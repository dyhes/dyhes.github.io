---
title: ã€Recommendationã€‘FAISS
date: 2025-06-18 00:00:00+0000
categories: 
- nutrition
tags:
- Recommendation
---

## Docker é•œåƒ

æ˜¯çš„ï¼Œ**FAISS å®Œå…¨å¯ä»¥ç»“åˆ Docker è¿›è¡Œéƒ¨ç½²**ï¼Œè¿™æ˜¯ç›®å‰ä¸»æµä¸”æ¨èçš„éƒ¨ç½²æ–¹å¼ä¹‹ä¸€ï¼Œèƒ½æœ‰æ•ˆè§£å†³ç¯å¢ƒä¾èµ–ã€ç‰ˆæœ¬éš”ç¦»å’Œè·¨å¹³å°è¿è¡Œç­‰é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯å‡ ç§å…¸å‹æ–¹æ¡ˆåŠå…¶é€‚ç”¨åœºæ™¯ï¼š

------

### âš™ï¸ 1. **ç›´æ¥ä½¿ç”¨å®˜æ–¹æˆ–ç¤¾åŒºé•œåƒ**

**åœºæ™¯**ï¼šå¿«é€Ÿå¯åŠ¨æµ‹è¯•æˆ–ç®€å•åº”ç”¨

- é•œåƒæ¥æºï¼š

  - å®˜æ–¹é•œåƒï¼š`facebookresearch/faiss`
  - é˜¿é‡Œäº‘ä¼˜åŒ–ç‰ˆï¼š`datascience-registry.cn-beijing.cr.aliyuncs.com/tools/faiss-server`ï¼ˆå«æœåŠ¡åŒ–æ”¯æŒï¼‰

- éƒ¨ç½²å‘½ä»¤ç¤ºä¾‹ï¼š

  ```
  docker run -p 8080:80 -it facebookresearch/faiss /bin/bash  # å®˜æ–¹é•œåƒ
  docker run -p 9000:9000 datascience-registry...  # é˜¿é‡Œäº‘é•œåƒï¼ˆå¸¦æœåŠ¡æ¥å£ï¼‰
  ```

**ç‰¹ç‚¹**ï¼šæ— éœ€ç¼–è¯‘ï¼Œå¼€ç®±å³ç”¨ï¼Œé€‚åˆåŸºç¡€åŠŸèƒ½éªŒè¯ã€‚

------

### ğŸ› ï¸ 2. **æ„å»ºè‡ªå®šä¹‰ Docker é•œåƒ**

**åœºæ™¯**ï¼šéœ€è¦å®šåˆ¶ç¯å¢ƒï¼ˆå¦‚ç‰¹å®š Python ç‰ˆæœ¬ã€ä¾èµ–åº“ï¼‰

- æ­¥éª¤ï¼š

  - ç¼–å†™ `Dockerfile`ï¼ŒåŸºäº `centos` æˆ– `ubuntu` å®‰è£… Conda å’Œ FAISSï¼›

  - ç¤ºä¾‹æ ¸å¿ƒé…ç½®ï¼š

    ```
    FROM centos:7
    RUN yum install -y wget && wget https://repo.anaconda.com/...  # å®‰è£… Miniconda
    RUN conda create -n faiss_env python=3.8 && conda install faiss-cpu -c pytorch
    ```

- æ„å»ºä¸è¿è¡Œï¼š

  ```
  docker build -t faiss-custom:v1 .  # æ„å»ºé•œåƒ
  docker run -v /host/data:/app/data faiss-custom:v1  # æŒ‚è½½æ•°æ®å·
  ```

**ç‰¹ç‚¹**ï¼šçµæ´»æ€§å¼ºï¼Œå¯é›†æˆ GPU é©±åŠ¨ï¼ˆéœ€å®‰è£… `faiss-gpu` å¹¶å¯ç”¨ NVIDIA å®¹å™¨è¿è¡Œæ—¶ï¼‰ã€‚

------

### ğŸŒ 3. **æœåŠ¡åŒ–éƒ¨ç½²ï¼ˆFaiss-Serverï¼‰**

**åœºæ™¯**ï¼šç”Ÿäº§ç¯å¢ƒéœ€æä¾› API æ¥å£

- æ–¹æ¡ˆï¼š

  - ä½¿ç”¨å¼€æºé¡¹ç›® **[Faiss-Server](https://github.com/ynqa/faiss-server)**ï¼Œæä¾› gRPC æ¥å£ï¼›
  - æ”¯æŒå¢é‡ç´¢å¼•æ›´æ–°å’Œç‰ˆæœ¬ç®¡ç†ã€‚

- éƒ¨ç½²æµç¨‹ï¼š

  ```
  git clone https://github.com/ynqa/faiss-server.git
  docker build -t faiss-server .  # æ„å»ºé•œåƒ
  docker run -p 8080:8080 -v /index:/data faiss-server  # æŒ‚è½½ç´¢å¼•ç›®å½•
  ```

**ç‰¹ç‚¹**ï¼šé€‚åˆé«˜å¹¶å‘åœºæ™¯ï¼Œæ”¯æŒåˆ†å¸ƒå¼æ‰©å±•ã€‚

------

### âš¡ 4. **GPU åŠ é€Ÿæ”¯æŒ**

**åœºæ™¯**ï¼šå¤§è§„æ¨¡å‘é‡æ£€ç´¢éœ€ä½å»¶è¿Ÿ

- é…ç½®è¦æ±‚ï¼š

  - å®‰è£… `faiss-gpu` å¹¶å¯ç”¨ CUDA æ”¯æŒï¼›
  - Docker è¿è¡Œæ—¶éœ€æ·»åŠ  `--gpus all` å‚æ•°ã€‚

- ç¤ºä¾‹å‘½ä»¤ï¼š

  ```
  docker run --gpus all -it faiss-gpu:v1  # å¯ç”¨ GPU æ”¯æŒ
  ```

**ç‰¹ç‚¹**ï¼šæ˜¾è‘—æå‡æœç´¢é€Ÿåº¦ï¼ˆå°¤å…¶åäº¿çº§æ•°æ®ï¼‰ï¼Œä½†éœ€ NVIDIA æ˜¾å¡é©±åŠ¨æ”¯æŒã€‚

------

### ğŸ“Š **æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹å»ºè®®**

| **æ–¹æ¡ˆ**     | **é€‚ç”¨åœºæ™¯**    | **ä¼˜åŠ¿**             | **å±€é™**          |
| ------------ | --------------- | -------------------- | ----------------- |
| å®˜æ–¹é•œåƒ     | å¿«é€ŸåŸå‹éªŒè¯    | æ— éœ€é…ç½®ï¼Œå³å¼€å³ç”¨   | åŠŸèƒ½è¾ƒåŸºç¡€        |
| è‡ªå®šä¹‰é•œåƒ   | å®šåˆ¶ç¯å¢ƒéœ€æ±‚    | çµæ´»é›†æˆä¾èµ–é¡¹       | éœ€ç»´æŠ¤ Dockerfile |
| Faiss-Server | ç”Ÿäº§çº§ API æœåŠ¡ | æ”¯æŒåˆ†å¸ƒå¼ã€å¢é‡æ›´æ–° | ä»…é™ CPU ç¯å¢ƒ     |
| GPU é•œåƒ     | é«˜æ€§èƒ½æ£€ç´¢åœºæ™¯  | æ¯«ç§’çº§å“åº”åäº¿çº§æ•°æ® | ä¾èµ–ç¡¬ä»¶å’Œé©±åŠ¨    |

------

### ğŸ’ **æ€»ç»“**

FAISS ä¸ Docker ç»“åˆéƒ¨ç½²æ˜¯**é«˜æ•ˆä¸”æˆç†Ÿçš„å®è·µæ–¹æ¡ˆ**ï¼š

- æµ‹è¯•ç¯å¢ƒ â†’ é€‰ç”¨ **å®˜æ–¹é•œåƒ** æˆ– **é¢„æ„å»ºæœåŠ¡é•œåƒ**ï¼›
- ç”Ÿäº§ç¯å¢ƒ â†’ æ¨è **Faiss-Server** æˆ– **è‡ªå®šä¹‰ GPU é•œåƒ**ï¼›
- éœ€æ³¨æ„ï¼šGPU é•œåƒéœ€é¢å¤–é…ç½®é©±åŠ¨ï¼ŒæœåŠ¡åŒ–æ–¹æ¡ˆéœ€å…³æ³¨ç´¢å¼•çƒ­æ›´æ–°æœºåˆ¶ã€‚

å»ºè®®å‚è€ƒ [Faiss å®˜æ–¹æ–‡æ¡£](https://github.com/facebookresearch/faiss/wiki) å’Œ [Faiss-Server é¡¹ç›®](https://github.com/ynqa/faiss-server) è·å–æœ€æ–°éƒ¨ç½²ç»†èŠ‚ã€‚
