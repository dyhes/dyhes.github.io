<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="About Unstructured data, such as text, images, and audio, varies in format and carries rich underlying semantics, making it challenging to analyze. To manage this complexity, embeddings are used to convert unstructured data into numerical vectors that capture its essential characteristics. These vectors are then stored in a vector database, enabling fast and scalable searches and analytics.\nMilvus Lite is a Python library that can be easily integrated into your applications. As a lightweight version of Milvus, itâ€™s ideal for quick prototyping in Jupyter Notebooks or running on edge devices with limited resources. Learn more. Milvus Standalone is a single-machine server deployment, with all components bundled into a single Docker image for convenient deployment. Learn more. Milvus Distributed can be deployed on Kubernetes clusters, featuring a cloud-native architecture designed for billion-scale or even larger scenarios. This architecture ensures redundancy in critical components. Learn more. High performance\n"><title>ã€Milvusã€‘Fundamentals</title><link rel=canonical href=https://dyhes.github.io/p/milvusfundamentals/><link rel=stylesheet href=/scss/style.min.f7091bff8043bd3e53b22be6c05dd86b506e8dec4d0d75d249d2dfb0fe074a46.css><meta property='og:title' content="ã€Milvusã€‘Fundamentals"><meta property='og:description' content="About Unstructured data, such as text, images, and audio, varies in format and carries rich underlying semantics, making it challenging to analyze. To manage this complexity, embeddings are used to convert unstructured data into numerical vectors that capture its essential characteristics. These vectors are then stored in a vector database, enabling fast and scalable searches and analytics.\nMilvus Lite is a Python library that can be easily integrated into your applications. As a lightweight version of Milvus, itâ€™s ideal for quick prototyping in Jupyter Notebooks or running on edge devices with limited resources. Learn more. Milvus Standalone is a single-machine server deployment, with all components bundled into a single Docker image for convenient deployment. Learn more. Milvus Distributed can be deployed on Kubernetes clusters, featuring a cloud-native architecture designed for billion-scale or even larger scenarios. This architecture ensures redundancy in critical components. Learn more. High performance\n"><meta property='og:url' content='https://dyhes.github.io/p/milvusfundamentals/'><meta property='og:site_name' content='é£é¸¿è¸é›ªæ³¥'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='DB'><meta property='article:published_time' content='2025-08-06T00:00:00+00:00'><meta property='article:modified_time' content='2025-08-08T20:27:12+08:00'><meta name=twitter:title content="ã€Milvusã€‘Fundamentals"><meta name=twitter:description content="About Unstructured data, such as text, images, and audio, varies in format and carries rich underlying semantics, making it challenging to analyze. To manage this complexity, embeddings are used to convert unstructured data into numerical vectors that capture its essential characteristics. These vectors are then stored in a vector database, enabling fast and scalable searches and analytics.\nMilvus Lite is a Python library that can be easily integrated into your applications. As a lightweight version of Milvus, itâ€™s ideal for quick prototyping in Jupyter Notebooks or running on edge devices with limited resources. Learn more. Milvus Standalone is a single-machine server deployment, with all components bundled into a single Docker image for convenient deployment. Learn more. Milvus Distributed can be deployed on Kubernetes clusters, featuring a cloud-native architecture designed for billion-scale or even larger scenarios. This architecture ensures redundancy in critical components. Learn more. High performance\n"><link rel="shortcut icon" href=/github.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_b567f26f71c49c33.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>é£é¸¿è¸é›ªæ³¥</a></h1><h2 class=site-description>æ²¡æœ‰è®°å½•ï¼Œå°±æ²¡æœ‰å‘ç”Ÿ</h2></div></header><ol class=menu-social><li><a href=https://leetcode.cn/u/dyhes/ target=_blank title=LeetCode rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 13h7.5"/><path d="M9.424 7.268l4.999-4.999"/><path d="M16.633 16.644l-2.402 2.415a3.189 3.189.0 01-4.524.0l-3.77-3.787a3.223 3.223.0 010-4.544l3.77-3.787a3.189 3.189.0 014.524.0l2.302 2.313"/></svg></a></li><li><a href=https://github.com/dyhes target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:dyheslin@gmail.com target=_blank title=Gmail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-gmail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M16 20h3a1 1 0 001-1V5a1 1 0 00-1-1h-3v16z"/><path d="M5 20h3V4H5A1 1 0 004 5v14a1 1 0 001 1z"/><path d="M16 4l-4 4-4-4"/><path d="M4 6.5l8 7.5 8-7.5"/></svg></a></li><li><a href=mailto:1325574784@qq.com target=_blank title=Mail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 19H5a2 2 0 01-2-2V7a2 2 0 012-2h14a2 2 0 012 2v5.5"/><path d="M3 7l9 6 9-6"/><path d="M19 16l-2 3h4l-2 3"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/categories/><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/tags/><svg class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>Tags</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#about>About</a></li><li><a href=#architecture>Architecture</a><ol><li><a href=#data-flow>Data Flow</a></li></ol></li><li><a href=#streaming-service>Streaming Service</a><ol><li><a href=#message>Message</a></li></ol></li><li><a href=#data-model>Data Model</a><ol><li><a href=#schema-design>Schema Design</a><ol><li><a href=#primary-key>Primary Key</a></li><li><a href=#partitioning>Partitioning</a></li><li><a href=#analyzer>Analyzer</a></li><li><a href=#function>Function</a></li></ol></li></ol></li><li><a href=#data-processing>Data Processing</a><ol><li><a href=#data-insertion>Data Insertion</a></li><li><a href=#index-building>Index building</a></li><li><a href=#data-query>Data query</a></li></ol></li><li><a href=#knowhere>Knowhere</a></li><li><a href=#bitset>Bitset</a></li><li><a href=#timestamp>Timestamp</a><ol><li><a href=#guarantee_timestamp><code>Guarantee_timestamp</code></a></li><li><a href=#service_timestamp><code>Service_timestamp</code></a><ol><li><a href=#scenario-1-service_timestamp--guarantee_timestamp>Scenario 1: <code>Service_timestamp</code> >= <code>Guarantee_timestamp</code></a></li><li><a href=#scenario-2-service_timestamp--guarantee_timestamp>Scenario 2: <code>Service_timestamp</code> &lt; <code>Guarantee_timestamp</code></a></li></ol></li><li><a href=#graceful_time><code>Graceful_time</code></a><ol><li><a href=#scenario-1-service_timestamp--graceful_time--guarantee_timestamp>Scenario 1: <code>Service_timestamp</code> + <code>Graceful_time</code> >= <code>Guarantee_timestamp</code></a></li><li><a href=#scenario-2-service_timestamp--graceful_time--guarantee_timestamp>Scenario 2: <code>Service_timestamp</code> + <code>Graceful_time</code> &lt; <code>Guarantee_timestamp</code></a></li></ol></li></ol></li><li><a href=#metrics>Metrics</a></li><li><a href=#index>Index</a><ol><li><a href=#ä¸€æ ¸å¿ƒåŸç†ä¸æŠ€æœ¯ç‰¹ç‚¹>ä¸€ã€æ ¸å¿ƒåŸç†ä¸æŠ€æœ¯ç‰¹ç‚¹</a><ol><li><a href=#1-hnswåˆ†å±‚å¯¼èˆªå°ä¸–ç•Œå›¾>1. <strong>HNSWï¼šåˆ†å±‚å¯¼èˆªå°ä¸–ç•Œå›¾</strong></a></li><li><a href=#2-ivf-flatå€’æ’æ–‡ä»¶æš´åŠ›æœç´¢>2. <strong>IVF-Flatï¼šå€’æ’æ–‡ä»¶+æš´åŠ›æœç´¢</strong></a></li></ol></li><li><a href=#äºŒæ€§èƒ½å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯>äºŒã€æ€§èƒ½å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯</a></li><li><a href=#ä¸‰å…¸å‹åº”ç”¨åœºæ™¯é€‰æ‹©å»ºè®®>ä¸‰ã€å…¸å‹åº”ç”¨åœºæ™¯é€‰æ‹©å»ºè®®</a></li><li><a href=#å››å®é™…æ¡ˆä¾‹è¯´æ˜>å››ã€å®é™…æ¡ˆä¾‹è¯´æ˜</a></li><li><a href=#äº”è¿›é˜¶è°ƒä¼˜ç­–ç•¥>äº”ã€è¿›é˜¶è°ƒä¼˜ç­–ç•¥</a></li></ol></li><li><a href=#fastjson>FastJson</a><ol><li><a href=#-1-ä¾èµ–ä½œç”¨åŸŸscopeè®¾è®¡>ğŸ”§ 1. <strong>ä¾èµ–ä½œç”¨åŸŸï¼ˆScopeï¼‰è®¾è®¡</strong></a></li><li><a href=#-2-æ¨¡å—åŒ–ä¸è½»é‡åŒ–è€ƒé‡>âš™ï¸ 2. <strong>æ¨¡å—åŒ–ä¸è½»é‡åŒ–è€ƒé‡</strong></a></li><li><a href=#-3-å®‰å…¨ä¸ç‰ˆæœ¬å…¼å®¹æ€§>ğŸ›¡ï¸ 3. <strong>å®‰å…¨ä¸ç‰ˆæœ¬å…¼å®¹æ€§</strong></a></li><li><a href=#-4-æ„å»ºå·¥å…·çš„é™åˆ¶>ğŸ”„ 4. <strong>æ„å»ºå·¥å…·çš„é™åˆ¶</strong></a></li><li><a href=#-æ€»ç»“milvus-çš„è®¾è®¡é€»è¾‘ä¸ç”¨æˆ·åº”å¯¹>ğŸ’ æ€»ç»“ï¼šMilvus çš„è®¾è®¡é€»è¾‘ä¸ç”¨æˆ·åº”å¯¹</a></li></ol></li><li><a href=#æ ‡é‡é»˜è®¤ç´¢å¼•>æ ‡é‡é»˜è®¤ç´¢å¼•</a><ol><li><a href=#-ä¸€é»˜è®¤ç´¢å¼•ç­–ç•¥è‡ªåŠ¨ç´¢å¼•auto-index>ğŸ“Œ ä¸€ã€é»˜è®¤ç´¢å¼•ç­–ç•¥ï¼šè‡ªåŠ¨ç´¢å¼•ï¼ˆAuto Indexï¼‰</a></li><li><a href=#-äºŒæ³¨æ„äº‹é¡¹>âš ï¸ äºŒã€æ³¨æ„äº‹é¡¹</a></li><li><a href=#-ä¸‰æ€»ç»“>ğŸ’ ä¸‰ã€æ€»ç»“</a></li></ol></li><li><a href=#æ ‡é‡ç´¢å¼•>æ ‡é‡ç´¢å¼•</a><ol><li><a href=#-1-è‡ªåŠ¨ç´¢å¼•auto-index>ğŸ” 1. <strong>è‡ªåŠ¨ç´¢å¼•ï¼ˆAuto Indexï¼‰</strong></a></li><li><a href=#-2-å€’æ’ç´¢å¼•inverted-index>ğŸ”¢ 2. <strong>å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰</strong></a></li><li><a href=#-3-ä½å›¾ç´¢å¼•bitmap>ğŸ§© 3. <strong>ä½å›¾ç´¢å¼•ï¼ˆBitmapï¼‰</strong></a></li><li><a href=#-4-å‰ç¼€æ ‘ç´¢å¼•trie>ğŸ”¤ 4. <strong>å‰ç¼€æ ‘ç´¢å¼•ï¼ˆTrieï¼‰</strong></a></li><li><a href=#-5-stl_>ğŸ“Š 5. <strong>STL_SORT ç´¢å¼•</strong></a></li><li><a href=#-ç´¢å¼•é€‰æ‹©ä¸ä½¿ç”¨å»ºè®®>âš™ï¸ <strong>ç´¢å¼•é€‰æ‹©ä¸ä½¿ç”¨å»ºè®®</strong></a></li><li><a href=#-æ€»ç»“>ğŸ’ <strong>æ€»ç»“</strong></a></li></ol></li><li><a href=#ç´¢å¼•ç‰©ç†ç»“æ„>ç´¢å¼•ç‰©ç†ç»“æ„</a><ol><li><a href=#-ä¸€å‘é‡ç´¢å¼•çš„ç‰©ç†ç»“æ„>âš™ï¸ <strong>ä¸€ã€å‘é‡ç´¢å¼•çš„ç‰©ç†ç»“æ„</strong></a></li><li><a href=#-äºŒæ ‡é‡ç´¢å¼•çš„ç‰©ç†ç»“æ„>ğŸ”¢ <strong>äºŒã€æ ‡é‡ç´¢å¼•çš„ç‰©ç†ç»“æ„</strong></a></li><li><a href=#-ä¸‰ç´¢å¼•çš„å­˜å‚¨ä¸æ‰§è¡Œæµç¨‹>ğŸ§© <strong>ä¸‰ã€ç´¢å¼•çš„å­˜å‚¨ä¸æ‰§è¡Œæµç¨‹</strong></a></li><li><a href=#-å››æ€»ç»“ç´¢å¼•ç»“æ„ä¸é€‚ç”¨åœºæ™¯>ğŸ’ <strong>å››ã€æ€»ç»“ï¼šç´¢å¼•ç»“æ„ä¸é€‚ç”¨åœºæ™¯</strong></a></li></ol></li><li><a href=#json-ç´¢å¼•>JSON ç´¢å¼•</a><ol><li><a href=#-json-å­—æ®µç´¢å¼•çš„æ ¸å¿ƒæœºåˆ¶>âš™ï¸ <strong>JSON å­—æ®µç´¢å¼•çš„æ ¸å¿ƒæœºåˆ¶</strong></a></li><li><a href=#-å¦‚ä½•ä¸º-json-çš„ç‰¹å®šå­—æ®µåˆ›å»ºç´¢å¼•>ğŸ”§ <strong>å¦‚ä½•ä¸º JSON çš„ç‰¹å®šå­—æ®µåˆ›å»ºç´¢å¼•ï¼Ÿ</strong></a></li><li><a href=#-å…³é”®æ³¨æ„äº‹é¡¹>âš ï¸ <strong>å…³é”®æ³¨æ„äº‹é¡¹</strong></a></li><li><a href=#-é«˜çº§æŠ€å·§åŠ¨æ€å­—æ®µçš„ç´¢å¼•>ğŸš€ <strong>é«˜çº§æŠ€å·§ï¼šåŠ¨æ€å­—æ®µçš„ç´¢å¼•</strong></a></li><li><a href=#-æ€»ç»“ä¸å»ºè®®>ğŸ’ <strong>æ€»ç»“ä¸å»ºè®®</strong></a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/nutrition/ style=background-color:#93b5cf;color:>ç§¯é›ªç²®
</a><a href=/categories/willow/ style=background-color:#dc9123;color:>æ»¡åŸé£çµ®</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/milvusfundamentals/>ã€Milvusã€‘Fundamentals</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 06, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>19 minute read</time></div></footer></div></header><section class=article-content><h2 id=about>About</h2><p>Unstructured data, such as text, images, and audio, varies in format and carries rich underlying <strong>semantics</strong>, making it challenging to analyze. To manage this complexity, embeddings are used to convert <strong>unstructured</strong> data into numerical vectors that capture its essential characteristics. These vectors are then stored in a vector database, enabling fast and scalable searches and analytics.</p><ul><li>Milvus Lite is a <strong>Python library</strong> that can be easily integrated into your applications. As a lightweight version of Milvus, itâ€™s ideal for quick prototyping in Jupyter Notebooks or running on edge devices with limited resources. <a class=link href=https://milvus.io/docs/milvus_lite.md target=_blank rel=noopener>Learn more</a>.</li><li>Milvus Standalone is a <strong>single-machine server</strong> deployment, with all components bundled into a single Docker image for convenient deployment. <a class=link href=https://milvus.io/docs/install_standalone-docker.md target=_blank rel=noopener>Learn more</a>.</li><li>Milvus Distributed can be deployed on <strong>Kubernetes clusters</strong>, featuring a cloud-native architecture designed for billion-scale or even larger scenarios. This architecture ensures redundancy in critical components. <a class=link href=https://milvus.io/docs/install_cluster-milvusoperator.md target=_blank rel=noopener>Learn more</a>.</li></ul><p>High performance</p><ul><li><p>Hardware-aware Optimization</p></li><li><p>Advanced Search Algorithms</p></li><li><p>C++ Search Engine</p></li><li><p>Column-Oriented</p><p>The primary advantages come from the data access patterns. When performing queries, a column-oriented database reads only the specific fields involved in the query, rather than entire rows, which greatly reduces the amount of data accessed. Additionally, operations on column-based data can be easily vectorized, allowing for operations to be applied in the entire columns at once, further enhancing performance.</p></li></ul><h2 id=architecture>Architecture</h2><p>Milvus itself is fully <strong>stateless</strong> so it can be easily scaled with the help of Kubernetes or public clouds.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/milvus_architecture_2_6.png loading=lazy alt="Highly decoupled system architecture of Milvus">Milvus follows the principle of data plane and control plane disaggregation, comprising four main layers that are mutually independent in terms of scalability and disaster recovery.</p><ul><li><p>Access Layer</p><p>Composed of a group of stateless proxies, the access layer is the front layer of the system and endpoint to users. It validates client requests and reduces the returned results.</p></li><li><p>Coordinator</p><p>The Coordinator serves as the brain of Milvus. At any moment, <strong>exactly one Coordinator is active</strong> across the entire cluster, responsible for maintaining the cluster topology, scheduling all task types, and promising cluster-level consistency.</p></li><li><p>Worker Nodes</p><p>Worker nodes are stateless thanks to <strong>separation of storage and computation</strong>, and can facilitate system scale-out and disaster recovery when deployed on Kubernetes.</p><ul><li><p>Streaming Node</p><p>Streaming Node serves as the shard-level &ldquo;<strong>mini-brain</strong>&rdquo;, providing shard-level consistency guarantees and fault recovery based on underlying <strong>WAL</strong> Storage. Meanwhile, Streaming Node is also responsible for growing data <strong>querying</strong> and generating query plans. Additionally, it also handles the <strong>conversion</strong> of growing data into sealed (historical) data.</p></li><li><p>Data Node</p><p>Data node is responsible for <strong>offline</strong> processing of historical data, such as compaction and index building.</p></li><li><p>Query Node</p><p>Query node loads the historical data from object storage, and provides the historical data querying.</p></li></ul></li><li><p>Storage</p><p>Storage is the bone of the system, responsible for data persistence. It comprises meta storage, log broker, and object storage.</p><ul><li><p>Meta Storage (etcd)</p><p>Meta storage stores snapshots of metadata such as collection schema, and message consumption checkpoints.</p></li><li><p>Object Storage</p><p>Object storage stores snapshot files of logs, index files for scalar and vector data, and intermediate query results. Milvus uses <strong>MinIO</strong> as object storage and can be readily deployed on AWS S3 and Azure Blob, two of the worldâ€™s most popular, cost-effective storage services.</p></li><li><p>WAL Storage</p></li></ul></li></ul><div class=table-wrapper><table><thead><tr><th>API Category</th><th>Operations</th><th>Example APIs</th><th>Architecture Flow</th></tr></thead><tbody><tr><td><strong>DDL/DCL</strong></td><td>Schema & Access Control</td><td><code>createCollection</code>, <code>dropCollection</code>, <code>hasCollection</code>, <code>createPartition</code></td><td>Access Layer â†’ Coordinator</td></tr><tr><td><strong>DML</strong></td><td>Data Manipulation</td><td><code>insert</code>, <code>delete</code>, <code>upsert</code></td><td>Access Layer â†’ Streaming Worker Node</td></tr><tr><td><strong>DQL</strong></td><td>Data Query</td><td><code>search</code>, <code>query</code></td><td>Access Layer â†’ Batch Worker Node (Query Nodes)</td></tr></tbody></table></div><h3 id=data-flow>Data Flow</h3><p>Search:</p><ol><li>Client sends a search request via SDK/RESTful API</li><li>Load Balancer routes request to available Proxy in Access Layer</li><li>Proxy uses routing cache to determine target nodes; contacts Coordinator <strong>only if cache is unavailable</strong></li><li>Proxy forwards request to appropriate Streaming Nodes, which then coordinate with Query Nodes for sealed data search while executing growing data search locally</li><li>Query Nodes load sealed segments from Object Storage as needed and perform segment-level search</li><li>Search results undergo <strong>multi-level reduction</strong>: Query Nodes reduce results across multiple segments, Streaming Nodes reduce results from Query Nodes, and Proxy reduces results from all Streaming Nodes before returning to client</li></ol><p>Insert:</p><ol><li>Client sends an insert request with vector data</li><li>Access Layer validates and forwards request to Streaming Node</li><li>Streaming Node logs operation to WAL Storage for durability</li><li>Data is processed in real-time and made available for queries</li><li>When <strong>segments</strong> reach capacity, Streaming Node triggers conversion to sealed segments</li><li>Data Node handles <strong>compaction</strong> and builds <strong>indexes</strong> on top of the sealed segments, storing results in Object Storage</li><li>Query Nodes load the newly built indexes and replace the corresponding growing data</li></ol><h2 id=streaming-service>Streaming Service</h2><p>The <strong>Streaming Service</strong> is a concept for Milvus internal streaming system module, built around the Write-Ahead Log (WAL) to support various streaming-related function.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/streaming_distributed_arch.png loading=lazy alt="Streaming Distributed Arc"></p><ul><li><strong>Streaming Coordinator</strong>: A logical component in the <strong>coordinator node</strong>. It uses Etcd for service discovery to locate available streaming nodes and is responsible for binding WAL to the corresponding streaming nodes. It also registers service to expose the WAL distribution topology, allowing streaming clients to know the appropriate streaming node for a given WAL.</li><li><strong>Streaming Node Cluster</strong>: A cluster of streaming worker nodes responsible for all streaming-processing tasks, such as wal appending, state recovering, growing data querying.</li><li><strong>Streaming Client</strong>: An internally developed Milvus client that encapsulates basic functionalities such as service discovery and readiness checks. It is used to initiate operations such as message writing and subscription.</li></ul><h3 id=message>Message</h3><p>The Streaming Service is a log-driven streaming system, so all write operations in Milvus (such as DML and DDL) are abstracted as <strong>Messages</strong>.</p><ul><li>Every Message is assigned a <strong>Timestamp Oracle (TSO)</strong> field by the Streaming Service, which indicates the messageâ€™s order in the WAL. The ordering of messages determines the order of write operations in Milvus. This makes it possible to reconstruct the latest cluster state from the logs.</li><li>Each Message belongs to a specific <strong>VChannel</strong> (Virtual Channel) and maintains certain invariant properties within that channel to ensure <strong>operation consistency</strong>. For example, an Insert operation must always occur before a DropCollection operation on the same channel.</li></ul><p><img src=https://milvus.io/docs/v2.6.x/assets/message_order.png loading=lazy alt="Message Order"></p><h2 id=data-model>Data Model</h2><p>Milvus allows you to specify the search data model through a <strong>collection</strong> schema, organizing unstructured data, their dense or sparse vector <strong>representations</strong>, and structured <strong>metadata</strong>.</p><p>User Queries:</p><ul><li>Documents Retrieving</li><li>Image Finding</li><li>Product Searching</li><li>Metadata Filtering</li><li>Hybrid</li></ul><p>Search Methods:</p><ul><li><strong>Semantic search</strong>: Uses dense vector similarity to find items with similar meaning, ideal for unstructured data like text or images.</li><li><strong>Full-text search</strong>: <strong>Complementing</strong> semantic search with keyword matching. Full-text search can utilize lexical analysis to avoid breaking long words into fragmented tokens, grasping the special terms during retrieval.</li><li><strong>Metadata filtering</strong>: On top of vector search, applying constraints like date ranges, categories, or tags.</li></ul><h3 id=schema-design>Schema Design</h3><p>On the high level, Milvus supports two main types of fields: <strong>vector fields</strong> and <strong>scalar fields</strong>.</p><p>You can map your data model into a schema of fields, including vectors and any auxiliary scalar fields. Ensure that each field correlates with the attributes from your data model, especially pay attention to your vector type (dense or spase) and its dimension.</p><p>Vector fields store embeddings for <strong>unstructured</strong> data types such as text, images, and audio. These embeddings may be dense, sparse, or binary, depending on the data type and the retrieval method utilized. Typically, dense vectors are used for <strong>semantic</strong> search, while sparse vectors are better suited for <strong>full-text or lexical</strong> matching. Binary vectors are useful when storage and computational resources are limited. A collection may contain several vector fields to enable <strong>multi-modal</strong> or hybrid retrieval strategies.</p><p>Milvus supports the vector data types: <code>FLOAT_VECTOR</code> for <a class=link href=https://milvus.io/docs/dense-vector.md target=_blank rel=noopener>Dense Vector</a>, <code>SPARSE_FLOAT_VECTOR</code> for <a class=link href=https://milvus.io/docs/sparse_vector.md target=_blank rel=noopener>Sparse Vector</a>, and <code>BINARY_VECTOR</code> for <a class=link href=https://milvus.io/docs/binary-vector.md target=_blank rel=noopener>Binary Vector</a></p><p>Scalar fields store primitive, structured valuesâ€”commonly referred to as <strong>metadata</strong>â€”such as numbers, strings, or dates. These values can be returned alongside vector search results and are essential for filtering and sorting. They allow you to narrow search results based on specific attributes, like limiting documents to a particular category or a defined time range.</p><p>Milvus supports scalar types such as <code>BOOL</code>, <code>INT8/16/32/64</code>, <code>FLOAT</code>, <code>DOUBLE</code>, <code>VARCHAR</code>, <code>JSON</code>, and <code>ARRAY</code> for storing and filtering non-vector data.</p><h4 id=primary-key>Primary Key</h4><p>A primary key field is a fundamental component of a schema, as it <strong>uniquely identifies</strong> each entity within a collection. Defining a primary key is <strong>mandatory</strong>. It shall be <strong>scalar field of integer or string</strong> type and marked as <code>is_primary=True</code>. Optionally, you can enable <code>auto_id</code> for the primary key, which is automatically assigned integer numbers that monolithically grow as more data is ingested into the collection.</p><h4 id=partitioning>Partitioning</h4><p>To speed up the search, you can <strong>optionally</strong> turn on partitioning. By designating a specific scalar field for partitioning and specifying filtering criteria based on this field during searches, the search scope can be effectively limited to only the relevant partitions. This method significantly enhances the efficiency of retrieval operations by reducing the search domain.</p><h4 id=analyzer>Analyzer</h4><p>An analyzer is an essential tool for processing and transforming text data. Its main function is to <strong>convert raw text into tokens</strong> and to structure them for indexing and retrieval. It does that by tokenizing the string, dropping the stop words, and stemming the individual words into tokens.</p><h4 id=function>Function</h4><p>Milvus allows you to define built-in functions as part of the schema to automatically derive certain fields.</p><h2 id=data-processing>Data Processing</h2><h3 id=data-insertion>Data Insertion</h3><p>You can choose how many <strong>shards</strong> a collection uses in Milvusâ€”each shard maps to a virtual channel (<em>vchannel</em>). As illustrated below, Milvus then assigns every <em>vchannel</em> to a physical channel (<em>pchannel</em>), and each <em>pchannel</em> is bound to a specific Streaming Node.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/pvchannel_wal.png loading=lazy alt="VChannel PChannel and StreamingNode"></p><p>After data verification, the proxy will split the written message into various data package of shards according to the specified shard routing rules.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/channels_1.png loading=lazy alt="Channels 1"></p><p>Then the written data of one shard (<em>vchannel</em>) is sent to the corresponding Streaming Node of <em>pchannel</em>.</p><p>The Streaming Node assigns a <strong>Timestamp Oracle</strong> (TSO) to each data packet to establish a total ordering of operations. It performs <strong>consistency checks</strong> on the payload before writing it into the underlying write-ahead log (WAL).</p><p>Meanwhile, the StreamingNode also asynchronously chops the committed WAL entries into discrete segments. There are two segment types:</p><ul><li><strong>Growing segment</strong>: any data that has <strong>not</strong> been presisted into the object storage.</li><li><strong>Sealed segment</strong>: all data has been persisted into the object storage, the data of sealed segment is <strong>immutable</strong>.</li></ul><p>The transition of a growing segment into a sealed segment is called a flush. The Streaming Node triggers a <strong>flush</strong> as soon as it has ingested and written all available WAL entries for that segmentâ€”i.e., when there are no more pending records in the underlying write-ahead logâ€”at which point the segment is finalized and made read-optimized.</p><p>When the growing segment on a Streaming Node is flushed into a sealed segmentâ€”or when a Data Node completes a compactionâ€”the Coordinator initiates a handoff operation to convert that growing data into historical data.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/handoff.png loading=lazy alt=Handoff></p><h3 id=index-building>Index building</h3><p>Index building is performed by data node. To avoid frequent index building for data updates, a collection in Milvus is divided further into segments, each with its own index.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/index_building.png loading=lazy alt="Index building"></p><p>Milvus supports building index for each <strong>vector field, scalar field and primary field</strong>. Both the input and output of index building engage with object storage: The data node loads the log snapshots to index from a segment (which is in object storage) to memory, deserializes the corresponding data and metadata to build index, serializes the index when index building completes, and writes it back to object storage.</p><p>Index building mainly involves <strong>vector and matrix operations</strong> and hence is computation- and memory-intensive. Vectors <strong>cannot be efficiently indexed with traditional tree-based indexes due to their high-dimensional nature</strong>, but can be indexed with techniques that are more mature in this subject, such as <strong>cluster- or graph-based indexes</strong>. Regardless its type, building index involves massive iterative calculations for large-scale vectors, such as Kmeans or graph traverse.</p><p>Unlike indexing for scalar data, building vector index has to take full advantage of SIMD (single instruction, multiple data) acceleration. Milvus has innate support for SIMD instruction sets, e.g., SSE, AVX2, and AVX512. Given the â€œhiccupâ€ and resource-intensive nature of vector index building, elasticity becomes crucially important to Milvus in economical terms. Future Milvus releases will further explorations in heterogeneous computing and serverless computation to bring down the related costs.</p><p>Besides, Milvus also supports s<strong>calar filtering and primary field query</strong>. It has inbuilt indexes to improve query efficiency, e.g., Bloom filter indexes, hash indexes, tree-based indexes, and inverted indexes, and plans to introduce more external indexes, e.g., bitmap indexes and rough indexes.</p><h3 id=data-query>Data query</h3><p><img src=https://milvus.io/docs/v2.6.x/assets/data_query.jpg loading=lazy alt="Data query"></p><p>A collection in Milvus is split into multiple <strong>segments</strong>; the Streaming Node loads <strong>growing</strong> segments and maintains real-time data, while the Query Nodes load <strong>sealed</strong> segments.</p><p>When a query/search request arrives, the proxy <strong>broadcasts the request to all Streaming Nodes responsible for the related shards</strong> for concurrent search.</p><p>Each Streaming Node generates a query plan, searches its <strong>local</strong> growing data, and simultaneously contacts <strong>remote</strong> Query Nodes to retrieve historical results, then aggregates these into a <strong>single shard result</strong>.</p><p>Finally, the proxy collects all shard results, merges them into the final outcome, and returns it to the client.</p><h2 id=knowhere>Knowhere</h2><p>Knowhere is the <strong>core vector execution engine</strong> of Milvus, which <strong>incorporates</strong> several vector similarity search libraries including <a class=link href=https://github.com/facebookresearch/faiss target=_blank rel=noopener>Faiss</a>, <a class=link href=https://github.com/nmslib/hnswlib target=_blank rel=noopener>Hnswlib</a> and <a class=link href=https://github.com/spotify/annoy target=_blank rel=noopener>Annoy</a>. Knowhere is also designed to support <strong>heterogeneous</strong> computing. It controls on which hardware (CPU or GPU) to execute index building and search requests. This is how Knowhere gets its name - knowing where to execute the operations. More types of hardware including DPU and TPU will be supported in future releases.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/knowhere_architecture.png loading=lazy alt=Knowhere></p><p>The bottom-most layer is the system hardware. Above this sit the third-party index libraries. At the top layer, Knowhere interacts with the index node and query node via CGO, which <strong>allows Go packages to call C code</strong>.</p><h2 id=bitset>Bitset</h2><p>In Milvus, bitsets are arrays of bit numbers <code>0</code> and <code>1</code> that can be used to represent certain data compactly and efficiently as opposed to in ints, floats, or chars. A bit number is <code>0</code> by default and is only set to <code>1</code> if it meets certain requirements.</p><p>Bitset is a simple yet powerful mechanism that helps Milvus perform attribute filtering, data deletion, and query with Time Travel.</p><h2 id=timestamp>Timestamp</h2><p>When conducting a data manipulation language (DML) operation, including <a class=link href=https://milvus.io/docs/v2.1.x/data_processing.md target=_blank rel=noopener>data insertion and deletion</a>, Milvus assigns timestamps to the entities involved in the operation. Therefore, all entities in Milvus has a <strong>timestamp attribute</strong>. And the batches of entities in the same DML operation share the same timestamp value.</p><h3 id=guarantee_timestamp><code>Guarantee_timestamp</code></h3><p><code>Guarantee_timestamp</code> is a type of timestamp used to ensure that all data updates by DML operations before the <code>Guarantee_timestamp</code> are <strong>visible</strong> when a vector similarity search or query is conducted.</p><p>If the <code>Guarantee_timestamp</code> is not configured, Milvus automatically takes <strong>the point in time</strong> when the search request is made. Therefore, the search is conducted on a data view with all data updates by DML operations before the search.</p><p>To save you the trouble of understanding the <a class=link href=https://github.com/milvus-io/milvus/blob/master/docs/design_docs/20211214-milvus_hybrid_ts.md target=_blank rel=noopener>TSO</a> inside Milvus, as a user, you do not have to directly configure the <code>Guarantee_timestamp</code> parameter. You only need to choose the <a class=link href=https://milvus.io/docs/v2.1.x/consistency.md target=_blank rel=noopener>consistency level</a>, and Milvus automatically handles the <code>Guarantee_timestamp</code> parameter for you. Each consistency level corresponds to a certain <code>Guarantee_timestamp</code> value.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/Guarantee_Timestamp.png loading=lazy alt=Guarantee_Timestamp></p><h3 id=service_timestamp><code>Service_timestamp</code></h3><p><code>Service_timestamp</code> is a type of timestamp automatically generated and managed by query nodes in Milvus. It is used to indicate which DML operations are executed by query nodes.</p><p>The data managed by query nodes can be categorized into two types:</p><ul><li>Historical data (or also called batch data)</li><li>Incremental data (or also called streaming data).</li></ul><p>In Milvus, you need to load the data before conducting a search or query. Therefore, batch data in a collection are loaded by query node before a search or query request is made. However, streaming data are inserted into or deleted from Milvus on the fly, which requires the query node to keep a timeline of the DML operations and the search or query requests. As a result, query nodes use <code>Service_timestamp</code> to keep such a timeline. <code>Service_timestamp</code> can be seen as <strong>the time point when certain data is visible</strong> as query nodes can ensure that all DML operations before <code>Service_timestamp</code> are completed.</p><p>When there is an incoming search or query request, a query node compares the values of <code>Service_timestamp</code> and <code>Guarantee_timestamp</code>.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/Service_Timestamp.png loading=lazy alt=Service_Timestamp></p><h4 id=scenario-1-service_timestamp--guarantee_timestamp>Scenario 1: <code>Service_timestamp</code> >= <code>Guarantee_timestamp</code></h4><p>As shown in the figure 1, the value of <code>Guarantee_timestamp</code> is set as <code>2021-08-26T18:15:00</code>. When the value of <code>Service_timestamp</code> is grown to <code>2021-08-26T18:15:01</code>, this means that all DML operations before this point in time are executed and completed by the query node, including those DML operations before the time indicated by <code>Guarantee_timestamp</code>. As a result, the search or query request can be executed immediately.</p><h4 id=scenario-2-service_timestamp--guarantee_timestamp>Scenario 2: <code>Service_timestamp</code> &lt; <code>Guarantee_timestamp</code></h4><p>As shown in the figure 2, the value of <code>Guarantee_timestamp</code> is set as <code>2021-08-26T18:15:00</code>, and the current value of <code>Service_timestamp</code> is only <code>2021-08-26T18:14:55</code>. This means that only DML operations before <code>2021-08-26T18:14:55</code> are executed and completed, leaving part of the DML operations after this time point but before the <code>Guarantee_timestamp</code> unfinished. If the search or query is executed at this point, some of the data required are invisible and unavailable yet, seriously affecting the accuracy of the search or query results. Therefore, the query node needs to put off the search or query request until the DML operations before <code>guarantee_timestamp</code> are completed (i.e. when <code>Service_timestamp</code> >= <code>Guarantee_timestamp</code>).</p><h3 id=graceful_time><code>Graceful_time</code></h3><p>Technically speaking, <code>Graceful_time</code> is not a timestamp, but rather a time period (e.g. 100ms). However, <code>Graceful_time</code> is worth mentioning because it is strongly related to <code>Guarantee_timestamp</code> and <code>Service_timestamp</code>. <code>Graceful_time</code> is a configurable parameter in the Milvus configuration file. It is used to indicate <strong>the period of time that can be tolerated before certain data become visible</strong>. In short, uncompleted DML operations during <code>Graceful_time</code> can be tolerated.</p><p><img src=https://milvus.io/docs/v2.6.x/assets/Graceful_Time.png loading=lazy alt=Graceful_Time></p><h4 id=scenario-1-service_timestamp--graceful_time--guarantee_timestamp>Scenario 1: <code>Service_timestamp</code> + <code>Graceful_time</code> >= <code>Guarantee_timestamp</code></h4><p>The value of <code>Guarantee_timestamp</code> is set as <code>2021-08-26T18:15:01</code>, and <code>Graceful_time</code> as <code>2s</code>. The value of <code>Service_timestamp</code> is grown to <code>2021-08-26T18:15:00</code>. Though the value of <code>Service_timestamp</code> is still smaller than that of <code>Guarantee_timestamp</code> and not all DML operations before <code>2021-08-26T18:15:01</code> are completed, a period of 2 seconds of data invisibility is tolerated as indicated by the value of <code>Graceful_time</code>. Therefore, the incoming search or query request can be executed immediately.</p><h4 id=scenario-2-service_timestamp--graceful_time--guarantee_timestamp>Scenario 2: <code>Service_timestamp</code> + <code>Graceful_time</code> &lt; <code>Guarantee_timestamp</code></h4><p>The value of <code>Guarantee_timestamp</code> is set as <code>2021-08-26T18:15:01</code>, and <code>Graceful_time</code> as <code>2s</code>. The current value of <code>Service_timestamp</code> is only <code>2021-08-26T18:14:54</code>. This means that the expected DML operations are not completed yet and even given the 2 second of graceful time, data invisibility is still intolerable. Therefore, the query node needs to put off the search or query request until certain DML requests are completed (i.e. when <code>Service_timestamp</code> + <code>Graceful_time</code> >= <code>Guarantee_timestamp</code>).</p><h2 id=metrics>Metrics</h2><p>Similarity metrics are used to measure similarities among vectors. Choosing an appropriate distance metric helps improve classification and clustering performance significantly.</p><p>Currently, Milvus supports these types of similarity Metrics: Euclidean distance (<code>L2</code>), Inner Product (<code>IP</code>), Cosine Similarity (<code>COSINE</code>), <code>JACCARD</code>, <code>HAMMING</code>, and <code>BM25</code> (specifically designed for full text search on sparse vectors).</p><div class=table-wrapper><table><thead><tr><th>Field Type</th><th>Dimension Range</th><th>Supported Metric Types</th><th>Default Metric Type</th></tr></thead><tbody><tr><td><code>FLOAT_VECTOR</code></td><td>2-32,768</td><td><code>COSINE</code>, <code>L2</code>, <code>IP</code></td><td><code>COSINE</code></td></tr><tr><td><code>FLOAT16_VECTOR</code></td><td>2-32,768</td><td><code>COSINE</code>, <code>L2</code>, <code>IP</code></td><td><code>COSINE</code></td></tr><tr><td><code>BFLOAT16_VECTOR</code></td><td>2-32,768</td><td><code>COSINE</code>, <code>L2</code>, <code>IP</code></td><td><code>COSINE</code></td></tr><tr><td><code>INT8_VECTOR</code></td><td>2-32,768</td><td><code>COSINE</code>, <code>L2</code>, <code>IP</code></td><td><code>COSINE</code></td></tr><tr><td><code>SPARSE\_FLOAT\_VECTOR</code></td><td>No need to specify the dimension.</td><td><code>IP</code>, <code>BM25</code> (used only for full text search)</td><td><code>IP</code></td></tr><tr><td><code>BINARY_VECTOR</code></td><td>8-32,768*8</td><td><code>HAMMING</code>, <code>JACCARD</code>, <code>MHJACCARD</code></td><td><code>HAMMING</code></td></tr></tbody></table></div><h2 id=index>Index</h2><p>HNSWï¼ˆHierarchical Navigable Small Worldï¼‰å’ŒIVF-Flatï¼ˆInverted File with Flat Indexï¼‰æ˜¯ä¸¤ç§å¹¿æ³›åº”ç”¨äºå‘é‡æ•°æ®åº“çš„é«˜æ•ˆè¿‘ä¼¼æœ€è¿‘é‚»ï¼ˆANNï¼‰æœç´¢ç®—æ³•ï¼Œå®ƒä»¬åœ¨å¤„ç†å¤§è§„æ¨¡é«˜ç»´å‘é‡æ•°æ®æ—¶å„æœ‰ä¼˜åŠ£ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€æ€§èƒ½å¯¹æ¯”åŠé€‚ç”¨åœºæ™¯ä¸‰æ–¹é¢è§£æï¼š</p><hr><h3 id=ä¸€æ ¸å¿ƒåŸç†ä¸æŠ€æœ¯ç‰¹ç‚¹>ä¸€ã€æ ¸å¿ƒåŸç†ä¸æŠ€æœ¯ç‰¹ç‚¹</h3><h4 id=1-hnswåˆ†å±‚å¯¼èˆªå°ä¸–ç•Œå›¾>1. <strong>HNSWï¼šåˆ†å±‚å¯¼èˆªå°ä¸–ç•Œå›¾</strong></h4><ul><li><strong>æ ¸å¿ƒæ€æƒ³</strong>
ç»“åˆ<strong>è·³è¡¨ï¼ˆSkip Listï¼‰â€‹</strong>â€‹ å’Œ â€‹<strong>å¯å¯¼èˆªå°ä¸–ç•Œå›¾ï¼ˆNSWï¼‰â€‹</strong>ï¼Œæ„å»ºå¤šå±‚å›¾ç»“æ„å®ç°é«˜æ•ˆæœç´¢ï¼š<ul><li><strong>åˆ†å±‚è®¾è®¡</strong>ï¼šåº•å±‚ï¼ˆLayer 0ï¼‰åŒ…å«æ‰€æœ‰èŠ‚ç‚¹ï¼Œå±‚çº§è¶Šé«˜èŠ‚ç‚¹è¶Šç¨€ç–ï¼Œå½¢æˆâ€œé«˜é€Ÿå…¬è·¯å¼â€å¿«é€Ÿè·¯å¾„ã€‚</li><li><strong>è´ªå¿ƒè·¯ç”±</strong>ï¼šä»é¡¶å±‚å…¥å£ç‚¹å¼€å§‹ï¼Œæ¯å±‚é€‰æ‹©è·ç¦»æŸ¥è¯¢å‘é‡æœ€è¿‘çš„é‚»å±…èŠ‚ç‚¹ï¼Œé€å±‚å‘ä¸‹ç²¾ç»†åŒ–æœç´¢ã€‚</li><li><strong>åŠ¨æ€æ›´æ–°</strong>ï¼šæ–°æ•°æ®æ’å…¥æ—¶éšæœºåˆ†é…å±‚çº§ï¼Œä»…éœ€å±€éƒ¨è°ƒæ•´è¿æ¥è¾¹ï¼ˆå‚æ•° <code>M</code> æ§åˆ¶æ¯å±‚é‚»å±…æ•°ï¼‰ã€‚</li></ul></li><li><strong>å…³é”®å‚æ•°</strong><ul><li><code>M</code>ï¼šæ¯å±‚é‚»å±…æ•°ï¼Œå½±å“ç´¢å¼•ç²¾åº¦å’Œå†…å­˜å ç”¨ï¼ˆå€¼è¶Šå¤§ç²¾åº¦è¶Šé«˜ï¼Œå†…å­˜æ¶ˆè€—è¶Šå¤§ï¼‰ã€‚</li><li><code>efConstruction</code>ï¼šæ„å»ºç´¢å¼•æ—¶çš„å€™é€‰é˜Ÿåˆ—é•¿åº¦ï¼Œå†³å®šç´¢å¼•è´¨é‡ã€‚</li><li><code>efSearch</code>ï¼šæœç´¢æ—¶çš„å€™é€‰é˜Ÿåˆ—é•¿åº¦ï¼Œç›´æ¥å½±å“å¬å›ç‡ä¸å»¶è¿Ÿã€‚</li></ul></li></ul><h4 id=2-ivf-flatå€’æ’æ–‡ä»¶æš´åŠ›æœç´¢>2. <strong>IVF-Flatï¼šå€’æ’æ–‡ä»¶+æš´åŠ›æœç´¢</strong></h4><ul><li><strong>æ ¸å¿ƒæ€æƒ³</strong>
é€šè¿‡èšç±»é¢„åˆ’åˆ†ç©ºé—´ï¼Œç¼©å°æœç´¢èŒƒå›´ï¼š<ul><li><strong>ç©ºé—´åˆ†åŒº</strong>ï¼šç”¨k-meanså°†å‘é‡ç©ºé—´åˆ’åˆ†ä¸º <code>nlist</code> ä¸ªèšç±»ï¼ˆç°‡ï¼‰ï¼Œæ¯ä¸ªç°‡å­˜å‚¨å…¶è´¨å¿ƒå’Œæˆå‘˜å‘é‡ã€‚</li><li><strong>å€’æ’ç´¢å¼•</strong>ï¼šå»ºç«‹è´¨å¿ƒâ†’å‘é‡çš„æ˜ å°„è¡¨ï¼Œæœç´¢æ—¶ä»…è®¡ç®—æŸ¥è¯¢å‘é‡ä¸æœ€è¿‘è´¨å¿ƒå¯¹åº”ç°‡å†…æ‰€æœ‰å‘é‡çš„è·ç¦»ï¼ˆâ€œFlatâ€å³æŒ‡æ— å‹ç¼©çš„æš´åŠ›è®¡ç®—ï¼‰ã€‚</li><li><strong>è¾¹ç•Œä¼˜åŒ–</strong>ï¼šé€šè¿‡å‚æ•° <code>probes</code> æ§åˆ¶æœç´¢çš„ç°‡æ•°é‡ï¼ˆå¦‚ <code>probes=5</code> è¡¨ç¤ºæœç´¢æœ€è¿‘çš„5ä¸ªç°‡ï¼‰ï¼Œå¹³è¡¡é€Ÿåº¦ä¸å¬å›ç‡ã€‚</li></ul></li><li><strong>å…³é”®å‚æ•°</strong><ul><li><code>nlist</code>ï¼šèšç±»æ•°é‡ï¼Œå½±å“ç´¢å¼•æ„å»ºé€Ÿåº¦å’Œæœç´¢ç²¾åº¦ï¼ˆå€¼è¶Šå¤§ç²¾åº¦è¶Šé«˜ï¼Œä½†æ„å»ºæ›´æ…¢ï¼‰ã€‚</li><li><code>probes</code>ï¼šæœç´¢çš„ç°‡æ•°é‡ï¼Œå€¼è¶Šå¤§å¬å›ç‡è¶Šé«˜ï¼Œä½†å»¶è¿Ÿå¢åŠ ã€‚</li></ul></li></ul><hr><h3 id=äºŒæ€§èƒ½å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯>äºŒã€æ€§èƒ½å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯</h3><div class=table-wrapper><table><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>HNSW</strong></th><th><strong>IVF-Flat</strong></th></tr></thead><tbody><tr><td><strong>æœç´¢é€Ÿåº¦</strong></td><td>âš¡ï¸ <strong>æå¿«</strong>ï¼ˆå¯¹æ•°å¤æ‚åº¦ O(log N)ï¼‰</td><td>âš¡ å¿«ï¼ˆä»…æœç´¢éƒ¨åˆ†ç°‡ï¼Œä½†ä»éœ€éå†ç°‡å†…æ‰€æœ‰å‘é‡ï¼‰</td></tr><tr><td><strong>ç´¢å¼•æ„å»ºæ—¶é—´</strong></td><td>â³ æ…¢ï¼ˆéœ€æ„å»ºå¤šå±‚å›¾ï¼‰</td><td>â±ï¸ <strong>æå¿«</strong>ï¼ˆä»…éœ€ä¸€æ¬¡èšç±»ï¼‰</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>ğŸ§  é«˜ï¼ˆå­˜å‚¨å¤šå±‚å›¾ç»“æ„ï¼‰</td><td>ğŸ’¾ ä½ï¼ˆä»…å­˜å‚¨åŸå§‹å‘é‡+è´¨å¿ƒæ˜ å°„ï¼‰</td></tr><tr><td><strong>ç²¾åº¦/å¬å›ç‡</strong></td><td>âœ… <strong>é«˜</strong>ï¼ˆå°¤å…¶é€‚åˆé«˜ç»´æ•°æ®ï¼‰</td><td>âš–ï¸ ä¸­ç­‰ï¼ˆä¾èµ–<code>probes</code>å‚æ•°ï¼‰</td></tr><tr><td><strong>åŠ¨æ€æ›´æ–°</strong></td><td>âœ… æ”¯æŒå®æ—¶æ’å…¥/åˆ é™¤</td><td>âŒ éœ€å®šæœŸé‡å»ºç´¢å¼•ï¼ˆé¢‘ç¹æ›´æ–°å¯¼è‡´ç²¾åº¦ä¸‹é™ï¼‰</td></tr><tr><td><strong>é€‚ç”¨æ•°æ®è§„æ¨¡</strong></td><td>ç™¾ä¸‡~åäº¿çº§å‘é‡</td><td>åƒ~ç™¾ä¸‡çº§å‘é‡</td></tr></tbody></table></div><hr><h3 id=ä¸‰å…¸å‹åº”ç”¨åœºæ™¯é€‰æ‹©å»ºè®®>ä¸‰ã€å…¸å‹åº”ç”¨åœºæ™¯é€‰æ‹©å»ºè®®</h3><ol><li><strong>ä¼˜å…ˆé€‰æ‹© HNSW çš„åœºæ™¯</strong><ul><li><strong>é«˜ç²¾åº¦éœ€æ±‚</strong>ï¼šå¦‚RAGç³»ç»Ÿçš„çŸ¥è¯†åº“æ£€ç´¢ã€æ¨èç³»ç»Ÿçš„å®æ—¶å¬å›ã€‚</li><li><strong>åŠ¨æ€æ•°æ®ç¯å¢ƒ</strong>ï¼šéœ€é¢‘ç¹å¢åˆ å‘é‡ï¼ˆå¦‚ç”¨æˆ·ç”»åƒå®æ—¶æ›´æ–°ï¼‰ã€‚</li><li><strong>èµ„æºå……è¶³</strong>ï¼šå¯æ¥å—è¾ƒé«˜å†…å­˜æ¶ˆè€—å’Œè¾ƒæ…¢çš„ç´¢å¼•æ„å»ºï¼ˆå¦‚äº‘æœåŠ¡å™¨éƒ¨ç½²ï¼‰ã€‚</li></ul></li><li><strong>ä¼˜å…ˆé€‰æ‹© IVF-Flat çš„åœºæ™¯</strong><ul><li><strong>ä¸­å°è§„æ¨¡æ•°æ®</strong>ï¼ˆ&lt;100ä¸‡å‘é‡ï¼‰ä¸”éœ€ä½æˆæœ¬éƒ¨ç½²ã€‚</li><li><strong>é™æ€æ•°æ®é›†</strong>ï¼šæ•°æ®æ›´æ–°é¢‘ç‡ä½ï¼ˆå¦‚å†å²æ¡£æ¡ˆæ£€ç´¢ï¼‰ã€‚</li><li><strong>é€Ÿåº¦ä¸å†…å­˜æ•æ„Ÿ</strong>ï¼šè¾¹ç¼˜è®¾å¤‡æˆ–å†…å­˜å—é™ç¯å¢ƒã€‚</li></ul></li></ol><hr><h3 id=å››å®é™…æ¡ˆä¾‹è¯´æ˜>å››ã€å®é™…æ¡ˆä¾‹è¯´æ˜</h3><ul><li><strong>HNSW åœ¨ RAG ç³»ç»Ÿä¸­çš„åº”ç”¨</strong>
Weaviate ä½¿ç”¨ HNSW ä½œä¸ºé»˜è®¤ç´¢å¼•ï¼Œåœ¨åƒä¸‡çº§æ–‡æ¡£åº“ä¸­å®ç°æ¯«ç§’çº§è¯­ä¹‰æœç´¢ã€‚ç”¨æˆ·æé—®å‘é‡åŒ–åï¼Œé€šè¿‡åˆ†å±‚å¯¼èˆªå¿«é€Ÿå®šä½ç›¸å…³æ–‡æœ¬å—ï¼Œæ˜¾è‘—æå‡å¤§æ¨¡å‹å›ç­”è´¨é‡ã€‚</li><li><strong>IVF-Flat åœ¨å›¾åƒæ£€ç´¢ä¸­çš„å®è·µ</strong>
ç™¾ä¸‡çº§å•†å“å›¾ç‰‡åº“ä½¿ç”¨ IVF-Flat ç´¢å¼•ï¼Œä»¥ <code>nlist=1000</code> åˆ’åˆ†èšç±»ã€‚ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡åï¼Œä»…éœ€æ‰«ææœ€è¿‘3ä¸ªç°‡ï¼ˆ<code>probes=3</code>ï¼‰ï¼Œå³å¯åœ¨50mså†…è¿”å›ç›¸ä¼¼å•†å“ï¼Œå…¼é¡¾æ•ˆç‡ä¸æˆæœ¬ã€‚</li></ul><hr><h3 id=äº”è¿›é˜¶è°ƒä¼˜ç­–ç•¥>äº”ã€è¿›é˜¶è°ƒä¼˜ç­–ç•¥</h3><ul><li><strong>HNSW å‚æ•°ä¼˜åŒ–</strong>ï¼š
å¤§æ•°æ®é›†å»ºè®® <code>M=16~32</code>, <code>efConstruction=200~400</code>ï¼Œæœç´¢æ—¶ <code>efSearch=50~100</code> å¹³è¡¡é€Ÿåº¦ä¸å¬å›ã€‚</li><li><strong>IVF-Flat å‚æ•°ä¼˜åŒ–</strong>ï¼š
è‹¥å¬å›ä¸è¶³ï¼Œé€æ­¥å¢åŠ  <code>probes</code>ï¼ˆä¸è¶…è¿‡ <code>nlist</code> çš„10%ï¼‰ã€‚</li><li><strong>æ··åˆç´¢å¼•æ–¹æ¡ˆ</strong>ï¼ˆå¦‚ Milvusï¼‰ï¼š
å…ˆç”¨ IVF ç²—ç­›ï¼ˆ<code>probes=5</code>ï¼‰å‡å°‘å€™é€‰é›†ï¼Œå†ç”¨ HNSW ç²¾æœï¼Œç»¼åˆäºŒè€…ä¼˜åŠ¿ã€‚</li></ul><blockquote><p>ğŸ’ <strong>æ€»ç»“</strong>ï¼šHNSW ä»¥å†…å­˜æ¢é€Ÿåº¦ä¸ç²¾åº¦ï¼Œé€‚åˆå¤§è§„æ¨¡åŠ¨æ€æ•°æ®ï¼›IVF-Flat ä»¥ç²¾åº¦æ¢å†…å­˜ä¸æ„å»ºé€Ÿåº¦ï¼Œé€‚åˆä¸­å°è§„æ¨¡é™æ€æ•°æ®ã€‚å®é™…é€‰å‹éœ€ç»“åˆæ•°æ®è§„æ¨¡ã€æ›´æ–°é¢‘ç‡ã€ç¡¬ä»¶èµ„æºç»¼åˆå†³ç­–ã€‚</p></blockquote><h2 id=fastjson>FastJson</h2><p>Milvus ä¾èµ– FastJSON ä½†ä¸ä¼šè‡ªåŠ¨å¯¼å…¥è¯¥ä¾èµ–ï¼Œè¿™ä¸»è¦æºäºå…¶ä¾èµ–ç®¡ç†ç­–ç•¥ã€ç‰ˆæœ¬å…¼å®¹æ€§è®¾è®¡åŠ Java ç”Ÿæ€çš„é€šç”¨è§„èŒƒã€‚ä»¥ä¸‹æ˜¯å…·ä½“åŸå› åŠæŠ€æœ¯è§£æï¼š</p><hr><h3 id=-1-ä¾èµ–ä½œç”¨åŸŸscopeè®¾è®¡>ğŸ”§ 1. <strong>ä¾èµ–ä½œç”¨åŸŸï¼ˆScopeï¼‰è®¾è®¡</strong></h3><ul><li><p><strong>æ˜¾å¼ä¾èµ–åŸåˆ™</strong>
Milvus SDK æˆ–ç›¸å…³æ¨¡å—ï¼ˆå¦‚ <code>spring-ai-milvus-store</code>ï¼‰åœ¨è®¾è®¡æ—¶é€šå¸¸å°† FastJSON æ ‡è®°ä¸º â€‹**<code>provided</code> ä½œç”¨åŸŸ<strong>â€‹ï¼ˆMavenï¼‰æˆ– â€‹</strong><code>compileOnly</code>**â€‹ï¼ˆGradleï¼‰ã€‚è¿™æ„å‘³ç€ï¼š</p><ul><li>FastJSON æ˜¯<strong>è¿è¡Œæ—¶å¿…éœ€</strong>çš„ï¼Œä½† SDK <strong>ä¸å¼ºåˆ¶ç»‘å®šå…¶ç‰ˆæœ¬</strong>ã€‚</li><li>ç”¨æˆ·éœ€æ ¹æ®è‡ªèº«é¡¹ç›®ç¯å¢ƒ<strong>æ˜¾å¼å¼•å…¥ FastJSON</strong>ï¼Œä»¥é¿å…ç‰ˆæœ¬å†²çªã€‚</li></ul><pre tabindex=0><code>&lt;!-- Maven ç¤ºä¾‹ï¼šMilvus SDK å¯èƒ½éšå«çš„ä¾èµ–å£°æ˜ --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;
    &lt;version&gt;[ç”¨æˆ·è‡ªå®š]&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt; &lt;!-- ä¸è‡ªåŠ¨ä¼ é€’ä¾èµ– --&gt;
&lt;/dependency&gt;
</code></pre></li><li><p><strong>é¿å…ä¾èµ–åœ°ç‹±</strong>
FastJSON çš„ç‰ˆæœ¬æ›´æ–°é¢‘ç¹ä¸”å­˜åœ¨å®‰å…¨é£é™©ï¼ˆå¦‚ååºåˆ—åŒ–æ¼æ´ï¼‰ã€‚è‹¥ Milvus å¼ºåˆ¶ç»‘å®šç‰¹å®šç‰ˆæœ¬ï¼Œå¯èƒ½å¯¼è‡´ï¼š</p><ul><li>ç”¨æˆ·é¡¹ç›®ä¸­çš„å…¶ä»–åº“å› ç‰ˆæœ¬å†²çªè€Œå¤±æ•ˆã€‚</li><li>å®‰å…¨æ¼æ´æ— æ³•é€šè¿‡å‡çº§ FastJSON ç‹¬ç«‹ä¿®å¤ã€‚</li></ul></li></ul><hr><h3 id=-2-æ¨¡å—åŒ–ä¸è½»é‡åŒ–è€ƒé‡>âš™ï¸ 2. <strong>æ¨¡å—åŒ–ä¸è½»é‡åŒ–è€ƒé‡</strong></h3><ul><li><strong>å‡å°‘ SDK ä½“ç§¯</strong>
Milvus SDK æ ¸å¿ƒåŠŸèƒ½èšç„¦äºå‘é‡æ“ä½œå’Œæ•°æ®åº“è¿æ¥ï¼Œè‹¥æ‰“åŒ… FastJSON ä¼šå¢å¤§åˆ†å‘ä½“ç§¯ã€‚ç”¨æˆ·å¯é€‰æ‹©æ›´å°çš„æ›¿ä»£åº“ï¼ˆå¦‚ Jacksonï¼‰æˆ–æŒ‰éœ€å¼•å…¥ FastJSONã€‚</li><li><strong>çµæ´»é€‚é… JSON åº“</strong>
éƒ¨åˆ†ä¼ä¸šå·²æ ‡å‡†åŒ– JSON åº“ï¼ˆå¦‚ Spring Boot é»˜è®¤ä½¿ç”¨ Jacksonï¼‰ã€‚Milvus ä¸å¼ºåˆ¶ä¾èµ– FastJSON å…è®¸ç”¨æˆ·æ— ç¼é›†æˆç°æœ‰æŠ€æœ¯æ ˆã€‚</li></ul><hr><h3 id=-3-å®‰å…¨ä¸ç‰ˆæœ¬å…¼å®¹æ€§>ğŸ›¡ï¸ 3. <strong>å®‰å…¨ä¸ç‰ˆæœ¬å…¼å®¹æ€§</strong></h3><ul><li></li></ul><p>è§„é¿é«˜å±ç‰ˆæœ¬</p><p>FastJSON æ—§ç‰ˆæœ¬ï¼ˆå¦‚ â‰¤1.2.68ï¼‰å­˜åœ¨ä¸¥é‡æ¼æ´ï¼ˆå¦‚ CVE-2017-18349ï¼‰ã€‚Milvus é€šè¿‡</p><p>ä¸è‡ªåŠ¨å¼•å…¥</p><p>çš„æ–¹å¼ï¼š</p><ul><li><p>ä¿ƒä½¿ç”¨æˆ·ä¸»åŠ¨é€‰æ‹©<strong>å®‰å…¨ç‰ˆæœ¬</strong>ï¼ˆå¦‚ â‰¥2.0.47ï¼‰ã€‚</p></li><li><p>é¿å…å›  SDK å†…ç½®æ—§ç‰ˆæœ¬å¯¼è‡´å®‰å…¨é£é™©ã€‚</p></li><li><p><strong>ç‰ˆæœ¬å…¼å®¹æ€§æŒ‘æˆ˜</strong>
Milvus çš„ JSON åºåˆ—åŒ–é€»è¾‘å¯èƒ½ä¾èµ– FastJSON ç‰¹å®š APIï¼ˆå¦‚ <code>JSONWriter.Feature</code>ï¼‰ã€‚è‹¥è‡ªåŠ¨ç»‘å®šç‰ˆæœ¬ï¼Œç”¨æˆ·å‡çº§ SDK æ—¶å¯èƒ½å›  API å˜æ›´è€Œå´©æºƒã€‚</p></li></ul><hr><h3 id=-4-æ„å»ºå·¥å…·çš„é™åˆ¶>ğŸ”„ 4. <strong>æ„å»ºå·¥å…·çš„é™åˆ¶</strong></h3><ul><li></li></ul><p>Maven/Gradle çš„ä¾èµ–ä¼ é€’æœºåˆ¶</p><p>å³ä½¿ Milvus SDK å£°æ˜äº† FastJSON ä¾èµ–ï¼Œè‹¥å…¶ä½œç”¨åŸŸä¸º</p><pre tabindex=0><code>provided
</code></pre><p>æˆ–</p><pre tabindex=0><code>compileOnly
</code></pre><p>ï¼Œæ„å»ºå·¥å…·</p><p>ä¸ä¼šå°†å…¶æ‰“åŒ…åˆ°æœ€ç»ˆåº”ç”¨</p><p>ä¸­ã€‚ç”¨æˆ·éœ€åœ¨é¡¹ç›®ä¸­æ˜¾å¼æ·»åŠ ï¼š</p><pre tabindex=0><code>// Gradle ç¤ºä¾‹
implementation &#39;com.alibaba:fastjson:2.0.47&#39;
</code></pre><ul><li><strong>æœ¬åœ°ä»“åº“ç¼“å­˜é—®é¢˜</strong>
è‹¥ç”¨æˆ·æœ¬åœ° Maven ä»“åº“ï¼ˆ<code>~/.m2/repository</code>ï¼‰ç¼ºå¤± FastJSONï¼Œå³ä½¿ SDK å£°æ˜ä¾èµ–ï¼Œæ„å»ºæ—¶ä»ä¼šæŠ¥é”™ <code>NoClassDefFoundError</code>ã€‚</li></ul><hr><h3 id=-æ€»ç»“milvus-çš„è®¾è®¡é€»è¾‘ä¸ç”¨æˆ·åº”å¯¹>ğŸ’ æ€»ç»“ï¼šMilvus çš„è®¾è®¡é€»è¾‘ä¸ç”¨æˆ·åº”å¯¹</h3><p>Milvus ä¸è‡ªåŠ¨å¯¼å…¥ FastJSON æ˜¯<strong>æƒè¡¡çµæ´»æ€§ã€å®‰å…¨æ€§å’Œå…¼å®¹æ€§</strong>çš„ç»“æœã€‚å¼€å‘è€…éœ€ï¼š</p><ol><li><strong>æ˜¾å¼æ·»åŠ ä¾èµ–</strong>ï¼šåœ¨ <code>pom.xml</code> æˆ– <code>build.gradle</code> ä¸­å¼•å…¥ FastJSONã€‚</li><li><strong>é”å®šå®‰å…¨ç‰ˆæœ¬</strong>ï¼šä¼˜å…ˆä½¿ç”¨ â‰¥2.0.47 çš„ FastJSON2ã€‚</li><li><strong>éªŒè¯ä¾èµ–æ ‘</strong>ï¼šé€šè¿‡ <code>mvn dependency:tree</code> æ£€æŸ¥ç‰ˆæœ¬å†²çªã€‚</li><li><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼šè‹¥éœ€æ¢ç”¨ Jacksonï¼Œéœ€é‡å†™ Milvus çš„åºåˆ—åŒ–é€‚é…å±‚ï¼ˆéœ€ä¿®æ”¹æºç ï¼‰ã€‚</li></ol><pre tabindex=0><code>graph TD
    A[Milvus ä¾èµ– FastJSON] --&gt; B{æ˜¯å¦è‡ªåŠ¨å¯¼å…¥ï¼Ÿ}
    B --&gt;|å¦| C[åŸå› 1ï¼šä½œç”¨åŸŸè®¾ä¸º provided]
    B --&gt;|å¦| D[åŸå› 2ï¼šé¿å…ç‰ˆæœ¬å†²çª]
    B --&gt;|å¦| E[åŸå› 3ï¼šå®‰å…¨é£é™©è§„é¿]
    C --&gt; F[ç”¨æˆ·éœ€æ˜¾å¼æ·»åŠ ä¾èµ–]
    D --&gt; F
    E --&gt; F
    F --&gt; G[é¡¹ç›®æ„å»ºæˆåŠŸ]
</code></pre><h2 id=æ ‡é‡é»˜è®¤ç´¢å¼•>æ ‡é‡é»˜è®¤ç´¢å¼•</h2><p>åœ¨ Milvus ä¸­ï¼Œæ ‡é‡å­—æ®µï¼ˆéå‘é‡å­—æ®µï¼‰çš„<strong>é»˜è®¤ç´¢å¼•ç­–ç•¥æ˜¯è‡ªåŠ¨ç´¢å¼•ï¼ˆAuto Indexï¼‰</strong>ï¼Œç³»ç»Ÿä¼šæ ¹æ®æ ‡é‡å­—æ®µçš„æ•°æ®ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„ç´¢å¼•ç±»å‹ï¼Œæ— éœ€ç”¨æˆ·æ‰‹åŠ¨æŒ‡å®šã€‚è¿™ä¸€ç­–ç•¥æ—¨åœ¨ç®€åŒ–é…ç½®å¹¶é€‚é…å¸¸è§æŸ¥è¯¢åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§„åˆ™å’Œç»†èŠ‚ï¼š</p><hr><h3 id=-ä¸€é»˜è®¤ç´¢å¼•ç­–ç•¥è‡ªåŠ¨ç´¢å¼•auto-index>ğŸ“Œ ä¸€ã€é»˜è®¤ç´¢å¼•ç­–ç•¥ï¼šè‡ªåŠ¨ç´¢å¼•ï¼ˆAuto Indexï¼‰</h3><ol><li><p><strong>è§¦å‘æ¡ä»¶</strong>
å½“åˆ›å»ºç´¢å¼•æ—¶<strong>ä¸æŒ‡å®š <code>index_type</code> å‚æ•°</strong>æˆ–å°†å…¶ç•™ç©ºï¼ŒMilvus ä¼šå¯ç”¨è‡ªåŠ¨ç´¢å¼•æœºåˆ¶ã€‚</p></li><li><p><strong>æ•°æ®ç±»å‹ä¸ç´¢å¼•ç±»å‹çš„æ˜ å°„</strong>
Milvus æ ¹æ®å­—æ®µæ•°æ®ç±»å‹è‡ªåŠ¨é€‰æ‹©ç´¢å¼•ç®—æ³•ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p><div class=table-wrapper><table><thead><tr><th><strong>æ ‡é‡å­—æ®µæ•°æ®ç±»å‹</strong></th><th><strong>è‡ªåŠ¨é€‰æ‹©çš„ç´¢å¼•ç±»å‹</strong></th><th><strong>é€‚ç”¨åœºæ™¯</strong></th></tr></thead><tbody><tr><td><code>VARCHAR</code>ï¼ˆå­—ç¬¦ä¸²ï¼‰</td><td>å€’æ’ç´¢å¼•ï¼ˆInvertedï¼‰</td><td>ç­‰å€¼æŸ¥è¯¢ã€å‰ç¼€åŒ¹é…ã€èŒƒå›´æŸ¥è¯¢</td></tr><tr><td><code>INT8/16/32/64</code>ï¼ˆæ•´æ•°ç±»å‹ï¼‰</td><td>å€’æ’ç´¢å¼•ï¼ˆInvertedï¼‰</td><td>ç²¾ç¡®åŒ¹é…ã€èŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚ <code>id > 100</code>ï¼‰</td></tr><tr><td><code>FLOAT/DOUBLE</code>ï¼ˆæµ®ç‚¹æ•°ï¼‰</td><td>å€’æ’ç´¢å¼•ï¼ˆInvertedï¼‰</td><td>èŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚ <code>price BETWEEN 10.0 AND 50.0</code>ï¼‰</td></tr><tr><td><code>BOOL</code>ï¼ˆå¸ƒå°”å€¼ï¼‰</td><td>å€’æ’ç´¢å¼•ï¼ˆInvertedï¼‰</td><td>å¸ƒå°”æ¡ä»¶è¿‡æ»¤ï¼ˆå¦‚ <code>status = True</code>ï¼‰</td></tr><tr><td><code>ARRAY</code>ï¼ˆæ•°ç»„ï¼‰</td><td>å€’æ’ç´¢å¼•ï¼ˆInvertedï¼‰</td><td>æ•°ç»„å…ƒç´ çš„ç­‰å€¼æˆ–åŒ…å«æŸ¥è¯¢</td></tr></tbody></table></div><blockquote><p>ğŸ’¡ <strong>è¯´æ˜</strong>ï¼šå€’æ’ç´¢å¼•é€šè¿‡æ„å»ºâ€œæœ¯è¯­å­—å…¸+å€’æ’åˆ—è¡¨â€åŠ é€ŸæŸ¥è¯¢ï¼Œå°¤å…¶é€‚åˆç‚¹æŸ¥è¯¢å’ŒèŒƒå›´è¿‡æ»¤ï¼Œæ€§èƒ½æ¯”æš´åŠ›æœç´¢æå‡æ˜¾è‘—ï¼ˆå®éªŒæ˜¾ç¤ºç‚¹æŸ¥è¯¢å¿«30å€ï¼‰ã€‚</p></blockquote></li></ol><hr><h3 id=-äºŒæ³¨æ„äº‹é¡¹>âš ï¸ äºŒã€æ³¨æ„äº‹é¡¹</h3><ol><li><strong>ä¸æ”¯æŒçš„æ•°æ®ç±»å‹</strong>
<code>JSON</code> ç±»å‹<strong>æ— æ³•åˆ›å»ºæ ‡é‡ç´¢å¼•</strong>ï¼Œéœ€é€šè¿‡å…¶ä»–æ–¹å¼å¤„ç†ã€‚</li><li><strong>æ¯ä¸ªå­—æ®µä»…æ”¯æŒä¸€ä¸ªç´¢å¼•</strong>
è‹¥éœ€æ›´æ¢ç´¢å¼•ç±»å‹ï¼ˆå¦‚æ”¹ç”¨ <code>BITMAP</code> æˆ– <code>TRIE</code>ï¼‰ï¼Œéœ€å…ˆåˆ é™¤ç°æœ‰ç´¢å¼•ã€‚</li><li><strong>è‡ªåŠ¨ç´¢å¼•çš„å±€é™æ€§</strong><ul><li>è™½ç®€åŒ–é…ç½®ï¼Œä½†ç‰¹å®šåœºæ™¯éœ€æ‰‹åŠ¨ä¼˜åŒ–ï¼š<ul><li>ä½åŸºæ•°ï¼ˆCardinality &lt; 500ï¼‰å­—æ®µ â†’ æ”¹ç”¨ <code>BITMAP</code> ç´¢å¼•æå‡ç­‰å€¼æŸ¥è¯¢æ•ˆç‡ã€‚</li><li>å­—ç¬¦ä¸²å‰ç¼€æœç´¢ â†’ æ‰‹åŠ¨æŒ‡å®š <code>TRIE</code> ç´¢å¼•æ›´é«˜æ•ˆã€‚</li></ul></li><li>æµ®ç‚¹å­—æ®µä¸æ”¯æŒ <code>BITMAP</code> ç´¢å¼•ï¼ˆå› äºŒè¿›åˆ¶ä¸å…¼å®¹ï¼‰ã€‚</li></ul></li></ol><hr><h3 id=-ä¸‰æ€»ç»“>ğŸ’ ä¸‰ã€æ€»ç»“</h3><ul><li><strong>é»˜è®¤ç­–ç•¥</strong>ï¼š<code>Auto Index</code> â†’ æŒ‰æ•°æ®ç±»å‹è‡ªåŠ¨é€‰æ‹© <strong>å€’æ’ç´¢å¼•</strong>ã€‚</li><li><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼šé™ä½é…ç½®å¤æ‚åº¦ï¼Œé€‚é…å¤šæ•°åœºæ™¯ï¼ˆå°¤å…¶æ–‡æœ¬ã€æ•°å€¼çš„è¿‡æ»¤æŸ¥è¯¢ï¼‰ã€‚</li><li><strong>æ‰‹åŠ¨ä¼˜åŒ–åœºæ™¯</strong>ï¼šä½åŸºæ•°å­—æ®µã€å­—ç¬¦ä¸²å‰ç¼€åŒ¹é…ã€è¶…é«˜åŸºæ•°ï¼ˆ>500ï¼‰å­—æ®µéœ€è‡ªå®šä¹‰ç´¢å¼•ç±»å‹ã€‚</li></ul><p>å»ºè®®é€šè¿‡ <code>list_indexes()</code> éªŒè¯ç´¢å¼•åˆ›å»ºç»“æœï¼Œä¾‹å¦‚ï¼š</p><pre tabindex=0><code># æŸ¥çœ‹é›†åˆå…¨éƒ¨ç´¢å¼•
indexes = client.list_indexes(collection_name=&#34;your_collection&#34;)
print(indexes)  # è¾“å‡ºç¤ºä¾‹ï¼š[&#39;default_index&#39;]
</code></pre><h2 id=æ ‡é‡ç´¢å¼•>æ ‡é‡ç´¢å¼•</h2><p>Milvus ä¸ºæ ‡é‡å­—æ®µï¼ˆå¦‚æ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ç­‰éå‘é‡æ•°æ®ï¼‰æä¾›äº†å¤šç§ç´¢å¼•ç±»å‹ï¼Œç”¨äºåŠ é€Ÿæ ‡é‡è¿‡æ»¤å’ŒæŸ¥è¯¢æ“ä½œã€‚ä»¥ä¸‹æ˜¯å…¶æ”¯æŒçš„ <strong>5 ç§æ ‡é‡ç´¢å¼•æ–¹å¼</strong>åŠå…¶æ ¸å¿ƒç‰¹ç‚¹ä¸é€‚ç”¨åœºæ™¯ï¼š</p><hr><h3 id=-1-è‡ªåŠ¨ç´¢å¼•auto-index>ğŸ” 1. <strong>è‡ªåŠ¨ç´¢å¼•ï¼ˆAuto Indexï¼‰</strong></h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š
Milvus æ ¹æ®å­—æ®µæ•°æ®ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç´¢å¼•ç±»å‹ï¼Œæ— éœ€ç”¨æˆ·æŒ‡å®šï¼Œç®€åŒ–é…ç½®æµç¨‹ã€‚</p></li><li></li></ul><p>é€‚ç”¨åœºæ™¯</p><p>ï¼š</p><ul><li><p>é€šç”¨å‹å­—æ®µï¼ˆå¦‚æ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰ã€‚</p></li><li><p>å¿«é€ŸåŸå‹éªŒè¯æˆ–å¯¹ç´¢å¼•ç±»å‹æ— ç‰¹æ®Šè¦æ±‚çš„åœºæ™¯ã€‚</p></li><li><p><strong>æ•°æ®ç±»å‹æ”¯æŒ</strong>ï¼š
<code>INT8/16/32/64</code>ã€<code>FLOAT/DOUBLE</code>ã€<code>BOOL</code>ã€<code>VARCHAR</code>ã€<code>ARRAY</code>ã€‚</p></li></ul><hr><h3 id=-2-å€’æ’ç´¢å¼•inverted-index>ğŸ”¢ 2. <strong>å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰</strong></h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š
é€šè¿‡â€œæœ¯è¯­å­—å…¸+å€’æ’åˆ—è¡¨â€ç»“æ„ï¼Œé«˜æ•ˆæ”¯æŒç­‰å€¼æŸ¥è¯¢ï¼ˆ<code>category == 1</code>ï¼‰å’ŒèŒƒå›´æŸ¥è¯¢ï¼ˆ<code>price > 50.0</code>ï¼‰ã€‚</p></li><li></li></ul><p>é€‚ç”¨åœºæ™¯</p><p>ï¼š</p><ul><li><p>é«˜é¢‘è¿‡æ»¤å­—æ®µï¼ˆå¦‚åˆ†ç±»æ ‡ç­¾ã€ç”¨æˆ·è¯„åˆ†ï¼‰ã€‚</p></li><li><p>é«˜åŸºæ•°ï¼ˆä¸åŒå€¼æ•°é‡å¤šï¼‰æˆ–æ··åˆæŸ¥è¯¢éœ€æ±‚ã€‚</p></li><li><p><strong>æ•°æ®ç±»å‹æ”¯æŒ</strong>ï¼š
æ‰€æœ‰æ ‡é‡ç±»å‹ï¼ˆé™¤ <code>JSON</code> å¤–ï¼‰ï¼ŒåŒ…æ‹¬æ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼å’Œæ•°ç»„ã€‚</p></li></ul><hr><h3 id=-3-ä½å›¾ç´¢å¼•bitmap>ğŸ§© 3. <strong>ä½å›¾ç´¢å¼•ï¼ˆBitmapï¼‰</strong></h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š
ä¸ºæ¯ä¸ªå”¯ä¸€å€¼ç”ŸæˆäºŒè¿›åˆ¶ä½å›¾ï¼Œé€šè¿‡ä½è¿ç®—ï¼ˆå¦‚ <code>AND/OR</code>ï¼‰å¿«é€Ÿåˆå¹¶å¤šæ¡ä»¶æŸ¥è¯¢ã€‚</p></li><li></li></ul><p>é€‚ç”¨åœºæ™¯</p><p>ï¼š</p><ul><li><p><strong>ä½åŸºæ•°å­—æ®µ</strong>ï¼ˆå¦‚æ€§åˆ«ã€çŠ¶æ€æ ‡å¿—ï¼‰ï¼ŒåŸºæ•°å»ºè®® <strong>&lt; 500</strong>ã€‚</p></li><li><p>å¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ï¼ˆå¦‚ <code>status=True AND category="A"</code>ï¼‰ã€‚</p></li><li></li></ul><p>é™åˆ¶</p><p>ï¼š</p><ul><li>ä¸æ”¯æŒæµ®ç‚¹ç±»å‹ï¼ˆ<code>FLOAT/DOUBLE</code>ï¼‰å’Œ <code>JSON</code>ã€‚</li><li>é«˜åŸºæ•°å­—æ®µä¼šå¯¼è‡´å­˜å‚¨å¼€é”€æ¿€å¢ã€‚</li></ul><hr><h3 id=-4-å‰ç¼€æ ‘ç´¢å¼•trie>ğŸ”¤ 4. <strong>å‰ç¼€æ ‘ç´¢å¼•ï¼ˆTrieï¼‰</strong></h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š
åŸºäºæ ‘å½¢ç»“æ„ä¼˜åŒ–å­—ç¬¦ä¸²å‰ç¼€åŒ¹é…ï¼ˆå¦‚ <code>name LIKE "apple%"</code>ï¼‰ã€‚</p></li><li></li></ul><p>é€‚ç”¨åœºæ™¯</p><p>ï¼š</p><ul><li><p><code>VARCHAR</code> å­—æ®µçš„å‰ç¼€æœç´¢æˆ–ç²¾ç¡®åŒ¹é…ã€‚</p></li><li><p>æ–‡æœ¬æ ‡ç­¾ã€äº§å“åç§°ç­‰å­—ç¬¦ä¸²ç±»ç›®è¿‡æ»¤ã€‚</p></li><li><p><strong>é™åˆ¶</strong>ï¼š
ä¸æ”¯æŒæ•°å€¼èŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚ <code>price > 100</code>ï¼‰ã€‚</p></li></ul><hr><h3 id=-5-stl_>ğŸ“Š 5. <strong>STL_SORT ç´¢å¼•</strong></h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š
åˆ©ç”¨æ’åºç®—æ³•ä¼˜åŒ–æ•°å€¼å­—æ®µçš„èŒƒå›´æŸ¥è¯¢å’Œæ’åºæ“ä½œï¼ˆå¦‚ <code>ORDER BY timestamp</code>ï¼‰ã€‚</p></li><li></li></ul><p>é€‚ç”¨åœºæ™¯</p><p>ï¼š</p><ul><li><p>æ•°å€¼å­—æ®µçš„èŒƒå›´è¿‡æ»¤ï¼ˆå¦‚æ—¶é—´æˆ³ã€ä»·æ ¼åŒºé—´ï¼‰ã€‚</p></li><li><p>éœ€è¦æ’åºç»“æœçš„æŸ¥è¯¢ã€‚</p></li><li><p><strong>æ•°æ®ç±»å‹æ”¯æŒ</strong>ï¼š
<code>BOOL</code>ã€<code>INT8/16/32/64</code>ã€<code>FLOAT</code>ã€<code>DOUBLE</code>ã€‚</p></li></ul><hr><h3 id=-ç´¢å¼•é€‰æ‹©ä¸ä½¿ç”¨å»ºè®®>âš™ï¸ <strong>ç´¢å¼•é€‰æ‹©ä¸ä½¿ç”¨å»ºè®®</strong></h3><div class=table-wrapper><table><thead><tr><th><strong>ç´¢å¼•ç±»å‹</strong></th><th><strong>é€‚ç”¨æ•°æ®ç±»å‹</strong></th><th><strong>å…¸å‹æŸ¥è¯¢åœºæ™¯</strong></th><th><strong>åŸºæ•°è¦æ±‚</strong></th></tr></thead><tbody><tr><td>è‡ªåŠ¨ç´¢å¼•ï¼ˆAutoï¼‰</td><td>é€šç”¨ç±»å‹</td><td>å¿«é€Ÿéƒ¨ç½²ï¼Œæ— ç‰¹æ®Šä¼˜åŒ–éœ€æ±‚</td><td>ä»»æ„</td></tr><tr><td>å€’æ’ç´¢å¼•ï¼ˆInvertedï¼‰</td><td>æ‰€æœ‰æ ‡é‡ï¼ˆé™¤ <code>JSON</code>ï¼‰</td><td>ç­‰å€¼/èŒƒå›´æ··åˆæŸ¥è¯¢</td><td>é«˜/ä½åŸºæ•°å‡å¯</td></tr><tr><td>ä½å›¾ç´¢å¼•ï¼ˆBitmapï¼‰</td><td>æ•´æ•°ã€å¸ƒå°”ã€çŸ­å­—ç¬¦ä¸²</td><td>å¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢</td><td><strong>ä½åŸºæ•°ï¼ˆ&lt;500ï¼‰</strong></td></tr><tr><td>å‰ç¼€æ ‘ï¼ˆTrieï¼‰</td><td><code>VARCHAR</code></td><td>å‰ç¼€åŒ¹é…ï¼ˆ<code>LIKE "prefix%"</code>ï¼‰</td><td>ä¸­ä½åŸºæ•°</td></tr><tr><td>STL_SORT</td><td>æ•°å€¼ç±»å‹</td><td>èŒƒå›´æŸ¥è¯¢/æ’åº</td><td>ä»»æ„</td></tr></tbody></table></div><ul><li></li></ul><p>ç‰¹æ®Šé™åˆ¶</p><p>ï¼š</p><ul><li><p><code>JSON</code> ç±»å‹ä»…æ”¯æŒå€’æ’ç´¢å¼•ã€‚</p></li><li><p>ä½å›¾ç´¢å¼•ä¸æ”¯æŒæµ®ç‚¹æ•°ã€‚</p></li><li></li></ul><p>æ“ä½œå»ºè®®</p><p>ï¼š</p><ul><li>ä½¿ç”¨ <code>list_indexes()</code> éªŒè¯ç´¢å¼•æ˜¯å¦åˆ›å»ºæˆåŠŸã€‚</li><li>æ¯ä¸ªå­—æ®µä»…æ”¯æŒä¸€ä¸ªç´¢å¼•ï¼Œæ›´æ¢ç±»å‹éœ€å…ˆåˆ é™¤æ—§ç´¢å¼•ã€‚</li></ul><hr><h3 id=-æ€»ç»“>ğŸ’ <strong>æ€»ç»“</strong></h3><p>Milvus çš„æ ‡é‡ç´¢å¼•ç­–ç•¥è¦†ç›–äº†ä»è‡ªåŠ¨åŒ–é…ç½®ï¼ˆAuto Indexï¼‰åˆ°é’ˆå¯¹ç‰¹å®šåœºæ™¯ï¼ˆå¦‚å­—ç¬¦ä¸²å‰ç¼€ã€ä½åŸºæ•°æšä¸¾ã€æ•°å€¼æ’åºï¼‰çš„ä¸“é¡¹ä¼˜åŒ–ã€‚<strong>å€’æ’ç´¢å¼•æ˜¯é»˜è®¤ä¸”æœ€é€šç”¨çš„é€‰æ‹©</strong>ï¼Œè€Œä½å›¾ç´¢å¼•åœ¨ä½åŸºæ•°å¤šæ¡ä»¶æŸ¥è¯¢ä¸­æ€§èƒ½æœ€ä¼˜ã€‚å®é™…åº”ç”¨ä¸­éœ€ç»“åˆå­—æ®µæ•°æ®ç±»å‹ã€åŸºæ•°åˆ†å¸ƒåŠæŸ¥è¯¢æ¨¡å¼ç»¼åˆé€‰æ‹©ï¼Œå¿…è¦æ—¶å¯é€šè¿‡ <code>list_indexes()</code> æ¥å£éªŒè¯ç´¢å¼•çŠ¶æ€ã€‚</p><h2 id=ç´¢å¼•ç‰©ç†ç»“æ„>ç´¢å¼•ç‰©ç†ç»“æ„</h2><p>Milvus çš„ç´¢å¼•åº•å±‚ç‰©ç†ç»“æ„å› ç´¢å¼•ç±»å‹å’Œç›®æ ‡æ•°æ®ç±»å‹ï¼ˆå‘é‡æˆ–æ ‡é‡ï¼‰è€Œå¼‚ï¼Œå…¶è®¾è®¡æ ¸å¿ƒåœ¨äºé«˜æ•ˆæ”¯æŒç›¸ä¼¼æ€§æœç´¢å’Œæ ‡é‡è¿‡æ»¤ã€‚ä»¥ä¸‹æ˜¯ä¸»è¦ç´¢å¼•ç±»å‹çš„åº•å±‚ç‰©ç†ç»“æ„è¯¦è§£ï¼š</p><hr><h3 id=-ä¸€å‘é‡ç´¢å¼•çš„ç‰©ç†ç»“æ„>âš™ï¸ <strong>ä¸€ã€å‘é‡ç´¢å¼•çš„ç‰©ç†ç»“æ„</strong></h3><p>å‘é‡ç´¢å¼•ä¸»è¦ç”¨äºåŠ é€Ÿé«˜ç»´å‘é‡çš„è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼ˆANNï¼‰ï¼Œå…¶ç‰©ç†ç»“æ„å–å†³äºå…·ä½“ç®—æ³•ï¼š</p><ol><li><p><strong>HNSWï¼ˆåˆ†å±‚å¯¼èˆªå°ä¸–ç•Œå›¾ï¼‰</strong></p><ul><li></li></ul></li></ol><pre><code> ç»“æ„

 ï¼šå¤šå±‚å›¾ç»“æ„ï¼ˆHierarchical Graphï¼‰ã€‚

 - åº•å±‚ï¼ˆç¬¬0å±‚ï¼‰åŒ…å«å…¨é‡æ•°æ®ç‚¹ï¼Œè¿æ¥å¯†é›†ï¼›
 - ä¸Šå±‚ï¼ˆç¬¬1å±‚åŠä»¥ä¸Šï¼‰é€æ­¥ç¨€ç–åŒ–ï¼ŒèŠ‚ç‚¹é—´è¿æ¥è·ç¦»é€’å¢ã€‚
</code></pre><ul><li></li></ul><pre><code> å…³é”®å‚æ•°

 ï¼š

 - `M`ï¼šæ¯å±‚èŠ‚ç‚¹çš„æœ€å¤§è¿æ¥æ•°ï¼ˆå½±å“å›¾å¯†åº¦å’Œç²¾åº¦ï¼‰ï¼›
 - `efConstruction`ï¼šæ„å»ºæ—¶çš„æœç´¢èŒƒå›´ï¼ˆå½±å“ç´¢å¼•è´¨é‡ï¼‰ã€‚
</code></pre><ul><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé«˜ç²¾åº¦æœç´¢ï¼Œå†…å­˜èµ„æºå……è¶³ï¼ˆå¦‚ç™¾ä¸‡çº§æ•°æ®é›†ï¼‰ã€‚</li></ul><ol start=2><li><p><strong>IVF ç³»åˆ—ï¼ˆå€’æ’æ–‡ä»¶ç´¢å¼•ï¼‰</strong></p><ul><li></li></ul></li></ol><pre><code> ç»“æ„

 ï¼šåŸºäºèšç±»çš„å€’æ’åˆ—è¡¨ï¼ˆInverted Listsï¼‰ã€‚

 - æ•°æ®è¢«åˆ’åˆ†ä¸º `nlist` ä¸ªèšç±»ä¸­å¿ƒï¼ˆè´¨å¿ƒï¼‰ï¼›
 - æ¯ä¸ªèšç±»å¯¹åº”ä¸€ä¸ªå€’æ’åˆ—è¡¨ï¼Œå­˜å‚¨å±äºè¯¥ç°‡çš„å‘é‡IDåŠåŸå§‹å‘é‡æˆ–é‡åŒ–åçš„å€¼ã€‚
</code></pre><ul><li></li></ul><pre><code> å­ç±»å‹å·®å¼‚

 ï¼š

 - **IVF_FLAT**ï¼šå­˜å‚¨åŸå§‹å‘é‡ï¼Œæ— å‹ç¼©ï¼›
 - **IVF_SQ8**ï¼šæ ‡é‡é‡åŒ–ï¼ˆScalar Quantizationï¼‰ï¼Œå°†æµ®ç‚¹æ•°å‹ç¼©ä¸º8ä½æ•´æ•°ï¼›
 - **IVF_PQ**ï¼šä¹˜ç§¯é‡åŒ–ï¼ˆProduct Quantizationï¼‰ï¼Œå‘é‡åˆ†æ®µå‹ç¼©ã€‚
</code></pre><ul><li><strong>æŸ¥è¯¢æµç¨‹</strong>ï¼šå…ˆå®šä½æœ€è¿‘è´¨å¿ƒï¼Œå†æ‰«æå¯¹åº”å€’æ’åˆ—è¡¨ã€‚</li></ul><ol start=3><li><p><strong>FLATï¼ˆæš´åŠ›æœç´¢ï¼‰</strong></p><ul><li><strong>ç»“æ„</strong>ï¼šåŸå§‹å‘é‡è¿ç»­æ•°ç»„ï¼ˆFlat Arrayï¼‰ã€‚</li><li>æ— é¢å¤–æ•°æ®ç»“æ„ï¼Œç›´æ¥è®¡ç®—æŸ¥è¯¢å‘é‡ä¸å…¨é‡æ•°æ®çš„è·ç¦»ï¼Œé€‚ç”¨äºæå°æ•°æ®é›†ï¼ˆâ‰¤1ä¸‡æ¡ï¼‰ã€‚</li></ul></li><li><p><strong>ç¨€ç–å‘é‡ç´¢å¼•ï¼ˆSPARSE_INVERTED_INDEXï¼‰</strong></p><ul><li></li></ul></li></ol><pre><code> ç»“æ„

 ï¼šç»´åº¦çº§å€’æ’åˆ—è¡¨ï¼ˆDimension-wise Inverted Listsï¼‰ã€‚

 - æ¯ä¸ªç»´åº¦ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ï¼Œè®°å½•åœ¨è¯¥ç»´åº¦éé›¶çš„å‘é‡IDåŠå€¼ã€‚
</code></pre><ul><li><strong>ä¼˜åŒ–</strong>ï¼šé€šè¿‡ <code>drop_ratio</code> å‚æ•°å¿½ç•¥ä½æƒé‡å€¼ï¼Œå¹³è¡¡ç²¾åº¦ä¸é€Ÿåº¦ã€‚</li></ul><hr><h3 id=-äºŒæ ‡é‡ç´¢å¼•çš„ç‰©ç†ç»“æ„>ğŸ”¢ <strong>äºŒã€æ ‡é‡ç´¢å¼•çš„ç‰©ç†ç»“æ„</strong></h3><p>æ ‡é‡ç´¢å¼•ç”¨äºåŠ é€Ÿç»“æ„åŒ–å­—æ®µï¼ˆå¦‚æ•´æ•°ã€å­—ç¬¦ä¸²ï¼‰çš„è¿‡æ»¤ï¼š</p><ol><li><p><strong>å€’æ’ç´¢å¼•ï¼ˆINVERTEDï¼‰</strong></p><ul><li></li></ul></li></ol><pre><code> ç»“æ„

 ï¼šè¯é¡¹å­—å…¸ï¼ˆTerm Dictionaryï¼‰+ å€’æ’åˆ—è¡¨ï¼ˆPosting Listsï¼‰ã€‚

 - å­—å…¸å­˜å‚¨å”¯ä¸€å€¼ï¼ˆå¦‚ `category=&quot;A&quot;`ï¼‰ï¼›
 - å€’æ’åˆ—è¡¨å­˜å‚¨åŒ…å«è¯¥å€¼çš„æ–‡æ¡£IDé›†åˆã€‚
</code></pre><ul><li><strong>é€‚ç”¨</strong>ï¼šç­‰å€¼æŸ¥è¯¢ï¼ˆ<code>age=30</code>ï¼‰ã€èŒƒå›´æŸ¥è¯¢ï¼ˆ<code>price>100</code>ï¼‰ã€‚</li></ul><ol start=2><li><p><strong>ä½å›¾ç´¢å¼•ï¼ˆBITMAPï¼‰</strong></p><ul><li></li></ul></li></ol><pre><code> ç»“æ„

 ï¼šä½å‘é‡æ•°ç»„ï¼ˆBit Vector Arraysï¼‰ã€‚

 - æ¯ä¸ªå”¯ä¸€å€¼å¯¹åº”ä¸€ä¸ªä½å‘é‡ï¼Œæ ‡è®°åŒ…å«è¯¥å€¼çš„è¡Œï¼ˆå¦‚ `[1,0,1]` è¡¨ç¤ºç¬¬0ã€2è¡Œæ»¡è¶³æ¡ä»¶ï¼‰ã€‚
</code></pre><ul><li><strong>ä¼˜åŠ¿</strong>ï¼šæ”¯æŒå¤šæ¡ä»¶ä½è¿ç®—ï¼ˆAND/ORï¼‰ï¼Œé€‚åˆä½åŸºæ•°å­—æ®µï¼ˆå¦‚æ€§åˆ«ï¼‰ã€‚</li></ul><ol start=3><li><p><strong>å‰ç¼€æ ‘ç´¢å¼•ï¼ˆTRIEï¼‰</strong></p><ul><li></li></ul></li></ol><pre><code> ç»“æ„

 ï¼šå¤šå‰æ ‘ï¼ˆTrie Treeï¼‰ã€‚

 - èŠ‚ç‚¹å­˜å‚¨å­—ç¬¦ï¼Œè·¯å¾„è¡¨ç¤ºå­—ç¬¦ä¸²å‰ç¼€ï¼ˆå¦‚ &quot;app&quot; â†’ &quot;apple&quot;ï¼‰ã€‚
</code></pre><ul><li><strong>é€‚ç”¨</strong>ï¼šå­—ç¬¦ä¸²å‰ç¼€åŒ¹é…ï¼ˆ<code>LIKE "abc%"</code>ï¼‰ã€‚</li></ul><ol start=4><li><p><strong>STL_SORT ç´¢å¼•</strong></p><ul><li></li></ul></li></ol><pre><code> ç»“æ„

 ï¼šæ’åºæ•°ç»„ï¼ˆSorted Arrayï¼‰ã€‚

 - æ•°æ®æŒ‰å­—æ®µå€¼æ’åºå­˜å‚¨ï¼Œæ”¯æŒäºŒåˆ†æŸ¥æ‰¾åŠ é€ŸèŒƒå›´æŸ¥è¯¢ã€‚
</code></pre><ul><li><strong>é€‚ç”¨</strong>ï¼šæ•°å€¼å­—æ®µçš„èŒƒå›´è¿‡æ»¤æˆ–æ’åºï¼ˆ<code>ORDER BY timestamp</code>ï¼‰ã€‚</li></ul><hr><h3 id=-ä¸‰ç´¢å¼•çš„å­˜å‚¨ä¸æ‰§è¡Œæµç¨‹>ğŸ§© <strong>ä¸‰ã€ç´¢å¼•çš„å­˜å‚¨ä¸æ‰§è¡Œæµç¨‹</strong></h3><ol><li><strong>æŒä¹…åŒ–å­˜å‚¨</strong>ï¼š<ul><li>ç´¢å¼•æ–‡ä»¶ï¼ˆå¦‚ IVF çš„èšç±»æ•°æ®ã€HNSW çš„å›¾ç»“æ„ï¼‰ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜å…¥å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚ MinIO/S3ï¼‰ã€‚</li><li>å…ƒæ•°æ®ï¼ˆç´¢å¼•ç±»å‹ã€å‚æ•°ï¼‰ä¿å­˜åœ¨ etcd ä¸­ã€‚</li></ul></li><li><strong>æŸ¥è¯¢åŠ è½½</strong>ï¼š<ul><li>æŸ¥è¯¢æ—¶ï¼ŒQuery Node å°†ç´¢å¼•æ–‡ä»¶ä»å¯¹è±¡å­˜å‚¨åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶æ ¹æ®ç´¢å¼•ç±»å‹æ‰§è¡Œæœç´¢ï¼š<ul><li>HNSWï¼šå›¾éå†ï¼›</li><li>IVFï¼šå®šä½èšç±»â†’æ‰«æå€’æ’åˆ—è¡¨ï¼›</li><li>å€’æ’ç´¢å¼•ï¼šæ£€ç´¢å€’æ’åˆ—è¡¨ã€‚</li></ul></li></ul></li></ol><hr><h3 id=-å››æ€»ç»“ç´¢å¼•ç»“æ„ä¸é€‚ç”¨åœºæ™¯>ğŸ’ <strong>å››ã€æ€»ç»“ï¼šç´¢å¼•ç»“æ„ä¸é€‚ç”¨åœºæ™¯</strong></h3><div class=table-wrapper><table><thead><tr><th><strong>ç´¢å¼•ç±»å‹</strong></th><th><strong>åº•å±‚ç‰©ç†ç»“æ„</strong></th><th><strong>å…¸å‹åº”ç”¨åœºæ™¯</strong></th><th><strong>å…³é”®è®¾è®¡ç›®æ ‡</strong></th></tr></thead><tbody><tr><td>HNSW</td><td>å¤šå±‚å›¾ç»“æ„</td><td>é«˜ç²¾åº¦å‘é‡æœç´¢</td><td>å¹³è¡¡å¬å›ç‡ä¸æŸ¥è¯¢å»¶è¿Ÿ</td></tr><tr><td>IVF_FLAT/PQ/SQ8</td><td>èšç±»ä¸­å¿ƒ+å€’æ’åˆ—è¡¨</td><td>å¤§è§„æ¨¡å‘é‡æ•°æ®é›†</td><td>å‹ç¼©å­˜å‚¨ï¼Œé™ä½å†…å­˜å ç”¨</td></tr><tr><td>å€’æ’ç´¢å¼• (INVERTED)</td><td>è¯é¡¹å­—å…¸+å€’æ’åˆ—è¡¨</td><td>æ ‡é‡ç­‰å€¼/èŒƒå›´è¿‡æ»¤</td><td>åŠ é€Ÿå¤šå€¼åŒ¹é…</td></tr><tr><td>ä½å›¾ç´¢å¼• (BITMAP)</td><td>ä½å‘é‡æ•°ç»„</td><td>ä½åŸºæ•°å­—æ®µçš„å¤šæ¡ä»¶è¿‡æ»¤</td><td>ä½è¿ç®—é«˜æ•ˆåˆå¹¶</td></tr><tr><td>TRIE</td><td>å‰ç¼€æ ‘</td><td>å­—ç¬¦ä¸²å‰ç¼€åŒ¹é…</td><td>å‡å°‘å­—ç¬¦æ‰«ææ¬¡æ•°</td></tr></tbody></table></div><p><strong>è®¾è®¡å…±æ€§</strong>ï¼š</p><ul><li><strong>å†·çƒ­åˆ†ç¦»</strong>ï¼šç´¢å¼•æ–‡ä»¶å­˜å‚¨åœ¨å¯¹è±¡å­˜å‚¨ï¼ˆå†·æ•°æ®ï¼‰ï¼ŒæŸ¥è¯¢æ—¶åŠ è½½åˆ°å†…å­˜ï¼ˆçƒ­æ•°æ®ï¼‰ã€‚</li><li><strong>å¼‚æ­¥æ„å»º</strong>ï¼šç´¢å¼•ç”± Index Node å¼‚æ­¥ç”Ÿæˆï¼Œé¿å…é˜»å¡æ•°æ®å†™å…¥ã€‚</li><li><strong>å‚æ•°åŒ–è°ƒä¼˜</strong>ï¼šé€šè¿‡ <code>nlist</code>ã€<code>M</code>ã€<code>ef</code> ç­‰å‚æ•°å¹³è¡¡ç²¾åº¦ã€é€Ÿåº¦ä¸èµ„æºã€‚</li></ul><p>å¦‚éœ€è¿›ä¸€æ­¥ä¼˜åŒ–ç´¢å¼•æ€§èƒ½ï¼Œå¯ç»“åˆå­—æ®µåŸºæ•°ã€æŸ¥è¯¢æ¨¡å¼è°ƒæ•´å‚æ•°ï¼ˆå¦‚ä½åŸºæ•°ç”¨ BITMAPï¼Œé«˜ç²¾åº¦ç”¨ HNSWï¼‰ã€‚</p><h2 id=json-ç´¢å¼•>JSON ç´¢å¼•</h2><p>åœ¨ Milvus ä¸­ï¼ŒJSON ç±»å‹å­—æ®µçš„ç´¢å¼•æ˜¯é€šè¿‡ <strong>è·¯å¾„ç´¢å¼•ï¼ˆPath Indexingï¼‰</strong> å®ç°çš„ï¼Œå…è®¸é’ˆå¯¹ JSON ç»“æ„å†…çš„ç‰¹å®šå­—æ®µï¼ˆå¦‚åµŒå¥—é”®æˆ–æ•°ç»„å…ƒç´ ï¼‰åˆ›å»ºç´¢å¼•ä»¥åŠ é€ŸæŸ¥è¯¢ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æœºåˆ¶å’Œæ“ä½œæŒ‡å—ï¼š</p><hr><h3 id=-json-å­—æ®µç´¢å¼•çš„æ ¸å¿ƒæœºåˆ¶>âš™ï¸ <strong>JSON å­—æ®µç´¢å¼•çš„æ ¸å¿ƒæœºåˆ¶</strong></h3><ol><li><strong>ç´¢å¼•ç±»å‹</strong><ul><li>ä»…æ”¯æŒ <strong>å€’æ’ç´¢å¼•ï¼ˆINVERTEDï¼‰</strong>ã€‚</li><li>é€šè¿‡æŒ‡å®š JSON è·¯å¾„ï¼ˆ<code>json_path</code>ï¼‰å’Œæ•°æ®ç±»å‹ï¼ˆ<code>json_cast_type</code>ï¼‰ï¼Œæå–ç›®æ ‡å€¼å¹¶æ„å»ºç´¢å¼•ã€‚</li></ul></li><li><strong>è·¯å¾„ç´¢å¼•åŸç†</strong><ul><li>ç´¢å¼•é’ˆå¯¹ JSON å†…éƒ¨çš„ç‰¹å®šè·¯å¾„ï¼ˆå¦‚ <code>metadata["product_info"]["category"]</code>ï¼‰ï¼Œè€Œéæ•´ä¸ª JSON å¯¹è±¡ã€‚</li><li>ç¤ºä¾‹ï¼šä¸º <code>metadata.price</code> åˆ›å»ºæ•°å€¼ç´¢å¼•åï¼ŒæŸ¥è¯¢ <code>metadata["price"] > 100</code> å¯ç›´æ¥å‘½ä¸­ç´¢å¼•ã€‚</li></ul></li></ol><hr><h3 id=-å¦‚ä½•ä¸º-json-çš„ç‰¹å®šå­—æ®µåˆ›å»ºç´¢å¼•>ğŸ”§ <strong>å¦‚ä½•ä¸º JSON çš„ç‰¹å®šå­—æ®µåˆ›å»ºç´¢å¼•ï¼Ÿ</strong></h3><p>é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°é’ˆå¯¹å•ä¸€å­—æ®µçš„ç´¢å¼•ï¼š</p><ol><li><p><strong>å®šä¹‰ç´¢å¼•å‚æ•°</strong></p><pre tabindex=0><code>index_params = client.prepare_index_params()
index_params.add_index(
    field_name=&#34;metadata&#34;,       # JSON å­—æ®µå
    index_type=&#34;INVERTED&#34;,        # ä»…æ”¯æŒå€’æ’ç´¢å¼•
    index_name=&#34;price_index&#34;,     # è‡ªå®šä¹‰ç´¢å¼•å
    params={
        &#34;json_path&#34;: &#34;metadata[\&#34;price\&#34;]&#34;,  # æŒ‡å®šç›®æ ‡å­—æ®µè·¯å¾„
        &#34;json_cast_type&#34;: &#34;double&#34;           # è½¬æ¢æ•°æ®ç±»å‹
    }
)
</code></pre><p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p><ul><li><code>json_path</code>ï¼šéœ€ç´¢å¼•çš„ JSON è·¯å¾„ï¼ˆæ”¯æŒåµŒå¥—é”®å’Œæ•°ç»„ï¼Œå¦‚ <code>tags[0]</code>ï¼‰ã€‚</li><li><code>json_cast_type</code>ï¼šç›®æ ‡æ•°æ®ç±»å‹ï¼ˆ<code>varchar</code>ã€<code>double</code> æˆ– <code>bool</code>ï¼‰ã€‚</li></ul></li><li><p><strong>åˆ›å»ºç´¢å¼•</strong></p><pre tabindex=0><code>client.create_index(collection_name=&#34;my_collection&#34;, index_params=index_params)
</code></pre></li></ol><hr><h3 id=-å…³é”®æ³¨æ„äº‹é¡¹>âš ï¸ <strong>å…³é”®æ³¨æ„äº‹é¡¹</strong></h3><ol><li><p><strong>æ•°æ®ç±»å‹åŒ¹é…</strong></p><ul><li><p>æŸ¥è¯¢æ¡ä»¶å¿…é¡»ä¸</p><pre tabindex=0><code>json_cast_type
</code></pre><p>ä¸€è‡´ï¼Œå¦åˆ™ç´¢å¼•å¤±æ•ˆï¼š</p><ul><li>è‹¥ç´¢å¼•ç±»å‹ä¸º <code>double</code>ï¼Œåˆ™è¿‡æ»¤æ¡ä»¶éœ€ä¸ºæ•°å€¼ï¼ˆå¦‚ <code>metadata["price"] > 100</code>ï¼‰ã€‚</li><li>è‹¥ä¸º <code>varchar</code>ï¼Œåˆ™éœ€å­—ç¬¦ä¸²æ¡ä»¶ï¼ˆå¦‚ <code>metadata["category"] == "electronics"</code>ï¼‰ã€‚</li></ul></li></ul></li><li><p><strong>æ•°æ®ä¸€è‡´æ€§è¦æ±‚</strong></p><ul><li><strong>ç±»å‹ä¸ä¸€è‡´</strong>ï¼šè‹¥æŸè¡Œæ•°æ®çš„è·¯å¾„å€¼ç±»å‹ä¸ <code>json_cast_type</code> ä¸ç¬¦ï¼ˆå¦‚å­—ç¬¦ä¸²å­˜å…¥æ•°å€¼ç´¢å¼•ï¼‰ï¼Œè¯¥è¡Œå°†è¢«è·³è¿‡ç´¢å¼•ã€‚</li><li><strong>è·¯å¾„ç¼ºå¤±</strong>ï¼šè·¯å¾„ä¸å­˜åœ¨çš„æ•°æ®è¡Œä¸ä¼šè¢«ç´¢å¼•ï¼Œä½†ä¸ä¼šæŠ¥é”™ã€‚</li></ul></li><li><p><strong>æ•°å€¼ç²¾åº¦é™åˆ¶</strong></p><ul><li>æ•°å€¼ç±»å‹ï¼ˆå¦‚ <code>double</code>ï¼‰ç´¢å¼•å­˜åœ¨ç²¾åº¦é™åˆ¶ï¼ˆè¶…è¿‡ 2^53 çš„æ•´æ•°å¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼‰ï¼Œéœ€é¿å…å¤§æ•´æ•°åœºæ™¯ã€‚</li></ul></li><li><p><strong>æ•°ç»„ç´¢å¼•é™åˆ¶</strong></p><ul><li>å½“å‰<strong>ä¸æ”¯æŒæ•°ç»„æ•´ä½“ç´¢å¼•</strong>ï¼ˆå¦‚ <code>tags</code> æ•°ç»„ï¼‰ï¼Œä»…æ”¯æŒç´¢å¼•æ•°ç»„ä¸­çš„æ ‡é‡å…ƒç´ ï¼ˆå¦‚ <code>tags[0]</code>ï¼‰ã€‚</li></ul></li></ol><hr><h3 id=-é«˜çº§æŠ€å·§åŠ¨æ€å­—æ®µçš„ç´¢å¼•>ğŸš€ <strong>é«˜çº§æŠ€å·§ï¼šåŠ¨æ€å­—æ®µçš„ç´¢å¼•</strong></h3><p>è‹¥å¯ç”¨åŠ¨æ€å­—æ®µï¼ˆ<code>enable_dynamic_fields=True</code>ï¼‰ï¼Œæœªå®šä¹‰çš„å­—æ®µä¼šå­˜å…¥ <code>$meta</code> JSON ä¸­ï¼Œå¯é€šè¿‡ç›¸åŒæ–¹å¼ç´¢å¼•ï¼š</p><pre tabindex=0><code>index_params.add_index(
    field_name=&#34;color&#34;,             # åŠ¨æ€å­—æ®µåï¼ˆå¦‚ colorï¼‰
    index_type=&#34;INVERTED&#34;,
    params={
        &#34;json_path&#34;: &#34;color&#34;,       # ç›´æ¥æŒ‡å®šé”®å
        &#34;json_cast_type&#34;: &#34;varchar&#34;
    }
)
</code></pre><p>åŠ¨æ€å­—æ®µçš„æŸ¥è¯¢è¯­æ³•ä¸æ™®é€šå­—æ®µç›¸åŒï¼ˆå¦‚ <code>color == "red"</code>ï¼‰ã€‚</p><hr><h3 id=-æ€»ç»“ä¸å»ºè®®>ğŸ’ <strong>æ€»ç»“ä¸å»ºè®®</strong></h3><ul><li><strong>ç´¢å¼•åœºæ™¯</strong>ï¼šå¯¹é«˜é¢‘æŸ¥è¯¢çš„ JSON è·¯å¾„ï¼ˆå¦‚åˆ†ç±»ã€ä»·æ ¼ï¼‰å•ç‹¬å»ºç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æã€‚</li><li><strong>è·¯å¾„é€‰æ‹©</strong>ï¼šä¼˜å…ˆç´¢å¼•<strong>ä½åŸºæ•°ã€é«˜é¢‘è¿‡æ»¤</strong>çš„å­—æ®µï¼ˆå¦‚ <code>category</code> è€Œé <code>description</code>ï¼‰ã€‚</li><li><strong>æ•°æ®ç±»å‹</strong>ï¼šæ ¹æ®å®é™…æŸ¥è¯¢éœ€æ±‚é€‰æ‹© <code>json_cast_type</code>ï¼ˆå­—ç¬¦ä¸²é€‰ <code>varchar</code>ï¼Œæ•°å€¼é€‰ <code>double</code>ï¼‰ã€‚</li><li><strong>æ€§èƒ½å¹³è¡¡</strong>ï¼šæ¯ä¸ªæ–°å¢ç´¢å¼•ä¼šå¢åŠ å­˜å‚¨å¼€é”€ï¼Œå»ºè®®æŒ‰éœ€åˆ›å»ºã€‚</li></ul><blockquote><p>é€šè¿‡ç²¾å‡†çš„è·¯å¾„ç´¢å¼•ï¼ŒJSON å­—æ®µçš„è¿‡æ»¤æ€§èƒ½å¯æå‡æ•°åå€ã€‚ä¾‹å¦‚ï¼Œä¸º <code>metadata["price"]</code> å»ºç´¢å¼•åï¼ŒèŒƒå›´æŸ¥è¯¢é€Ÿåº¦æ¥è¿‘å¸¸é‡æ—¶é—´å¤æ‚åº¦ã€‚</p></blockquote></section><footer class=article-footer><section class=article-tags><a href=/tags/db/>DB</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Aug 08, 2025 20:27 CST</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/mongodbfundamentals/><div class=article-details><h2 class=article-title>ã€MongoDBã€‘Fundamentals</h2></div></a></article><article><a href=/p/nebulafundamentals/><div class=article-details><h2 class=article-title>ã€Nebulaã€‘Fundamentals</h2></div></a></article><article><a href=/p/db%E5%88%86%E5%B8%83%E5%BC%8F/><div class=article-details><h2 class=article-title>ã€DBã€‘åˆ†å¸ƒå¼</h2></div></a></article><article><a href=/p/distributedlock/><div class=article-details><h2 class=article-title>ã€Distributedã€‘Lock</h2></div></a></article><article><a href=/p/rediscluster/><div class=article-details><h2 class=article-title>ã€Redisã€‘Cluster</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 é£é¸¿è¸é›ªæ³¥</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>