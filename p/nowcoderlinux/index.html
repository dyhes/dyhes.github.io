<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="tcpdump tcpdump 是一款强大且广泛使用的命令行网络数据包捕获和分析工具，它允许用户拦截和显示发送或经过计算机网络接口的数据包，是网络故障排查、性能分析和安全监控的利器。\n下面是一个快速了解 tcpdump 常用命令的表格：\n功能类别 命令示例 说明 基本捕获 tcpdump -i eth0 捕获指定接口 (eth0) 的所有数据包。 限制与保存 tcpdump -i any -c 10 -w file.pcap 捕获所有接口的 10 个包并保存到 file.pcap。 主机与端口过滤 tcpdump host 192.168.1.1 tcpdump port 80 tcpdump src host 192.168.1.1 and dst port 443 过滤特定主机、端口，或组合条件（如源主机+目标端口）。 协议过滤 tcpdump icmp tcpdump tcp tcpdump udp 仅捕获特定协议的数据包（如 ICMP, TCP, UDP）。 高级过滤 tcpdump 'net 192.168.1.0/24' tcpdump 'tcp port 80 and (tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x47455420)' 使用 CIDR 过滤网段，或基于报文内容（如 HTTP GET 请求）进行过滤。 📜 核心功能 tcpdump 的核心功能包括：\n"><title>【NowCoder】Linux</title><link rel=canonical href=https://dyhes.github.io/p/nowcoderlinux/><link rel=stylesheet href=/scss/style.min.f7091bff8043bd3e53b22be6c05dd86b506e8dec4d0d75d249d2dfb0fe074a46.css><meta property='og:title' content="【NowCoder】Linux"><meta property='og:description' content="tcpdump tcpdump 是一款强大且广泛使用的命令行网络数据包捕获和分析工具，它允许用户拦截和显示发送或经过计算机网络接口的数据包，是网络故障排查、性能分析和安全监控的利器。\n下面是一个快速了解 tcpdump 常用命令的表格：\n功能类别 命令示例 说明 基本捕获 tcpdump -i eth0 捕获指定接口 (eth0) 的所有数据包。 限制与保存 tcpdump -i any -c 10 -w file.pcap 捕获所有接口的 10 个包并保存到 file.pcap。 主机与端口过滤 tcpdump host 192.168.1.1 tcpdump port 80 tcpdump src host 192.168.1.1 and dst port 443 过滤特定主机、端口，或组合条件（如源主机+目标端口）。 协议过滤 tcpdump icmp tcpdump tcp tcpdump udp 仅捕获特定协议的数据包（如 ICMP, TCP, UDP）。 高级过滤 tcpdump 'net 192.168.1.0/24' tcpdump 'tcp port 80 and (tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x47455420)' 使用 CIDR 过滤网段，或基于报文内容（如 HTTP GET 请求）进行过滤。 📜 核心功能 tcpdump 的核心功能包括：\n"><meta property='og:url' content='https://dyhes.github.io/p/nowcoderlinux/'><meta property='og:site_name' content='飞鸿踏雪泥'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='NowCoder'><meta property='article:published_time' content='2025-09-09T00:00:00+00:00'><meta property='article:modified_time' content='2025-09-30T19:46:00+08:00'><meta name=twitter:title content="【NowCoder】Linux"><meta name=twitter:description content="tcpdump tcpdump 是一款强大且广泛使用的命令行网络数据包捕获和分析工具，它允许用户拦截和显示发送或经过计算机网络接口的数据包，是网络故障排查、性能分析和安全监控的利器。\n下面是一个快速了解 tcpdump 常用命令的表格：\n功能类别 命令示例 说明 基本捕获 tcpdump -i eth0 捕获指定接口 (eth0) 的所有数据包。 限制与保存 tcpdump -i any -c 10 -w file.pcap 捕获所有接口的 10 个包并保存到 file.pcap。 主机与端口过滤 tcpdump host 192.168.1.1 tcpdump port 80 tcpdump src host 192.168.1.1 and dst port 443 过滤特定主机、端口，或组合条件（如源主机+目标端口）。 协议过滤 tcpdump icmp tcpdump tcp tcpdump udp 仅捕获特定协议的数据包（如 ICMP, TCP, UDP）。 高级过滤 tcpdump 'net 192.168.1.0/24' tcpdump 'tcp port 80 and (tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x47455420)' 使用 CIDR 过滤网段，或基于报文内容（如 HTTP GET 请求）进行过滤。 📜 核心功能 tcpdump 的核心功能包括：\n"><link rel="shortcut icon" href=/github.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_b567f26f71c49c33.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>飞鸿踏雪泥</a></h1><h2 class=site-description>没有记录，就没有发生</h2></div></header><ol class=menu-social><li><a href=https://leetcode.cn/u/dyhes/ target=_blank title=LeetCode rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 13h7.5"/><path d="M9.424 7.268l4.999-4.999"/><path d="M16.633 16.644l-2.402 2.415a3.189 3.189.0 01-4.524.0l-3.77-3.787a3.223 3.223.0 010-4.544l3.77-3.787a3.189 3.189.0 014.524.0l2.302 2.313"/></svg></a></li><li><a href=https://github.com/dyhes target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:dyheslin@gmail.com target=_blank title=Gmail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-gmail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M16 20h3a1 1 0 001-1V5a1 1 0 00-1-1h-3v16z"/><path d="M5 20h3V4H5A1 1 0 004 5v14a1 1 0 001 1z"/><path d="M16 4l-4 4-4-4"/><path d="M4 6.5l8 7.5 8-7.5"/></svg></a></li><li><a href=mailto:1325574784@qq.com target=_blank title=Mail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 19H5a2 2 0 01-2-2V7a2 2 0 012-2h14a2 2 0 012 2v5.5"/><path d="M3 7l9 6 9-6"/><path d="M19 16l-2 3h4l-2 3"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/categories/><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/tags/><svg class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>Tags</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#tcpdump>tcpdump</a><ol><li><a href=#-核心功能>📜 核心功能</a></li><li><a href=#-安装与基本使用>🛠️ 安装与基本使用</a></li><li><a href=#-常用过滤表达式>🔧 常用过滤表达式</a></li><li><a href=#-实用场景与示例>💡 实用场景与示例</a></li><li><a href=#-注意事项>⚠️ 注意事项</a></li><li><a href=#-替代方案>🔄 替代方案</a></li><li><a href=#-学习建议>📖 学习建议</a></li></ol></li><li><a href=#软硬链接>软硬链接</a><ol><li><a href=#-如何创建与查看>📝 如何创建与查看</a><ol><li><a href=#创建链接>创建链接</a></li><li><a href=#查看链接信息>查看链接信息</a></li></ol></li><li><a href=#-底层原理与行为差异>⚙️ 底层原理与行为差异</a></li><li><a href=#-如何选择应用场景>🎯 如何选择：应用场景</a></li><li><a href=#-注意事项与常见问题>⚠️ 注意事项与常见问题</a></li><li><a href=#-总结>💎 总结</a></li></ol></li><li><a href=#tail--last>tail & last</a><ol><li><a href=#-命令详解与使用场景>📝 命令详解与使用场景</a><ol><li><a href=#1-tail查看文件尾部>1. <code>tail</code>：查看文件尾部</a></li><li><a href=#2-last查看登录历史>2. <code>last</code>：查看登录历史</a></li></ol></li><li><a href=#-重要注意事项>⚠️ 重要注意事项</a></li><li><a href=#-总结与如何选择>💎 总结与如何选择</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/arts/ style=background-color:#a7535a;color:>文武艺</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/nowcoderlinux/>【NowCoder】Linux</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 09, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><h2 id=tcpdump>tcpdump</h2><p>tcpdump 是一款强大且广泛使用的命令行网络数据包捕获和分析工具，它允许用户拦截和显示发送或经过计算机网络接口的数据包，是网络故障排查、性能分析和安全监控的利器。</p><p>下面是一个快速了解 tcpdump 常用命令的表格：</p><div class=table-wrapper><table><thead><tr><th>功能类别</th><th>命令示例</th><th>说明</th></tr></thead><tbody><tr><td><strong>基本捕获</strong></td><td><code>tcpdump -i eth0</code></td><td>捕获指定接口 (<code>eth0</code>) 的所有数据包。</td></tr><tr><td><strong>限制与保存</strong></td><td><code>tcpdump -i any -c 10 -w file.pcap</code></td><td>捕获所有接口的 10 个包并保存到 <code>file.pcap</code>。</td></tr><tr><td><strong>主机与端口过滤</strong></td><td><code>tcpdump host 192.168.1.1</code> <code>tcpdump port 80</code> <code>tcpdump src host 192.168.1.1 and dst port 443</code></td><td>过滤特定主机、端口，或组合条件（如源主机+目标端口）。</td></tr><tr><td><strong>协议过滤</strong></td><td><code>tcpdump icmp</code> <code>tcpdump tcp</code> <code>tcpdump udp</code></td><td>仅捕获特定协议的数据包（如 ICMP, TCP, UDP）。</td></tr><tr><td><strong>高级过滤</strong></td><td><code>tcpdump 'net 192.168.1.0/24'</code> <code>tcpdump 'tcp port 80 and (tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x47455420)'</code></td><td>使用 CIDR 过滤网段，或基于报文内容（如 HTTP GET 请求）进行过滤。</td></tr></tbody></table></div><h3 id=-核心功能>📜 核心功能</h3><p>tcpdump 的核心功能包括：</p><ul><li><strong>数据包捕获</strong>：实时捕获流经网络接口的原始网络数据包。</li><li><strong>精准过滤</strong>：使用 <strong>BPF (Berkeley Packet Filter)</strong> 语法，可以根据源/目标 IP、端口、协议类型甚至特定报文内容进行过滤，极大提升分析效率。</li><li><strong>详细解析</strong>：对多种网络协议（如 Ethernet, IP, TCP, UDP, ICMP 等）进行解析，并以可读格式显示报文头信息。</li><li><strong>数据保存与离线分析</strong>：可将捕获的数据包保存为 <code>.pcap</code>文件，便于日后使用 Wireshark 等图形化工具进行深入分析。</li></ul><h3 id=-安装与基本使用>🛠️ 安装与基本使用</h3><ol><li><p><strong>安装 tcpdump</strong></p><p>在许多 Linux 发行版中，可以使用包管理器安装：</p><ul><li>Debian/Ubuntu: <code>sudo apt install tcpdump</code></li><li>RHEL/CentOS: <code>sudo yum install tcpdump</code></li><li>macOS (使用 Homebrew): <code>brew install tcpdump</code></li></ul></li><li><p><strong>基本命令格式</strong></p><p>tcpdump 的基本命令格式为：<code>sudo tcpdump [选项] [过滤表达式]</code></p><p>常用选项包括：</p><ul><li><code>-i &lt;接口></code>: 指定网络接口，如 <code>eth0</code>, <code>wlan0</code>, 或 <code>any</code>（所有接口）。</li><li><code>-c &lt;数量></code>: 捕获指定数量的数据包后停止。</li><li><code>-w &lt;文件></code>: 将捕获的数据包写入文件。</li><li><code>-r &lt;文件></code>: 从文件中读取数据包。</li><li><code>-n</code>: 不将 IP 地址解析为主机名。</li><li><code>-nn</code>: 不解析主机名和端口号。</li><li><code>-v</code>, <code>-vv</code>, <code>-vvv</code>: 显示更详细的信息。</li><li><code>-X</code>: 以十六进制和 ASCII 码形式显示数据包内容。</li><li><code>-A</code>: 以 ASCII 格式打印数据包内容。</li><li><code>-s &lt;长度></code>: 设置要捕获的数据包长度（<code>-s0</code>表示捕获完整数据包）。</li></ul></li></ol><h3 id=-常用过滤表达式>🔧 常用过滤表达式</h3><p>tcpdump 的威力在于其灵活的过滤表达式：</p><ul><li><p><strong>按主机过滤</strong>：<code>host 192.168.1.1</code>(过滤该 IP 的流量)</p></li><li><p><strong>按方向过滤</strong>：<code>src host 192.168.1.1</code>(源地址), <code>dst host 192.168.1.1</code>(目标地址)</p></li><li><p><strong>按端口过滤</strong>：<code>port 80</code>, <code>dst port 53</code></p></li><li><p><strong>按协议过滤</strong>：<code>tcp</code>, <code>udp</code>, <code>icmp</code></p></li><li><p><strong>逻辑组合</strong>：使用 <code>and</code>(与), <code>or</code>(或), <code>not</code>(非) 组合条件，例如：</p><p><code>src host 192.168.1.100 and (dst port 80 or dst port 443)</code></p></li></ul><h3 id=-实用场景与示例>💡 实用场景与示例</h3><ol><li><p><strong>捕获特定主机的 ICMP 包 (如 Ping)</strong></p><pre tabindex=0><code>sudo tcpdump -i any -nn icmp and host 192.168.1.1
</code></pre></li><li><p><strong>捕获 HTTP 流量并显示内容</strong></p><pre tabindex=0><code>sudo tcpdump -i any -A -s0 port 80
</code></pre></li><li><p><strong>捕获特定端口的流量并保存到文件</strong></p><pre tabindex=0><code>sudo tcpdump -i eth0 -w web_traffic.pcap port 80 or port 443
</code></pre></li><li><p><strong>从保存的文件中读取数据包</strong></p><pre tabindex=0><code>sudo tcpdump -r web_traffic.pcap
</code></pre></li><li><p><strong>捕获 TCP 三次握手 (SYN, SYN-ACK, ACK)</strong></p><pre tabindex=0><code>sudo tcpdump -nn &#39;tcp[tcpflags] &amp; (tcp-syn|tcp-ack) != 0&#39;
</code></pre></li></ol><h3 id=-注意事项>⚠️ 注意事项</h3><ul><li><strong>权限要求</strong>：tcpdump 需要 root 权限（通常使用 <code>sudo</code>）来访问网络接口。</li><li><strong>性能影响</strong>：在高流量网络上捕获所有数据包可能消耗大量 CPU 和内存。务必使用过滤条件缩小范围，或用 <code>-c</code>限制包数量。</li><li><strong>隐私与安全</strong>：tcpdump 可能捕获明文传输的敏感信息（如密码）。请仅在授权范围内使用，并妥善处理捕获的数据。</li></ul><h3 id=-替代方案>🔄 替代方案</h3><p>虽然 tcpdump 功能强大，但在某些场景下，其他工具可能更合适：</p><ul><li><strong>Wireshark/tshark</strong>: 提供强大的图形化界面和更深入的分析功能，tshark 是其命令行版本。</li><li><strong>对加密协议的分析</strong>：tcpdump 无法解密 HTTPS 等加密流量的内容。</li></ul><h3 id=-学习建议>📖 学习建议</h3><p>掌握 tcpdump 的最佳方式是<strong>结合实践</strong>。可以先从简单的过滤条件开始，如捕获特定 IP 或端口的流量，再逐步尝试更复杂的表达式。使用 <code>-w</code>选项保存数据包，然后用 Wireshark 打开进行对比分析，这能帮助你更好地理解网络协议和 tcpdump 的输出。</p><p>tcpdump 是网络工作者工具箱中不可或缺的利器，希望这些信息能帮助你更好地理解和使用它。</p><h2 id=软硬链接>软硬链接</h2><p>理解 Linux 中的硬链接和软链接对于高效管理文件系统至关重要。下面我将通过一个对比表格和详细解释，帮你彻底搞清楚它们的区别、工作原理以及如何选择。</p><div class=table-wrapper><table><thead><tr><th>特性</th><th><strong>硬链接 (Hard Link)</strong></th><th><strong>软链接 (Symbolic Link / Soft Link)</strong></th></tr></thead><tbody><tr><td><strong>本质</strong></td><td>是文件的一个<strong>别名</strong>，与源文件共享相同的 <strong>inode</strong> 和数据块</td><td>是一个<strong>独立的文件</strong>，其内容是目标文件的<strong>路径字符串</strong>，拥有自己的 inode</td></tr><tr><td><strong>inode 号</strong></td><td>与源文件<strong>相同</strong></td><td>与目标文件<strong>不同</strong>，是独立的</td></tr><tr><td><strong>跨文件系统</strong></td><td><strong>不支持</strong>（因为 inode 是文件系统内唯一的）</td><td><strong>支持</strong></td></tr><tr><td><strong>链接目录</strong></td><td><strong>不能</strong>（为防止循环引用，普通用户无法创建目录的硬链接）</td><td><strong>可以</strong></td></tr><tr><td><strong>原始文件删除后</strong></td><td><strong>不受影响</strong>（数据仍可通过任何硬链接访问，直到所有硬链接被删除）</td><td><strong>失效</strong>（变成“悬空链接”或“断链”）</td></tr><tr><td><strong>存储内容</strong></td><td>直接指向文件数据的<strong>磁盘块</strong></td><td>存储目标文件的<strong>路径信息</strong></td></tr><tr><td><strong>文件类型</strong></td><td>显示为普通文件（如 <code>-rw-r--r--</code>）</td><td>显示为链接文件（如 <code>lrwxrwxrwx</code>），并以 <code>-></code>指示目标</td></tr><tr><td><strong>创建命令</strong></td><td><code>ln &lt;源文件> &lt;链接名></code></td><td><code>ln -s &lt;目标文件> &lt;链接名></code></td></tr><tr><td><strong>空间占用</strong></td><td>不额外占用磁盘空间（仅增加一个目录项）</td><td>占用少量空间（用于存储路径字符串）</td></tr><tr><td><strong>访问速度</strong></td><td>较快（直接访问数据块）</td><td>稍慢（需额外解析路径）</td></tr></tbody></table></div><hr><h3 id=-如何创建与查看>📝 如何创建与查看</h3><h4 id=创建链接>创建链接</h4><pre tabindex=0><code># 创建硬链接
ln original.txt hardlink.txt

# 创建软链接（使用绝对路径更可靠）
ln -s /absolute/path/to/original.txt softlink.txt
</code></pre><h4 id=查看链接信息>查看链接信息</h4><p>使用 <code>ls -li</code>命令可以查看文件的 inode 号和链接信息。硬链接与原文件 inode 号相同，软链接则不同且会显示指向路径。</p><pre tabindex=0><code>ls -li original.txt hardlink.txt softlink.txt
</code></pre><p>输出示例：</p><pre tabindex=0><code>25869085 -rw-r--r-- 2 user group 27 7月  8 17:39 hardlink.txt
25869085 -rw-r--r-- 2 user group 27 7月  8 17:39 original.txt
25869216 lrwxrwxrwx 1 user group 6 7月  8 17:47 softlink.txt -&gt; original.txt
</code></pre><hr><h3 id=-底层原理与行为差异>⚙️ 底层原理与行为差异</h3><ol><li><p><strong>inode 是关键</strong>：</p><p>inode 是文件系统的核心数据结构，记录文件的元数据（权限、大小、时间戳等）及数据块位置。<strong>硬链接</strong>通过共享同一 inode 实现，而<strong>软链接</strong>拥有独立 inode，仅存储路径信息。</p></li><li><p><strong>删除行为的本质</strong>：</p><ul><li>在 Linux 中，删除文件 (<code>rm</code>) 的实际行为是<strong>减少其 inode 的链接计数</strong>。只有当链接计数降为 0 时，文件的数据块才会被标记为可覆盖。</li><li>因此，删除一个<strong>硬链接</strong>只是减少了一个计数，数据依然存在。而删除<strong>软链接</strong>指向的原始文件，数据可能被真正删除，导致软链接失效。</li></ul></li><li><p><strong>链接计数</strong>：</p><p>使用 <code>ls -l</code>看到的第二列数字就是硬链接的计数。新建普通文件的链接计数通常为 1，每创建一个硬链接，计数就会 +1。</p></li></ol><hr><h3 id=-如何选择应用场景>🎯 如何选择：应用场景</h3><ul><li><strong>硬链接的典型用途</strong>：<ul><li><strong>文件备份与快照</strong>：用于创建文件系统的快照（如 <code>rsync --link-dest</code>），避免重复存储相同数据，节省空间。</li><li><strong>重要文件防误删</strong>：为重要文件创建硬链接，即使原始路径被删，数据依然可通过硬链接访问。</li><li><strong>同一文件系统内多路径访问</strong>：当需要在同一文件系统内通过多个不同路径访问同一份数据时。</li></ul></li><li><strong>软链接的典型用途</strong>：<ul><li><strong>快捷方式与动态引用</strong>：为安装在不同位置的软件创建统一入口（如 <code>/usr/bin/python</code>-> <code>/usr/bin/python3.10</code>）。</li><li><strong>跨文件系统或挂载点链接</strong>：例如，将家目录下的一个文件夹链接到另一个硬盘分区上。</li><li><strong>目录链接</strong>：为深层目录创建方便的快捷访问方式。</li><li><strong>版本管理</strong>：灵活切换不同版本的软件或配置文件（如 <code>node</code>-> <code>/opt/node-v18/bin/node</code>）。</li></ul></li></ul><hr><h3 id=-注意事项与常见问题>⚠️ 注意事项与常见问题</h3><ol><li><strong>硬链接的限制</strong>：<ul><li>不能跨文件系统（如从 ext4 链接到 NTFS）。</li><li>普通用户不能为目录创建硬链接（主要是为了防止文件系统遍历时出现循环引用问题）。</li></ul></li><li><strong>软链接的陷阱</strong>：<ul><li><strong>悬空链接</strong>：目标文件被移动或删除后，软链接会失效。</li><li><strong>相对路径问题</strong>：使用相对路径创建的软链接，如果其本身被移动，可能会解析失败。<strong>建议创建时使用绝对路径</strong>。</li><li><strong>循环链接</strong>：虽然罕见，但软链接可以形成循环（如 A -> B, B -> A），某些工具可能无法正确处理。</li></ul></li><li><strong>删除操作</strong>：<ul><li>删除软链接使用 <code>rm softlink_name</code>，这<strong>只会删除链接本身</strong>，不会影响目标文件。</li><li>删除硬链接使用 <code>rm hardlink_name</code>，这会减少 inode 的链接计数，<strong>只有所有硬链接被删除后数据才会被释放</strong>。</li></ul></li></ol><hr><h3 id=-总结>💎 总结</h3><p>简单来说，<strong>硬链接像是给文件起了个别名</strong>，而<strong>软链接更像是文件的快捷方式</strong>。</p><p>选择时记住一个原则：如果你的需求集中在<strong>同一文件系统内</strong>的数据保护、节省空间和效率上，优先考虑<strong>硬链接</strong>。如果你需要<strong>跨文件系统</strong>、为目录创建链接或者更灵活的路径管理，<strong>软链接</strong>是你的不二之选。</p><p>希望这份详细的对比能帮助你彻底理解并灵活运用它们！</p><h2 id=tail--last>tail & last</h2><p><code>tail</code>和 <code>last</code>是 Linux 中两个名称相似但功能完全不同的命令。简单来说，<code>tail</code>用于<strong>查看文件的尾部内容</strong>，而 <code>last</code>用于<strong>查看系统的用户登录历史</strong>。</p><p>下面这个表格汇总了它们的核心区别，帮你快速把握要点：</p><div class=table-wrapper><table><thead><tr><th>特性</th><th><strong><code>tail</code></strong></th><th><strong><code>last</code></strong></th></tr></thead><tbody><tr><td><strong>核心功能</strong></td><td>查看<strong>文件末尾</strong>的内容，支持实时追踪</td><td>查看<strong>用户登录历史</strong>（成功、失败、重启事件）</td></tr><tr><td><strong>处理对象</strong></td><td><strong>任意文本文件</strong>（如日志、配置文件）</td><td><strong>系统二进制日志文件</strong>（<code>/var/log/wtmp</code>, <code>/var/log/btmp</code>）</td></tr><tr><td><strong>数据性质</strong></td><td>静态文件内容</td><td>动态生成的系统登录记录</td></tr><tr><td><strong>常用参数</strong></td><td><code>-n &lt;N></code>(显示最后N行), <code>-f</code>(实时追踪), <code>-c &lt;N></code>(显示最后N字节)</td><td><code>-n &lt;N></code>(显示最近N条记录), <code>-x</code>(显示关机重启), <code>-a</code>(显示登录IP/主机名)</td></tr><tr><td><strong>典型用途</strong></td><td>实时监控日志、查看最新记录、提取文件尾部片段</td><td>审计安全、排查故障、查看用户活动时间</td></tr><tr><td><strong>输出示例</strong></td><td><code>Line 998</code> <code>Line 999</code> <code>Line 1000</code></td><td><code>user1 pts/0 192.168.1.100 Mon 10:30 - 11:30 (01:00)</code> <code>reboot system boot 5.4.0-72-generic Mon Nov 8 09:10 - 11:35 (02:25)</code></td></tr></tbody></table></div><hr><h3 id=-命令详解与使用场景>📝 命令详解与使用场景</h3><h4 id=1-tail查看文件尾部>1. <code>tail</code>：查看文件尾部</h4><p><code>tail</code>命令读取<strong>任意文本文件</strong>的末尾部分，默认显示最后10行。它在运维和开发中极高频率使用。</p><ul><li><strong>核心功能与参数</strong>：<ul><li><code>tail -n &lt;N> &lt;file></code>：显示文件最后 <code>N</code>行。例如 <code>tail -n 20 system.log</code>显示最后20行。</li><li><code>tail -f &lt;file></code>：<strong>实时追踪</strong>文件的新增内容。这是监控日志文件（如应用日志、系统日志）的利器。监控时会持续刷新显示新内容，直到用 <code>Ctrl+C</code>手动中断。</li><li><code>tail -c &lt;N> &lt;file></code>：显示文件最后 <code>N</code>个字节的内容。</li></ul></li><li><strong>典型使用场景</strong>：<ul><li><strong>实时监控日志</strong>：故障排查时，常用 <code>tail -f /var/log/syslog</code>或 <code>tail -f application.log</code>来实时观察最新日志输出。</li><li><strong>查看最新记录</strong>：检查作业执行结果或文件最近更新，如 <code>tail -n 50 output.txt</code>。</li><li><strong>提取文件片段</strong>：结合重定向，保存文件尾部内容，如 <code>tail -n 100 largefile.log > last100.log</code>。</li></ul></li></ul><h4 id=2-last查看登录历史>2. <code>last</code>：查看登录历史</h4><p><code>last</code>命令查询的是系统<strong>预定义的二进制日志文件</strong>，专门记录用户登录、注销、重启等信息。主要用于系统管理和安全审计。</p><ul><li><strong>核心功能与参数</strong>：<ul><li><code>last</code>：默认显示所有用户最近的登录记录，按时间倒序排列。</li><li><code>last -n &lt;N></code>：仅显示最近 <code>N</code>条记录。如 <code>last -n 5</code>。</li><li><code>last &lt;username></code>：查看特定用户的登录历史。如 <code>last root</code>。</li><li><code>last -x</code>：显示<strong>系统关机（halt）和重启（reboot）</strong> 记录。</li><li><code>last -a</code>：在最后一列显示登录的<strong>IP地址或主机名</strong>，使得输出更易读。</li><li><code>last -f &lt;file></code>：指定读取的日志文件（默认为 <code>/var/log/wtmp</code>），高级用法。</li></ul></li><li><strong>数据来源</strong>：<ul><li><code>/var/log/wtmp</code>：记录<strong>成功的</strong>用户登录会话（登录、注销、持续时间）。</li><li><code>/var/log/btmp</code>：记录<strong>失败的</strong>登录尝试（需要指定 <code>-f /var/log/btmp</code>或使用 <code>lastb</code>命令）。</li></ul></li><li><strong>典型使用场景</strong>：<ul><li><strong>安全审计</strong>：检查是否有异常时间或来源的登录，排查潜在入侵。</li><li><strong>故障排查</strong>：查看系统重启时间是否与故障时间吻合，或用户是否成功登录。</li><li><strong>用户行为查看</strong>：了解特定用户（如离职员工）近期的系统活动时间。</li></ul></li></ul><hr><h3 id=-重要注意事项>⚠️ 重要注意事项</h3><ol><li><strong>权限要求</strong>：<ul><li><code>tail</code>：通常只需有对目标文件的读取权限即可。</li><li><code>last</code>：普通用户只能查看到与自己相关的登录历史（某些系统配置下）。查看所有用户的完整历史通常需要 <code>root</code>权限。</li></ul></li><li><strong>实时性</strong>：<ul><li><code>tail -f</code>可以实时看到文件的最新写入。</li><li><code>last</code>查询的是历史记录文件，其更新通常有轻微延迟，并且需要登录会话完全结束（用户注销或连接断开）后，记录才会完整写入。</li></ul></li><li><strong>文件格式</strong>：<ul><li><code>tail</code>处理的是可读的纯文本文件。</li><li><code>last</code>读取的 <code>/var/log/wtmp</code>和 <code>/var/log/btmp</code>是<strong>二进制格式</strong>，不能用 <code>cat</code>或 <code>vi</code>直接查看，必须通过 <code>last</code>或专用工具（如 <code>utmpdump</code>）解析。</li></ul></li></ol><hr><h3 id=-总结与如何选择>💎 总结与如何选择</h3><p>记住一个简单的原则：</p><ul><li>当你想<strong>查看一个文本文件（尤其是日志）的最后部分内容，或者实时监控它的增长</strong>时，就用 <strong><code>tail</code></strong>。</li><li>当你想<strong>查看谁在什么时候登录了系统、系统何时重启过，或者是否有失败的登录尝试</strong>时，就用 <strong><code>last</code></strong>。</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/nowcoder/>NowCoder</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Sep 30, 2025 19:46 CST</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/nowcoderreference/><div class=article-details><h2 class=article-title>【NowCoder】Reference</h2></div></a></article><article><a href=/p/nowcoder25-oct/><div class=article-details><h2 class=article-title>【NowCoder】25 Oct</h2></div></a></article><article><a href=/p/nowcoderkafka-2/><div class=article-details><h2 class=article-title>【NowCoder】Kafka 2</h2></div></a></article><article><a href=/p/nowcodermybatis-2/><div class=article-details><h2 class=article-title>【NowCoder】Mybatis 2</h2></div></a></article><article><a href=/p/nowcoderredis-2/><div class=article-details><h2 class=article-title>【NowCoder】Redis 2</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 飞鸿踏雪泥</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>