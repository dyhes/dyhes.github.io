<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="1. 概念设计 1.1 ER图 下图为论坛系统数据库设计的ER图，为了简洁期间我们从ER图中移除了实体共有的属性（id，创建日期等），仅在后续的数据字典中体现。\n1.2 数据字典 1.2.1 用户 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 用户的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 用户创建时的时间戳。 username VARCHAR(255) NOT NULL, UNIQUE 用户的唯一用户名。 nickname VARCHAR(255) 用户的可选昵称。 password VARCHAR(255) NOT NULL 用户的加密密码。 email VARCHAR(255) 用户的电子邮件地址。 showEmail BOOLEAN 是否向其他人显示电子邮件地址。 avatar VARCHAR(255) 用户头像图片的 URL 或路径。 bindedWeChat VARCHAR(255) 用户绑定的微信账号（可选字段）。 bindedAliPay VARCHAR(255) 用户绑定的支付宝账号（可选字段）。 1.2.2 空间 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 空间的唯一标识符。 name VARCHAR(255) NOT NULL, UNIQUE 空间的唯一名称，用于标识每个空间。 description VARCHAR(255) NOT NULL 空间的描述信息，通常用于介绍空间的目的和内容。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 空间创建时的时间戳。 isArchived BOOLEAN 标识空间是否被归档（归档后可能不再活跃）。 avatar VARCHAR(255) 空间头像的 URL 或路径。 1.2.3 帖子 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT, 不可更新 帖子的唯一标识符。 subject VARCHAR(255) NOT NULL 帖子的主题，用于标题或概述。 content TEXT NOT NULL 帖子的内容，通常为正文。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 帖子创建时的时间戳。 status TINYINT NOT NULL, ENUM(ORDINAL) 帖子的状态（例如草稿、已发布、被删除等）。 positiveCount BIGINT 帖子的正向反馈数量（如点赞数）。 negativeCount BIGINT 帖子的负向反馈数量（如点踩数）。 commentCount BIGINT 帖子的评论总数量。 1.2.4 评论 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 评论的唯一标识符。 content TEXT NOT NULL 评论的正文内容。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 评论创建时的时间戳。 positiveCount BIGINT 评论的正向反馈数量（如点赞数）。 negativeCount BIGINT 评论的负向反馈数量（如点踩数）。 1.2.5 观点 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 意见的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 意见创建的时间戳。 isPositive BOOLEAN NOT NULL 标识该意见是否为正向意见（例如点赞）。 opinion_type VARCHAR(31) NOT NULL 用于区分意见的类型（例如评论意见或帖子意见等）。 1.2.6 通知 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 空间用户信息的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 记录用户加入空间的时间。 content TEXT NOT NULL 通知。 1.2.7 关系 关联实体1 关联实体2 类型 解释 用户 空间 多对多 用户可以加入多个空间，空间可以拥有多个用户 用户 帖子 一对多 用户可以创建多个帖子 用户 评论 一对多 用户可以发表多个评论 用户 观点 一对多 用户可以发表多个观点 用户 通知 一对多 用户可以收到多个通知 空间 帖子 一对多 空间中可以有多个帖子 帖子 评论 一对多 帖子可以有多个评论 帖子 观点 一对多 帖子可以收到多个赞同或反对 评论 评论 一对多 评论可以有多个子评论 评论 观点 一对多 评论可以收到多个赞同或反对 1.3 用例图 "><title>【Postopia】设计文档</title><link rel=canonical href=https://dyhes.github.io/p/postopia%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/><link rel=stylesheet href=/scss/style.min.f7091bff8043bd3e53b22be6c05dd86b506e8dec4d0d75d249d2dfb0fe074a46.css><meta property='og:title' content="【Postopia】设计文档"><meta property='og:description' content="1. 概念设计 1.1 ER图 下图为论坛系统数据库设计的ER图，为了简洁期间我们从ER图中移除了实体共有的属性（id，创建日期等），仅在后续的数据字典中体现。\n1.2 数据字典 1.2.1 用户 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 用户的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 用户创建时的时间戳。 username VARCHAR(255) NOT NULL, UNIQUE 用户的唯一用户名。 nickname VARCHAR(255) 用户的可选昵称。 password VARCHAR(255) NOT NULL 用户的加密密码。 email VARCHAR(255) 用户的电子邮件地址。 showEmail BOOLEAN 是否向其他人显示电子邮件地址。 avatar VARCHAR(255) 用户头像图片的 URL 或路径。 bindedWeChat VARCHAR(255) 用户绑定的微信账号（可选字段）。 bindedAliPay VARCHAR(255) 用户绑定的支付宝账号（可选字段）。 1.2.2 空间 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 空间的唯一标识符。 name VARCHAR(255) NOT NULL, UNIQUE 空间的唯一名称，用于标识每个空间。 description VARCHAR(255) NOT NULL 空间的描述信息，通常用于介绍空间的目的和内容。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 空间创建时的时间戳。 isArchived BOOLEAN 标识空间是否被归档（归档后可能不再活跃）。 avatar VARCHAR(255) 空间头像的 URL 或路径。 1.2.3 帖子 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT, 不可更新 帖子的唯一标识符。 subject VARCHAR(255) NOT NULL 帖子的主题，用于标题或概述。 content TEXT NOT NULL 帖子的内容，通常为正文。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 帖子创建时的时间戳。 status TINYINT NOT NULL, ENUM(ORDINAL) 帖子的状态（例如草稿、已发布、被删除等）。 positiveCount BIGINT 帖子的正向反馈数量（如点赞数）。 negativeCount BIGINT 帖子的负向反馈数量（如点踩数）。 commentCount BIGINT 帖子的评论总数量。 1.2.4 评论 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 评论的唯一标识符。 content TEXT NOT NULL 评论的正文内容。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 评论创建时的时间戳。 positiveCount BIGINT 评论的正向反馈数量（如点赞数）。 negativeCount BIGINT 评论的负向反馈数量（如点踩数）。 1.2.5 观点 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 意见的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 意见创建的时间戳。 isPositive BOOLEAN NOT NULL 标识该意见是否为正向意见（例如点赞）。 opinion_type VARCHAR(31) NOT NULL 用于区分意见的类型（例如评论意见或帖子意见等）。 1.2.6 通知 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 空间用户信息的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 记录用户加入空间的时间。 content TEXT NOT NULL 通知。 1.2.7 关系 关联实体1 关联实体2 类型 解释 用户 空间 多对多 用户可以加入多个空间，空间可以拥有多个用户 用户 帖子 一对多 用户可以创建多个帖子 用户 评论 一对多 用户可以发表多个评论 用户 观点 一对多 用户可以发表多个观点 用户 通知 一对多 用户可以收到多个通知 空间 帖子 一对多 空间中可以有多个帖子 帖子 评论 一对多 帖子可以有多个评论 帖子 观点 一对多 帖子可以收到多个赞同或反对 评论 评论 一对多 评论可以有多个子评论 评论 观点 一对多 评论可以收到多个赞同或反对 1.3 用例图 "><meta property='og:url' content='https://dyhes.github.io/p/postopia%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/'><meta property='og:site_name' content='飞鸿踏雪泥'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Postopia'><meta property='article:published_time' content='2024-11-19T00:00:00+00:00'><meta property='article:modified_time' content='2025-10-22T16:27:30+08:00'><meta name=twitter:title content="【Postopia】设计文档"><meta name=twitter:description content="1. 概念设计 1.1 ER图 下图为论坛系统数据库设计的ER图，为了简洁期间我们从ER图中移除了实体共有的属性（id，创建日期等），仅在后续的数据字典中体现。\n1.2 数据字典 1.2.1 用户 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 用户的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 用户创建时的时间戳。 username VARCHAR(255) NOT NULL, UNIQUE 用户的唯一用户名。 nickname VARCHAR(255) 用户的可选昵称。 password VARCHAR(255) NOT NULL 用户的加密密码。 email VARCHAR(255) 用户的电子邮件地址。 showEmail BOOLEAN 是否向其他人显示电子邮件地址。 avatar VARCHAR(255) 用户头像图片的 URL 或路径。 bindedWeChat VARCHAR(255) 用户绑定的微信账号（可选字段）。 bindedAliPay VARCHAR(255) 用户绑定的支付宝账号（可选字段）。 1.2.2 空间 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 空间的唯一标识符。 name VARCHAR(255) NOT NULL, UNIQUE 空间的唯一名称，用于标识每个空间。 description VARCHAR(255) NOT NULL 空间的描述信息，通常用于介绍空间的目的和内容。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 空间创建时的时间戳。 isArchived BOOLEAN 标识空间是否被归档（归档后可能不再活跃）。 avatar VARCHAR(255) 空间头像的 URL 或路径。 1.2.3 帖子 属性 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT, 不可更新 帖子的唯一标识符。 subject VARCHAR(255) NOT NULL 帖子的主题，用于标题或概述。 content TEXT NOT NULL 帖子的内容，通常为正文。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 帖子创建时的时间戳。 status TINYINT NOT NULL, ENUM(ORDINAL) 帖子的状态（例如草稿、已发布、被删除等）。 positiveCount BIGINT 帖子的正向反馈数量（如点赞数）。 negativeCount BIGINT 帖子的负向反馈数量（如点踩数）。 commentCount BIGINT 帖子的评论总数量。 1.2.4 评论 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 评论的唯一标识符。 content TEXT NOT NULL 评论的正文内容。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 评论创建时的时间戳。 positiveCount BIGINT 评论的正向反馈数量（如点赞数）。 negativeCount BIGINT 评论的负向反馈数量（如点踩数）。 1.2.5 观点 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 意见的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 意见创建的时间戳。 isPositive BOOLEAN NOT NULL 标识该意见是否为正向意见（例如点赞）。 opinion_type VARCHAR(31) NOT NULL 用于区分意见的类型（例如评论意见或帖子意见等）。 1.2.6 通知 字段名称 数据类型 约束 描述 id BIGINT PRIMARY KEY, AUTO_INCREMENT 空间用户信息的唯一标识符。 createdAt TIMESTAMP NOT NULL, AUDIT-CREATED 记录用户加入空间的时间。 content TEXT NOT NULL 通知。 1.2.7 关系 关联实体1 关联实体2 类型 解释 用户 空间 多对多 用户可以加入多个空间，空间可以拥有多个用户 用户 帖子 一对多 用户可以创建多个帖子 用户 评论 一对多 用户可以发表多个评论 用户 观点 一对多 用户可以发表多个观点 用户 通知 一对多 用户可以收到多个通知 空间 帖子 一对多 空间中可以有多个帖子 帖子 评论 一对多 帖子可以有多个评论 帖子 观点 一对多 帖子可以收到多个赞同或反对 评论 评论 一对多 评论可以有多个子评论 评论 观点 一对多 评论可以收到多个赞同或反对 1.3 用例图 "><link rel="shortcut icon" href=/github.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_b567f26f71c49c33.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>飞鸿踏雪泥</a></h1><h2 class=site-description>没有记录，就没有发生</h2></div></header><ol class=menu-social><li><a href=https://leetcode.cn/u/dyhes/ target=_blank title=LeetCode rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 13h7.5"/><path d="M9.424 7.268l4.999-4.999"/><path d="M16.633 16.644l-2.402 2.415a3.189 3.189.0 01-4.524.0l-3.77-3.787a3.223 3.223.0 010-4.544l3.77-3.787a3.189 3.189.0 014.524.0l2.302 2.313"/></svg></a></li><li><a href=https://github.com/dyhes target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:dyheslin@gmail.com target=_blank title=Gmail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-gmail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M16 20h3a1 1 0 001-1V5a1 1 0 00-1-1h-3v16z"/><path d="M5 20h3V4H5A1 1 0 004 5v14a1 1 0 001 1z"/><path d="M16 4l-4 4-4-4"/><path d="M4 6.5l8 7.5 8-7.5"/></svg></a></li><li><a href=mailto:1325574784@qq.com target=_blank title=Mail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 19H5a2 2 0 01-2-2V7a2 2 0 012-2h14a2 2 0 012 2v5.5"/><path d="M3 7l9 6 9-6"/><path d="M19 16l-2 3h4l-2 3"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/categories/><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/tags/><svg class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>Tags</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1-概念设计>1. 概念设计</a><ol><li><a href=#11-er图>1.1 ER图</a></li><li><a href=#12-数据字典>1.2 数据字典</a><ol><li><a href=#121-用户>1.2.1 用户</a></li><li><a href=#122-空间>1.2.2 空间</a></li><li><a href=#123-帖子>1.2.3 帖子</a></li><li><a href=#124-评论>1.2.4 评论</a></li><li><a href=#125-观点>1.2.5 观点</a></li><li><a href=#126-通知>1.2.6 通知</a></li><li><a href=#127-关系>1.2.7 关系</a></li></ol></li><li><a href=#13-用例图>1.3 用例图</a></li></ol></li><li><a href=#2-逻辑设计>2. 逻辑设计</a><ol><li><a href=#21-全局逻辑设计>2.1 全局逻辑设计</a><ol><li><a href=#211-表结构设计>2.1.1 表结构设计</a></li><li><a href=#212-索引设计>2.1.2 索引设计</a></li><li><a href=#213-视图设计>2.1.3 视图设计</a></li><li><a href=#214-规范化>2.1.4 规范化</a></li></ol></li><li><a href=#22-分布设计>2.2 分布设计</a><ol><li><a href=#221-分片设计>2.2.1 分片设计</a></li><li><a href=#222-非冗余分配>2.2.2 非冗余分配</a></li><li><a href=#223-冗余分配>2.2.3 冗余分配</a></li></ol></li><li><a href=#23-局部逻辑设计>2.3 局部逻辑设计</a><ol><li><a href=#231-表结构设计>2.3.1 表结构设计</a></li><li><a href=#233-索引设计>2.3.3 索引设计</a></li><li><a href=#234-视图设计>2.3.4 视图设计</a></li><li><a href=#235-规范化>2.3.5 规范化</a></li></ol></li><li><a href=#24-局部物理设计>2.4 局部物理设计</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/moon/ style=background-color:#b7ae8f;color:>月满西楼
</a><a href=/categories/snow/ style=background-color:#aa6a4c;color:>踏雪泥</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/postopia%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/>【Postopia】设计文档</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Nov 19, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>6 minute read</time></div></footer></div></header><section class=article-content><h2 id=1-概念设计>1. 概念设计</h2><h3 id=11-er图>1.1 ER图</h3><p>下图为论坛系统数据库设计的ER图，为了简洁期间我们从ER图中移除了实体共有的属性（id，创建日期等），仅在后续的数据字典中体现。</p><p><img src=https://i.ibb.co/rG9dCHRq/image-20241114213022716.png loading=lazy alt=image-20241114213022716></p><h3 id=12-数据字典>1.2 数据字典</h3><h4 id=121-用户>1.2.1 用户</h4><div class=table-wrapper><table><thead><tr><th><strong>属性</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>用户的唯一标识符。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>用户创建时的时间戳。</td></tr><tr><td><code>username</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code>, <code>UNIQUE</code></td><td>用户的唯一用户名。</td></tr><tr><td><code>nickname</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户的可选昵称。</td></tr><tr><td><code>password</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>用户的加密密码。</td></tr><tr><td><code>email</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户的电子邮件地址。</td></tr><tr><td><code>showEmail</code></td><td><code>BOOLEAN</code></td><td></td><td>是否向其他人显示电子邮件地址。</td></tr><tr><td><code>avatar</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户头像图片的 URL 或路径。</td></tr><tr><td><code>bindedWeChat</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户绑定的微信账号（可选字段）。</td></tr><tr><td><code>bindedAliPay</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户绑定的支付宝账号（可选字段）。</td></tr></tbody></table></div><h4 id=122-空间>1.2.2 空间</h4><div class=table-wrapper><table><thead><tr><th><strong>属性</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>空间的唯一标识符。</td></tr><tr><td><code>name</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code>, <code>UNIQUE</code></td><td>空间的唯一名称，用于标识每个空间。</td></tr><tr><td><code>description</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>空间的描述信息，通常用于介绍空间的目的和内容。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>空间创建时的时间戳。</td></tr><tr><td><code>isArchived</code></td><td><code>BOOLEAN</code></td><td></td><td>标识空间是否被归档（归档后可能不再活跃）。</td></tr><tr><td><code>avatar</code></td><td><code>VARCHAR(255)</code></td><td></td><td>空间头像的 URL 或路径。</td></tr></tbody></table></div><h4 id=123-帖子>1.2.3 帖子</h4><div class=table-wrapper><table><thead><tr><th><strong>属性</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code>, <code>不可更新</code></td><td>帖子的唯一标识符。</td></tr><tr><td><code>subject</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>帖子的主题，用于标题或概述。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>帖子的内容，通常为正文。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>帖子创建时的时间戳。</td></tr><tr><td><code>status</code></td><td><code>TINYINT</code></td><td><code>NOT NULL</code>, <code>ENUM(ORDINAL)</code></td><td>帖子的状态（例如草稿、已发布、被删除等）。</td></tr><tr><td><code>positiveCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的正向反馈数量（如点赞数）。</td></tr><tr><td><code>negativeCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的负向反馈数量（如点踩数）。</td></tr><tr><td><code>commentCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的评论总数量。</td></tr></tbody></table></div><h4 id=124-评论>1.2.4 评论</h4><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>评论的唯一标识符。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>评论的正文内容。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>评论创建时的时间戳。</td></tr><tr><td><code>positiveCount</code></td><td><code>BIGINT</code></td><td></td><td>评论的正向反馈数量（如点赞数）。</td></tr><tr><td><code>negativeCount</code></td><td><code>BIGINT</code></td><td></td><td>评论的负向反馈数量（如点踩数）。</td></tr></tbody></table></div><h4 id=125-观点>1.2.5 观点</h4><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>意见的唯一标识符。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>意见创建的时间戳。</td></tr><tr><td><code>isPositive</code></td><td><code>BOOLEAN</code></td><td><code>NOT NULL</code></td><td>标识该意见是否为正向意见（例如点赞）。</td></tr><tr><td><code>opinion_type</code></td><td><code>VARCHAR(31)</code></td><td><code>NOT NULL</code></td><td>用于区分意见的类型（例如评论意见或帖子意见等）。</td></tr></tbody></table></div><h4 id=126-通知>1.2.6 通知</h4><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>空间用户信息的唯一标识符。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>记录用户加入空间的时间。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>通知。</td></tr></tbody></table></div><h4 id=127-关系>1.2.7 关系</h4><div class=table-wrapper><table><thead><tr><th><strong>关联实体1</strong></th><th><strong>关联实体2</strong></th><th><strong>类型</strong></th><th><strong>解释</strong></th></tr></thead><tbody><tr><td>用户</td><td>空间</td><td>多对多</td><td>用户可以加入多个空间，空间可以拥有多个用户</td></tr><tr><td>用户</td><td>帖子</td><td>一对多</td><td>用户可以创建多个帖子</td></tr><tr><td>用户</td><td>评论</td><td>一对多</td><td>用户可以发表多个评论</td></tr><tr><td>用户</td><td>观点</td><td>一对多</td><td>用户可以发表多个观点</td></tr><tr><td>用户</td><td>通知</td><td>一对多</td><td>用户可以收到多个通知</td></tr><tr><td>空间</td><td>帖子</td><td>一对多</td><td>空间中可以有多个帖子</td></tr><tr><td>帖子</td><td>评论</td><td>一对多</td><td>帖子可以有多个评论</td></tr><tr><td>帖子</td><td>观点</td><td>一对多</td><td>帖子可以收到多个赞同或反对</td></tr><tr><td>评论</td><td>评论</td><td>一对多</td><td>评论可以有多个子评论</td></tr><tr><td>评论</td><td>观点</td><td>一对多</td><td>评论可以收到多个赞同或反对</td></tr></tbody></table></div><h3 id=13-用例图>1.3 用例图</h3><p><img src=https://i.ibb.co/60pL0ZJv/image-20241115193639427.png loading=lazy alt=image-20241115193639427></p><h2 id=2-逻辑设计>2. 逻辑设计</h2><h3 id=21-全局逻辑设计>2.1 全局逻辑设计</h3><h4 id=211-表结构设计>2.1.1 表结构设计</h4><h5 id=2111-users>2.1.1.1 users</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>用户的唯一标识符。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>用户创建时的时间戳。</td></tr><tr><td><code>username</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code>, <code>UNIQUE</code></td><td>用户的唯一用户名。</td></tr><tr><td><code>nickname</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户的可选昵称。</td></tr><tr><td><code>password</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>用户的加密密码。</td></tr><tr><td><code>email</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户的电子邮件地址。</td></tr><tr><td><code>showEmail</code></td><td><code>BOOLEAN</code></td><td></td><td>是否向其他人显示电子邮件地址。</td></tr><tr><td><code>avatar</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户头像图片的 URL 或路径。</td></tr><tr><td><code>bindedWeChat</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户绑定的微信账号（可选字段）。</td></tr><tr><td><code>bindedAliPay</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户绑定的支付宝账号（可选字段）。</td></tr></tbody></table></div><h5 id=2112-spaces>2.1.1.2 spaces</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>空间的唯一标识符。</td></tr><tr><td><code>name</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code>, <code>UNIQUE</code></td><td>空间的唯一名称，用于标识每个空间。</td></tr><tr><td><code>description</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>空间的描述信息，通常用于介绍空间的目的和内容。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>空间创建时的时间戳。</td></tr><tr><td><code>isArchived</code></td><td><code>BOOLEAN</code></td><td></td><td>标识空间是否被归档（归档后可能不再活跃）。</td></tr><tr><td><code>avatar</code></td><td><code>VARCHAR(255)</code></td><td></td><td>空间头像的 URL 或路径。</td></tr></tbody></table></div><h5 id=2113-posts>2.1.1.3 posts</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code>, <code>不可更新</code></td><td>帖子的唯一标识符。</td></tr><tr><td><code>subject</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>帖子的主题，用于标题或概述。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>帖子的内容，通常为正文。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>NOT NULL</code>, <code>不可更新</code>, <code>FOREIGN KEY</code></td><td>发布帖子的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>space_id</code></td><td><code>BIGINT</code></td><td><code>NOT NULL</code>, <code>不可更新</code>, <code>FOREIGN KEY</code></td><td>帖子所属空间的唯一标识符，关联到 <code>spaces</code> 表。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>帖子创建时的时间戳。</td></tr><tr><td><code>status</code></td><td><code>TINYINT</code></td><td><code>NOT NULL</code>, <code>ENUM(ORDINAL)</code></td><td>帖子的状态（例如草稿、已发布、被删除等）。</td></tr><tr><td><code>positiveCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的正向反馈数量（如点赞数）。</td></tr><tr><td><code>negativeCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的负向反馈数量（如点踩数）。</td></tr><tr><td><code>commentCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的评论总数量。</td></tr></tbody></table></div><h5 id=2114-comments>2.1.1.4 comments</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>评论的唯一标识符。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>评论的正文内容。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>发布评论的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>post_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>评论所属帖子的唯一标识符，关联到 <code>posts</code> 表。</td></tr><tr><td><code>space_id</code></td><td><code>BIGINT</code></td><td><code>NOT NULL</code>, <code>不可更新</code>, <code>FOREIGN KEY</code></td><td>评论所属空间的唯一标识符，关联到 <code>spaces</code> 表。</td></tr><tr><td><code>parent_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>父级评论的唯一标识符，用于支持评论的嵌套结构。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>评论创建时的时间戳。</td></tr><tr><td><code>positiveCount</code></td><td><code>BIGINT</code></td><td></td><td>评论的正向反馈数量（如点赞数）。</td></tr><tr><td><code>negativeCount</code></td><td><code>BIGINT</code></td><td></td><td>评论的负向反馈数量（如点踩数）。</td></tr></tbody></table></div><h5 id=2115-opinions>2.1.1.5 opinions</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>意见的唯一标识符。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>意见创建的时间戳。</td></tr><tr><td><code>isPositive</code></td><td><code>BOOLEAN</code></td><td><code>NOT NULL</code></td><td>标识该意见是否为正向意见（例如点赞）。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>提交该意见的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>opinion_type</code></td><td><code>VARCHAR(31)</code></td><td><code>NOT NULL</code></td><td>用于区分意见的类型（例如评论意见或帖子意见等）。</td></tr><tr><td><code>post_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>该意见相关的帖子的唯一标识符，关联到 <code>posts</code> 表，仅在意见为帖子意见时有意义</td></tr><tr><td><code>comment_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>该意见相关的评论的唯一标识符，关联到 <code>comments</code> 表，仅在意见为评论意见时有意义</td></tr></tbody></table></div><h5 id=2116-notifications>2.1.1.6 notifications</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>空间用户信息的唯一标识符。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code>, <code>NOT NULL</code></td><td>关联的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>记录用户加入空间的时间。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>通知。</td></tr></tbody></table></div><h5 id=2117-space_user_infos>2.1.1.7 space_user_infos</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>空间用户信息的唯一标识符。</td></tr><tr><td><code>space_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code>, <code>NOT NULL</code></td><td>关联的空间的唯一标识符，关联到 <code>spaces</code> 表。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code>, <code>NOT NULL</code></td><td>关联的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>记录用户加入空间的时间。</td></tr><tr><td><code>lastActiveAt</code></td><td><code>DATE</code></td><td></td><td>用户在空间中最近活跃的日期。</td></tr></tbody></table></div><h4 id=212-索引设计>2.1.2 索引设计</h4><p>OceanBase 数据库中，索引可以分为两种类型：本地索引和全局索引。两者之间的区别在于：本地索引与分区数据共用分区，全局索引为单独分区。</p><p>OceanBase推荐按照本地索引->全局分区索引->全局索引的顺序进行选择，非必要情况下不建议使用全局索引。全局索引维护代价很高，数据的增删改都需要维护全局索引， 不适宜大量使用。数据的查询要尽量使用主键或只要数据能在分区内保证唯一，则没必要使用全局索引。</p><p>因此除了全局的主键索引（OceanBase自动建立）外，仅建立本地索引，其细节将在 2.3 局部逻辑设计中详细讨论。</p><h4 id=213-视图设计>2.1.3 视图设计</h4><p>考虑到在展示帖子列表、帖子评论时需要同时展示发帖者、评论者信息，建立视图 user_posts 和 user_comments。</p><p><strong>user_posts：</strong></p><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td>帖子的唯一标识符。</td></tr><tr><td><code>subject</code></td><td><code>VARCHAR(255)</code></td><td>帖子的主题，用于标题或概述。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td>帖子的内容，通常为正文。</td></tr><tr><td><code>space_id</code></td><td><code>BIGINT</code></td><td>帖子所属空间的唯一标识符，关联到 <code>spaces</code> 表。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td>帖子创建时的时间戳。</td></tr><tr><td><code>status</code></td><td><code>TINYINT</code></td><td>帖子的状态（例如草稿、已发布、被删除等）。</td></tr><tr><td><code>positiveCount</code></td><td><code>BIGINT</code></td><td>帖子的正向反馈数量（如点赞数）。</td></tr><tr><td><code>negativeCount</code></td><td><code>BIGINT</code></td><td>帖子的负向反馈数量（如点踩数）。</td></tr><tr><td><code>commentCount</code></td><td><code>BIGINT</code></td><td>帖子的评论总数量。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td>用户 id。</td></tr><tr><td><code>nickname</code></td><td><code>VARCHAR(255)</code></td><td>用户的可选昵称。</td></tr><tr><td><code>avatar</code></td><td><code>VARCHAR(255)</code></td><td>用户头像图片的 URL 或路径。</td></tr></tbody></table></div><p><strong>user_comments：</strong></p><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td>评论的唯一标识符。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td>评论的正文内容。</td></tr><tr><td><code>post_id</code></td><td><code>BIGINT</code></td><td>评论所属帖子的唯一标识符，关联到 <code>posts</code> 表。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td>评论创建时的时间戳。</td></tr><tr><td><code>positiveCount</code></td><td><code>BIGINT</code></td><td>评论的正向反馈数量（如点赞数）。</td></tr><tr><td><code>negativeCount</code></td><td><code>BIGINT</code></td><td>评论的负向反馈数量（如点踩数）。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td>用户 id。</td></tr><tr><td><code>nickname</code></td><td><code>VARCHAR(255)</code></td><td>用户的可选昵称。</td></tr><tr><td><code>avatar</code></td><td><code>VARCHAR(255)</code></td><td>用户头像图片的 URL 或路径。</td></tr></tbody></table></div><p>考虑到请求空间列表时需要根据加入空间的人数对空间进行排序，因此建立持久化视图 space_member_counts并定期刷新。</p><p><strong>space_member_counts：</strong></p><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td>空间的唯一标识符。</td></tr><tr><td><code>count</code></td><td><code>BIGINT</code></td><td>加入空间的用户数。</td></tr></tbody></table></div><h4 id=214-规范化>2.1.4 规范化</h4><p>上述表符合BCNF范式，更高的范式虽然可以减少数据冗余，但可能会增加查询的复杂性和维护的难度，因此不再继续进行规范化。</p><h3 id=22-分布设计>2.2 分布设计</h3><h4 id=221-分片设计>2.2.1 分片设计</h4><h5 id=2211-垂直分片设计>2.2.1.1 垂直分片设计</h5><p>OceanBase不支持垂直分片，因此我们在建表时就根据业务需求对 2.1.1中各表进行垂直分片设计，直接根据需要对表进行拆分。</p><p>对于users表，根据查询频率拆分为更经常查询的husers和查询频率较低的cusers：</p><p><strong>husers：</strong></p><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>用户的唯一标识符。</td></tr><tr><td><code>username</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code>, <code>UNIQUE</code></td><td>用户的唯一用户名。</td></tr><tr><td><code>nickname</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户的可选昵称。</td></tr><tr><td><code>email</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户的电子邮件地址。</td></tr><tr><td><code>showEmail</code></td><td><code>BOOLEAN</code></td><td></td><td>是否向其他人显示电子邮件地址。</td></tr><tr><td><code>avatar</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户头像图片的 URL 或路径。</td></tr></tbody></table></div><p><strong>cusers：</strong></p><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>用户的唯一标识符。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>用户创建时的时间戳。</td></tr><tr><td><code>password</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>用户的加密密码。</td></tr><tr><td><code>bindedWeChat</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户绑定的微信账号（可选字段）。</td></tr><tr><td><code>bindedAliPay</code></td><td><code>VARCHAR(255)</code></td><td></td><td>用户绑定的支付宝账号（可选字段）。</td></tr></tbody></table></div><h5 id=2212-水平分片设计>2.2.1.2 水平分片设计</h5><p>OceanBase中的水平分片通过分区（Partition）实现。OceanBase可以将普通表的数据按照规则划分到不同的区块内，区块内数据物理上存储在一起，称为分区表，每个区块称为一个分区。OceanBase支持多种分区类型，包括Range分区、Range Columns分区、List分区、List Columns分区、Hash分区、Key分区以及二级分区。</p><p>数据表中每一行中用于计算分区归属的列的集合叫做分区键。由分区键构成的用于计算分区归属的表达式叫做分区表达式。其中Range分区根据分区表达式的值范围进行分区，List分区根据分区表达式的值进行分区，Columns后缀则代表允许使用多列作为分区键，Hash分区通过哈希函数计算的分区键哈希值进行分区，Key分区则通过哈希函数计算的分区键哈希值取模结果进行分区。</p><p>我们根据业务需求对各表进行了分区设计。</p><ul><li>对于 husers和cusers 表，以 <code>id</code> 为分区键进行Key分区，使得用户信息在各节点间均匀分布。</li><li>对于 spaces 表，在查询时往往需要筛除已归档的空间，因此首先以 <code>isArchived</code> 为分区键进行List分区，再以 <code>id</code> 为分区键进行Key二级分区，使得空间信息在各节点间均匀分布。</li><li>对于 posts 表，由于帖子查询往往以空间为单位，因此首先 <code>space_id</code> 为分区键进行List分区，再以 <code>status</code> 为分区键进行List二级分区，便于在展示帖子列表时仅展示发布状态的帖子。</li><li>对于 comments 表，由于评论查询往往以空间中的帖子为单位进行查询，因此首先 <code>space_id</code> 为分区键进行List分区，再以 <code>post_id</code> 为分区键进行Range二级分区。</li><li>对于 opinions 表，由于 posts，comments中有观点数记录，对于观点的查询往往以用户为单位（用户管理或展示用户对帖子、评论的观点），因此以 <code>opinion_type</code> 为分区键进行List分区，区分对于评论或帖子的观点，再以 <code>user_id</code> 为分区键进行Range二级分区。</li><li>对于 notifications 表，由于通知查询往往以用户为单位，因此以 <code>user_id</code> 为分区键进行Range分区。</li><li>对于 space_user_infos 表，由于其主要用于查询用户加入的空间，因此以 <code>user_id</code> 为分区键进行Range分区。</li></ul><h4 id=222-非冗余分配>2.2.2 非冗余分配</h4><p>【OceanBase 动态分区分配】</p><h4 id=223-冗余分配>2.2.3 冗余分配</h4><p>【OceanBase 副本机制】</p><h3 id=23-局部逻辑设计>2.3 局部逻辑设计</h3><h4 id=231-表结构设计>2.3.1 表结构设计</h4><p>在OceanBase中由于主键的唯一性检查是在各个分区内部进行的，如果主键不包含全部分区键，这个检查就会失效，同时需要保证指定主键的查询能很快定位到表所在的分区，分区键必须是主键的子集，因此除了 2.2.1.1 中的husers与cusers外，表结构与 2.1.1 相比发生了如下变化：</p><h5 id=2311-spaces>2.3.1.1 spaces</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>空间的唯一标识符。</td></tr><tr><td><code>isArchived</code></td><td><code>BOOLEAN</code></td><td><code>PRIMARY KEY</code></td><td>标识空间是否被归档（归档后可能不再活跃）。</td></tr><tr><td><code>name</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code>, <code>UNIQUE</code></td><td>空间的唯一名称，用于标识每个空间。</td></tr><tr><td><code>description</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>空间的描述信息，通常用于介绍空间的目的和内容。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>空间创建时的时间戳。</td></tr><tr><td><code>avatar</code></td><td><code>VARCHAR(255)</code></td><td></td><td>空间头像的 URL 或路径。</td></tr></tbody></table></div><p><code>isArchived</code> 成为主键中的字段。</p><h5 id=2312-posts>2.3.1.2 posts</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code>, <code>不可更新</code></td><td>帖子的唯一标识符。</td></tr><tr><td><code>space_id</code></td><td><code>BIGINT</code></td><td><code>NOT NULL</code>, <code>不可更新</code>, <code>FOREIGN KEY</code>,<code>PRIMARY KEY</code></td><td>帖子所属空间的唯一标识符，关联到 <code>spaces</code> 表。</td></tr><tr><td><code>status</code></td><td><code>TINYINT</code></td><td><code>NOT NULL</code>, <code>ENUM(ORDINAL)</code>,<code>PRIMARY KEY</code></td><td>帖子的状态（例如草稿、已发布、被删除等）。</td></tr><tr><td><code>subject</code></td><td><code>VARCHAR(255)</code></td><td><code>NOT NULL</code></td><td>帖子的主题，用于标题或概述。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>帖子的内容，通常为正文。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>NOT NULL</code>, <code>不可更新</code>, <code>FOREIGN KEY</code></td><td>发布帖子的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>帖子创建时的时间戳。</td></tr><tr><td><code>positiveCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的正向反馈数量（如点赞数）。</td></tr><tr><td><code>negativeCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的负向反馈数量（如点踩数）。</td></tr><tr><td><code>commentCount</code></td><td><code>BIGINT</code></td><td></td><td>帖子的评论总数量。</td></tr></tbody></table></div><p><code>space_id</code> 和<code>status</code>成为主键中的字段。</p><h5 id=2313-comments>2.3.1.3 comments</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>评论的唯一标识符。</td></tr><tr><td><code>post_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code>,<code>PRIMARY KEY</code></td><td>评论所属帖子的唯一标识符，关联到 <code>posts</code> 表。</td></tr><tr><td><code>space_id</code></td><td><code>BIGINT</code></td><td><code>NOT NULL</code>, <code>不可更新</code>, <code>FOREIGN KEY</code>,<code>PRIMARY KEY</code></td><td>评论所属空间的唯一标识符，关联到 <code>spaces</code> 表。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>评论的正文内容。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>发布评论的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>parent_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>父级评论的唯一标识符，用于支持评论的嵌套结构。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>评论创建时的时间戳。</td></tr><tr><td><code>positiveCount</code></td><td><code>BIGINT</code></td><td></td><td>评论的正向反馈数量（如点赞数）。</td></tr><tr><td><code>negativeCount</code></td><td><code>BIGINT</code></td><td></td><td>评论的负向反馈数量（如点踩数）。</td></tr></tbody></table></div><p><code>space_id</code> 和<code>post_id</code>成为主键中的字段。</p><h5 id=2314-opinions>2.3.1.4 opinions</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>意见的唯一标识符。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code>,<code>PRIMARY KEY</code></td><td>提交该意见的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>opinion_type</code></td><td><code>VARCHAR(31)</code></td><td><code>NOT NULL</code>,<code>PRIMARY KEY</code></td><td>用于区分意见的类型（例如评论意见或帖子意见等）。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>意见创建的时间戳。</td></tr><tr><td><code>isPositive</code></td><td><code>BOOLEAN</code></td><td><code>NOT NULL</code></td><td>标识该意见是否为正向意见（例如点赞）。</td></tr><tr><td><code>post_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>该意见相关的帖子的唯一标识符，关联到 <code>posts</code> 表，仅在意见为帖子意见时有意义</td></tr><tr><td><code>comment_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code></td><td>该意见相关的评论的唯一标识符，关联到 <code>comments</code> 表，仅在意见为评论意见时有意义</td></tr></tbody></table></div><p><code>opinion_type</code> 和 <code>user_id</code> 成为主键中的字段。</p><h5 id=2315-notifications>2.3.1.5 notifications</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>空间用户信息的唯一标识符。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code>, <code>NOT NULL</code>,<code>PRIMARY KEY</code></td><td>关联的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>记录用户加入空间的时间。</td></tr><tr><td><code>content</code></td><td><code>TEXT</code></td><td><code>NOT NULL</code></td><td>通知。</td></tr></tbody></table></div><p><code>user_id</code> 成为主键中的字段。</p><h5 id=2316-space_user_infos>2.3.1.6 space_user_infos</h5><div class=table-wrapper><table><thead><tr><th><strong>字段名称</strong></th><th><strong>数据类型</strong></th><th><strong>约束</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>id</code></td><td><code>BIGINT</code></td><td><code>PRIMARY KEY</code>, <code>AUTO_INCREMENT</code></td><td>空间用户信息的唯一标识符。</td></tr><tr><td><code>user_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code>, <code>NOT NULL</code>,<code>PRIMARY KEY</code></td><td>关联的用户的唯一标识符，关联到 <code>users</code> 表。</td></tr><tr><td><code>space_id</code></td><td><code>BIGINT</code></td><td><code>FOREIGN KEY</code>, <code>NOT NULL</code></td><td>关联的空间的唯一标识符，关联到 <code>spaces</code> 表。</td></tr><tr><td><code>createdAt</code></td><td><code>TIMESTAMP</code></td><td><code>NOT NULL</code>, <code>AUDIT-CREATED</code></td><td>记录用户加入空间的时间。</td></tr><tr><td><code>lastActiveAt</code></td><td><code>DATE</code></td><td></td><td>用户在空间中最近活跃的日期。</td></tr></tbody></table></div><p><code>user_id</code> 成为主键中的字段。</p><h4 id=233-索引设计>2.3.3 索引设计</h4><p>对于分区后的分区表，我们根据业务查询的需求在如下表上设计了索引。</p><ul><li>对于二级分区（List Partition By <code>space_id</code> + List Partition By <code>status</code> ）后的 posts 表分区，在 <code>createdAt</code> 列上建立本地索引，便于按照创建时间查询帖子。</li><li>对于二级分区（List Partition By <code>space_id</code> + Range Partition By <code>post_id</code> ）后的 comments 表分区，在 <code>post_id</code> 和<code>createdAt</code> 列上建立本地索引，便于按照帖子及评论时间查询评论。</li><li>对于二级分区（List Partition By <code>opinion_type</code> + Range Partition By <code>user_id</code> ）后的 opinions 表分区，在 <code>user_id</code> 列上建立本地索引，便于按照用户查询观点。</li><li>对于分区（Range Partition By <code>user_id</code> ）后的 notifications 表，在 <code>user_id</code> 和 <code>created_at</code> 列上建立复合本地索引，便于按照用户查询按时间排序的通知。</li><li>对于分区（Range Partition By <code>user_id</code> ）后的 space_user_infos 表，在 <code>user_id</code> 和 <code>created_at</code> 列上建立复合本地索引，便于按照用户查询按加入时间排序的空间。</li></ul><h4 id=234-视图设计>2.3.4 视图设计</h4><p>对于持久化视图 space_member_counts，使用与 spaces 表相同的分区方式，即首先以 <code>isArchived</code> 为分区键进行List分区，再以 <code>id</code> 为分区键进行Key二级分区。</p><h4 id=235-规范化>2.3.5 规范化</h4><p>users 表拆分而成的 husers 与 cusers 表同样满足BCNF范式</p><h3 id=24-局部物理设计>2.4 局部物理设计</h3><p>【OceanBase 节点物理设计】</p></section><footer class=article-footer><section class=article-tags><a href=/tags/postopia/>Postopia</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Oct 22, 2025 16:27 CST</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/postopia-dev-logweek-17/><div class=article-details><h2 class=article-title>【Postopia Dev Log】Week 17</h2></div></a></article><article><a href=/p/postopia-dev-logweek-16/><div class=article-details><h2 class=article-title>【Postopia Dev Log】Week 16</h2></div></a></article><article><a href=/p/postopia-dev-logweek-15/><div class=article-details><h2 class=article-title>【Postopia Dev Log】Week 15</h2></div></a></article><article><a href=/p/postopia-dev-logweek-14/><div class=article-details><h2 class=article-title>【Postopia Dev Log】Week 14</h2></div></a></article><article><a href=/p/postopia-dev-logweek-13/><div class=article-details><h2 class=article-title>【Postopia Dev Log】Week 13</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 飞鸿踏雪泥</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>