<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Kafka on é£é¸¿è¸é›ªæ³¥</title><link>https://dyhes.github.io/tags/kafka/</link><description>Recent content in Kafka on é£é¸¿è¸é›ªæ³¥</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 22 Oct 2025 16:27:30 +0800</lastBuildDate><atom:link href="https://dyhes.github.io/tags/kafka/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€NowCoderã€‘Kafka</title><link>https://dyhes.github.io/p/nowcoderkafka/</link><pubDate>Thu, 11 Sep 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/nowcoderkafka/</guid><description>&lt;h2 id="rebalance"&gt;Rebalance
&lt;/h2&gt;&lt;p&gt;Kafka æ¶ˆè´¹ç»„çš„ &lt;strong&gt;Rebalanceï¼ˆé‡å¹³è¡¡ï¼‰&lt;/strong&gt; æ˜¯å…¶å®ç°&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;å’Œ&lt;strong&gt;å®¹é”™&lt;/strong&gt;çš„æ ¸å¿ƒæœºåˆ¶ã€‚å½“æ¶ˆè´¹è€…ç»„çš„æˆå‘˜æˆ–è®¢é˜…èµ„æºå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒKafka ä¼šé‡æ–°åˆ†é…åˆ†åŒºï¼ˆPartitionï¼‰ä¸æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œä»¥ç¡®ä¿æ‰€æœ‰åˆ†åŒºéƒ½èƒ½è¢«æ¶ˆè´¹ï¼Œä¸”è´Ÿè½½å°½å¯èƒ½å‡è¡¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘å°†è¯¦ç»†è§£é‡Šå…¶è§¦å‘æ—¶æœºã€è¿‡ç¨‹ã€å½±å“ä»¥åŠä¼˜åŒ–ç­–ç•¥ã€‚&lt;/p&gt;
&lt;h3 id="-ä¸€è§¦å‘-rebalance-çš„æ—¶æœº"&gt;âš™ï¸ ä¸€ã€è§¦å‘ Rebalance çš„æ—¶æœº
&lt;/h3&gt;&lt;p&gt;Rebalance ä¼šåœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹è¢«è§¦å‘ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…ç»„æˆå‘˜æ•°é‡å˜åŒ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–°æ¶ˆè´¹è€…åŠ å…¥&lt;/strong&gt;ï¼šä¾‹å¦‚ï¼Œä¸€ä¸ªæ–°çš„æ¶ˆè´¹è€…å®ä¾‹å¯åŠ¨å¹¶åŠ å…¥åˆ°ç»„ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…ç¦»å¼€&lt;/strong&gt;ï¼šåŒ…æ‹¬æ¶ˆè´¹è€…ä¸»åŠ¨å…³é—­ (&lt;code&gt;close()&lt;/code&gt;) ã€å´©æºƒå®•æœºï¼Œæˆ–å› ç½‘ç»œé—®é¢˜ã€é•¿æ—¶é—´GCç­‰åŸå› &lt;strong&gt;æœªèƒ½åŠæ—¶å‘é€å¿ƒè·³&lt;/strong&gt;ï¼ˆè¶…è¿‡ &lt;code&gt;session.timeout.ms&lt;/code&gt;é…ç½®çš„æ—¶é—´ï¼‰ï¼Œè¢«åè°ƒè€…ï¼ˆCoordinatorï¼‰è®¤ä¸ºå·²å¤±æ•ˆè€Œè¸¢å‡ºç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¢é˜…çš„ä¸»é¢˜ï¼ˆTopicï¼‰æ•°é‡å‘ç”Ÿå˜åŒ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å½“æ¶ˆè´¹è€…ç»„ä½¿ç”¨&lt;strong&gt;æ­£åˆ™è¡¨è¾¾å¼&lt;/strong&gt;è®¢é˜…ä¸»é¢˜æ—¶ï¼Œå¦‚æœæ­¤æ—¶åˆ›å»ºäº†åŒ¹é…è¯¥æ­£åˆ™æ¨¡å¼çš„æ–°ä¸»é¢˜ï¼Œå°±ä¼šè§¦å‘ Rebalanceã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¢é˜…ä¸»é¢˜çš„åˆ†åŒºæ•°å‘ç”Ÿå˜åŒ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ç®¡ç†å‘˜é€šè¿‡å‘½ä»¤&lt;strong&gt;å¢åŠ äº†æŸä¸ªä¸»é¢˜çš„åˆ†åŒºæ•°&lt;/strong&gt;ï¼ˆKafka æ”¯æŒåŠ¨æ€å¢åŠ åˆ†åŒºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»„åè°ƒè€…ï¼ˆGroup Coordinatorï¼‰å˜æ›´&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è´Ÿè´£ç®¡ç†è¯¥æ¶ˆè´¹è€…ç»„çš„åè°ƒè€…æ‰€åœ¨çš„ Broker å‘ç”Ÿæ•…éšœï¼Œå¯¼è‡´ç»„éœ€è¦é‡æ–°è¿æ¥åˆ°æ–°çš„åè°ƒè€…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ å…¶ä¸­ï¼Œ&lt;strong&gt;æ¶ˆè´¹è€…ç»„æˆå‘˜æ•°é‡çš„å˜åŒ–&lt;/strong&gt;æ˜¯æœ€å¸¸è§å’Œæœ€ä¸»è¦çš„è§¦å‘åŸå› ï¼Œå°¤å…¶æ˜¯æ¶ˆè´¹è€…å› è¶…æ—¶è¢«è¯¯åˆ¤ç¦»å¼€çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="-äºŒrebalance-çš„è¿‡ç¨‹"&gt;ğŸ”„ äºŒã€Rebalance çš„è¿‡ç¨‹
&lt;/h3&gt;&lt;p&gt;Rebalance çš„è¿‡ç¨‹ä¸»è¦æ¶‰åŠ &lt;strong&gt;Group Coordinator&lt;/strong&gt;ï¼ˆæœåŠ¡ç«¯çš„åè°ƒè€…ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª Brokerï¼‰å’Œ &lt;strong&gt;Consumer Coordinator&lt;/strong&gt;ï¼ˆæ¶ˆè´¹è€…ç«¯çš„åè°ƒå™¨ï¼‰ã€‚å…¶å¤§è‡´æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;flowchart TD
A[Rebalanceè§¦å‘æ¡ä»¶æ»¡è¶³] --&amp;gt; B[æ‰€æœ‰æ¶ˆè´¹è€…åœæ­¢æ¶ˆè´¹&amp;lt;br&amp;gt;è¿›å…¥REBALANCINGçŠ¶æ€]
B --&amp;gt; C[æ¶ˆè´¹è€…å‘Coordinator&amp;lt;br&amp;gt;å‘é€JoinGroupè¯·æ±‚]
C --&amp;gt; D[Coordinatoré€‰ä¸¾Leaderæ¶ˆè´¹è€…]
D --&amp;gt; E[Leaderæ¶ˆè´¹è€…åˆ¶å®šåˆ†åŒºåˆ†é…æ–¹æ¡ˆ]
E --&amp;gt; F[Leaderé€šè¿‡SyncGroupè¯·æ±‚&amp;lt;br&amp;gt;å°†æ–¹æ¡ˆå‘é€ç»™Coordinator]
F --&amp;gt; G[Coordinatorå°†åˆ†é…ç»“æœ&amp;lt;br&amp;gt;åŒæ­¥ç»™æ‰€æœ‰æ¶ˆè´¹è€…]
G --&amp;gt; H[æ¶ˆè´¹è€…æ ¹æ®æ–°åˆ†é…çš„åˆ†åŒº&amp;lt;br&amp;gt;æ¢å¤æ¶ˆè´¹]
&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€‰ä¸¾ Leader Consumer&lt;/strong&gt;ï¼šCoordinator ä¼šä»æ‰€æœ‰å‘é€äº† &lt;code&gt;JoinGroup&lt;/code&gt;è¯·æ±‚çš„æ¶ˆè´¹è€…ä¸­é€‰ä¸¾ä¸€ä¸ªä½œä¸º Leaderï¼ˆé€šå¸¸ç¬¬ä¸€ä¸ªåŠ å…¥çš„æ¶ˆè´¹è€…ä¼šæˆä¸º Leaderï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ¶å®šåˆ†é…æ–¹æ¡ˆ&lt;/strong&gt;ï¼šLeader Consumer æ ¹æ®ç»„å†…æ‰€æœ‰æ¶ˆè´¹è€…è®¢é˜…çš„ä¸»é¢˜ä¿¡æ¯å’Œé¢„è®¾çš„&lt;strong&gt;åˆ†åŒºåˆ†é…ç­–ç•¥&lt;/strong&gt;ï¼ˆå¦‚ Rangeã€RoundRobinã€Stickyï¼‰ï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ–°çš„åˆ†åŒºåˆ†é…æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥æ–¹æ¡ˆ&lt;/strong&gt;ï¼šLeader Consumer å°†åˆ†é…æ–¹æ¡ˆé€šè¿‡ &lt;code&gt;SyncGroup&lt;/code&gt;è¯·æ±‚å‘é€ç»™ Coordinatorï¼ŒCoordinator å†å°†å…¶åŒæ­¥ç»™ç»„å†…çš„æ¯ä¸€ä¸ªæ¶ˆè´¹è€…ã€‚æ¯ä¸ªæ¶ˆè´¹è€…åªçŸ¥é“è‡ªå·±æ‰€åˆ†é…åˆ°çš„åˆ†åŒºã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸‰rebalance-çš„å½±å“"&gt;âš ï¸ ä¸‰ã€Rebalance çš„å½±å“
&lt;/h3&gt;&lt;p&gt;è™½ç„¶ Rebalance ä¿è¯äº†ç³»ç»Ÿçš„å®¹é”™æ€§å’Œæ‰©å±•æ€§ï¼Œä½†ä¹Ÿä¼šå¸¦æ¥ä¸€äº›è´Ÿé¢å½±å“ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å½±å“ç»´åº¦&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶ˆè´¹æš‚åœ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ Rebalance æœŸé—´ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…éƒ½ä¼šåœæ­¢æ¶ˆè´¹æ¶ˆæ¯ï¼Œé€ æˆ&lt;strong&gt;çŸ­æš‚çš„ä¸šåŠ¡ä¸­æ–­&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é‡å¤æ¶ˆè´¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‹¥ Rebalance å‰æ¶ˆè´¹è€…æœªåŠæ—¶æäº¤åç§»é‡ï¼ˆOffsetï¼‰ï¼Œå¯èƒ½å¯¼è‡´æ¶ˆæ¯è¢«&lt;strong&gt;é‡å¤å¤„ç†&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Rebalance è¿‡ç¨‹æœ¬èº«éœ€è¦å¤šæ¬¡ç½‘ç»œé€šä¿¡å’Œåè°ƒï¼Œé¢‘ç¹å‘ç”Ÿä¼š&lt;strong&gt;æ¶ˆè€—é¢å¤–çš„CPUå’Œå¸¦å®½&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰©å±•æ€§ç“¶é¢ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹äºéå¸¸å¤§çš„æ¶ˆè´¹è€…ç»„ï¼ˆå¦‚æœ‰æ•°ç™¾ä¸ªæ¶ˆè´¹è€…ï¼‰ï¼Œä¸€æ¬¡å®Œæ•´çš„ Rebalance å¯èƒ½&lt;strong&gt;è€—æ—¶æé•¿&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å››ä¼˜åŒ–ç­–ç•¥ä¸æœ€ä½³å®è·µ"&gt;ğŸ› ï¸ å››ã€ä¼˜åŒ–ç­–ç•¥ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†å‡å°‘ Rebalance çš„è´Ÿé¢å½±å“ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è°ƒæ•´å…³é”®å‚æ•°&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;session.timeout.ms&lt;/code&gt;&lt;/strong&gt;ï¼šå¢å¤§ä¼šè¯è¶…æ—¶æ—¶é—´ï¼ˆé»˜è®¤10ç§’ï¼‰ï¼Œå…è®¸æ¶ˆè´¹è€…æœ‰æ›´é•¿æ—¶é—´æ¥å‘é€å¿ƒè·³ï¼Œé¿å…å› ç½‘ç»œæŠ–åŠ¨æˆ–çŸ­æš‚GCè€Œè¢«è¯¯åˆ¤ç¦»çº¿ã€‚å¯å°è¯•è°ƒæ•´ä¸º &lt;strong&gt;20-30ç§’&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;heartbeat.interval.ms&lt;/code&gt;&lt;/strong&gt;ï¼šç¡®ä¿å¿ƒè·³é—´éš”æ˜æ˜¾å°äºä¼šè¯è¶…æ—¶æ—¶é—´ï¼Œé€šå¸¸è®¾ç½®ä¸º &lt;code&gt;session.timeout.ms&lt;/code&gt;çš„ &lt;strong&gt;1/3&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼Œä¼šè¯è¶…æ—¶ä¸º30ç§’æ—¶ï¼Œå¿ƒè·³é—´éš”å¯è®¾ä¸º &lt;strong&gt;10ç§’&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;max.poll.interval.ms&lt;/code&gt;&lt;/strong&gt;ï¼šå¢å¤§æ¯æ¬¡æ‹‰å–æ¶ˆæ¯å¤„ç†çš„æœ€å¤§å…è®¸æ—¶é—´ï¼ˆé»˜è®¤5åˆ†é’Ÿï¼‰ã€‚å¦‚æœä¸šåŠ¡å¤„ç†é€»è¾‘è€—æ—¶è¾ƒé•¿ï¼ŒåŠ¡å¿…å°†æ­¤å‚æ•°è®¾ç½®å¾—&lt;strong&gt;å¤§äºå¤„ç†ä¸€æ‰¹æ¶ˆæ¯çš„æœ€å¤§è€—æ—¶&lt;/strong&gt;ï¼Œå¦åˆ™ä¼šè¢«åè°ƒè€…è®¤ä¸ºæ¶ˆè´¹èƒ½åŠ›ä¸è¶³è€Œè¸¢å‡ºç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©åˆé€‚çš„åˆ†é…ç­–ç•¥&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘ä½¿ç”¨ &lt;strong&gt;StickyAssignor&lt;/strong&gt; æˆ– &lt;strong&gt;CooperativeStickyAssignor&lt;/strong&gt;ï¼ˆå¢é‡Rebalanceï¼‰ã€‚è¿™äº›ç­–ç•¥èƒ½åœ¨ Rebalance æ—¶&lt;strong&gt;å°½é‡ä¿æŒåŸæœ‰çš„åˆ†é…å…³ç³»&lt;/strong&gt;ï¼Œåªè¿›è¡Œæœ€å°å¿…è¦çš„è°ƒæ•´ï¼Œä»è€Œå‡å°‘åˆ†åŒºè¿ç§»çš„æˆæœ¬å’Œæ•´ä½“å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ä¸å¿…è¦çš„è®¢é˜…å˜æ›´&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è°¨æ…ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è®¢é˜…ä¸»é¢˜ï¼Œé¿å…é¢‘ç¹åŠ¨æ€åˆ›å»ºåŒ¹é…æ¨¡å¼çš„æ–°ä¸»é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§ä¸å‘Šè­¦&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ç›‘æ§æ¶ˆè´¹è€…ç»„çš„ Rebalance é¢‘ç‡ï¼ˆ&lt;code&gt;kafka-consumer-groups.sh&lt;/code&gt;è„šæœ¬ï¼‰ã€æ¶ˆæ¯å¤„ç†å»¶è¿Ÿç­‰æŒ‡æ ‡ï¼Œè®¾ç½®å‘Šè­¦ä»¥ä¾¿åŠæ—¶å‘ç°å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Kafka çš„ Rebalance æœºåˆ¶æ˜¯ä¿éšœæ¶ˆè´¹è€…ç»„é«˜å¯ç”¨å’Œå¯æ‰©å±•çš„åŸºçŸ³ï¼Œä½†å®ƒæ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚ç†è§£å…¶è§¦å‘æ¡ä»¶ã€è¿‡ç¨‹å’Œæ½œåœ¨å½±å“ï¼Œå¹¶é€šè¿‡åˆç†çš„å‚æ•°é…ç½®ã€ç­–ç•¥é€‰æ‹©å’Œåº”ç”¨è®¾è®¡æ¥&lt;strong&gt;å°½é‡å‡å°‘éå¿…è¦çš„ Rebalance&lt;/strong&gt;ï¼Œæ˜¯ä¿è¯ Kafka æ¶ˆè´¹ç«¯ç¨³å®šæ€§å’Œé«˜æ€§èƒ½çš„å…³é”®ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›ä»¥ä¸Šè§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Kafka Rebalanceã€‚&lt;/p&gt;
&lt;h2 id="é‡å¤æ¶ˆè´¹"&gt;é‡å¤æ¶ˆè´¹
&lt;/h2&gt;&lt;p&gt;Kafka çš„ Rebalance æœºåˆ¶è™½ç„¶ä¿è¯äº†æ¶ˆè´¹è€…ç»„çš„å®¹é”™æ€§å’Œæ‰©å±•æ€§ï¼Œä½†ç¡®å®å¯èƒ½å¼•èµ·&lt;strong&gt;é‡å¤æ¶ˆè´¹&lt;/strong&gt;é—®é¢˜ã€‚ä¸ºäº†å¸®åŠ©ä½ æ›´å¥½åœ°åº”å¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å°†ä»åŸå› ã€è§£å†³æ–¹æ¡ˆå’Œæœ€ä½³å®è·µç­‰æ–¹é¢ä¸ºä½ è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆé€šè¿‡ä¸€ä¸ªè¡¨æ ¼å¿«é€Ÿäº†è§£ä¸»è¦çš„è§£å†³æ–¹æ¡ˆå’Œé€‚ç”¨åœºæ™¯ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è§£å†³æ–¹æ¡ˆ&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒæ€è·¯&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;th&gt;ä¼˜ç‚¹&lt;/th&gt;
&lt;th&gt;ç¼ºç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰‹åŠ¨æäº¤ä½ç§»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡å¤„ç†æˆåŠŸåæ‰‹åŠ¨æäº¤ä½ç§»ï¼Œé¿å…æ¶ˆæ¯æœªå¤„ç†å°±æäº¤&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰éœ€è¦é¿å…é‡å¤æ¶ˆè´¹çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯æ¶ˆæ¯å¤„ç†è€—æ—¶æˆ–ä¸šåŠ¡é€»è¾‘é‡è¦çš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;å¯æœ€å¤§ç¨‹åº¦é¿å…æ¶ˆæ¯ä¸¢å¤±å’Œé‡å¤æ¶ˆè´¹&lt;/td&gt;
&lt;td&gt;éœ€åœ¨ä»£ç ä¸­æ˜¾å¼æ§åˆ¶æäº¤æ—¶æœºï¼Œå¢åŠ å¤æ‚åº¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹‚ç­‰æ€§å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ä¸šåŠ¡é€»è¾‘å¯¹é‡å¤æ¶ˆæ¯å…ç–«&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰å¯èƒ½é‡å¤æ¶ˆè´¹çš„åœºæ™¯ï¼Œä½œä¸ºå…œåº•æ–¹æ¡ˆ&lt;/td&gt;
&lt;td&gt;æœ€æ ¹æœ¬çš„è§£å†³ä¹‹é“ï¼Œå¯é æ€§é«˜&lt;/td&gt;
&lt;td&gt;éœ€æ ¹æ®ä¸šåŠ¡é€»è¾‘å®ç°ï¼Œå¯èƒ½å¢åŠ ç³»ç»Ÿå¤æ‚æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒæ•´å…³é”®å‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‡å°‘ä¸å¿…è¦çš„ Rebalance&lt;/td&gt;
&lt;td&gt;å› å‚æ•°é…ç½®ä¸å½“ï¼ˆå¦‚å¿ƒè·³è¶…æ—¶ã€å¤„ç†è¶…æ—¶ï¼‰å¯¼è‡´ Rebalance çš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;ä»æºå¤´é™ä½ Rebalance æ¦‚ç‡ï¼Œæ•ˆæœç›´æ¥&lt;/td&gt;
&lt;td&gt;éœ€æ ¹æ®å®é™…ç¯å¢ƒè°ƒæ•´ï¼Œå‚æ•°è®¾ç½®éœ€è°¨æ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½¿ç”¨äº‹åŠ¡ç”Ÿäº§è€…/æ¶ˆè´¹è€…&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ©ç”¨ Kafka çš„ç²¾ç¡®ä¸€æ¬¡è¯­ä¹‰ï¼ˆEOSï¼‰&lt;/td&gt;
&lt;td&gt;é‡‘èã€äº¤æ˜“ç­‰å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚æé«˜çš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;Kafka åŸç”Ÿæ”¯æŒï¼Œæä¾›å¼ºä¸€è‡´æ€§ä¿è¯&lt;/td&gt;
&lt;td&gt;æ€§èƒ½å¼€é”€è¾ƒå¤§ï¼Œé…ç½®ç¨å¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç° Rebalance ç›‘å¬å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ Rebalance å‘ç”Ÿæ—¶ä¸»åŠ¨æäº¤ä½ç§»æˆ–ä¿å­˜çŠ¶æ€&lt;/td&gt;
&lt;td&gt;éœ€è¦ç²¾ç»†æ§åˆ¶ Rebalance å‰åè¡Œä¸ºçš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;æä¾›æ›´ç»†ç²’åº¦çš„æ§åˆ¶æœºä¼š&lt;/td&gt;
&lt;td&gt;å®ç°ç›¸å¯¹å¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç†è§£é‡å¤æ¶ˆè´¹çš„åŸå› "&gt;âš ï¸ ç†è§£é‡å¤æ¶ˆè´¹çš„åŸå› 
&lt;/h3&gt;&lt;p&gt;Rebalance è¿‡ç¨‹ä¸­ï¼Œæ¶ˆè´¹è€…ç»„ä¼šé‡æ–°åˆ†é…åˆ†åŒºã€‚å¦‚æœ&lt;strong&gt;ä½ç§»æäº¤æ˜¯å¼‚æ­¥çš„æˆ–æ—¶æœºä¸å½“&lt;/strong&gt;ï¼Œæˆ–è€…æ¶ˆè´¹è€…&lt;strong&gt;å¤„ç†æ¶ˆæ¯çš„æ—¶é—´è¿‡é•¿&lt;/strong&gt;å¯¼è‡´è¢«è¯¯åˆ¤æ­»äº¡ï¼Œéƒ½å¯èƒ½é€ æˆé‡å¤æ¶ˆè´¹ ã€‚&lt;/p&gt;
&lt;h3 id="-åº”å¯¹ç­–ç•¥ä¸æœ€ä½³å®è·µ"&gt;ğŸ› ï¸ åº”å¯¹ç­–ç•¥ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;h4 id="1-æ‘’å¼ƒè‡ªåŠ¨æäº¤é‡‡ç”¨æ‰‹åŠ¨æäº¤ä½ç§»"&gt;1. æ‘’å¼ƒè‡ªåŠ¨æäº¤ï¼Œé‡‡ç”¨æ‰‹åŠ¨æäº¤ä½ç§»
&lt;/h4&gt;&lt;p&gt;é»˜è®¤çš„è‡ªåŠ¨æäº¤ï¼ˆ&lt;code&gt;enable.auto.commit=true&lt;/code&gt;ï¼‰ä¼šåœ¨å›ºå®šçš„æ—¶é—´é—´éš”ï¼ˆå¦‚5ç§’ï¼‰æäº¤ä½ç§»ï¼Œè¿™ææ˜“å¯¼è‡´&lt;strong&gt;æ¶ˆæ¯å¤„ç†å®Œæˆå‰ä½ç§»å·²è¢«æäº¤&lt;/strong&gt;ï¼Œæˆ–åœ¨Rebalanceå‘ç”Ÿæ—¶&lt;strong&gt;æ¥ä¸åŠæäº¤ä½ç§»&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®&lt;/strong&gt;ï¼šè®¾ç½® &lt;code&gt;enable.auto.commit=false&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥æäº¤ (&lt;code&gt;commitSync()&lt;/code&gt;)&lt;/strong&gt;ï¼šç¡®ä¿æäº¤æˆåŠŸåå†ç»§ç»­ï¼Œä½†ä¼šé˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥æäº¤ (&lt;code&gt;commitAsync()&lt;/code&gt;)&lt;/strong&gt;ï¼šä¸é˜»å¡ä¸»çº¿ç¨‹ï¼Œæ€§èƒ½æ›´å¥½ï¼Œä½†éœ€é…åˆå›è°ƒå‡½æ•°å¤„ç†å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨èåšæ³•&lt;/strong&gt;ï¼šåœ¨æ¶ˆæ¯å¤„ç†é€»è¾‘å®Œæˆåï¼Œ&lt;strong&gt;æ‰‹åŠ¨æäº¤ä½ç§»&lt;/strong&gt;ã€‚è¿™å¯ä»¥ç¡®ä¿åªæœ‰æˆåŠŸå¤„ç†çš„æ¶ˆæ¯æ‰ä¼šè¢«æäº¤ä½ç§» ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-å®ç°ä¸šåŠ¡é€»è¾‘çš„å¹‚ç­‰æ€§"&gt;2. å®ç°ä¸šåŠ¡é€»è¾‘çš„å¹‚ç­‰æ€§
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯åº”å¯¹é‡å¤æ¶ˆè´¹çš„&lt;strong&gt;ç»ˆæä¿é™©&lt;/strong&gt;ã€‚å³ä½¿æ¶ˆæ¯è¢«é‡å¤æ¶ˆè´¹ï¼Œä¹Ÿèƒ½ä¿è¯æœ€ç»ˆç»“æœä¸€è‡´ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨æ–¹æ³•&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸ºæ¶ˆæ¯åˆ†é…å…¨å±€å”¯ä¸€IDï¼ˆå¦‚ä¸šåŠ¡IDã€è¯·æ±‚IDï¼‰ï¼Œå¹¶åœ¨å¤„ç†å‰åœ¨æ•°æ®åº“æˆ–ç¼“å­˜ä¸­æŸ¥è¯¢è¯¥IDæ˜¯å¦å·²å­˜åœ¨ã€‚&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨æ•°æ®åº“çš„å”¯ä¸€é”®çº¦æŸæˆ–ä¹è§‚é”æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-ä¼˜åŒ–æ¶ˆè´¹è€…é…ç½®å‡å°‘ä¸å¿…è¦çš„rebalance"&gt;3. ä¼˜åŒ–æ¶ˆè´¹è€…é…ç½®ï¼Œå‡å°‘ä¸å¿…è¦çš„Rebalance
&lt;/h4&gt;&lt;p&gt;è®¸å¤šRebalanceæ˜¯ç”±äºå‚æ•°é…ç½®ä¸å½“ï¼Œæ¶ˆè´¹è€…è¢«&lt;strong&gt;è¯¯åˆ¤ä¸ºå¤±æ•ˆ&lt;/strong&gt;è€Œè§¦å‘çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;session.timeout.ms&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;strong&gt;å¢åŠ ä¼šè¯è¶…æ—¶æ—¶é—´&lt;/strong&gt;ï¼ˆä¾‹å¦‚è®¾ç½®ä¸º30ç§’ï¼‰ï¼Œå…è®¸æ¶ˆè´¹è€…æœ‰æ›´é•¿æ—¶é—´å‘é€å¿ƒè·³ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;heartbeat.interval.ms&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;strong&gt;ä¿æŒå¿ƒè·³é—´éš”ç¨³å®š&lt;/strong&gt;ï¼Œé€šå¸¸è®¾ä¸º &lt;code&gt;session.timeout.ms&lt;/code&gt;çš„ä¸‰åˆ†ä¹‹ä¸€ï¼ˆä¾‹å¦‚10ç§’ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;max.poll.interval.ms&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;strong&gt;å¢åŠ å¤„ç†æ¶ˆæ¯çš„æœ€å¤§å…è®¸æ—¶é—´&lt;/strong&gt;ã€‚å¦‚æœä¸šåŠ¡å¤„ç†é€»è¾‘è€—æ—¶è¾ƒé•¿ï¼ŒåŠ¡å¿…å¢å¤§æ­¤å€¼ï¼ˆä¾‹å¦‚10-15åˆ†é’Ÿï¼‰ï¼Œé˜²æ­¢æ¶ˆè´¹è€…å› å¤„ç†æ…¢è€Œè¢«è¸¢å‡ºç»„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;max.poll.records&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;strong&gt;é™åˆ¶å•æ¬¡æ‹‰å–çš„æ¶ˆæ¯æ•°&lt;/strong&gt;ã€‚å‡å°‘æ¯æ¬¡å¤„ç†çš„æ¶ˆæ¯é‡ï¼Œæœ‰åŠ©äºåœ¨ &lt;code&gt;max.poll.interval.ms&lt;/code&gt;å†…å®Œæˆå¤„ç†ï¼Œé¿å…è§¦å‘Rebalanceã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="4-ä½¿ç”¨kafkaçš„äº‹åŠ¡æœºåˆ¶"&gt;4. ä½¿ç”¨Kafkaçš„äº‹åŠ¡æœºåˆ¶
&lt;/h4&gt;&lt;p&gt;å¯¹äºè¦æ±‚&lt;strong&gt;æé«˜ä¸€è‡´æ€§&lt;/strong&gt;çš„åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Kafkaçš„äº‹åŠ¡ï¼ˆTransactionï¼‰æœºåˆ¶æ¥å®ç°&lt;strong&gt;ç²¾ç¡®ä¸€æ¬¡ï¼ˆExactly-Onceï¼‰&lt;/strong&gt; è¯­ä¹‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç”Ÿäº§è€…é…ç½®&lt;/strong&gt;ï¼šå¯ç”¨å¹‚ç­‰æ€§ &lt;code&gt;enable.idempotence=true&lt;/code&gt;å¹¶è®¾ç½® &lt;code&gt;transactional.id&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¶ˆè´¹è€…é…ç½®&lt;/strong&gt;ï¼šè®¾ç½® &lt;code&gt;isolation.level=read_committed&lt;/code&gt;ï¼Œåªæ¶ˆè´¹å·²æäº¤çš„äº‹åŠ¡æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ–¹æ¡ˆæ€§èƒ½å¼€é”€è¾ƒå¤§ï¼Œéœ€æ ¹æ®ä¸šåŠ¡é‡è¦æ€§æƒè¡¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="5-å®ç°consumerrebalancelistener"&gt;5. å®ç°ConsumerRebalanceListener
&lt;/h4&gt;&lt;p&gt;é€šè¿‡å®ç°&lt;code&gt;ConsumerRebalanceListener&lt;/code&gt;æ¥å£ï¼Œä½ å¯ä»¥åœ¨Rebalance&lt;strong&gt;å‘ç”Ÿå‰å&lt;/strong&gt;æ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œä»è€Œæ›´ç²¾ç»†åœ°æ§åˆ¶ä½ç§»æäº¤å’ŒçŠ¶æ€æ¢å¤ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;onPartitionsRevoked&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨åˆ†åŒºè¢«å›æ”¶&lt;strong&gt;å‰&lt;/strong&gt;è§¦å‘ã€‚è¿™æ˜¯&lt;strong&gt;åŒæ­¥æäº¤å½“å‰å¤„ç†ä½ç§»çš„æœ€ä½³æ—¶æœº&lt;/strong&gt;ï¼Œå¯ä»¥æå¤§å‡å°‘é‡å¤æ¶ˆè´¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;onPartitionsAssigned&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨åˆ†åŒºè¢«åˆ†é…&lt;strong&gt;å&lt;/strong&gt;è§¦å‘ã€‚å¯åœ¨è¿™é‡Œä»å¤–éƒ¨å­˜å‚¨ä¸­æ¢å¤ä½ç§»æˆ–åˆå§‹åŒ–çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“ä¸å»ºè®®"&gt;ğŸ’ æ€»ç»“ä¸å»ºè®®
&lt;/h3&gt;&lt;p&gt;è¦æœ‰æ•ˆé¿å…Rebalanceå¯¼è‡´çš„é‡å¤æ¶ˆè´¹ï¼Œé€šå¸¸éœ€è¦&lt;strong&gt;ç»„åˆç­–ç•¥&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¦–è¦æ­¥éª¤&lt;/strong&gt;ï¼š&lt;strong&gt;ç¦ç”¨è‡ªåŠ¨æäº¤ï¼Œæ”¹ç”¨æ‰‹åŠ¨æäº¤&lt;/strong&gt;ã€‚å¹¶åœ¨å¤„ç†å®Œæ¶ˆæ¯åæäº¤ä½ç§»ï¼Œè¿™æ˜¯åŸºç¡€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®é…ç½®&lt;/strong&gt;ï¼š&lt;strong&gt;åˆç†è°ƒæ•´ &lt;code&gt;session.timeout.ms&lt;/code&gt;ã€&lt;code&gt;max.poll.interval.ms&lt;/code&gt;å’Œ &lt;code&gt;max.poll.records&lt;/code&gt;&lt;/strong&gt;ï¼Œå‡å°‘éå¿…è¦çš„Rebalanceã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¹æœ¬ä¿éšœ&lt;/strong&gt;ï¼š&lt;strong&gt;å°½é‡å®ç°ä¸šåŠ¡çš„å¹‚ç­‰æ€§&lt;/strong&gt;ã€‚è¿™æ˜¯æœ€å®‰å…¨å¯é çš„å…œåº•æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜çº§ä¿éšœ&lt;/strong&gt;ï¼šå¯¹ä¸€è‡´æ€§è¦æ±‚æé«˜çš„åœºæ™¯ï¼Œå¯è€ƒè™‘&lt;strong&gt;ä½¿ç”¨Kafkaäº‹åŠ¡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç²¾ç»†æ§åˆ¶&lt;/strong&gt;ï¼šé€šè¿‡&lt;strong&gt;å®ç° &lt;code&gt;ConsumerRebalanceListener&lt;/code&gt;&lt;/strong&gt;ï¼Œåœ¨Rebalanceå‘ç”Ÿæ—¶ä¸»åŠ¨æäº¤ä½ç§»ï¼Œè¿›ä¸€æ­¥é™ä½é‡å¤æ¶ˆè´¹é£é™©ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›æ–¹æ¡ˆèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°é©¾é©­Kafkaï¼Œæ„å»ºæ›´ç¨³å®šå¯é çš„æ•°æ®å¤„ç†ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;h2 id="ç”Ÿäº§è€…åˆ†åŒº"&gt;ç”Ÿäº§è€…åˆ†åŒº
&lt;/h2&gt;&lt;p&gt;Kafka ç”Ÿäº§è€…çš„åˆ†åŒºç­–ç•¥æ˜¯ä¸€ä¸ªæ ¸å¿ƒæœºåˆ¶ï¼Œå®ƒå†³å®šäº†æ¶ˆæ¯å¦‚ä½•è¢«å†™å…¥åˆ° Topic çš„å„ä¸ªåˆ†åŒºä¸­ï¼Œç›´æ¥å½±å“ç€ç³»ç»Ÿçš„&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;ã€&lt;strong&gt;æ¶ˆæ¯é¡ºåºæ€§&lt;/strong&gt;å’Œ&lt;strong&gt;ååæ€§èƒ½&lt;/strong&gt;ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ è¯¦ç»†è§£æä¸»è¦çš„ç­–ç•¥ç±»å‹ã€å·¥ä½œåŸç†ä»¥åŠå¦‚ä½•æ ¹æ®ä¸šåŠ¡åœºæ™¯è¿›è¡Œé€‰æ‹©ã€‚&lt;/p&gt;
&lt;h3 id="-åˆ†åŒºç­–ç•¥çš„æ ¸å¿ƒä»·å€¼"&gt;ğŸ§  åˆ†åŒºç­–ç•¥çš„æ ¸å¿ƒä»·å€¼
&lt;/h3&gt;&lt;p&gt;åœ¨ Kafka ä¸­ï¼Œä¸€ä¸ª Topic å¯ä»¥è¢«åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼ˆPartitionï¼‰ï¼Œè¿™æ˜¯ Kafka å®ç°&lt;strong&gt;æ°´å¹³æ‰©å±•&lt;/strong&gt;å’Œ&lt;strong&gt;é«˜å¹¶å‘&lt;/strong&gt;çš„åŸºç¡€ã€‚ç”Ÿäº§è€…åˆ†åŒºç­–ç•¥çš„æ ¸å¿ƒç›®æ ‡æ˜¯åœ¨å¤šä¸ªåˆ†åŒºä¸Šåˆç†åˆ†å¸ƒæ¶ˆæ¯ï¼Œæ—¢è¦é¿å…æŸäº›åˆ†åŒºè¿‡è½½ï¼ˆçƒ­ç‚¹ï¼‰ï¼Œåˆè¦ä¿è¯å…·æœ‰é€»è¾‘ç›¸å…³æ€§çš„æ¶ˆæ¯ï¼ˆå¦‚åŒä¸€ä¸ªè®¢å•çš„æ‰€æœ‰æ¶ˆæ¯ï¼‰èƒ½æŒ‰é¡ºåºè¢«å¤„ç†ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†åŒºç­–ç•¥æ¦‚è§ˆ"&gt;ğŸ“Š åˆ†åŒºç­–ç•¥æ¦‚è§ˆ
&lt;/h3&gt;&lt;p&gt;ä¸‹è¡¨æ±‡æ€»äº† Kafka ç”Ÿäº§è€…ä¸»è¦çš„å‡ ç§åˆ†åŒºç­–ç•¥åŠå…¶æ ¸å¿ƒç‰¹æ€§ï¼Œå¸®åŠ©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç­–ç•¥åç§°&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒæœºåˆ¶&lt;/th&gt;
&lt;th&gt;é¡ºåºæ€§ä¿è¯&lt;/th&gt;
&lt;th&gt;è´Ÿè½½å‡è¡¡æ•ˆæœ&lt;/th&gt;
&lt;th&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é»˜è®¤ç­–ç•¥ (DefaultPartitioner)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ‰ Key åˆ™å“ˆå¸Œå–æ¨¡ï¼Œæ—  Key åˆ™è½®è¯¢ï¼ˆæ–°ç‰ˆæœ¬ä¸ºç²˜æ€§è½®è¯¢ï¼‰&lt;/td&gt;
&lt;td&gt;åŒä¸€ Key ä¿è¯é¡ºåº&lt;/td&gt;
&lt;td&gt;å¯èƒ½å›  Key å€¾æ–œè€Œä¸å‡&lt;/td&gt;
&lt;td&gt;é€šç”¨åœºæ™¯ï¼›éœ€æŒ‰ Key ä¿åºæˆ–å‡åŒ€åˆ†å¸ƒæ—  Key æ¶ˆæ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç²˜æ€§åˆ†åŒºç­–ç•¥ (Sticky Partitioner)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ—  Key æ—¶ï¼Œä¼˜å…ˆå°†æ¶ˆæ¯æ‰¹é‡å¡«å……è‡³åŒä¸€åˆ†åŒºï¼Œæ»¡æ‰¹æ¬¡åå†â€œç²˜â€åˆ°ä¸‹ä¸€ä¸ªåˆ†åŒº&lt;/td&gt;
&lt;td&gt;ä¸ä¿è¯&lt;/td&gt;
&lt;td&gt;æ‰¹æ¬¡å±‚é¢å‡è¡¡ï¼Œæ•´ä½“å‡åŒ€&lt;/td&gt;
&lt;td&gt;é«˜åååœºæ™¯ï¼›è¿½æ±‚æœ€å¤§ç”Ÿäº§æ•ˆç‡å’Œå‡å°‘ç½‘ç»œå¼€é”€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŒ‡å®šåˆ†åŒº (Explicit Partition)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥åœ¨ä»£ç ä¸­æŒ‡å®šç›®æ ‡åˆ†åŒºå·&lt;/td&gt;
&lt;td&gt;æŒ‡å®šåˆ†åŒºå†…ä¿è¯é¡ºåº&lt;/td&gt;
&lt;td&gt;ä¾èµ–äººå·¥åˆ†é…ï¼Œææ˜“ä¸å‡&lt;/td&gt;
&lt;td&gt;ç‰¹æ®Šè·¯ç”±éœ€æ±‚ï¼›è°ƒè¯•æˆ–æµ‹è¯•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªå®šä¹‰ç­–ç•¥ (Custom Partitioner)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼€å‘è€…å®ç°æ¥å£ï¼Œæ ¹æ®ä»»æ„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚åœ°åŒºã€ç”¨æˆ·ç±»å‹ï¼‰è®¡ç®—åˆ†åŒºå·&lt;/td&gt;
&lt;td&gt;æŒ‰è‡ªå®šä¹‰é€»è¾‘ä¿è¯&lt;/td&gt;
&lt;td&gt;å¯è®¾è®¡ä¸ºå‡è¡¡ï¼Œä¹Ÿå¯èƒ½å€¾æ–œ&lt;/td&gt;
&lt;td&gt;å¤æ‚ä¸šåŠ¡éœ€æ±‚ï¼›é»˜è®¤ç­–ç•¥æ— æ³•æ»¡è¶³çš„ç‰¹æ®Šåˆ†å‘è§„åˆ™&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ·±å…¥ç†è§£å„ç§ç­–ç•¥"&gt;ğŸ” æ·±å…¥ç†è§£å„ç§ç­–ç•¥
&lt;/h3&gt;&lt;h4 id="1-é»˜è®¤åˆ†åŒºç­–ç•¥-defaultpartitioner"&gt;1. é»˜è®¤åˆ†åŒºç­–ç•¥ (DefaultPartitioner)
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯æœ€å¸¸ç”¨ä¸”æ— éœ€ç‰¹æ®Šé…ç½®çš„ç­–ç•¥ã€‚å®ƒçš„è¡Œä¸ºé€»è¾‘æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯æŒ‡å®šäº† Key&lt;/strong&gt;ï¼šå¯¹ Key è¿›è¡Œ &lt;strong&gt;å“ˆå¸Œè®¡ç®—&lt;/strong&gt;ï¼ˆé€šå¸¸ä½¿ç”¨ Murmur2Hash ç®—æ³•ï¼‰ï¼Œç„¶åå¯¹åˆ†åŒºæ€»æ•°&lt;strong&gt;å–æ¨¡&lt;/strong&gt;ï¼Œå¾—åˆ°ç›®æ ‡åˆ†åŒºå·ï¼š&lt;code&gt;partition = hash(key) % numPartitions&lt;/code&gt;ã€‚&lt;strong&gt;è¿™ç¡®ä¿äº†ç›¸åŒ Key çš„æ‰€æœ‰æ¶ˆæ¯ä¸€å®šä¼šè¢«å‘é€åˆ°åŒä¸€ä¸ªåˆ†åŒºï¼Œä»è€Œä¿è¯äº†è¯¥åˆ†åŒºå†…è¿™äº›æ¶ˆæ¯çš„ä¸¥æ ¼é¡ºåº&lt;/strong&gt;ï¼Œè¿™å¯¹äºè®¢å•æµæ°´ã€ç”¨æˆ·è¡Œä¸ºè¿½è¸ªç­‰åœºæ™¯è‡³å…³é‡è¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯æœªæŒ‡å®š Key (null)&lt;/strong&gt;ï¼šåœ¨æ—§ç‰ˆæœ¬ä¸­ï¼Œä¼šé‡‡ç”¨ç®€å•çš„è½®è¯¢ï¼ˆRound-Robinï¼‰ã€‚ä½†åœ¨ &lt;strong&gt;Kafka 2.4+&lt;/strong&gt; ä¸­ï¼Œé»˜è®¤è¡Œä¸ºå˜ä¸ºäº† &lt;strong&gt;ç²˜æ€§åˆ†åŒºç­–ç•¥&lt;/strong&gt;ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œä»¥æ˜¾è‘—æå‡ç”Ÿäº§ååé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-ç²˜æ€§åˆ†åŒºç­–ç•¥-sticky-partitioner"&gt;2. ç²˜æ€§åˆ†åŒºç­–ç•¥ (Sticky Partitioner)
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯ä¸€ç§ä¼˜åŒ–ç­–ç•¥ï¼Œæ—¨åœ¨å‡å°‘ç”Ÿäº§è€…ä¸ Broker ä¹‹é—´è¿æ¥å’Œæ‰¹æ¬¡åˆ›å»ºçš„å¼€é”€ï¼Œå°¤å…¶åœ¨æ¶ˆæ¯æ²¡æœ‰ Key æ—¶ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼šå½“æ¶ˆæ¯æ²¡æœ‰ Key æ—¶ï¼Œç”Ÿäº§è€…ä¼šéšæœºé€‰æ‹©ä¸€ä¸ªåˆ†åŒºï¼Œç„¶ååœ¨&lt;strong&gt;ä¸€æ®µæ—¶é—´å†…æˆ–ç§¯æ”’è¶³å¤Ÿå¤šæ¶ˆæ¯ï¼ˆå½¢æˆä¸€ä¸ªæ‰¹æ¬¡ï¼‰ä¹‹å‰&lt;/strong&gt;ï¼Œå°†æ‰€æœ‰æ¶ˆæ¯éƒ½å‘å¾€è¿™ä¸ª&lt;strong&gt;ç›¸åŒ&lt;/strong&gt;çš„åˆ†åŒºã€‚ç›´åˆ°æ»¡è¶³æŸä¸ªæ¡ä»¶ï¼ˆå¦‚æ‰¹æ¬¡å·²æ»¡æˆ–è¶…æ—¶ï¼‰ï¼Œå®ƒæ‰ä¼šâ€œç²˜â€åˆ°ä¸‹ä¸€ä¸ªéšæœºé€‰æ‹©çš„åˆ†åŒºã€‚è¿™é¿å…äº†é¢‘ç¹åˆ‡æ¢åˆ†åŒºå¸¦æ¥çš„é¢å¤–å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šé€šè¿‡&lt;strong&gt;æ‰¹é‡å‘é€&lt;/strong&gt;å‡å°‘äº†ç½‘ç»œè¯·æ±‚æ¬¡æ•°ï¼Œé™ä½äº† CPU ä½¿ç”¨ç‡ï¼Œä»è€Œæå¤§åœ°æå‡äº†&lt;strong&gt;ååé‡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šéå¸¸é€‚åˆæ—¥å¿—æ”¶é›†ã€æŒ‡æ ‡ä¸ŠæŠ¥ç­‰å¯¹é¡ºåºæ€§æ— è¦æ±‚ä½†è¦æ±‚æé«˜ååçš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-æŒ‡å®šåˆ†åŒº-explicit-partition"&gt;3. æŒ‡å®šåˆ†åŒº (Explicit Partition)
&lt;/h4&gt;&lt;p&gt;ç”Ÿäº§è€…å¯ä»¥åœ¨åˆ›å»º &lt;code&gt;ProducerRecord&lt;/code&gt;æ—¶ç›´æ¥æŒ‡å®šä¸€ä¸ªåˆ†åŒºå·ã€‚æ­¤ç­–ç•¥&lt;strong&gt;å®Œå…¨ç»•è¿‡åˆ†åŒºå™¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;ï¼šé€šå¸¸ç”¨äºç‰¹æ®Šçš„è°ƒè¯•ã€æµ‹è¯•åœºæ™¯ï¼Œæˆ–è€…æœ‰éå¸¸ç‰¹å®šçš„è·¯ç”±éœ€æ±‚ï¼Œä½†&lt;strong&gt;ä¸æ¨è&lt;/strong&gt;åœ¨å¸¸è§„ä¸šåŠ¡ä¸­ä½¿ç”¨ï¼Œå› ä¸ºå®ƒææ˜“å¯¼è‡´ä¸¥é‡çš„&lt;strong&gt;æ•°æ®å€¾æ–œ&lt;/strong&gt;ï¼Œä½¿è´Ÿè½½å‡è¡¡å¤±æ•ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="4-è‡ªå®šä¹‰åˆ†åŒºç­–ç•¥-custom-partitioner"&gt;4. è‡ªå®šä¹‰åˆ†åŒºç­–ç•¥ (Custom Partitioner)
&lt;/h4&gt;&lt;p&gt;å½“ä¸Šè¿°æ‰€æœ‰ç­–ç•¥éƒ½æ— æ³•æ»¡è¶³ä½ çš„ä¸šåŠ¡éœ€æ±‚æ—¶ï¼Œä½ å¯ä»¥å®ç° &lt;code&gt;org.apache.kafka.clients.producer.Partitioner&lt;/code&gt;æ¥å£ï¼Œç¼–å†™å®Œå…¨è‡ªå®šä¹‰çš„åˆ†åŒºé€»è¾‘ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¸¸è§åœºæ™¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºäºä¸šåŠ¡å­—æ®µ&lt;/strong&gt;ï¼šä¾‹å¦‚ï¼Œæ ¹æ®æ¶ˆæ¯ä½“ä¸­çš„â€œç”¨æˆ·åœ°åŸŸâ€å­—æ®µï¼Œå°†ä¸åŒåœ°åŒºçš„ç”¨æˆ·æ¶ˆæ¯å‘é€åˆ°æŒ‡å®šçš„åˆ†åŒºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…çƒ­ç‚¹&lt;/strong&gt;ï¼šå½“æŸä¸ª Key ç‰¹åˆ«å¤§ï¼ˆå¦‚ç½‘çº¢ç”¨æˆ·ï¼‰ï¼Œé€šè¿‡è‡ªå®šä¹‰é€»è¾‘å°†å…¶æ•£åˆ—åˆ°å¤šä¸ªåˆ†åŒºï¼Œé¿å…å•ä¸ªåˆ†åŒºè¿‡çƒ­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆçº§é˜Ÿåˆ—&lt;/strong&gt;ï¼šå°†é«˜ä¼˜å…ˆçº§çš„æ¶ˆæ¯ï¼ˆå¦‚ VIP è®¢å•ï¼‰å›ºå®šå‘é€åˆ°æŸä¸ªç‰¹å®šåˆ†åŒºï¼Œä»¥ä¾¿æ¶ˆè´¹è€…ä¼˜å…ˆå¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æ­¥éª¤&lt;/strong&gt;ï¼š
&lt;ol&gt;
&lt;li&gt;å®ç° &lt;code&gt;Partitioner&lt;/code&gt;æ¥å£ï¼Œä¸»è¦åœ¨ &lt;code&gt;partition()&lt;/code&gt;æ–¹æ³•ä¸­ç¼–å†™é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ç”Ÿäº§è€…é…ç½®ä¸­é€šè¿‡ &lt;code&gt;partitioner.class&lt;/code&gt;å±æ€§æŒ‡å®šä½ çš„è‡ªå®šä¹‰ç±»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç­–ç•¥é€‰æ‹©ä¸æœ€ä½³å®è·µ"&gt;âš–ï¸ ç­–ç•¥é€‰æ‹©ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¦‚ä½•é€‰æ‹©ç­–ç•¥ï¼Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦æŒ‰ Key ä¿è¯æ¶ˆæ¯é¡ºåº&lt;/strong&gt;ï¼ˆå¦‚è®¢å•çŠ¶æ€å˜æ›´ï¼‰ï¼šä½¿ç”¨&lt;strong&gt;é»˜è®¤ç­–ç•¥&lt;/strong&gt;ï¼Œå¹¶ä¸ºç›¸å…³æ¶ˆæ¯è®¾ç½®&lt;strong&gt;ç›¸åŒçš„ Key&lt;/strong&gt;ã€‚è¿™æ˜¯æœ€å¸¸è§çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åªéœ€æœ€å¤§åŒ–ååï¼Œæ— é¡ºåºè¦æ±‚&lt;/strong&gt;ï¼ˆå¦‚æ—¥å¿—ã€æŒ‡æ ‡ï¼‰ï¼šä½¿ç”¨&lt;strong&gt;ç²˜æ€§åˆ†åŒºç­–ç•¥&lt;/strong&gt;ï¼ˆKafka 2.4+ åæ—  Key é»˜è®¤å³æ˜¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰å¤æ‚çš„åˆ†åŒºéœ€æ±‚&lt;/strong&gt;ï¼ˆå¦‚æŒ‰åœ°åŸŸã€ä¸šåŠ¡ç±»å‹ï¼‰ï¼šå¼€å‘&lt;strong&gt;è‡ªå®šä¹‰åˆ†åŒºå™¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å€¾æ–œï¼ˆçƒ­ç‚¹ï¼‰é—®é¢˜&lt;/strong&gt;ï¼šå¦‚æœä½ çš„ Key åˆ†å¸ƒæä¸å‡åŒ€ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸ª Key çš„æ¶ˆæ¯é‡ç‰¹åˆ«å¤§ï¼‰ï¼Œä¼šå¯¼è‡´å¤§éƒ¨åˆ†æ¶ˆæ¯æ¶Œå…¥å°‘æ•°å‡ ä¸ªåˆ†åŒºï¼Œé€ æˆ&lt;strong&gt;çƒ­ç‚¹é—®é¢˜&lt;/strong&gt;ã€‚è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ï¼šå¯¹ Key è¿›è¡ŒåŠ ç›ï¼ˆæ·»åŠ éšæœºåç¼€ï¼‰ã€ä½¿ç”¨å¤åˆ Keyæˆ–åœ¨è‡ªå®šä¹‰åˆ†åŒºå™¨ä¸­å®ç°å‡è¡¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒºæ•°è§„åˆ’&lt;/strong&gt;ï¼šTopic çš„åˆ†åŒºæ•°&lt;strong&gt;ä¸€æ—¦å¢åŠ ï¼Œå°±æ— æ³•å‡å°‘&lt;/strong&gt;ã€‚å¢åŠ åˆ†åŒºä¼šæ”¹å˜å“ˆå¸Œå–æ¨¡çš„åŸºæ•°ï¼Œå¯èƒ½å¯¼è‡´ç›¸åŒ Key çš„æ¶ˆæ¯è¢«è·¯ç”±åˆ°ä¸åŒçš„åˆ†åŒºï¼Œ&lt;strong&gt;ç ´åé¡ºåºæ€§&lt;/strong&gt;ã€‚å› æ­¤ï¼Œåˆå§‹è®¾ç½®æ—¶éœ€è¦æ ¹æ®é¢„æœŸååé‡å’Œæ¶ˆè´¹è€…æ•°é‡è°¨æ…è§„åˆ’ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§&lt;/strong&gt;ï¼šä½¿ç”¨ Kafka å·¥å…·ï¼ˆå¦‚ &lt;code&gt;kafka-consumer-groups.sh&lt;/code&gt;ï¼‰ç›‘æ§å„åˆ†åŒºçš„æ¶ˆæ¯ç§¯å‹é‡ï¼ˆLagï¼‰ï¼ŒåŠæ—¶å‘ç°å€¾æ–œé—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Kafka ç”Ÿäº§è€…çš„åˆ†åŒºç­–ç•¥æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œè®©ä½ èƒ½åœ¨&lt;strong&gt;æ¶ˆæ¯é¡ºåºæ€§&lt;/strong&gt;å’Œ&lt;strong&gt;ç³»ç»Ÿååé‡/è´Ÿè½½å‡è¡¡&lt;/strong&gt;ä¹‹é—´åšå‡ºçµæ´»çš„æƒè¡¡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç‰¢è®° &lt;strong&gt;Key&lt;/strong&gt; æ˜¯æ§åˆ¶æ¶ˆæ¯å»å‘å’Œé¡ºåºçš„é’¥åŒ™ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨&lt;strong&gt;é»˜è®¤ç­–ç•¥&lt;/strong&gt;å¹¶è®¾ç½®å¥½ Key å°±èƒ½æ»¡è¶³éœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨è¿½æ±‚æè‡´ååä¸”æ— é¡ºåºè¦æ±‚çš„åœºæ™¯ä¸‹ï¼Œ&lt;strong&gt;ç²˜æ€§åˆ†åŒº&lt;/strong&gt;æ˜¯æ€§èƒ½åˆ©å™¨ã€‚&lt;/li&gt;
&lt;li&gt;é¢å¯¹ç‹¬ç‰¹å¤æ‚çš„ä¸šåŠ¡è§„åˆ™æ—¶ï¼Œä¸è¦çŠ¹è±«ï¼Œ&lt;strong&gt;è‡ªå®šä¹‰åˆ†åŒºå™¨&lt;/strong&gt;ä¼šç»™ä½ å……åˆ†çš„æ§åˆ¶æƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨ Kafka çš„ç”Ÿäº§è€…åˆ†åŒºç­–ç•¥ã€‚&lt;/p&gt;
&lt;h2 id="æ´»é”é—®é¢˜"&gt;æ´»é”é—®é¢˜
&lt;/h2&gt;&lt;p&gt;Kafkaçš„æ´»é”é—®é¢˜æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸€ä¸ªå€¼å¾—å…³æ³¨çš„ç°è±¡ã€‚ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒä¿¡æ¯ï¼Œæˆ‘å…ˆé€šè¿‡ä¸€ä¸ªè¡¨æ ¼æ¥æ±‡æ€»æ´»é”çš„å…³é”®æ–¹é¢ï¼Œç„¶åæˆ‘ä»¬å†æ·±å…¥æ¢è®¨å…¶æœºç†å’Œè§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ–¹é¢&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒæè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é—®é¢˜æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆè´¹è€…è¿›ç¨‹çœ‹ä¼¼â€œå­˜æ´»â€ï¼ˆèƒ½å‘é€å¿ƒè·³ï¼‰ï¼Œä½†å®é™…æ— æ³•æœ‰æ•ˆæ¶ˆè´¹æ¶ˆæ¯ï¼Œå¯¼è‡´æ¶ˆæ¯å †ç§¯ï¼Œç³»ç»Ÿæ€§èƒ½ä¸‹é™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸æ­»é”åŒºåˆ«&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ­»é”ï¼šçº¿ç¨‹ç›¸äº’ç­‰å¾…èµ„æºï¼Œå®Œå…¨å¡ä½ã€‚æ´»é”ï¼šçº¿ç¨‹ä»åœ¨è¿è¡Œï¼ˆå¦‚å‘é€å¿ƒè·³ã€å°è¯•å¤„ç†ï¼‰ï¼Œä½†æ— æ³•æ¨è¿›å®é™…å·¥ä½œï¼ˆæ¶ˆè´¹æ¶ˆæ¯ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®æ£€æµ‹å‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;max.poll.interval.ms&lt;/code&gt;ï¼šæ§åˆ¶æ¶ˆè´¹è€…ä¸¤æ¬¡è°ƒç”¨ &lt;code&gt;poll()&lt;/code&gt;æ–¹æ³•çš„æœ€å¤§æ—¶é—´é—´éš”ã€‚è¶…è¿‡æ­¤é—´éš”ï¼ŒKafkaä¼šè®¤ä¸ºæ¶ˆè´¹è€…å·²â€œåƒµæ­»â€å¹¶è§¦å‘é‡å¹³è¡¡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1. ä¼˜åŒ–æ¶ˆæ¯å¤„ç†é€»è¾‘ä¸æ€§èƒ½ 2. åˆç†é…ç½®æ¶ˆè´¹è€…å‚æ•°ï¼ˆå¦‚ &lt;code&gt;max.poll.interval.ms&lt;/code&gt;, &lt;code&gt;max.poll.records&lt;/code&gt;ï¼‰ 3. é‡‡ç”¨å¼‚æ­¥å¤„ç†æˆ–æ‰¹å¤„ç† 4. å®Œå–„é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ç†è§£æ´»é”çš„æœºç†ä¸å½±å“"&gt;ğŸ” ç†è§£æ´»é”çš„æœºç†ä¸å½±å“
&lt;/h3&gt;&lt;p&gt;æ´»é”å‘ç”Ÿæ—¶ï¼Œæ¶ˆè´¹è€…å®ä¾‹å¹¶&lt;strong&gt;æ²¡æœ‰å´©æºƒ&lt;/strong&gt;ï¼Œå®ƒå¯èƒ½ä»åœ¨å‘Kafkaé›†ç¾¤å‘é€å¿ƒè·³ï¼Œå› æ­¤è¢«åè°ƒè€…è®¤ä¸ºæ˜¯â€œå­˜æ´»â€çš„ã€‚ç„¶è€Œï¼Œç”±äºæŸäº›åŸå› ï¼Œå®ƒ&lt;strong&gt;æ— æ³•æˆåŠŸå¤„ç†&lt;/strong&gt;åˆ†é…ç»™å®ƒçš„åˆ†åŒºä¸­çš„æ¶ˆæ¯ï¼Œæˆ–è€…å¤„ç†é€Ÿåº¦æå…¶ç¼“æ…¢ã€‚è¿™ä¼šå¯¼è‡´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯ç§¯å‹&lt;/strong&gt;ï¼šè¯¥æ¶ˆè´¹è€…è´Ÿè´£çš„åˆ†åŒºæ¶ˆæ¯å †ç§¯è¶Šæ¥è¶Šå¤šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæµªè´¹&lt;/strong&gt;ï¼šCPUã€å†…å­˜ç­‰èµ„æºè¢«å ç”¨ï¼Œå´æ²¡æœ‰äº§ç”Ÿå®é™…æ•ˆç›Šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡å—é˜»&lt;/strong&gt;ï¼šä¾èµ–è¿™äº›æ¶ˆæ¯çš„ä¸‹æ¸¸ä¸šåŠ¡æ— æ³•æ­£å¸¸è¿›è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®ƒä¸æ­»é”çš„å…³é”®åŒºåˆ«åœ¨äºï¼šæ­»é”ä¸­çš„çº¿ç¨‹æ˜¯&lt;strong&gt;å®Œå…¨é˜»å¡&lt;/strong&gt;ã€åœæ­¢å·¥ä½œçš„ï¼›è€Œæ´»é”ä¸­çš„çº¿ç¨‹ï¼ˆæ¶ˆè´¹è€…ï¼‰&lt;strong&gt;ä»åœ¨æ‰§è¡ŒæŸäº›åŠ¨ä½œ&lt;/strong&gt;ï¼ˆå¦‚å‘é€å¿ƒè·³ã€ç”šè‡³å¯èƒ½åœ¨è¿›è¡Œæ— æ•ˆçš„é‡è¯•ï¼‰ï¼Œä½†æ•´ä¸ªç³»ç»Ÿåœ¨æ¶ˆæ¯æ¶ˆè´¹ä¸Šæ²¡æœ‰å®è´¨æ€§è¿›å±•ã€‚&lt;/p&gt;
&lt;h3 id="-å¯¼è‡´æ´»é”çš„å¸¸è§åŸå› "&gt;ğŸš¦ å¯¼è‡´æ´»é”çš„å¸¸è§åŸå› 
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½æ•ˆçš„æ¶ˆæ¯å¤„ç†é€»è¾‘&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€å¸¸è§çš„åŸå› ã€‚å¦‚æœæ¶ˆè´¹è€…å¤„ç†å•æ¡æ¶ˆæ¯çš„ä»£ç éå¸¸è€—æ—¶ï¼Œä¾‹å¦‚åŒ…å«å¤æ‚çš„è®¡ç®—ã€ä½æ•ˆçš„æ•°æ®åº“æŸ¥è¯¢æˆ–åŒæ­¥çš„ç½‘ç»œIOè°ƒç”¨ï¼Œå°±ä¼šå¯¼è‡´æ¶ˆè´¹é€Ÿåº¦è¿œä½äºæ¶ˆæ¯æ‹‰å–é€Ÿåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰ç¼ºé™·çš„ä¸šåŠ¡é€»è¾‘&lt;/strong&gt;ï¼šä»£ç ä¸­å¯èƒ½å­˜åœ¨æ— é™å¾ªç¯ã€æ­»å¾ªç¯ï¼Œæˆ–è€…å¯¹ç‰¹å®šæ ¼å¼çš„å¼‚å¸¸æ¶ˆæ¯æ— æ³•å¤„ç†è€Œé™·å…¥åå¤é‡è¯•çš„é™·é˜±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢‘ç¹çš„æ¶ˆè´¹è€…ç»„é‡å¹³è¡¡&lt;/strong&gt;ï¼šå¦‚æœæ¶ˆè´¹è€…å› ä¸ºç½‘ç»œæŠ–åŠ¨ç­‰åŸå› é¢‘ç¹åœ°ä¸åè°ƒè€…æ–­å¼€è¿æ¥åˆé‡è¿ï¼Œä¼šä¸æ–­è§¦å‘é‡å¹³è¡¡ã€‚åœ¨é‡å¹³è¡¡æœŸé—´ï¼Œæ•´ä¸ªæ¶ˆè´¹è€…ç»„ä¼šæš‚åœæ¶ˆæ¯æ¶ˆè´¹ï¼Œé¢‘ç¹çš„é‡å¹³è¡¡ä¼šå¯¼è‡´æ¶ˆè´¹å·¥ä½œé¢‘ç¹ä¸­æ–­ï¼Œå½¢ä¼¼â€œæ´»é”â€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ°å½“çš„åç§»é‡æäº¤&lt;/strong&gt;ï¼šå¦‚æœä½¿ç”¨äº†è‡ªåŠ¨æäº¤åç§»é‡ï¼Œå¯èƒ½åœ¨æ¶ˆæ¯å°šæœªå¤„ç†å®Œæˆæ—¶å°±æäº¤äº†ã€‚è‹¥æ­¤æ—¶æ¶ˆè´¹è€…å´©æºƒåé‡å¯ï¼Œä¼šä»å·²æäº¤çš„åç§»é‡åå¼€å§‹æ¶ˆè´¹ï¼Œå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€‚å¦‚æœä¸ºäº†ç¡®ä¿ä¸ä¸¢å¤±è€Œé‡‡ç”¨æ‰‹åŠ¨æäº¤ï¼Œä½†æäº¤æ—¶æœºä¸å½“æˆ–æäº¤å¤±è´¥ï¼Œåˆå¯èƒ½å¯¼è‡´æ¶ˆæ¯è¢«é‡å¤æ¶ˆè´¹ï¼Œæ¶ˆè´¹è€…é™·å…¥â€œæ¶ˆè´¹-å¤±è´¥-é‡å¤æ¶ˆè´¹â€çš„å¾ªç¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-è§£å†³æ´»é”é—®é¢˜çš„å®ç”¨ç­–ç•¥"&gt;ğŸ› ï¸ è§£å†³æ´»é”é—®é¢˜çš„å®ç”¨ç­–ç•¥
&lt;/h3&gt;&lt;h4 id="1-ä¼˜åŒ–æ¶ˆè´¹è€…é…ç½®å‚æ•°"&gt;1. ä¼˜åŒ–æ¶ˆè´¹è€…é…ç½®å‚æ•°
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯æœ€ç›´æ¥å’Œæœ‰æ•ˆçš„è°ƒæ•´æ‰‹æ®µã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è°ƒæ•´ &lt;code&gt;max.poll.interval.ms&lt;/code&gt;&lt;/strong&gt;ï¼šæ ¹æ®ä¸šåŠ¡é€»è¾‘å¤„ç†çš„æœ€é•¿æ—¶é—´ï¼Œé€‚å½“è°ƒå¤§æ­¤å‚æ•°å€¼ï¼Œç»™æ¶ˆè´¹è€…è¶³å¤Ÿçš„å¤„ç†æ—¶é—´ï¼Œé¿å…è¢«è¯¯åˆ¤ä¸ºå¤±è´¥è€Œè§¦å‘é‡å¹³è¡¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶ &lt;code&gt;max.poll.records&lt;/code&gt;&lt;/strong&gt;ï¼šé™åˆ¶æ¯æ¬¡è°ƒç”¨ &lt;code&gt;poll()&lt;/code&gt;æ–¹æ³•è¿”å›çš„æœ€å¤§æ¶ˆæ¯æ•°é‡ã€‚è¿™æœ‰åŠ©äºæ§åˆ¶å•æ¬¡å¤„ç†çš„æ•°æ®é‡ï¼Œæ›´å®¹æ˜“é¢„æµ‹å’Œå¤„ç†å‘¨æœŸï¼Œé¿å…ä¸€æ‰¹æ¶ˆæ¯å¤ªå¤šå¯¼è‡´å¤„ç†è¶…æ—¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-ä¼˜åŒ–æ¶ˆæ¯å¤„ç†é€»è¾‘ä¸æ¶æ„"&gt;2. ä¼˜åŒ–æ¶ˆæ¯å¤„ç†é€»è¾‘ä¸æ¶æ„
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼šå®¡æŸ¥å¹¶ä¼˜åŒ–æ¶ˆè´¹ç«¯ä¸šåŠ¡ä»£ç ï¼Œä¾‹å¦‚ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢ã€ä½¿ç”¨ç¼“å­˜ã€å‡å°‘ä¸å¿…è¦çš„IOæ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥ä¸éé˜»å¡å¤„ç†&lt;/strong&gt;ï¼šå°†è€—æ—¶çš„æ“ä½œï¼ˆå¦‚è°ƒç”¨å¤–éƒ¨APIã€å›¾åƒå¤„ç†ï¼‰æ”¾å…¥å•ç‹¬çš„çº¿ç¨‹æ± æˆ–ä½¿ç”¨å¼‚æ­¥æ–¹å¼å¤„ç†ï¼Œç¡®ä¿æ¶ˆè´¹è€…ä¸»çº¿ç¨‹èƒ½å¤ŸåŠæ—¶è°ƒç”¨ &lt;code&gt;poll()&lt;/code&gt;ã€‚ä½†éœ€æ³¨æ„ç¡®ä¿åç§»é‡æäº¤çš„æ­£ç¡®æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡å¤„ç†&lt;/strong&gt;ï¼šå¦‚æœä¸šåŠ¡å…è®¸ï¼Œå¯ä»¥å°è¯•æ‰¹é‡å¤„ç†æ¶ˆæ¯ï¼Œå‡å°‘äº¤äº’å¼€é”€ï¼Œæé«˜ååé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-å®Œå–„é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶"&gt;3. å®Œå–„é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¥å£®çš„å¼‚å¸¸æ•è·&lt;/strong&gt;ï¼šåœ¨æ¶ˆæ¯å¤„ç†é€»è¾‘å‘¨å›´ä½¿ç”¨ &lt;code&gt;try-catch&lt;/code&gt;ï¼Œå¯¹å¯é‡è¯•çš„é”™è¯¯ï¼ˆå¦‚ç½‘ç»œæš‚æ—¶ä¸å¯ç”¨ï¼‰è¿›è¡Œæœ‰é™æ¬¡æ•°çš„é‡è¯•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­»ä¿¡é˜Ÿåˆ—&lt;/strong&gt;ï¼šå¯¹äºé‡è¯•å¤šæ¬¡åä»æ— æ³•å¤„ç†çš„æ¶ˆæ¯ï¼Œå¯ä»¥å°†å…¶å‘é€åˆ°ä¸€ä¸ªä¸“é—¨çš„â€œæ­»ä¿¡é˜Ÿåˆ—â€ï¼Œå¹¶è®°å½•æ—¥å¿—å‘Šè­¦ï¼Œç”±åç»­æµç¨‹è¿›è¡Œäººå·¥æˆ–ç‰¹æ®Šå¤„ç†ï¼Œé¿å…å•æ¡åæ¶ˆæ¯é˜»å¡æ•´ä¸ªæ¶ˆè´¹æµç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="4-ç¡®ä¿åç§»é‡æäº¤çš„å¯é æ€§"&gt;4. ç¡®ä¿åç§»é‡æäº¤çš„å¯é æ€§
&lt;/h4&gt;&lt;p&gt;å»ºè®®&lt;strong&gt;ç¦ç”¨è‡ªåŠ¨æäº¤&lt;/strong&gt;ï¼Œé‡‡ç”¨&lt;strong&gt;æ‰‹åŠ¨æäº¤&lt;/strong&gt;åç§»é‡ï¼Œå¹¶åœ¨æ¶ˆæ¯è¢«æˆåŠŸå¤„ç†åå†æäº¤ã€‚å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åŒæ­¥æäº¤æˆ–å¼‚æ­¥æäº¤ï¼Œå¹¶å¤„ç†å¥½æäº¤å¤±è´¥çš„é‡è¯•é€»è¾‘ï¼Œä»¥ç¡®ä¿ &lt;code&gt;at-least-once&lt;/code&gt;æˆ– &lt;code&gt;exactly-once&lt;/code&gt;çš„è¯­ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šå’Œç­–ç•¥èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œåº”å¯¹Kafkaä¸­çš„æ´»é”é—®é¢˜ã€‚å¦‚æœä½ åœ¨å…·ä½“å®è·µä¸­é‡åˆ°æ›´ç»†è‡´çš„æƒ…å†µï¼Œæ¬¢è¿éšæ—¶æå‡ºï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="å¢“ç¢‘æ¶ˆæ¯"&gt;å¢“ç¢‘æ¶ˆæ¯
&lt;/h2&gt;&lt;p&gt;å¢“ç¢‘æ¶ˆæ¯æ˜¯ Apache Kafka ä¸­ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ¶ˆæ¯ï¼Œå®ƒæœ¬èº«ä¸æºå¸¦æœ‰æ•ˆæ•°æ®ï¼ˆå…¶å€¼ä¸º &lt;code&gt;null&lt;/code&gt;ï¼‰ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªâ€œåˆ é™¤æ ‡è®°â€ä½¿ç”¨ï¼Œä¸»è¦åœ¨ä½¿ç”¨&lt;strong&gt;æ—¥å¿—å‹ç¼©&lt;/strong&gt;ç­–ç•¥çš„ä¸»é¢˜ä¸­ï¼ŒæŒ‡ç¤ºç³»ç»Ÿæ°¸ä¹…åˆ é™¤å…·æœ‰ç‰¹å®šé”®çš„æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹è¡¨æ¦‚æ‹¬äº† Kafka å¢“ç¢‘æ¶ˆæ¯çš„æ ¸å¿ƒç‰¹æ€§ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€ç§ Value ä¸º &lt;code&gt;null&lt;/code&gt;çš„ç‰¹æ®Šæ¶ˆæ¯ï¼Œå……å½“åˆ é™¤æ ‡è®°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿäº§è€…ä¸»åŠ¨å‘é€é”®ä¸ä¸ºç©ºä½†å€¼ä¸º &lt;code&gt;null&lt;/code&gt;çš„æ¶ˆæ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨æ—¥å¿—å‹ç¼©è¿‡ç¨‹ä¸­ï¼Œæ°¸ä¹…åˆ é™¤æŒ‡å®šé”®åŠå…¶æ‰€æœ‰å†å²å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†™å…¥æ—¥å¿—åä¸ä¼šç«‹å³åˆ é™¤ï¼Œä¼šä¿ç•™ä¸€æ®µå¯é…ç½®çš„æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤–è§‚ç‰¹å¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ™®é€šæ¶ˆæ¯ç»“æ„ç›¸åŒï¼Œä½† Value éƒ¨åˆ†ä¸ºç©º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº”ç”¨å‰æ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…å¯¹å¯ç”¨æ—¥å¿—å‹ç¼©ä¸”æ¶ˆæ¯æ‹¥æœ‰æœ‰æ•ˆé”®çš„ä¸»é¢˜æœ‰æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å·¥ä½œåŸç†ä¸ç”Ÿå‘½å‘¨æœŸ"&gt;ğŸ’¡ å·¥ä½œåŸç†ä¸ç”Ÿå‘½å‘¨æœŸ
&lt;/h3&gt;&lt;p&gt;å¢“ç¢‘æ¶ˆæ¯çš„å®ç°ä¾èµ–äº Kafka çš„&lt;strong&gt;æ—¥å¿—å‹ç¼©&lt;/strong&gt;æœºåˆ¶ã€‚ç†è§£å…¶å·¥ä½œæµç¨‹ï¼Œå…³é”®åœ¨äºå¼„æ¸…æ¥šä»æ¶ˆæ¯äº§ç”Ÿåˆ°æœ€ç»ˆè¢«æ¸…ç†çš„å®Œæ•´å‘¨æœŸã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ›´ç›´è§‚åœ°å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹ï¼Œä¸‹å›¾æç»˜äº†å¢“ç¢‘æ¶ˆæ¯ä»äº§ç”Ÿåˆ°å®Œæˆä½¿å‘½çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;flowchart TD
A[åº”ç”¨å‘é€é”®ä¸ºKçš„å¢“ç¢‘æ¶ˆæ¯] --&amp;gt; B[å¢“ç¢‘æ¶ˆæ¯ä»¥æ™®é€šæ¶ˆæ¯å½¢å¼&amp;lt;br&amp;gt;å†™å…¥Kafkaåˆ†åŒºæ—¥å¿—]
B --&amp;gt; C{æ—¥å¿—å‹ç¼©çº¿ç¨‹å¯åŠ¨}
C --&amp;gt; D[å‹ç¼©çº¿ç¨‹æ‰«ææ—¥å¿—&amp;lt;br&amp;gt;å¹¶æ„å»ºæ¯ä¸ªé”®çš„åç§»é‡æ˜ å°„]
D --&amp;gt; E{å‘ç°é”®Kå¯¹åº”çš„&amp;lt;br&amp;gt;æœ€æ–°æ¶ˆæ¯æ˜¯å¢“ç¢‘æ¶ˆæ¯?}
E -- æ˜¯ --&amp;gt; F[ä¿ç•™å¢“ç¢‘æ¶ˆæ¯&amp;lt;br&amp;gt;å¹¶åˆ é™¤è¯¥é”®æ‰€æœ‰å†å²å€¼]
E -- å¦ --&amp;gt; G[ä»…ä¿ç•™é”®Kçš„æœ€æ–°æ¶ˆæ¯]
F --&amp;gt; H[å¢“ç¢‘æ¶ˆæ¯åœ¨ä¿ç•™æœŸå†…&amp;lt;br&amp;gt;å¯¹æ¶ˆè´¹è€…å¯è§]
H --&amp;gt; I{å¢“ç¢‘æ¶ˆæ¯ä¿ç•™æœŸå·²åˆ°?}
I -- æ˜¯ --&amp;gt; J[åœ¨åç»­å‹ç¼©ä¸­&amp;lt;br&amp;gt;ç§»é™¤å¢“ç¢‘æ¶ˆæ¯æœ¬èº«]
I -- å¦ --&amp;gt; H
G --&amp;gt; K[å‹ç¼©å®Œæˆ]
J --&amp;gt; K
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªæµç¨‹çš„å…³é”®é˜¶æ®µåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†™å…¥é˜¶æ®µ&lt;/strong&gt;ï¼šåº”ç”¨ç¨‹åºé€šè¿‡ç”Ÿäº§è€…å®¢æˆ·ç«¯ï¼Œå‘é€ä¸€æ¡&lt;strong&gt;é”®ï¼ˆKeyï¼‰ä¸ºéœ€è¦åˆ é™¤çš„ç›®æ ‡é”®ï¼Œå€¼ï¼ˆValueï¼‰ä¸º &lt;code&gt;null&lt;/code&gt;&lt;/strong&gt; çš„æ¶ˆæ¯ã€‚Kafka Broker ä¼šåƒå¤„ç†ä»»ä½•æ™®é€šæ¶ˆæ¯ä¸€æ ·ï¼Œå°†è¿™æ¡å¢“ç¢‘æ¶ˆæ¯è¿½åŠ åˆ°å¯¹åº”åˆ†åŒºçš„æ—¥å¿—æœ«å°¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‹ç¼©ä¸åˆ é™¤é˜¶æ®µ&lt;/strong&gt;ï¼šKafka çš„æ—¥å¿—æ¸…ç†çº¿ç¨‹ä¼šå®šæœŸå¯¹æ—¥å¿—è¿›è¡Œå‹ç¼©ã€‚å‹ç¼©çš„æ ¸å¿ƒé€»è¾‘æ˜¯&lt;strong&gt;ä¸ºæ¯ä¸ªé”®åªä¿ç•™å…¶æœ€æ–°ç‰ˆæœ¬çš„å€¼&lt;/strong&gt;ã€‚å½“æ¸…ç†çº¿ç¨‹é‡åˆ°ä¸€æ¡å¢“ç¢‘æ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šè¢«è§†ä¸ºè¯¥é”®çš„â€œæœ€æ–°å€¼â€ã€‚ç”±äºè¿™ä¸ªâ€œå€¼â€æ˜¯ &lt;code&gt;null&lt;/code&gt;ï¼Œæ¸…ç†çº¿ç¨‹çš„æ“ä½œæ˜¯ï¼š&lt;strong&gt;ä¿ç•™è¿™æ¡å¢“ç¢‘æ¶ˆæ¯ï¼Œå¹¶åˆ é™¤è¯¥é”®ä¹‹å‰æ‰€æœ‰çš„å†å²æ¶ˆæ¯&lt;/strong&gt;ã€‚è¿™æ ·ï¼Œè¿™ä¸ªé”®åŠå…¶å…³è”çš„æ•°æ®å°±è¢«æœ‰æ•ˆåœ°æ ‡è®°ä¸ºâ€œå·²åˆ é™¤â€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿ç•™ä¸æœ€ç»ˆæ¸…ç†é˜¶æ®µ&lt;/strong&gt;ï¼šå¢“ç¢‘æ¶ˆæ¯è¢«ä¿ç•™ä¸€æ®µæ—¶é—´ï¼ˆé€šè¿‡ &lt;code&gt;delete.retention.ms&lt;/code&gt;å‚æ•°é…ç½®ï¼Œé»˜è®¤é€šå¸¸ä¸º24å°æ—¶ï¼‰ï¼Œä»¥ç¡®ä¿æ‰€æœ‰æ¶ˆè´¹è€…éƒ½æœ‰è¶³å¤Ÿçš„æ—¶é—´çœ‹åˆ°è¿™æ¡åˆ é™¤æ ‡è®°ã€‚åœ¨æ­¤æœŸé—´ï¼Œæ¶ˆè´¹è€…ä»ç„¶å¯ä»¥è¯»å–åˆ°è¿™æ¡å¢“ç¢‘æ¶ˆæ¯ã€‚ä¸€æ—¦è¶…è¿‡ä¿ç•™æœŸï¼Œåœ¨ä¸‹ä¸€æ¬¡æ—¥å¿—å‹ç¼©æ—¶ï¼Œ&lt;strong&gt;å¢“ç¢‘æ¶ˆæ¯æœ¬èº«ä¹Ÿä¼šè¢«æ¸…é™¤&lt;/strong&gt;ï¼Œè¿™ä¸ªé”®å°†å½»åº•ä»åˆ†åŒºæ—¥å¿—ä¸­æ¶ˆå¤±ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸»è¦åº”ç”¨åœºæ™¯"&gt;ğŸ¯ ä¸»è¦åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;å¢“ç¢‘æ¶ˆæ¯çš„è®¾è®¡ä¸»è¦æ˜¯ä¸ºäº†æ»¡è¶³ä»¥ä¸‹ä¸¤ç§å…¸å‹éœ€æ±‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®æ•°æ®åˆ é™¤&lt;/strong&gt;ï¼šå½“éœ€è¦ä»Kafkaä¸­æ°¸ä¹…åˆ é™¤ä¸æŸä¸ªç‰¹å®šé”®ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯æ—¶ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·æ³¨é”€è´¦å·åï¼Œéœ€è¦åˆ é™¤è¯¥ç”¨æˆ·çš„å…¨éƒ¨ä¸ªäººä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¯æŒæœ€ç»ˆä¸€è‡´æ€§&lt;/strong&gt;ï¼šåœ¨è¯»å†™Kafkaçš„ç³»ç»Ÿä¸­ï¼Œé€šè¿‡å¢“ç¢‘æ¶ˆæ¯ç¡®ä¿å·²åˆ é™¤çš„æ•°æ®ä¸ä¼šåœ¨å‹ç¼©åå› â€œæœ€ç»ˆåªä¿ç•™æœ€æ–°å€¼â€çš„æœºåˆ¶è€Œæ„å¤–é‡ç°ï¼Œç»´æŠ¤æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é‡è¦å®è·µè€ƒé‡"&gt;âš ï¸ é‡è¦å®è·µè€ƒé‡
&lt;/h3&gt;&lt;p&gt;åœ¨ä½¿ç”¨å¢“ç¢‘æ¶ˆæ¯æ—¶ï¼Œæœ‰å‡ ä¸ªå…³é”®ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…éœ€æ„ŸçŸ¥å¢“ç¢‘æ¶ˆæ¯&lt;/strong&gt;ï¼šä½ çš„æ¶ˆè´¹è€…åº”ç”¨ç¨‹åºå¿…é¡»èƒ½å¤Ÿè¯†åˆ«å’Œå¤„ç†Valueä¸º&lt;code&gt;null&lt;/code&gt;çš„æ¶ˆæ¯ã€‚è¿™æ„å‘³ç€å½“è¯»åˆ°å¢“ç¢‘æ¶ˆæ¯æ—¶ï¼Œæ¶ˆè´¹è€…åº”æ‰§è¡Œç›¸åº”çš„åˆ é™¤é€»è¾‘ï¼ˆä¾‹å¦‚ï¼Œä»æœ¬åœ°æ•°æ®åº“æˆ–ç¼“å­˜ä¸­åˆ é™¤å¯¹åº”é”®çš„æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¡®ä¿ä¿ç•™æ—¶é—´è¶³å¤Ÿé•¿&lt;/strong&gt;ï¼šåŠ¡å¿…ä¸ºå¢“ç¢‘æ¶ˆæ¯è®¾ç½®è¶³å¤Ÿé•¿çš„ä¿ç•™æ—¶é—´ï¼ˆ&lt;code&gt;delete.retention.ms&lt;/code&gt;ï¼‰ï¼Œç¡®ä¿å³ä½¿æœ‰æ¶ˆè´¹è€…çŸ­æš‚ç¦»çº¿ï¼Œåœ¨é‡æ–°ä¸Šçº¿åä¹Ÿæœ‰æœºä¼šè¯»åˆ°å¢“ç¢‘æ¶ˆæ¯ï¼Œé¿å…å› é”™è¿‡åˆ é™¤æ ‡è®°è€Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»…é€‚ç”¨äºæœ‰é”®çš„æ¶ˆæ¯&lt;/strong&gt;ï¼šå¢“ç¢‘æ¶ˆæ¯åªå¯¹æ¶ˆæ¯é”®æœ‰æ•ˆã€‚å¦‚æœæ¶ˆæ¯çš„é”®ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œå¢“ç¢‘æœºåˆ¶å°†ä¸èµ·ä½œç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ å…¨é¢ç†è§£Kafkaçš„å¢“ç¢‘æ¶ˆæ¯ã€‚å¦‚æœä½ å¯¹æ—¥å¿—å‹ç¼©çš„å…·ä½“å®ç°ç»†èŠ‚æˆ–å…¶ä»–Kafkaæ¦‚å¿µæ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="æ—¥å¿—å‹ç¼©"&gt;æ—¥å¿—å‹ç¼©
&lt;/h2&gt;&lt;p&gt;Kafka çš„æ—¥å¿—å‹ç¼©ï¼ˆLog Compactionï¼‰æ˜¯ä¸€ç§éå¸¸ç²¾å·§çš„è®¾è®¡ï¼Œå®ƒé€šè¿‡åœ¨åå°ä¸æ–­æ•´ç†æ•°æ®ï¼Œç¡®ä¿æ¯ä¸ª Key åªä¿ç•™å…¶æœ€æ–°çš„ Valueï¼Œä»è€Œåœ¨æä¾›å®Œæ•´æ•°æ®å†å²çš„åŒæ—¶ï¼Œæå¤§åœ°èŠ‚çœäº†å­˜å‚¨ç©ºé—´å¹¶æå‡äº†è¯»å–æ•ˆç‡ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹è¡¨æ±‡æ€»äº†å®ç°è¿™ä¸€æœºåˆ¶çš„æ ¸å¿ƒç»„ä»¶ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ ¸å¿ƒç»„ä»¶&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒèŒè´£ä¸æœºåˆ¶&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¥å¿—åˆ†æ®µ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ—¥å¿—åœ¨ç‰©ç†ä¸Šç”±å¤šä¸ªé¡ºåºå†™å…¥çš„æ—¥å¿—åˆ†æ®µæ–‡ä»¶ç»„æˆï¼Œå‹ç¼©ä»¥åˆ†æ®µä¸ºåŸºæœ¬æ“ä½œå•å…ƒã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶ˆæ¯é”®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯æ¡æ¶ˆæ¯çš„å¯é€‰é”®æ˜¯å‹ç¼©æ“ä½œçš„ä¾æ®ï¼Œç›¸åŒé”®çš„æ¶ˆæ¯è¢«è§†ä¸ºåŒä¸€æ•°æ®çš„ä¸åŒç‰ˆæœ¬ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‹ç¼©çº¿ç¨‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åå°çš„æ¸…ç†çº¿ç¨‹æ± è´Ÿè´£æ‰§è¡Œå‹ç¼©ä»»åŠ¡ï¼Œä¼šé€‰æ‹©â€œæœ€è„â€çš„æ—¥å¿—åˆ†æ®µè¿›è¡Œå¤„ç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è„æ•°æ®æ¯”ç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è§¦å‘å‹ç¼©çš„å…³é”®é˜ˆå€¼ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š&lt;code&gt;è„æ•°æ®æ¯”ç‡ = å¯æ¸…ç†æ•°æ®å¤§å° / æ—¥å¿—åˆ†æ®µæ€»å¤§å°&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ é™¤æ ‡è®°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€ç§ç‰¹æ®Šçš„ Value ä¸º &lt;code&gt;null&lt;/code&gt;çš„æ¶ˆæ¯ï¼Œç”¨äºæ ‡è®°æŸä¸ª Key çš„æ•°æ®éœ€è¦è¢«åˆ é™¤ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ—¥å¿—å‹ç¼©çš„å·¥ä½œåŸç†"&gt;ğŸ’¡ æ—¥å¿—å‹ç¼©çš„å·¥ä½œåŸç†
&lt;/h3&gt;&lt;p&gt;æ—¥å¿—å‹ç¼©çš„æ ¸å¿ƒç›®æ ‡æ˜¯éå†æ—¥å¿—ï¼Œä¸ºæ¯ä¸ª Key åªä¿ç•™å…¶æœ€æ–°ç‰ˆæœ¬çš„å€¼ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥æ¦‚æ‹¬ä¸ºâ€œ&lt;strong&gt;ä¸¤éæ‰«æï¼Œä¸€éå†™å…¥&lt;/strong&gt;â€ï¼Œå…¶å…·ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;flowchart TD
A[å¯åŠ¨æ—¥å¿—å‹ç¼©] --&amp;gt; B[é€‰æ‹©è„æ•°æ®æ¯”ç‡æœ€é«˜çš„æ—¥å¿—åˆ†æ®µ]
B --&amp;gt; C[ç¬¬ä¸€éæ‰«æ&amp;lt;br&amp;gt;å»ºç«‹é”®ä¸æœ€æ–°åç§»é‡çš„æ˜ å°„]
C --&amp;gt; D[ç¬¬äºŒéæ‰«æ&amp;lt;br&amp;gt;æ£€æŸ¥é”®æ˜¯å¦åœ¨æ˜ å°„ä¸­ä¸”ä¸ºæœ€æ–°]
D --&amp;gt; E{å½“å‰è®°å½•æ˜¯å¦ä¸º&amp;lt;br&amp;gt;è¯¥é”®çš„æœ€æ–°ç‰ˆæœ¬?}
E -- æ˜¯ --&amp;gt; F[å°†è®°å½•å†™å…¥æ–°çš„åˆ†æ®µæ–‡ä»¶]
E -- å¦ --&amp;gt; G[è·³è¿‡/ä¸¢å¼ƒè¯¥è®°å½•]
F --&amp;gt; H[æ‰€æœ‰è®°å½•å¤„ç†å®Œæ¯•?]
G --&amp;gt; H
H -- å¦ --&amp;gt; D
H -- æ˜¯ --&amp;gt; I[ç”¨æ–°çš„åˆ†æ®µæ–‡ä»¶&amp;lt;br&amp;gt;åŸå­æ›¿æ¢æ—§çš„åˆ†æ®µæ–‡ä»¶]
I --&amp;gt; J[å¼‚æ­¥åˆ é™¤æ—§çš„åˆ†æ®µæ–‡ä»¶]
J --&amp;gt; K[å‹ç¼©å®Œæˆ]
&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©å‹ç¼©ç›®æ ‡&lt;/strong&gt;ï¼šKafka çš„æ¸…ç†çº¿ç¨‹ä¼šå®šæœŸæ£€æŸ¥æ‰€æœ‰æ—¥å¿—åˆ†æ®µï¼Œå¹¶é€‰æ‹©å…¶ä¸­â€œè„æ•°æ®æ¯”ç‡â€æœ€é«˜çš„åˆ†æ®µè¿›è¡Œå‹ç¼©ã€‚è„æ•°æ®æ¯”ç‡æ˜¯æŒ‡è¯¥åˆ†æ®µä¸­å¯ä»¥è¢«æ¸…ç†çš„æ—§æ•°æ®æ‰€å çš„æ¯”ä¾‹ã€‚å½“è¿™ä¸ªæ¯”ç‡è¶…è¿‡é…ç½®çš„é˜ˆå€¼ï¼ˆç”± &lt;code&gt;min.cleanable.dirty.ratio&lt;/code&gt;æ§åˆ¶ï¼Œé»˜è®¤0.5ï¼‰æ—¶ï¼Œå‹ç¼©å°±ä¼šè¢«è§¦å‘ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸¤éæ‰«æ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ä¸€éæ‰«æï¼ˆå»ºç«‹æ‘˜è¦ï¼‰&lt;/strong&gt;ï¼šæ¸…ç†çº¿ç¨‹ä¼šæ‰«æé€‰å®šçš„æ—¥å¿—åˆ†æ®µï¼Œå¹¶æ„å»ºä¸€ä¸ªâ€œé”® -&amp;gt; è¯¥é”®æœ€æ–°æ¶ˆæ¯åç§»é‡â€çš„æ˜ å°„å…³ç³»ã€‚è¿™ä¸ªæ˜ å°„ç›¸å½“äºä¸€ä¸ªæ¸…å•ï¼ŒæŒ‡æ˜äº†å“ªäº›è®°å½•æ˜¯éœ€è¦ä¿ç•™çš„æœ€ç»ˆç‰ˆæœ¬ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬äºŒéæ‰«æï¼ˆå¤åˆ¶å†™å›ï¼‰&lt;/strong&gt;ï¼šçº¿ç¨‹å†æ¬¡ä»å¤´æ‰«æè¯¥åˆ†æ®µã€‚å¯¹äºæ¯ä¸€æ¡è®°å½•ï¼Œå®ƒä¼šæ£€æŸ¥å…¶é”®æ˜¯å¦å‡ºç°åœ¨åˆšæ‰å»ºç«‹çš„æ˜ å°„ä¸­ï¼Œå¹¶ä¸”å½“å‰çš„åç§»é‡æ˜¯å¦å°±æ˜¯æ˜ å°„ä¸­è®°å½•çš„æœ€æ–°åç§»é‡ã€‚
&lt;ul&gt;
&lt;li&gt;å¦‚æœ&lt;strong&gt;æ˜¯&lt;/strong&gt;ï¼Œåˆ™è¯´æ˜è¿™æ¡è®°å½•æ˜¯è¯¥é”®çš„æœ€æ–°å€¼ï¼Œå°†å…¶å¤åˆ¶åˆ°æ–°çš„ã€å‹ç¼©åçš„åˆ†æ®µæ–‡ä»¶ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœ&lt;strong&gt;ä¸æ˜¯&lt;/strong&gt;ï¼Œåˆ™è¯´æ˜è¿™æ¡è®°å½•æ˜¯æ—§ç‰ˆæœ¬ï¼Œå°†è¢«è·³è¿‡å’Œä¸¢å¼ƒ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ›¿æ¢&lt;/strong&gt;ï¼šå½“æ•´ä¸ªåˆ†æ®µå‹ç¼©å®Œæˆåï¼ŒKafka ä¼šè¿›è¡Œä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼šå°†æ—§çš„ã€åŒ…å«å†—ä½™æ•°æ®çš„åˆ†æ®µæ–‡ä»¶æ›¿æ¢ä¸ºæ–°çš„ã€ç²¾ç®€åçš„åˆ†æ®µæ–‡ä»¶ã€‚è¿™ä¸ªæ“ä½œå¯¹ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ˜¯å®Œå…¨é€æ˜çš„ï¼Œç¡®ä¿äº†æ•°æ®çš„ä¸€è‡´æ€§ã€‚æ—§æ–‡ä»¶éšåä¼šè¢«å¼‚æ­¥åˆ é™¤ ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å…³é”®é…ç½®ä¸é«˜çº§ç‰¹æ€§"&gt;âš™ï¸ å…³é”®é…ç½®ä¸é«˜çº§ç‰¹æ€§
&lt;/h3&gt;&lt;p&gt;è¦è®©æ—¥å¿—å‹ç¼©æŒ‰é¢„æœŸå·¥ä½œï¼Œéœ€è¦å…³æ³¨å‡ ä¸ªå…³é”®é…ç½®å‚æ•°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;cleanup.policy=compact&lt;/code&gt;&lt;/strong&gt;ï¼šè¿™æ˜¯å¯ç”¨æ—¥å¿—å‹ç¼©çš„æ ¸å¿ƒå¼€å…³ï¼Œéœ€è¦åœ¨ä¸»é¢˜çº§åˆ«è¿›è¡Œé…ç½® ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;min.cleanable.dirty.ratio&lt;/code&gt;&lt;/strong&gt;ï¼šæ§åˆ¶è§¦å‘å‹ç¼©çš„â€œè„åº¦â€é˜ˆå€¼ã€‚æ¯”å€¼è¶Šå°ï¼Œå‹ç¼©è§¦å‘è¶Šé¢‘ç¹ï¼Œå­˜å‚¨ç©ºé—´æ›´èŠ‚çœï¼Œä½†CPUå’ŒIOå¼€é”€æ›´å¤§ï¼›æ¯”å€¼è¶Šå¤§åˆ™ç›¸å ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;delete.retention.ms&lt;/code&gt;&lt;/strong&gt;ï¼šé…ç½®åˆ é™¤æ ‡è®°ï¼ˆTombstoneï¼‰åœ¨æ—¥å¿—ä¸­ä¿ç•™çš„æ—¶é—´ï¼ˆé»˜è®¤24å°æ—¶ï¼‰ã€‚åœ¨è¿™æœŸé—´ï¼Œæ¶ˆè´¹è€…èƒ½å¤Ÿçœ‹åˆ°è¿™ä¸ªåˆ é™¤æ ‡è®°ï¼Œä»è€ŒçŸ¥é“æŸä¸ªKeyå·²è¢«åˆ é™¤ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;min.compaction.lag.ms&lt;/code&gt;&lt;/strong&gt;ï¼šè§„å®šä¸€æ¡æ¶ˆæ¯åœ¨å†™å…¥åå¿…é¡»ç»è¿‡å¤šé•¿æ—¶é—´æ‰èƒ½è¢«å‹ç¼©ã€‚è¿™ç¡®ä¿äº†æ¶ˆæ¯æœ‰è¶³å¤Ÿçš„æ—¶é—´è¢«æ‰€æœ‰æ¶ˆè´¹è€…è¯»å–ï¼Œé€‚ç”¨äºå¯¹å®æ—¶æ€§æœ‰è¦æ±‚çš„åœºæ™¯ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ"&gt;ğŸ¯ åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;p&gt;æ—¥å¿—å‹ç¼©å¹¶éé€‚ç”¨äºæ‰€æœ‰åœºæ™¯ï¼Œå®ƒæœ€é€‚åˆä»¥ä¸‹ç±»å‹çš„åº”ç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å˜æ›´æ•°æ®æ•è·&lt;/strong&gt;ï¼šå°†æ•°æ®åº“çš„å˜æ›´æµåŒæ­¥åˆ°Kafkaæ—¶ï¼Œæ¯ä¸ªè¡¨è¡Œçš„ä¸»é”®ä½œä¸ºæ¶ˆæ¯Keyã€‚å‹ç¼©èƒ½ä¿è¯æ¯ä¸ªè¡Œæœ€ç»ˆåªä¿ç•™æœ€æ–°çš„çŠ¶æ€ï¼Œæå¤§èŠ‚çœç©ºé—´ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®ç®¡ç†&lt;/strong&gt;ï¼šå­˜å‚¨ç³»ç»Ÿæˆ–åº”ç”¨çš„é…ç½®é¡¹ï¼Œä»¥é…ç½®IDä¸ºKeyã€‚å‹ç¼©èƒ½ç¡®ä¿ä»»ä½•æ—¶å€™è¯»å–åˆ°çš„éƒ½æ˜¯æœ€æ–°é…ç½® ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€å­˜å‚¨&lt;/strong&gt;ï¼šåœ¨æµå¤„ç†ä¸­ï¼Œå°†è®¡ç®—çš„ä¸­é—´çŠ¶æ€ï¼ˆå¦‚ç”¨æˆ·ä¼šè¯ï¼‰å­˜å…¥Kafkaã€‚æ•…éšœæ¢å¤æ—¶ï¼Œåªéœ€è¯»å–å‹ç¼©åçš„æœ€æ–°çŠ¶æ€ï¼Œèƒ½æå¤§åŠ å¿«æ¢å¤é€Ÿåº¦ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µå»ºè®®ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¡®ä¿æ¶ˆæ¯æœ‰é”®&lt;/strong&gt;ï¼šåªæœ‰å¸¦é”®çš„æ¶ˆæ¯æ‰ä¼šè¢«å‹ç¼©å¤„ç† ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å‹ç¼©è¿›åº¦&lt;/strong&gt;ï¼šå…³æ³¨ &lt;code&gt;dirty.records.ratio&lt;/code&gt;å’Œ &lt;code&gt;compaction.lag.time&lt;/code&gt;ç­‰æŒ‡æ ‡ï¼Œç¡®ä¿å‹ç¼©å·¥ä½œæ­£å¸¸ï¼Œæ²¡æœ‰æ»å ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆç†è®¾ç½®åˆ†æ®µå¤§å°&lt;/strong&gt;ï¼šè¿‡å¤§çš„åˆ†æ®µå¯èƒ½å»¶é•¿å•æ¬¡å‹ç¼©æ—¶é—´ï¼Œè¿‡å°çš„åˆ†æ®µåˆ™ä¼šäº§ç”Ÿå¤ªå¤šæ–‡ä»¶ã€‚é»˜è®¤1GBé€šå¸¸æ˜¯ä¸ªä¸é”™çš„èµ·ç‚¹ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ é€å½»åœ°ç†è§£Kafkaæ—¥å¿—å‹ç¼©çš„å®ç°åŸç†ã€‚å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šåœºæ™¯ä¸‹çš„é…ç½®æˆ–å†…éƒ¨æœºåˆ¶æœ‰æ›´è¿›ä¸€æ­¥çš„å…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="æ—¥å¿—åˆ é™¤--æ—¥å¿—å‹ç¼©"&gt;æ—¥å¿—åˆ é™¤ &amp;amp; æ—¥å¿—å‹ç¼©
&lt;/h2&gt;&lt;p&gt;ç†è§£ Kafka æ—¥å¿—å‹ç¼©ä¸æ™®é€šæ—¥å¿—åˆ é™¤ç­–ç•¥åœ¨æ€§èƒ½ä¸Šçš„å·®å¼‚ï¼Œå…³é”®åœ¨äºè®¤è¯†åˆ°å®ƒä»¬çš„è®¾è®¡ç›®æ ‡ä¸åŒï¼š&lt;strong&gt;åˆ é™¤ç­–ç•¥è¿½æ±‚ç®€å•é«˜æ•ˆåœ°æ¸…ç†æ•°æ®ï¼Œè€Œå‹ç¼©ç­–ç•¥åˆ™é€šè¿‡æ¶ˆè€—é¢å¤–è®¡ç®—èµ„æºæ¥æ¢å–å­˜å‚¨æ•ˆç‡å’ŒçŠ¶æ€ç»´æŠ¤èƒ½åŠ›&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯ä»¥è®©ä½ å¿«é€ŸæŠ“ä½æ ¸å¿ƒåŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ€§èƒ½å½±å“ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ—¥å¿—åˆ é™¤ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ—¥å¿—å‹ç¼©ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥åˆ é™¤æ•´ä¸ªè¿‡æœŸçš„æ—¥å¿—åˆ†æ®µæ–‡ä»¶&lt;/td&gt;
&lt;td&gt;æ‰«ææ—¥å¿—å†…å®¹ï¼Œä¿ç•™æ¯ä¸ªKeyçš„æœ€æ–°å€¼ï¼Œé‡å†™æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CPUå¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½&lt;/strong&gt;ã€‚ä»…éœ€æ£€æŸ¥æ–‡ä»¶æ—¶é—´æˆ–å¤§å°å¹¶åˆ é™¤ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜&lt;/strong&gt;ã€‚éœ€æ‰«æã€æ¯”è¾ƒé”®å€¼å¯¹å¹¶é‡å†™æ–‡ä»¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç£ç›˜I/O&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½ä¸”ç®€å•&lt;/strong&gt;ã€‚ä¸»è¦æ˜¯åˆ é™¤æ–‡ä»¶çš„æ“ä½œã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜ä¸”å¤æ‚&lt;/strong&gt;ã€‚æ¶‰åŠå¤§é‡æ•°æ®çš„è¯»å–å’Œå†™å…¥ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‡ ä¹ä¸å ç”¨é¢å¤–å†…å­˜ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è¾ƒé«˜&lt;/strong&gt;ã€‚éœ€åœ¨å†…å­˜ä¸­æ„å»ºâ€œé”®-æœ€æ–°åç§»é‡â€çš„æ˜ å°„è¡¨ï¼ˆå¦‚SkimpyOffsetMapï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯¹ç”Ÿäº§/æ¶ˆè´¹çš„å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å½±å“å°ã€‚åå°åˆ é™¤æ“ä½œä¸ä¸»æµç¨‹åŸºæœ¬éš”ç¦»ã€‚&lt;/td&gt;
&lt;td&gt;å¯èƒ½å¼•èµ·è½»å¾®å»¶è¿Ÿã€‚å‹ç¼©è¿‡ç¨‹ä¸­çš„I/Oå’ŒCPUæ¶ˆè€—å¯èƒ½ä¸æ­£å¸¸è¯»å†™ç«äº‰èµ„æºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®æ¨¡å‹ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€‚ç”¨äº&lt;strong&gt;äº‹ä»¶æµæ•°æ®&lt;/strong&gt;ï¼ˆå¦‚æ—¥å¿—è®°å½•ï¼‰ï¼Œæ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ç‹¬ç«‹äº‹ä»¶ã€‚&lt;/td&gt;
&lt;td&gt;é€‚ç”¨äº&lt;strong&gt;çŠ¶æ€æµæ•°æ®&lt;/strong&gt;ï¼ˆå¦‚æ•°æ®åº“å˜æ›´ï¼‰ï¼Œéœ€è¦ç»´æŠ¤é”®çš„æœ€æ–°çŠ¶æ€ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ·±å…¥è§£ææ€§èƒ½å·®å¼‚çš„æ ¹æº"&gt;ğŸ’¡ æ·±å…¥è§£ææ€§èƒ½å·®å¼‚çš„æ ¹æº
&lt;/h3&gt;&lt;p&gt;è¿™ä¸¤ç§ç­–ç•¥æ€§èƒ½å·®å¼‚çš„æ ¹æºåœ¨äºå®ƒä»¬è§£å†³é—®é¢˜çš„é€»è¾‘å®Œå…¨ä¸åŒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ—¥å¿—åˆ é™¤çš„ç­–ç•¥é€»è¾‘æ˜¯â€œè¿‡æœŸä¸¢å¼ƒâ€&lt;/strong&gt;ï¼šå®ƒæŠŠæ—¥å¿—çœ‹ä½œæŒ‰æ—¶é—´é¡ºåºæ’åˆ—çš„äº‹ä»¶æµã€‚å…¶æ ¸å¿ƒä»»åŠ¡æ˜¯&lt;strong&gt;åŸºäºæ—¶é—´ï¼ˆå¦‚é»˜è®¤ä¿ç•™7å¤©ï¼‰æˆ–æ—¥å¿—æ€»å¤§å°æ¥åˆ¤æ–­å“ªäº›æ•´ä¸ªçš„æ—¥å¿—åˆ†æ®µæ–‡ä»¶å¯ä»¥è¢«å®‰å…¨åœ°ç§»é™¤&lt;/strong&gt;ã€‚è¿™ä¸ªæ“ä½œéå¸¸è½»é‡ï¼Œç±»ä¼¼äºæ¸…ç†ç”µè„‘ä¸Šè¿‡æœŸçš„ä¸´æ—¶æ–‡ä»¶ï¼Œç›´æ¥åˆ é™¤å³å¯ï¼Œå¯¹ç³»ç»Ÿæ€§èƒ½å½±å“å¾®ä¹å…¶å¾®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ—¥å¿—å‹ç¼©çš„ç­–ç•¥é€»è¾‘æ˜¯â€œç²¾ç›Šæ±‚ç²¾â€&lt;/strong&gt;ï¼šå®ƒæŠŠæ—¥å¿—çœ‹ä½œä¸€ä¸ªé”®å€¼å¯¹å­˜å‚¨ç³»ç»Ÿã€‚å…¶ç›®æ ‡æ˜¯åœ¨æµ·é‡å†å²æ•°æ®ä¸­&lt;strong&gt;ä¸ºæ¯ä¸ªé”®ï¼ˆKeyï¼‰ä¿ç•™æœ€æ–°çš„å€¼ï¼ˆValueï¼‰&lt;/strong&gt;ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼Œå‹ç¼©çº¿ç¨‹éœ€è¦æ‰§è¡Œä¸€ç³»åˆ—å¤æ‚æ“ä½œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ‰«æä¸æ˜ å°„&lt;/strong&gt;ï¼šéå†æ—¥å¿—åˆ†æ®µï¼Œä¸ºæ¯ä¸ªé”®è®°å½•å…¶æœ€åå‡ºç°çš„ä½ç½®ï¼ˆåç§»é‡ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¯”è¾ƒä¸é‡å†™&lt;/strong&gt;ï¼šå†æ¬¡éå†ï¼Œåªå°†æ¯ä¸ªé”®çš„æœ€æ–°ç‰ˆæœ¬æ•°æ®å†™å…¥ä¸€ä¸ªæ–°çš„ã€å‹ç¼©åçš„æ—¥å¿—åˆ†æ®µæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸå­æ›¿æ¢&lt;/strong&gt;ï¼šç”¨æ–°çš„ã€æ›´ç²¾ç‚¼çš„æ–‡ä»¶æ›¿æ¢æ—§çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹å°±åƒæ•´ç†ä¸€ä¸ªä¸æ–­æ›´æ–°çš„æ¡£æ¡ˆåº“ï¼Œéœ€è¦ä»”ç»†ç”„åˆ«æ¯ä¸€ä»½æ–‡ä»¶ï¼Œåªä¿ç•™æœ€ç»ˆç‰ˆæœ¬ï¼Œå…¶è®¡ç®—å’ŒI/Oå¼€é”€è‡ªç„¶è¿œé«˜äºç®€å•çš„â€œæ•´ç®±ä¸¢å¼ƒâ€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¼˜åŒ–ç­–ç•¥ä¸é€‰å‹å»ºè®®"&gt;ğŸ”§ ä¼˜åŒ–ç­–ç•¥ä¸é€‰å‹å»ºè®®
&lt;/h3&gt;&lt;p&gt;äº†è§£äº†æ ¹æœ¬åŒºåˆ«ï¼Œä½ å°±å¯ä»¥æ ¹æ®å®é™…åœºæ™¯è¿›è¡Œé€‰æ‹©å’Œä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¦‚ä½•é€‰æ‹©ç­–ç•¥ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©æ—¥å¿—åˆ é™¤ç­–ç•¥ï¼Œå¦‚æœ&lt;/strong&gt;ï¼šä½ çš„æ•°æ®æ˜¯&lt;strong&gt;äº‹ä»¶æµ&lt;/strong&gt;ï¼ˆå¦‚ç”¨æˆ·ç‚¹å‡»æ—¥å¿—ã€åº”ç”¨ç¨‹åºè¾“å‡ºæ—¥å¿—ï¼‰ï¼Œæ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¸”ä½ åªå…³å¿ƒæœ€è¿‘ä¸€æ®µæ—¶é—´çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©æ—¥å¿—å‹ç¼©ç­–ç•¥ï¼Œå¦‚æœ&lt;/strong&gt;ï¼šä½ çš„æ•°æ®æ˜¯&lt;strong&gt;çŠ¶æ€æµ&lt;/strong&gt;ï¼ˆå¦‚æ•°æ®åº“çš„å˜æ›´è®°å½•ã€ç”¨æˆ·çš„é…ç½®ä¿¡æ¯ã€è®¾å¤‡çš„æœ€æ–°çŠ¶æ€ï¼‰ï¼Œæ¶ˆæ¯æœ‰é‡å¤çš„é”®ï¼Œä¸”ä½ å…³å¿ƒæ¯ä¸ªé”®çš„æœ€æ–°çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¦‚ä½•ä¼˜åŒ–å‹ç¼©æ€§èƒ½ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœç¡®å®šéœ€è¦ä½¿ç”¨å‹ç¼©ç­–ç•¥ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´ä»¥ä¸‹å‚æ•°æ¥å¹³è¡¡æ€§èƒ½å’Œæ•ˆæœï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;log.cleaner.threads&lt;/code&gt;&lt;/strong&gt;ï¼šå¢åŠ å‹ç¼©çº¿ç¨‹æ•°ï¼Œå¯ä»¥åŠ å¿«å‹ç¼©é€Ÿåº¦ï¼ˆå¦‚æœCPUèµ„æºå……è¶³ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;min.cleanable.dirty.ratio&lt;/code&gt;&lt;/strong&gt;ï¼šæé«˜è¿™ä¸ªæ¯”å€¼ï¼ˆé»˜è®¤0.5ï¼‰ï¼Œæ„å‘³ç€å…è®¸æ—¥å¿—ä¸­æœ‰æ›´å¤šâ€œè„æ•°æ®â€ï¼Œä»è€Œå‡å°‘å‹ç¼©è§¦å‘çš„é¢‘ç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;log.cleaner.dedupe.buffer.size&lt;/code&gt;&lt;/strong&gt;ï¼šå¢å¤§ç”¨äºæ„å»ºé”®å€¼æ˜ å°„çš„å†…å­˜ç¼“å†²åŒºå¤§å°ï¼Œå¯ä»¥æå‡å•æ¬¡å‹ç¼©èƒ½å¤„ç†çš„æ—¥å¿—é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œæ—¥å¿—åˆ é™¤ç­–ç•¥ä»¥å…¶&lt;strong&gt;ä½å¼€é”€ã€é«˜æ—¶æ•ˆ&lt;/strong&gt;çš„ç‰¹ç‚¹ï¼Œéå¸¸é€‚åˆå¤„ç†æµ·é‡ã€ä¸´æ—¶çš„æµå¼æ•°æ®ã€‚è€Œæ—¥å¿—å‹ç¼©ç­–ç•¥åˆ™é€šè¿‡&lt;strong&gt;ä»¥è®¡ç®—æ¢å­˜å‚¨&lt;/strong&gt;çš„æ–¹å¼ï¼Œä¸ºéœ€è¦ç»´æŠ¤ç²¾ç¡®æœ€æ–°çŠ¶æ€çš„åœºæ™¯æä¾›äº†å¼ºå¤§æ”¯æŒï¼Œä½†å…¶æ€§èƒ½ä»£ä»·ä¹Ÿæ›´é«˜ï¼Œéœ€è¦ä»”ç»†è°ƒä¼˜ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ ¹æ®ä¸šåŠ¡éœ€æ±‚åšå‡ºæœ€åˆé€‚çš„æŠ€æœ¯é€‰å‹ã€‚&lt;/p&gt;</description></item><item><title>ã€Kafkaã€‘Concepts</title><link>https://dyhes.github.io/p/kafkaconcepts/</link><pubDate>Sun, 29 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/kafkaconcepts/</guid><description>&lt;h2 id="æ¶æ„"&gt;æ¶æ„
&lt;/h2&gt;&lt;p&gt;Kafka æ˜¯ä¸€ç§é«˜ååã€åˆ†å¸ƒå¼ã€å¯æ‰©å±•çš„&lt;strong&gt;åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°&lt;/strong&gt;ï¼Œå…¶æ¶æ„è®¾è®¡æ ¸å¿ƒåœ¨äº&lt;strong&gt;æ°´å¹³æ‰©å±•æ€§ã€é«˜ååé‡å’Œå®¹é”™èƒ½åŠ›&lt;/strong&gt;ã€‚ä»¥ä¸‹ç»“åˆå…¶æ ¸å¿ƒç»„ä»¶ä¸å·¥ä½œæœºåˆ¶è¿›è¡Œç³»ç»Ÿä»‹ç»ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶æ„æ ¸å¿ƒç»„ä»¶"&gt;ğŸ“Œ æ¶æ„æ ¸å¿ƒç»„ä»¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Producerï¼ˆç”Ÿäº§è€…ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šåˆ›å»ºæ¶ˆæ¯å¹¶å‘å¸ƒåˆ° Kafka çš„ Topic ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®æœºåˆ¶&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒºç­–ç•¥&lt;/strong&gt;ï¼šæ”¯æŒè½®è¯¢ï¼ˆRound Robinï¼‰ã€å“ˆå¸Œï¼ˆKey Hashingï¼‰ã€ç²˜æ€§åˆ†åŒºï¼ˆSticky Partitioningï¼‰ç­‰ï¼Œç¡®ä¿æ¶ˆæ¯å‡åŒ€åˆ†å¸ƒæˆ–æŒ‰ä¸šåŠ¡é€»è¾‘è·¯ç”±åˆ°ç‰¹å®šåˆ†åŒº&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯é æ€§ä¿éšœ&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;acks&lt;/code&gt; å‚æ•°æ§åˆ¶ç¡®è®¤æœºåˆ¶ï¼ˆ&lt;code&gt;acks=0&lt;/code&gt; æ— ç¡®è®¤ï¼›&lt;code&gt;acks=1&lt;/code&gt; Leader ç¡®è®¤ï¼›&lt;code&gt;acks=all&lt;/code&gt; æ‰€æœ‰ ISR å‰¯æœ¬ç¡®è®¤ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰æ€§ä¸äº‹åŠ¡&lt;/strong&gt;ï¼š&lt;code&gt;enable.idempotence=true&lt;/code&gt; é¿å…é‡å¤æ¶ˆæ¯ï¼›äº‹åŠ¡ API å®ç°è·¨åˆ†åŒºåŸå­å†™å…¥&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;Brokerï¼ˆä»£ç†ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§’è‰²&lt;/strong&gt;ï¼šKafka é›†ç¾¤çš„æœåŠ¡å™¨èŠ‚ç‚¹ï¼Œè´Ÿè´£æ¶ˆæ¯å­˜å‚¨ã€è¯»å†™è¯·æ±‚å¤„ç†å’Œå‰¯æœ¬åŒæ­¥ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒèƒ½åŠ›ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒºç®¡ç†&lt;/strong&gt;ï¼šæ¯ä¸ª Broker å­˜å‚¨å¤šä¸ªåˆ†åŒºçš„æ•°æ®ï¼Œé€šè¿‡ &lt;strong&gt;Leader-Follower æœºåˆ¶&lt;/strong&gt;å®ç°è¯»å†™åˆ†ç¦»ï¼ˆLeader å¤„ç†è¯»å†™ï¼ŒFollower ä»…åŒæ­¥æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤åè°ƒ&lt;/strong&gt;ï¼šä¾èµ– &lt;strong&gt;Controller&lt;/strong&gt;ï¼ˆç‰¹æ®Š Brokerï¼‰é€‰ä¸¾åˆ†åŒº Leaderã€ç›‘æ§èŠ‚ç‚¹çŠ¶æ€ï¼ˆæ—§ç‰ˆç”¨ ZooKeeperï¼Œ2.8.0+ æ”¯æŒ KRaft æ¨¡å¼å» ZooKeeper åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Topicï¼ˆä¸»é¢˜ï¼‰ä¸ Partitionï¼ˆåˆ†åŒºï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Topic&lt;/strong&gt;ï¼šé€»è¾‘æ¶ˆæ¯åˆ†ç±»å•ä½ï¼ˆå¦‚æ—¥å¿—æµã€äº‹ä»¶æµï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Partition&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†åˆ†ç‰‡&lt;/strong&gt;ï¼šæ¯ä¸ª Topic åˆ’åˆ†ä¸ºå¤šä¸ª Partitionï¼Œå®ç°å¹¶è¡Œè¯»å†™å’Œæ°´å¹³æ‰©å±•ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ‰åºæ€§ä¿éšœ&lt;/strong&gt;ï¼š&lt;strong&gt;å•åˆ†åŒºå†…æ¶ˆæ¯ä¸¥æ ¼æœ‰åº&lt;/strong&gt;ï¼Œè·¨åˆ†åŒºé¡ºåºéœ€é€šè¿‡ç›¸åŒ Key è·¯ç”±åˆ°åŒä¸€åˆ†åŒº&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒºæ•°æƒè¡¡&lt;/strong&gt;ï¼šè¿‡å¤šåˆ†åŒºå¢åŠ ç®¡ç†å¼€é”€ï¼Œå»ºè®®å•ä¸ª Broker ç®¡ç† 1000â€“2000 ä¸ªåˆ†åŒº&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸ Consumer Groupï¼ˆæ¶ˆè´¹è€…ç»„ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Consumer&lt;/strong&gt;ï¼šä» Topic æ‹‰å–ï¼ˆPullï¼‰æ¶ˆæ¯è¿›è¡Œå¤„ç†ï¼Œ&lt;strong&gt;æ¶ˆè´¹ä½ç½®é€šè¿‡ Offset æ ‡è¯†&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Consumer Group&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šç»„å†…å¤šä¸ª Consumer ååŒæ¶ˆè´¹åŒä¸€ Topicï¼Œæ¯ä¸ª Partition ä»…ç”±ä¸€ä¸ª Consumer æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åç§»é‡ç®¡ç†&lt;/strong&gt;ï¼šæ”¯æŒè‡ªåŠ¨æäº¤ï¼ˆ&lt;code&gt;enable.auto.commit=true&lt;/code&gt;ï¼‰æˆ–æ‰‹åŠ¨æäº¤ï¼ˆ&lt;code&gt;commitSync()&lt;/code&gt;/&lt;code&gt;commitAsync()&lt;/code&gt;ï¼‰ï¼Œé¿å…é‡å¤æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†å¹³è¡¡ï¼ˆRebalanceï¼‰&lt;/strong&gt;ï¼šConsumer å¢å‡æ—¶è‡ªåŠ¨é‡æ–°åˆ†é…åˆ†åŒºï¼Œå¯èƒ½å¼•å‘çŸ­æš‚åœé¡¿&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®å­˜å‚¨ä¸å¤åˆ¶æœºåˆ¶"&gt;ğŸ’¾ æ•°æ®å­˜å‚¨ä¸å¤åˆ¶æœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‰¯æœ¬æœºåˆ¶ï¼ˆReplicationï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Leader-Follower æ¨¡å‹ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ª Partition æœ‰ 1 ä¸ª Leader å’Œå¤šä¸ª Followerï¼ˆç”± &lt;code&gt;replication.factor&lt;/code&gt; é…ç½®ï¼Œé€šå¸¸ä¸º 3ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§è€…å†™å…¥å’Œæ¶ˆè´¹è€…è¯»å–å‡é€šè¿‡ Leaderï¼ŒFollower å¼‚æ­¥/åŒæ­¥å¤åˆ¶æ•°æ®&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ISRï¼ˆIn-Sync Replicaï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸ Leader æ•°æ®åŒæ­¥çš„å‰¯æœ¬é›†åˆï¼ŒLeader é€‰ä¸¾ä»…ä» ISR ä¸­é€‰æ–° Leaderï¼ˆé€šè¿‡ &lt;code&gt;min.insync.replicas&lt;/code&gt; æ§åˆ¶æœ€å°åŒæ­¥å‰¯æœ¬æ•°ï¼‰&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºè¿½åŠ å†™å…¥&lt;/strong&gt;ï¼šæ¶ˆæ¯ä»¥ Append-Only æ—¥å¿—å½¢å¼å†™å…¥ç£ç›˜ï¼Œå……åˆ†åˆ©ç”¨ç£ç›˜é¡ºåº I/O æ€§èƒ½ï¼ˆæ¥è¿‘å†…å­˜é€Ÿåº¦ï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ®µæ—¥å¿—ï¼ˆSegment Logï¼‰&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ª Partition æ‹†åˆ†ä¸ºå¤šä¸ª Segment æ–‡ä»¶ï¼ˆé»˜è®¤ 1GBï¼‰ï¼Œé€šè¿‡ç¨€ç–ç´¢å¼•å¿«é€Ÿå®šä½æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æ¸…ç†&lt;/strong&gt;ï¼šæ”¯æŒåŸºäºæ—¶é—´æˆ–å¤§å°çš„ä¿ç•™ç­–ç•¥ï¼ˆå¦‚ä¿ç•™ 7 å¤©æˆ– 1TB æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜ååé‡è®¾è®¡åŸç†"&gt;âš¡ é«˜ååé‡è®¾è®¡åŸç†
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é›¶æ‹·è´ï¼ˆZero-Copyï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…è¯»å–æ—¶ï¼ŒBroker ä½¿ç”¨ &lt;code&gt;sendfile()&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨å°†ç£ç›˜æ•°æ®ç›´æ¥å‘é€åˆ°ç½‘å¡ï¼Œé¿å…å†…æ ¸æ€ä¸ç”¨æˆ·æ€æ•°æ®å¤åˆ¶ï¼Œé™ä½ CPU å¼€é”€&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡å¤„ç†ä¸å‹ç¼©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§è€…æ‰¹é‡å‘é€æ¶ˆæ¯ï¼ˆ&lt;code&gt;batch.size&lt;/code&gt; æ§åˆ¶ï¼‰ï¼Œæ”¯æŒ Gzip/Snappy/LZ4 å‹ç¼©å‡å°‘ç½‘ç»œä¼ è¾“é‡&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µç¼“å­˜ï¼ˆPage Cacheï¼‰ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Broker åˆ©ç”¨æ“ä½œç³»ç»Ÿé¡µç¼“å­˜å­˜å‚¨çƒ­ç‚¹æ•°æ®ï¼Œå‡å°‘ç£ç›˜ I/O æ¬¡æ•°&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜å¯ç”¨æ€§ä¿éšœæœºåˆ¶"&gt;ğŸ›¡ï¸ é«˜å¯ç”¨æ€§ä¿éšœæœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™ä¸æ•…éšœæ¢å¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Leader é€‰ä¸¾&lt;/strong&gt;ï¼šController ç›‘æ§ Broker çŠ¶æ€ï¼ŒLeader æ•…éšœæ—¶ä» ISR é€‰ä¸¾æ–° Leaderï¼ˆè‹¥ ISR ä¸ºç©ºï¼Œå¯é€šè¿‡ &lt;code&gt;unclean.leader.election.enable&lt;/code&gt; å…è®¸é ISR å‰¯æœ¬å½“é€‰ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æŒä¹…åŒ–&lt;/strong&gt;ï¼šæ¶ˆæ¯å†™å…¥ååŒæ­¥åˆ°å¤šä¸ªå‰¯æœ¬ï¼Œé˜²æ­¢å•ç‚¹æ•…éšœ&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼åè°ƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;KRaft æ¨¡å¼&lt;/strong&gt;ï¼š2.8.0+ ç‰ˆæœ¬ä½¿ç”¨ Raft åè®®ç®¡ç†å…ƒæ•°æ®ï¼Œæ›¿ä»£ ZooKeeperï¼Œç®€åŒ–éƒ¨ç½²å¹¶æå‡ç¨³å®šæ€§&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶ˆæ¯ä¼ é€’è¯­ä¹‰"&gt;âœ‰ï¸ æ¶ˆæ¯ä¼ é€’è¯­ä¹‰
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è¯­ä¹‰ç±»å‹&lt;/th&gt;
&lt;th&gt;å®ç°æœºåˆ¶&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;At Most Once&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿäº§è€…è®¾ç½® &lt;code&gt;acks=0&lt;/code&gt;ï¼Œä¸é‡è¯•ï¼Œå¯èƒ½ä¸¢æ¶ˆæ¯ã€‚&lt;/td&gt;
&lt;td&gt;å¯å®¹å¿ä¸¢å¤±çš„ç›‘æ§æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;At Least Once&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿäº§è€…é‡è¯• + æ¶ˆè´¹è€…æ‰‹åŠ¨æäº¤åç§»é‡ï¼Œå¯èƒ½é‡å¤æ¶ˆè´¹ã€‚&lt;/td&gt;
&lt;td&gt;éœ€ä¿è¯ä¸ä¸¢ä½†å¯é‡å¤å¤„ç†çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Exactly Once&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿäº§è€…å¹‚ç­‰æ€§ + äº‹åŠ¡ API + æ¶ˆè´¹è€… &lt;code&gt;isolation.level=read_committed&lt;/code&gt;&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;é‡‘èäº¤æ˜“ç­‰ç²¾ç¡®ä¸€æ¬¡å¤„ç†éœ€æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰©å±•ä¸è¿ç»´"&gt;ğŸ” æ‰©å±•ä¸è¿ç»´
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ°´å¹³æ‰©å±•&lt;/strong&gt;ï¼šé€šè¿‡å¢åŠ  Broker å’Œåˆ†åŒºæ•°æå‡ååé‡ï¼ˆåˆ†åŒºæ•°éœ€ä¸æ¶ˆè´¹è€…æ•°é‡åŒ¹é…ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯ç§¯å‹å¤„ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å¢åŠ æ¶ˆè´¹è€…å®ä¾‹æ•°ï¼ˆä¸è¶…è¿‡åˆ†åŒºæ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–æ¶ˆè´¹è€…é€»è¾‘ï¼ˆå¦‚æ‰¹é‡å¤„ç†ã€å¼‚æ­¥åŒ–ï¼‰æˆ–è°ƒæ•´å‚æ•°ï¼ˆå¦‚å¢å¤§ &lt;code&gt;max.poll.records&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Kafka çš„æ¶æ„æ ¸å¿ƒåœ¨äº&lt;strong&gt;åˆ†å¸ƒå¼åˆ†åŒºå­˜å‚¨ã€å¤šå‰¯æœ¬å†—ä½™ã€é«˜æ•ˆ I/O ä¼˜åŒ–&lt;/strong&gt;ä¸‰è€…ç»“åˆï¼Œå®ç°äº†é«˜ååã€ä½å»¶è¿Ÿä¸é«˜å¯é ã€‚å…¶è®¾è®¡æƒè¡¡äº†é¡ºåºæ€§ä¸å¹¶è¡Œæ€§ï¼ˆå•åˆ†åŒºæœ‰åº vs. å¤šåˆ†åŒºå¹¶å‘ï¼‰ï¼Œå¹¶é€šè¿‡çµæ´»çš„é…ç½®ï¼ˆå¦‚ &lt;code&gt;acks&lt;/code&gt;ã€&lt;code&gt;isolation.level&lt;/code&gt;ï¼‰é€‚åº”ä¸åŒä¸šåŠ¡åœºæ™¯çš„å¯é æ€§éœ€æ±‚ã€‚KRaft æ¨¡å¼çš„å¼•å…¥è¿›ä¸€æ­¥ç®€åŒ–äº†æ¶æ„ï¼Œæ ‡å¿—ç€ Kafka å‘æ›´è½»é‡åŒ–ã€è‡ªæ²»åŒ–æ¼”è¿›&lt;a class="link" href="@ref" &gt;1,2,5&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="segment-log"&gt;Segment Log
&lt;/h2&gt;&lt;p&gt;Segment Logï¼ˆåˆ†æ®µæ—¥å¿—ï¼‰æ˜¯Kafkaå®ç°é«˜æ€§èƒ½ã€å¯æ‰©å±•å­˜å‚¨çš„æ ¸å¿ƒè®¾è®¡ï¼Œé€šè¿‡å°†åˆ†åŒºæ•°æ®æ‹†åˆ†ä¸ºå¤šä¸ªç‰©ç†æ®µï¼ˆSegmentï¼‰æ–‡ä»¶ï¼Œè§£å†³äº†å•ä¸€å¤§æ–‡ä»¶çš„ç®¡ç†éš¾é¢˜ã€‚ä»¥ä¸‹ä»äº”ä¸ªç»´åº¦æ·±å…¥è§£æå…¶å·¥ä½œæœºåˆ¶ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç‰©ç†å­˜å‚¨ç»“æ„"&gt;ğŸ“ &lt;strong&gt;ç‰©ç†å­˜å‚¨ç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ¯ä¸ªåˆ†åŒºå¯¹åº”ä¸€ä¸ªç£ç›˜ç›®å½•ï¼ˆå¦‚&lt;code&gt;test-topic-0&lt;/code&gt;ï¼‰ï¼Œå†…éƒ¨åŒ…å«å¤šç»„Segmentæ–‡ä»¶ï¼Œæ¯ç»„ç”±å››ä¸ªæ–‡ä»¶æ„æˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;.log&lt;/code&gt;&lt;/strong&gt;ï¼šå­˜å‚¨æ¶ˆæ¯æœ¬ä½“ï¼ˆKey/Valueï¼‰ï¼ŒæŒ‰åç§»é‡é¡ºåºè¿½åŠ å†™å…¥&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;.index&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;strong&gt;ç¨€ç–ä½ç§»ç´¢å¼•&lt;/strong&gt;ï¼Œè®°å½•é€»è¾‘åç§»é‡åˆ°&lt;code&gt;.log&lt;/code&gt;æ–‡ä»¶ç‰©ç†ä½ç½®çš„æ˜ å°„ï¼ˆæ¯ç§¯ç´¯&lt;code&gt;log.index.interval.bytes&lt;/code&gt;å­—èŠ‚å»ºä¸€æ¡ç´¢å¼•ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;.timeindex&lt;/code&gt;&lt;/strong&gt;ï¼šæ—¶é—´æˆ³ç´¢å¼•ï¼Œç”¨äºæŒ‰æ—¶é—´èŒƒå›´å¿«é€Ÿå®šä½æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;leader-epoch-checkpoint&lt;/code&gt;&lt;/strong&gt;ï¼šLeaderä»»æœŸä¿¡æ¯ï¼Œä¿éšœå‰¯æœ¬ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚
&lt;strong&gt;æ–‡ä»¶å‘½åè§„åˆ™&lt;/strong&gt;ï¼šä»¥å½“å‰Segmentçš„&lt;strong&gt;èµ·å§‹åç§»é‡&lt;/strong&gt;ï¼ˆ20ä½æ•°å­—è¡¥é›¶ï¼‰å‘½åï¼Œå¦‚&lt;code&gt;00000000000000170410.log&lt;/code&gt;&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-segmentæ»šåŠ¨rolloveræœºåˆ¶"&gt;â±ï¸ &lt;strong&gt;Segmentæ»šåŠ¨ï¼ˆRolloverï¼‰æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å½“æ»¡è¶³ä»»ä¸€æ¡ä»¶æ—¶ï¼ŒKafkaä¼šåˆ›å»ºæ–°Segmentï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤§å°è§¦å‘&lt;/strong&gt;ï¼šå½“å‰Segmentè¾¾åˆ°&lt;code&gt;log.segment.bytes&lt;/code&gt;ï¼ˆé»˜è®¤1GBï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´è§¦å‘&lt;/strong&gt;ï¼šè·ç¦»ä¸Šæ¬¡æ»šåŠ¨è¶…è¿‡&lt;code&gt;log.segment.ms&lt;/code&gt;ï¼ˆé»˜è®¤7å¤©ï¼‰&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•æ–‡ä»¶æ»¡&lt;/strong&gt;ï¼šç´¢å¼•æ¡ç›®è¶…è¿‡&lt;code&gt;log.index.size.max.bytes&lt;/code&gt;é™åˆ¶&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸»åŠ¨è§¦å‘&lt;/strong&gt;ï¼šé€šè¿‡Kafka APIæ‰‹åŠ¨åˆ‡åˆ†&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚
&lt;strong&gt;ä¼˜åŒ–è®¾è®¡&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;log.roll.jitter.ms&lt;/code&gt;æ·»åŠ éšæœºå»¶è¿Ÿï¼Œé¿å…é›†ç¾¤å†…å¤§é‡SegmentåŒæ—¶æ»šåŠ¨å¯¼è‡´I/Oçªå¢&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶ˆæ¯å®šä½ä¸è¯»å–ä¼˜åŒ–"&gt;ğŸ” &lt;strong&gt;æ¶ˆæ¯å®šä½ä¸è¯»å–ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é€šè¿‡&lt;strong&gt;äºŒçº§æŸ¥æ‰¾&lt;/strong&gt;å¿«é€Ÿå®šä½æ¶ˆæ¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®šä½Segmentæ–‡ä»¶&lt;/strong&gt;ï¼š
æ ¹æ®ç›®æ ‡OffsetäºŒåˆ†æŸ¥æ‰¾æ–‡ä»¶åï¼ˆå¦‚Offset=170418 â†’ æ–‡ä»¶&lt;code&gt;00000000000000170410.log&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•åŠ é€Ÿç‰©ç†å®šä½&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åœ¨&lt;code&gt;.index&lt;/code&gt;ä¸­æŸ¥æ‰¾&lt;strong&gt;å°äºç›®æ ‡Offsetçš„æœ€å¤§æ¡ç›®&lt;/strong&gt;ï¼ˆå¦‚Offset=170418 â†’ ç´¢å¼•æ¡ç›®&lt;code&gt;[8,1325]&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»&lt;code&gt;.log&lt;/code&gt;æ–‡ä»¶çš„1325ä½ç½®é¡ºåºæ‰«æï¼Œç›´è‡³æ‰¾åˆ°ç›®æ ‡æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚
&lt;strong&gt;ç¨€ç–ç´¢å¼•ä¼˜åŠ¿&lt;/strong&gt;ï¼šå¤§å¹…å‡å°‘ç´¢å¼•ä½“ç§¯ï¼ˆä»…è®°å½•éƒ¨åˆ†æ¶ˆæ¯ä½ç½®ï¼‰ï¼Œå†…å­˜åŠ è½½æ•ˆç‡æ›´é«˜&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®æ¸…ç†ç­–ç•¥"&gt;ğŸ§¹ &lt;strong&gt;æ•°æ®æ¸…ç†ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä»¥&lt;strong&gt;æ•´ä¸ªSegment&lt;/strong&gt;ä¸ºå•ä½æ‰§è¡Œæ¸…ç†ï¼Œå½“å‰æ´»è·ƒSegmentï¼ˆActive Segmentï¼‰ä¸å¤„ç†&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ é™¤ç­–ç•¥ï¼ˆ&lt;code&gt;delete&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼š
è¶…ä¿ç•™æ—¶é—´ï¼ˆ&lt;code&gt;log.retention.hours&lt;/code&gt;ï¼‰æˆ–å¤§å°ï¼ˆ&lt;code&gt;log.retention.bytes&lt;/code&gt;ï¼‰çš„æ—§Segmentç›´æ¥åˆ é™¤&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‹ç¼©ç­–ç•¥ï¼ˆ&lt;code&gt;compact&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼š
ä¿ç•™&lt;strong&gt;ç›¸åŒKeyçš„æœ€æ–°Value&lt;/strong&gt;ï¼Œç”¨äºKVå­˜å‚¨åœºæ™¯ï¼ˆå¦‚æ•°æ®åº“å˜æ›´æ—¥å¿—ï¼‰&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ æ¸…ç†æ“ä½œç”±åå°çº¿ç¨‹å‘¨æœŸæ€§æ‰§è¡Œï¼Œä¸å½±å“ç”Ÿäº§è€…å†™å…¥æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†æ®µè®¾è®¡çš„æ ¸å¿ƒä»·å€¼"&gt;âš™ï¸ &lt;strong&gt;åˆ†æ®µè®¾è®¡çš„æ ¸å¿ƒä»·å€¼&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ€§èƒ½å†™å…¥&lt;/strong&gt;ï¼š
ä»…è¿½åŠ åˆ°æ´»è·ƒSegmentï¼Œâ€‹&lt;strong&gt;é¡ºåºI/O&lt;/strong&gt;æ•ˆç‡æ¥è¿‘å†…å­˜å†™å…¥&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«é€Ÿæ•…éšœæ¢å¤&lt;/strong&gt;ï¼š
é‡å¯æ—¶åªéœ€æ¢å¤æ´»è·ƒSegmentï¼Œæ— éœ€åŠ è½½å…¨é‡æ•°æ®&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œæ“ä½œèƒ½åŠ›&lt;/strong&gt;ï¼š
ä¸åŒSegmentå¯ç‹¬ç«‹æ‰§è¡Œæ¸…ç†ã€å‹ç¼©ã€å‰¯æœ¬åŒæ­¥&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»æ‰©å±•æ€§&lt;/strong&gt;ï¼š
åˆ†åŒºå®¹é‡éšSegmentæ•°é‡æ°´å¹³æ‰©å±•ï¼Œçªç ´å•æœºç£ç›˜é™åˆ¶&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“åˆ†å¸ƒå¼ç³»ç»Ÿçš„é€šç”¨èŒƒå¼"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„é€šç”¨èŒƒå¼&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Segment Logä¸ä»…æ˜¯Kafkaçš„å­˜å‚¨åŸºçŸ³ï¼Œæ›´æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„é€šç”¨è®¾è®¡æ¨¡å¼ï¼ˆå¦‚&lt;strong&gt;Etcdçš„WALåˆ†æ®µ&lt;/strong&gt;ã€&lt;strong&gt;MySQL Binlogæ»šåŠ¨&lt;/strong&gt;ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡&lt;strong&gt;åˆ†æ²»ç­–ç•¥&lt;/strong&gt;å°†æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†ç²’åº¦ä»æ–‡ä»¶çº§é™è‡³æ®µçº§ï¼Œåœ¨ä¿éšœé¡ºåºæ€§çš„åŒæ—¶ï¼Œå®ç°äº†å­˜å‚¨æ•ˆç‡ã€è¿ç»´çµæ´»æ€§å’Œç³»ç»Ÿå¼¹æ€§çš„ä¸‰é‡æå‡ã€‚&lt;/p&gt;
&lt;h2 id="partition-offset"&gt;PARTITION offset
&lt;/h2&gt;&lt;p&gt;åœ¨ Kafka ä¸­ï¼Œ&lt;strong&gt;offset æ˜¯ PARTITION çº§åˆ«çš„&lt;/strong&gt;ï¼Œè€Œé Topic çº§åˆ«çš„ã€‚ä»¥ä¸‹æ˜¯å…³é”®åŸå› å’Œè¯¦ç»†è§£é‡Šï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-offset-çš„æœ¬è´¨ä¸ä½œç”¨"&gt;ğŸ“Œ offset çš„æœ¬è´¨ä¸ä½œç”¨
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒºå†…çš„å”¯ä¸€æ ‡è¯†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;offset æ˜¯ Kafka ä¸º &lt;strong&gt;Partition ä¸­çš„æ¯æ¡æ¶ˆæ¯&lt;/strong&gt;åˆ†é…çš„å”¯ä¸€åºå·ï¼Œä» 0 å¼€å§‹å•è°ƒé€’å¢ã€‚æ¯ä¸ª Partition ç‹¬ç«‹ç»´æŠ¤è‡ªå·±çš„ offset åºåˆ—ï¼Œäº’ä¸å½±å“&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚ï¼šä¸€ä¸ª Topic æœ‰ 3 ä¸ª Partitionï¼ŒPartition 0 çš„ offset èŒƒå›´å¯èƒ½æ˜¯ &lt;code&gt;0~1000&lt;/code&gt;ï¼ŒPartition 1 å¯èƒ½æ˜¯ &lt;code&gt;0~800&lt;/code&gt;ï¼ŒPartition 2 å¯èƒ½æ˜¯ &lt;code&gt;0~1200&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯å®šä½&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…é€šè¿‡æŒ‡å®š Partition + offset ç²¾ç¡®è¯»å–ç‰¹å®šæ¶ˆæ¯&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è¿›åº¦è®°å½•&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…æäº¤ offset åˆ° Kafkaï¼ˆå­˜å‚¨äº &lt;code&gt;__consumer_offsets&lt;/code&gt; Topicï¼‰ï¼Œè¡¨ç¤ºæŸä¸ª Partition çš„æ¶ˆè´¹è¿›åº¦&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ºä»€ä¹ˆ-offset-å±äº-partition-çº§åˆ«"&gt;ğŸ§© ä¸ºä»€ä¹ˆ offset å±äº Partition çº§åˆ«ï¼Ÿ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Partition æ˜¯ç‰©ç†å­˜å‚¨å•å…ƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Topic æ˜¯é€»è¾‘æ¦‚å¿µï¼Œè€Œ Partition æ˜¯å®é™…å­˜å‚¨æ¶ˆæ¯çš„ç‰©ç†åˆ†ç‰‡ã€‚æ¯ä¸ª Partition å¯¹åº”ä¸€ä¸ª&lt;strong&gt;ç‹¬ç«‹çš„æ—¥å¿—æ–‡ä»¶ï¼ˆSegment Logï¼‰&lt;/strong&gt;ï¼Œoffset æ ‡è¯†æ¶ˆæ¯åœ¨æ–‡ä»¶å†…çš„ä½ç½®&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸åŒ Partition çš„æ—¥å¿—æ–‡ä»¶å®Œå…¨éš”ç¦»ï¼Œå› æ­¤ offset æ— æ³•è·¨ Partition ç»Ÿä¸€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰åºæ€§ä¿è¯çš„è¾¹ç•Œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Kafka ä»…ä¿è¯ &lt;strong&gt;Partition å†…çš„æ¶ˆæ¯æœ‰åºæ€§&lt;/strong&gt;ï¼ˆé€šè¿‡ offset é¡ºåºï¼‰ï¼Œè€Œè·¨ Partition çš„æ¶ˆæ¯æ˜¯æ— åºçš„&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ offset æ˜¯ Topic çº§åˆ«ï¼Œåˆ™æ— æ³•å®ç°åˆ†åŒºå†…æœ‰åºæ€§ä¿éšœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œæ¶ˆè´¹çš„åŸºç¡€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…ç»„ï¼ˆConsumer Groupï¼‰ä¸­ï¼Œ&lt;strong&gt;æ¯ä¸ª Partition ä»…ç”±ä¸€ä¸ªæ¶ˆè´¹è€…å®ä¾‹æ¶ˆè´¹&lt;/strong&gt;ã€‚æ¯ä¸ªæ¶ˆè´¹è€…ç‹¬ç«‹ç»´æŠ¤å…¶è´Ÿè´£ Partition çš„ offsetï¼Œå®ç°è´Ÿè½½å‡è¡¡&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-offset-å­˜å‚¨ä¸ç®¡ç†çš„å®è·µ"&gt;ğŸ’¾ offset å­˜å‚¨ä¸ç®¡ç†çš„å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…æäº¤çš„ offset å­˜å‚¨åœ¨ Kafka å†…ç½® Topic &lt;code&gt;__consumer_offsets&lt;/code&gt; ä¸­ï¼Œå…¶ Key ä¸ºä¸‰å…ƒç»„ï¼š
&lt;code&gt;(Consumer Group ID, Topic, Partition) â†’ offset&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚
ğŸ‘‰ æ˜ç¡®ä½“ç°äº† offset ä¸ Partition çš„ç»‘å®šå…³ç³»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡ç½® offset çš„æ“ä½œç²’åº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…å¯é€šè¿‡ seek() æ–¹æ³•ä¿®æ”¹æŒ‡å®š Partition çš„ offsetï¼Œå¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;consumer.seek(new TopicPartition(&amp;#34;topic-A&amp;#34;, 0), 100); // å°† Partition 0 çš„ offset è®¾ä¸º 100
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å‚æ•° &lt;code&gt;auto.offset.reset&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;earliest&lt;/code&gt;/&lt;code&gt;latest&lt;/code&gt;ï¼‰ä¹Ÿæ˜¯æŒ‰ Partition ç”Ÿæ•ˆ&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-topic-ä¸-partition-çº§åˆ«çš„å¯¹æ¯”"&gt;âš–ï¸ Topic ä¸ Partition çº§åˆ«çš„å¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Topic çº§åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Partition çº§åˆ«&lt;/strong&gt;ï¼ˆå®é™…è®¾è®¡ï¼‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶ˆæ¯é¡ºåºæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¨å±€æœ‰åºï¼ˆéš¾ä»¥å®ç°ï¼‰&lt;/td&gt;
&lt;td&gt;ä»…åˆ†åŒºå†…æœ‰åº&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶è¡Œæ¶ˆè´¹èƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å—é™ï¼ˆå•æ¶ˆè´¹è€…ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå¤šæ¶ˆè´¹è€…å¹¶è¡Œå¤„ç†ä¸åŒ Partitionï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;offset å«ä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¨å±€å”¯ä¸€æ ‡è¯†ï¼ˆä¸å¯è¡Œï¼‰&lt;/td&gt;
&lt;td&gt;åˆ†åŒºå†…å”¯ä¸€æ ‡è¯†&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•…éšœæ¢å¤ç²’åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç²—ç²’åº¦&lt;/td&gt;
&lt;td&gt;ç»†ç²’åº¦ï¼ˆæŒ‰åˆ†åŒºæ¢å¤è¿›åº¦ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;offset æ˜¯ Partition çº§åˆ«çš„æ¦‚å¿µ&lt;/strong&gt;ï¼Œè¿™æ˜¯ Kafka å®ç°é«˜ååã€å¹¶è¡Œæ¶ˆè´¹å’Œåˆ†åŒºæœ‰åºæ€§çš„åŸºçŸ³&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Topic ä½œä¸ºé€»è¾‘åˆ†ç±»ï¼Œå…¶æ¶ˆæ¯çš„æ¶ˆè´¹è¿›åº¦å®é™…ç”±å¤šä¸ª Partition çš„ offset å…±åŒæ„æˆã€‚&lt;/li&gt;
&lt;li&gt;å¼€å‘æ—¶éœ€æ³¨æ„ï¼š&lt;strong&gt;æ“ä½œ offset å¿…é¡»æŒ‡å®š Partition&lt;/strong&gt;ï¼ˆå¦‚é‡ç½®æ¶ˆè´¹ä½ç½®ã€ç›‘æ§æ»åé‡ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="isr"&gt;ISR
&lt;/h2&gt;&lt;p&gt;Kafkaçš„ISRï¼ˆIn-Sync Replicasï¼‰æœºåˆ¶æ˜¯å…¶å®ç°&lt;strong&gt;é«˜å¯é æ€§å’Œé«˜å¯ç”¨æ€§&lt;/strong&gt;çš„æ ¸å¿ƒè®¾è®¡ï¼Œé€šè¿‡åŠ¨æ€ç»´æŠ¤ä¸Leaderå‰¯æœ¬åŒæ­¥çš„å‰¯æœ¬é›†åˆï¼Œå¹³è¡¡æ•°æ®ä¸€è‡´æ€§ä¸ç³»ç»Ÿæ€§èƒ½ã€‚ä»¥ä¸‹ä»æœºåˆ¶åŸç†ã€å…³é”®ç»„ä»¶ã€å·¥ä½œæµç¨‹åŠå®è·µè°ƒä¼˜è§’åº¦å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-isrçš„æ ¸å¿ƒæ¦‚å¿µ"&gt;ğŸ“Œ ISRçš„æ ¸å¿ƒæ¦‚å¿µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å®šä¹‰ä¸ç»„æˆ
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ISRå®šä¹‰&lt;/strong&gt;ï¼šISRæ˜¯åˆ†åŒºï¼ˆPartitionï¼‰ä¸­ä¸Leaderå‰¯æœ¬&lt;strong&gt;æ•°æ®å®Œå…¨åŒæ­¥çš„å‰¯æœ¬é›†åˆ&lt;/strong&gt;ï¼ˆåŒ…æ‹¬Leaderè‡ªèº«ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‰¯æœ¬åˆ†ç±»&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Leaderå‰¯æœ¬&lt;/strong&gt;ï¼šå¤„ç†è¯»å†™è¯·æ±‚ï¼Œè´Ÿè´£ç»´æŠ¤ISRåˆ—è¡¨&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Followerå‰¯æœ¬&lt;/strong&gt;ï¼šä»Leaderæ‹‰å–æ•°æ®ï¼ŒåŒæ­¥è¿›åº¦æ»¡è¶³æ¡ä»¶æ—¶åŠ å…¥ISR&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;OSRï¼ˆOut-of-Sync Replicasï¼‰&lt;/strong&gt;ï¼šæ»åäºLeaderçš„å‰¯æœ¬ï¼Œè¢«ç§»å‡ºISRçš„é›†åˆ&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³ç³»å…¬å¼&lt;/strong&gt;ï¼š&lt;code&gt;ARï¼ˆAssigned Replicasï¼‰= ISR + OSR&lt;/code&gt;&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-isrçš„å·¥ä½œæœºåˆ¶"&gt;âš™ï¸ ISRçš„å·¥ä½œæœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ç»´æŠ¤è§„åˆ™&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ å…¥æ¡ä»¶&lt;/strong&gt;ï¼šFollowerå‰¯æœ¬çš„&lt;strong&gt;LEOï¼ˆLog End Offsetï¼‰&lt;/strong&gt; ä¸Leaderçš„LEOå·®è·åœ¨é˜ˆå€¼å†…ï¼ˆé€šè¿‡å¿ƒè·³ä¸æ‹‰å–è¯·æ±‚æ£€æµ‹ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‰”é™¤æ¡ä»¶&lt;/strong&gt;ï¼šè‹¥Followeråœ¨&lt;code&gt;replica.lag.time.max.ms&lt;/code&gt;ï¼ˆé»˜è®¤10ç§’ï¼‰å†…æœªè¿½ä¸ŠLeaderï¼Œåˆ™ç§»å‡ºISR&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨æ¢å¤&lt;/strong&gt;ï¼šæ»åå‰¯æœ¬è¿½ä¸ŠLeaderè¿›åº¦åï¼Œ&lt;strong&gt;é‡æ–°åŠ å…¥ISR&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸HWï¼ˆHigh Watermarkï¼‰çš„ååŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HWå®šä¹‰&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…å¯è§çš„æœ€å¤§åç§»é‡ï¼Œå–å€¼ä¸º&lt;strong&gt;ISRä¸­æ‰€æœ‰å‰¯æœ¬LEOçš„æœ€å°å€¼&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LEOå®šä¹‰&lt;/strong&gt;ï¼šå‰¯æœ¬æœ€æ–°æ¶ˆæ¯çš„ä½ç½®&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æäº¤é€»è¾‘&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯å†™å…¥Leaderåï¼Œéœ€åŒæ­¥è‡³ISRæ‰€æœ‰å‰¯æœ¬æ‰æ›´æ–°HW&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…ä»…èƒ½æ¶ˆè´¹HWä¹‹å‰çš„æ¶ˆæ¯ï¼ˆå·²æäº¤æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœæ¢å¤æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Leaderæ•…éšœ&lt;/strong&gt;ï¼šControllerä»ISRä¸­é€‰ä¸¾æ–°Leaderï¼ˆè‹¥ISRä¸ºç©ºä¸”&lt;code&gt;unclean.leader.election.enable=true&lt;/code&gt;ï¼Œåˆ™å…è®¸ä»OSRé€‰ä¸¾ï¼Œä½†å¯èƒ½ä¸¢æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Followeræ•…éšœ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ¢å¤åæˆªæ–­æœ¬åœ°æ—¥å¿—è‡³HWä½ç½®ï¼Œä»æ–°LeaderåŒæ­¥æ•°æ®&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¿½ä¸Šè¿›åº¦åé‡æ–°åŠ å…¥ISR&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-isrä¸ç”Ÿäº§è€…åä½œackæœºåˆ¶"&gt;ğŸ”§ ISRä¸ç”Ÿäº§è€…åä½œï¼ˆACKæœºåˆ¶ï¼‰
&lt;/h3&gt;&lt;p&gt;ç”Ÿäº§è€…é€šè¿‡&lt;code&gt;acks&lt;/code&gt;å‚æ•°æ§åˆ¶æ¶ˆæ¯çš„å¯é æ€§çº§åˆ«ï¼Œ&lt;strong&gt;ç›´æ¥ä¾èµ–ISRçŠ¶æ€&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ACKçº§åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;acks=0&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ç­‰å¾…ç¡®è®¤ï¼Œå‘é€å³æˆåŠŸ&lt;/td&gt;
&lt;td&gt;æœ€ä½ï¼ˆå¯èƒ½ä¸¢æ¶ˆæ¯ï¼‰&lt;/td&gt;
&lt;td&gt;æœ€é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;acks=1&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Leaderå†™å…¥æœ¬åœ°æ—¥å¿—å³æˆåŠŸ&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰ï¼ˆLeaderæ•…éšœå¯èƒ½ä¸¢æ•°æ®ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;acks=all&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€ISRæ‰€æœ‰å‰¯æœ¬ç¡®è®¤ï¼ˆè‹¥ISRå‰¯æœ¬æ•°ä¸è¶³&lt;code&gt;min.insync.replicas&lt;/code&gt;ï¼Œç”Ÿäº§è€…æŠ›å‡ºå¼‚å¸¸ï¼‰&lt;/td&gt;
&lt;td&gt;æœ€é«˜&lt;/td&gt;
&lt;td&gt;æœ€ä½&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;å…³é”®å‚æ•°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;min.insync.replicas&lt;/code&gt;ï¼šISRæœ€å°å­˜æ´»å‰¯æœ¬æ•°ï¼ˆä¾‹å¦‚è®¾ä¸º2æ—¶ï¼Œè‹¥ISRå‰¯æœ¬æ•°&amp;lt;2ï¼Œç”Ÿäº§è€…å†™å…¥ä¼šå¤±è´¥ï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;replica.lag.time.max.ms&lt;/code&gt;ï¼šFolloweræœ€å¤§å…è®¸æ»åæ—¶é—´ï¼ˆé»˜è®¤10ç§’ï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-isrå¼‚å¸¸åœºæ™¯ä¸å¤„ç†"&gt;âš ï¸ ISRå¼‚å¸¸åœºæ™¯ä¸å¤„ç†
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¸¸è§é—®é¢˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ISRé¢‘ç¹ä¼¸ç¼©&lt;/strong&gt;ï¼šç½‘ç»œå»¶è¿Ÿæˆ–å‰¯æœ¬è´Ÿè½½è¿‡é«˜å¯¼è‡´Followeré¢‘ç¹è¿›å‡ºISRï¼Œè§¦å‘&lt;code&gt;IsrShrinksPerSec&lt;/code&gt;å‘Šè­¦&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ISRä¸ºç©ºï¼ˆIsr: 0ï¼‰&lt;/strong&gt;ï¼šæ‰€æœ‰å‰¯æœ¬å‡æœªåŒæ­¥ï¼Œåˆ†åŒºä¸å¯å†™ï¼ˆå¸¸è§äºBrokerå®•æœºæˆ–ç½‘ç»œåˆ†åŒºï¼‰&lt;a class="link" href="@ref" &gt;8,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å‚æ•°è°ƒä¼˜ï¼š
&lt;ul&gt;
&lt;li&gt;å¢åŠ &lt;code&gt;num.replica.fetchers&lt;/code&gt;ï¼ˆå‰¯æœ¬æ‹‰å–çº¿ç¨‹æ•°ï¼‰æå‡åŒæ­¥æ•ˆç‡&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒæ•´&lt;code&gt;replica.lag.time.max.ms&lt;/code&gt;é€‚åº”ç½‘ç»œæ³¢åŠ¨&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¿ç»´æ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;é‡å¯æ»åå‰¯æœ¬æˆ–æ‰§è¡Œå‰¯æœ¬é‡åˆ†é…ï¼ˆ&lt;code&gt;kafka-reassign-partitions.sh&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æ§&lt;code&gt;UnderReplicatedPartitions&lt;/code&gt;æŒ‡æ ‡ï¼ŒåŠæ—¶å¤„ç†å¼‚å¸¸&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-isæœºåˆ¶çš„ä»·å€¼ä¸å±€é™"&gt;ğŸ’ ISæœºåˆ¶çš„ä»·å€¼ä¸å±€é™
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯é æ€§&lt;/strong&gt;ï¼šé€šè¿‡å¤šå‰¯æœ¬å†—ä½™+ISRåŠ¨æ€é€‰ä¸¾ï¼Œé¿å…å•ç‚¹æ•…éšœå¯¼è‡´æ•°æ®ä¸¢å¤±&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»æƒè¡¡&lt;/strong&gt;ï¼šç”¨æˆ·å¯é€šè¿‡&lt;code&gt;acks&lt;/code&gt;å’Œ&lt;code&gt;min.insync.replicas&lt;/code&gt;è‡ªå®šä¹‰å¯é æ€§ä¸ååé‡çš„å¹³è¡¡ç‚¹&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥å»¶è¿Ÿ&lt;/strong&gt;ï¼š&lt;code&gt;acks=all&lt;/code&gt;éœ€ç­‰å¾…æ‰€æœ‰ISRå‰¯æœ¬ç¡®è®¤ï¼Œå¢åŠ å†™å…¥å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ç”¨æ€§é£é™©&lt;/strong&gt;ï¼šè‹¥ISRå‰¯æœ¬æ•°ä¸è¶³&lt;code&gt;min.insync.replicas&lt;/code&gt;ï¼Œåˆ†åŒºæ‹’ç»å†™å…¥ï¼ˆç‰ºç‰²å¯ç”¨æ€§ä¿ä¸€è‡´æ€§ï¼‰&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿäº§å®è·µå»ºè®®"&gt;ğŸ” ç”Ÿäº§å®è·µå»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æ¨è&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‰¯æœ¬æ•°&lt;/strong&gt;ï¼š&lt;code&gt;ReplicationFactor â‰¥ 3&lt;/code&gt;ï¼Œåˆ†æ•£è‡³ä¸åŒæœºæ¶&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€å°ISR&lt;/strong&gt;ï¼š&lt;code&gt;min.insync.replicas=2&lt;/code&gt;ï¼ˆç¡®ä¿Leaderæ•…éšœæ—¶æœ‰å¤‡ç”¨å‰¯æœ¬ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§æŒ‡æ ‡&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;kafka.server:type=ReplicaManager,name=IsrShrinksPerSec&lt;/code&gt;ï¼ˆISRå˜åŠ¨é¢‘ç‡ï¼‰&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;UnderReplicatedPartitions&lt;/code&gt;ï¼ˆæœªå……åˆ†å¤åˆ¶åˆ†åŒºæ•°ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœæ’æŸ¥æ­¥éª¤&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph TD
A[ISRå¼‚å¸¸] --&amp;gt; B[æ£€æŸ¥Brokerè¿›ç¨‹ä¸ç«¯å£]
B --&amp;gt; C[åˆ†æKafkaæ—¥å¿— server.log]
C --&amp;gt; D[éªŒè¯ZooKeeperçŠ¶æ€]
D --&amp;gt; E[æ‰‹åŠ¨è§¦å‘Leaderé€‰ä¸¾]
E --&amp;gt; F[å‰¯æœ¬é‡åˆ†é…]
&lt;/code&gt;&lt;/pre&gt;è¯¦è§å‘½ä»¤ç¤ºä¾‹&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Kafkaçš„ISRæœºåˆ¶é€šè¿‡&lt;strong&gt;åŠ¨æ€åŒæ­¥å‰¯æœ¬é›†åˆ+HW/LEOååŒ&lt;/strong&gt;ï¼Œåœ¨ä¿éšœæ•°æ®ä¸€è‡´æ€§çš„åŒæ—¶æ”¯æŒæ•…éšœè‡ªåŠ¨è½¬ç§»ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºå…è®¸ç”¨æˆ·é€šè¿‡å‚æ•°ï¼ˆå¦‚&lt;code&gt;acks&lt;/code&gt;ã€&lt;code&gt;min.insync.replicas&lt;/code&gt;ï¼‰&lt;strong&gt;çµæ´»æƒè¡¡å¯é æ€§ä¸æ€§èƒ½&lt;/strong&gt;ï¼Œä½†éœ€è­¦æƒ•åŒæ­¥å»¶è¿Ÿå’ŒISRæ”¶ç¼©é£é™©ã€‚ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç»“åˆç›‘æ§ä¸åˆç†é…ç½®ï¼ˆå¦‚å‰¯æœ¬æ•°â‰¥3ã€æœ€å°ISRâ‰¥2ï¼‰ï¼Œå¯æœ€å¤§åŒ–å‘æŒ¥å…¶é«˜å¯ç”¨ä¼˜åŠ¿&lt;a class="link" href="@ref" &gt;2,6,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="é€‰ä¸¾"&gt;é€‰ä¸¾
&lt;/h2&gt;&lt;p&gt;Kafka ä¸­çš„ &lt;strong&gt;Broker Leader é€‰ä¸¾&lt;/strong&gt;ï¼ˆé€šå¸¸æŒ‡åˆ†åŒº Leader é€‰ä¸¾ï¼‰æ˜¯ä¿éšœé›†ç¾¤é«˜å¯ç”¨çš„æ ¸å¿ƒæœºåˆ¶ï¼Œåˆ†ä¸º &lt;strong&gt;Controller é€‰ä¸¾&lt;/strong&gt;å’Œ&lt;strong&gt;åˆ†åŒº Leader é€‰ä¸¾&lt;/strong&gt;ä¸¤ä¸ªå±‚çº§ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æµç¨‹åŠå…³é”®æœºåˆ¶ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-controller-é€‰ä¸¾é›†ç¾¤ç®¡ç†èŠ‚ç‚¹"&gt;âš™ï¸ Controller é€‰ä¸¾ï¼ˆé›†ç¾¤ç®¡ç†èŠ‚ç‚¹ï¼‰
&lt;/h3&gt;&lt;p&gt;Controller æ˜¯ Kafka é›†ç¾¤çš„â€œå¤§è„‘â€ï¼Œè´Ÿè´£ç®¡ç†åˆ†åŒºçŠ¶æ€å’Œè§¦å‘ Leader é€‰ä¸¾ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€‰ä¸¾è§¦å‘æ¡ä»¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é›†ç¾¤å¯åŠ¨æ—¶&lt;/li&gt;
&lt;li&gt;å½“å‰ Controller æ•…éšœï¼ˆå¦‚ Broker å®•æœºã€ç½‘ç»œæ–­å¼€ï¼‰&lt;/li&gt;
&lt;li&gt;Controller ä¸»åŠ¨æ”¾å¼ƒèŒè´£ï¼ˆå¦‚ä¼˜é›…ä¸‹çº¿ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ä¸¾æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç«äº‰ Zookeeper ä¸´æ—¶èŠ‚ç‚¹&lt;/strong&gt;ï¼šæ‰€æœ‰ Broker å°è¯•åˆ›å»º Zookeeper çš„ &lt;code&gt;/controller&lt;/code&gt; ä¸´æ—¶èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å”¯ä¸€æ€§ä¿è¯&lt;/strong&gt;ï¼šZookeeper ç¡®ä¿ä»…æœ‰ä¸€ä¸ª Broker åˆ›å»ºæˆåŠŸï¼Œè¯¥ Broker æˆä¸º Controller&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ƒæ•°æ®åŒæ­¥&lt;/strong&gt;ï¼šæ–° Controller ä» Zookeeper åŠ è½½é›†ç¾¤å…ƒæ•°æ®ï¼Œå¹¶å¹¿æ’­ç»™æ‰€æœ‰ Broker&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜²è„‘è£‚æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;strong&gt;&lt;code&gt;controller_epoch&lt;/code&gt;&lt;/strong&gt;ï¼ˆå•è°ƒé€’å¢ç‰ˆæœ¬å·ï¼‰æ ‡è¯† Controller æœ‰æ•ˆæ€§ï¼Œæ—§ Controller çš„è¯·æ±‚å› ç‰ˆæœ¬å·è¿‡ä½ä¼šè¢«æ‹’ç»&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†åŒº-leader-é€‰ä¸¾æ•°æ®å‰¯æœ¬ç®¡ç†"&gt;ğŸ” åˆ†åŒº Leader é€‰ä¸¾ï¼ˆæ•°æ®å‰¯æœ¬ç®¡ç†ï¼‰
&lt;/h3&gt;&lt;p&gt;å½“åˆ†åŒº Leader å‰¯æœ¬æ•…éšœæ—¶ï¼ŒController è´Ÿè´£é€‰ä¸¾æ–° Leaderï¼š&lt;/p&gt;
&lt;h4 id="è§¦å‘æ¡ä»¶"&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Leader å‰¯æœ¬æ‰€åœ¨ Broker å®•æœºï¼ˆå¿ƒè·³è¶…æ—¶ï¼‰&lt;/li&gt;
&lt;li&gt;Leader å‰¯æœ¬åŒæ­¥å¼‚å¸¸ï¼ˆå¦‚ç£ç›˜æ•…éšœï¼‰&lt;/li&gt;
&lt;li&gt;åˆ†åŒºæ‰©å®¹æˆ–æ‰‹åŠ¨é‡æ–°åˆ†é…å‰¯æœ¬&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é€‰ä¸¾è§„åˆ™"&gt;&lt;strong&gt;é€‰ä¸¾è§„åˆ™&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆä» ISR é€‰ä¸¾&lt;/strong&gt;
Controller ä» â€‹&lt;strong&gt;ISRï¼ˆIn-Sync Replicasï¼‰â€‹&lt;/strong&gt;â€‹ åˆ—è¡¨ä¸­é€‰æ‹©ç¬¬ä¸€ä¸ªå‰¯æœ¬ä½œä¸ºæ–° Leaderï¼ˆå¦‚ ISR = [1, 2, 3]ï¼Œåˆ™é€‰æ‹© Broker 1ï¼‰&lt;a class="link" href="@ref" &gt;2,5,7&lt;/a&gt;ã€‚
â€‹&lt;strong&gt;ä¸ºä»€ä¹ˆæ˜¯ç¬¬ä¸€ä¸ªï¼Ÿâ€‹&lt;/strong&gt;â€‹ å†å²è®¾è®¡é€‰æ‹©ï¼Œé€šå¸¸è®¤ä¸º ISR ä¸­é å‰çš„å‰¯æœ¬åŒæ­¥çŠ¶æ€æ›´ä½³ï¼ˆä½†å®é™…éœ€ç»“åˆåŒæ­¥è¿›åº¦åˆ¤æ–­ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ISR ä¸ºç©ºæ—¶çš„é™çº§å¤„ç†&lt;/strong&gt;
è‹¥ &lt;code&gt;unclean.leader.election.enable=true&lt;/code&gt;ï¼Œå…è®¸ä» â€‹&lt;strong&gt;OSRï¼ˆOut-of-Sync Replicasï¼‰â€‹&lt;/strong&gt;â€‹ ä¸­é€‰ä¸¾ï¼Œä½†å¯èƒ½&lt;strong&gt;ä¸¢å¤±æ•°æ®&lt;/strong&gt;â€‹ï¼ˆå›  OSR å‰¯æœ¬æ»åï¼‰ï¼›è‹¥ä¸º &lt;code&gt;false&lt;/code&gt;ï¼Œåˆ™åˆ†åŒºä¸å¯ç”¨ï¼ˆç‰ºç‰²å¯ç”¨æ€§ä¿ä¸€è‡´æ€§ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®ä¸€è‡´æ€§ä¿éšœ"&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§ä¿éšœ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HWï¼ˆHigh Watermarkï¼‰æœºåˆ¶&lt;/strong&gt;ï¼š
æ–° Leader ä¸Šä»»åï¼Œæ‰€æœ‰å‰¯æœ¬éœ€æˆªæ–­æ—¥å¿—è‡³ â€‹&lt;strong&gt;HW ä½ç½®&lt;/strong&gt;â€‹ï¼ˆå·²æäº¤æ¶ˆæ¯çš„åç§»é‡ï¼‰ï¼Œä¸¢å¼ƒæœªæäº¤çš„æ•°æ®ï¼Œç¡®ä¿å„å‰¯æœ¬æ•°æ®ä¸€è‡´&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LEOï¼ˆLog End Offsetï¼‰&lt;/strong&gt;ï¼šæ ‡è¯†å‰¯æœ¬æœ€æ–°æ¶ˆæ¯ä½ç½®ï¼Œé€‰ä¸¾åéœ€åŸºäº HW å¯¹é½&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®è®¾è®¡isr-åŠ¨æ€ç»´æŠ¤"&gt;ğŸ›¡ï¸ å…³é”®è®¾è®¡ï¼šISR åŠ¨æ€ç»´æŠ¤
&lt;/h3&gt;&lt;p&gt;åˆ†åŒº Leader é€‰ä¸¾ä¾èµ– ISR çš„æœ‰æ•ˆæ€§ï¼Œå…¶ç»´æŠ¤æœºåˆ¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡†å…¥æ¡ä»¶&lt;/strong&gt;ï¼šFollower å‰¯æœ¬çš„ &lt;strong&gt;LEO ä¸ Leader çš„å·®å€¼&lt;/strong&gt;ä¸è¶…è¿‡ &lt;code&gt;replica.lag.time.max.ms&lt;/code&gt;ï¼ˆé»˜è®¤ 10 ç§’ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®šæœŸæ£€æŸ¥&lt;/strong&gt;ï¼šLeader æ¯ç§’æ£€æµ‹ Follower çŠ¶æ€ï¼Œæ»åå‰¯æœ¬ç§»å‡º ISR è‡³ OSRï¼›åŒæ­¥æ¢å¤åé‡æ–°åŠ å…¥&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ISR ä¼¸ç¼©&lt;/strong&gt;ï¼šé€šè¿‡åå°çº¿ç¨‹ &lt;code&gt;isr-expiration&lt;/code&gt; å’Œ &lt;code&gt;isr-change-propagation&lt;/code&gt; ç®¡ç†ï¼Œé¿å…é¢‘ç¹å˜æ›´&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ•…éšœåœºæ™¯ä¸åº”å¯¹"&gt;âš ï¸ æ•…éšœåœºæ™¯ä¸åº”å¯¹
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¤„ç†ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é£é™©&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Leader æ•…éšœï¼ˆISR éç©ºï¼‰&lt;/td&gt;
&lt;td&gt;ä» ISR é€‰ä¸¾æ–° Leaderï¼Œæ›´æ–°å…ƒæ•°æ®å¹¶åŒæ­¥é›†ç¾¤&lt;/td&gt;
&lt;td&gt;æ— æ•°æ®ä¸¢å¤±&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ISR å…¨éƒ¨æ•…éšœ&lt;/td&gt;
&lt;td&gt;è‹¥å¯ç”¨ &lt;code&gt;unclean.leader.election.enable=true&lt;/code&gt;ï¼Œä» OSR é€‰ä¸¾ï¼›å¦åˆ™åˆ†åŒºä¸å¯ç”¨&lt;/td&gt;
&lt;td&gt;å¯èƒ½ä¸¢å¤±æœªæäº¤æ•°æ®æˆ–æœåŠ¡ä¸­æ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Controller æ•…éšœ&lt;/td&gt;
&lt;td&gt;30 ç§’å†…è‡ªåŠ¨é€‰ä¸¾æ–° Controllerï¼ˆä¾èµ– Zookeeper Session è¶…æ—¶ï¼‰&lt;/td&gt;
&lt;td&gt;çŸ­æš‚å…ƒæ•°æ®æ“ä½œä¸å¯ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿäº§å®è·µå»ºè®®-1"&gt;âš¡ï¸ ç”Ÿäº§å®è·µå»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‰¯æœ¬æ•°&lt;/strong&gt;ï¼š&lt;code&gt;replication.factor â‰¥ 3&lt;/code&gt;ï¼Œåˆ†æ•£è‡³ä¸åŒæœºæ¶&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€å° ISR&lt;/strong&gt;ï¼š&lt;code&gt;min.insync.replicas=2&lt;/code&gt;ï¼Œç¡®ä¿ Leader æ•…éšœæ—¶æœ‰å¤‡ç”¨å‰¯æœ¬&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¦ç”¨éå®‰å…¨é€‰ä¸¾&lt;/strong&gt;ï¼š&lt;code&gt;unclean.leader.election.enable=false&lt;/code&gt;ï¼ˆé‡‘èç­‰å¼ºä¸€è‡´æ€§åœºæ™¯ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§ä¸è¿ç»´&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŒ‡æ ‡ç›‘æ§&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;&lt;code&gt;UnderReplicatedPartitions&lt;/code&gt;ï¼ˆæœªå……åˆ†å¤åˆ¶åˆ†åŒºæ•°ï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;OfflinePartitionsCount&lt;/code&gt;ï¼ˆæ—  Leader çš„åˆ†åŒºæ•°ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‰¯æœ¬é‡åˆ†é…&lt;/strong&gt;ï¼šèŠ‚ç‚¹æ•…éšœæ¢å¤åï¼Œç”¨ &lt;code&gt;kafka-reassign-partitions.sh&lt;/code&gt; é‡æ–°å‡è¡¡å‰¯æœ¬&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡æ‹Ÿæµ‹è¯•&lt;/strong&gt;ï¼šåœ¨æµ‹è¯•ç¯å¢ƒæ³¨å…¥æ•…éšœï¼ˆå¦‚ Kill Broker è¿›ç¨‹ï¼‰ï¼ŒéªŒè¯é€‰ä¸¾ç­–ç•¥&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Kafka çš„ Leader é€‰ä¸¾é€šè¿‡ &lt;strong&gt;Controller åè°ƒ&lt;/strong&gt; + &lt;strong&gt;ISR ä¼˜å…ˆé€‰ä¸¾&lt;/strong&gt; + &lt;strong&gt;HW ä¸€è‡´æ€§ä¿éšœ&lt;/strong&gt;ï¼Œåœ¨å®•æœºæ—¶å¿«é€Ÿæ¢å¤æœåŠ¡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Controller é€‰ä¸¾&lt;/strong&gt;ï¼šåŸºäº Zookeeper ä¸´æ—¶èŠ‚ç‚¹ç«äº‰ï¼Œç¡®ä¿å”¯ä¸€ç®¡ç†èŠ‚ç‚¹ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒº Leader é€‰ä¸¾&lt;/strong&gt;ï¼šä¼˜å…ˆé€‰æ‹© ISR å‰¯æœ¬ï¼Œé€šè¿‡ HW æˆªæ–­å®ç°æ•°æ®å¼ºä¸€è‡´ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™è®¾è®¡&lt;/strong&gt;ï¼šISR åŠ¨æ€ç»´æŠ¤ä¸é™çº§ç­–ç•¥å¹³è¡¡å¯ç”¨æ€§ä¸ä¸€è‡´æ€§ã€‚
ç”Ÿäº§ç¯å¢ƒä¸­éœ€ç»“åˆç›‘æ§ã€åˆç†å‰¯æœ¬åˆ†å¸ƒåŠå‚æ•°è°ƒä¼˜ï¼ˆå¦‚ç¦ç”¨ &lt;code&gt;unclean&lt;/code&gt; é€‰ä¸¾ï¼‰ï¼Œæœ€å¤§åŒ–é™ä½æ•…éšœå½±å“&lt;a class="link" href="@ref" &gt;1,4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="raft"&gt;RAFT
&lt;/h2&gt;&lt;p&gt;RAFTåè®®æ˜¯ä¸€ç§åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ï¼Œæ—¨åœ¨é€šè¿‡&lt;strong&gt;é¢†å¯¼è€…é€‰ä¸¾&lt;/strong&gt;å’Œ&lt;strong&gt;æ—¥å¿—å¤åˆ¶&lt;/strong&gt;æœºåˆ¶ï¼Œè§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­èŠ‚ç‚¹é—´çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒåŸç†ä¸å·¥ä½œæµç¨‹çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="æ ¸å¿ƒè§’è‰²ä¸çŠ¶æ€"&gt;æ ¸å¿ƒè§’è‰²ä¸çŠ¶æ€
&lt;/h3&gt;&lt;p&gt;RAFTåè®®å®šä¹‰äº†ä¸‰ç§èŠ‚ç‚¹è§’è‰²ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¢†å¯¼è€…ï¼ˆLeaderï¼‰
&lt;ul&gt;
&lt;li&gt;å”¯ä¸€å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„èŠ‚ç‚¹ï¼Œè´Ÿè´£æ—¥å¿—å¤åˆ¶ä¸å¿ƒè·³ç»´æŠ¤&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡å‘¨æœŸæ€§å‘é€å¿ƒè·³ï¼ˆ&lt;code&gt;AppendEntries RPC&lt;/code&gt;ï¼‰ç»´æŒæƒå¨ï¼Œé˜²æ­¢å…¶ä»–èŠ‚ç‚¹å‘èµ·é€‰ä¸¾&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è·Ÿéšè€…ï¼ˆFollowerï¼‰
&lt;ul&gt;
&lt;li&gt;è¢«åŠ¨æ¥æ”¶é¢†å¯¼è€…çš„æ—¥å¿—å’Œå¿ƒè·³ï¼Œä»…åœ¨é€‰ä¸¾è¶…æ—¶æœªæ”¶åˆ°å¿ƒè·³æ—¶è½¬ä¸ºå€™é€‰è€…&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å€™é€‰è€…ï¼ˆCandidateï¼‰
&lt;ul&gt;
&lt;li&gt;é€‰ä¸¾è¿‡ç¨‹ä¸­çš„ä¸´æ—¶çŠ¶æ€ï¼Œå‘èµ·æŠ•ç¥¨è¯·æ±‚ï¼ˆ&lt;code&gt;RequestVote RPC&lt;/code&gt;ï¼‰ç«é€‰é¢†å¯¼è€…&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚
&lt;strong&gt;ä»»æœŸï¼ˆTermï¼‰&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªä»»æœŸæ˜¯ä¸€ä¸ªè¿ç»­é€’å¢çš„ç¼–å·ï¼Œç”¨äºæ ‡è¯†é€‰ä¸¾è½®æ¬¡ã€‚æ–°é€‰ä¸¾å¼€å§‹æ—¶ä»»æœŸ+1ï¼Œç¡®ä¿æ—§é¢†å¯¼è€…å¤±æ•ˆåèƒ½è¢«è¯†åˆ«&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="é¢†å¯¼é€‰ä¸¾æœºåˆ¶"&gt;é¢†å¯¼é€‰ä¸¾æœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è§¦å‘æ¡ä»¶
&lt;ul&gt;
&lt;li&gt;è·Ÿéšè€…åœ¨&lt;strong&gt;é€‰ä¸¾è¶…æ—¶æ—¶é—´&lt;/strong&gt;ï¼ˆé€šå¸¸150-300msï¼ŒéšæœºåŒ–é¿å…å†²çªï¼‰å†…æœªæ”¶åˆ°å¿ƒè·³ï¼Œåˆ™è½¬ä¸ºå€™é€‰è€…å¹¶å‘èµ·é€‰ä¸¾&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æŠ•ç¥¨è§„åˆ™
&lt;ul&gt;
&lt;li&gt;å€™é€‰è€…éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ‰èƒ½è·å¾—æŠ•ç¥¨ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å…¶æ—¥å¿—æ¯”æŠ•ç¥¨è€…æ›´æ–°ï¼ˆé€šè¿‡æ¯”è¾ƒæœ€åä¸€æ¡æ—¥å¿—çš„Termå’ŒIndexï¼‰&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªèŠ‚ç‚¹åœ¨åŒä¸€ä»»æœŸå†…ä»…èƒ½æŠ•ä¸€ç¥¨ï¼ˆå…ˆåˆ°å…ˆå¾—ï¼‰&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;é€‰ä¸¾ç»“æœ
&lt;ul&gt;
&lt;li&gt;è·å¾—&lt;strong&gt;å¤šæ•°æ´¾æŠ•ç¥¨&lt;/strong&gt;çš„å€™é€‰è€…æˆä¸ºé¢†å¯¼è€…ï¼Œç«‹å³å‘é€å¿ƒè·³ç¡®ç«‹æƒå¨&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥é€‰ä¸¾è¶…æ—¶æœªæœï¼Œå€™é€‰è€…ç­‰å¾…éšæœºæ—¶é—´åé‡æ–°å‘èµ·é€‰ä¸¾&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚
&lt;strong&gt;å®‰å…¨æ€§ä¿è¯&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;é€šè¿‡æ—¥å¿—å®Œæ•´æ€§æ¯”è¾ƒï¼Œç¡®ä¿æ–°é¢†å¯¼è€…åŒ…å«æ‰€æœ‰å·²æäº¤çš„æ—¥å¿—ï¼Œé¿å…æ•°æ®ä¸¢å¤±&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="æ—¥å¿—å¤åˆ¶æµç¨‹"&gt;æ—¥å¿—å¤åˆ¶æµç¨‹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ—¥å¿—ç»“æ„
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªæ—¥å¿—æ¡ç›®åŒ…å«ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ï¼ˆIndexï¼‰&lt;/strong&gt;ï¼šå”¯ä¸€æ ‡è¯†æ—¥å¿—ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»æœŸï¼ˆTermï¼‰&lt;/strong&gt;ï¼šåˆ›å»ºè¯¥æ¡ç›®çš„é¢†å¯¼è€…ä»»æœŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒ‡ä»¤ï¼ˆCommandï¼‰&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯è¯·æ±‚çš„æ“ä½œ&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤åˆ¶è¿‡ç¨‹
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤1&lt;/strong&gt;ï¼šé¢†å¯¼è€…æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œè¿½åŠ åˆ°æœ¬åœ°æ—¥å¿—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤2&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;AppendEntries RPC&lt;/code&gt;å°†æ—¥å¿—å¹¿æ’­ç»™è·Ÿéšè€…ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤3&lt;/strong&gt;ï¼šå½“å¤šæ•°èŠ‚ç‚¹å¤åˆ¶æˆåŠŸåï¼Œé¢†å¯¼è€…æäº¤æ—¥å¿—å¹¶åº”ç”¨åˆ°çŠ¶æ€æœºï¼Œé€šçŸ¥è·Ÿéšè€…æäº¤&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;ä¸€è‡´æ€§ä¿è¯
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—åŒ¹é…å±æ€§&lt;/strong&gt;ï¼šç›¸åŒç´¢å¼•å’Œä»»æœŸçš„æ—¥å¿—å†…å®¹å¿…é¡»ä¸€è‡´ï¼Œå¦åˆ™è·Ÿéšè€…ä¼šæ‹’ç»å¹¶å›æ»šä¸ä¸€è‡´çš„æ—¥å¿—&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚
&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥é¢†å¯¼è€…å´©æºƒï¼Œæ–°é¢†å¯¼è€…é€šè¿‡å¼ºåˆ¶è¦†ç›–ä¸ä¸€è‡´æ—¥å¿—ç¡®ä¿æœ€ç»ˆä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="å®‰å…¨æ€§æœºåˆ¶"&gt;å®‰å…¨æ€§æœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é€‰ä¸¾é™åˆ¶
&lt;ul&gt;
&lt;li&gt;å€™é€‰è€…çš„æ—¥å¿—å¿…é¡»æ¯”å¤šæ•°èŠ‚ç‚¹æ›´æ–°ï¼Œé˜²æ­¢æ—§æ•°æ®è¢«é€‰ä¸¾ä¸ºé¢†å¯¼è€…&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æäº¤è§„åˆ™
&lt;ul&gt;
&lt;li&gt;ä»…å½“å‰ä»»æœŸçš„æ—¥å¿—è¢«å¤šæ•°å¤åˆ¶åæ‰èƒ½æäº¤ï¼Œé¿å…â€œå¹½çµå¤ç°â€ï¼ˆæ—§æ—¥å¿—è¢«æ„å¤–æäº¤ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æˆå‘˜å˜æ›´
&lt;ul&gt;
&lt;li&gt;é‡‡ç”¨&lt;strong&gt;å•èŠ‚ç‚¹å˜æ›´&lt;/strong&gt;ç­–ç•¥ï¼Œæ¯æ¬¡ä»…å¢åˆ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé¿å…ç½‘ç»œåˆ†åŒºå¯¼è‡´åŒä¸»é—®é¢˜&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="åº”ç”¨åœºæ™¯ä¸ä¼˜åŠ¿"&gt;åº”ç”¨åœºæ™¯ä¸ä¼˜åŠ¿
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é€‚ç”¨åœºæ™¯
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆå¦‚Etcdã€CockroachDBï¼‰ã€æœåŠ¡å‘ç°ï¼ˆConsulï¼‰ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafka KRaftæ¨¡å¼ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ˜“äºå®ç°&lt;/strong&gt;ï¼šç›¸æ¯”Paxosï¼Œè§’è‰²å’Œæµç¨‹æ›´æ¸…æ™°&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼ºä¸€è‡´æ€§&lt;/strong&gt;ï¼šé€šè¿‡æ—¥å¿—å¤åˆ¶å’Œé€‰ä¸¾é™åˆ¶ä¿è¯æ•°æ®ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨æ€§&lt;/strong&gt;ï¼šæ”¯æŒèŠ‚ç‚¹æ•…éšœæ¢å¤å’Œç½‘ç»œåˆ†åŒºå®¹é”™&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="ä¸paxosçš„å¯¹æ¯”"&gt;ä¸Paxosçš„å¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RAFT&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Paxos&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç†è§£éš¾åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•ï¼Œè§’è‰²æ˜ç¡®&lt;/td&gt;
&lt;td&gt;å¤æ‚ï¼Œç†è®ºæ€§å¼º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆæ ‡å‡†å®ç°å¦‚braftï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆéœ€å®šåˆ¶åŒ–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰ï¼ˆä¾èµ–å¿ƒè·³å’Œæ—¥å¿—å¤åˆ¶å»¶è¿Ÿï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆä½†ä¼˜åŒ–éš¾åº¦å¤§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šç”¨ï¼ˆå¦‚æ•°æ®åº“ã€å­˜å‚¨ç³»ç»Ÿï¼‰&lt;/td&gt;
&lt;td&gt;ç‰¹å®šåœºæ™¯ï¼ˆå¦‚Chubbyï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;RAFTé€šè¿‡&lt;strong&gt;å¼ºé¢†å¯¼æ¨¡å‹&lt;/strong&gt;å’Œ&lt;strong&gt;æ¨¡å—åŒ–è®¾è®¡&lt;/strong&gt;ï¼Œæˆä¸ºå·¥ç¨‹å®è·µä¸­å¹¿æ³›é‡‡ç”¨çš„å…±è¯†ç®—æ³•&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“"&gt;æ€»ç»“
&lt;/h3&gt;&lt;p&gt;RAFTåè®®é€šè¿‡&lt;strong&gt;è§’è‰²åˆ’åˆ†&lt;/strong&gt;ã€&lt;strong&gt;ä»»æœŸæœºåˆ¶&lt;/strong&gt;å’Œ&lt;strong&gt;æ—¥å¿—å¤åˆ¶&lt;/strong&gt;ï¼Œå®ç°äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼ºä¸€è‡´æ€§ä¸é«˜å¯ç”¨æ€§ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œä¸€åˆ‡ä»¥é¢†å¯¼è€…ä¸ºå‡†â€ï¼Œç®€åŒ–äº†å¤æ‚åœºæ™¯ä¸‹çš„å…±è¯†é—®é¢˜ï¼Œæˆä¸ºç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆå¦‚Kafka KRaftæ¨¡å¼ï¼‰çš„åŸºçŸ³&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="kraft"&gt;Kraft
&lt;/h2&gt;&lt;p&gt;Kafka çš„ &lt;strong&gt;KRaftï¼ˆKafka Raftï¼‰æ¨¡å¼&lt;/strong&gt; æ˜¯ Apache Kafka è‡ª 2.8 ç‰ˆæœ¬å¼•å…¥çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ—¨åœ¨é€šè¿‡ç§»é™¤å¯¹ ZooKeeper çš„ä¾èµ–ï¼Œç®€åŒ–é›†ç¾¤æ¶æ„å¹¶æå‡æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯ KRaft æ¨¡å¼çš„è¯¦ç»†ä»‹ç»ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="kraft-æ¨¡å¼çš„æ ¸å¿ƒæ¦‚å¿µ"&gt;&lt;strong&gt;KRaft æ¨¡å¼çš„æ ¸å¿ƒæ¦‚å¿µ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;KRaft æ¨¡å¼æ˜¯ Kafka å†…ç½®çš„åˆ†å¸ƒå¼å…±è¯†åè®®ï¼ŒåŸºäº &lt;strong&gt;Raft ç®—æ³•&lt;/strong&gt; å®ç°é›†ç¾¤å…ƒæ•°æ®ï¼ˆå¦‚ä¸»é¢˜ã€åˆ†åŒºã€å‰¯æœ¬çŠ¶æ€ç­‰ï¼‰çš„è‡ªä¸»ç®¡ç†ã€‚å®ƒæ›¿ä»£äº†ä¼ ç»Ÿçš„ ZooKeeper æ¨¡å¼ï¼Œä½¿ Kafka é›†ç¾¤æ— éœ€å¤–éƒ¨åè°ƒæœåŠ¡å³å¯è¿è¡Œ&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id="æ ¸å¿ƒç›®æ ‡"&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–æ¶æ„&lt;/strong&gt;ï¼šæ¶ˆé™¤å¯¹ ZooKeeper çš„ä¾èµ–ï¼Œå‡å°‘è¿ç»´å¤æ‚åº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æå‡æ‰©å±•æ€§&lt;/strong&gt;ï¼šæ”¯æŒç™¾ä¸‡çº§åˆ†åŒºï¼ˆè¿œè¶… ZooKeeper çš„æ•°ä¸‡é™åˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢å¼ºå¯é æ€§&lt;/strong&gt;ï¼šæ§åˆ¶å™¨æ•…éšœæ¢å¤æ—¶é—´ç¼©çŸ­è‡³æ¯«ç§’çº§ï¼Œå…ƒæ•°æ®å˜æ›´é€šè¿‡ Raft åè®®ä¿è¯å¼ºä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="kraft-æ¨¡å¼çš„æ¶æ„ä¸å·¥ä½œåŸç†"&gt;&lt;strong&gt;KRaft æ¨¡å¼çš„æ¶æ„ä¸å·¥ä½œåŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç»„ä»¶"&gt;&lt;strong&gt;æ ¸å¿ƒç»„ä»¶&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶å™¨èŠ‚ç‚¹ï¼ˆController Nodesï¼‰&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è´Ÿè´£ç®¡ç†é›†ç¾¤å…ƒæ•°æ®ï¼ˆå¦‚ä¸»é¢˜ã€åˆ†åŒºåˆ†é…ã€å‰¯æœ¬çŠ¶æ€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ Raft åè®®é€‰ä¸¾äº§ç”Ÿ &lt;strong&gt;ä¸»æ§åˆ¶å™¨ï¼ˆActive Controllerï¼‰&lt;/strong&gt;ï¼Œå…¶ä½™ä¸ºå¤‡ç”¨ï¼ˆStandbyï¼‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…ƒæ•°æ®å­˜å‚¨åœ¨ Kafka å†…éƒ¨çš„ &lt;code&gt;__cluster_metadata&lt;/code&gt; ä¸»é¢˜ä¸­ï¼Œæ”¯æŒæ—¥å¿—å‹ç¼©å’Œå¿«ç…§&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Broker èŠ‚ç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è´Ÿè´£æ¶ˆæ¯çš„å­˜å‚¨å’Œè¯»å†™ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡å¿ƒè·³æœºåˆ¶ä¸æ§åˆ¶å™¨ä¿æŒé€šä¿¡ï¼Œä¸»åŠ¨æ‹‰å–å…ƒæ•°æ®æ›´æ–°&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="raft-åè®®çš„å…³é”®æœºåˆ¶"&gt;&lt;strong&gt;Raft åè®®çš„å…³é”®æœºåˆ¶&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Leader é€‰ä¸¾&lt;/strong&gt;ï¼šæ§åˆ¶å™¨èŠ‚ç‚¹é€šè¿‡ Raft åè®®é€‰ä¸¾ Leaderï¼Œç¡®ä¿å…ƒæ•°æ®çš„ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—å¤åˆ¶&lt;/strong&gt;ï¼šå…ƒæ•°æ®å˜æ›´é€šè¿‡ Raft æ—¥å¿—å¤åˆ¶åˆ°æ‰€æœ‰æ§åˆ¶å™¨èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«ç…§æœºåˆ¶&lt;/strong&gt;ï¼šå®šæœŸç”Ÿæˆå…ƒæ•°æ®å¿«ç…§ï¼Œé¿å…æ—¥å¿—æ— é™å¢é•¿ï¼ŒåŠ é€Ÿæ•…éšœæ¢å¤&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="kraft-æ¨¡å¼çš„ä¼˜åŠ¿"&gt;&lt;strong&gt;KRaft æ¨¡å¼çš„ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç®€åŒ–éƒ¨ç½²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— éœ€å•ç‹¬éƒ¨ç½² ZooKeeperï¼Œé™ä½è¿ç»´æˆæœ¬&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…ƒæ•°æ®å­˜å‚¨æœ¬åœ°åŒ–ï¼Œå‡å°‘è·¨ç³»ç»Ÿé€šä¿¡å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¯ç”¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Raft åè®®çš„å¤šæ•°æ´¾é€‰ä¸¾æœºåˆ¶ï¼Œç¡®ä¿é›†ç¾¤åœ¨éƒ¨åˆ†èŠ‚ç‚¹æ•…éšœæ—¶ä»èƒ½è¿è¡Œ&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¿«é€Ÿæ¢å¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ§åˆ¶å™¨æ•…éšœåï¼Œæ–°æ§åˆ¶å™¨å¯ç›´æ¥ä»å†…å­˜åŠ è½½å…ƒæ•°æ®ï¼Œæ— éœ€ä»å¤–éƒ¨å­˜å‚¨æ¢å¤&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="kraft-æ¨¡å¼çš„éƒ¨ç½²ä¸é…ç½®"&gt;&lt;strong&gt;KRaft æ¨¡å¼çš„éƒ¨ç½²ä¸é…ç½®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…³é”®é…ç½®é¡¹"&gt;&lt;strong&gt;å…³é”®é…ç½®é¡¹&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;process.roles&lt;/code&gt;&lt;/strong&gt;ï¼šå®šä¹‰èŠ‚ç‚¹è§’è‰²ï¼ˆ&lt;code&gt;controller&lt;/code&gt;ã€&lt;code&gt;broker&lt;/code&gt; æˆ–æ··åˆæ¨¡å¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;node.id&lt;/code&gt;&lt;/strong&gt;ï¼šå”¯ä¸€æ ‡è¯†èŠ‚ç‚¹ï¼Œéœ€ä¸ &lt;code&gt;controller.quorum.voters&lt;/code&gt; ä¸­çš„ ID ä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;controller.quorum.voters&lt;/code&gt;&lt;/strong&gt;ï¼šå®šä¹‰æ§åˆ¶å™¨ä»²è£åˆ—è¡¨ï¼ˆå¦‚ &lt;code&gt;1@host1:9093,2@host2:9093,3@host3:9093&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="éƒ¨ç½²æµç¨‹"&gt;&lt;strong&gt;éƒ¨ç½²æµç¨‹&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;åˆå§‹åŒ–é›†ç¾¤å…ƒæ•°æ®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;bin/kafka-storage initialize \
-bootstrap-server localhost:9093 \
-configuration config/kraft/server.properties
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å¯åŠ¨ Kafka æœåŠ¡ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;bin/kafka-server-start.sh config/kraft/server.properties
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="ç”Ÿäº§ç¯å¢ƒå»ºè®®"&gt;&lt;strong&gt;ç”Ÿäº§ç¯å¢ƒå»ºè®®&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ§åˆ¶å™¨èŠ‚ç‚¹æ•°å»ºè®®ä¸º &lt;strong&gt;3 æˆ– 5&lt;/strong&gt;ï¼ˆå¥‡æ•°ï¼‰ï¼Œç¡®ä¿å¤šæ•°æ´¾å­˜æ´»ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…æ··åˆæ¨¡å¼ï¼ˆåŒæ—¶ä½œä¸ºæ§åˆ¶å™¨å’Œ Brokerï¼‰ï¼Œæ¨èéš”ç¦»éƒ¨ç½²ä»¥æå‡ç¨³å®šæ€§&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="kraft-æ¨¡å¼-vs-zookeeper-æ¨¡å¼"&gt;&lt;strong&gt;KRaft æ¨¡å¼ vs. ZooKeeper æ¨¡å¼&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;KRaft æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ZooKeeper æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶æ„å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•ï¼ˆæ— éœ€ ZooKeeperï¼‰&lt;/td&gt;
&lt;td&gt;å¤æ‚ï¼ˆéœ€ç‹¬ç«‹ç»´æŠ¤ ZooKeeperï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå…ƒæ•°æ®æœ¬åœ°åŒ–ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆZK å¯èƒ½æˆä¸ºç“¶é¢ˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒç™¾ä¸‡çº§åˆ†åŒº&lt;/td&gt;
&lt;td&gt;é™åˆ¶åœ¨æ•°ä¸‡åˆ†åŒº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•…éšœæ¢å¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯«ç§’çº§&lt;/td&gt;
&lt;td&gt;åˆ†é’Ÿçº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æˆç†Ÿåº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒæ–°ï¼ˆKafka 4.0 é»˜è®¤å¯ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;æˆç†Ÿï¼ˆé•¿æœŸç¨³å®šï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;è¿ç§»å»ºè®®&lt;/strong&gt;ï¼šæ–°é›†ç¾¤ä¼˜å…ˆé€‰æ‹© KRaft æ¨¡å¼ï¼Œæ—§é›†ç¾¤å¯é€æ­¥è¿ç§»&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="kraft-æ¨¡å¼çš„é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;KRaft æ¨¡å¼çš„é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤§è§„æ¨¡é›†ç¾¤&lt;/strong&gt;ï¼šé€‚åˆç™¾ä¸‡çº§åˆ†åŒºçš„åœºæ™¯&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶æ•°æ®å¤„ç†&lt;/strong&gt;ï¼šä½å»¶è¿Ÿå…ƒæ•°æ®æ“ä½œï¼Œé€‚åˆé‡‘èã€ç‰©è”ç½‘ç­‰å®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¾¹ç¼˜è®¡ç®—&lt;/strong&gt;ï¼šç®€åŒ–éƒ¨ç½²ï¼Œé€‚åˆèµ„æºå—é™çš„ç¯å¢ƒ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“-1"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;KRaft æ¨¡å¼æ˜¯ Kafka æ¶æ„çš„é‡å¤§æ¼”è¿›ï¼Œé€šè¿‡è‡ªç®¡ç†çš„ Raft åè®®æ˜¾è‘—æå‡äº†é›†ç¾¤çš„å¯æ‰©å±•æ€§ã€å¯é æ€§å’Œè¿ç»´æ•ˆç‡ã€‚éšç€ Kafka 4.0 çš„å‘å¸ƒï¼ŒKRaft å·²æˆä¸ºç”Ÿäº§ç¯å¢ƒçš„é¦–é€‰æ¨¡å¼ï¼Œå°¤å…¶é€‚åˆéœ€è¦é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿåœºæ™¯&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="äº‹åŠ¡"&gt;äº‹åŠ¡
&lt;/h2&gt;&lt;p&gt;Kafka äº‹åŠ¡æœºåˆ¶æ˜¯å…¶å®ç° &lt;strong&gt;Exactly-Once è¯­ä¹‰ï¼ˆEOSï¼‰&lt;/strong&gt; çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä¸»è¦ç”¨äºä¿éšœè·¨åˆ†åŒºæˆ–è·¨ä¸»é¢˜çš„æ¶ˆæ¯åŸå­æ€§æ“ä½œï¼ˆå³â€œå…¨æˆåŠŸæˆ–å…¨å¤±è´¥â€ï¼‰ï¼Œå°¤å…¶é€‚ç”¨äºé‡‘èäº¤æ˜“ã€å®æ—¶æµå¤„ç†ç­‰å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä¸¥æ ¼çš„åœºæ™¯ã€‚ä»¥ä¸‹ä»åŸç†ã€å®ç°ã€åº”ç”¨åŠé™åˆ¶å››ä¸ªç»´åº¦å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæœºåˆ¶ä¸åŸç†"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒæœºåˆ¶ä¸åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ç›®æ ‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ€§ï¼ˆAtomicityï¼‰&lt;/strong&gt;ï¼šè·¨åˆ†åŒº/ä¸»é¢˜çš„å¤šæ¡æ¶ˆæ¯è¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼ˆå¯¹æ¶ˆè´¹è€…å¯è§ï¼‰ï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šï¼ˆä¸å¯è§ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰&lt;/strong&gt;ï¼šé¿å…ç”Ÿäº§è€…éƒ¨åˆ†å†™å…¥æˆ–æ¶ˆè´¹è€…è¯»åˆ°æœªæäº¤æ•°æ®ï¼Œç¡®ä¿æµå¤„ç†ä¸­çš„ç«¯åˆ°ç«¯ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒä¹…æ€§ï¼ˆDurabilityï¼‰&lt;/strong&gt;ï¼šäº‹åŠ¡çŠ¶æ€æŒä¹…åŒ–å­˜å‚¨ï¼Œæ”¯æŒæ•…éšœæ¢å¤&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–ç»„ä»¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¹‚ç­‰æ€§ç”Ÿäº§è€…ï¼ˆIdempotent Producerï¼‰é€šè¿‡ Producer ID (PID) å’Œ Sequence Number å®ç°å•åˆ†åŒºå†…æ¶ˆæ¯å»é‡ï¼Œè§£å†³ç½‘ç»œé‡è¯•å¯¼è‡´çš„æ•°æ®é‡å¤é—®é¢˜ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;PID&lt;/em&gt;ï¼šç”Ÿäº§è€…ä¼šè¯å”¯ä¸€æ ‡è¯†ï¼Œé‡å¯åå¤±æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Sequence Number&lt;/em&gt;ï¼šæ¯ä¸ªåˆ†åŒºå†…å•è°ƒé€’å¢çš„åºåˆ—å·ï¼ŒBroker æ®æ­¤æ‹’ç»é‡å¤æ¶ˆæ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡åè°ƒå™¨ï¼ˆTransaction Coordinatorï¼‰&lt;/strong&gt;
Broker ç«¯ç‹¬ç«‹æ¨¡å—ï¼Œç®¡ç†äº‹åŠ¡çŠ¶æ€ï¼ˆå¦‚å¼€å§‹/æäº¤/å›æ»šï¼‰ï¼Œç»´æŠ¤äº‹åŠ¡æ—¥å¿—ï¼ˆæŒä¹…åŒ–äºå†…éƒ¨ Topic &lt;code&gt;__transaction_state&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶æ¶ˆæ¯ï¼ˆControl Messagesï¼‰&lt;/strong&gt;
ç‰¹æ®Šæ ‡è®°ï¼ˆå¦‚ &lt;code&gt;COMMIT&lt;/code&gt;/&lt;code&gt;ABORT&lt;/code&gt;ï¼‰ï¼Œæ ‡è¯†äº‹åŠ¡ç»“æœï¼Œæ¶ˆè´¹è€…æ®æ­¤è¿‡æ»¤æœªæäº¤æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆ2PCï¼‰æµç¨‹&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[å¼€å§‹äº‹åŠ¡] --&amp;gt; B[å‘é€æ¶ˆæ¯è‡³å¤šä¸ªåˆ†åŒº]
B --&amp;gt; C{æ‰€æœ‰æ¶ˆæ¯å†™å…¥æˆåŠŸï¼Ÿ}
C -- æ˜¯ --&amp;gt; D[å‘é€ Prepare Commit]
D --&amp;gt; E[äº‹åŠ¡åè°ƒå™¨å†™ Commit æ ‡è®°]
E --&amp;gt; F[æ¶ˆæ¯å¯¹æ¶ˆè´¹è€…å¯è§]
C -- å¦ --&amp;gt; G[å‘é€ Abort]
G --&amp;gt; H[ä¸¢å¼ƒæ¶ˆæ¯]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é˜¶æ®µ1&lt;/strong&gt;ï¼šç”Ÿäº§è€…å‘é€æ¶ˆæ¯ï¼Œäº‹åŠ¡åè°ƒå™¨è®°å½•ä¸ºâ€œæœªæäº¤â€çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜¶æ®µ2&lt;/strong&gt;ï¼šç”Ÿäº§è€…æäº¤äº‹åŠ¡ï¼Œåè°ƒå™¨å†™å…¥ &lt;code&gt;COMMIT&lt;/code&gt; æ ‡è®°ï¼Œæ¶ˆæ¯æ–¹å¯è¢«æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®å®ç°ç»†èŠ‚"&gt;ğŸ› ï¸ &lt;strong&gt;å…³é”®å®ç°ç»†èŠ‚&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è·¨ä¼šè¯äº‹åŠ¡æ¢å¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ IDï¼ˆTransactional IDï¼‰&lt;/strong&gt;ï¼šç”¨æˆ·é…ç½®çš„ç¨³å®š IDï¼ˆå¦‚ &lt;code&gt;transactional.id=tx-1&lt;/code&gt;ï¼‰ï¼Œæ›¿ä»£ä¸´æ—¶æ€§ PIDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Epoch æœºåˆ¶&lt;/strong&gt;ï¼šæ¯æ¬¡ç”Ÿäº§è€…åˆå§‹åŒ–æ—¶é€’å¢ epoch å€¼ï¼Œæ—§ epoch çš„ç”Ÿäº§è€…è¯·æ±‚å°†è¢«æ‹’ç»ï¼Œé˜²æ­¢â€œåƒµå°¸ç”Ÿäº§è€…â€å¹²æ‰°&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹-å¤„ç†-ç”Ÿäº§æ¨¡å¼ï¼ˆRead-Process-Writeï¼‰&lt;/strong&gt;
å°† â€‹&lt;strong&gt;æ¶ˆè´¹åç§»é‡æäº¤&lt;/strong&gt;â€‹ ä¸ â€‹&lt;strong&gt;ç”Ÿäº§æ¶ˆæ¯&lt;/strong&gt;â€‹ ç»‘å®šä¸ºåŸå­æ“ä½œï¼Œé¿å…ä»¥ä¸‹é—®é¢˜ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸¢å¤±&lt;/strong&gt;ï¼šæ¶ˆè´¹åæœªç”Ÿäº§æˆåŠŸï¼Œä½†åç§»é‡å·²æäº¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®é‡å¤&lt;/strong&gt;ï¼šç”Ÿäº§æˆåŠŸä½†åç§»é‡æœªæäº¤ï¼Œå¯¼è‡´é‡å¤æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;producer.beginTransaction();
ConsumerRecords records = consumer.poll();
for (record : records) {
producer.send(new ProducerRecord(&amp;#34;output&amp;#34;, process(record)));
}
// åŸå­æäº¤åç§»é‡ä¸ç”Ÿäº§æ¶ˆæ¯
producer.sendOffsetsToTransaction(offsets, &amp;#34;consumer-group&amp;#34;);
producer.commitTransaction(); // å¤±è´¥åˆ™ abortTransaction()
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…éš”ç¦»çº§åˆ«&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;read_uncommitted&lt;/code&gt;ï¼ˆé»˜è®¤ï¼‰ï¼šå¯æ¶ˆè´¹æœªæäº¤æ¶ˆæ¯ï¼ˆå«å›æ»šæ¶ˆæ¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;read_committed&lt;/code&gt;ï¼šä»…æ¶ˆè´¹å·²æäº¤äº‹åŠ¡çš„æ¶ˆæ¯ï¼Œç­‰å¾…äº‹åŠ¡å®Œæˆåå†æ¨é€&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;âš¡ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è·¨åˆ†åŒºåŸå­å†™å…¥&lt;/strong&gt;
ä¾‹å¦‚è½¬è´¦ä¸šåŠ¡ï¼šæ‰£æ¬¾ï¼ˆåˆ†åŒº Aï¼‰ä¸åŠ æ¬¾ï¼ˆåˆ†åŒº Bï¼‰éœ€åŸå­å®Œæˆ&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµå¤„ç† Exactly-Once&lt;/strong&gt;
Kafka Streams ä¸­ï¼Œè¾“å…¥å¤„ç† â†’ è¾“å‡ºå†™å…¥ å…¨è¿‡ç¨‹åŸå­åŒ–ï¼Œæ•…éšœæ—¶çŠ¶æ€è‡ªåŠ¨æ¢å¤&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šç³»ç»Ÿä¸€è‡´æ€§ï¼ˆæœ‰é™æ”¯æŒï¼‰&lt;/strong&gt;
é€šè¿‡ â€‹&lt;strong&gt;æœ¬åœ°äº‹åŠ¡ + Kafka äº‹åŠ¡&lt;/strong&gt;â€‹ è”åŠ¨ï¼ˆå¦‚å…ˆå†™æ•°æ®åº“å†å‘æ¶ˆæ¯ï¼‰ï¼Œä½†éœ€ä¸šåŠ¡å±‚è¡¥å¿æœºåˆ¶ï¼ˆéå†…ç½®æ”¯æŒï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é™åˆ¶ä¸è°ƒä¼˜å»ºè®®"&gt;âš ï¸ &lt;strong&gt;é™åˆ¶ä¸è°ƒä¼˜å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— äº‹åŠ¡åæŸ¥&lt;/strong&gt;ï¼šå¦‚ RocketMQ çš„ Broker ä¸»åŠ¨å›æŸ¥ç”Ÿäº§è€…çŠ¶æ€ï¼ŒKafka éœ€ä¾èµ–è¶…æ—¶è‡ªåŠ¨å›æ»šï¼ˆé»˜è®¤ 15 åˆ†é’Ÿï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸è·¨å¤–éƒ¨ç³»ç»Ÿ&lt;/strong&gt;ï¼šæ— æ³•ä¸æ•°æ®åº“äº‹åŠ¡è”åŠ¨ï¼ˆå¦‚ MySQLï¼‰ï¼Œéœ€ä¸šåŠ¡å±‚å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆå¦‚ Saga æ¨¡å¼ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æŸè€—&lt;/strong&gt;ï¼šäº‹åŠ¡æäº¤å¢åŠ çº¦ 20%~30% å»¶è¿Ÿï¼Œé«˜é¢‘åœºæ™¯éœ€æƒè¡¡&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç”Ÿäº§é…ç½®å»ºè®®&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èå€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;isolation.level&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;read_committed&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆè´¹è€…éš”ç¦»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;acks&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;all&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç¡®ä¿æ¶ˆæ¯æŒä¹…åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;enable.idempotence&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;true&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨å¯ç”¨ï¼ˆäº‹åŠ¡ ID è®¾ç½®åé»˜è®¤å¼€å¯ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;transaction.timeout.ms&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;60000 (1 åˆ†é’Ÿ)&lt;/td&gt;
&lt;td&gt;é¿å…æœªå†³äº‹åŠ¡é˜»å¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ•…éšœå¤„ç†&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…å®•æœº&lt;/strong&gt;ï¼šæ–°ç”Ÿäº§è€…ä»¥ç›¸åŒäº‹åŠ¡ ID åˆå§‹åŒ–æ—¶ï¼Œæ—§äº‹åŠ¡è‡ªåŠ¨ç»ˆæ­¢ï¼ˆepoch é€’å¢ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åè°ƒå™¨æ•…éšœ&lt;/strong&gt;ï¼šäº‹åŠ¡æ—¥å¿—æŒä¹…åŒ–ï¼Œåˆ‡æ¢åè°ƒå™¨åå¯æ¢å¤çŠ¶æ€&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Kafka äº‹åŠ¡é€šè¿‡ &lt;strong&gt;å¹‚ç­‰æ€§ç”Ÿäº§è€… + äº‹åŠ¡åè°ƒå™¨ + ä¸¤é˜¶æ®µæäº¤&lt;/strong&gt; å®ç°è·¨åˆ†åŒºåŸå­æ“ä½œï¼Œæ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Exactly-Once è¯­ä¹‰&lt;/strong&gt;ï¼šæµå¤„ç†ä¸­ç«¯åˆ°ç«¯æ•°æ®ä¸€è‡´æ€§ä¿éšœï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–å®¹é”™é€»è¾‘&lt;/strong&gt;ï¼šè¯»-å¤„ç†-å†™æ¨¡å¼æ— éœ€æ‰‹åŠ¨ç®¡ç†åç§»é‡ä¸æ¶ˆæ¯çŠ¶æ€ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»éš”ç¦»æ§åˆ¶&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…å¯è¿‡æ»¤æœªæäº¤æ•°æ®ã€‚
éœ€æ³¨æ„å…¶ä¸é€‚ç”¨è·¨æ•°æ®åº“äº‹åŠ¡åœºæ™¯ï¼Œä¸”æ€§èƒ½å¼€é”€éœ€é€šè¿‡å‚æ•°è°ƒä¼˜å¹³è¡¡ã€‚å¯¹äºé‡‘èçº§ç³»ç»Ÿï¼Œå»ºè®®ç»“åˆ &lt;code&gt;min.insync.replicas=2&lt;/code&gt; åŠå¤šå‰¯æœ¬éƒ¨ç½²ï¼Œè¿›ä¸€æ­¥é™ä½æ•°æ®ä¸¢å¤±é£é™©&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="æ¶ˆè´¹æ¨¡å¼"&gt;æ¶ˆè´¹æ¨¡å¼
&lt;/h2&gt;&lt;p&gt;Kafkaçš„æ¶ˆè´¹æ¨¡å¼ä¸»è¦ä»&lt;strong&gt;æ¶ˆæ¯ä¼ é€’è¯­ä¹‰&lt;/strong&gt;å’Œ&lt;strong&gt;æ¶ˆè´¹è€…è¡Œä¸º&lt;/strong&gt;ä¸¤ä¸ªç»´åº¦åˆ’åˆ†ï¼Œä»¥ä¸‹æ˜¯ä¸‰ç§æ ¸å¿ƒæ¨¡å¼çš„è¯¦ç»†è¯´æ˜åŠé€‚ç”¨åœºæ™¯ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶ˆæ¯ä¼ é€’è¯­ä¹‰æ¨¡å¼å¯é æ€§ç»´åº¦"&gt;ğŸ“¨ &lt;strong&gt;æ¶ˆæ¯ä¼ é€’è¯­ä¹‰æ¨¡å¼ï¼ˆå¯é æ€§ç»´åº¦ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="at-most-onceæœ€å¤šä¸€æ¬¡"&gt;&lt;strong&gt;At-Most-Onceï¼ˆæœ€å¤šä¸€æ¬¡ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…åœ¨æ¶ˆæ¯å¤„ç†å‰è‡ªåŠ¨æäº¤åç§»é‡ï¼ˆOffsetï¼‰ã€‚è‹¥æ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œå› åç§»é‡å·²æ›´æ–°ï¼Œæ¶ˆæ¯ä¸ä¼šè¢«é‡æ–°æ¶ˆè´¹ã€‚&lt;/li&gt;
&lt;li&gt;é…ç½®æ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;å¼€å¯è‡ªåŠ¨æäº¤ï¼š&lt;code&gt;enable.auto.commit=true&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è®¾ç½®è¾ƒçŸ­æäº¤é—´éš”ï¼š&lt;code&gt;auto.commit.interval.ms=1000&lt;/code&gt;ï¼ˆä¾‹å¦‚1ç§’ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©&lt;/strong&gt;ï¼š
âš ï¸ â€‹&lt;strong&gt;æ¶ˆæ¯ä¸¢å¤±&lt;/strong&gt;â€‹ï¼šå¤„ç†è¿‡ç¨‹ä¸­è‹¥æ¶ˆè´¹è€…å´©æºƒï¼Œæ¶ˆæ¯å› åç§»é‡å·²æäº¤è€Œä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ—¥å¿—é‡‡é›†ç­‰å…è®¸å°‘é‡ä¸¢å¤±çš„å®æ—¶æ€§åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="at-least-onceæœ€å°‘ä¸€æ¬¡"&gt;&lt;strong&gt;At-Least-Onceï¼ˆæœ€å°‘ä¸€æ¬¡ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…åœ¨å¤„ç†æ¶ˆæ¯åæ‰‹åŠ¨æäº¤åç§»é‡ã€‚è‹¥æäº¤å¤±è´¥æˆ–æ¶ˆè´¹è€…å´©æºƒï¼Œæ¶ˆæ¯ä¼šè¢«é‡å¤æ¶ˆè´¹ã€‚&lt;/li&gt;
&lt;li&gt;é…ç½®æ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;å…³é—­è‡ªåŠ¨æäº¤ï¼š&lt;code&gt;enable.auto.commit=false&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¤„ç†å®Œæˆåè°ƒç”¨&lt;code&gt;commitSync()&lt;/code&gt;ï¼ˆåŒæ­¥æäº¤ï¼‰æˆ–&lt;code&gt;commitAsync()&lt;/code&gt;ï¼ˆå¼‚æ­¥æäº¤ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©&lt;/strong&gt;ï¼š
ğŸ”„ â€‹&lt;strong&gt;æ¶ˆæ¯é‡å¤&lt;/strong&gt;â€‹ï¼šç½‘ç»œæŠ–åŠ¨æˆ–æ¶ˆè´¹è€…é‡å¯å¯èƒ½å¯¼è‡´é‡å¤å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè®¢å•æ”¯ä»˜ç­‰ä¸å…è®¸ä¸¢å¤±ä½†å¯å®¹å¿é‡å¤çš„ä¸šåŠ¡ï¼ˆéœ€ä¸šåŠ¡å±‚å»é‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="exactly-onceæ­£å¥½ä¸€æ¬¡"&gt;&lt;strong&gt;Exactly-Onceï¼ˆæ­£å¥½ä¸€æ¬¡ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æœºåˆ¶ï¼šé€šè¿‡äº‹åŠ¡å’Œå¹‚ç­‰æ€§ç¡®ä¿æ¶ˆæ¯å¤„ç†ä¸åç§»é‡æäº¤çš„åŸå­æ€§ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…ç«¯&lt;/strong&gt;ï¼šå¯ç”¨å¹‚ç­‰ï¼ˆ&lt;code&gt;enable.idempotence=true&lt;/code&gt;ï¼‰é¿å…é‡è¯•å¯¼è‡´é‡å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…ç«¯&lt;/strong&gt;ï¼šç»“åˆKafkaäº‹åŠ¡APIï¼Œå°†æ¶ˆæ¯å¤„ç†ä¸åç§»é‡æäº¤ç»‘å®šä¸ºåŸå­æ“ä½œ&lt;a class="link" href="@ref" &gt;1,3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®ç°ç¤ºä¾‹ï¼ˆJavaï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;producer.beginTransaction();
ConsumerRecords&amp;lt;String, String&amp;gt; records = consumer.poll(Duration.ofMillis(100));
for (ConsumerRecord record : records) {
// å¤„ç†æ¶ˆæ¯å¹¶å†™å…¥å¤–éƒ¨ç³»ç»Ÿï¼ˆå¦‚æ•°æ®åº“ï¼‰
}
producer.sendOffsetsToTransaction(offsets, &amp;#34;consumer-group&amp;#34;); // æäº¤åç§»é‡
producer.commitTransaction(); // äº‹åŠ¡æäº¤
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼š
âœ… â€‹&lt;strong&gt;æ— é‡å¤æ— ä¸¢å¤±&lt;/strong&gt;â€‹ï¼šé€‚ç”¨äºé‡‘èäº¤æ˜“ã€å®æ—¶ç»Ÿè®¡ç­‰å¼ºä¸€è‡´æ€§åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶ˆè´¹è€…è¡Œä¸ºæ¨¡å¼å¹¶è¡Œå¤„ç†ç»´åº¦"&gt;ğŸ”„ &lt;strong&gt;æ¶ˆè´¹è€…è¡Œä¸ºæ¨¡å¼ï¼ˆå¹¶è¡Œå¤„ç†ç»´åº¦ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é›†ç¾¤æ¶ˆè´¹æ¶ˆè´¹è€…ç»„æ¨¡å¼"&gt;&lt;strong&gt;é›†ç¾¤æ¶ˆè´¹ï¼ˆæ¶ˆè´¹è€…ç»„æ¨¡å¼ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼š
åŒä¸€æ¶ˆè´¹è€…ç»„ï¼ˆ&lt;code&gt;group.id&lt;/code&gt;ç›¸åŒï¼‰å†…çš„å¤šä¸ªæ¶ˆè´¹è€…å®ä¾‹&lt;strong&gt;å…±äº«æ¶ˆè´¹åˆ†åŒº&lt;/strong&gt;ã€‚æ¯ä¸ªåˆ†åŒºä»…ç”±ç»„å†…ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ï¼Œå®ç°&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;ä¸&lt;strong&gt;åˆ†åŒºå†…é¡ºåºæ¶ˆè´¹&lt;/strong&gt;â€‹&lt;a class="link" href="@ref" &gt;4,5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ°´å¹³æ‰©å±•&lt;/strong&gt;ï¼šå¢åŠ æ¶ˆè´¹è€…å®ä¾‹å¯æå‡ååé‡ï¼ˆä¸è¶…è¿‡åˆ†åŒºæ•°ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†å¹³è¡¡ï¼ˆRebalanceï¼‰&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…åŠ å…¥/é€€å‡ºæ—¶ï¼Œåˆ†åŒºè‡ªåŠ¨é‡æ–°åˆ†é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘æ•°æ®å¤„ç†ï¼ˆå¦‚ç”µå•†è®¢å•å¤„ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¹¿æ’­æ¶ˆè´¹"&gt;&lt;strong&gt;å¹¿æ’­æ¶ˆè´¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šå¤šä¸ªæ¶ˆè´¹è€…ç»„æˆ–ç‹¬ç«‹æ¶ˆè´¹è€…è®¢é˜…åŒä¸€ä¸»é¢˜ï¼Œ&lt;strong&gt;æ¯æ¡æ¶ˆæ¯è¢«æ‰€æœ‰æ¶ˆè´¹è€…ç‹¬ç«‹æ¶ˆè´¹&lt;/strong&gt;ã€‚åç§»é‡æŒ‰æ¶ˆè´¹è€…ç»„æˆ–å®ä¾‹ç‹¬ç«‹ç»´æŠ¤&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯å…¨è¦†ç›–&lt;/strong&gt;ï¼šæ¯ä¸ªæ¶ˆè´¹è€…æ”¶åˆ°å…¨é‡æ¶ˆæ¯ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…æ•°é‡ä¸åˆ†åŒºæ— å…³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ—¥å¿—åˆ†å‘ï¼ˆæ‰€æœ‰æœåŠ¡æ¥æ”¶å®¡è®¡æ—¥å¿—ï¼‰ã€å®æ—¶ç›‘æ§æŠ¥è­¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æŒ‡å®šåˆ†åŒºæ¶ˆè´¹"&gt;&lt;strong&gt;æŒ‡å®šåˆ†åŒºæ¶ˆè´¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…ç›´æ¥ç»‘å®šåˆ°ç‰¹å®šåˆ†åŒºï¼ˆè€Œéé€šè¿‡æ¶ˆè´¹è€…ç»„åˆ†é…ï¼‰ï¼Œå¸¸ç”¨äºç‰¹æ®Šè·¯ç”±éœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ assign() æ‰‹åŠ¨æŒ‡å®šåˆ†åŒºï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;consumer.assign(Arrays.asList(new TopicPartition(&amp;#34;topic&amp;#34;, 0))); // æ¶ˆè´¹åˆ†åŒº0[8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š
ğŸ” â€‹&lt;strong&gt;é¡ºåºæ€§ä¿éšœ&lt;/strong&gt;â€‹ï¼šä¾‹å¦‚æŒ‰ç”¨æˆ·IDå“ˆå¸Œåˆ°å›ºå®šåˆ†åŒºï¼Œä¿è¯åŒä¸€ç”¨æˆ·çš„æ“ä½œé¡ºåºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ¨¡å¼å¯¹æ¯”ä¸é€‰å‹å»ºè®®"&gt;ğŸ’ &lt;strong&gt;æ¨¡å¼å¯¹æ¯”ä¸é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é…ç½®å¤æ‚åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;At-Most-Once&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®æ—¶æ—¥å¿—æµ&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆå¯èƒ½ä¸¢å¤±ï¼‰&lt;/td&gt;
&lt;td&gt;æœ€é«˜&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;At-Least-Once&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®¢å•çŠ¶æ€æ›´æ–°&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆå¯èƒ½é‡å¤ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Exactly-Once&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡‘èäº¤æ˜“æµæ°´&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆæ— é‡å¤æ— ä¸¢å¤±ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆäº‹åŠ¡å¼€é”€ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é›†ç¾¤æ¶ˆè´¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ä¸šåŠ¡å¤„ç†&lt;/td&gt;
&lt;td&gt;ä¾èµ–æäº¤ç­–ç•¥&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¿æ’­æ¶ˆè´¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šç³»ç»Ÿæ—¥å¿—åŒæ­¥&lt;/td&gt;
&lt;td&gt;ä¾èµ–æäº¤ç­–ç•¥&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŒ‡å®šåˆ†åŒºæ¶ˆè´¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰Keyé¡ºåºå¤„ç†çš„ä¸šåŠ¡ï¼ˆå¦‚ç”¨æˆ·ä¼šè¯ï¼‰&lt;/td&gt;
&lt;td&gt;ä¾èµ–æäº¤ç­–ç•¥&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å®è·µå»ºè®®"&gt;âš¡ &lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å¯é æ€§ä¼˜å…ˆï¼š
&lt;ul&gt;
&lt;li&gt;å¼ºä¸€è‡´æ€§åœºæ™¯é€‰æ‹©&lt;code&gt;Exactly-Once&lt;/code&gt;+äº‹åŠ¡ï¼Œé…åˆ&lt;code&gt;acks=all&lt;/code&gt;å’Œ&lt;code&gt;min.insync.replicasâ‰¥2&lt;/code&gt;&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ååé‡ä¼˜å…ˆï¼š
&lt;ul&gt;
&lt;li&gt;å…è®¸å°‘é‡é‡å¤æ—¶ç”¨&lt;code&gt;At-Least-Once&lt;/code&gt;+å¼‚æ­¥æäº¤ï¼Œå¹¶æ‰©å¤§&lt;code&gt;max.poll.records&lt;/code&gt;æå‡å•æ¬¡æ‹‰å–é‡&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é¿å…æ¶ˆè´¹é˜»å¡ï¼š
&lt;ul&gt;
&lt;li&gt;è®¾ç½®&lt;code&gt;max.poll.interval.ms&lt;/code&gt;é˜²æ­¢å¤„ç†è¶…æ—¶è§¦å‘å†å¹³è¡¡&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åŠ¨æ€æ‰©å±•ï¼š
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…ç»„æ¨¡å¼ä¸‹ï¼Œåˆ†åŒºæ•°åº”â‰¥æ¶ˆè´¹è€…å®ä¾‹æ•°ï¼Œé¿å…é—²ç½®&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ç»„åˆ&lt;strong&gt;æ¶ˆæ¯è¯­ä¹‰&lt;/strong&gt;ä¸&lt;strong&gt;è¡Œä¸ºæ¨¡å¼&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;Exactly-Once+é›†ç¾¤æ¶ˆè´¹&lt;/code&gt;ï¼‰ï¼Œå¯åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ã€æ‰©å±•æ€§ä¸é¡ºåºæ€§éœ€æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="exactly-once"&gt;Exactly-Once
&lt;/h2&gt;&lt;p&gt;Kafka çš„ &lt;strong&gt;Exactly-Onceï¼ˆç²¾ç¡®ä¸€æ¬¡ï¼‰è¯­ä¹‰&lt;/strong&gt;æ˜¯åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿçš„æœ€é«˜ä¸€è‡´æ€§ä¿éšœï¼Œç¡®ä¿æ¶ˆæ¯ä»ç”Ÿäº§åˆ°æ¶ˆè´¹çš„å…¨é“¾è·¯&lt;strong&gt;ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€ä¸”å¤„ç†ç»“æœç¡®å®š&lt;/strong&gt;ã€‚ä»¥ä¸‹ä»å®ç°æœºåˆ¶ã€æ ¸å¿ƒç»„ä»¶ã€åº”ç”¨åœºæ™¯åŠé™åˆ¶å››ä¸ªç»´åº¦å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå®ç°æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒå®ç°æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å¹‚ç­‰æ€§ç”Ÿäº§è€…idempotent-producer"&gt;&lt;strong&gt;å¹‚ç­‰æ€§ç”Ÿäº§è€…ï¼ˆIdempotent Producerï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šè§£å†³å•åˆ†åŒºå†…å› ç”Ÿäº§è€…é‡è¯•å¯¼è‡´çš„æ¶ˆæ¯é‡å¤é—®é¢˜&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªç”Ÿäº§è€…åˆ†é…å”¯ä¸€ &lt;code&gt;PID&lt;/code&gt;ï¼ˆProducer IDï¼‰å’Œé€’å¢çš„ &lt;code&gt;Sequence Number&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Broker ç¼“å­˜æ¯ä¸ªåˆ†åŒºçš„æœ€æ–° 5 æ¡æ¶ˆæ¯çš„ &lt;code&gt;&amp;lt;PID, Partition, SeqNumber&amp;gt;&lt;/code&gt; ä¸‰å…ƒç»„ï¼Œæ‹’ç»é‡å¤åºåˆ—å·çš„æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯ç”¨æ¡ä»¶ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;props.put(&amp;#34;enable.idempotence&amp;#34;, &amp;#34;true&amp;#34;); // è‡ªåŠ¨å¼€å¯ acks=all å’Œé‡è¯•æœºåˆ¶[7](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="äº‹åŠ¡æœºåˆ¶transactions"&gt;&lt;strong&gt;äº‹åŠ¡æœºåˆ¶ï¼ˆTransactionsï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šå®ç°è·¨åˆ†åŒºçš„åŸå­å†™å…¥ï¼Œå¹¶ä¸æ¶ˆè´¹è€…åç§»é‡æäº¤ç»‘å®š&lt;a class="link" href="@ref" &gt;1,2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç»„ä»¶&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡åè°ƒå™¨ï¼ˆTransaction Coordinatorï¼‰&lt;/strong&gt;ï¼š
å†…åµŒäº Brokerï¼Œç®¡ç†äº‹åŠ¡çŠ¶æ€ï¼ˆå¦‚ &lt;code&gt;ongoing&lt;/code&gt;ã€&lt;code&gt;prepare_commit&lt;/code&gt;ï¼‰ï¼ŒæŒä¹…åŒ–åˆ°å†…éƒ¨ Topic &lt;code&gt;__transaction_state&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ IDï¼ˆtransactional.idï¼‰&lt;/strong&gt;ï¼š
ç”¨æˆ·é…ç½®çš„ç¨³å®šæ ‡è¯†ï¼Œç”¨äºè·¨ä¼šè¯æ¢å¤äº‹åŠ¡ï¼ˆå¦‚ç”Ÿäº§è€…é‡å¯åå»¶ç»­æœªå®Œæˆäº‹åŠ¡ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸¤é˜¶æ®µæäº¤æµç¨‹&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[ç”Ÿäº§è€… beginTransaction] --&amp;gt; B[å‘é€æ¶ˆæ¯åˆ°å¤šä¸ªåˆ†åŒº]
B --&amp;gt; C[é¢„æäº¤ï¼šæ¶ˆæ¯å†™å…¥ä½†æ ‡è®°ä¸ºæœªæäº¤]
C --&amp;gt; D[åè°ƒå™¨æŒä¹…åŒ– prepare_commit çŠ¶æ€]
D --&amp;gt; E[æ‰€æœ‰åˆ†åŒºå†™å…¥æˆåŠŸï¼Ÿ]
E -- æ˜¯ --&amp;gt; F[æäº¤äº‹åŠ¡ï¼šå†™å…¥ COMMIT æ ‡è®°]
E -- å¦ --&amp;gt; G[å›æ»šï¼šå†™å…¥ ABORT æ ‡è®°]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æäº¤å&lt;/strong&gt;ï¼šæ¶ˆæ¯å¯¹æ¶ˆè´¹è€…å¯è§ï¼Œåç§»é‡åŒæ­¥æäº¤&lt;a class="link" href="@ref" &gt;1,5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç«¯åˆ°ç«¯-exactly-once-å®ç°"&gt;ğŸ”§ &lt;strong&gt;ç«¯åˆ°ç«¯ Exactly-Once å®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç”Ÿäº§è€…ç«¯é…ç½®"&gt;&lt;strong&gt;ç”Ÿäº§è€…ç«¯é…ç½®&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// åˆå§‹åŒ–äº‹åŠ¡ç”Ÿäº§è€…
props.put(&amp;#34;transactional.id&amp;#34;, &amp;#34;order-producer&amp;#34;); // å¿…é¡»å…¨å±€å”¯ä¸€
props.put(&amp;#34;isolation.level&amp;#34;, &amp;#34;read_committed&amp;#34;); // æ¶ˆè´¹è€…ä»…è¯»å·²æäº¤æ¶ˆæ¯
producer.initTransactions();
producer.beginTransaction();
producer.send(record);
producer.sendOffsetsToTransaction(offsets, &amp;#34;consumer-group&amp;#34;); // ç»‘å®šåç§»é‡æäº¤
producer.commitTransaction();
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ¶ˆè´¹è€…ç«¯å»é‡"&gt;&lt;strong&gt;æ¶ˆè´¹è€…ç«¯å»é‡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;éš”ç¦»çº§åˆ«ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;read_committed&lt;/code&gt;ï¼šè¿‡æ»¤æœªæäº¤äº‹åŠ¡çš„æ¶ˆæ¯ï¼ˆä¾èµ– Broker çš„ LSO æœºåˆ¶ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨ç³»ç»Ÿé…åˆï¼š
&lt;ul&gt;
&lt;li&gt;ä¸šåŠ¡å±‚éœ€å®ç°å¹‚ç­‰æ“ä½œï¼ˆå¦‚æ•°æ®åº“å”¯ä¸€é”®çº¦æŸæˆ– Redis å»é‡ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;if (!isOrderProcessed(record.key())) { // æ£€æŸ¥è®¢å•æ˜¯å¦å·²å¤„ç†
deductBalance(record.value()); // æ‰£æ¬¾æ“ä½œ
markOrderAsProcessed(record.key()); // åŸå­æ›´æ–°çŠ¶æ€
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚å¸¸åœºæ™¯ä¸å®¹é”™"&gt;âš ï¸ &lt;strong&gt;å¼‚å¸¸åœºæ™¯ä¸å®¹é”™&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ•…éšœåœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç³»ç»Ÿè¡Œä¸º&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Exactly-Once ä¿éšœ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿäº§è€…å®•æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–°ç”Ÿäº§è€…ä»¥ç›¸åŒ &lt;code&gt;transactional.id&lt;/code&gt; å¯åŠ¨ï¼Œé€’å¢ &lt;code&gt;epoch&lt;/code&gt; æ‹’ç»æ—§ç”Ÿäº§è€…æ¶ˆæ¯&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡è‡ªåŠ¨å›æ»šï¼Œæ— é‡å¤æ•°æ®&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶ˆè´¹è€…å´©æºƒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡å¯åä»å·²æäº¤åç§»é‡é‡æ–°æ¶ˆè´¹ï¼Œé€šè¿‡å¤–éƒ¨å­˜å‚¨å»é‡&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡å±‚å¹‚ç­‰é¿å…é‡å¤å¤„ç†&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Broker æ•…éšœ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡æ—¥å¿—é€šè¿‡å‰¯æœ¬æŒä¹…åŒ–ï¼Œæ–° Leader åŸºäº HWï¼ˆHigh Watermarkï¼‰æ¢å¤äº‹åŠ¡çŠ¶æ€&lt;/td&gt;
&lt;td&gt;æ•°æ®ä¸€è‡´æ€§ä¿éšœ&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åè°ƒå™¨å®•æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30 ç§’å†…é€‰ä¸¾æ–°åè°ƒå™¨ï¼Œé€šè¿‡ &lt;code&gt;__transaction_state&lt;/code&gt; æ¢å¤äº‹åŠ¡çŠ¶æ€&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸é€‚ç”¨åœºæ™¯"&gt;ğŸ“Š &lt;strong&gt;æ€§èƒ½ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ€§èƒ½å½±å“"&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ååé‡ä¸‹é™&lt;/strong&gt;ï¼šäº‹åŠ¡æäº¤å¢åŠ çº¦ 15%~30% å»¶è¿Ÿï¼ˆRPC é€šä¿¡å’Œæ—¥å¿—æŒä¹…åŒ–å¼€é”€ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°è°ƒä¼˜å»ºè®®&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;max.in.flight.requests.per.connection=5 # æ§åˆ¶å¹¶å‘è¯·æ±‚æ•°
transaction.timeout.ms=60000 # é¿å…åƒµå°¸äº‹åŠ¡é˜»å¡
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é€‚ç”¨åœºæ™¯å¯¹æ¯”"&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èè¯­ä¹‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;é‡‘èäº¤æ˜“/å®æ—¶å¯¹è´¦&lt;/td&gt;
&lt;td&gt;Exactly-Once&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´æ€§è¦æ±‚ï¼Œå®¹å¿ä¸€å®šå»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç”µå•†è®¢å•å¤„ç†&lt;/td&gt;
&lt;td&gt;At-Least-Once + å¹‚ç­‰&lt;/td&gt;
&lt;td&gt;é«˜ååä¼˜å…ˆï¼Œä¸šåŠ¡å±‚å»é‡æˆæœ¬ä½&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å®æ—¶ç›‘æ§æ—¥å¿—&lt;/td&gt;
&lt;td&gt;At-Most-Once&lt;/td&gt;
&lt;td&gt;å…è®¸ä¸¢å¤±ï¼Œè¿½æ±‚æœ€ä½å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é™åˆ¶ä¸æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;é™åˆ¶ä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è·¨ç³»ç»Ÿäº‹åŠ¡ä¸æ”¯æŒ
&lt;ul&gt;
&lt;li&gt;Kafka äº‹åŠ¡ä»…é™å†…éƒ¨è¯»å†™ï¼ˆå¦‚ &lt;code&gt;Kafkaâ†’Flinkâ†’Kafka&lt;/code&gt;ï¼‰ï¼Œæ— æ³•ä¿è¯æ•°æ®åº“ç­‰å¤–éƒ¨ç³»ç»Ÿçš„åŸå­æ€§&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼šé€šè¿‡ Saga æ¨¡å¼æˆ– CDC åŒæ­¥å®ç°è·¨ç³»ç»Ÿä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è¿ç»´å¤æ‚æ€§
&lt;ul&gt;
&lt;li&gt;éœ€ç›‘æ§äº‹åŠ¡åè°ƒå™¨æŒ‡æ ‡ï¼ˆå¦‚ &lt;code&gt;transaction-abort-rate &amp;gt;5%&lt;/code&gt; æ—¶å‘Šè­¦ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é¿å… &lt;code&gt;transactional.id&lt;/code&gt; å†²çªå¯¼è‡´ epoch ç«äº‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸é€‚ç”¨åœºæ™¯
&lt;ul&gt;
&lt;li&gt;è¶…ä½å»¶è¿Ÿéœ€æ±‚ï¼ˆå¦‚å®æ—¶é£æ§ï¼‰ã€å…è®¸å°‘é‡é‡å¤çš„é«˜åååœºæ™¯ï¼ˆå¦‚æ—¥å¿—åˆ†æï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Kafka Exactly-Once çš„æœ¬è´¨æ˜¯ &lt;strong&gt;å¹‚ç­‰æ€§ + äº‹åŠ¡ + æ¶ˆè´¹ç«¯ååŒ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…å¹‚ç­‰&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;&amp;lt;PID, SeqNum&amp;gt;&lt;/code&gt; æœç»å•åˆ†åŒºé‡å¤&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨åˆ†åŒºåŸå­æ€§&lt;/strong&gt;ï¼šäº‹åŠ¡åè°ƒå™¨é©±åŠ¨ä¸¤é˜¶æ®µæäº¤ï¼Œç»‘å®šåç§»é‡æäº¤&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…éš”ç¦»&lt;/strong&gt;ï¼š&lt;code&gt;read_committed&lt;/code&gt; è¿‡æ»¤æœªæäº¤æ•°æ®ï¼Œé…åˆå¤–éƒ¨å­˜å‚¨å»é‡&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé‡‘èçº§ç³»ç»Ÿæ¨èé…ç½®ï¼š&lt;code&gt;replication.factor=3&lt;/code&gt; + &lt;code&gt;min.insync.replicas=2&lt;/code&gt; + &lt;code&gt;isolation.level=read_committed&lt;/code&gt;ï¼Œå¹¶ä¸¥æ ¼ç›‘æ§äº‹åŠ¡ä¸­æ­¢ç‡ã€‚å¯¹äºéå…³é”®ä¸šåŠ¡ï¼Œå¯æƒè¡¡æ€§èƒ½é‡‡ç”¨ &lt;strong&gt;At-Least-Once + ä¸šåŠ¡å¹‚ç­‰&lt;/strong&gt;çš„ç»„åˆæ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¹‚ç­‰"&gt;å¹‚ç­‰
&lt;/h2&gt;&lt;p&gt;åœ¨Kafkaçš„Exactly-Onceï¼ˆç²¾ç¡®ä¸€æ¬¡ï¼‰è¯­ä¹‰å®ç°ä¸­ï¼Œ&lt;strong&gt;æ¶ˆè´¹ç«¯æ˜¯å¦éœ€ä¸šåŠ¡å±‚é¢å¤–å®ç°å¹‚ç­‰æ€§ï¼Œå–å†³äºæ¶ˆæ¯å¤„ç†çš„è¾¹ç•Œæ˜¯å¦æ¶‰åŠå¤–éƒ¨ç³»ç»Ÿ&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯åˆ†å±‚è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-kafka-exactly-once-çš„ä¿éšœèŒƒå›´"&gt;âš™ï¸ Kafka Exactly-Once çš„ä¿éšœèŒƒå›´
&lt;/h3&gt;&lt;p&gt;Kafkaé€šè¿‡&lt;strong&gt;äº‹åŠ¡æœºåˆ¶ + å¹‚ç­‰ç”Ÿäº§è€…&lt;/strong&gt;å®ç°ç«¯åˆ°ç«¯Exactly-Onceï¼Œä½†å…¶åŸå­æ€§è¾¹ç•Œä»…é™äºKafkaå†…éƒ¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç”Ÿäº§è€…ç«¯&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹‚ç­‰æ€§ï¼ˆIdempotenceï¼‰&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;&amp;lt;PID, Partition, Sequence Number&amp;gt;&lt;/code&gt; ä¸‰å…ƒç»„å»é‡ï¼Œç¡®ä¿å•åˆ†åŒºå†…æ— é‡å¤å†™å…¥&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;äº‹åŠ¡ï¼ˆTransactionsï¼‰&lt;/strong&gt;ï¼šè·¨åˆ†åŒºçš„å†™å…¥ä¸æ¶ˆè´¹åç§»é‡æäº¤ï¼ˆsendOffsetsToTransactionï¼‰ç»‘å®šä¸ºåŸå­æ“ä½œï¼Œä¿è¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; - æ‰€æœ‰æ¶ˆæ¯å†™å…¥æˆåŠŸ + åç§»é‡æäº¤ â‡’ äº‹åŠ¡æäº¤
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä»»ä¸€å¤±è´¥ â‡’ äº‹åŠ¡å›æ»š&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Brokerç«¯&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡åè°ƒå™¨è®°å½•çŠ¶æ€ï¼Œé€šè¿‡ &lt;code&gt;read_committed&lt;/code&gt; éš”ç¦»çº§åˆ«ï¼Œæ¶ˆè´¹è€…ä»…è¯»å–å·²æäº¤äº‹åŠ¡çš„æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¶ˆè´¹ç«¯&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Kafkaå†…éƒ¨é—­ç¯&lt;/strong&gt;ï¼šè‹¥æ¶ˆè´¹é€»è¾‘å®Œå…¨åœ¨Kafkaäº‹åŠ¡å†…ï¼ˆå¦‚Kafka Streamsæµå¤„ç†ï¼‰ï¼Œåˆ™åç§»é‡æäº¤ä¸æ¶ˆæ¯å¤„ç†åŸå­ç»‘å®šï¼Œæ— éœ€ä¸šåŠ¡å±‚å¹‚ç­‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶‰åŠå¤–éƒ¨ç³»ç»Ÿ&lt;/strong&gt;ï¼šè‹¥å¤„ç†ç»“æœéœ€å†™å…¥æ•°æ®åº“ã€Redisç­‰å¤–éƒ¨å­˜å‚¨ï¼Œåˆ™åç§»é‡æäº¤ä¸å¤–éƒ¨å†™å…¥&lt;strong&gt;æ— æ³•åŸå­åŒ–&lt;/strong&gt;ï¼Œå¯èƒ½å› å´©æºƒå¯¼è‡´é‡å¤æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;1,4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ºä½•æ¶ˆè´¹ç«¯ä»éœ€ä¸šåŠ¡å¹‚ç­‰æ€§"&gt;âš ï¸ ä¸ºä½•æ¶ˆè´¹ç«¯ä»éœ€ä¸šåŠ¡å¹‚ç­‰æ€§ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;å³ä½¿Kafkaäº‹åŠ¡ä¿éšœäº†æ¶ˆæ¯åœ¨Brokerå†…çš„Exactly-Onceï¼Œä»¥ä¸‹åœºæ™¯ä»å¯èƒ½å¯¼è‡´æ¶ˆè´¹ç«¯é‡å¤å¤„ç†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åç§»é‡æäº¤ä¸å¤–éƒ¨å†™å…¥çš„å‰²è£‚&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥æ¶ˆè´¹ç«¯å®Œæˆå¤–éƒ¨å†™å…¥åã€äº‹åŠ¡æäº¤å‰å´©æºƒï¼Œé‡å¯åä¼šé‡æ–°æ¶ˆè´¹å¹¶é‡å¤å†™å…¥å¤–éƒ¨ç³»ç»Ÿ&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;ä¾‹å¦‚&lt;/em&gt;ï¼šæ¶ˆè´¹æ¶ˆæ¯ â†’ å†™å…¥MySQL â†’ Kafkaäº‹åŠ¡æœªæäº¤ â†’ å´©æºƒ â†’ é‡å¯åé‡å¤æ¶ˆè´¹å¹¶å†æ¬¡å†™å…¥MySQLã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kafkaäº‹åŠ¡çš„è¶…æ—¶ä¸é‡è¯•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡è¶…æ—¶ï¼ˆé»˜è®¤1åˆ†é’Ÿï¼‰æˆ–ç½‘ç»œæ³¢åŠ¨å¯èƒ½å¯¼è‡´äº‹åŠ¡å›æ»šï¼Œä½†å¤–éƒ¨ç³»ç»Ÿå·²æ‰§è¡ŒæˆåŠŸï¼Œé‡è¯•æ—¶é€ æˆé‡å¤&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…ç»„å†å‡è¡¡ï¼ˆRebalanceï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†åŒºé‡åˆ†é…æ—¶ï¼Œæ–°æ¶ˆè´¹è€…å¯èƒ½ä»æ—§åç§»é‡å¼€å§‹æ¶ˆè´¹ï¼Œå¯¼è‡´å·²å¤„ç†ä½†æœªæäº¤åç§»é‡çš„æ¶ˆæ¯è¢«äºŒæ¬¡æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸šåŠ¡å±‚å¹‚ç­‰æ€§è®¾è®¡å»ºè®®"&gt;ğŸ›¡ï¸ ä¸šåŠ¡å±‚å¹‚ç­‰æ€§è®¾è®¡å»ºè®®
&lt;/h3&gt;&lt;p&gt;ä¸ºå½»åº•è§£å†³å¤–éƒ¨ç³»ç»Ÿé‡å¤å†™å…¥é—®é¢˜ï¼Œéœ€åœ¨æ¶ˆè´¹ç«¯å®ç°ä¸šåŠ¡é€»è¾‘çš„å¹‚ç­‰æ€§ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¹‚ç­‰ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å”¯ä¸€é”®çº¦æŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“å¯¹ä¸šåŠ¡ä¸»é”®ï¼ˆå¦‚è®¢å•IDï¼‰è®¾ç½®å”¯ä¸€ç´¢å¼•ï¼Œé‡å¤å†™å…¥è‡ªåŠ¨å¤±è´¥&lt;/td&gt;
&lt;td&gt;è®¢å•ã€æ”¯ä»˜ç­‰æœ‰å”¯ä¸€æ ‡è¯†çš„ä¸šåŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¹è§‚é”/ç‰ˆæœ¬å·&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ›´æ–°æ•°æ®å‰æ£€æŸ¥ç‰ˆæœ¬å·ï¼Œä»…å½“ç‰ˆæœ¬åŒ¹é…æ—¶æ‰§è¡Œæ›´æ–°&lt;/td&gt;
&lt;td&gt;åº“å­˜æ‰£å‡ã€è´¦æˆ·ä½™é¢å˜æ›´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çŠ¶æ€æœºæ ¡éªŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡æ•°æ®å¢åŠ çŠ¶æ€å­—æ®µï¼ˆå¦‚&lt;code&gt;å·²å¤„ç†&lt;/code&gt;ï¼‰ï¼Œä»…å½“çŠ¶æ€ä¸ºåˆå§‹å€¼æ—¶æ‰§è¡Œæ“ä½œ&lt;/td&gt;
&lt;td&gt;å·¥ä½œæµå®¡æ‰¹ã€ä»»åŠ¡çŠ¶æ€æµè½¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å»é‡è¡¨/Redisç¼“å­˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆè´¹å‰æŸ¥è¯¢Redisæˆ–å»é‡è¡¨ï¼Œè‹¥å­˜åœ¨ç›¸åŒIDåˆ™è·³è¿‡å¤„ç†&lt;/td&gt;
&lt;td&gt;é«˜é¢‘ä¸”å®¹å¿çŸ­æš‚æ•°æ®ä¸ä¸€è‡´çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;em&gt;ä»£ç ç¤ºä¾‹ï¼ˆè®¢å•å¤„ç†å¹‚ç­‰æ€§ï¼‰ï¼š&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ¶ˆè´¹æ¶ˆæ¯æ—¶æ£€æŸ¥è®¢å•æ˜¯å¦å·²å¤„ç†
if (!orderService.isOrderProcessed(orderId)) {
orderService.processOrder(order); // å¤„ç†è®¢å•
kafkaProducer.sendOffsetsToTransaction(offsets, groupId); // æäº¤åç§»é‡
producer.commitTransaction();
} else {
log.warn(&amp;#34;è®¢å•å·²å¤„ç†ï¼Œè·³è¿‡é‡å¤æ¶ˆè´¹: {}&amp;#34;, orderId);
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“exactly-onceçš„å®Œæ•´æ¡ä»¶"&gt;ğŸ’ æ€»ç»“ï¼šExactly-Onceçš„å®Œæ•´æ¡ä»¶
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Kafkaå†…éƒ¨é—­ç¯&lt;/strong&gt;ï¼ˆå¦‚Kafkaâ†’Kafka Streamsâ†’Kafkaï¼‰ï¼š
æ— éœ€ä¸šåŠ¡å±‚å¹‚ç­‰ï¼Œäº‹åŠ¡æœºåˆ¶å¯ä¿éšœç«¯åˆ°ç«¯Exactly-Once&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶‰åŠå¤–éƒ¨ç³»ç»Ÿ&lt;/strong&gt;ï¼ˆå¦‚Kafkaâ†’æ•°æ®åº“ï¼‰ï¼š
â€‹&lt;strong&gt;å¿…é¡»é€šè¿‡ä¸šåŠ¡å±‚å¹‚ç­‰æ€§å…œåº•&lt;/strong&gt;ï¼Œå› Kafkaäº‹åŠ¡æ— æ³•è¦†ç›–å¤–éƒ¨æ“ä½œåŸå­æ€§&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼šé‡‘èçº§ç³»ç»Ÿæ¨èç»„åˆæ–¹æ¡ˆâ€”â€”
&lt;code&gt;Kafkaäº‹åŠ¡ï¼ˆenable.idempotence + transactional.idï¼‰ + æ¶ˆè´¹ç«¯éš”ç¦»çº§åˆ«ï¼ˆread_committedï¼‰ + ä¸šåŠ¡å¹‚ç­‰æ€§&lt;/code&gt;&lt;a class="link" href="@ref" &gt;6,7,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¤štopic"&gt;å¤šTopic
&lt;/h2&gt;&lt;p&gt;Kafka åœ¨ Topic æ•°é‡è¿‡å¤šæ—¶æ€§èƒ½æ˜¾è‘—ä¸‹é™ï¼Œä¸»è¦æºäºå…¶æ¶æ„è®¾è®¡ä¸­å¯¹èµ„æºç®¡ç†å’Œå…ƒæ•°æ®å¤„ç†çš„æœºåˆ¶ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒåŸå› åŠæŠ€æœ¯ç»†èŠ‚åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å…ƒæ•°æ®ç®¡ç†å¼€é”€æ¿€å¢"&gt;âš™ï¸ &lt;strong&gt;å…ƒæ•°æ®ç®¡ç†å¼€é”€æ¿€å¢&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ZooKeeper/KRaft å‹åŠ›&lt;/strong&gt;ï¼š
Kafka ä¾èµ– ZooKeeperï¼ˆæˆ– KRaft æ¨¡å¼ï¼‰å­˜å‚¨ Topicã€åˆ†åŒºã€ISR çŠ¶æ€ç­‰å…ƒæ•°æ®ã€‚æ¯ä¸ª Topic åŠå…¶åˆ†åŒºä¼šåœ¨å…ƒæ•°æ®å­˜å‚¨ä¸­ç”Ÿæˆå¤šä¸ªèŠ‚ç‚¹ï¼ˆå¦‚åˆ†åŒºçŠ¶æ€ã€æ¶ˆè´¹è€…åç§»é‡ï¼‰ã€‚Topic æ•°é‡å¢åŠ æ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;ZooKeeper çš„è¯»å†™è´Ÿè½½æŒ‡æ•°çº§å¢é•¿ï¼Œæˆä¸ºç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;KRaft æ¨¡å¼ä¸‹è™½å‡å°‘å¤–éƒ¨ä¾èµ–ï¼Œä½† Controller èŠ‚ç‚¹ä»éœ€å¤„ç†æµ·é‡å…ƒæ•°æ®åŒæ­¥ï¼Œå¯¼è‡´é€‰ä¸¾å»¶è¿Ÿå’Œå…ƒæ•°æ®ä¼ æ’­å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Broker å…ƒæ•°æ®åŒæ­¥&lt;/strong&gt;ï¼š
æ¯ä¸ª Broker éœ€å®šæœŸä» Controller æ‹‰å–å…¨é‡å…ƒæ•°æ®ã€‚Topic è¿‡å¤šæ—¶ï¼Œå…ƒæ•°æ®ä½“ç§¯è†¨èƒ€ï¼ˆå¦‚è¶…è¿‡ 100MBï¼‰ï¼Œå¯¼è‡´ç½‘ç»œå¸¦å®½æ¶ˆè€—å‰§å¢å’ŒåŒæ­¥å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ–‡ä»¶ç³»ç»Ÿä¸-io-æ€§èƒ½é€€åŒ–"&gt;ğŸ“ &lt;strong&gt;æ–‡ä»¶ç³»ç»Ÿä¸ I/O æ€§èƒ½é€€åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶å¥æŸ„è€—å°½é£é™©&lt;/strong&gt;ï¼š
æ¯ä¸ª Topic åˆ†åŒºå¯¹åº”ç‹¬ç«‹çš„æ—¥å¿—æ®µæ–‡ä»¶ï¼ˆSegmentï¼‰ã€‚1 ä¸‡ä¸ª Topicï¼ˆæ¯ä¸ª 1 åˆ†åŒºï¼‰å¯èƒ½äº§ç”Ÿæ•°ä¸‡ä¸ªæ–‡ä»¶ï¼Œè¿…é€Ÿè€—å°½æ“ä½œç³»ç»Ÿæ–‡ä»¶å¥æŸ„é™åˆ¶ï¼ˆé»˜è®¤ä»… 10 ä¸‡ï¼‰&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç£ç›˜ I/O ä»é¡ºåºå†™é€€åŒ–ä¸ºéšæœºå†™ï¼š
Kafka ä¾èµ–é¡ºåºç£ç›˜ I/Oå®ç°é«˜ååã€‚ä½† Topic è¿‡å¤šæ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸åŒ Topic çš„åˆ†åŒºæ—¥å¿—åˆ†æ•£å­˜å‚¨ï¼Œç‰©ç†ç£ç›˜ç£å¤´é¢‘ç¹å¯»é“ï¼›&lt;/li&gt;
&lt;li&gt;å°¤å…¶æ˜¯æœºæ¢°ç¡¬ç›˜ï¼ˆHDDï¼‰åœºæ™¯ï¼Œéšæœº I/O æ€§èƒ½éª¤é™&lt;a class="link" href="@ref" &gt;2,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”å®éªŒ&lt;/strong&gt;ï¼šå½“ Topic ä» 64 å¢è‡³ 256 æ—¶ï¼ŒKafka ååé‡ä¸‹é™ &lt;strong&gt;98%&lt;/strong&gt;ï¼Œè€Œ RocketMQï¼ˆå…±äº« CommitLogï¼‰ä»…é™ 16%&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å­˜ä¸-gc-å‹åŠ›åŠ å‰§"&gt;ğŸ’¾ &lt;strong&gt;å†…å­˜ä¸ GC å‹åŠ›åŠ å‰§&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;PageCache ç«äº‰ï¼š
Kafka åˆ©ç”¨ PageCache åŠ é€Ÿè¯»å†™ï¼Œæ¯ä¸ªåˆ†åŒºéœ€ç‹¬ç«‹ç¼“å­˜ã€‚Topic è¿‡å¤šæ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;å†…å­˜ç¢ç‰‡åŒ–ï¼ŒPageCache å‘½ä¸­ç‡ä¸‹é™ï¼›&lt;/li&gt;
&lt;li&gt;é¢‘ç¹çš„æ—¥å¿—æ®µåˆ‡æ¢å¯¼è‡´å†…å­˜æŠ–åŠ¨&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åƒåœ¾å›æ”¶ï¼ˆGCï¼‰é£æš´&lt;/strong&gt;ï¼š
æµ·é‡åˆ†åŒºå¼•å‘æ›´å¤šåå°çº¿ç¨‹ï¼ˆå¦‚å¤åˆ¶ã€Flush çº¿ç¨‹ï¼‰ï¼Œå¯¹è±¡åˆ›å»ºé¢‘ç¹ã€‚JVM Full GC åœé¡¿æ—¶é—´å¢é•¿ï¼Œå¯¼è‡´ Broker å“åº”å»¶è¿Ÿæ³¢åŠ¨&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®¢æˆ·ç«¯ä¸ç½‘ç»œè´Ÿè½½ä¸Šå‡"&gt;ğŸ“¡ &lt;strong&gt;å®¢æˆ·ç«¯ä¸ç½‘ç»œè´Ÿè½½ä¸Šå‡&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯åˆå§‹åŒ–å¡é¡¿&lt;/strong&gt;ï¼š
ç”Ÿäº§è€…/æ¶ˆè´¹è€…å¯åŠ¨æ—¶éœ€åŠ è½½å…¨é‡å…ƒæ•°æ®ã€‚Topic è¿‡å¤šæ—¶ï¼Œå®¢æˆ·ç«¯åˆå§‹åŒ–è€—æ—¶ä»æ¯«ç§’çº§å¢è‡³ç§’çº§ï¼Œç”šè‡³è¶…æ—¶&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†å¹³è¡¡ï¼ˆRebalanceï¼‰è€—æ—¶å‰§å¢&lt;/strong&gt;ï¼š
æ¶ˆè´¹è€…ç»„éœ€åè°ƒæ‰€æœ‰åˆ†åŒºçš„åˆ†é…ã€‚Topic å¢å¤šæ—¶ï¼Œå†å¹³è¡¡ç®—æ³•å¤æ‚åº¦ä¸Šå‡ï¼Œä¾‹å¦‚ä¸‡çº§åˆ†åŒºå¯èƒ½å¯¼è‡´åˆ†é’Ÿçº§åœé¡¿&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-kafka-ä¸-rocketmq-çš„æ¶æ„å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;Kafka ä¸ RocketMQ çš„æ¶æ„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è®¾è®¡ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒæ•°æ®ç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é›†ä¸­å¼ï¼ˆZooKeeper/KRaftï¼‰ï¼Œæ˜“æˆç“¶é¢ˆ&lt;/td&gt;
&lt;td&gt;è½»é‡åŒ–ï¼ˆNameServer + Broker è‡ªæ²»ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨æ¨¡å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†åŒºç‹¬ç«‹æ–‡ä»¶ â†’ I/O éšæœºåŒ–&lt;/td&gt;
&lt;td&gt;å…±äº« CommitLog + é€»è¾‘é˜Ÿåˆ— â†’ é¡ºåº I/O&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºéš”ç¦»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†åŒºå ç”¨ç‹¬ç«‹å¥æŸ„/ç¼“å­˜&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰ Topic å…±äº«æ–‡ä»¶ä¸ MMap å†…å­˜&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†åŒºæ•°é™åˆ¶ï¼ˆå• Broker â‰¤1 ä¸‡ï¼‰&lt;/td&gt;
&lt;td&gt;æ”¯æŒç™¾ä¸‡çº§ Topic&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–å»ºè®®"&gt;ğŸ› ï¸ &lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆå¹¶ Topic&lt;/strong&gt;ï¼š
å°†ç›¸ä¼¼æ•°æ®å†™å…¥åŒä¸€ Topicï¼Œé€šè¿‡æ¶ˆæ¯ Key æˆ– Header åŒºåˆ†é€»è¾‘ï¼Œå‡å°‘ç‰©ç†åˆ†åŒºæ•°&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ç”¨æ—¥å¿—å‹ç¼©ï¼ˆLog Compactionï¼‰&lt;/strong&gt;ï¼š
å¯¹ Key-Value å‹æ•°æ®å¯ç”¨ &lt;code&gt;cleanup.policy=compact&lt;/code&gt;ï¼Œå‡å°‘å­˜å‚¨ä¸ I/O å‹åŠ›&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒæ•´åˆ†åŒºæ•°ä¸é›†ç¾¤è§„æ¨¡ï¼š
&lt;ul&gt;
&lt;li&gt;å• Broker åˆ†åŒºæ•°æ§åˆ¶åœ¨ &lt;strong&gt;4,000â€“10,000&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;é€šè¿‡å¢åŠ  Broker åˆ†æ•£è´Ÿè½½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‡çº§ç¡¬ä»¶ä¸é…ç½®ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ SSD ç£ç›˜è§„é¿éšæœº I/O ç“¶é¢ˆï¼›&lt;/li&gt;
&lt;li&gt;è°ƒå¤§ OS æ–‡ä»¶å¥æŸ„é™åˆ¶ï¼ˆ&lt;code&gt;fs.file-max&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç§»è‡³ KRaft æ¨¡å¼&lt;/strong&gt;ï¼š
å‡å°‘ ZooKeeper ä¾èµ–ï¼Œæå‡å…ƒæ•°æ®åŒæ­¥æ•ˆç‡&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Kafka çš„ Topic æ€§èƒ½ç“¶é¢ˆæœ¬è´¨æ˜¯&lt;strong&gt;æ¶æ„è®¾è®¡&lt;/strong&gt;ä¸&lt;strong&gt;èµ„æºæ¨¡å‹&lt;/strong&gt;çš„æƒè¡¡ï¼šå…¶åˆ†åŒºç‹¬ç«‹å­˜å‚¨å’Œé›†ä¸­å¼å…ƒæ•°æ®ç®¡ç†ï¼Œåœ¨ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ä¸éš”ç¦»æ€§çš„åŒæ—¶ï¼Œç‰ºç‰²äº†æµ·é‡ Topic åœºæ™¯çš„æ‰©å±•æ€§ã€‚è‹¥ä¸šåŠ¡éœ€é«˜é¢‘åˆ›å»º Topicï¼ˆå¦‚å¤šç§Ÿæˆ·æ—¥å¿—æ”¶é›†ï¼‰ï¼Œå¯è¯„ä¼° RocketMQ æˆ– Pulsarï¼›è‹¥éœ€æµå¤„ç†ç”Ÿæ€ï¼Œåˆ™é€šè¿‡åˆå¹¶ Topicã€åˆ†åŒºä¼˜åŒ–ä¸ç¡¬ä»¶å‡çº§ç¼“è§£ Kafka ç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;5,6,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="é«˜å¯ç”¨"&gt;é«˜å¯ç”¨
&lt;/h2&gt;&lt;p&gt;Kafka çš„é«˜å¯ç”¨æ€§ï¼ˆHigh Availability, HAï¼‰æ˜¯å…¶ä½œä¸ºåˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿçš„æ ¸å¿ƒèƒ½åŠ›ï¼Œç¡®ä¿åœ¨èŠ‚ç‚¹æ•…éšœã€ç½‘ç»œåˆ†åŒºç­‰å¼‚å¸¸æƒ…å†µä¸‹ä»èƒ½æŒç»­æä¾›æœåŠ¡ä¸”æ•°æ®ä¸ä¸¢å¤±ã€‚å…¶é«˜å¯ç”¨è®¾è®¡ä¸»è¦ä¾èµ–ä»¥ä¸‹æœºåˆ¶ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®å¤åˆ¶ä¸å‰¯æœ¬æœºåˆ¶replication"&gt;ğŸ”§ &lt;strong&gt;æ•°æ®å¤åˆ¶ä¸å‰¯æœ¬æœºåˆ¶ï¼ˆReplicationï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒºï¼ˆPartitionï¼‰ä¸å‰¯æœ¬ï¼ˆReplicaï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒº&lt;/strong&gt;ï¼šTopic è¢«åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼Œå®ç°å¹¶è¡Œå¤„ç†å’Œè´Ÿè½½å‡è¡¡ã€‚&lt;/li&gt;
&lt;li&gt;å‰¯æœ¬ï¼šæ¯ä¸ªåˆ†åŒºé…ç½®å¤šä¸ªå‰¯æœ¬ï¼ˆç”±
&lt;pre tabindex="0"&gt;&lt;code&gt;replication.factor
&lt;/code&gt;&lt;/pre&gt;æ§åˆ¶ï¼Œé»˜è®¤3ï¼‰ï¼Œåˆ†å¸ƒåœ¨ä¸åŒçš„ Broker ä¸Šã€‚å‰¯æœ¬åˆ†ä¸ºï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Leader å‰¯æœ¬&lt;/strong&gt;ï¼šå¤„ç†æ‰€æœ‰è¯»å†™è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Follower å‰¯æœ¬&lt;/strong&gt;ï¼šä» Leader å¼‚æ­¥/åŒæ­¥å¤åˆ¶æ•°æ®ï¼Œä¸ç›´æ¥æœåŠ¡å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šå•èŠ‚ç‚¹æ•…éšœæ—¶ï¼Œå…¶ä»–å‰¯æœ¬å¯æ¥ç®¡æœåŠ¡ï¼Œé¿å…æ•°æ®ä¸¢å¤±&lt;a class="link" href="@ref" &gt;1,3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ISR æœºåˆ¶ï¼ˆIn-Sync Replicasï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥å‰¯æœ¬é›†åˆ&lt;/strong&gt;ï¼šLeader åŠ¨æ€ç»´æŠ¤ä¸å…¶æ•°æ®åŒæ­¥çš„ Follower å‰¯æœ¬åˆ—è¡¨ï¼ˆISRï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥æ¡ä»¶&lt;/strong&gt;ï¼šFollower éœ€åœ¨ &lt;code&gt;replica.lag.time.max.ms&lt;/code&gt;ï¼ˆé»˜è®¤30ç§’ï¼‰å†…ä¸ Leader ä¿æŒåŒæ­¥ï¼Œå¦åˆ™è¢«è¸¢å‡º ISR&lt;a class="link" href="@ref" &gt;1,5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ä¸¾èµ„æ ¼&lt;/strong&gt;ï¼šåªæœ‰ ISR ä¸­çš„å‰¯æœ¬å¯è¢«é€‰ä¸¾ä¸ºæ–° Leaderï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;3,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ•…éšœæ£€æµ‹ä¸è‡ªåŠ¨è½¬ç§»failover"&gt;âš™ï¸ &lt;strong&gt;æ•…éšœæ£€æµ‹ä¸è‡ªåŠ¨è½¬ç§»ï¼ˆFailoverï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœæ£€æµ‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ZooKeeper/KRaft ååŒ&lt;/strong&gt;ï¼šæ—©æœŸä¾èµ– ZooKeeper ç›‘æ§ Broker çŠ¶æ€ï¼›æ–°ç‰ˆ Kafka æ”¯æŒ KRaft æ¨¡å¼ï¼ˆå» ZooKeeper ä¾èµ–ï¼‰ï¼Œé€šè¿‡ Raft åè®®ç®¡ç†é›†ç¾¤å…ƒæ•°æ®&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Controller è§’è‰²&lt;/strong&gt;ï¼šé›†ç¾¤ä¸­é€‰ä¸¾ä¸€ä¸ª Broker ä½œä¸º Controllerï¼Œè´Ÿè´£ç›‘æ§èŠ‚ç‚¹çŠ¶æ€å¹¶è§¦å‘æ•…éšœæ¢å¤&lt;a class="link" href="@ref" &gt;3,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Leader è‡ªåŠ¨é€‰ä¸¾&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“ Leader å‰¯æœ¬æ‰€åœ¨ Broker å®•æœºæ—¶ï¼ŒController ä» ISR ä¸­é€‰ä¸¾æ–° Leaderã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ä¸¾ç­–ç•¥&lt;/strong&gt;ï¼šä¼˜å…ˆé€‰æ‹©æ•°æ®æœ€æ–°çš„å‰¯æœ¬ï¼Œé¿å…æ•°æ®ä¸¢å¤±&lt;a class="link" href="@ref" &gt;1,5,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯é‡å®šå‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§è€…/æ¶ˆè´¹è€…é€šè¿‡å…ƒæ•°æ®æ›´æ–°è‡ªåŠ¨å‘ç°æ–° Leaderï¼Œå¹¶é‡å®šå‘è¯·æ±‚ï¼ˆéœ€é…ç½® &lt;code&gt;bootstrap.servers&lt;/code&gt; ä¸ºå¤šä¸ª Broker åœ°å€ï¼‰&lt;a class="link" href="@ref" &gt;10,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®å¯é æ€§ä¿éšœæœºåˆ¶"&gt;ğŸ›¡ï¸ &lt;strong&gt;æ•°æ®å¯é æ€§ä¿éšœæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€… ACK æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;acks
&lt;/code&gt;&lt;/pre&gt;å‚æ•°æ§åˆ¶æ¶ˆæ¯æŒä¹…åŒ–å¼ºåº¦ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ACK çº§åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®å¯é æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;acks=0&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½ä¸¢å¤±&lt;/td&gt;
&lt;td&gt;æœ€é«˜&lt;/td&gt;
&lt;td&gt;æ—¥å¿—æ”¶é›†ç­‰ä½å¯é æ€§éœ€æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;acks=1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Leader å†™å…¥åç¡®è®¤&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰&lt;/td&gt;
&lt;td&gt;å¹³è¡¡å¯é æ€§ä¸åå&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;acks=all&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éœ€æ‰€æœ‰ ISR å‰¯æœ¬ç¡®è®¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ä½&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é‡‘èäº¤æ˜“ç­‰é«˜å¯é æ€§åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›¶ä¸¢å¤±æ¡ä»¶&lt;/strong&gt;ï¼š&lt;code&gt;acks=all&lt;/code&gt; + &lt;code&gt;min.insync.replicasâ‰¥2&lt;/code&gt; + &lt;code&gt;replication.factorâ‰¥3&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æŒä¹…åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºå†™ç£ç›˜&lt;/strong&gt;ï¼šæ¶ˆæ¯è¿½åŠ åˆ°æ—¥å¿—æ–‡ä»¶ï¼ˆSegmentï¼‰å°¾éƒ¨ï¼Œåˆ©ç”¨ç£ç›˜é¡ºåºå†™çš„é«˜æ€§èƒ½ç‰¹æ€§&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åˆ·ç›˜ç­–ç•¥ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥åˆ·ç›˜&lt;/strong&gt;ï¼šé«˜æ€§èƒ½ï¼Œå®•æœºå¯èƒ½ä¸¢å¤±å°‘é‡æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥åˆ·ç›˜&lt;/strong&gt;ï¼šæ¯ç¬”å†™å…¥å¼ºåˆ¶åˆ·ç›˜ï¼Œå¯é æ€§é«˜ä½†æ€§èƒ½ä½&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…ä½ç§»ç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…å®šæœŸæäº¤åç§»é‡ï¼ˆOffsetï¼‰åˆ° &lt;code&gt;__consumer_offsets&lt;/code&gt; Topicï¼Œæ•…éšœæ¢å¤åå¯ä»æ–­ç‚¹ç»§ç»­æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;9,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜å¯ç”¨é›†ç¾¤è®¾è®¡å®è·µ"&gt;ğŸŒ &lt;strong&gt;é«˜å¯ç”¨é›†ç¾¤è®¾è®¡å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éƒ¨ç½²æ¶æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Broker æ•°é‡&lt;/strong&gt;ï¼šè‡³å°‘ 3 èŠ‚ç‚¹ï¼Œè·¨æœºæ¶/å¯ç”¨åŒºéƒ¨ç½²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‰¯æœ¬åˆ†å¸ƒ&lt;/strong&gt;ï¼šå‰¯æœ¬åˆ†æ•£åœ¨ä¸åŒç‰©ç†èŠ‚ç‚¹ï¼ˆå¦‚ &lt;code&gt;broker.rack&lt;/code&gt; é…ç½®æœºæ¶æ„ŸçŸ¥ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®å‚æ•°é…ç½®&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èå€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;replication.factor&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;æ¯ä¸ªåˆ†åŒºçš„å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;min.insync.replicas&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;æœ€å°åŒæ­¥å‰¯æœ¬æ•°ï¼Œä¿éšœå†™å…¥å¯é æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;unclean.leader.election.enable&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç¦æ­¢é ISR å‰¯æœ¬æˆä¸º Leaderï¼Œé¿å…æ•°æ®ä¸¢å¤±&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;default.replication.factor&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;é»˜è®¤å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨æ•°æ®ä¸­å¿ƒå®¹ç¾&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MirrorMaker å·¥å…·&lt;/strong&gt;ï¼šå°†æ•°æ®å¼‚æ­¥å¤åˆ¶åˆ°å¼‚åœ°é›†ç¾¤ï¼Œå®ç°å¼‚åœ°å¤šæ´»&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜å¯ç”¨å±€é™æ€§åŠåº”å¯¹"&gt;âš ï¸ &lt;strong&gt;é«˜å¯ç”¨å±€é™æ€§åŠåº”å¯¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è„‘è£‚é—®é¢˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šç½‘ç»œåˆ†åŒºå¯¼è‡´å¤šä¸ª Broker è‡ªè®¤ Controllerã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šKRaft æ¨¡å¼é€šè¿‡ Raft å…±è¯†ç®—æ³•é¿å…è„‘è£‚&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ISR æ”¶ç¼©é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šè‹¥æ‰€æœ‰ Follower å‡è¢«è¸¢å‡º ISRï¼ŒLeader å•ç‚¹å†™å…¥å¯èƒ½ä¸¢å¤±æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§&lt;/strong&gt;ï¼šå®æ—¶ç›‘æ§ ISR å¤§å°ï¼Œå‘Šè­¦é˜ˆå€¼è®¾ä¸º &lt;code&gt;min.insync.replicas+1&lt;/code&gt;&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Rebalance å½±å“&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…ç»„ Rebalance å¯¼è‡´æ¶ˆè´¹æš‚åœã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;StickyAssignor&lt;/code&gt; åˆ†é…ç­–ç•¥å‡å°‘åˆ†åŒºéœ‡è¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è®¾ç½®é™æ€ &lt;code&gt;group.instance.id&lt;/code&gt; é¿å…é‡å¯è§¦å‘ Rebalance&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Kafka çš„é«˜å¯ç”¨æ€§å»ºç«‹åœ¨ &lt;strong&gt;åˆ†å¸ƒå¼å‰¯æœ¬&lt;/strong&gt;ã€&lt;strong&gt;æ™ºèƒ½æ•…éšœè½¬ç§»&lt;/strong&gt; å’Œ &lt;strong&gt;å¼ºä¸€è‡´æ€§æœºåˆ¶&lt;/strong&gt; ä¹‹ä¸Šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å±‚&lt;/strong&gt;ï¼šå¤šå‰¯æœ¬ + ISR ä¿éšœå†—ä½™ä¸ä¸€è‡´æ€§ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶å±‚&lt;/strong&gt;ï¼šController è‡ªåŠ¨é€‰ä¸¾ä¸æ•…éšœæ¢å¤ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯&lt;/strong&gt;ï¼šACK æœºåˆ¶ä¸ä½ç§»ç®¡ç†å®ç°ç«¯åˆ°ç«¯å¯é æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼šç”Ÿäº§ç¯å¢ƒåŠ¡å¿…é…ç½® &lt;code&gt;acks=all&lt;/code&gt; + &lt;code&gt;min.insync.replicas=2&lt;/code&gt; + ç¦ç”¨ &lt;code&gt;unclean.leader.election&lt;/code&gt;ï¼Œå¹¶ç»“åˆè·¨é›†ç¾¤å¤åˆ¶åº”å¯¹ç¾éš¾æ€§æ•…éšœ&lt;a class="link" href="@ref" &gt;1,5,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="åˆ é™¤"&gt;åˆ é™¤
&lt;/h2&gt;&lt;p&gt;Kafka ä¸­çš„æ•°æ®&lt;strong&gt;ä¸ä¼šåœ¨æ¶ˆè´¹åè¢«ç›´æ¥åˆ é™¤&lt;/strong&gt;ï¼Œå…¶å­˜å‚¨ç­–ç•¥ä¸æ¶ˆè´¹è¡Œä¸ºæ— å…³ï¼Œè€Œæ˜¯ç”±é…ç½®çš„&lt;strong&gt;æ—¥å¿—ä¿ç•™ç­–ç•¥&lt;/strong&gt;å†³å®šã€‚ä»¥ä¸‹æ˜¯ Kafka æ•°æ®å­˜å‚¨ä¸æ¸…ç†çš„æ ¸å¿ƒæœºåˆ¶ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®ä¿ç•™ç­–ç•¥log-retention-policy"&gt;âš™ï¸ &lt;strong&gt;æ•°æ®ä¿ç•™ç­–ç•¥ï¼ˆLog Retention Policyï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Kafka çš„æ•°æ®æ¸…ç†å®Œå…¨ä¾èµ–äºé¢„å…ˆé…ç½®çš„ç­–ç•¥ï¼Œè€Œéæ¶ˆè´¹è¡Œä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºäºæ—¶é—´ä¿ç•™&lt;/strong&gt;ï¼š
é€šè¿‡ &lt;code&gt;log.retention.hours&lt;/code&gt;ï¼ˆé»˜è®¤ 168 å°æ—¶ï¼Œå³ 7 å¤©ï¼‰æ§åˆ¶æ¶ˆæ¯ä¿ç•™æ—¶é•¿ï¼Œè¿‡æœŸåè‡ªåŠ¨åˆ é™¤&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºäºå¤§å°ä¿ç•™&lt;/strong&gt;ï¼š
é€šè¿‡ &lt;code&gt;log.retention.bytes&lt;/code&gt; é™åˆ¶å•ä¸ªåˆ†åŒºçš„æ—¥å¿—æ€»å¤§å°ï¼ˆé»˜è®¤ &lt;code&gt;-1&lt;/code&gt; æ— é™åˆ¶ï¼‰ï¼Œè¶…é™æ—¶åˆ é™¤æœ€æ—§çš„æ•°æ®&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—å‹ç¼©ï¼ˆLog Compactionï¼‰&lt;/strong&gt;ï¼š
å¯¹ç›¸åŒ Key çš„æ¶ˆæ¯ï¼Œä»…ä¿ç•™æœ€æ–°å€¼ï¼ˆé€‚ç”¨äºçŠ¶æ€æ›´æ–°åœºæ™¯ï¼‰ã€‚é…ç½® &lt;code&gt;cleanup.policy=compact&lt;/code&gt; å¯ç”¨&lt;a class="link" href="@ref" &gt;6,7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;ç‰¹æ®Šæ¡ˆä¾‹&lt;/strong&gt;ï¼šå†…éƒ¨ Topicï¼ˆå¦‚ &lt;code&gt;__consumer_offsets&lt;/code&gt;ï¼‰é»˜è®¤å¯ç”¨å‹ç¼©ç­–ç•¥ï¼Œä¿ç•™æ¶ˆè´¹è€…ç»„ä½ç§»ä¿¡æ¯&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ é™¤æœºåˆ¶ä¸è§¦å‘æ¡ä»¶"&gt;ğŸ—‘ï¸ &lt;strong&gt;åˆ é™¤æœºåˆ¶ä¸è§¦å‘æ¡ä»¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ é™¤å•ä½&lt;/strong&gt;ï¼šä»¥ &lt;strong&gt;æ—¥å¿—æ®µï¼ˆSegmentï¼‰&lt;/strong&gt; ä¸ºå•ä½æ‰¹é‡åˆ é™¤ï¼Œè€Œéå•æ¡æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§¦å‘æ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šæ—¶ä»»åŠ¡&lt;/strong&gt;ï¼šæ¯ 5 åˆ†é’Ÿï¼ˆ&lt;code&gt;log.retention.check.interval.ms&lt;/code&gt;ï¼‰æ£€æŸ¥è¿‡æœŸæˆ–è¶…é™çš„ Segment&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‹ç¼©çº¿ç¨‹&lt;/strong&gt;ï¼šå¯¹å¯ç”¨å‹ç¼©çš„ Topicï¼Œåå°çº¿ç¨‹åˆå¹¶é‡å¤ Key çš„æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ºä½•æ— æ³•ç›´æ¥åˆ é™¤å•æ¡æ¶ˆæ¯"&gt;âš ï¸ &lt;strong&gt;ä¸ºä½•æ— æ³•ç›´æ¥åˆ é™¤å•æ¡æ¶ˆæ¯ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡åŸåˆ™&lt;/strong&gt;ï¼šKafka å®šä½ä¸ºæŒä¹…åŒ–æ—¥å¿—ç³»ç»Ÿï¼Œæ¶ˆæ¯ä¸€æ—¦å†™å…¥å³æŒä¹…åŒ–ï¼Œæ¶ˆè´¹è¡Œä¸ºä¸å½±å“å­˜å‚¨&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è€ƒé‡&lt;/strong&gt;ï¼šé¡ºåºè¯»å†™ç£ç›˜çš„è®¾è®¡ä¸æ”¯æŒéšæœºåˆ é™¤ï¼Œé¿å…æ€§èƒ½æŸè€—&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¼ºåˆ¶æ¸…ç†æ•°æ®çš„æ›¿ä»£æ–¹æ¡ˆ"&gt;ğŸ› ï¸ &lt;strong&gt;å¼ºåˆ¶æ¸…ç†æ•°æ®çš„æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è‹¥éœ€ç«‹å³æ¸…ç†æ•°æ®ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š
1.
è°ƒæ•´ä¿ç•™ç­–ç•¥
åŠ¨æ€ç¼©çŸ­ä¿ç•™æ—¶é—´æˆ–å¤§å°ï¼ˆéœ€ç­‰å¾…ç­–ç•¥ç”Ÿæ•ˆï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;kafka-configs --bootstrap-server localhost:9092 --entity-type topics \
--entity-name my_topic --alter --add-config log.retention.ms=3600000 # ä¿ç•™1å°æ—¶
&lt;/code&gt;&lt;/pre&gt;&lt;ol start="2"&gt;
&lt;li&gt;æ‰‹åŠ¨é‡ç½®æ¶ˆè´¹åç§»é‡ï¼ˆä¼ªåˆ é™¤ï¼‰
é€šè¿‡æ¶ˆè´¹è€… API è·³è¿‡ç‰¹å®šæ¶ˆæ¯ï¼ˆéœ€è°¨æ…æ“ä½œï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;consumer.seek(topicPartition, targetOffset + 1); // è·³è¿‡ç›®æ ‡æ¶ˆæ¯[5,9](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;åˆ é™¤æ•´ä¸ª Topic
ç›´æ¥ç§»é™¤ Topic åŠå…¶æ‰€æœ‰æ•°æ®ï¼ˆä¸å¯é€†æ“ä½œï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;kafka-topics --bootstrap-server localhost:9092 --delete --topic my_topic
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®æ˜¯å¦åˆ é™¤&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ¶ˆæ¯è¢«æ¶ˆè´¹å&lt;/td&gt;
&lt;td&gt;âŒ å¦&lt;/td&gt;
&lt;td&gt;ä¸æ¶ˆè´¹æ— å…³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¶ˆæ¯è¶…è¿‡ä¿ç•™æ—¶é—´/å¤§å°&lt;/td&gt;
&lt;td&gt;âœ… æ˜¯&lt;/td&gt;
&lt;td&gt;å®šæ—¶ä»»åŠ¡è§¦å‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç›¸åŒ Key å¯ç”¨å‹ç¼©ç­–ç•¥&lt;/td&gt;
&lt;td&gt;âœ… ä¿ç•™æœ€æ–°å€¼&lt;/td&gt;
&lt;td&gt;åå°å‹ç¼©çº¿ç¨‹å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é‡ç½®åç§»é‡æˆ–åˆ é™¤ Topic&lt;/td&gt;
&lt;td&gt;âœ… æ˜¯ï¼ˆé€»è¾‘/ç‰©ç†ï¼‰&lt;/td&gt;
&lt;td&gt;æ‰‹åŠ¨æ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆé€šè¿‡ &lt;code&gt;log.retention.*&lt;/code&gt; é…ç½®è‡ªåŠ¨åŒ–æ¸…ç†&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;é¿å…æ‰‹åŠ¨åˆ é™¤å•æ¡æ¶ˆæ¯ï¼Œå¯èƒ½ç ´åæ¶ˆæ¯é¡ºåºæ€§ä¸ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¯¹æ¯”"&gt;å¯¹æ¯”
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ Kafka ä¸å…¶ä»–ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRabbitMQã€RocketMQã€ActiveMQï¼‰çš„è¯¦ç»†å¯¹æ¯”ï¼Œä»æ¶æ„è®¾è®¡ã€æ€§èƒ½ç‰¹æ€§ã€å¯é æ€§ã€é€‚ç”¨åœºæ™¯ç­‰ç»´åº¦ç»¼åˆåˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶æ„ä¸æ ¸å¿ƒæ¨¡å‹å¯¹æ¯”"&gt;âš™ï¸ &lt;strong&gt;æ¶æ„ä¸æ ¸å¿ƒæ¨¡å‹å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ActiveMQ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶æ„æ¨¡å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼æ—¥å¿—å­˜å‚¨ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡å‹&lt;/td&gt;
&lt;td&gt;åŸºäº AMQP åè®®çš„é˜Ÿåˆ—æ¨¡å‹&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼å‘å¸ƒ-è®¢é˜…æ¨¡å‹&lt;/td&gt;
&lt;td&gt;åŸºäº JMS è§„èŒƒçš„ä¼ ç»Ÿæ¶ˆæ¯ä»£ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å­˜å‚¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¡ºåºå†™å…¥ç£ç›˜ï¼Œåˆ†åŒºæ—¥å¿—æŒä¹…åŒ–&lt;/td&gt;
&lt;td&gt;å†…å­˜+ç£ç›˜ï¼ˆéœ€æ˜¾å¼é…ç½®æŒä¹…åŒ–ï¼‰&lt;/td&gt;
&lt;td&gt;é¡ºåºå†™ CommitLog + ç´¢å¼•æ–‡ä»¶&lt;/td&gt;
&lt;td&gt;å†…å­˜+ç£ç›˜/æ•°æ®åº“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤©ç„¶æ°´å¹³æ‰©å±•ï¼ˆå¢åŠ  Broker/Partitionï¼‰&lt;/td&gt;
&lt;td&gt;å‚ç›´æ‰©å±•ä¸ºä¸»ï¼Œé›†ç¾¤éœ€è´Ÿè½½å‡è¡¡æ”¯æŒ&lt;/td&gt;
&lt;td&gt;æ°´å¹³æ‰©å±•ï¼ˆå¤š Master-Slave ç»„ï¼‰&lt;/td&gt;
&lt;td&gt;é›†ç¾¤æ‰©å±•è¾ƒå¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–ç»„ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ZooKeeperï¼ˆæˆ– KRaft æ¨¡å¼ï¼‰&lt;/td&gt;
&lt;td&gt;Erlang åˆ†å¸ƒå¼è¿è¡Œæ—¶&lt;/td&gt;
&lt;td&gt;NameServerï¼ˆè½»é‡çº§å…ƒæ•°æ®ç®¡ç†ï¼‰&lt;/td&gt;
&lt;td&gt;ZooKeeperï¼ˆå¯é€‰ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®å·®å¼‚&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kafka ä»¥&lt;strong&gt;åˆ†åŒºæ—¥å¿—&lt;/strong&gt;ä¸ºæ ¸å¿ƒï¼Œé€‚åˆæµå¼æ•°æ®ï¼›RabbitMQ ä»¥&lt;strong&gt;é˜Ÿåˆ—å’Œäº¤æ¢æœº&lt;/strong&gt;ä¸ºæ ¸å¿ƒï¼Œæ”¯æŒå¤æ‚è·¯ç”±&lt;a class="link" href="@ref" &gt;1,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;RocketMQ å€Ÿé‰´ Kafka è®¾è®¡ï¼Œä½†å¼ºåŒ–äº†&lt;strong&gt;äº‹åŠ¡æ¶ˆæ¯&lt;/strong&gt;å’Œ&lt;strong&gt;é¡ºåºä¸€è‡´æ€§&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸ååé‡"&gt;âš¡ &lt;strong&gt;æ€§èƒ½ä¸ååé‡&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æŒ‡æ ‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ActiveMQ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç™¾ä¸‡çº§ QPSï¼ˆæ‰¹å¤„ç†+é›¶æ‹·è´ä¼˜åŒ–ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸‡çº§ QPS&lt;/td&gt;
&lt;td&gt;åä¸‡çº§ QPS&lt;/td&gt;
&lt;td&gt;ä¸‡çº§ QPS&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å»¶è¿Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯«ç§’~ç§’çº§ï¼ˆå—æ‰¹é‡å‘é€å½±å“ï¼‰&lt;/td&gt;
&lt;td&gt;æ¯«ç§’çº§&lt;/td&gt;
&lt;td&gt;æ¯«ç§’çº§&lt;/td&gt;
&lt;td&gt;æ¯«ç§’çº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶ˆæ¯å †ç§¯èƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒ TB çº§æ•°æ®å †ç§¯ï¼ˆç£ç›˜æŒä¹…åŒ–ï¼‰&lt;/td&gt;
&lt;td&gt;æœ‰é™ï¼ˆå†…å­˜ç“¶é¢ˆï¼‰&lt;/td&gt;
&lt;td&gt;æ”¯æŒå¤§é‡å †ç§¯ï¼ˆç£ç›˜å­˜å‚¨ï¼‰&lt;/td&gt;
&lt;td&gt;æœ‰é™&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€§èƒ½è§£æ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kafka é€šè¿‡&lt;strong&gt;é¡ºåºç£ç›˜ I/O&lt;/strong&gt; å’Œ &lt;strong&gt;PageCache ä¼˜åŒ–&lt;/strong&gt;å®ç°é«˜ååï¼Œä½†å®æ—¶æ€§å¼±äº RabbitMQ&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;RabbitMQ åœ¨&lt;strong&gt;ä½å»¶è¿Ÿåœºæ™¯&lt;/strong&gt;ï¼ˆå¦‚æ”¯ä»˜å›è°ƒï¼‰æ›´ä¼˜ï¼Œä½†é«˜è´Ÿè½½ä¸‹æ˜“æˆç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å¯é æ€§ä¿éšœæœºåˆ¶"&gt;ğŸ”’ &lt;strong&gt;å¯é æ€§ä¿éšœæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ActiveMQ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®æŒä¹…åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¨é‡ç£ç›˜æŒä¹…åŒ–ï¼ˆé»˜è®¤å¼€å¯ï¼‰&lt;/td&gt;
&lt;td&gt;å¯é€‰æŒä¹…åŒ–ï¼ˆéœ€é…ç½®é˜Ÿåˆ—+æ¶ˆæ¯ï¼‰&lt;/td&gt;
&lt;td&gt;ç£ç›˜æŒä¹…åŒ–&lt;/td&gt;
&lt;td&gt;å¯é€‰æŒä¹…åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¯ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šå‰¯æœ¬ï¼ˆISR æœºåˆ¶ï¼‰+ Leader é€‰ä¸¾&lt;/td&gt;
&lt;td&gt;é•œåƒé˜Ÿåˆ—ï¼ˆä¸»ä»å¤åˆ¶ï¼‰&lt;/td&gt;
&lt;td&gt;å¤šå‰¯æœ¬ + Master-Slave åˆ‡æ¢&lt;/td&gt;
&lt;td&gt;Master-Slave æˆ–ç½‘ç»œä»£ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è·¨åˆ†åŒºäº‹åŠ¡ï¼ˆExactly-Once è¯­ä¹‰ï¼‰&lt;/td&gt;
&lt;td&gt;æ”¯æŒï¼ˆåŒæ­¥é˜»å¡ï¼Œæ€§èƒ½ä½ï¼‰&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆäº‹åŠ¡æ¶ˆæ¯ï¼‰&lt;/td&gt;
&lt;td&gt;æ”¯æŒ JMS äº‹åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶ˆæ¯é¡ºåºæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†åŒºå†…ä¸¥æ ¼æœ‰åº&lt;/td&gt;
&lt;td&gt;åŒä¸€é˜Ÿåˆ—æ— æ³•ä¿è¯ï¼ˆé‡è¯•ä¹±åºï¼‰&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—å†…ä¸¥æ ¼æœ‰åº&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—å†…æœ‰åº&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å¯é æ€§é‡ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kafka çš„ &lt;strong&gt;ISRï¼ˆIn-Sync Replicasï¼‰&lt;/strong&gt; åŠ¨æ€ç»´æŠ¤å‰¯æœ¬åŒæ­¥çŠ¶æ€ï¼Œå¹³è¡¡ä¸€è‡´æ€§ä¸å¯ç”¨æ€§&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;RabbitMQ çš„&lt;strong&gt;é•œåƒé˜Ÿåˆ—&lt;/strong&gt;éœ€æ‰‹åŠ¨é…ç½®ï¼Œä¸”ä¸»ä»åˆ‡æ¢å¯èƒ½ä¸¢æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯å¯¹æ¯”"&gt;ğŸ¯ &lt;strong&gt;é€‚ç”¨åœºæ™¯å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ActiveMQ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®æ—¶æ—¥å¿—æ”¶é›†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æœ€ä½³ï¼ˆé«˜åå+æŒä¹…åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ ä¸€èˆ¬ï¼ˆå †ç§¯èƒ½åŠ›å¼±ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… é€‚åˆ&lt;/td&gt;
&lt;td&gt;âš ï¸ ä¸€èˆ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é‡‘èçº§äº‹åŠ¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… è·¨åˆ†åŒºäº‹åŠ¡ï¼ˆéœ€ä¸šåŠ¡å¹‚ç­‰ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… å¼ºäº‹åŠ¡ï¼ˆä½†æ€§èƒ½ä½ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;âœ… äº‹åŠ¡æ¶ˆæ¯ï¼ˆæœ€ç»ˆä¸€è‡´ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… JMS äº‹åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤æ‚è·¯ç”±&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä»…æ”¯æŒ Topic åˆ†åŒº&lt;/td&gt;
&lt;td&gt;âœ… çµæ´»ï¼ˆDirect/Topic/Fanout äº¤æ¢æœºï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ æœ‰é™ï¼ˆTag è¿‡æ»¤ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… JMS é€‰æ‹©å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æµå¼è®¡ç®—é›†æˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… åŸç”Ÿæ”¯æŒï¼ˆKafka Streams/Flinkï¼‰&lt;/td&gt;
&lt;td&gt;âŒ éœ€æ’ä»¶æ”¯æŒ&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒ Flink&lt;/td&gt;
&lt;td&gt;âŒ å¼±&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‰©è”ç½‘è®¾å¤‡æ¶ˆæ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ é€‚åˆé«˜é¢‘æ•°æ®ä¸ŠæŠ¥&lt;/td&gt;
&lt;td&gt;âœ… ä½å»¶è¿Ÿå‘½ä»¤ä¸‹å‘&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;âœ… æµ·é‡è®¾å¤‡æ¥å…¥&lt;/td&gt;
&lt;td&gt;âš ï¸ ä¸€èˆ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;åœºæ™¯è§£æ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kafka æ˜¯&lt;strong&gt;å¤§æ•°æ®ç®¡é“&lt;/strong&gt;é¦–é€‰ï¼šæ—¥å¿—èšåˆ â†’ å®æ—¶åˆ†æ â†’ æµå¤„ç†&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;RabbitMQ æ“…é•¿&lt;strong&gt;ä¼ä¸šåº”ç”¨é›†æˆ&lt;/strong&gt;ï¼šå¦‚è®¢å•çŠ¶æ€åŒæ­¥ã€è·¨ç³»ç»Ÿè§£è€¦&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿæ€ä¸è¿ç»´å¯¹æ¯”"&gt;ğŸ§© &lt;strong&gt;ç”Ÿæ€ä¸è¿ç»´å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç®¡ç†å·¥å…·&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼€æºå·¥å…·è¾ƒå°‘ï¼ˆKafka Managerï¼‰&lt;/td&gt;
&lt;td&gt;å®Œå–„çš„ç®¡ç†ç•Œé¢ï¼ˆWeb UIï¼‰&lt;/td&gt;
&lt;td&gt;å¼€æºç‰ˆæœ¬æ— å®˜æ–¹ UI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›‘æ§æŒ‡æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JMX æš´éœ²ä¸°å¯ŒæŒ‡æ ‡&lt;/td&gt;
&lt;td&gt;Prometheus/Grafana é›†æˆå‹å¥½&lt;/td&gt;
&lt;td&gt;å†…ç½®ç›‘æ§å‘½ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤¾åŒºç”Ÿæ€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºå¤§ï¼ˆConfluent å•†ä¸šæ”¯æŒ+å¤§æ•°æ®é›†æˆï¼‰&lt;/td&gt;
&lt;td&gt;æ´»è·ƒï¼ˆErlang/Java ç¤¾åŒºï¼‰&lt;/td&gt;
&lt;td&gt;é˜¿é‡Œç”Ÿæ€æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éƒ¨ç½²å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆéœ€ ZooKeeper+Broker è°ƒä¼˜ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆä¾èµ– Erlang ç¯å¢ƒï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆNameServer+Brokerï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;è¿ç»´å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kafka éœ€å…³æ³¨ &lt;strong&gt;ZooKeeper æ€§èƒ½&lt;/strong&gt;å’Œ&lt;strong&gt;ç£ç›˜ I/O ä¼˜åŒ–&lt;/strong&gt;ï¼›RabbitMQ éœ€è°ƒæ•´&lt;strong&gt;å†…å­˜é˜ˆå€¼&lt;/strong&gt;é¿å…é˜»å¡&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“é€‰å‹å†³ç­–æŒ‡å—"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šé€‰å‹å†³ç­–æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€‰ Kafka&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€æ±‚ï¼š&lt;strong&gt;é«˜ååæµå¤„ç†&lt;/strong&gt;ï¼ˆæ—¥å¿—/å®æ—¶åˆ†æï¼‰ã€&lt;strong&gt;å¤§æ•°æ®å›æº¯&lt;/strong&gt;ï¼ˆé•¿æ—¶é—´å­˜å‚¨ï¼‰ã€&lt;strong&gt;Exactly-Once è¯­ä¹‰&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼šç”¨æˆ·è¡Œä¸ºåŸ‹ç‚¹ã€é‡‘èäº¤æ˜“æµæ°´ã€Flink æµè®¡ç®—æ•°æ®æº&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ RabbitMQ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€æ±‚ï¼š&lt;strong&gt;å¤æ‚è·¯ç”±è§„åˆ™&lt;/strong&gt;ã€&lt;strong&gt;æ¯«ç§’çº§å»¶è¿Ÿ&lt;/strong&gt;ã€&lt;strong&gt;ä¼ä¸šçº§äº‹åŠ¡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼šç”µå•†è®¢å•çŠ¶æ€åŒæ­¥ã€æ”¯ä»˜å›è°ƒé€šçŸ¥&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ RocketMQ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€æ±‚ï¼š&lt;strong&gt;æµ·é‡å †ç§¯+é¡ºåºæ¶ˆæ¯&lt;/strong&gt;ï¼ˆå¦‚è®¢å•çŠ¶æ€å˜æ›´ï¼‰ã€&lt;strong&gt;åˆ†å¸ƒå¼äº‹åŠ¡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼šé˜¿é‡Œäº‘ç”Ÿæ€ã€ç”µå•†ä¸šåŠ¡æµæ°´&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ ActiveMQ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€æ±‚ï¼š&lt;strong&gt;ä¼ ç»Ÿ JMS å…¼å®¹&lt;/strong&gt;ã€&lt;strong&gt;ç®€å•å¼‚æ­¥è§£è€¦&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼šé—ç•™ç³»ç»Ÿå‡çº§ã€å°å‹ä¼ä¸šåº”ç”¨é›†æˆ&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;é¿å‘æç¤º&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…ç”¨ Kafka åš&lt;strong&gt;å¤æ‚è·¯ç”±&lt;/strong&gt;ï¼ˆå¦‚æŒ‰ç”¨æˆ·å±æ€§è¿‡æ»¤ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;é¿å…ç”¨ RabbitMQ å¤„ç†&lt;strong&gt;è¶…å¤§è§„æ¨¡æ—¥å¿—æµ&lt;/strong&gt;ï¼ˆå†…å­˜å’Œååç“¶é¢ˆï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="amqp"&gt;AMQP
&lt;/h2&gt;&lt;p&gt;AMQPï¼ˆAdvanced Message Queuing Protocolï¼Œé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼‰æ˜¯ä¸€ç§&lt;strong&gt;å¼€æ”¾æ ‡å‡†çš„åº”ç”¨å±‚åè®®&lt;/strong&gt;ï¼Œä¸“ä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ï¼Œæ—¨åœ¨è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è·¨å¹³å°ã€è·¨è¯­è¨€çš„å¯é æ¶ˆæ¯ä¼ é€’é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒè¦ç‚¹ä¸æŠ€æœ¯ç»†èŠ‚ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åè®®å®šä½ä¸æ ¸å¿ƒç›®æ ‡-16"&gt;ğŸ”§ &lt;strong&gt;åè®®å®šä½ä¸æ ¸å¿ƒç›®æ ‡&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼€æ”¾æ ‡å‡†&lt;/strong&gt;ï¼šç”±é‡‘èè¡Œä¸šå‘èµ·ï¼Œç»OASISæ ‡å‡†åŒ–ï¼Œç¡®ä¿ä¸åŒå‚å•†å®ç°äº’æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;ï¼šä¿éšœæ¶ˆæ¯ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€æœ‰åºä¼ é€’ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥é€šä¿¡&lt;/strong&gt;ï¼šè§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œæå‡ç³»ç»Ÿå“åº”èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»è·¯ç”±&lt;/strong&gt;ï¼šæ”¯æŒå¤æ‚æ¶ˆæ¯åˆ†å‘é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç»„ä»¶ä¸å·¥ä½œæ¨¡å‹-135"&gt;ğŸ§© &lt;strong&gt;æ ¸å¿ƒç»„ä»¶ä¸å·¥ä½œæ¨¡å‹&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,3,5&lt;/a&gt;
&lt;/h3&gt;&lt;p&gt;AMQPæ¨¡å‹åŸºäºç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®ç»„ä»¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”Ÿäº§è€…ï¼ˆProducerï¼‰
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºå¹¶å‘é€æ¶ˆæ¯çš„åº”ç”¨ï¼Œæ¶ˆæ¯åŒ…å«&lt;strong&gt;æ¶ˆæ¯å¤´&lt;/strong&gt;ï¼ˆå±æ€§ï¼‰å’Œ&lt;strong&gt;æ¶ˆæ¯ä½“&lt;/strong&gt;ï¼ˆæ•°æ®è´Ÿè½½ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;äº¤æ¢æœºï¼ˆExchangeï¼‰
&lt;ul&gt;
&lt;li&gt;æ¥æ”¶ç”Ÿäº§è€…æ¶ˆæ¯ï¼Œæ ¹æ®è·¯ç”±é”®ï¼ˆRouting Keyï¼‰ å’Œç»‘å®šè§„åˆ™åˆ†å‘åˆ°é˜Ÿåˆ—ã€‚æ”¯æŒå››ç§ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Direct&lt;/strong&gt;ï¼šç²¾ç¡®åŒ¹é…è·¯ç”±é”®ï¼ˆå¦‚ &lt;code&gt;payment.success&lt;/code&gt; â†’ æ”¯ä»˜æˆåŠŸé˜Ÿåˆ—ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Topic&lt;/strong&gt;ï¼šé€šé…ç¬¦åŒ¹é…ï¼ˆ&lt;code&gt;*&lt;/code&gt; åŒ¹é…ä¸€ä¸ªè¯ï¼Œ&lt;code&gt;#&lt;/code&gt; åŒ¹é…å¤šçº§ï¼Œå¦‚ &lt;code&gt;order.*.failed&lt;/code&gt;ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Fanout&lt;/strong&gt;ï¼šå¹¿æ’­åˆ°æ‰€æœ‰ç»‘å®šé˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Headers&lt;/strong&gt;ï¼šåŸºäºæ¶ˆæ¯å¤´é”®å€¼å¯¹åŒ¹é…ï¼ˆå¦‚ &lt;code&gt;x-priority: high&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é˜Ÿåˆ—ï¼ˆQueueï¼‰
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨æ¶ˆæ¯çš„ç¼“å†²åŒºï¼Œæ”¯æŒ&lt;strong&gt;æŒä¹…åŒ–&lt;/strong&gt;ï¼ˆæ¶ˆæ¯å­˜ç›˜é˜²ä¸¢å¤±ï¼‰å’Œ&lt;strong&gt;ä¸´æ—¶é˜Ÿåˆ—&lt;/strong&gt;ï¼ˆè‡ªåŠ¨é”€æ¯ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰
&lt;ul&gt;
&lt;li&gt;ä»é˜Ÿåˆ—æ‹‰å–æ¶ˆæ¯å¤„ç†ï¼Œæ”¯æŒ&lt;strong&gt;æ‰‹åŠ¨ACK&lt;/strong&gt;ï¼ˆç¡®è®¤å¤„ç†æˆåŠŸï¼‰æˆ–&lt;strong&gt;è‡ªåŠ¨ACK&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç»‘å®šï¼ˆBindingï¼‰
&lt;ul&gt;
&lt;li&gt;å®šä¹‰äº¤æ¢æœºä¸é˜Ÿåˆ—çš„å…³è”è§„åˆ™ï¼ˆä¾‹ï¼šå°†é˜Ÿåˆ—Aç»‘å®šåˆ°Topicäº¤æ¢æœºï¼Œè·¯ç”±é”®ä¸º &lt;code&gt;logs.error.*&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è™šæ‹Ÿä¸»æœºï¼ˆVirtual Hostï¼‰
&lt;ul&gt;
&lt;li&gt;é€»è¾‘éš”ç¦»å•å…ƒï¼Œå…è®¸å¤šç§Ÿæˆ·å…±äº«åŒä¸€ç‰©ç†èµ„æºï¼ˆå¦‚ &lt;code&gt;/tenantA&lt;/code&gt; å’Œ &lt;code&gt;/tenantB&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åè®®åˆ†å±‚ä¸é€šä¿¡æœºåˆ¶-36"&gt;âš™ï¸ &lt;strong&gt;åè®®åˆ†å±‚ä¸é€šä¿¡æœºåˆ¶&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è¿æ¥å±‚ï¼ˆConnectionï¼‰
&lt;ul&gt;
&lt;li&gt;å»ºç«‹TCPè¿æ¥ï¼Œæ”¯æŒTLSåŠ å¯†å’ŒSASLè®¤è¯ï¼ˆå¦‚ç”¨æˆ·å/å¯†ç ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¿¡é“å±‚ï¼ˆChannelï¼‰
&lt;ul&gt;
&lt;li&gt;åœ¨å•ä¸€è¿æ¥ä¸Šåˆ›å»ºå¤šé€»è¾‘ä¿¡é“ï¼Œå®ç°&lt;strong&gt;å¤šè·¯å¤ç”¨&lt;/strong&gt;ï¼Œå‡å°‘ç½‘ç»œå¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¸§å±‚ï¼ˆFrameï¼‰
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯è¢«æ‹†åˆ†ä¸ºå¸§ä¼ è¾“ï¼ˆåŒ…æ‹¬å¸§å¤´ã€å¸§ä½“å’Œå¸§å°¾ï¼‰ï¼Œç¡®ä¿ä¼ è¾“å¯é æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¯é æ€§æœºåˆ¶-126"&gt;ğŸ›¡ï¸ &lt;strong&gt;å¯é æ€§æœºåˆ¶&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,2,6&lt;/a&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯ç¡®è®¤ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…ç¡®è®¤ï¼ˆConfirmï¼‰&lt;/strong&gt;ï¼šBrokerç¡®è®¤æ¶ˆæ¯å·²æ¥æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…ACK&lt;/strong&gt;ï¼šæ‰‹åŠ¨ACKç¡®ä¿æ¶ˆæ¯å¤„ç†æˆåŠŸåæ‰ä»é˜Ÿåˆ—ç§»é™¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒä¹…åŒ–&lt;/strong&gt;ï¼šäº¤æ¢æœºã€é˜Ÿåˆ—ã€æ¶ˆæ¯å‡å¯æ ‡è®°ä¸º &lt;code&gt;durable&lt;/code&gt;ï¼Œé‡å¯åä¸ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æ”¯æŒ&lt;/strong&gt;ï¼šæ‰¹é‡æ¶ˆæ¯å‘é€çš„åŸå­æ€§ä¿è¯ï¼ˆä½†æ€§èƒ½è¾ƒä½ï¼Œæ¨èç”¨Confirmæ›¿ä»£ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶ˆæ¯è·¯ç”±æ¨¡å¼-157"&gt;ğŸ”„ &lt;strong&gt;æ¶ˆæ¯è·¯ç”±æ¨¡å¼&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,5,7&lt;/a&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‚¹å¯¹ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Directäº¤æ¢æœº + å•é˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;è®¢å•ç²¾å‡†æŠ•é€’ï¼ˆå¦‚æ”¯ä»˜å¤„ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‘å¸ƒ/è®¢é˜…&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Fanout/Topicäº¤æ¢æœº + å¤šé˜Ÿåˆ—ç»‘å®š&lt;/td&gt;
&lt;td&gt;æ—¥å¿—å¹¿æ’­ã€é…ç½®æ›´æ–°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯·æ±‚/å“åº”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸´æ—¶é˜Ÿåˆ— + å›è°ƒID&lt;/td&gt;
&lt;td&gt;RPCè°ƒç”¨ï¼ˆå¦‚åº“å­˜æŸ¥è¯¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å·¥ä½œé˜Ÿåˆ—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•é˜Ÿåˆ— + å¤šæ¶ˆè´¹è€…ç«äº‰æ¶ˆè´¹&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼ä»»åŠ¡åˆ†å‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;è·¯ç”±çµæ´»æ€§ç¤ºä¾‹&lt;/strong&gt;ï¼š
ç”µå•†ç³»ç»Ÿä¸­ï¼ŒTopicäº¤æ¢æœºå¯å°† &lt;code&gt;order.us.payment&lt;/code&gt; è·¯ç”±è‡³ç¾å›½æ”¯ä»˜é˜Ÿåˆ—ï¼Œ&lt;code&gt;order.eu.refund&lt;/code&gt; è·¯ç”±è‡³æ¬§æ´²é€€æ¬¾é˜Ÿåˆ—ï¼Œå®ç°å¤šç»´åº¦æ¶ˆæ¯åˆ†ç±»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµå®ç°ä¸åº”ç”¨åœºæ™¯-247"&gt;ğŸŒ &lt;strong&gt;ä¸»æµå®ç°ä¸åº”ç”¨åœºæ™¯&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;2,4,7&lt;/a&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;ï¼ˆæœ€æµè¡Œï¼‰ï¼šErlangå¼€å‘ï¼Œæ’ä»¶ä¸°å¯Œï¼ˆå¦‚å»¶è¿Ÿæ¶ˆæ¯æ’ä»¶ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Apache Qpid&lt;/strong&gt;ï¼šæ”¯æŒå¤šè¯­è¨€å®¢æˆ·ç«¯ï¼Œå…¼å®¹æ€§å¼ºã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Azure Service Bus&lt;/strong&gt;ï¼šäº‘åŸç”ŸæœåŠ¡ï¼Œé›†æˆAzureç”Ÿæ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;åº”ç”¨åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é‡‘èäº¤æ˜“&lt;/strong&gt;ï¼šç¡®ä¿äº¤æ˜“æŒ‡ä»¤å¯é ä¼ é€’ï¼ˆå¦‚é“¶è¡Œè½¬è´¦ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”µå•†è§£è€¦&lt;/strong&gt;ï¼šè®¢å•ç³»ç»Ÿå¼‚æ­¥é€šçŸ¥åº“å­˜æœåŠ¡ï¼Œé¿å…åŒæ­¥é˜»å¡ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰©è”ç½‘&lt;/strong&gt;ï¼šè®¾å¤‡æ•°æ®é€šè¿‡Topicäº¤æ¢æœºåˆ†ç±»å¤„ç†ï¼ˆå¦‚ä¼ æ„Ÿå™¨å‘Šè­¦è·¯ç”±ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—æ”¶é›†&lt;/strong&gt;ï¼šFanoutäº¤æ¢æœºå¹¿æ’­æ—¥å¿—åˆ°å­˜å‚¨ã€åˆ†æå’ŒæŠ¥è­¦é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¯¹æ¯”å…¶ä»–æ¶ˆæ¯åè®®-12"&gt;âš–ï¸ &lt;strong&gt;å¯¹æ¯”å…¶ä»–æ¶ˆæ¯åè®®&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;AMQP&lt;/th&gt;
&lt;th&gt;MQTT&lt;/th&gt;
&lt;th&gt;Kafka&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åè®®å±‚çº§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åº”ç”¨å±‚æ ‡å‡†&lt;/td&gt;
&lt;td&gt;åº”ç”¨å±‚&lt;/td&gt;
&lt;td&gt;è‡ªå®šä¹‰ä¼ è¾“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è·¯ç”±èƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­â­ï¼ˆ4ç§äº¤æ¢æœºï¼‰&lt;/td&gt;
&lt;td&gt;â­ï¼ˆä»…Topicï¼‰&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆåˆ†åŒº+Keyï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºï¼ˆACK+æŒä¹…åŒ–ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆQoSåˆ†çº§ï¼‰&lt;/td&gt;
&lt;td&gt;å¼ºï¼ˆå‰¯æœ¬åŒæ­¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼ä¸šçº§å¤æ‚è·¯ç”±&lt;/td&gt;
&lt;td&gt;è½»é‡çº§IoTè®¾å¤‡&lt;/td&gt;
&lt;td&gt;é«˜ååæ—¥å¿—æµ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€å¤æ‚è·¯ç”±æˆ–äº‹åŠ¡æ”¯æŒ â†’ AMQPï¼ˆå¦‚RabbitMQï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;èµ„æºå—é™è®¾å¤‡ â†’ MQTTï¼›æµ·é‡æ—¥å¿—æµ â†’ Kafkaã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å‘å±•è¶‹åŠ¿ä¸æŒ‘æˆ˜-14"&gt;ğŸš€ &lt;strong&gt;å‘å±•è¶‹åŠ¿ä¸æŒ‘æˆ˜&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;è¶‹åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‘åŸç”Ÿé›†æˆ&lt;/strong&gt;ï¼šä¸Kubernetesã€Service Meshèåˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼šå‡å°‘åºåˆ—åŒ–å¼€é”€ï¼ˆå¦‚äºŒè¿›åˆ¶åè®®æ”¹è¿›ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æŒ‘æˆ˜ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®å¤æ‚&lt;/strong&gt;ï¼šç»‘å®šè§„åˆ™è®¾è®¡éœ€ä¸“ä¸šçŸ¥è¯†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ¶ˆè€—&lt;/strong&gt;ï¼šé«˜å¹¶å‘ä¸‹ä¿¡é“ç®¡ç†å ç”¨è¾ƒå¤šå†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;AMQPé€šè¿‡&lt;strong&gt;æ ‡å‡†åŒ–åè®®&lt;/strong&gt;ã€&lt;strong&gt;çµæ´»è·¯ç”±æ¨¡å‹&lt;/strong&gt;å’Œ&lt;strong&gt;ä¼ä¸šçº§å¯é æ€§&lt;/strong&gt;ï¼Œæˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿå¼‚æ­¥é€šä¿¡çš„åŸºçŸ³ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦èƒ½åŠ›&lt;/strong&gt;ï¼šç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…å®Œå…¨éš”ç¦»ï¼Œé€šè¿‡äº¤æ¢æœºåŠ¨æ€è·¯ç”±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨å¹³å°æ€§&lt;/strong&gt;ï¼šè¯­è¨€æ— å…³æ€§ï¼ˆæ”¯æŒPython/Java/.NETç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…œåº•æœºåˆ¶&lt;/strong&gt;ï¼šæŒä¹…åŒ–+ACK+äº‹åŠ¡ä¸‰é‡ä¿éšœæ•°æ®å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…è¿‡åº¦ä½¿ç”¨Headersäº¤æ¢æœºï¼ˆæ€§èƒ½è¾ƒä½ï¼‰ï¼Œä¼˜å…ˆç”¨Topicå®ç°æ¨¡å¼åŒ¹é…ã€‚&lt;/li&gt;
&lt;li&gt;ç”Ÿäº§ç¯å¢ƒæ¨èé›†ç¾¤éƒ¨ç½²ï¼ˆå¦‚RabbitMQé•œåƒé˜Ÿåˆ—ï¼‰ç¡®ä¿é«˜å¯ç”¨&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="rabbitmq"&gt;RabbitMQ
&lt;/h2&gt;&lt;p&gt;RabbitMQ æ˜¯ä¸€ä¸ªåŸºäº &lt;strong&gt;AMQPï¼ˆé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼‰&lt;/strong&gt; çš„å¼€æºæ¶ˆæ¯ä»£ç†è½¯ä»¶ï¼Œç”± Erlang è¯­è¨€ç¼–å†™ï¼Œä¸“æ³¨äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„&lt;strong&gt;å¼‚æ­¥é€šä¿¡ã€åº”ç”¨è§£è€¦å’Œæµé‡å‰Šå³°&lt;/strong&gt;ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæ¶æ„ã€å·¥ä½œæœºåˆ¶ã€ç‰¹æ€§åŠé€‚ç”¨åœºæ™¯ç­‰ç»´åº¦å…¨é¢è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¶æ„ä¸ç»„ä»¶"&gt;ğŸ”§ æ ¸å¿ƒæ¶æ„ä¸ç»„ä»¶
&lt;/h3&gt;&lt;p&gt;RabbitMQ çš„æ ¸å¿ƒæ¶æ„å›´ç»• &lt;strong&gt;ç”Ÿäº§è€…-äº¤æ¢æœº-é˜Ÿåˆ—-æ¶ˆè´¹è€…&lt;/strong&gt; æ¨¡å‹æ„å»ºï¼Œé€šè¿‡é€»è¾‘éš”ç¦»å®ç°çµæ´»æ€§å’Œæ‰©å±•æ€§ï¼š
1.
ç”Ÿäº§è€…ï¼ˆProducerï¼‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºçš„åº”ç”¨ï¼Œæ¶ˆæ¯åŒ…å« &lt;strong&gt;æ¶ˆæ¯ä½“ï¼ˆBodyï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;å±æ€§ï¼ˆPropertiesï¼‰&lt;/strong&gt;ï¼ˆå¦‚ä¼˜å…ˆçº§ã€å»¶è¿Ÿï¼‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;äº¤æ¢æœºï¼ˆExchangeï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ¥æ”¶ç”Ÿäº§è€…æ¶ˆæ¯ï¼Œæ ¹æ®
è·¯ç”±é”®ï¼ˆRouting Keyï¼‰
å’Œ
ç»‘å®šè§„åˆ™ï¼ˆBindingï¼‰
åˆ†å‘åˆ°é˜Ÿåˆ—ï¼Œæ”¯æŒå››ç§ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Direct&lt;/strong&gt;ï¼šç²¾ç¡®åŒ¹é…è·¯ç”±é”®ï¼ˆå¦‚ &lt;code&gt;order.payment&lt;/code&gt; â†’ æ”¯ä»˜é˜Ÿåˆ—ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Fanout&lt;/strong&gt;ï¼šå¹¿æ’­åˆ°æ‰€æœ‰ç»‘å®šé˜Ÿåˆ—ï¼ˆå¦‚æ—¥å¿—å¹¿æ’­ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Topic&lt;/strong&gt;ï¼šé€šé…ç¬¦åŒ¹é…è·¯ç”±é”®ï¼ˆ&lt;code&gt;*&lt;/code&gt; åŒ¹é…ä¸€ä¸ªè¯ï¼Œ&lt;code&gt;#&lt;/code&gt; åŒ¹é…å¤šçº§è¯ï¼Œå¦‚ &lt;code&gt;order.*.success&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Headers&lt;/strong&gt;ï¼šåŸºäºæ¶ˆæ¯å¤´é”®å€¼å¯¹åŒ¹é…ï¼ˆå¦‚ &lt;code&gt;x-type: urgent&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;é˜Ÿåˆ—ï¼ˆQueueï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨æ¶ˆæ¯çš„ç¼“å†²åŒºï¼Œæ”¯æŒ &lt;strong&gt;æŒä¹…åŒ–ï¼ˆdurableï¼‰&lt;/strong&gt; é˜²æ­¢æœåŠ¡é‡å¯ä¸¢å¤±æ•°æ®ï¼Œå¤šä¸ªæ¶ˆè´¹è€…å¯ç«äº‰æ¶ˆè´¹ï¼ˆè½®è¯¢åˆ†å‘ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä»é˜Ÿåˆ—æ‹‰å–æ¶ˆæ¯å¤„ç†ï¼Œæ”¯æŒ &lt;strong&gt;æ‰‹åŠ¨ç¡®è®¤ï¼ˆACKï¼‰&lt;/strong&gt; æˆ– &lt;strong&gt;è‡ªåŠ¨ç¡®è®¤&lt;/strong&gt;ï¼Œç¡®ä¿æ¶ˆæ¯å¤„ç†æˆåŠŸ&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="5"&gt;
&lt;li&gt;è™šæ‹Ÿä¸»æœºï¼ˆVirtual Hostï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é€»è¾‘éš”ç¦»å•å…ƒï¼Œä¸åŒä¸šåŠ¡å¯ç‹¬ç«‹ç®¡ç†äº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;/projectA&lt;/code&gt; å’Œ &lt;code&gt;/projectB&lt;/code&gt;ï¼‰ï¼Œé¿å…å‘½åå†²çª&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜çº§ç‰¹æ€§ä¸å¯é æ€§æœºåˆ¶"&gt;âš™ï¸ é«˜çº§ç‰¹æ€§ä¸å¯é æ€§æœºåˆ¶
&lt;/h3&gt;&lt;p&gt;RabbitMQ é€šè¿‡å¤šç§æœºåˆ¶ä¿éšœæ¶ˆæ¯å¯é æ€§å’Œç³»ç»Ÿå¥å£®æ€§ï¼š
1.
æ¶ˆæ¯æŒä¹…åŒ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é˜Ÿåˆ—å’Œæ¶ˆæ¯å‡å¯æ ‡è®°ä¸º &lt;code&gt;durable&lt;/code&gt;ï¼Œç»“åˆç£ç›˜å­˜å‚¨æŠµå¾¡æœåŠ¡å™¨å®•æœº&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;ç”Ÿäº§è€…ç¡®è®¤ï¼ˆConfirmï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§è€…é€šè¿‡ &lt;code&gt;Confirm&lt;/code&gt; æ¨¡å¼ç¡®è®¤æ¶ˆæ¯æ˜¯å¦æˆåŠŸåˆ°è¾¾ Broker&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;æ¶ˆè´¹è€…æ‰‹åŠ¨ ACK&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…å¤„ç†å®Œæˆåå‘é€ ACKï¼Œå¤±è´¥æ—¶ Broker é‡æ–°æŠ•é€’æˆ–è½¬å…¥ &lt;strong&gt;æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLXï¼‰&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;é›†ç¾¤ä¸é«˜å¯ç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é•œåƒé˜Ÿåˆ—ï¼ˆMirrored Queuesï¼‰&lt;/strong&gt;ï¼šé˜Ÿåˆ—æ•°æ®è·¨èŠ‚ç‚¹å¤åˆ¶ï¼Œä¸»èŠ‚ç‚¹æ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="5"&gt;
&lt;li&gt;å»¶è¿Ÿæ¶ˆæ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡æ’ä»¶ &lt;code&gt;rabbitmq-delayed-message-exchange&lt;/code&gt; æ”¯æŒå®šæ—¶æŠ•é€’ï¼ˆå¦‚ 30 åˆ†é’Ÿåå¤„ç†è¶…æ—¶è®¢å•ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…­ç§å·¥ä½œæ¨¡å¼"&gt;ğŸ”„ å…­ç§å·¥ä½œæ¨¡å¼
&lt;/h3&gt;&lt;p&gt;RabbitMQ æ”¯æŒå¤šç§æ¶ˆæ¯åˆ†å‘æ¨¡å¼ï¼Œé€‚åº”ä¸åŒåœºæ™¯éœ€æ±‚ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç®€å•é˜Ÿåˆ—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€å¯¹ä¸€é€šä¿¡ï¼ˆç”Ÿäº§è€… â†’ é˜Ÿåˆ— â†’ å•ä¸ªæ¶ˆè´¹è€…ï¼‰&lt;/td&gt;
&lt;td&gt;å•ä»»åŠ¡å¤„ç†ï¼ˆå¦‚è®¢å•åˆ›å»ºï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å·¥ä½œé˜Ÿåˆ—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€å¯¹å¤šï¼ˆä¸€ä¸ªé˜Ÿåˆ— â†’ å¤šä¸ªæ¶ˆè´¹è€…ç«äº‰æ¶ˆè´¹ï¼Œè½®è¯¢åˆ†å‘ï¼‰&lt;/td&gt;
&lt;td&gt;ä»»åŠ¡åˆ†å‘ï¼ˆå¦‚åˆ†å¸ƒå¼è®¡ç®—ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‘å¸ƒ/è®¢é˜…&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰‡å½¢äº¤æ¢æœºå¹¿æ’­æ¶ˆæ¯åˆ°æ‰€æœ‰ç»‘å®šé˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;ç³»ç»Ÿé€šçŸ¥ã€é…ç½®æ›´æ–°å¹¿æ’­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è·¯ç”±æ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´è¿äº¤æ¢æœºæŒ‰è·¯ç”±é”®ç²¾ç¡®åŒ¹é…é˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;åˆ†ç±»æ¶ˆæ¯å¤„ç†ï¼ˆå¦‚æ”¯ä»˜æˆåŠŸé€šçŸ¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»é¢˜æ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸»é¢˜äº¤æ¢æœºæŒ‰é€šé…ç¬¦åŒ¹é…é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;logs.*.error&lt;/code&gt; â†’ é”™è¯¯æ—¥å¿—é˜Ÿåˆ—ï¼‰&lt;/td&gt;
&lt;td&gt;å¤šç»´åº¦æ¶ˆæ¯åˆ†ç±»ï¼ˆå¦‚æ—¥å¿—åˆ†çº§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RPC æ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»“åˆå›è°ƒé˜Ÿåˆ—å®ç°è¿œç¨‹è°ƒç”¨ï¼Œæ¶ˆè´¹è€…å¤„ç†å®Œè¿”å›å“åº”è‡³æŒ‡å®šé˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;åŒæ­¥è¯·æ±‚å“åº”ï¼ˆå¦‚åº“å­˜æŸ¥è¯¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–æŠ€å·§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å·¥ä½œé˜Ÿåˆ—ä¸­é€šè¿‡ &lt;code&gt;channel.basicQos(prefetchCount=1)&lt;/code&gt; é™åˆ¶æ¶ˆè´¹è€…æœªç¡®è®¤æ¶ˆæ¯æ•°ï¼Œé¿å…è´Ÿè½½ä¸å‡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é«˜é¢‘åœºæ™¯é¿å…ä½¿ç”¨ Headers Exchangeï¼ˆæ€§èƒ½ä½ï¼‰ï¼Œæ”¹ç”¨ Topic æˆ– Direct&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯"&gt;ğŸŒ é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;RabbitMQ çš„ä¼˜åŠ¿åœºæ™¯é›†ä¸­åœ¨ &lt;strong&gt;ä½å»¶è¿Ÿã€çµæ´»è·¯ç”±å’Œä¼ä¸šçº§å¯é æ€§&lt;/strong&gt;ï¼š
1.
å¼‚æ­¥å¤„ç†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è§£è€¦è€—æ—¶æ“ä½œï¼ˆå¦‚æ”¯ä»˜æˆåŠŸåå¼‚æ­¥ç”Ÿæˆè´¦å•ã€å‘é€é‚®ä»¶ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;åº”ç”¨è§£è€¦&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†ç¦»è®¢å•ç³»ç»Ÿä¸åº“å­˜ç³»ç»Ÿï¼Œé¿å…è¿é”æ•…éšœ&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;æµé‡å‰Šå³°&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç¼“å†²çªå‘è¯·æ±‚ï¼ˆå¦‚ç§’æ€æ´»åŠ¨ï¼‰ï¼Œä¿æŠ¤ä¸‹æ¸¸æœåŠ¡&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;å‘å¸ƒ/è®¢é˜…&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å®æ—¶å¹¿æ’­ï¼ˆå¦‚è‚¡ç¥¨ä»·æ ¼å˜åŠ¨é€šçŸ¥æ‰€æœ‰å•†æˆ·ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¯¹æ¯”å…¶ä»–æ¶ˆæ¯ä¸­é—´ä»¶"&gt;âš–ï¸ å¯¹æ¯”å…¶ä»–æ¶ˆæ¯ä¸­é—´ä»¶
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;RabbitMQ&lt;/th&gt;
&lt;th&gt;Kafka&lt;/th&gt;
&lt;th&gt;RocketMQ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åè®®æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;AMQPã€MQTTã€STOMP&lt;/td&gt;
&lt;td&gt;è‡ªå®šä¹‰åè®®&lt;/td&gt;
&lt;td&gt;è‡ªå®šä¹‰åè®®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è·¯ç”±çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆ4ç§äº¤æ¢æœºï¼‰&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆåŸºäºTopicåˆ†åŒºï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­ï¼ˆTopic+Tagè¿‡æ»¤ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸‡çº§ï¼ˆä¸­å°è§„æ¨¡ï¼‰&lt;/td&gt;
&lt;td&gt;ç™¾ä¸‡çº§ï¼ˆå¤§æ•°æ®æµï¼‰&lt;/td&gt;
&lt;td&gt;åä¸‡çº§ï¼ˆå¹³è¡¡å‹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å»¶è¿Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¾®ç§’çº§&lt;/strong&gt;ï¼ˆæœ€ä¼˜ï¼‰&lt;/td&gt;
&lt;td&gt;æ¯«ç§’çº§&lt;/td&gt;
&lt;td&gt;æ¯«ç§’çº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼ä¸šåº”ç”¨é›†æˆã€å¤æ‚è·¯ç”±&lt;/td&gt;
&lt;td&gt;æ—¥å¿—å¤„ç†ã€å®æ—¶æµåˆ†æ&lt;/td&gt;
&lt;td&gt;é‡‘èçº§äº‹åŠ¡ã€é¡ºåºæ¶ˆæ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€å¤æ‚è·¯ç”±ï¼ˆå¦‚æŒ‰ç”¨æˆ·å±æ€§è¿‡æ»¤ï¼‰ â†’ RabbitMQ&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;éœ€è¶…é«˜æ€§èƒ½æˆ–æµ·é‡æ—¥å¿—æµ â†’ Kafkaï¼›éœ€å¼ºäº‹åŠ¡æ”¯æŒ â†’ RocketMQ&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-è¿ç»´ä¸ç”Ÿæ€"&gt;ğŸ› ï¸ è¿ç»´ä¸ç”Ÿæ€
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç®¡ç†å·¥å…·&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Web æ§åˆ¶å°ï¼ˆç«¯å£ &lt;code&gt;15672&lt;/code&gt;ï¼‰ã€CLI å‘½ä»¤ &lt;code&gt;rabbitmqctl&lt;/code&gt;ã€Prometheus ç›‘æ§é›†æˆ&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å¤šè¯­è¨€æ”¯æŒ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å®˜æ–¹æ”¯æŒ Javaã€Pythonã€.NETã€Go ç­‰å®¢æˆ·ç«¯&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;æ’ä»¶æ‰©å±•&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ &lt;code&gt;rabbitmq_management&lt;/code&gt;ï¼ˆWebç®¡ç†ï¼‰ã€&lt;code&gt;rabbitmq_delayed_message_exchange&lt;/code&gt;ï¼ˆå»¶è¿Ÿæ¶ˆæ¯ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;èµ„æºéš”ç¦»&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ Virtual Host å®ç°å¤šç§Ÿæˆ·èµ„æºéš”ç¦»ï¼Œé¿å…é˜Ÿåˆ—å†²çª&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;RabbitMQ ä»¥ &lt;strong&gt;çµæ´»çš„è·¯ç”±ç­–ç•¥ã€å¾®ç§’çº§å»¶è¿Ÿå’Œæˆç†Ÿçš„å¯é æ€§æœºåˆ¶&lt;/strong&gt;ï¼Œæˆä¸ºä¼ä¸šçº§å¼‚æ­¥é€šä¿¡çš„é¦–é€‰ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦èƒ½åŠ›å¼º&lt;/strong&gt;ï¼šé€šè¿‡äº¤æ¢æœº-é˜Ÿåˆ—ç»‘å®šå®ç°åŠ¨æ€è·¯ç”±ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™æ€§é«˜&lt;/strong&gt;ï¼šæŒä¹…åŒ–+é›†ç¾¤+é•œåƒé˜Ÿåˆ—ä¿éšœæ¶ˆæ¯ä¸ä¸¢å¤±ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæ€å®Œå–„&lt;/strong&gt;ï¼šå¤šåè®®æ”¯æŒä¸å¯è§†åŒ–è¿ç»´é™ä½ä½¿ç”¨é—¨æ§›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…å•èŠ‚ç‚¹éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒï¼Œæ¨èé•œåƒé˜Ÿåˆ—é›†ç¾¤&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æµ·é‡æ¶ˆæ¯å †ç§¯ï¼ˆTBçº§ï¼‰åœºæ™¯ä¼˜å…ˆè€ƒè™‘ Kafka/RocketMQ&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="rabbitmq-å¤æ‚è·¯ç”±"&gt;RabbitMQ å¤æ‚è·¯ç”±
&lt;/h2&gt;&lt;p&gt;RabbitMQ æ”¯æŒå¤æ‚è·¯ç”±çš„æ ¸å¿ƒåŸå› åœ¨äºå…¶&lt;strong&gt;åŸºäºäº¤æ¢å™¨ï¼ˆExchangeï¼‰çš„æ¶æ„è®¾è®¡&lt;/strong&gt;ï¼Œè¿™ä¸€è®¾è®¡å°†æ¶ˆæ¯çš„å‘é€é€»è¾‘ä¸æ¥æ”¶é€»è¾‘è§£è€¦ï¼Œå¹¶é€šè¿‡å¤šç§äº¤æ¢å™¨ç±»å‹ã€ç»‘å®šè§„åˆ™å’Œè·¯ç”±é”®æœºåˆ¶å®ç°çµæ´»çš„æ¶ˆæ¯åˆ†å‘ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åŸå› åŠæŠ€æœ¯ç»†èŠ‚ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-äº¤æ¢å™¨exchangeçš„æŠ½è±¡ä¸è§£è€¦"&gt;ğŸ§© &lt;strong&gt;äº¤æ¢å™¨ï¼ˆExchangeï¼‰çš„æŠ½è±¡ä¸è§£è€¦&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;RabbitMQ çš„æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯&lt;strong&gt;ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…å®Œå…¨è§£è€¦&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…ä¸ç›´æ¥å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—&lt;/strong&gt;ï¼Œè€Œæ˜¯å‘é€åˆ°äº¤æ¢å™¨ï¼Œåªéœ€æŒ‡å®šäº¤æ¢å™¨åç§°å’Œè·¯ç”±é”®ï¼ˆRouting Keyï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…åªéœ€å…³æ³¨é˜Ÿåˆ—&lt;/strong&gt;ï¼Œæ— éœ€çŸ¥é“æ¶ˆæ¯æ¥æºæˆ–è·¯ç”±é€»è¾‘ã€‚
è¿™ç§è®¾è®¡å…è®¸&lt;strong&gt;åŠ¨æ€è°ƒæ•´è·¯ç”±è§„åˆ™&lt;/strong&gt;ï¼ˆå¦‚æ–°å¢é˜Ÿåˆ—æˆ–ä¿®æ”¹ç»‘å®šå…³ç³»ï¼‰ï¼Œè€Œæ— éœ€ä¿®æ”¹ç”Ÿäº§è€…çš„ä»£ç ï¼Œé€‚åº”ä¸šåŠ¡å˜åŒ–&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å››ç§äº¤æ¢å™¨ç±»å‹æ”¯æŒä¸åŒè·¯ç”±ç­–ç•¥"&gt;ğŸ”€ &lt;strong&gt;å››ç§äº¤æ¢å™¨ç±»å‹æ”¯æŒä¸åŒè·¯ç”±ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;RabbitMQ æä¾›å››ç§äº¤æ¢å™¨ç±»å‹ï¼Œè¦†ç›–ä»ç®€å•åˆ°å¤æ‚çš„è·¯ç”±åœºæ™¯ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;äº¤æ¢å™¨ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è·¯ç”±æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Directï¼ˆç›´è¿ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç²¾ç¡®åŒ¹é…è·¯ç”±é”®ï¼ˆRouting Key = Binding Keyï¼‰&lt;/td&gt;
&lt;td&gt;ä¸€å¯¹ä¸€ç²¾å‡†æŠ•é€’ï¼ˆå¦‚è®¢å•å¤„ç†ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜æ€§èƒ½ï¼Œæ— è®¡ç®—å¼€é”€&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Fanoutï¼ˆæ‰‡å‡ºï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿½ç•¥è·¯ç”±é”®ï¼Œå¹¿æ’­åˆ°æ‰€æœ‰ç»‘å®šé˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;æ—¥å¿—å¹¿æ’­ã€å®æ—¶é€šçŸ¥&lt;/td&gt;
&lt;td&gt;æ€§èƒ½å—é˜Ÿåˆ—æ•°é‡å½±å“&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Topicï¼ˆä¸»é¢˜ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è·¯ç”±é”®é€šé…ç¬¦åŒ¹é…ï¼ˆ&lt;code&gt;*&lt;/code&gt; åŒ¹é…ä¸€ä¸ªè¯ï¼Œ&lt;code&gt;#&lt;/code&gt; åŒ¹é…å¤šçº§è¯ï¼Œå¦‚ &lt;code&gt;order.*.payment&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å¤šç»´åº¦æ¶ˆæ¯åˆ†ç±»ï¼ˆå¦‚æŒ‰åœ°åŸŸ+ä¸šåŠ¡ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰ï¼Œé€šé…ç¬¦å¤æ‚åº¦å½±å“æ€§èƒ½&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Headersï¼ˆå¤´äº¤æ¢ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäºæ¶ˆæ¯å¤´å±æ€§ï¼ˆHeadersï¼‰åŒ¹é…ï¼Œæ”¯æŒ AND/OR é€»è¾‘&lt;/td&gt;
&lt;td&gt;å¤æ‚è¿‡æ»¤ï¼ˆå¦‚åŒæ—¶æ»¡è¶³ç”¨æˆ·ç±»å‹å’ŒåŒºåŸŸï¼‰&lt;/td&gt;
&lt;td&gt;æ€§èƒ½è¾ƒä½ï¼Œéœ€è®¡ç®—å¤´éƒ¨å±æ€§&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”µå•†ç³»ç»Ÿä¸­ï¼ŒTopic Exchange å¯å°† &lt;code&gt;order.us.payment&lt;/code&gt; è·¯ç”±åˆ°ç¾å›½æ”¯ä»˜é˜Ÿåˆ—ï¼Œ&lt;code&gt;order.eu.refund&lt;/code&gt;è·¯ç”±åˆ°æ¬§æ´²é€€æ¬¾é˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Headers Exchange å¯é€šè¿‡ &lt;code&gt;x-type: urgent&lt;/code&gt; å’Œ &lt;code&gt;x-region: north&lt;/code&gt; çš„ AND é€»è¾‘ï¼Œä»…æŠ•é€’åˆ°é«˜ä¼˜å…ˆçº§åŒ—æ–¹é˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ç»‘å®šbindingçš„åŠ¨æ€é…ç½®"&gt;âš™ï¸ &lt;strong&gt;ç»‘å®šï¼ˆBindingï¼‰çš„åŠ¨æ€é…ç½®&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç»‘å®šæ˜¯è¿æ¥äº¤æ¢å™¨ä¸é˜Ÿåˆ—çš„è§„åˆ™ï¼Œæ”¯æŒçµæ´»è°ƒæ•´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šé˜Ÿåˆ—ç»‘å®š&lt;/strong&gt;ï¼šä¸€ä¸ªäº¤æ¢å™¨å¯ç»‘å®šå¤šä¸ªé˜Ÿåˆ—ï¼Œå®ç°ä¸€å¯¹å¤šåˆ†å‘ï¼ˆå¦‚å¹¿æ’­æˆ–è´Ÿè½½å‡è¡¡ï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šè§„åˆ™ç»‘å®š&lt;/strong&gt;ï¼šä¸€ä¸ªé˜Ÿåˆ—å¯ç»‘å®šåˆ°å¤šä¸ªäº¤æ¢å™¨ï¼Œæˆ–é€šè¿‡ä¸åŒè·¯ç”±é”®ç»‘å®šåˆ°åŒä¸€äº¤æ¢å™¨ï¼Œå®ç°å¤šè·¯å¾„è·¯ç”±&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚
ä¾‹å¦‚ï¼Œæ—¥å¿—ç³»ç»Ÿå¯é€šè¿‡ Fanout Exchange å°†æ¶ˆæ¯åŒæ—¶å¹¿æ’­åˆ°å­˜å‚¨é˜Ÿåˆ—ã€æŠ¥è­¦é˜Ÿåˆ—å’Œå®¡è®¡é˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¯é æ€§æœºåˆ¶æ”¯æŒå¤æ‚è·¯ç”±çš„å¥å£®æ€§"&gt;ğŸ›¡ï¸ &lt;strong&gt;å¯é æ€§æœºåˆ¶æ”¯æŒå¤æ‚è·¯ç”±çš„å¥å£®æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å¤æ‚è·¯ç”±éœ€ç¡®ä¿æ¶ˆæ¯ä¸ä¸¢å¤±æˆ–è¯¯æŠ•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLXï¼‰&lt;/strong&gt;ï¼šè·¯ç”±å¤±è´¥çš„æ¶ˆæ¯ï¼ˆå¦‚æ— åŒ¹é…é˜Ÿåˆ—ï¼‰å¯è½¬å‘åˆ° DLX ä¾›äººå·¥å¤„ç†&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯ç¡®è®¤ï¼ˆACK/NACKï¼‰&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…å¤„ç†å¤±è´¥æ—¶ï¼Œå¯é€šè¿‡ NACK å°†æ¶ˆæ¯é‡æ–°å…¥é˜Ÿæˆ–è½¬å…¥ DLX&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒä¹…åŒ–&lt;/strong&gt;ï¼šäº¤æ¢å™¨ã€é˜Ÿåˆ—å’Œæ¶ˆæ¯å‡å¯æŒä¹…åŒ–ï¼Œé¿å…é‡å¯åè·¯ç”±è§„åˆ™ä¸¢å¤±&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ’ä»¶ä½“ç³»æ‰©å±•è·¯ç”±èƒ½åŠ›"&gt;ğŸŒ &lt;strong&gt;æ’ä»¶ä½“ç³»æ‰©å±•è·¯ç”±èƒ½åŠ›&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;RabbitMQ çš„æ’ä»¶æœºåˆ¶è¿›ä¸€æ­¥æ‰©å±•äº†è·¯ç”±åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿæ¶ˆæ¯æ’ä»¶ï¼ˆ&lt;code&gt;rabbitmq-delayed-message-exchange&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼šæ”¯æŒå®šæ—¶è·¯ç”±ï¼ˆå¦‚ 30 åˆ†é’Ÿåå¤„ç†è¶…æ—¶è®¢å•ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åè®®è½¬æ¢æ’ä»¶&lt;/strong&gt;ï¼šæ”¯æŒ MQTTã€STOMP ç­‰åè®®ï¼Œå°†ä¸åŒåè®®çš„æ¶ˆæ¯è·¯ç”±åˆ°ç»Ÿä¸€é˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸ºä½•-rabbitmq-æ“…é•¿å¤æ‚è·¯ç”±"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šä¸ºä½• RabbitMQ æ“…é•¿å¤æ‚è·¯ç”±ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶æ„åŸºå› &lt;/strong&gt;ï¼šäº¤æ¢å™¨-é˜Ÿåˆ—çš„åˆ†ç¦»è®¾è®¡æ˜¯å¤æ‚è·¯ç”±çš„åŸºçŸ³&lt;a class="link" href="@ref" &gt;2,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯è¦†ç›–&lt;/strong&gt;ï¼šå››ç§äº¤æ¢å™¨ç±»å‹è¦†ç›–ä»ç²¾ç¡®åŒ¹é…åˆ°å¤šå±æ€§è¿‡æ»¤çš„å…¨åœºæ™¯éœ€æ±‚&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ€§&lt;/strong&gt;ï¼šç»‘å®šè§„åˆ™å¯åŠ¨æ€è°ƒæ•´ï¼Œé€‚åº”ä¸šåŠ¡å˜åŒ–&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é æ€§å…œåº•&lt;/strong&gt;ï¼šæ­»ä¿¡é˜Ÿåˆ—å’ŒæŒä¹…åŒ–æœºåˆ¶ä¿éšœè·¯ç”±å¤±è´¥æ—¶çš„æ•°æ®å®‰å…¨&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;ï¼š
å¤æ‚è·¯ç”±å¯èƒ½ç‰ºç‰²éƒ¨åˆ†æ€§èƒ½ï¼ˆå¦‚ Headers Exchange çš„å¤´éƒ¨åŒ¹é…ï¼‰ï¼Œåœ¨è¶…é«˜é¢‘åœºæ™¯ï¼ˆ&amp;gt;10ä¸‡/ç§’ï¼‰å»ºè®®ç”¨ Topic æˆ– Direct ç®€åŒ–é€»è¾‘ï¼Œæˆ–é€‰ç”¨ Kafka ç­‰ååä¼˜å…ˆçš„ä¸­é—´ä»¶&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¤šé˜Ÿåˆ—æ¶ˆè´¹"&gt;å¤šé˜Ÿåˆ—æ¶ˆè´¹
&lt;/h2&gt;&lt;p&gt;åŒä¸€æ¶ˆæ¯è¢«æ¶ˆè´¹ä¸¤æ¬¡çš„å®ç°æ–¹å¼å–å†³äºä¸šåŠ¡åœºæ™¯éœ€æ±‚ï¼Œ&lt;strong&gt;ä¸ä¸€å®šéœ€è¦ä¸¤ä¸ªé˜Ÿåˆ—&lt;/strong&gt;ã€‚å…·ä½“å®ç°è·¯å¾„å¯åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æ¨¡å¼ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¤šé˜Ÿåˆ—æ¨¡å¼å¹¿æ’­æœºåˆ¶"&gt;ğŸ”„ &lt;strong&gt;å¤šé˜Ÿåˆ—æ¨¡å¼ï¼ˆå¹¿æ’­æœºåˆ¶ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é€‚ç”¨äº&lt;strong&gt;ä¸åŒä¸šåŠ¡é€»è¾‘éœ€è¦ç‹¬ç«‹å¤„ç†åŒä¸€æ¶ˆæ¯&lt;/strong&gt;çš„åœºæ™¯ï¼ˆå¦‚è®¢å•åˆ›å»ºåéœ€åŒæ—¶è§¦å‘åº“å­˜æ‰£å‡å’Œæ—¥å¿—è®°å½•ï¼‰ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Fanout Exchangeå¹¿æ’­&lt;/strong&gt;ï¼šç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€è‡³Fanoutç±»å‹äº¤æ¢æœºï¼Œè¯¥äº¤æ¢æœºä¼šå°†æ¶ˆæ¯&lt;strong&gt;åŒæ—¶å¤åˆ¶&lt;/strong&gt;åˆ°æ‰€æœ‰ç»‘å®šçš„é˜Ÿåˆ—ï¼ˆæ¯ä¸ªé˜Ÿåˆ—è·å¾—ä¸€ä»½ç‹¬ç«‹çš„æ¶ˆæ¯å‰¯æœ¬ï¼‰&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šé˜Ÿåˆ—ç‹¬ç«‹æ¶ˆè´¹&lt;/strong&gt;ï¼šæ¯ä¸ªé˜Ÿåˆ—çš„æ¶ˆè´¹è€…ä»…å¤„ç†è‡ªå·±é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å‰¯æœ¬ï¼Œäº’ä¸å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ç”Ÿäº§è€… â†’ Fanout Exchange â†’ é˜Ÿåˆ—Aï¼ˆåº“å­˜æœåŠ¡æ¶ˆè´¹ï¼‰
â†’ é˜Ÿåˆ—Bï¼ˆæ—¥å¿—æœåŠ¡æ¶ˆè´¹ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡è§£è€¦&lt;/strong&gt;ï¼šä¸åŒæ¶ˆè´¹è€…å¤„ç†é€»è¾‘å®Œå…¨ç‹¬ç«‹ï¼ˆå¦‚åº“å­˜æ‰£å‡å¤±è´¥ä¸å½±å“æ—¥å¿—è®°å½•ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œæ€§é«˜&lt;/strong&gt;ï¼šå¤šä¸ªæœåŠ¡åŒæ—¶æ¶ˆè´¹ï¼Œæå‡å¤„ç†æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å†—ä½™&lt;/strong&gt;ï¼šæ¶ˆæ¯åœ¨å¤šä¸ªé˜Ÿåˆ—ä¸­é‡å¤å­˜å‚¨ï¼Œå¢åŠ å­˜å‚¨å¼€é”€&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€é¢å¤–è®¾è®¡&lt;/strong&gt;ï¼šéœ€æ˜¾å¼å®šä¹‰å¤šä¸ªé˜Ÿåˆ—å’Œç»‘å®šè§„åˆ™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å•é˜Ÿåˆ—æ¨¡å¼é‡è¯•é‡æ”¾æœºåˆ¶"&gt;ğŸ” &lt;strong&gt;å•é˜Ÿåˆ—æ¨¡å¼ï¼ˆé‡è¯•/é‡æ”¾æœºåˆ¶ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é€‚ç”¨äº&lt;strong&gt;åŒä¸€ä¸šåŠ¡é€»è¾‘éœ€é‡è¯•æˆ–å›æº¯æ¶ˆæ¯&lt;/strong&gt;çš„åœºæ™¯ï¼ˆå¦‚æ”¯ä»˜å¤±è´¥åé‡è¯•ï¼‰ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯é‡å…¥é˜Ÿï¼ˆRequeueï¼‰&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…å¤„ç†å¤±è´¥æ—¶ï¼Œé€šè¿‡ &lt;code&gt;basic_nack(requeue=true)&lt;/code&gt; å°†æ¶ˆæ¯&lt;strong&gt;é‡æ–°æ”¾å›åŸé˜Ÿåˆ—å¤´éƒ¨&lt;/strong&gt;ï¼Œç­‰å¾…å†æ¬¡è¢«æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLXï¼‰+ TTLï¼š
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯å¤„ç†å¤±è´¥åè½¬å‘è‡³æ­»ä¿¡é˜Ÿåˆ—ï¼Œç­‰å¾…TTLè¿‡æœŸå&lt;strong&gt;è‡ªåŠ¨è½¬å›åŸé˜Ÿåˆ—&lt;/strong&gt;é‡è¯•&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;åŸé˜Ÿåˆ— â†’ æ¶ˆè´¹å¤±è´¥ â†’ æ­»ä¿¡é˜Ÿåˆ—ï¼ˆç­‰å¾…TTLè¶…æ—¶ï¼‰â†’ è‡ªåŠ¨è½¬å›åŸé˜Ÿåˆ— â†’ é‡æ–°æ¶ˆè´¹
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºèŠ‚çœ&lt;/strong&gt;ï¼šä»…éœ€ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ— å†—ä½™å­˜å‚¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–æ¶æ„&lt;/strong&gt;ï¼šæ— éœ€é¢å¤–ç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é‡å¤æ¶ˆè´¹é£é™©&lt;/strong&gt;ï¼šéœ€æ¶ˆè´¹è€…ç«¯å®ç°&lt;strong&gt;å¹‚ç­‰æ€§&lt;/strong&gt;ï¼ˆå¦‚é€šè¿‡Redisè®°å½•æ¶ˆæ¯IDï¼‰ï¼Œé¿å…ä¸šåŠ¡é€»è¾‘é‡å¤æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºå½±å“&lt;/strong&gt;ï¼šé‡å…¥é˜Ÿçš„æ¶ˆæ¯å›åˆ°é˜Ÿåˆ—å¤´éƒ¨ï¼Œå¯èƒ½é˜»å¡åç»­æ¶ˆæ¯å¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹å»ºè®®"&gt;âš–ï¸ &lt;strong&gt;æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é˜Ÿåˆ—æ•°é‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å¤šä¸šåŠ¡ç‹¬ç«‹å¤„ç†ï¼ˆå¦‚è®¢å•+æ—¥å¿—ï¼‰&lt;/td&gt;
&lt;td&gt;Fanoutå¹¿æ’­&lt;/td&gt;
&lt;td&gt;å¤šä¸ªé˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;âœ… é«˜å¹¶å‘ã€é€»è¾‘è§£è€¦åœºæ™¯&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯å†—ä½™å­˜å‚¨ï¼Œéœ€è§„åˆ’é˜Ÿåˆ—æ•°é‡&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å•ä¸šåŠ¡é‡è¯•ï¼ˆå¦‚æ”¯ä»˜å¤±è´¥ï¼‰&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯é‡å…¥é˜Ÿ/DLX&lt;/td&gt;
&lt;td&gt;å•é˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;âœ… èµ„æºæ•æ„Ÿã€éœ€é‡è¯•çš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;å¿…é¡»å®ç°å¹‚ç­‰æ€§&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è·¨æœåŠ¡æ•°æ®å¤ç”¨ï¼ˆå¦‚æ—¥å¿—åˆ†æï¼‰&lt;/td&gt;
&lt;td&gt;Kafkaæ¶ˆè´¹è€…ç»„&lt;/td&gt;
&lt;td&gt;æ— éœ€é¢å¤–é˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;âœ… å¤§è§„æ¨¡æ•°æ®å¤ç”¨åœºæ™¯&lt;/td&gt;
&lt;td&gt;éœ€åˆ‡æ¢è‡³Kafka/RocketMQ&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰æ€§è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ— è®ºå•é˜Ÿåˆ—é‡è¯•æˆ–å¤šé˜Ÿåˆ—æ¶ˆè´¹ï¼Œå‡éœ€é€šè¿‡ &lt;strong&gt;å”¯ä¸€æ¶ˆæ¯ID + å»é‡å­˜å‚¨&lt;/strong&gt;ï¼ˆå¦‚Redisæˆ–æ•°æ®åº“ï¼‰ä¿è¯ä¸šåŠ¡é€»è¾‘çš„å¹‚ç­‰æ€§&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ä»£ç ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ£€æŸ¥Redisæ˜¯å¦å·²å¤„ç†è¿‡è¯¥æ¶ˆæ¯
if (!redis.setIfAbsent(messageId, &amp;#34;processed&amp;#34;, TTL)) {
return; // å·²å¤„ç†åˆ™è·³è¿‡
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜Ÿåˆ—æ¨¡å‹å·®å¼‚&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;ï¼šéœ€æ˜¾å¼åˆ›å»ºå¤šé˜Ÿåˆ—å®ç°å¹¿æ’­ï¼ˆFanoutï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kafka/RocketMQ&lt;/strong&gt;ï¼šåŸç”Ÿæ”¯æŒå¤šæ¶ˆè´¹è€…ç»„ç‹¬ç«‹æ¶ˆè´¹åŒä¸€æ¶ˆæ¯ï¼ˆå•é˜Ÿåˆ—å¤šç»„æ¶ˆè´¹ï¼‰&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¤šé˜Ÿåˆ—å¹¿æ’­ â†’ æå‡å¹¶è¡Œåº¦ä½†å¢åŠ I/Oå‹åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;å•é˜Ÿåˆ—é‡è¯• â†’ èŠ‚çœèµ„æºä½†é‡è¯•å¯èƒ½é˜»å¡é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-11"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦ä¸¤ä¸ªé˜Ÿåˆ—&lt;/strong&gt;ï¼šå½“åŒä¸€æ¶ˆæ¯éœ€è¢«&lt;strong&gt;ä¸åŒä¸šåŠ¡é€»è¾‘ç‹¬ç«‹å¤„ç†&lt;/strong&gt;æ—¶ï¼ˆå¦‚è®¢å•å¤„ç†ä¸æ—¥å¿—è®°å½•ï¼‰ï¼Œå¿…é¡»é€šè¿‡å¤šé˜Ÿåˆ—ï¼ˆFanoutå¹¿æ’­ï¼‰å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— éœ€ä¸¤ä¸ªé˜Ÿåˆ—&lt;/strong&gt;ï¼šå½“åŒä¸€æ¶ˆæ¯éœ€è¢«&lt;strong&gt;åŒä¸€ä¸šåŠ¡é€»è¾‘é‡è¯•æˆ–å›æº¯&lt;/strong&gt;æ—¶ï¼Œå•é˜Ÿåˆ—é…åˆé‡è¯•æœºåˆ¶ï¼ˆé‡å…¥é˜Ÿ/DLXï¼‰å³å¯å®ç°ï¼Œä¸”æ›´èŠ‚çœèµ„æºã€‚
â€‹&lt;strong&gt;é€‰å‹å…³é”®&lt;/strong&gt;â€‹ï¼šæ ¹æ®ä¸šåŠ¡åœºæ™¯çš„å¹¶è¡Œæ€§éœ€æ±‚ä¸èµ„æºé™åˆ¶æƒè¡¡é€‰æ‹©ï¼Œå¹¶å§‹ç»ˆé€šè¿‡å¹‚ç­‰æ€§è®¾è®¡è§„é¿é‡å¤æ¶ˆè´¹é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="rocketmq"&gt;ROCKETMQ
&lt;/h2&gt;&lt;p&gt;RocketMQ æ˜¯ç”±é˜¿é‡Œå·´å·´å¼€å‘çš„&lt;strong&gt;åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶&lt;/strong&gt;ï¼Œç°ä¸º Apache é¡¶çº§é¡¹ç›®ï¼Œä¸“ä¸ºé«˜å¹¶å‘ã€é«˜å¯é ã€ä½å»¶è¿Ÿçš„åœºæ™¯è®¾è®¡ï¼Œå°¤å…¶é€‚åˆå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæ¶æ„ã€ç‰¹æ€§ã€åº”ç”¨åœºæ™¯ç­‰ç»´åº¦å…¨é¢è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¶æ„ä¸ç»„ä»¶-1"&gt;ğŸ§© æ ¸å¿ƒæ¶æ„ä¸ç»„ä»¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;NameServerï¼ˆæ³¨å†Œä¸­å¿ƒï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡çº§æœåŠ¡å‘ç°&lt;/strong&gt;ï¼šè®°å½•æ‰€æœ‰ Broker çš„è·¯ç”±ä¿¡æ¯ï¼ˆTopicã€é˜Ÿåˆ—ç­‰ï¼‰ï¼ŒèŠ‚ç‚¹é—´æ— é€šä¿¡ï¼Œå¯æ¨ªå‘æ‰©å±•&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;ï¼šProducer/Consumer å¯åŠ¨æ—¶è¿æ¥ NameServer è·å– Broker åœ°å€ï¼Œåç»­ç›´æ¥ä¸ Broker é€šä¿¡&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Brokerï¼ˆæ¶ˆæ¯å­˜å‚¨ä¸­å¿ƒï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸»ä»æ¶æ„ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Master&lt;/strong&gt;ï¼šå¤„ç†è¯»å†™è¯·æ±‚ï¼›&lt;strong&gt;Slave&lt;/strong&gt;ï¼šå¼‚æ­¥/åŒæ­¥å¤åˆ¶æ•°æ®ï¼ˆåŒæ­¥å¤åˆ¶ä¿è¯é›¶ä¸¢å¤±ï¼Œå¼‚æ­¥å¤åˆ¶æ€§èƒ½æ›´é«˜ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;éƒ¨ç½²æ¨¡å¼ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å• Master&lt;/td&gt;
&lt;td&gt;é…ç½®ç®€å•&lt;/td&gt;
&lt;td&gt;å•ç‚¹æ•…éšœå¯¼è‡´æœåŠ¡ä¸å¯ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤š Master&lt;/td&gt;
&lt;td&gt;é«˜ååï¼Œå•èŠ‚ç‚¹æ•…éšœä¸å½±å“æ•´ä½“&lt;/td&gt;
&lt;td&gt;å®•æœºæœŸé—´éƒ¨åˆ†æ¶ˆæ¯ä¸å¯æ¶ˆè´¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤š Master å¤š Slaveï¼ˆå¼‚æ­¥ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜å¯ç”¨ï¼Œæ¶ˆæ¯ä¸¢å¤±æå°‘&lt;/td&gt;
&lt;td&gt;ä¸»å¤‡å»¶è¿Ÿæ¯«ç§’çº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤š Master å¤š Slaveï¼ˆåŒæ­¥ï¼‰&lt;/td&gt;
&lt;td&gt;æ•°æ®é›¶ä¸¢å¤±ï¼Œé«˜å¯ç”¨&lt;/td&gt;
&lt;td&gt;æ€§èƒ½ç•¥ä½ï¼Œå»¶è¿Ÿè¾ƒé«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨æœºåˆ¶&lt;/strong&gt;ï¼šæ¶ˆæ¯æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ”¯æŒåŒæ­¥/å¼‚æ­¥åˆ·ç›˜ï¼ˆåŒæ­¥åˆ·ç›˜æ›´å¯é ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Producerï¼ˆç”Ÿäº§è€…ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å‘é€æ¨¡å¼ï¼š&lt;strong&gt;åŒæ­¥&lt;/strong&gt;ï¼ˆé˜»å¡ç­‰å¾… ACKï¼‰ã€&lt;strong&gt;å¼‚æ­¥&lt;/strong&gt;ï¼ˆå›è°ƒé€šçŸ¥ï¼‰ã€&lt;strong&gt;å•å‘&lt;/strong&gt;ï¼ˆä¸å…³æ³¨ç»“æœï¼Œå¦‚æ—¥å¿—ï¼‰&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ•é€’ç­–ç•¥&lt;/strong&gt;ï¼šæ”¯æŒè½®è¯¢ã€Hash åˆ†é…ã€æœºæˆ¿å°±è¿‘åˆ†é…ç­‰ï¼Œç¡®ä¿æ¶ˆæ¯å‡åŒ€åˆ†å¸ƒåˆ°é˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹æ¨¡å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Push æ¨¡å¼&lt;/strong&gt;ï¼šBroker ä¸»åŠ¨æ¨é€æ¶ˆæ¯ï¼ˆæ¨èï¼Œå®æ—¶æ€§é«˜ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Pull æ¨¡å¼&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…ä¸»åŠ¨æ‹‰å–æ¶ˆæ¯ï¼ˆçµæ´»æ€§é«˜ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹åˆ†ç»„ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤æ¶ˆè´¹ï¼ˆClusteringï¼‰&lt;/strong&gt;ï¼šåŒç»„æ¶ˆè´¹è€…åˆ†æ‘Šæ¶ˆæ¯ï¼ˆé»˜è®¤ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¿æ’­æ¶ˆè´¹ï¼ˆBroadcastingï¼‰&lt;/strong&gt;ï¼šæ¯æ¡æ¶ˆæ¯è¢«æ‰€æœ‰æ¶ˆè´¹è€…æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§"&gt;âš™ï¸ æ ¸å¿ƒç‰¹æ€§
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯ç±»å‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºæ¶ˆæ¯&lt;/strong&gt;ï¼š&lt;strong&gt;å±€éƒ¨é¡ºåº&lt;/strong&gt;ï¼ˆåŒä¸€é˜Ÿåˆ— FIFOï¼‰å’Œ&lt;strong&gt;å…¨å±€é¡ºåº&lt;/strong&gt;ï¼ˆå•é˜Ÿåˆ—ï¼Œæ€§èƒ½å—é™ï¼‰&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æ¶ˆæ¯&lt;/strong&gt;ï¼š&lt;strong&gt;å”¯ä¸€æ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡&lt;/strong&gt;çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆå¦‚è®¢å•åˆ›å»º+åº“å­˜æ‰£å‡çš„åŸå­æ€§ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿæ¶ˆæ¯&lt;/strong&gt;ï¼šæ”¯æŒ 18 ä¸ªå»¶è¿Ÿçº§åˆ«ï¼ˆå¦‚ 30 åˆ†é’Ÿæœªæ”¯ä»˜è®¢å•è‡ªåŠ¨å…³é—­ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æº¯æ¶ˆè´¹&lt;/strong&gt;ï¼šå¯æŒ‰æ—¶é—´æˆ³æˆ–åç§»é‡é‡æ–°æ¶ˆè´¹å†å²æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é æ€§ä¿éšœ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯é‡è¯•&lt;/strong&gt;ï¼šæ¶ˆè´¹å¤±è´¥åè¿›å…¥é‡è¯•é˜Ÿåˆ—ï¼Œé˜¶æ¢¯å¼é‡è¯•ï¼ˆé—´éš”é€æ¸å¢åŠ ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLQï¼‰&lt;/strong&gt;ï¼šé‡è¯•è¶…é™çš„æ¶ˆæ¯è½¬å…¥ DLQï¼Œä¾›äººå·¥å¤„ç†&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰æ€§&lt;/strong&gt;ï¼šéœ€ä¸šåŠ¡å±‚å®ç°ï¼ˆå¦‚é€šè¿‡å”¯ä¸€æ¶ˆæ¯ ID + Redis å»é‡ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ€§èƒ½è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº¿çº§æ¶ˆæ¯å †ç§¯&lt;/strong&gt;ï¼šå•é˜Ÿåˆ—ç™¾ä¸‡çº§æ¶ˆæ¯å †ç§¯ä¸‹ä»ä¿æŒä½å»¶è¿Ÿå†™å…¥&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›¶æ‹·è´æŠ€æœ¯&lt;/strong&gt;ï¼šå‡å°‘æ•°æ®æ‹·è´æ¬¡æ•°ï¼Œæå‡ååé‡&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯-1"&gt;ğŸ› ï¸ å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”µå•†ç³»ç»Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®¢å•æµç¨‹&lt;/strong&gt;ï¼šè®¢å•åˆ›å»º â†’ åº“å­˜æ‰£å‡ â†’ æ”¯ä»˜é€šçŸ¥ â†’ ç‰©æµæ›´æ–°ï¼Œé€šè¿‡äº‹åŠ¡æ¶ˆæ¯ä¿è¯ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç§’æ€æ´»åŠ¨&lt;/strong&gt;ï¼šæµé‡å‰Šå³°ï¼Œè¯·æ±‚å¼‚æ­¥å†™å…¥é˜Ÿåˆ—ï¼Œé¿å…ç³»ç»Ÿå´©æºƒ&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡‘èäº¤æ˜“&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼äº‹åŠ¡&lt;/strong&gt;ï¼šè·¨ç³»ç»Ÿè½¬è´¦åœºæ™¯ï¼Œé€šè¿‡äº‹åŠ¡æ¶ˆæ¯ç¡®ä¿èµ„é‡‘æ“ä½œåŸå­æ€§&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—æ”¶é›†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æµ·é‡æ—¥å¿—å¼‚æ­¥å†™å…¥ RocketMQï¼Œç”±æ¶ˆè´¹è€…æ‰¹é‡å¯¼å…¥ ElasticSearch/Hadoop&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶é€šçŸ¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¨é€ç”¨æˆ·è¡Œä¸ºæ¶ˆæ¯ï¼ˆå¦‚ä¼˜æƒ åˆ¸å‘æ”¾ï¼‰ï¼Œæ”¯æŒ Tag è¿‡æ»¤ï¼ˆå¦‚ä»…æ¨é€ç»™ç‰¹å®šåœ°åŒºç”¨æˆ·ï¼‰&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é›†ç¾¤éƒ¨ç½²ä¸è¿ç»´"&gt;âš¡ é›†ç¾¤éƒ¨ç½²ä¸è¿ç»´
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éƒ¨ç½²æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯åŠ¨ NameServer â†’ å¯åŠ¨ Brokerï¼ˆä¸»ä»é…ç½®éœ€æŒ‡å®š &lt;code&gt;brokerId&lt;/code&gt;ï¼š0 ä¸ºä¸»ï¼Œ&amp;gt;0 ä¸ºä»ï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å‘½ä»¤ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;# å¯åŠ¨ NameServer
nohup sh bin/mqnamesrv &amp;gt; logs/mqnamesrv.log 2&amp;gt;&amp;amp;1 &amp;amp;
# å¯åŠ¨ Brokerï¼ˆä¸»èŠ‚ç‚¹ï¼‰
nohup sh bin/mqbroker -c conf/broker-a.properties &amp;gt; logs/broker.log 2&amp;gt;&amp;amp;1 &amp;amp; [3](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å·¥å…·&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶å° Dashboard&lt;/strong&gt;ï¼šå¯è§†åŒ–æŸ¥çœ‹ Topicã€é˜Ÿåˆ—å †ç§¯ã€æ¶ˆè´¹è€…çŠ¶æ€ç­‰&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Prometheus é›†æˆ&lt;/strong&gt;ï¼šç›‘æ§é›†ç¾¤æ€§èƒ½æŒ‡æ ‡ï¼ˆå¦‚æ¶ˆæ¯ååé‡ã€å»¶è¿Ÿï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¼€å‘å®æˆ˜ç¤ºä¾‹"&gt;ğŸ”„ å¼€å‘å®æˆ˜ç¤ºä¾‹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…å‘é€æ¶ˆæ¯&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;DefaultMQProducer producer = new DefaultMQProducer(&amp;#34;producer_group&amp;#34;);
producer.setNamesrvAddr(&amp;#34;localhost:9876&amp;#34;);
producer.start();
Message msg = new Message(&amp;#34;OrderTopic&amp;#34;, &amp;#34;TagA&amp;#34;, &amp;#34;è®¢å•001&amp;#34;.getBytes());
SendResult result = producer.send(msg); // åŒæ­¥å‘é€
producer.shutdown(); [8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…ç›‘å¬æ¶ˆæ¯&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(&amp;#34;consumer_group&amp;#34;);
consumer.subscribe(&amp;#34;OrderTopic&amp;#34;, &amp;#34;TagA || TagB&amp;#34;); // è®¢é˜… TagA æˆ– TagB
consumer.registerMessageListener((msgs, context) -&amp;gt; {
for (MessageExt msg : msgs) {
System.out.println(&amp;#34;æ”¶åˆ°æ¶ˆæ¯: &amp;#34; + new String(msg.getBody()));
}
return ConsumeConcurrentlyStatus.CONSUME_SUCCESS; // æ¶ˆè´¹æˆåŠŸ
});
consumer.start(); [4,8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¯¹æ¯”å…¶ä»–æ¶ˆæ¯ä¸­é—´ä»¶-1"&gt;âš–ï¸ å¯¹æ¯”å…¶ä»–æ¶ˆæ¯ä¸­é—´ä»¶
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;RocketMQ&lt;/th&gt;
&lt;th&gt;Kafka&lt;/th&gt;
&lt;th&gt;RabbitMQ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é¡ºåºæ¶ˆæ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… é˜Ÿåˆ—çº§ä¸¥æ ¼é¡ºåº&lt;/td&gt;
&lt;td&gt;âœ… åˆ†åŒºå†…é¡ºåº&lt;/td&gt;
&lt;td&gt;âŒ ä»…åŸºç¡€ FIFO&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡æ¶ˆæ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… åŸç”Ÿæ”¯æŒ&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;âŒ éœ€æ’ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å»¶è¿Ÿæ¶ˆæ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… 18 ä¸ªçº§åˆ«&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;âœ… ä»»æ„ç²¾åº¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å †ç§¯èƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆäº¿çº§ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­â­â­ï¼ˆæ›´é«˜ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆä¸‡çº§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è·¯ç”±çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­ï¼ˆTag è¿‡æ»¤ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆKey åˆ†åŒºï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆ4 ç§äº¤æ¢æœºï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”µå•†/é‡‘èäº‹åŠ¡&lt;/td&gt;
&lt;td&gt;æ—¥å¿—æµå¤„ç†&lt;/td&gt;
&lt;td&gt;å¤æ‚è·¯ç”±ä¼ä¸šåº”ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-12"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šé«˜å¯é äº‹åŠ¡æ¶ˆæ¯ã€æµ·é‡å †ç§¯èƒ½åŠ›ã€é‡‘èçº§æ•°æ®ä¸€è‡´æ€§ä¿éšœ&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šç”µå•†äº¤æ˜“ã€é‡‘èæ¸…ç®—ã€æ—¥å¿—æ”¶é›†ç­‰é«˜å¹¶å‘å¼ºä¸€è‡´éœ€æ±‚é¢†åŸŸ&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é¿å‘å»ºè®®ï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…å• Master éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒï¼Œæ¨èå¤š Master å¤š Slaveï¼ˆåŒæ­¥å¤åˆ¶ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹ç«¯åŠ¡å¿…å®ç°å¹‚ç­‰æ€§ï¼Œé˜²æ­¢é‡å¤æ¶ˆè´¹å¯¼è‡´ä¸šåŠ¡å¼‚å¸¸&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚éœ€è¿›ä¸€æ­¥å®è·µï¼Œå¯å‚è€ƒ &lt;a class="link" href="https://rocketmq.apache.org/" target="_blank" rel="noopener"
&gt;RocketMQ å®˜æ–¹æ–‡æ¡£&lt;/a&gt; æˆ–å¼€æºç¤¾åŒºç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="commitlog"&gt;CommitLog
&lt;/h2&gt;&lt;p&gt;RocketMQ çš„ &lt;strong&gt;CommitLog&lt;/strong&gt; æ˜¯å…¶å­˜å‚¨æ¶æ„çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£æ‰€æœ‰æ¶ˆæ¯çš„ç‰©ç†æŒä¹…åŒ–ï¼Œå…¶è®¾è®¡é€šè¿‡é¡ºåºå†™å…¥ã€é›¶æ‹·è´ã€å¼‚æ­¥æ„å»ºç´¢å¼•ç­‰æœºåˆ¶å®ç°é«˜ååä¸é«˜å¯é ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒåŸç†ä¸å·¥ä½œæœºåˆ¶çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-commitlog-çš„æ ¸å¿ƒä½œç”¨"&gt;ğŸ“‚ &lt;strong&gt;CommitLog çš„æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†å­˜å‚¨ä¸»ä½“&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰æ¶ˆæ¯ç»Ÿä¸€å­˜å‚¨&lt;/strong&gt;ï¼šæ— è®ºå±äºå“ªä¸ª Topic æˆ– Queueï¼Œæ‰€æœ‰æ¶ˆæ¯å‡æŒ‰&lt;strong&gt;å†™å…¥é¡ºåº&lt;/strong&gt;è¿½åŠ åˆ° CommitLog æ–‡ä»¶ï¼Œå½¢æˆå…¨å±€è¿ç»­çš„æ¶ˆæ¯æµ&lt;a class="link" href="@ref" &gt;1,7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨å†…å®¹&lt;/strong&gt;ï¼šæ¶ˆæ¯ä½“ï¼ˆBodyï¼‰ã€Topicã€é˜Ÿåˆ— IDã€ç”Ÿäº§è€…åœ°å€ã€æ¶ˆæ¯å±æ€§ç­‰è¿‘ 20 é¡¹å…ƒæ•°æ®&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ€å¤§åŒ–å†™å…¥æ€§èƒ½&lt;/strong&gt;ï¼šé€šè¿‡&lt;strong&gt;é¡ºåºå†™ç›˜&lt;/strong&gt;é¿å…éšæœº I/Oï¼Œå•æœºå¯æ”¯æŒç™¾ä¸‡çº§ TPS&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦å­˜å‚¨ä¸æ¶ˆè´¹&lt;/strong&gt;ï¼šç‰©ç†å­˜å‚¨ï¼ˆCommitLogï¼‰ä¸é€»è¾‘ç´¢å¼•ï¼ˆConsumeQueueï¼‰åˆ†ç¦»ï¼Œæå‡æ‰©å±•æ€§&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨ç»“æ„ä¸æ–‡ä»¶ç®¡ç†"&gt;âš™ï¸ &lt;strong&gt;å­˜å‚¨ç»“æ„ä¸æ–‡ä»¶ç®¡ç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶ç»„ç»‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç‰‡æœºåˆ¶&lt;/strong&gt;ï¼šå•ä¸ª CommitLog æ–‡ä»¶å›ºå®šå¤§å°ï¼ˆé»˜è®¤ &lt;strong&gt;1GB&lt;/strong&gt;ï¼‰ï¼Œå†™æ»¡ååˆ›å»ºæ–°æ–‡ä»¶&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶åè§„åˆ™&lt;/strong&gt;ï¼šä»¥ &lt;strong&gt;20 ä½æ•°å­—&lt;/strong&gt;å‘½åï¼Œè¡¨ç¤ºæ–‡ä»¶èµ·å§‹åç§»é‡ï¼ˆå¦‚ &lt;code&gt;00000000000000000000&lt;/code&gt; è¡¨ç¤ºåç§»é‡ 0ï¼Œç¬¬äºŒä¸ªæ–‡ä»¶ä¸º &lt;code&gt;00000000001073741824&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨è·¯å¾„&lt;/strong&gt;ï¼šé»˜è®¤ä½äº &lt;code&gt;${storePathRootDir}/commitlog&lt;/code&gt;&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™å…¥æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºè¿½åŠ &lt;/strong&gt;ï¼šæ¶ˆæ¯æŒ‰åˆ°è¾¾ Broker çš„é¡ºåºå†™å…¥å½“å‰æ´»è·ƒæ–‡ä»¶&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜æ˜ å°„ä¼˜åŒ–&lt;/strong&gt;ï¼šé€šè¿‡ &lt;strong&gt;&lt;code&gt;MappedByteBuffer&lt;/code&gt;&lt;/strong&gt; å°†æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ï¼ˆmmap æŠ€æœ¯ï¼‰ï¼Œå‡å°‘å†…æ ¸æ€ä¸ç”¨æˆ·æ€æ•°æ®æ‹·è´ï¼ˆé›¶æ‹·è´ï¼‰&lt;a class="link" href="@ref" &gt;2,7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–æœºåˆ¶"&gt;ğŸ”§ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ·ç›˜ç­–ç•¥ï¼ˆæŒä¹…åŒ–ä¿éšœï¼‰&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒæ­¥åˆ·ç›˜ï¼ˆ&lt;code&gt;SYNC_FLUSH&lt;/code&gt;ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯å†™å…¥ç£ç›˜åæ‰è¿”å› ACKï¼Œç¡®ä¿å®•æœºä¸ä¸¢å¤±æ•°æ®ã€‚&lt;/td&gt;
&lt;td&gt;é‡‘èäº¤æ˜“ã€è®¢å•æ”¯ä»˜ç­‰é«˜å¯é æ€§åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼‚æ­¥åˆ·ç›˜ï¼ˆ&lt;code&gt;ASYNC_FLUSH&lt;/code&gt;ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯å†™å…¥ PageCache åç«‹å³è¿”å› ACKï¼Œåå°çº¿ç¨‹å®šæœŸåˆ·ç›˜ã€‚&lt;/td&gt;
&lt;td&gt;æ—¥å¿—æ”¶é›†ã€ååä¼˜å…ˆåœºæ™¯ï¼ˆé»˜è®¤ç­–ç•¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”&lt;/strong&gt;ï¼šå¼‚æ­¥åˆ·ç›˜ååé‡ï¼ˆ&lt;strong&gt;10ä¸‡+ TPS&lt;/strong&gt;ï¼‰è¿œé«˜äºåŒæ­¥åˆ·ç›˜ï¼ˆçº¦ 1 ä¸‡ TPSï¼‰&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®å‚æ•°&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;broker.conf&lt;/code&gt; ä¸­è®¾ç½® &lt;code&gt;flushDiskType=ASYNC_FLUSH&lt;/code&gt; æˆ– &lt;code&gt;SYNC_FLUSH&lt;/code&gt;&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PageCache åŠ é€Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Broker ä¼˜å…ˆå°†æ•°æ®å†™å…¥ &lt;strong&gt;OS é¡µç¼“å­˜&lt;/strong&gt;ï¼Œç”±æ“ä½œç³»ç»Ÿå¼‚æ­¥åˆ·ç›˜ï¼Œå‡å°‘ç›´æ¥ç£ç›˜ I/O&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜é¢„ç•™å»ºè®®&lt;/strong&gt;ï¼šé¢„ç•™ 50% ç‰©ç†å†…å­˜ä¾› PageCache ä½¿ç”¨&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶é¢„åˆ†é…&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é¢„å…ˆåˆ†é…å›ºå®šå¤§å°ï¼ˆ1GBï¼‰ï¼Œé¿å…åŠ¨æ€æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å…¶ä»–ç»„ä»¶çš„ååŒ"&gt;ğŸ”„ &lt;strong&gt;ä¸å…¶ä»–ç»„ä»¶çš„ååŒ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸ ConsumeQueue çš„å…³ç³»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥æ„å»ºç´¢å¼•&lt;/strong&gt;ï¼šåå°çº¿ç¨‹ &lt;strong&gt;&lt;code&gt;ReputMessageService&lt;/code&gt;&lt;/strong&gt; ä» CommitLog è§£ææ¶ˆæ¯ï¼Œç”Ÿæˆå¯¹åº” Topic/Queue çš„ &lt;strong&gt;ConsumeQueue&lt;/strong&gt; æ–‡ä»¶ï¼ˆå­˜å‚¨æ¶ˆæ¯åç§»é‡ã€å¤§å°ã€Tag å“ˆå¸Œå€¼ï¼‰&lt;a class="link" href="@ref" &gt;1,7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ç»“æ„&lt;/strong&gt;ï¼šæ¯æ¡ç´¢å¼•å›ºå®š &lt;strong&gt;20 å­—èŠ‚&lt;/strong&gt;ï¼ˆ8B åç§»é‡ + 4B æ¶ˆæ¯é•¿åº¦ + 8B Tag å“ˆå¸Œï¼‰&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹åŠ é€Ÿ&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…é€šè¿‡ ConsumeQueue å¿«é€Ÿå®šä½ CommitLog ä¸­çš„æ¶ˆæ¯ç‰©ç†ä½ç½®&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ IndexFile çš„ååŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºæ¶ˆæ¯ Key æˆ–æ—¶é—´èŒƒå›´æ„å»ºå“ˆå¸Œç´¢å¼•ï¼ˆ&lt;strong&gt;IndexFile&lt;/strong&gt;ï¼‰ï¼Œæ”¯æŒé«˜æ•ˆæŸ¥è¯¢ï¼ˆå¦‚äº‹åŠ¡æ¶ˆæ¯å›æŸ¥ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜å¯é æ€§ä¸å®¹ç¾"&gt;âš ï¸ &lt;strong&gt;é«˜å¯é æ€§ä¸å®¹ç¾&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸»ä»å¤åˆ¶æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥åŒå†™ï¼ˆ&lt;code&gt;SYNC_MASTER&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼šMaster éœ€ç­‰å¾… Slave å†™å…¥æˆåŠŸåæ‰è¿”å› ACKï¼Œä¿è¯æ•°æ®é›¶ä¸¢å¤±&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥å¤åˆ¶ï¼ˆ&lt;code&gt;ASYNC_MASTER&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼šMaster å†™å…¥åç«‹å³è¿”å›ï¼Œæ€§èƒ½æ›´é«˜ä½†å¯èƒ½ä¸¢å¤±å°‘é‡æ•°æ®&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœæ¢å¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸å®•æœºå¤„ç†&lt;/strong&gt;ï¼šé€šè¿‡ CRC æ ¡éªŒæ–‡ä»¶å®Œæ•´æ€§ï¼Œä¸¢å¼ƒæŸåæ–‡ä»¶å¹¶ä»æœªåŒæ­¥ä½ç½®æ¢å¤&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—æ¸…ç†&lt;/strong&gt;ï¼šé»˜è®¤ä¿ç•™ &lt;strong&gt;72 å°æ—¶&lt;/strong&gt;æ¶ˆæ¯ï¼Œåå°çº¿ç¨‹å®šæœŸåˆ é™¤è¿‡æœŸæ–‡ä»¶&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç£ç›˜ä¿æŠ¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é…ç½® &lt;code&gt;diskMaxUsedSpaceRatio&lt;/code&gt;ï¼ˆé»˜è®¤ 75%ï¼‰é™åˆ¶ç£ç›˜ä½¿ç”¨ç‡ï¼Œé¿å…å†™æ»¡å¯¼è‡´æœåŠ¡ä¸å¯ç”¨&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹é—®é¢˜ä¸ä¼˜åŒ–å®è·µ"&gt;ğŸ“Š &lt;strong&gt;å…¸å‹é—®é¢˜ä¸ä¼˜åŒ–å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆåˆ†æ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥åˆ·ç›˜å»¶è¿Ÿ&lt;/strong&gt;ï¼šåœ¨é‡‘èåœºæ™¯éœ€æƒè¡¡å¯é æ€§ä¸å»¶è¿Ÿï¼Œå»ºè®®æ­é… SSD ä½¿ç”¨&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å †ç§¯é£é™©&lt;/strong&gt;ï¼šç›‘æ§ &lt;code&gt;mappedFileSizeCommitLog&lt;/code&gt; å’Œç£ç›˜æ°´ä½ï¼Œæå‰æ‰©å®¹&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é…ç½®å»ºè®®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;# broker.conf å…³é”®å‚æ•°
mapedFileSizeCommitLog=1073741824 # CommitLog æ–‡ä»¶å¤§å°ï¼ˆ1GBï¼‰
flushDiskType=ASYNC_FLUSH # å¼‚æ­¥åˆ·ç›˜ï¼ˆé«˜æ€§èƒ½åœºæ™¯ï¼‰
brokerRole=SYNC_MASTER # ä¸»ä»åŒæ­¥åŒå†™ï¼ˆé«˜å¯é ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§æŒ‡æ ‡&lt;/strong&gt;ï¼šç£ç›˜ I/Oã€PageCache å‘½ä¸­ç‡ã€CommitLog æ–‡ä»¶å¢é•¿é€Ÿç‡&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-13"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;CommitLog ä½œä¸º RocketMQ çš„å­˜å‚¨åŸºçŸ³ï¼Œé€šè¿‡ &lt;strong&gt;ç‰©ç†é›†ä¸­å­˜å‚¨ + é€»è¾‘åˆ†æ•£ç´¢å¼•&lt;/strong&gt; çš„è®¾è®¡ï¼Œå®ç°äº†é«˜æ€§èƒ½ä¸é«˜å¯é çš„å¹³è¡¡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†™å…¥æ€§èƒ½&lt;/strong&gt;ï¼šé¡ºåºå†™ç›˜ + é›¶æ‹·è´ + PageCache åŠ é€Ÿ â†’ ç™¾ä¸‡çº§ TPS&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å®‰å…¨&lt;/strong&gt;ï¼šåŒæ­¥åˆ·ç›˜ + ä¸»ä»åŒæ­¥åŒå†™ â†’ é‡‘èçº§å¯é æ€§&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;ï¼šä¸ ConsumeQueue è§£è€¦ï¼Œæ”¯æŒæµ·é‡æ¶ˆæ¯å †ç§¯ï¼ˆäº¿çº§ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡æœ¬è´¨&lt;/strong&gt;ï¼šä»¥æ—¥å¿—å‹å­˜å‚¨æ¨¡å‹ï¼ˆé¡ºåºå†™ã€éšæœºè¯»ï¼‰ä¸ºæ ¸å¿ƒï¼Œé€‚é…æ¶ˆæ¯ä¸­é—´ä»¶çš„é«˜åååœºæ™¯&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚ç”Ÿäº§ç¯å¢ƒä¸­éœ€ç»“åˆä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆ·ç›˜ç­–ç•¥ä¸ä¸»ä»æ¨¡å¼ï¼Œå¹¶é€šè¿‡ç›‘æ§æå‰è§„é¿æ€§èƒ½ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="rocketmq--kafka"&gt;RocketMQ &amp;amp; Kafka
&lt;/h2&gt;&lt;p&gt;RocketMQ åœ¨å•æœºååé‡ä¸Šé€šå¸¸ä½äº Kafkaï¼ˆå¦‚ Kafka å•æœºå¯è¾¾ç™¾ä¸‡çº§ TPSï¼Œè€Œ RocketMQ çº¦åœ¨ 10 ä¸‡çº§ TPSï¼‰ï¼Œè¿™ä¸€å·®å¼‚ä¸»è¦ç”±æ¶æ„è®¾è®¡ã€åŠŸèƒ½å®šä½åŠå®ç°ç»†èŠ‚å…±åŒå¯¼è‡´ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒåŸå› åˆ†æåŠå¯¹æ¯”ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶æ„è®¾è®¡ä¸å­˜å‚¨æœºåˆ¶å·®å¼‚"&gt;ğŸ”§ &lt;strong&gt;æ¶æ„è®¾è®¡ä¸å­˜å‚¨æœºåˆ¶å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨æ¨¡å‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Kafka&lt;/strong&gt;ï¼šé‡‡ç”¨&lt;strong&gt;åˆ†åŒºåˆ†ç‰‡ç‹¬ç«‹å­˜å‚¨&lt;/strong&gt;ï¼Œæ¯ä¸ª Topic çš„ Partition å¯¹åº”ç‹¬ç«‹çš„æ—¥å¿—æ–‡ä»¶ï¼ˆSegmentï¼‰ï¼Œå†™å…¥æ—¶ä»…éœ€è¿½åŠ åˆ°å½“å‰æ´»è·ƒ Segmentï¼Œ&lt;strong&gt;ç£ç›˜é¡ºåºå†™å…¥æ•ˆç‡æé«˜&lt;/strong&gt;ã€‚ä½†å½“ Topic æˆ– Partition æ•°é‡è¿‡å¤šæ—¶ï¼Œå¤šä¸ªæ–‡ä»¶çš„å¹¶å‘å†™å…¥ä¼šé€€åŒ–ä¸ºéšæœº I/Oï¼Œæ€§èƒ½æ€¥å‰§ä¸‹é™ï¼ˆé˜ˆå€¼çº¦ 64 ä¸ªåˆ†åŒºï¼‰&lt;a class="link" href="@ref" &gt;2,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;ï¼šæ‰€æœ‰æ¶ˆæ¯ç»Ÿä¸€å†™å…¥&lt;strong&gt;å•ä¸€ CommitLog æ–‡ä»¶&lt;/strong&gt;ï¼ˆå…¨å±€é¡ºåºå†™ï¼‰ï¼Œå†å¼‚æ­¥æ„å»ºå„é˜Ÿåˆ—çš„ç´¢å¼•ï¼ˆConsumeQueueï¼‰ã€‚è¿™ç§è®¾è®¡åœ¨ &lt;strong&gt;Topic æ•°é‡å¤šæ—¶ä»ä¿æŒé¡ºåºå†™ä¼˜åŠ¿&lt;/strong&gt;ï¼Œä½†&lt;strong&gt;æ¶ˆè´¹æ—¶éœ€ä¸¤æ¬¡è¯»å–&lt;/strong&gt;ï¼ˆå…ˆè¯»ç´¢å¼•ï¼Œå†è¯» CommitLogï¼‰ï¼Œå¢åŠ äº† I/O å¼€é”€&lt;a class="link" href="@ref" &gt;3,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›¶æ‹·è´æŠ€æœ¯å®ç°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Kafka&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;strong&gt;&lt;code&gt;sendfile&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;ï¼ˆLinux 2.4+ï¼‰ï¼Œä»…éœ€ &lt;strong&gt;2 æ¬¡ DMA æ‹·è´&lt;/strong&gt;ï¼ˆç£ç›˜â†’å†…æ ¸ç¼“å†²åŒºâ†’ç½‘å¡ï¼‰ï¼Œæ— éœ€ CPU ä»‹å…¥ï¼Œé€‚åˆå¤§æ–‡ä»¶ä¼ è¾“&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;ï¼šé‡‡ç”¨ &lt;strong&gt;&lt;code&gt;mmap&lt;/code&gt; å†…å­˜æ˜ å°„&lt;/strong&gt;ï¼Œéœ€ &lt;strong&gt;3 æ¬¡æ‹·è´&lt;/strong&gt;ï¼ˆç£ç›˜â†’å†…æ ¸ç¼“å†²åŒºâ†’ç”¨æˆ·ç©ºé—´â†’Socket ç¼“å†²åŒºï¼‰ï¼Œå¤šä¸€æ¬¡ CPU æ‹·è´ï¼Œå°¤å…¶åœ¨å°æ¶ˆæ¯åœºæ™¯æ›´æ˜æ˜¾&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åŠŸèƒ½ç‰¹æ€§ä¸å¯é æ€§è®¾è®¡çš„æ€§èƒ½ä»£ä»·"&gt;âš™ï¸ &lt;strong&gt;åŠŸèƒ½ç‰¹æ€§ä¸å¯é æ€§è®¾è®¡çš„æ€§èƒ½ä»£ä»·&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯æŠ•é€’æ¨¡å¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Kafka&lt;/strong&gt;ï¼š&lt;strong&gt;é»˜è®¤æ‰¹é‡å¼‚æ­¥å‘é€&lt;/strong&gt;ï¼Œç”Ÿäº§è€…å°†æ¶ˆæ¯ç¼“å­˜åæ‰¹é‡æ¨é€ï¼Œå¤§å¹…å‡å°‘ç½‘ç»œ I/O å’Œ Broker å‹åŠ›ï¼Œä½†å­˜åœ¨æ¶ˆæ¯ä¸¢å¤±é£é™©ï¼ˆå¦‚ç”Ÿäº§è€…å®•æœºï¼‰&lt;a class="link" href="@ref" &gt;2,4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;ï¼š&lt;strong&gt;é»˜è®¤å•æ¡åŒæ­¥å‘é€&lt;/strong&gt;ï¼Œæ¯æ¡æ¶ˆæ¯éœ€ç­‰å¾… Broker ç¡®è®¤ï¼Œç¡®ä¿å¯é æ€§ä½†ååé‡å—é™ã€‚è™½æ”¯æŒæ‰¹é‡ APIï¼Œä½†éœ€ä¸šåŠ¡å±‚æ˜¾å¼è°ƒç”¨ï¼Œä¸”æ˜“å¼•å‘ Java GC é—®é¢˜&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜çº§åŠŸèƒ½å¼€é”€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RocketMQ æ”¯æŒäº‹åŠ¡æ¶ˆæ¯ã€é¡ºåºæ¶ˆæ¯ã€Tag è¿‡æ»¤&lt;/strong&gt;ç­‰åŠŸèƒ½ï¼Œéœ€åœ¨ Broker ç«¯è§£ææ¶ˆæ¯å†…å®¹ï¼ˆå¦‚ Tag å“ˆå¸Œæ¯”è¾ƒã€äº‹åŠ¡çŠ¶æ€å›æŸ¥ï¼‰ï¼Œæ¶ˆè€— CPU èµ„æºå¹¶è§¦å‘å †å†…å­˜æ‹·è´&lt;a class="link" href="@ref" &gt;2,6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kafka&lt;/strong&gt; åŠŸèƒ½ç›¸å¯¹å•ä¸€ï¼Œæ— å†…ç½®äº‹åŠ¡æˆ– Tag è¿‡æ»¤ï¼Œæ•°æ®å¤„ç†è·¯å¾„æ›´ç®€æ´&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ·ç›˜ä¸å¤åˆ¶ç­–ç•¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;ï¼šæ”¯æŒ&lt;strong&gt;åŒæ­¥åˆ·ç›˜&lt;/strong&gt;ï¼ˆæ¯æ¡æ¶ˆæ¯è½ç›˜åè¿”å› ACKï¼‰å’Œ&lt;strong&gt;åŒæ­¥å¤åˆ¶&lt;/strong&gt;ï¼ˆä¸»ä»åŒå†™ï¼‰ï¼Œä¿éšœé‡‘èçº§å¯é æ€§ï¼Œä½†æ˜¾è‘—é™ä½åå&lt;a class="link" href="@ref" &gt;3,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kafka&lt;/strong&gt;ï¼šé»˜è®¤&lt;strong&gt;å¼‚æ­¥åˆ·ç›˜ + å¼‚æ­¥å¤åˆ¶&lt;/strong&gt;ï¼ˆISR æœºåˆ¶ï¼‰ï¼Œä¾èµ– PageCache æ‰¹é‡åˆ·ç›˜ï¼Œååæ›´é«˜ä½†å®•æœºå¯èƒ½ä¸¢å¤±å°‘é‡æ•°æ®&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½å¯¹æ¯”ä¸åœºæ™¯é€‚åº”æ€§"&gt;ğŸ“Š &lt;strong&gt;æ€§èƒ½å¯¹æ¯”ä¸åœºæ™¯é€‚åº”æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å• Topic åå&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­â­ï¼ˆç™¾ä¸‡çº§ TPSï¼‰&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆ10 ä¸‡çº§ TPSï¼‰&lt;/td&gt;
&lt;td&gt;Kafka æ‰¹é‡å‘é€ + æ— ç´¢å¼•è§£æä¼˜åŠ¿&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤š Topic ç¨³å®šæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆ64+ åˆ†åŒºåæ€§èƒ½éª¤é™ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆ5 ä¸‡é˜Ÿåˆ—ä»ç¨³å®šï¼‰&lt;/td&gt;
&lt;td&gt;CommitLog å…¨å±€é¡ºåºå†™æŠ—éšæœº I/O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å»¶è¿Ÿæ§åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆæ¯«ç§’~ç§’çº§ï¼Œä¾èµ–é…ç½®ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆ99% &amp;lt;1msï¼‰&lt;/td&gt;
&lt;td&gt;RocketMQ é•¿è½®è¯¢ + é›¶å †ç§¯ä¼˜åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠŸèƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆæ— äº‹åŠ¡/è¿‡æ»¤ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆäº‹åŠ¡/é¡ºåº/Tag è¿‡æ»¤ï¼‰&lt;/td&gt;
&lt;td&gt;RocketMQ éœ€è§£ææ¶ˆæ¯å†…å®¹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…¸å‹åœºæ™¯éªŒè¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å• Topic å‹æµ‹&lt;/strong&gt;ï¼šKafka ååé‡å¯è¾¾ RocketMQ çš„ 1.5 å€ä»¥ä¸Šï¼ˆå¦‚ 17.3w vs 11.6w TPSï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;64 Topic å‹æµ‹&lt;/strong&gt;ï¼šKafka æ€§èƒ½æ³¢åŠ¨å‰§çƒˆï¼ˆéšæœº I/O ç“¶é¢ˆï¼‰ï¼Œè€Œ RocketMQ ä¿æŒç¨³å®š&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¹æœ¬åŸå› æ€»ç»“"&gt;âš–ï¸ &lt;strong&gt;æ ¹æœ¬åŸå› æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡ä¸åŒ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Kafka ä¸º&lt;strong&gt;æ—¥å¿—æµå¤„ç†&lt;/strong&gt;ä¼˜åŒ–ï¼Œè¿½æ±‚æè‡´ååï¼Œå®¹å¿å°‘é‡æ•°æ®ä¸¢å¤±&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;RocketMQ ä¸º&lt;strong&gt;ä¸šåŠ¡äº¤æ˜“&lt;/strong&gt;è®¾è®¡ï¼Œä¼˜å…ˆä¿éšœå¯é æ€§ã€ä½å»¶è¿Ÿä¸äº‹åŠ¡ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æŠ€æœ¯å·®å¼‚&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Kafka çš„ &lt;code&gt;sendfile&lt;/code&gt; å’Œ&lt;strong&gt;æ‰¹é‡å¼‚æ­¥æœºåˆ¶&lt;/strong&gt;å‡å°‘ CPU ä¸ I/O å¼€é”€&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;RocketMQ çš„ &lt;strong&gt;&lt;code&gt;mmap&lt;/code&gt; æ‹·è´&lt;/strong&gt;ã€&lt;strong&gt;ç´¢å¼•äºŒæ¬¡è¯»å–&lt;/strong&gt;åŠ&lt;strong&gt;åŠŸèƒ½é€»è¾‘å¤„ç†&lt;/strong&gt;å åŠ ä¸ºæ€§èƒ½ç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯­è¨€ä¸ç”Ÿæ€&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Kafkaï¼ˆScala/JVMï¼‰ç¤¾åŒºä¼˜åŒ–æ›´æ—©ï¼Œè€Œ RocketMQï¼ˆJavaï¼‰éœ€è§„é¿å †å†…å­˜ GC é—®é¢˜ï¼Œé™åˆ¶ç¼“å­˜ä½¿ç”¨&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç»“è®ºæ€§èƒ½ä¸å¯é æ€§çš„æƒè¡¡"&gt;ğŸ’ &lt;strong&gt;ç»“è®ºï¼šæ€§èƒ½ä¸å¯é æ€§çš„æƒè¡¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰ Kafka&lt;/strong&gt;ï¼šéœ€å¤„ç†&lt;strong&gt;æµ·é‡æ—¥å¿—/æµæ•°æ®&lt;/strong&gt;ï¼ˆå¦‚ Flink å®æ—¶è®¡ç®—ï¼‰ï¼Œå®¹å¿ç§’çº§å»¶è¿Ÿï¼Œè¿½æ±‚ååæè‡´&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ RocketMQ&lt;/strong&gt;ï¼šéœ€&lt;strong&gt;é‡‘èçº§å¯é &lt;/strong&gt;ã€&lt;strong&gt;ä½å»¶è¿Ÿäº‹åŠ¡&lt;/strong&gt;ï¼ˆå¦‚æ”¯ä»˜è®¢å•ï¼‰ï¼Œæˆ–&lt;strong&gt;å¤š Topic é«˜å¹¶å‘&lt;/strong&gt;ä¸šåŠ¡ï¼ˆå¦‚ç”µå•†å¹³å°ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–å»ºè®®&lt;/strong&gt;ï¼šRocketMQ å¯é€šè¿‡&lt;strong&gt;å¼‚æ­¥åˆ·ç›˜&lt;/strong&gt;ã€&lt;strong&gt;æ‰¹é‡å‘é€ API&lt;/strong&gt; æå‡ååï¼Œä½†éœ€ä¸šåŠ¡å±‚é…åˆå¹‚ç­‰è®¾è®¡&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€kafkaã€‘Fundamentals</title><link>https://dyhes.github.io/p/kafkafundamentals/</link><pubDate>Wed, 05 Mar 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/kafkafundamentals/</guid><description>&lt;p&gt;&lt;img src="https://i.ibb.co/hxgg6J4Z/image.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/ycC8sNZD/image-2.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/VW9s6q0L/image-3.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/XkFbw3F7/image-4.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/nqXkN4RV/image-5.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/C3PZ90Lp/image-6.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/VWpbSWZf/image-7.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/FLL1fzzt/image-8.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/d4QZ1rJW/image-9.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/vCWR5tFp/image-10.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/BV8Lw3qw/image-11.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/C39qGZ6r/image-12.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/JWP3hsDW/image-13.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/LdJS3BFK/image-14.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/KcbNLhFw/image-15.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/hxZDX1C0/image-16.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/GfzmWbPq/image-17.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/5gtZ5ggq/image-18.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/xKqhDr0Q/image-19.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.ibb.co/PzbXhGyD/image-20.png"
loading="lazy"
&gt;
only latest value of key-x&lt;/p&gt;</description></item><item><title>ã€Kafkaã€‘Stream</title><link>https://dyhes.github.io/p/kafkastream/</link><pubDate>Wed, 05 Mar 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/kafkastream/</guid><description>&lt;p&gt;Kafka å’Œ Kafka Streams çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®šä½ã€åŠŸèƒ½å’Œåº”ç”¨åœºæ™¯ä¸Šï¼Œä»¥ä¸‹æ˜¯ä¸¤è€…çš„æ ¸å¿ƒå·®å¼‚ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="å®šä½ä¸æ ¸å¿ƒåŠŸèƒ½"&gt;&lt;strong&gt;å®šä½ä¸æ ¸å¿ƒåŠŸèƒ½&lt;/strong&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;br&gt;
æ˜¯ä¸€ä¸ª &lt;strong&gt;åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿ&lt;/strong&gt; å’Œ &lt;strong&gt;æµå¤„ç†å¹³å°&lt;/strong&gt;ï¼Œä¸»è¦ç”¨äºæ„å»ºå®æ—¶æ•°æ®ç®¡é“ï¼Œæä¾›é«˜ååã€æŒä¹…åŒ–çš„æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…æœåŠ¡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒèƒ½åŠ›&lt;/strong&gt;ï¼šæ•°æ®å­˜å‚¨ã€æ¶ˆæ¯ä¼ è¾“ã€å‰¯æœ¬å®¹é”™ï¼ˆé€šè¿‡å¤šå‰¯æœ¬æœºåˆ¶ç¡®ä¿æ•°æ®é«˜å¯ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šæ—¥å¿—èšåˆã€äº‹ä»¶æºã€ç³»ç»Ÿè§£è€¦ã€å‰Šå³°å¡«è°·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kafka Streams&lt;/strong&gt;&lt;br&gt;
Kafka Streams æ˜¯ä¸€ä¸ªç”¨äº&lt;strong&gt;å¤„ç†å’Œåˆ†æ&lt;/strong&gt;å­˜å‚¨åœ¨ Kafka ç³»ç»Ÿä¸­çš„æ•°æ®çš„å®¢æˆ·ç«¯åº“ã€‚
æ˜¯ Kafka çš„ &lt;strong&gt;å®¢æˆ·ç«¯åº“&lt;/strong&gt;ï¼ˆéç‹¬ç«‹å¹³å°ï¼‰ï¼Œä¸“ä¸ºæµå¤„ç†è®¾è®¡ï¼Œæä¾›å®æ—¶æ•°æ®è½¬æ¢ã€èšåˆç­‰é«˜çº§æ“ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒèƒ½åŠ›&lt;/strong&gt;ï¼šæµå¤„ç†é€»è¾‘ï¼ˆå¦‚çª—å£è®¡ç®—ã€çŠ¶æ€ç®¡ç†ã€è¿æ¥æ“ä½œï¼‰ã€æ”¯æŒäº‹ä»¶æ—¶é—´è¯­ä¹‰ã€Exactly-Once å¤„ç†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šå®æ—¶ç›‘æ§å‘Šè­¦ã€æµå¼ ETLã€å¤æ‚äº‹ä»¶å¤„ç†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="æ•°æ®å¤„ç†æ¨¡å‹"&gt;&lt;strong&gt;æ•°æ®å¤„ç†æ¨¡å‹&lt;/strong&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»¥ &lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt; ä¸ºæ ¸å¿ƒï¼Œæ•°æ®æŒ‰ä¸»é¢˜ï¼ˆTopicï¼‰åˆ†åŒºå­˜å‚¨ï¼Œæ”¯æŒé¡ºåºè¯»å†™å’ŒæŒä¹…åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;ä¸å¤„ç†æ•°æ®å†…å®¹ï¼Œä»…è´Ÿè´£ä¼ è¾“å’Œå­˜å‚¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kafka Streams&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æä¾› &lt;strong&gt;æµå¤„ç†æŠ½è±¡&lt;/strong&gt;ï¼ˆå¦‚ KStream å’Œ KTableï¼‰ï¼Œæ”¯æŒåŠ¨æ€å¤„ç†æ•°æ®æµï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;KStream&lt;/strong&gt;ï¼šä»£è¡¨æ— é™æ•°æ®é›†ï¼Œæ¯æ¡è®°å½•ç‹¬ç«‹å¤„ç†ï¼ˆå¦‚è¿‡æ»¤ã€æ˜ å°„ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;KTable&lt;/strong&gt;ï¼šåŠ¨æ€è¡¨ç»“æ„ï¼Œæ”¯æŒèšåˆæ›´æ–°ï¼ˆå¦‚è®¡æ•°ã€çª—å£ç»Ÿè®¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å†…ç½®çŠ¶æ€å­˜å‚¨ï¼ˆState Storeï¼‰ï¼Œå®ç°æœ‰çŠ¶æ€è®¡ç®—ï¼ˆå¦‚ Join æ“ä½œï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="ä¾èµ–ä¸éƒ¨ç½²"&gt;&lt;strong&gt;ä¾èµ–ä¸éƒ¨ç½²&lt;/strong&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€ç‹¬ç«‹éƒ¨ç½²é›†ç¾¤ï¼ˆBroker èŠ‚ç‚¹ï¼‰ï¼Œä¾èµ– ZooKeeper ç®¡ç†å…ƒæ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;ä½œä¸ºåŸºç¡€è®¾æ–½ï¼Œä¸å…¶ä»–ç³»ç»Ÿï¼ˆå¦‚ Sparkã€Flinkï¼‰è§£è€¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kafka Streams&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»¥ &lt;strong&gt;è½»é‡çº§åº“&lt;/strong&gt; å½¢å¼åµŒå…¥åº”ç”¨ï¼ˆä»…éœ€ Kafka ä¾èµ–ï¼‰ï¼Œæ— éœ€é¢å¤–éƒ¨ç½²èµ„æºç®¡ç†å™¨æˆ–è°ƒåº¦å™¨ã€‚&lt;/li&gt;
&lt;li&gt;ç›´æ¥åˆ©ç”¨ Kafka çš„åˆ†åŒºæœºåˆ¶å®ç°æ°´å¹³æ‰©å±•ï¼Œé€šè¿‡ Consumer Rebalance åŠ¨æ€è°ƒæ•´å¹¶è¡Œåº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="æ—¶é—´è¯­ä¹‰æ”¯æŒ"&gt;&lt;strong&gt;æ—¶é—´è¯­ä¹‰æ”¯æŒ&lt;/strong&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æä¾›æ¶ˆæ¯çš„æ—¶é—´æˆ³ï¼ˆäº‹ä»¶æ—¶é—´æˆ–æ‘„å…¥æ—¶é—´ï¼‰ï¼Œä½†ä¸å‚ä¸æ—¶é—´ç›¸å…³çš„è®¡ç®—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kafka Streams&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒ &lt;strong&gt;äº‹ä»¶æ—¶é—´ï¼ˆEvent Timeï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;å¤„ç†æ—¶é—´ï¼ˆProcessing Timeï¼‰&lt;/strong&gt;ï¼Œé€šè¿‡ &lt;code&gt;TimestampExtractor&lt;/code&gt; æ¥å£å®šä¹‰æ—¶é—´è¯­ä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°åŸºäºæ—¶é—´çš„çª—å£æ“ä½œï¼ˆå¦‚æ»‘åŠ¨çª—å£ã€ä¼šè¯çª—å£ï¼‰ï¼Œå¹¶å¤„ç†è¿Ÿåˆ°æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="é€‚ç”¨åœºæ™¯å¯¹æ¯”"&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯å¯¹æ¯”&lt;/strong&gt;
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Kafka Streams&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ä¼ è¾“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ååæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚æ—¥å¿—ä¼ è¾“ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸é€‚ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®æ—¶è®¡ç®—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€é…åˆå…¶ä»–æ¡†æ¶ï¼ˆå¦‚ Flinkï¼‰&lt;/td&gt;
&lt;td&gt;ç›´æ¥å¤„ç†ï¼ˆå¦‚å®æ—¶èšåˆã€å¤æ‚äº‹ä»¶å¤„ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çŠ¶æ€ç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;å†…ç½®çŠ¶æ€å­˜å‚¨ï¼ˆå¦‚çª—å£è®¡æ•°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç«¯åˆ°ç«¯ Exactly-Once&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨å®ç°&lt;/td&gt;
&lt;td&gt;åŸç”Ÿæ”¯æŒï¼ˆé€šè¿‡äº‹åŠ¡å’Œå¹‚ç­‰ Producerï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id="æ€»ç»“"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;Kafka æ˜¯æµå¼æ•°æ®çš„â€œé«˜é€Ÿå…¬è·¯â€ï¼Œè´Ÿè´£é«˜æ•ˆä¼ è¾“ä¸å­˜å‚¨ï¼›è€Œ Kafka Streams æ˜¯â€œå®æ—¶å¤„ç†å¼•æ“â€ï¼Œç›´æ¥åœ¨æ•°æ®æµä¸Šæ‰§è¡Œè®¡ç®—é€»è¾‘ã€‚ä¸¤è€…ç»“åˆå¯æ„å»ºç«¯åˆ°ç«¯çš„å®æ—¶æ•°æ®å¤„ç†ç®¡é“ï¼Œä¾‹å¦‚ï¼šKafka æ¥æ”¶åŸå§‹æ•°æ® â†’ Kafka Streams å¤„ç†å¹¶ç”Ÿæˆç»“æœ â†’ ç»“æœå†™å› Kafka ä¾›ä¸‹æ¸¸æ¶ˆè´¹ã€‚&lt;/p&gt;</description></item><item><title>ã€Kafkaã€‘ä½¿ç”¨åœºæ™¯</title><link>https://dyhes.github.io/p/kafka%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/</link><pubDate>Tue, 04 Mar 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/kafka%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/</guid><description>&lt;p&gt;Kafka ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMessage Brokerï¼‰å¹¶éä»…ä¸ºå¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼Œåœ¨å•ä½“åº”ç”¨ï¼ˆMonolithicï¼‰ä¸­åŒæ ·æœ‰å¹¿æ³›çš„åº”ç”¨åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="å¾®æœåŠ¡æ¶æ„ä¸­çš„å…¸å‹åº”ç”¨åœºæ™¯"&gt;&lt;strong&gt;å¾®æœåŠ¡æ¶æ„ä¸­çš„å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;å¾®æœåŠ¡æ¶æ„é€šè¿‡æ¶ˆæ¯ä¸­é—´ä»¶å®ç°æœåŠ¡è§£è€¦ã€å¼‚æ­¥é€šä¿¡å’Œåˆ†å¸ƒå¼åè°ƒï¼Œè¿™æ˜¯å…¶æ ¸å¿ƒä¼˜åŠ¿ä¹‹ä¸€ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡è§£è€¦&lt;/strong&gt;ï¼šä¾‹å¦‚è®¢å•æœåŠ¡å°†æ¶ˆæ¯å‘å¸ƒåˆ° Kafka ä¸»é¢˜åï¼Œåº“å­˜ã€æ”¯ä»˜ç­‰æœåŠ¡ä½œä¸ºæ¶ˆè´¹è€…ç‹¬ç«‹å¤„ç†æ¶ˆæ¯ï¼Œæ— éœ€åŒæ­¥è°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶æ•°æ®æµå¤„ç†&lt;/strong&gt;ï¼šKafka çš„é«˜ååé‡å’Œåˆ†åŒºæœºåˆ¶æ”¯æŒå¾®æœåŠ¡é—´çš„å®æ—¶æ•°æ®ä¼ è¾“ï¼Œå¦‚ç”¨æˆ·è¡Œä¸ºè·Ÿè¸ªã€æ—¥å¿—èšåˆç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™ä¸æ‰©å±•æ€§&lt;/strong&gt;ï¼šKafka çš„å‰¯æœ¬æœºåˆ¶å’Œå¤šæ¶ˆè´¹è€…æ¨¡å¼ä¿éšœäº†å¾®æœåŠ¡åœ¨èŠ‚ç‚¹æ•…éšœæˆ–æµé‡æ¿€å¢æ—¶çš„ç¨³å®šæ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id="å•ä½“æ¶æ„ä¸­ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶çš„åœºæ™¯"&gt;&lt;strong&gt;å•ä½“æ¶æ„ä¸­ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶çš„åœºæ™¯&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;å³ä½¿åº”ç”¨æœªæ‹†åˆ†ä¸ºå¾®æœåŠ¡ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶ä»èƒ½è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š&lt;/p&gt;
&lt;h4 id="æ¨¡å—é—´è§£è€¦"&gt;&lt;strong&gt;æ¨¡å—é—´è§£è€¦&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;åœ¨å•ä½“åº”ç”¨ä¸­ï¼Œä¸åŒæ¨¡å—å¯é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å®ç°å¼‚æ­¥é€šä¿¡ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”µå•†åœºæ™¯&lt;/strong&gt;ï¼šç”¨æˆ·ä¸‹å•åï¼Œè®¢å•æ¨¡å—å°†æ¶ˆæ¯å†™å…¥é˜Ÿåˆ—ï¼Œåº“å­˜ã€ç‰©æµç­‰æ¨¡å—å¼‚æ­¥æ¶ˆè´¹ï¼Œé¿å…åŒæ­¥è°ƒç”¨å¯¼è‡´çš„æ€§èƒ½ç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—æ”¶é›†&lt;/strong&gt;ï¼šå•ä½“åº”ç”¨å°†æ—¥å¿—ç»Ÿä¸€å‘é€åˆ° Kafkaï¼Œåç»­ç”±ç‹¬ç«‹æœåŠ¡è¿›è¡Œå­˜å‚¨æˆ–åˆ†æï¼Œé¿å…æ—¥å¿—å¤„ç†é˜»å¡ä¸»ä¸šåŠ¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼‚æ­¥å¤„ç†ä¸å“åº”ä¼˜åŒ–"&gt;&lt;strong&gt;å¼‚æ­¥å¤„ç†ä¸å“åº”ä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è€—æ—¶æ“ä½œå¼‚æ­¥åŒ–&lt;/strong&gt;ï¼šå¦‚é‚®ä»¶å‘é€ã€æ–‡ä»¶å¯¼å‡ºç­‰ä»»åŠ¡ï¼Œé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å‰¥ç¦»ä¸»æµç¨‹ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼ˆå¦‚ç½‘é¡µ6æåˆ°çš„â€œè®¢å•å¤„ç†æ— éœ€ç­‰å¾…é‚®ä»¶å‘é€å®Œæˆâ€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµé‡å‰Šå³°&lt;/strong&gt;ï¼šåœ¨é«˜å¹¶å‘åœºæ™¯ï¼ˆå¦‚ç§’æ€æ´»åŠ¨ï¼‰ä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—æš‚å­˜è¯·æ±‚ï¼Œåç«¯æŒ‰å¤„ç†èƒ½åŠ›é€æ­¥æ¶ˆè´¹ï¼Œé˜²æ­¢ç³»ç»Ÿè¿‡è½½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="äº‹ä»¶é©±åŠ¨æ¶æ„"&gt;&lt;strong&gt;äº‹ä»¶é©±åŠ¨æ¶æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å•ä½“åº”ç”¨å¯é€šè¿‡æ¶ˆæ¯ä¸­é—´ä»¶å®ç°å†…éƒ¨äº‹ä»¶é©±åŠ¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€å˜æ›´é€šçŸ¥&lt;/strong&gt;ï¼šä¾‹å¦‚ç”¨æˆ·æ³¨å†Œåè§¦å‘ç§¯åˆ†å‘æ”¾ã€çŸ­ä¿¡é€šçŸ¥ç­‰æ“ä½œï¼Œé€šè¿‡è®¢é˜…â€œç”¨æˆ·æ³¨å†Œâ€ä¸»é¢˜å®ç°æ¾è€¦åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§ä¿éšœ&lt;/strong&gt;ï¼šé€šè¿‡æ¶ˆæ¯æŒä¹…åŒ–å’Œé‡è¯•æœºåˆ¶ï¼Œç¡®ä¿å…³é”®æ“ä½œï¼ˆå¦‚æ”¯ä»˜çŠ¶æ€æ›´æ–°ï¼‰çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ—¥å¿—ä¸ç›‘æ§"&gt;&lt;strong&gt;æ—¥å¿—ä¸ç›‘æ§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é›†ä¸­å¼æ—¥å¿—ç®¡ç†&lt;/strong&gt;ï¼šå•ä½“åº”ç”¨å°†æ—¥å¿—æ¨é€è‡³ Kafkaï¼Œä¾¿äºåç»­æ¥å…¥ Elasticsearch ç­‰å·¥å…·è¿›è¡Œå®æ—¶åˆ†æã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç³»ç»Ÿç›‘æ§&lt;/strong&gt;ï¼šæœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡ï¼ˆCPUã€å†…å­˜ç­‰ï¼‰é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ä¼ è¾“ï¼Œå®ç°å®æ—¶å‘Šè­¦æˆ–å¯è§†åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é—ç•™ç³»ç»Ÿæ”¹é€ "&gt;&lt;strong&gt;é—ç•™ç³»ç»Ÿæ”¹é€ &lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;åœ¨å•ä½“å‘å¾®æœåŠ¡è¿‡æ¸¡é˜¶æ®µï¼Œæ¶ˆæ¯ä¸­é—´ä»¶å¯ä½œä¸ºä¸­é—´å±‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€æ­¥æ‹†åˆ†&lt;/strong&gt;ï¼šå°†éƒ¨åˆ†åŠŸèƒ½æ¨¡å—è¿ç§»ä¸ºç‹¬ç«‹æœåŠ¡ï¼Œé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ä¸åŸç³»ç»Ÿé€šä¿¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯å¼‚æ„&lt;/strong&gt;ï¼šä¾‹å¦‚æ—§ç³»ç»Ÿä½¿ç”¨ Javaï¼Œæ–°æ¨¡å—ç”¨ Python å¼€å‘ï¼Œé€šè¿‡ Kafka å®ç°è·¨è¯­è¨€é€šä¿¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="æŠ€æœ¯é€‰å‹å»ºè®®"&gt;&lt;strong&gt;æŠ€æœ¯é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜åååœºæ™¯&lt;/strong&gt;ï¼šä¼˜å…ˆé€‰æ‹© Kafkaï¼ˆæ”¯æŒç™¾ä¸‡çº§æ¶ˆæ¯/ç§’ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡çº§éœ€æ±‚&lt;/strong&gt;ï¼šRabbitMQ æˆ– ActiveMQ æ›´é€‚åˆç®€å•é˜Ÿåˆ—å’Œä½å»¶è¿Ÿåœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰©è”ç½‘ä¸è¾¹ç¼˜è®¡ç®—&lt;/strong&gt;ï¼šMQTT åè®®ï¼ˆå¦‚ç½‘é¡µ8æ‰€è¿°ï¼‰æ›´é€‚é…è®¾å¤‡é—´é€šä¿¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="æ€»ç»“"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;æ¶ˆæ¯ä¸­é—´ä»¶çš„æ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;è§£è€¦ç”Ÿäº§ä¸æ¶ˆè´¹ã€ä¿éšœå¯é é€šä¿¡ã€æå‡ç³»ç»Ÿæ‰©å±•æ€§&lt;/strong&gt;ï¼Œè¿™äº›éœ€æ±‚åœ¨å•ä½“æ¶æ„ä¸­åŒæ ·å­˜åœ¨ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kafka åœ¨å•ä½“åº”ç”¨ä¸­çš„æ—¥å¿—æ”¶é›†ã€å¼‚æ­¥ä»»åŠ¡å¤„ç†ç­‰åœºæ™¯å·²æˆç†Ÿåº”ç”¨ï¼›&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯é˜Ÿåˆ—çš„æµé‡å‰Šå³°èƒ½åŠ›å¯¹é«˜å¹¶å‘å•ä½“ç³»ç»Ÿè‡³å…³é‡è¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼Œ&lt;strong&gt;æ˜¯å¦ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶å–å†³äºå…·ä½“ä¸šåŠ¡éœ€æ±‚ï¼Œè€Œéä»…é™äºæ¶æ„é£æ ¼&lt;/strong&gt;ã€‚&lt;/p&gt;</description></item></channel></rss>