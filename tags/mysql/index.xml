<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Mysql on é£é¸¿è¸é›ªæ³¥</title><link>https://dyhes.github.io/tags/mysql/</link><description>Recent content in Mysql on é£é¸¿è¸é›ªæ³¥</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 22 Oct 2025 16:26:59 +0800</lastBuildDate><atom:link href="https://dyhes.github.io/tags/mysql/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€DBã€‘åˆ†å¸ƒå¼</title><link>https://dyhes.github.io/p/db%E5%88%86%E5%B8%83%E5%BC%8F/</link><pubDate>Sat, 21 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/db%E5%88%86%E5%B8%83%E5%BC%8F/</guid><description>&lt;h2 id="binlog"&gt;Binlog
&lt;/h2&gt;&lt;p&gt;MySQL çš„ Binlogï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰åœ¨ä¸»åº“ä¸Šçš„è®°å½•æ—¶æœºæ˜¯ &lt;strong&gt;åœ¨ SQL è¯­å¥æ‰§è¡Œä¹‹åã€äº‹åŠ¡æäº¤ä¹‹å‰&lt;/strong&gt;ï¼Œå…·ä½“æµç¨‹ä¸äº‹åŠ¡æäº¤æœºåˆ¶å¼ºç›¸å…³ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-binlog-è®°å½•çš„æ ¸å¿ƒæµç¨‹"&gt;ğŸ”„ &lt;strong&gt;Binlog è®°å½•çš„æ ¸å¿ƒæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¯­å¥æ‰§è¡Œé˜¶æ®µ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“ä¸»åº“æ‰§è¡Œä¸€æ¡æ•°æ®ä¿®æ”¹è¯­å¥ï¼ˆå¦‚ &lt;code&gt;INSERT&lt;/code&gt;/&lt;code&gt;UPDATE&lt;/code&gt;/&lt;code&gt;DELETE&lt;/code&gt;ï¼‰æ—¶ï¼Œ&lt;strong&gt;è¯­å¥ä¼šå…ˆç”±å­˜å‚¨å¼•æ“ï¼ˆå¦‚ InnoDBï¼‰æ‰§è¡Œ&lt;/strong&gt;ï¼Œå°†æ•°æ®å˜æ›´å†™å…¥å†…å­˜ï¼ˆBuffer Poolï¼‰å¹¶ç”Ÿæˆ &lt;strong&gt;Redo Logï¼ˆé‡åšæ—¥å¿—ï¼‰&lt;/strong&gt; ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­¤æ—¶ Binlog å°šæœªè®°å½•&lt;/strong&gt;ï¼Œä½†å·²ç”Ÿæˆå¯¹åº”çš„é€»è¾‘æ“ä½œæè¿°ï¼ˆä¾‹å¦‚è¡Œå˜æ›´äº‹ä»¶æˆ–åŸå§‹ SQL è¯­å¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æäº¤å‰çš„å‡†å¤‡é˜¶æ®µ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡æäº¤å‰ï¼ŒMySQL ä¼šå°† &lt;strong&gt;Binlog äº‹ä»¶å†™å…¥å†…å­˜ç¼“å†²åŒºï¼ˆBinlog Cacheï¼‰&lt;/strong&gt;ã€‚æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„ Binlog Cacheï¼Œç”¨äºæš‚å­˜è¯¥äº‹åŠ¡çš„æ‰€æœ‰æ“ä½œæ—¥å¿—ã€‚&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- äº‹åŠ¡å†…æ‰§è¡Œ
UPDATE users SET balance = 100 WHERE id = 1;
-- Binlog äº‹ä»¶ç”Ÿæˆå¹¶æš‚å­˜åˆ°çº¿ç¨‹çš„ Binlog Cache
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æäº¤æ—¶çš„æŒä¹…åŒ–é˜¶æ®µ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“æ‰§è¡Œ COMMIT æ—¶ï¼ŒMySQL é€šè¿‡ ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Prepare é˜¶æ®µ&lt;/strong&gt;ï¼šInnoDB å°† Redo Log æ ‡è®°ä¸º &lt;code&gt;PREPARE&lt;/code&gt; çŠ¶æ€ï¼ˆç¡®ä¿å´©æºƒåå¯æ¢å¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Write &amp;amp; Fsync é˜¶æ®µ&lt;/strong&gt;ï¼šå°† Binlog Cache ä¸­çš„å®Œæ•´äº‹åŠ¡æ—¥å¿—å†™å…¥ &lt;strong&gt;Binlog æ–‡ä»¶&lt;/strong&gt;ï¼ˆå…ˆå†™å…¥æ–‡ä»¶ç³»ç»Ÿçš„ Page Cacheï¼Œå†æ ¹æ®é…ç½®å†³å®šæ˜¯å¦åˆ·ç›˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Commit é˜¶æ®µ&lt;/strong&gt;ï¼šInnoDB å°† Redo Log æ ‡è®°ä¸º &lt;code&gt;COMMIT&lt;/code&gt;ï¼Œå®Œæˆäº‹åŠ¡æäº¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­¤æ—¶ Binlog æ‰çœŸæ­£è®°å½•åˆ°ç£ç›˜æ–‡ä»¶ä¸­&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æœºåˆ¶è§£æ"&gt;âš™ï¸ &lt;strong&gt;å…³é”®æœºåˆ¶è§£æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="binlog-å†™å…¥çš„ç‰©ç†æ—¶æœº"&gt;&lt;strong&gt;Binlog å†™å…¥çš„ç‰©ç†æ—¶æœº&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Binlog Cache â†’ Page Cache&lt;/strong&gt;
äº‹åŠ¡æäº¤æ—¶ï¼ŒBinlog Cache çš„å†…å®¹ä¸€æ¬¡æ€§å†™å…¥æ“ä½œç³»ç»Ÿçš„ â€‹&lt;strong&gt;Page Cacheï¼ˆå†…å­˜ç¼“å­˜ï¼‰â€‹&lt;/strong&gt;ï¼Œè¿™ä¸€æ­¥ç§°ä¸º &lt;code&gt;write&lt;/code&gt; æ“ä½œï¼ˆé€Ÿåº¦å¿«ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Page Cache â†’ ç£ç›˜æŒä¹…åŒ–æ˜¯å¦ç«‹å³åˆ·ç›˜å–å†³äºå‚æ•° sync_binlogï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;sync_binlog&lt;/code&gt; å€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œä¸º&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®å®‰å…¨æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–æ“ä½œç³»ç»Ÿå®šæœŸåˆ·ç›˜ï¼ˆçº¦æ¯ç§’1æ¬¡ï¼‰&lt;/td&gt;
&lt;td&gt;å¯èƒ½ä¸¢å¤±æœ€è¿‘1ç§’å†…çš„äº‹åŠ¡æ—¥å¿—&lt;/td&gt;
&lt;td&gt;æœ€é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;1&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯æ¬¡æäº¤éƒ½å¼ºåˆ¶åˆ·ç›˜ï¼ˆ&lt;code&gt;fsync&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æœ€é«˜ï¼ˆå´©æºƒåå‡ ä¹æ— æ•°æ®ä¸¢å¤±ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒä½ï¼ˆé¢‘ç¹ I/Oï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Nï¼ˆ&amp;gt;1ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç´¯ç§¯ N ä¸ªäº‹åŠ¡æäº¤ååˆ·ç›˜&lt;/td&gt;
&lt;td&gt;å¯èƒ½ä¸¢å¤±æœ€è¿‘ N ä¸ªäº‹åŠ¡æ—¥å¿—&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰ï¼ˆæŠ˜ä¸­æ–¹æ¡ˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸ºä»€ä¹ˆå¿…é¡»åœ¨è¯­å¥æ‰§è¡Œåè®°å½•"&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆå¿…é¡»åœ¨è¯­å¥æ‰§è¡Œåè®°å½•ï¼Ÿ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ•°æ®æ­£ç¡®æ€§ä¾èµ–æ‰§è¡Œç»“æœ Binlog éœ€è®°å½• å®é™…ç”Ÿæ•ˆçš„æ“ä½œã€‚ä¾‹å¦‚ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥è¯­å¥å› å”¯ä¸€é”®å†²çªæ‰§è¡Œå¤±è´¥ï¼ŒBinlog ä¸ä¼šè®°å½•è¯¥æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åœ¨ &lt;code&gt;ROW&lt;/code&gt; æ ¼å¼ä¸‹ï¼ŒBinlog éœ€è®°å½•ä¿®æ”¹å‰åçš„è¡Œæ•°æ®ï¼Œå¿…é¡»å…ˆæ‰§è¡Œè¯­å¥æ‰èƒ½è·å–è¿™äº›å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸-redo-log-çš„ååŒä¸¤é˜¶æ®µæäº¤"&gt;&lt;strong&gt;ä¸ Redo Log çš„ååŒï¼ˆä¸¤é˜¶æ®µæäº¤ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Binlog å’Œ Redo Log é€šè¿‡ &lt;strong&gt;äº‹åŠ¡ IDï¼ˆXIDï¼‰&lt;/strong&gt; å…³è”ï¼Œç¡®ä¿ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ Binlog å·²å®Œæ•´å†™å…¥ â†’ äº‹åŠ¡å¿…é¡»æäº¤ï¼ˆRedo Log æ ‡è®° &lt;code&gt;COMMIT&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ Binlog æœªå†™å…¥ â†’ äº‹åŠ¡å›æ»šï¼ˆå³ä½¿ Redo Log å·² &lt;code&gt;PREPARE&lt;/code&gt;ï¼‰ã€‚
ğŸ‘‰ è¿™ä¸€æœºåˆ¶æ˜¯ â€‹&lt;strong&gt;å´©æºƒæ¢å¤ï¼ˆCrash-Safeï¼‰â€‹&lt;/strong&gt;â€‹ çš„æ ¸å¿ƒä¿éšœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸åŒ-binlog-æ ¼å¼çš„è®°å½•è¡Œä¸ºå¯¹æ¯”"&gt;ğŸ“Š &lt;strong&gt;ä¸åŒ Binlog æ ¼å¼çš„è®°å½•è¡Œä¸ºå¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Binlog æ ¼å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è®°å½•å†…å®¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è®°å½•æ—¶æœº&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;STATEMENT&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸå§‹ SQL è¯­å¥&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œåã€æäº¤å‰&lt;/td&gt;
&lt;td&gt;æ—¥å¿—é‡å°ï¼Œä½†å­˜åœ¨ä¸»ä»ä¸ä¸€è‡´é£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ROW&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯è¡Œæ•°æ®å˜æ›´å‰åçš„å€¼&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œåã€æäº¤å‰ï¼ˆéœ€å…ˆè·å–è¡Œæ•°æ®ï¼‰&lt;/td&gt;
&lt;td&gt;æ•°æ®ä¸€è‡´æ€§é«˜ï¼Œæ—¥å¿—é‡å¤§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;MIXED&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ ¹æ®è¯­å¥é£é™©åŠ¨æ€é€‰æ‹© STATEMENT/ROW&lt;/td&gt;
&lt;td&gt;åŒ STATEMENT/ROW&lt;/td&gt;
&lt;td&gt;å¹³è¡¡æ—¥å¿—é‡ä¸ä¸€è‡´æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šæ— è®ºå“ªç§æ ¼å¼ï¼ŒBinlog å‡åœ¨ &lt;strong&gt;è¯­å¥æ‰§è¡Œåã€äº‹åŠ¡æäº¤å‰&lt;/strong&gt; ç”Ÿæˆå¹¶ç¼“å­˜ï¼Œæäº¤æ—¶å†™å…¥æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Binlog åœ¨ä¸»åº“çš„æ—¥å¿—è®°å½•æ—¶æœº&lt;/strong&gt;ï¼š&lt;strong&gt;SQL è¯­å¥æ‰§è¡Œå®Œæˆåã€äº‹åŠ¡æäº¤å‰&lt;/strong&gt;ç”Ÿæˆæ—¥å¿—å¹¶ç¼“å­˜ï¼Œ&lt;strong&gt;äº‹åŠ¡æäº¤æ—¶&lt;/strong&gt;å†™å…¥ Binlog æ–‡ä»¶ï¼ˆæŒä¹…åŒ–æ—¶æœºç”± &lt;code&gt;sync_binlog&lt;/code&gt; æ§åˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è®¾è®¡æ„ä¹‰ï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…è®°å½•æœªå®é™…æ‰§è¡Œçš„è¯­å¥ï¼ˆå¦‚æ‰§è¡Œå¤±è´¥çš„æ“ä½œï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ä¸¤é˜¶æ®µæäº¤ä¸ Redo Log ååŒï¼Œå®ç°å´©æºƒæ¢å¤ä¸ä¸»ä»æ•°æ®ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;ï¼š
é«˜é¢‘å†™å…¥åœºæ™¯å»ºè®® &lt;code&gt;sync_binlog=1&lt;/code&gt; + &lt;code&gt;innodb_flush_log_at_trx_commit=1&lt;/code&gt;ï¼ˆåŒ1é…ç½®ï¼‰ï¼Œç‰ºç‰²éƒ¨åˆ†æ€§èƒ½æ¢å–ç»å¯¹æ•°æ®å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="ä¸»ä»åŒæ­¥å»¶è¿Ÿ"&gt;ä¸»ä»åŒæ­¥å»¶è¿Ÿ
&lt;/h2&gt;&lt;p&gt;ä¸»ä»åŒæ­¥å»¶è¿Ÿæ˜¯åˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿä¸­çš„å¸¸è§é—®é¢˜ï¼Œå°¤å…¶åœ¨MySQLæ¶æ„ä¸­ï¼Œä¸»è¦ç”±ç½‘ç»œä¼ è¾“ã€ç¡¬ä»¶æ€§èƒ½ã€é…ç½®ä¸å½“æˆ–ä¸šåŠ¡è´Ÿè½½ç­‰å› ç´ å¯¼è‡´ã€‚ä»¥ä¸‹æ˜¯ç³»ç»Ÿæ€§è§£å†³æ–¹æ¡ˆï¼ŒæŒ‰ä¼˜åŒ–ä¼˜å…ˆçº§æ’åºï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç²¾å‡†å®šä½å»¶è¿Ÿæ ¹æº"&gt;ğŸ” &lt;strong&gt;ç²¾å‡†å®šä½å»¶è¿Ÿæ ¹æº&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å…³é”®æŒ‡æ ‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;SHOW SLAVE STATUSï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Seconds_Behind_Master&lt;/code&gt;ï¼šå»¶è¿Ÿç§’æ•°ï¼ˆ&amp;gt;0å³å­˜åœ¨å»¶è¿Ÿï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Relay_Log_Pos&lt;/code&gt; vs &lt;code&gt;Read_Master_Log_Pos&lt;/code&gt;ï¼šå¯¹æ¯”ä¸»ä»æ—¥å¿—ä½ç½®å·®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ç“¶é¢ˆåˆ†æï¼š
&lt;ul&gt;
&lt;li&gt;ä¸»åº“TPSä¸Binlogç”Ÿæˆé€Ÿç‡ï¼ˆ&lt;code&gt;mysqlbinlog&lt;/code&gt;è§£æï¼‰&lt;/li&gt;
&lt;li&gt;ä»åº“CPU/å†…å­˜/ç£ç›˜I/Oï¼ˆ&lt;code&gt;top&lt;/code&gt;ã€&lt;code&gt;iostat&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;ç½‘ç»œå»¶è¿Ÿï¼ˆ&lt;code&gt;ping&lt;/code&gt;ã€&lt;code&gt;traceroute&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯†åˆ«é«˜é¢‘å»¶è¿Ÿåœºæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤§äº‹åŠ¡é˜»å¡&lt;/strong&gt;ï¼šæ£€æŸ¥&lt;code&gt;information_schema.INNODB_TRX&lt;/code&gt;ä¸­çš„é•¿äº‹åŠ¡&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•çº¿ç¨‹å¤åˆ¶ç“¶é¢ˆ&lt;/strong&gt;ï¼šä»åº“SQLçº¿ç¨‹ç§¯å‹ï¼ˆ&lt;code&gt;SHOW PROCESSLIST&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”ç«äº‰&lt;/strong&gt;ï¼šä»åº“æŸ¥è¯¢è´Ÿè½½è¿‡é«˜é˜»å¡å¤åˆ¶çº¿ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»ä»åº“é…ç½®ä¼˜åŒ–"&gt;âš™ï¸ &lt;strong&gt;ä¸»ä»åº“é…ç½®ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¸»åº“ä¾§"&gt;&lt;strong&gt;ä¸»åº“ä¾§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æ‹†åˆ†&lt;/strong&gt;ï¼šå°†å¤§äº‹åŠ¡æ‹†ä¸ºå°æ‰¹æ¬¡ï¼ˆå¦‚æ¯1000è¡Œæäº¤ä¸€æ¬¡ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°è°ƒä¼˜&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;sync_binlog = 100 # å¹³è¡¡å®‰å…¨æ€§ä¸I/Oï¼Œé¿å…æ¯æ¬¡æäº¤åˆ·ç›˜
innodb_flush_log_at_trx_commit = 2 # ç‰ºç‰²éƒ¨åˆ†å®‰å…¨æ€§æå‡å†™å…¥æ€§èƒ½
binlog_group_commit_sync_delay = 1000 # ç»„æäº¤å»¶è¿Ÿå‡å°‘åˆ·ç›˜æ¬¡æ•°
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä»åº“ä¾§"&gt;&lt;strong&gt;ä»åº“ä¾§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å¯ç”¨å¹¶è¡Œå¤åˆ¶ï¼ˆMySQL 5.7+ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;slave_parallel_type = LOGICAL_CLOCK # åŸºäºäº‹åŠ¡ç»„å¹¶è¡Œ
slave_parallel_workers = 8 # æŒ‰CPUæ ¸æ•°è®¾ç½®ï¼ˆé€šå¸¸â‰¤16ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;èµ„æºæ‰©å®¹ï¼š
&lt;ul&gt;
&lt;li&gt;å‡çº§SSDç£ç›˜ï¼ˆæå‡I/OPS 10å€+ï¼‰&lt;/li&gt;
&lt;li&gt;å†…å­˜æ‰©å®¹ï¼ˆå¢å¤§&lt;code&gt;innodb_buffer_pool_size&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œä¼˜åŒ–&lt;/strong&gt;ï¼šä¸»ä»åŒæœºæˆ¿éƒ¨ç½²ï¼Œä¸‡å…†å†…ç½‘äº’è”&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶æ„å‡çº§"&gt;ğŸ—ï¸ &lt;strong&gt;æ¶æ„å‡çº§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤åˆ¶æ¨¡å¼å¢å¼º&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŠåŒæ­¥å¤åˆ¶ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;INSTALL PLUGIN rpl_semi_sync_master SONAME &amp;#39;semisync_master.so&amp;#39;;
SET GLOBAL rpl_semi_sync_master_enabled = 1; # ä¸»åº“éœ€è‡³å°‘ä¸€ä¸ªä»åº“ACKç¡®è®¤
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»„å¤åˆ¶ï¼ˆMGRï¼‰&lt;/strong&gt;ï¼šMySQL 5.7+åŸºäºPaxosåè®®ï¼Œå¼ºä¸€è‡´æ€§ä½†æ€§èƒ½æŸè€—è¾ƒé«˜&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯»å†™åˆ†ç¦»ä¸è´Ÿè½½å‡è¡¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç†ä¸­é—´ä»¶ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ProxySQL/MaxScaleè‡ªåŠ¨è·¯ç”±å†™è¯·æ±‚åˆ°ä¸»åº“ï¼Œè¯»è¯·æ±‚åˆ°ä½å»¶è¿Ÿä»åº“&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šä»åº“æ¨ªå‘æ‰©å±•&lt;/strong&gt;ï¼šå¢åŠ ä»åº“æ•°é‡åˆ†æ‹…è¯»è´Ÿè½½&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ä¸å¼‚æ­¥é˜Ÿåˆ—&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redisç¼“å­˜çƒ­ç‚¹æ•°æ®&lt;/strong&gt;ï¼šå‡å°‘å¯¹ä»åº“çš„å®æ—¶æŸ¥è¯¢ä¾èµ–&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kafka/RabbitMQå¼‚æ­¥æ¶ˆè´¹&lt;/strong&gt;ï¼šé«˜å¹¶å‘å†™å…¥åœºæ™¯å…ˆå…¥é˜Ÿåˆ—ï¼Œå†å¼‚æ­¥åŒæ­¥åˆ°ä»åº“&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸šåŠ¡å¦¥åç­–ç•¥"&gt;ğŸ”„ &lt;strong&gt;ä¸šåŠ¡å¦¥åç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æœ€ç»ˆä¸€è‡´æ€§è®¾è®¡
&lt;ul&gt;
&lt;li&gt;éå®æ—¶åœºæ™¯ï¼ˆå¦‚ç”¨æˆ·è¯„è®ºï¼‰å®¹å¿çŸ­æš‚å»¶è¿Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¼ºåˆ¶è¯»ä¸»åº“ï¼š
&lt;ul&gt;
&lt;li&gt;å…³é”®ä¸šåŠ¡ï¼ˆå¦‚æ”¯ä»˜ï¼‰é…ç½®å¼ºåˆ¶è·¯ç”±åˆ°ä¸»åº“è¯»&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®è¡¥å¿æœºåˆ¶ï¼š
è‹¥å› å»¶è¿Ÿå¯¼è‡´åº“å­˜è¶…å–ï¼Œé€šè¿‡ä¸šåŠ¡é€»è¾‘å›æ»šæˆ–è¡¥è´§&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç´§æ€¥æ¢å¤æªæ–½"&gt;ğŸš¨ &lt;strong&gt;ç´§æ€¥æ¢å¤æªæ–½&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è·³è¿‡å•æ¬¡å»¶è¿Ÿï¼ˆæ…ç”¨ï¼ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;STOP SLAVE;
SET GLOBAL SQL_SLAVE_SKIP_COUNTER = 1; # è·³è¿‡ä¸€ä¸ªäº‹åŠ¡
START SLAVE;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;é‡å»ºä¸»ä»é“¾è·¯ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;STOP SLAVE;
RESET SLAVE ALL;
CHANGE MASTER TO ...; # é‡æ–°é…ç½®ä¸»åº“ä¿¡æ¯
START SLAVE;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“å¤„ç†ä¼˜å…ˆçº§çŸ©é˜µ"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šå¤„ç†ä¼˜å…ˆçº§çŸ©é˜µ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é¦–è¦æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¤‡é€‰æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çŸ­æ—¶å»¶è¿Ÿï¼ˆ&amp;lt;30sï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼˜åŒ–ä»åº“å¹¶è¡Œå¤åˆ¶+ç½‘ç»œå¸¦å®½&lt;/td&gt;
&lt;td&gt;æ‰©å®¹ä»åº“ç¡¬ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤§äº‹åŠ¡é˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‹†åˆ†äº‹åŠ¡+é¿å…DDLé«˜å³°&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡é”™å³°æ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¹¶å‘å†™å…¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯é˜Ÿåˆ—ç¼“å†²+ç¼“å­˜è¯»è¯·æ±‚&lt;/td&gt;
&lt;td&gt;å¼ºåˆ¶è¯»ä¸»åº“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŒç»­é«˜å»¶è¿Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¶æ„å‡çº§ï¼ˆMGR/ProxySQLï¼‰&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡è¡¥å¿æœºåˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ ¸å¿ƒåŸåˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å…ˆè¡Œ&lt;/strong&gt;ï¼šPrometheus+Grafanaè®¾ç½®å»¶è¿Ÿå‘Šè­¦ï¼ˆ&amp;gt;300sè§¦å‘ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…è¿‡åº¦ä¼˜åŒ–&lt;/strong&gt;ï¼šæ ¹æ®ä¸šåŠ¡å®¹å¿åº¦é€‰æ‹©æ–¹æ¡ˆï¼ˆå¦‚é‡‘èç³»ç»Ÿéœ€å¼ºä¸€è‡´ï¼Œç¤¾äº¤å¯å®¹å¿å»¶è¿Ÿï¼‰
é€šè¿‡ä»¥ä¸Šç»„åˆç­–ç•¥ï¼Œå¯æ˜¾è‘—é™ä½å»¶è¿Ÿè‡³ä¸šåŠ¡å¯æ¥å—èŒƒå›´ï¼ˆé€šå¸¸&amp;lt;1sï¼‰ã€‚è‹¥éœ€ä¸¥æ ¼å¼ºä¸€è‡´ï¼Œå»ºè®®è¯„ä¼°åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆå¦‚TiDBï¼‰æ›¿ä»£æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="è¯»å†™åˆ†ç¦»"&gt;è¯»å†™åˆ†ç¦»
&lt;/h2&gt;&lt;p&gt;å®ç°è¯»å†™åˆ†ç¦»çš„æ ¸å¿ƒç›®æ ‡æ˜¯å°†æ•°æ®åº“çš„è¯»æ“ä½œï¼ˆå¦‚ &lt;code&gt;SELECT&lt;/code&gt;ï¼‰å’Œå†™æ“ä½œï¼ˆå¦‚ &lt;code&gt;INSERT&lt;/code&gt;/&lt;code&gt;UPDATE&lt;/code&gt;/&lt;code&gt;DELETE&lt;/code&gt;ï¼‰åˆ†ç¦»åˆ°ä¸åŒå®ä¾‹ï¼Œä»¥æå‡ç³»ç»Ÿå¹¶å‘èƒ½åŠ›å’Œæ‰©å±•æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸‰ç§ä¸»æµå®ç°æ–¹æ¡ˆåŠå®è·µè¦ç‚¹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»ä»å¤åˆ¶åŸºç¡€"&gt;ğŸ”§ &lt;strong&gt;ä¸»ä»å¤åˆ¶åŸºç¡€&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è¯»å†™åˆ†ç¦»ä¾èµ–æ•°æ®åº“çš„ä¸»ä»å¤åˆ¶æ¶æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»åº“ï¼ˆMasterï¼‰&lt;/strong&gt;ï¼šå¤„ç†æ‰€æœ‰å†™æ“ä½œï¼Œç”ŸæˆäºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBinlogï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»åº“ï¼ˆSlaveï¼‰&lt;/strong&gt;ï¼šé€šè¿‡ I/O çº¿ç¨‹æ‹‰å– Binlogï¼ŒSQL çº¿ç¨‹é‡æ”¾æ—¥å¿—å®ç°æ•°æ®åŒæ­¥ã€‚&lt;/li&gt;
&lt;li&gt;é…ç½®æ­¥éª¤ï¼š
&lt;ol&gt;
&lt;li&gt;ä¸»åº“å¼€å¯ &lt;code&gt;log_bin&lt;/code&gt; å¹¶é…ç½®å”¯ä¸€ &lt;code&gt;server-id&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åˆ›å»ºå¤åˆ¶è´¦å·ï¼ˆ&lt;code&gt;GRANT REPLICATION SLAVE&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»åº“é…ç½®ä¸»åº“ä¿¡æ¯ï¼ˆ&lt;code&gt;CHANGE MASTER TO ...&lt;/code&gt;ï¼‰å¹¶å¯åŠ¨å¤åˆ¶ï¼ˆ&lt;code&gt;START SLAVE&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å…³é”®å‘½ä»¤ï¼š&lt;code&gt;SHOW SLAVE STATUS\G&lt;/code&gt; æ£€æŸ¥ &lt;code&gt;Slave_IO_Running&lt;/code&gt; å’Œ &lt;code&gt;Slave_SQL_Running&lt;/code&gt; çŠ¶æ€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰ç§å®ç°æ–¹æ¡ˆå¯¹æ¯”"&gt;âš™ï¸ &lt;strong&gt;ä¸‰ç§å®ç°æ–¹æ¡ˆå¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åº”ç”¨å±‚å®ç°ä»£ç æ§åˆ¶"&gt;&lt;strong&gt;åº”ç”¨å±‚å®ç°ï¼ˆä»£ç æ§åˆ¶ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåœ¨ä¸šåŠ¡ä»£ç ä¸­æ ¹æ®æ“ä½œç±»å‹åŠ¨æ€é€‰æ‹©æ•°æ®æºã€‚
â€‹&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;â€‹ï¼ˆä»¥ Spring Boot ä¸ºä¾‹ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€æ•°æ®æºè·¯ç”±ï¼š
ç»§æ‰¿
&lt;pre tabindex="0"&gt;&lt;code&gt;AbstractRoutingDataSource
&lt;/code&gt;&lt;/pre&gt;ï¼Œé€šè¿‡çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼ˆå¦‚
&lt;pre tabindex="0"&gt;&lt;code&gt;ThreadLocal
&lt;/code&gt;&lt;/pre&gt;ï¼‰åˆ‡æ¢ä¸»ä»åº“ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;public class DynamicDataSource extends AbstractRoutingDataSource {
@Override
protected Object determineCurrentLookupKey() {
return DataSourceContextHolder.getDataSourceType(); // è¿”å› &amp;#34;master&amp;#34; æˆ– &amp;#34;slave&amp;#34;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;AOP åˆ‡é¢è‡ªåŠ¨åˆ‡æ¢ï¼š
é€šè¿‡æ³¨è§£æ ‡è®°æ–¹æ³•ç±»å‹ï¼ˆè¯»/å†™ï¼‰ï¼Œæ‹¦æˆªè¯·æ±‚å¹¶è®¾ç½®æ•°æ®æºã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;@Around(&amp;#34;@annotation(readOnly)&amp;#34;)
public Object setReadOnly(ProceedingJoinPoint pjp, ReadOnly readOnly) {
DataSourceContextHolder.setSlave(); // æ ‡è®°ä¸ºè¯»æ“ä½œ
Object result = pjp.proceed();
DataSourceContextHolder.clear();
return result;
}
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šä¸šåŠ¡é€»è¾‘ç®€å•ï¼Œå¼€å‘å›¢é˜Ÿæœ‰è¾ƒå¼ºæ§åˆ¶èƒ½åŠ›ã€‚
â€‹&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;â€‹ï¼šä»£ç ä¾µå…¥æ€§å¼ºï¼Œéœ€å¤„ç†äº‹åŠ¡ä¸€è‡´æ€§ï¼ˆå¦‚äº‹åŠ¡å†…å¼ºåˆ¶èµ°ä¸»åº“ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸­é—´ä»¶ä»£ç†é€æ˜è·¯ç”±"&gt;&lt;strong&gt;ä¸­é—´ä»¶ä»£ç†ï¼ˆé€æ˜è·¯ç”±ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šé€šè¿‡ä»£ç†å±‚è‡ªåŠ¨åˆ†å‘ SQLï¼Œåº”ç”¨æ— æ„ŸçŸ¥ã€‚
â€‹&lt;strong&gt;å¸¸ç”¨å·¥å…·&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ProxySQLï¼šé«˜æ€§èƒ½ä»£ç†ï¼Œæ”¯æŒå¤æ‚è·¯ç”±è§„åˆ™å’Œè´Ÿè½½å‡è¡¡ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;INSERT INTO mysql_servers (hostgroup_id, hostname, port)
VALUES (0, &amp;#39;master_ip&amp;#39;, 3306), (1, &amp;#39;slave_ip&amp;#39;, 3306); -- é…ç½®ä¸»ä»å®ä¾‹
INSERT INTO mysql_query_rules (active, match_pattern, destination_hostgroup)
VALUES (1, &amp;#39;^SELECT&amp;#39;, 1), (1, &amp;#39;^INSERT|^UPDATE|^DELETE&amp;#39;, 0); -- è¯»è·¯ç”±åˆ°ä»åº“ï¼Œå†™è·¯ç”±åˆ°ä¸»åº“
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MySQL Router&lt;/strong&gt;ï¼šå®˜æ–¹è½»é‡çº§ä¸­é—´ä»¶ï¼Œè‡ªåŠ¨è¯†åˆ«è¯»å†™æ“ä½œã€‚
â€‹&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;â€‹ï¼šä¸ä¸šåŠ¡è§£è€¦ï¼Œæ”¯æŒåŠ¨æ€æ‰©ç¼©å®¹ã€‚
â€‹&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;â€‹ï¼šå¤šå®ä¾‹é›†ç¾¤ã€é«˜å¹¶å‘è¯»è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®åº“å†…ç½®æ–¹æ¡ˆ"&gt;&lt;strong&gt;æ•°æ®åº“å†…ç½®æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯»å†™ç«¯å£åˆ†ç¦»&lt;/strong&gt;ï¼š
ä¸»åº“å’Œä»åº“ä½¿ç”¨ä¸åŒç«¯å£ï¼ˆå¦‚ä¸»åº“ &lt;code&gt;3306&lt;/code&gt;ï¼Œä»åº“ &lt;code&gt;3307&lt;/code&gt;ï¼‰ï¼Œåº”ç”¨æ‰‹åŠ¨è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åªè¯»å‰¯æœ¬é™åˆ¶&lt;/strong&gt;ï¼š
ä»åº“é…ç½® &lt;code&gt;read_only=ON&lt;/code&gt; ç¦æ­¢å†™æ“ä½œï¼Œé¿å…è¯¯æ“ä½œã€‚
â€‹&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;â€‹ï¼šå°è§„æ¨¡åº”ç”¨ï¼Œæ— å¤æ‚è·¯ç”±éœ€æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ"&gt;âš ï¸ &lt;strong&gt;å…³é”®æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ•°æ®ä¸€è‡´æ€§"&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šä¸»ä»å¼‚æ­¥å¤åˆ¶å¯¼è‡´è¯»å»¶è¿Ÿï¼ˆå¦‚åˆšå†™å…¥çš„æ•°æ®ä»åº“æœªåŒæ­¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºåˆ¶è¯»ä¸»åº“&lt;/strong&gt;ï¼šå¯¹ä¸€è‡´æ€§è¦æ±‚é«˜çš„æŸ¥è¯¢ï¼ˆå¦‚æ”¯ä»˜çŠ¶æ€ï¼‰æ˜¾å¼æŒ‡å®šä¸»åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠåŒæ­¥å¤åˆ¶&lt;/strong&gt;ï¼šä¸»åº“å†™å…¥éœ€è‡³å°‘ä¸€ä¸ªä»åº“ç¡®è®¤ï¼ˆ&lt;code&gt;rpl_semi_sync_master_enabled=1&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿç›‘æ§&lt;/strong&gt;ï¼šå®æ—¶æ£€æµ‹ &lt;code&gt;Seconds_Behind_Master&lt;/code&gt;ï¼Œè¶…é˜ˆå€¼è‡ªåŠ¨åˆ‡ä¸»åº“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è´Ÿè½½å‡è¡¡ç­–ç•¥"&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡ç­–ç•¥&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è½®è¯¢/åŠ æƒè½®è¯¢&lt;/strong&gt;ï¼šå‡åŒ€åˆ†é…è¯»è¯·æ±‚åˆ°å¤šä¸ªä»åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€å°è¿æ¥æ•°&lt;/strong&gt;ï¼šä¼˜å…ˆé€‰æ‹©è´Ÿè½½ä½çš„ä»åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†çº§ä»åº“&lt;/strong&gt;ï¼šæŒ‰å»¶è¿Ÿåˆ†çº§ï¼ˆå¦‚ &lt;code&gt;&amp;lt;100ms&lt;/code&gt; çš„ä»åº“æœåŠ¡å®æ—¶æŸ¥è¯¢ï¼Œ&lt;code&gt;&amp;lt;500ms&lt;/code&gt; çš„ç”¨äºæŠ¥è¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="äº‹åŠ¡å¤„ç†"&gt;&lt;strong&gt;äº‹åŠ¡å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡å†…è¯»æ“ä½œ&lt;/strong&gt;ï¼šé»˜è®¤è·¯ç”±åˆ°ä¸»åº“ï¼ˆé¿å…è„è¯»ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨åº“äº‹åŠ¡&lt;/strong&gt;ï¼šé€šè¿‡åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ï¼ˆå¦‚ Seataï¼‰æˆ–é¿å…è·¨åº“æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‰å‹å»ºè®®"&gt;ğŸ§© &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èæ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¸­å°åº”ç”¨ï¼Œå¼€å‘å¯æ§&lt;/td&gt;
&lt;td&gt;åº”ç”¨å±‚å®ç° + AOP&lt;/td&gt;
&lt;td&gt;çµæ´»ã€æˆæœ¬ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é«˜å¹¶å‘é›†ç¾¤ï¼Œéœ€åŠ¨æ€æ‰©å±•&lt;/td&gt;
&lt;td&gt;ProxySQL/MySQL Router&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨åŒ–è·¯ç”±ï¼Œè¿ç»´ç®€å•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¼ºä¸€è‡´æ€§é‡‘èç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;åŠåŒæ­¥å¤åˆ¶ + å¼ºåˆ¶è¯»ä¸»&lt;/td&gt;
&lt;td&gt;æ•°æ®é›¶å»¶è¿Ÿé£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†å²æ•°æ®åˆ†æ&lt;/td&gt;
&lt;td&gt;å»¶è¿Ÿä»åº“ + ä¸­é—´ä»¶è·¯ç”±&lt;/td&gt;
&lt;td&gt;éš”ç¦»æ…¢æŸ¥è¯¢ï¼Œä¸å½±å“å®æ—¶ä¸šåŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€æ¶æ„&lt;/strong&gt;ï¼šä¸»ä»å¤åˆ¶æ˜¯åŸºçŸ³ï¼Œéœ€ä¼˜å…ˆé…ç½®ç¨³å®šã€‚&lt;/li&gt;
&lt;li&gt;å®ç°è·¯å¾„ï¼š
&lt;ul&gt;
&lt;li&gt;ä»£ç æ§åˆ¶ï¼ˆçµæ´»ï¼‰ â†’ ä¸­é—´ä»¶ï¼ˆè‡ªåŠ¨åŒ–ï¼‰ â†’ æ•°æ®åº“å†…ç½®ï¼ˆè½»é‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§ä¿éšœ&lt;/strong&gt;ï¼šç»“åˆåŠåŒæ­¥å¤åˆ¶ã€å¼ºåˆ¶è¯»ä¸»å’Œå»¶è¿Ÿç›‘æ§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼šä»åº“åŠ ç´¢å¼•ã€è¿æ¥æ± è°ƒä¼˜ï¼ˆå¦‚ HikariCP &lt;code&gt;maximumPoolSize&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”Ÿäº§å»ºè®®ï¼šä¼˜å…ˆæµ‹è¯•ä¸­é—´ä»¶æ–¹æ¡ˆï¼ˆå¦‚ ProxySQLï¼‰ï¼Œæ­é… Prometheus ç›‘æ§å»¶è¿Ÿå’Œååé‡ã€‚å¯¹å¼ºä¸€è‡´æ€§åœºæ™¯ï¼Œå¯è¯„ä¼°åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆå¦‚ TiDBï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="åˆ†åº“åˆ†è¡¨"&gt;åˆ†åº“åˆ†è¡¨
&lt;/h2&gt;&lt;p&gt;åˆ†åº“åˆ†è¡¨æ˜¯åº”å¯¹æµ·é‡æ•°æ®å’Œé«˜å¹¶å‘åœºæ™¯çš„æ•°æ®åº“æ¶æ„ä¼˜åŒ–æŠ€æœ¯ï¼Œå…¶æ ¸å¿ƒæ˜¯å°†å•åº“å•è¡¨çš„æ•°æ®æŒ‰è§„åˆ™åˆ†æ•£åˆ°å¤šä¸ªåº“æˆ–è¡¨ä¸­ï¼Œä»¥æå‡ç³»ç»Ÿæ€§èƒ½å’Œæ‰©å±•æ€§ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒè¦ç‚¹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†åº“åˆ†è¡¨çš„æ ¸å¿ƒç±»å‹"&gt;ğŸ” &lt;strong&gt;åˆ†åº“åˆ†è¡¨çš„æ ¸å¿ƒç±»å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å‚ç›´æ‹†åˆ†æŒ‰ä¸šåŠ¡æˆ–å­—æ®µ"&gt;&lt;strong&gt;å‚ç›´æ‹†åˆ†ï¼ˆæŒ‰ä¸šåŠ¡æˆ–å­—æ®µï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‚ç›´åˆ†åº“&lt;/strong&gt;
æŒ‰ä¸šåŠ¡æ¨¡å—æ‹†åˆ†è¡¨åˆ°ä¸åŒæ•°æ®åº“ï¼ˆå¦‚ç”¨æˆ·åº“ã€è®¢å•åº“ã€å•†å“åº“ï¼‰ã€‚
â€‹&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;â€‹ï¼šä¸šåŠ¡è§£è€¦ã€èµ„æºéš”ç¦»ï¼›&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;â€‹ï¼šæ— æ³•è§£å†³å•è¡¨æ•°æ®é‡è¿‡å¤§é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚ç›´åˆ†è¡¨&lt;/strong&gt;
æŒ‰å­—æ®µæ‹†åˆ†è¡¨ï¼ˆå¦‚å°†&lt;code&gt;user&lt;/code&gt;è¡¨æ‹†æˆ&lt;code&gt;user_base&lt;/code&gt;ï¼ˆåŸºæœ¬ä¿¡æ¯ï¼‰å’Œ&lt;code&gt;user_detail&lt;/code&gt;ï¼ˆæ‰©å±•ä¿¡æ¯ï¼‰ï¼‰ã€‚
â€‹&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;â€‹ï¼šå‡å°‘å•è¡¨å­—æ®µé‡ã€æå‡é«˜é¢‘å­—æ®µæŸ¥è¯¢æ•ˆç‡ï¼›&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;â€‹ï¼šéœ€å…³è”æŸ¥è¯¢ï¼Œå¢åŠ å¤æ‚åº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ°´å¹³æ‹†åˆ†æŒ‰æ•°æ®è¡Œ"&gt;&lt;strong&gt;æ°´å¹³æ‹†åˆ†ï¼ˆæŒ‰æ•°æ®è¡Œï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ°´å¹³åˆ†åº“&lt;/strong&gt;
å°†åŒä¸€è¡¨çš„æ•°æ®æŒ‰è§„åˆ™ï¼ˆå¦‚ç”¨æˆ·IDå“ˆå¸Œï¼‰åˆ†æ•£åˆ°å¤šä¸ªæ•°æ®åº“å®ä¾‹ã€‚
â€‹&lt;strong&gt;åœºæ™¯&lt;/strong&gt;â€‹ï¼šå•åº“å†™å…¥å‹åŠ›å¤§æˆ–å­˜å‚¨å®¹é‡ä¸è¶³ï¼ˆå¦‚è®¢å•åº“æŒ‰å¹´ä»½æ‹†åˆ†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ°´å¹³åˆ†è¡¨&lt;/strong&gt;
å°†å•è¡¨æ•°æ®æŒ‰è§„åˆ™æ‹†åˆ†ä¸ºå¤šä¸ªç»“æ„ç›¸åŒçš„å­è¡¨ï¼ˆå¦‚&lt;code&gt;order_0&lt;/code&gt;ã€&lt;code&gt;order_1&lt;/code&gt;ï¼‰ã€‚
â€‹&lt;strong&gt;åœºæ™¯&lt;/strong&gt;â€‹ï¼šå•è¡¨æ•°æ®è¶…åƒä¸‡ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¸‹é™ï¼ˆå¦‚ç”¨æˆ·è¡¨æŒ‰IDèŒƒå›´æ‹†åˆ†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†åº“åˆ†è¡¨çš„é€‚ç”¨åœºæ™¯"&gt;âš™ï¸ &lt;strong&gt;åˆ†åº“åˆ†è¡¨çš„é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®é‡è¿‡å¤§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•è¡¨è¶…åƒä¸‡è¡Œï¼ŒæŸ¥è¯¢æ…¢ã€ç»´æŠ¤éš¾&lt;/td&gt;
&lt;td&gt;æ°´å¹³åˆ†è¡¨/åˆ†åº“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¹¶å‘å†™å…¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•åº“å†™å…¥æˆä¸ºç“¶é¢ˆï¼Œé”ç«äº‰ä¸¥é‡&lt;/td&gt;
&lt;td&gt;æ°´å¹³åˆ†åº“åˆ†æ•£å†™å…¥å‹åŠ›&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸šåŠ¡è§£è€¦éœ€æ±‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸åŒä¸šåŠ¡æ¨¡å—ç›¸äº’å½±å“ï¼ˆå¦‚ç”¨æˆ·ä¸è®¢å•ï¼‰&lt;/td&gt;
&lt;td&gt;å‚ç›´åˆ†åº“éš”ç¦»èµ„æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†·çƒ­æ•°æ®åˆ†ç¦»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†å²æ•°æ®è®¿é—®ä½é¢‘ä½†å ç”¨å­˜å‚¨&lt;/td&gt;
&lt;td&gt;æ°´å¹³åˆ†è¡¨æŒ‰æ—¶é—´æ‹†åˆ†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;ä½•æ—¶éœ€åˆ†åº“åˆ†è¡¨ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å•è¡¨æ•°æ®é‡ &amp;gt; 1000ä¸‡è¡Œ&lt;/li&gt;
&lt;li&gt;å•åº“QPS &amp;gt; 2000 æˆ–ç£ç›˜å®¹é‡æ¥è¿‘ä¸Šé™&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†åº“åˆ†è¡¨çš„å…³é”®æŠ€æœ¯"&gt;ğŸ§© &lt;strong&gt;åˆ†åº“åˆ†è¡¨çš„å…³é”®æŠ€æœ¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åˆ†ç‰‡ç­–ç•¥ä¸ç®—æ³•"&gt;&lt;strong&gt;åˆ†ç‰‡ç­–ç•¥ä¸ç®—æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç‰‡é”®é€‰æ‹©&lt;/strong&gt;ï¼šéœ€ç¦»æ•£å‡åŒ€ï¼ˆå¦‚ç”¨æˆ·IDï¼‰ã€ä¸šåŠ¡å…³è”æ€§å¼ºã€ä¸å¯å˜ã€‚&lt;/li&gt;
&lt;li&gt;å¸¸ç”¨ç®—æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œå–æ¨¡&lt;/strong&gt;ï¼šæ•°æ®å‡åŒ€åˆ†å¸ƒï¼ˆå¦‚ &lt;code&gt;user_id % 4&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŒƒå›´åˆ†ç‰‡&lt;/strong&gt;ï¼šæŒ‰æ—¶é—´æˆ–IDåŒºé—´åˆ’åˆ†ï¼ˆå¦‚è®¢å•æŒ‰æœˆåˆ†è¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/strong&gt;ï¼šæ‰©å®¹æ—¶å‡å°‘æ•°æ®è¿ç§»é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å®ç°æ–¹å¼å¯¹æ¯”"&gt;&lt;strong&gt;å®ç°æ–¹å¼å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº”ç”¨å±‚ç¼–ç &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡ä»£ç ä¸­å®ç°åˆ†ç‰‡é€»è¾‘&lt;/td&gt;
&lt;td&gt;çµæ´»å¯æ§&lt;/td&gt;
&lt;td&gt;å¼€å‘å¤æ‚ï¼Œä¾µå…¥æ€§å¼º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸­é—´ä»¶ä»£ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ShardingSphere/MyCatè‡ªåŠ¨è·¯ç”±&lt;/td&gt;
&lt;td&gt;å¯¹ä¸šåŠ¡é€æ˜ï¼Œæ”¯æŒåŠ¨æ€æ‰©ç¼©å®¹&lt;/td&gt;
&lt;td&gt;ä¾èµ–ä¸­é—´ä»¶æ€§èƒ½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼æ•°æ®åº“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸç”Ÿæ”¯æŒåˆ†ç‰‡ï¼ˆå¦‚TiDBã€OceanBaseï¼‰&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨æ‰©å®¹ï¼Œå¼ºä¸€è‡´æ€§äº‹åŠ¡&lt;/td&gt;
&lt;td&gt;æˆæœ¬é«˜ï¼Œæ¶æ„å¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;æ¨èå®è·µ&lt;/strong&gt;ï¼šä¼˜å…ˆä½¿ç”¨ &lt;strong&gt;ShardingSphere&lt;/strong&gt; ç­‰ä¸­é—´ä»¶ï¼Œé…ç½®åˆ†ç‰‡è§„åˆ™ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;sharding:
tables:
order:
actual-data-nodes: ds${0..1}.order_${0..1}
database-strategy:
inline: sharding-column: order_id; algorithm-expression: ds${order_id % 2}
table-strategy:
inline: sharding-column: order_id; algorithm-expression: order_${order_id % 2}
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ"&gt;âš ï¸ &lt;strong&gt;æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è·¨åº“/è¡¨æŸ¥è¯¢&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šJOINæ“ä½œå¤æ‚ï¼Œæ€§èƒ½å·®ã€‚&lt;/li&gt;
&lt;li&gt;æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…è·¨åˆ†ç‰‡æŸ¥è¯¢ï¼Œæˆ–é€šè¿‡ä¸­é—´ä»¶åˆå¹¶ç»“æœï¼ˆå¦‚ShardingSphereçš„&lt;code&gt;UNION ALL&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å†—ä½™å­—æ®µæˆ–å…¨å±€è¡¨ï¼ˆå¦‚åŸºç¡€é…ç½®è¡¨åŒæ­¥åˆ°æ‰€æœ‰åº“ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼äº‹åŠ¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šæ•°æ®ä¸€è‡´æ€§éš¾ä¿éšœã€‚&lt;/li&gt;
&lt;li&gt;æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;å¼ºä¸€è‡´æ€§ï¼šä½¿ç”¨Seataçš„XAæ¨¡å¼æˆ–åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆTiDBçš„Percolatoräº‹åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆä¸€è‡´æ€§ï¼šé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚Kafkaï¼‰å¼‚æ­¥è¡¥å¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸»é”®å†²çª&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šé‡‡ç”¨åˆ†å¸ƒå¼IDç”Ÿæˆå™¨ï¼ˆå¦‚Snowflakeã€UUIDï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å®¹è¿ç§»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šåŒå†™è¿‡æ¸¡æˆ–åœ¨çº¿è¿ç§»å·¥å…·ï¼ˆå¦‚ShardingSphere-Scalingï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åˆ†åº“åˆ†è¡¨æ˜¯&lt;strong&gt;æ°´å¹³æ‰©å±•ï¼ˆScale-outï¼‰&lt;strong&gt;çš„æ ¸å¿ƒæ‰‹æ®µï¼Œæœ¬è´¨æ˜¯&lt;/strong&gt;ç”¨æ¶æ„å¤æ‚åº¦æ¢å–æ€§èƒ½ä¸å®¹é‡&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‚ç›´æ‹†åˆ†&lt;/strong&gt;ä¼˜å…ˆè§£å†³ä¸šåŠ¡è€¦åˆé—®é¢˜ï¼Œ&lt;strong&gt;æ°´å¹³æ‹†åˆ†&lt;/strong&gt;åº”å¯¹æ•°æ®é‡ä¸å¹¶å‘å‹åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸­é—´ä»¶æ–¹æ¡ˆ&lt;/strong&gt;ï¼ˆå¦‚ShardingSphereï¼‰æ˜¯ä¸»æµé€‰æ‹©ï¼Œå¹³è¡¡å¼€å‘æ•ˆç‡ä¸è¿ç»´æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼æ•°æ®åº“&lt;/strong&gt;ï¼ˆå¦‚TiDBï¼‰åœ¨å¼ºä¸€è‡´æ€§ä¸è‡ªåŠ¨åˆ†ç‰‡åœºæ™¯æ›´ä¼˜ï¼Œä½†æˆæœ¬è¾ƒé«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš™ï¸ &lt;strong&gt;å®æ–½å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆç›‘æ§å®šä½ç“¶é¢ˆï¼ˆæ•°æ®é‡ï¼Ÿå¹¶å‘ï¼Ÿï¼‰ï¼Œé¿å…è¿‡æ—©ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†ç‰‡é”®è®¾è®¡ &amp;gt; ç®—æ³•é€‰æ‹© &amp;gt; å·¥å…·è½åœ°ï¼Œé€æ­¥éªŒè¯ã€‚&lt;/li&gt;
&lt;li&gt;é‡‘èç­‰å¼ºä¸€è‡´ç³»ç»Ÿï¼Œä¼˜å…ˆè¯„ä¼°åˆ†å¸ƒå¼æ•°æ®åº“ï¼›é«˜å¹¶å‘äº’è”ç½‘åº”ç”¨ï¼Œä¸­é—´ä»¶åˆ†ç‰‡æ›´çµæ´»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2 id="ç¼“å­˜ç©¿é€å‡»ç©¿é›ªå´©"&gt;ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ä¸ç¼“å­˜é›ªå´©çš„è¯¦ç»†å¯¹æ¯”åˆ†æï¼Œæ¶µç›–å®šä¹‰ã€åŸå› ã€å½±å“åŠè§£å†³æ–¹æ¡ˆï¼Œç»“åˆæŠ€æœ¯å®ç°ä¸é€‚ç”¨åœºæ™¯è¿›è¡Œè¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-é—®é¢˜å®šä¹‰ä¸æ ¸å¿ƒåŒºåˆ«"&gt;âš¡ é—®é¢˜å®šä¹‰ä¸æ ¸å¿ƒåŒºåˆ«
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é—®é¢˜ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…³é”®ç‰¹å¾&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜ç©¿é€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢&lt;strong&gt;ä¸å­˜åœ¨çš„æ•°æ®&lt;/strong&gt;ï¼Œç¼“å­˜å’Œæ•°æ®åº“å‡æ— ç»“æœï¼Œå¯¼è‡´è¯·æ±‚ç›´æ¥å†²å‡»æ•°æ®åº“&lt;a class="link" href="@ref" &gt;1,2,6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;â€¢ æ•°æ®ç»å¯¹ä¸å­˜åœ¨ â€¢ æ¶æ„è¯·æ±‚æˆ–å‚æ•°å¼‚å¸¸&lt;/td&gt;
&lt;td&gt;â€¢ æ”»å‡»è€…ä¼ªé€ éšæœºIDï¼ˆå¦‚è´Ÿå€¼ï¼‰ â€¢ ä¸šåŠ¡é€»è¾‘ç¼ºé™·å¯¼è‡´éæ³•å‚æ•°æŸ¥è¯¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜å‡»ç©¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;çƒ­ç‚¹æ•°æ®çªç„¶å¤±æ•ˆ&lt;/strong&gt;ï¼Œå¤§é‡å¹¶å‘è¯·æ±‚ç›´æ¥è®¿é—®æ•°æ®åº“&lt;a class="link" href="@ref" &gt;1,5,9&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;â€¢ å•ä¸€çƒ­ç‚¹Keyè¿‡æœŸ â€¢ é«˜å¹¶å‘è®¿é—®é›†ä¸­&lt;/td&gt;
&lt;td&gt;â€¢ ç§’æ€å•†å“ç¼“å­˜è¿‡æœŸ â€¢ çƒ­æœæ–°é—»ç¼“å­˜å¤±æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜é›ªå´©&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤§é‡ç¼“å­˜åŒæ—¶å¤±æ•ˆ&lt;/strong&gt;æˆ–&lt;strong&gt;ç¼“å­˜æœåŠ¡å®•æœº&lt;/strong&gt;ï¼Œè¯·æ±‚é›†ä½“æ¶Œå…¥æ•°æ®åº“&lt;a class="link" href="@ref" &gt;3,5,10&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;â€¢ å¤šKeyé›†ä¸­è¿‡æœŸ â€¢ ç¼“å­˜é›†ç¾¤æ•…éšœ&lt;/td&gt;
&lt;td&gt;â€¢ ç¼“å­˜ç»Ÿä¸€è®¾ç½®æ•´ç‚¹è¿‡æœŸ â€¢ Redisä¸»èŠ‚ç‚¹å®•æœº&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åŸå› ä¸å½±å“å¯¹æ¯”"&gt;ğŸ” åŸå› ä¸å½±å“å¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¸»è¦åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç›´æ¥å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ½œåœ¨é£é™©&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜ç©¿é€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â€¢ æ¶æ„æ”»å‡»ï¼ˆä¼ªé€ IDï¼‰ â€¢ æœªç¼“å­˜ç©ºå€¼æˆ–æ ¡éªŒå‚æ•°&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;â€¢ æ•°æ®åº“é¢‘ç¹æŸ¥è¯¢ä¸å­˜åœ¨æ•°æ® â€¢ CPUå’Œè¿æ¥æ•°æ¿€å¢&lt;/td&gt;
&lt;td&gt;â€¢ æ•°æ®åº“è¿‡è½½å®•æœº â€¢ èµ„æºæµªè´¹ï¼ˆå¤§é‡ç©ºæŸ¥è¯¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜å‡»ç©¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â€¢ çƒ­ç‚¹æ•°æ®TTLè®¾ç½®è¿‡çŸ­ â€¢ ç¼“å­˜æ„å¤–åˆ é™¤&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;â€¢ æ•°æ®åº“ç¬æ—¶é«˜å¹¶å‘æŸ¥è¯¢ â€¢ å“åº”å»¶è¿Ÿé£™å‡&lt;/td&gt;
&lt;td&gt;â€¢ æ•°æ®åº“è¿æ¥æ± è€—å°½ â€¢ æœåŠ¡é›ªå´©ï¼ˆçº§è”æ•…éšœï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜é›ªå´©&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â€¢ æ‰¹é‡Keyè®¾ç½®ç›¸åŒTTL â€¢ ç¼“å­˜é›†ç¾¤æ•…éšœï¼ˆå¦‚Rediså®•æœºï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;â€¢ æ•°æ®åº“è¯·æ±‚é‡æŒ‡æ•°çº§å¢é•¿ â€¢ ç³»ç»Ÿå…¨é¢å»¶è¿Ÿ&lt;/td&gt;
&lt;td&gt;â€¢ æ•°æ®åº“å´©æºƒ â€¢ æ•´ä¸ªæœåŠ¡ä¸å¯ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-è§£å†³æ–¹æ¡ˆä¸é€‚ç”¨åœºæ™¯"&gt;ğŸ›  è§£å†³æ–¹æ¡ˆä¸é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;h4 id="ç¼“å­˜ç©¿é€è§£å†³æ–¹æ¡ˆ"&gt;&lt;strong&gt;ç¼“å­˜ç©¿é€è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šé¢„å­˜æ‰€æœ‰åˆæ³•Keyçš„å“ˆå¸Œå€¼ï¼Œæ‹¦æˆªéæ³•è¯·æ±‚&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå†…å­˜å ç”¨ä½ï¼Œæ‹¦æˆªæ•ˆç‡é«˜ï¼ˆO(1)å¤æ‚åº¦ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå­˜åœ¨è¯¯åˆ¤ç‡ï¼ˆå‡é˜³æ€§ï¼‰ï¼Œéœ€å®šæœŸæ›´æ–°æ•°æ®&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨&lt;/strong&gt;ï¼šè¯»å¤šå†™å°‘åœºæ™¯ï¼ˆå¦‚å•†å“IDæ ¡éªŒï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ç©ºå€¼ï¼ˆNull Cachingï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šæ•°æ®åº“æ— æ•°æ®æ—¶ï¼Œç¼“å­˜çŸ­TTLçš„ç©ºå€¼ï¼ˆå¦‚&lt;code&gt;key:null&lt;/code&gt;, TTL=30ç§’ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šç®€å•æ˜“å®ç°ï¼Œå‡å°‘é‡å¤æŸ¥è¯¢&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå¯èƒ½ç¼“å­˜å¤§é‡æ— æ•ˆKeyï¼Œå ç”¨å†…å­˜&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»„åˆç­–ç•¥&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç¤ºä¾‹ï¼šå¸ƒéš†è¿‡æ»¤å™¨ + ç©ºå€¼ç¼“å­˜
public User getUser(Long id) {
if (!bloomFilter.mightContain(id)) return null; // æ‹¦æˆªéæ³•ID
User user = cache.get(id);
if (user == null) {
user = db.query(id);
if (user != null) cache.set(id, user);
else cache.set(id, &amp;#34;NULL&amp;#34;, 60); // ç¼“å­˜ç©ºå€¼60ç§’[6,8](@ref)
}
return user;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4 id="ç¼“å­˜å‡»ç©¿è§£å†³æ–¹æ¡ˆ"&gt;&lt;strong&gt;ç¼“å­˜å‡»ç©¿è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº’æ–¥é”ï¼ˆMutex Lockï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šç¼“å­˜å¤±æ•ˆæ—¶ï¼Œç”¨åˆ†å¸ƒå¼é”ï¼ˆå¦‚Redisçš„&lt;code&gt;SETNX&lt;/code&gt;ï¼‰ä¿è¯å•çº¿ç¨‹é‡å»ºç¼“å­˜&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šé¿å…å¹¶å‘é‡å»ºï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šé”ç«äº‰å¯èƒ½å¢åŠ å»¶è¿Ÿï¼ˆéœ€è®¾ç½®è¶…æ—¶é˜²æ­»é”ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€»è¾‘è¿‡æœŸï¼ˆLogical Expireï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šç¼“å­˜å€¼åŒ…å«é€»è¾‘è¿‡æœŸæ—¶é—´ï¼Œå¼‚æ­¥æ›´æ–°æ•°æ®ï¼ˆç‰©ç†ç¼“å­˜æ°¸ä¸è¿‡æœŸï¼‰&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç¤ºä¾‹ï¼šé€»è¾‘è¿‡æœŸå®ç°
public class RedisData {
private LocalDateTime expireTime;
private Object data; // å®é™…ä¸šåŠ¡æ•°æ®[9](@ref)
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šç”¨æˆ·è¯·æ±‚æ— é˜»å¡ï¼Œé«˜å¹¶å‘å‹å¥½&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå¯èƒ½è¿”å›æ—§æ•°æ®ï¼ˆç‰ºç‰²ä¸€è‡´æ€§ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šé€šè¿‡åå°ä»»åŠ¡å®šæ—¶æ›´æ–°ç¼“å­˜ï¼ˆå¦‚æ¯10åˆ†é’Ÿåˆ·æ–°ï¼‰&lt;a class="link" href="@ref" &gt;2,10&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨&lt;/strong&gt;ï¼šæé«˜é¢‘è®¿é—®æ•°æ®ï¼ˆå¦‚æ˜æ˜Ÿä¸»é¡µï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4 id="ç¼“å­˜é›ªå´©è§£å†³æ–¹æ¡ˆ"&gt;&lt;strong&gt;ç¼“å­˜é›ªå´©è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éšæœºè¿‡æœŸæ—¶é—´&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šåŸºç¡€TTL + éšæœºåç§»é‡ï¼ˆå¦‚&lt;code&gt;3600 + Random(600)&lt;/code&gt;ç§’ï¼‰&lt;a class="link" href="@ref" &gt;2,3,5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šåˆ†æ•£å¤±æ•ˆæ—¶é—´ï¼Œé™ä½é›†ä½“å¤±æ•ˆé£é™©&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº§ç¼“å­˜æ¶æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šæœ¬åœ°ç¼“å­˜ï¼ˆCaffeineï¼‰ + åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆRedisï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šæœ¬åœ°ç¼“å­˜å­˜çƒ­ç‚¹æ•°æ®ï¼ŒRediså­˜å…¨é‡æ•°æ®&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šç¼“å­˜åˆ†å±‚ï¼Œå•ç‚¹æ•…éšœå½±å“å°&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç†”æ–­é™çº§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šHystrix/Sentinelé™æµï¼Œæ•°æ®åº“å‹åŠ›å¤§æ—¶è¿”å›é»˜è®¤å€¼&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šNginxé™æµï¼ˆä»¤ç‰Œæ¡¶ç®—æ³•ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå¯¹æ¯”æ€»ç»“è¡¨"&gt;ğŸ“Š æ ¸å¿ƒå¯¹æ¯”æ€»ç»“è¡¨
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼“å­˜ç©¿é€&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼“å­˜å‡»ç©¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼“å­˜é›ªå´©&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®&lt;/td&gt;
&lt;td&gt;çƒ­ç‚¹Keyçªç„¶å¤±æ•ˆ&lt;/td&gt;
&lt;td&gt;å¤§é‡KeyåŒæ—¶å¤±æ•ˆ/é›†ç¾¤å®•æœº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®çŠ¶æ€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼“å­˜å’ŒDBå‡æ— æ•°æ®&lt;/td&gt;
&lt;td&gt;DBæœ‰æ•°æ®ï¼Œç¼“å­˜æ— &lt;/td&gt;
&lt;td&gt;DBæœ‰æ•°æ®ï¼Œç¼“å­˜å¤§é¢ç§¯å¤±æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é˜²å¾¡æ ¸å¿ƒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‹¦æˆªæ— æ•ˆè¯·æ±‚&lt;/td&gt;
&lt;td&gt;é¿å…å¹¶å‘é‡å»º&lt;/td&gt;
&lt;td&gt;åˆ†æ•£å¤±æ•ˆé£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®æŠ€æœ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¸ƒéš†è¿‡æ»¤å™¨ã€ç©ºå€¼ç¼“å­˜&lt;/td&gt;
&lt;td&gt;äº’æ–¥é”ã€é€»è¾‘è¿‡æœŸ&lt;/td&gt;
&lt;td&gt;éšæœºTTLã€å¤šçº§ç¼“å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸šåŠ¡å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“ç©ºæŸ¥è¯¢å‹åŠ›&lt;/td&gt;
&lt;td&gt;å•ç‚¹æ•°æ®åº“é«˜å¹¶å‘&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“å…¨é¢è¿‡è½½&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç»¼åˆé˜²å¾¡ç­–ç•¥å»ºè®®"&gt;ğŸ›¡ ç»¼åˆé˜²å¾¡ç­–ç•¥å»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©¿é€é˜²å¾¡ç»„åˆ&lt;/strong&gt;ï¼šå¸ƒéš†è¿‡æ»¤å™¨ + ç©ºå€¼ç¼“å­˜ + æ¥å£å‚æ•°æ ¡éªŒ&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡»ç©¿é˜²å¾¡ç»„åˆ&lt;/strong&gt;ï¼šäº’æ–¥é” + çƒ­ç‚¹æ•°æ®é¢„çƒ­ + æœ¬åœ°ç¼“å­˜&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›ªå´©é˜²å¾¡ç»„åˆ&lt;/strong&gt;ï¼šéšæœºTTL + Redisé›†ç¾¤ï¼ˆå“¨å…µ/Clusterï¼‰ + ç†”æ–­é™çº§&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ¶æ„è®¾è®¡æç¤º&lt;/strong&gt;ï¼šå¯¹äºç”µå•†ç­‰é«˜å¹¶å‘ç³»ç»Ÿï¼Œå»ºè®®é‡‡ç”¨ &lt;strong&gt;å¤šçº§ç¼“å­˜+ç†”æ–­+å¸ƒéš†è¿‡æ»¤å™¨&lt;/strong&gt; ç»„åˆæ–¹æ¡ˆï¼Œå¹¶åœ¨ä¸šåŠ¡ä½å³°æœŸæ‰§è¡Œç¼“å­˜é¢„çƒ­ï¼ˆå¦‚æå‰åŠ è½½ç§’æ€å•†å“æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚
é€šè¿‡ä¸Šè¿°åˆ†å±‚ç­–ç•¥ï¼Œå¯æ˜¾è‘—é™ä½ç¼“å­˜å¤±æ•ˆå¯¼è‡´çš„ç³»ç»Ÿæ€§é£é™©ï¼Œä¿éšœæ•°æ®åº“ç¨³å®šè¿è¡Œã€‚å®é™…åº”ç”¨ä¸­éœ€æ ¹æ®ä¸šåŠ¡ç‰¹æ€§ï¼ˆå¦‚æ•°æ®çƒ­åº¦ã€ä¸€è‡´æ€§è¦æ±‚ï¼‰é€‰æ‹©é€‚é…æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¸ƒéš†è¿‡æ»¤å™¨"&gt;å¸ƒéš†è¿‡æ»¤å™¨
&lt;/h2&gt;&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰æ˜¯ä¸€ç§&lt;strong&gt;ç©ºé—´æ•ˆç‡æé«˜çš„æ¦‚ç‡å‹æ•°æ®ç»“æ„&lt;/strong&gt;ï¼Œç”± Burton Howard Bloom äº 1970 å¹´æå‡ºï¼Œç”¨äºå¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å±äºæŸä¸ªé›†åˆã€‚å…¶æ ¸å¿ƒç‰¹ç‚¹æ˜¯&lt;strong&gt;ä»¥æå°çš„å†…å­˜å ç”¨å®ç°é«˜æ•ˆçš„å­˜åœ¨æ€§æ£€æµ‹&lt;/strong&gt;ï¼Œä½†å­˜åœ¨ä¸€å®šçš„è¯¯åˆ¤ç‡ï¼ˆå‡é˜³æ€§ï¼‰ã€‚ä»¥ä¸‹æ˜¯å…¶è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸ç»“æ„"&gt;âš™ï¸ æ ¸å¿ƒåŸç†ä¸ç»“æ„
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;åŸºæœ¬ç»„æˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½æ•°ç»„ï¼ˆBit Arrayï¼‰&lt;/strong&gt;ï¼šé•¿åº¦ä¸º &lt;code&gt;m&lt;/code&gt; çš„äºŒè¿›åˆ¶å‘é‡ï¼Œåˆå§‹å€¼å…¨ä¸º &lt;code&gt;0&lt;/code&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œå‡½æ•°ï¼ˆHash Functionsï¼‰&lt;/strong&gt;ï¼š&lt;code&gt;k&lt;/code&gt; ä¸ªç‹¬ç«‹çš„å“ˆå¸Œå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°å°†è¾“å…¥å…ƒç´ æ˜ å°„åˆ°ä½æ•°ç»„çš„æŸä¸€ä½ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;æ“ä½œæµç¨‹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ·»åŠ å…ƒç´ &lt;/strong&gt;ï¼š
å¯¹å…ƒç´ æ‰§è¡Œ &lt;code&gt;k&lt;/code&gt; æ¬¡å“ˆå¸Œè¿ç®—ï¼Œå¾—åˆ° &lt;code&gt;k&lt;/code&gt; ä¸ªä½æ•°ç»„ä¸‹æ ‡ï¼Œå¹¶å°†è¿™äº›ä½ç½®çš„å€¼ç½®ä¸º &lt;code&gt;1&lt;/code&gt;ã€‚
&lt;em&gt;ä¾‹&lt;/em&gt;ï¼šæ’å…¥å…ƒç´  &lt;code&gt;x&lt;/code&gt;ï¼Œå“ˆå¸Œå‡½æ•°è¾“å‡ºä½ç½® &lt;code&gt;{2, 5, 7}&lt;/code&gt;ï¼Œåˆ™ä½æ•°ç»„ä¸‹æ ‡ 2ã€5ã€7 è¢«è®¾ä¸º &lt;code&gt;1&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;æŸ¥è¯¢å…ƒç´ ï¼š
å¯¹å…ƒç´ æ‰§è¡Œç›¸åŒå“ˆå¸Œè¿ç®—ï¼Œæ£€æŸ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; k
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸ªä½ç½®çš„å€¼ï¼š
- è‹¥&lt;strong&gt;æ‰€æœ‰ä½ç½®å‡ä¸º &lt;code&gt;1&lt;/code&gt;&lt;/strong&gt; â†’ å…ƒç´ â€œå¯èƒ½å­˜åœ¨â€ï¼ˆå¯èƒ½è¯¯åˆ¤ï¼‰ã€‚
- è‹¥&lt;strong&gt;ä»»ä¸€ä½ç½®ä¸º &lt;code&gt;0&lt;/code&gt;&lt;/strong&gt; â†’ å…ƒç´ â€œä¸€å®šä¸å­˜åœ¨â€&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç‰¹æ€§ä¸æƒè¡¡"&gt;âš–ï¸ ç‰¹æ€§ä¸æƒè¡¡
&lt;/h3&gt;&lt;h4 id="ä¼˜ç‚¹"&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¶…ä½ç©ºé—´å ç”¨&lt;/strong&gt;ï¼šå­˜å‚¨ 100 ä¸‡ä¸ªå…ƒç´ ä»…éœ€çº¦ 122KB å†…å­˜ï¼ˆè¯¯åˆ¤ç‡ 1% æ—¶ï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ•ˆæŸ¥è¯¢&lt;/strong&gt;ï¼šæ—¶é—´å¤æ‚åº¦ä¸º &lt;code&gt;O(k)&lt;/code&gt;ï¼ˆ&lt;code&gt;k&lt;/code&gt; ä¸ºå“ˆå¸Œå‡½æ•°æ•°é‡ï¼Œé€šå¸¸è¾ƒå°ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— å‡é˜´æ€§ï¼ˆFalse Negativeï¼‰&lt;/strong&gt;ï¼šè‹¥è¿”å›â€œä¸å­˜åœ¨â€ï¼Œç»“æœç»å¯¹å¯é &lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç¼ºç‚¹"&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡é˜³æ€§ï¼ˆFalse Positiveï¼‰&lt;/strong&gt;ï¼šä¸åŒå…ƒç´ çš„å“ˆå¸Œå¯èƒ½ç¢°æ’ï¼Œå¯¼è‡´è¯¯åˆ¤ã€‚è¯¯åˆ¤ç‡ &lt;code&gt;p&lt;/code&gt; å…¬å¼ä¸ºï¼š
&lt;code&gt;p \approx \left(1 - e^{-k \cdot n / m}\right)^k&lt;/code&gt;
å…¶ä¸­ &lt;code&gt;n&lt;/code&gt; ä¸ºå…ƒç´ æ•°é‡ï¼Œ&lt;code&gt;m&lt;/code&gt; ä¸ºä½æ•°ç»„é•¿åº¦ï¼Œ&lt;code&gt;k&lt;/code&gt; ä¸ºå“ˆå¸Œå‡½æ•°æ•°&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ”¯æŒåˆ é™¤&lt;/strong&gt;ï¼šä¼ ç»Ÿå¸ƒéš†è¿‡æ»¤å™¨çš„ä½æ— æ³•åŒºåˆ†ä¸åŒå…ƒç´ ã€‚è‹¥éœ€åˆ é™¤ï¼Œéœ€æ”¹ç”¨&lt;strong&gt;è®¡æ•°å¸ƒéš†è¿‡æ»¤å™¨&lt;/strong&gt;ï¼ˆç”¨è®¡æ•°å™¨æ›¿ä»£äºŒè¿›åˆ¶ä½ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å‚æ•°è®¾è®¡ä¸è¯¯åˆ¤ç‡æ§åˆ¶"&gt;ğŸ“Š å‚æ•°è®¾è®¡ä¸è¯¯åˆ¤ç‡æ§åˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä¼˜å‚æ•°è®¡ç®—&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½æ•°ç»„å¤§å° &lt;code&gt;m&lt;/code&gt;&lt;/strong&gt;ï¼š
&lt;code&gt;m = -\frac{n \ln p}{(\ln 2)^2}&lt;/code&gt;
&lt;em&gt;ä¾‹&lt;/em&gt;ï¼šå­˜å‚¨ &lt;code&gt;n=10,000&lt;/code&gt; ä¸ªå…ƒç´ ï¼Œè¦æ±‚è¯¯åˆ¤ç‡ &lt;code&gt;p=0.01&lt;/code&gt;ï¼Œåˆ™ &lt;code&gt;mâ‰ˆ95,850&lt;/code&gt; ä½ï¼ˆçº¦ 12KBï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œå‡½æ•°æ•°é‡ &lt;code&gt;k&lt;/code&gt;&lt;/strong&gt;ï¼š
&lt;code&gt;k = \frac{m}{n} \ln 2&lt;/code&gt;
é€šå¸¸å–æ•´æ•°ï¼ˆå¦‚ &lt;code&gt;m/n=10&lt;/code&gt; æ—¶ï¼Œ&lt;code&gt;kâ‰ˆ7&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™ä½è¯¯åˆ¤ç‡çš„ç­–ç•¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¢å¤§ä½æ•°ç»„é•¿åº¦ &lt;code&gt;m&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–å“ˆå¸Œå‡½æ•°ï¼ˆå¦‚ MurmurHashã€SHA-1 ç¡®ä¿å‡åŒ€åˆ†å¸ƒï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯"&gt;ğŸ’¡ åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ç©¿é€é˜²æŠ¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ç¼“å­˜æŸ¥è¯¢å‰ï¼Œç”¨å¸ƒéš†è¿‡æ»¤å™¨æ‹¦æˆªæ— æ•ˆè¯·æ±‚ï¼ˆå¦‚æ•°æ®åº“ä¸å­˜åœ¨çš„ Keyï¼‰ï¼Œé¿å…æ•°æ®åº“è¢«å‡»ç©¿&lt;a class="link" href="@ref" &gt;1,4,5&lt;/a&gt;ã€‚
&lt;em&gt;å®ç°ç¤ºä¾‹&lt;/em&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;if (!bloomFilter.mightContain(key)) return null; // ç›´æ¥è¿”å›ï¼Œé¿å…æŸ¥åº“
else return cache.get(key);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµ·é‡æ•°æ®å»é‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çˆ¬è™« URL å»é‡ï¼šé¿å…é‡å¤æŠ“å–ç›¸åŒé“¾æ¥&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·è¡Œä¸ºæ—¥å¿—å»é‡ï¼šå¿«é€Ÿè¿‡æ»¤å·²å¤„ç†çš„æ•°æ®&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨è¿‡æ»¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åƒåœ¾é‚®ä»¶è¿‡æ»¤ï¼šå­˜å‚¨å·²çŸ¥åƒåœ¾é‚®ä»¶ç‰¹å¾ï¼Œå¿«é€Ÿæ‹¦æˆª&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é»‘åå•ç³»ç»Ÿï¼šæ ¡éªŒ IP æˆ–æ‰‹æœºå·æ˜¯å¦åœ¨é»‘åå•ä¸­&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŠ é€Ÿ Join æ“ä½œï¼šé¢„åˆ¤æŸè¡¨çš„é”®æ˜¯å¦åœ¨å¦ä¸€è¡¨ä¸­å­˜åœ¨ï¼Œå‡å°‘ç£ç›˜ I/O&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°æ–¹å¼"&gt;ğŸ› ï¸ å®ç°æ–¹å¼
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰‹åŠ¨å®ç°ï¼ˆJava ç¤ºä¾‹ï¼‰&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class BloomFilter {
private BitSet bitSet;
private SimpleHash[] hashFunctions;
// æ·»åŠ å…ƒç´ 
public void add(String item) {
for (SimpleHash func : hashFunctions) {
bitSet.set(func.hash(item), true);
}
}
// æ£€æŸ¥å…ƒç´ 
public boolean contains(String item) {
for (SimpleHash func : hashFunctions) {
if (!bitSet.get(func.hash(item))) return false;
}
return true; // å¯èƒ½å­˜åœ¨
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç°æˆå·¥å…·åº“&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Guavaï¼ˆå•æœºç‰ˆï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;BloomFilter&amp;lt;Integer&amp;gt; filter = BloomFilter.create(Funnels.integerFunnel(), 1000, 0.01);
filter.put(1);
filter.mightContain(1); // è¿”å› true æˆ– false
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RedisBloomï¼ˆåˆ†å¸ƒå¼ï¼‰&lt;/strong&gt;ï¼š
æ”¯æŒå‘½ä»¤ &lt;code&gt;BF.ADD&lt;/code&gt;ã€&lt;code&gt;BF.EXISTS&lt;/code&gt;ï¼Œé€‚ç”¨äºé›†ç¾¤ç¯å¢ƒ&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å˜ç§ä¸æ‰©å±•"&gt;ğŸ”„ å˜ç§ä¸æ‰©å±•
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è®¡æ•°å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆCounting Bloom Filterï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å°†ä½æ•°ç»„æ›¿æ¢ä¸ºè®¡æ•°å™¨ï¼Œæ”¯æŒåˆ é™¤æ“ä½œï¼ˆè®¡æ•°å™¨åŠ å‡ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å¯æ‰©å±•å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆScalable Bloom Filterï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€å¢åŠ ä½æ•°ç»„ï¼Œåº”å¯¹æ•°æ®é‡å¢é•¿ï¼Œä¿æŒä½è¯¯åˆ¤ç‡&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;åˆ†å¸ƒå¼å¸ƒéš†è¿‡æ»¤å™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†ç‰‡ä½æ•°ç»„åˆ°å¤šèŠ‚ç‚¹ï¼Œæå‡å¤§è§„æ¨¡ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨ä»¥&lt;strong&gt;æå°å†…å­˜&lt;/strong&gt;å’Œ&lt;strong&gt;æé«˜æŸ¥è¯¢é€Ÿåº¦&lt;/strong&gt;è§£å†³äº†æµ·é‡æ•°æ®å­˜åœ¨æ€§åˆ¤æ–­é—®é¢˜ï¼Œå°¤å…¶é€‚åˆç¼“å­˜ç©¿é€ã€å»é‡ç­‰åœºæ™¯ã€‚å…¶ä»£ä»·æ˜¯&lt;strong&gt;å¯æ§çš„è¯¯åˆ¤ç‡&lt;/strong&gt;å’Œ&lt;strong&gt;ä¸æ”¯æŒåˆ é™¤&lt;/strong&gt;çš„ç‰¹æ€§ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆé€‰ç”¨æˆç†Ÿåº“ï¼ˆå¦‚ Guavaã€RedisBloomï¼‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´å‚æ•°ï¼ˆ&lt;code&gt;m&lt;/code&gt;ã€&lt;code&gt;k&lt;/code&gt;ï¼‰ï¼Œæƒè¡¡ç©ºé—´ä¸è¯¯åˆ¤ç‡&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹åˆ é™¤æ•æ„Ÿçš„åœºæ™¯ï¼Œæ”¹ç”¨è®¡æ•°å¸ƒéš†è¿‡æ»¤å™¨&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨çš„è®¾è®¡ä½“ç°äº† &lt;strong&gt;â€œä»¥ç©ºé—´æ¢æ—¶é—´ï¼Œä»¥æ¦‚ç‡æ¢ç²¾ç¡®â€&lt;/strong&gt; çš„å·¥ç¨‹æ™ºæ…§ï¼Œæˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸å¯æˆ–ç¼ºçš„åŸºç¡€ç»„ä»¶&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="é¡ºåºæ¶ˆè´¹"&gt;é¡ºåºæ¶ˆè´¹
&lt;/h2&gt;&lt;p&gt;æ¶ˆæ¯é˜Ÿåˆ—çš„é¡ºåºæ¶ˆè´¹æŒ‡ç¡®ä¿æ¶ˆæ¯æŒ‰ç…§å‘é€çš„å…ˆåé¡ºåºè¢«å¤„ç†ï¼Œå°¤å…¶åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­é¢ä¸´ç½‘ç»œå»¶è¿Ÿã€å¹¶è¡Œæ¶ˆè´¹ç­‰æŒ‘æˆ˜ã€‚ä»¥ä¸‹æ˜¯ä¿è¯é¡ºåºæ¶ˆè´¹çš„æ ¸å¿ƒåŸç†ã€ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—å®ç°æ–¹æ¡ˆåŠå·¥ç¨‹å®è·µè¦ç‚¹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-é¡ºåºæ¶ˆè´¹çš„æ ¸å¿ƒæŒ‘æˆ˜ä¸åŸºç¡€åŸç†"&gt;ğŸ” é¡ºåºæ¶ˆè´¹çš„æ ¸å¿ƒæŒ‘æˆ˜ä¸åŸºç¡€åŸç†
&lt;/h3&gt;&lt;h4 id="ä¸ºä½•é¡ºåºéš¾ä»¥ä¿è¯"&gt;&lt;strong&gt;ä¸ºä½•é¡ºåºéš¾ä»¥ä¿è¯ï¼Ÿ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œæ¶æ„&lt;/strong&gt;ï¼šæ¶ˆæ¯é˜Ÿåˆ—é€šè¿‡å¤šåˆ†åŒº/é˜Ÿåˆ—ã€å¤šæ¶ˆè´¹è€…æå‡ååï¼Œå¤©ç„¶å¯¼è‡´æ¶ˆæ¯åˆ†æ•£å¤„ç†&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸å¹²æ‰°&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…å®•æœºã€é‡å¹³è¡¡ï¼ˆRebalanceï¼‰æˆ–æ¶ˆæ¯é‡è¯•å¯èƒ½æ‰“ä¹±å¤„ç†é¡ºåº&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é¡ºåºæ€§åˆ†çº§"&gt;&lt;strong&gt;é¡ºåºæ€§åˆ†çº§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€é¡ºåº&lt;/strong&gt;ï¼šåŒä¸€Topicä¸‹æ‰€æœ‰æ¶ˆæ¯ä¸¥æ ¼æœ‰åºï¼ˆæ€§èƒ½ä»£ä»·é«˜ï¼Œæå°‘ä½¿ç”¨ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±€éƒ¨é¡ºåº&lt;/strong&gt;ï¼šåŒä¸€ä¸šåŠ¡ç»„ï¼ˆå¦‚è®¢å•IDç›¸åŒçš„æ¶ˆæ¯ï¼‰æœ‰åºå¤„ç†ï¼ˆä¸»æµæ–¹æ¡ˆï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å®ç°ä¸‰è¦ç´ "&gt;&lt;strong&gt;å®ç°ä¸‰è¦ç´ &lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§æœ‰åº&lt;/strong&gt;ï¼šåŒä¸€ä¸šåŠ¡çš„æ¶ˆæ¯å¿…é¡»å‘é€åˆ°åŒä¸€é˜Ÿåˆ—/åˆ†åŒºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨æœ‰åº&lt;/strong&gt;ï¼šé˜Ÿåˆ—å†…éƒ¨éœ€éµå¾ªFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰å­˜å‚¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹æœ‰åº&lt;/strong&gt;ï¼šå•çº¿ç¨‹å¤„ç†åŒä¸€é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼Œé¿å…å¹¶å‘å¹²æ‰°&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¿è¯é¡ºåºæ¶ˆè´¹çš„æ ¸å¿ƒæŠ€æœ¯æ–¹æ¡ˆ"&gt;âš™ï¸ ä¿è¯é¡ºåºæ¶ˆè´¹çš„æ ¸å¿ƒæŠ€æœ¯æ–¹æ¡ˆ
&lt;/h3&gt;&lt;h4 id="ç”Ÿäº§ç«¯è·¯ç”±åŒä¸€ä¸šåŠ¡æ¶ˆæ¯è‡³åŒä¸€é˜Ÿåˆ—"&gt;&lt;strong&gt;ç”Ÿäº§ç«¯ï¼šè·¯ç”±åŒä¸€ä¸šåŠ¡æ¶ˆæ¯è‡³åŒä¸€é˜Ÿåˆ—&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è·¯ç”±ç­–ç•¥ï¼šé€šè¿‡ä¸šåŠ¡Keyï¼ˆå¦‚è®¢å•IDï¼‰å“ˆå¸Œé€‰æ‹©é˜Ÿåˆ—ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;// RocketMQ ç¤ºä¾‹ï¼šæŒ‰è®¢å•IDé€‰æ‹©é˜Ÿåˆ—
public MessageQueue select(List&amp;lt;MessageQueue&amp;gt; queues, Message msg, Object arg) {
String orderId = (String) arg;
int index = Math.abs(orderId.hashCode()) % queues.size();
return queues.get(index);
}[5,7](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥å‘é€&lt;/strong&gt;ï¼šå¼‚æ­¥å‘é€å¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¹±åºï¼Œéœ€å¼ºåˆ¶åŒæ­¥å‘é€&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©&lt;/strong&gt;ï¼šé˜Ÿåˆ—æ•°é‡å˜åŒ–ï¼ˆå¦‚Brokeræ‰©å®¹ï¼‰ä¼šå¯¼è‡´çŸ­æš‚ä¹±åºï¼Œéœ€ä¸šåŠ¡å®¹é”™&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å­˜å‚¨ç«¯é˜Ÿåˆ—å†…fifoä¿éšœ"&gt;&lt;strong&gt;å­˜å‚¨ç«¯ï¼šé˜Ÿåˆ—å†…FIFOä¿éšœ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰æ¶ˆæ¯é˜Ÿåˆ—å‡æ»¡è¶³&lt;/strong&gt;ï¼šKafkaåˆ†åŒºã€RocketMQé˜Ÿåˆ—ã€RabbitMQé˜Ÿåˆ—å¤©ç„¶ä¿è¯å†…éƒ¨æ¶ˆæ¯æœ‰åºå­˜å‚¨&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¶ˆè´¹ç«¯å•çº¿ç¨‹ä¸²è¡Œå¤„ç†"&gt;&lt;strong&gt;æ¶ˆè´¹ç«¯ï¼šå•çº¿ç¨‹ä¸²è¡Œå¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é˜Ÿåˆ—ç‹¬å æ¶ˆè´¹ï¼šåŒä¸€é˜Ÿåˆ—ä»…å…è®¸ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†ï¼Œé¿å…å¹¶å‘ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;ï¼š&lt;code&gt;MessageListenerOrderly&lt;/code&gt; + åˆ†å¸ƒå¼é”ï¼ˆBrokeré”+æœ¬åœ°é˜Ÿåˆ—é”ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kafka&lt;/strong&gt;ï¼šå•åˆ†åŒºå•çº¿ç¨‹æ¶ˆè´¹ï¼Œé€šè¿‡&lt;code&gt;max.poll.records=1&lt;/code&gt;æ§åˆ¶å•æ¬¡æ‹‰å–æ¶ˆæ¯æ•°&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;ï¼šå•é˜Ÿåˆ—å•æ¶ˆè´¹è€… + &lt;code&gt;prefetch_count=1&lt;/code&gt;ï¼ˆæ¯æ¬¡ä»…æ¶ˆè´¹ä¸€æ¡ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# RabbitMQ ç¤ºä¾‹ï¼šè®¾ç½®prefetch_count=1
channel.basic_qos(prefetch_count=1)[2](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å¼‚å¸¸å¤„ç†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰‹åŠ¨ACK&lt;/strong&gt;ï¼šæ¶ˆæ¯å¤„ç†æˆåŠŸåæ‰ç¡®è®¤ï¼Œå¤±è´¥åˆ™é‡è¯•ï¼ˆé¿å…ä¹±åºé‡è¯•ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜»å¡é£é™©&lt;/strong&gt;ï¼šå•æ¡æ¶ˆæ¯å¤„ç†å¤±è´¥ä¼šé˜»å¡åç»­æ¶ˆæ¯ï¼Œéœ€è®¾ç½®æœ€å¤§é‡è¯•æ¬¡æ•°æˆ–æ­»ä¿¡é˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¯¹æ¯”"&gt;ğŸ“Š ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç”Ÿäº§ç«¯ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¶ˆè´¹ç«¯ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MessageQueueSelector&lt;/code&gt;æŒ‰Keyè·¯ç”±&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MessageListenerOrderly&lt;/code&gt; + ä¸‰æŠŠé”&lt;/td&gt;
&lt;td&gt;ç”µå•†è®¢å•ã€æ”¯ä»˜æµæ°´&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ï¼Œæ‰©å±•æ€§å¼º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰Keyå“ˆå¸Œåˆ°åŒä¸€åˆ†åŒº&lt;/td&gt;
&lt;td&gt;å•åˆ†åŒºå•çº¿ç¨‹æ¶ˆè´¹&lt;/td&gt;
&lt;td&gt;æ—¥å¿—æµã€å®æ—¶è®¡ç®—&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;è¶…é«˜ååï¼Œåˆ†åŒºæ‰©å±•æ€§å¥½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;RoutingKeyç»‘å®šå›ºå®šé˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;å•é˜Ÿåˆ—å•æ¶ˆè´¹è€… + &lt;code&gt;prefetch_count=1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä½é¢‘é«˜é¡ºåºéœ€æ±‚ï¼ˆå¦‚å¯¹è´¦ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä½ååï¼Œæ‰©å±•æ€§å·®&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šRabbitMQå¯é€šè¿‡å¤šé˜Ÿåˆ—åˆ†æµå®ç°å±€éƒ¨é¡ºåºï¼ˆå¦‚æŒ‰ç”¨æˆ·IDåˆ†é˜Ÿåˆ—ï¼‰ï¼Œä½†éœ€ä¸šåŠ¡å±‚è®¾è®¡è·¯ç”±&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹é—®é¢˜ä¸åº”å¯¹ç­–ç•¥"&gt;âš ï¸ å…¸å‹é—®é¢˜ä¸åº”å¯¹ç­–ç•¥
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹é˜»å¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šå•æ¡æ¶ˆæ¯å¤„ç†æ…¢æˆ–å¤±è´¥é‡è¯•é˜»å¡åç»­æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼š
&lt;ul&gt;
&lt;li&gt;è®¾ç½®æœ€å¤§é‡è¯•æ¬¡æ•°ï¼ˆå¦‚3æ¬¡ï¼‰ï¼Œè¶…æ—¶è½¬æ­»ä¿¡é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–æ¶ˆè´¹é€»è¾‘ï¼ˆå¦‚å¼‚æ­¥å¤„ç†éå…³é”®æ“ä½œï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤æ‰©å®¹å¯¼è‡´ä¹±åº&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šBrokeræ‰©å®¹ä½¿é˜Ÿåˆ—æ•°å˜åŒ–ï¼Œå“ˆå¸Œè·¯ç”±å¤±æ•ˆ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸šåŠ¡ç«¯é¢„åˆ†æ¡¶ï¼ˆå¦‚å›ºå®š1024ä¸ªè™šæ‹Ÿæ¡¶æ˜ å°„ç‰©ç†é˜Ÿåˆ—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä½å³°æœŸæ‰©å®¹ + æ•°æ®è¿ç§»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€é¡ºåºéœ€æ±‚&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šå•åˆ†åŒº/å•é˜Ÿåˆ—ï¼ˆå¦‚Kafkaå•åˆ†åŒºã€RocketMQå•é˜Ÿåˆ—ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ä»·&lt;/strong&gt;ï¼šååé‡éª¤é™ï¼Œä»…é€‚åˆä½å¹¶å‘åœºæ™¯ï¼ˆå¦‚é…ç½®æ›´æ–°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æœ€ä½³å®è·µæ€»ç»“"&gt;ğŸ› ï¸ æœ€ä½³å®è·µæ€»ç»“
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ä¸šåŠ¡è®¾è®¡ä¼˜å…ˆï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…å…¨å±€é¡ºåºéœ€æ±‚ï¼Œé€šè¿‡ä¸šåŠ¡æ‹†åˆ†ï¼ˆå¦‚è®¢å•IDåˆ†ç»„ï¼‰å®ç°å±€éƒ¨é¡ºåº&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç”Ÿäº§ç«¯ç»„åˆç­–ç•¥ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸šåŠ¡Keyè·¯ç”± + åŒæ­¥å‘é€ + å¼‚å¸¸å›æ»š&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹ç«¯ç¨³å¥é…ç½®ï¼š
&lt;ul&gt;
&lt;li&gt;RocketMQ/Kafkaï¼šå•é˜Ÿåˆ—å•çº¿ç¨‹ + æœ‰é™é‡è¯•ã€‚&lt;/li&gt;
&lt;li&gt;RabbitMQï¼š&lt;code&gt;prefetch_count=1&lt;/code&gt; + æ‰‹åŠ¨ACK&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æ§ä¸é™çº§ï¼š
&lt;ul&gt;
&lt;li&gt;ç›‘æ§æ¶ˆæ¯ç§¯å‹ï¼ŒåŠ¨æ€æ‰©å®¹æ¶ˆè´¹è€…ï¼ˆéé¡ºåºé˜Ÿåˆ—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç†”æ–­é™çº§ï¼šæ•°æ®åº“å‹åŠ›è¿‡å¤§æ—¶è¿”å›å…œåº•æ•°æ®&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ¶æ„å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘åœºæ™¯ï¼šé€‰ RocketMQ/Kafka åˆ†åŒºé¡ºåº + å¤šçº§ç¼“å­˜ã€‚&lt;/li&gt;
&lt;li&gt;ä½ååå¼ºé¡ºåºï¼šRabbitMQ å•é˜Ÿåˆ—å•æ¶ˆè´¹è€…ã€‚&lt;/li&gt;
&lt;li&gt;ç»ˆæå®¹é”™ï¼šåœ¨æ¶ˆè´¹å±‚å®ç°å¹‚ç­‰æ€§ï¼ˆå¦‚æ•°æ®åº“å”¯ä¸€çº¦æŸï¼‰ï¼Œå³ä½¿ä¹±åºä¹Ÿèƒ½æœ€ç»ˆä¸€è‡´&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ­»ä¿¡é˜Ÿåˆ—"&gt;æ­»ä¿¡é˜Ÿåˆ—
&lt;/h2&gt;&lt;p&gt;æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queueï¼ŒDLQï¼‰æ˜¯æ¶ˆæ¯ä¸­é—´ä»¶ä¸­çš„ä¸€ç§ç‰¹æ®Šé˜Ÿåˆ—ï¼Œç”¨äºå­˜å‚¨&lt;strong&gt;æ— æ³•è¢«æ­£å¸¸æ¶ˆè´¹çš„æ¶ˆæ¯&lt;/strong&gt;ï¼ˆç§°ä¸ºâ€œæ­»ä¿¡â€ï¼‰ã€‚å…¶æ ¸å¿ƒä½œç”¨æ˜¯ä¸ºå¼‚å¸¸æ¶ˆæ¯æä¾›å…œåº•å¤„ç†æœºåˆ¶ï¼Œé¿å…æ¶ˆæ¯ä¸¢å¤±æˆ–æ— é™é‡è¯•å¯¼è‡´ç³»ç»Ÿé›ªå´©ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒè¦ç‚¹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ­»ä¿¡æ¥æºè§¦å‘æ¡ä»¶"&gt;âš™ï¸ &lt;strong&gt;æ­»ä¿¡æ¥æºï¼ˆè§¦å‘æ¡ä»¶ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ¶ˆæ¯è¢«æ‹’ç»ä¸”ä¸é‡è¯•&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…æ˜ç¡®æ‹’ç»æ¶ˆæ¯ï¼ˆå¦‚RabbitMQçš„ &lt;code&gt;basic.reject&lt;/code&gt; æˆ– &lt;code&gt;basic.nack&lt;/code&gt;ï¼‰ï¼Œä¸”è®¾ç½® &lt;code&gt;requeue=false&lt;/code&gt;ï¼Œæ¶ˆæ¯ä¸å†è¿”å›åŸé˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;2,5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;æ¶ˆæ¯è¶…æ—¶ï¼ˆTTLè¿‡æœŸï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­çš„å­˜æ´»æ—¶é—´è¶…è¿‡é¢„è®¾çš„TTLï¼ˆTime-To-Liveï¼‰ï¼Œæœªè¢«æ¶ˆè´¹å³å¤±æ•ˆ&lt;a class="link" href="@ref" &gt;4,7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§å®¹é‡&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é˜Ÿåˆ—æ¶ˆæ¯æ•°é‡æˆ–æ€»å¤§å°è¶…è¿‡é™åˆ¶ï¼Œæ–°æ¶ˆæ¯æ— æ³•è¿›å…¥æ—¶ï¼Œæ—§æ¶ˆæ¯å¯èƒ½è¢«æŒ¤å…¥æ­»ä¿¡é˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;4,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä»·å€¼"&gt;ğŸ›¡ï¸ &lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¼‚å¸¸æ¶ˆæ¯æš‚å­˜äºDLQï¼Œé¿å…å› ä¸¢å¼ƒå¯¼è‡´ä¸šåŠ¡æ•°æ®ç¼ºå¤±ï¼Œä¸ºäººå·¥å¹²é¢„æˆ–è‡ªåŠ¨ä¿®å¤æä¾›ç¼“å†²&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;éš”ç¦»æ•…éšœ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å°†é—®é¢˜æ¶ˆæ¯ç§»å‡ºæ­£å¸¸é˜Ÿåˆ—ï¼Œé¿å…é˜»å¡åç»­æ¶ˆæ¯å¤„ç†ï¼Œä¿éšœç³»ç»Ÿç¨³å®šæ€§&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;ç®€åŒ–é—®é¢˜æ’æŸ¥&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é›†ä¸­å­˜å‚¨å¼‚å¸¸æ¶ˆæ¯ï¼Œä¾¿äºå¼€å‘äººå‘˜åˆ†æå¤±è´¥åŸå› ï¼ˆå¦‚æ ¼å¼é”™è¯¯ã€ä¾èµ–æœåŠ¡ä¸å¯ç”¨ç­‰ï¼‰&lt;a class="link" href="@ref" &gt;1,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;âš¡ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ¶ˆæ¯é‡è¯•å¤±è´¥å…œåº•&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è®¢å•æ”¯ä»˜æ¶ˆæ¯æ¶ˆè´¹å¤±è´¥3æ¬¡åè½¬å…¥DLQï¼Œè§¦å‘å‘Šè­¦æˆ–äººå·¥å¤„ç†&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å»¶è¿Ÿæ¶ˆæ¯è§¦å‘&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è®¢å•è¶…æ—¶æœªæ”¯ä»˜ï¼šè®¾ç½®æ¶ˆæ¯TTLä¸º30åˆ†é’Ÿï¼Œè¿‡æœŸåè¿›å…¥DLQï¼Œè§¦å‘å…³å•é€»è¾‘&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;å¼‚å¸¸æ•°æ®å¤„ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯æ ¼å¼é”™è¯¯ï¼ˆå¦‚JSONè§£æå¤±è´¥ï¼‰æ—¶ï¼Œè½¬å…¥DLQé¿å…æ¶ˆè´¹è€…å´©æºƒ&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;æµé‡ç†”æ–­&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡æ•…éšœå¯¼è‡´æ¶ˆæ¯ç§¯å‹æ—¶ï¼Œé€šè¿‡DLQéš”ç¦»é—®é¢˜ï¼Œé¿å…é‡è¯•é£æš´æ‹–å®ç³»ç»Ÿ&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æŠ€æœ¯å®ç°ä»¥rabbitmqä¸ºä¾‹"&gt;ğŸ§© &lt;strong&gt;æŠ€æœ¯å®ç°ï¼ˆä»¥RabbitMQä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç»‘å®šæ­»ä¿¡äº¤æ¢æœºï¼ˆDLXï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ™®é€šé˜Ÿåˆ—å£°æ˜æ—¶ç»‘å®šDLXå’Œè·¯ç”±é”®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Map&amp;lt;String, Object&amp;gt; args = new HashMap&amp;lt;&amp;gt;();
args.put(&amp;#34;x-dead-letter-exchange&amp;#34;, &amp;#34;dlx.exchange&amp;#34;); // æ­»ä¿¡äº¤æ¢æœº
args.put(&amp;#34;x-dead-letter-routing-key&amp;#34;, &amp;#34;order.dlq&amp;#34;); // æ­»ä¿¡è·¯ç”±é”®
channel.queueDeclare(&amp;#34;order.queue&amp;#34;, true, false, false, args);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;åˆ›å»ºæ­»ä¿¡é˜Ÿåˆ—&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šåˆ°DLXï¼Œæ¥æ”¶è·¯ç”±è€Œæ¥çš„å¼‚å¸¸æ¶ˆæ¯ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;channel.queueDeclare(&amp;#34;order.dlq&amp;#34;, true, false, false, null); // æ­»ä¿¡é˜Ÿåˆ—
channel.queueBind(&amp;#34;order.dlq&amp;#34;, &amp;#34;dlx.exchange&amp;#34;, &amp;#34;order.dlq&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å½“ &lt;code&gt;order.queue&lt;/code&gt; ä¸­çš„æ¶ˆæ¯æ»¡è¶³æ­»ä¿¡æ¡ä»¶æ—¶ï¼Œè‡ªåŠ¨è·¯ç”±è‡³ &lt;code&gt;order.dlq&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4,7,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é¿å…æ»¥ç”¨DLQ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;FIFOé˜Ÿåˆ—æ…ç”¨&lt;/strong&gt;ï¼šæ­»ä¿¡å¯èƒ½ç ´åä¸¥æ ¼é¡ºåºï¼ˆå¦‚è§†é¢‘ç¼–è¾‘æŒ‡ä»¤ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— é™é‡è¯•åœºæ™¯&lt;/strong&gt;ï¼šè‹¥éœ€ç­‰å¾…ä¾èµ–æœåŠ¡æ¢å¤ï¼Œåº”ä½¿ç”¨å»¶è¿Ÿé˜Ÿåˆ—è€ŒéDLQ&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å…³é”®é…ç½®&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å‘Šè­¦&lt;/strong&gt;ï¼šç›‘æ§DLQå †ç§¯é‡ï¼ˆå¦‚è¶…è¿‡1000æ¡è§¦å‘å‘Šè­¦ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰è®¾è®¡&lt;/strong&gt;ï¼šé‡è¯•å¤„ç†æ­»ä¿¡æ—¶éœ€é˜²æ­¢é‡å¤æ¶ˆè´¹å¯¼è‡´æ•°æ®é”™è¯¯&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TTLä¼˜åŒ–&lt;/strong&gt;ï¼šæ ¹æ®ä¸šåŠ¡è®¾ç½®åˆç†è¶…æ—¶æ—¶é—´ï¼Œé¿å…è¿‡æ—©/è¿‡æ™šè¿›å…¥DLQ&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¯¹æ¯”-1"&gt;ğŸ”§ &lt;strong&gt;ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ­»ä¿¡é˜Ÿåˆ—ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ˜¾å¼ç»‘å®šDLXå’Œæ­»ä¿¡é˜Ÿåˆ—ï¼›æ”¯æŒä¸‰ç§æ­»ä¿¡æ¥æº&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨åˆ›å»ºæ­»ä¿¡é˜Ÿåˆ—ï¼ˆ&lt;code&gt;%DLQ%æ¶ˆè´¹ç»„å&lt;/code&gt;ï¼‰ï¼›æ¶ˆæ¯é‡è¯•16æ¬¡å¤±è´¥åè½¬å…¥&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— å†…ç½®DLQï¼Œéœ€è‡ªå®šä¹‰æ­»ä¿¡Topicå¹¶æ‰‹åŠ¨è½¬ç§»å¤±è´¥æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ActiveMQ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é»˜è®¤å¯ç”¨DLQï¼ˆ&lt;code&gt;ActiveMQ.DLQ&lt;/code&gt;ï¼‰ï¼Œå¯é…ç½®æœ€å¤§é‡è¯•æ¬¡æ•°&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ­»ä¿¡é˜Ÿåˆ—æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„**â€œå®‰å…¨æ°”å›Šâ€**ï¼šé€šè¿‡éš”ç¦»å¼‚å¸¸æ¶ˆæ¯ï¼Œå¹³è¡¡äº†å¯é æ€§ï¼ˆä¸ä¸¢æ•°æ®ï¼‰ä¸å¯ç”¨æ€§ï¼ˆæ•…éšœéš”ç¦»ï¼‰ã€‚å®é™…åº”ç”¨ä¸­éœ€ç»“åˆä¸šåŠ¡åœºæ™¯é…ç½®æ­»ä¿¡è§„åˆ™ï¼Œå¹¶é…å¥—ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶ï¼Œç¡®ä¿é—®é¢˜å¯è¿½æº¯ã€å¯æ¢å¤&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;ã€‚å¯¹äºéœ€é«˜å¯é æ€§çš„åœºæ™¯ï¼ˆå¦‚é‡‘èäº¤æ˜“ï¼‰ï¼Œå»ºè®®ç»“åˆäº‹åŠ¡æ¶ˆæ¯+DLQä½¿ç”¨&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="é‡å¤æ¶ˆè´¹"&gt;é‡å¤æ¶ˆè´¹
&lt;/h2&gt;&lt;p&gt;æ¶ˆæ¯é˜Ÿåˆ—ä¸­é˜²æ­¢æ¶ˆæ¯é‡å¤æ¶ˆè´¹æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒæŒ‘æˆ˜ä¹‹ä¸€ï¼Œéœ€åœ¨ç”Ÿäº§è€…ã€æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ç«¯å’Œæ¶ˆè´¹è€…ä¸‰ä¸ªå±‚é¢ååŒè®¾è®¡ã€‚ä»¥ä¸‹æ˜¯ç³»ç»ŸåŒ–çš„è§£å†³æ–¹æ¡ˆåŠå®è·µè¦ç‚¹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿäº§è€…ç«¯é¿å…æ¶ˆæ¯é‡å¤å‘é€"&gt;âš™ï¸ ç”Ÿäº§è€…ç«¯ï¼šé¿å…æ¶ˆæ¯é‡å¤å‘é€
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å”¯ä¸€æ¶ˆæ¯IDæœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šä¸ºæ¯æ¡æ¶ˆæ¯ç”Ÿæˆå…¨å±€å”¯ä¸€IDï¼ˆå¦‚UUIDã€é›ªèŠ±ç®—æ³•IDï¼‰ï¼Œå‘é€å‰åœ¨æœ¬åœ°æˆ–åˆ†å¸ƒå¼å­˜å‚¨ï¼ˆå¦‚Redisï¼‰è®°å½•è¯¥IDï¼Œåç»­å‘é€æ—¶æ ¡éªŒå»é‡&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ‰€æœ‰æ¶ˆæ¯é˜Ÿåˆ—é€šç”¨ï¼Œä½†éœ€æƒè¡¡å­˜å‚¨æˆæœ¬ä¸å»¶è¿Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—çš„å¹‚ç­‰ç”Ÿäº§è€…&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Kafka&lt;/strong&gt;ï¼šè®¾ç½® &lt;code&gt;enable.idempotence=true&lt;/code&gt;ï¼Œç»“åˆ &lt;code&gt;acks=all&lt;/code&gt; å’Œäº‹åŠ¡APIï¼Œç¡®ä¿æ¶ˆæ¯ç²¾å‡†ä¸€æ¬¡æŠ•é€’&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;ï¼šä½¿ç”¨äº‹åŠ¡æ¶ˆæ¯ï¼ˆäºŒé˜¶æ®µæäº¤ï¼‰ï¼Œç”Ÿäº§è€…æœ¬åœ°äº‹åŠ¡ä¸æ¶ˆæ¯å‘é€åŸå­ç»‘å®š&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šç”±ä¸­é—´ä»¶ä¿éšœï¼Œä¸šåŠ¡ä»£ç æ— éœ€é¢å¤–å¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ç«¯å†…ç½®å»é‡ä¸éš”ç¦»"&gt;ğŸ›¡ï¸ æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ç«¯ï¼šå†…ç½®å»é‡ä¸éš”ç¦»
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Brokerç«¯å»é‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;UNIQUE_KEY&lt;/code&gt; å±æ€§å®ç°æœåŠ¡ç«¯å»é‡ï¼Œè‡ªåŠ¨è¿‡æ»¤é‡å¤æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;ï¼šå€ŸåŠ©æ’ä»¶ï¼ˆå¦‚ &lt;code&gt;rabbitmq_message_deduplication&lt;/code&gt;ï¼‰å®ç°ç±»ä¼¼åŠŸèƒ½&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯è¿‡æœŸæœºåˆ¶ï¼ˆTTLï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºæ¶ˆæ¯æˆ–é˜Ÿåˆ—è®¾ç½®ç”Ÿå­˜æ—¶é—´ï¼ˆTTLï¼‰ï¼Œè¶…æ—¶åè‡ªåŠ¨åˆ é™¤ï¼Œé¿å…å› å †ç§¯å¯¼è‡´é‡å¤æ¶ˆè´¹é£é™©&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šç§’æ€ã€é™æ—¶ä¼˜æƒ ç­‰é«˜æ—¶æ•ˆæ€§ä¸šåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶ˆè´¹è€…ç«¯å¹‚ç­‰æ€§è®¾è®¡æ ¸å¿ƒé˜²å¾¡"&gt;ğŸ§  æ¶ˆè´¹è€…ç«¯ï¼šå¹‚ç­‰æ€§è®¾è®¡ï¼ˆæ ¸å¿ƒé˜²å¾¡ï¼‰
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å”¯ä¸€æ¶ˆæ¯ID + çŠ¶æ€å­˜å‚¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…æå–æ¶ˆæ¯çš„å”¯ä¸€IDï¼ˆå¦‚è®¢å•å·ã€æ”¯ä»˜æµæ°´å·ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢å­˜å‚¨ç³»ç»Ÿï¼ˆRedis/DBï¼‰åˆ¤æ–­æ˜¯å¦å·²å¤„ç†ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥å·²å¤„ç† â†’ ç›´æ¥ACKç¡®è®¤&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æœªå¤„ç† â†’ æ‰§è¡Œä¸šåŠ¡é€»è¾‘ â†’ è®°å½•å¤„ç†çŠ¶æ€ â†’ ACKç¡®è®¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å­˜å‚¨é€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜é¢‘åœºæ™¯&lt;/strong&gt;ï¼šRedisçš„ &lt;code&gt;SETNX&lt;/code&gt; å‘½ä»¤æˆ–å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆå†…å­˜å ç”¨ä½ï¼Œæœ‰è¯¯åˆ¤ç‡ï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½é¢‘å¼ºä¸€è‡´&lt;/strong&gt;ï¼šæ•°æ®åº“å”¯ä¸€ç´¢å¼•ï¼ˆå¦‚MySQLå”¯ä¸€é”®ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡é€»è¾‘å¹‚ç­‰è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®åº“æ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;æ’å…¥æ—¶ä½¿ç”¨ &lt;code&gt;INSERT IGNORE&lt;/code&gt; æˆ– &lt;code&gt;ON DUPLICATE KEY UPDATE&lt;/code&gt;&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ›´æ–°æ—¶æ·»åŠ ä¹è§‚é”ï¼ˆç‰ˆæœ¬å·ï¼‰æˆ–çŠ¶æ€æ ¡éªŒï¼ˆå¦‚ &lt;code&gt;UPDATE orders SET status='paid' WHERE status='unpaid'&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤©ç„¶å¹‚ç­‰æ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;åˆ é™¤ï¼ˆ&lt;code&gt;DELETE&lt;/code&gt;ï¼‰ã€æŸ¥è¯¢ï¼ˆ&lt;code&gt;SELECT&lt;/code&gt;ï¼‰ã€å›ºå®šå€¼æ›´æ–°ï¼ˆ&lt;code&gt;SET status=1&lt;/code&gt;ï¼‰æ— éœ€é¢å¤–å¤„ç†&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼é”æ§åˆ¶å¹¶å‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨Redisæˆ–ZooKeeperå®ç°åˆ†å¸ƒå¼é”ï¼Œç¡®ä¿åŒä¸€ä¸šåŠ¡é”®ï¼ˆå¦‚è®¢å•IDï¼‰çš„æ¶ˆæ¯ä¸²è¡Œå¤„ç†&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šé”ç²’åº¦è¦ç»†ï¼ˆæŒ‰ä¸šåŠ¡é”®åŠ é”ï¼‰ï¼Œé¿å…æ€§èƒ½ç“¶é¢ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®¹é”™æœºåˆ¶å…œåº•ä¸æ¢å¤"&gt;âš ï¸ å®¹é”™æœºåˆ¶ï¼šå…œåº•ä¸æ¢å¤
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹ç¡®è®¤ï¼ˆACKï¼‰ä¸é‡è¯•ç­–ç•¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰‹åŠ¨ACK&lt;/strong&gt;ï¼šä¸šåŠ¡é€»è¾‘æˆåŠŸåå†æäº¤ACKï¼Œå¤±è´¥åˆ™NACKé‡è¯•ï¼ˆå¦‚RabbitMQçš„ &lt;code&gt;basicNack&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡è¯•é™åˆ¶&lt;/strong&gt;ï¼šè®¾ç½®æœ€å¤§é‡è¯•æ¬¡æ•°ï¼ˆå¦‚3æ¬¡ï¼‰ï¼Œè¶…é™åè½¬å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLQï¼‰äººå·¥å¤„ç†&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆä¸€è‡´æ€§è¡¥å¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹è´¦ç³»ç»Ÿï¼šå®šæœŸæ‰«æä¸šåŠ¡æ•°æ®ï¼ˆå¦‚è®¢å•çŠ¶æ€ï¼‰ï¼Œä¿®å¤å› æç«¯æƒ…å†µå¯¼è‡´çš„é‡å¤é—®é¢˜&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰ˆæœ¬å·è¿½è¸ªï¼šé€šè¿‡æ¶ˆæ¯æºå¸¦çš„ç‰ˆæœ¬å·ï¼Œä¸¢å¼ƒæ—§ç‰ˆæœ¬æ¶ˆæ¯ï¼ˆå¦‚ &lt;code&gt;if (message.version &amp;gt; current_version)&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¯¹æ¯”-2"&gt;ğŸ“Š ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç”Ÿäº§è€…é˜²é‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœåŠ¡ç«¯å»é‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¶ˆè´¹è€…ç«¯æ¨èæ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Kafka&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;enable.idempotence=true&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;å”¯ä¸€ID + Redis + å¹‚ç­‰æ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RocketMQ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡æ¶ˆæ¯&lt;/td&gt;
&lt;td&gt;æ”¯æŒï¼ˆ&lt;code&gt;UNIQUE_KEY&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å¸ƒéš†è¿‡æ»¤å™¨ + ä¹è§‚é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RabbitMQ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å”¯ä¸€ID + æœ¬åœ°ç¼“å­˜&lt;/td&gt;
&lt;td&gt;éœ€æ’ä»¶æ”¯æŒ&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“å”¯ä¸€ç´¢å¼• + æ‰‹åŠ¨ACK&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åœºæ™¯åŒ–æ–¹æ¡ˆé€‰æ‹©"&gt;ğŸ› ï¸ åœºæ™¯åŒ–æ–¹æ¡ˆé€‰æ‹©
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ”¯ä»˜å›è°ƒï¼ˆé«˜é¢‘é«˜æ•ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šå”¯ä¸€æ”¯ä»˜æµæ°´å· + Rediså»é‡ + ä¹è§‚é”æ›´æ–°è®¢å•çŠ¶æ€&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»£ç ç‰‡æ®µï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE orders SET status = &amp;#39;paid&amp;#39;
WHERE order_id = &amp;#39;123&amp;#39; AND status = &amp;#39;unpaid&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº“å­˜æ‰£å‡ï¼ˆé˜²è¶…å–ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šRedisåŸå­æ“ä½œï¼ˆ&lt;code&gt;DECRBY&lt;/code&gt;ï¼‰ + æ‰£å‡æµæ°´è¡¨å”¯ä¸€çº¦æŸ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šæ‰£å‡å‰æ ¡éªŒåº“å­˜ä½™é¢ï¼Œé¿å…è´Ÿæ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€šçŸ¥ç±»æ¶ˆæ¯ï¼ˆå…è®¸å°‘é‡é‡å¤ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šæ¶ˆæ¯TTL + å¸ƒéš†è¿‡æ»¤å™¨ï¼Œç‰ºç‰²ç²¾ç¡®æ€§æ¢å–æ€§èƒ½&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸æœ€ä½³å®è·µ"&gt;ğŸ’ æ€»ç»“ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆå±‚çº§&lt;/strong&gt;ï¼š
â€‹&lt;strong&gt;ä¸šåŠ¡å¹‚ç­‰è®¾è®¡&lt;/strong&gt;â€‹ &amp;gt; â€‹&lt;strong&gt;å”¯ä¸€IDå»é‡&lt;/strong&gt;â€‹ &amp;gt; â€‹&lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—ç‰¹æ€§&lt;/strong&gt;â€‹ &amp;gt; â€‹&lt;strong&gt;äººå·¥è¡¥å¿&lt;/strong&gt;â€‹&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»„é‡‘ç»„åˆ&lt;/strong&gt;ï¼š
ç”Ÿäº§è€…å”¯ä¸€ID + æ¶ˆè´¹è€…å¹‚ç­‰æ“ä½œ + æ­»ä¿¡é˜Ÿåˆ—å…œåº•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;ï¼š
é«˜é¢‘åœºæ™¯ç”¨Redisï¼ˆTPSé«˜ï¼‰ï¼Œä½é¢‘å¼ºä¸€è‡´ç”¨æ•°æ®åº“ï¼ˆå¯é æ€§å¼ºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹ç¾è®¾è®¡&lt;/strong&gt;ï¼š
ç›‘æ§DLQå †ç§¯é‡ï¼Œè®¾ç½®å‘Šè­¦é˜ˆå€¼ï¼ˆå¦‚ &amp;gt;1000æ¡ï¼‰ï¼Œå®šæœŸå·¡æ£€å¯¹è´¦&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡åˆ†å±‚é˜²å¾¡ï¼ˆç”Ÿäº§é˜²é‡ã€æ¶ˆè´¹å¹‚ç­‰ã€å¼‚å¸¸éš”ç¦»ï¼‰ï¼Œå¯åœ¨99.9%åœºæ™¯ä¸‹é¿å…é‡å¤æ¶ˆè´¹ã€‚æç«¯æƒ…å†µï¼ˆå¦‚åˆ†å¸ƒå¼å­˜å‚¨æ•…éšœï¼‰éœ€ç»“åˆä¸šåŠ¡è¡¥å¿æœºåˆ¶ï¼Œå®ç°æœ€ç»ˆä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="åˆ†å¸ƒå¼é”"&gt;åˆ†å¸ƒå¼é”
&lt;/h2&gt;&lt;p&gt;åˆ†å¸ƒå¼é”æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åè°ƒå¤šèŠ‚ç‚¹å¯¹å…±äº«èµ„æºäº’æ–¥è®¿é—®çš„æ ¸å¿ƒæœºåˆ¶ï¼Œç¡®ä¿åœ¨ä»»æ„æ—¶åˆ»åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹èƒ½æ“ä½œå…±äº«èµ„æºï¼ˆå¦‚æ•°æ®åº“è®°å½•ã€é…ç½®ã€åº“å­˜ï¼‰ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´å’Œç«äº‰æ¡ä»¶ã€‚ä»¥ä¸‹ä»åŸç†ã€å®ç°ã€æŒ‘æˆ˜åˆ°å®è·µè¿›è¡Œå…¨é¢è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§"&gt;ğŸ”’ æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº’æ–¥æ€§&lt;/strong&gt;ï¼šåŒä¸€æ—¶åˆ»ä»…ä¸€ä¸ªèŠ‚ç‚¹æŒæœ‰é”&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™æ€§&lt;/strong&gt;ï¼šå³ä½¿èŠ‚ç‚¹å´©æºƒæˆ–ç½‘ç»œå¼‚å¸¸ï¼Œé”ä¹Ÿèƒ½è‡ªåŠ¨é‡Šæ”¾ï¼ˆé¿å…æ­»é”ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é‡å…¥æ€§&lt;/strong&gt;ï¼šåŒä¸€èŠ‚ç‚¹å¯å¤šæ¬¡è·å–åŒä¸€æŠŠé”ï¼ˆé˜²æ­¢è‡ªæˆ‘é˜»å¡ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨&lt;/strong&gt;ï¼šé”æœåŠ¡éœ€é›†ç¾¤åŒ–ï¼Œå•ç‚¹æ•…éšœä¸å½±å“æ•´ä½“åŠŸèƒ½&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç§’æ€åº“å­˜æ‰£å‡&lt;/strong&gt;ï¼šé˜²æ­¢è¶…å–ï¼ˆå¦‚Redisé”æ§åˆ¶åº“å­˜æ›´æ–°ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦&lt;/strong&gt;ï¼šç¡®ä¿å®šæ—¶ä»»åŠ¡ä»…å•èŠ‚ç‚¹æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æ›´æ–°&lt;/strong&gt;ï¼šé¿å…å¤šèŠ‚ç‚¹å¹¶å‘ä¿®æ”¹é…ç½®å¯¼è‡´å†²çª&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼äº‹åŠ¡åè°ƒ&lt;/strong&gt;ï¼šä¿è¯è·¨æœåŠ¡æ“ä½œçš„åŸå­æ€§&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµå®ç°æ–¹å¼å¯¹æ¯”"&gt;âš™ï¸ ä¸»æµå®ç°æ–¹å¼å¯¹æ¯”
&lt;/h3&gt;&lt;h4 id="åŸºäºæ•°æ®åº“"&gt;&lt;strong&gt;åŸºäºæ•°æ®åº“&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å®ç°åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;åˆ©ç”¨å”¯ä¸€çº¦æŸæˆ–ä¹è§‚é”ï¼ˆç‰ˆæœ¬å·ï¼‰å®ç°äº’æ–¥ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šæ’å…¥å”¯ä¸€é”®&lt;code&gt;lock_name&lt;/code&gt;ï¼ŒæˆåŠŸå³è·é”&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜ç¼ºç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;âœ… æ— éœ€é¢å¤–ä¸­é—´ä»¶ï¼Œé€‚åˆç®€å•åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;âŒ æ€§èƒ½å·®ï¼ˆé«˜å¹¶å‘ä¸‹æ•°æ®åº“å‹åŠ›å¤§ï¼‰ã€æ— è‡ªåŠ¨è¶…æ—¶æœºåˆ¶&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸºäºredisä¸»æµæ–¹æ¡ˆ"&gt;&lt;strong&gt;åŸºäºRedisï¼ˆä¸»æµæ–¹æ¡ˆï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ ¸å¿ƒå‘½ä»¤ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;// åŸå­æ“ä½œï¼šSET key value NX EX 30 ï¼ˆä¸å­˜åœ¨åˆ™è®¾ç½®ï¼Œè¶…æ—¶30ç§’ï¼‰
String result = jedis.set(&amp;#34;lock:order_123&amp;#34;, uuid, &amp;#34;NX&amp;#34;, &amp;#34;EX&amp;#34;, 30);
if (&amp;#34;OK&amp;#34;.equals(result)) {
// è·é”æˆåŠŸ
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;é‡Šæ”¾é”éœ€Luaè„šæœ¬ä¿è¯åŸå­æ€§ï¼šæ ¡éªŒUUIDåŒ¹é…åå†åˆ é™¤&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è¿›é˜¶æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;Redissonï¼šè§£å†³ä¸å¯é‡å…¥ã€é”ç»­æœŸé—®é¢˜ï¼š
&lt;ul&gt;
&lt;li&gt;å¯é‡å…¥é”ï¼šHashç»“æ„è®°å½•çº¿ç¨‹IDå’Œé‡å…¥æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;WatchDog&lt;/strong&gt;ï¼šåå°çº¿ç¨‹è‡ªåŠ¨ç»­æœŸï¼ˆé»˜è®¤æ¯10ç§’ç»­è‡³30ç§’ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RedLock&lt;/strong&gt;ï¼šå¤šRedisèŠ‚ç‚¹æŠ•ç¥¨ï¼Œè¿‡åŠæˆåŠŸæ‰è§†ä¸ºè·é”ï¼ˆé˜²ä¸»ä»è„‘è£‚ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸºäºzookeeper"&gt;&lt;strong&gt;åŸºäºZooKeeper&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å®ç°åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;åˆ›å»º&lt;strong&gt;ä¸´æ—¶é¡ºåºèŠ‚ç‚¹&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;/lock/resource_000001&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»…åºå·æœ€å°çš„èŠ‚ç‚¹è·é”ï¼›å…¶ä»–èŠ‚ç‚¹ç›‘å¬å‰åºèŠ‚ç‚¹åˆ é™¤äº‹ä»¶&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‰¹æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;âœ… å¼ºä¸€è‡´æ€§ã€è‡ªåŠ¨é‡Šæ”¾ï¼ˆèŠ‚ç‚¹æ–­å¼€åˆ™ä¸´æ—¶èŠ‚ç‚¹åˆ é™¤ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;âŒ æ€§èƒ½ä½äºRedisï¼Œéœ€ç»´æŠ¤ZKé›†ç¾¤&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸºäºetcd"&gt;&lt;strong&gt;åŸºäºEtcd&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ç§Ÿçº¦ï¼ˆLeaseï¼‰åˆ›å»ºå¸¦TTLçš„é”®å€¼å¯¹ï¼Œåˆ©ç”¨CASæ“ä½œç«äº‰é”&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜å¯ç”¨ã€å¼ºä¸€è‡´æ€§ï¼ˆåŸºäºRaftåè®®ï¼‰ï¼Œé€‚åˆKubernetesç­‰äº‘åŸç”Ÿåœºæ™¯&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-æ–¹æ¡ˆå¯¹æ¯”è¡¨"&gt;ğŸ“Š &lt;strong&gt;æ–¹æ¡ˆå¯¹æ¯”è¡¨&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®åº“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Redis&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ZooKeeper&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Etcd&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆIOç“¶é¢ˆï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆå†…å­˜çº§ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆå†™éœ€åŒæ­¥ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­ï¼ˆé«˜æ•ˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆä¾èµ–DBé«˜å¯ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆéœ€RedLockï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆå¼ºä¸€è‡´ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆå¼ºä¸€è‡´ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªåŠ¨é‡Šæ”¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨æ¸…ç†&lt;/td&gt;
&lt;td&gt;è¶…æ—¶è‡ªåŠ¨é‡Šæ”¾&lt;/td&gt;
&lt;td&gt;ä¼šè¯æ–­å¼€å³é‡Šæ”¾&lt;/td&gt;
&lt;td&gt;ç§Ÿçº¦åˆ°æœŸé‡Šæ”¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½é¢‘ç®€å•ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ç¼“å­˜åœºæ™¯&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼åè°ƒ&lt;/td&gt;
&lt;td&gt;äº‘åŸç”Ÿ/å®¹å™¨åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"&gt;âš ï¸ å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é”ç»­æœŸï¼ˆLock Renewalï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šä¸šåŠ¡æ‰§è¡Œè¶…æ—¶å¯¼è‡´é”æå‰é‡Šæ”¾ï¼Œå¼•å‘å¹¶å‘å†²çªã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Redissonçš„WatchDog&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;æˆ–è‡ªå®šä¹‰å®ˆæŠ¤çº¿ç¨‹å®šæœŸç»­æœŸã€‚
&lt;ul&gt;
&lt;li&gt;è®¾ç½®åˆç†è¶…æ—¶æ—¶é—´ï¼ˆå»ºè®®ï¼šä¸šåŠ¡æœ€å¤§è€—æ—¶ * 2ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;è¯¯é‡Šæ”¾ï¼ˆNon-Owner Releaseï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šèŠ‚ç‚¹Açš„é”è¢«èŠ‚ç‚¹Bé‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šé”å€¼ç»‘å®šå”¯ä¸€IDï¼ˆå¦‚UUIDï¼‰ï¼Œé‡Šæ”¾æ—¶æ ¡éªŒæŒæœ‰è€…&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è„‘è£‚é—®é¢˜ï¼ˆRedisä¸»ä»åˆ‡æ¢ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç°è±¡&lt;/strong&gt;ï¼šä¸»èŠ‚ç‚¹é”æœªåŒæ­¥åˆ°ä»èŠ‚ç‚¹å³å®•æœºï¼Œæ–°ä¸»èŠ‚ç‚¹å…è®¸å¤šå®¢æˆ·ç«¯è·é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šRedLockç®—æ³•ï¼ˆéœ€è‡³å°‘3ä¸ªç‹¬ç«‹Rediså®ä¾‹ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¹³æ€§ä¸é¥¥é¥¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šé«˜å¹¶å‘ä¸‹æŸäº›èŠ‚ç‚¹é•¿æœŸæœªè·é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šZooKeeperé¡ºåºèŠ‚ç‚¹å®ç°æ’é˜Ÿæœºåˆ¶&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æœ€ä½³å®è·µ"&gt;ğŸ› ï¸ æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘ç§’æ€ â†’ Redis + Redisson&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é‡‘èçº§å¼ºä¸€è‡´ â†’ ZooKeeper/Etcd&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è½»é‡çº§ä»»åŠ¡ â†’ æ•°æ®åº“ä¹è§‚é”ï¼ˆç‰ˆæœ¬å·ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹ç¾è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æ§é”ç­‰å¾…æ—¶é—´ä¸æŒæœ‰æ—¶é•¿ï¼Œè¶…é˜ˆå€¼è§¦å‘å‘Šè­¦&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…œåº•ç­–ç•¥ï¼šé”è·å–å¤±è´¥æ—¶å¿«é€Ÿå¤±è´¥ï¼ˆFast-Failï¼‰æˆ–é™çº§å¤„ç†&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…æ»¥ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é”ç²’åº¦è¦ç»†ï¼ˆå¦‚æŒ‰è®¢å•IDåˆ†é”è€Œéå…¨å±€é”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éå¿…è¦ä¸åŠ é”ï¼Œä¼˜å…ˆè€ƒè™‘æ— é”è®¾è®¡ï¼ˆå¦‚CASæ“ä½œï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;åˆ†å¸ƒå¼é”æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„â€œåè°ƒå‘˜â€ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;å¹³è¡¡æ€§èƒ½ä¸ä¸€è‡´æ€§&lt;/strong&gt;ã€‚é€‰å‹éœ€æƒè¡¡åœºæ™¯éœ€æ±‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redis&lt;/strong&gt;ï¼šé¦–é€‰é«˜å¹¶å‘åœºæ™¯ï¼Œé…åˆRedissonè§£å†³ç»­æœŸã€é‡å…¥é—®é¢˜&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ZooKeeper/Etcd&lt;/strong&gt;ï¼šå¼ºä¸€è‡´æ€§åœºæ™¯ï¼ˆå¦‚åˆ†å¸ƒå¼äº‹åŠ¡ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“&lt;/strong&gt;ï¼šä»…é€‚ç”¨äºä½é¢‘ç®€å•ä»»åŠ¡ï¼Œä¸æ¨èç”Ÿäº§ç¯å¢ƒä½¿ç”¨&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ€ç»ˆå»ºè®®ï¼šä¼˜å…ˆä½¿ç”¨æˆç†Ÿæ¡†æ¶ï¼ˆå¦‚Redissonã€Curatorï¼‰ï¼Œé¿å…é‡å¤é€ è½®å­ï¼›åŒæ—¶ç»“åˆç†”æ–­ã€ç›‘æ§ã€æ—¥å¿—è¿½è¸ªï¼Œæ„å»ºé²æ£’çš„åˆ†å¸ƒå¼é”ä½“ç³»&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="åˆ†å¸ƒå¼äº‹åŠ¡"&gt;åˆ†å¸ƒå¼äº‹åŠ¡
&lt;/h2&gt;&lt;p&gt;åˆ†å¸ƒå¼äº‹åŠ¡æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç¡®ä¿è·¨å¤šä¸ªç‹¬ç«‹èŠ‚ç‚¹æˆ–æœåŠ¡çš„æ“ä½œå…·æœ‰åŸå­æ€§ï¼ˆå…¨éƒ¨æˆåŠŸæˆ–å…¨éƒ¨å¤±è´¥ï¼‰çš„æ ¸å¿ƒæœºåˆ¶ï¼Œé€‚ç”¨äºå¾®æœåŠ¡ã€è·¨æ•°æ®åº“ç­‰åœºæ™¯ã€‚ä»¥ä¸‹ä»ç†è®ºåŸºç¡€ã€è§£å†³æ–¹æ¡ˆåˆ°å®è·µæ¡†æ¶å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸æŒ‘æˆ˜"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸æŒ‘æˆ˜&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡å‚ä¸è€…ï¼ˆå¦‚æ•°æ®åº“ã€æœåŠ¡ï¼‰ã€èµ„æºæœåŠ¡å™¨ã€äº‹åŠ¡ç®¡ç†å™¨ä½äºä¸åŒç½‘ç»œèŠ‚ç‚¹ï¼Œéœ€ååŒä¿è¯æ“ä½œåŸå­æ€§&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šç”µå•†ä¸‹å•ï¼ˆåˆ›å»ºè®¢å•ã€æ‰£åº“å­˜ã€æ”¯ä»˜ï¼‰æ¶‰åŠå¤šä¸ªæœåŠ¡ï¼Œéœ€ä¿è¯ä¸‰è€…çŠ¶æ€ä¸€è‡´&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæŒ‘æˆ˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œä¸å¯é &lt;/strong&gt;ï¼šèŠ‚ç‚¹é—´é€šä¿¡å¯èƒ½è¶…æ—¶ã€ä¸¢åŒ…ï¼Œå¯¼è‡´éƒ¨åˆ†æ“ä½œå¤±è´¥&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;ï¼šè·¨èŠ‚ç‚¹æ•°æ®éœ€åœ¨æ•…éšœæ—¶ä¿æŒåŒæ­¥ï¼Œé¿å…éƒ¨åˆ†æäº¤&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¸å¯ç”¨æ€§æƒè¡¡&lt;/strong&gt;ï¼šå¼ºä¸€è‡´æ€§å¯èƒ½ç‰ºç‰²ç³»ç»Ÿå¯ç”¨æ€§ï¼ˆCAPç†è®ºï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç†è®ºåŸºç¡€capä¸base"&gt;ğŸ“œ &lt;strong&gt;ç†è®ºåŸºç¡€ï¼šCAPä¸BASE&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;CAPå®šç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸‰é€‰äºŒå›°å¢ƒï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§ (Consistency)&lt;/strong&gt;ï¼šæ‰€æœ‰èŠ‚ç‚¹æ•°æ®å®æ—¶ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯ç”¨æ€§ (Availability)&lt;/strong&gt;ï¼šè¯·æ±‚å¿…é¡»è·å¾—å“åº”ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒºå®¹é”™æ€§ (Partition Tolerance)&lt;/strong&gt;ï¼šèŠ‚ç‚¹æ•…éšœæ—¶ç³»ç»Ÿä»å¯ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“è®º&lt;/strong&gt;ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿå¿…é¡»ä¼˜å…ˆæ»¡è¶³ &lt;strong&gt;åˆ†åŒºå®¹é”™æ€§ (P)&lt;/strong&gt;ï¼Œåœ¨ &lt;strong&gt;ä¸€è‡´æ€§ (C)&lt;/strong&gt; ä¸ &lt;strong&gt;å¯ç”¨æ€§ (A)&lt;/strong&gt; ä¹‹é—´æƒè¡¡&lt;a class="link" href="@ref" &gt;3,8,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼šElasticsearch é€‰æ‹© &lt;strong&gt;CP&lt;/strong&gt;ï¼ˆå¼ºä¸€è‡´ï¼Œä½å¯ç”¨ï¼‰ï¼›APç³»ç»Ÿï¼ˆå¦‚Cassandraï¼‰ä¼˜å…ˆå¯ç”¨æ€§&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;BASEç†è®º&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºæœ¬å¯ç”¨ (Basically Available)&lt;/strong&gt;ï¼šæ•…éšœæ—¶å…è®¸é™çº§ï¼ˆå¦‚å“åº”å»¶è¿Ÿï¼‰&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯çŠ¶æ€ (Soft State)&lt;/strong&gt;ï¼šå…è®¸ä¸­é—´æ€ï¼ˆå¦‚â€œæ”¯ä»˜ä¸­â€ï¼‰&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆä¸€è‡´æ€§ (Eventually Consistent)&lt;/strong&gt;ï¼šæ•°æ®å»¶è¿ŸåŒæ­¥åä¸€è‡´&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘ç³»ç»Ÿï¼ˆå¦‚ç”µå•†ï¼‰ï¼Œå®¹å¿çŸ­æš‚ä¸ä¸€è‡´&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµè§£å†³æ–¹æ¡ˆ"&gt;ğŸ› ï¸ &lt;strong&gt;ä¸»æµè§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¸¤é˜¶æ®µæäº¤-2pc"&gt;&lt;strong&gt;ä¸¤é˜¶æ®µæäº¤ (2PC)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡†å¤‡é˜¶æ®µ&lt;/strong&gt;ï¼šåè°ƒè€…è¯¢é—®å‚ä¸è€…èƒ½å¦æäº¤ï¼Œå‚ä¸è€…é¢„æ‰§è¡Œå¹¶é”å®šèµ„æºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æäº¤é˜¶æ®µ&lt;/strong&gt;ï¼šè‹¥å…¨éƒ¨åŒæ„ï¼Œåè°ƒè€…é€šçŸ¥æäº¤ï¼›å¦åˆ™å›æ»š&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå¼ºä¸€è‡´æ€§ï¼Œå®ç°ç®€å•ï¼ˆå¦‚MySQL XAåè®®ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥é˜»å¡&lt;/strong&gt;ï¼šå‚ä¸è€…ç­‰å¾…æŒ‡ä»¤æ—¶èµ„æºè¢«é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•ç‚¹æ•…éšœ&lt;/strong&gt;ï¼šåè°ƒè€…å®•æœºå¯¼è‡´äº‹åŠ¡æ‚¬åœ&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé“¶è¡Œè½¬è´¦ç­‰å¼ºä¸€è‡´éœ€æ±‚&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="tcc-try-confirm-cancel"&gt;&lt;strong&gt;TCC (Try-Confirm-Cancel)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ä¸‰é˜¶æ®µï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Try&lt;/strong&gt;ï¼šé¢„ç•™èµ„æºï¼ˆå¦‚å†»ç»“åº“å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Confirm&lt;/strong&gt;ï¼šæäº¤æ“ä½œï¼ˆå¦‚æ‰£å‡åº“å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cancel&lt;/strong&gt;ï¼šå¤±è´¥æ—¶å›æ»šï¼ˆå¦‚è§£å†»åº“å­˜ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ— é”è®¾è®¡ã€é«˜æ€§èƒ½ï¼Œæ”¯æŒé«˜å¹¶å‘ï¼ˆå¦‚ç§’æ€ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šä¸šåŠ¡ä¾µå…¥æ€§å¼ºï¼Œéœ€æ‰‹åŠ¨å®ç°è¡¥å¿é€»è¾‘&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="sagaæ¨¡å¼"&gt;&lt;strong&gt;Sagaæ¨¡å¼&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼šé•¿äº‹åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªæœ¬åœ°äº‹åŠ¡ï¼Œå¤±è´¥æ—¶è§¦å‘é€†å‘è¡¥å¿æ“ä½œã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;ç¤ºä¾‹ï¼šè®¢å•æµç¨‹ â†’ æ”¯ä»˜æˆåŠŸ â†’ ç‰©æµå¤±è´¥ â†’ è§¦å‘é€€æ¬¾è¡¥å¿[7](@ref)ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå¼‚æ­¥æ‰§è¡Œï¼Œé€‚åˆè·¨æœåŠ¡é•¿æµç¨‹ï¼ˆå¦‚æ—…è¡Œé¢„è®¢ï¼‰&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šéœ€å¤„ç†â€œæ‚¬æŒ‚äº‹åŠ¡â€ï¼ˆè¡¥å¿ååŸæ“ä½œåˆ°è¾¾ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸºäºæ¶ˆæ¯é˜Ÿåˆ—çš„æœ€ç»ˆä¸€è‡´æ€§"&gt;&lt;strong&gt;åŸºäºæ¶ˆæ¯é˜Ÿåˆ—çš„æœ€ç»ˆä¸€è‡´æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;æœåŠ¡Aå®Œæˆæœ¬åœ°äº‹åŠ¡ï¼Œå‘é€æ¶ˆæ¯è‡³MQï¼ˆå¦‚RocketMQäº‹åŠ¡æ¶ˆæ¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;MQç¡®ä¿æ¶ˆæ¯æŠ•é€’ï¼ŒæœåŠ¡Bæ¶ˆè´¹åæ‰§è¡Œæ“ä½œ&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šè§£è€¦æœåŠ¡ï¼Œé«˜ååï¼ˆå¦‚å¼‚æ­¥é€šçŸ¥ã€æ—¥å¿—åŒæ­¥ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…éœ€å¹‚ç­‰è®¾è®¡ï¼Œé˜²é‡å¤æ¶ˆè´¹&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æœ¬åœ°æ¶ˆæ¯è¡¨"&gt;&lt;strong&gt;æœ¬åœ°æ¶ˆæ¯è¡¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸šåŠ¡DBä¸­å»ºæ¶ˆæ¯è¡¨ï¼Œæœ¬åœ°äº‹åŠ¡ä¸æ¶ˆæ¯å†™å…¥åŸå­æäº¤ã€‚&lt;/li&gt;
&lt;li&gt;å®šæ—¶ä»»åŠ¡æ‰«æå¹¶å‘é€æœªå¤„ç†æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ— MQæ”¯æŒçš„è·¨åº“åŒæ­¥&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹"&gt;ğŸ“Š &lt;strong&gt;æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¾µå…¥æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;2PC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;é‡‘èè½¬è´¦ã€XAæ•°æ®åº“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;TCC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ç§’æ€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Saga&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;é•¿æµç¨‹ï¼ˆç‰©æµã€è®¢å•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;å¼‚æ­¥è§£è€¦ï¼ˆæ”¯ä»˜å›è°ƒï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬åœ°æ¶ˆæ¯è¡¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;æ— MQçš„è·¨åº“åŒæ­¥&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä¸šçº§æ¡†æ¶seata"&gt;ğŸ§© &lt;strong&gt;å·¥ä¸šçº§æ¡†æ¶ï¼šSeata&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Seata æ˜¯é˜¿é‡Œå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šæ¨¡å¼&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ATæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸€é˜¶æ®µæäº¤æœ¬åœ°äº‹åŠ¡ï¼Œç”Ÿæˆæ•°æ®å¿«ç…§ï¼ˆundo_logï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;äºŒé˜¶æ®µå¤±è´¥æ—¶é€šè¿‡å¿«ç…§å›æ»š&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ— ä»£ç ä¾µå…¥ï¼Œæ€§èƒ½ä¼˜äºXAã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨&lt;/strong&gt;ï¼šå¸¸è§„ä¸šåŠ¡ï¼ˆå¦‚è®¢å•åˆ›å»ºï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;TCCæ¨¡å¼&lt;/strong&gt;ï¼šéœ€æ‰‹åŠ¨å®ç° Try/Confirm/Cancel æ¥å£ï¼Œé€‚ç”¨é«˜æ€§èƒ½åœºæ™¯ï¼ˆå¦‚åº“å­˜æ‰£å‡ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sagaæ¨¡å¼&lt;/strong&gt;ï¼šå†…ç½®çŠ¶æ€æœºç¼–æ’ï¼Œç®€åŒ–é•¿äº‹åŠ¡è¡¥å¿é€»è¾‘&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;XAæ¨¡å¼&lt;/strong&gt;ï¼šå¼ºä¸€è‡´ï¼Œä¾èµ–æ•°æ®åº“XAåè®®ï¼ˆå¦‚é“¶è¡Œç³»ç»Ÿï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="seataæ¶æ„æ ¸å¿ƒè§’è‰²"&gt;&lt;strong&gt;Seataæ¶æ„æ ¸å¿ƒè§’è‰²&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;TC (Transaction Coordinator)&lt;/strong&gt;ï¼šäº‹åŠ¡åè°ƒè€…ï¼ˆç‹¬ç«‹éƒ¨ç½²ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TM (Transaction Manager)&lt;/strong&gt;ï¼šå®šä¹‰å…¨å±€äº‹åŠ¡è¾¹ç•Œï¼ˆ@GlobalTransactionalï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RM (Resource Manager)&lt;/strong&gt;ï¼šç®¡ç†åˆ†æ”¯äº‹åŠ¡èµ„æº&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®è·µå»ºè®®ä¸è¶‹åŠ¿"&gt;âš¡ &lt;strong&gt;å®è·µå»ºè®®ä¸è¶‹åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€‰å‹ç­–ç•¥&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºä¸€è‡´&lt;/strong&gt;ï¼š2PCã€TCCã€XAï¼ˆé‡‘èåœºæ™¯ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆä¸€è‡´&lt;/strong&gt;ï¼šæ¶ˆæ¯é˜Ÿåˆ—ã€Sagaï¼ˆç”µå•†ã€ç‰©æµï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜åå&lt;/strong&gt;ï¼šTCC &amp;gt; æ¶ˆæ¯é˜Ÿåˆ— &amp;gt; Saga&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®è®¾è®¡&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰æ€§&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…éœ€æ”¯æŒé‡å¤æ¶ˆæ¯å¤„ç†ï¼ˆå¦‚å”¯ä¸€ID+Redisï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™çº§ä¸ç›‘æ§&lt;/strong&gt;ï¼šäº‹åŠ¡å¤±è´¥ç‡ç›‘æ§ + æ­»ä¿¡é˜Ÿåˆ—å…œåº•&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶‹åŠ¿&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Serverlessäº‹åŠ¡&lt;/strong&gt;ï¼šäº‘åŸç”Ÿä¸‹æ— æœåŠ¡åŒ–äº‹åŠ¡ç®¡ç†&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ··åˆæ–¹æ¡ˆ&lt;/strong&gt;ï¼šå¦‚ Seata AT + TCC åº”å¯¹å¤æ‚åœºæ™¯&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åˆ†å¸ƒå¼äº‹åŠ¡æœ¬è´¨æ˜¯ &lt;strong&gt;ä¸€è‡´æ€§ã€å¯ç”¨æ€§ã€æ€§èƒ½çš„ä¸‰è§’æƒè¡¡&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºä¸€è‡´åœºæ™¯&lt;/strong&gt;ï¼šä¼˜å…ˆ 2PC/TCCï¼Œæ¥å—æ€§èƒ½æŸè€—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘åœºæ™¯&lt;/strong&gt;ï¼šTCC/æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä»¥æœ€ç»ˆä¸€è‡´æ¢ååã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿æµç¨‹ä¸šåŠ¡&lt;/strong&gt;ï¼šSaga æ¨¡å¼ + è¡¥å¿æœºåˆ¶ã€‚
å·¥ä¸šæ¡†æ¶ï¼ˆå¦‚ Seataï¼‰é€šè¿‡å¤šæ¨¡å¼æ”¯æŒé™ä½å®ç°æˆæœ¬ï¼Œä½†éœ€ç»“åˆä¸šåŠ¡ç‰¹ç‚¹è®¾è®¡å®¹é”™ä¸ç›‘æ§æœºåˆ¶ã€‚æœªæ¥éšç€äº‘åŸç”Ÿå‘å±•ï¼Œâ€‹&lt;strong&gt;æ— ä¾µå…¥äº‹åŠ¡ç®¡ç†&lt;/strong&gt;å’Œ&lt;strong&gt;è‡ªåŠ¨åŒ–ç¼–æ’&lt;/strong&gt;å°†æˆä¸ºé‡ç‚¹æ–¹å‘&lt;a class="link" href="@ref" &gt;6,9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="2pc"&gt;2PC
&lt;/h2&gt;&lt;h3 id="-2pcä¸¤é˜¶æ®µæäº¤åè®®è¯¦è§£"&gt;ğŸ” &lt;strong&gt;2PCï¼ˆä¸¤é˜¶æ®µæäº¤åè®®ï¼‰è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;2PCï¼ˆTwo-Phase Commitï¼‰æ˜¯ä¸€ç§ç»å…¸çš„åˆ†å¸ƒå¼äº‹åŠ¡åè®®ï¼Œç”¨äºç¡®ä¿è·¨å¤šä¸ªèŠ‚ç‚¹çš„æ“ä½œå…·å¤‡&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;ï¼ˆè¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥ï¼‰ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡åè°ƒè€…ï¼ˆCoordinatorï¼‰ç»Ÿä¸€è°ƒåº¦å‚ä¸è€…ï¼ˆParticipantsï¼‰ï¼Œåˆ†ä¸¤ä¸ªé˜¶æ®µå®Œæˆäº‹åŠ¡æäº¤ã€‚ä»¥ä¸‹ä»åŸç†ã€æµç¨‹ã€é—®é¢˜åˆ°ä¼˜åŒ–å±•å¼€åˆ†æã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id="-æ ¸å¿ƒåŸç†ä¸è®¾è®¡ç›®æ ‡"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸è®¾è®¡ç›®æ ‡&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ€§ä¿è¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼äº‹åŠ¡æ¶‰åŠå¤šä¸ªç‹¬ç«‹èŠ‚ç‚¹ï¼ˆå¦‚æ•°æ®åº“ã€å¾®æœåŠ¡ï¼‰ï¼Œ2PCé€šè¿‡&lt;strong&gt;åè°ƒè€…&lt;/strong&gt;ç»Ÿä¸€å†³ç­–ï¼Œç¡®ä¿æ‰€æœ‰å‚ä¸è€…è¦ä¹ˆå…¨éƒ¨æäº¤äº‹åŠ¡ï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šï¼Œé¿å…éƒ¨åˆ†æˆåŠŸå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´&lt;a class="link" href="@ref" &gt;1,4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè·¨æ•°æ®åº“æ›´æ–°ï¼ˆå¦‚è®¢å•åˆ›å»º+åº“å­˜æ‰£å‡ï¼‰ã€å¾®æœåŠ¡æ¶æ„ä¸­çš„è·¨æœåŠ¡äº‹åŠ¡&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§’è‰²åˆ†å·¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åè°ƒè€…&lt;/strong&gt;ï¼šäº‹åŠ¡å‘èµ·è€…ï¼Œå†³ç­–æäº¤æˆ–å›æ»šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚ä¸è€…&lt;/strong&gt;ï¼šæ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼Œåé¦ˆæ‰§è¡ŒçŠ¶æ€ï¼ˆå¦‚æ•°æ®åº“ã€å¾®æœåŠ¡ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h4 id="-åè®®æµç¨‹ä¸¤é˜¶æ®µè¯¦è§£"&gt;ğŸ”„ &lt;strong&gt;åè®®æµç¨‹ï¼šä¸¤é˜¶æ®µè¯¦è§£&lt;/strong&gt;
&lt;/h4&gt;&lt;h5 id="é˜¶æ®µ1å‡†å¤‡é˜¶æ®µprepare-phase"&gt;&lt;strong&gt;é˜¶æ®µ1ï¼šå‡†å¤‡é˜¶æ®µï¼ˆPrepare Phaseï¼‰&lt;/strong&gt;
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;åè°ƒè€…è¡Œä¸º&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å‘æ‰€æœ‰å‚ä¸è€…å‘é€&lt;code&gt;Prepare&lt;/code&gt;è¯·æ±‚ï¼Œè¯¢é—®æ˜¯å¦å¯æäº¤äº‹åŠ¡&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å‚ä¸è€…è¡Œä¸º&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼ˆ&lt;strong&gt;ä¸æäº¤&lt;/strong&gt;ï¼‰ï¼Œå†™&lt;code&gt;Undo/Redo&lt;/code&gt;æ—¥å¿—ï¼ˆç”¨äºå›æ»šæˆ–é‡è¯•ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;è¿”å›æŠ•ç¥¨ç»“æœï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ„ï¼ˆYesï¼‰&lt;/strong&gt;ï¼šæœ¬åœ°äº‹åŠ¡é¢„æ‰§è¡ŒæˆåŠŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‹’ç»ï¼ˆNoï¼‰&lt;/strong&gt;ï¼šæœ¬åœ°äº‹åŠ¡å¤±è´¥ï¼ˆå¦‚èµ„æºå†²çªï¼‰&lt;a class="link" href="@ref" &gt;1,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šæ­¤é˜¶æ®µå‚ä¸è€…é”å®šèµ„æºï¼ˆå¦‚æ•°æ®åº“è¡Œé”ï¼‰ï¼Œä½†æœªæŒä¹…åŒ–æ•°æ®ï¼Œå¤„äºé˜»å¡çŠ¶æ€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id="é˜¶æ®µ2æäº¤å›æ»šé˜¶æ®µcommitrollback-phase"&gt;&lt;strong&gt;é˜¶æ®µ2ï¼šæäº¤/å›æ»šé˜¶æ®µï¼ˆCommit/Rollback Phaseï¼‰&lt;/strong&gt;
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;åè°ƒè€…å†³ç­–&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¨éƒ¨åŒæ„&lt;/strong&gt; â†’ å‘é€&lt;code&gt;Commit&lt;/code&gt;å‘½ä»¤ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»»ä¸€æ‹’ç»æˆ–è¶…æ—¶&lt;/strong&gt; â†’ å‘é€&lt;code&gt;Rollback&lt;/code&gt;å‘½ä»¤&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å‚ä¸è€…æ‰§è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ”¶åˆ°&lt;code&gt;Commit&lt;/code&gt;ï¼šæäº¤æœ¬åœ°äº‹åŠ¡ï¼Œé‡Šæ”¾é”ï¼Œè¿”å›&lt;code&gt;ACK&lt;/code&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;æ”¶åˆ°&lt;code&gt;Rollback&lt;/code&gt;ï¼šæ ¹æ®&lt;code&gt;Undo&lt;/code&gt;æ—¥å¿—å›æ»šï¼Œé‡Šæ”¾é”ï¼Œè¿”å›&lt;code&gt;ACK&lt;/code&gt;&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;é£é™©ç‚¹&lt;/strong&gt;ï¼šè‹¥åè°ƒè€…å‘é€&lt;code&gt;Commit&lt;/code&gt;åå®•æœºï¼Œéƒ¨åˆ†å‚ä¸è€…æäº¤æˆåŠŸï¼Œéƒ¨åˆ†æœªæ”¶åˆ°æŒ‡ä»¤ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼ˆè„‘è£‚é—®é¢˜ï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h4 id="-æ ¸å¿ƒé—®é¢˜ä¸ç¼ºé™·"&gt;âš ï¸ &lt;strong&gt;æ ¸å¿ƒé—®é¢˜ä¸ç¼ºé™·&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥é˜»å¡ï¼ˆæ€§èƒ½ç“¶é¢ˆï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å‚ä¸è€…ç­‰å¾…åè°ƒè€…æŒ‡ä»¤æ—¶&lt;strong&gt;é•¿æœŸå ç”¨é”èµ„æº&lt;/strong&gt;ï¼Œé«˜å¹¶å‘ä¸‹æ˜“å¼•å‘æ­»é”å’Œååé‡ä¸‹é™&lt;a class="link" href="@ref" &gt;1,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•ç‚¹æ•…éšœï¼ˆåè°ƒè€…å®•æœºï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åè°ƒè€…å®•æœºåï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡†å¤‡é˜¶æ®µ&lt;/strong&gt;ï¼šå‚ä¸è€…é˜»å¡ï¼Œäº‹åŠ¡æŒ‚èµ·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æäº¤é˜¶æ®µ&lt;/strong&gt;ï¼šéƒ¨åˆ†å‚ä¸è€…æäº¤ï¼Œéƒ¨åˆ†æœªæ”¶åˆ°æŒ‡ä»¤ï¼Œæ•°æ®ä¸ä¸€è‡´&lt;a class="link" href="@ref" &gt;2,4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸ä¸€è‡´é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œåˆ†åŒº&lt;/strong&gt;ï¼šéƒ¨åˆ†å‚ä¸è€…æ”¶ä¸åˆ°æŒ‡ä»¤ï¼Œå¯èƒ½è‡ªè¡Œæäº¤æˆ–å›æ»š&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æç«¯åœºæ™¯&lt;/strong&gt;ï¼šåè°ƒè€…ä¸å‚ä¸è€…åœ¨æäº¤é˜¶æ®µåŒæ—¶å®•æœºï¼Œäº‹åŠ¡çŠ¶æ€ä¸¢å¤±ï¼ˆæ— æœ€ç»ˆå†³ç­–ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— å®¹é”™æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å‚ä¸è€…æ•…éšœåï¼Œåè°ƒè€…åªèƒ½ç­‰å¾…è¶…æ—¶ï¼Œæ— æ³•ä¸»åŠ¨æ¢å¤&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="-2pc-ä¼˜ç¼ºç‚¹å¯¹æ¯”"&gt;ğŸ“Š &lt;strong&gt;2PC ä¼˜ç¼ºç‚¹å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å¼ºä¸€è‡´ï¼ˆåŸå­æ€§ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ç½‘ç»œåˆ†åŒºæ—¶å¯èƒ½è„‘è£‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;âŒ é«˜å»¶è¿Ÿï¼ˆä¸¤è½®é€šä¿¡+é˜»å¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯ç”¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;âŒ å•ç‚¹æ•…éšœï¼ˆåè°ƒè€…å®•æœºé˜»å¡å…¨å±€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… é€»è¾‘ç®€å•ï¼Œæ˜“äºç†è§£&lt;/td&gt;
&lt;td&gt;âŒ å®¹é”™æœºåˆ¶ç¼ºå¤±ï¼Œæ¢å¤å¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h4 id="-ä¼˜åŒ–ä¸æ”¹è¿›æ–¹æ¡ˆ"&gt;ğŸ› ï¸ &lt;strong&gt;ä¼˜åŒ–ä¸æ”¹è¿›æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³å•ç‚¹æ•…éšœ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åè°ƒè€…å†—ä½™&lt;/strong&gt;ï¼šä¸»å¤‡åè°ƒè€…+æ—¥å¿—åŒæ­¥ï¼Œä¸»èŠ‚ç‚¹å®•æœºåå¤‡èŠ‚ç‚¹æ¥ç®¡&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æœºåˆ¶&lt;/strong&gt;ï¼šå‚ä¸è€…ç­‰å¾…è¶…æ—¶åï¼Œä¸»åŠ¨æŸ¥è¯¢åè°ƒè€…çŠ¶æ€æˆ–å‘èµ·é€‰ä¸¾&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘é˜»å¡ä¸æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥æäº¤&lt;/strong&gt;ï¼šå‚ä¸è€…æäº¤åå¼‚æ­¥é‡Šæ”¾èµ„æºï¼Œå‡å°‘é”å ç”¨æ—¶é—´&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡å¤„ç†&lt;/strong&gt;ï¼šåˆå¹¶å¤šä¸ªäº‹åŠ¡çš„&lt;code&gt;Prepare&lt;/code&gt;è¯·æ±‚ï¼Œå‡å°‘ç½‘ç»œå¾€è¿”&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢å¼ºå®¹é”™æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸‰é˜¶æ®µæäº¤ï¼ˆ3PCï¼‰&lt;/strong&gt;ï¼šå¢åŠ &lt;code&gt;Pre-Commit&lt;/code&gt;é˜¶æ®µï¼Œå‚ä¸è€…è¶…æ—¶åé»˜è®¤æäº¤ï¼ˆé™ä½é˜»å¡é£é™©ï¼Œä½†å¯èƒ½åŠ å‰§ä¸ä¸€è‡´ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“åˆæ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt;ï¼šç”¨MQè®°å½•äº‹åŠ¡çŠ¶æ€ï¼Œæ•…éšœåé€šè¿‡è¡¥å¿æœºåˆ¶ä¿®å¤ï¼ˆå¦‚Sagaæ¨¡å¼ï¼‰&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h4 id="-å®é™…åº”ç”¨åœºæ™¯"&gt;ğŸ’» &lt;strong&gt;å®é™…åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“é›†ç¾¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;MySQLé›†ç¾¤ä¸­è·¨èŠ‚ç‚¹æ›´æ–°ï¼šé€šè¿‡XAæ¥å£å®ç°2PCï¼ˆå¦‚&lt;code&gt;XA START&lt;/code&gt;/&lt;code&gt;XA END&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šé“¶è¡Œè½¬è´¦ï¼ˆè´¦æˆ·Aæ‰£æ¬¾ â†’ è´¦æˆ·BåŠ æ¬¾ï¼‰éœ€å¼ºä¸€è‡´&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¾®æœåŠ¡æ¶æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”µå•†ä¸‹å•æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åè°ƒè€…&lt;/strong&gt;ï¼šè®¢å•æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚ä¸è€…&lt;/strong&gt;ï¼šåº“å­˜æœåŠ¡ï¼ˆæ‰£åº“å­˜ï¼‰ã€æ”¯ä»˜æœåŠ¡ï¼ˆæ‰£æ¬¾ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®ç°ï¼šé€šè¿‡Seataç­‰æ¡†æ¶å°è£…2PCé€»è¾‘&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ··åˆæ–¹æ¡ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;2PC + TCC&lt;/strong&gt;ï¼šå¼ºä¸€è‡´æ“ä½œç”¨2PCï¼Œé«˜å¹¶å‘æ“ä½œç”¨TCCï¼ˆå¦‚åº“å­˜å†»ç»“ï¼‰&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h4 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼š2PCé€šè¿‡ä¸¤é˜¶æ®µæäº¤å®ç°äº†åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸå­æ€§ï¼Œæ˜¯é‡‘èã€è®¢å•ç­‰å¼ºä¸€è‡´åœºæ™¯çš„åŸºçŸ³&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨è¾¹ç•Œ&lt;/strong&gt;ï¼šé€‚ç”¨äºèŠ‚ç‚¹å°‘ã€ç½‘ç»œç¨³å®šã€å¯¹ä¸€è‡´æ€§è¦æ±‚é«˜äºå¯ç”¨æ€§çš„åœºæ™¯&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼”è¿›æ–¹å‘&lt;/strong&gt;ï¼šå·¥ä¸šç•Œé€æ¸è½¬å‘&lt;strong&gt;æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ&lt;/strong&gt;ï¼ˆå¦‚Sagaã€æ¶ˆæ¯é˜Ÿåˆ—ï¼‰æˆ–&lt;strong&gt;æ··åˆäº‹åŠ¡æ¨¡å‹&lt;/strong&gt;ï¼ˆå¦‚2PC+TCCï¼‰ï¼Œä»¥å¹³è¡¡æ€§èƒ½ä¸ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;1,7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ¶æ„å»ºè®®&lt;/strong&gt;ï¼šè‹¥éœ€å¼ºä¸€è‡´ï¼Œä¼˜å…ˆä½¿ç”¨æˆç†Ÿæ¡†æ¶ï¼ˆå¦‚Seataçš„XAæ¨¡å¼ï¼‰ï¼›è‹¥å®¹å¿æœ€ç»ˆä¸€è‡´ï¼Œé€‰ç”¨Sagaæˆ–å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—é™ä½å¤æ‚åº¦ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="tcc"&gt;TCC
&lt;/h2&gt;&lt;p&gt;TCCï¼ˆTry-Confirm-Cancelï¼‰æ˜¯ä¸€ç§åŸºäº&lt;strong&gt;ä¸šåŠ¡è¡¥å¿&lt;/strong&gt;çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡å°†äº‹åŠ¡æ‹†åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼ˆTryã€Confirmã€Cancelï¼‰å®ç°æœ€ç»ˆä¸€è‡´æ€§ï¼Œé€‚ç”¨äºé«˜å¹¶å‘åœºæ™¯ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€å®ç°ç»†èŠ‚åˆ°å·¥ä¸šå®è·µå±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸è®¾è®¡æ€æƒ³"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸è®¾è®¡æ€æƒ³&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸‰é˜¶æ®µæ‹†åˆ†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Tryï¼ˆå°è¯•ï¼‰&lt;/strong&gt;ï¼šä¸šåŠ¡æ£€æŸ¥ä¸èµ„æºé¢„ç•™ï¼ˆå¦‚æ£€æŸ¥åº“å­˜ã€å†»ç»“èµ„é‡‘ï¼‰ï¼Œ&lt;strong&gt;ä¸æ‰§è¡ŒçœŸå®æ“ä½œ&lt;/strong&gt;ï¼Œä»…é”å®šèµ„æºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Confirmï¼ˆç¡®è®¤ï¼‰&lt;/strong&gt;ï¼šåŸºäºTryé¢„ç•™çš„èµ„æºæ‰§è¡Œä¸šåŠ¡æäº¤ï¼ˆå¦‚æ‰£å‡åº“å­˜ã€å®é™…æ‰£æ¬¾ï¼‰ï¼Œéœ€&lt;strong&gt;å¹‚ç­‰è®¾è®¡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cancelï¼ˆå–æ¶ˆï¼‰&lt;/strong&gt;ï¼šé‡Šæ”¾Tryé˜¶æ®µé¢„ç•™çš„èµ„æºï¼ˆå¦‚è§£å†»èµ„é‡‘ã€é‡Šæ”¾åº“å­˜ï¼‰ï¼Œéœ€&lt;strong&gt;å¹‚ç­‰ä¸”å¯ç©ºå›æ»š&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;3,5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸2PCçš„æœ¬è´¨åŒºåˆ«&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºé”å®šç²’åº¦&lt;/strong&gt;ï¼š2PCåœ¨æ•°æ®åº“å±‚é¢é”èµ„æºï¼ˆå¦‚è¡Œé”ï¼‰ï¼ŒTCCåœ¨ä¸šåŠ¡å±‚é¢é€šè¿‡é¢„ç•™å­—æ®µï¼ˆå¦‚&lt;code&gt;å†»ç»“åº“å­˜&lt;/code&gt;ï¼‰æ§åˆ¶ï¼Œå‡å°‘é”å†²çª&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŠ¿&lt;/strong&gt;ï¼šTryé˜¶æ®µå¿«é€Ÿé¢„ç•™èµ„æºï¼ŒConfirm/Cancelå¼‚æ­¥æäº¤ï¼Œé¿å…é•¿äº‹åŠ¡é˜»å¡&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§æ¨¡å‹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆä¸€è‡´æ€§&lt;/strong&gt;ï¼šConfirm/Cancelé˜¶æ®µå¯èƒ½çŸ­æš‚ä¸ä¸€è‡´ï¼ˆå¦‚éƒ¨åˆ†ConfirmæˆåŠŸï¼‰ï¼Œä½†æœ€ç»ˆé€šè¿‡é‡è¯•æˆ–è¡¥å¿è¾¾æˆä¸€è‡´&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ-1"&gt;âš ï¸ &lt;strong&gt;å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;TCCéœ€è§£å†³ä¸‰ç±»å¼‚å¸¸åœºæ™¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºå›æ»šï¼ˆNull Rollbackï¼‰&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šæœªæ‰§è¡ŒTryå´è§¦å‘Cancelï¼ˆå¦‚Tryè°ƒç”¨å‰æœåŠ¡å®•æœºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šè®°å½•åˆ†æ”¯äº‹åŠ¡çŠ¶æ€è¡¨ï¼ŒCancelå‰æ£€æŸ¥Tryæ˜¯å¦æ‰§è¡Œã€‚è‹¥æœªæ‰§è¡Œï¼Œç›´æ¥è¿”å›æˆåŠŸ&lt;a class="link" href="@ref" &gt;3,5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰æ€§ï¼ˆIdempotencyï¼‰&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šç½‘ç»œé‡è¯•å¯¼è‡´Confirm/Cancelé‡å¤è°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šæ¥å£è®¾è®¡éœ€å¹‚ç­‰ï¼ˆå¦‚é€šè¿‡äº‹åŠ¡ID+çŠ¶æ€æœºåˆ¤æ–­ï¼‰ï¼Œç¡®ä¿å¤šæ¬¡è°ƒç”¨ç»“æœä¸€è‡´&lt;a class="link" href="@ref" &gt;3,7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‚¬æŒ‚ï¼ˆHangingï¼‰&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šCancelå…ˆäºTryæ‰§è¡Œï¼ˆå¦‚Tryç½‘ç»œå»¶è¿Ÿï¼‰ï¼Œå¯¼è‡´é¢„ç•™èµ„æºæ— æ³•é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šæ‰§è¡ŒTryå‰æ£€æŸ¥å…¨å±€äº‹åŠ¡çŠ¶æ€ï¼Œè‹¥å·²è¿›å…¥Cancelé˜¶æ®µåˆ™æ‹’ç»æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;3,5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°æ­¥éª¤ä¸ä»£ç ç¤ºä¾‹"&gt;ğŸ› ï¸ &lt;strong&gt;å®ç°æ­¥éª¤ä¸ä»£ç ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä»¥ç”µå•†ä¸‹å•ä¸ºä¾‹ï¼ˆè®¢å•+åº“å­˜+è´¦æˆ·æœåŠ¡ï¼‰ï¼š&lt;/p&gt;
&lt;h4 id="tryé˜¶æ®µèµ„æºé¢„ç•™"&gt;&lt;strong&gt;Tryé˜¶æ®µï¼šèµ„æºé¢„ç•™&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// åº“å­˜æœåŠ¡Try
public boolean reserveInventory(String productId, int quantity) {
// æ£€æŸ¥å¯ç”¨åº“å­˜ï¼šæ€»åº“å­˜ - å†»ç»“åº“å­˜ â‰¥ éœ€æ±‚
if (availableStock &amp;gt;= quantity) {
availableStock -= quantity; // æ‰£å‡å¯ç”¨åº“å­˜
frozenStock += quantity; // å¢åŠ å†»ç»“åº“å­˜
return true;
}
return false;
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®&lt;/strong&gt;ï¼šæ›´æ–°&lt;code&gt;å†»ç»“åº“å­˜&lt;/code&gt;å­—æ®µï¼Œä¸å®é™…æ‰£å‡&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="confirmé˜¶æ®µçœŸå®æäº¤"&gt;&lt;strong&gt;Confirmé˜¶æ®µï¼šçœŸå®æäº¤&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// åº“å­˜æœåŠ¡Confirm
public boolean commitInventory(String productId, int quantity) {
// å¹‚ç­‰æ£€æŸ¥ï¼šè‹¥å·²æäº¤åˆ™è·³è¿‡
if (frozenStock &amp;gt;= quantity) {
frozenStock -= quantity; // é‡Šæ”¾å†»ç»“åº“å­˜
return true;
}
return false;
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="cancelé˜¶æ®µèµ„æºé‡Šæ”¾"&gt;&lt;strong&gt;Cancelé˜¶æ®µï¼šèµ„æºé‡Šæ”¾&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// åº“å­˜æœåŠ¡Cancel
public boolean releaseInventory(String productId, int quantity) {
// ç©ºå›æ»šå¤„ç†ï¼šè‹¥æœªæ‰§è¡ŒTryï¼Œç›´æ¥è¿”å›
if (frozenStock == 0) return true;
// é‡Šæ”¾å†»ç»“èµ„æº
availableStock += quantity;
frozenStock -= quantity;
return true;
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šéœ€ç»“åˆå…¨å±€äº‹åŠ¡IDå®ç°å¹‚ç­‰å’Œç©ºå›æ»šåˆ¤æ–­&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-tcc-vs-2pc-å¯¹æ¯”"&gt;ğŸ“Š &lt;strong&gt;TCC vs 2PC å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;TCC&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;2PC&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå¼‚æ­¥æäº¤ï¼Œæ— é•¿é”ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆåŒæ­¥é˜»å¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾µå…¥æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆéœ€ä¸šåŠ¡æ”¹é€ ä¸‰ä¸ªæ¥å£ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆä¾èµ–æ•°æ®åº“XAåè®®ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºé”å®š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡å±‚æ§åˆ¶ï¼ˆå¦‚å†»ç»“å­—æ®µï¼‰&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“å±‚é”ï¼ˆè¡Œé”/è¡¨é”ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ï¼ˆç”µå•†ã€æ”¯ä»˜ï¼‰&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´éœ€æ±‚ï¼ˆé“¶è¡Œè½¬è´¦ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä¸šçº§å®ç°æ¡†æ¶seata"&gt;ğŸ­ &lt;strong&gt;å·¥ä¸šçº§å®ç°æ¡†æ¶ï¼ˆSeataï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Seataçš„TCCæ¨¡å¼æä¾›å®Œæ•´è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ³¨è§£é©±åŠ¨å¼€å‘&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@LocalTCC
public interface InventoryService {
@TwoPhaseBusinessAction(name = &amp;#34;reserve&amp;#34;, commitMethod = &amp;#34;commit&amp;#34;, rollbackMethod = &amp;#34;cancel&amp;#34;)
boolean reserve(BusinessActionContext ctx, String productId, int quantity);
boolean commit(BusinessActionContext ctx);
boolean cancel(BusinessActionContext ctx);
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;é€šè¿‡&lt;code&gt;@TwoPhaseBusinessAction&lt;/code&gt;è‡ªåŠ¨ç®¡ç†äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸ&lt;a class="link" href="@ref" &gt;11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡åè°ƒæœºåˆ¶&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;TMï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰&lt;/strong&gt;ï¼šç”Ÿæˆå…¨å±€äº‹åŠ¡IDï¼ˆXIDï¼‰ï¼Œåè°ƒTry/Confirm/Cancelè°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TCï¼ˆäº‹åŠ¡åè°ƒå™¨ï¼‰&lt;/strong&gt;ï¼šæŒä¹…åŒ–äº‹åŠ¡çŠ¶æ€ï¼Œæ”¯æŒé‡è¯•ä¸æ•…éšœæ¢å¤&lt;a class="link" href="@ref" &gt;8,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨è®¾è®¡&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;TCé›†ç¾¤åŒ–éƒ¨ç½²ï¼Œé€šè¿‡Raftåè®®é€‰ä¸»ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡æ—¥å¿—å­˜å‚¨æ”¯æŒMySQLã€Redisç­‰&lt;a class="link" href="@ref" &gt;11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯-1"&gt;ğŸ’¼ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”µå•†ä¸‹å•&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Tryï¼šå†»ç»“åº“å­˜ã€æ ¡éªŒè´¦æˆ·ä½™é¢ã€‚&lt;/li&gt;
&lt;li&gt;Confirmï¼šæ‰£å‡åº“å­˜ã€å®é™…æ‰£æ¬¾ã€‚&lt;/li&gt;
&lt;li&gt;Cancelï¼šé‡Šæ”¾åº“å­˜ã€è§£å†»èµ„é‡‘&lt;a class="link" href="@ref" &gt;1,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡‘èè½¬è´¦&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Tryï¼šå†»ç»“è½¬å‡ºè´¦æˆ·èµ„é‡‘ã€‚&lt;/li&gt;
&lt;li&gt;Confirmï¼šå®é™…è½¬è´¦ï¼ˆè½¬å‡ºæ‰£æ¬¾+æ”¶æ¬¾å…¥è´¦ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Cancelï¼šè§£å†»èµ„é‡‘&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¥¨åŠ¡é¢„è®¢&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Tryï¼šé”å®šåº§ä½ã€ç”Ÿæˆé¢„è®¢å•ã€‚&lt;/li&gt;
&lt;li&gt;Confirmï¼šç¡®è®¤å‡ºç¥¨ã€‚&lt;/li&gt;
&lt;li&gt;Cancelï¼šé‡Šæ”¾åº§ä½&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å±€é™æ€§åŠåº”å¯¹"&gt;âš ï¸ &lt;strong&gt;å±€é™æ€§åŠåº”å¯¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼€å‘æˆæœ¬é«˜&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªæœåŠ¡éœ€å®ç°ä¸‰ä¸ªæ¥å£ï¼Œä»£ç é‡å¢åŠ 200%&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–&lt;/strong&gt;ï¼šä½¿ç”¨Seataç­‰æ¡†æ¶å‡å°‘æ¨¡æ¿ä»£ç &lt;a class="link" href="@ref" &gt;11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡åœºæ™¯é™åˆ¶&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ— æ³•é¢„ç•™èµ„æºçš„åœºæ™¯ï¼ˆå¦‚å‘é€çŸ­ä¿¡ï¼‰ä¸é€‚ç”¨TCCï¼Œæ”¹ç”¨SAGAæ¨¡å¼&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡¥å¿å¤æ‚åº¦&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Cancelé€»è¾‘éœ€å®Œå…¨é€†å‘ï¼ˆå¦‚é€€æ¬¾éœ€è€ƒè™‘æ‰‹ç»­è´¹ï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡åŸåˆ™&lt;/strong&gt;ï¼šCancelæ“ä½œå¿…é¡»å¹‚ç­‰ä¸”æ”¯æŒéƒ¨åˆ†å›æ»šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸é€‰å‹å»ºè®®"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ä¸é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘ã€å¯é¢„ç•™èµ„æºçš„ä¸šåŠ¡ï¼ˆæ”¯ä»˜/åº“å­˜ï¼‰ï¼Œ&lt;strong&gt;å®¹å¿æœ€ç»ˆä¸€è‡´&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå¼ºä¸€è‡´éœ€æ±‚ï¼ˆå¦‚é‡‘èæ ¸å¿ƒç³»ç»Ÿï¼‰ã€æ— æ³•é¢„ç•™èµ„æºçš„æ“ä½œï¼ˆå¦‚çŸ­ä¿¡å‘é€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ€ä½³å®è·µï¼š
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨æ¡†æ¶ï¼ˆå¦‚Seataï¼‰é™ä½å¼€å‘æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;å¿…é¡»è§£å†³&lt;strong&gt;ç©ºå›æ»šã€å¹‚ç­‰ã€æ‚¬æŒ‚&lt;/strong&gt;ä¸‰å¤§å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;é…å¥—ç›‘æ§äº‹åŠ¡æ—¥å¿—ä¸å‘Šè­¦ï¼ˆå¦‚Confirmå¤±è´¥ç‡ï¼0.1%éœ€äººå·¥å¹²é¢„ï¼‰&lt;a class="link" href="@ref" &gt;7,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;TCCé€šè¿‡&lt;strong&gt;ä¸šåŠ¡å±‚äº‹åŠ¡æ‹†åˆ†&lt;/strong&gt;ï¼Œä»¥å¼€å‘å¤æ‚æ€§æ¢å–é«˜æ€§èƒ½å’Œé«˜å¯ç”¨ï¼Œæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡ä¸­å¹³è¡¡æ€§èƒ½ä¸ä¸€è‡´æ€§çš„å…¸å‹æ–¹æ¡ˆã€‚å®é™…è½åœ°éœ€ç»“åˆæ¡†æ¶èƒ½åŠ›ä¸ä¸¥æ ¼çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œé¿å…èµ„æºæ³„æ¼ä¸æ•°æ®ä¸ä¸€è‡´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="saga"&gt;SAGA
&lt;/h2&gt;&lt;p&gt;Saga æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºè§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­é•¿äº‹åŠ¡ä¸€è‡´æ€§é—®é¢˜çš„&lt;strong&gt;è¡¥å¿å‹äº‹åŠ¡æ¨¡å¼&lt;/strong&gt;ï¼Œå°¤å…¶é€‚ç”¨äºå¾®æœåŠ¡æ¶æ„ã€‚å®ƒé€šè¿‡å°†å…¨å±€äº‹åŠ¡æ‹†è§£ä¸ºä¸€ç³»åˆ—å¯é€†çš„æœ¬åœ°äº‹åŠ¡ï¼Œå¹¶è®¾è®¡å¯¹åº”çš„è¡¥å¿æ“ä½œï¼Œå®ç°æœ€ç»ˆä¸€è‡´æ€§ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒåŸç†ã€å®ç°æ–¹å¼åŠå®è·µè¦ç‚¹çš„ç³»ç»ŸåŒ–è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸å·¥ä½œæµç¨‹"&gt;ğŸ”„ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡åˆ†è§£&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å°†å…¨å±€äº‹åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ª&lt;strong&gt;æœ¬åœ°äº‹åŠ¡&lt;/strong&gt;ï¼ˆå¦‚è®¢å•åˆ›å»ºã€åº“å­˜æ‰£å‡ã€æ”¯ä»˜æ‰§è¡Œï¼‰ï¼Œæ¯ä¸ªæœ¬åœ°äº‹åŠ¡ç‹¬ç«‹æäº¤åˆ°å„è‡ªçš„æ•°æ®åº“&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªæœ¬åœ°äº‹åŠ¡éœ€é…å¥—ä¸€ä¸ª&lt;strong&gt;è¡¥å¿äº‹åŠ¡&lt;/strong&gt;ï¼ˆå¦‚å–æ¶ˆè®¢å•ã€æ¢å¤åº“å­˜ã€é€€æ¬¾ï¼‰ï¼Œç”¨äºé€†å‘å›æ»šæ“ä½œ&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œæœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­£å‘æµç¨‹&lt;/strong&gt;ï¼šæŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰æœ¬åœ°äº‹åŠ¡ï¼Œè‹¥å…¨éƒ¨æˆåŠŸåˆ™äº‹åŠ¡å®Œæˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡¥å¿æµç¨‹&lt;/strong&gt;ï¼šè‹¥æŸä¸€æœ¬åœ°äº‹åŠ¡å¤±è´¥ï¼Œåˆ™&lt;strong&gt;é€†åºè§¦å‘&lt;/strong&gt;å·²æˆåŠŸæ­¥éª¤çš„è¡¥å¿äº‹åŠ¡ï¼Œå›æ»šè‡³åˆå§‹çŠ¶æ€&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§æ¨¡å‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆä¸€è‡´æ€§&lt;/strong&gt;ï¼šäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å…è®¸çŸ­æš‚ä¸ä¸€è‡´ï¼ˆå¦‚åº“å­˜å·²æ‰£å‡ä½†æ”¯ä»˜æœªå®Œæˆï¼‰ï¼Œé€šè¿‡è¡¥å¿æ“ä½œæœ€ç»ˆè¾¾æˆä¸€è‡´&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— å¼ºéš”ç¦»æ€§&lt;/strong&gt;ï¼šå› æœ¬åœ°äº‹åŠ¡ç‹¬ç«‹æäº¤ï¼Œå¯èƒ½å‘ç”Ÿè„è¯»æˆ–æ›´æ–°ä¸¢å¤±ï¼ˆå¦‚è¡¥å¿æ—¶æ•°æ®å·²è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸¤ç§å®ç°æ–¹å¼å¯¹æ¯”"&gt;âš™ï¸ &lt;strong&gt;ä¸¤ç§å®ç°æ–¹å¼å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç¼–èˆæ¨¡å¼choreography"&gt;&lt;strong&gt;ç¼–èˆæ¨¡å¼ï¼ˆChoreographyï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šæ— ä¸­å¿ƒåè°ƒå™¨ï¼ŒæœåŠ¡é—´é€šè¿‡&lt;strong&gt;äº‹ä»¶/æ¶ˆæ¯&lt;/strong&gt;ï¼ˆå¦‚ Kafkaã€RabbitMQï¼‰è‡ªä¸»è§¦å‘åç»­äº‹åŠ¡&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æµç¨‹ç¤ºä¾‹ï¼š
&lt;ol&gt;
&lt;li&gt;è®¢å•æœåŠ¡åˆ›å»ºè®¢å• â†’ å‘å¸ƒ &lt;code&gt;OrderCreated&lt;/code&gt; äº‹ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;åº“å­˜æœåŠ¡ç›‘å¬äº‹ä»¶ â†’ æ‰£å‡åº“å­˜ â†’ å‘å¸ƒ &lt;code&gt;InventoryDeducted&lt;/code&gt; äº‹ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯ä»˜æœåŠ¡ç›‘å¬äº‹ä»¶ â†’ æ‰§è¡Œæ‰£æ¬¾ â†’ æˆåŠŸæˆ–å‘å¸ƒå¤±è´¥äº‹ä»¶è§¦å‘è¡¥å¿&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ— å•ç‚¹æ•…éšœã€æœåŠ¡è§£è€¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæµç¨‹å¤æ‚éš¾è¿½è¸ªï¼Œå¾ªç¯ä¾èµ–é£é™©é«˜&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç¼–æ’æ¨¡å¼orchestration"&gt;&lt;strong&gt;ç¼–æ’æ¨¡å¼ï¼ˆOrchestrationï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šç”±&lt;strong&gt;ä¸­å¿ƒåè°ƒå™¨&lt;/strong&gt;ï¼ˆå¦‚ Seataã€Temporalï¼‰ç»Ÿä¸€è°ƒåº¦äº‹åŠ¡åºåˆ—ï¼Œç®¡ç†çŠ¶æ€ä¸è¡¥å¿é€»è¾‘&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æµç¨‹ç¤ºä¾‹ï¼š
&lt;ol&gt;
&lt;li&gt;åè°ƒå™¨è°ƒç”¨è®¢å•æœåŠ¡ â†’ æˆåŠŸåˆ™è°ƒç”¨åº“å­˜æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;åº“å­˜æœåŠ¡å¤±è´¥ â†’ åè°ƒå™¨é€†åºè§¦å‘è®¢å•æœåŠ¡çš„è¡¥å¿æ“ä½œ&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæµç¨‹å¯è§†åŒ–ã€æ˜“æ‰©å±•ï¼Œé¿å…å¾ªç¯ä¾èµ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šåè°ƒå™¨å•ç‚¹æ•…éšœé£é™©ï¼Œéœ€é¢å¤–ç»´æŠ¤&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-ç¼–èˆ-vs-ç¼–æ’é€‚ç”¨åœºæ™¯"&gt;ğŸ“Š &lt;strong&gt;ç¼–èˆ vs ç¼–æ’é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼–èˆæ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼–æ’æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆç®€å•æµç¨‹ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå¤æ‚æµç¨‹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯ç»´æŠ¤æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éš¾ï¼ˆæµç¨‹åˆ†æ•£ï¼‰&lt;/td&gt;
&lt;td&gt;æ˜“ï¼ˆé›†ä¸­ç®¡ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•…éšœç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— å•ç‚¹æ•…éšœ&lt;/td&gt;
&lt;td&gt;åè°ƒå™¨å¯èƒ½æ•…éšœ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœåŠ¡å°‘ã€é€»è¾‘ç®€å•ï¼ˆ&amp;lt;5ä¸ªï¼‰&lt;/td&gt;
&lt;td&gt;é•¿æµç¨‹ã€å¤šæœåŠ¡ååŒï¼ˆå¦‚ç”µå•†è®¢å•ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é—®é¢˜ä¸è§£å†³ç­–ç•¥"&gt;âš ï¸ &lt;strong&gt;å…³é”®é—®é¢˜ä¸è§£å†³ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å¼‚å¸¸&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è„è¯»&lt;/strong&gt;ï¼šäº‹åŠ¡Aæœªå®Œæˆæ—¶ï¼Œäº‹åŠ¡Bè¯»å–ä¸­é—´çŠ¶æ€ï¼ˆå¦‚åº“å­˜å†»ç»“ä½†æœªæ‰£å‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯­ä¹‰é”&lt;/strong&gt;ï¼šä¸šåŠ¡å±‚æ ‡è®°æ•°æ®çŠ¶æ€ï¼ˆå¦‚ &lt;code&gt;status = &amp;quot;FREEZING&amp;quot;&lt;/code&gt;ï¼‰ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡æ“ä½œ&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‚²è§‚è§†å›¾&lt;/strong&gt;ï¼šè°ƒæ•´äº‹åŠ¡é¡ºåºï¼Œå°†æ•æ„Ÿæ“ä½œåç½®&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡¥å¿å¤±è´¥é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è¡¥å¿æ“ä½œè‡ªèº«å¤±è´¥ï¼ˆå¦‚é€€æ¬¾æ¥å£è¶…æ—¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é‡è¯•æœºåˆ¶&lt;/strong&gt;ï¼šæŒ‡æ•°é€€é¿é‡è¯• + æ­»ä¿¡é˜Ÿåˆ—å…œåº•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äººå·¥å¹²é¢„&lt;/strong&gt;ï¼šæ—¥å¿—å‘Šè­¦ + äººå·¥ä¿®å¤&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‚¬æŒ‚ä¸ç©ºè¡¥å¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç©ºè¡¥å¿&lt;/strong&gt;ï¼šæœªæ‰§è¡Œæ­£å‘æ“ä½œå´è§¦å‘è¡¥å¿ï¼ˆå¦‚ç½‘ç»œè¶…æ—¶å¯¼è‡´è¯¯å›æ»šï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‚¬æŒ‚&lt;/strong&gt;ï¼šè¡¥å¿å…ˆäºæ­£å‘æ“ä½œåˆ°è¾¾ï¼ˆå¦‚æ­£å‘è°ƒç”¨å»¶è¿Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡çŠ¶æ€è¡¨&lt;/strong&gt;ï¼šè®°å½•äº‹åŠ¡IDä¸çŠ¶æ€ï¼Œè¡¥å¿å‰æ ¡éªŒæ˜¯å¦éœ€æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰è®¾è®¡&lt;/strong&gt;ï¼šè¡¥å¿æ“ä½œæ”¯æŒå¤šæ¬¡è°ƒç”¨ï¼ˆå¦‚é€šè¿‡äº‹åŠ¡IDå»é‡ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä¸šçº§å®ç°æ¡†æ¶ä»¥-seata-ä¸ºä¾‹"&gt;ğŸ­ &lt;strong&gt;å·¥ä¸šçº§å®ç°æ¡†æ¶ï¼ˆä»¥ Seata ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€æœºå¼•æ“&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ JSON å®šä¹‰äº‹åŠ¡æµç¨‹ï¼Œæ˜ç¡®æ­£å‘æ“ä½œä¸è¡¥å¿é€»è¾‘çš„æ˜ å°„å…³ç³»
7ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;{
&amp;#34;Name&amp;#34;: &amp;#34;OrderSaga&amp;#34;,
&amp;#34;States&amp;#34;: [
{ &amp;#34;Name&amp;#34;: &amp;#34;CreateOrder&amp;#34;, &amp;#34;Compensate&amp;#34;: &amp;#34;CancelOrder&amp;#34; },
{ &amp;#34;Name&amp;#34;: &amp;#34;DeductInventory&amp;#34;, &amp;#34;Compensate&amp;#34;: &amp;#34;RestoreInventory&amp;#34; }
]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œæµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;åè°ƒå™¨é©±åŠ¨çŠ¶æ€æœº â†’ è°ƒç”¨æœåŠ¡ â†’ å¤±è´¥æ—¶è§¦å‘è¡¥å¿é“¾&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;TCï¼ˆäº‹åŠ¡åè°ƒå™¨ï¼‰é›†ç¾¤åŒ–&lt;/strong&gt;ï¼šåŸºäº Raft åè®®é€‰ä¸»ï¼Œé¿å…å•ç‚¹æ•…éšœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æ—¥å¿—æŒä¹…åŒ–&lt;/strong&gt;ï¼šè®°å½•æ“ä½œçŠ¶æ€ï¼Œæ•…éšœåå¯æ¢å¤&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯-2"&gt;ğŸ›’ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”µå•†è®¢å•æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ­¥éª¤ï¼šåˆ›å»ºè®¢å• â†’ æ‰£åº“å­˜ â†’ æ”¯ä»˜ â†’ å‘è´§ã€‚&lt;/li&gt;
&lt;li&gt;è¡¥å¿ï¼šæ”¯ä»˜å¤±è´¥ â†’ æ¢å¤åº“å­˜ â†’ å–æ¶ˆè®¢å•&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨è¡Œè½¬è´¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ­¥éª¤ï¼šè½¬å‡ºè¡Œæ‰£æ¬¾ â†’ è½¬å…¥è¡ŒåŠ æ¬¾ã€‚&lt;/li&gt;
&lt;li&gt;è¡¥å¿ï¼šåŠ æ¬¾å¤±è´¥ â†’ è½¬å‡ºè¡Œé€€æ¬¾&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—…è¡Œé¢„è®¢&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ­¥éª¤ï¼šè®¢æœºç¥¨ â†’ è®¢é…’åº— â†’ ç§Ÿè½¦ã€‚&lt;/li&gt;
&lt;li&gt;è¡¥å¿ï¼šç§Ÿè½¦å¤±è´¥ â†’ é€€é…’åº— â†’ é€€æœºç¥¨&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-saga-ä¸å…¶ä»–äº‹åŠ¡æ¨¡å¼å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;Saga ä¸å…¶ä»–äº‹åŠ¡æ¨¡å¼å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¾µå…¥æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Saga&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;é•¿æµç¨‹ã€è·¨æœåŠ¡ï¼ˆè®¢å•/ç‰©æµï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;2PC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;çŸ­äº‹åŠ¡ã€å¼ºä¸€è‡´ï¼ˆé“¶è¡Œè½¬è´¦ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;TCC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ç§’æ€ï¼ˆåº“å­˜å†»ç»“ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æœ€ä½³å®è·µä¸é€‰å‹å»ºè®®"&gt;ğŸ’ &lt;strong&gt;æœ€ä½³å®è·µä¸é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è®¾è®¡åŸåˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡å¯é€†æ€§&lt;/strong&gt;ï¼šç¡®ä¿è¡¥å¿æ“ä½œé€»è¾‘å®Œå¤‡ï¼ˆå¦‚é€€æ¬¾éœ€å«æ‰‹ç»­è´¹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;ï¼šè®¾ç½®äº‹åŠ¡è¶…æ—¶é˜ˆå€¼ï¼Œé¿å…èµ„æºé•¿æœŸå ç”¨&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€‰å‹åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆ &lt;strong&gt;Saga&lt;/strong&gt;ï¼šè·¨æœåŠ¡é•¿æµç¨‹ã€å¯¹ä¸€è‡´æ€§å»¶è¿Ÿå®¹å¿é«˜ï¼ˆå¦‚ç”µå•†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é¿å… &lt;strong&gt;Saga&lt;/strong&gt;ï¼šéœ€å¼ºéš”ç¦»æ€§ï¼ˆå¦‚é‡‘èæ ¸å¿ƒè´¦åŠ¡ï¼‰æˆ–æ— æ³•è®¾è®¡è¡¥å¿çš„åœºæ™¯ï¼ˆå¦‚çŸ­ä¿¡å‘é€ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®¹ç¾å…œåº•ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§&lt;/strong&gt;ï¼šè·Ÿè¸ªäº‹åŠ¡æˆåŠŸ/è¡¥å¿ç‡ï¼ˆå¦‚ Prometheus + Grafanaï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è´¦ç³»ç»Ÿ&lt;/strong&gt;ï¼šå®šæœŸæ ¡éªŒä¸šåŠ¡æ•°æ®ä¸€è‡´æ€§ï¼ˆå¦‚è®¢å•ä¸åº“å­˜çŠ¶æ€ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼šSaga æ¨¡å¼ä»¥&lt;strong&gt;ä¸šåŠ¡é€»è¾‘è¡¥å¿&lt;/strong&gt;æ›¿ä»£æ•°æ®åº“é”ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¹³è¡¡äº†ä¸€è‡´æ€§ä¸æ€§èƒ½ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;æµç¨‹ç¼–æ’çµæ´»æ€§&lt;/strong&gt;ä¸&lt;strong&gt;æœ€ç»ˆå¯é æ€§&lt;/strong&gt;ï¼Œé€‚ç”¨äºå¤šæ•°å¼‚æ­¥è§£è€¦åœºæ™¯ã€‚å·¥ä¸šè½åœ°æ—¶ï¼Œå»ºè®®ç»“åˆ Seata ç­‰æ¡†æ¶é™ä½å¤æ‚åº¦ï¼Œå¹¶é€šè¿‡å¹‚ç­‰æ€§ã€ç›‘æ§å‘Šè­¦å¼ºåŒ–é²æ£’æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="seata"&gt;seata
&lt;/h2&gt;&lt;p&gt;Seataï¼ˆSimple Extensible Autonomous Transaction Architectureï¼‰æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œè‡´åŠ›äºåœ¨å¾®æœåŠ¡æ¶æ„ä¸‹æä¾›&lt;strong&gt;é«˜æ€§èƒ½ã€æ˜“ç”¨ä¸”å¤šæ¨¡å¼å…¼å®¹&lt;/strong&gt;çš„äº‹åŠ¡æœåŠ¡ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæ¶æ„ã€äº‹åŠ¡æ¨¡å¼ã€å·¥ä½œåŸç†åˆ°å®è·µåº”ç”¨å±•å¼€ç³»ç»Ÿè§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¶æ„tctmrm-ååŒæ¨¡å‹"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒæ¶æ„ï¼šTC/TM/RM ååŒæ¨¡å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Seata çš„æ ¸å¿ƒæ¶æ„å›´ç»•ä¸‰ä¸ªè§’è‰²æ„å»ºï¼Œå®ç°å…¨å±€äº‹åŠ¡ä¸åˆ†æ”¯äº‹åŠ¡çš„åä½œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;TC (Transaction Coordinator)&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èŒè´£&lt;/strong&gt;ï¼šäº‹åŠ¡åè°ƒå™¨ï¼ˆç‹¬ç«‹éƒ¨ç½²ï¼‰ï¼Œç»´æŠ¤å…¨å±€äº‹åŠ¡çŠ¶æ€ï¼ˆæäº¤/å›æ»šï¼‰ï¼Œè°ƒåº¦åˆ†æ”¯äº‹åŠ¡çš„æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®èƒ½åŠ›&lt;/strong&gt;ï¼šé«˜å¯ç”¨é›†ç¾¤éƒ¨ç½²ï¼ˆå¦‚åŸºäºNacosæ³¨å†Œä¸­å¿ƒï¼‰ï¼Œäº‹åŠ¡æ—¥å¿—æŒä¹…åŒ–ï¼ˆæ”¯æŒDBã€Redisç­‰ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TM (Transaction Manager)&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èŒè´£&lt;/strong&gt;ï¼šäº‹åŠ¡ç®¡ç†å™¨ï¼ˆé›†æˆåœ¨åº”ç”¨ï¼‰ï¼Œå®šä¹‰å…¨å±€äº‹åŠ¡è¾¹ç•Œï¼Œé€šè¿‡æ³¨è§£ &lt;code&gt;@GlobalTransactional&lt;/code&gt; å¼€å¯äº‹åŠ¡ï¼Œå¹¶æœ€ç»ˆå‘TCå‘èµ·æäº¤æˆ–å›æ»šå†³è®®&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RM (Resource Manager)&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èŒè´£&lt;/strong&gt;ï¼šèµ„æºç®¡ç†å™¨ï¼ˆé›†æˆåœ¨åº”ç”¨ï¼‰ï¼Œç®¡ç†åˆ†æ”¯äº‹åŠ¡èµ„æºï¼ˆå¦‚æ•°æ®åº“ï¼‰ï¼Œæ‰§è¡Œæœ¬åœ°äº‹åŠ¡å¹¶å‘TCæ³¨å†Œ/ä¸ŠæŠ¥çŠ¶æ€&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;ï¼šåœ¨ATæ¨¡å¼ä¸‹è‡ªåŠ¨ç”Ÿæˆå›æ»šæ—¥å¿—ï¼ˆ&lt;code&gt;undo_log&lt;/code&gt;ï¼‰ï¼Œåœ¨TCCæ¨¡å¼ä¸‹æ‰§è¡Œä¸šåŠ¡è¡¥å¿é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;åä½œæµç¨‹&lt;/strong&gt;ï¼š
TM å¼€å¯å…¨å±€äº‹åŠ¡ â†’ ç”Ÿæˆå”¯ä¸€XID â†’ XIDé€ä¼ è‡³è°ƒç”¨é“¾ â†’ RM æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ â†’ TC ç»Ÿä¸€è°ƒåº¦æäº¤/å›æ»š&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å››å¤§äº‹åŠ¡æ¨¡å¼è¯¦è§£"&gt;âš™ï¸ &lt;strong&gt;å››å¤§äº‹åŠ¡æ¨¡å¼è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="atæ¨¡å¼è‡ªåŠ¨è¡¥å¿é»˜è®¤æ¨¡å¼"&gt;&lt;strong&gt;ATæ¨¡å¼ï¼ˆè‡ªåŠ¨è¡¥å¿ï¼Œé»˜è®¤æ¨¡å¼ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸€é˜¶æ®µ&lt;/strong&gt;ï¼šä¸šåŠ¡SQLä¸å›æ»šæ—¥å¿—ï¼ˆ&lt;code&gt;undo_log&lt;/code&gt;ï¼‰åœ¨æœ¬åœ°äº‹åŠ¡ä¸­æäº¤ï¼Œè®°å½•æ•°æ®å‰åé•œåƒï¼ˆ&lt;code&gt;before_image&lt;/code&gt;/&lt;code&gt;after_image&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;äºŒé˜¶æ®µï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æäº¤&lt;/strong&gt;ï¼šå¼‚æ­¥åˆ é™¤&lt;code&gt;undo_log&lt;/code&gt;ï¼ˆå‡ ä¹æ— æ€§èƒ½æŸè€—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æ»š&lt;/strong&gt;ï¼šå¯¹æ¯”å½“å‰æ•°æ®ä¸&lt;code&gt;after_image&lt;/code&gt;ï¼Œè‹¥ä¸€è‡´åˆ™ç”¨&lt;code&gt;before_image&lt;/code&gt;ç”Ÿæˆåå‘SQLè¡¥å¿ï¼›è‹¥ä¸ä¸€è‡´ï¼ˆè„å†™ï¼‰åˆ™è§¦å‘å‘Šè­¦æˆ–äººå·¥å¹²é¢„&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šæ— ä¸šåŠ¡ä¾µå…¥ï¼ŒåŸºäºSQLè§£æè‡ªåŠ¨ç”Ÿæˆè¡¥å¿é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;ï¼šé€šè¿‡å…¨å±€é”å®ç°å†™éš”ç¦»ï¼ˆSELECT FOR UPDATE ä¼šç”³è¯·å…¨å±€é”ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="tccæ¨¡å¼ä¸šåŠ¡è¡¥å¿"&gt;&lt;strong&gt;TCCæ¨¡å¼ï¼ˆä¸šåŠ¡è¡¥å¿ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Try&lt;/strong&gt;ï¼šé¢„ç•™èµ„æºï¼ˆå¦‚å†»ç»“åº“å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Confirm&lt;/strong&gt;ï¼šæäº¤èµ„æºï¼ˆå®é™…æ‰£å‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cancel&lt;/strong&gt;ï¼šé‡Šæ”¾èµ„æºï¼ˆè§£å†»åº“å­˜ï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šéœ€å¼ºä¸€è‡´æ€§çš„é«˜å¹¶å‘æ“ä½œï¼ˆå¦‚æ”¯ä»˜ã€ç§’æ€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒ‘æˆ˜&lt;/strong&gt;ï¼šéœ€æ‰‹åŠ¨å®ç°ä¸‰æ¥å£ï¼Œè§£å†³ç©ºå›æ»šã€å¹‚ç­‰æ€§é—®é¢˜&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="sagaæ¨¡å¼é•¿äº‹åŠ¡æµç¨‹"&gt;&lt;strong&gt;SAGAæ¨¡å¼ï¼ˆé•¿äº‹åŠ¡æµç¨‹ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­£å‘æœåŠ¡é“¾&lt;/strong&gt;ï¼šä¾æ¬¡æäº¤æœ¬åœ°äº‹åŠ¡ï¼ˆæ— é”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡¥å¿é“¾&lt;/strong&gt;ï¼šå¤±è´¥æ—¶é€†åºè§¦å‘è¡¥å¿æ“ä½œï¼ˆéœ€ä¸šåŠ¡å®ç°ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè·¨æœåŠ¡é•¿æµç¨‹ï¼ˆå¦‚ç”µå•†ä¸‹å•ã€ä¿é™©ç†èµ”ï¼‰ï¼Œæ”¯æŒå¼‚æ„ç³»ç»Ÿé›†æˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ— éš”ç¦»æ€§ï¼Œéœ€ä¸šåŠ¡è®¾è®¡è¡¥å¿é˜²æ‚¬æŒ‚&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="xaæ¨¡å¼å¼ºä¸€è‡´æ€§"&gt;&lt;strong&gt;XAæ¨¡å¼ï¼ˆå¼ºä¸€è‡´æ€§ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼šåŸºäºæ•°æ®åº“XAåè®®ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸€é˜¶æ®µ&lt;/strong&gt;ï¼šRMæ‰§è¡ŒSQLä½†ä¸æäº¤ï¼ŒæŒæœ‰æ•°æ®åº“é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äºŒé˜¶æ®µ&lt;/strong&gt;ï¼šTCé€šçŸ¥æ‰€æœ‰RMæäº¤/å›æ»š&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šä¼ ç»Ÿé‡‘èç³»ç»Ÿï¼Œéœ€å¼ºä¸€è‡´ä¸”æ•°æ®åº“æ”¯æŒXAåè®®ï¼ˆå¦‚MySQL InnoDBï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-å››ç§æ¨¡å¼å¯¹æ¯”"&gt;ğŸ“Š &lt;strong&gt;å››ç§æ¨¡å¼å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¾µå…¥æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;AT&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´&lt;/td&gt;
&lt;td&gt;å…¨å±€é”å†™éš”ç¦»&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;å¸¸è§„ä¸šåŠ¡ï¼ˆè®¢å•ã€åº“å­˜ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;TCC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´&lt;/td&gt;
&lt;td&gt;èµ„æºé¢„ç•™éš”ç¦»&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;æé«˜&lt;/td&gt;
&lt;td&gt;æ”¯ä»˜ã€é«˜å¹¶å‘ç§’æ€&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;SAGA&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´&lt;/td&gt;
&lt;td&gt;æ— éš”ç¦»&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;é•¿æµç¨‹ï¼ˆç‰©æµã€ç†èµ”ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;XA&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“é”å®Œå…¨éš”ç¦»&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;é“¶è¡Œè½¬è´¦ã€é‡‘èæ ¸å¿ƒ&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹è§£æä»¥atæ¨¡å¼ä¸ºä¾‹"&gt;ğŸ”„ &lt;strong&gt;å·¥ä½œæµç¨‹è§£æï¼ˆä»¥ATæ¨¡å¼ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€äº‹åŠ¡å¯åŠ¨&lt;/strong&gt;
TM é€šè¿‡ &lt;code&gt;@GlobalTransactional&lt;/code&gt; æ³¨è§£å¼€å¯äº‹åŠ¡ï¼ŒTC ç”Ÿæˆå…¨å±€å”¯ä¸€XID&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ”¯äº‹åŠ¡æ‰§è¡Œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;RM æ‹¦æˆªä¸šåŠ¡SQLï¼Œç”Ÿæˆ &lt;code&gt;before_image&lt;/code&gt; å’Œ &lt;code&gt;after_image&lt;/code&gt;ï¼Œå†™å…¥ &lt;code&gt;undo_log&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æäº¤æœ¬åœ°äº‹åŠ¡å‰ç”³è¯·å…¨å±€é”ï¼ŒæˆåŠŸåˆ™æäº¤å¹¶ä¸ŠæŠ¥TCï¼›å¤±è´¥åˆ™å›æ»š&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€äº‹åŠ¡æäº¤/å›æ»š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æäº¤&lt;/strong&gt;ï¼šTC å¼‚æ­¥åˆ é™¤æ‰€æœ‰å…³è” &lt;code&gt;undo_log&lt;/code&gt;ï¼ˆé‡Šæ”¾å…¨å±€é”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æ»š&lt;/strong&gt;ï¼šRM æ ¹æ® &lt;code&gt;undo_log&lt;/code&gt; ç”Ÿæˆè¡¥å¿SQLï¼Œåœ¨æœ¬åœ°äº‹åŠ¡ä¸­æ‰§è¡Œå›æ»š&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€é”å†²çª&lt;/strong&gt;ï¼šè‹¥æ•°æ®è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼ˆè„å†™ï¼‰ï¼Œå›æ»šä¼šå¤±è´¥å¹¶è§¦å‘å‘Šè­¦&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ€§èƒ½è®¾è®¡&lt;/strong&gt;ï¼šäºŒé˜¶æ®µæäº¤å¼‚æ­¥åŒ–ï¼Œé¿å…åŒæ­¥é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æŠ€æœ¯ä¼˜åŠ¿ä¸æŒ‘æˆ˜"&gt;âš¡ &lt;strong&gt;æŠ€æœ¯ä¼˜åŠ¿ä¸æŒ‘æˆ˜&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¼˜åŠ¿"&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ¨¡å¼å…¼å®¹&lt;/strong&gt;ï¼šé€‚é…ä¸åŒä¸šåŠ¡åœºæ™¯ï¼ˆå¼ºä¸€è‡´/æœ€ç»ˆä¸€è‡´ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ä¾µå…¥æ€§&lt;/strong&gt;ï¼šATæ¨¡å¼é›¶ä¸šåŠ¡æ”¹é€ ï¼ŒXAæ¨¡å¼å…¼å®¹æ ‡å‡†åè®®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨&lt;/strong&gt;ï¼šTCæ”¯æŒé›†ç¾¤åŒ–éƒ¨ç½²ï¼Œäº‹åŠ¡æ—¥å¿—æŒä¹…åŒ–é˜²å•ç‚¹æ•…éšœ&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æŒ‘æˆ˜ä¸åº”å¯¹"&gt;&lt;strong&gt;æŒ‘æˆ˜ä¸åº”å¯¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ATæ¨¡å¼è„å†™é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šå›æ»šæ—¶æ•°æ®å·²è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šé…ç½®ç­–ç•¥ï¼ˆé‡è¯•/äººå·¥ä»‹å…¥ï¼‰+ ç›‘æ§å‘Šè­¦&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TCCå¼€å‘å¤æ‚åº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šä½¿ç”¨Seataæ¡†æ¶çš„ &lt;code&gt;@TwoPhaseBusinessAction&lt;/code&gt; ç®€åŒ–æ¥å£å¼€å‘&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–&lt;/strong&gt;ï¼šé¿å…è·¨æœåŠ¡æ“ä½œåŒä¸€è¡Œæ•°æ®ï¼›Sagaå¼‚æ­¥æ‰§è¡Œå‡å°‘é˜»å¡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨å®è·µæŒ‡å—"&gt;ğŸ› ï¸ &lt;strong&gt;åº”ç”¨å®è·µæŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="éƒ¨ç½²ä¸é…ç½®"&gt;&lt;strong&gt;éƒ¨ç½²ä¸é…ç½®&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;TCæœåŠ¡ç«¯ï¼š
&lt;ul&gt;
&lt;li&gt;ä»å®˜ç½‘ä¸‹è½½Seata Serverï¼Œé…ç½®æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚Nacosï¼‰åŠå­˜å‚¨æ¨¡å¼ï¼ˆDB/Redisï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å»ºè¡¨ &lt;code&gt;global_table&lt;/code&gt;ã€&lt;code&gt;branch_table&lt;/code&gt;ã€&lt;code&gt;lock_table&lt;/code&gt;ã€&lt;code&gt;undo_log&lt;/code&gt;&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯ï¼š
&lt;ul&gt;
&lt;li&gt;å¼•å…¥ &lt;code&gt;seata-spring-boot-starter&lt;/code&gt;ï¼Œé…ç½®äº‹åŠ¡ç»„ä¸TCåœ°å€&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼€å‘ç¤ºä¾‹atæ¨¡å¼"&gt;&lt;strong&gt;å¼€å‘ç¤ºä¾‹ï¼ˆATæ¨¡å¼ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// TMç«¯ï¼šè®¢å•æœåŠ¡
@GlobalTransactional(rollbackFor = Exception.class)
public void createOrder() {
orderService.insert(); // æœ¬åœ°äº‹åŠ¡
inventoryService.deduct(); // è¿œç¨‹è°ƒç”¨åº“å­˜æœåŠ¡ï¼ˆRMï¼‰
}
// RMç«¯ï¼šåº“å­˜æœåŠ¡ï¼ˆè‡ªåŠ¨ç”Ÿæˆundo_logï¼‰
public void deduct() {
jdbcTemplate.update(&amp;#34;UPDATE stock SET count = count - 1 WHERE product_id = 1&amp;#34;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ç›‘æ§ä¸è¿ç»´"&gt;&lt;strong&gt;ç›‘æ§ä¸è¿ç»´&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—è¿½è¸ª&lt;/strong&gt;ï¼šé€šè¿‡XIDä¸²è”å…¨å±€äº‹åŠ¡é“¾è·¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å¯¹è´¦&lt;/strong&gt;ï¼šå®šæœŸæ ¡éªŒä¸šåŠ¡æ•°æ®ä¸€è‡´æ€§ï¼ˆå¦‚è®¢å•ä¸åº“å­˜çŠ¶æ€ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸é€‰å‹å»ºè®®-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ä¸é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Seata é€šè¿‡ &lt;strong&gt;å¤šæ¨¡å¼é€‚é…&lt;/strong&gt; å’Œ &lt;strong&gt;åˆ†å±‚æ¶æ„è®¾è®¡&lt;/strong&gt;ï¼Œæˆä¸ºå¾®æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡çš„äº‹å®æ ‡å‡†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºä¸€è‡´åœºæ™¯&lt;/strong&gt;ï¼šé€‰ &lt;strong&gt;XA&lt;/strong&gt;ï¼ˆé‡‘èï¼‰æˆ– &lt;strong&gt;TCC&lt;/strong&gt;ï¼ˆé«˜å¹¶å‘æ”¯ä»˜ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆä¸€è‡´åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;å¸¸è§„ä¸šåŠ¡ï¼š&lt;strong&gt;ATæ¨¡å¼&lt;/strong&gt;ï¼ˆæ— ä¾µå…¥é¦–é€‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é•¿æµç¨‹/å¼‚æ„ç³»ç»Ÿï¼š&lt;strong&gt;SAGAæ¨¡å¼&lt;/strong&gt;ï¼ˆå¼‚æ­¥é«˜æ€§èƒ½ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆè§„é¿&lt;/strong&gt;ï¼šé¿å…è·¨æœåŠ¡æ“ä½œçƒ­ç‚¹æ•°æ®ï¼Œé…åˆå¼‚æ­¥è¡¥å¿æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼šä¼˜å…ˆé‡‡ç”¨ AT æ¨¡å¼é™ä½å¼€å‘æˆæœ¬ï¼Œå¤æ‚åœºæ™¯ç»„åˆ TCC/SAGAï¼›é…å¥—å…¨å±€é”ç›‘æ§ã€äº‹åŠ¡æ—¥å¿—åˆ†æï¼Œæ„å»ºé²æ£’çš„äº‹åŠ¡ä½“ç³»&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="at--saga"&gt;AT &amp;amp; SAGA
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ Seata æ¡†æ¶ä¸­ &lt;strong&gt;AT æ¨¡å¼&lt;/strong&gt;ï¼ˆè‡ªåŠ¨è¡¥å¿äº‹åŠ¡ï¼‰ä¸ &lt;strong&gt;SAGA æ¨¡å¼&lt;/strong&gt;ï¼ˆé•¿äº‹åŠ¡è¡¥å¿æ¨¡å¼ï¼‰çš„è¯¦ç»†å¯¹æ¯”ï¼Œç»“åˆæŠ€æœ¯åŸç†ã€é€‚ç”¨åœºæ™¯åŠå®è·µè¦ç‚¹è¿›è¡Œç³»ç»Ÿåˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå·®å¼‚æ‘˜è¦"&gt;ğŸ“Š &lt;strong&gt;æ ¸å¿ƒå·®å¼‚æ‘˜è¦&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AT æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;SAGA æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡æ¨¡å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰ä¼˜åŒ–&lt;/td&gt;
&lt;td&gt;äº‹ä»¶é©±åŠ¨é•¿äº‹åŠ¡é“¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´ï¼ˆå¼±éš”ç¦»ï¼‰&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´ï¼ˆæ— éš”ç¦»ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çŸ­äº‹åŠ¡é«˜åå&lt;/td&gt;
&lt;td&gt;é•¿äº‹åŠ¡é«˜å¹¶å‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾µå…¥æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— ä¸šåŠ¡ä¾µå…¥&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨ç¼–å†™è¡¥å¿æœåŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡å…¨å±€é”å®ç°å†™éš”ç¦»&lt;/td&gt;
&lt;td&gt;æ— éš”ç¦»ï¼Œéœ€ä¸šåŠ¡å±‚å¤„ç†è„è¯»/æ›´æ–°ä¸¢å¤±&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è·¨æ•°æ®åº“çš„çŸ­äº‹åŠ¡ï¼ˆè®¢å•æ”¯ä»˜ï¼‰&lt;/td&gt;
&lt;td&gt;è·¨æœåŠ¡çš„å¼‚æ­¥é•¿æµç¨‹ï¼ˆç”µå•†ä¸‹å•ã€æ—…ç¨‹é¢„è®¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-äº‹åŠ¡æ¨¡å‹ä¸åŸç†"&gt;ğŸ”§ &lt;strong&gt;äº‹åŠ¡æ¨¡å‹ä¸åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="at-æ¨¡å¼è‡ªåŠ¨è¡¥å¿äº‹åŠ¡"&gt;&lt;strong&gt;AT æ¨¡å¼ï¼ˆè‡ªåŠ¨è¡¥å¿äº‹åŠ¡ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ ¸å¿ƒæœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸€é˜¶æ®µ&lt;/strong&gt;ï¼šä¸šåŠ¡ SQL ä¸å›æ»šæ—¥å¿—ï¼ˆ&lt;code&gt;undo_log&lt;/code&gt;ï¼‰åœ¨æœ¬åœ°äº‹åŠ¡ä¸­æäº¤ï¼Œè®°å½•æ•°æ®ä¿®æ”¹å‰åçš„å¿«ç…§ï¼ˆ&lt;code&gt;before_image&lt;/code&gt;/&lt;code&gt;after_image&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;äºŒé˜¶æ®µï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æäº¤&lt;/strong&gt;ï¼šå¼‚æ­¥åˆ é™¤ &lt;code&gt;undo_log&lt;/code&gt;ï¼ˆå‡ ä¹æ— å»¶è¿Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æ»š&lt;/strong&gt;ï¼šå¯¹æ¯”å½“å‰æ•°æ®ä¸ &lt;code&gt;after_image&lt;/code&gt;ï¼Œè‹¥ä¸€è‡´åˆ™é€šè¿‡ &lt;code&gt;before_image&lt;/code&gt;ç”Ÿæˆåå‘ SQL æ¢å¤æ•°æ®ï¼›è‹¥ä¸ä¸€è‡´ï¼ˆè„å†™ï¼‰è§¦å‘å‘Šè­¦&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…¨å±€é”ï¼š
&lt;ul&gt;
&lt;li&gt;åœ¨æäº¤å‰ç”³è¯·å…¨å±€é”ï¼ˆå†™å…¥ &lt;code&gt;lock_table&lt;/code&gt;ï¼‰ï¼Œé¿å…å…¶ä»–äº‹åŠ¡ä¿®æ”¹ç›¸åŒæ•°æ®ï¼Œå®ç°&lt;strong&gt;å†™éš”ç¦»&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="saga-æ¨¡å¼é•¿äº‹åŠ¡é“¾"&gt;&lt;strong&gt;SAGA æ¨¡å¼ï¼ˆé•¿äº‹åŠ¡é“¾ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ ¸å¿ƒæœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­£å‘äº‹åŠ¡é“¾&lt;/strong&gt;ï¼šå°†å…¨å±€äº‹åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªæœ¬åœ°äº‹åŠ¡ï¼ˆå¦‚åˆ›å»ºè®¢å• â†’ æ‰£åº“å­˜ â†’ æ”¯ä»˜ï¼‰ï¼Œæ¯ä¸ªäº‹åŠ¡ç‹¬ç«‹æäº¤&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡¥å¿äº‹åŠ¡é“¾&lt;/strong&gt;ï¼šè‹¥æŸä¸€äº‹åŠ¡å¤±è´¥ï¼ŒæŒ‰&lt;strong&gt;é€†åºè§¦å‘è¡¥å¿æ“ä½œ&lt;/strong&gt;ï¼ˆå¦‚æ”¯ä»˜å¤±è´¥ â†’ é‡Šæ”¾åº“å­˜ â†’ å–æ¶ˆè®¢å•ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œæ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼–æ’å¼ï¼ˆChoreographyï¼‰&lt;/strong&gt;ï¼šæœåŠ¡é—´é€šè¿‡äº‹ä»¶ï¼ˆå¦‚ Kafkaï¼‰è‡ªä¸»è§¦å‘åç»­äº‹åŠ¡ï¼Œæ— ä¸­å¿ƒåè°ƒå™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åè°ƒå¼ï¼ˆOrchestrationï¼‰&lt;/strong&gt;ï¼šç”± Seata çŠ¶æ€æœºå¼•æ“ï¼ˆJSON å®šä¹‰æµç¨‹ï¼‰ç»Ÿä¸€è°ƒåº¦äº‹åŠ¡ä¸è¡¥å¿&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-éš”ç¦»æ€§å¯¹æ¯”"&gt;âš ï¸ &lt;strong&gt;éš”ç¦»æ€§å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AT æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;SAGA æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è„è¯»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ é€šè¿‡å…¨å±€é”é˜»æ­¢å†™æ“ä½œ&lt;/td&gt;
&lt;td&gt;âœ… å¯èƒ½å‘ç”Ÿï¼ˆäº‹åŠ¡æäº¤åæ•°æ®ç«‹å³å¯è§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ›´æ–°ä¸¢å¤±&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ å…¨å±€é”é˜²æ­¢å¹¶å‘å†™å†²çª&lt;/td&gt;
&lt;td&gt;âœ… éœ€ä¸šåŠ¡å±‚å¤„ç†ï¼ˆå¦‚è¯­ä¹‰é”æ ‡è®°çŠ¶æ€ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§£å†³ç­–ç•¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†…ç½®å…¨å±€é” + å¿«ç…§æ¯”å¯¹&lt;/td&gt;
&lt;td&gt;ä¾èµ–ä¸šåŠ¡è®¾è®¡ï¼ˆå¦‚æ‚²è§‚æµç¨‹è°ƒæ•´é¡ºåºï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AT æ¨¡å¼ä¸­ï¼Œä¸¤ä¸ªå¹¶å‘äº‹åŠ¡æ›´æ–°åŒä¸€è¡Œæ•°æ®ï¼šäº‹åŠ¡1æŒæœ‰å…¨å±€é”æ—¶ï¼Œäº‹åŠ¡2ä¼šè¢«é˜»å¡ç›´è‡³é”é‡Šæ”¾&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;SAGA æ¨¡å¼ä¸­ï¼Œè‹¥â€œæ‰£åº“å­˜â€åæœªåŠæ—¶â€œæ”¯ä»˜â€ï¼Œå…¶ä»–äº‹åŠ¡å¯èƒ½è¯»å–åˆ°ä¸­é—´çŠ¶æ€åº“å­˜ï¼Œéœ€æ ‡è®° &lt;code&gt;status=&amp;quot;FREEZING&amp;quot;&lt;/code&gt; é˜»æ­¢è„è¯»&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸èµ„æºå¼€é”€"&gt;âš¡ &lt;strong&gt;æ€§èƒ½ä¸èµ„æºå¼€é”€&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æŒ‡æ ‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AT æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;SAGA æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºé”å®šæ—¶é—´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çŸ­ï¼ˆä»…ä¸€é˜¶æ®µæäº¤æ—¶çŸ­æš‚æŒé”ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— é”&lt;/strong&gt;ï¼ˆäº‹åŠ¡æäº¤å³é‡Šæ”¾ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆäºŒé˜¶æ®µå¼‚æ­¥æäº¤ï¼‰&lt;/td&gt;
&lt;td&gt;æé«˜ï¼ˆäº‹åŠ¡é“¾å¯å¹¶è¡Œæ‰§è¡Œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç“¶é¢ˆç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¨å±€é”ç«äº‰ï¼ˆé«˜å¹¶å‘çƒ­ç‚¹æ•°æ®ï¼‰&lt;/td&gt;
&lt;td&gt;è¡¥å¿æœåŠ¡æ‰§è¡Œå»¶è¿Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;AT ä¼˜åŠ¿&lt;/strong&gt;ï¼šé€‚åˆé«˜é¢‘çŸ­äº‹åŠ¡ï¼ˆå¦‚æ”¯ä»˜æ‰£æ¬¾ï¼‰ï¼Œæœ¬åœ°äº‹åŠ¡æäº¤å³é‡Šæ”¾èµ„æº&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SAGA ä¼˜åŠ¿&lt;/strong&gt;ï¼šé•¿äº‹åŠ¡ä¸­æ— èµ„æºé”å®šï¼Œé€‚åˆåº“å­˜å†»ç»“ã€æ—…ç¨‹é¢„è®¢ç­‰åˆ†é’Ÿçº§æµç¨‹&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸šåŠ¡ä¾µå…¥æ€§ä¸å¤æ‚åº¦"&gt;ğŸ› ï¸ &lt;strong&gt;ä¸šåŠ¡ä¾µå…¥æ€§ä¸å¤æ‚åº¦&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AT æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;SAGA æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼€å‘æˆæœ¬&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ— ä¾µå…¥ï¼ˆæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆ/å›æ»š SQLï¼‰&lt;/td&gt;
&lt;td&gt;âŒ éœ€æ‰‹åŠ¨ç¼–å†™&lt;strong&gt;æ­£å‘æœåŠ¡ + è¡¥å¿æœåŠ¡&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç ç¤ºä¾‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;java @GlobalTransactional&lt;/code&gt; æ³¨è§£ç”Ÿæ•ˆ&lt;/td&gt;
&lt;td&gt;éœ€å®šä¹‰ JSON çŠ¶æ€æœºæˆ–å®ç°è¡¥å¿æ¥å£&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿ç»´å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆæ—¥å¿—è‡ªåŠ¨æ¸…ç†ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆéœ€ç›‘æ§æ‚¬æŒ‚äº‹åŠ¡ã€ç©ºè¡¥å¿ï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;SAGA è¡¥å¿é€»è¾‘æŒ‘æˆ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç©ºå›æ»š&lt;/strong&gt;ï¼šæœªæ‰§è¡Œ Try å´è§¦å‘ Cancel â†’ éœ€äº‹åŠ¡çŠ¶æ€è¡¨æ ¡éªŒ&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‚¬æŒ‚&lt;/strong&gt;ï¼šCancel å…ˆäº Try æ‰§è¡Œ â†’ éœ€æ£€æŸ¥å…¨å±€äº‹åŠ¡çŠ¶æ€&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯å¯¹æ¯”"&gt;ğŸ­ &lt;strong&gt;é€‚ç”¨åœºæ™¯å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="at-æ¨¡å¼é¦–é€‰åœºæ™¯"&gt;&lt;strong&gt;AT æ¨¡å¼é¦–é€‰åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çŸ­äº‹åŠ¡ &amp;amp; å¼ºæ•°æ®ä¾èµ–&lt;/strong&gt;ï¼šå¦‚è®¢å•åˆ›å»º+åº“å­˜æ‰£å‡ï¼ˆè·¨æ•°æ®åº“ï¼‰ï¼Œéœ€ä¿è¯åº“å­˜æ‰£å‡ä¸è®¢å•çŠ¶æ€åŒæ­¥&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½å»¶è¿Ÿè¦æ±‚&lt;/strong&gt;ï¼šç§’çº§å†…å®Œæˆçš„äº¤æ˜“ï¼ˆå¦‚æ”¯ä»˜å›è°ƒï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="saga-æ¨¡å¼é¦–é€‰åœºæ™¯"&gt;&lt;strong&gt;SAGA æ¨¡å¼é¦–é€‰åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é•¿æµç¨‹ &amp;amp; è·¨æœåŠ¡å¼‚æ­¥ï¼š
&lt;ul&gt;
&lt;li&gt;ç”µå•†ä¸‹å•ï¼šåˆ›å»ºè®¢å• â†’ æ”¯ä»˜ â†’ å‘è´§ï¼ˆè¡¥å¿é“¾ï¼šæ”¯ä»˜å¤±è´¥é€€å•ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ—…ç¨‹é¢„è®¢ï¼šè®¢æœºç¥¨ â†’ è®¢é…’åº— â†’ ç§Ÿè½¦ï¼ˆä»»ä¸€å¤±è´¥è§¦å‘é€†åºå–æ¶ˆï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ„ç³»ç»Ÿé›†æˆ&lt;/strong&gt;ï¼šè°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆå¦‚é“¶è¡Œæ¥å£ï¼‰ï¼Œæ— æ³•æ§åˆ¶å…¶äº‹åŠ¡æ—¶&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®¹é”™ä¸å¼‚å¸¸å¤„ç†"&gt;ğŸ§© &lt;strong&gt;å®¹é”™ä¸å¼‚å¸¸å¤„ç†&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¼‚å¸¸ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AT æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;SAGA æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬åœ°äº‹åŠ¡å¤±è´¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨å›æ»šï¼ˆé€šè¿‡ &lt;code&gt;undo_log&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;è§¦å‘åç»­è¡¥å¿é“¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¡¥å¿å¤±è´¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸é€‚ç”¨&lt;/td&gt;
&lt;td&gt;âš ï¸ éœ€é‡è¯•æœºåˆ¶ + äººå·¥å…œåº•ï¼ˆå¦‚é€€æ¬¾æ¥å£è¶…æ—¶ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ä¸ä¸€è‡´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿«ç…§æ¯”å¯¹å‘Šè­¦ + äººå·¥ä¿®å¤&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡å±‚ä¿è¯è¡¥å¿å¹‚ç­‰æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;SAGA å®¹ç¾å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¡¥å¿æœåŠ¡éœ€&lt;strong&gt;å¹‚ç­‰è®¾è®¡&lt;/strong&gt;ï¼ˆå¦‚é€šè¿‡äº‹åŠ¡ ID å»é‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯ç”¨å¼‚æ­¥é‡è¯•é˜Ÿåˆ— + æ­»ä¿¡ç›‘æ§&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸é€‰å‹å»ºè®®-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ä¸é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆé€‰æ‹© AT æ¨¡å¼&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åœºæ™¯ï¼šè·¨æ•°æ®åº“çš„çŸ­äº‹åŠ¡ï¼ˆ90% å¾®æœåŠ¡åœºæ™¯ï¼‰ï¼Œè¿½æ±‚å¼€å‘æ•ˆç‡ä¸æ— ä¾µå…¥æ€§&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§„é¿ç‚¹ï¼šçƒ­ç‚¹æ•°æ®å¹¶å‘å†™ï¼ˆå¦‚ç§’æ€åº“å­˜ï¼‰ï¼Œå…¨å±€é”å¯èƒ½æˆä¸ºç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆé€‰æ‹© SAGA æ¨¡å¼&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åœºæ™¯ï¼šè·¨å¤šæœåŠ¡çš„å¼‚æ­¥é•¿æµç¨‹ï¼ˆ&amp;gt;1åˆ†é’Ÿï¼‰ï¼Œæˆ–éœ€é›†æˆå¼‚æ„ç³»ç»Ÿï¼ˆå¦‚ç¬¬ä¸‰æ–¹æ”¯ä»˜ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¿…å¤‡æªæ–½ï¼šè¡¥å¿æœåŠ¡å¹‚ç­‰æ€§ + çŠ¶æ€æœºå¯è§†åŒ–ç¼–æ’ï¼ˆSeata Designer å·¥å…·ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ··åˆæ¨¡å¼å®è·µ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è®¢å•ç³»ç»Ÿï¼šç”¨ AT å¤„ç†è®¢å•åˆ›å»º + åº“å­˜æ‰£å‡ï¼ŒSAGA å¤„ç†æ”¯ä»˜ â†’ å‘è´§é•¿é“¾&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å†³ç­–æµç¨‹å›¾&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph TD
A[äº‹åŠ¡æ˜¯å¦è·¨å¤šæœåŠ¡ï¼Ÿ] --&amp;gt;|å¦| B[é€‰æ‹© AT æ¨¡å¼]
A --&amp;gt;|æ˜¯| C{æ‰§è¡Œæ—¶é—´ &amp;gt;1 åˆ†é’Ÿï¼Ÿ}
C --&amp;gt;|å¦| D[è¯„ä¼° AT æˆ– TCC]
C --&amp;gt;|æ˜¯| E[é€‰æ‹© SAGA æ¨¡å¼]
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
&lt;h2 id="è´Ÿè½½å‡è¡¡"&gt;è´Ÿè½½å‡è¡¡
&lt;/h2&gt;&lt;p&gt;è´Ÿè½½å‡è¡¡æŠ€æœ¯æ˜¯ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼Œå…¶ç±»å‹å¯ä»&lt;strong&gt;ç½‘ç»œå±‚çº§&lt;/strong&gt;ã€&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;å’Œ&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;ä¸‰ä¸ªç»´åº¦è¿›è¡Œåˆ†ç±»ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æŒ‰ç½‘ç»œå±‚çº§åˆ†ç±»osiæ¨¡å‹"&gt;ğŸ”§ &lt;strong&gt;æŒ‰ç½‘ç»œå±‚çº§åˆ†ç±»ï¼ˆOSIæ¨¡å‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="äºŒå±‚è´Ÿè½½å‡è¡¡æ•°æ®é“¾è·¯å±‚"&gt;&lt;strong&gt;äºŒå±‚è´Ÿè½½å‡è¡¡ï¼ˆæ•°æ®é“¾è·¯å±‚ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåŸºäºMACåœ°å€è¿›è¡Œæµé‡åˆ†å‘ï¼Œé€šè¿‡ä¿®æ”¹ç›®æ ‡MACåœ°å€å°†è¯·æ±‚è½¬å‘åˆ°ä¸åŒæœåŠ¡å™¨&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åè®®&lt;/strong&gt;ï¼šARPã€MACåœ°å€ä¼ªé€ ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šè½¬å‘æ•ˆç‡é«˜ï¼Œå»¶è¿Ÿä½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ— æ³•æ„ŸçŸ¥åº”ç”¨å±‚ä¿¡æ¯ï¼Œçµæ´»æ€§å·®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå±€åŸŸç½‘å†…éƒ¨æµé‡è°ƒåº¦ï¼Œå¦‚äº¤æ¢æœºçº§è´Ÿè½½å‡è¡¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸‰å±‚è´Ÿè½½å‡è¡¡ç½‘ç»œå±‚"&gt;&lt;strong&gt;ä¸‰å±‚è´Ÿè½½å‡è¡¡ï¼ˆç½‘ç»œå±‚ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåŸºäºIPåœ°å€åˆ†å‘æµé‡ï¼Œé€šè¿‡ä¿®æ”¹ç›®æ ‡IPå®ç°è½¬å‘&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åè®®&lt;/strong&gt;ï¼šIPåœ°å€è½¬æ¢ï¼ˆNATï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ”¯æŒè·¨å­ç½‘æµé‡è°ƒåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ— æ³•åŒºåˆ†åŒä¸€IPçš„ä¸åŒæœåŠ¡ï¼ˆå¦‚HTTP vs. FTPï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šä¼ä¸šå†…éƒ¨ç½‘ç»œè·¯ç”±ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å››å±‚è´Ÿè½½å‡è¡¡ä¼ è¾“å±‚"&gt;&lt;strong&gt;å››å±‚è´Ÿè½½å‡è¡¡ï¼ˆä¼ è¾“å±‚ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåŸºäºTCP/UDPåè®®ï¼Œé€šè¿‡IP+ç«¯å£å·åˆ†å‘è¯·æ±‚&lt;a class="link" href="@ref" &gt;1,4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åè®®&lt;/strong&gt;ï¼šTCP/UDPã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šé«˜æ€§èƒ½ï¼Œæ”¯æŒç™¾ä¸‡çº§å¹¶å‘è¿æ¥ï¼ˆå¦‚LVSï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ— æ³•è§£æHTTPå¤´éƒ¨ç­‰åº”ç”¨å±‚å†…å®¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹å·¥å…·&lt;/strong&gt;ï¼šLVSã€F5 BIG-IPã€HAProxyï¼ˆTCPæ¨¡å¼ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ•°æ®åº“é›†ç¾¤ã€æ¸¸æˆæœåŠ¡å™¨ç­‰é•¿è¿æ¥æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸ƒå±‚è´Ÿè½½å‡è¡¡åº”ç”¨å±‚"&gt;&lt;strong&gt;ä¸ƒå±‚è´Ÿè½½å‡è¡¡ï¼ˆåº”ç”¨å±‚ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šè§£æHTTP/HTTPSç­‰åº”ç”¨å±‚åè®®ï¼Œæ ¹æ®URLã€Headerç­‰ä¿¡æ¯æ™ºèƒ½è·¯ç”±&lt;a class="link" href="@ref" &gt;1,2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åè®®&lt;/strong&gt;ï¼šHTTP/HTTPSã€DNSã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ”¯æŒç°åº¦å‘å¸ƒã€A/Bæµ‹è¯•ã€é˜²ç›—é“¾ç­‰é«˜çº§åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå¤„ç†æ€§èƒ½ä½äºå››å±‚ï¼ˆéœ€è§£æåº”ç”¨å±‚æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹å·¥å…·&lt;/strong&gt;ï¼šNginxã€HAProxyï¼ˆHTTPæ¨¡å¼ï¼‰ã€Spring Cloud Gateway&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šWebåº”ç”¨ã€APIç½‘å…³ã€å¾®æœåŠ¡è·¯ç”±ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æŒ‰å®ç°æ–¹å¼åˆ†ç±»"&gt;âš™ï¸ &lt;strong&gt;æŒ‰å®ç°æ–¹å¼åˆ†ç±»&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç¡¬ä»¶è´Ÿè½½å‡è¡¡"&gt;&lt;strong&gt;ç¡¬ä»¶è´Ÿè½½å‡è¡¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šé€šè¿‡ä¸“ç”¨ç¡¬ä»¶è®¾å¤‡ï¼ˆå¦‚F5 BIG-IPã€Cisco ACEï¼‰åˆ†å‘æµé‡&lt;a class="link" href="@ref" &gt;1,3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šé«˜æ€§èƒ½ã€é«˜å¯é æ€§ï¼Œæ”¯æŒTBçº§æµé‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæˆæœ¬é«˜æ˜‚ï¼ˆå•å°è®¾å¤‡æ•°åä¸‡å…ƒï¼‰ï¼Œæ‰©å±•æ€§å·®&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé‡‘èã€ç”µä¿¡ç­‰å¯¹ç¨³å®šæ€§è¦æ±‚æé«˜çš„æ ¸å¿ƒç³»ç»Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è½¯ä»¶è´Ÿè½½å‡è¡¡"&gt;&lt;strong&gt;è½¯ä»¶è´Ÿè½½å‡è¡¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šé€šè¿‡è½¯ä»¶å®ç°æµé‡è°ƒåº¦ï¼Œéƒ¨ç½²åœ¨é€šç”¨æœåŠ¡å™¨æˆ–äº‘ç¯å¢ƒ&lt;a class="link" href="@ref" &gt;1,4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šçµæ´»ã€ä½æˆæœ¬ï¼Œæ”¯æŒåŠ¨æ€æ‰©ç¼©å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ€§èƒ½ä¾èµ–å®¿ä¸»æœåŠ¡å™¨èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…¸å‹å·¥å…·ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€šç”¨è½¯ä»¶&lt;/strong&gt;ï¼šNginxï¼ˆHTTP/TCPï¼‰ã€HAProxyï¼ˆå››å±‚/ä¸ƒå±‚ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¾®æœåŠ¡é›†æˆ&lt;/strong&gt;ï¼šRibbonï¼ˆå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼‰ã€Spring Cloud LoadBalancer&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šäº’è”ç½‘åº”ç”¨ã€äº‘åŸç”Ÿæ¶æ„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="äº‘åŸç”Ÿè´Ÿè½½å‡è¡¡"&gt;&lt;strong&gt;äº‘åŸç”Ÿè´Ÿè½½å‡è¡¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šäº‘æœåŠ¡å•†æä¾›çš„æ‰˜ç®¡æœåŠ¡ï¼Œå¦‚AWS ALBï¼ˆåº”ç”¨å±‚ï¼‰ã€AWS NLBï¼ˆç½‘ç»œå±‚ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šè‡ªåŠ¨æ‰©ç¼©å®¹ï¼Œä¸äº‘ç”Ÿæ€æ— ç¼é›†æˆï¼ˆå¦‚K8s Ingressï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šç»‘å®šç‰¹å®šäº‘å¹³å°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹æœåŠ¡&lt;/strong&gt;ï¼šAWS ELBã€Azure Load Balancerã€GCP Cloud Load Balancingã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æŒ‰åº”ç”¨åœºæ™¯åˆ†ç±»"&gt;ğŸŒ &lt;strong&gt;æŒ‰åº”ç”¨åœºæ™¯åˆ†ç±»&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…¨å±€è´Ÿè½½å‡è¡¡gslb"&gt;&lt;strong&gt;å…¨å±€è´Ÿè½½å‡è¡¡ï¼ˆGSLBï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šè·¨åœ°åŸŸè°ƒåº¦æµé‡ï¼Œå°†ç”¨æˆ·è¯·æ±‚åˆ†å‘åˆ°æœ€è¿‘æˆ–æœ€å¥åº·çš„æ•°æ®ä¸­å¿ƒ&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DNSè´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šå°†åŒä¸€åŸŸåè§£æåˆ°ä¸åŒåœ°åŸŸçš„IPï¼ˆå¦‚CDNèŠ‚ç‚¹ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AnyCastè·¯ç”±&lt;/strong&gt;ï¼šé€šè¿‡BGPåè®®å®ç°IPå°±è¿‘è®¿é—®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè·¨å›½ä¼ä¸šã€å¤šåœ°åŸŸéƒ¨ç½²çš„äº‘æœåŠ¡ï¼ˆå¦‚Netflixï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é›†ç¾¤å†…è´Ÿè½½å‡è¡¡"&gt;&lt;strong&gt;é›†ç¾¤å†…è´Ÿè½½å‡è¡¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåœ¨å•ä¸€é›†ç¾¤å†…éƒ¨ï¼ˆå¦‚K8s Podsï¼‰åˆ†å‘è¯·æ±‚ï¼Œé¿å…å•ç‚¹è¿‡è½½&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡ç½‘æ ¼&lt;/strong&gt;ï¼šIstioã€Linkerdé€šè¿‡Sidecarä»£ç†åŠ¨æ€è·¯ç”±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šRibbonã€gRPCå†…ç½®ç®—æ³•ï¼ˆå¦‚æœ€å°‘è¿æ¥æ•°ï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå¾®æœåŠ¡æ¶æ„ã€å®¹å™¨åŒ–éƒ¨ç½²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®åº“è´Ÿè½½å‡è¡¡"&gt;&lt;strong&gt;æ•°æ®åº“è´Ÿè½½å‡è¡¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåˆ†æ•£æ•°æ®åº“è¯»å†™å‹åŠ›ï¼Œæå‡æŸ¥è¯¢æ•ˆç‡&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯»å†™åˆ†ç¦»&lt;/strong&gt;ï¼šå†™æ“ä½œåˆ°ä¸»åº“ï¼Œè¯»æ“ä½œåˆ°ä»åº“ï¼ˆå¦‚MySQL Proxyï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç‰‡ï¼ˆShardingï¼‰&lt;/strong&gt;ï¼šæŒ‰æ•°æ®ç‰¹å¾ï¼ˆå¦‚ç”¨æˆ·IDå“ˆå¸Œï¼‰åˆ†å¸ƒåˆ°ä¸åŒå®ä¾‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘ç”µå•†ã€ç¤¾äº¤å¹³å°æ•°æ®åº“é›†ç¾¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è´Ÿè½½å‡è¡¡ç±»å‹å¯¹æ¯”æ€»ç»“"&gt;ğŸ“Š &lt;strong&gt;è´Ÿè½½å‡è¡¡ç±»å‹å¯¹æ¯”æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åˆ†ç±»ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å·¥ä½œå±‚çº§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åè®®/å·¥å…·&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç½‘ç»œå±‚çº§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å››å±‚è´Ÿè½½å‡è¡¡&lt;/td&gt;
&lt;td&gt;TCP/UDP&lt;/td&gt;
&lt;td&gt;LVSã€F5&lt;/td&gt;
&lt;td&gt;é«˜æ€§èƒ½ï¼Œä½†æ— æ³•è¯†åˆ«åº”ç”¨å±‚å†…å®¹&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“ã€å®æ—¶é€šä¿¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ä¸ƒå±‚è´Ÿè½½å‡è¡¡&lt;/td&gt;
&lt;td&gt;HTTP/HTTPS&lt;/td&gt;
&lt;td&gt;Nginxã€HAProxy&lt;/td&gt;
&lt;td&gt;åŠŸèƒ½ä¸°å¯Œï¼Œä½†æ€§èƒ½è¾ƒä½&lt;/td&gt;
&lt;td&gt;Webåº”ç”¨ã€APIç½‘å…³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¡¬ä»¶è´Ÿè½½å‡è¡¡&lt;/td&gt;
&lt;td&gt;å››å±‚/ä¸ƒå±‚&lt;/td&gt;
&lt;td&gt;F5 BIG-IP&lt;/td&gt;
&lt;td&gt;é«˜å¯é é«˜æ€§èƒ½ï¼Œæˆæœ¬é«˜æ˜‚&lt;/td&gt;
&lt;td&gt;é‡‘èæ ¸å¿ƒç³»ç»Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;è½¯ä»¶è´Ÿè½½å‡è¡¡&lt;/td&gt;
&lt;td&gt;å››å±‚/ä¸ƒå±‚&lt;/td&gt;
&lt;td&gt;Nginxã€Ribbon&lt;/td&gt;
&lt;td&gt;çµæ´»ä½æˆæœ¬ï¼Œä¾èµ–å®¿ä¸»èµ„æº&lt;/td&gt;
&lt;td&gt;äº’è”ç½‘åº”ç”¨ã€äº‘åŸç”Ÿæ¶æ„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¨å±€è´Ÿè½½å‡è¡¡ï¼ˆGSLBï¼‰&lt;/td&gt;
&lt;td&gt;DNS/AnyCast&lt;/td&gt;
&lt;td&gt;AWS Route 53ã€Azure Traffic Manager&lt;/td&gt;
&lt;td&gt;è·¨åœ°åŸŸå®¹ç¾ï¼Œä½†é…ç½®å¤æ‚&lt;/td&gt;
&lt;td&gt;å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;é›†ç¾¤å†…è´Ÿè½½å‡è¡¡&lt;/td&gt;
&lt;td&gt;å››å±‚/ä¸ƒå±‚&lt;/td&gt;
&lt;td&gt;K8s Serviceã€Istio&lt;/td&gt;
&lt;td&gt;åŠ¨æ€è°ƒåº¦ï¼Œéœ€é…åˆæœåŠ¡å‘ç°&lt;/td&gt;
&lt;td&gt;å¾®æœåŠ¡ã€å®¹å™¨é›†ç¾¤&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‰å‹å»ºè®®-1"&gt;âš ï¸ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ€§èƒ½æ•æ„Ÿå‹åœºæ™¯ï¼ˆå¦‚æ¸¸æˆæœåŠ¡å™¨ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆé€‰æ‹©&lt;strong&gt;å››å±‚ç¡¬ä»¶è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼ˆå¦‚F5ï¼‰æˆ–&lt;strong&gt;DPDKä¼˜åŒ–çš„è½¯ä»¶æ–¹æ¡ˆ&lt;/strong&gt;ï¼ˆå¦‚LVSï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;çµæ´»è·¯ç”±éœ€æ±‚ï¼ˆå¦‚å¾®æœåŠ¡ç½‘å…³ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;strong&gt;ä¸ƒå±‚è½¯ä»¶è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼ˆNginx+OpenRestyï¼‰æˆ–&lt;strong&gt;æœåŠ¡ç½‘æ ¼&lt;/strong&gt;ï¼ˆIstioï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æˆæœ¬ä¸æ‰©å±•æ€§å¹³è¡¡ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸­å°è§„æ¨¡é€‰&lt;strong&gt;Nginx/HAProxy&lt;/strong&gt;ï¼›äº‘åŸç”Ÿç¯å¢ƒé€‰&lt;strong&gt;æ‰˜ç®¡æœåŠ¡&lt;/strong&gt;ï¼ˆAWS ALBï¼‰æˆ–&lt;strong&gt;å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼ˆRibbonï¼‰&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è·¨åœ°åŸŸé«˜å¯ç”¨ï¼š
&lt;ul&gt;
&lt;li&gt;å¿…é€‰&lt;strong&gt;å…¨å±€è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼ˆGSLBï¼‰é…åˆDNSæ™ºèƒ½è§£æ&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’ &lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šè´Ÿè½½å‡è¡¡é€šè¿‡&lt;strong&gt;åˆ†æ²»ç­–ç•¥&lt;/strong&gt;å°†æµé‡åˆ†æ•£åˆ°å¤šèŠ‚ç‚¹ï¼Œæœ¬è´¨æ˜¯&lt;strong&gt;åˆ†å¸ƒå¼ç³»ç»Ÿèµ„æºè°ƒåº¦çš„åŸºçŸ³&lt;/strong&gt;ã€‚é€‰å‹æ—¶éœ€æƒè¡¡æ€§èƒ½ã€æˆæœ¬ã€åŠŸèƒ½å¤æ‚åº¦ï¼Œå¹¶ç»“åˆå¥åº·æ£€æŸ¥ã€ä¼šè¯ä¿æŒç­‰é…å¥—æœºåˆ¶æ„å»ºå®Œæ•´é«˜å¯ç”¨æ¶æ„&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="è´Ÿè½½å‡è¡¡ç®—æ³•"&gt;è´Ÿè½½å‡è¡¡ç®—æ³•
&lt;/h2&gt;&lt;p&gt;è´Ÿè½½å‡è¡¡ç®—æ³•æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒè°ƒåº¦æœºåˆ¶ï¼Œé€šè¿‡åˆç†åˆ†é…è¯·æ±‚æµé‡æå‡ç³»ç»Ÿååé‡ã€å¯ç”¨æ€§ä¸å®¹é”™æ€§ã€‚æ ¹æ®å†³ç­–ä¾æ®ï¼ˆæ˜¯å¦æ„ŸçŸ¥æœåŠ¡å™¨çŠ¶æ€ï¼‰å¯åˆ†ä¸ºé™æ€ä¸åŠ¨æ€ä¸¤å¤§ç±»ï¼Œä»¥ä¸‹ä»ç®—æ³•åŸç†ã€åº”ç”¨åœºæ™¯åŠå·¥ä¸šå®è·µå±•å¼€åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-é™æ€è´Ÿè½½å‡è¡¡ç®—æ³•"&gt;âš–ï¸ &lt;strong&gt;é™æ€è´Ÿè½½å‡è¡¡ç®—æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é™æ€ç®—æ³•åŸºäºé¢„å®šä¹‰ç­–ç•¥åˆ†é…è¯·æ±‚ï¼Œ&lt;strong&gt;ä¸æ„ŸçŸ¥æœåŠ¡å™¨å®æ—¶çŠ¶æ€&lt;/strong&gt;ï¼Œé€‚ç”¨äºæœåŠ¡å™¨æ€§èƒ½ç›¸è¿‘ä¸”è´Ÿè½½æ³¢åŠ¨å°çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;h4 id="è½®è¯¢round-robin"&gt;&lt;strong&gt;è½®è¯¢ï¼ˆRound Robinï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šæŒ‰æœåŠ¡å™¨åˆ—è¡¨é¡ºåºä¾æ¬¡åˆ†é…è¯·æ±‚ï¼Œå¾ªç¯å¾€å¤ã€‚å…¬å¼è¡¨ç¤ºä¸ºï¼š
&lt;code&gt;\text{next} = ( \text{current} + 1 ) \mod N&lt;/code&gt; ï¼ˆ&lt;code&gt;N&lt;/code&gt;ä¸ºæœåŠ¡å™¨æ•°é‡ï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå®ç°ç®€å•ï¼Œç»å¯¹å…¬å¹³ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå¿½ç•¥æœåŠ¡å™¨æ€§èƒ½å·®å¼‚ï¼Œé«˜è´Ÿè½½æ—¶ä½é…æœåŠ¡å™¨æ˜“è¿‡è½½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šåŒæ„æœåŠ¡å™¨é›†ç¾¤ï¼ˆå¦‚é™æ€èµ„æºæœåŠ¡å™¨ï¼‰&lt;a class="link" href="@ref" &gt;7,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="éšæœºrandom"&gt;&lt;strong&gt;éšæœºï¼ˆRandomï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šå®Œå…¨éšæœºé€‰æ‹©æœåŠ¡å™¨ã€‚è‹¥æœåŠ¡å™¨æ€§èƒ½ç›¸åŒï¼Œåˆ™è¯·æ±‚åˆ†å¸ƒè¶‹è¿‘å‡åŒ€&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ— çŠ¶æ€ï¼Œé€‚åˆå¿«é€Ÿéƒ¨ç½²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šçŸ­æ—¶é—´å¯èƒ½é€ æˆå±€éƒ¨è´Ÿè½½å€¾æ–œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä¸šå®è·µ&lt;/strong&gt;ï¼šRibbonçš„&lt;code&gt;RandomRule&lt;/code&gt;ã€Dubboçš„&lt;code&gt;RandomLoadBalance&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŠ æƒè½®è¯¢weighted-round-robin"&gt;&lt;strong&gt;åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robinï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼šä¸ºé«˜æ€§èƒ½æœåŠ¡å™¨åˆ†é…æ›´é«˜æƒé‡ï¼ŒæŒ‰æƒé‡æ¯”ä¾‹åˆ†é…è¯·æ±‚ã€‚
å®ç°æ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°ç»„å±•å¼€æ³•&lt;/strong&gt;ï¼šæŒ‰æƒé‡å¤åˆ¶æœåŠ¡å™¨èŠ‚ç‚¹ï¼ˆå¦‚æƒé‡3:1åˆ™ç”Ÿæˆ[A,A,A,B]ï¼‰ï¼Œæ´—ç‰Œåè½®è¯¢ï¼ˆå†…å­˜å¼€é”€å¤§ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸Šç•Œæ”¶æ•›æ³•&lt;/strong&gt;ï¼šåŠ¨æ€é™ä½æƒé‡ä¸Šç•Œï¼Œä¼˜å…ˆé€‰æ‹©é«˜æƒé‡èŠ‚ç‚¹ï¼ˆå¦‚Nginxå®ç°ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå¼‚æ„æœåŠ¡å™¨ï¼ˆå¦‚CPU/å†…å­˜å·®å¼‚å¤§ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æºipå“ˆå¸Œsource-ip-hash"&gt;&lt;strong&gt;æºIPå“ˆå¸Œï¼ˆSource IP Hashï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šå¯¹å®¢æˆ·ç«¯IPå“ˆå¸Œå–æ¨¡ï¼š&lt;code&gt;\text{server} = \text{hash}(\text{client\_ip}) \mod N&lt;/code&gt;ï¼ŒåŒä¸€IPçš„è¯·æ±‚å›ºå®šåˆ°åŒä¸€æœåŠ¡å™¨&lt;a class="link" href="@ref" &gt;4,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ”¯æŒä¼šè¯ä¿æŒï¼ˆSession Affinityï¼‰ï¼Œæå‡ç¼“å­˜å‘½ä¸­ç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæœåŠ¡å™¨æ‰©å®¹/ç¼©å®¹æ—¶å¤§é‡ä¼šè¯å¤±æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨&lt;/strong&gt;ï¼šNginxçš„&lt;code&gt;ip_hash&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åŠ¨æ€è´Ÿè½½å‡è¡¡ç®—æ³•"&gt;ğŸ”„ &lt;strong&gt;åŠ¨æ€è´Ÿè½½å‡è¡¡ç®—æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åŠ¨æ€ç®—æ³•**ä¾æ®æœåŠ¡å™¨å®æ—¶çŠ¶æ€ï¼ˆè¿æ¥æ•°ã€å“åº”æ—¶é—´ç­‰ï¼‰**åŠ¨æ€è°ƒæ•´æµé‡åˆ†é…ï¼Œé€‚åˆå¤æ‚å¤šå˜åœºæ™¯ã€‚&lt;/p&gt;
&lt;h4 id="æœ€å°‘è¿æ¥æ•°least-connections"&gt;&lt;strong&gt;æœ€å°‘è¿æ¥æ•°ï¼ˆLeast Connectionsï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šé€‰æ‹©å½“å‰æ´»è·ƒè¿æ¥æ•°æœ€å°‘çš„æœåŠ¡å™¨ã€‚å…¬å¼ï¼š
&lt;code&gt;\text{select} = \arg\min(\text{connections}_i)&lt;/code&gt; &lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šè‡ªåŠ¨é€‚åº”é•¿è¿æ¥ã€å¤„ç†æ—¶é—´å·®å¼‚å¤§çš„æœåŠ¡ï¼ˆå¦‚æ•°æ®åº“ã€WebSocketï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šéœ€æŒç»­ç›‘æ§è¿æ¥æ•°ï¼Œå¢åŠ ç³»ç»Ÿå¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°&lt;/strong&gt;ï¼šLVSçš„&lt;code&gt;LC&lt;/code&gt;/&lt;code&gt;WLC&lt;/code&gt;ç®—æ³•ã€HAProxyçš„&lt;code&gt;leastconn&lt;/code&gt;&lt;a class="link" href="@ref" &gt;9,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æœ€çŸ­å“åº”æ—¶é—´least-response-time"&gt;&lt;strong&gt;æœ€çŸ­å“åº”æ—¶é—´ï¼ˆLeast Response Timeï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šç»¼åˆå“åº”æ—¶é—´ä¸è¿æ¥æ•°ï¼Œé€‰æ‹©å“åº”æœ€å¿«çš„æœåŠ¡å™¨ï¼š
&lt;code&gt;\text{score} = \alpha \times \text{response\_time} + \beta \times \text{connections}&lt;/code&gt; &lt;a class="link" href="@ref" &gt;7,4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œé€‚åˆå»¶è¿Ÿæ•æ„Ÿå‹åº”ç”¨ï¼ˆåœ¨çº¿æ¸¸æˆã€é‡‘èäº¤æ˜“ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šç½‘ç»œæŠ–åŠ¨æ˜“å¯¼è‡´å†³ç­–æ³¢åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼šRibbonçš„&lt;code&gt;WeightedResponseTimeRule&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸€è‡´æ€§å“ˆå¸Œconsistent-hash"&gt;&lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ol&gt;
&lt;li&gt;æ„å»ºå“ˆå¸Œç¯ï¼ˆ0~2Â³Â²-1ï¼‰ï¼Œå°†æœåŠ¡å™¨å’Œè¯·æ±‚çš„Keyï¼ˆå¦‚ç”¨æˆ·IDï¼‰å“ˆå¸Œåˆ°ç¯ä¸Šï¼›&lt;/li&gt;
&lt;li&gt;è¯·æ±‚åˆ†é…ç»™é¡ºæ—¶é’ˆæœ€è¿‘çš„æœåŠ¡å™¨èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šæœåŠ¡å™¨å¢å‡æ—¶ä»…å½±å“ç›¸é‚»èŠ‚ç‚¹ï¼Œä¼šè¯ä¿æŒæ€§ä¼˜äºIPå“ˆå¸Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨&lt;/strong&gt;ï¼šç¼“å­˜é›†ç¾¤ï¼ˆå¦‚Redisé›†ç¾¤ï¼‰ã€Dubboçš„&lt;code&gt;ConsistentHashLoadBalance&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸºäºèµ„æºçš„åŠ¨æ€æƒé‡resource-based"&gt;&lt;strong&gt;åŸºäºèµ„æºçš„åŠ¨æ€æƒé‡ï¼ˆResource-Basedï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šé‡‡é›†æœåŠ¡å™¨CPUã€å†…å­˜ã€I/Oç­‰æŒ‡æ ‡ï¼ŒåŠ¨æ€è®¡ç®—æƒé‡å¹¶è°ƒæ•´æµé‡&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;é˜¿é‡Œäº‘SLBçš„&lt;code&gt;QoS&lt;/code&gt;ç®—æ³•ï¼Œæ ¹æ®å®æ—¶è´Ÿè½½å¼¹æ€§åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;Kubernetes HPAï¼ˆHorizontal Pod Autoscalerï¼‰ç»“åˆè´Ÿè½½æŒ‡æ ‡è‡ªåŠ¨æ‰©ç¼©å®¹&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç®—æ³•å¯¹æ¯”ä¸é€‰å‹æŒ‡å—"&gt;ğŸ“Š &lt;strong&gt;ç®—æ³•å¯¹æ¯”ä¸é€‰å‹æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç®—æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;åŠ¨æ€æ€§&lt;/th&gt;
&lt;th&gt;ä¼šè¯ä¿æŒ&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;th&gt;æ€§èƒ½å½±å“&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;è½®è¯¢&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;åŒæ„æœåŠ¡å™¨ã€é™æ€èµ„æº&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŠ æƒè½®è¯¢&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;å¼‚æ„æœåŠ¡å™¨ï¼ˆCPU/å†…å­˜å·®å¼‚ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ€å°‘è¿æ¥æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;é•¿è¿æ¥æœåŠ¡ï¼ˆæ•°æ®åº“ã€WebSocketï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆéœ€ç›‘æ§è¿æ¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ€çŸ­å“åº”æ—¶é—´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;å»¶è¿Ÿæ•æ„Ÿå‹åº”ç”¨ï¼ˆæ¸¸æˆã€äº¤æ˜“ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆéœ€è®¡ç®—æ—¶å»¶ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;ç¼“å­˜é›†ç¾¤ã€ä¼šè¯ä¾èµ–æœåŠ¡&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æºIPå“ˆå¸Œ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;éœ€ç®€å•ä¼šè¯ä¿æŒçš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="é€‰å‹å»ºè®®"&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ„æœåŠ¡å™¨+çŸ­è¯·æ±‚&lt;/strong&gt;ï¼šè½®è¯¢/éšæœºï¼ˆå¦‚Nginxé™æ€èµ„æºåˆ†å‘ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ„æœåŠ¡å™¨&lt;/strong&gt;ï¼šåŠ æƒè½®è¯¢/åŠ æƒéšæœºï¼ˆå¦‚æ··åˆäº‘ç¯å¢ƒï¼‰&lt;a class="link" href="@ref" &gt;7,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿è¿æ¥/å¤„ç†æ—¶é—´å·®å¼‚å¤§&lt;/strong&gt;ï¼šæœ€å°‘è¿æ¥æ•°ï¼ˆå¦‚LVSçš„&lt;code&gt;WLC&lt;/code&gt;ç®—æ³•ï¼‰&lt;a class="link" href="@ref" &gt;9,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘+ä½å»¶è¿Ÿè¦æ±‚&lt;/strong&gt;ï¼šæœ€çŸ­å“åº”æ—¶é—´ï¼ˆå¦‚é‡‘èäº¤æ˜“ç³»ç»Ÿï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼šè¯ä¿æŒéœ€æ±‚&lt;/strong&gt;ï¼šä¸€è‡´æ€§å“ˆå¸Œï¼ˆå¦‚ç”¨æˆ·ç™»å½•çŠ¶æ€ç»´æŠ¤ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä¸šçº§å®ç°ä¸ä¼˜åŒ–ç­–ç•¥"&gt;âš™ï¸ &lt;strong&gt;å·¥ä¸šçº§å®ç°ä¸ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¸­é—´ä»¶é»˜è®¤ç®—æ³•"&gt;&lt;strong&gt;ä¸­é—´ä»¶é»˜è®¤ç®—æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Nginx&lt;/strong&gt;ï¼šè½®è¯¢ï¼ˆ&lt;code&gt;rr&lt;/code&gt;ï¼‰ã€åŠ æƒè½®è¯¢ï¼ˆ&lt;code&gt;wrr&lt;/code&gt;ï¼‰ã€IPå“ˆå¸Œï¼ˆ&lt;code&gt;ip_hash&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Spring Cloud&lt;/strong&gt;ï¼š&lt;code&gt;Ribbon&lt;/code&gt;æ”¯æŒ&lt;code&gt;ZoneAvoidanceRule&lt;/code&gt;ï¼ˆåŒºåŸŸæ„ŸçŸ¥+æƒé‡å“åº”ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LVS&lt;/strong&gt;ï¼šæ”¯æŒ8ç§ç®—æ³•ï¼Œå¦‚&lt;code&gt;WLC&lt;/code&gt;ï¼ˆåŠ æƒæœ€å°‘è¿æ¥ï¼‰ã€&lt;code&gt;LBLC&lt;/code&gt;ï¼ˆåŠ¨æ€ç›®æ ‡IPå“ˆå¸Œï¼‰&lt;a class="link" href="@ref" &gt;9,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å®¹ç¾ä¸é«˜å¯ç”¨"&gt;&lt;strong&gt;å®¹ç¾ä¸é«˜å¯ç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¥åº·æ£€æŸ¥&lt;/strong&gt;ï¼šç»“åˆHTTPæ¢é’ˆæˆ–TCPç«¯å£æ£€æµ‹ï¼Œè‡ªåŠ¨å‰”é™¤æ•…éšœèŠ‚ç‚¹ï¼ˆå¦‚HAProxyçš„&lt;code&gt;health check&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç†”æ–­é™çº§&lt;/strong&gt;ï¼šHystrix/Sentinelåœ¨è´Ÿè½½å‡è¡¡å±‚æ‹¦æˆªå¼‚å¸¸æµé‡ï¼Œé˜²æ­¢é›ªå´©&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è¿›é˜¶ä¼˜åŒ–æ–¹å‘"&gt;&lt;strong&gt;è¿›é˜¶ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªé€‚åº”ç®—æ³•&lt;/strong&gt;ï¼šAIé¢„æµ‹è´Ÿè½½è¶‹åŠ¿ï¼ˆå¦‚Google B4ç½‘ç»œä½¿ç”¨çš„Q-Learningæ¨¡å‹ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº§è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šå…¨å±€GSLBï¼ˆå¦‚AWS Route 53ï¼‰â†’ åŒºåŸŸSLB â†’ å¾®æœåŠ¡ç½‘å…³&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åè®®ä¼˜åŒ–&lt;/strong&gt;ï¼šHTTP/3çš„QUICåè®®å‡å°‘è¿æ¥å¼€é”€ï¼Œæå‡åŠ¨æ€è°ƒåº¦æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è´Ÿè½½å‡è¡¡ç®—æ³•æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„â€œæµé‡æŒ‡æŒ¥å®˜â€ï¼Œ&lt;strong&gt;é™æ€ç®—æ³•&lt;/strong&gt;ä»¥é…ç½®ç®€å•å–èƒœï¼Œ&lt;strong&gt;åŠ¨æ€ç®—æ³•&lt;/strong&gt;ä»¥å®æ—¶é€‚é…è§é•¿ã€‚é€‰å‹éœ€ç»¼åˆä¸šåŠ¡åœºæ™¯ã€æ•°æ®ç‰¹å¾åŠè¿ç»´æˆæœ¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŒæ„é›†ç¾¤é€‰&lt;strong&gt;è½®è¯¢&lt;/strong&gt;ï¼Œå¼‚æ„ç¯å¢ƒç”¨&lt;strong&gt;åŠ æƒ&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ä¼šè¯ä¿æŒéœ€&lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/strong&gt;ï¼Œå»¶è¿Ÿæ•æ„Ÿé &lt;strong&gt;æœ€çŸ­å“åº”&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;é•¿è¿æ¥æœåŠ¡&lt;strong&gt;æœ€å°‘è¿æ¥æ•°&lt;/strong&gt;ï¼Œæ™ºèƒ½è°ƒåº¦æ˜¯æœªæ¥è¶‹åŠ¿ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…åº”ç”¨ä¸­ï¼Œå»ºè®®é€šè¿‡Nginxï¼ˆä¸ƒå±‚ï¼‰æˆ–LVSï¼ˆå››å±‚ï¼‰çš„å¤šç§ç®—æ³•ç»„åˆæµ‹è¯•ï¼Œç»“åˆPrometheusç›‘æ§æŒ‡æ ‡æŒç»­è°ƒä¼˜&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="é™æµ"&gt;é™æµ
&lt;/h2&gt;&lt;p&gt;é™æµç®—æ³•æ˜¯ä¿æŠ¤ç³»ç»Ÿå…å—è¿‡è½½çš„å…³é”®æŠ€æœ¯ï¼Œé€šè¿‡åœ¨æµé‡é«˜å³°æœŸé™åˆ¶è¯·æ±‚é€Ÿç‡ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸»æµé™æµç®—æ³•çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åŸºç¡€ç®—æ³•è®¡æ•°å™¨ä¸æ»‘åŠ¨çª—å£"&gt;ğŸ”§ &lt;strong&gt;åŸºç¡€ç®—æ³•ï¼šè®¡æ•°å™¨ä¸æ»‘åŠ¨çª—å£&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å›ºå®šçª—å£è®¡æ•°å™¨ï¼ˆFixed Windowï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šå°†æ—¶é—´åˆ’åˆ†ä¸ºå›ºå®šçª—å£ï¼ˆå¦‚1ç§’ï¼‰ï¼Œç»Ÿè®¡çª—å£å†…è¯·æ±‚æ•°ï¼Œè¶…è¿‡é˜ˆå€¼åˆ™æ‹’ç»åç»­è¯·æ±‚&lt;a class="link" href="@ref" &gt;1,4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå®ç°ç®€å•ï¼ˆå¦‚Redisçš„&lt;code&gt;INCR&lt;/code&gt;å‘½ä»¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå­˜åœ¨&lt;strong&gt;è¾¹ç•Œçªåˆºé—®é¢˜&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼Œåœ¨1åˆ†é’Ÿçª—å£çš„æœ€åä¸€ç§’å’Œä¸‹ä¸€çª—å£çš„ç¬¬ä¸€ç§’é›†ä¸­è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´å®é™…æµé‡åŒå€äºé˜ˆå€¼&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå¯¹ç²¾åº¦è¦æ±‚ä¸é«˜çš„ä½é¢‘æ¥å£ï¼ˆå¦‚æ¯æ—¥é™é¢æœåŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ»‘åŠ¨çª—å£è®¡æ•°å™¨ï¼ˆSliding Windowï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šå°†å›ºå®šçª—å£ç»†åˆ†ä¸ºæ›´å°çš„æ—¶é—´ç‰‡ï¼ˆå¦‚100msï¼‰ï¼ŒåŠ¨æ€ç»Ÿè®¡æ»‘åŠ¨çª—å£å†…çš„è¯·æ±‚é‡ã€‚ä¾‹å¦‚ï¼Œ1ç§’çª—å£åˆ†ä¸º10ä¸ª100mså­çª—å£ï¼Œè¯·æ±‚é‡åŸºäºæœ€è¿‘1ç§’å†…çš„å­çª—å£ç´¯åŠ &lt;a class="link" href="@ref" &gt;4,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šç¼“è§£è¾¹ç•Œçªåˆºï¼Œæµé‡æ§åˆ¶æ›´å¹³æ»‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå­˜å‚¨å’Œè®¡ç®—å¼€é”€è¾ƒé«˜ï¼ˆéœ€ç»´æŠ¤æ—¶é—´ç‰‡é˜Ÿåˆ—ï¼‰&lt;a class="link" href="@ref" &gt;4,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šAPIç½‘å…³ã€éœ€è¦ç²¾ç¡®æ§æµçš„æœåŠ¡ï¼ˆå¦‚æ”¯ä»˜æ¥å£ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¡¶ç®—æ³•æ¼æ¡¶ä¸ä»¤ç‰Œæ¡¶"&gt;ğŸª£ &lt;strong&gt;æ¡¶ç®—æ³•ï¼šæ¼æ¡¶ä¸ä»¤ç‰Œæ¡¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¼æ¡¶ç®—æ³•ï¼ˆLeaky Bucketï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šè¯·æ±‚è¿›å…¥å®¹é‡å›ºå®šçš„â€œæ¡¶â€ï¼Œä»¥æ’å®šé€Ÿç‡æµå‡ºï¼ˆå¦‚æ¯ç§’10ä¸ªè¯·æ±‚ï¼‰ã€‚æ¡¶æ»¡æ—¶æ–°è¯·æ±‚è¢«ä¸¢å¼ƒæˆ–æ’é˜Ÿ&lt;a class="link" href="@ref" &gt;1,3,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;strong&gt;ç»å¯¹å¹³æ»‘æµé‡&lt;/strong&gt;ï¼Œè¾“å‡ºé€Ÿç‡æ’å®šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ— æ³•å¤„ç†çªå‘æµé‡ï¼Œå¯èƒ½é€ æˆè¯·æ±‚å»¶è¿Ÿæˆ–ä¸¢å¼ƒ&lt;a class="link" href="@ref" &gt;3,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæµé‡æ•´å½¢ï¼ˆå¦‚æ•°æ®åº“è®¿é—®é™æµï¼‰ï¼Œä¿æŠ¤ä¸‹æ¸¸è„†å¼±æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆToken Bucketï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šç³»ç»Ÿä»¥å›ºå®šé€Ÿç‡ï¼ˆå¦‚10ä¸ª/ç§’ï¼‰å‘æ¡¶ä¸­æ·»åŠ ä»¤ç‰Œã€‚è¯·æ±‚éœ€è·å–ä»¤ç‰Œæ‰èƒ½å¤„ç†ï¼Œæ¡¶ç©ºæ—¶è¯·æ±‚è¢«æ‹’ç»ã€‚æ¡¶å®¹é‡å…è®¸æš‚å­˜ä»¤ç‰Œï¼Œæ”¯æŒçªå‘æµé‡ï¼ˆå¦‚æ¡¶å®¹é‡100ï¼Œå¯ç¬é—´å¤„ç†100è¯·æ±‚ï¼‰&lt;a class="link" href="@ref" &gt;1,3,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;strong&gt;å…¼é¡¾å¹³æ»‘ä¸çªå‘æµé‡&lt;/strong&gt;ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå®ç°å¤æ‚åº¦è¾ƒé«˜ï¼ˆéœ€ç®¡ç†ä»¤ç‰Œç”Ÿæˆå’Œæ¶ˆè€—ï¼‰&lt;a class="link" href="@ref" &gt;3,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘åœºæ™¯ï¼ˆå¦‚ç§’æ€ç³»ç»Ÿã€çƒ­ç‚¹APIï¼‰ï¼Œå…¸å‹å·¥å…·æœ‰Guavaçš„&lt;code&gt;RateLimiter&lt;/code&gt;&lt;a class="link" href="@ref" &gt;11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¿›é˜¶ç®—æ³•ä¸åˆ†å¸ƒå¼åœºæ™¯"&gt;ğŸ“Š &lt;strong&gt;è¿›é˜¶ç®—æ³•ä¸åˆ†å¸ƒå¼åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ»‘åŠ¨æ—¥å¿—ç®—æ³•ï¼ˆSliding Logï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šè®°å½•æ¯ä¸ªè¯·æ±‚çš„æ—¶é—´æˆ³ï¼ŒåŠ¨æ€ç»Ÿè®¡æ—¶é—´çª—å£å†…çš„è¯·æ±‚æ•°ï¼ˆå¦‚Redisçš„&lt;code&gt;ZSET&lt;/code&gt;å­˜å‚¨æ—¶é—´æˆ³ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šç²¾åº¦é«˜ï¼Œå¯ç²¾ç¡®åˆ°æ¯«ç§’çº§æ§æµã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå­˜å‚¨å’Œè®¡ç®—æˆæœ¬é«˜ï¼Œä¸é€‚åˆè¶…é«˜å¹¶å‘&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šç²¾ç»†åŒ–é™æµï¼ˆå¦‚VIPç”¨æˆ·æ¥å£ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼é™æµ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®ç°æ–¹å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redis+Luaè„šæœ¬&lt;/strong&gt;ï¼šé€šè¿‡åŸå­æ“ä½œç»Ÿè®¡é›†ç¾¤è¯·æ±‚é‡ï¼ˆå¦‚&lt;code&gt;INCR&lt;/code&gt;+&lt;code&gt;EXPIRE&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘å…³å±‚é›†æˆ&lt;/strong&gt;ï¼šå¦‚Spring Cloud Gatewayçš„&lt;code&gt;RequestRateLimiter&lt;/code&gt;è¿‡æ»¤å™¨ï¼ŒåŸºäºä»¤ç‰Œæ¡¶å®ç°&lt;a class="link" href="@ref" &gt;11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒ‘æˆ˜&lt;/strong&gt;ï¼šéœ€è§£å†³æ—¶é’ŸåŒæ­¥ã€åˆ†å¸ƒå¼é”æ€§èƒ½ç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç®—æ³•å¯¹æ¯”ä¸é€‰å‹æŒ‡å—-1"&gt;âš–ï¸ &lt;strong&gt;ç®—æ³•å¯¹æ¯”ä¸é€‰å‹æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç®—æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;æµé‡å¹³æ»‘æ€§&lt;/th&gt;
&lt;th&gt;çªå‘æµé‡æ”¯æŒ&lt;/th&gt;
&lt;th&gt;ç²¾åº¦&lt;/th&gt;
&lt;th&gt;å®ç°å¤æ‚åº¦&lt;/th&gt;
&lt;th&gt;å…¸å‹åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å›ºå®šçª—å£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;ä½é¢‘æ¥å£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ»‘åŠ¨çª—å£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âš ï¸æœ‰é™&lt;/td&gt;
&lt;td&gt;ä¸­é«˜&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;APIç½‘å…³ã€æ”¯ä»˜æ¥å£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¼æ¡¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“è®¿é—®ã€æµé‡æ•´å½¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»¤ç‰Œæ¡¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…âœ…&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;ç§’æ€ç³»ç»Ÿã€é«˜å¹¶å‘API&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ»‘åŠ¨æ—¥å¿—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âš ï¸æœ‰é™&lt;/td&gt;
&lt;td&gt;æé«˜&lt;/td&gt;
&lt;td&gt;æé«˜&lt;/td&gt;
&lt;td&gt;ç²¾ç»†åŒ–æ§æµï¼ˆå¦‚æŒ‰ç”¨æˆ·IDï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="é€‰å‹å»ºè®®-1"&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿½æ±‚ç®€å•&lt;/strong&gt;ï¼šä½é¢‘åœºæ™¯ç”¨å›ºå®šçª—å£ï¼ˆå¦‚&lt;code&gt;Nginx&lt;/code&gt;çš„&lt;code&gt;limit_req&lt;/code&gt;æ¨¡å—ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹³è¡¡çªå‘ä¸ç¨³å®š&lt;/strong&gt;ï¼šä»¤ç‰Œæ¡¶ï¼ˆå¦‚ç”µå•†æŠ¢è´­ï¼‰&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»å¯¹å¹³æ»‘è¾“å‡º&lt;/strong&gt;ï¼šæ¼æ¡¶ï¼ˆå¦‚æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆè´¹é€Ÿç‡æ§åˆ¶ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼ç¯å¢ƒ&lt;/strong&gt;ï¼šRedisé›†ç¾¤+æ»‘åŠ¨çª—å£/ä»¤ç‰Œæ¡¶&lt;a class="link" href="@ref" &gt;11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®è·µæŠ€å·§ä¸ä¼˜åŒ–"&gt;âš™ï¸ &lt;strong&gt;å®è·µæŠ€å·§ä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;åŠ¨æ€è°ƒå‚ï¼š
&lt;ul&gt;
&lt;li&gt;åŸºäºå®æ—¶ç›‘æ§ï¼ˆå¦‚QPSã€ç³»ç»Ÿè´Ÿè½½ï¼‰åŠ¨æ€è°ƒæ•´é™æµé˜ˆå€¼&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šCPUè¶…è¿‡80%æ—¶è‡ªåŠ¨é™ä½ä»¤ç‰Œç”Ÿæˆé€Ÿç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ†çº§é™æµï¼š
&lt;ul&gt;
&lt;li&gt;æ ¸å¿ƒæ¥å£ä¸éæ ¸å¿ƒæ¥å£è®¾ç½®ä¸åŒé˜ˆå€¼ï¼Œä¿è¯æ ¸å¿ƒä¸šåŠ¡å¯ç”¨&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é™çº§ç­–ç•¥ç»“åˆï¼š
&lt;ul&gt;
&lt;li&gt;é™æµåè¿”å›å…œåº•æ•°æ®ï¼ˆå¦‚ç¼“å­˜æ•°æ®ï¼‰ã€æ’é˜Ÿé¡µé¢æˆ–é‡è¯•æŒ‡ä»¤&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é™æµç®—æ³•çš„æ ¸å¿ƒç›®æ ‡æ˜¯åœ¨&lt;strong&gt;ç³»ç»Ÿç¨³å®šæ€§&lt;/strong&gt;ä¸&lt;strong&gt;æµé‡åˆ©ç”¨ç‡&lt;/strong&gt;é—´å¯»æ±‚å¹³è¡¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®¡æ•°å™¨/æ»‘åŠ¨çª—å£&lt;/strong&gt;ï¼šé€‚åˆç®€å•åœºæ™¯æˆ–åˆ†å¸ƒå¼ç¯å¢ƒ&lt;a class="link" href="@ref" &gt;4,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼æ¡¶&lt;/strong&gt;ï¼šå¼ºçº¦æŸåœºæ™¯çš„é¦–é€‰ï¼ˆå¦‚é‡‘èç³»ç»Ÿï¼‰&lt;a class="link" href="@ref" &gt;3,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»¤ç‰Œæ¡¶&lt;/strong&gt;ï¼šé«˜å¹¶å‘ç³»ç»Ÿçš„é»„é‡‘æ ‡å‡†ï¼ˆå¦‚ç”µå•†ã€ç¤¾äº¤å¹³å°ï¼‰&lt;a class="link" href="@ref" &gt;1,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…åº”ç”¨ä¸­ï¼Œå¯ç»“åˆå¤šç§ç®—æ³•ï¼ˆå¦‚ç½‘å…³å±‚ç”¨ä»¤ç‰Œæ¡¶ï¼ŒæœåŠ¡å†…ç”¨æ»‘åŠ¨çª—å£ï¼‰ï¼Œå¹¶é€šè¿‡å‹æµ‹ç¡®å®šé˜ˆå€¼ã€‚æ¨èå·¥å…·ï¼š&lt;code&gt;Nginx&lt;/code&gt;ï¼ˆå››å±‚/ä¸ƒå±‚é™æµï¼‰ã€&lt;code&gt;Spring Cloud Gateway&lt;/code&gt;ï¼ˆåˆ†å¸ƒå¼ä»¤ç‰Œæ¡¶ï¼‰ã€&lt;code&gt;Redis&lt;/code&gt;+&lt;code&gt;Lua&lt;/code&gt;è„šæœ¬ï¼ˆé«˜ç²¾åº¦åˆ†å¸ƒå¼é™æµï¼‰&lt;a class="link" href="@ref" &gt;6,11&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æœåŠ¡é™çº§ç†”æ–­"&gt;æœåŠ¡é™çº§ã€ç†”æ–­
&lt;/h2&gt;&lt;p&gt;æœåŠ¡é™çº§ä¸ç†”æ–­æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­ä¿éšœç³»ç»Ÿç¨³å®šæ€§å’Œå¯ç”¨æ€§çš„æ ¸å¿ƒå®¹é”™æœºåˆ¶ã€‚å®ƒä»¬é€šè¿‡ä¸åŒçš„ç­–ç•¥åº”å¯¹é«˜å¹¶å‘ã€ä¾èµ–æ•…éšœç­‰å¼‚å¸¸åœºæ™¯ï¼Œé˜²æ­¢ç³»ç»Ÿé›ªå´©ã€‚ä»¥ä¸‹ä»åŸç†ã€åŒºåˆ«ã€å®è·µåŠå·¥ä¸šåº”ç”¨å±•å¼€æ·±åº¦è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç†”æ–­circuit-breakeræ•…éšœéš”ç¦»çš„ä¿é™©ä¸"&gt;âš™ï¸ &lt;strong&gt;ç†”æ–­ï¼ˆCircuit Breakerï¼‰ï¼šæ•…éšœéš”ç¦»çš„â€œä¿é™©ä¸â€&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒåŸç†"&gt;&lt;strong&gt;æ ¸å¿ƒåŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ç†”æ–­å™¨æ¨¡ä»¿ç”µè·¯ä¿é™©ä¸æœºåˆ¶ï¼Œå½“ä¾èµ–æœåŠ¡æ•…éšœè¶…è¿‡é˜ˆå€¼æ—¶ï¼Œä¸»åŠ¨åˆ‡æ–­è°ƒç”¨é“¾è·¯ï¼Œé¿å…èµ„æºè€—å°½å¼•å‘é›ªå´©ã€‚å…¶æ ¸å¿ƒæ˜¯&lt;strong&gt;çŠ¶æ€æœºæ¨¡å‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é—­ï¼ˆClosedï¼‰&lt;/strong&gt;ï¼šæ­£å¸¸è°ƒç”¨ï¼ŒæŒç»­ç›‘æ§å¤±è´¥ç‡ï¼ˆå¦‚é”™è¯¯ç‡ &amp;gt; 50%ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰“å¼€ï¼ˆOpenï¼‰&lt;/strong&gt;ï¼šç›´æ¥æ‹’ç»è¯·æ±‚ï¼Œä¸è°ƒç”¨æ•…éšœæœåŠ¡ï¼ˆå¦‚å†·å´30ç§’ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠå¼€ï¼ˆHalf-Openï¼‰&lt;/strong&gt;ï¼šè¯•æ¢æ€§æ”¾è¡Œå°‘é‡è¯·æ±‚ï¼ŒæˆåŠŸåˆ™å…³é—­ç†”æ–­ï¼Œå¤±è´¥åˆ™é‡æ–°æ‰“å¼€&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è§¦å‘æ¡ä»¶"&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯ç‡è¶…æ ‡&lt;/strong&gt;ï¼šä¾‹å¦‚10ç§’å†…é”™è¯¯è°ƒç”¨å æ¯” &amp;gt; 60%&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å“åº”è¶…æ—¶&lt;/strong&gt;ï¼šå¦‚æ¥å£å¹³å‡å“åº”æ—¶é—´ &amp;gt; 2ç§’&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘è¿‡è½½&lt;/strong&gt;ï¼šçº¿ç¨‹æ± /è¿æ¥æ± èµ„æºè€—å°½&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…¸å‹åº”ç”¨åœºæ™¯"&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¥å£è¿ç»­è¶…æ—¶ï¼Œè§¦å‘ç†”æ–­é¿å…æ”¯ä»˜æœåŠ¡é˜»å¡&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“è¿æ¥æ± è€—å°½æ—¶ï¼Œç†”æ–­è¯»åº“è¯·æ±‚ï¼Œä¿æŠ¤æ ¸å¿ƒå†™æ“ä½œ&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æœåŠ¡é™çº§degradationä¼˜é›…å¤±æ•ˆçš„å¤‡èƒæ–¹æ¡ˆ"&gt;ğŸ›¡ï¸ &lt;strong&gt;æœåŠ¡é™çº§ï¼ˆDegradationï¼‰ï¼šä¼˜é›…å¤±æ•ˆçš„â€œå¤‡èƒæ–¹æ¡ˆâ€&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç­–ç•¥"&gt;&lt;strong&gt;æ ¸å¿ƒç­–ç•¥&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;åœ¨ç³»ç»Ÿå‹åŠ›è¿‡å¤§æ—¶ï¼Œ&lt;strong&gt;ä¸»åŠ¨å…³é—­éæ ¸å¿ƒåŠŸèƒ½&lt;/strong&gt;ï¼Œç¡®ä¿æ ¸å¿ƒé“¾è·¯å¯ç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½é™çº§&lt;/strong&gt;ï¼šå…³é—­å•†å“æ¨èã€ç§¯åˆ†å…‘æ¢ç­‰æ¬¡è¦åŠŸèƒ½&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®é™çº§&lt;/strong&gt;ï¼šè¿”å›ç¼“å­˜æ•°æ®ï¼ˆå¦‚Redisï¼‰ã€é™æ€é»˜è®¤å€¼ï¼ˆå¦‚â€œç³»ç»Ÿç¹å¿™â€ï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµç¨‹é™çº§&lt;/strong&gt;ï¼šç®€åŒ–ä¸šåŠ¡æµç¨‹ï¼ˆå¦‚å…å¯†æ”¯ä»˜è·³è¿‡é£æ§æ ¡éªŒï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è§¦å‘æ–¹å¼"&gt;&lt;strong&gt;è§¦å‘æ–¹å¼&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¢«åŠ¨è§¦å‘&lt;/strong&gt;ï¼šç”±ç†”æ–­ã€è¶…æ—¶æˆ–å¼‚å¸¸è‡ªåŠ¨æ¿€æ´»&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸»åŠ¨è§¦å‘&lt;/strong&gt;ï¼šåŸºäºç³»ç»Ÿè´Ÿè½½ï¼ˆå¦‚CPU &amp;gt; 80%ï¼‰æˆ–ä¸šåŠ¡ç­–ç•¥ï¼ˆå¦‚å¤§ä¿ƒå‰é¢„è®¾ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç”¨æˆ·ä½“éªŒè®¾è®¡"&gt;&lt;strong&gt;ç”¨æˆ·ä½“éªŒè®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— æ„ŸçŸ¥é™çº§&lt;/strong&gt;ï¼šç”¨ç¼“å­˜æ•°æ®æ›¿ä»£å®æ—¶æŸ¥è¯¢ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‹å¥½æç¤º&lt;/strong&gt;ï¼šå‰ç«¯å±•ç¤ºâ€œæœåŠ¡ç¹å¿™ï¼Œå±•ç¤ºé»˜è®¤æ¨èâ€&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç†”æ–­-vs-é™çº§æ ¸å¿ƒåŒºåˆ«ä¸ååŒ"&gt;âš–ï¸ &lt;strong&gt;ç†”æ–­ vs é™çº§ï¼šæ ¸å¿ƒåŒºåˆ«ä¸ååŒ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;ç†”æ–­&lt;/th&gt;
&lt;th&gt;é™çº§&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é˜²æ­¢æ•…éšœæ‰©æ•£ï¼ˆç³»ç»Ÿä¿æŠ¤ï¼‰&lt;/td&gt;
&lt;td&gt;ä¿éšœæ ¸å¿ƒåŠŸèƒ½ï¼ˆä¸šåŠ¡ä¿åº•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–æœåŠ¡æ•…éšœï¼ˆé”™è¯¯ç‡/è¶…æ—¶ï¼‰&lt;/td&gt;
&lt;td&gt;èµ„æºä¸è¶³æˆ–ä¸»åŠ¨é™çº§ç­–ç•¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½œç”¨èŒƒå›´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•ç‚¹æœåŠ¡è°ƒç”¨é“¾è·¯&lt;/td&gt;
&lt;td&gt;å…¨å±€åŠŸèƒ½æ¨¡å—æˆ–ä¸šåŠ¡æµç¨‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¢å¤æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨æ¢å¤ï¼ˆåŠå¼€çŠ¶æ€æ¢æµ‹ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€äººå·¥ä»‹å…¥æˆ–è´Ÿè½½é™ä½åæ¢å¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åŠ¨ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿«é€Ÿå¤±è´¥ï¼ˆFail-Fastï¼‰&lt;/td&gt;
&lt;td&gt;é™é»˜å¤±è´¥ï¼ˆFail-Silentï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ååŒæµç¨‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph TD
A[ç”¨æˆ·è¯·æ±‚] --&amp;gt; B[è°ƒç”¨æœåŠ¡X]
B -- ç†”æ–­è§¦å‘ --&amp;gt; C[åœæ­¢è°ƒç”¨X]
C --&amp;gt; D[æ‰§è¡Œé™çº§é€»è¾‘]
D --&amp;gt; E[è¿”å›ç¼“å­˜/é»˜è®¤å€¼]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç¤ºä¾‹ï¼šç”µå•†è®¢å•æœåŠ¡è°ƒç”¨æ”¯ä»˜æ¥å£è¶…æ—¶ â†’ ç†”æ–­æ”¯ä»˜è°ƒç”¨ â†’ é™çº§ä¸ºâ€œå»¶è¿Ÿæ”¯ä»˜â€æç¤º&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä¸šçº§å®è·µä¸æ¡†æ¶"&gt;ğŸ­ &lt;strong&gt;å·¥ä¸šçº§å®è·µä¸æ¡†æ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç†”æ–­å®ç°resilience4jsentinel"&gt;&lt;strong&gt;ç†”æ–­å®ç°ï¼ˆResilience4j/Sentinelï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// Resilience4j ç†”æ–­é…ç½®
CircuitBreakerConfig config = CircuitBreakerConfig.custom()
.failureRateThreshold(50) // é”™è¯¯ç‡é˜ˆå€¼50%
.waitDurationInOpenState(Duration.ofSeconds(30))
.slidingWindowType(SlidingWindowType.COUNT_BASED)
.build();
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å…³é”®ä¼˜åŒ–&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€é˜ˆå€¼&lt;/strong&gt;ï¼šæ ¹æ®P99å»¶è¿Ÿè‡ªåŠ¨è°ƒæ•´ç†”æ–­é˜ˆå€¼&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸ç™½åå•&lt;/strong&gt;ï¼šå¿½ç•¥ä¸šåŠ¡å¼‚å¸¸ï¼ˆå¦‚å‚æ•°é”™è¯¯ï¼‰ï¼Œé¿å…è¯¯è§¦å‘&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é™çº§å®ç°spring-cloud-gateway--redis"&gt;&lt;strong&gt;é™çº§å®ç°ï¼ˆSpring Cloud Gateway + Redisï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// Feignå®¢æˆ·ç«¯é™çº§ç¤ºä¾‹
@FeignClient(name = &amp;#34;user-service&amp;#34;, fallback = UserFallback.class)
public interface UserService {
@GetMapping(&amp;#34;/user/{id}&amp;#34;)
User getUser(@PathVariable Long id);
}
@Component
public class UserFallback implements UserService {
@Override
public User getUser(Long id) {
return Redis.get(&amp;#34;user:&amp;#34; + id); // è¿”å›ç¼“å­˜æ•°æ®
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å¤šçº§é™çº§ç­–ç•¥&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Level1ï¼šè¿”å›æœ¬åœ°ç¼“å­˜&lt;/li&gt;
&lt;li&gt;Level2ï¼šè¿”å›é€šç”¨é»˜è®¤å€¼&lt;/li&gt;
&lt;li&gt;Level3ï¼šå…³é—­éæ ¸å¿ƒåŠŸèƒ½&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¤§å‚å®æˆ˜ç»éªŒæŠ–éŸ³é˜¿é‡Œè…¾è®¯"&gt;ğŸ“Š &lt;strong&gt;å¤§å‚å®æˆ˜ç»éªŒï¼ˆæŠ–éŸ³/é˜¿é‡Œ/è…¾è®¯ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç†”æ–­ç²¾ç»†åŒ–&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æŠ–éŸ³ï¼šåŸºäºå†å²æµé‡é¢„æµ‹ç†”æ–­é˜ˆå€¼ï¼ŒåŠ¨æ€è°ƒæ•´æ¢æµ‹è¯·æ±‚æ¯”ä¾‹&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;é˜¿é‡Œï¼šç†”æ–­æ¢å¤åï¼Œé€æ­¥æ”¾é‡ï¼ˆå¦‚10% â†’ 50% â†’ 100%ï¼‰é¿å…äºŒæ¬¡é›ªå´©&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;é™çº§ç”¨æˆ·ä½“éªŒ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è…¾è®¯è§†é¢‘ï¼šåœ¨CDNæ•…éšœæ—¶é™çº§ä¸ºä½ç”»è´¨ï¼Œä¿è¯è§†é¢‘å¯æ’­&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;æ‹¼å¤šå¤šï¼šå¤§ä¿ƒæœŸé—´å…³é—­â€œè´­ç‰©è½¦åŠ¨ç”»ç‰¹æ•ˆâ€ï¼Œå‡å°‘å‰ç«¯èµ„æºæ¶ˆè€—&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;å…¨é“¾è·¯ç›‘æ§&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åä¸ºï¼šé€šè¿‡APMå·¥å…·ï¼ˆå¦‚SkyWalkingï¼‰è¿½è¸ªç†”æ–­/é™çº§é“¾è·¯ï¼Œå®æ—¶å‘Šè­¦&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é¿å‘æŒ‡å—"&gt;âš ï¸ &lt;strong&gt;é¿å‘æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç†”æ–­è¯¯è§¦å‘&lt;/strong&gt;ï¼šå¿½ç•¥ä¸šåŠ¡å¼‚å¸¸ï¼ˆå¦‚&lt;code&gt;InvalidRequestException&lt;/code&gt;ï¼‰ï¼Œä»…ç›‘æ§è¶…æ—¶å’Œç³»ç»Ÿé”™è¯¯&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™çº§è¿‡åº¦&lt;/strong&gt;ï¼šé¿å…æ ¸å¿ƒåŠŸèƒ½é™çº§ï¼ˆå¦‚æ”¯ä»˜ä¸å¯ç”¨ï¼‰ï¼Œéœ€æ˜ç¡®ä¼˜å…ˆçº§åˆ’åˆ†&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¢å¤æ»å&lt;/strong&gt;ï¼šç†”æ–­åŠå¼€çŠ¶æ€éœ€æ­é…å¥åº·æ£€æŸ¥ï¼Œè‡ªåŠ¨æ¢å¤æœåŠ¡è°ƒç”¨&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§ç¼ºå¤±&lt;/strong&gt;ï¼šç†”æ–­åˆ‡æ¢ã€é™çº§æ¯”ä¾‹ç­‰æŒ‡æ ‡æ¥å…¥Prometheusï¼Œé©±åŠ¨ç­–ç•¥ä¼˜åŒ–&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç†”æ–­æ˜¯ç›¾&lt;/strong&gt;ï¼šå¿«é€Ÿéš”ç¦»æ•…éšœæœåŠ¡ï¼Œé˜²æ­¢é›ªå´©æ‰©æ•£ï¼ˆé€‚ç”¨&lt;strong&gt;ä¾èµ–æ•…éšœ&lt;/strong&gt;åœºæ™¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™çº§æ˜¯è·¯&lt;/strong&gt;ï¼šç‰ºç‰²éæ ¸å¿ƒåŠŸèƒ½ï¼Œä¿éšœä¸»é“¾è·¯å¯ç”¨ï¼ˆé€‚ç”¨&lt;strong&gt;èµ„æºè¿‡è½½&lt;/strong&gt;åœºæ™¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ€ä½³å®è·µï¼š
&lt;ul&gt;
&lt;li&gt;ç½‘å…³å±‚é›†æˆç†”æ–­ï¼ˆå¦‚Spring Cloud Gatewayï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸šåŠ¡å±‚é™çº§ç­–ç•¥ä¸ç¼“å­˜/æ¶ˆæ¯é˜Ÿåˆ—è”åŠ¨ï¼ˆå¦‚Redis + MQï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒå…¬å¼ï¼š&lt;strong&gt;ç›‘æ§ â†’ ç†”æ–­ â†’ é™çº§ â†’ æ¢å¤ â†’ ä¼˜åŒ–&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é™„ï¼šæŠ€æœ¯é€‰å‹æ¨è&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Javaç”Ÿæ€ï¼šResilience4jï¼ˆç†”æ–­ï¼‰ + Sentinelï¼ˆé™çº§é™æµï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;äº‘åŸç”Ÿï¼šIstioï¼ˆç½‘æ ¼å±‚ç†”æ–­ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="åˆ†å¸ƒå¼id"&gt;åˆ†å¸ƒå¼ID
&lt;/h2&gt;&lt;p&gt;åˆ†å¸ƒå¼IDæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç¡®ä¿å…¨å±€å”¯ä¸€æ ‡è¯†çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œå°¤å…¶åœ¨å¤šèŠ‚ç‚¹ã€é«˜å¹¶å‘åœºæ™¯ä¸‹è‡³å…³é‡è¦ã€‚ä»¥ä¸‹ä»åŸºç¡€åˆ°è¿›é˜¶çš„è§£å†³æ–¹æ¡ˆåˆ†ç±»è§£æï¼Œç»“åˆåŸç†ã€ä¼˜ç¼ºç‚¹åŠé€‚ç”¨åœºæ™¯ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åŸºç¡€è§£å†³æ–¹æ¡ˆ"&gt;âš™ï¸ &lt;strong&gt;åŸºç¡€è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="uuidé€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦"&gt;&lt;strong&gt;UUIDï¼ˆé€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåŸºäºæ—¶é—´æˆ³ã€MACåœ°å€å’Œéšæœºæ•°ç”Ÿæˆ128ä½å­—ç¬¦ä¸²ï¼ˆå¦‚ &lt;code&gt;f47ac10b-58cc-4372-a567-0e02b2c3d479&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæœ¬åœ°ç”Ÿæˆæ— ç½‘ç»œä¾èµ–ï¼Œæ€§èƒ½é«˜ï¼ˆ200ä¸‡/ç§’ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;æ— åºæ€§å¯¼è‡´æ•°æ®åº“ç´¢å¼•æ•ˆç‡ä¸‹é™30%&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;128ä½å­˜å‚¨ç©ºé—´å¤§ï¼ˆ36å­—ç¬¦ï¼‰ï¼Œä¸é€‚åˆä½œä¸ºä¸»é”®&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ—¥å¿—è¿½è¸ªã€ä¸´æ—¶ä¼šè¯IDç­‰éæ ¸å¿ƒä¸šåŠ¡&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®åº“è‡ªå¢id"&gt;&lt;strong&gt;æ•°æ®åº“è‡ªå¢ID&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåˆ©ç”¨æ•°æ®åº“çš„ &lt;code&gt;AUTO_INCREMENT&lt;/code&gt; ç”Ÿæˆè¿ç»­IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå®ç°ç®€å•ï¼ŒIDæœ‰åºä¸”ç´¢å¼•é«˜æ•ˆ&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;å•ç‚¹æ•…éšœé£é™©ï¼Œæ•°æ®åº“å®•æœºå¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ç“¶é¢ˆï¼ˆæ¯ç§’ç”Ÿæˆé‡å—é™äºæ•°æ®åº“å†™å…¥èƒ½åŠ›ï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;ï¼šåˆ†åº“åˆ†è¡¨æ—¶è®¾ç½®ä¸åŒåˆå§‹å€¼å’Œæ­¥é•¿ï¼ˆå¦‚DB1åˆå§‹1æ­¥é•¿2ï¼ŒDB2åˆå§‹2æ­¥é•¿2ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è¿›é˜¶è§£å†³æ–¹æ¡ˆ"&gt;ğŸš€ &lt;strong&gt;è¿›é˜¶è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å·æ®µæ¨¡å¼segment"&gt;&lt;strong&gt;å·æ®µæ¨¡å¼ï¼ˆSegmentï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šä»æ•°æ®åº“æ‰¹é‡è·å–IDæ®µï¼ˆå¦‚1-1000ï¼‰ï¼Œæœ¬åœ°ç¼“å­˜å¹¶é€æ­¥åˆ†é…&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;å‡å°‘æ•°æ®åº“è®¿é—®ï¼ˆå•æ¬¡è·å–æ”¯æŒåƒæ¬¡IDç”Ÿæˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ€§èƒ½æå‡è‡³10ä¸‡/ç§’ï¼Œæ”¯æŒé«˜å¹¶å‘&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæœåŠ¡é‡å¯å¯èƒ½å¯¼è‡´IDç©ºæ´ï¼ˆæœªä½¿ç”¨çš„å·æ®µä¸¢å¤±ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä¸šå®è·µ&lt;/strong&gt;ï¼šç¾å›¢Leafé€šè¿‡åŒBufferé¢„åŠ è½½å·æ®µï¼Œé¿å…åˆ†é…ç­‰å¾…&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="redisè‡ªå¢id"&gt;&lt;strong&gt;Redisè‡ªå¢ID&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåˆ©ç”¨ &lt;code&gt;INCR&lt;/code&gt; æˆ– &lt;code&gt;INCRBY&lt;/code&gt; å‘½ä»¤åŸå­æ€§ç”Ÿæˆé€’å¢IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ€§èƒ½ä¼˜å¼‚ï¼ˆ15ä¸‡/ç§’ï¼‰ï¼Œå¤©ç„¶æœ‰åº&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;ä¾èµ–Rediså¯ç”¨æ€§ï¼ŒæŒä¹…åŒ–é—®é¢˜å¯èƒ½å¯¼è‡´IDé‡å¤ï¼ˆRDBå¿«ç…§ä¸¢å¤±ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é›†ç¾¤éƒ¨ç½²éœ€è®¾ç½®æ­¥é•¿ï¼ˆå¦‚èŠ‚ç‚¹1æ­¥é•¿5ï¼ŒèŠ‚ç‚¹2æ­¥é•¿5ï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæŒ‰æ—¥ç”Ÿæˆçš„æµæ°´å·ï¼ˆå¦‚è®¢å•å·=æ—¥æœŸ+Redisè‡ªå¢æ•°ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é›ªèŠ±ç®—æ³•snowflake"&gt;&lt;strong&gt;é›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼š64ä½ç»“æ„ = &lt;strong&gt;æ—¶é—´æˆ³ï¼ˆ41ä½ï¼‰&lt;/strong&gt; + &lt;strong&gt;æœºå™¨IDï¼ˆ10ä½ï¼‰&lt;/strong&gt; + &lt;strong&gt;åºåˆ—å·ï¼ˆ12ä½ï¼‰&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜æ€§èƒ½ï¼ˆå•æœº50ä¸‡/ç§’ï¼‰ï¼Œè¶‹åŠ¿é€’å¢åˆ©äºç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;æ— ä¸­å¿ƒä¾èµ–ï¼Œå¯ç”¨æ€§é«˜&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ—¶é’Ÿå›æ‹¨å¯èƒ½å¯¼è‡´IDé‡å¤ï¼ˆéœ€é€šè¿‡å¼‚å¸¸æ£€æµ‹æˆ–NTPåŒæ­¥è§£å†³ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ”¹è¿›æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;ç™¾åº¦UidGeneratorï¼šæ”¯æŒè‡ªå®šä¹‰æ—¶é—´æˆ³å’Œæœºå™¨IDä½æ•°ï¼Œååé‡æå‡è‡³600ä¸‡/ç§’&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ·»åŠ ä¸šåŠ¡æ ‡è¯†ä½ï¼ˆå¦‚ç”µå•†è®¢å•IDå‰4ä½æ ‡è¯†ä¸šåŠ¡ç±»å‹ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä¸šçº§è§£å†³æ–¹æ¡ˆ"&gt;ğŸ­ &lt;strong&gt;å·¥ä¸šçº§è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç¾å›¢leaf"&gt;&lt;strong&gt;ç¾å›¢Leaf&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶æ„&lt;/strong&gt;ï¼šæ”¯æŒå·æ®µæ¨¡å¼ä¸Snowflakeæ¨¡å¼&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;å·æ®µæ¨¡å¼ï¼šåŒBufferé¢„åŠ è½½ã€DBåˆ†åº“åˆ†è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;Snowflakeæ¨¡å¼ï¼šZooKeeperåˆ†é…æœºå™¨IDï¼Œé¿å…æ‰‹åŠ¨é…ç½®&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé‡‘èäº¤æ˜“ç­‰é«˜ä¸€è‡´æ€§éœ€æ±‚ç³»ç»Ÿ&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ»´æ»´tinyid"&gt;&lt;strong&gt;æ»´æ»´TinyID&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåŸºäºå·æ®µæ¨¡å¼ï¼Œæ”¯æŒHTTP/RPCè°ƒç”¨è·å–IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šåŠ¨æ€æ‰©å®¹ã€å¤šèŠ‚ç‚¹åè°ƒï¼Œé€‚åˆç‰©è”ç½‘è®¾å¤‡æ ‡è¯†&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ksuidcuid"&gt;&lt;strong&gt;KSUID/CUID&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;KSUID&lt;/strong&gt;ï¼šç»“åˆæ—¶é—´æˆ³å’Œéšæœºæ•°ï¼ˆå¦‚ &lt;code&gt;0o5Fs0EELR0fUjHjbCnEtdUwQe3&lt;/code&gt;ï¼‰ï¼Œå¯æ’åºä¸”æ— å†²çªé£é™©&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CUID&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯ç”Ÿæˆå¯è¯»IDï¼ˆå¦‚ &lt;code&gt;ckp7qd9g7000001mi5myb8zfp&lt;/code&gt;ï¼‰ï¼Œé€‚ç”¨äºå‰ç«¯åº”ç”¨&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹æŒ‡å—"&gt;âš–ï¸ &lt;strong&gt;æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;ååé‡&lt;/th&gt;
&lt;th&gt;æœ‰åºæ€§&lt;/th&gt;
&lt;th&gt;ä¾èµ–é¡¹&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;UUID&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;200ä¸‡/ç§’&lt;/td&gt;
&lt;td&gt;æ— åº&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;æ—¥å¿—è¿½è¸ªã€ä¸´æ—¶ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Redis&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;15ä¸‡/ç§’&lt;/td&gt;
&lt;td&gt;ä¸¥æ ¼é€’å¢&lt;/td&gt;
&lt;td&gt;Redis&lt;/td&gt;
&lt;td&gt;æŒ‰æ—¥æµæ°´å·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å·æ®µæ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;10ä¸‡/ç§’&lt;/td&gt;
&lt;td&gt;åˆ†æ®µé€’å¢&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·IDã€é‡‘èäº¤æ˜“ï¼ˆLeafä¼˜åŒ–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Snowflake&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;50ä¸‡/ç§’&lt;/td&gt;
&lt;td&gt;è¶‹åŠ¿é€’å¢&lt;/td&gt;
&lt;td&gt;æ—¶é’ŸåŒæ­¥&lt;/td&gt;
&lt;td&gt;ç”µå•†è®¢å•ã€é«˜å¹¶å‘ä¸šåŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;KSUID&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;100ä¸‡/ç§’&lt;/td&gt;
&lt;td&gt;æ—¶é—´æœ‰åº&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼æ—¥å¿—ã€æ’åºéœ€æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="é€‰å‹å»ºè®®-2"&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”µå•†è®¢å•&lt;/strong&gt;ï¼šSnowflakeï¼ˆè¶‹åŠ¿é€’å¢ + é«˜æ€§èƒ½ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡‘èäº¤æ˜“&lt;/strong&gt;ï¼šLeaf-Segmentï¼ˆåŒBufferé¢„åŠ è½½ + é«˜å¯ç”¨ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰©è”ç½‘è®¾å¤‡&lt;/strong&gt;ï¼šTinyIDï¼ˆåŠ¨æ€æ‰©ç¼©å®¹ + å¤šèŠ‚ç‚¹åè°ƒï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯ç”Ÿæˆ&lt;/strong&gt;ï¼šCUIDï¼ˆå‰ç«¯è‡ªä¸»ç”Ÿæˆ + å¯è¯»æ€§ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡åŸåˆ™ä¸å‰æ²¿è¶‹åŠ¿"&gt;ğŸ’¡ &lt;strong&gt;è®¾è®¡åŸåˆ™ä¸å‰æ²¿è¶‹åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ ¸å¿ƒåŸåˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å”¯ä¸€æ€§&lt;/strong&gt;ï¼šè·¨èŠ‚ç‚¹/æ—¶é—´æ— å†²çªï¼ˆå¦‚Snowflakeæœºå™¨IDéš”ç¦»ï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯ç”¨æ€§&lt;/strong&gt;ï¼šé¿å…å•ç‚¹æ•…éšœï¼ˆå¦‚Leafå¤šèŠ‚ç‚¹éƒ¨ç½²ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;ï¼šæ”¯æŒä¸šåŠ¡å¢é•¿ï¼ˆå¦‚KSUIDæ—¶é—´æˆ³æ”¯æŒ69å¹´ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;è¶‹åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ··åˆæ–¹æ¡ˆ&lt;/strong&gt;ï¼šSnowflake + å·æ®µæ¨¡å¼åº”å¯¹æ—¶é’Ÿå›æ‹¨ä¸åˆ†æ®µæ‰©å®¹&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨å¢å¼º&lt;/strong&gt;ï¼šæ··æ·†IDç»“æ„é˜²æ­¢ä¸šåŠ¡ä¿¡æ¯æ³„éœ²ï¼ˆå¦‚è®¢å•é‡æ¨æµ‹ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é¿å‘æŒ‡å—&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ—¶é’Ÿå›æ‹¨é—®é¢˜ï¼šSnowflakeéœ€ç»‘å®šNTPæœåŠ¡ + å¼‚å¸¸æ£€æµ‹æœºåˆ¶&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å·æ®µæµªè´¹ï¼šLeafåŠ¨æ€è°ƒæ•´æ­¥é•¿ï¼Œæ ¹æ®è´Ÿè½½é¢„æµ‹åˆ†é…&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚
åˆ†å¸ƒå¼IDä¸ä»…æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œæ›´æ˜¯ä¸šåŠ¡ä¸æ¶æ„çš„å¹³è¡¡ç»“æœã€‚å»ºè®®ç»“åˆå‹æµ‹ï¼ˆå¦‚JMeterï¼‰éªŒè¯æ–¹æ¡ˆæé™ï¼Œå¹¶é€šè¿‡APMå·¥å…·ï¼ˆSkyWalkingï¼‰ç›‘æ§IDå†²çªç‡ï¼ŒæŒç»­ä¼˜åŒ–&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="é›ªèŠ±ç®—æ³•"&gt;é›ªèŠ±ç®—æ³•
&lt;/h2&gt;&lt;p&gt;Snowflake é›ªèŠ±ç®—æ³•æ˜¯ Twitter å¼€æºçš„åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆç®—æ³•ï¼Œé€šè¿‡æ—¶é—´æˆ³ã€æœºå™¨æ ‡è¯†å’Œåºåˆ—å·çš„ç»„åˆï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç”Ÿæˆå…¨å±€å”¯ä¸€ä¸”è¶‹åŠ¿é€’å¢çš„ IDã€‚å…¶æ ¸å¿ƒè®¾è®¡å…¼é¡¾é«˜æ€§èƒ½ä¸æœ‰åºæ€§ï¼Œé€‚ç”¨äºé«˜å¹¶å‘åœºæ™¯ï¼ˆå¦‚ç”µå•†è®¢å•ã€åˆ†å¸ƒå¼æ•°æ®åº“ï¼‰ã€‚ä»¥ä¸‹ä»åŸç†ã€é—®é¢˜ã€ä¼˜åŒ–åŠå·¥ä¸šå®è·µå±•å¼€åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç®—æ³•åŸç†ä¸ç»“æ„"&gt;âš™ï¸ &lt;strong&gt;ç®—æ³•åŸç†ä¸ç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Snowflake ç”Ÿæˆçš„ ID æ˜¯ä¸€ä¸ª &lt;strong&gt;64 ä½&lt;/strong&gt;çš„ long å‹æ•´æ•°ï¼Œç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»„æˆéƒ¨åˆ†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å–å€¼èŒƒå›´&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¬¦å·ä½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1 bit&lt;/td&gt;
&lt;td&gt;å›ºå®šä¸º 0ï¼ˆè¡¨ç¤ºæ­£æ•°ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¶é—´æˆ³&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;41 bit&lt;/td&gt;
&lt;td&gt;è®°å½•ä¸èµ·å§‹æ—¶é—´ï¼ˆå¦‚ &lt;code&gt;2010-01-01&lt;/code&gt;ï¼‰çš„æ¯«ç§’å·®&lt;/td&gt;
&lt;td&gt;æœ€å¤šæ”¯æŒ &lt;strong&gt;69 å¹´&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœºå™¨æ ‡è¯†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;10 bit&lt;/td&gt;
&lt;td&gt;æ‹†åˆ†ä½ï¼š5 bit æ•°æ®ä¸­å¿ƒ ID + 5 bit èŠ‚ç‚¹ IDï¼ˆæ”¯æŒ &lt;strong&gt;1024 ä¸ªèŠ‚ç‚¹&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æ•°æ®ä¸­å¿ƒï¼š0&lt;del&gt;31ï¼ŒèŠ‚ç‚¹ï¼š0&lt;/del&gt;31&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åºåˆ—å·&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;12 bit&lt;/td&gt;
&lt;td&gt;åŒä¸€æ¯«ç§’å†…çš„è‡ªå¢åºå·ï¼ˆæ¯æ¯«ç§’æœ€å¤šç”Ÿæˆ &lt;strong&gt;4096 ä¸ª ID&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;0~4095&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿæˆæµç¨‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;è·å–å½“å‰æ¯«ç§’çº§æ—¶é—´æˆ³ &lt;code&gt;timestamp&lt;/code&gt;ï¼Œè®¡ç®—ä¸èµ·å§‹æ—¶é—´ &lt;code&gt;twepoch&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;1288834974657L&lt;/code&gt;ï¼‰çš„å·®å€¼&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æ—¶é—´æˆ³å›æ‹¨ï¼ˆ&lt;code&gt;timestamp &amp;lt; lastTimestamp&lt;/code&gt;ï¼‰ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;åŒä¸€æ¯«ç§’å†…ï¼šåºåˆ—å· &lt;code&gt;sequence&lt;/code&gt; è‡ªå¢ï¼ˆ&lt;code&gt;sequence = (sequence + 1) &amp;amp; sequenceMask&lt;/code&gt;ï¼‰ï¼Œè‹¥æº¢å‡ºåˆ™ç­‰å¾…ä¸‹ä¸€æ¯«ç§’&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ‹¼æ¥å„éƒ¨åˆ†ï¼š
&lt;code&gt;ID = (æ—¶é—´æˆ³å·®å€¼ &amp;lt;&amp;lt; 22) | (æ•°æ®ä¸­å¿ƒID &amp;lt;&amp;lt; 17) | (èŠ‚ç‚¹ID &amp;lt;&amp;lt; 12) | åºåˆ—å·&lt;/code&gt;&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"&gt;âš ï¸ &lt;strong&gt;æ ¸å¿ƒé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ—¶é’Ÿå›æ‹¨é—®é¢˜"&gt;&lt;strong&gt;æ—¶é’Ÿå›æ‹¨é—®é¢˜&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;ï¼šæœåŠ¡å™¨æ—¶é—´è¢«æ‰‹åŠ¨è°ƒæ•´æˆ– NTP åŒæ­¥å¯¼è‡´æ—¶é—´å€’é€€&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åæœ&lt;/strong&gt;ï¼šç”Ÿæˆé‡å¤ IDï¼Œç ´åå”¯ä¸€æ€§ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾…æ—¶é’Ÿè¿½ä¸Š&lt;/strong&gt;ï¼šè‹¥å›æ‹¨æ—¶é—´çŸ­ï¼ˆå¦‚ â‰¤ 100msï¼‰ï¼Œé˜»å¡çº¿ç¨‹ç›´åˆ°æ—¶é—´æ¢å¤&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ—¶é—´æˆ³ä½æ•°&lt;/strong&gt;ï¼šä» 41 ä½å¢è‡³ 42 ä½ï¼Œæ”¯æŒæ›´é•¿æ—¶é—´èŒƒå›´ï¼ˆä» 69 å¹´ â†’ 139 å¹´ï¼‰ï¼Œé™ä½å›æ‹¨æ¦‚ç‡&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™çº§ç­–ç•¥&lt;/strong&gt;ï¼šå›æ‹¨æ—¶åˆ‡æ¢ä¸º UUID æˆ–æ•°æ®åº“è‡ªå¢ ID ä¸´æ—¶å…œåº•&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é«˜å¹¶å‘ä¸‹åºåˆ—å·è€—å°½"&gt;&lt;strong&gt;é«˜å¹¶å‘ä¸‹åºåˆ—å·è€—å°½&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šå•èŠ‚ç‚¹æ¯æ¯«ç§’è¯·æ±‚é‡è¶…è¿‡ 4096ï¼ˆå¦‚ç§’æ€ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¢åŠ åºåˆ—å·ä½æ•°&lt;/strong&gt;ï¼šå¦‚ä» 12 ä½æ‰©å±•è‡³ 14 ä½ï¼ˆæ”¯æŒæ¯æ¯«ç§’ 16384 ä¸ª IDï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ•£æ—¶é—´æˆ³ç²¾åº¦&lt;/strong&gt;ï¼šä½¿ç”¨å¾®ç§’çº§æ—¶é—´æˆ³ï¼ˆéœ€è°ƒæ•´æ—¶é—´æˆ³ä½æ•°ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æœºå™¨-id-åˆ†é…å†²çª"&gt;&lt;strong&gt;æœºå™¨ ID åˆ†é…å†²çª&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šå¤šèŠ‚ç‚¹éƒ¨ç½²æ—¶ï¼Œè‹¥æœºå™¨ ID é‡å¤ï¼ˆå¦‚é…ç½®é”™è¯¯ï¼‰ï¼Œå¯¼è‡´ä¸åŒèŠ‚ç‚¹ç”Ÿæˆç›¸åŒ ID&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€åˆ†é…&lt;/strong&gt;ï¼šé€šè¿‡ ZooKeeper/Redis åˆ†é…å”¯ä¸€æœºå™¨ IDï¼Œæ”¯æŒèŠ‚ç‚¹åŠ¨æ€æ‰©å®¹&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºäºç¡¬ä»¶ç”Ÿæˆ&lt;/strong&gt;ï¼šé€šè¿‡ MAC åœ°å€ã€IP å“ˆå¸Œå€¼è‡ªåŠ¨è®¡ç®—æœºå™¨ IDï¼ˆå¦‚ &lt;code&gt;getDatacenterId()&lt;/code&gt; æ–¹æ³•ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–ä¸å·¥ä¸šå®è·µ"&gt;ğŸš€ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–ä¸å·¥ä¸šå®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ€§èƒ½ç“¶é¢ˆçªç ´"&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆçªç ´&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç”Ÿæ€§èƒ½&lt;/strong&gt;ï¼šå•èŠ‚ç‚¹æ¯ç§’çº¦ 26 ä¸‡ IDï¼ˆä¾èµ–æ—¶é’Ÿè·å–æ•ˆç‡ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–æ‰‹æ®µï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜æ—¶é—´æˆ³&lt;/strong&gt;ï¼šé¢„å–æœªæ¥æ—¶é—´æˆ³ï¼Œå‡å°‘ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚ç™¾åº¦ UidGenerator æ–¹æ¡ˆï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é”è®¾è®¡&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;ThreadLocal&lt;/code&gt; æˆ– CAS æ›¿ä»£ &lt;code&gt;synchronized&lt;/code&gt;ï¼ˆå¦‚æ”¹è¿›ç‰ˆ Hutool çš„ &lt;code&gt;Snowflake&lt;/code&gt; ç±»ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼€æºæ¡†æ¶å¢å¼º"&gt;&lt;strong&gt;å¼€æºæ¡†æ¶å¢å¼º&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¡†æ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŒ–ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¾å›¢ Leaf&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒå·æ®µæ¨¡å¼ï¼ˆé¢„åˆ†é… ID æ®µï¼‰ + Snowflake æ··åˆæ¨¡å¼ï¼Œé¿å…æ—¶é’Ÿä¾èµ–&lt;/td&gt;
&lt;td&gt;é‡‘èäº¤æ˜“ç­‰é«˜ä¸€è‡´æ€§ç³»ç»Ÿ&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç™¾åº¦ Uid&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªå®šä¹‰æ—¶é—´æˆ³/æœºå™¨ ID ä½æ•°ï¼Œå¼•å…¥å·¥ä½œè¿›ç¨‹ç¼–å·ï¼ˆæ‰©å±•è‡³ 22 ä½åºåˆ—å·ï¼‰&lt;/td&gt;
&lt;td&gt;è¶…é«˜é¢‘å¹¶å‘ï¼ˆ600 ä¸‡/ç§’ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Hutool&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾›å¼€ç®±å³ç”¨çš„ &lt;code&gt;Snowflake&lt;/code&gt; ç±»ï¼Œå†…ç½®æ—¶é’Ÿå›æ‹¨æ£€æµ‹&lt;/td&gt;
&lt;td&gt;ä¸­å°å‹å¿«é€Ÿå¼€å‘&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‰å‹å»ºè®®ä¸æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;é€‰å‹å»ºè®®ä¸æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ¨èåœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;ç”µå•†è®¢å•å·ã€åˆ†å¸ƒå¼æ•°æ®åº“ä¸»é”®ï¼ˆè¶‹åŠ¿é€’å¢åˆ©äºç´¢å¼•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¾®æœåŠ¡è°ƒç”¨é“¾è¿½è¸ª IDï¼ˆæ—¶é—´æˆ³éšå«ç”Ÿæˆæ—¶é—´ï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸æ¨èåœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;æ—¶é’Ÿä¸å¯é çš„ç¯å¢ƒï¼ˆå¦‚æœªéƒ¨ç½² NTP çš„æ—§æœåŠ¡å™¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;éœ€è¦ç»å¯¹é€’å¢ï¼ˆéè¶‹åŠ¿é€’å¢ï¼‰çš„ä¸šåŠ¡ï¼ˆå¦‚é‡‘èæµæ°´å·ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é€‰å‹å†³ç­–æ ‘"&gt;&lt;strong&gt;é€‰å‹å†³ç­–æ ‘&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph TD
A{æ˜¯å¦éœ€è¦å…¨å±€å”¯ä¸€ IDï¼Ÿ} --&amp;gt;|æ˜¯| B{å¹¶å‘é‡æ˜¯å¦ï¼10ä¸‡/ç§’ï¼Ÿ}
B --&amp;gt;|æ˜¯| C[ç™¾åº¦ UidGenerator æˆ–è‡ªå®šä¹‰æ‰©å±•]
B --&amp;gt;|å¦| D{æ˜¯å¦è¦æ±‚ä¸¥æ ¼é€’å¢ï¼Ÿ}
D --&amp;gt;|æ˜¯| E[æ•°æ®åº“è‡ªå¢ ID + æ­¥é•¿åˆ†é…]
D --&amp;gt;|å¦| F[Snowflake æˆ– Leaf æ··åˆæ¨¡å¼]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ ¸å¿ƒä»·å€¼"&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Snowflake æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„â€œæ—¶é—´æœ‰åº ID ç”Ÿæˆå™¨â€ï¼Œå…¶ä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ€§èƒ½ä¸ä½è€¦åˆ&lt;/strong&gt;ï¼šä¸ä¾èµ–æ•°æ®åº“ï¼Œå†…å­˜è®¡ç®—&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´æ•ˆç‡&lt;/strong&gt;ï¼š64 ä½ ID æ¯” UUIDï¼ˆ128 ä½ï¼‰æ›´çœå­˜å‚¨&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯æ‰©å±•æ€§&lt;/strong&gt;ï¼šé€šè¿‡è°ƒæ•´ä½æ•°åˆ†é…ï¼Œé€‚é…ä¸šåŠ¡å¢é•¿ï¼ˆå¦‚å»¶é•¿æ—¶é—´æˆ³æ”¯æŒå¹´é™ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç»ˆæå»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸­å°ç³»ç»Ÿç›´æ¥ç”¨ &lt;strong&gt;Hutool çš„ &lt;code&gt;Snowflake&lt;/code&gt;&lt;/strong&gt;ï¼Œé¿å…é‡å¤é€ è½®å­&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¤§å‹ç³»ç»Ÿç”¨ &lt;strong&gt;Leaf æ··åˆæ¨¡å¼&lt;/strong&gt;ï¼ˆSnowflake + å·æ®µï¼‰ï¼Œå…¼é¡¾æ€§èƒ½ä¸å®¹ç¾&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ—¶é’ŸåŒæ­¥æ˜¯åº•çº¿ï¼š&lt;strong&gt;å¿…é¡»éƒ¨ç½² NTP æœåŠ¡&lt;/strong&gt;ï¼Œå¹¶ç›‘æ§æ—¶é’Ÿåç§»é‡&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="ä¸€è‡´æ€§å“ˆå¸Œ"&gt;ä¸€è‡´æ€§å“ˆå¸Œ
&lt;/h2&gt;&lt;p&gt;ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashingï¼‰æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ ¸å¿ƒç®—æ³•ï¼Œæ—¨åœ¨è§£å†³èŠ‚ç‚¹åŠ¨æ€å˜åŒ–æ—¶æ•°æ®å¤§è§„æ¨¡è¿ç§»çš„é—®é¢˜ã€‚ä»¥ä¸‹ä»åŸç†ã€ç‰¹æ€§ã€ä¼˜åŒ–åˆ°åº”ç”¨åœºæ™¯çš„å…¨é¢è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†å“ˆå¸Œç¯ä¸åŠ¨æ€æ˜ å°„"&gt;ğŸ”„ &lt;strong&gt;æ ¸å¿ƒåŸç†ï¼šå“ˆå¸Œç¯ä¸åŠ¨æ€æ˜ å°„&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œç¯æ„å»º&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å°†å“ˆå¸Œå€¼ç©ºé—´ç»„ç»‡æˆç¯å½¢ç»“æ„ï¼ˆèŒƒå›´é€šå¸¸ä¸º &lt;code&gt;0 ~ 2Â³Â²-1&lt;/code&gt;ï¼‰ï¼Œé¦–å°¾ç›¸æ¥ã€‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹ï¼ˆå¦‚æœåŠ¡å™¨ï¼‰å’Œæ•°æ®å‡é€šè¿‡å“ˆå¸Œå‡½æ•°ï¼ˆå¦‚ MD5ã€SHA-1ï¼‰æ˜ å°„åˆ°ç¯ä¸Šç‰¹å®šä½ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å®šä½è§„åˆ™&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®å­˜å‚¨æ—¶ï¼Œä»å…¶å“ˆå¸Œä½ç½®&lt;strong&gt;é¡ºæ—¶é’ˆæŸ¥æ‰¾&lt;/strong&gt;ï¼Œé‡åˆ°çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å³ä¸ºå½’å±èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šæ•°æ® &lt;code&gt;D&lt;/code&gt; çš„å“ˆå¸Œå€¼ä½äºèŠ‚ç‚¹ &lt;code&gt;A&lt;/code&gt; å’Œ &lt;code&gt;B&lt;/code&gt; ä¹‹é—´ï¼Œåˆ™å­˜å…¥èŠ‚ç‚¹ &lt;code&gt;B&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ä¼¸ç¼©æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–°å¢èŠ‚ç‚¹&lt;/strong&gt;ï¼šä»…å½±å“æ–°èŠ‚ç‚¹é€†æ—¶é’ˆæ–¹å‘è‡³ä¸‹ä¸€èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®ï¼ˆå›¾ä¸­ä»… &lt;code&gt;C&lt;/code&gt; ä» &lt;code&gt;D&lt;/code&gt; è¿ç§»è‡³æ–°èŠ‚ç‚¹ &lt;code&gt;X&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ é™¤èŠ‚ç‚¹&lt;/strong&gt;ï¼šæ•…éšœèŠ‚ç‚¹çš„æ•°æ®ç”±å…¶é¡ºæ—¶é’ˆä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ¥ç®¡ï¼ˆå¦‚èŠ‚ç‚¹ &lt;code&gt;C&lt;/code&gt; å®•æœºï¼Œæ•°æ® &lt;code&gt;C&lt;/code&gt; è¿ç§»è‡³ &lt;code&gt;D&lt;/code&gt;ï¼‰ã€‚
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®è¿ç§»èŒƒå›´&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å½±å“ç¨‹åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ™®é€šå“ˆå¸Œå–æ¨¡&lt;/td&gt;
&lt;td&gt;å…¨éƒ¨æ•°æ®é‡æ–°æ˜ å°„&lt;/td&gt;
&lt;td&gt;å…¨å±€æ€§é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/td&gt;
&lt;td&gt;ç›¸é‚»èŠ‚ç‚¹é—´çš„å°éƒ¨åˆ†æ•°æ®&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å±€éƒ¨æ€§ä½&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®ç‰¹æ€§ä¸ä¼˜åŠ¿"&gt;âš–ï¸ &lt;strong&gt;å…³é”®ç‰¹æ€§ä¸ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å•è°ƒæ€§ï¼ˆMonotonicityï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹å¢å‡æ—¶ï¼Œä»…å°‘é‡æ•°æ®éœ€è¿ç§»ï¼Œä¸å½±å“ç³»ç»Ÿæ•´ä½“è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;é¿å…ä¼ ç»Ÿå“ˆå¸Œä¸­èŠ‚ç‚¹æ•°å˜åŒ–å¯¼è‡´çš„å…¨å±€æ•°æ®å¤±æ•ˆï¼ˆå¦‚ç¼“å­˜é›ªå´©ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹³è¡¡æ€§ï¼ˆBalanceï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç†æƒ³æƒ…å†µä¸‹æ•°æ®å‡åŒ€åˆ†å¸ƒï¼Œä½†ç‰©ç†èŠ‚ç‚¹å°‘æ—¶å¯èƒ½å€¾æ–œï¼ˆå¦‚ä¸¤èŠ‚ç‚¹åˆ†æ‹… 80%/20% è´Ÿè½½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šå¼•å…¥è™šæ‹ŸèŠ‚ç‚¹ï¼ˆè§ä¸‹æ–‡ä¼˜åŒ–éƒ¨åˆ†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ•£æ€§ï¼ˆSpreadï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®åˆ†æ•£å­˜å‚¨ï¼Œæ— å•ç‚¹å­˜å‚¨å‹åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™æ€§ï¼ˆFault Toleranceï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹æ•…éšœåï¼Œå…¶æ•°æ®è‡ªåŠ¨è¿ç§»è‡³ä¸‹ä¸€èŠ‚ç‚¹ï¼Œç³»ç»Ÿä»å¯æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æŒ‘æˆ˜ä¸ä¼˜åŒ–è™šæ‹ŸèŠ‚ç‚¹æŠ€æœ¯"&gt;ğŸ› ï¸ &lt;strong&gt;æŒ‘æˆ˜ä¸ä¼˜åŒ–ï¼šè™šæ‹ŸèŠ‚ç‚¹æŠ€æœ¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é—®é¢˜æ ¹æº&lt;/strong&gt;ï¼šç‰©ç†èŠ‚ç‚¹å°‘æ—¶ï¼Œå“ˆå¸Œç¯åˆ†å¸ƒä¸å‡å¯¼è‡´æ•°æ®å€¾æ–œï¼ˆå¦‚å¤§éƒ¨åˆ†æ•°æ®é›†ä¸­åœ¨å°‘æ•°èŠ‚ç‚¹ï¼‰ã€‚
&lt;strong&gt;è™šæ‹ŸèŠ‚ç‚¹æ–¹æ¡ˆ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªç‰©ç†èŠ‚ç‚¹æ˜ å°„ä¸ºå¤šä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼ˆå¦‚ &lt;code&gt;Node A&lt;/code&gt; â†’ &lt;code&gt;A#1&lt;/code&gt;ã€&lt;code&gt;A#2&lt;/code&gt;&amp;hellip;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è™šæ‹ŸèŠ‚ç‚¹æ•£åˆ—åˆ†å¸ƒåœ¨ç¯ä¸Šï¼Œæ•°æ®å…ˆå®šä½åˆ°è™šæ‹ŸèŠ‚ç‚¹ï¼Œå†æ˜ å°„è‡³ç‰©ç†èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šç‰©ç†èŠ‚ç‚¹è´Ÿè½½æ›´å‡åŒ€ï¼ˆå³ä½¿èŠ‚ç‚¹å°‘ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»æ‰©ç¼©&lt;/strong&gt;ï¼šè°ƒæ•´è™šæ‹ŸèŠ‚ç‚¹æ•°é‡å³å¯ä¼˜åŒ–è´Ÿè½½ï¼Œæ— éœ€é‡æ„ç¯ã€‚
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ— è™šæ‹ŸèŠ‚ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å«è™šæ‹ŸèŠ‚ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç‰©ç†èŠ‚ç‚¹æ•°&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;2ï¼ˆå„å« 3 ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ•°æ®åˆ†å¸ƒ&lt;/td&gt;
&lt;td&gt;80% åœ¨ Aï¼Œ20% åœ¨ B&lt;/td&gt;
&lt;td&gt;Aã€B å„æ‰¿æ‹… â‰ˆ50%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯-1"&gt;ğŸŒ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼ç¼“å­˜ç³»ç»Ÿ&lt;/strong&gt;ï¼ˆRedis Clusterã€Memcachedï¼‰
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹å®•æœºæ—¶ä»…å°‘é‡ç¼“å­˜å¤±æ•ˆï¼Œé¿å…æ•°æ®åº“è¢«å‡»ç©¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼æ•°æ®åº“&lt;/strong&gt;ï¼ˆCassandraã€DynamoDBï¼‰
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€æ‰©å®¹æ—¶æ•°æ®è¿ç§»é‡æå°ï¼Œæå‡ä¼¸ç¼©æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è¯·æ±‚æŒ‰å“ˆå¸Œå‡åŒ€åˆ†é…åç«¯æœåŠ¡å™¨ï¼Œæ–°å¢èŠ‚ç‚¹ä»…å½±å“å±€éƒ¨æµé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å®¹åˆ†å‘ç½‘ç»œï¼ˆCDNï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èµ„æºæŒ‰å“ˆå¸Œåˆ†å¸ƒè¾¹ç¼˜èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹å˜åŠ¨æ—¶ç”¨æˆ·è¯·æ±‚ä»é«˜æ•ˆå‘½ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°è¦ç‚¹ä»¥-java-ä¸ºä¾‹"&gt;âš™ï¸ &lt;strong&gt;å®ç°è¦ç‚¹ï¼ˆä»¥ Java ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// ç®€åŒ–ç‰ˆä¸€è‡´æ€§å“ˆå¸Œå®ç°
public class ConsistentHash {
private final SortedMap&amp;lt;Integer, Node&amp;gt; ring = new TreeMap&amp;lt;&amp;gt;();
private int virtualNodesPerNode = 3; // è™šæ‹ŸèŠ‚ç‚¹æ•°
// æ·»åŠ èŠ‚ç‚¹
public void addNode(Node node) {
for (int i = 0; i &amp;lt; virtualNodesPerNode; i++) {
int hash = hash(node.id + &amp;#34;#&amp;#34; + i);
ring.put(hash, node);
}
}
// è·¯ç”±æ•°æ®
public Node getNode(String key) {
int hash = hash(key);
SortedMap&amp;lt;Integer, Node&amp;gt; tailMap = ring.tailMap(hash);
int targetHash = tailMap.isEmpty() ? ring.firstKey() : tailMap.firstKey();
return ring.get(targetHash);
}
private int hash(String value) {
return Math.abs(value.hashCode() % (int)Math.pow(2, 32)); // 32ä½å“ˆå¸Œç©ºé—´
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-11"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸€è‡´æ€§å“ˆå¸Œé€šè¿‡&lt;strong&gt;ç¯å½¢æ˜ å°„&lt;/strong&gt;å’Œ&lt;strong&gt;è™šæ‹ŸèŠ‚ç‚¹&lt;/strong&gt;æŠ€æœ¯ï¼Œè§£å†³äº†åˆ†å¸ƒå¼ç³»ç»ŸåŠ¨æ€ä¼¸ç¼©ä¸­çš„æ•°æ®è¿ç§»éš¾é¢˜ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å®¹é”™&lt;/strong&gt;ï¼šèŠ‚ç‚¹æ•…éšœä»…å½±å“ç›¸é‚»æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜“æ‰©å±•&lt;/strong&gt;ï¼šå¢åˆ èŠ‚ç‚¹è¿ç§»æˆæœ¬ä½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šè™šæ‹ŸèŠ‚ç‚¹é¿å…æ•°æ®å€¾æ–œã€‚
åœ¨åˆ†å¸ƒå¼ç¼“å­˜ã€æ•°æ®åº“ã€CDN ç­‰åœºæ™¯ä¸­ï¼Œå®ƒæ˜¯ä¿éšœç³»ç»Ÿç¨³å®šæ€§å’Œæ‰©å±•æ€§çš„åŸºçŸ³ã€‚ç°ä»£ç³»ç»Ÿï¼ˆå¦‚ Redis Clusterï¼‰å·²å°†å…¶ä½œä¸ºé»˜è®¤åˆ†ç‰‡ç­–ç•¥ï¼Œæœªæ¥åœ¨è¾¹ç¼˜è®¡ç®—ã€åŒºå—é“¾ä¸­åº”ç”¨æ½œåŠ›å·¨å¤§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="è´Ÿè½½ä¸å‡è¡¡"&gt;è´Ÿè½½ä¸å‡è¡¡
&lt;/h2&gt;&lt;p&gt;åœ¨ä¸€è‡´æ€§å“ˆå¸Œä¸­ï¼Œåˆ é™¤èŠ‚ç‚¹åæ•°æ®ç”±&lt;strong&gt;é¡ºæ—¶é’ˆä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ‰˜ç®¡&lt;/strong&gt;ç¡®å®å¯èƒ½å¯¼è‡´è´Ÿè½½ä¸å‡è¡¡ï¼Œè¿™æ˜¯è¯¥ç®—æ³•çš„å›ºæœ‰ç¼ºé™·ã€‚ä½†é€šè¿‡è™šæ‹ŸèŠ‚ç‚¹æŠ€æœ¯å’Œå…¶ä»–ä¼˜åŒ–ç­–ç•¥ï¼Œå¯ä»¥æ˜¾è‘—ç¼“è§£è¿™ä¸€é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ é™¤èŠ‚ç‚¹åçš„è´Ÿè½½ä¸å‡è¡¡é—®é¢˜"&gt;âš ï¸ &lt;strong&gt;åˆ é™¤èŠ‚ç‚¹åçš„è´Ÿè½½ä¸å‡è¡¡é—®é¢˜&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å½“èŠ‚ç‚¹è¢«åˆ é™¤æ—¶ï¼Œå…¶è´Ÿè´£çš„æ•°æ®ä¼šå…¨éƒ¨è½¬ç§»åˆ°é¡ºæ—¶é’ˆæ–¹å‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¯¼è‡´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿè½½é›†ä¸­&lt;/strong&gt;ï¼šä¸‹ä¸€ä¸ªèŠ‚ç‚¹éœ€é¢å¤–æ‰¿æ‹…è¢«åˆ é™¤èŠ‚ç‚¹çš„å…¨éƒ¨æ•°æ®ï¼Œè´Ÿè½½çªå¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çƒ­ç‚¹é£é™©&lt;/strong&gt;ï¼šè‹¥è¢«åˆ é™¤èŠ‚ç‚¹åŸè´Ÿè´£å¤§é‡æ•°æ®ï¼Œæ¥ç®¡èŠ‚ç‚¹å¯èƒ½å› å‹åŠ›è¿‡å¤§è€Œå®•æœºï¼Œå¼•å‘é›ªå´©æ•ˆåº”ï¼ˆå¦‚èŠ‚ç‚¹Aå®•æœºåï¼ŒèŠ‚ç‚¹Bå› è´Ÿè½½è¿‡é«˜å®•æœºï¼Œå‹åŠ›è¿›ä¸€æ­¥ä¼ å¯¼è‡³èŠ‚ç‚¹Cï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæµªè´¹&lt;/strong&gt;ï¼šå…¶ä»–èŠ‚ç‚¹æœªåˆ†æ‹…å‹åŠ›ï¼Œç³»ç»Ÿæ•´ä½“è´Ÿè½½ä¸å‡ã€‚
&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š
å‡è®¾3ä¸ªèŠ‚ç‚¹å‡åŒ€åˆ†æ‹…æ•°æ®ï¼ˆå„33%ï¼‰ã€‚è‹¥èŠ‚ç‚¹Bå®•æœºï¼ŒèŠ‚ç‚¹Céœ€æ¥ç®¡Bçš„å…¨éƒ¨æ•°æ®ï¼Œè´Ÿè½½å‡è‡³66%ï¼Œè€ŒèŠ‚ç‚¹Aä»ä¸º33%ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è§£å†³æ–¹æ¡ˆè™šæ‹ŸèŠ‚ç‚¹æŠ€æœ¯"&gt;âš™ï¸ &lt;strong&gt;è§£å†³æ–¹æ¡ˆï¼šè™šæ‹ŸèŠ‚ç‚¹æŠ€æœ¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è™šæ‹ŸèŠ‚ç‚¹æ˜¯è§£å†³è´Ÿè½½ä¸å‡çš„æ ¸å¿ƒæœºåˆ¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šæ¯ä¸ªç‰©ç†èŠ‚ç‚¹æ˜ å°„ä¸ºå¤šä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼ˆå¦‚200ä¸ªï¼‰ï¼Œåˆ†æ•£åœ¨å“ˆå¸Œç¯ä¸Šã€‚&lt;/li&gt;
&lt;li&gt;åˆ é™¤èŠ‚ç‚¹æ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;è¢«åˆ é™¤èŠ‚ç‚¹çš„è™šæ‹ŸèŠ‚ç‚¹å¤±æ•ˆï¼Œå…¶æ•°æ®ç”±å¤šä¸ªä¸åŒç‰©ç†èŠ‚ç‚¹æ¥ç®¡ï¼ˆè€Œéä»…ä¸€ä¸ªï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆæœ&lt;/strong&gt;ï¼šæ•°æ®è¿ç§»åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œé¿å…å•ç‚¹è¿‡è½½ã€‚
&lt;strong&gt;è™šæ‹ŸèŠ‚ç‚¹é…ç½®å»ºè®®&lt;/strong&gt;ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰©ç†èŠ‚ç‚¹æ•°&lt;/th&gt;
&lt;th&gt;æ¨èè™šæ‹ŸèŠ‚ç‚¹å€æ•°&lt;/th&gt;
&lt;th&gt;æ•ˆæœ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;â‰¤10&lt;/td&gt;
&lt;td&gt;100~200å€&lt;/td&gt;
&lt;td&gt;è´Ÿè½½åˆ†å¸ƒè¾ƒå‡åŒ€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&amp;gt;50&lt;/td&gt;
&lt;td&gt;50~100å€&lt;/td&gt;
&lt;td&gt;å¹³è¡¡æ€§èƒ½ä¸å¼€é”€&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šç‰©ç†èŠ‚ç‚¹è¶Šå°‘ï¼Œè™šæ‹ŸèŠ‚ç‚¹å€æ•°éœ€è¶Šé«˜ï¼Œä»¥å¡«è¡¥å“ˆå¸Œç¯ä¸Šçš„åˆ†å¸ƒç©ºéš™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-è¿›ä¸€æ­¥ä¼˜åŒ–ç­–ç•¥"&gt;ğŸ”§ &lt;strong&gt;è¿›ä¸€æ­¥ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="1-åŠ¨æ€è´Ÿè½½å‡è¡¡"&gt;(1) &lt;strong&gt;åŠ¨æ€è´Ÿè½½å‡è¡¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æƒé‡è°ƒæ•´&lt;/strong&gt;ï¼šæ ¹æ®èŠ‚ç‚¹æ€§èƒ½ï¼ˆCPUã€å†…å­˜ç­‰ï¼‰åˆ†é…ä¸åŒæ•°é‡çš„è™šæ‹ŸèŠ‚ç‚¹ã€‚é«˜æ€§èƒ½èŠ‚ç‚¹æ‰¿è½½æ›´å¤šæ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶ç›‘æ§&lt;/strong&gt;ï¼šæ£€æµ‹èŠ‚ç‚¹è´Ÿè½½ï¼ŒåŠ¨æ€è¿ç§»è™šæ‹ŸèŠ‚ç‚¹ï¼Œä»é«˜è´Ÿè½½èŠ‚ç‚¹è½¬ç§»è‡³ä½è´Ÿè½½èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-æ•°æ®å†—ä½™ä¸æ•…éšœè½¬ç§»"&gt;(2) &lt;strong&gt;æ•°æ®å†—ä½™ä¸æ•…éšœè½¬ç§»&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šå‰¯æœ¬æœºåˆ¶&lt;/strong&gt;ï¼šæ•°æ®å­˜å‚¨å¤šä¸ªå‰¯æœ¬ï¼ˆå¦‚3å‰¯æœ¬ï¼‰ï¼Œåˆ†å¸ƒåœ¨ä¸åŒçš„ç‰©ç†èŠ‚ç‚¹ã€‚åˆ é™¤èŠ‚ç‚¹æ—¶ï¼Œå‰¯æœ¬èŠ‚ç‚¹å¯åˆ†æ‹…è¯»è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨æ¢å¤&lt;/strong&gt;ï¼šæ•…éšœèŠ‚ç‚¹æ¢å¤åï¼Œç³»ç»Ÿè‡ªåŠ¨åŒæ­¥æ•°æ®ï¼Œé¿å…äººå·¥å¹²é¢„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-ç»“åˆå…¶ä»–ç®—æ³•"&gt;(3) &lt;strong&gt;ç»“åˆå…¶ä»–ç®—æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Rendezvous Hashing&lt;/strong&gt;ï¼šåœ¨åˆ é™¤èŠ‚ç‚¹æ—¶ï¼Œæ•°æ®è¿ç§»æ›´åˆ†æ•£ï¼Œé€‚åˆå¯¹å‡è¡¡æ€§è¦æ±‚æé«˜çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çƒ­ç‚¹æ•°æ®æ£€æµ‹&lt;/strong&gt;ï¼šè¯†åˆ«é«˜é¢‘è®¿é—®æ•°æ®ï¼Œå°†å…¶å¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œå‡å°‘å•ç‚¹å‹åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åº”ç”¨æ•ˆæœ"&gt;ğŸ’ &lt;strong&gt;å®é™…åº”ç”¨æ•ˆæœ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— è™šæ‹ŸèŠ‚ç‚¹&lt;/strong&gt;ï¼šåˆ é™¤èŠ‚ç‚¹åï¼Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹è´Ÿè½½å¯èƒ½ç¿»å€ï¼Œç³»ç»Ÿé£é™©é«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å«è™šæ‹ŸèŠ‚ç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ•°æ®è¿ç§»åˆ†æ•£è‡³å¤šä¸ªèŠ‚ç‚¹ï¼Œå„èŠ‚ç‚¹è´Ÿè½½å¢å¹…å¯æ§ï¼ˆå¦‚10%è€Œé100%ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç³»ç»Ÿååé‡æ³¢åŠ¨å‡å°‘ï¼Œå“åº”æ—¶é—´æ›´ç¨³å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼šMemcachedé›†ç¾¤ä¸­ï¼Œä½¿ç”¨è™šæ‹ŸèŠ‚ç‚¹åï¼Œåˆ é™¤èŠ‚ç‚¹å¼•å‘çš„ç¼“å­˜å‘½ä¸­ç‡ä¸‹é™ä»30%é™è‡³5%ä»¥ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-12"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åˆ é™¤èŠ‚ç‚¹åï¼Œæ•°æ®ç”±å•ä¸€èŠ‚ç‚¹æ‰˜ç®¡&lt;strong&gt;å¿…ç„¶å¯¼è‡´è´Ÿè½½ä¸å‡è¡¡&lt;/strong&gt;ï¼Œä½†é€šè¿‡&lt;strong&gt;è™šæ‹ŸèŠ‚ç‚¹æŠ€æœ¯&lt;/strong&gt;ï¼ˆåˆ†æ•£æ•°æ®è¿ç§»ï¼‰å’Œ&lt;strong&gt;åŠ¨æ€æƒé‡è°ƒæ•´&lt;/strong&gt;ï¼ˆæŒ‰æ€§èƒ½åˆ†é…è´Ÿè½½ï¼‰ï¼Œå¯å°†å½±å“é™è‡³æœ€ä½ã€‚åœ¨åˆ†å¸ƒå¼ç¼“å­˜ã€æ•°æ®åº“ç­‰åœºæ™¯ä¸­ï¼Œè¿™äº›ä¼˜åŒ–æ˜¯ä¿éšœé«˜å¯ç”¨çš„å…³é”®ã€‚&lt;/p&gt;</description></item><item><title>ã€Mysqlã€‘Concepts</title><link>https://dyhes.github.io/p/mysqlconcepts/</link><pubDate>Sat, 21 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/mysqlconcepts/</guid><description>&lt;h2 id="acid"&gt;ACID
&lt;/h2&gt;&lt;p&gt;ACID æ˜¯æ•°æ®åº“äº‹åŠ¡ï¼ˆTransactionï¼‰æ­£ç¡®æ‰§è¡Œçš„å››ä¸ªæ ¸å¿ƒç‰¹æ€§çš„ç¼©å†™ï¼Œç¡®ä¿åœ¨æ•°æ®æ“ä½œè¿‡ç¨‹ä¸­ä¿æŒå¯é æ€§ã€ä¸€è‡´æ€§å’Œå¯æ¢å¤æ€§ã€‚å®ƒç”±ä»¥ä¸‹å››ä¸ªç‰¹æ€§ç»„æˆï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åŸå­æ€§atomicity"&gt;âš›ï¸ &lt;strong&gt;åŸå­æ€§ï¼ˆAtomicityï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸæ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šï¼Œä¸å­˜åœ¨éƒ¨åˆ†æ‰§è¡Œçš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šè‹¥äº‹åŠ¡ä¸­é€”å‡ºé”™ï¼ˆå¦‚ç³»ç»Ÿå´©æºƒï¼‰ï¼Œæ•°æ®åº“ä¼šæ’¤é”€å·²æ‰§è¡Œçš„æ“ä½œï¼Œå›æ»šåˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå¦‚åŒä»æœªæ‰§è¡Œè¿‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾‹å­&lt;/strong&gt;ï¼šé“¶è¡Œè½¬è´¦åŒ…å«â€œæ‰£å‡Aè´¦æˆ·ä½™é¢â€å’Œâ€œå¢åŠ Bè´¦æˆ·ä½™é¢â€ä¸¤æ­¥ã€‚è‹¥ç¬¬äºŒæ­¥å¤±è´¥ï¼Œç¬¬ä¸€æ­¥ä¹Ÿä¼šè¢«æ’¤é”€ï¼Œé¿å…Aè´¦æˆ·æ‰£æ¬¾åBè´¦æˆ·æœªåˆ°è´¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€è‡´æ€§consistency"&gt;ğŸ”„ &lt;strong&gt;ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šäº‹åŠ¡æ‰§è¡Œå‰åï¼Œæ•°æ®åº“å¿…é¡»ä¿æŒé€»è¾‘ä¸€è‡´æ€§ï¼Œå³æ‰€æœ‰æ•°æ®å˜æ›´éœ€ç¬¦åˆé¢„è®¾è§„åˆ™ï¼ˆå¦‚çº¦æŸã€è§¦å‘å™¨ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šç¡®ä¿æ•°æ®ä»ä¸€ä¸ªæœ‰æ•ˆçŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªæœ‰æ•ˆçŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œè½¬è´¦å‰åæ€»é‡‘é¢åº”ä¿æŒä¸å˜ï¼ˆA + B æ€»é¢ä¸å˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šä¸€è‡´æ€§ä¾èµ–äºåº”ç”¨ç¨‹åºæ­£ç¡®è®¾è®¡äº‹åŠ¡é€»è¾‘ï¼Œæ•°æ®åº“ä»…æä¾›åŸå­æ€§å’Œéš”ç¦»æ€§æ”¯æŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-éš”ç¦»æ€§isolation"&gt;ğŸš§ &lt;strong&gt;éš”ç¦»æ€§ï¼ˆIsolationï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šå¤šä¸ªå¹¶å‘äº‹åŠ¡æ‰§è¡Œæ—¶äº’ä¸å¹²æ‰°ï¼Œæ¯ä¸ªäº‹åŠ¡çš„æ“ä½œç‹¬ç«‹äºå…¶ä»–äº‹åŠ¡ï¼Œé˜²æ­¢æ•°æ®å†²çªã€‚&lt;/li&gt;
&lt;li&gt;ã€é—®é¢˜ä¸è§£å†³ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è„è¯»&lt;/strong&gt;ï¼šè¯»å–æœªæäº¤çš„æ•°æ® â†’ é€šè¿‡é”æœºåˆ¶æˆ–æ—¶é—´æˆ³é¿å…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¯é‡å¤è¯»&lt;/strong&gt;ï¼šåŒä¸€äº‹åŠ¡å†…å¤šæ¬¡è¯»å–ç»“æœä¸åŒ â†’ ä½¿ç”¨â€œå¯é‡å¤è¯»â€éš”ç¦»çº§åˆ«ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹»è¯»&lt;/strong&gt;ï¼šäº‹åŠ¡æ‰§è¡Œä¸­æ–°å¢æ•°æ®å¯¼è‡´ç»“æœé›†å˜åŒ– â†’ æœ€é«˜éš”ç¦»çº§åˆ«â€œä¸²è¡ŒåŒ–â€è§£å†³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®è·µ&lt;/strong&gt;ï¼šæ•°æ®åº“æä¾›ä¸åŒéš”ç¦»çº§åˆ«ï¼ˆå¦‚è¯»æœªæäº¤ã€è¯»æäº¤ã€å¯é‡å¤è¯»ã€ä¸²è¡ŒåŒ–ï¼‰ï¼Œå¹³è¡¡æ€§èƒ½ä¸æ•°æ®å‡†ç¡®æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æŒä¹…æ€§durability"&gt;ğŸ’¾ &lt;strong&gt;æŒä¹…æ€§ï¼ˆDurabilityï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šäº‹åŠ¡æäº¤åï¼Œå…¶æ•°æ®å˜æ›´æ°¸ä¹…ä¿å­˜ï¼Œå³ä½¿ç³»ç»Ÿæ•…éšœï¼ˆå¦‚æ–­ç”µã€å´©æºƒï¼‰ä¹Ÿä¸ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¢„å†™æ—¥å¿—ï¼ˆWALï¼‰&lt;/strong&gt;ï¼šäº‹åŠ¡æäº¤å‰å…ˆå°†æ“ä½œå†™å…¥æ—¥å¿—ï¼Œæ•…éšœåé€šè¿‡æ—¥å¿—æ¢å¤æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å¤åˆ¶&lt;/strong&gt;ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿä¸­å°†æ•°æ®åŒæ­¥åˆ°å¤šä¸ªèŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾‹å­&lt;/strong&gt;ï¼šè½¬è´¦æˆåŠŸåï¼Œå³ä½¿æ•°æ®åº“æœåŠ¡å™¨ç«‹å³å®•æœºï¼Œé‡å¯åè´¦æˆ·ä½™é¢ä»ä¸ºæ›´æ–°åçš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-acid-ç‰¹æ€§æ€»ç»“è¡¨"&gt;ğŸ“Š &lt;strong&gt;ACID ç‰¹æ€§æ€»ç»“è¡¨&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒè¦æ±‚&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…³é”®æŠ€æœ¯/æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¸¸è§é—®é¢˜é˜²èŒƒ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¨æˆåŠŸæˆ–å…¨å¤±è´¥&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡å›æ»šï¼ˆRollbackï¼‰&lt;/td&gt;
&lt;td&gt;éƒ¨åˆ†æ“ä½œå¤±è´¥å¯¼è‡´æ•°æ®ä¸ä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®ç¬¦åˆä¸šåŠ¡è§„åˆ™&lt;/td&gt;
&lt;td&gt;çº¦æŸã€è§¦å‘å™¨ã€å¤–é”®&lt;/td&gt;
&lt;td&gt;ç ´åæ•°æ®åº“é€»è¾‘å®Œæ•´æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¹¶å‘äº‹åŠ¡äº’ä¸å¹²æ‰°&lt;/td&gt;
&lt;td&gt;é”ã€æ—¶é—´æˆ³ã€å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰&lt;/td&gt;
&lt;td&gt;è„è¯»ã€å¹»è¯»ã€ä¸å¯é‡å¤è¯»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŒä¹…æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æäº¤åæ•°æ®æ°¸ä¹…ä¿å­˜&lt;/td&gt;
&lt;td&gt;é¢„å†™æ—¥å¿—ï¼ˆWALï¼‰ã€æ•°æ®å¤åˆ¶&lt;/td&gt;
&lt;td&gt;ç³»ç»Ÿæ•…éšœå¯¼è‡´æ•°æ®ä¸¢å¤±&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-acid-çš„æ„ä¹‰ä¸å±€é™æ€§"&gt;ğŸ’ &lt;strong&gt;ACID çš„æ„ä¹‰ä¸å±€é™æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ„ä¹‰&lt;/strong&gt;ï¼šä¸ºé‡‘èã€ç”µå•†ç­‰é«˜å¯é æ€§åœºæ™¯æä¾›æ•°æ®å®‰å…¨ä¿éšœï¼Œç¡®ä¿å…³é”®æ“ä½œï¼ˆå¦‚æ”¯ä»˜ã€åº“å­˜æ‰£å‡ï¼‰çš„å‡†ç¡®æ€§ã€‚&lt;/li&gt;
&lt;li&gt;å±€é™æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸¥æ ¼ ACID å¯èƒ½é™ä½å¹¶å‘æ€§èƒ½ï¼ˆå¦‚ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;NoSQL æ•°æ®åº“ï¼ˆå¦‚ MongoDBã€Cassandraï¼‰å¸¸ç‰ºç‰²éƒ¨åˆ† ACID ç‰¹æ€§ï¼ˆå¦‚ä¸€è‡´æ€§æˆ–éš”ç¦»æ€§ï¼‰ä»¥æ¢å–é«˜å¯ç”¨æ€§å’Œæ‰©å±•æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ•°æ®åº“ç³»ç»Ÿé€šè¿‡ç»“åˆæ—¥å¿—ã€é”ã€å¤åˆ¶ç­‰æŠ€æœ¯å®ç° ACIDï¼Œå¼€å‘è€…éœ€æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©éš”ç¦»çº§åˆ«ï¼Œå¹¶åœ¨ä¸€è‡´æ€§ä¸æ€§èƒ½é—´æƒè¡¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="è‡ªå¢é”"&gt;è‡ªå¢é”
&lt;/h2&gt;&lt;p&gt;è‡ªå¢é”ï¼ˆAUTO-INC Lockï¼‰æ˜¯MySQLä¸­InnoDBå¼•æ“ç”¨äºç®¡ç†è‡ªå¢åˆ—ï¼ˆAUTO_INCREMENTï¼‰çš„ç‰¹æ®Šè¡¨çº§é”ï¼Œ&lt;strong&gt;ç¡®ä¿å¹¶å‘æ’å…¥æ—¶è‡ªå¢IDçš„å”¯ä¸€æ€§å’Œè¿ç»­æ€§&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒæœºåˆ¶å’Œåº”ç”¨è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä½œç”¨ä¸åŸç†"&gt;ğŸ”’ &lt;strong&gt;æ ¸å¿ƒä½œç”¨ä¸åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜èƒŒæ™¯&lt;/strong&gt;
å½“å¤šä¸ªäº‹åŠ¡å¹¶å‘æ’å…¥å¸¦è‡ªå¢åˆ—çš„è¡¨æ—¶ï¼Œè‹¥ä¸é”å®šè‡ªå¢è®¡æ•°å™¨ï¼Œå¯èƒ½å¯¼è‡´IDé‡å¤æˆ–è·³å·ã€‚è‡ªå¢é”é€šè¿‡&lt;strong&gt;ä¸²è¡ŒåŒ–IDåˆ†é…&lt;/strong&gt;è§£å†³æ­¤é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”ç‰¹æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¡¨çº§é”&lt;/strong&gt;ï¼šä½œç”¨äºæ•´ä¸ªè¡¨çš„è‡ªå¢è®¡æ•°å™¨ï¼Œè€Œéå•è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº’æ–¥æ€§&lt;/strong&gt;ï¼šåŒä¸€æ—¶åˆ»ä»…å…è®¸ä¸€ä¸ªäº‹åŠ¡è·å–è‡ªå¢é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éå›è°ƒæ€§&lt;/strong&gt;ï¼šè‡ªå¢å€¼ä¸€æ—¦åˆ†é…ï¼Œå³ä½¿äº‹åŠ¡å›æ»šä¹Ÿä¸ä¼šå›æ”¶ï¼Œå¯èƒ½å¯¼è‡´IDä¸è¿ç»­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹ä¸mysqlç‰ˆæœ¬å·®å¼‚"&gt;âš™ï¸ &lt;strong&gt;å·¥ä½œæµç¨‹ä¸MySQLç‰ˆæœ¬å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŠ é”æµç¨‹"&gt;&lt;strong&gt;åŠ é”æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;äº‹åŠ¡æ‰§è¡Œæ’å…¥è¯­å¥ï¼ˆå¦‚ &lt;code&gt;INSERT INTO users (name) VALUES ('Alice')&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;InnoDB &lt;strong&gt;è‡ªåŠ¨åŠ è‡ªå¢é”&lt;/strong&gt;ï¼Œé”å®šè¡¨çš„è‡ªå¢è®¡æ•°å™¨ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†é…ä¸‹ä¸€ä¸ªè‡ªå¢å€¼ï¼ˆå¦‚å½“å‰AUTO_INCREMENT=101 â†’ åˆ†é…ID=101ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ’å…¥æ•°æ®è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡Šæ”¾è‡ªå¢é”&lt;/strong&gt;ï¼ˆé‡Šæ”¾æ—¶æœºå› ç‰ˆæœ¬è€Œå¼‚ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="ç‰ˆæœ¬è¡Œä¸ºå¯¹æ¯”"&gt;&lt;strong&gt;ç‰ˆæœ¬è¡Œä¸ºå¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;MySQLç‰ˆæœ¬&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é”é‡Šæ”¾æ—¶æœº&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;5.7åŠä¹‹å‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡æäº¤åé‡Šæ”¾&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘æ’å…¥ä¸¥é‡é˜»å¡ï¼ˆä¸²è¡ŒåŒ–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;8.0+&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ’å…¥æ“ä½œå®Œæˆåç«‹å³é‡Šæ”¾&lt;/td&gt;
&lt;td&gt;å¤§å¹…æå‡å¹¶å‘æ€§ï¼ˆè½»é‡çº§é”ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;MySQL 8.0ä¼˜åŒ–&lt;/strong&gt;ï¼šå¼•å…¥&amp;quot;è½»é‡çº§è‡ªå¢é”&amp;quot;ï¼Œä»…çŸ­æš‚æŒæœ‰äº’æ–¥é”åˆ†é…IDï¼Œé¿å…é•¿æ—¶é˜»å¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é”æ¨¡å¼ä¸å‚æ•°é…ç½®"&gt;âš–ï¸ &lt;strong&gt;é”æ¨¡å¼ä¸å‚æ•°é…ç½®&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é€šè¿‡å‚æ•° &lt;code&gt;innodb_autoinc_lock_mode&lt;/code&gt; æ§åˆ¶é”ç­–ç•¥ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼å€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åç§°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œä¸º&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼ ç»Ÿæ¨¡å¼&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰æ’å…¥å‡è¡¨çº§é”ï¼Œä¸¥æ ¼ä¿è¯IDè¿ç»­ï¼ˆäº‹åŠ¡æäº¤é‡Šæ”¾ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€ä¸¥æ ¼IDé¡ºåºçš„ä¸»ä»å¤åˆ¶ç¯å¢ƒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;1&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿ç»­æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
&lt;td&gt;Simple Insertç”¨è½»é‡é”ï¼›Bulk Insertï¼ˆå¦‚&lt;code&gt;INSERT...SELECT&lt;/code&gt;ï¼‰ç”¨è¡¨çº§é”&lt;/td&gt;
&lt;td&gt;å¹³è¡¡å¹¶å‘ä¸IDè¿ç»­æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;2&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº¤å‰æ¨¡å¼&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰æ’å…¥ä»…ç”¨è½»é‡é”ï¼ŒIDå¯èƒ½ä¸è¿ç»­&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ä¸”ä¸è¦æ±‚IDè¿ç»­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ’å…¥ç±»å‹è¯´æ˜&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Simple Insert&lt;/strong&gt;ï¼šå¯é¢„çŸ¥è¡Œæ•°ï¼ˆå¦‚ &lt;code&gt;INSERT ... VALUES&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Bulk Insert&lt;/strong&gt;ï¼šè¡Œæ•°ä¸ç¡®å®šï¼ˆå¦‚ &lt;code&gt;INSERT ... SELECT&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Mixed-Mode&lt;/strong&gt;ï¼šéƒ¨åˆ†æŒ‡å®šIDçš„æ‰¹é‡æ’å…¥ï¼ˆå¦‚ &lt;code&gt;INSERT ... VALUES (1,'a'),(NULL,'b')&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–å»ºè®®"&gt;âš ï¸ &lt;strong&gt;å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç°è±¡&lt;/strong&gt;ï¼šé«˜å¹¶å‘æ’å…¥æ—¶ï¼Œ&lt;code&gt;SHOW PROCESSLIST&lt;/code&gt; æ˜¾ç¤º &lt;code&gt;Waiting for auto-increment lock&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;å‡çº§MySQL 8.0+ï¼Œåˆ©ç”¨è½»é‡çº§é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è®¾ç½® &lt;code&gt;innodb_autoinc_lock_mode=2&lt;/code&gt;ï¼ˆéœ€å®¹å¿IDä¸è¿ç»­ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­»é”é£é™©&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šäº‹åŠ¡åŒæ—¶æŒæœ‰è‡ªå¢é”å’Œè¡Œé”ï¼ˆå¦‚å…ˆæ’å…¥åæ›´æ–°å…¶ä»–è¡Œï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è§„é¿ï¼š
&lt;ul&gt;
&lt;li&gt;ç¼©çŸ­äº‹åŠ¡æ—¶é•¿ï¼Œå°½å¿«æäº¤ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…åœ¨æ’å…¥åç«‹å³æ›´æ–°éè‡ªå¢åˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;IDä¸è¿ç»­&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;ï¼šäº‹åŠ¡å›æ»šæˆ–é”æ¨¡å¼2å¹¶å‘åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”å¯¹&lt;/strong&gt;ï¼šä¸šåŠ¡é€»è¾‘é¿å…ä¾èµ–IDè¿ç»­æ€§ï¼ˆå¦‚åˆ†é¡µæŸ¥è¯¢æ”¹ç”¨æ—¶é—´æˆ³æ’åºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ç¤ºä¾‹"&gt;ğŸ’¡ &lt;strong&gt;åº”ç”¨åœºæ™¯ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;-- åœºæ™¯1ï¼šé«˜å¹¶å‘ç”¨æˆ·æ³¨å†Œï¼ˆMySQL 8.0+ï¼‰
INSERT INTO users (name) VALUES (&amp;#39;Alice&amp;#39;); -- è½»é‡é”åˆ†é…IDåç«‹å³é‡Šæ”¾
-- åœºæ™¯2ï¼šæ•°æ®è¿ç§»ï¼ˆBulk Insertï¼Œæ¨¡å¼1ï¼‰
SET innodb_autoinc_lock_mode=1;
INSERT INTO new_table SELECT * FROM old_table; -- è¡¨çº§é”ä¿è¯è¿ç§»IDè¿ç»­
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-è‡ªå¢é”ä¸å…¶ä»–é”å¯¹æ¯”"&gt;ğŸ”„ &lt;strong&gt;è‡ªå¢é”ä¸å…¶ä»–é”å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è‡ªå¢é”&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œçº§é”&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ„å‘é”&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”å®šç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¡¨è‡ªå¢è®¡æ•°å™¨&lt;/td&gt;
&lt;td&gt;å•è¡Œæ•°æ®&lt;/td&gt;
&lt;td&gt;è¡¨çº§é”æ„å‘å£°æ˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½œç”¨èŒƒå›´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¡¨çº§&lt;/td&gt;
&lt;td&gt;è¡Œçº§&lt;/td&gt;
&lt;td&gt;è¡¨çº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…é˜»å¡å¹¶å‘æ’å…¥&lt;/td&gt;
&lt;td&gt;é˜»å¡è¡Œè¯»å†™&lt;/td&gt;
&lt;td&gt;åè°ƒè¡Œé”ä¸è¡¨é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”¨æˆ·å¹²é¢„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨ç®¡ç†&lt;/td&gt;
&lt;td&gt;å¯æ‰‹åŠ¨åŠ é”ï¼ˆ&lt;code&gt;FOR UPDATE&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨ç®¡ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è‡ªå¢é”æ˜¯InnoDBä¿éšœè‡ªå¢IDå®‰å…¨çš„åŸºçŸ³ï¼Œå…¶æ ¸å¿ƒæƒè¡¡åœ¨äº &lt;strong&gt;IDè¿ç»­æ€§ä¸å¹¶å‘æ€§èƒ½&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸¥æ ¼è¿ç»­&lt;/strong&gt; â†’ ä¼ ç»Ÿæ¨¡å¼ï¼ˆ&lt;code&gt;mode=0&lt;/code&gt;ï¼‰ï¼Œç‰ºç‰²å¹¶å‘æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘&lt;/strong&gt; â†’ äº¤å‰æ¨¡å¼ï¼ˆ&lt;code&gt;mode=2&lt;/code&gt;ï¼‰ï¼Œå®¹å¿IDä¸è¿ç»­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹³è¡¡æ–¹æ¡ˆ&lt;/strong&gt; â†’ è¿ç»­æ¨¡å¼ï¼ˆ&lt;code&gt;mode=1&lt;/code&gt;ï¼‰ï¼Œé»˜è®¤æ¨èã€‚
â€‹&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;â€‹ï¼šç»“åˆMySQLç‰ˆæœ¬å’Œä¸šåŠ¡éœ€æ±‚ï¼ˆå¦‚æ˜¯å¦éœ€ä¸»ä»å¤åˆ¶IDä¸€è‡´ï¼‰é…ç½®é”æ¨¡å¼ï¼Œå¹¶é¿å…é•¿äº‹åŠ¡æŒæœ‰é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="è¡¨çº§é”"&gt;è¡¨çº§é”
&lt;/h2&gt;&lt;p&gt;MySQLä¸­çš„è¡¨çº§é”ä¸»è¦ç”¨äºæ§åˆ¶å¤šä¸ªäº‹åŠ¡å¯¹æ•´å¼ è¡¨çš„å¹¶å‘è®¿é—®ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚ä»¥ä¸‹æ˜¯MySQLè¡¨çº§é”çš„ä¸»è¦ç±»å‹åŠå…¶ç‰¹æ€§ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å…±äº«é”shared-lock-sé”"&gt;ğŸ”’ &lt;strong&gt;å…±äº«é”ï¼ˆShared Lock, Sé”ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šå…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è¯»å–è¡¨æ•°æ®ï¼Œä½†é˜»æ­¢ä»»ä½•äº‹åŠ¡ä¿®æ”¹è¡¨ï¼ˆå†™æ“ä½œé˜»å¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åŠ é”æ–¹å¼ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;LOCK TABLES table_name READ;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;è¯»è¯»å…¼å®¹ï¼šå¤šä¸ªäº‹åŠ¡å¯åŒæ—¶æŒæœ‰å…±äº«é”ã€‚&lt;/li&gt;
&lt;li&gt;è¯»å†™äº’æ–¥ï¼šæŒæœ‰å…±äº«é”æ—¶ï¼Œå…¶ä»–äº‹åŠ¡æ— æ³•åŠ å†™é”æˆ–ä¿®æ”¹æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘è¯»æ“ä½œï¼ˆå¦‚æŠ¥è¡¨ç”Ÿæˆï¼‰ï¼Œéœ€ç¡®ä¿æ•°æ®ä¸è¢«ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ’ä»–é”exclusive-lock-xé”"&gt;âš”ï¸ &lt;strong&gt;æ’ä»–é”ï¼ˆExclusive Lock, Xé”ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä»…å…è®¸ä¸€ä¸ªäº‹åŠ¡ç‹¬å è®¿é—®è¡¨ï¼Œå…¶ä»–äº‹åŠ¡æ— æ³•è¯»å†™ã€‚&lt;/li&gt;
&lt;li&gt;åŠ é”æ–¹å¼ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;LOCK TABLES table_name WRITE;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;å®Œå…¨äº’æ–¥ï¼šé˜»å¡å…¶ä»–äº‹åŠ¡çš„æ‰€æœ‰è¯»å†™è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡ç»“æŸé‡Šæ”¾ï¼šéœ€æ˜¾å¼æ‰§è¡Œ &lt;code&gt;UNLOCK TABLES&lt;/code&gt; æˆ–æäº¤äº‹åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ‰¹é‡æ•°æ®æ›´æ–°ã€è¡¨ç»“æ„å˜æ›´ï¼ˆå¦‚ &lt;code&gt;ALTER TABLE&lt;/code&gt;ï¼‰æˆ–æ•°æ®è¿ç§»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ„å‘é”intention-lock"&gt;ğŸš© &lt;strong&gt;æ„å‘é”ï¼ˆIntention Lockï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šæ”¯æŒå¤šç²’åº¦é”ï¼ˆè¡Œé”+è¡¨é”å…±å­˜ï¼‰ï¼Œé¿å…åŠ è¡¨é”æ—¶é€è¡Œæ£€æŸ¥å†²çªã€‚&lt;/li&gt;
&lt;li&gt;ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ„å‘å…±äº«é”ï¼ˆISé”ï¼‰&lt;/strong&gt;ï¼šè¡¨ç¤ºäº‹åŠ¡è®¡åˆ’å¯¹æŸäº›è¡ŒåŠ å…±äº«é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„å‘æ’ä»–é”ï¼ˆIXé”ï¼‰&lt;/strong&gt;ï¼šè¡¨ç¤ºäº‹åŠ¡è®¡åˆ’å¯¹æŸäº›è¡ŒåŠ æ’ä»–é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨åŠ é”&lt;/strong&gt;ï¼šå½“è¡Œçº§é”ï¼ˆS/Xé”ï¼‰å­˜åœ¨æ—¶ï¼Œè¡¨çº§è‡ªåŠ¨æ·»åŠ å¯¹åº”çš„IS/IXé”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¼å®¹æ€§&lt;/strong&gt;ï¼šISä¸IXé”äº’ç›¸å…¼å®¹ï¼Œä½†IXé”ä¸è¡¨çº§Sé”äº’æ–¥ï¼ˆé˜²æ­¢è„è¯»ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼šInnoDBå¼•æ“åè°ƒè¡Œé”ä¸è¡¨é”çš„å…³é”®æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…ƒæ•°æ®é”metadata-lock-mdl"&gt;ğŸ“œ &lt;strong&gt;å…ƒæ•°æ®é”ï¼ˆMetadata Lock, MDLï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä¿æŠ¤è¡¨ç»“æ„ï¼ˆå…ƒæ•°æ®ï¼‰ï¼Œé˜²æ­¢åœ¨æŸ¥è¯¢æˆ–ä¿®æ”¹è¿‡ç¨‹ä¸­è¡¨ç»“æ„è¢«å˜æ›´ã€‚&lt;/li&gt;
&lt;li&gt;ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MDLè¯»é”&lt;/strong&gt;ï¼šäº‹åŠ¡æ‰§è¡Œ &lt;code&gt;SELECT&lt;/code&gt; æ—¶è‡ªåŠ¨æ·»åŠ ï¼Œå…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶æŒæœ‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MDLå†™é”&lt;/strong&gt;ï¼šäº‹åŠ¡æ‰§è¡Œ &lt;code&gt;ALTER TABLE&lt;/code&gt; ç­‰DDLæ“ä½œæ—¶æ·»åŠ ï¼Œç‹¬å è¡¨ç»“æ„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;è¯»å†™äº’æ–¥ï¼šMDLå†™é”ä¼šé˜»å¡æ‰€æœ‰è¯»é”å’Œå†™é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿äº‹åŠ¡é£é™©&lt;/strong&gt;ï¼šæœªæäº¤çš„äº‹åŠ¡æŒæœ‰MDLè¯»é”ä¼šé˜»å¡DDLæ“ä½œï¼ˆå¸¸è§äºå¤§è¡¨ç»“æ„å˜æ›´ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥çœ‹æ–¹å¼&lt;/strong&gt;ï¼š&lt;code&gt;SHOW ENGINE INNODB STATUS&lt;/code&gt; æŸ¥çœ‹é”çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è‡ªå¢é”auto-increment-lock"&gt;ğŸ”„ &lt;strong&gt;è‡ªå¢é”ï¼ˆAuto-Increment Lockï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä¿è¯è‡ªå¢åˆ—ï¼ˆå¦‚ä¸»é”®IDï¼‰åœ¨å¹¶å‘æ’å…¥æ—¶çš„å”¯ä¸€æ€§ã€‚&lt;/li&gt;
&lt;li&gt;å·¥ä½œæ¨¡å¼ï¼ˆé€šè¿‡å‚æ•° innodb_autoinc_lock_mode é…ç½®ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;0ï¼ˆä¼ ç»Ÿæ¨¡å¼ï¼‰&lt;/strong&gt;ï¼šè¯­å¥æ‰§è¡Œå®Œé‡Šæ”¾é”ï¼Œä¸¥æ ¼ä¿è¯IDè¿ç»­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;1ï¼ˆè¿ç»­æ¨¡å¼ï¼Œé»˜è®¤ï¼‰&lt;/strong&gt;ï¼šç®€å•æ’å…¥ç”¨è½»é‡é”ï¼Œæ‰¹é‡æ’å…¥ç”¨è¡¨çº§é”ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;2ï¼ˆäº¤å‰æ¨¡å¼ï¼‰&lt;/strong&gt;ï¼šé«˜å¹¶å‘æ’å…¥ï¼ŒIDå¯èƒ½ä¸è¿ç»­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;ï¼šMySQL 8.0+ é»˜è®¤è½»é‡é”ï¼Œæ˜¾è‘—æå‡å¹¶å‘æ’å…¥æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è¡¨çº§é”å¯¹æ¯”æ€»ç»“"&gt;ğŸ“Š &lt;strong&gt;è¡¨çº§é”å¯¹æ¯”æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é”ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠ é”æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¼å®¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…±äº«é”ï¼ˆSï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LOCK TABLES ... READ&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å…è®¸å¤šä¸ªè¯»ï¼Œé˜»å¡å†™&lt;/td&gt;
&lt;td&gt;å¹¶å‘æŸ¥è¯¢ï¼ˆå¦‚æ•°æ®æŠ¥è¡¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ’ä»–é”ï¼ˆXï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LOCK TABLES ... WRITE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®Œå…¨ç‹¬å ï¼Œé˜»å¡è¯»å†™&lt;/td&gt;
&lt;td&gt;æ‰¹é‡æ›´æ–°ã€æ•°æ®è¿ç§»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ„å‘é”ï¼ˆIS/IXï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨æ·»åŠ ï¼ˆè¡Œé”è§¦å‘ï¼‰&lt;/td&gt;
&lt;td&gt;IS/IXå…¼å®¹ï¼ŒIXä¸Säº’æ–¥&lt;/td&gt;
&lt;td&gt;åè°ƒè¡Œé”ä¸è¡¨é”å†²çª&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒæ•°æ®é”ï¼ˆMDLï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨æ·»åŠ &lt;/td&gt;
&lt;td&gt;è¯»é”å…¼å®¹ï¼Œå†™é”ç‹¬å &lt;/td&gt;
&lt;td&gt;é˜²æ­¢DDLä¸DMLå†²çª&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªå¢é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ’å…¥è‡ªå¢åˆ—æ—¶è‡ªåŠ¨è§¦å‘&lt;/td&gt;
&lt;td&gt;æ¨¡å¼ä¾èµ–ï¼ˆ0/1/2ï¼‰&lt;/td&gt;
&lt;td&gt;ä¿è¯è‡ªå¢IDå”¯ä¸€æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨å»ºè®®ä¸æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨å»ºè®®ä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é•¿äº‹åŠ¡&lt;/strong&gt;ï¼š
è¡¨çº§é”ï¼ˆå°¤å…¶æ˜¯Xé”å’ŒMDLé”ï¼‰ä¼šä¸¥é‡é˜»å¡å¹¶å‘ï¼Œå°½é‡ç¼©çŸ­äº‹åŠ¡æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆä½¿ç”¨è¡Œé”&lt;/strong&gt;ï¼š
InnoDBé»˜è®¤è¡Œé”æ›´ç»†ç²’åº¦ï¼Œä»…å½“æ‰¹é‡æ“ä½œï¼ˆå¦‚å…¨è¡¨æ›´æ–°ï¼‰æ—¶å†ç”¨è¡¨é”ã€‚&lt;/li&gt;
&lt;li&gt;æ­»é”é¢„é˜²ï¼š
&lt;ul&gt;
&lt;li&gt;æŒ‰å›ºå®šé¡ºåºåŠ é”ï¼ˆå¦‚å…ˆè¡¨Aåè¡¨Bï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è®¾ç½®é”è¶…æ—¶ï¼š&lt;code&gt;SET innodb_lock_wait_timeout = 5&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“æ„å˜æ›´ä¼˜åŒ–&lt;/strong&gt;ï¼š
å¤§è¡¨DDLä½¿ç”¨å·¥å…·ï¼ˆå¦‚pt-online-schema-changeï¼‰ï¼Œé¿å…MDLé”é˜»å¡ä¸šåŠ¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;SHOW OPEN TABLES&lt;/code&gt; æŸ¥çœ‹å½“å‰è¡¨é”çŠ¶æ€ï¼Œæˆ– &lt;code&gt;SHOW ENGINE INNODB STATUS&lt;/code&gt; åˆ†æé”å†²çªç»†èŠ‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ­»é”æ¡ä»¶"&gt;æ­»é”æ¡ä»¶
&lt;/h2&gt;&lt;p&gt;æ­»é”ï¼ˆDeadlockï¼‰æ˜¯æŒ‡å¤šä¸ªè¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ã€äº‹åŠ¡ï¼‰å› ç«äº‰èµ„æºè€Œé™·å…¥äº’ç›¸ç­‰å¾…çš„åƒµæŒçŠ¶æ€ï¼Œå¯¼è‡´æ‰€æœ‰ç›¸å…³è¿›ç¨‹éƒ½æ— æ³•ç»§ç»­æ‰§è¡Œçš„ç°è±¡ã€‚æ­»é”çš„å‘ç”Ÿå¿…é¡»åŒæ—¶æ»¡è¶³ä»¥ä¸‹å››ä¸ªå¿…è¦æ¡ä»¶ï¼Œç¼ºä¸€ä¸å¯ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ­»é”å‘ç”Ÿçš„å››ä¸ªå¿…è¦æ¡ä»¶"&gt;ğŸ”’ &lt;strong&gt;æ­»é”å‘ç”Ÿçš„å››ä¸ªå¿…è¦æ¡ä»¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="äº’æ–¥æ¡ä»¶mutual-exclusion"&gt;&lt;strong&gt;äº’æ–¥æ¡ä»¶ï¼ˆMutual Exclusionï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šèµ„æºå…·æœ‰ç‹¬å æ€§ï¼Œä¸€æ¬¡ä»…èƒ½è¢«ä¸€ä¸ªè¿›ç¨‹å ç”¨ã€‚å…¶ä»–è¿›ç¨‹è¯·æ±‚è¯¥èµ„æºæ—¶ï¼Œå¿…é¡»ç­‰å¾…å…¶è¢«é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;æ‰“å°æœºã€æ•°æ®åº“è¡¨çš„å†™é”ç­‰èµ„æºä¸å¯å…±äº«ï¼ŒåŒä¸€æ—¶åˆ»ä»…å…è®¸ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‹¥è¿›ç¨‹AæŒæœ‰æŸèµ„æºçš„æ’ä»–é”ï¼Œè¿›ç¨‹Bçš„è¯·æ±‚å°†è¢«é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è¯·æ±‚ä¸ä¿æŒæ¡ä»¶hold-and-wait"&gt;&lt;strong&gt;è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼ˆHold and Waitï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šè¿›ç¨‹å·²æŒæœ‰è‡³å°‘ä¸€ä¸ªèµ„æºï¼ŒåŒæ—¶è¯·æ±‚å…¶ä»–è¿›ç¨‹å ç”¨çš„èµ„æºï¼Œä¸”åœ¨ç­‰å¾…æœŸé—´ä¸é‡Šæ”¾å·²æŒæœ‰èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡AæŒæœ‰è¡¨Xçš„é”åè¯·æ±‚è¡¨Yçš„é”ï¼Œäº‹åŠ¡BæŒæœ‰è¡¨Yçš„é”åè¯·æ±‚è¡¨Xçš„é”ï¼Œä¸¤è€…å‡é˜»å¡ä¸”ä¸é‡Šæ”¾å·²æœ‰é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸å¯å‰¥å¤ºæ¡ä»¶no-preemption"&gt;&lt;strong&gt;ä¸å¯å‰¥å¤ºæ¡ä»¶ï¼ˆNo Preemptionï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šè¿›ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œæ¯•å‰ä¸èƒ½è¢«å¼ºåˆ¶å‰¥å¤ºï¼Œåªèƒ½ç”±è¿›ç¨‹ä¸»åŠ¨é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥è¿›ç¨‹AæŒæœ‰å†…å­˜èµ„æºï¼Œç³»ç»Ÿæ— æ³•å¼ºè¡Œå›æ”¶ï¼Œåªèƒ½ç­‰å¾…Aä¸»åŠ¨é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¾ªç¯ç­‰å¾…æ¡ä»¶circular-wait"&gt;&lt;strong&gt;å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼ˆCircular Waitï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šå­˜åœ¨ä¸€ä¸ªè¿›ç¨‹-èµ„æºçš„ç¯å½¢ç­‰å¾…é“¾ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…ä¸‹ä¸€ä¸ªè¿›ç¨‹æ‰€æŒæœ‰çš„èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;è¿›ç¨‹P1ç­‰å¾…P2å ç”¨çš„èµ„æºR2ï¼ŒP2ç­‰å¾…P3å ç”¨çš„R3ï¼ŒP3åˆç­‰å¾…P1å ç”¨çš„R1ï¼Œå½¢æˆé—­ç¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ­»é”å‘ç”Ÿçš„å…¸å‹åœºæ™¯"&gt;âš ï¸ &lt;strong&gt;æ­»é”å‘ç”Ÿçš„å…¸å‹åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ•°æ®åº“äº‹åŠ¡ï¼š
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡Aé”å®šè¡Œ1åè¯·æ±‚è¡Œ2ï¼Œäº‹åŠ¡Bé”å®šè¡Œ2åè¯·æ±‚è¡Œ1ï¼Œå½¢æˆå¾ªç¯ç­‰å¾…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤šçº¿ç¨‹ç¼–ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹1æŒæœ‰é”Aå¹¶è¯·æ±‚é”Bï¼Œçº¿ç¨‹2æŒæœ‰é”Bå¹¶è¯·æ±‚é”Aã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;è¿›ç¨‹Aå ç”¨æ–‡ä»¶F1åè¯·æ±‚F2ï¼Œè¿›ç¨‹Bå ç”¨F2åè¯·æ±‚F1ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¦‚ä½•ç ´åæ­»é”æ¡ä»¶"&gt;ğŸ”§ &lt;strong&gt;å¦‚ä½•ç ´åæ­»é”æ¡ä»¶&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¿…è¦æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç ´åæ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº’æ–¥æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨å…±äº«èµ„æºï¼ˆå¦‚åªè¯»æ–‡ä»¶ï¼‰&lt;/td&gt;
&lt;td&gt;å¤šæ•°èµ„æºï¼ˆå¦‚æ‰“å°æœºï¼‰æ— æ³•é¿å…äº’æ–¥ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯·æ±‚ä¸ä¿æŒæ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰èµ„æºï¼šè¿›ç¨‹å¯åŠ¨æ—¶ç”³è¯·å…¨éƒ¨æ‰€éœ€èµ„æºï¼Œå¦åˆ™ä¸æ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;èµ„æºåˆ©ç”¨ç‡ä½ï¼Œå¯èƒ½å¯¼è‡´é¥¥é¥¿ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸å¯å‰¥å¤ºæ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…è®¸ç³»ç»Ÿå¼ºåˆ¶å›æ”¶èµ„æºï¼ˆå¦‚ç»ˆæ­¢è¿›ç¨‹æˆ–å›æ»šæ“ä½œï¼‰&lt;/td&gt;
&lt;td&gt;å®ç°å¤æ‚ï¼Œä¸é€‚ç”¨æ‰€æœ‰èµ„æºï¼ˆå¦‚æ‰“å°æœºï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¾ªç¯ç­‰å¾…æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºæœ‰åºåˆ†é…æ³•&lt;/strong&gt;ï¼šå…¨å±€å®šä¹‰èµ„æºé¡ºåºï¼ˆå¦‚Aâ†’Bâ†’Cï¼‰ï¼Œè¿›ç¨‹æŒ‰å›ºå®šé¡ºåºç”³è¯·èµ„æº&lt;/td&gt;
&lt;td&gt;éœ€ç»Ÿä¸€èµ„æºé¡ºåºï¼Œçµæ´»æ€§é™ä½ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åº”ç”¨ä¸­çš„æ­»é”é¿å…ç­–ç•¥"&gt;âš™ï¸ &lt;strong&gt;å®é™…åº”ç”¨ä¸­çš„æ­»é”é¿å…ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å¤šçº¿ç¨‹ç¯å¢ƒï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å›ºå®šé”é¡ºåº&lt;/strong&gt;ï¼šæ‰€æœ‰çº¿ç¨‹æŒ‰ç›¸åŒé¡ºåºè·å–é”ï¼ˆå¦‚å…ˆé”Aå†é”Bï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æœºåˆ¶&lt;/strong&gt;ï¼šå°è¯•è·å–é”æ—¶è®¾ç½®è¶…æ—¶ï¼ˆå¦‚Javaçš„&lt;code&gt;lock.tryLock(1, TimeUnit.SECONDS)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“ç³»ç»Ÿï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡è¶…æ—¶&lt;/strong&gt;ï¼šè®¾ç½®é”ç­‰å¾…æ—¶é—´ï¼ˆå¦‚&lt;code&gt;SET LOCK_TIMEOUT 5000&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒ‰é¡ºåºè®¿é—®è¡¨&lt;/strong&gt;ï¼šæ‰€æœ‰äº‹åŠ¡æŒ‰å›ºå®šé¡ºåºè®¿é—®èµ„æºï¼ˆå¦‚å…ˆæ›´æ–°è¡¨Xå†æ›´æ–°è¡¨Yï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¹è§‚é”&lt;/strong&gt;ï¼šé€šè¿‡ç‰ˆæœ¬å·æ§åˆ¶å¹¶å‘ï¼Œé¿å…åŠ é”ï¼ˆå¦‚CASæ“ä½œï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ­»é”æ£€æµ‹ä¸æ¢å¤ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ£€æµ‹&lt;/strong&gt;ï¼šå®šæœŸæ„å»ºèµ„æºåˆ†é…å›¾ï¼Œæ£€æŸ¥ç¯è·¯ï¼ˆæ•°æ®åº“å¼•æ“è‡ªåŠ¨å®Œæˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¢å¤&lt;/strong&gt;ï¼šå¼ºåˆ¶å›æ»šä»£ä»·æœ€å°çš„äº‹åŠ¡ï¼Œé‡Šæ”¾å…¶èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ­»é”æ˜¯å¹¶å‘ç³»ç»Ÿä¸­å› èµ„æºç«äº‰å¼•å‘çš„å…¸å‹é—®é¢˜ï¼Œå…¶å‘ç”Ÿå¿…é¡»åŒæ—¶æ»¡è¶³å››ä¸ªæ¡ä»¶ã€‚å®é™…åº”ç”¨ä¸­ï¼Œ&lt;strong&gt;ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼ˆèµ„æºæœ‰åºåˆ†é…ï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;å¼•å…¥è¶…æ—¶æœºåˆ¶&lt;/strong&gt; æ˜¯æœ€æœ‰æ•ˆçš„é¢„é˜²æ‰‹æ®µï¼Œè€Œæ•°æ®åº“ç³»ç»Ÿé€šå¸¸ç»“åˆæ­»é”æ£€æµ‹ä¸äº‹åŠ¡å›æ»šå®ç°è‡ªåŠ¨æ¢å¤ã€‚è®¾è®¡ç³»ç»Ÿæ—¶éœ€æƒè¡¡æ€§èƒ½ä¸å®‰å…¨æ€§ï¼Œé¿å…è¿‡åº¦åŠ é”å¯¼è‡´å¹¶å‘æ€§èƒ½ä¸‹é™ã€‚&lt;/p&gt;
&lt;h2 id="åµŒå¥—äº‹åŠ¡"&gt;åµŒå¥—äº‹åŠ¡
&lt;/h2&gt;&lt;p&gt;MySQL æœ¬èº«&lt;strong&gt;ä¸æ”¯æŒåŸç”Ÿçš„åµŒå¥—äº‹åŠ¡&lt;/strong&gt;ï¼ˆå³å­äº‹åŠ¡ç‹¬ç«‹æäº¤ä¸å½±å“çˆ¶äº‹åŠ¡ï¼‰ï¼Œä½†é€šè¿‡ &lt;strong&gt;ä¿å­˜ç‚¹ï¼ˆSavepointï¼‰æœºåˆ¶&lt;/strong&gt; å¯æ¨¡æ‹Ÿç±»ä¼¼æ•ˆæœï¼Œå®ç°äº‹åŠ¡å†…çš„éƒ¨åˆ†å›æ»šå’Œé€»è¾‘åˆ†å±‚ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒè¦ç‚¹è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åµŒå¥—äº‹åŠ¡çš„æœ¬è´¨ä¸-mysql-çš„å®ç°æ–¹å¼"&gt;ğŸ”„ &lt;strong&gt;åµŒå¥—äº‹åŠ¡çš„æœ¬è´¨ä¸ MySQL çš„å®ç°æ–¹å¼&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸç”Ÿé™åˆ¶"&gt;&lt;strong&gt;åŸç”Ÿé™åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;MySQL çš„äº‹åŠ¡æ¨¡å‹æ˜¯æ‰å¹³åŒ–çš„ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­å¼€å¯æ–°äº‹åŠ¡ï¼ˆå¦‚ &lt;code&gt;START TRANSACTION&lt;/code&gt;ï¼‰ä¼šéšå¼æäº¤å½“å‰äº‹åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;çœŸæ­£åµŒå¥—äº‹åŠ¡
éœ€æ»¡è¶³ï¼š
&lt;ul&gt;
&lt;li&gt;å­äº‹åŠ¡å¯ç‹¬ç«‹æäº¤ï¼ˆä»…çˆ¶äº‹åŠ¡æäº¤åç”Ÿæ•ˆï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å­äº‹åŠ¡å›æ»šä¸å½±å“çˆ¶äº‹åŠ¡ã€‚
â€‹&lt;strong&gt;MySQL æ— æ³•æ»¡è¶³è¿™ä¸¤ç‚¹&lt;/strong&gt;ï¼Œæ•…éœ€ç”¨ &lt;code&gt;SAVEPOINT&lt;/code&gt; æ¨¡æ‹Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¿å­˜ç‚¹savepointçš„æ ¸å¿ƒä½œç”¨"&gt;&lt;strong&gt;ä¿å­˜ç‚¹ï¼ˆSavepointï¼‰çš„æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;é€šè¿‡åˆ›å»ºäº‹åŠ¡å†…éƒ¨çš„â€œå›æ»šæ ‡è®°ç‚¹â€ï¼Œå®ç°&lt;strong&gt;éƒ¨åˆ†å›æ»š&lt;/strong&gt;ï¼Œæ¨¡æ‹Ÿå­äº‹åŠ¡è¡Œä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;SAVEPOINT sp_name&lt;/code&gt;&lt;/strong&gt;ï¼šåˆ›å»ºä¿å­˜ç‚¹ï¼ˆå¦‚å­äº‹åŠ¡èµ·ç‚¹ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ROLLBACK TO sp_name&lt;/code&gt;&lt;/strong&gt;ï¼šå›æ»šåˆ°è¯¥ç‚¹ï¼Œæ’¤é”€åç»­æ“ä½œï¼ˆæ¨¡æ‹Ÿå­äº‹åŠ¡å›æ»šï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;RELEASE SAVEPOINT sp_name&lt;/code&gt;&lt;/strong&gt;ï¼šæ˜¾å¼é‡Šæ”¾ä¿å­˜ç‚¹ï¼ˆéå¿…éœ€ï¼Œäº‹åŠ¡æäº¤æ—¶è‡ªåŠ¨é‡Šæ”¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¿å­˜ç‚¹æ¨¡æ‹ŸåµŒå¥—äº‹åŠ¡çš„æµç¨‹"&gt;âš™ï¸ &lt;strong&gt;ä¿å­˜ç‚¹æ¨¡æ‹ŸåµŒå¥—äº‹åŠ¡çš„æµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹ä»£ç å±•ç¤ºå…¸å‹å®ç°æ­¥éª¤ï¼ˆä»¥ç”¨æˆ·æ³¨å†Œ+æ—¥å¿—è®°å½•ä¸ºä¾‹ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;START TRANSACTION; -- å¼€å¯çˆ¶äº‹åŠ¡
INSERT INTO users (name) VALUES (&amp;#39;Alice&amp;#39;);
SAVEPOINT sp_log; -- åˆ›å»ºä¿å­˜ç‚¹ï¼ˆæ¨¡æ‹Ÿå­äº‹åŠ¡å¼€å§‹ï¼‰
INSERT INTO logs (action) VALUES (&amp;#39;user_created&amp;#39;);
-- è‹¥æ—¥å¿—æ’å…¥å¤±è´¥ï¼Œå›æ»šåˆ° sp_logï¼ˆä¸å½±å“ users æ’å…¥ï¼‰
ROLLBACK TO sp_log; -- å­äº‹åŠ¡â€œå›æ»šâ€
UPDATE account SET balance = balance - 100; -- ç»§ç»­çˆ¶äº‹åŠ¡æ“ä½œ
COMMIT; -- æäº¤çˆ¶äº‹åŠ¡ï¼ˆæ‰€æœ‰æ“ä½œç”Ÿæ•ˆï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å…³é”®è¡Œä¸º"&gt;&lt;strong&gt;å…³é”®è¡Œä¸º&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å›æ»šèŒƒå›´&lt;/strong&gt;ï¼š&lt;code&gt;ROLLBACK TO sp_log&lt;/code&gt; ä»…æ’¤é”€ &lt;code&gt;sp_log&lt;/code&gt; åçš„æ“ä½œï¼ˆå¦‚æ—¥å¿—æ’å…¥ï¼‰ï¼Œä¿ç•™ä¹‹å‰æ“ä½œï¼ˆå¦‚ç”¨æˆ·æ’å…¥ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨åŸŸé™åˆ¶&lt;/strong&gt;ï¼šå›æ»šåˆ°æ—©æœŸä¿å­˜ç‚¹ï¼ˆå¦‚ &lt;code&gt;sp1&lt;/code&gt;ï¼‰åï¼Œåç»­ä¿å­˜ç‚¹ï¼ˆå¦‚ &lt;code&gt;sp2&lt;/code&gt;ï¼‰è‡ªåŠ¨å¤±æ•ˆï¼Œä¸å¯å†å›æ»šåˆ° &lt;code&gt;sp2&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”ä¸èµ„æº&lt;/strong&gt;ï¼šå›æ»šåï¼Œå­äº‹åŠ¡ä¸­åŠ çš„é”å¯èƒ½ä¿ç•™ï¼ˆéµå®ˆä¸¤é˜¶æ®µé”åè®®ï¼‰ï¼Œé¿å…æ­»é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¿å­˜ç‚¹çš„æ ¸å¿ƒé™åˆ¶ä¸åŸç”ŸåµŒå¥—äº‹åŠ¡å·®å¼‚"&gt;âš ï¸ &lt;strong&gt;ä¿å­˜ç‚¹çš„æ ¸å¿ƒé™åˆ¶ä¸åŸç”ŸåµŒå¥—äº‹åŠ¡å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;MySQL ä¿å­˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç”ŸåµŒå¥—äº‹åŠ¡&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­äº‹åŠ¡æäº¤ç‹¬ç«‹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ å­äº‹åŠ¡æ— ç‹¬ç«‹æäº¤ï¼Œå›æ»šä»…æ’¤é”€æ“ä½œ&lt;/td&gt;
&lt;td&gt;âœ… å­äº‹åŠ¡å¯ç‹¬ç«‹æäº¤ï¼ˆå»¶è¿Ÿç”Ÿæ•ˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å›æ»šç²’åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒéƒ¨åˆ†å›æ»š&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒå­äº‹åŠ¡ç‹¬ç«‹å›æ»š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çˆ¶æ“ä½œå½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ çˆ¶äº‹åŠ¡å›æ»šåˆ™å…¨éƒ¨æ’¤é”€&lt;/td&gt;
&lt;td&gt;âœ… çˆ¶äº‹åŠ¡å›æ»šå¯ä¿ç•™å­äº‹åŠ¡æäº¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡å±‚æ¬¡ç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— çˆ¶å­äº‹åŠ¡å±‚çº§æ§åˆ¶&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒå¤šçº§äº‹åŠ¡æ ‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¿å­˜ç‚¹æœ¬è´¨æ˜¯&lt;strong&gt;äº‹åŠ¡å†…çš„å›æ»šç‚¹&lt;/strong&gt;ï¼Œè€Œéç‹¬ç«‹äº‹åŠ¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…å¼€å‘ä¸­çš„æ³¨æ„äº‹é¡¹"&gt;ğŸ§© &lt;strong&gt;å®é™…å¼€å‘ä¸­çš„æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="éš”ç¦»çº§åˆ«ä¸é”ç«äº‰"&gt;&lt;strong&gt;éš”ç¦»çº§åˆ«ä¸é”ç«äº‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤éš”ç¦»çº§åˆ«ï¼ˆREPEATABLE READï¼‰&lt;/strong&gt;ï¼šå¯èƒ½å¯¼è‡´å¹»è¯»ï¼Œå­äº‹åŠ¡ä¸­èŒƒå›´æŸ¥è¯¢éœ€è°¨æ…ï¼›&lt;/li&gt;
&lt;li&gt;é”å‡çº§é£é™©ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;START TRANSACTION;
SELECT * FROM orders FOR UPDATE; -- è¡Œé”
SAVEPOINT sp1;
UPDATE orders SET status = &amp;#39;paid&amp;#39;; -- å¯èƒ½å› é”ç«äº‰æ­»é”
&lt;/code&gt;&lt;/pre&gt;å»ºè®®ï¼šå­äº‹åŠ¡é¿å…åœ¨ç›¸åŒèµ„æºä¸ŠåŠ é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ€§èƒ½ä¸èµ„æº"&gt;&lt;strong&gt;æ€§èƒ½ä¸èµ„æº&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å ç”¨&lt;/strong&gt;ï¼šæ¯ä¸ªä¿å­˜ç‚¹è®°å½•äº‹åŠ¡çŠ¶æ€ï¼ˆUNDO æ—¥å¿—ï¼‰ï¼Œæ·±å±‚åµŒå¥—æ¶ˆè€—å†…å­˜ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åµŒå¥—æ·±åº¦&lt;/strong&gt;ï¼šå»ºè®® â‰¤3 å±‚ï¼Œè¿‡æ·±éœ€é‡æ„ä¸šåŠ¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼‚å¸¸å¤„ç†"&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ç»Ÿä¸€å›æ»šæœºåˆ¶ï¼šåœ¨ç¼–ç¨‹è¯­è¨€å±‚å°è£…ä¿å­˜ç‚¹ç®¡ç†ï¼ˆå¦‚ PHP/Java å¼‚å¸¸æ•è·ä¸­å›æ»šåˆ°æŒ‡å®šç‚¹ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;function nested_transaction(PDO $pdo, callable $callback) {
$pdo-&amp;gt;exec(&amp;#34;SAVEPOINT sp_child&amp;#34;);
try {
$callback();
$pdo-&amp;gt;exec(&amp;#34;RELEASE SAVEPOINT sp_child&amp;#34;);
} catch (Exception $e) {
$pdo-&amp;gt;exec(&amp;#34;ROLLBACK TO sp_child&amp;#34;);
throw $e;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;ğŸ—ï¸ &lt;strong&gt;é€‚ç”¨åœºæ™¯ä¸æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¿å­˜ç‚¹é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;ä¿å­˜ç‚¹é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å±€éƒ¨å¤±è´¥æ¢å¤&lt;/strong&gt;ï¼šå¦‚ä¸»è®°å½•æ’å…¥æˆåŠŸï¼Œæ˜ç»†æ’å…¥å¤±è´¥æ—¶å›æ»šæ˜ç»†ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ­¥éª¤äº‹åŠ¡&lt;/strong&gt;ï¼šå¦‚è®¢å•åˆ›å»ºï¼ˆåº“å­˜é”å®šâ†’è®¢å•å†™å…¥â†’æ”¯ä»˜æ—¥å¿—ï¼‰ï¼Œéœ€åˆ†é˜¶æ®µå›æ»šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤æ‚åœºæ™¯æ›¿ä»£æ–¹æ¡ˆ"&gt;&lt;strong&gt;å¤æ‚åœºæ™¯æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‹†åˆ†ä¸ºç‹¬ç«‹äº‹åŠ¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ä¸šåŠ¡ï¼ˆå¦‚ç”µå•†ä¸‹å•ï¼‰&lt;/td&gt;
&lt;td&gt;å‡å°‘é”ç«äº‰ï¼ŒMQ ä¿éšœæœ€ç»ˆä¸€è‡´æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;TCC æ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆè·¨æœåŠ¡ï¼‰&lt;/td&gt;
&lt;td&gt;æ”¯æŒå­äº‹åŠ¡ç‹¬ç«‹æäº¤/å›æ»šï¼ˆTry-Confirm-Cancelï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¡†æ¶æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Spring åº”ç”¨&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@Transactional(propagation = NESTED)&lt;/code&gt; è‡ªåŠ¨ç®¡ç†ä¿å­˜ç‚¹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;MySQL é€šè¿‡ &lt;strong&gt;Savepoint æœºåˆ¶&lt;/strong&gt; æ”¯æŒäº‹åŠ¡å†…çš„éƒ¨åˆ†å›æ»šï¼Œæ¨¡æ‹Ÿäº†åµŒå¥—äº‹åŠ¡çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆå­äº‹åŠ¡å›æ»šï¼‰ï¼Œä½†æ— æ³•å®ç°å­äº‹åŠ¡ç‹¬ç«‹æäº¤æˆ–å±‚çº§ç®¡ç†ã€‚å®é™…å¼€å‘ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;ç®€å•éƒ¨åˆ†å›æ»š&lt;/strong&gt;ï¼šä¼˜å…ˆä½¿ç”¨ä¿å­˜ç‚¹ï¼ˆ&lt;code&gt;SAVEPOINT&lt;/code&gt;/&lt;code&gt;ROLLBACK TO&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;æ·±å±‚åµŒå¥—&lt;/strong&gt;ï¼šè¯„ä¼°æ€§èƒ½å½±å“ï¼Œé¿å…è¶…è¿‡ 3 å±‚ï¼›&lt;/li&gt;
&lt;li&gt;ğŸ”„ &lt;strong&gt;åˆ†å¸ƒå¼æˆ–ç‹¬ç«‹æäº¤éœ€æ±‚&lt;/strong&gt;ï¼šæ”¹ç”¨ TCCã€äº‹åŠ¡æ‹†åˆ†æˆ–æ”¯æŒåŸç”ŸåµŒå¥—çš„æ•°æ®åº“ï¼ˆå¦‚ PostgreSQLï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¿å­˜ç‚¹æ˜¯äº‹åŠ¡ç®¡ç†çš„çµæ´»å·¥å…·ï¼Œç†è§£å…¶&lt;strong&gt;æ¨¡æ‹Ÿæœ¬è´¨&lt;/strong&gt;å’Œ&lt;strong&gt;è¡Œä¸ºè¾¹ç•Œ&lt;/strong&gt;ï¼ˆå¦‚å›æ»šä½œç”¨åŸŸã€é”ä¿ç•™ï¼‰ï¼Œæ˜¯é«˜æ•ˆåº”ç”¨çš„å…³é”®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å­˜å‚¨è¿‡ç¨‹"&gt;å­˜å‚¨è¿‡ç¨‹
&lt;/h2&gt;&lt;p&gt;å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰æ˜¯æ•°æ®åº“ä¸­çš„ä¸€ç§é¢„ç¼–è¯‘æ•°æ®åº“å¯¹è±¡ï¼Œç”¨äºå°è£…ä¸€ç»„å®Œæˆç‰¹å®šåŠŸèƒ½çš„SQLè¯­å¥å’Œæ§åˆ¶æµé€»è¾‘ã€‚å®ƒç±»ä¼¼äºç¼–ç¨‹è¯­è¨€ä¸­çš„å‡½æ•°æˆ–æ–¹æ³•ï¼Œå¯æ¥å—å‚æ•°ã€æ‰§è¡Œå¤æ‚æ“ä½œå¹¶è¿”å›ç»“æœã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒè¦ç‚¹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å®šä¹‰ä¸æ ¸å¿ƒæ¦‚å¿µ"&gt;ğŸ” &lt;strong&gt;å®šä¹‰ä¸æ ¸å¿ƒæ¦‚å¿µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;
å­˜å‚¨è¿‡ç¨‹æ˜¯&lt;strong&gt;é¢„ç¼–è¯‘çš„SQLè¯­å¥é›†åˆ&lt;/strong&gt;ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“æœåŠ¡å™¨ç«¯ï¼Œé€šè¿‡åç§°è°ƒç”¨æ‰§è¡Œã€‚å®ƒæ”¯æŒå‚æ•°ä¼ é€’ï¼ˆè¾“å…¥ã€è¾“å‡ºã€è¾“å…¥è¾“å‡ºï¼‰ã€å˜é‡å£°æ˜ã€æ¡ä»¶åˆ¤æ–­ï¼ˆå¦‚&lt;code&gt;IF&lt;/code&gt;ï¼‰ã€å¾ªç¯ï¼ˆå¦‚&lt;code&gt;WHILE&lt;/code&gt;/&lt;code&gt;LOOP&lt;/code&gt;ï¼‰å’Œå¼‚å¸¸å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ›å»ºæ—¶&lt;/strong&gt;ï¼šSQLè¯­å¥è¢«è§£æã€ä¼˜åŒ–å¹¶ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶ä»£ç ï¼Œå­˜å‚¨åœ¨ç³»ç»Ÿè¡¨ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œæ—¶&lt;/strong&gt;ï¼šç›´æ¥è°ƒç”¨ç¼–è¯‘åçš„ä»£ç ï¼Œæ— éœ€é‡æ–°è§£æï¼Œæå‡æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æŠ€æœ¯ç‰¹ç‚¹ä¸å·¥ä½œåŸç†"&gt;âš™ï¸ &lt;strong&gt;æŠ€æœ¯ç‰¹ç‚¹ä¸å·¥ä½œåŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¢„ç¼–è¯‘ä¸æ‰§è¡Œä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ™®é€šSQLæ¯æ¬¡æ‰§è¡Œéœ€ç¼–è¯‘ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹&lt;strong&gt;ä»…é¦–æ¬¡ç¼–è¯‘&lt;/strong&gt;ï¼Œåç»­è°ƒç”¨ç›´æ¥æ‰§è¡Œç¼“å­˜ä¸­çš„æ‰§è¡Œè®¡åˆ’ï¼Œå‡å°‘CPUå¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šå¤æ‚æŠ¥è¡¨ç”Ÿæˆæˆ–æ‰¹é‡æ›´æ–°æ“ä½œï¼Œå­˜å‚¨è¿‡ç¨‹é€Ÿåº¦å¯æå‡30%ä»¥ä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°ä¼ é€’æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¾“å…¥å‚æ•°ï¼ˆINï¼‰&lt;/strong&gt;ï¼šè°ƒç”¨æ—¶ä¼ å…¥å€¼ï¼ˆå¦‚æŸ¥è¯¢æ¡ä»¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¾“å‡ºå‚æ•°ï¼ˆOUTï¼‰&lt;/strong&gt;ï¼šè¿”å›è®¡ç®—ç»“æœï¼ˆå¦‚èšåˆå€¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¾“å…¥è¾“å‡ºå‚æ•°ï¼ˆINOUTï¼‰&lt;/strong&gt;ï¼šåŒå‘ä¼ é€’ï¼ˆå¦‚è®¡æ•°å™¨ç´¯åŠ ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- Oracleç¤ºä¾‹ï¼šINOUTå‚æ•°æ›´æ–°æ•°æ®
CREATE PROCEDURE update_counter (val INOUT INT) AS
BEGIN
val := val + 1; -- ç›´æ¥ä¿®æ”¹å‚æ•°å€¼
END;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡é›†æˆ&lt;/strong&gt;
å­˜å‚¨è¿‡ç¨‹å¯åŒ…å«äº‹åŠ¡æ§åˆ¶ï¼ˆå¦‚&lt;code&gt;BEGIN TRANSACTION&lt;/code&gt;ã€&lt;code&gt;COMMIT&lt;/code&gt;ï¼‰ï¼Œç¡®ä¿å¤šæ­¥æ“ä½œçš„åŸå­æ€§ï¼Œé¿å…éƒ¨åˆ†å¤±è´¥å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç±»å‹ä¸ç»“æ„"&gt;ğŸ“‚ &lt;strong&gt;ç±»å‹ä¸ç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç±»&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç±»å‹&lt;/th&gt;
&lt;th&gt;å‰ç¼€&lt;/th&gt;
&lt;th&gt;ä½œç”¨&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç³»ç»Ÿå­˜å‚¨è¿‡ç¨‹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;sp_&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç®¡ç†æ•°æ®åº“ç³»ç»Ÿï¼ˆå¦‚&lt;code&gt;sp_help&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æŸ¥çœ‹è¡¨ç»“æ„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ‰©å±•å­˜å‚¨è¿‡ç¨‹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;xp_&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è°ƒç”¨æ“ä½œç³»ç»ŸåŠŸèƒ½ï¼ˆå·²é€æ¸æ·˜æ±°ï¼‰&lt;/td&gt;
&lt;td&gt;æ‰§è¡ŒShellå‘½ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨è¿‡ç¨‹&lt;/td&gt;
&lt;td&gt;è‡ªå®šä¹‰&lt;/td&gt;
&lt;td&gt;å°è£…ä¸šåŠ¡é€»è¾‘&lt;/td&gt;
&lt;td&gt;è®¢å•å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºæœ¬è¯­æ³•ç»“æ„ï¼ˆä»¥SQL Serverä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE PROCEDURE proc_name
@param1 INT,
@param2 VARCHAR(20) OUTPUT
AS
BEGIN
SELECT @param2 = COUNT(*) FROM table WHERE column = @param1;
IF @@ERROR &amp;gt; 0
RAISERROR(&amp;#39;æ“ä½œå¤±è´¥&amp;#39;, 16, 1); -- é”™è¯¯å¤„ç†
END
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŠ¿ä¸å±€é™"&gt;âœ… &lt;strong&gt;ä¼˜åŠ¿ä¸å±€é™&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å±€é™&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;âš¡ &lt;strong&gt;é«˜æ€§èƒ½&lt;/strong&gt;ï¼šå‡å°‘ç¼–è¯‘ä¸ç½‘ç»œä¼ è¾“&lt;/td&gt;
&lt;td&gt;ğŸ”„ &lt;strong&gt;ç§»æ¤æ€§å·®&lt;/strong&gt;ï¼šä¸åŒæ•°æ®åº“è¯­æ³•å·®å¼‚å¤§ï¼ˆå¦‚Oracleçš„&lt;code&gt;IS&lt;/code&gt; vs SQL Serverçš„&lt;code&gt;AS&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ğŸŒ &lt;strong&gt;ä½ç½‘ç»œæµé‡&lt;/strong&gt;ï¼šå•æ¡è°ƒç”¨ä»£æ›¿å¤šè¡ŒSQL&lt;/td&gt;
&lt;td&gt;ğŸ &lt;strong&gt;è°ƒè¯•å›°éš¾&lt;/strong&gt;ï¼šç¼ºä¹å¯è§†åŒ–å·¥å…·ï¼Œä¾èµ–æ—¥å¿—è¾“å‡º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ğŸ”’ &lt;strong&gt;é«˜å®‰å…¨æ€§&lt;/strong&gt;ï¼šé€šè¿‡æ‰§è¡Œæƒé™éš”ç¦»è¡¨è®¿é—®&lt;/td&gt;
&lt;td&gt;ğŸ“ˆ &lt;strong&gt;ç»´æŠ¤æˆæœ¬é«˜&lt;/strong&gt;ï¼šä¸šåŠ¡é€»è¾‘åˆ†æ•£åœ¨æ•°æ®åº“å±‚ï¼Œéœ€æ±‚å˜æ›´éœ€é‡å†™è¿‡ç¨‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;â™»ï¸ &lt;strong&gt;ä»£ç å¤ç”¨&lt;/strong&gt;ï¼šç»Ÿä¸€ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚è®¢å•æ ¡éªŒï¼‰&lt;/td&gt;
&lt;td&gt;ğŸš« &lt;strong&gt;ä¼˜åŒ–é™åˆ¶&lt;/strong&gt;ï¼šæ— æ³•ä½¿ç”¨&lt;code&gt;EXPLAIN&lt;/code&gt;åˆ†ææ‰§è¡Œè®¡åˆ’&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸æ¡ˆä¾‹"&gt;ğŸ’¼ &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸æ¡ˆä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é«˜é¢‘å¤æ‚æ“ä½œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šç”µå•†è®¢å•ç»“ç®—ï¼ˆè®¡ç®—æŠ˜æ‰£ã€æ›´æ–°åº“å­˜ã€ç”Ÿæˆæµæ°´ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»£ç ç‰‡æ®µï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE PROCEDURE settle_order (@order_id INT)
AS
BEGIN
UPDATE inventory SET stock = stock - order_qty WHERE product_id IN (...);
INSERT INTO payment_log (...) SELECT ... FROM orders WHERE id = @order_id;
END
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®è¿ç§»ä¸æ¸…æ´—&lt;/strong&gt;
ä½¿ç”¨ä¸´æ—¶è¡¨ï¼ˆ&lt;code&gt;#temptable&lt;/code&gt;ï¼‰å’Œæ¸¸æ ‡ï¼ˆ&lt;code&gt;CURSOR&lt;/code&gt;ï¼‰æ‰¹é‡å¤„ç†æ•°æ®ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;-- åˆ›å»ºä¸´æ—¶è¡¨å­˜å‚¨ä¸­é—´ç»“æœ
SELECT a.id, b.name INTO #temp FROM table_a a JOIN table_b b ON ...;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨åŒ–ä»»åŠ¡&lt;/strong&gt;
ç»“åˆå®šæ—¶ä»»åŠ¡ï¼ˆå¦‚SQL Agentï¼‰å®šæœŸæ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼ˆå¦‚æ¯æ—¥æŠ¥è¡¨ç”Ÿæˆï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¼€å‘æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å¼€å‘æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‘½åè§„èŒƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å‰ç¼€ç»Ÿä¸€ï¼ˆå¦‚&lt;code&gt;proc_&lt;/code&gt;ï¼‰ï¼Œé¿å…ä½¿ç”¨&lt;code&gt;sp_&lt;/code&gt;ï¼ˆç³»ç»Ÿä¿ç•™å‰ç¼€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å‘½åæ¨¡å¼ï¼š&lt;code&gt;proc_[è¡¨å]_[æ“ä½œ]&lt;/code&gt;ï¼ˆå¦‚&lt;code&gt;proc_Order_Create&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;
ä½¿ç”¨&lt;code&gt;TRY...CATCH&lt;/code&gt;ï¼ˆSQL Serverï¼‰æˆ–&lt;code&gt;EXCEPTION&lt;/code&gt;ï¼ˆOracleï¼‰æ•è·å¼‚å¸¸ï¼Œè®°å½•æ—¥å¿—ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- Oracleç¤ºä¾‹
EXCEPTION
WHEN OTHERS THEN
INSERT INTO log_info VALUES (SQLERRM, SYSDATE); -- è®°å½•é”™è¯¯ä¿¡æ¯
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…åµŒå¥—å¾ªç¯ï¼Œä¼˜å…ˆä½¿ç”¨é›†åˆæ“ä½œï¼ˆå¦‚&lt;code&gt;JOIN&lt;/code&gt;ä»£æ›¿æ¸¸æ ‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®šæœŸé‡å»ºç´¢å¼•ï¼Œå‡å°‘ç¢ç‰‡å¯¹æ‰§è¡Œè®¡åˆ’çš„å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨è¿‡ç¨‹çš„æ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;é«˜æ€§èƒ½æ‰§è¡Œå°è£…å¥½çš„ä¸šåŠ¡é€»è¾‘&lt;/strong&gt;ï¼Œå°¤å…¶é€‚åˆå¤æ‚äº‹åŠ¡ã€é«˜é¢‘è°ƒç”¨åœºæ™¯ã€‚ä½†å…¶å¼ºè€¦åˆäºæ•°æ®åº“çš„ç‰¹æ€§ï¼Œéœ€æƒè¡¡&lt;strong&gt;ä¸šåŠ¡ç¨³å®šæ€§&lt;/strong&gt;ä¸&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šOLTPç³»ç»Ÿæ ¸å¿ƒæµç¨‹ã€æ•°æ®æ‰¹å¤„ç†ã€æƒé™éš”ç¦»è¦æ±‚é«˜çš„æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;âŒ &lt;strong&gt;æ…ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè·¨æ•°æ®åº“å¹³å°é¡¹ç›®ã€å¿«é€Ÿè¿­ä»£çš„ä¸šåŠ¡æ¨¡å—ã€‚
åœ¨æ¶æ„è®¾è®¡ä¸­ï¼Œå¯ç»“åˆORMæ¡†æ¶å¤„ç†åŸºç¡€CRUDï¼Œä¿ç•™å­˜å‚¨è¿‡ç¨‹ç”¨äºæ€§èƒ½å…³é”®è·¯å¾„ï¼Œå®ç°æ•ˆç‡ä¸çµæ´»æ€§çš„å¹³è¡¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="æ•°æ®åº“è§†å›¾"&gt;æ•°æ®åº“è§†å›¾
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å…³äºæ•°æ®åº“è§†å›¾çš„å…¨é¢ä»‹ç»ï¼Œæ¶µç›–æ ¸å¿ƒæ¦‚å¿µã€æ ¸å¿ƒç‰¹ç‚¹ã€ä½¿ç”¨æ–¹æ³•åŠå®é™…åº”ç”¨åœºæ™¯ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è§†å›¾çš„æ ¸å¿ƒæ¦‚å¿µ"&gt;ğŸ–¼ï¸ &lt;strong&gt;è§†å›¾çš„æ ¸å¿ƒæ¦‚å¿µ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è§†å›¾ï¼ˆViewï¼‰æ˜¯æ•°æ®åº“ä¸­çš„&lt;strong&gt;è™šæ‹Ÿè¡¨&lt;/strong&gt;ï¼Œå…¶å†…å®¹ç”±ä¸€ä¸ªæˆ–å¤šä¸ªåŸºè¡¨ï¼ˆå®é™…å­˜å‚¨æ•°æ®çš„è¡¨ï¼‰é€šè¿‡&lt;code&gt;SELECT&lt;/code&gt;æŸ¥è¯¢åŠ¨æ€ç”Ÿæˆã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;ï¼šä¸€æ¡å­˜å‚¨çš„&lt;code&gt;SELECT&lt;/code&gt;è¯­å¥ï¼Œä¸ç›´æ¥å­˜å‚¨æ•°æ®ï¼Œæ•°æ®ä»å­˜åœ¨äºåŸºè¡¨ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;ç»„æˆï¼š
&lt;ul&gt;
&lt;li&gt;è¡Œå’Œåˆ—çš„ç»“æ„ä¸ç‰©ç†è¡¨ç±»ä¼¼ï¼Œæ•°æ®æ¥æºäºåŸºè¡¨æˆ–åµŒå¥—è§†å›¾ã€‚&lt;/li&gt;
&lt;li&gt;åŸºè¡¨å¯ä»¥æ˜¯å•è¡¨ã€å¤šè¡¨è”æ¥æˆ–èšåˆç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è§†å›¾çš„æ ¸å¿ƒç‰¹ç‚¹"&gt;âš™ï¸ &lt;strong&gt;è§†å›¾çš„æ ¸å¿ƒç‰¹ç‚¹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç®€åŒ–å¤æ‚æ“ä½œ"&gt;&lt;strong&gt;ç®€åŒ–å¤æ‚æ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å°†å¤šè¡¨è”æ¥ã€èšåˆè®¡ç®—ç­‰å¤æ‚æŸ¥è¯¢å°è£…ä¸ºç®€å•è§†å›¾ï¼Œç”¨æˆ·åªéœ€æŸ¥è¯¢è§†å›¾è€Œéç¼–å†™é•¿SQLã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šç»Ÿè®¡å®¢æˆ·è®¢å•æ€»é‡‘é¢çš„è§†å›¾ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE VIEW vw_CustomerOrderTotals AS
SELECT c.CustomerID, c.CustomerName, SUM(od.Quantity * p.Price) AS TotalAmount
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
GROUP BY c.CustomerID, c.CustomerName;
&lt;/code&gt;&lt;/pre&gt;ç”¨æˆ·åç»­åªéœ€æ‰§è¡Œï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM vw_CustomerOrderTotals
&lt;/code&gt;&lt;/pre&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®å®‰å…¨æ€§"&gt;&lt;strong&gt;æ•°æ®å®‰å…¨æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ—çº§éšè—&lt;/strong&gt;ï¼šä»…æš´éœ²éƒ¨åˆ†åˆ—ï¼ˆå¦‚éšè—å·¥èµ„åˆ—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡Œçº§è¿‡æ»¤&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;WHERE&lt;/code&gt;é™åˆ¶ç”¨æˆ·å¯è§æ•°æ®ï¼ˆå¦‚ä»…æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æ–¹æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;è¡¨ä¸­å¢åŠ ç”¨æˆ·æ ‡è¯†åˆ—ï¼ˆå¦‚&lt;code&gt;username&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åˆ›å»ºè§†å›¾ï¼š&lt;code&gt;CREATE VIEW user_view AS SELECT * FROM table WHERE username = CURRENT_USER&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é€»è¾‘æ•°æ®ç‹¬ç«‹æ€§"&gt;&lt;strong&gt;é€»è¾‘æ•°æ®ç‹¬ç«‹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å±è”½è¡¨ç»“æ„å˜æ›´ï¼šå½“åŸºè¡¨ç»“æ„å˜åŒ–ï¼ˆå¦‚åˆ†è¡¨ã€å¢åˆ åˆ—ï¼‰ï¼Œå¯é€šè¿‡ä¿®æ”¹è§†å›¾ä¿æŒåº”ç”¨å±‚ä¸å˜ã€‚
ç¤ºä¾‹ï¼šåŸºè¡¨
&lt;pre tabindex="0"&gt;&lt;code&gt;Student
&lt;/code&gt;&lt;/pre&gt;æ‹†åˆ†ä¸º
&lt;pre tabindex="0"&gt;&lt;code&gt;SX
&lt;/code&gt;&lt;/pre&gt;ï¼ˆå­¦å·ã€å§“åï¼‰å’Œ
&lt;pre tabindex="0"&gt;&lt;code&gt;SY
&lt;/code&gt;&lt;/pre&gt;ï¼ˆæ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œåˆ›å»ºè§†å›¾è¿˜åŸåŸç»“æ„ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE VIEW Student AS
SELECT SX.Sno, SX.Sname, SY.Ssex, SY.Sage
FROM SX JOIN SY ON SX.Sno = SY.Sno;
&lt;/code&gt;&lt;/pre&gt;åº”ç”¨ä»å¯æŸ¥è¯¢
&lt;pre tabindex="0"&gt;&lt;code&gt;Student
&lt;/code&gt;&lt;/pre&gt;è§†å›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤šè§’åº¦æ•°æ®å‘ˆç°"&gt;&lt;strong&gt;å¤šè§’åº¦æ•°æ®å‘ˆç°&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŒä¸€æ•°æ®æ ¹æ®ä¸åŒä¸šåŠ¡éœ€æ±‚ç”Ÿæˆä¸åŒè§†å›¾ï¼ˆå¦‚é”€å”®è§†å›¾ã€è´¢åŠ¡è§†å›¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è§†å›¾çš„åˆ›å»ºä¸ç®¡ç†"&gt;ğŸ“ &lt;strong&gt;è§†å›¾çš„åˆ›å»ºä¸ç®¡ç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åˆ›å»ºè¯­æ³•"&gt;&lt;strong&gt;åˆ›å»ºè¯­æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE [OR REPLACE] VIEW è§†å›¾å [(åˆ—åˆ«å)]
AS
SELECT åˆ—1, åˆ—2, ...
FROM åŸºè¡¨
[WHERE æ¡ä»¶]
[WITH CHECK OPTION]; -- ç¡®ä¿æ›´æ–°ç¬¦åˆè§†å›¾æ¡ä»¶
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å…³é”®å‚æ•°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;OR REPLACE&lt;/code&gt;ï¼šè¦†ç›–åŒåè§†å›¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WITH CHECK OPTION&lt;/code&gt;ï¼šç¦æ­¢æ’å…¥/æ›´æ–°ä¸ç¬¦åˆè§†å›¾æ¡ä»¶çš„æ•°æ®ï¼ˆå¦‚è§†å›¾è¿‡æ»¤&lt;code&gt;å¹´é¾„&amp;gt;18&lt;/code&gt;ï¼Œåˆ™ç¦æ­¢æ’å…¥å¹´é¾„â‰¤18çš„æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ›´æ–°ä¸åˆ é™¤"&gt;&lt;strong&gt;æ›´æ–°ä¸åˆ é™¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ›´æ–°è§†å›¾ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ALTER VIEW è§†å›¾å AS æ–°æŸ¥è¯¢è¯­å¥; -- æˆ– CREATE OR REPLACE VIEW
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;åˆ é™¤è§†å›¾ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;DROP VIEW è§†å›¾å;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®æ“ä½œé™åˆ¶"&gt;&lt;strong&gt;æ•°æ®æ“ä½œé™åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å¯æ›´æ–°è§†å›¾ï¼šæ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶å¯é€šè¿‡è§†å›¾ä¿®æ”¹åŸºè¡¨æ•°æ®ï¼š
&lt;ul&gt;
&lt;li&gt;æºè‡ªå•è¡¨ï¼ˆéå¤šè¡¨è”æ¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸å«èšåˆå‡½æ•°ã€&lt;code&gt;DISTINCT&lt;/code&gt;ã€&lt;code&gt;GROUP BY&lt;/code&gt;ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¯æ›´æ–°è§†å›¾&lt;/strong&gt;ï¼šéœ€é€šè¿‡&lt;code&gt;INSTEAD OF&lt;/code&gt;è§¦å‘å™¨å®ç°æ›´æ–°ï¼ˆå¦‚SQL Serverï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è§†å›¾çš„ç±»å‹ä»¥sql-serverä¸ºä¾‹"&gt;ğŸ”§ &lt;strong&gt;è§†å›¾çš„ç±»å‹ï¼ˆä»¥SQL Serverä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ‡å‡†è§†å›¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€ç”Ÿæˆç»“æœé›†ï¼ˆé»˜è®¤ç±»å‹ï¼‰&lt;/td&gt;
&lt;td&gt;ç®€åŒ–æŸ¥è¯¢ã€æƒé™æ§åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç´¢å¼•è§†å›¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºå”¯ä¸€èšé›†ç´¢å¼•ï¼Œç‰©åŒ–æ•°æ®&lt;/td&gt;
&lt;td&gt;é¢‘ç¹æŸ¥è¯¢çš„èšåˆç»“æœï¼ˆéœ€é«˜æ€§èƒ½ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†åŒºè§†å›¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆå¹¶å¤šä¸ªè¡¨çš„åˆ†åŒºæ•°æ®&lt;/td&gt;
&lt;td&gt;æ°´å¹³åˆ†è¡¨çš„å¤§å‹æ•°æ®åº“&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ç´¢å¼•è§†å›¾è¦æ±‚&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¦æ­¢ä½¿ç”¨&lt;code&gt;*&lt;/code&gt;ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šåˆ—åã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰è¡¨éœ€åŠ æ¶æ„å‰ç¼€ï¼ˆå¦‚&lt;code&gt;dbo.Table1&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸æ”¯æŒé‡å¤åˆ—åã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åº”ç”¨åœºæ™¯"&gt;ğŸ† &lt;strong&gt;å®é™…åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é«˜é¢‘å¤æ‚æŸ¥è¯¢ï¼š
&lt;ul&gt;
&lt;li&gt;å°†å¤šè¡¨è”æ¥æŸ¥è¯¢å°è£…ä¸ºè§†å›¾ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åŠ¨æ€æ•°æ®è„±æ•ï¼š
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚èº«ä»½è¯å·ï¼‰çš„è§†å›¾ä¾›æ™®é€šç”¨æˆ·è®¿é—®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ†æƒåˆ†åŸŸç®¡ç†ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸ºä¸åŒéƒ¨é—¨ï¼ˆé”€å”®ã€è´¢åŠ¡ï¼‰æä¾›å®šåˆ¶åŒ–æ•°æ®è§†å›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®è¿ç§»å…¼å®¹ï¼š
&lt;ul&gt;
&lt;li&gt;åŸºè¡¨é‡æ„æ—¶ï¼Œé€šè¿‡è§†å›¾ä¿æŒæ—§æ¥å£å…¼å®¹æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å±€é™ä¸æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å±€é™ä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ€§èƒ½æŸè€—ï¼š
&lt;ul&gt;
&lt;li&gt;è§†å›¾æŸ¥è¯¢éœ€åŠ¨æ€ç”Ÿæˆç»“æœï¼Œå¤æ‚è§†å›¾å¯èƒ½æ¯”ç›´æ¥æŸ¥è¡¨æ…¢ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…åœ¨å¤§å‹è¡¨ä¸Šåˆ›å»ºåµŒå¥—è§†å›¾ï¼ˆå¤šå±‚è§†å›¾ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹èšåˆç±»é«˜é¢‘æŸ¥è¯¢æ”¹ç”¨ç´¢å¼•è§†å›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ›´æ–°é™åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;å«èšåˆã€åˆ†ç»„ã€å­æŸ¥è¯¢çš„è§†å›¾ä¸å¯ç›´æ¥æ›´æ–°ï¼Œéœ€é€šè¿‡è§¦å‘å™¨æˆ–åŸºè¡¨æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç»´æŠ¤æˆæœ¬ï¼š
&lt;ul&gt;
&lt;li&gt;è§†å›¾ä¾èµ–åŸºè¡¨ç»“æ„ï¼ŒåŸºè¡¨å˜æ›´éœ€åŒæ­¥ä¿®æ”¹è§†å›¾å®šä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è§†å›¾æ˜¯æ•°æ®åº“è®¾è®¡çš„&lt;strong&gt;é€»è¾‘æŠ½è±¡å±‚&lt;/strong&gt;ï¼Œé€šè¿‡è™šæ‹Ÿè¡¨å®ç° &lt;strong&gt;â€œæ•°æ®ä¸ä¸šåŠ¡è§£è€¦â€&lt;/strong&gt; ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šç®€åŒ–æ“ä½œã€ä¿éšœå®‰å…¨ã€éš”ç¦»å˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;æ…ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè¶…å¤§å‹è¡¨ã€é«˜é¢‘æ›´æ–°æ“ä½œã€æ·±åº¦åµŒå¥—æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼šå¯¹å…³é”®è§†å›¾æ·»åŠ æ³¨é‡Šè¯´æ˜ç”¨é€”ï¼Œå®šæœŸå®¡æŸ¥æ€§èƒ½ï¼Œç»“åˆç´¢å¼•è§†å›¾ä¼˜åŒ–é«˜é¢‘æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="è§†å›¾-vs-å­˜å‚¨è¿‡ç¨‹"&gt;è§†å›¾ vs. å­˜å‚¨è¿‡ç¨‹
&lt;/h2&gt;&lt;p&gt;è§†å›¾å’Œå­˜å‚¨è¿‡ç¨‹æ˜¯æ•°æ®åº“ä¸­ä¸¤ç§é‡è¦çš„å¯¹è±¡ï¼Œå®ƒä»¬éƒ½èƒ½å°è£…é€»è¾‘å¹¶æå‡æ•ˆç‡ï¼Œä½†æœ¬è´¨å’Œç”¨é€”å·®å¼‚æ˜¾è‘—ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„æ ¸å¿ƒå¼‚åŒç‚¹åŠé€‚ç”¨åœºæ™¯åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç›¸åŒç‚¹"&gt;ğŸ”„ &lt;strong&gt;ç›¸åŒç‚¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å°è£…å¤æ‚é€»è¾‘&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä¸¤è€…å‡å¯å°†å¤æ‚çš„ SQL æ“ä½œï¼ˆå¦‚å¤šè¡¨å…³è”ã€èšåˆè®¡ç®—ï¼‰å°è£…ä¸ºå¯å¤ç”¨çš„æ¨¡å—ï¼Œç®€åŒ–åº”ç”¨å±‚è°ƒç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;æå‡å®‰å…¨æ€§&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡æƒé™æ§åˆ¶ï¼Œé™åˆ¶ç”¨æˆ·ç›´æ¥è®¿é—®åŸºè¡¨ï¼Œä»…æš´éœ²å¿…è¦æ•°æ®æˆ–æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;å‡å°‘ç½‘ç»œå¼€é”€&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯åªéœ€è°ƒç”¨è§†å›¾æˆ–å­˜å‚¨è¿‡ç¨‹ï¼Œé¿å…ä¼ è¾“å¤§é‡åŸå§‹ SQL è¯­å¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå·®å¼‚"&gt;âš–ï¸ &lt;strong&gt;æ ¸å¿ƒå·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§†å›¾ï¼ˆViewï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è™šæ‹Ÿè¡¨ï¼ˆåŸºäº &lt;code&gt;SELECT&lt;/code&gt; çš„åŠ¨æ€ç»“æœé›†ï¼‰&lt;/td&gt;
&lt;td&gt;é¢„ç¼–è¯‘çš„ SQL ä»£ç å—ï¼ˆå¯å«ä¸šåŠ¡é€»è¾‘ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…æ”¯æŒæŸ¥è¯¢ï¼ˆ&lt;code&gt;SELECT&lt;/code&gt;ï¼‰ï¼Œéƒ¨åˆ†ç®€å•è§†å›¾å¯æ›´æ–°åŸºè¡¨&lt;/td&gt;
&lt;td&gt;æ”¯æŒå¢åˆ æ”¹æŸ¥ï¼ˆ&lt;code&gt;DML&lt;/code&gt;ï¼‰ã€äº‹åŠ¡æ§åˆ¶ï¼ˆ&lt;code&gt;COMMIT/ROLLBACK&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— å‚æ•°&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒè¾“å…¥/è¾“å‡ºå‚æ•°ï¼Œçµæ´»ä¼ é€’æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œæ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åƒè¡¨ä¸€æ ·æŸ¥è¯¢ï¼ˆ&lt;code&gt;SELECT * FROM view&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€æ˜¾å¼è°ƒç”¨ï¼ˆ&lt;code&gt;CALL proc()&lt;/code&gt; æˆ– &lt;code&gt;EXEC proc&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ç‰¹ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯æ¬¡æŸ¥è¯¢åŠ¨æ€ç”Ÿæˆç»“æœï¼Œå¤æ‚è§†å›¾å¯èƒ½è¾ƒæ…¢&lt;/td&gt;
&lt;td&gt;é¢„ç¼–è¯‘æ‰§è¡Œï¼Œé«˜é¢‘è°ƒç”¨æ•ˆç‡æ›´é«˜ï¼ˆå‡å°‘ SQL è§£æå¼€é”€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–ç¨‹èƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— æµç¨‹æ§åˆ¶&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒæ¡ä»¶åˆ†æ”¯ï¼ˆ&lt;code&gt;IF&lt;/code&gt;ï¼‰ã€å¾ªç¯ï¼ˆ&lt;code&gt;LOOP&lt;/code&gt;ï¼‰ã€å¼‚å¸¸å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…å­˜å‚¨æŸ¥è¯¢å®šä¹‰ï¼ˆæ— å®é™…æ•°æ®ï¼‰&lt;/td&gt;
&lt;td&gt;å­˜å‚¨æºä»£ç åŠç¼–è¯‘åçš„ä¸­é—´ä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯å¯¹æ¯”"&gt;ğŸ¯ &lt;strong&gt;é€‚ç”¨åœºæ™¯å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="è§†å›¾çš„ç†æƒ³åœºæ™¯"&gt;&lt;strong&gt;è§†å›¾çš„ç†æƒ³åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;ç®€åŒ–é«˜é¢‘å¤æ‚æŸ¥è¯¢&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å°è£…å¤šè¡¨&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; JOIN
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–èšåˆæ“ä½œï¼Œå¦‚ç»Ÿè®¡ç”¨æˆ·è®¢å•æ±‡æ€»ï¼š
&lt;code&gt;CREATE VIEW v_orders_summary AS SELECT user_id, SUM(amount) AS total FROM orders GROUP BY user_id; &lt;/code&gt;
â†’ åº”ç”¨å±‚ç›´æ¥&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; SELECT * FROM v_orders_summary
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt; ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start="2"&gt;
&lt;li&gt;æ•°æ®å®‰å…¨ä¸æŠ½è±¡&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;éšè—æ•æ„Ÿåˆ—ï¼ˆå¦‚å¯†ç ã€è–ªèµ„ï¼‰ï¼Œæˆ–é‡æ„è¡¨ç»“æ„æ—¶æä¾›å…¼å®¹æ¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;ç»Ÿä¸€æ•°æ®å±•ç¤º&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºä¸åŒéƒ¨é—¨å®šåˆ¶æ•°æ®è§†å›¾ï¼ˆå¦‚é”€å”®è§†å›¾ä»…æ˜¾ç¤ºå®¢æˆ·å§“åã€è®¢å•é‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å­˜å‚¨è¿‡ç¨‹çš„ç†æƒ³åœºæ™¯"&gt;&lt;strong&gt;å­˜å‚¨è¿‡ç¨‹çš„ç†æƒ³åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;äº‹åŠ¡æ€§ä¸šåŠ¡é€»è¾‘&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å°è£…åŸå­æ“ä½œï¼ˆå¦‚è½¬è´¦ï¼šæ‰£æ¬¾+è®°å½•æ—¥å¿—+æ›´æ–°ä½™é¢ï¼‰ï¼Œç¡®ä¿äº‹åŠ¡ä¸€è‡´æ€§ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE PROCEDURE transfer_funds(IN from_acc INT, IN to_acc INT, IN amt DECIMAL)
BEGIN
START TRANSACTION;
UPDATE accounts SET balance = balance - amt WHERE id = from_acc;
UPDATE accounts SET balance = balance + amt WHERE id = to_acc;
INSERT INTO audit_log (action) VALUES (&amp;#39;Funds transferred&amp;#39;);
COMMIT;
END;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;é«˜é¢‘æ€§èƒ½æ•æ„Ÿæ“ä½œ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é¢„ç¼–è¯‘å‡å°‘è§£æå¼€é”€ï¼Œé€‚åˆæ‰¹é‡æ•°æ®å¤„ç†æˆ–å®æ—¶æŠ¥è¡¨ç”Ÿæˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;å¤æ‚é€»è¾‘å¤„ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç»“åˆæ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ï¼ˆå¦‚æ•°æ®æ¸…æ´—ï¼šéå†è¡¨è®°å½•å¹¶ä¿®æ­£å¼‚å¸¸å€¼ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é™åˆ¶ä¸æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å…³é”®é™åˆ¶ä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§†å›¾&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å­˜å‚¨è¿‡ç¨‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ›´æ–°é™åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å«èšåˆã€&lt;code&gt;DISTINCT&lt;/code&gt;ã€å­æŸ¥è¯¢çš„è§†å›¾ä¸å¯æ›´æ–°&lt;/td&gt;
&lt;td&gt;æ— æ›´æ–°é™åˆ¶ï¼Œä½†å¤æ‚é€»è¾‘éœ€é˜²æ­»é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»´æŠ¤éš¾åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»“æ„ç®€å•ï¼Œä¾èµ–åŸºè¡¨ç»“æ„å˜åŒ–&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡é€»è¾‘è€¦åˆåº¦é«˜ï¼Œè°ƒè¯•å›°éš¾ï¼ˆéœ€ç‰ˆæœ¬ç®¡ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è·¨å¹³å°å…¼å®¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ ‡å‡† SQL è¯­æ³•ï¼Œå…¼å®¹æ€§å¥½&lt;/td&gt;
&lt;td&gt;è¯­æ³•æ•°æ®åº“ä¾èµ–æ€§å¼ºï¼ˆå¦‚ MySQL vs. SQL Serverï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“å¦‚ä½•é€‰æ‹©"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰è§†å›¾&lt;/strong&gt;ï¼š
âœ… ä»…éœ€&lt;strong&gt;ç®€åŒ–æŸ¥è¯¢&lt;/strong&gt;ã€&lt;strong&gt;æ•°æ®è„±æ•&lt;/strong&gt;æˆ–&lt;strong&gt;ç»Ÿä¸€æ¥å£&lt;/strong&gt;æ—¶ï¼›
âœ… è½»é‡åŒ–é€»è¾‘ï¼Œæ— å‚æ•°æˆ–æµç¨‹æ§åˆ¶éœ€æ±‚æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰å­˜å‚¨è¿‡ç¨‹&lt;/strong&gt;ï¼š
âœ… éœ€&lt;strong&gt;å°è£…äº‹åŠ¡&lt;/strong&gt;ã€&lt;strong&gt;å¤„ç†å¤æ‚ä¸šåŠ¡é€»è¾‘&lt;/strong&gt;æˆ–&lt;strong&gt;é«˜é¢‘è°ƒç”¨ä¼˜åŒ–æ€§èƒ½&lt;/strong&gt;æ—¶ï¼›
âœ… éœ€å‚æ•°ä¼ é€’æˆ–è¿”å›ç»“æœé›†æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“åˆä½¿ç”¨&lt;/strong&gt;ï¼š
ç”¨è§†å›¾æä¾›æ•°æ®å…¥å£ï¼Œå­˜å‚¨è¿‡ç¨‹å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œå…¼é¡¾å®‰å…¨æ€§ä¸æ•ˆç‡ï¼ˆå¦‚ï¼šå­˜å‚¨è¿‡ç¨‹è°ƒç”¨è§†å›¾ç»“æœå†åŠ å·¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒå·®å¼‚ä¸€å¥è¯æ€»ç»“&lt;/strong&gt;ï¼šè§†å›¾æ˜¯â€œåŠ¨æ€æŸ¥è¯¢ç»“æœçš„çª—å£â€ï¼Œé‡åœ¨ç®€åŒ–æ•°æ®å±•ç¤ºï¼›å­˜å‚¨è¿‡ç¨‹æ˜¯â€œé¢„ç¼–è¯‘çš„ä¸šåŠ¡è„šæœ¬â€ï¼Œé‡åœ¨å¤„ç†é€»è¾‘ä¸äº‹åŠ¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ•°æ®åº“èŒƒå¼"&gt;æ•°æ®åº“èŒƒå¼
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯æ•°æ®åº“èŒƒå¼çš„ç³»ç»Ÿæ€§ä»‹ç»ï¼Œæ¶µç›–æ ¸å¿ƒæ¦‚å¿µã€å„çº§èŒƒå¼åŸç†ã€åº”ç”¨åœºæ™¯åŠè®¾è®¡æƒè¡¡ï¼Œç»“åˆè¡Œä¸šå®è·µå’Œç†è®ºè§„èŒƒæ•´ç†è€Œæˆï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-èŒƒå¼æ ¸å¿ƒæ¦‚å¿µ"&gt;ğŸ§± &lt;strong&gt;èŒƒå¼æ ¸å¿ƒæ¦‚å¿µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰ä¸ç›®çš„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;ï¼šæ•°æ®åº“èŒƒå¼ï¼ˆNormal Formï¼‰æ˜¯å…³ç³»æ•°æ®åº“è®¾è®¡çš„è§„èŒƒåŒ–è§„åˆ™ï¼Œæ—¨åœ¨&lt;strong&gt;æ¶ˆé™¤æ•°æ®å†—ä½™&lt;/strong&gt;ã€&lt;strong&gt;é¿å…æ“ä½œå¼‚å¸¸&lt;/strong&gt;ï¼ˆæ’å…¥/æ›´æ–°/åˆ é™¤å¼‚å¸¸ï¼‰ï¼Œå¹¶æå‡æ•°æ®ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒç›®æ ‡ï¼š
&lt;ul&gt;
&lt;li&gt;å‡å°‘é‡å¤æ•°æ®å­˜å‚¨ï¼ˆå¦‚é¿å…åŒä¸€ä¿¡æ¯åœ¨å¤šè¡Œé‡å¤ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;ç¡®ä¿æ•°æ®ä¾èµ–å…³ç³»åˆç†ï¼ˆå¦‚å±æ€§å®Œå…¨ä¾èµ–äºä¸»é”®ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;ç®€åŒ–æ•°æ®ç»“æ„ï¼Œæå‡å¯ç»´æŠ¤æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŒƒå¼å‘å±•å±‚çº§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»ä½çº§åˆ°é«˜çº§å…±å…­ç§èŒƒå¼ï¼ˆ1NF â†’ 6NFï¼‰ï¼Œé«˜çº§èŒƒå¼å…¼å®¹ä½çº§è¦æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨å±‚çº§&lt;/strong&gt;ï¼šå¤šæ•°æ•°æ®åº“æ»¡è¶³&lt;strong&gt;ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰&lt;/strong&gt; å³å¯å¹³è¡¡æ€§èƒ½ä¸è§„èŒƒæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å„çº§èŒƒå¼è¯¦è§£ä¸å®ä¾‹"&gt;ğŸ” &lt;strong&gt;å„çº§èŒƒå¼è¯¦è§£ä¸å®ä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç¬¬ä¸€èŒƒå¼1nf"&gt;&lt;strong&gt;ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¦æ±‚&lt;/strong&gt;ï¼šè¡¨ä¸­æ¯åˆ—å‡ä¸º&lt;strong&gt;åŸå­æ•°æ®é¡¹&lt;/strong&gt;ï¼ˆä¸å¯å†åˆ†ï¼‰ï¼Œæ— é‡å¤åˆ—æˆ–å¤åˆå€¼ã€‚&lt;/li&gt;
&lt;li&gt;é—®é¢˜æ¡ˆä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;| å­¦ç”ŸID | è”ç³»æ–¹å¼ |
|--------|------------------------|
| 101 | 138xxx,abc@example.com | // è¿å1NFï¼ˆå«æ‰‹æœºå·+é‚®ç®±ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼šæ‹†åˆ†å¤åˆåˆ—ä¸ºç‹¬ç«‹åŸå­åˆ—ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE TABLE Students (
å­¦ç”ŸID INT PRIMARY KEY,
æ‰‹æœºå· VARCHAR(15),
é‚®ç®± VARCHAR(50)
);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®é™…æ„ä¹‰&lt;/strong&gt;ï¼šç°ä»£æ•°æ®åº“ç³»ç»Ÿï¼ˆå¦‚MySQLï¼‰é»˜è®¤å¼ºåˆ¶æ»¡è¶³1NFã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç¬¬äºŒèŒƒå¼2nf"&gt;&lt;strong&gt;ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‰æ&lt;/strong&gt;ï¼šå·²æ»¡è¶³1NFã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¦æ±‚&lt;/strong&gt;ï¼š&lt;strong&gt;éä¸»å±æ€§å®Œå…¨ä¾èµ–ä¸»é”®&lt;/strong&gt;ï¼ˆä¸å­˜åœ¨éƒ¨åˆ†ä¾èµ–ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é—®é¢˜æ¡ˆä¾‹ï¼ˆé€‰è¯¾è¡¨ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;| å­¦å· | è¯¾ç¨‹ | æˆç»© | å­¦åˆ† | // ä¸»é”®ï¼š(å­¦å·, è¯¾ç¨‹)
|------|------|------|------|
| S01 | æ•°å­¦ | 90 | 4 |
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;å­¦åˆ†
&lt;/code&gt;&lt;/pre&gt;ä»…ä¾èµ–
&lt;pre tabindex="0"&gt;&lt;code&gt;è¯¾ç¨‹
&lt;/code&gt;&lt;/pre&gt;ï¼ˆéƒ¨åˆ†ä¾èµ–ä¸»é”®ï¼‰ï¼Œå¯¼è‡´ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å†—ä½™&lt;/strong&gt;ï¼šåŒä¸€è¯¾ç¨‹å­¦åˆ†é‡å¤å­˜å‚¨ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–°å¼‚å¸¸&lt;/strong&gt;ï¼šä¿®æ”¹è¯¾ç¨‹å­¦åˆ†éœ€æ›´æ–°å¤šè¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼šæ‹†åˆ†è¡¨ï¼Œæ¶ˆé™¤éƒ¨åˆ†ä¾èµ–ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- é€‰è¯¾æˆç»©è¡¨
CREATE TABLE Scores (å­¦å·, è¯¾ç¨‹, æˆç»©, PRIMARY KEY(å­¦å·, è¯¾ç¨‹));
-- è¯¾ç¨‹ä¿¡æ¯è¡¨
CREATE TABLE Courses (è¯¾ç¨‹, å­¦åˆ†, PRIMARY KEY(è¯¾ç¨‹));
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç¬¬ä¸‰èŒƒå¼3nf"&gt;&lt;strong&gt;ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‰æ&lt;/strong&gt;ï¼šå·²æ»¡è¶³2NFã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¦æ±‚&lt;/strong&gt;ï¼š&lt;strong&gt;éä¸»å±æ€§é—´æ— ä¼ é€’ä¾èµ–&lt;/strong&gt;ï¼ˆå¦‚Aâ†’Bâ†’Cï¼Œåˆ™Aâ†’Cä¸ºä¼ é€’ä¾èµ–ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é—®é¢˜æ¡ˆä¾‹ï¼ˆå‘˜å·¥è¡¨ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;| å‘˜å·¥ID | å§“å | éƒ¨é—¨ID | éƒ¨é—¨åç§° | // éƒ¨é—¨åç§°ä¾èµ–äºéƒ¨é—¨IDï¼Œéƒ¨é—¨IDä¾èµ–äºå‘˜å·¥ID
|---------|------|---------|----------|
| E001 | å¼ ä¸‰ | D01 | æŠ€æœ¯éƒ¨ |
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;éƒ¨é—¨åç§°
&lt;/code&gt;&lt;/pre&gt;ä¼ é€’ä¾èµ–äº
&lt;pre tabindex="0"&gt;&lt;code&gt;å‘˜å·¥ID
&lt;/code&gt;&lt;/pre&gt;ï¼Œå¯¼è‡´ï¼š
&lt;ul&gt;
&lt;li&gt;éƒ¨é—¨åç§°é‡å¤å­˜å‚¨ï¼›&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹éƒ¨é—¨åç§°éœ€æ›´æ–°å¤šæ¡è®°å½•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼šæ‹†åˆ†éƒ¨é—¨ä¿¡æ¯ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- å‘˜å·¥è¡¨
CREATE TABLE Employees (å‘˜å·¥ID, å§“å, éƒ¨é—¨ID);
-- éƒ¨é—¨è¡¨
CREATE TABLE Departments (éƒ¨é—¨ID, éƒ¨é—¨åç§°);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="bcèŒƒå¼bcnf"&gt;&lt;strong&gt;BCèŒƒå¼ï¼ˆBCNFï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºåŒ–ç‰ˆ3NF&lt;/strong&gt;ï¼šæ¶ˆé™¤&lt;strong&gt;ä¸»å±æ€§å¯¹å€™é€‰ç çš„éƒ¨åˆ†/ä¼ é€’ä¾èµ–&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼šå¤šå€™é€‰ç è¡¨ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;| å­¦ç”Ÿ | è¯¾ç¨‹ | æ•™å¸ˆ | // å‡è®¾ï¼šæ¯ä½æ•™å¸ˆåªæ•™ä¸€é—¨è¯¾ï¼Œæ¯é—¨è¯¾æœ‰å¤šåæ•™å¸ˆ
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šè‹¥&lt;code&gt;(å­¦ç”Ÿ, è¯¾ç¨‹)&lt;/code&gt;å’Œ&lt;code&gt;(å­¦ç”Ÿ, æ•™å¸ˆ)&lt;/code&gt;å‡ä¸ºå€™é€‰ç ï¼Œåˆ™&lt;code&gt;æ•™å¸ˆ&lt;/code&gt;éƒ¨åˆ†ä¾èµ–äºå€™é€‰ç &lt;code&gt;(å­¦ç”Ÿ, è¯¾ç¨‹)&lt;/code&gt;ï¼ˆå› è¯¾ç¨‹â†’æ•™å¸ˆï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šæ‹†åˆ†ä¸º&lt;code&gt;é€‰è¯¾(å­¦ç”Ÿ, è¯¾ç¨‹)&lt;/code&gt;å’Œ&lt;code&gt;æˆè¯¾(è¯¾ç¨‹, æ•™å¸ˆ)&lt;/code&gt;è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜é˜¶èŒƒå¼ä¸åèŒƒå¼è®¾è®¡"&gt;âš–ï¸ &lt;strong&gt;é«˜é˜¶èŒƒå¼ä¸åèŒƒå¼è®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é«˜é˜¶èŒƒå¼4nf5nf"&gt;&lt;strong&gt;é«˜é˜¶èŒƒå¼ï¼ˆ4NF/5NFï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;4NF&lt;/strong&gt;ï¼šæ¶ˆé™¤éå¹³å‡¡å¤šå€¼ä¾èµ–ï¼ˆå¦‚ä¸€ä¸ªå±æ€§å†³å®šå¤šä¸ªç‹¬ç«‹å±æ€§é›†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;5NF&lt;/strong&gt;ï¼šæ¶ˆé™¤è¿æ¥ä¾èµ–ï¼ˆè§£å†³å¤šè¡¨å…³è”å†—ä½™ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè¶…å¤§å‹å¤æ‚ç³»ç»Ÿï¼ˆå¦‚é‡‘èæ ¸å¿ƒåº“ï¼‰ï¼Œä¸€èˆ¬é¡¹ç›®è¾ƒå°‘ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åèŒƒå¼è®¾è®¡denormalization"&gt;&lt;strong&gt;åèŒƒå¼è®¾è®¡ï¼ˆDenormalizationï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç›®çš„&lt;/strong&gt;ï¼š&lt;strong&gt;ç‰ºç‰²éƒ¨åˆ†è§„èŒƒæ€§ä»¥æå‡æŸ¥è¯¢æ€§èƒ½&lt;/strong&gt;ï¼Œå¸¸è§äºè¯»å¯†é›†å‹åœºæ™¯ï¼ˆå¦‚æ•°æ®ä»“åº“ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹å®è·µï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†—ä½™å­—æ®µ&lt;/strong&gt;ï¼šåœ¨è®¢å•è¡¨ä¸­ç›´æ¥å­˜å‚¨ç”¨æˆ·å§“åï¼ˆé¿å…è¿è¡¨æŸ¥è¯¢ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ±‡æ€»è¡¨&lt;/strong&gt;ï¼šé¢„è®¡ç®—å¹¶å­˜å‚¨æ¯æ—¥é”€å”®é¢ï¼ˆåŠ é€Ÿç»Ÿè®¡æŸ¥è¯¢ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©æ§åˆ¶&lt;/strong&gt;ï¼šéœ€é€šè¿‡åº”ç”¨å±‚é€»è¾‘æˆ–è§¦å‘å™¨ç¡®ä¿å†—ä½™æ•°æ®ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-èŒƒå¼åº”ç”¨å†³ç­–æŒ‡å—"&gt;ğŸ“Š &lt;strong&gt;èŒƒå¼åº”ç”¨å†³ç­–æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èèŒƒå¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OLTPç³»ç»Ÿï¼ˆäº‹åŠ¡å¤„ç†ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;3NFæˆ–BCNF&lt;/td&gt;
&lt;td&gt;å†™æ“ä½œé¢‘ç¹ï¼Œéœ€é¿å…æ›´æ–°å¼‚å¸¸å’Œé«˜å¹¶å‘é”ç«äº‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OLAPç³»ç»Ÿï¼ˆåˆ†ææŸ¥è¯¢ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åèŒƒå¼&lt;/td&gt;
&lt;td&gt;å¤æ‚æŸ¥è¯¢éœ€å¿«é€Ÿå“åº”ï¼Œå†—ä½™å­˜å‚¨å‡å°‘è¡¨è¿æ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å°å‹åº”ç”¨/åŸå‹å¼€å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1NF/2NF&lt;/td&gt;
&lt;td&gt;å¿«é€Ÿè¿­ä»£ä¼˜å…ˆï¼Œç»“æ„ç®€å•æ˜“è°ƒæ•´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†å²æ•°æ®å­˜å‚¨ï¼ˆå½’æ¡£ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1NF&lt;/td&gt;
&lt;td&gt;æ•°æ®åªè¯»ï¼Œå†—ä½™ä¸å½±å“ä¸€è‡´æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;è®¾è®¡æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æƒè¡¡æ€§èƒ½ä¸è§„èŒƒï¼š
&lt;ul&gt;
&lt;li&gt;é«˜èŒƒå¼å‡å°‘å†—ä½™ä½†å¢åŠ è¡¨è¿æ¥ï¼ˆå½±å“æŸ¥è¯¢é€Ÿåº¦ï¼‰ï¼Œéœ€æ ¹æ®è¯»å†™æ¯”ä¾‹æƒè¡¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸»é”®è®¾è®¡åŸåˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;é‡‡ç”¨&lt;strong&gt;ä»£ç†é”®ï¼ˆå¦‚è‡ªå¢IDï¼‰&lt;/strong&gt; é¿å…ä¸šåŠ¡ä¸»é”®å˜æ›´å¼•å‘çš„è¿é”æ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®è¯­ä¹‰ç»Ÿä¸€ï¼š
&lt;ul&gt;
&lt;li&gt;åŒä¸€å±æ€§åœ¨ä¸åŒè¡¨ä¸­éœ€ä¿æŒ&lt;strong&gt;ç›¸åŒæ•°æ®ç±»å‹å’Œå‘½å&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;user_id&lt;/code&gt;åœ¨ç”¨æˆ·è¡¨ã€è®¢å•è¡¨ç±»å‹ä¸€è‡´ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€è§„èŒƒ&lt;/strong&gt;ï¼š1NFæ˜¯åŸºçŸ³ï¼Œ2NF/3NFè§£å†³æ•°æ®ä¾èµ–ï¼ŒBCNFå¤„ç†å¤æ‚ä¸»é”®å…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»åº”ç”¨&lt;/strong&gt;ï¼š&lt;strong&gt;æ— é“¶å¼¹ï¼&lt;/strong&gt; æ ¹æ®ä¸šåŠ¡ç±»å‹ï¼ˆOLTP/OLAPï¼‰ã€æ•°æ®è§„æ¨¡åŠæ€§èƒ½éœ€æ±‚åŠ¨æ€é€‰æ‹©èŒƒå¼çº§åˆ«ã€‚&lt;/li&gt;
&lt;li&gt;æœ€ä½³å®è·µï¼š
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;è®¾è®¡å£è¯€&lt;/strong&gt;ï¼šä¸€åˆ—åŸå­ã€äºŒæ— éƒ¨åˆ†ã€ä¸‰æ— ä¼ é€’ã€BCä¸»é”®ç‹¬ç«‹ã€‚
ğŸ”§ â€‹&lt;strong&gt;ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;â€‹ï¼šé«˜é¢‘æŸ¥è¯¢å­—æ®µå¯å†—ä½™ï¼Œå…³é”®äº‹åŠ¡è¡¨ä¸¥æ ¼æ»¡è¶³3NF+ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="æ¸¸æ ‡"&gt;æ¸¸æ ‡
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å…³äºæ•°æ®åº“æ¸¸æ ‡çš„ç³»ç»Ÿæ€§ä»‹ç»ï¼Œæ¶µç›–å…¶æ ¸å¿ƒæ¦‚å¿µã€å·¥ä½œåŸç†ã€ç±»å‹ã€åº”ç”¨åœºæ™¯åŠä¼˜åŒ–ç­–ç•¥ï¼Œç»“åˆè¡Œä¸šå®è·µå’Œç†è®ºè§„èŒƒæ•´ç†è€Œæˆï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸æœ¬è´¨"&gt;ğŸ“Œ &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸æœ¬è´¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¸¸æ ‡ï¼ˆCursorï¼‰&lt;/strong&gt; æ˜¯ä¸€ç§æ•°æ®åº“å¯¹è±¡ï¼Œç”¨äº&lt;strong&gt;é€è¡Œå¤„ç†æŸ¥è¯¢ç»“æœé›†&lt;/strong&gt;ï¼Œæœ¬è´¨æ˜¯&lt;strong&gt;æŒ‡å‘ç»“æœé›†çš„æŒ‡é’ˆ&lt;/strong&gt;ï¼Œå…è®¸ç¨‹åºæŒ‰é¡ºåºè®¿é—®æ¯æ¡è®°å½•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»æ¯”ç†è§£&lt;/strong&gt;ï¼šç±»ä¼¼äºæ–‡ä»¶å¥æŸ„ï¼ˆå¦‚Cè¯­è¨€ä¸­çš„&lt;code&gt;FILE*&lt;/code&gt;ï¼‰ï¼Œæ¸¸æ ‡æ˜¯æ“ä½œç»“æœé›†çš„â€œå¥æŸ„â€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç»„æˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»“æœé›†&lt;/strong&gt;ï¼šå…³è”çš„&lt;code&gt;SELECT&lt;/code&gt;æŸ¥è¯¢è¿”å›çš„æ•°æ®é›†åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸¸æ ‡ä½ç½®&lt;/strong&gt;ï¼šæŒ‡å‘ç»“æœé›†ä¸­å½“å‰æ“ä½œè¡Œçš„æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡æ€æƒ³&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨é¢å‘é›†åˆçš„SQLä¸­å¼•å…¥&lt;strong&gt;é¢å‘è¡Œçš„å¤„ç†èƒ½åŠ›&lt;/strong&gt;ï¼Œæˆä¸ºé›†åˆæ“ä½œä¸é€è¡Œæ“ä½œçš„æ¡¥æ¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œåŸç†ä¸ç”Ÿå‘½å‘¨æœŸ"&gt;ğŸ”§ &lt;strong&gt;å·¥ä½œåŸç†ä¸ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ¸¸æ ‡æ“ä½œéœ€ä¸¥æ ¼éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š
1.
å£°æ˜æ¸¸æ ‡ï¼ˆDECLAREï¼‰&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; DECLARE cursor_name CURSOR FOR
SELECT column1, column2 FROM table WHERE condition; -- å®šä¹‰ç»“æœé›†
&lt;/code&gt;&lt;/pre&gt;&lt;ol start="2"&gt;
&lt;li&gt;æ‰“å¼€æ¸¸æ ‡ï¼ˆOPENï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; OPEN cursor_name; -- æ‰§è¡ŒæŸ¥è¯¢ï¼Œç”Ÿæˆç»“æœé›†å¹¶å®šä½åˆ°é¦–è¡Œå‰
&lt;/code&gt;&lt;/pre&gt;&lt;ol start="3"&gt;
&lt;li&gt;è·å–æ•°æ®ï¼ˆFETCHï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; FETCH NEXT FROM cursor_name INTO @var1, @var2; -- é€è¡Œè¯»å–æ•°æ®åˆ°å˜é‡
&lt;/code&gt;&lt;/pre&gt;&lt;ol start="4"&gt;
&lt;li&gt;å¤„ç†æ•°æ®&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹å˜é‡ä¸­çš„æ•°æ®è¿›è¡Œä¸šåŠ¡é€»è¾‘æ“ä½œï¼ˆå¦‚è®¡ç®—ã€æ›´æ–°ã€è°ƒç”¨å¤–éƒ¨APIï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="5"&gt;
&lt;li&gt;å…³é—­æ¸¸æ ‡ï¼ˆCLOSEï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; CLOSE cursor_name; -- é‡Šæ”¾ç»“æœé›†èµ„æº
&lt;/code&gt;&lt;/pre&gt;&lt;ol start="6"&gt;
&lt;li&gt;é‡Šæ”¾æ¸¸æ ‡ï¼ˆDEALLOCATEï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; DEALLOCATE cursor_name; -- æ¸…é™¤æ¸¸æ ‡å¯¹è±¡ï¼Œé‡Šæ”¾å†…å­˜
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®çŠ¶æ€&lt;/strong&gt;ï¼šæ¸¸æ ‡ä»…åœ¨è¢«æ‰“å¼€æ—¶æŒæœ‰ç»“æœé›†èµ„æºï¼Œå…³é—­åä»…ä¿ç•™å®šä¹‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ¸¸æ ‡ç±»å‹ä¸é€‚ç”¨åœºæ™¯"&gt;ğŸ“Š &lt;strong&gt;æ¸¸æ ‡ç±»å‹ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æŒ‰æ§åˆ¶æ–¹å¼åˆ†ç±»"&gt;&lt;strong&gt;æŒ‰æ§åˆ¶æ–¹å¼åˆ†ç±»&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ˜¾å¼æ¸¸æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·æ‰‹åŠ¨å£°æ˜ã€æ‰“å¼€ã€å…³é—­ï¼ˆå¦‚PL/SQLä¸­çš„&lt;code&gt;CURSOR&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€ç²¾ç»†æ§åˆ¶é€è¡Œé€»è¾‘çš„å¤æ‚æ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éšå¼æ¸¸æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”±æ•°æ®åº“è‡ªåŠ¨ç®¡ç†ï¼ˆå¦‚å•è¡Œ&lt;code&gt;SELECT...INTO&lt;/code&gt;ï¼‰ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ&lt;/td&gt;
&lt;td&gt;ç®€å•DMLæ“ä½œï¼ˆINSERT/UPDATEï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æŒ‰æ•°æ®æ•æ„Ÿæ€§åˆ†ç±»"&gt;&lt;strong&gt;æŒ‰æ•°æ®æ•æ„Ÿæ€§åˆ†ç±»&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®å˜åŒ–æ•æ„Ÿåº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å†…å­˜ä½¿ç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€æ¸¸æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ‰“å¼€æ—¶ç”Ÿæˆå¿«ç…§ï¼Œä¸åæ˜ åç»­æ•°æ®å˜åŒ–&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå­˜å‚¨å®Œæ•´ç»“æœé›†ï¼‰&lt;/td&gt;
&lt;td&gt;æ•°æ®ä¸€è‡´æ€§è¦æ±‚é«˜ï¼ˆå¦‚è´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ¨æ€æ¸¸æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å®æ—¶åæ˜ æºè¡¨æœ€æ–°æ•°æ®&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆä»…ç¼“å­˜æŒ‡é’ˆï¼‰&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘å®æ—¶æ•°æ®æ›´æ–°ï¼ˆå¦‚åº“å­˜ç®¡ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”®é›†æ¸¸æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ ä»…å­˜å‚¨ä¸»é”®ï¼Œè¯»å–æ—¶å®æ—¶è·å–è¡Œæ•°æ®&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;å¹³è¡¡æ€§èƒ½ä¸å®æ—¶æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåº”ç”¨åœºæ™¯"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;âš™ï¸ é€è¡Œå¤æ‚é€»è¾‘å¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚é“¶è¡Œåˆ©æ¯è®¡ç®—ï¼šéå†è´¦æˆ·ï¼Œæ ¹æ®ä½™é¢åŠ¨æ€è®¡ç®—é€æ”¯è´¹ç”¨ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;FETCH NEXT FROM account_cursor INTO @account_id;
WHILE @@FETCH_STATUS = 0
BEGIN
UPDATE accounts SET fee = balance * 0.1 WHERE id = @account_id; -- é€è¡Œæ›´æ–°
FETCH NEXT FROM account_cursor INTO @account_id;
END
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“¤ æ•°æ®è¿ç§»ä¸ETL&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è·¨æ•°æ®åº“åŒæ­¥æ—¶ç¡®ä¿äº‹åŠ¡åŸå­æ€§ï¼ˆå¦‚ä¸»åº“åˆ°åˆ†æåº“çš„é€è¡Œè½¬ç§»ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸŒ³ æ ‘å½¢ç»“æ„é€’å½’å¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç»„ç»‡æ¶æ„éå†ï¼šé€’å½’è®¡ç®—éƒ¨é—¨è–ªèµ„æ€»å’Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“Š å®šåˆ¶åŒ–æŠ¥è¡¨ç”Ÿæˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æŒ‰æ—¶é—´åºåˆ—è¾“å‡ºé”€å”®æ•°æ®ï¼ˆå¦‚é€æ—¥æ‰“å°é”€å”®é¢è¶‹åŠ¿ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;DECLARE sales_cursor SCROLL CURSOR FOR
SELECT date, amount FROM sales ORDER BY date;
FETCH ABSOLUTE 5 FROM sales_cursor; -- è·³è½¬åˆ°ç¬¬5è¡Œ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ”„ å­˜å‚¨è¿‡ç¨‹é›†æˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­å°è£…æ¸¸æ ‡ï¼Œå®ç°æ‰¹é‡è–ªèµ„è°ƒæ•´ç­‰ä¸šåŠ¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜ç¼ºç‚¹åˆ†æ"&gt;âš–ï¸ &lt;strong&gt;ä¼˜ç¼ºç‚¹åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒé€è¡Œå¤æ‚æ“ä½œï¼ˆå¦‚æ¡ä»¶åˆ†æ”¯ã€å¤–éƒ¨è°ƒç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ä»£ç å¤æ‚åº¦é«˜ï¼Œå¯ç»´æŠ¤æ€§å·®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºæ§åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å‡å°‘å¤§æ•°æ®é›†çš„å†…å­˜å ç”¨ï¼ˆåˆ†æ‰¹å¤„ç†ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ é¢‘ç¹I/Oæ“ä½œå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼ˆå°¤å…¶åŠ¨æ€æ¸¸æ ‡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç¡®ä¿é€è¡Œæ“ä½œçš„åŸå­æ€§&lt;/td&gt;
&lt;td&gt;âŒ é•¿æœŸå ç”¨é”èµ„æºï¼Œå¯èƒ½å¼•å‘æ­»é”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"&gt;ğŸš€ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é™åˆ¶ç»“æœé›†å¤§å°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ ç²¾ç¡®çš„&lt;code&gt;WHERE&lt;/code&gt;æ¡ä»¶ï¼Œå‡å°‘å¤„ç†è¡Œæ•°ï¼ˆå¦‚&lt;code&gt;WHERE date &amp;gt; '2025-01-01'&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆä½¿ç”¨é™æ€æ¸¸æ ‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…åŠ¨æ€æ¸¸æ ‡çš„å®æ—¶æŸ¥è¯¢å¼€é”€ï¼Œå°¤å…¶å¯¹ä¸€è‡´æ€§è¦æ±‚é«˜çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡æ“ä½œæ›¿ä»£é€è¡Œå¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½æ•ˆæ¸¸æ ‡ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- é€è¡Œæ›´æ–°5ä¸‡æ¡è®°å½•ï¼ˆçº¦120ç§’ï¼‰
UPDATE Employees SET Tax = Salary * 0.15 WHERE CURRENT OF cursor_emp;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;é«˜æ•ˆé›†åˆæ“ä½œï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- æ‰¹é‡æ›´æ–°ï¼ˆçº¦0.8ç§’ï¼‰
UPDATE Employees SET Tax = Salary * 0.15 WHERE DepartmentID = 5;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠæ—¶é‡Šæ”¾èµ„æº&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ“ä½œå®Œæˆåç«‹å³å…³é—­æ¸¸æ ‡ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ©ç”¨ç´¢å¼•åŠ é€ŸæŸ¥è¯¢&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿æ¸¸æ ‡çš„&lt;code&gt;SELECT&lt;/code&gt;è¯­å¥å‘½ä¸­ç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;æ¸¸æ ‡æ˜¯æ•°æ®åº“ä¸­çš„â€œç²¾å¯†æ‰‹æœ¯åˆ€â€ğŸ”ªï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šåœ¨&lt;strong&gt;é¢å‘é›†åˆçš„SQLä¸–ç•Œä¸­å®ç°é€è¡Œç²¾ç»†åŒ–æ“ä½œ&lt;/strong&gt;ï¼Œå°¤å…¶é€‚åˆå¤æ‚é€»è¾‘ã€æ ‘å½¢éå†å’Œè·¨åº“äº‹åŠ¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åŸåˆ™&lt;/strong&gt;ï¼š&lt;strong&gt;æ…ç”¨ã€å°‘ç”¨ã€ä¼˜åŒ–ç”¨&lt;/strong&gt;ã€‚å¤šæ•°åœºæ™¯ä¸‹é›†åˆæ“ä½œï¼ˆå¦‚æ‰¹é‡UPDATEï¼‰æ€§èƒ½æ›´ä¼˜ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­å°è£…æ¸¸æ ‡ï¼Œç¡®ä¿èµ„æºé‡Šæ”¾ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é™æ€æ¸¸æ ‡ä¼˜å…ˆï¼ŒåŠ¨æ€æ¸¸æ ‡ä»…ç”¨äºå®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¶…1ä¸‡è¡Œæ•°æ®æ—¶è¯„ä¼°æ›¿ä»£æ–¹æ¡ˆï¼ˆå¦‚ä¸´æ—¶è¡¨æˆ–çª—å£å‡½æ•°ï¼‰ã€‚
é€šè¿‡åˆç†æƒè¡¡æ¸¸æ ‡çš„çµæ´»æ€§ä¸æ€§èƒ½æŸè€—ï¼Œå¯é«˜æ•ˆè§£å†³æ•°æ®å¤„ç†ä¸­çš„â€œè¾¹ç¼˜éš¾é¢˜â€ï¼ŒåŒæ—¶ä¿éšœç³»ç»Ÿç¨³å®šè¿è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ•°æ®åˆ†é¡µ"&gt;æ•°æ®åˆ†é¡µ
&lt;/h2&gt;&lt;p&gt;åœ¨ InnoDB ä¸­ï¼Œä½¿ç”¨ &lt;code&gt;OFFSET&lt;/code&gt; çš„åˆ†é¡µæŸ¥è¯¢&lt;strong&gt;å¹¶éé€šè¿‡æ¸¸æ ‡å®ç°&lt;/strong&gt;ï¼Œè€Œæ˜¯é€šè¿‡é¡ºåºæ‰«æå¹¶ä¸¢å¼ƒå‰ç½®æ•°æ®çš„æ–¹å¼å®Œæˆã€‚çœŸæ­£çš„æ¸¸æ ‡åˆ†é¡µï¼ˆCursor-based Paginationï¼‰æ˜¯ä¸€ç§&lt;strong&gt;åº”ç”¨å±‚ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;ï¼Œé€šè¿‡è®°å½•ä¸Šä¸€é¡µçš„ç»“æŸä½ç½®ï¼ˆå¦‚ä¸»é”® IDï¼‰ç›´æ¥å®šä½ä¸‹ä¸€é¡µèµ·ç‚¹ï¼Œé¿å…æ‰«ææ— å…³æ•°æ®ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-offset"&gt;âš™ï¸ &lt;strong&gt;&lt;code&gt;OFFSET&lt;/code&gt; åˆ†é¡µçš„å®ç°æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…¨é‡æ‰«æä¸ä¸¢å¼ƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“æ‰§è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; SELECT * FROM table ORDER BY id LIMIT 1000000, 10;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ—¶ï¼ŒInnoDB ä¼šï¼š
- é€šè¿‡ä¸»é”®ç´¢å¼•ï¼ˆèšç°‡ç´¢å¼•ï¼‰æ‰«æå‰ &lt;code&gt;1,000,010&lt;/code&gt; è¡Œæ•°æ®ï¼›
- å°†å‰ &lt;code&gt;1,000,000&lt;/code&gt; è¡Œä¸¢å¼ƒï¼Œä»…è¿”å›æœ€å &lt;code&gt;10&lt;/code&gt; è¡Œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;ï¼šæ‰«æå¤§é‡æ— ç”¨æ•°æ®å¯¼è‡´é«˜ I/O å¼€é”€å’Œå»¶è¿Ÿï¼Œå°¤å…¶å½“ &lt;code&gt;OFFSET&lt;/code&gt; å€¼æå¤§æ—¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•æ— æ³•å®Œå…¨ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å³ä½¿ä½¿ç”¨ &lt;code&gt;ORDER BY&lt;/code&gt; ç´¢å¼•å­—æ®µï¼ŒInnoDB ä»éœ€éå†ç´¢å¼•æ ‘çš„å‰ &lt;code&gt;OFFSET + LIMIT&lt;/code&gt; ä¸ªå¶å­èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æŸ¥è¯¢å­—æ®µæœªè¦†ç›–ç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;SELECT *&lt;/code&gt;ï¼‰ï¼Œè¿˜éœ€å›è¡¨æŸ¥è¯¢å®Œæ•´æ•°æ®ï¼Œè¿›ä¸€æ­¥å¢åŠ å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¸¸æ ‡åˆ†é¡µcursor-based-paginationçš„ä¼˜åŒ–åŸç†"&gt;ğŸš€ &lt;strong&gt;æ¸¸æ ‡åˆ†é¡µï¼ˆCursor-based Paginationï¼‰çš„ä¼˜åŒ–åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ¸¸æ ‡åˆ†é¡µæ˜¯&lt;strong&gt;æ›¿ä»£ &lt;code&gt;OFFSET&lt;/code&gt; çš„ä¸»åŠ¨ä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;ï¼Œå…¶æ ¸å¿ƒæ˜¯&lt;strong&gt;åˆ©ç”¨æœ‰åºå­—æ®µè·³è¿‡å‰ç½®æ‰«æ&lt;/strong&gt;ï¼š
1.
å®ç°æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€é¡µï¼š&lt;code&gt;SELECT * FROM table ORDER BY id LIMIT 10;&lt;/code&gt;
è®°å½•æœ€åä¸€è¡Œ IDï¼ˆå¦‚ &lt;code&gt;100&lt;/code&gt;ï¼‰ä½œä¸ºæ¸¸æ ‡ã€‚&lt;/li&gt;
&lt;li&gt;ä¸‹ä¸€é¡µï¼š&lt;code&gt;SELECT * FROM table WHERE id &amp;gt; 100 ORDER BY id LIMIT 10;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é›¶æ‰«æä¸¢å¼ƒ&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;WHERE id &amp;gt; last_id&lt;/code&gt; ç›´æ¥å®šä½èµ·å§‹ç‚¹ï¼Œä»…æ‰«ææ‰€éœ€ &lt;code&gt;LIMIT&lt;/code&gt; æ¡æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¨³å®šæ€§&lt;/strong&gt;ï¼šåŸºäºå”¯ä¸€æœ‰åºå­—æ®µï¼ˆå¦‚è‡ªå¢ä¸»é”®ï¼‰ï¼Œé¿å…å› æ•°æ®å˜åŠ¨å¯¼è‡´åˆ†é¡µé”™ä¹±ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-offset-1"&gt;âš ï¸ &lt;strong&gt;&lt;code&gt;OFFSET&lt;/code&gt; ä¸æ¸¸æ ‡åˆ†é¡µçš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;OFFSET&lt;/code&gt; åˆ†é¡µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¸¸æ ‡åˆ†é¡µ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰«æ &lt;code&gt;OFFSET+LIMIT&lt;/code&gt; è¡Œåä¸¢å¼ƒ&lt;/td&gt;
&lt;td&gt;ç›´æ¥å®šä½æ¸¸æ ‡ä½ç½®ï¼Œæ‰«æ &lt;code&gt;LIMIT&lt;/code&gt; è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éš &lt;code&gt;OFFSET&lt;/code&gt; å¢å¤§çº¿æ€§ä¸‹é™&lt;/td&gt;
&lt;td&gt;æ’å®šé«˜æ•ˆï¼ˆä¸é¡µæ•°æ— å…³ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜“å—æ–°å¢/åˆ é™¤æ•°æ®å½±å“&lt;/td&gt;
&lt;td&gt;ç¨³å®šï¼ˆåŸºäºå”¯ä¸€æœ‰åºå­—æ®µï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éšæœºè·³é¡µï¼ˆå¦‚ç¬¬ 1000 é¡µï¼‰&lt;/td&gt;
&lt;td&gt;é¡ºåºç¿»é¡µï¼ˆå¦‚â€œä¸‹ä¸€é¡µâ€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–"&gt;ğŸ› ï¸ &lt;strong&gt;ä¼˜åŒ– &lt;code&gt;OFFSET&lt;/code&gt; æ·±åˆ†é¡µçš„å…¶ä»–æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è‹¥ä¸šåŠ¡å¿…é¡»æ”¯æŒéšæœºè·³é¡µï¼Œå¯è€ƒè™‘ä»¥ä¸‹ä¼˜åŒ–ï¼š
1.
å­æŸ¥è¯¢ + ç´¢å¼•è¦†ç›–&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SELECT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FROM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;WHERE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SELECT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FROM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LIMIT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1000000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LIMIT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;å­æŸ¥è¯¢ä»…æ‰«æä¸»é”®ï¼ˆç´¢å¼•è¦†ç›–ï¼‰ï¼Œé¿å…å›è¡¨ï¼Œå‡å°‘ I/Oã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;ä¸šåŠ¡å±‚é™åˆ¶&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é™åˆ¶ç”¨æˆ·è®¿é—®æ·±åº¦ï¼ˆå¦‚ä»…å…è®¸æŸ¥å‰ 1000 é¡µï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;å†·çƒ­æ•°æ®åˆ†ç¦»&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å°†å†å²æ•°æ®å½’æ¡£è‡³ç‹¬ç«‹è¡¨ï¼Œå‡å°‘ä¸»è¡¨æ•°æ®é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;ç¼“å­˜ä¸å¼‚æ­¥åŠ è½½&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹é«˜é¢‘è®¿é—®çš„æ·±åˆ†é¡µç»“æœè¿›è¡Œç¼“å­˜ï¼ˆå¦‚ Redisï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;OFFSET&lt;/code&gt; éæ¸¸æ ‡å®ç°&lt;/strong&gt;ï¼šInnoDB åŸç”Ÿ &lt;code&gt;OFFSET&lt;/code&gt; é€šè¿‡é¡ºåºæ‰«æä¸ä¸¢å¼ƒå®ç°åˆ†é¡µï¼Œæ€§èƒ½éšæ·±åº¦å¢åŠ è€Œéª¤é™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸¸æ ‡æ˜¯ä¼˜åŒ–æ‰‹æ®µ&lt;/strong&gt;ï¼šæ¸¸æ ‡åˆ†é¡µéœ€å¼€å‘è€…ä¸»åŠ¨è®¾è®¡ï¼Œåˆ©ç”¨ &lt;code&gt;WHERE id &amp;gt; last_id&lt;/code&gt; è·³è¿‡å‰ç½®æ‰«æï¼Œé€‚ç”¨äºé¡ºåºç¿»é¡µåœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·³é¡µä¼˜åŒ–éœ€æƒè¡¡&lt;/strong&gt;ï¼šå­æŸ¥è¯¢æˆ–å†·çƒ­åˆ†ç¦»å¯ç¼“è§£éšæœºè·³é¡µé—®é¢˜ï¼Œä½†æ— æ³•æ ¹æ²»æ€§èƒ½ç“¶é¢ˆï¼Œéœ€ç»“åˆä¸šåŠ¡éœ€æ±‚é€‰æ‹©æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–°ç³»ç»Ÿä¼˜å…ˆé‡‡ç”¨æ¸¸æ ‡åˆ†é¡µï¼ˆå¦‚è¿”å› &lt;code&gt;next_cursor&lt;/code&gt; å­—æ®µï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å­˜é‡ç³»ç»Ÿæ·±åˆ†é¡µä¼˜åŒ–å¯æ”¹ç”¨å­æŸ¥è¯¢æˆ–å½’æ¡£å†å²æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ¸¸æ ‡--åˆ†é¡µ"&gt;æ¸¸æ ‡ &amp;amp; åˆ†é¡µ
&lt;/h2&gt;&lt;p&gt;æ˜¯çš„ï¼Œä½ çš„ç†è§£å®Œå…¨æ­£ç¡®ã€‚&lt;strong&gt;æ¸¸æ ‡åˆ†é¡µä¸­çš„â€œæ¸¸æ ‡â€ä¸æ•°æ®åº“å†…éƒ¨çš„â€œæ¸¸æ ‡â€æ˜¯æˆªç„¶ä¸åŒçš„æ¦‚å¿µ&lt;/strong&gt;ï¼Œå°½ç®¡åç§°ç›¸åŒï¼Œä½†è®¾è®¡ç›®æ ‡ã€å®ç°æœºåˆ¶å’Œåº”ç”¨åœºæ™¯å‡æœ‰æœ¬è´¨å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®åº“æ¸¸æ ‡database-cursor"&gt;ğŸ“Œ &lt;strong&gt;æ•°æ®åº“æ¸¸æ ‡ï¼ˆDatabase Cursorï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼š
æ•°æ®åº“æ¸¸æ ‡æ˜¯æ•°æ®åº“ç³»ç»Ÿå†…éƒ¨æä¾›çš„ä¸€ç§&lt;strong&gt;é€è¡Œéå†æŸ¥è¯¢ç»“æœé›†&lt;/strong&gt;çš„æœºåˆ¶ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°æ®åº“å¯¹è±¡ï¼Œç”¨äºåœ¨å­˜å‚¨è¿‡ç¨‹æˆ–å¤æ‚æŸ¥è¯¢ä¸­æŒ‰é¡ºåºå¤„ç†æ¯ä¸€è¡Œæ•°æ®ã€‚
&lt;strong&gt;æ ¸å¿ƒç‰¹ç‚¹&lt;/strong&gt;ï¼š
1.
é€è¡Œæ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;DECLARE CURSOR&lt;/code&gt; å£°æ˜ã€&lt;code&gt;OPEN&lt;/code&gt; æ‰“å¼€ã€&lt;code&gt;FETCH&lt;/code&gt; é€è¡Œè¯»å–ã€&lt;code&gt;CLOSE&lt;/code&gt; å…³é—­çš„æ­¥éª¤å¤„ç†æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;é€‚ç”¨äºéœ€è¦é€è¡Œæ ¡éªŒã€æ›´æ–°æˆ–åˆ é™¤çš„åœºæ™¯ï¼ˆå¦‚æ•°æ®æ¸…æ´—ã€æ‰¹é‡è®¡ç®—ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;èµ„æºæ¶ˆè€—å¤§ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€åœ¨æ•°æ®åº“æœåŠ¡å™¨å†…å­˜ä¸­ç»´æŠ¤ç»“æœé›†å¿«ç…§ï¼Œé•¿æ—¶é—´å ç”¨èµ„æºï¼Œå¯èƒ½å¼•å‘æ€§èƒ½é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç±»å‹å¤šæ ·ï¼š
&lt;ul&gt;
&lt;li&gt;åŒ…æ‹¬é™æ€æ¸¸æ ‡ï¼ˆå¿«ç…§éš”ç¦»ï¼‰ã€åŠ¨æ€æ¸¸æ ‡ï¼ˆå®æ—¶æ•°æ®ï¼‰ã€é”®é›†æ¸¸æ ‡ç­‰ï¼Œé€‚ç”¨äºä¸åŒä¸€è‡´æ€§éœ€æ±‚ã€‚
&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- ç¤ºä¾‹ï¼šä½¿ç”¨æ•°æ®åº“æ¸¸æ ‡é€è¡Œæ›´æ–°æ•°æ®
DECLARE update_cursor CURSOR FOR
SELECT id, balance FROM accounts WHERE status = &amp;#39;active&amp;#39;;
OPEN update_cursor;
FETCH NEXT FROM update_cursor INTO @id, @balance;
WHILE @@FETCH_STATUS = 0
BEGIN
UPDATE accounts SET balance = @balance * 1.05 WHERE CURRENT OF update_cursor;
FETCH NEXT FROM update_cursor INTO @id, @balance;
END;
CLOSE update_cursor;
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-åˆ†é¡µæ¸¸æ ‡cursor-based-pagination"&gt;ğŸ”„ &lt;strong&gt;åˆ†é¡µæ¸¸æ ‡ï¼ˆCursor-based Paginationï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼š
åˆ†é¡µæ¸¸æ ‡æ˜¯&lt;strong&gt;åº”ç”¨å±‚è®¾è®¡çš„åˆ†é¡µä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;ï¼Œé€šè¿‡ä¼ é€’æœ‰åºå­—æ®µçš„å€¼ï¼ˆå¦‚è‡ªå¢IDã€æ—¶é—´æˆ³ï¼‰ä½œä¸ºâ€œé”šç‚¹â€ï¼Œç›´æ¥å®šä½ä¸‹ä¸€é¡µèµ·å§‹ä½ç½®ï¼Œé¿å…æ‰«ææ— å…³æ•°æ®ã€‚
&lt;strong&gt;æ ¸å¿ƒç‰¹ç‚¹&lt;/strong&gt;ï¼š
1.
åŸºäºç´¢å¼•é«˜æ•ˆå®šä½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥è¯¢è¯­å¥å½¢å¦‚ &lt;code&gt;SELECT * FROM table WHERE id &amp;gt; {last_id} ORDER BY id LIMIT 10&lt;/code&gt;ï¼Œåˆ©ç”¨ç´¢å¼•ç›´æ¥è·³è¿‡å·²è¯»æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;æ— çŠ¶æ€ä¸”è½»é‡ï¼š
&lt;ul&gt;
&lt;li&gt;æ— éœ€åœ¨æ•°æ®åº“ç»´æŠ¤ç»“æœé›†ï¼Œä»…ä¾èµ–å®¢æˆ·ç«¯ä¼ é€’çš„æ¸¸æ ‡å€¼ï¼ˆå¦‚ &lt;code&gt;last_id=100&lt;/code&gt;ï¼‰ï¼Œèµ„æºå¼€é”€æä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è§£å†³æ·±åº¦åˆ†é¡µé—®é¢˜ï¼š
&lt;ul&gt;
&lt;li&gt;æ€§èƒ½ä¸å—é¡µç å½±å“ï¼ˆæ—¶é—´å¤æ‚åº¦ &lt;code&gt;O(log n)&lt;/code&gt;ï¼‰ï¼Œè€Œä¼ ç»Ÿ &lt;code&gt;OFFSET&lt;/code&gt; åˆ†é¡µæ€§èƒ½éšé¡µç å¢åŠ çº¿æ€§ä¸‹é™ï¼ˆ&lt;code&gt;O(n)&lt;/code&gt;ï¼‰ã€‚
&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- ç¤ºä¾‹ï¼šç¤¾äº¤åŠ¨æ€åˆ†é¡µï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰
-- ç¬¬ä¸€é¡µ
SELECT id, content, created_at
FROM posts
ORDER BY created_at DESC, id DESC
LIMIT 10;
-- ä¸‹ä¸€é¡µï¼ˆæ¸¸æ ‡ä¸ºä¸Šä¸€é¡µæœ€åä¸€æ¡çš„ created_at å’Œ idï¼‰
SELECT id, content, created_at
FROM posts
WHERE created_at &amp;lt; &amp;#39;2025-06-20 12:00:00&amp;#39;
OR (created_at = &amp;#39;2025-06-20 12:00:00&amp;#39; AND id &amp;lt; 100)
ORDER BY created_at DESC, id DESC
LIMIT 10;
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å…³é”®å·®å¼‚å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;å…³é”®å·®å¼‚å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®åº“æ¸¸æ ‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åˆ†é¡µæ¸¸æ ‡&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“å†…éƒ¨æœºåˆ¶ï¼ˆé€è¡Œå¤„ç†å·¥å…·ï¼‰&lt;/td&gt;
&lt;td&gt;åº”ç”¨å±‚åˆ†é¡µç­–ç•¥ï¼ˆæŸ¥è¯¢ä¼˜åŒ–è®¾è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºå ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆéœ€ç»´æŠ¤ç»“æœé›†å¿«ç…§ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆä»…ä¼ é€’é”šç‚¹å€¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½æˆä¸ºç“¶é¢ˆï¼ˆé€è¡Œæ“ä½œæ…¢ï¼‰&lt;/td&gt;
&lt;td&gt;æå‡æ€§èƒ½ï¼ˆé¿å…å…¨è¡¨æ‰«æï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®æ¸…æ´—ã€é€è¡Œè®¡ç®—&lt;/td&gt;
&lt;td&gt;æ— é™æ»šåŠ¨ã€åŠ¨æ€æµåŠ è½½ï¼ˆå¦‚å¾®åš/æœ‹å‹åœˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;SQL æ˜¾å¼å£°æ˜ï¼ˆ&lt;code&gt;DECLARE CURSOR&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢æ¡ä»¶ï¼ˆ&lt;code&gt;WHERE id &amp;gt; {cursor}&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–æ¸¸æ ‡ç±»å‹ï¼ˆé™æ€/åŠ¨æ€ï¼‰&lt;/td&gt;
&lt;td&gt;ç¨³å®šï¼ˆåŸºäºæœ‰åºå­—æ®µï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†é¡µæ¸¸æ ‡&lt;/strong&gt;æ˜¯é¢å‘æŸ¥è¯¢ä¼˜åŒ–çš„&lt;strong&gt;åº”ç”¨å±‚è®¾è®¡ç­–ç•¥&lt;/strong&gt;ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯è§£å†³ &lt;code&gt;OFFSET&lt;/code&gt; åˆ†é¡µçš„æ€§èƒ½ç“¶é¢ˆï¼Œé€šè¿‡æœ‰åºå­—æ®µé”šç‚¹å®ç°é«˜æ•ˆå®šä½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“æ¸¸æ ‡&lt;/strong&gt;æ˜¯æ•°æ®åº“ç³»ç»Ÿæä¾›çš„&lt;strong&gt;åº•å±‚é€è¡Œæ“ä½œå·¥å…·&lt;/strong&gt;ï¼Œé€‚ç”¨äºéœ€è¦ç²¾ç»†æ§åˆ¶æ•°æ®è¡Œçš„åœºæ™¯ï¼Œä½†éœ€è­¦æƒ•æ€§èƒ½é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸¤è€…åŒåä½†æœ¬è´¨ä¸åŒï¼Œç†è§£è¿™ä¸€åŒºåˆ«èƒ½å¸®åŠ©ä½ åœ¨æ¶æ„è®¾è®¡ä¸­æ›´ç²¾å‡†åœ°é€‰æ‹©æŠ€æœ¯æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦é«˜æ•ˆåˆ†é¡µ â†’ é‡‡ç”¨ &lt;strong&gt;åˆ†é¡µæ¸¸æ ‡&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;WHERE id &amp;gt; last_id&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;éœ€é€è¡Œå¤„ç†ä¸šåŠ¡é€»è¾‘ â†’ è°¨æ…ä½¿ç”¨ &lt;strong&gt;æ•°æ®åº“æ¸¸æ ‡&lt;/strong&gt;ï¼Œä¼˜å…ˆè€ƒè™‘æ‰¹é‡æ“ä½œæ›¿ä»£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ·±åº¦åˆ†é¡µ"&gt;æ·±åº¦åˆ†é¡µ
&lt;/h2&gt;&lt;p&gt;æ·±åº¦åˆ†é¡µï¼ˆDeep Paginationï¼‰æ˜¯æŒ‡åœ¨æ•°æ®åº“æˆ–æœç´¢å¼•æ“ä¸­æŸ¥è¯¢ç»“æœé›†æ—¶ï¼Œéœ€è¦è·å–&lt;strong&gt;é¡µç æå¤§ï¼ˆå¦‚ç¬¬ 1000 é¡µï¼‰æˆ–åç§»é‡ï¼ˆOffsetï¼‰æé«˜&lt;/strong&gt;çš„æ•°æ®é¡µã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œä¼ ç»Ÿåˆ†é¡µæ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;LIMIT/OFFSET&lt;/code&gt;ï¼‰ä¼šå› è·³è¿‡å¤§é‡æ•°æ®å¯¼è‡´æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼Œç”šè‡³å¼•å‘ç³»ç»Ÿèµ„æºè€—å°½ç­‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å®šä¹‰ä¸å…¸å‹åœºæ™¯"&gt;ğŸ” &lt;strong&gt;å®šä¹‰ä¸å…¸å‹åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç‰¹å¾&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡µç æ·±&lt;/strong&gt;ï¼šç”¨æˆ·è¯·æ±‚çš„æ•°æ®ä½äºç»“æœé›†çš„å°¾éƒ¨ï¼ˆå¦‚ç¬¬ 10 ä¸‡é¡µï¼Œæ¯é¡µ 10 æ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜åç§»é‡&lt;/strong&gt;ï¼šæŸ¥è¯¢éœ€è·³è¿‡å¤§é‡è®°å½•ï¼ˆå¦‚ &lt;code&gt;LIMIT 10 OFFSET 1000000&lt;/code&gt; éœ€è·³è¿‡ 100 ä¸‡æ¡æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®è§„æ¨¡å¤§&lt;/strong&gt;ï¼šå¸¸è§äºç™¾ä¸‡çº§ä»¥ä¸Šçš„æ•°æ®é›†ï¼ˆå¦‚ç”µå•†å•†å“åˆ—è¡¨ã€ç¤¾äº¤åª’ä½“å†å²å¸–æ–‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡åœºæ™¯ä¸¾ä¾‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·è·³è½¬åˆ°æœç´¢ç»“æœçš„åå‡ ä¸‡é¡µï¼ˆå¦‚ç™¾åº¦æœ€å¤šä»…å±•ç¤º 10 é¡µï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åå°ç³»ç»Ÿå¯¼å‡ºå…¨é‡å†å²è®¢å•ï¼ˆéœ€éå†æ‰€æœ‰åˆ†é¡µï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½é—®é¢˜æ ¹æº"&gt;âš ï¸ &lt;strong&gt;æ€§èƒ½é—®é¢˜æ ¹æº&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¼ ç»Ÿåˆ†é¡µçš„ç“¶é¢ˆ"&gt;&lt;strong&gt;ä¼ ç»Ÿåˆ†é¡µçš„ç“¶é¢ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¨é‡æ‰«æä¸ä¸¢å¼ƒ&lt;/strong&gt;ï¼š
æ•°æ®åº“éœ€å…ˆè¯»å– &lt;code&gt;OFFSET + LIMIT&lt;/code&gt; æ¡æ•°æ®ï¼ˆå¦‚è·³è¿‡ 100 ä¸‡æ¡ï¼‰ï¼Œå†è¿”å›å°‘é‡ç›®æ ‡æ•°æ®ã€‚å¤§é‡æ— æ•ˆ I/O å’Œå†…å­˜å ç”¨å¯¼è‡´æ€§èƒ½éª¤é™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’åºæˆæœ¬é«˜&lt;/strong&gt;ï¼š
è‹¥éœ€ &lt;code&gt;ORDER BY&lt;/code&gt;ï¼Œæ•°æ®åº“éœ€å¯¹æ‰€æœ‰è·³è¿‡æ•°æ®æ’åºï¼Œå³ä½¿å®ƒä»¬ä¸åœ¨ç»“æœä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•å¤±æ•ˆ&lt;/strong&gt;ï¼š
å¤§åç§»é‡æ—¶ä¼˜åŒ–å™¨å¯èƒ½æ”¾å¼ƒç´¢å¼•ï¼Œé€‰æ‹©å…¨è¡¨æ‰«æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åœ¨æœç´¢å¼•æ“ä¸­çš„è¡¨ç°"&gt;&lt;strong&gt;åœ¨æœç´¢å¼•æ“ä¸­çš„è¡¨ç°&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç‰‡æ•°æ®åˆå¹¶&lt;/strong&gt;ï¼š
Elasticsearch éœ€ä»æ¯ä¸ªåˆ†ç‰‡è·å– &lt;code&gt;(Offset + Limit)&lt;/code&gt; æ¡æ•°æ®ï¼Œåè°ƒèŠ‚ç‚¹åˆå¹¶æ’åºåä¸¢å¼ƒå¤šä½™æ•°æ®ã€‚ä¾‹å¦‚æŸ¥è¯¢ç¬¬ 1000 é¡µï¼ˆæ¯é¡µ 10 æ¡ï¼‰éœ€ä» â€‹&lt;strong&gt;8 ä¸ªåˆ†ç‰‡å„å– 1 ä¸‡æ¡æ•°æ®&lt;/strong&gt;ï¼Œåˆå¹¶åä¸¢å¼ƒ 79,920 æ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ä¸è®¡ç®—å‹åŠ›&lt;/strong&gt;ï¼š
æ·±åº¦åˆ†é¡µæ˜“å¼•å‘ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ï¼Œæ•… ES é»˜è®¤é™åˆ¶ &lt;code&gt;offset + size â‰¤ 10,000&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–ç­–ç•¥ä¸é€‚ç”¨åœºæ™¯"&gt;âš™ï¸ &lt;strong&gt;ä¼˜åŒ–ç­–ç•¥ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ•°æ®åº“ä¼˜åŒ–æ–¹æ¡ˆ"&gt;&lt;strong&gt;æ•°æ®åº“ä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¸¸æ ‡åˆ†é¡µï¼ˆCursorï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäºä¸Šä¸€é¡µæœ«å°¾è®°å½•çš„ ID æŸ¥è¯¢ä¸‹ä¸€é¡µï¼Œé¿å… &lt;code&gt;OFFSET&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿ç»­ç¿»é¡µï¼ˆå¦‚æ— é™æ»šåŠ¨ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SELECT * FROM orders WHERE id &amp;gt; 1000 ORDER BY id LIMIT 10;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å»¶è¿Ÿå…³è”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­æŸ¥è¯¢å…ˆå®šä½ç›®æ ‡é¡µçš„ä¸»é”®ï¼Œå†å…³è”ä¸»è¡¨å‡å°‘å›è¡¨&lt;/td&gt;
&lt;td&gt;éœ€æ’åºçš„æ·±åº¦åˆ†é¡µ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SELECT t1.* FROM orders t1 JOIN (SELECT id FROM orders ORDER BY time LIMIT 1000000, 10) t2 ON t1.id = t2.id;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¦†ç›–ç´¢å¼•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç´¢å¼•åŒ…å«æŸ¥è¯¢æ‰€éœ€å­—æ®µï¼Œé¿å…å›è¡¨&lt;/td&gt;
&lt;td&gt;ä»…æŸ¥è¯¢ç´¢å¼•å­—æ®µ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SELECT id, name FROM users ORDER BY id LIMIT 1000000, 10;&lt;/code&gt;ï¼ˆéœ€è”åˆç´¢å¼• &lt;code&gt;(id, name)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸šåŠ¡å±‚é™åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¦æ­¢éšæœºè·³é¡µï¼Œä»…å…è®¸å‰åç¿»é¡µæˆ–æœç´¢è¿‡æ»¤&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ç³»ç»Ÿï¼ˆå¦‚ç™¾åº¦/è°·æ­Œï¼‰&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç”¨æˆ·åªèƒ½æŸ¥çœ‹å‰ 100 é¡µ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="elasticsearch-ä¼˜åŒ–æ–¹æ¡ˆ"&gt;&lt;strong&gt;Elasticsearch ä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Search After&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäºä¸Šä¸€é¡µæœ€åä¸€æ¡çš„æ’åºå€¼å®šä½ä¸‹ä¸€é¡µ&lt;/td&gt;
&lt;td&gt;æ·±åº¦éå†æˆ–æ»šåŠ¨åŠ è½½&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢è¿”å›åŒ…å« &lt;code&gt;sort&lt;/code&gt; å€¼ï¼Œä¸‹ä¸€é¡µè¯·æ±‚æºå¸¦ &lt;code&gt;&amp;quot;search_after&amp;quot;: [ä¸Šæ¬¡æœ«å°¾çš„æ’åºå€¼]&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é¿å… From/Size&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é™åˆ¶ &lt;code&gt;from + size â‰¤ 10,000&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æµ…åˆ†é¡µæˆ–å°å‹æ•°æ®é›†&lt;/td&gt;
&lt;td&gt;å¼ºåˆ¶ä¸šåŠ¡è®¾è®¡è§„é¿æ·±åº¦è·³é¡µ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“å»ºè®®"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒåŸåˆ™&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…éšæœºè·³é¡µ&lt;/strong&gt;ï¼šä¸šåŠ¡è®¾è®¡åº”å¼•å¯¼ç”¨æˆ·é€šè¿‡æœç´¢ã€ç­›é€‰ä»£æ›¿æ·±åº¦è·³é¡µï¼ˆå¦‚åªå…è®¸æŸ¥çœ‹å‰ 100 é¡µï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆæ¸¸æ ‡åˆ†é¡µ&lt;/strong&gt;ï¼šè¿ç»­ç¿»é¡µåœºæ™¯ç”¨ &lt;code&gt;WHERE id &amp;gt; ?&lt;/code&gt; æ›¿ä»£ &lt;code&gt;OFFSET&lt;/code&gt;ï¼Œæ€§èƒ½æå‡æ˜¾è‘—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ä¼˜åŒ–&lt;/strong&gt;ï¼šè¦†ç›–ç´¢å¼•æˆ–å»¶è¿Ÿå…³è”å‡å°‘å›è¡¨ï¼Œå°¤å…¶é€‚åˆæ’åºå­—æ®µä¸è¿‡æ»¤å­—æ®µåˆ†ç¦»çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰å‹å‚è€ƒ&lt;/strong&gt;ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èæ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ•°æ®åº“è¿ç»­ç¿»é¡µ&lt;/td&gt;
&lt;td&gt;æ¸¸æ ‡åˆ†é¡µï¼ˆCursorï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ•°æ®åº“æ·±åº¦è·³é¡µ&lt;/td&gt;
&lt;td&gt;å»¶è¿Ÿå…³è” + è¦†ç›–ç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ES æ·±åº¦éå†&lt;/td&gt;
&lt;td&gt;Search After&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é«˜å¹¶å‘ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡å±‚é™åˆ¶åˆ†é¡µæ·±åº¦&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”&lt;/strong&gt;ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;100 ä¸‡æ•°æ®åç§»æŸ¥è¯¢ï¼ˆ10 æ¡ï¼‰&lt;/th&gt;
&lt;th&gt;èµ„æºæ¶ˆè€—&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LIMIT 1000000, 10&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;1~5 ç§’&lt;/td&gt;
&lt;td&gt;é«˜ I/O + é«˜å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¸¸æ ‡åˆ†é¡µï¼ˆ&lt;code&gt;id &amp;gt; ?&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;0.01 ç§’&lt;/td&gt;
&lt;td&gt;ä½ I/O + ä½å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ES Search After&lt;/td&gt;
&lt;td&gt;0.1 ç§’&lt;/td&gt;
&lt;td&gt;å¯æ§å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šè‹¥æ•°æ®é‡è¶…äº¿çº§æˆ–éœ€å¼ºä¸€è‡´æ€§äº‹åŠ¡ï¼Œå¯ç»“åˆåˆ†åº“åˆ†è¡¨ï¼ˆå¦‚ ShardingSphereï¼‰æˆ–åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆå¦‚ TiDBï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="textblob"&gt;TEXT/BLOB
&lt;/h2&gt;&lt;p&gt;åœ¨ MySQL å’Œ Oracle æ•°æ®åº“ä¸­å­˜å‚¨ &lt;code&gt;TEXT&lt;/code&gt;/&lt;code&gt;BLOB&lt;/code&gt; ç±»å‹æ•°æ®æ—¶ï¼Œè¡¨ç©ºé—´ä¼šå› å­˜å‚¨æœºåˆ¶ã€ç¢ç‰‡åŒ–åŠç®¡ç†ç­–ç•¥å‘ç”Ÿæ˜¾è‘—å˜åŒ–ã€‚ä»¥ä¸‹æ˜¯å…³é”®å½±å“åŠä¼˜åŒ–å»ºè®®ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨æœºåˆ¶ä¸ç©ºé—´åˆ†é…å˜åŒ–"&gt;âš™ï¸ &lt;strong&gt;å­˜å‚¨æœºåˆ¶ä¸ç©ºé—´åˆ†é…å˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†é¡µå­˜å‚¨ï¼ˆOff-Page Storageï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;MySQL InnoDBï¼š
&lt;ul&gt;
&lt;li&gt;å½“è¡Œæ ¼å¼ä¸º &lt;code&gt;DYNAMIC&lt;/code&gt; æˆ– &lt;code&gt;COMPRESSED&lt;/code&gt; æ—¶ï¼Œ&lt;code&gt;TEXT&lt;/code&gt;/&lt;code&gt;BLOB&lt;/code&gt; æ•°æ®ï¼ˆè¶…è¿‡ 768 å­—èŠ‚ï¼‰ä¼šå®Œå…¨å­˜å‚¨åœ¨ç‹¬ç«‹çš„é¡µä¸­ï¼Œä¸»ç´¢å¼•é¡µä»…ä¿ç•™ 20 å­—èŠ‚çš„æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚ï¼Œå­˜å‚¨ 64KB çš„ &lt;code&gt;BLOB&lt;/code&gt; æ•°æ®ä¼šå ç”¨è‡³å°‘ 4 ä¸ª 16KB çš„é¡µï¼ˆå®é™…å¯èƒ½æ›´å¤šï¼Œå› é¡µå¡«å……ç‡ä¸è¶³ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Oracleï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;BLOB&lt;/code&gt; æ•°æ®è¶…è¿‡çº¦ 4KB æ—¶ï¼Œä¼šå­˜å‚¨åœ¨ç‹¬ç«‹çš„ &lt;code&gt;LOB&lt;/code&gt; æ®µä¸­ï¼Œè¡¨å†…ä»…ä¿ç•™ 36â€“84 å­—èŠ‚çš„å®šä½å™¨ï¼ˆLocatorï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å¯ç”¨ &lt;code&gt;ENABLE STORAGE IN ROW&lt;/code&gt;ï¼Œå°æ•°æ®ï¼ˆ&amp;lt;4KBï¼‰å¯å†…è”å­˜å‚¨ï¼Œå‡å°‘é¢å¤–æ®µå¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´è†¨èƒ€ä¸ç¢ç‰‡åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‹¬å é¡µæµªè´¹&lt;/strong&gt;ï¼šæ¯ä¸ª &lt;code&gt;TEXT&lt;/code&gt;/&lt;code&gt;BLOB&lt;/code&gt; åˆ—å¯èƒ½ç‹¬å ä¸€ä¸ªæ•°æ®é¡µï¼ˆå³ä½¿æ•°æ®å¾ˆå°ï¼‰ï¼Œå¯¼è‡´ç©ºé—´åˆ©ç”¨ç‡ä½ä¸‹ï¼ˆå¦‚å­˜å‚¨ 5KB æ•°æ®éœ€å ç”¨ 8KB çš„æ•´é¡µï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ¬¡åˆ é™¤æ“ä½œ&lt;/strong&gt;ï¼šåˆ é™¤ &lt;code&gt;TEXT&lt;/code&gt;/&lt;code&gt;BLOB&lt;/code&gt; æ•°æ®åï¼Œé‡Šæ”¾çš„é¡µå¯èƒ½ä¸è¿ç»­ï¼Œå½¢æˆç©ºæ´ï¼ˆFragmentï¼‰ï¼Œç‰©ç†æ–‡ä»¶å¤§å°ä¸å˜ï¼Œéœ€æ‰‹åŠ¨æ•´ç†ï¼ˆå¦‚ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–°æ‰©å®¹&lt;/strong&gt;ï¼šè‹¥æ›´æ–°åæ•°æ®å¢å¤§ï¼Œå¯èƒ½è§¦å‘é¡µåˆ†è£‚æˆ–è¡Œè¿ç§»ï¼Œè¿›ä¸€æ­¥åŠ å‰§ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡¨ç©ºé—´å¢é•¿æ¨¡å¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€æ‰©å±•ï¼š
&lt;ul&gt;
&lt;li&gt;MySQL çš„ç‹¬ç«‹è¡¨ç©ºé—´ï¼ˆ&lt;code&gt;innodb_file_per_table=ON&lt;/code&gt;ï¼‰ä¼šéš &lt;code&gt;BLOB&lt;/code&gt; æ•°æ®å¢åŠ è‡ªåŠ¨æ‰©å±• &lt;code&gt;.ibd&lt;/code&gt; æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;Oracle çš„ &lt;code&gt;LOB&lt;/code&gt; æ®µä¼šå ç”¨ç‹¬ç«‹è¡¨ç©ºé—´ï¼Œéœ€ç›‘æ§å…¶å¢é•¿è¶‹åŠ¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çªå‘æ€§å¢é•¿&lt;/strong&gt;ï¼šæ‰¹é‡æ’å…¥å¤§å¯¹è±¡å¯èƒ½å¯¼è‡´è¡¨ç©ºé—´ç¬é—´æ‰©å®¹ï¼ˆå¦‚æœªé¢„åˆ†é…è¶³å¤Ÿç©ºé—´ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç©ºé—´ç¢ç‰‡ä¸æ€§èƒ½å½±å“"&gt;ğŸ“‰ &lt;strong&gt;ç©ºé—´ç¢ç‰‡ä¸æ€§èƒ½å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡¨ç©ºé—´å˜åŒ–&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜é¢‘æ’å…¥/åˆ é™¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç©ºæ´ç‡å¢åŠ ï¼Œç‰©ç†æ–‡ä»¶ä¸ç¼©å°&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢éœ€éå†æ›´å¤šé¡µï¼ŒI/O å‹åŠ›å¢å¤§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤§å¯¹è±¡æ›´æ–°ï¼ˆæ‰©å®¹ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¡µåˆ†è£‚å¢åŠ ï¼Œç¢ç‰‡ç‡ä¸Šå‡&lt;/td&gt;
&lt;td&gt;å†™å…¥å»¶è¿Ÿå¢åŠ ï¼Œäº‹åŠ¡é˜»å¡é£é™©é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœªå¯ç”¨å‹ç¼©&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç©ºé—´å ç”¨å¢é•¿ 50%â€“100%ï¼ˆå¯¹æ¯”å‹ç¼©æ–¹æ¡ˆï¼‰&lt;/td&gt;
&lt;td&gt;ç£ç›˜å’Œå†…å­˜å‹åŠ›åŠ å‰§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šMySQL ä¸­åˆ é™¤ 50% çš„ &lt;code&gt;BLOB&lt;/code&gt; æ•°æ®åï¼Œè¡¨ç‰©ç†æ–‡ä»¶å¤§å°ä¸å˜ï¼Œç›´åˆ°æ‰§è¡Œ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt; æ‰é‡Šæ”¾ç©ºé—´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–ç®¡ç†å»ºè®®"&gt;ğŸ› ï¸ &lt;strong&gt;ä¼˜åŒ–ç®¡ç†å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å‡å°‘-off-page-å­˜å‚¨"&gt;&lt;strong&gt;å‡å°‘ Off-Page å­˜å‚¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ—åˆå¹¶&lt;/strong&gt;ï¼šå°†å¤šä¸ªå° &lt;code&gt;BLOB&lt;/code&gt; åˆ—åˆå¹¶ä¸ºä¸€ä¸ªï¼Œå‡å°‘ç‹¬ç«‹é¡µåˆ†é…æ¬¡æ•°ï¼ˆå¦‚å°† 9 ä¸ª 7KB åˆ—åˆå¹¶ä¸º 1 ä¸ª 64KB åˆ—ï¼Œç©ºé—´èŠ‚çœ 40%ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è¡Œæ ¼å¼é€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;MySQLï¼šä¼˜å…ˆç”¨ &lt;code&gt;COMPACT&lt;/code&gt; æ ¼å¼ï¼ˆå­˜å‚¨å‰ç¼€ 768 å­—èŠ‚ï¼‰ï¼Œé¿å… &lt;code&gt;DYNAMIC&lt;/code&gt; çš„æŒ‡é’ˆå¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;Oracleï¼šå¯ç”¨ &lt;code&gt;ENABLE STORAGE IN ROW&lt;/code&gt; å†…è”å­˜å‚¨å°å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸»åŠ¨ç©ºé—´ç®¡ç†"&gt;&lt;strong&gt;ä¸»åŠ¨ç©ºé—´ç®¡ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å®šæœŸæ•´ç†ç¢ç‰‡ï¼š
&lt;ul&gt;
&lt;li&gt;MySQLï¼šæ‰§è¡Œ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt; æˆ– &lt;code&gt;ALTER TABLE ... ENGINE=InnoDB&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Oracleï¼šé‡å»ºè¡¨å¹¶è¿ç§»&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; LOB
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ®µï¼š
&lt;code&gt;ALTER TABLE table_name MOVE LOB(column_name) STORE AS (TABLESPACE new_tbs);&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¢„åˆ†é…ç©ºé—´&lt;/strong&gt;ï¼šè®¾ç½®è¡¨ç©ºé—´è‡ªåŠ¨æ‰©å±•ï¼ˆ&lt;code&gt;AUTOEXTEND ON&lt;/code&gt;ï¼‰ï¼Œé¿å…çªå‘å†™å…¥å¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ€§èƒ½ä¸å¤‡ä»½ä¼˜åŒ–"&gt;&lt;strong&gt;æ€§èƒ½ä¸å¤‡ä»½ä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç¦»å­˜å‚¨&lt;/strong&gt;ï¼šå°† &lt;code&gt;TEXT&lt;/code&gt;/&lt;code&gt;BLOB&lt;/code&gt; åˆ—æ‹†åˆ†åˆ°ç‹¬ç«‹è¡¨ï¼Œæ ¸å¿ƒè¡¨ä»…ä¿ç•™æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆæˆç´¢å¼•&lt;/strong&gt;ï¼šä¸º &lt;code&gt;BLOB&lt;/code&gt; å†…å®¹ç”Ÿæˆæ•£åˆ—å€¼ï¼ˆå¦‚ MD5ï¼‰ï¼Œé€šè¿‡ç´¢å¼•æ•£åˆ—åˆ—åŠ é€ŸæŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;li&gt;å¤‡ä»½ç­–ç•¥ï¼š
&lt;ul&gt;
&lt;li&gt;MySQLï¼š&lt;code&gt;mysqldump&lt;/code&gt; è·³è¿‡ &lt;code&gt;BLOB&lt;/code&gt; æˆ–åˆ†å·å¤‡ä»½ã€‚&lt;/li&gt;
&lt;li&gt;Oracleï¼šä½¿ç”¨ &lt;code&gt;RMAN&lt;/code&gt; å‹ç¼©å¤‡ä»½ &lt;code&gt;LOB&lt;/code&gt; æ®µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-mysql-ä¸-oracle-å…³é”®å·®å¼‚å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;MySQL ä¸ Oracle å…³é”®å·®å¼‚å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;MySQL&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Oracle&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Off-Page é˜ˆå€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;768 å­—èŠ‚ï¼ˆCOMPACTï¼‰æˆ–å…¨éƒ¨åˆ†ç¦»ï¼ˆDYNAMICï¼‰&lt;/td&gt;
&lt;td&gt;~4KBï¼ˆä¾èµ– &lt;code&gt;ENABLE STORAGE IN ROW&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç©ºé—´å›æ”¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;éœ€ &lt;code&gt;ALTER TABLE MOVE LOB&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ€å¤§é™åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;4GBï¼ˆLONGBLOBï¼‰&lt;/td&gt;
&lt;td&gt;4GBï¼ˆåŸºæœ¬ BLOBï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨ &lt;code&gt;TEXT&lt;/code&gt;/&lt;code&gt;BLOB&lt;/code&gt; æ•°æ®æ—¶ï¼Œè¡¨ç©ºé—´çš„æ ¸å¿ƒå˜åŒ–æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´ç¢ç‰‡åŒ–&lt;/strong&gt;ï¼šåˆ é™¤/æ›´æ–°å¯¼è‡´ç©ºæ´ï¼Œéœ€æ‰‹åŠ¨æ•´ç†ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Off-Page è†¨èƒ€&lt;/strong&gt;ï¼šç‹¬ç«‹é¡µå­˜å‚¨å¼•å‘ç©ºé—´æµªè´¹ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ‰©å®¹é£é™©&lt;/strong&gt;ï¼šçªå‘å†™å…¥å¯èƒ½è§¦å‘è¡¨ç©ºé—´æš´æ¶¨ã€‚
â€‹&lt;strong&gt;ä¼˜åŒ–æ ¸å¿ƒ&lt;/strong&gt;â€‹ï¼šåˆå¹¶åˆ—ã€é€‰åˆé€‚è¡Œæ ¼å¼ã€å®šæœŸç¢ç‰‡æ•´ç†ã€åˆ†ç¦»å¤§å¯¹è±¡è¡¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ åŠ¡å¿…ç›‘æ§è¡¨ç©ºé—´ä½¿ç”¨ç‡ï¼ˆå¦‚ MySQL &lt;code&gt;DATA_FREE&lt;/code&gt;ã€Oracle &lt;code&gt;DBA_SEGMENTS&lt;/code&gt;ï¼‰ï¼Œé¿å…å› å¤§å¯¹è±¡å¤±æ§å¢é•¿æ‹–å®æ•´ä¸ªåº“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="text-versus-blob"&gt;TEXT versus BLOB
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ MySQL ä¸­ &lt;code&gt;TEXT&lt;/code&gt; ä¸ &lt;code&gt;BLOB&lt;/code&gt; æ•°æ®ç±»å‹çš„è¯¦ç»†å¯¹æ¯”ï¼Œä»å­˜å‚¨æœºåˆ¶ã€åŠŸèƒ½ç‰¹æ€§åˆ°åº”ç”¨åœºæ™¯å…¨é¢è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå¼‚åŒç‚¹æ¦‚è§ˆ"&gt;ğŸ“Š &lt;strong&gt;æ ¸å¿ƒå¼‚åŒç‚¹æ¦‚è§ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;TEXT&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;BLOB&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç›¸åŒç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–‡æœ¬æ•°æ®ï¼ˆå­—ç¬¦åºåˆ—ï¼Œå¦‚æ–‡ç« ã€æ—¥å¿—ï¼‰&lt;/td&gt;
&lt;td&gt;äºŒè¿›åˆ¶æ•°æ®ï¼ˆå­—èŠ‚åºåˆ—ï¼Œå¦‚å›¾ç‰‡ã€åŠ å¯†æ–‡ä»¶ï¼‰&lt;/td&gt;
&lt;td&gt;å‡ç”¨äºå­˜å‚¨å¤§æ•°æ®ï¼ˆæœ€å¤§ 4GBï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—ç¬¦é›†å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒå­—ç¬¦é›†å’Œæ’åºè§„åˆ™ï¼ˆå¦‚ &lt;code&gt;utf8_general_ci&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æ— å­—ç¬¦é›†ï¼ŒæŒ‰åŸå§‹å­—èŠ‚å­˜å‚¨&lt;/td&gt;
&lt;td&gt;å‡ä¸æ”¯æŒé»˜è®¤å€¼ï¼ˆ&lt;code&gt;DEFAULT&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¯”è¾ƒä¸æ’åº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰å­—ç¬¦é›†è§„åˆ™æ’åºï¼ˆå¦‚å­—æ¯é¡ºåºï¼‰&lt;/td&gt;
&lt;td&gt;æŒ‰å­—èŠ‚æ•°å€¼é€ä½æ¯”è¾ƒ&lt;/td&gt;
&lt;td&gt;ç´¢å¼•éœ€å‰ç¼€é•¿åº¦ï¼ˆå¦‚ &lt;code&gt;INDEX(column(10))&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‡½æ•°æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒå­—ç¬¦ä¸²å‡½æ•°ï¼ˆ&lt;code&gt;CONCAT&lt;/code&gt;ã€&lt;code&gt;SUBSTRING&lt;/code&gt;ï¼‰å’Œ &lt;code&gt;LIKE&lt;/code&gt; æŸ¥è¯¢&lt;/td&gt;
&lt;td&gt;ä»…æ”¯æŒäºŒè¿›åˆ¶æ“ä½œï¼ˆå¦‚ &lt;code&gt;LENGTH&lt;/code&gt;è¿”å›å­—èŠ‚æ•°ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸¥æ ¼æ¨¡å¼ä¸‹è¶…é•¿æ•°æ®æˆªæ–­æŠ¥é”™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å°¾éƒ¨ç©ºæ ¼å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¿ç•™å°¾éƒ¨ç©ºæ ¼ï¼Œæ¯”è¾ƒæ—¶å¯èƒ½å½±å“ç»“æœ&lt;/td&gt;
&lt;td&gt;ä¿ç•™æ‰€æœ‰å­—èŠ‚ï¼Œæ— ç‰¹æ®Šå¤„ç†&lt;/td&gt;
&lt;td&gt;å­˜å‚¨æ—¶ä¿ç•™åŸå§‹æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æŠ€æœ¯ç»†èŠ‚è§£æ"&gt;âš™ï¸ &lt;strong&gt;å…³é”®æŠ€æœ¯ç»†èŠ‚è§£æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å­˜å‚¨æœºåˆ¶"&gt;&lt;strong&gt;å­˜å‚¨æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;TEXT&lt;/li&gt;
&lt;li&gt;æ•°æ®æŒ‰å­—ç¬¦ç¼–ç å­˜å‚¨ï¼ˆå¦‚ UTF-8ï¼‰ï¼Œå­—ç¬¦é•¿åº¦å½±å“ç©ºé—´å ç”¨ã€‚
&lt;ul&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š&lt;code&gt;TEXT 'abc'&lt;/code&gt;ï¼ˆUTF-8ï¼‰å  3 å­—èŠ‚ï¼Œä¸­æ–‡å­—ç¬¦å  3~4 å­—èŠ‚/å­—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;BLOB&lt;/li&gt;
&lt;li&gt;ç›´æ¥å­˜å‚¨åŸå§‹å­—èŠ‚æµï¼Œæ— ç¼–ç è½¬æ¢ã€‚
&lt;ul&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šä¸€å¼  1MB å›¾ç‰‡å­˜å…¥ &lt;code&gt;BLOB&lt;/code&gt; åä»å çº¦ 1MB ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç´¢å¼•ä¸æŸ¥è¯¢æ€§èƒ½"&gt;&lt;strong&gt;ç´¢å¼•ä¸æŸ¥è¯¢æ€§èƒ½&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ç´¢å¼•é™åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸¤è€…å‡éœ€æŒ‡å®šå‰ç¼€é•¿åº¦åˆ›å»ºç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;CREATE INDEX idx ON t1 (text_col(20))&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TEXT&lt;/code&gt; ç´¢å¼•å—å­—ç¬¦é›†å½±å“ï¼ˆä¸åŒå­—ç¬¦é›†ç´¢å¼•å¤§å°ä¸åŒï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸´æ—¶è¡¨é—®é¢˜ï¼š
&lt;ul&gt;
&lt;li&gt;æŸ¥è¯¢æ¶‰åŠ &lt;code&gt;TEXT/BLOB&lt;/code&gt; æ—¶ï¼ŒMySQL å¼ºåˆ¶ä½¿ç”¨&lt;strong&gt;ç£ç›˜ä¸´æ—¶è¡¨&lt;/strong&gt;ï¼ˆ&lt;code&gt;MEMORY&lt;/code&gt; å¼•æ“ä¸æ”¯æŒï¼‰ï¼Œæ˜¾è‘—é™ä½æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;ï¼šé¿å… &lt;code&gt;SELECT *&lt;/code&gt;ï¼Œæ”¹ç”¨ &lt;code&gt;SUBSTRING(column, length)&lt;/code&gt; æˆªå–åˆ°å†…å­˜ä¸´æ—¶è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®æ“ä½œå·®å¼‚"&gt;&lt;strong&gt;æ•°æ®æ“ä½œå·®å¼‚&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;TEXT æ”¯æŒæƒ…å†µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;BLOB æ”¯æŒæƒ…å†µ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å­—ç¬¦ä¸²æ‹¼æ¥&lt;/td&gt;
&lt;td&gt;âœ… &lt;code&gt;CONCAT(text1, text2)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­ä¸²æå–&lt;/td&gt;
&lt;td&gt;âœ… &lt;code&gt;SUBSTRING(text, 1, 10)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ éœ€ç”¨ &lt;code&gt;SUBSTRING&lt;/code&gt; è½¬å­—ç¬¦å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¨¡å¼åŒ¹é…&lt;/td&gt;
&lt;td&gt;âœ… &lt;code&gt;WHERE text_col LIKE '%sql%'&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å…¨æ–‡æœç´¢&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼ˆ&lt;code&gt;FULLTEXT&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å­ç±»å‹ä¸å®¹é‡é™åˆ¶"&gt;ğŸ“‚ &lt;strong&gt;å­ç±»å‹ä¸å®¹é‡é™åˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;TEXT æœ€å¤§å®¹é‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;BLOB æœ€å¤§å®¹é‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;TINYTEXT/BLOB&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;255 &lt;strong&gt;å­—ç¬¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;255 &lt;strong&gt;å­—èŠ‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çŸ­æ–‡æœ¬/å°å›¾æ ‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;TEXT/BLOB&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;64 KBï¼ˆ65,535 å­—ç¬¦ï¼‰&lt;/td&gt;
&lt;td&gt;64 KBï¼ˆ65,535 å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;è¯„è®ºã€äº§å“æè¿°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;MEDIUMTEXT/BLOB&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;16 MBï¼ˆ16M å­—ç¬¦ï¼‰&lt;/td&gt;
&lt;td&gt;16 MBï¼ˆ16M å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;é•¿ç¯‡å°è¯´ã€é«˜æ¸…ç¼©ç•¥å›¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LONGTEXT/BLOB&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;4 GBï¼ˆ4G å­—ç¬¦ï¼‰&lt;/td&gt;
&lt;td&gt;4 GBï¼ˆ4G å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“å¤‡ä»½ã€é«˜æ¸…è§†é¢‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ æ³¨æ„ï¼š&lt;code&gt;TEXT&lt;/code&gt; çš„å®¹é‡å•ä½æ˜¯å­—ç¬¦ï¼ˆå—å­—ç¬¦é›†å½±å“ï¼‰ï¼Œ&lt;code&gt;BLOB&lt;/code&gt; æ˜¯å­—èŠ‚ï¼ˆå›ºå®šï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—"&gt;ğŸ§© &lt;strong&gt;åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ–‡ç« å†…å®¹ã€ç”¨æˆ·è¯„è®º&lt;/td&gt;
&lt;td&gt;âœ… TEXT&lt;/td&gt;
&lt;td&gt;éœ€å­—ç¬¦é›†æ”¯æŒã€å…¨æ–‡æœç´¢å’Œå­—ç¬¦ä¸²æ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å›¾ç‰‡ã€éŸ³è§†é¢‘æ–‡ä»¶&lt;/td&gt;
&lt;td&gt;âœ… BLOB&lt;/td&gt;
&lt;td&gt;ä¿ç•™åŸå§‹äºŒè¿›åˆ¶æ ¼å¼ï¼Œæ— å­—ç¬¦é›†å¹²æ‰°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŠ å¯†æ•°æ®ï¼ˆå¦‚å“ˆå¸Œå€¼ã€å¯†é’¥ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… BLOB&lt;/td&gt;
&lt;td&gt;äºŒè¿›åˆ¶å­˜å‚¨é¿å…ç¼–ç æŸå&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤šè¯­è¨€æ–‡æœ¬ï¼ˆå¦‚æ—¥æ–‡ã€é˜¿æ‹‰ä¼¯æ–‡ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… TEXT&lt;/td&gt;
&lt;td&gt;ä¾èµ–å­—ç¬¦é›†æ­£ç¡®æ¸²æŸ“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸´æ—¶æ–‡ä»¶ç¼“å­˜&lt;/td&gt;
&lt;td&gt;âš ï¸ é¿å…ä½¿ç”¨&lt;/td&gt;
&lt;td&gt;æ˜“è§¦å‘ç£ç›˜ä¸´æ—¶è¡¨ï¼Œå»ºè®®ç”¨æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨é¿å‘å»ºè®®"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨é¿å‘å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å­—ç¬¦é›†ä¸€è‡´æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;TEXT&lt;/code&gt; åˆ—éœ€æ˜¾å¼æŒ‡å®šå­—ç¬¦é›†ï¼ˆå¦‚ &lt;code&gt;CHARSET=utf8mb4&lt;/code&gt;ï¼‰ï¼Œé¿å…ä¹±ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç´¢å¼•ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹ &lt;code&gt;TEXT&lt;/code&gt; åˆ›å»ºå‰ç¼€ç´¢å¼•æ—¶ï¼Œé•¿åº¦éœ€è¦†ç›–å¸¸è§æŸ¥è¯¢ï¼ˆå¦‚ &lt;code&gt;INDEX(comment(50))&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤‡ä»½ä¸è¿ç§»ï¼š
&lt;ul&gt;
&lt;li&gt;å¤§é‡ &lt;code&gt;BLOB&lt;/code&gt; æ•°æ®ä¼šæ˜¾è‘—å¢åŠ å¤‡ä»½ä½“ç§¯å’Œè€—æ—¶ï¼Œå»ºè®®åˆ†ç¦»å­˜å‚¨ï¼ˆå¦‚ç”¨æ–‡ä»¶è·¯å¾„æ›¿ä»£ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ç›‘æ§ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜é¢‘è¯»å†™ &lt;code&gt;TEXT/BLOB&lt;/code&gt; æ—¶ç›‘æ§ &lt;code&gt;Disk Temporary Tables&lt;/code&gt;ï¼Œè¶…è¿‡é˜ˆå€¼éœ€ä¼˜åŒ–æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“æ ¹æ®æœ¬è´¨éœ€æ±‚é€‰æ‹©"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šæ ¹æ®æœ¬è´¨éœ€æ±‚é€‰æ‹©&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;*&lt;em&gt;é€‰ &lt;code&gt;TEXT&lt;/code&gt;**ï¼šå¤„ç†*&lt;em&gt;å­—ç¬¦æ•°æ®&lt;/em&gt;&lt;/em&gt;ï¼Œéœ€å­—ç¬¦é›†æ”¯æŒã€æ–‡æœ¬æœç´¢æˆ–å­—ç¬¦ä¸²æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;*&lt;em&gt;é€‰ &lt;code&gt;BLOB&lt;/code&gt;**ï¼šå­˜å‚¨*&lt;em&gt;äºŒè¿›åˆ¶åŸå§‹æ•°æ®&lt;/em&gt;&lt;/em&gt;ï¼ˆå¦‚å›¾ç‰‡/åŠ å¯†æµï¼‰ï¼Œæ— éœ€å­—ç¬¦è§£é‡Šã€‚&lt;/li&gt;
&lt;li&gt;é€šç”¨åŸåˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…è¿‡åº¦ä½¿ç”¨ï¼šä¼˜å…ˆè€ƒè™‘å¤–éƒ¨å­˜å‚¨ï¼ˆå¦‚å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸¥æ ¼é™åˆ¶é•¿åº¦ï¼šç”¨ &lt;code&gt;MEDIUMTEXT&lt;/code&gt; è€Œé &lt;code&gt;LONGTEXT&lt;/code&gt; é˜²æ­¢æ„å¤–è†¨èƒ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ç²¾å‡†åŒ¹é…æ•°æ®ç±»å‹ä¸ä¸šåŠ¡åœºæ™¯ï¼Œå¯å…¼é¡¾æ•°æ®å®Œæ•´æ€§ã€æ€§èƒ½ä¸å­˜å‚¨æ•ˆç‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æº¢å‡ºé¡µ"&gt;æº¢å‡ºé¡µ
&lt;/h2&gt;&lt;p&gt;åœ¨æ•°æ®åº“å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œ&lt;strong&gt;æº¢å‡ºé¡µï¼ˆOverflow Pageï¼‰&lt;/strong&gt; æ˜¯ç”¨äºå¤„ç†å•æ¡è®°å½•æ•°æ®é‡è¿‡å¤§ã€æ— æ³•å®Œå…¨å­˜å‚¨åœ¨å•ä¸ªæ•°æ®é¡µï¼ˆé»˜è®¤16KBï¼‰æ—¶çš„ç‰¹æ®Šå­˜å‚¨æœºåˆ¶ã€‚å½“ä¸€è¡Œæ•°æ®çš„æŸä¸ªå­—æ®µï¼ˆå¦‚ &lt;code&gt;TEXT&lt;/code&gt;ã€&lt;code&gt;BLOB&lt;/code&gt; æˆ–è¶…å¤§ &lt;code&gt;VARCHAR&lt;/code&gt;ï¼‰è¶…è¿‡æ•°æ®é¡µçš„å®¹é‡é™åˆ¶æ—¶ï¼Œæ•°æ®åº“ä¼šå°†è¯¥å­—æ®µçš„éƒ¨åˆ†æ•°æ®æ‹†åˆ†åˆ°é¢å¤–çš„æº¢å‡ºé¡µä¸­å­˜å‚¨ï¼Œå¹¶é€šè¿‡æŒ‡é’ˆå…³è”è¿™äº›é¡µã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒæœºåˆ¶å’Œç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æº¢å‡ºé¡µçš„æ ¸å¿ƒæœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;æº¢å‡ºé¡µçš„æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;MySQL InnoDBï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Compact/Redundantè¡Œæ ¼å¼&lt;/strong&gt;ï¼šå•ä¸ªå­—æ®µæ•°æ®è¶…è¿‡ &lt;strong&gt;768å­—èŠ‚&lt;/strong&gt; æ—¶ï¼Œå‰768å­—èŠ‚ä¿ç•™åœ¨åŸå§‹æ•°æ®é¡µï¼Œå‰©ä½™æ•°æ®å­˜å…¥æº¢å‡ºé¡µï¼Œå¹¶é™„åŠ  &lt;strong&gt;20å­—èŠ‚æŒ‡é’ˆ&lt;/strong&gt; æŒ‡å‘æº¢å‡ºé¡µé“¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dynamic/Compressedè¡Œæ ¼å¼&lt;/strong&gt;ï¼šä¸å­˜å‚¨ä»»ä½•å®é™…æ•°æ®ï¼Œä»…ä¿ç•™ &lt;strong&gt;20å­—èŠ‚æŒ‡é’ˆ&lt;/strong&gt;ï¼Œæ‰€æœ‰æ•°æ®å­˜å…¥æº¢å‡ºé¡µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SQLite&lt;/strong&gt;ï¼šBæ ‘é¡µä¸­çš„è´Ÿè½½ï¼ˆPayloadï¼‰è¶…è¿‡é¡µå¯ç”¨ç©ºé—´æ—¶ï¼Œè¶…å‡ºéƒ¨åˆ†å­˜å…¥æº¢å‡ºé¡µé“¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é“¾è¡¨ç»„ç»‡ï¼šæº¢å‡ºé¡µé€šè¿‡æŒ‡é’ˆä¸²è”æˆå•å‘é“¾è¡¨ã€‚æ¯ä¸ªæº¢å‡ºé¡µåŒ…å«ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;4å­—èŠ‚&lt;/strong&gt;ï¼šæŒ‡å‘ä¸‹ä¸€ä¸ªæº¢å‡ºé¡µçš„é¡µå·ï¼ˆéæœ«å°¾é¡µï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®é™…æ•°æ®&lt;/strong&gt;ï¼šæœ«å°¾é¡µå¯ä»…å­˜1å­—èŠ‚æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´åˆ©ç”¨&lt;/strong&gt;ï¼šéæœ«å°¾æº¢å‡ºé¡µä¼šå°½é‡å¡«æ»¡ï¼ˆå¦‚16KBé¡µå­˜å‚¨ &lt;code&gt;16KB-4&lt;/code&gt; å­—èŠ‚æ•°æ®ï¼‰ï¼Œæœ«å°¾é¡µå¯çµæ´»ä½¿ç”¨ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®é¡µä¸æº¢å‡ºé¡µçš„å…³ç³»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå§‹æ•°æ®é¡µ&lt;/strong&gt;ï¼šå­˜å‚¨è¡Œè®°å½•çš„å…ƒä¿¡æ¯ï¼ˆå¦‚è®°å½•å¤´ã€å˜é•¿å­—æ®µåˆ—è¡¨ï¼‰åŠå°å­—æ®µæ•°æ®ï¼Œå¹¶ä¸ºå¤§å­—æ®µä¿ç•™æŒ‡é’ˆæˆ–å‰ç¼€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æº¢å‡ºé¡µ&lt;/strong&gt;ï¼šä»…å­˜å‚¨æ‹†åˆ†åçš„éƒ¨åˆ†å­—æ®µæ•°æ®ï¼Œä¸æ··åˆå­˜å‚¨å…¶ä»–è¡Œæ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šä¸€ä¸ª&lt;code&gt;VARCHAR(65532)&lt;/code&gt;å­—æ®µå­˜å‚¨64KBæ•°æ®æ—¶ï¼Œå¯èƒ½å ç”¨ &lt;strong&gt;1ä¸ªæ•°æ®é¡µ + 4ä¸ªæº¢å‡ºé¡µ&lt;/strong&gt;ï¼ˆæ¯é¡µ16KBï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æº¢å‡ºé¡µå¯¹æ€§èƒ½ä¸ç©ºé—´çš„å½±å“"&gt;âš ï¸ &lt;strong&gt;æº¢å‡ºé¡µå¯¹æ€§èƒ½ä¸ç©ºé—´çš„å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹é¢&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å½±å“è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç©ºé—´åˆ©ç”¨ç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éæœ«å°¾æº¢å‡ºé¡µæœªå®Œå…¨å¡«æ»¡æ—¶é€ æˆæµªè´¹ï¼ˆå¦‚5KBæ•°æ®ç‹¬å 16KBé¡µï¼‰&lt;/td&gt;
&lt;td&gt;åˆå¹¶å¤šä¸ªå°å­—æ®µå‡å°‘æº¢å‡ºé¡µæ•°é‡ï¼ˆå¦‚å°†9ä¸ª7KBåˆ—åˆå¹¶ä¸º1ä¸ª64KBåˆ—ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;I/Oæ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»å–ä¸€è¡Œæ•°æ®éœ€è®¿é—®å¤šä¸ªé¡µï¼Œå¢åŠ ç£ç›˜å¯»å€å¼€é”€&lt;/td&gt;
&lt;td&gt;é¿å…é¢‘ç¹æŸ¥è¯¢å¤§å­—æ®µï¼›ä¸ºé«˜é¢‘æŸ¥è¯¢çš„å­—æ®µç”Ÿæˆå“ˆå¸Œç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¢ç‰‡åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ é™¤æº¢å‡ºé¡µåäº§ç”Ÿç©ºé—´ç©ºæ´ï¼Œç‰©ç†æ–‡ä»¶ä¸è‡ªåŠ¨æ”¶ç¼©&lt;/td&gt;
&lt;td&gt;å®šæœŸæ‰§è¡Œ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt;ï¼ˆMySQLï¼‰æˆ–é‡å»ºLOBæ®µï¼ˆOracleï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†™å…¥æ•ˆç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…å¤§å­—æ®µè§¦å‘æ•°æ®é¡µåˆ†è£‚ï¼Œæå‡æ’å…¥é€Ÿåº¦&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨&lt;code&gt;COMPRESSED&lt;/code&gt;è¡Œæ ¼å¼å‹ç¼©æ•°æ®ï¼ˆMySQLï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼šMySQLä¸­åˆ é™¤åŒ…å«æº¢å‡ºé¡µçš„è®°å½•åï¼Œéœ€æ‰§è¡Œ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt; æ‰èƒ½å›æ”¶ç©ºé—´ï¼Œå¦åˆ™ç‰©ç†æ–‡ä»¶å¤§å°ä¸å˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸åŒæ•°æ®åº“çš„æº¢å‡ºé¡µå®ç°å·®å¼‚"&gt;ğŸ”§ &lt;strong&gt;ä¸åŒæ•°æ®åº“çš„æº¢å‡ºé¡µå®ç°å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®åº“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æº¢å‡ºé˜ˆå€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æŒ‡é’ˆå¤§å°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç©ºé—´å›æ”¶æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœ€å¤§æ”¯æŒ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;MySQL&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;768å­—èŠ‚ï¼ˆCompactï¼‰æˆ–å…¨æº¢å‡ºï¼ˆDynamicï¼‰&lt;/td&gt;
&lt;td&gt;20å­—èŠ‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;OPTIMIZE TABLE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;4GBï¼ˆ&lt;code&gt;LONGBLOB&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;SQLite&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–é¡µå¯ç”¨ç©ºé—´&lt;/td&gt;
&lt;td&gt;4å­—èŠ‚ï¼ˆé¡µå·ï¼‰&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨å¹¶å…¥ç©ºé—²é¡µé“¾è¡¨&lt;/td&gt;
&lt;td&gt;2^31å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Oracle&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çº¦4KBï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
&lt;td&gt;36-84å­—èŠ‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ALTER TABLE MOVE LOB&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;4GBï¼ˆåŸºæœ¬BLOBï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æº¢å‡ºé¡µæ˜¯æ•°æ®åº“å¤„ç†è¶…é•¿å­—æ®µçš„é€šç”¨æ–¹æ¡ˆï¼Œå…¶æœ¬è´¨æ˜¯&lt;strong&gt;é€šè¿‡ç©ºé—´æ¢æ—¶é—´&lt;/strong&gt;çš„æƒè¡¡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´æ‹†åˆ†&lt;/strong&gt;ï¼šå°†å¤§å­—æ®µæ•°æ®åˆ†æ•£åˆ°å¤šä¸ªé¡µï¼Œé¿å…å•é¡µå®¹é‡ä¸è¶³ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒ‡é’ˆå…³è”&lt;/strong&gt;ï¼šç”¨é“¾è¡¨ç»´æŠ¤æ•°æ®é€»è¾‘è¿ç»­æ€§ï¼Œä½†å¢åŠ I/Oå¼€é”€ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€ä¸»åŠ¨ç®¡ç†&lt;/strong&gt;ï¼šå®šæœŸæ•´ç†ç¢ç‰‡ã€åˆ†ç¦»å†·çƒ­æ•°æ®ä»¥å¹³è¡¡æ€§èƒ½ä¸å­˜å‚¨æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ è®¾è®¡è¡¨ç»“æ„æ—¶ï¼Œè‹¥éå¿…è¦åº”é¿å…è¶…å¤§å­—æ®µï¼›è‹¥å¿…é¡»ä½¿ç”¨ï¼Œå»ºè®®å°†å¤§å­—æ®µç‹¬ç«‹å­˜æ”¾åˆ°å‰¯è¡¨ï¼Œä¸»è¡¨ä»…ä¿ç•™IDå¼•ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="varchar"&gt;Varchar
&lt;/h2&gt;&lt;p&gt;MySQLä¸­&lt;code&gt;VARCHAR&lt;/code&gt;ç±»å‹çš„æœ€å¤§é•¿åº¦é™åˆ¶ä¸º &lt;strong&gt;65,535å­—èŠ‚&lt;/strong&gt;ï¼Œè¿™ä¸€é™åˆ¶æºäºMySQLçš„è¡Œå­˜å‚¨è®¾è®¡ï¼Œè€Œé&lt;code&gt;VARCHAR&lt;/code&gt;ç±»å‹æœ¬èº«çš„å›ºæœ‰ç¼ºé™·ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åŸå› å’Œå½±å“å› ç´ ï¼š&lt;/p&gt;
&lt;h3 id="-è¡Œå¤§å°é™åˆ¶æ ¸å¿ƒåŸå› "&gt;âš™ï¸ &lt;strong&gt;è¡Œå¤§å°é™åˆ¶ï¼ˆæ ¸å¿ƒåŸå› ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;MySQLè§„å®šï¼Œå•è¡Œæ•°æ®çš„æ€»é•¿åº¦ï¼ˆä¸åŒ…æ‹¬&lt;code&gt;TEXT&lt;/code&gt;ã€&lt;code&gt;BLOB&lt;/code&gt;ç­‰å¤§å¯¹è±¡ç±»å‹ï¼‰ä¸èƒ½è¶…è¿‡ &lt;strong&gt;65,535å­—èŠ‚&lt;/strong&gt;ï¼ˆå³ &lt;code&gt;2^{16} - 1&lt;/code&gt; å­—èŠ‚ï¼‰ã€‚è¿™æ˜¯å› ä¸ºMySQLä½¿ç”¨16ä½åœ°å€ç©ºé—´ç®¡ç†è¡Œæ•°æ®ï¼Œæœ€å¤§å¯»å€èŒƒå›´ä¸º65,535å­—èŠ‚ã€‚è‹¥æ‰€æœ‰å­—æ®µï¼ˆåŒ…æ‹¬&lt;code&gt;VARCHAR&lt;/code&gt;ï¼‰çš„æ€»é•¿åº¦è¶…è¿‡æ­¤å€¼ï¼Œä¼šè§¦å‘é”™è¯¯ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ERROR 1118 (42000): Row size too large... You have to change some columns to TEXT or BLOBs
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-varcharçš„å­˜å‚¨ç»“æ„"&gt;ğŸ“¦ &lt;strong&gt;VARCHARçš„å­˜å‚¨ç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;VARCHAR&lt;/code&gt;çš„å®é™…å­˜å‚¨å ç”¨åŒ…å«ä¸¤éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®é™…æ•°æ®&lt;/strong&gt;ï¼šå­—ç¬¦ä¸²çš„å­—èŠ‚å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;é•¿åº¦æ ‡è¯†ï¼šé¢å¤–1~2å­—èŠ‚è®°å½•å­—ç¬¦ä¸²å®é™…é•¿åº¦ï¼š
&lt;ul&gt;
&lt;li&gt;å®šä¹‰é•¿åº¦ â‰¤ 255å­—ç¬¦ï¼šå ç”¨&lt;strong&gt;1å­—èŠ‚&lt;/strong&gt;å­˜å‚¨é•¿åº¦ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;å®šä¹‰é•¿åº¦ &amp;gt; 255å­—ç¬¦ï¼šå ç”¨&lt;strong&gt;2å­—èŠ‚&lt;/strong&gt;å­˜å‚¨é•¿åº¦ä¿¡æ¯ã€‚
ä¾‹å¦‚ï¼Œ&lt;code&gt;VARCHAR(100)&lt;/code&gt; å­˜å‚¨&amp;quot;abc&amp;quot;ï¼ˆ3å­—èŠ‚ï¼‰æ—¶ï¼Œæ€»å ç”¨ä¸º &lt;code&gt;3å­—èŠ‚ + 1å­—èŠ‚ = 4å­—èŠ‚&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å­—ç¬¦é›†çš„å½±å“"&gt;ğŸŒ &lt;strong&gt;å­—ç¬¦é›†çš„å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç”±äºä¸åŒå­—ç¬¦é›†çš„å­—ç¬¦å­—èŠ‚æ•°ä¸åŒï¼Œ&lt;code&gt;VARCHAR(65535)&lt;/code&gt; çš„å®é™…å­—ç¬¦å®¹é‡éœ€é‡æ–°è®¡ç®—ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å­—ç¬¦é›†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å•å­—ç¬¦æœ€å¤§å­—èŠ‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç†è®ºæœ€å¤§å­—ç¬¦æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®é™…æœ€å¤§å­—ç¬¦æ•°ï¼ˆè€ƒè™‘é•¿åº¦æ ‡è¯†ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Latin1 (e.g., ASCII)&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;65,535&lt;/td&gt;
&lt;td&gt;65,533ï¼ˆé•¿åº¦æ ‡è¯†å 2å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;GBK&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;32,767&lt;/td&gt;
&lt;td&gt;32,765ï¼ˆé•¿åº¦æ ‡è¯†å 2å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UTF8&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;21,845&lt;/td&gt;
&lt;td&gt;21,844ï¼ˆé•¿åº¦æ ‡è¯†å 1~2å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UTF8MB4ï¼ˆæ”¯æŒEmojiï¼‰&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;16,383&lt;/td&gt;
&lt;td&gt;16,382ï¼ˆé•¿åº¦æ ‡è¯†å 2å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šå®é™…æœ€å¤§å­—ç¬¦æ•°è¿˜éœ€æ‰£é™¤å…¶ä»–å­—æ®µå’ŒNULLæ ‡è¯†çš„å ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="-å…¶ä»–å­—æ®µä¸nullæ ‡è¯†çš„å ç”¨"&gt;âš ï¸ &lt;strong&gt;å…¶ä»–å­—æ®µä¸NULLæ ‡è¯†çš„å ç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¶ä»–å­—æ®µ&lt;/strong&gt;ï¼šè¡¨ä¸­é&lt;code&gt;VARCHAR&lt;/code&gt;å­—æ®µï¼ˆå¦‚&lt;code&gt;INT&lt;/code&gt;ã€&lt;code&gt;CHAR&lt;/code&gt;ï¼‰ä¼šå ç”¨è¡Œç©ºé—´ï¼Œè¿›ä¸€æ­¥å‹ç¼©&lt;code&gt;VARCHAR&lt;/code&gt;å¯ç”¨ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;NULLæ ‡è¯†ï¼šè‹¥å­—æ®µå…è®¸ä¸ºNULLï¼Œæ¯8ä¸ªå¯ä¸ºNULLçš„å­—æ®µå…±äº«1å­—èŠ‚çš„æ ‡å¿—ä½ï¼ˆä¸è¶³8ä¸ªæŒ‰1å­—èŠ‚è®¡ï¼‰ã€‚ä¾‹å¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- å…è®¸NULLæ—¶ï¼Œå³ä½¿é•¿åº¦è¶³å¤Ÿä¹Ÿå¯èƒ½å¤±è´¥
CREATE TABLE t1 (a VARCHAR(65533) NULL) CHARSET=latin1; -- æŠ¥é”™ï¼
-- éNULLæ—¶å¯æˆåŠŸ
CREATE TABLE t1 (a VARCHAR(65533) NOT NULL) CHARSET=latin1; -- æˆåŠŸ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å†å²ç‰ˆæœ¬å·®å¼‚"&gt;ğŸ“… &lt;strong&gt;å†å²ç‰ˆæœ¬å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;MySQL 4.0åŠæ›´æ—©ï¼š&lt;code&gt;VARCHAR&lt;/code&gt;æœ€å¤§ä»…æ”¯æŒ&lt;strong&gt;255å­—èŠ‚&lt;/strong&gt;ï¼ˆé•¿åº¦æ ‡è¯†ç”¨1å­—èŠ‚ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;MySQL 5.0+ï¼šæ”¯æŒæœ€å¤§&lt;strong&gt;65,535å­—èŠ‚&lt;/strong&gt;ï¼Œä¸”å®šä¹‰é•¿åº¦å•ä½ä»&lt;strong&gt;å­—èŠ‚&lt;/strong&gt;æ”¹ä¸º&lt;strong&gt;å­—ç¬¦&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;VARCHAR(50)&lt;/code&gt;æŒ‡50ä¸ªå­—ç¬¦è€Œé50å­—èŠ‚ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-è¶…è¿‡é™åˆ¶çš„è§£å†³æ–¹æ¡ˆ"&gt;ğŸ’¡ &lt;strong&gt;è¶…è¿‡é™åˆ¶çš„è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è‹¥éœ€å­˜å‚¨è¶…è¿‡65,535å­—èŠ‚çš„æ•°æ®ï¼Œåº”æ”¹ç”¨å¤§å¯¹è±¡ç±»å‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;TEXT&lt;/code&gt;ï¼šæœ€å¤§65,535å­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MEDIUMTEXT&lt;/code&gt;ï¼šæœ€å¤§16,777,215å­—èŠ‚ï¼ˆçº¦16MBï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LONGTEXT&lt;/code&gt;ï¼šæœ€å¤§4,294,967,295å­—èŠ‚ï¼ˆçº¦4GBï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="æ€»ç»“"&gt;æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;VARCHAR(65535)&lt;/code&gt; çš„å­—èŠ‚ä¸Šé™æœ¬è´¨æ˜¯MySQLå•è¡Œæ•°æ®çš„å…¨å±€é™åˆ¶ï¼Œå åŠ å­—ç¬¦é›†ã€é•¿åº¦æ ‡è¯†ã€NULLæ ‡å¿—ç­‰å­˜å‚¨å¼€é”€åçš„ç»“æœã€‚å®é™…ä½¿ç”¨æ—¶ï¼Œéœ€æ ¹æ®å­—ç¬¦é›†è®¡ç®—å¯ç”¨å­—ç¬¦æ•°ï¼Œå¹¶ä¼˜å…ˆä½¿ç”¨&lt;code&gt;TEXT&lt;/code&gt;ç±»å‹è§„é¿è¡Œæº¢å‡ºé—®é¢˜ã€‚è®¾è®¡è¡¨ç»“æ„æ—¶ï¼Œé˜¿é‡Œå¼€å‘è§„èŒƒå»ºè®®ï¼šè‹¥å­—æ®µé•¿åº¦å¯èƒ½è¶…è¿‡5000å­—ç¬¦ï¼Œåº”ä½¿ç”¨&lt;code&gt;TEXT&lt;/code&gt;ç±»å‹å¹¶ç‹¬ç«‹å­˜è¡¨ã€‚&lt;/p&gt;
&lt;h2 id="decimal"&gt;DECIMAL
&lt;/h2&gt;&lt;p&gt;DECIMAL ä¸ FLOAT/DOUBLE æ˜¯æ•°æ®åº“ä¸­ç”¨äºå­˜å‚¨å°æ•°çš„ä¸åŒç±»å‹ï¼Œå…¶æ ¸å¿ƒå·®å¼‚åœ¨äº&lt;strong&gt;ç²¾åº¦å®ç°æ–¹å¼&lt;/strong&gt;å’Œ&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨æœºåˆ¶ä¸ç²¾åº¦"&gt;ğŸ”¢ &lt;strong&gt;å­˜å‚¨æœºåˆ¶ä¸ç²¾åº¦&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DECIMALï¼ˆå®šç‚¹æ•°ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨æ–¹å¼&lt;/strong&gt;ï¼šä»¥&lt;strong&gt;å­—ç¬¦ä¸²å½¢å¼&lt;/strong&gt;å­˜å‚¨åè¿›åˆ¶æ•°å­—ï¼ˆå¦‚ &lt;code&gt;&amp;quot;12.345&amp;quot;&lt;/code&gt;ï¼‰ï¼Œç¡®ä¿æ•°å€¼ç²¾ç¡®æ— è¯¯å·®ã€‚&lt;/li&gt;
&lt;li&gt;ç²¾åº¦æ§åˆ¶ï¼šé€šè¿‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; DECIMAL(M,D)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å®šä¹‰ç²¾åº¦ï¼š
- &lt;code&gt;M&lt;/code&gt;ï¼šæ€»ä½æ•°ï¼ˆæ•´æ•°+å°æ•°ï¼‰ï¼Œæœ€å¤§ 65ï¼ˆMySQLï¼‰
- &lt;code&gt;D&lt;/code&gt;ï¼šå°æ•°ä½æ•°ï¼Œæœ€å¤§ 30ï¼ˆMySQLï¼‰
ä¾‹å¦‚ &lt;code&gt;DECIMAL(5,2)&lt;/code&gt; å¯å­˜å‚¨ &lt;code&gt;-999.99&lt;/code&gt; è‡³ &lt;code&gt;999.99&lt;/code&gt;ï¼Œæ’å…¥ &lt;code&gt;1.234&lt;/code&gt; ä¼šå››èˆäº”å…¥ä¸º &lt;code&gt;1.23&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè´¢åŠ¡é‡‘é¢ã€ç¨ç‡ç­‰&lt;strong&gt;éœ€ç»å¯¹ç²¾ç¡®&lt;/strong&gt;çš„é¢†åŸŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;FLOAT/DOUBLEï¼ˆæµ®ç‚¹æ•°ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨æ–¹å¼ï¼šéµå¾ª
IEEE 754 æ ‡å‡†
ï¼Œä»¥äºŒè¿›åˆ¶ç§‘å­¦è®¡æ•°æ³•å­˜å‚¨è¿‘ä¼¼å€¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;FLOAT&lt;/code&gt;ï¼š32 ä½ï¼ˆ1 ç¬¦å·ä½ + 8 æŒ‡æ•°ä½ + 23 å°¾æ•°ä½ï¼‰ï¼Œæœ‰æ•ˆç²¾åº¦çº¦ &lt;strong&gt;7 ä½&lt;/strong&gt;åè¿›åˆ¶æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DOUBLE&lt;/code&gt;ï¼š64 ä½ï¼ˆ1 ç¬¦å·ä½ + 11 æŒ‡æ•°ä½ + 52 å°¾æ•°ä½ï¼‰ï¼Œæœ‰æ•ˆç²¾åº¦çº¦ &lt;strong&gt;15 ä½&lt;/strong&gt;åè¿›åˆ¶æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç²¾åº¦é—®é¢˜ï¼šäºŒè¿›åˆ¶æ— æ³•ç²¾ç¡®è¡¨ç¤ºæŸäº›åè¿›åˆ¶å°æ•°ï¼ˆå¦‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; 0.1
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;ï¼‰ï¼Œå¯¼è‡´
èˆå…¥è¯¯å·®
ã€‚ä¾‹å¦‚ï¼š
```
INSERT INTO test VALUES (1.2345, 1.2345); -- FLOAT å­˜å‚¨ä¸º 1.234 æˆ– 1.235ã€‚
```
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h3 id="-ç²¾åº¦ä¸èŒƒå›´å¯¹æ¯”"&gt;ğŸ“Š &lt;strong&gt;ç²¾åº¦ä¸èŒƒå›´å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;DECIMAL&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;FLOAT&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;DOUBLE&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç²¾åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç²¾ç¡®ï¼ˆç”¨æˆ·è‡ªå®šä¹‰ï¼‰&lt;/td&gt;
&lt;td&gt;çº¦ 7 ä½æœ‰æ•ˆæ•°å­—&lt;/td&gt;
&lt;td&gt;çº¦ 15 ä½æœ‰æ•ˆæ•°å­—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èŒƒå›´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒå°ï¼ˆå¦‚ &lt;code&gt;DECIMAL(10,2)&lt;/code&gt; æœ€å¤§ &lt;code&gt;99999999.99&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æå¤§ï¼ˆ&lt;code&gt;Â±3.4E38&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æå¤§ï¼ˆ&lt;code&gt;Â±1.7E308&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨ç¤ºä¾‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;123.45&lt;/code&gt; â†’ ç²¾ç¡®å­˜å‚¨&lt;/td&gt;
&lt;td&gt;&lt;code&gt;123.456789&lt;/code&gt; â†’ å¯èƒ½å­˜å‚¨ä¸º &lt;code&gt;123.4568&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;123.456789012345&lt;/code&gt; â†’ æ›´æ¥è¿‘åŸå€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¡ç®—è¯¯å·®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;ç´¯åŠ åè¯¯å·®æ˜¾è‘—ï¼ˆå¦‚ &lt;code&gt;SUM()&lt;/code&gt; ç»“æœåå·®ï¼‰&lt;/td&gt;
&lt;td&gt;è¯¯å·®è¾ƒå°ä½†ä»å­˜åœ¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸å­˜å‚¨ç©ºé—´"&gt;âš–ï¸ &lt;strong&gt;æ€§èƒ½ä¸å­˜å‚¨ç©ºé—´&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨å¼€é”€&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DECIMAL&lt;/code&gt;ï¼šç©ºé—´éšç²¾åº¦å¢åŠ ï¼ˆæ¯ 9 ä½æ•°å­—å  4 å­—èŠ‚ï¼‰ï¼Œä¾‹å¦‚ &lt;code&gt;DECIMAL(10,2)&lt;/code&gt; çº¦éœ€ 5 å­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FLOAT&lt;/code&gt;ï¼šå›ºå®š &lt;strong&gt;4 å­—èŠ‚&lt;/strong&gt;ï¼›&lt;code&gt;DOUBLE&lt;/code&gt;ï¼šå›ºå®š &lt;strong&gt;8 å­—èŠ‚&lt;/strong&gt;ï¼Œç©ºé—´æ•ˆç‡æ›´é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—é€Ÿåº¦&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;FLOAT/DOUBLE&lt;/code&gt;ï¼šæµ®ç‚¹è¿ç®—ç”±ç¡¬ä»¶åŠ é€Ÿï¼Œ&lt;strong&gt;é€Ÿåº¦æ›´å¿«&lt;/strong&gt;ï¼Œé€‚åˆå¤§è§„æ¨¡ç§‘å­¦è®¡ç®—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DECIMAL&lt;/code&gt;ï¼šå­—ç¬¦ä¸²è½¬æ¢ä¸åè¿›åˆ¶è¿ç®—å¯¼è‡´&lt;strong&gt;æ€§èƒ½è¾ƒä½&lt;/strong&gt;ï¼Œé«˜å¹¶å‘åœºæ™¯éœ€è°¨æ…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯é€‰æ‹©"&gt;ğŸ§© &lt;strong&gt;åº”ç”¨åœºæ™¯é€‰æ‹©&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èåœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é¿å‘æŒ‡å—&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;DECIMAL&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… é‡‘èç³»ç»Ÿï¼ˆè´¦æˆ·ä½™é¢ã€äº¤æ˜“é‡‘é¢ï¼‰ âœ… ç¨ç‡ã€è¯„åˆ†ç­‰å›ºå®šå°æ•°ä½åœºæ™¯&lt;/td&gt;
&lt;td&gt;é¿å…è¿‡åº¦å®šä¹‰ç²¾åº¦ï¼ˆå¦‚ &lt;code&gt;DECIMAL(30,10)&lt;/code&gt; æµªè´¹ç©ºé—´ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;FLOAT&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆæ¸©åº¦ã€åæ ‡ï¼‰ âœ… å›¾åƒå¤„ç†ï¼ˆé¢œè‰²å€¼ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ç¦æ­¢ç”¨äºè´§å¸è®¡ç®—ï¼ˆè¯¯å·®ç´¯ç§¯è‡´å‘½ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;DOUBLE&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç§‘å­¦è®¡ç®—ï¼ˆç‰©ç†æ¨¡æ‹Ÿã€å¤©æ–‡æ•°æ®ï¼‰ âœ… æœºå™¨å­¦ä¹ æ¨¡å‹å‚æ•°&lt;/td&gt;
&lt;td&gt;ä¼˜å…ˆç”¨ &lt;code&gt;DECIMAL&lt;/code&gt; æ›¿ä»£éœ€é«˜ç²¾åº¦çš„ä¸šåŠ¡æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-11"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¦ç²¾ç¡® â†’ DECIMAL&lt;/strong&gt;ï¼šæ­»ç£•å°æ•°ä½å¿…é¡»åˆ†æ¯«ä¸å·®çš„åœºæ™¯ï¼ˆå¦‚1åˆ†é’±ä¹Ÿä¸èƒ½é”™ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¦é€Ÿåº¦/èŒƒå›´ â†’ FLOAT/DOUBLE&lt;/strong&gt;ï¼šæ¥å—å¾®å°è¯¯å·®ï¼Œä½†æ•°æ®é‡å·¨å¤§æˆ–èŒƒå›´è¶…å®½çš„ç§‘å­¦é¢†åŸŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å‘æç¤º&lt;/strong&gt;ï¼šç”¨ &lt;code&gt;FLOAT&lt;/code&gt; å­˜é‡‘é¢å¯èƒ½å›  &lt;code&gt;0.1 + 0.2 â‰  0.3&lt;/code&gt; å¼•å‘è´¢åŠ¡äº‹æ•…ï¼›ç”¨ &lt;code&gt;DECIMAL&lt;/code&gt; å­˜å®‡å®™è·ç¦»åˆ™å¯èƒ½æº¢å‡ºæˆ–æ‹–å®æ€§èƒ½ã€‚&lt;strong&gt;æ ¹æ®ä¸šåŠ¡æœ¬è´¨é€‰æ‹©ï¼Œç²¾åº¦ä¸æ•ˆç‡éš¾ä¸¤å…¨ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="decimal-9-ä½-4-å­—èŠ‚"&gt;DECIMAL 9 ä½ 4 å­—èŠ‚
&lt;/h2&gt;&lt;p&gt;DECIMAL ç±»å‹é‡‡ç”¨â€œæ¯ 9 ä½åè¿›åˆ¶æ•°å ç”¨ 4 å­—èŠ‚â€çš„å­˜å‚¨è®¾è®¡ï¼Œæ ¸å¿ƒåŸå› æ˜¯ä¸ºäº†åœ¨ä¿éšœæ•°å€¼ç²¾ç¡®æ€§çš„åŒæ—¶ï¼Œä¼˜åŒ–å­˜å‚¨æ•ˆç‡ä¸è®¡ç®—æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æœºåˆ¶åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨åŸç†äºŒè¿›åˆ¶æ‰“åŒ…ä¸è¿›åˆ¶è½¬æ¢"&gt;âš™ï¸ &lt;strong&gt;å­˜å‚¨åŸç†ï¼šäºŒè¿›åˆ¶æ‰“åŒ…ä¸è¿›åˆ¶è½¬æ¢&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;DECIMAL å­˜å‚¨çš„æœ¬è´¨æ˜¯å°†åè¿›åˆ¶æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ ¼å¼è¿›è¡Œå‹ç¼©å­˜å‚¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿›åˆ¶è½¬æ¢é€»è¾‘&lt;/strong&gt;ï¼š
åè¿›åˆ¶æ¯ä½æ•°å­—èŒƒå›´æ˜¯ 0â€“9ï¼ˆ10 ç§çŠ¶æ€ï¼‰ï¼Œè€Œè®¡ç®—æœºå­˜å‚¨ä»¥äºŒè¿›åˆ¶ä½ï¼ˆbitï¼‰ä¸ºåŸºç¡€ã€‚æ¯ 9 ä½åè¿›åˆ¶æ•°çš„å–å€¼èŒƒå›´æ˜¯ 0â€“999,999,999ï¼ˆå…± 10â¹ ç§çŠ¶æ€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;äºŒè¿›åˆ¶ç©ºé—´éœ€æ±‚ï¼š
å­˜å‚¨ 10â¹ ç§çŠ¶æ€è‡³å°‘éœ€è¦æ»¡è¶³ 2â¿ â‰¥ 10â¹ çš„äºŒè¿›åˆ¶ä½æ•°ã€‚è®¡ç®—å¯å¾—ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;2Â³â° = 1,073,741,824 &amp;lt; 10â¹ï¼ˆä¸å¤Ÿï¼‰
2Â³Â² = 4,294,967,296 â‰¥ 10â¹ï¼ˆè¶³å¤Ÿï¼‰
&lt;/code&gt;&lt;/pre&gt;å› æ­¤ï¼Œ
4 å­—èŠ‚ï¼ˆ32 ä½ï¼‰
æ˜¯èƒ½å®Œæ•´å®¹çº³ 9 ä½åè¿›åˆ¶æ•°çš„æœ€å°äºŒè¿›åˆ¶å•å…ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å­˜å‚¨ä¼˜åŒ–åˆ†ç»„ä¸ä½™æ•°å¤„ç†"&gt;ğŸ“¦ &lt;strong&gt;å­˜å‚¨ä¼˜åŒ–ï¼šåˆ†ç»„ä¸ä½™æ•°å¤„ç†&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;DECIMAL é‡‡ç”¨åˆ†ç»„å­˜å‚¨ç­–ç•¥ä»¥å¹³è¡¡æ•ˆç‡å’Œçµæ´»æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;9 ä½åˆ†ç»„æœºåˆ¶&lt;/strong&gt;ï¼š
å°†æ•°å­—æŒ‰ 9 ä½ä¸€ç»„æ‹†åˆ†ï¼Œæ¯ç»„ç”¨ 4 å­—èŠ‚å­˜å‚¨ï¼ˆå¦‚å‰æ‰€è¿°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½™æ•°å¤„ç†è§„åˆ™&lt;/strong&gt;ï¼š
è‹¥æ•°å­—æ€»ä½æ•°ä¸æ˜¯ 9 çš„å€æ•°ï¼Œå‰©ä½™ä½æ•°æŒ‰éœ€åˆ†é…æ›´å°çš„å­—èŠ‚ç©ºé—´ï¼ˆè§ä¸‹è¡¨ï¼‰ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‰©ä½™ä½æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ‰€éœ€å­—èŠ‚&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1â€“2&lt;/td&gt;
&lt;td&gt;1 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3â€“4&lt;/td&gt;
&lt;td&gt;2 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5â€“6&lt;/td&gt;
&lt;td&gt;3 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7â€“9&lt;/td&gt;
&lt;td&gt;4 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¾‹å¦‚ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DECIMAL(18,9)&lt;/code&gt; â†’ æ•´æ•° 9 ä½ + å°æ•° 9 ä½ â†’ å„å  4 å­—èŠ‚ â†’ æ€»è®¡ 8 å­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DECIMAL(20,6)&lt;/code&gt; â†’ æ•´æ•° 14 ä½ï¼ˆ9+5ï¼‰â†’ 9 ä½å  4 å­—èŠ‚ + 5 ä½å  3 å­—èŠ‚ï¼›å°æ•° 6 ä½å  3 å­—èŠ‚ â†’ æ€»è®¡ 10 å­—èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€§èƒ½ä¸ç²¾åº¦çš„å¹³è¡¡"&gt;âš¡ï¸ &lt;strong&gt;æ€§èƒ½ä¸ç²¾åº¦çš„å¹³è¡¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—æ•ˆç‡&lt;/strong&gt;ï¼š
32 ä½ï¼ˆ4 å­—èŠ‚ï¼‰æ˜¯ CPU å’Œå†…å­˜å¯¹é½çš„å¸¸ç”¨å•ä½ï¼Œä»¥ 4 å­—èŠ‚ä¸ºå•ä½å¤„ç†æ•°æ®å¯æ˜¾è‘—æå‡è¿ç®—é€Ÿåº¦ï¼ˆå¦‚åŠ æ³•ã€ä¹˜æ³•å¯ç›´æ¥ç”¨ç¡¬ä»¶æŒ‡ä»¤ä¼˜åŒ–ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ç²¾åº¦æŸå¤±&lt;/strong&gt;ï¼š
æµ®ç‚¹æ•°ï¼ˆFLOAT/DOUBLEï¼‰å› äºŒè¿›åˆ¶ç§‘å­¦è®¡æ•°æ³•å­˜åœ¨èˆå…¥è¯¯å·®ï¼ˆå¦‚ 0.1 æ— æ³•ç²¾ç¡®è¡¨ç¤ºï¼‰ï¼Œè€Œ DECIMAL çš„åè¿›åˆ¶æ‰“åŒ…å­˜å‚¨ç¡®ä¿æ¯ä¸€ä½æ•°å­—ç²¾ç¡®ä¿ç•™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸å…¶ä»–ç±»å‹çš„å¯¹æ¯”"&gt;ğŸ”„ &lt;strong&gt;ä¸å…¶ä»–ç±»å‹çš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æµ®ç‚¹ç±»å‹ï¼ˆFLOAT/DOUBLEï¼‰&lt;/strong&gt;ï¼š
å›ºå®šå ç”¨ 4/8 å­—èŠ‚ï¼Œä½†å­˜å‚¨çš„æ˜¯è¿‘ä¼¼å€¼ã€‚ä¾‹å¦‚ &lt;code&gt;FLOAT&lt;/code&gt; ä»…ç²¾ç¡®åˆ°çº¦ 7 ä½åè¿›åˆ¶æ•°ï¼Œè¶…å‡ºéƒ¨åˆ†å¯èƒ½å¤±çœŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­—ç¬¦ä¸²å­˜å‚¨&lt;/strong&gt;ï¼š
è‹¥ç”¨å­—ç¬¦ä¸²å­˜æ•°å­—ï¼ˆå¦‚ VARCHARï¼‰ï¼Œæ¯ä¸ªæ•°å­—éœ€ 1 å­—èŠ‚ï¼Œå­˜å‚¨ 9 ä½éœ€ 9 å­—èŠ‚ï¼ˆè¿œè¶… DECIMAL çš„ 4 å­—èŠ‚ï¼‰ï¼Œä¸”æ— æ³•ç›´æ¥è¿ç®—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-12"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;DECIMAL çš„â€œ9 ä½ = 4 å­—èŠ‚â€è®¾è®¡æ˜¯ç²¾åº¦ä¸æ•ˆç‡çš„ç»å…¸æƒè¡¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç²¾åº¦ä¿éšœ&lt;/strong&gt;ï¼šåè¿›åˆ¶ç›´æ¥æ˜ å°„ï¼Œæœç»æµ®ç‚¹è¯¯å·®ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´é«˜æ•ˆ&lt;/strong&gt;ï¼š32 ä½äºŒè¿›åˆ¶å®Œç¾è¦†ç›– 10â¹ ç§çŠ¶æ€ï¼Œä½™æ•°åˆ†ç»„è¿›ä¸€æ­¥å‹ç¼©ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—å‹å¥½&lt;/strong&gt;ï¼šå¯¹é½ CPU å­—é•¿ï¼ŒåŠ é€Ÿæ•°å€¼è¿ç®—ã€‚
å› æ­¤ï¼Œåœ¨é‡‘èã€è®¡é‡ç­‰éœ€ç»å¯¹ç²¾ç¡®çš„åœºæ™¯ä¸­ï¼ŒDECIMAL æ˜¯æ›´å¯é çš„é€‰æ‹©ï¼Œå°½ç®¡å…¶è®¡ç®—å¼€é”€ç•¥é«˜äºæµ®ç‚¹ç±»å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="decimal-å­˜å‚¨"&gt;DECIMAL å­˜å‚¨
&lt;/h2&gt;&lt;p&gt;MySQL çš„ &lt;code&gt;DECIMAL&lt;/code&gt; ç±»å‹è™½ç„¶å¸¸è¢«æè¿°ä¸ºâ€œä»¥å­—ç¬¦ä¸²å½¢å¼å­˜å‚¨â€ï¼Œä½†å®é™…åº•å±‚é‡‡ç”¨çš„æ˜¯ &lt;strong&gt;ç´§å‡‘çš„äºŒè¿›åˆ¶å‹ç¼©æ ¼å¼&lt;/strong&gt;ï¼Œè€Œéç›´è§‚çš„å­—ç¬¦ç¼–ç ï¼ˆå¦‚ ASCII æˆ– UTF-8ï¼‰ã€‚è¿™ç§è®¾è®¡åœ¨ä¿éšœç²¾ç¡®åº¦çš„åŒæ—¶ï¼Œæ˜¾è‘—ä¼˜åŒ–äº†å­˜å‚¨æ•ˆç‡ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åŸç†å’Œå­˜å‚¨è§„åˆ™ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨æœºåˆ¶äºŒè¿›åˆ¶å‹ç¼©è€Œéå­—ç¬¦ç¼–ç "&gt;âš™ï¸ å­˜å‚¨æœºåˆ¶ï¼šäºŒè¿›åˆ¶å‹ç¼©è€Œéå­—ç¬¦ç¼–ç 
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;DECIMAL&lt;/code&gt; å¹¶éé€å­—ç¬¦å­˜å‚¨æ•°å­—ã€ç¬¦å·æˆ–å°æ•°ç‚¹ï¼Œè€Œæ˜¯å°†æ•°å€¼æ‹†åˆ†ä¸º &lt;strong&gt;æ•´æ•°å’Œå°æ•°éƒ¨åˆ†&lt;/strong&gt;ï¼ŒæŒ‰ &lt;strong&gt;9ä½åè¿›åˆ¶æ•°ä¸ºä¸€ç»„&lt;/strong&gt; å‹ç¼©ä¸ºäºŒè¿›åˆ¶å­˜å‚¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•´æ•°ä¸å°æ•°åˆ†ç¦»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¾‹å¦‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; DECIMAL(16,4)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å­˜å‚¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; 1234567890.1234
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ—¶ï¼Œå®é™…å­˜å‚¨ä¸‰ä¸ªæ•´æ•°ï¼š
- æ•´æ•°éƒ¨åˆ†ï¼š&lt;code&gt;1&lt;/code&gt;ï¼ˆé«˜ä½ï¼‰ã€&lt;code&gt;234567890&lt;/code&gt;ï¼ˆä¸­æ®µï¼‰
- å°æ•°éƒ¨åˆ†ï¼š&lt;code&gt;1234&lt;/code&gt;
- &lt;strong&gt;ä¸å­˜å‚¨å°æ•°ç‚¹&lt;/strong&gt;ï¼Œå…¶ä½ç½®ç”±å®šä¹‰ &lt;code&gt;(M,D)&lt;/code&gt; ä¸­çš„ &lt;code&gt;D&lt;/code&gt; éšå«ç¡®å®šã€‚
2. &lt;strong&gt;9ä½åè¿›åˆ¶æ•° â†’ 4å­—èŠ‚äºŒè¿›åˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ç»„ &lt;strong&gt;9ä½åè¿›åˆ¶æ•°&lt;/strong&gt;ï¼ˆèŒƒå›´ &lt;code&gt;0~999,999,999&lt;/code&gt;ï¼‰éœ€ç”¨ 32 ä½ï¼ˆ4 å­—èŠ‚ï¼‰äºŒè¿›åˆ¶è¡¨ç¤ºï¼ˆå›  &lt;code&gt;2^{32} = 4.29 \times 10^9 &amp;gt; 10^9&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼šæ¯”é€å­—ç¬¦å­˜å‚¨ï¼ˆæ¯å­—ç¬¦ 1 å­—èŠ‚ï¼‰èŠ‚çœç©ºé—´ã€‚ä¾‹å¦‚ï¼š
&lt;ul&gt;
&lt;li&gt;å­—ç¬¦ä¸²å­˜å‚¨ &lt;code&gt;&amp;quot;123456789&amp;quot;&lt;/code&gt; éœ€ 9 å­—èŠ‚ï¼Œè€Œ &lt;code&gt;DECIMAL&lt;/code&gt; ä»…éœ€ 4 å­—èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨ç©ºé—´è®¡ç®—è§„åˆ™"&gt;ğŸ“Š å­˜å‚¨ç©ºé—´è®¡ç®—è§„åˆ™
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨ç©ºé—´ç”± &lt;strong&gt;æ•´æ•°éƒ¨åˆ†&lt;/strong&gt; å’Œ &lt;strong&gt;å°æ•°éƒ¨åˆ†&lt;/strong&gt; åˆ†åˆ«è®¡ç®—ï¼Œè§„åˆ™å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç»„ä¸å­—èŠ‚åˆ†é…&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä½æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ‰€éœ€å­—èŠ‚&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1â€“2 ä½&lt;/td&gt;
&lt;td&gt;1 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3â€“4 ä½&lt;/td&gt;
&lt;td&gt;2 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5â€“6 ä½&lt;/td&gt;
&lt;td&gt;3 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7â€“9 ä½&lt;/td&gt;
&lt;td&gt;4 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®é™…æ¡ˆä¾‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;DECIMAL(10,2)
&lt;/code&gt;&lt;/pre&gt;**ï¼ˆå¦‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; 12345678.12
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt; ï¼‰:
- æ•´æ•°éƒ¨åˆ† `12345678`ï¼ˆ8ä½ï¼‰â†’ éœ€ 4 å­—èŠ‚ï¼ˆ7-9ä½ç»„ï¼‰
- å°æ•°éƒ¨åˆ† `12`ï¼ˆ2ä½ï¼‰â†’ éœ€ 1 å­—èŠ‚
- **æ€»è®¡ï¼š5 å­—èŠ‚**ï¼ˆä¸å«ç¬¦å·å’Œå°æ•°ç‚¹ï¼‰ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—ç¬¦ä¸²å­˜å‚¨å¯¹æ¯”&lt;/strong&gt;ï¼šè‹¥å­˜ä¸º &lt;code&gt;&amp;quot;12345678.12&amp;quot;&lt;/code&gt; éœ€ 11 å­—èŠ‚ï¼ˆ10æ•°å­—+1å°æ•°ç‚¹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;ç¬¦å·ä½çš„å¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å ç”¨é¢å¤–å­—èŠ‚
ï¼è´Ÿæ•°é€šè¿‡
äºŒè¿›åˆ¶è¡¥ç 
è¡¨ç¤ºï¼ˆæœ€é«˜ä½ä¸ºç¬¦å·ä½ï¼‰ï¼Œä¸æ•´æ•°å…±ç”¨å­˜å‚¨ç©ºé—´ã€‚
&lt;ul&gt;
&lt;li&gt;ä¾‹å¦‚ &lt;code&gt;-123&lt;/code&gt; å­˜å‚¨ä¸ºè¡¥ç æ ¼å¼ï¼Œæ— éœ€å•ç‹¬å­˜å‚¨ &lt;code&gt;-&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å­—ç¬¦ä¸²å­˜å‚¨çš„å¯¹æ¯”"&gt;âš–ï¸ ä¸å­—ç¬¦ä¸²å­˜å‚¨çš„å¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å­˜å‚¨æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹ &lt;code&gt;123.45&lt;/code&gt; çš„å­˜å‚¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç©ºé—´å ç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—ç¬¦ä¸²ï¼ˆå¦‚ VARCHARï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨ &lt;code&gt;'123.45'&lt;/code&gt;ï¼ˆå«å°æ•°ç‚¹ï¼‰&lt;/td&gt;
&lt;td&gt;6 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;DECIMAL(5,2)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•´æ•° &lt;code&gt;123&lt;/code&gt;ï¼ˆ3ä½â†’2å­—èŠ‚ï¼‰+ å°æ•° &lt;code&gt;45&lt;/code&gt;ï¼ˆ2ä½â†’1å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;3 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼š&lt;code&gt;DECIMAL&lt;/code&gt; æ¯”å­—ç¬¦ä¸²èŠ‚çœ &lt;strong&gt;50% ä»¥ä¸Šç©ºé—´&lt;/strong&gt;ï¼Œä¸”æ”¯æŒé«˜æ•ˆæ•°å€¼è®¡ç®—ï¼ˆæ— éœ€å­—ç¬¦ä¸²è½¬æ¢ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“decimal-çš„è®¾è®¡å“²å­¦"&gt;ğŸ’ æ€»ç»“ï¼šDECIMAL çš„è®¾è®¡å“²å­¦
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç²¾åº¦ä¼˜å…ˆ&lt;/strong&gt;ï¼šé€šè¿‡æ•´æ•°åˆ†ç»„é¿å…æµ®ç‚¹è¯¯å·®ï¼Œä¿éšœé‡‘èç­‰åœºæ™¯çš„ç»å¯¹ç²¾ç¡®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´é«˜æ•ˆ&lt;/strong&gt;ï¼šäºŒè¿›åˆ¶å‹ç¼©å¤§å¹…å‡å°‘å­˜å‚¨å¼€é”€ï¼ˆæ¯”å­—ç¬¦ä¸²èŠ‚çœ 50%~70%ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—ä¼˜åŒ–&lt;/strong&gt;ï¼šç›´æ¥åŸºäºæ•´æ•°è¿ç®—ï¼Œé¿å…å­—ç¬¦ä¸²è§£æçš„æ€§èƒ½æŸè€—ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å› æ­¤ï¼Œ&lt;code&gt;DECIMAL&lt;/code&gt; çš„â€œç±»å­—ç¬¦ä¸²â€æè¿°ä»…æŒ‡å…¶é€»è¾‘å¤„ç†æ–¹å¼ï¼ˆåè¿›åˆ¶é€ä½å¤„ç†ï¼‰ï¼Œç‰©ç†å­˜å‚¨å®åˆ™æ˜¯é«˜åº¦ä¼˜åŒ–çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä½•å®ƒèƒ½åœ¨æ•°æ®åº“ä¸­è¢«é«˜æ•ˆå­˜å‚¨å’Œè®¡ç®—çš„æ ¸å¿ƒåŸå› ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="datetime--timestamp"&gt;DateTime &amp;amp; TimeStamp
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯MySQLä¸­ &lt;code&gt;DATETIME&lt;/code&gt; ä¸ &lt;code&gt;TIMESTAMP&lt;/code&gt; ç±»å‹çš„è¯¦ç»†å¯¹æ¯”ï¼Œç»“åˆå­˜å‚¨æœºåˆ¶ã€æ—¶åŒºå¤„ç†ã€æ€§èƒ½ç­‰ç»´åº¦ç»¼åˆåˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«æ¦‚è§ˆ"&gt;â° &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«æ¦‚è§ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;DATETIME&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;TIMESTAMP&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥å­˜å‚¨æ—¶é—´å­—é¢é‡ï¼ˆYYYY-MM-DD HH:MM:SSï¼‰&lt;/td&gt;
&lt;td&gt;å­˜å‚¨UTCæ—¶é—´æˆ³ï¼ˆè‡ª1970-01-01çš„ç§’æ•°/æ¯«ç§’ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¶é—´èŒƒå›´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;1000-01-01 00:00:00&lt;/code&gt; ~ &lt;code&gt;9999-12-31 23:59:59&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;1970-01-01 00:00:01 UTC&lt;/code&gt; ~ &lt;code&gt;2038-01-19 03:14:07 UTC&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¶åŒºå¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å›ºå®šå­˜å‚¨è¾“å…¥å€¼ï¼Œ&lt;strong&gt;ä¸å—æ—¶åŒºå½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨è½¬æ¢ä¸ºUTCå­˜å‚¨ï¼Œ&lt;strong&gt;æŸ¥è¯¢æ—¶æŒ‰ä¼šè¯æ—¶åŒºè½¬æ¢&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨ç©ºé—´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;5~8å­—èŠ‚ï¼ˆå«å°æ•°ç§’ï¼‰&lt;/td&gt;
&lt;td&gt;4~7å­—èŠ‚ï¼ˆå«å°æ•°ç§’ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é»˜è®¤è¡Œä¸º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é»˜è®¤å€¼ä¸º&lt;code&gt;NULL&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é»˜è®¤å€¼ä¸ºå½“å‰æ—¶é—´ï¼ˆ&lt;code&gt;CURRENT_TIMESTAMP&lt;/code&gt;ï¼‰ï¼Œæ”¯æŒè‡ªåŠ¨æ›´æ–°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;2038å¹´é—®é¢˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;2038å¹´åæº¢å‡ºï¼ˆ32ä½æ•´æ•°é™åˆ¶ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æŠ€æœ¯ç»†èŠ‚è§£æ-1"&gt;âš™ï¸ &lt;strong&gt;å…³é”®æŠ€æœ¯ç»†èŠ‚è§£æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å­˜å‚¨ç»“æ„ä¸ç©ºé—´å ç”¨"&gt;&lt;strong&gt;å­˜å‚¨ç»“æ„ä¸ç©ºé—´å ç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DATETIME&lt;/strong&gt;
äºŒè¿›åˆ¶å­˜å‚¨ç»“æ„ï¼š
&lt;ul&gt;
&lt;li&gt;1ä½ç¬¦å·ä½ + å¹´ï¼ˆ4ä½Ã—13ï¼‰+ æœˆï¼ˆ5ä½ï¼‰+ æ—¥ï¼ˆ5ä½ï¼‰+ æ—¶ï¼ˆ5ä½ï¼‰+ åˆ†ï¼ˆ6ä½ï¼‰+ ç§’ï¼ˆ6ä½ï¼‰+ å¾®ç§’ï¼ˆ0~24ä½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ— å°æ•°ç§’æ—¶å 5å­—èŠ‚ï¼Œå«å¾®ç§’æ—¶æœ€é«˜å 8å­—èŠ‚ï¼ˆå¦‚&lt;code&gt;DATETIME(6)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TIMESTAMP&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;32ä½æ— ç¬¦å·æ•´æ•°å­˜å‚¨UTCç§’æ•°ï¼Œå¾®ç§’éƒ¨åˆ†é¢å¤–å ç”¨ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;æ— å°æ•°ç§’æ—¶å 4å­—èŠ‚ï¼Œå«å¾®ç§’æ—¶æœ€é«˜å 7å­—èŠ‚ï¼ˆå¦‚&lt;code&gt;TIMESTAMP(6)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2038å¹´é—®é¢˜&lt;/strong&gt;ï¼š32ä½æ•´æ•°æœ€å¤§å€¼ä¸º&lt;code&gt;2^31-1&lt;/code&gt;ï¼ˆçº¦68å¹´ï¼‰ï¼Œå¯¼è‡´2038å¹´åæº¢å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ—¶åŒºå¤„ç†æœºåˆ¶"&gt;&lt;strong&gt;æ—¶åŒºå¤„ç†æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DATETIME&lt;/strong&gt;
å­˜å‚¨è¾“å…¥çš„æ—¶é—´å­—é¢é‡ï¼Œâ€‹&lt;strong&gt;ä¸æ¶‰åŠæ—¶åŒºè½¬æ¢&lt;/strong&gt;ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SET time_zone = &amp;#39;+00:00&amp;#39;;
INSERT INTO table (datetime_col) VALUES (&amp;#39;2023-01-01 12:00:00&amp;#39;);
SET time_zone = &amp;#39;+08:00&amp;#39;;
SELECT datetime_col; -- è¾“å‡ºï¼š2023-01-01 12:00:00ï¼ˆä¸å˜ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TIMESTAMP&lt;/strong&gt;
å†™å…¥æ—¶è‡ªåŠ¨ä»&lt;strong&gt;ä¼šè¯æ—¶åŒº â†’ UTC&lt;/strong&gt;ï¼ŒæŸ¥è¯¢æ—¶&lt;strong&gt;UTC â†’ ä¼šè¯æ—¶åŒº&lt;/strong&gt;ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SET time_zone = &amp;#39;+00:00&amp;#39;;
INSERT INTO table (timestamp_col) VALUES (NOW()); -- å­˜å‚¨ä¸ºUTCæ—¶é—´
SET time_zone = &amp;#39;+08:00&amp;#39;;
SELECT timestamp_col; -- è¾“å‡ºï¼šåŸå§‹æ—¶é—´+8å°æ—¶ï¼ˆå¦‚2023-01-01 20:00:00ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ€§èƒ½ä¸è‡ªåŠ¨æ›´æ–°"&gt;&lt;strong&gt;æ€§èƒ½ä¸è‡ªåŠ¨æ›´æ–°&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†™å…¥æ€§èƒ½&lt;/strong&gt;
&lt;code&gt;TIMESTAMP&lt;/code&gt;å› æ—¶åŒºè½¬æ¢æ¯”&lt;code&gt;DATETIME&lt;/code&gt;æ…¢5%~10%ï¼Œé«˜å¹¶å‘å†™å…¥åœºæ™¯ä¼˜å…ˆé€‰&lt;code&gt;DATETIME&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‡ªåŠ¨æ›´æ–°&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; TIMESTAMP
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ”¯æŒè‡ªåŠ¨æ›´æ–°ä¸ºå½“å‰æ—¶é—´ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE TABLE example (
modified_ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
); -- æ•°æ®ä¿®æ”¹æ—¶è‡ªåŠ¨åˆ·æ–°
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;DATETIME
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;éœ€æ‰‹åŠ¨é…ç½®æ­¤åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h4 id="ç´¢å¼•æ•ˆç‡"&gt;&lt;strong&gt;ç´¢å¼•æ•ˆç‡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;èŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚
&lt;pre tabindex="0"&gt;&lt;code&gt;WHERE time_col &amp;gt; &amp;#39;2024-01-01&amp;#39;
&lt;/code&gt;&lt;/pre&gt;ï¼‰æ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DATETIME&lt;/code&gt;æ— éœ€æ—¶åŒºè½¬æ¢ï¼Œ&lt;strong&gt;ç´¢å¼•æ‰«æé€Ÿåº¦å¿«15%~20%&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TIMESTAMP&lt;/code&gt;éœ€åå‘æ—¶åŒºè½¬æ¢ï¼Œå¢åŠ CPUå¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—-1"&gt;ğŸ“Š &lt;strong&gt;åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å•ä¸€æ—¶åŒºç³»ç»Ÿï¼ˆå¦‚æœ¬åœ°æ—¥å¿—ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… DATETIME&lt;/td&gt;
&lt;td&gt;é¿å…æ—¶åŒºè½¬æ¢å¼€é”€ï¼Œæ”¯æŒæ›´å¹¿æ—¶é—´èŒƒå›´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤šæ—¶åŒºåº”ç”¨ï¼ˆå¦‚è·¨å¢ƒç”µå•†ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… TIMESTAMP&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨æ—¶åŒºè½¬æ¢ç®€åŒ–å¼€å‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é«˜å¹¶å‘å†™å…¥ï¼ˆå¦‚IoTè®¾å¤‡ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… DATETIME&lt;/td&gt;
&lt;td&gt;å†™å…¥æ€§èƒ½æ›´é«˜ï¼Œæ— æ—¶åŒºè½¬æ¢å»¶è¿Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;éœ€è¦è‡ªåŠ¨è®°å½•ä¿®æ”¹æ—¶é—´&lt;/td&gt;
&lt;td&gt;âœ… TIMESTAMP&lt;/td&gt;
&lt;td&gt;å†…ç½®&lt;code&gt;ON UPDATE&lt;/code&gt;ç‰¹æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­˜å‚¨å†å²æˆ–æœªæ¥æ—¥æœŸï¼ˆå¦‚åˆåŒï¼‰&lt;/td&gt;
&lt;td&gt;âœ… DATETIME&lt;/td&gt;
&lt;td&gt;æ”¯æŒå…¬å…ƒ1000å¹´~9999å¹´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2038å¹´åä»éœ€ä½¿ç”¨çš„ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;âœ… DATETIME æˆ– BIGINT&lt;/td&gt;
&lt;td&gt;é¿å…&lt;code&gt;TIMESTAMP&lt;/code&gt;æº¢å‡º&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é¿å‘å»ºè®®"&gt;âš ï¸ &lt;strong&gt;é¿å‘å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ—¶åŒºä¸€è‡´æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;TIMESTAMP&lt;/code&gt;æ—¶ï¼Œç¡®ä¿æ‰€æœ‰å®¢æˆ·ç«¯ä¼šè¯æ—¶åŒºè®¾ç½®æ­£ç¡®ï¼ˆå¦‚&lt;code&gt;SET time_zone = '+08:00'&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²æ—¶ï¼Œåœ¨åº”ç”¨å±‚ç»Ÿä¸€æ—¶åŒºå¤„ç†é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;éå¿…è¦ä¸ä½¿ç”¨å°æ•°ç§’ï¼ˆå¦‚&lt;code&gt;DATETIME(6)&lt;/code&gt;ï¼‰ï¼Œé¿å…é¢å¤–å­˜å‚¨å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜å…ˆé€‰&lt;code&gt;TIMESTAMP&lt;/code&gt;èŠ‚çœç©ºé—´ï¼ˆç™¾ä¸‡æ•°æ®å¯çœ25%ç©ºé—´ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;éœ€æè‡´æ€§èƒ½æˆ–è§£å†³2038é—®é¢˜ï¼šç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;BIGINT
&lt;/code&gt;&lt;/pre&gt;å­˜å‚¨Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’çº§ï¼‰ï¼Œç”±åº”ç”¨å±‚å¤„ç†æ ¼å¼å’Œæ—¶åŒºã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE TABLE events (
event_time BIGINT -- å­˜å‚¨æ¯«ç§’çº§æ—¶é—´æˆ³
);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-13"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰&lt;code&gt;DATETIME&lt;/code&gt;&lt;/strong&gt;ï¼šéœ€å¤§æ—¶é—´èŒƒå›´ã€å•ä¸€æ—¶åŒºã€é«˜æ€§èƒ½å†™å…¥çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰&lt;code&gt;TIMESTAMP&lt;/code&gt;&lt;/strong&gt;ï¼šéœ€è‡ªåŠ¨æ—¶åŒºè½¬æ¢ã€è®°å½•ä¿®æ”¹æ—¶é—´ä¸”ä¸è¶…2038å¹´çš„å¤šæ—¶åŒºç³»ç»Ÿã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»ˆæç­–ç•¥&lt;/strong&gt;ï¼šå…¨çƒåŒ–é«˜å¹¶å‘ç³»ç»Ÿæ¨è&lt;code&gt;BIGINT&lt;/code&gt;æ—¶é—´æˆ³+åº”ç”¨å±‚æ—¶åŒºå¤„ç†ï¼Œå…¼é¡¾æ€§èƒ½ä¸å¯ç»´æŠ¤æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="null--"&gt;Null &amp;amp; &amp;quot;&amp;quot;
&lt;/h2&gt;&lt;p&gt;åœ¨æ•°æ®åº“ä¸­ï¼Œ&lt;code&gt;NULL&lt;/code&gt;å’Œç©ºå­—ç¬¦ä¸²ï¼ˆ&lt;code&gt;''&lt;/code&gt;ï¼‰æ˜¯ä¸¤ç§å®Œå…¨ä¸åŒçš„æ¦‚å¿µï¼Œå®ƒä»¬åœ¨è¯­ä¹‰ã€å­˜å‚¨ã€æŸ¥è¯¢é€»è¾‘å’Œå®é™…åº”ç”¨ä¸­å‡æœ‰æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯ç»¼åˆå¯¹æ¯”åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸è¯­ä¹‰å·®å¼‚"&gt;ğŸ§  &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸è¯­ä¹‰å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;NULL&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç©ºå­—ç¬¦ä¸² (&lt;code&gt;''&lt;/code&gt;)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºâ€œæœªçŸ¥ã€ç¼ºå¤±æˆ–ä¸é€‚ç”¨â€çš„å€¼&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºâ€œç¡®å®šçš„ã€é•¿åº¦ä¸º0çš„å­—ç¬¦ä¸²â€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— ç±»å‹ï¼ˆç‰¹æ®Šæ ‡è®°ï¼‰&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²ç±»å‹ï¼ˆæœ‰æ•ˆå€¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯­ä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®ä¸å­˜åœ¨æˆ–æœªçŸ¥ï¼ˆå¦‚æœªå¡«å†™çš„æ‰‹æœºå·ï¼‰&lt;/td&gt;
&lt;td&gt;æ•°æ®å­˜åœ¨ä½†å†…å®¹ä¸ºç©ºï¼ˆå¦‚ç”¨æˆ·æ•…æ„ç•™ç©ºï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¯”è¾ƒé€»è¾‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»»ä½•ä¸&lt;code&gt;NULL&lt;/code&gt;çš„æ¯”è¾ƒç»“æœå‡ä¸º&lt;code&gt;UNKNOWN&lt;/code&gt;ï¼ˆéœ€ç”¨&lt;code&gt;IS NULL&lt;/code&gt;åˆ¤æ–­ï¼‰&lt;/td&gt;
&lt;td&gt;å¯æ­£å¸¸ä½¿ç”¨&lt;code&gt;= ''&lt;/code&gt;æˆ–&lt;code&gt;!= ''&lt;/code&gt;è¿›è¡Œæ¯”è¾ƒ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨ä¸ç©ºé—´å ç”¨"&gt;ğŸ’¾ &lt;strong&gt;å­˜å‚¨ä¸ç©ºé—´å ç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;NULL&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç©ºå­—ç¬¦ä¸² (&lt;code&gt;''&lt;/code&gt;)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…éœ€ä¸€ä¸ªâ€œNULLæ ‡è®°ä½â€ï¼ˆé€šå¸¸1 bitï¼‰&lt;/td&gt;
&lt;td&gt;å ç”¨å­˜å‚¨ç©ºé—´ï¼ˆè®°å½•é•¿åº¦æ ‡è¯†ï¼Œè‡³å°‘1å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç©ºé—´å ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä½ï¼ˆInnoDBä¸­å¯å˜é•¿åº¦å­—æ®µé™¤å¤–ï¼‰&lt;/td&gt;
&lt;td&gt;å›ºå®šå ç”¨ç©ºé—´ï¼ˆå¦‚&lt;code&gt;VARCHAR&lt;/code&gt;å­—æ®µéœ€å­˜é•¿åº¦ä¿¡æ¯ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;INSERT INTO users (phone) VALUES (NULL)&lt;/code&gt; â†’ æ ‡è®°ä½ä¸ºNULL&lt;/td&gt;
&lt;td&gt;&lt;code&gt;INSERT INTO users (phone) VALUES ('')&lt;/code&gt; â†’ å­˜å‚¨é•¿åº¦0çš„å­—ç¬¦ä¸²&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æŸ¥è¯¢ä¸å‡½æ•°è¡Œä¸ºå·®å¼‚"&gt;ğŸ” &lt;strong&gt;æŸ¥è¯¢ä¸å‡½æ•°è¡Œä¸ºå·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æŸ¥è¯¢æ¡ä»¶"&gt;&lt;strong&gt;æŸ¥è¯¢æ¡ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;NULLï¼šå¿…é¡»ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;IS NULL
&lt;/code&gt;&lt;/pre&gt;æˆ–
&lt;pre tabindex="0"&gt;&lt;code&gt;IS NOT NULL
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM users WHERE phone IS NULL; -- æ‰¾å‡ºæœªå¡«å†™æ‰‹æœºå·çš„ç”¨æˆ·
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ç©ºå­—ç¬¦ä¸²ï¼šå¯ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;= &amp;#39;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;æˆ–
&lt;pre tabindex="0"&gt;&lt;code&gt;!= &amp;#39;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM users WHERE phone = &amp;#39;&amp;#39;; -- æ‰¾å‡ºæ‰‹æœºå·ç•™ç©ºçš„ç”¨æˆ·
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="èšåˆå‡½æ•°å¤„ç†"&gt;&lt;strong&gt;èšåˆå‡½æ•°å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‡½æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¯¹NULLçš„å¤„ç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¯¹ç©ºå­—ç¬¦ä¸²çš„å¤„ç†&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;COUNT(column)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¿½ç•¥NULLå€¼ï¼ˆä¸è®¡æ•°ï¼‰&lt;/td&gt;
&lt;td&gt;è®¡å…¥è®¡æ•°ï¼ˆè§†ä¸ºæœ‰æ•ˆå€¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;SUM()/AVG()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¿½ç•¥NULLå€¼ï¼ˆä¸å‚ä¸è®¡ç®—ï¼‰&lt;/td&gt;
&lt;td&gt;è§†ä¸º0å‚ä¸è®¡ç®—ï¼ˆå¯èƒ½å¯¼è‡´é€»è¾‘é”™è¯¯ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CONCAT()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸NULLè¿ç®—ç»“æœæ’ä¸ºNULL&lt;/td&gt;
&lt;td&gt;æ­£å¸¸å‚ä¸è¿ç®—ï¼ˆå¦‚&lt;code&gt;CONCAT('a', '') â†’ 'a'&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ç´¢å¼•ä¸æ€§èƒ½"&gt;&lt;strong&gt;ç´¢å¼•ä¸æ€§èƒ½&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;NULLï¼š
&lt;ul&gt;
&lt;li&gt;é»˜è®¤ä¸è¢«Bæ ‘ç´¢å¼•åŒ…å«ï¼ˆé™¤éåˆ›å»ºè¿‡æ»¤ç´¢å¼•ï¼Œå¦‚&lt;code&gt;WHERE column IS NOT NULL&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IS NULL&lt;/code&gt;æ¡ä»¶å¯èƒ½å¯¼è‡´å…¨è¡¨æ‰«æ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç©ºå­—ç¬¦ä¸²ï¼š
&lt;ul&gt;
&lt;li&gt;å¯è¢«æ­£å¸¸ç´¢å¼•ï¼Œæ”¯æŒé«˜æ•ˆæŸ¥è¯¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åº”ç”¨åœºæ™¯-1"&gt;ğŸ› ï¸ &lt;strong&gt;å®é™…åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èé€‰æ‹©&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¡¨ç¤ºæœªçŸ¥/ç¼ºå¤±æ•°æ®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… NULL&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·æœªå¡«å†™æ‰‹æœºå·ï¼ˆæœªçŸ¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¡¨ç¤ºæ˜ç¡®ç•™ç©ºçš„å­—æ®µ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç©ºå­—ç¬¦ä¸² (&lt;code&gt;''&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·ä¸»åŠ¨æ¸…ç©ºâ€œä¸ªæ€§ç­¾åâ€å­—æ®µï¼ˆå·²çŸ¥æ— å†…å®¹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤–é”®å…³è”ï¼ˆæ— å…³è”è®°å½•ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… NULL&lt;/td&gt;
&lt;td&gt;è®¢å•è¡¨ä¸­â€œé€€è´§IDâ€å­—æ®µï¼ˆæœªé€€è´§æ—¶æ— å…³è”è®°å½•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¿…å¡«å­—æ®µçš„é»˜è®¤å€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç©ºå­—ç¬¦ä¸² (&lt;code&gt;''&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·åœ°å€å­—æ®µè®¾ä¸º&lt;code&gt;NOT NULL DEFAULT ''&lt;/code&gt;ï¼ˆé¿å…NULLæ£€æŸ¥é€»è¾‘ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šæ•°æ®åº“å…¼å®¹åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ æ³¨æ„å·®å¼‚&lt;/td&gt;
&lt;td&gt;Oracleå°†&lt;code&gt;''&lt;/code&gt;è§†ä¸ºNULLï¼Œéœ€ç»Ÿä¸€è®¾è®¡é¿å…è·¨å¹³å°é—®é¢˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é¿å‘æŒ‡å—"&gt;âš ï¸ &lt;strong&gt;é¿å‘æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¦æ­¢æ··æ·†æ¯”è¾ƒ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;é”™è¯¯ï¼š&lt;code&gt;SELECT * FROM table WHERE column = NULL&lt;/code&gt;ï¼ˆæ°¸è¿œè¿”å›ç©ºï¼‰&lt;/li&gt;
&lt;li&gt;æ­£ç¡®ï¼š&lt;code&gt;SELECT * FROM table WHERE column IS NULL&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ä¼˜åŒ–å»ºè®®&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹å«NULLçš„åˆ—åˆ›å»ºè¿‡æ»¤ç´¢å¼•ï¼š&lt;code&gt;CREATE INDEX idx ON table (col) WHERE col IS NOT NULL;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨å±‚å¤„ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;COALESCE(phone, 'N/A')&lt;/code&gt;å°†NULLè½¬ä¸ºå‹å¥½æç¤º&lt;/li&gt;
&lt;li&gt;ç©ºå­—ç¬¦ä¸²æ£€æŸ¥ï¼š&lt;code&gt;if (str !== null &amp;amp;&amp;amp; str.length === 0)&lt;/code&gt;ï¼ˆJavaScriptç¤ºä¾‹ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡è§„èŒƒ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ˜ç¡®å­—æ®µè¯­ä¹‰ï¼šç”¨NULLè¡¨ç¤ºâ€œæœªçŸ¥â€ï¼Œç”¨&lt;code&gt;''&lt;/code&gt;è¡¨ç¤ºâ€œæ— å†…å®¹â€&lt;/li&gt;
&lt;li&gt;å…³é”®å­—æ®µï¼ˆå¦‚ç”¨æˆ·IDï¼‰è®¾ä¸º&lt;code&gt;NOT NULL&lt;/code&gt;ï¼Œé¿å…NULLæ±¡æŸ“ä¸šåŠ¡é€»è¾‘&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-14"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NULLæ˜¯â€œæœªçŸ¥çš„è¿·é›¾â€&lt;/strong&gt;ï¼ˆæ•°æ®ç¼ºå¤±æ—¶ä½¿ç”¨ï¼‰ï¼Œ&lt;strong&gt;ç©ºå­—ç¬¦ä¸²æ˜¯â€œç©ºç™½çš„ç”»å¸ƒâ€&lt;/strong&gt;ï¼ˆå†…å®¹æ˜ç¡®ä¸ºç©ºæ—¶ä½¿ç”¨ï¼‰ã€‚
æ­£ç¡®åŒºåˆ†äºŒè€…ï¼Œèƒ½é¿å…æ•°æ®æ­§ä¹‰ã€æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œå¹¶å‡å°‘è·¨æ•°æ®åº“å…¼å®¹æ€§é—®é¢˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Mysqlã€‘innoDB</title><link>https://dyhes.github.io/p/mysqlinnodb/</link><pubDate>Sat, 21 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/mysqlinnodb/</guid><description>&lt;h2 id="å­˜å‚¨å¼•æ“"&gt;å­˜å‚¨å¼•æ“
&lt;/h2&gt;&lt;p&gt;å­˜å‚¨å¼•æ“æ˜¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£æ•°æ®çš„ç‰©ç†å­˜å‚¨ã€æ£€ç´¢ã€ç»„ç»‡å’Œç®¡ç†ã€‚å®ƒå……å½“æ•°æ®åº“é€»è¾‘æ¨¡å‹ï¼ˆå¦‚è¡¨ã€è¡Œã€åˆ—ï¼‰ä¸åº•å±‚æ–‡ä»¶ç³»ç»Ÿä¹‹é—´çš„æ¡¥æ¢ï¼Œå†³å®šäº†æ•°æ®å¦‚ä½•å†™å…¥ç£ç›˜ã€å¦‚ä½•è¢«è¯»å–ä»¥åŠæ”¯æŒå“ªäº›åŠŸèƒ½ç‰¹æ€§ã€‚ä»¥ä¸‹æ˜¯å­˜å‚¨å¼•æ“çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="æ ¸å¿ƒåŠŸèƒ½ä¸ä½œç”¨"&gt;æ ¸å¿ƒåŠŸèƒ½ä¸ä½œç”¨
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å­˜å‚¨ä¸ç»„ç»‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®šä¹‰æ•°æ®çš„ç‰©ç†å­˜å‚¨ç»“æ„ï¼ˆå¦‚æ–‡ä»¶ã€é¡µã€å—ï¼‰ï¼Œä¾‹å¦‚ï¼š
&lt;ul&gt;
&lt;li&gt;InnoDB ä½¿ç”¨ &lt;code&gt;B+æ ‘&lt;/code&gt; ç´¢å¼•ç»“æ„ï¼Œæ•°æ®æŒ‰é¡µï¼ˆPageï¼‰å­˜å‚¨ï¼›&lt;/li&gt;
&lt;li&gt;MyISAM å°†æ•°æ®ï¼ˆ&lt;code&gt;.MYD&lt;/code&gt; æ–‡ä»¶ï¼‰å’Œç´¢å¼•ï¼ˆ&lt;code&gt;.MYI&lt;/code&gt; æ–‡ä»¶ï¼‰åˆ†å¼€å­˜å‚¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æ£€ç´¢ä¸æŸ¥è¯¢ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®ç°ç´¢å¼•æœºåˆ¶ï¼ˆå¦‚ Bæ ‘ã€å“ˆå¸Œç´¢å¼•ï¼‰ï¼Œä¼˜åŒ–æŸ¥è¯¢æ•ˆç‡ã€‚&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚ï¼šMyISAM æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œé€‚åˆæ–‡æœ¬æœç´¢ï¼›InnoDB çš„è¡Œçº§é”æå‡é«˜å¹¶å‘æŸ¥è¯¢æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å†³å®šæ˜¯å¦æ”¯æŒ
ACID äº‹åŠ¡
ï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;InnoDB æ”¯æŒäº‹åŠ¡å›æ»šã€å´©æºƒæ¢å¤ï¼ˆé€šè¿‡ Redo/Undo Logï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;MyISAM ä¸æ”¯æŒäº‹åŠ¡ï¼Œä»…é€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ§åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç®¡ç†å¤šç”¨æˆ·åŒæ—¶è®¿é—®çš„å†²çªï¼š
&lt;ul&gt;
&lt;li&gt;InnoDB é‡‡ç”¨ &lt;strong&gt;è¡Œçº§é”&lt;/strong&gt; å’Œ MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;MyISAM ä»…æ”¯æŒ &lt;strong&gt;è¡¨çº§é”&lt;/strong&gt;ï¼Œå†™å…¥æ—¶ä¼šé˜»å¡æ•´ä¸ªè¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å®Œæ•´æ€§ä¸å®‰å…¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒå¤–é”®çº¦æŸã€æ•°æ®åŠ å¯†ç­‰æœºåˆ¶ã€‚ä¾‹å¦‚ InnoDB é€šè¿‡å¤–é”®ä¿è¯å…³è”è¡¨çš„æ•°æ®ä¸€è‡´æ€§ï¼ŒMyISAM æ— æ­¤åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="ä¸ºä»€ä¹ˆå­˜å‚¨å¼•æ“é‡è¦"&gt;ä¸ºä»€ä¹ˆå­˜å‚¨å¼•æ“é‡è¦ï¼Ÿ
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;ï¼šç›´æ¥å†³å®šè¯»å†™é€Ÿåº¦ã€å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚ä¾‹å¦‚ Memory å¼•æ“å°†æ•°æ®å…¨ç½®å†…å­˜ï¼Œè¯»å†™æå¿«ä½†é‡å¯åæ•°æ®ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;åŠŸèƒ½é€‚ï¼šä¸åŒä¸šåŠ¡éœ€æ±‚éœ€åŒ¹é…ä¸åŒå¼•æ“ï¼š
&lt;ul&gt;
&lt;li&gt;ç”µå•†äº¤æ˜“ï¼ˆé«˜å¹¶å‘+äº‹åŠ¡ï¼‰â†’ &lt;strong&gt;InnoDB&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®ä»“åº“ï¼ˆè¯»å¯†é›†å‹ï¼‰â†’ &lt;strong&gt;MyISAM&lt;/strong&gt;ï¼›
&lt;ul&gt;
&lt;li&gt;å®æ—¶ç¼“å­˜ â†’ &lt;strong&gt;Memory å¼•æ“&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§ä¸æˆæœ¬&lt;/strong&gt;ï¼šå¦‚åˆ†å¸ƒå¼åœºæ™¯å¯é€‰ Cassandraï¼ˆåˆ—å­˜å‚¨ï¼‰ï¼Œå¤§æ•°æ®åˆ†æé€‚ç”¨åˆ—å¼å¼•æ“ï¼ˆå¦‚ Apache Parquetï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="å¸¸è§å­˜å‚¨å¼•æ“å¯¹æ¯”"&gt;å¸¸è§å­˜å‚¨å¼•æ“å¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¼•æ“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;InnoDB&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº¤æ˜“ç³»ç»Ÿã€é«˜å¹¶å‘è¯»å†™&lt;/td&gt;
&lt;td&gt;æ”¯æŒäº‹åŠ¡ã€è¡Œçº§é”ã€å¤–é”®ã€å´©æºƒæ¢å¤&lt;/td&gt;
&lt;td&gt;å†™æ€§èƒ½ä½äº MyISAM&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;MyISAM&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»å¯†é›†å‹åº”ç”¨ï¼ˆCMSï¼‰&lt;/td&gt;
&lt;td&gt;é«˜è¯»å–é€Ÿåº¦ã€å…¨æ–‡ç´¢å¼•ã€å‹ç¼©å­˜å‚¨&lt;/td&gt;
&lt;td&gt;æ— äº‹åŠ¡ã€è¡¨çº§é”ã€æ˜“æŸå&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Memory&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸´æ—¶æ•°æ®/é«˜é€Ÿç¼“å­˜&lt;/td&gt;
&lt;td&gt;å†…å­˜å­˜å‚¨ã€å¾®ç§’çº§å“åº”&lt;/td&gt;
&lt;td&gt;æ•°æ®æ˜“å¤±ã€å®¹é‡å—é™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Archive&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†å²æ—¥å¿—å½’æ¡£&lt;/td&gt;
&lt;td&gt;é«˜å‹ç¼©æ¯”ã€èŠ‚çœç©ºé—´&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒç´¢å¼•ã€æŸ¥è¯¢æ•ˆç‡ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CSV&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®äº¤æ¢/å¯¼å…¥å¯¼å‡º&lt;/td&gt;
&lt;td&gt;æ–‡æœ¬æ ¼å¼ï¼ˆCSV æ–‡ä»¶ï¼‰ã€è·¨å¹³å°å…¼å®¹&lt;/td&gt;
&lt;td&gt;æ— ç´¢å¼•ã€ä¸æ”¯æŒäº‹åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="å¦‚ä½•é€‰æ‹©å­˜å‚¨å¼•æ“"&gt;å¦‚ä½•é€‰æ‹©å­˜å‚¨å¼•æ“ï¼Ÿ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡éœ€æ±‚&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;éœ€äº‹åŠ¡ï¼Ÿé€‰ &lt;strong&gt;InnoDB&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;åªéœ€é«˜é€Ÿè¯»ï¼Ÿé€‰ &lt;strong&gt;MyISAM&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ä¸´æ—¶æ•°æ®å¤„ç†ï¼Ÿé€‰ &lt;strong&gt;Memory&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç‰¹æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç»“æ„åŒ–æ•°æ® â†’ å…³ç³»å‹å¼•æ“ï¼ˆInnoDBï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;éç»“æ„åŒ–/æµ·é‡æ•°æ® â†’ NoSQL å¼•æ“ï¼ˆMongoDBã€Cassandraï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç³»ç»Ÿæ¶æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼ç³»ç»Ÿ â†’ &lt;strong&gt;Cassandra&lt;/strong&gt;ã€&lt;strong&gt;HBase&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;äº‘ç¯å¢ƒ â†’ &lt;strong&gt;Amazon Aurora&lt;/strong&gt;ï¼ˆè‡ªåŠ¨æ‰©å±•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="æœªæ¥å‘å±•è¶‹åŠ¿"&gt;æœªæ¥å‘å±•è¶‹åŠ¿
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‘åŸç”Ÿå¼•æ“&lt;/strong&gt;ï¼šå¦‚ Google Spannerï¼Œæ”¯æŒå…¨çƒåˆ†å¸ƒå¼éƒ¨ç½²ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ¨¡æ•°æ®åº“&lt;/strong&gt;ï¼šå•å¼•æ“æ”¯æŒæ–‡æ¡£ã€å›¾ã€é”®å€¼ç­‰å¤šç§æ¨¡å‹ï¼ˆå¦‚ ArangoDBï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AI ä¼˜åŒ–&lt;/strong&gt;ï¼šæœºå™¨å­¦ä¹ è‡ªåŠ¨è°ƒä¼˜ç´¢å¼•ã€æŸ¥è¯¢è®¡åˆ’ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–°ç¡¬ä»¶é€‚é…&lt;/strong&gt;ï¼šåˆ©ç”¨ NVMe SSDã€æŒä¹…å†…å­˜æå‡ I/O æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“"&gt;æ€»ç»“
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨å¼•æ“æ˜¯æ•°æ®åº“çš„â€œå‘åŠ¨æœºâ€ï¼Œå…¶è®¾è®¡ç›´æ¥å½±å“æ•°æ®å®‰å…¨æ€§ã€æ€§èƒ½åŠåŠŸèƒ½æ‰©å±•æ€§ã€‚ç†è§£ä¸åŒå¼•æ“çš„ç‰¹æ€§ï¼ˆå¦‚ InnoDB çš„äº‹åŠ¡ä¿éšœã€MyISAM çš„è¯»æ€§èƒ½ï¼‰ï¼Œç»“åˆä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚æ–¹æ¡ˆï¼Œæ˜¯æ•°æ®åº“ä¼˜åŒ–çš„å…³é”®ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;h2 id="myisam"&gt;MyISAM
&lt;/h2&gt;&lt;p&gt;MyISAMæ˜¯MySQLæ—©æœŸï¼ˆ5.5ç‰ˆæœ¬å‰ï¼‰çš„é»˜è®¤å­˜å‚¨å¼•æ“ï¼Œä»¥å…¶&lt;strong&gt;é«˜æ€§èƒ½è¯»å–ã€ä½å­˜å‚¨å¼€é”€å’Œç®€å•æ¶æ„&lt;/strong&gt;è‘—ç§°ï¼Œå°¤å…¶é€‚åˆè¯»å¯†é›†å‹åœºæ™¯ã€‚å°½ç®¡åœ¨äº‹åŠ¡æ”¯æŒå’Œå¹¶å‘å†™å…¥æ–¹é¢å¼±äºInnoDBï¼Œä½†åœ¨ç‰¹å®šéœ€æ±‚ä¸‹ä»æœ‰ä¸å¯æ›¿ä»£çš„ä»·å€¼ã€‚ä»¥ä¸‹æ˜¯æ·±åº¦è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§ä¸è®¾è®¡"&gt;âš™ï¸ æ ¸å¿ƒç‰¹æ€§ä¸è®¾è®¡
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ç»“æ„ä¸æ–‡ä»¶ç»„æˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸‰æ–‡ä»¶åˆ†ç¦»ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.frm&lt;/code&gt;ï¼šå­˜å‚¨è¡¨ç»“æ„å®šä¹‰ï¼ˆMySQL 8.0ååºŸå¼ƒï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.MYD&lt;/code&gt;ï¼ˆMyDataï¼‰ï¼šå­˜å‚¨å®é™…æ•°æ®&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.MYI&lt;/code&gt;ï¼ˆMyIndexï¼‰ï¼šå­˜å‚¨ç´¢å¼•æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶å¯åˆ†ç¦»å­˜æ”¾&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;DATA DIRECTORY&lt;/code&gt; å’Œ &lt;code&gt;INDEX DIRECTORY&lt;/code&gt; æŒ‡å®šè·¯å¾„ï¼Œåˆ†æ•£I/Oå‹åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å­˜å‚¨æ ¼å¼&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€è¡¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å›ºå®šé•¿åº¦å­—æ®µï¼Œå°¾éƒ¨ç©ºæ ¼è‡ªåŠ¨å»é™¤&lt;/td&gt;
&lt;td&gt;è¯»å–å¿«ã€æ˜“ç¼“å­˜ï¼Œä½†å ç”¨ç©ºé—´å¤§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ¨æ€è¡¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒå˜é•¿å­—æ®µï¼ˆå¦‚VARCHARï¼‰ï¼Œæ˜“ç¢ç‰‡åŒ–&lt;/td&gt;
&lt;td&gt;èŠ‚çœç©ºé—´ï¼Œéœ€å®šæœŸ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt; ä¼˜åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‹ç¼©è¡¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ &lt;code&gt;myisampack&lt;/code&gt; å·¥å…·ç”Ÿæˆï¼Œåªè¯»&lt;/td&gt;
&lt;td&gt;å½’æ¡£æ•°æ®ï¼Œå‡å°‘ç£ç›˜å ç”¨ï¼ˆå¦‚å†å²æ—¥å¿—ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;B-Treeç´¢å¼•&lt;/strong&gt;ï¼šä¸»é”®/äºŒçº§ç´¢å¼•å‡å­˜å‚¨æ•°æ®è¡Œç‰©ç†åœ°å€ï¼ˆéèšç°‡ç´¢å¼•ï¼‰ï¼ŒæŸ¥è¯¢éœ€ä¸¤æ¬¡å¯»å€ã€‚&lt;/li&gt;
&lt;li&gt;å…¨æ–‡ç´¢å¼•ï¼ˆFulltextï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;æ”¯æŒ &lt;code&gt;CHAR&lt;/code&gt;/&lt;code&gt;VARCHAR&lt;/code&gt;/&lt;code&gt;TEXT&lt;/code&gt; å­—æ®µçš„æ–‡æœ¬æœç´¢ï¼ˆ&lt;code&gt;MATCH ... AGAINST&lt;/code&gt;è¯­æ³•ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MySQL 5.6å‰å”¯ä¸€æ”¯æŒå…¨æ–‡ç´¢å¼•çš„å¼•æ“&lt;/strong&gt;ï¼Œ5.6åInnoDBæ‰è·Ÿè¿›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;R-Treeç´¢å¼•&lt;/strong&gt;ï¼šä¸“ç”¨äºç©ºé—´æ•°æ®ç±»å‹ï¼ˆå¦‚GISåæ ‡ï¼‰ï¼Œä½¿ç”¨è¾ƒå°‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ§åˆ¶ä¸é”æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è¡¨çº§é”ï¼ˆTable Lockï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;è¯»æ“ä½œåŠ å…±äº«é”ï¼ˆSé”ï¼‰ï¼Œå†™æ“ä½œåŠ æ’ä»–é”ï¼ˆXé”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘å†™å…¥ç“¶é¢ˆ&lt;/strong&gt;ï¼šå†™æ“ä½œä¼šé˜»å¡å…¨è¡¨è¯»å†™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¹¶å‘æ’å…¥ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥è¡¨æ— ç©ºæ´ï¼ˆæœªåˆ é™¤æ•°æ®ï¼‰ï¼Œå…è®¸è¯»æ“ä½œåŒæ—¶æ’å…¥æ–°æ•°æ®ï¼ˆ&lt;code&gt;SET GLOBAL concurrent_insert=2&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŠ¿ä¸å±€é™"&gt;âš–ï¸ ä¼˜åŠ¿ä¸å±€é™
&lt;/h3&gt;&lt;h4 id="ä¼˜åŠ¿"&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯»å–æ€§èƒ½å“è¶Š&lt;/strong&gt;ï¼šæ— äº‹åŠ¡å¼€é”€ï¼ŒB-Treeç´¢å¼•ä¼˜åŒ–ï¼Œå…¨è¡¨æ‰«æé€Ÿåº¦å¿«ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ç©ºé—´é«˜æ•ˆ&lt;/strong&gt;ï¼šæ•°æ®ç´§å‡‘ï¼Œå‹ç¼©è¡¨å¯å‡å°‘70%+ç£ç›˜å ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´ç®€æ˜“&lt;/strong&gt;ï¼šæ–‡ä»¶ç‹¬ç«‹ï¼Œç›´æ¥æ‹·è´å³å¯è¿ç§»/å¤‡ä»½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½èµ„æºæ¶ˆè€—&lt;/strong&gt;ï¼šå†…å­˜å ç”¨å°‘ï¼Œé€‚åˆåµŒå…¥å¼æˆ–ä½é…æœåŠ¡å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å±€é™ä¸é£é™©"&gt;&lt;strong&gt;å±€é™ä¸é£é™©&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;âŒ ä¸æ”¯æŒäº‹åŠ¡&lt;/strong&gt;ï¼šå´©æºƒæ—¶å¯èƒ½éƒ¨åˆ†æ•°æ®ä¸¢å¤±ï¼Œæ— æ³•å›æ»šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;âŒ è¡¨çº§é”å¹¶å‘å·®&lt;/strong&gt;ï¼šå†™å…¥é¢‘ç¹æ—¶æ€§èƒ½éª¤é™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;âŒ æ•°æ®æ˜“æŸå&lt;/strong&gt;ï¼šæ–­ç”µæˆ–å®•æœºåéœ€æ‰‹åŠ¨ä¿®å¤ï¼ˆ&lt;code&gt;REPAIR TABLE&lt;/code&gt;æˆ–&lt;code&gt;myisamchk&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;âŒ æ— å¤–é”®çº¦æŸ&lt;/strong&gt;ï¼šæ•°æ®å®Œæ•´æ€§ä¾èµ–åº”ç”¨å±‚ä¿éšœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯"&gt;ğŸ¯ é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—ä¸ç›‘æ§ç³»ç»Ÿ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å•å‘è¿½åŠ å†™å…¥ï¼ˆå¦‚è®¿é—®æ—¥å¿—ï¼‰ï¼Œè¯»å¤šå†™å°‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE TABLE access_log (
id INT AUTO_INCREMENT PRIMARY KEY,
url VARCHAR(255),
access_time DATETIME
) ENGINE=MyISAM; -- æ‰¹é‡æ’å…¥é«˜æ•ˆ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯»å¯†é›†å‹åˆ†æ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ•°æ®ä»“åº“ã€æŠ¥è¡¨æŸ¥è¯¢ï¼ˆå¦‚é”€å”®ç»Ÿè®¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨æ–‡æœç´¢åº”ç”¨&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ—©æœŸç‰ˆæœ¬æ–‡æœ¬æœç´¢ï¼ˆå¦‚åšå®¢å†…å®¹æ£€ç´¢ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE TABLE articles (
id INT PRIMARY KEY,
content TEXT,
FULLTEXT(content) -- MyISAMåŸç”Ÿå…¨æ–‡ç´¢å¼•
) ENGINE=MyISAM;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºå—é™ç¯å¢ƒ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åµŒå…¥å¼è®¾å¤‡æˆ–å†…å­˜æœ‰é™çš„æœåŠ¡å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¿ç»´ä¸ä¼˜åŒ–"&gt;ğŸ”§ è¿ç»´ä¸ä¼˜åŒ–
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¿®å¤æŸåè¡¨&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å‘½ä»¤è¡Œå·¥å…·ï¼š&lt;code&gt;myisamchk --recover table_name.MYI&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;SQLå‘½ä»¤ï¼š&lt;code&gt;REPAIR TABLE table_name&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘ç¢ç‰‡åŒ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å®šæœŸæ‰§è¡Œï¼š&lt;code&gt;OPTIMIZE TABLE table_name&lt;/code&gt;ï¼ˆåŠ¨æ€è¡¨å¿…éœ€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è°ƒä¼˜&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å¯ç”¨å¹¶å‘æ’å…¥ï¼š&lt;code&gt;SET GLOBAL concurrent_insert=2&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…é•¿æ—¶å†™æ“ä½œï¼šæ‰¹é‡å†™å…¥æ—¶å‡å°‘é”æŒæœ‰æ—¶é—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä½•æ—¶é¿å…ä½¿ç”¨"&gt;âš ï¸ ä½•æ—¶é¿å…ä½¿ç”¨ï¼Ÿ
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘å†™å…¥&lt;/strong&gt;ï¼šå¦‚ç”µå•†è®¢å•ç³»ç»Ÿï¼Œä¼˜å…ˆé€‰InnoDBè¡Œçº§é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡å…³é”®å‹ä¸šåŠ¡&lt;/strong&gt;ï¼šå¦‚æ”¯ä»˜ç³»ç»Ÿï¼Œéœ€ACIDä¿éšœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å¼ºä¸€è‡´æ€§éœ€æ±‚&lt;/strong&gt;ï¼šå¤–é”®çº¦æŸæˆ–å´©æºƒæ¢å¤åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;MyISAMä»¥&lt;strong&gt;æç®€æ¶æ„æ¢å–è¯»æ€§èƒ½ä¸å­˜å‚¨æ•ˆç‡&lt;/strong&gt;ï¼Œåœ¨æ—¥å¿—åˆ†æã€å…¨æ–‡æ£€ç´¢ç­‰è¯»ä¸»å¯¼åœºæ™¯ä¸­ä»å…·ç”Ÿå‘½åŠ›ã€‚ç„¶è€Œï¼Œå…¶ç¼ºä¹äº‹åŠ¡å®‰å…¨ä¸è¡Œçº§é”çš„ç¡¬ä¼¤ï¼Œä½¿å…¶éš¾ä»¥é€‚åº”ç°ä»£é«˜å¹¶å‘äº‹åŠ¡ç³»ç»Ÿã€‚&lt;strong&gt;å»ºè®®é€‰æ‹©ç­–ç•¥&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–°é¡¹ç›®é»˜è®¤InnoDBï¼Œä¿éšœäº‹åŠ¡ä¸å¹¶å‘ï¼›&lt;/li&gt;
&lt;li&gt;å†å²ç³»ç»Ÿæˆ–ç‰¹å®šéœ€æ±‚ï¼ˆå¦‚å…¨æ–‡ç´¢å¼•ã€ä½èµ„æºï¼‰å¯ä¿ç•™MyISAMï¼Œä½†éœ€å¼ºåŒ–æ•°æ®å¤‡ä»½ä¸ç›‘æ§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šMySQL 8.0å·²ç§»é™¤&lt;code&gt;.frm&lt;/code&gt;æ–‡ä»¶ï¼Œç³»ç»Ÿè¡¨ç»Ÿä¸€å­˜å‚¨å…ƒæ•°æ®ï¼Œä½†MyISAMçš„æ ¸å¿ƒæœºåˆ¶ä»å»¶ç»­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="federated"&gt;Federated
&lt;/h2&gt;&lt;p&gt;Federated å­˜å‚¨å¼•æ“æ˜¯ MySQL ä¸­ä¸€ç§ç‰¹æ®Šçš„å¼•æ“ï¼Œå…è®¸åœ¨&lt;strong&gt;æœ¬åœ°æœåŠ¡å™¨ä¸Šè®¿é—®è¿œç¨‹ MySQL æœåŠ¡å™¨ä¸­çš„è¡¨æ•°æ®&lt;/strong&gt;ï¼Œæ— éœ€å¤åˆ¶æˆ–é›†ç¾¤æŠ€æœ¯ã€‚å®ƒé€šè¿‡å»ºç«‹è™šæ‹Ÿè¡¨æ˜ å°„è¿œç¨‹è¡¨ï¼Œå®ç°è·¨æœåŠ¡å™¨çš„æ•°æ®é€æ˜è®¿é—®ï¼Œç±»ä¼¼äº Oracle çš„ DBLINKã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒç‰¹æ€§å’Œä½¿ç”¨ç»†èŠ‚ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸æ¶æ„"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸æ¶æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è™šæ‹Ÿè¡¨ä¸æ•°æ®åˆ†ç¦»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°è¡¨&lt;/strong&gt;ï¼šä»…å­˜å‚¨è¡¨ç»“æ„ï¼ˆ&lt;code&gt;.frm&lt;/code&gt; æˆ– &lt;code&gt;.sdi&lt;/code&gt; æ–‡ä»¶ï¼‰ï¼Œ&lt;strong&gt;ä¸ä¿å­˜å®é™…æ•°æ®&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿œç¨‹è¡¨&lt;/strong&gt;ï¼šæ•°æ®å®é™…å­˜å‚¨åœ¨è¿œç¨‹ MySQL æœåŠ¡å™¨ï¼Œæ”¯æŒ InnoDBã€MyISAM ç­‰å¼•æ“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥æœºåˆ¶&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;CONNECTION&lt;/code&gt; å­—ç¬¦ä¸²ï¼ˆå¦‚ &lt;code&gt;mysql://user:pass@ip:port/db/table&lt;/code&gt;ï¼‰æŒ‡å®šè¿œç¨‹è¡¨ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥è¯¢æ‰§è¡Œæµç¨‹&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;æœ¬åœ° SQL è¯­å¥è§£æåï¼Œæ„é€ è¿œç¨‹æŸ¥è¯¢è¯­å¥ï¼›&lt;/li&gt;
&lt;li&gt;é€šè¿‡ MySQL API å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨æ‰§è¡Œï¼›&lt;/li&gt;
&lt;li&gt;è¿œç¨‹ç»“æœè¿”å›æœ¬åœ°ï¼Œè½¬æ¢ä¸º Federated å¼•æ“æ ¼å¼å¹¶è¿”å›å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é™åˆ¶ä¸é£é™©&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è·¨æœåŠ¡å™¨è®¿é—®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€æ˜æ“ä½œè¿œç¨‹è¡¨ï¼Œæ”¯æŒ &lt;code&gt;SELECT/INSERT/UPDATE/DELETE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ &lt;code&gt;ALTER TABLE&lt;/code&gt;ã€&lt;code&gt;DROP TABLE&lt;/code&gt;ï¼ˆä»…åˆ é™¤æœ¬åœ°è¡¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ— æ•°æ®å†—ä½™&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…æ•°æ®å¤åˆ¶ï¼ŒèŠ‚çœæœ¬åœ°å­˜å‚¨&lt;/td&gt;
&lt;td&gt;è¿œç¨‹è¡¨ç»“æ„å˜æ›´éœ€æ‰‹åŠ¨åŒæ­¥æœ¬åœ°è¡¨ç»“æ„ï¼Œå¦åˆ™æ•°æ®å¯èƒ½æŸå&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æƒé™ä¾èµ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ¬åœ°æ“ä½œæƒé™ç”±è¿œç¨‹ç”¨æˆ·å†³å®šï¼Œéœ€æå‰æˆæƒï¼ˆå¦‚ &lt;code&gt;GRANT SELECT ON remote.*&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å¯†ç æ˜æ–‡å­˜å‚¨äº &lt;code&gt;CONNECTION&lt;/code&gt; å­—ç¬¦ä¸²ï¼Œå­˜åœ¨æ³„éœ²é£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€‚åˆä½é¢‘æˆ–å°æ‰¹é‡æ“ä½œ&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç½‘ç»œå»¶è¿Ÿæ•æ„Ÿ&lt;/strong&gt;ï¼š&lt;code&gt;COUNT(*)&lt;/code&gt;ã€&lt;code&gt;LIMIT&lt;/code&gt; åˆ†é¡µç­‰æ“ä½œæ•ˆç‡æä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡ä¸åŠŸèƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒäº‹åŠ¡ã€å¤–é”®ã€JSON å­—æ®µåŠæŸ¥è¯¢ç¼“å­˜&lt;/td&gt;
&lt;td&gt;æ“ä½œä¸­æ–­å¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼ˆå¦‚æ‰¹é‡æ’å…¥å¤±è´¥éƒ¨åˆ†æäº¤ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯-1"&gt;ğŸ¯ &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼æ•°æ®æ•´åˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è·¨ç‹¬ç«‹ç³»ç»Ÿè®¿é—®æ•°æ®ï¼ˆå¦‚ä»ä¸šåŠ¡åº“è¯»å–è´¦å·ä¿¡æ¯ï¼‰ï¼Œé¿å…å…¨é‡åŒæ­¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- æœ¬åœ°åˆ›å»º Federated è¡¨æ˜ å°„è¿œç¨‹è´¦å·è¡¨
CREATE TABLE account_remote (
id INT PRIMARY KEY,
name VARCHAR(50)
) ENGINE=FEDERATED
CONNECTION=&amp;#39;mysql://user:pass@remote_ip:3306/account_db/account_tb&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åªè¯»æŸ¥è¯¢ä¸æŠ¥è¡¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºè¿œç¨‹è¡¨é…ç½®åªè¯»è´¦å·ï¼Œå®‰å…¨æ‰§è¡Œåˆ†æç±»æŸ¥è¯¢ï¼ˆå¦‚å†å²æ—¥å¿—ç»Ÿè®¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«é€Ÿæ•°æ®è¿ç§»è¿‡æ¸¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è¿ç§»è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ Federated ä¸´æ—¶è®¿é—®æ–°æ—§åº“æ•°æ®ï¼Œå‡å°‘åº”ç”¨å±‚æ”¹é€ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¯ç”¨å¼•æ“&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤ç¦ç”¨ï¼Œéœ€åœ¨ &lt;code&gt;my.cnf&lt;/code&gt; æ·»åŠ  &lt;code&gt;federated=1&lt;/code&gt; å¹¶é‡å¯ MySQLã€‚&lt;/li&gt;
&lt;li&gt;ç¡®è®¤æ”¯æŒæ€§ï¼š&lt;code&gt;SHOW ENGINES;&lt;/code&gt; éœ€æ˜¾ç¤º &lt;code&gt;Support=YES&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥å­—ç¬¦ä¸²å®‰å…¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…å¯†ç å« &lt;code&gt;@&lt;/code&gt; å­—ç¬¦ï¼Œå»ºè®®ç”¨ &lt;code&gt;CREATE SERVER&lt;/code&gt; å®šä¹‰è¿æ¥ï¼ˆMySQL 5.5+ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE SERVER fed_link
FOREIGN DATA WRAPPER mysql
OPTIONS (USER &amp;#39;fed_user&amp;#39;, HOST &amp;#39;192.168.1.1&amp;#39;, DATABASE &amp;#39;db&amp;#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°è¡¨éœ€æ˜¾å¼åˆ›å»ºç´¢å¼•&lt;/strong&gt;ï¼Œå¦åˆ™å³ä½¿è¿œç¨‹è¡¨æœ‰ç´¢å¼•ï¼ŒæŸ¥è¯¢ä»å¯èƒ½å…¨è¡¨æ‰«æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œä¸å®¹ç¾&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è¿œç¨‹æœåŠ¡å™¨å®•æœºå°†å¯¼è‡´æœ¬åœ°æ“ä½œå¤±è´¥ï¼Œéœ€è®¾è®¡é‡è¯•æˆ–é™çº§æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å…¶ä»–æ–¹æ¡ˆçš„å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ä¸å…¶ä»–æ–¹æ¡ˆçš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠ£åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Federated&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é›¶æ•°æ®å†—ä½™ã€å¿«é€Ÿæ¥å…¥&lt;/td&gt;
&lt;td&gt;æ€§èƒ½å·®ã€åŠŸèƒ½é™åˆ¶å¤šã€æ— äº‹åŠ¡æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å¤åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®æœ¬åœ°åŒ–ã€é«˜æ€§èƒ½&lt;/td&gt;
&lt;td&gt;å­˜å‚¨å¼€é”€å¤§ã€åŒæ­¥å»¶è¿Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ETL åŒæ­¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒå¤æ‚æ¸…æ´—ã€å…¼å®¹å¼‚æ„æ•°æ®åº“&lt;/td&gt;
&lt;td&gt;å¼€å‘æˆæœ¬é«˜ã€å®æ—¶æ€§å·®&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Federated å¼•æ“æ˜¯ MySQL è·¨æœåŠ¡å™¨æ•°æ®è®¿é—®çš„è½»é‡çº§è§£å†³æ–¹æ¡ˆï¼Œ&lt;strong&gt;é€‚åˆä½é¢‘ã€åªè¯»æˆ–è¿‡æ¸¡æœŸåœºæ™¯&lt;/strong&gt;ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š
âœ… â€‹&lt;strong&gt;å…å¤åˆ¶é€æ˜è®¿é—®&lt;/strong&gt;â€‹ï¼šé¿å…æ•°æ®å†—ä½™ï¼Œç®€åŒ–è·¨åº“æŸ¥è¯¢ï¼›
âš ï¸ â€‹&lt;strong&gt;æ…ç”¨äºç”Ÿäº§é«˜é¢‘æ“ä½œ&lt;/strong&gt;â€‹ï¼šæ€§èƒ½ä¸åŠŸèƒ½é™åˆ¶æ˜¾è‘—ï¼ˆäº‹åŠ¡ã€JSONã€åˆ†é¡µç­‰ï¼‰ï¼›
ğŸ”’ â€‹&lt;strong&gt;å¼ºåˆ¶å®‰å…¨åŠ å›º&lt;/strong&gt;â€‹ï¼šæœ€å°åŒ–è¿œç¨‹è´¦å·æƒé™ + åŠ å¯†è¿æ¥ï¼ˆSSLï¼‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šä¼˜å…ˆè€ƒè™‘å¤åˆ¶æˆ– API é›†æˆæ»¡è¶³é«˜é¢‘éœ€æ±‚ï¼ŒFederated ä»…ä½œä¸ºç‰¹å®šåœºæ™¯çš„è¡¥å……å·¥å…·ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="myisam-å¤–é”®äº‹åŠ¡"&gt;MyISAM å¤–é”®ã€äº‹åŠ¡
&lt;/h2&gt;&lt;p&gt;åœ¨MySQL 5.6ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œ&lt;strong&gt;MyISAMå¼•æ“åŸç”Ÿä¸æ”¯æŒäº‹åŠ¡å’Œå¤–é”®çº¦æŸ&lt;/strong&gt;ï¼Œä½†å¯é€šè¿‡ä»¥ä¸‹æ–¹æ¡ˆå®ç°ç±»ä¼¼åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-äº‹åŠ¡æ”¯æŒçš„æ›¿ä»£æ–¹æ¡ˆ"&gt;ğŸ”§ &lt;strong&gt;äº‹åŠ¡æ”¯æŒçš„æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åˆ‡æ¢å­˜å‚¨å¼•æ“è‡³innodb"&gt;&lt;strong&gt;åˆ‡æ¢å­˜å‚¨å¼•æ“è‡³InnoDB&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ ¸å¿ƒæ–¹æ³•ï¼šå°†è¡¨å¼•æ“ä»MyISAMæ”¹ä¸ºInnoDBï¼ˆå”¯ä¸€åŸç”Ÿæ”¯æŒäº‹åŠ¡çš„å¼•æ“ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;ALTER TABLE è¡¨å ENGINE=InnoDB;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡æ“ä½œç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;BEGIN; -- å¼€å¯äº‹åŠ¡
UPDATE account SET balance = balance - 100 WHERE user_id = 1;
UPDATE account SET balance = balance + 100 WHERE user_id = 2;
COMMIT; -- æäº¤ï¼ˆæˆ– ROLLBACK å›æ»šï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¨¡æ‹Ÿäº‹åŠ¡ä»…é™ç®€å•åœºæ™¯"&gt;&lt;strong&gt;æ¨¡æ‹Ÿäº‹åŠ¡ï¼ˆä»…é™ç®€å•åœºæ™¯ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è¡¨é”æ›¿ä»£ï¼šé€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;LOCK TABLES
&lt;/code&gt;&lt;/pre&gt;é”å®šè¡¨é˜²æ­¢å¹¶å‘å¹²æ‰°ï¼Œä½†æ— æ³•å›æ»šã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;LOCK TABLES account WRITE; -- å†™é”
-- æ‰§è¡Œæ“ä½œ
UNLOCK TABLES; -- é‡Šæ”¾é”
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨å±‚è¡¥å¿&lt;/strong&gt;ï¼š
è®°å½•æ“ä½œæ—¥å¿—ï¼Œå¤±è´¥æ—¶é€šè¿‡åå‘æ“ä½œå›æ»šï¼ˆéœ€è‡ªè¡Œå®ç°åŸå­æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¤–é”®çº¦æŸçš„æ›¿ä»£æ–¹æ¡ˆ"&gt;âš™ï¸ &lt;strong&gt;å¤–é”®çº¦æŸçš„æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åˆ‡æ¢è‡³innodbå¼•æ“"&gt;&lt;strong&gt;åˆ‡æ¢è‡³InnoDBå¼•æ“&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç”Ÿæ”¯æŒå¤–é”®ï¼šInnoDBå¯å®šä¹‰çº§è”æ“ä½œï¼ˆ
&lt;pre tabindex="0"&gt;&lt;code&gt;ON DELETE CASCADE
&lt;/code&gt;&lt;/pre&gt;/
&lt;pre tabindex="0"&gt;&lt;code&gt;ON UPDATE CASCADE
&lt;/code&gt;&lt;/pre&gt;ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;ALTER TABLE å­è¡¨
ADD CONSTRAINT fk_parent
FOREIGN KEY (parent_id) REFERENCES çˆ¶è¡¨(id)
ON DELETE CASCADE;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ‰‹åŠ¨å®ç°å¤–é”®é€»è¾‘"&gt;&lt;strong&gt;æ‰‹åŠ¨å®ç°å¤–é”®é€»è¾‘&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è§¦å‘å™¨ï¼ˆTriggersï¼‰ï¼š
é€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;BEFORE INSERT/UPDATE
&lt;/code&gt;&lt;/pre&gt;è§¦å‘å™¨æ£€æŸ¥æ•°æ®ä¸€è‡´æ€§ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;DELIMITER //
CREATE TRIGGER check_fk BEFORE INSERT ON å­è¡¨
FOR EACH ROW
BEGIN
IF NOT EXISTS (SELECT 1 FROM çˆ¶è¡¨ WHERE id = NEW.parent_id) THEN
SIGNAL SQLSTATE &amp;#39;45000&amp;#39; SET MESSAGE_TEXT = &amp;#39;å¤–é”®çº¦æŸå¤±è´¥&amp;#39;;
END IF;
END //
DELIMITER ;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨å±‚æ ¡éªŒ&lt;/strong&gt;ï¼š
åœ¨ä¸šåŠ¡ä»£ç ä¸­å…ˆæŸ¥è¯¢çˆ¶è¡¨æ˜¯å¦å­˜åœ¨è®°å½•ï¼Œå†æ‰§è¡Œå­è¡¨æ“ä½œï¼ˆéœ€ä¿è¯é«˜å¹¶å‘ä¸‹çš„æ•°æ®ä¸€è‡´æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸å…¼å®¹æ€§è€ƒé‡"&gt;âš ï¸ &lt;strong&gt;æ€§èƒ½ä¸å…¼å®¹æ€§è€ƒé‡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;MyISAMä¸InnoDBçš„å·®å¼‚&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;MyISAM&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;InnoDB&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;åŸç”Ÿæ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤–é”®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;åŸç”Ÿæ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¡¨çº§é”ï¼ˆå†™é˜»å¡ï¼‰&lt;/td&gt;
&lt;td&gt;è¡Œçº§é” + MVCCï¼ˆé«˜å¹¶å‘ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å´©æºƒæ¢å¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨ä¿®å¤&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨å´©æºƒæ¢å¤ï¼ˆRedo Logï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ‡æ¢å¼•æ“çš„é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®è¿ç§»&lt;/strong&gt;ï¼šå¤§è¡¨è½¬æ¢å¯èƒ½è€—æ—¶è¾ƒé•¿ï¼Œéœ€åœ¨ä½å³°æœŸæ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¼å®¹æ€§é—®é¢˜&lt;/strong&gt;ï¼šéƒ¨åˆ†ä¾èµ–MyISAMç‰¹æ€§çš„åº”ç”¨ï¼ˆå¦‚å…¨æ–‡ç´¢å¼•ï¼‰éœ€è°ƒæ•´å®ç°é€»è¾‘ï¼ˆMySQL 5.6å‰InnoDBä¸æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åº”ç”¨å»ºè®®"&gt;ğŸ’ &lt;strong&gt;å®é™…åº”ç”¨å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆåˆ‡æ¢å¼•æ“&lt;/strong&gt;ï¼š
å¯¹äº‹åŠ¡/å¤–é”®æœ‰å¼ºéœ€æ±‚æ—¶ï¼Œâ€‹&lt;strong&gt;ç›´æ¥ä½¿ç”¨InnoDB&lt;/strong&gt;â€‹ï¼ˆå¦‚è®¢å•ã€æ”¯ä»˜ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸´æ—¶æ–¹æ¡ˆé€‚ç”¨åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;è§¦å‘å™¨ï¼šæ•°æ®é‡å°ã€å˜æ›´é¢‘ç‡ä½çš„è¡¨ï¼›&lt;/li&gt;
&lt;li&gt;åº”ç”¨å±‚æ ¡éªŒï¼šæ— æ³•ä¿®æ”¹å¼•æ“çš„é—ç•™ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§„é¿MyISAMç¼ºé™·&lt;/strong&gt;ï¼š
è¯»å¯†é›†å‹åœºæ™¯ï¼ˆå¦‚æ—¥å¿—åˆ†æï¼‰å¯ä¿ç•™MyISAMï¼Œä½†éœ€é€šè¿‡&lt;strong&gt;å®šæœŸå¤‡ä»½+æ•°æ®æ ¡éªŒ&lt;/strong&gt;è¡¥å¿ä¸€è‡´æ€§é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼šMySQL 5.6å‰MyISAMçš„çŸ­æ¿éœ€é€šè¿‡&lt;strong&gt;å¼•æ“åˆ‡æ¢&lt;/strong&gt;æˆ–&lt;strong&gt;åº”ç”¨å±‚æ¨¡æ‹Ÿ&lt;/strong&gt;è§£å†³ï¼Œè€Œåè€…ä»…èƒ½éƒ¨åˆ†å¼¥è¡¥åŠŸèƒ½ç¼ºå¤±ã€‚ç”Ÿäº§ç¯å¢ƒå»ºè®®ç›´æ¥è¿ç§»è‡³InnoDBï¼Œå…¼é¡¾åŠŸèƒ½å®Œæ•´æ€§ä¸æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="innodb"&gt;InnoDB
&lt;/h2&gt;&lt;p&gt;InnoDB æ˜¯ MySQL çš„&lt;strong&gt;é»˜è®¤å­˜å‚¨å¼•æ“&lt;/strong&gt;ï¼Œç”± Innobase Oy å¼€å‘ï¼ˆ2006 å¹´è¢«ç”²éª¨æ–‡æ”¶è´­ï¼‰ï¼Œä»¥å…¶&lt;strong&gt;å¼ºäº‹åŠ¡æ”¯æŒã€é«˜å¹¶å‘æ€§å’Œå´©æºƒæ¢å¤èƒ½åŠ›&lt;/strong&gt;æˆä¸ºä¼ä¸šçº§åº”ç”¨çš„æ ¸å¿ƒé€‰æ‹©ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒç‰¹æ€§ã€æŠ€æœ¯æ¶æ„ã€é€‚ç”¨åœºæ™¯åŠä¼˜åŒ–å®è·µå±•å¼€æ·±åº¦è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§ä¸ä¼˜åŠ¿"&gt;ğŸ” æ ¸å¿ƒç‰¹æ€§ä¸ä¼˜åŠ¿
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ACID äº‹åŠ¡æ”¯æŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;ï¼šé€šè¿‡ Undo Log å®ç°å›æ»šï¼Œç¡®ä¿äº‹åŠ¡æ“ä½œâ€œå…¨æˆåŠŸæˆ–å…¨å¤±è´¥â€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒä¹…æ€§&lt;/strong&gt;ï¼šä¾èµ– Redo Log å®ç°å´©æºƒæ¢å¤ï¼Œæäº¤åæ•°æ®æ°¸ä¹…ä¿å­˜ï¼ˆå³ä½¿å®•æœºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;ï¼šé»˜è®¤é‡‡ç”¨ &lt;strong&gt;å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«&lt;/strong&gt;ï¼Œé€šè¿‡ MVCC é¿å…è„è¯»/å¹»è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;ï¼šç”±æ•°æ®åº“çº¦æŸï¼ˆå¦‚å¤–é”®ï¼‰å’Œäº‹åŠ¡æœºåˆ¶å…±åŒä¿éšœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘å¤„ç†èƒ½åŠ›&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¡Œçº§é”&lt;/strong&gt;ï¼šä»…é”å®šè¢«ä¿®æ”¹çš„è¡Œï¼Œé¿å… MyISAM è¡¨çº§é”çš„å¹¶å‘ç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éé˜»å¡è¯»ï¼ˆConsistent Readï¼‰&lt;/strong&gt;ï¼šSELECT æ“ä½œä¸é˜»å¡å†™ï¼Œç±»ä¼¼ Oracle çš„è¯»ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰&lt;/strong&gt;ï¼šä¸ºæ¯ä¸ªäº‹åŠ¡ç”Ÿæˆç‹¬ç«‹æ•°æ®å¿«ç…§ï¼Œè¯»å†™æ“ä½œäº’ä¸å†²çªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å¯é æ€§ä¸æ¢å¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒå†™ç¼“å†²åŒºï¼ˆDouble Write Bufferï¼‰&lt;/strong&gt;ï¼šé˜²æ­¢é¡µæ–­è£‚å¯¼è‡´æ•°æ®æŸåã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å´©æºƒè‡ªåŠ¨æ¢å¤&lt;/strong&gt;ï¼šé‡å¯æ—¶è‡ªåŠ¨é‡æ”¾ Redo Log ä¿®å¤æœªè½ç›˜äº‹åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜çº§åŠŸèƒ½æ”¯æŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤–é”®çº¦æŸ&lt;/strong&gt;ï¼šç»´æŠ¤è·¨è¡¨æ•°æ®ä¸€è‡´æ€§ï¼ˆå¦‚çº§è”åˆ é™¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨æ–‡ç´¢å¼•ï¼ˆMySQL 5.6+ï¼‰&lt;/strong&gt;ï¼šæ”¯æŒå…¨æ–‡æœç´¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœ¨çº¿ DDL&lt;/strong&gt;ï¼šæ”¯æŒè¡¨ç»“æ„ä¿®æ”¹ä¸é”è¡¨ï¼ˆå¦‚æ·»åŠ ç´¢å¼•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æŠ€æœ¯æ¶æ„è§£æ"&gt;âš™ï¸ æŠ€æœ¯æ¶æ„è§£æ
&lt;/h3&gt;&lt;h4 id="å…³é”®ç»„ä»¶ä¸å·¥ä½œæµç¨‹"&gt;&lt;strong&gt;å…³é”®ç»„ä»¶ä¸å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»„ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Buffer Pool&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼“å­˜æ•°æ®é¡µä¸ç´¢å¼•ï¼Œå‡å°‘ç£ç›˜ I/O&lt;/td&gt;
&lt;td&gt;å ç‰©ç†å†…å­˜ 70%~80%ï¼ŒLRU ç®—æ³•ç®¡ç†ç¼“å­˜é¡µã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Redo Log&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®°å½•äº‹åŠ¡ä¿®æ”¹ï¼Œä¿éšœæŒä¹…æ€§&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡æäº¤å‰å…ˆå†™ Redo Logï¼ˆé¡ºåºå†™é«˜æ€§èƒ½ï¼‰ï¼Œå´©æºƒæ—¶é‡æ”¾æ—¥å¿—æ¢å¤æ•°æ®ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Undo Log&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨æ•°æ®æ—§ç‰ˆæœ¬ï¼Œæ”¯æŒå›æ»šå’Œ MVCC&lt;/td&gt;
&lt;td&gt;æ„å»ºäº‹åŠ¡å¿«ç…§ï¼Œå®ç°éé˜»å¡è¯»ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Adaptive Hash&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨ä¼˜åŒ–é«˜é¢‘æŸ¥è¯¢è·¯å¾„&lt;/td&gt;
&lt;td&gt;å°† B+æ ‘ç´¢å¼•è½¬ä¸ºå“ˆå¸Œç´¢å¼•ï¼ŒåŠ é€Ÿç­‰å€¼æŸ¥è¯¢ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="äº‹åŠ¡æ‰§è¡Œæµç¨‹"&gt;&lt;strong&gt;äº‹åŠ¡æ‰§è¡Œæµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¯åŠ¨äº‹åŠ¡&lt;/strong&gt;ï¼š&lt;code&gt;BEGIN&lt;/code&gt; åˆ†é…äº‹åŠ¡ IDï¼Œå¼€å¯å¿«ç…§ã€‚&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹æ•°æ®ï¼š
&lt;ul&gt;
&lt;li&gt;åŠ è½½æ•°æ®é¡µåˆ° Buffer Poolï¼›&lt;/li&gt;
&lt;li&gt;å†™ Undo Log è®°å½•æ—§å€¼ï¼›&lt;/li&gt;
&lt;li&gt;æ›´æ–°å†…å­˜æ•°æ®å¹¶æ ‡è®°è„é¡µï¼›&lt;/li&gt;
&lt;li&gt;å†™ Redo Log åˆ° Log Bufferã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æäº¤äº‹åŠ¡ï¼š
&lt;ul&gt;
&lt;li&gt;Redo Log åˆ·ç›˜ï¼ˆ&lt;code&gt;innodb_flush_log_at_trx_commit=1&lt;/code&gt; ç¡®ä¿å¼ºæŒä¹…æ€§ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Binlog åŒæ­¥ï¼ˆä¸»ä»å¤åˆ¶ï¼‰ï¼›
&lt;ul&gt;
&lt;li&gt;è„é¡µå¼‚æ­¥åˆ·ç›˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;&lt;strong&gt;å›æ»šäº‹åŠ¡&lt;/strong&gt;ï¼šé€šè¿‡ Undo Log æ¢å¤æ•°æ®åŸçŠ¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ"&gt;ğŸ¯ é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;h4 id="å…¸å‹åº”ç”¨åœºæ™¯"&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é‡‘èäº¤æ˜“ç³»ç»Ÿ&lt;/strong&gt;ï¼šACID äº‹åŠ¡ä¿éšœèµ„é‡‘è½¬è´¦åŸå­æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘ç”µå•†å¹³å°&lt;/strong&gt;ï¼šè¡Œçº§é”åº”å¯¹ç§’æ€åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³è”æ•°æ®ç®¡ç†&lt;/strong&gt;ï¼šå¤–é”®ç»´æŠ¤è®¢å•-ç”¨æˆ·å…³ç³»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é…ç½®ä¸è®¾è®¡æœ€ä½³å®è·µ"&gt;&lt;strong&gt;é…ç½®ä¸è®¾è®¡æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;ä¸»é”®è®¾è®¡ï¼š
&lt;ul&gt;
&lt;li&gt;æ˜¾å¼å®šä¹‰è‡ªå¢ä¸»é”®ï¼Œé¿å…éšå¼ç”Ÿæˆæ€§èƒ½æŸè€—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‚æ•°ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;innodb_file_per_table=ON&lt;/code&gt;ï¼šæ¯è¡¨ç‹¬ç«‹è¡¨ç©ºé—´ï¼Œä¾¿äºç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;innodb_buffer_pool_size&lt;/code&gt;ï¼šè®¾ä¸ºç‰©ç†å†…å­˜ 70%~80%ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡æ§åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;å…³é—­è‡ªåŠ¨æäº¤ï¼ˆ&lt;code&gt;autocommit=0&lt;/code&gt;ï¼‰ï¼Œæ‰¹é‡æäº¤å‡å°‘æ—¥å¿—åˆ·ç›˜æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯¼å…¥å¤§æ•°æ®ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸´æ—¶å…³é—­å”¯ä¸€/å¤–é”®æ£€æŸ¥ï¼š&lt;code&gt;SET UNIQUE_CHECKS=0, FOREIGN_KEY_CHECKS=0&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–æŠ€å·§"&gt;âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ—¥å¿—ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;éå…³é”®ä¸šåŠ¡è®¾ç½® &lt;code&gt;innodb_flush_log_at_trx_commit=2&lt;/code&gt;ï¼Œå¹³è¡¡æ€§èƒ½ä¸æŒä¹…æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é”å†²çªç›‘æ§ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;SHOW ENGINE INNODB STATUS&lt;/code&gt; åˆ†æé”ç­‰å¾…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é¿å…å…¨è¡¨å›æ»šï¼š
&lt;ul&gt;
&lt;li&gt;å¤§äº‹åŠ¡å›æ»šæ•ˆç‡æä½ï¼Œä¼˜å…ˆç”¨ &lt;code&gt;TRUNCATE&lt;/code&gt; æ¸…ç©ºè¡¨è€Œé &lt;code&gt;DELETE&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‹ç¼©ä¸åˆ†åŒºï¼š
&lt;ul&gt;
&lt;li&gt;å¯ç”¨è¡¨å‹ç¼©ï¼ˆ&lt;code&gt;ROW_FORMAT=COMPRESSED&lt;/code&gt;ï¼‰èŠ‚çœå­˜å‚¨ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æŒ‰æ—¶é—´åˆ†åŒºå¤§è¡¨ï¼ˆå¦‚æ—¥å¿—è¡¨ï¼‰æå‡æŸ¥è¯¢æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;InnoDB å‡­å€Ÿ&lt;strong&gt;äº‹åŠ¡å®‰å…¨ã€è¡Œçº§é”ã€MVCC å’Œå´©æºƒæ¢å¤&lt;/strong&gt;å››å¤§æ”¯æŸ±ï¼Œæˆä¸º MySQL çš„é»˜è®¤å¼•æ“ã€‚å…¶æ¶æ„è®¾è®¡ï¼ˆå¦‚ Buffer Pool å’Œ Redo/Undo Logï¼‰å…¼é¡¾é«˜æ€§èƒ½ä¸å¯é æ€§ï¼Œé€‚ç”¨äºéœ€å¼ºä¸€è‡´æ€§çš„åœ¨çº¿äº‹åŠ¡å¤„ç†ï¼ˆOLTPï¼‰ç³»ç»Ÿã€‚åˆç†é…ç½®å‚æ•°ï¼ˆå¦‚ç‹¬ç«‹è¡¨ç©ºé—´ã€ç¼“å†²æ± å¤§å°ï¼‰å’Œéµå¾ªæœ€ä½³å®è·µï¼ˆæ˜¾å¼ä¸»é”®ã€æ‰¹å¤„ç†äº‹åŠ¡ï¼‰ï¼Œå¯æœ€å¤§åŒ–å‘æŒ¥å…¶ä¼˜åŠ¿ã€‚åœ¨äº‘åŸç”Ÿä¸åˆ†å¸ƒå¼è¶‹åŠ¿ä¸‹ï¼ŒInnoDB ä»æŒç»­æ¼”è¿›ï¼ˆå¦‚å¢å¼ºçš„åœ¨çº¿ DDL å’Œåˆ†åŒºæ”¯æŒï¼‰ï¼Œç¨³å›ºå…¶æ ¸å¿ƒåœ°ä½ã€‚&lt;/p&gt;
&lt;h2 id="innodb-å­˜å‚¨æœºåˆ¶"&gt;InnoDB å­˜å‚¨æœºåˆ¶
&lt;/h2&gt;&lt;p&gt;InnoDB çš„å­˜å‚¨æœºåˆ¶é‡‡ç”¨å¤šå±‚æ¬¡ç»“æ„è®¾è®¡ï¼Œå…¼é¡¾æ€§èƒ½ã€äº‹åŠ¡å®‰å…¨ä¸æ•°æ®ä¸€è‡´æ€§ã€‚å…¶æ ¸å¿ƒæ¶æ„ä»å®è§‚åˆ°å¾®è§‚å¯åˆ†ä¸ºä»¥ä¸‹å±‚æ¬¡ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è¡¨ç©ºé—´tablespaceé€»è¾‘å­˜å‚¨é¡¶å±‚å®¹å™¨"&gt;ğŸ“‚ è¡¨ç©ºé—´ï¼ˆTablespaceï¼‰ï¼šé€»è¾‘å­˜å‚¨é¡¶å±‚å®¹å™¨
&lt;/h3&gt;&lt;p&gt;è¡¨ç©ºé—´æ˜¯ InnoDB å­˜å‚¨æ•°æ®çš„&lt;strong&gt;æœ€é«˜é€»è¾‘å•å…ƒ&lt;/strong&gt;ï¼Œåˆ†ä¸ºå¤šç§ç±»å‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç³»ç»Ÿè¡¨ç©ºé—´ï¼ˆ&lt;code&gt;ibdata1&lt;/code&gt;æ–‡ä»¶ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šå­˜å‚¨æ•°æ®å­—å…¸ã€äº‹åŠ¡ä¿¡æ¯ã€å›æ»šæ®µï¼ˆUndo Logï¼‰åŠå†å²è¡¨æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;ï¼šæ‰€æœ‰è¡¨å…±äº«ï¼ˆé™¤éå¯ç”¨ç‹¬ç«‹è¡¨ç©ºé—´ï¼‰ï¼Œæ–‡ä»¶å¤§å°å¯åŠ¨æ€æ‰©å±•ï¼ˆé€šè¿‡ &lt;code&gt;innodb_data_file_path&lt;/code&gt; é…ç½®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‹¬ç«‹è¡¨ç©ºé—´ï¼ˆ&lt;code&gt;è¡¨å.ibd&lt;/code&gt;æ–‡ä»¶ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šæ¯å¼ è¡¨æ‹¥æœ‰ç‹¬ç«‹çš„ &lt;code&gt;.ibd&lt;/code&gt; æ–‡ä»¶ï¼Œå­˜å‚¨è¯¥è¡¨çš„&lt;strong&gt;æ•°æ®+ç´¢å¼•+B+æ ‘ç»“æ„&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ç”¨æ–¹å¼&lt;/strong&gt;ï¼š&lt;code&gt;innodb_file_per_table=ON&lt;/code&gt;ï¼ˆMySQL 5.6+ é»˜è®¤å¼€å¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒå•è¡¨å¤‡ä»½/æ¢å¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ é™¤è¡¨æ—¶è‡ªåŠ¨é‡Šæ”¾ç£ç›˜ç©ºé—´
&lt;ul&gt;
&lt;li&gt;å‡å°‘ I/O ç«äº‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸´æ—¶è¡¨ç©ºé—´ï¼ˆ&lt;code&gt;ibtmp1&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨ä¸´æ—¶è¡¨æ•°æ®åŠæ’åºæ“ä½œä¸­é—´ç»“æœï¼Œé‡å¯åé‡å»ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Undo è¡¨ç©ºé—´ï¼ˆ&lt;code&gt;undo_001&lt;/code&gt;ç­‰ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;MySQL 8.0+ æ”¯æŒç‹¬ç«‹å­˜å‚¨ Undo Logï¼Œæå‡å¹¶å‘äº‹åŠ¡æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ®µsegmenté€»è¾‘ç®¡ç†å•å…ƒ"&gt;ğŸ§© æ®µï¼ˆSegmentï¼‰ï¼šé€»è¾‘ç®¡ç†å•å…ƒ
&lt;/h3&gt;&lt;p&gt;è¡¨ç©ºé—´å†…éƒ¨æŒ‰åŠŸèƒ½åˆ’åˆ†æ®µï¼Œæ¯ä¸ªæ®µç®¡ç†å¤šä¸ªåŒºï¼ˆExtentï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æ®µï¼ˆLeaf Segmentï¼‰&lt;/strong&gt;ï¼šB+æ ‘å¶å­èŠ‚ç‚¹ï¼Œå­˜å‚¨å®é™…è¡Œæ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•æ®µï¼ˆNon-Leaf Segmentï¼‰&lt;/strong&gt;ï¼šB+æ ‘éå¶å­èŠ‚ç‚¹ï¼Œå­˜å‚¨ç´¢å¼•ç›®å½•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æ»šæ®µï¼ˆRollback Segmentï¼‰&lt;/strong&gt;ï¼šç®¡ç† Undo Logï¼Œæ”¯æŒäº‹åŠ¡å›æ»šä¸ MVCCã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åŒºextentç‰©ç†åˆ†é…å•ä½"&gt;ğŸ§± åŒºï¼ˆExtentï¼‰ï¼šç‰©ç†åˆ†é…å•ä½
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤§å°&lt;/strong&gt;ï¼š1MBï¼ˆç”± &lt;strong&gt;64ä¸ªè¿ç»­é¡µ&lt;/strong&gt;ç»„æˆï¼Œæ¯é¡µ 16KBï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šå‡å°‘ç£ç›˜ç¢ç‰‡ï¼ŒInnoDB æ¯æ¬¡ç”³è¯· 4â€“5 ä¸ªåŒºï¼ˆ4â€“5MBï¼‰ï¼Œç¡®ä¿é¡µçš„ç‰©ç†è¿ç»­æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é¡µpageæœ€å°å­˜å‚¨å•å…ƒ16kb"&gt;ğŸ“„ é¡µï¼ˆPageï¼‰ï¼šæœ€å°å­˜å‚¨å•å…ƒï¼ˆ16KBï¼‰
&lt;/h3&gt;&lt;p&gt;é¡µæ˜¯ç£ç›˜ä¸å†…å­˜äº¤äº’çš„åŸºæœ¬å•ä½ï¼Œé»˜è®¤ 16KBã€‚æ•°æ®é¡µï¼ˆç±»å‹ &lt;code&gt;FIL_PAGE_INDEX&lt;/code&gt;ï¼‰çš„ç»“æ„åˆ†ä¸º 7 éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»„ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¤§å°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;File Header&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;38 å­—èŠ‚&lt;/td&gt;
&lt;td&gt;å­˜å‚¨é¡µé€šç”¨ä¿¡æ¯ï¼šé¡µå·ã€å‰åé¡µæŒ‡é’ˆï¼ˆåŒå‘é“¾è¡¨ï¼‰ã€æ ¡éªŒå’Œï¼ˆCRC32ï¼‰ã€LSNï¼ˆæ—¥å¿—åºåˆ—å·ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Page Header&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;56 å­—èŠ‚&lt;/td&gt;
&lt;td&gt;è®°å½•é¡µå†…çŠ¶æ€ï¼šè®°å½•æ•°é‡ã€ç©ºé—²ä½ç½®ã€åˆ é™¤é“¾è¡¨å¤´ã€B+æ ‘å±‚çº§ï¼ˆ&lt;code&gt;PAGE_LEVEL&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Infimum + Supremum&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;26 å­—èŠ‚&lt;/td&gt;
&lt;td&gt;è™šæ‹Ÿè¡Œè®°å½•ï¼Œå®šä¹‰é¡µä¸­æœ€å°/æœ€å¤§è¾¹ç•Œï¼Œç”¨äºèŒƒå›´æ‰«æã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;User Records&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€&lt;/td&gt;
&lt;td&gt;å®é™…å­˜å‚¨çš„è¡Œæ•°æ®ï¼ŒæŒ‰ä¸»é”®é¡ºåºå•å‘é“¾è¡¨ç»„ç»‡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Free Space&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€&lt;/td&gt;
&lt;td&gt;æœªä½¿ç”¨ç©ºé—´ï¼Œåˆ é™¤è®°å½•æ—¶åŠ å…¥ç©ºé—²é“¾è¡¨ä¾›é‡ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Page Directory&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ§½ï¼ˆSlotï¼‰æ•°ç»„&lt;/strong&gt;ï¼Œå­˜å‚¨æ¯ç»„æœ€åè®°å½•çš„åç§»é‡ï¼Œæ”¯æŒé¡µå†…äºŒåˆ†æŸ¥æ‰¾ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;File Trailer&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;8 å­—èŠ‚&lt;/td&gt;
&lt;td&gt;æ ¡éªŒé¡µå®Œæ•´æ€§ï¼ˆæ¯”å¯¹ Header æ ¡éªŒå’Œä¸ LSNï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="-é¡µå†…è®°å½•ç»„ç»‡å…³é”®æœºåˆ¶"&gt;ğŸ” é¡µå†…è®°å½•ç»„ç»‡å…³é”®æœºåˆ¶ï¼š
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®°å½•é“¾è¡¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰è¡ŒæŒ‰ä¸»é”®å‡åºç»„æˆå•å‘é“¾è¡¨ï¼Œæ¯æ¡è®°å½•çš„&lt;strong&gt;è®°å½•å¤´&lt;/strong&gt;ä¸­ &lt;code&gt;next_record&lt;/code&gt; å­˜å‚¨ä¸‹ä¸€æ¡ä½ç½®åç§»é‡ã€‚&lt;/li&gt;
&lt;li&gt;åˆ é™¤è®°å½•ä»…æ ‡è®° &lt;code&gt;delete_flag=1&lt;/code&gt;ï¼ŒåŠ å…¥ç©ºé—²é“¾è¡¨ï¼ˆ&lt;code&gt;PAGE_FREE&lt;/code&gt;ï¼‰ï¼Œç©ºé—´å¯å¤ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µç›®å½•ï¼ˆPage Directoryï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è®°å½•åˆ†ç»„ç®¡ç†ï¼ˆæ¯ç»„ 4â€“8 æ¡ï¼‰ï¼Œæ§½å­˜å‚¨æ¯ç»„æœ€å¤§è®°å½•çš„åç§»é‡ã€‚&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;äºŒåˆ†æŸ¥æ‰¾å®šä½æ§½ â†’ éå†ç»„å†…è®°å½• â†’ åŒ¹é…ç›®æ ‡è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¡Œrowæ•°æ®å­˜å‚¨å®ä½“"&gt;ğŸ“Š è¡Œï¼ˆRowï¼‰ï¼šæ•°æ®å­˜å‚¨å®ä½“
&lt;/h3&gt;&lt;p&gt;æ¯è¡Œæ•°æ®åŒ…å«ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éšè—å­—æ®µ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;trx_id&lt;/code&gt;ï¼šæœ€åä¿®æ”¹è¯¥è¡Œçš„äº‹åŠ¡ IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;roll_pointer&lt;/code&gt;ï¼šæŒ‡å‘ Undo Log çš„æŒ‡é’ˆï¼Œæ„å»º MVCC ç‰ˆæœ¬é“¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡Œæ ¼å¼ï¼ˆå½±å“å­˜å‚¨æ•ˆç‡ï¼‰&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ ¼å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Compact&lt;/td&gt;
&lt;td&gt;é»˜è®¤æ ¼å¼ï¼Œå‹ç¼© NULL å’Œå˜é•¿å­—æ®µã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dynamic&lt;/td&gt;
&lt;td&gt;æ”¯æŒå¤§å¯¹è±¡ï¼ˆLOBï¼‰æº¢å‡ºé¡µå­˜å‚¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Compressed&lt;/td&gt;
&lt;td&gt;æ”¯æŒæ•°æ®å‹ç¼©ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¾…åŠ©å­˜å‚¨ç»“æ„"&gt;âš™ï¸ è¾…åŠ©å­˜å‚¨ç»“æ„
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—æ–‡ä»¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redo Logï¼ˆ&lt;code&gt;ib_logfile0-N&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼šé¡ºåºè®°å½•äº‹åŠ¡ä¿®æ”¹ï¼Œå´©æºƒæ¢å¤æ—¶é‡æ”¾æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Undo Log&lt;/strong&gt;ï¼šå­˜å‚¨æ—§æ•°æ®ç‰ˆæœ¬ï¼Œæ”¯æŒäº‹åŠ¡å›æ»šå’Œ MVCC å¿«ç…§è¯»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒå†™ç¼“å†²åŒºï¼ˆDoublewrite Bufferï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½äºç³»ç»Ÿè¡¨ç©ºé—´ï¼Œé˜²æ­¢é¡µæ–­è£‚ï¼ˆPartial Writeï¼‰ï¼Œç¡®ä¿æ•°æ®é¡µå†™å…¥åŸå­æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®æ“ä½œæµç¨‹ç¤ºä¾‹"&gt;ğŸ”„ æ•°æ®æ“ä½œæµç¨‹ç¤ºä¾‹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ’å…¥è®°å½•
&lt;ul&gt;
&lt;li&gt;ä» &lt;code&gt;Free Space&lt;/code&gt; æˆ–ç©ºé—²é“¾è¡¨åˆ†é…ç©ºé—´ â†’ å†™å…¥ &lt;code&gt;User Records&lt;/code&gt; â†’ æ›´æ–°é“¾è¡¨æŒ‡é’ˆä¸é¡µç›®å½•æ§½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢è®°å½•
&lt;ul&gt;
&lt;li&gt;B+æ ‘å®šä½é¡µ â†’ é¡µå†…äºŒåˆ†æŸ¥æ‰¾æ§½ â†’ éå†ç»„å†…é“¾è¡¨ â†’ è¿”å›æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ é™¤è®°å½•
&lt;ul&gt;
&lt;li&gt;æ ‡è®° &lt;code&gt;delete_flag=1&lt;/code&gt; â†’ åŠ å…¥ç©ºé—²é“¾è¡¨ â†’ æ›´æ–°ç›¸é‚»è®°å½•æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“innodb-å­˜å‚¨è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³"&gt;ğŸ’ æ€»ç»“ï¼šInnoDB å­˜å‚¨è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å±‚ç®¡ç†&lt;/strong&gt;ï¼šè¡¨ç©ºé—´ â†’ æ®µ â†’ åŒº â†’ é¡µ â†’ è¡Œï¼Œå®ç°é«˜æ•ˆç©ºé—´åˆ†é…ä¸æ‰©å±•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µä¸ºæ ¸å¿ƒ&lt;/strong&gt;ï¼š16KB é¡µä½œä¸º I/O å•ä½ï¼Œé€šè¿‡ç¼“å†²æ± ï¼ˆBuffer Poolï¼‰å‡å°‘ç£ç›˜è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æ”¯æŒ&lt;/strong&gt;ï¼šé€šè¿‡éšè—å­—æ®µï¼ˆ&lt;code&gt;trx_id&lt;/code&gt;, &lt;code&gt;roll_pointer&lt;/code&gt;ï¼‰å’Œæ—¥å¿—ï¼ˆRedo/Undoï¼‰å®ç° ACIDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ•ˆæŸ¥è¯¢&lt;/strong&gt;ï¼šB+æ ‘ç´¢å¼• + é¡µå†…æ§½åˆ†ç»„ + è®°å½•é“¾è¡¨ï¼Œå¹³è¡¡æŸ¥è¯¢ä¸å†™å…¥æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šç†è§£ InnoDB å­˜å‚¨ç»“æ„æ˜¯ä¼˜åŒ–&lt;strong&gt;ç´¢å¼•è®¾è®¡&lt;/strong&gt;ï¼ˆå¦‚é¿å…éšæœºå†™å…¥ï¼‰ã€&lt;strong&gt;äº‹åŠ¡è°ƒä¼˜&lt;/strong&gt;ï¼ˆå¦‚åˆç†è®¾ç½® Undo è¡¨ç©ºé—´ï¼‰å’Œ&lt;strong&gt;æ•…éšœæ¢å¤&lt;/strong&gt;çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="buffer-pool"&gt;Buffer Pool
&lt;/h2&gt;&lt;p&gt;InnoDB çš„ &lt;strong&gt;Buffer Poolï¼ˆç¼“å†²æ± ï¼‰&lt;/strong&gt; æ˜¯ MySQL çš„æ ¸å¿ƒå†…å­˜ç»„ä»¶ï¼Œç”¨äºç¼“å­˜ç£ç›˜ä¸­çš„è¡¨æ•°æ®å’Œç´¢å¼•é¡µï¼Œé€šè¿‡å‡å°‘ç£ç›˜ I/O æ˜¾è‘—æå‡æ•°æ®åº“æ€§èƒ½ã€‚ä»¥ä¸‹ä»ä½œç”¨ã€ç»“æ„ã€å·¥ä½œæœºåˆ¶ã€ä¼˜åŒ–ç­–ç•¥ç­‰ç»´åº¦å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä½œç”¨ä¸ä»·å€¼"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒä½œç”¨ä¸ä»·å€¼&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ é€Ÿæ•°æ®è®¿é—®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å°†é¢‘ç¹è®¿é—®çš„&lt;strong&gt;æ•°æ®é¡µ&lt;/strong&gt;ï¼ˆ16KB/é¡µï¼‰å’Œ&lt;strong&gt;ç´¢å¼•é¡µ&lt;/strong&gt;ç¼“å­˜åˆ°å†…å­˜ï¼Œåç»­æŸ¥è¯¢ç›´æ¥è¯»å–å†…å­˜ï¼Œé¿å…ç£ç›˜ I/Oã€‚&lt;/li&gt;
&lt;li&gt;ä¸“ç”¨æ•°æ®åº“æœåŠ¡å™¨å»ºè®®åˆ†é… &lt;strong&gt;60%~80% ç‰©ç†å†…å­˜&lt;/strong&gt;ç»™ Buffer Poolã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¯æŒäº‹åŠ¡ä¸å¹¶å‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ç¼“å­˜ &lt;strong&gt;Undo é¡µ&lt;/strong&gt; å®ç°äº‹åŠ¡å›æ»šå’Œ MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç»“åˆ &lt;strong&gt;Redo Log&lt;/strong&gt; ä¿è¯æ•°æ®æŒä¹…æ€§ï¼šäº‹åŠ¡æäº¤æ—¶å…ˆå†™ Redo Logï¼Œè„é¡µå¼‚æ­¥åˆ·ç›˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢„è¯»ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºå±€éƒ¨æ€§åŸç†ï¼ŒåŠ è½½ç›®æ ‡é¡µæ—¶&lt;strong&gt;é¢„è¯»ç›¸é‚»é¡µ&lt;/strong&gt;ï¼Œå‡å°‘æœªæ¥å¯èƒ½çš„ç£ç›˜ I/Oã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å†…éƒ¨ç»“æ„ä¸æ•°æ®ç®¡ç†"&gt;ğŸ§  &lt;strong&gt;å†…éƒ¨ç»“æ„ä¸æ•°æ®ç®¡ç†&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Buffer Pool é€šè¿‡å¤šé“¾è¡¨å’Œå“ˆå¸Œè¡¨ç®¡ç†å†…å­˜é¡µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒé“¾è¡¨ç»“æ„&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é“¾è¡¨ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç®¡ç†å†…å®¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Free List&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç©ºé—²é¡µ&lt;/td&gt;
&lt;td&gt;æä¾›æ–°é¡µåŠ è½½çš„å¯ç”¨å†…å­˜ç©ºé—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;LRU List&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å·²ç¼“å­˜é¡µ&lt;/td&gt;
&lt;td&gt;æŒ‰è®¿é—®é¢‘ç‡æ’åºï¼Œæ·˜æ±°å†·æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Flush List&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è„é¡µï¼ˆè¢«ä¿®æ”¹æœªåˆ·ç›˜ï¼‰&lt;/td&gt;
&lt;td&gt;å®šæœŸå¼‚æ­¥åˆ·ç›˜ä¿è¯æ•°æ®æŒä¹…æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¹è¿›çš„ LRU ç®—æ³•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;LRU é“¾è¡¨åˆ†ä¸º &lt;strong&gt;Young åŒºï¼ˆçƒ­æ•°æ®ï¼Œ5/8ï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;Old åŒºï¼ˆå†·æ•°æ®ï¼Œ3/8ï¼‰&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ–°åŠ è½½çš„é¡µæ’å…¥ Old åŒºå¤´éƒ¨ï¼Œ&lt;strong&gt;ä»…å½“ 1 ç§’åå†æ¬¡è¢«è®¿é—®&lt;/strong&gt;æ‰ç§»å…¥ Young åŒºï¼ˆé˜²å…¨è¡¨æ‰«ææ±¡æŸ“ç¼“å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å‚æ•°æ§åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;innodb_old_blocks_pct&lt;/code&gt;ï¼šOld åŒºå æ¯”ï¼ˆé»˜è®¤ 37%ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;innodb_old_blocks_time&lt;/code&gt;ï¼šå†·æ•°æ®æ™‹å‡é˜ˆå€¼ï¼ˆé»˜è®¤ 1000msï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«é€Ÿå®šä½ï¼šPage Hash Table&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»¥ &lt;code&gt;(è¡¨ç©ºé—´ID + é¡µå·)&lt;/code&gt; ä¸º Keyï¼Œé€šè¿‡å“ˆå¸Œè¡¨å¿«é€Ÿå®šä½é¡µæ˜¯å¦åœ¨å†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹"&gt;ğŸ”„ &lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®è¯»å–æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥è¯¢æ•°æ®é¡µ&lt;/strong&gt; â†’ æŸ¥ Page Hash è¡¨ â†’ &lt;strong&gt;å‘½ä¸­åˆ™è¿”å›å†…å­˜æ•°æ®&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªå‘½ä¸­&lt;/strong&gt; â†’ ä»ç£ç›˜åŠ è½½ â†’ è‹¥ Free List æ— ç©ºé—´ï¼Œåˆ™ LRU æ·˜æ±°å†·é¡µ â†’ åŠ è½½æ–°é¡µåˆ° Buffer Poolã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¿®æ”¹æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–°æ“ä½œ&lt;/strong&gt; â†’ ä¿®æ”¹ Buffer Pool ä¸­çš„é¡µ â†’ æ ‡è®°ä¸ºè„é¡µ â†’ å†™å…¥ Flush List â†’ &lt;strong&gt;å¼‚æ­¥åˆ·ç›˜&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å´©æºƒæ¢å¤&lt;/strong&gt;ï¼šé€šè¿‡ Redo Log é‡æ”¾æœªè½ç›˜çš„ä¿®æ”¹ï¼ˆWrite-Ahead Logging åŸåˆ™ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è„é¡µåˆ·ç›˜æ—¶æœº&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Buffer Pool ç©ºé—´ä¸è¶³éœ€æ·˜æ±°è„é¡µæ—¶ï¼›&lt;/li&gt;
&lt;li&gt;Redo Log å†™æ»¡æ—¶ï¼ˆå¼ºåˆ¶åˆ·ç›˜ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;ç³»ç»Ÿç©ºé—²æˆ–äº‹åŠ¡æäº¤æ—¶ï¼ˆæ ¹æ®é…ç½®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"&gt;âš¡ï¸ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆç†é…ç½® Buffer Pool å¤§å°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€è°ƒæ•´ï¼š&lt;code&gt;SET GLOBAL innodb_buffer_pool_size = X_GB;&lt;/code&gt;ï¼ˆæ— éœ€é‡å¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å‘½ä¸­ç‡ç›‘æ§ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- è®¡ç®—å‘½ä¸­ç‡ï¼ˆéœ€ &amp;gt;90%ï¼‰
SELECT (1 - Innodb_buffer_pool_reads / Innodb_buffer_pool_read_requests) * 100 AS hit_rate
FROM information_schema.GLOBAL_STATUS;
&lt;/code&gt;&lt;/pre&gt;è‹¥ä½äº 90%ï¼Œéœ€å¢å¤§
&lt;pre tabindex="0"&gt;&lt;code&gt;innodb_buffer_pool_size
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šå®ä¾‹ä¸åˆ†å—ï¼ˆChunkï¼‰æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¤šå®ä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;å‚æ•° &lt;code&gt;innodb_buffer_pool_instances&lt;/code&gt;ï¼ˆé»˜è®¤ 1ï¼‰ï¼Œå½“æ€»å¤§å° &amp;gt;1GB æ—¶å»ºè®®è®¾ä¸º &lt;strong&gt;8&lt;/strong&gt;ï¼Œå‡å°‘é”ç«äº‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Chunk åˆ†å—ï¼š
&lt;ul&gt;
&lt;li&gt;ä»¥ &lt;code&gt;innodb_buffer_pool_chunk_size&lt;/code&gt;ï¼ˆé»˜è®¤ 128MBï¼‰ä¸ºå•ä½åŠ¨æ€è°ƒæ•´å†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢„çƒ­ä¸æŒä¹…åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é—­æ—¶è½¬å‚¨çƒ­æ•°æ®&lt;/strong&gt;ï¼š&lt;code&gt;innodb_buffer_pool_dump_at_shutdown=ON&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯åŠ¨æ—¶åŠ è½½çƒ­æ•°æ®&lt;/strong&gt;ï¼š&lt;code&gt;innodb_buffer_pool_load_at_startup=ON&lt;/code&gt;ï¼ŒåŠ é€Ÿé¢„çƒ­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å…¨è¡¨æ‰«ææ±¡æŸ“ç¼“å­˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;strong&gt;Old åŒºéš”ç¦»&lt;/strong&gt;å…¨è¡¨æ‰«æçš„ä¸´æ—¶é¡µï¼Œä¿æŠ¤ Young åŒºçš„çƒ­æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜ä¸è§£å†³"&gt;âš ï¸ &lt;strong&gt;å¸¸è§é—®é¢˜ä¸è§£å†³&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ä¸è¶³å¯¼è‡´é¢‘ç¹æ·˜æ±°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç°è±¡&lt;/strong&gt;ï¼š&lt;code&gt;Innodb_buffer_pool_reads&lt;/code&gt;ï¼ˆç£ç›˜è¯»ï¼‰å€¼é«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šå¢åŠ  Buffer Pool å¤§å°æˆ–ä¼˜åŒ–æŸ¥è¯¢å‡å°‘å…¨è¡¨æ‰«æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è„é¡µå †ç§¯å½±å“å†™å…¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç°è±¡&lt;/strong&gt;ï¼š&lt;code&gt;Innodb_buffer_pool_pages_dirty&lt;/code&gt;ï¼ˆè„é¡µæ•°é‡ï¼‰æŒç»­é«˜ä½ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼š
&lt;ul&gt;
&lt;li&gt;å¢å¤§ &lt;code&gt;innodb_log_file_size&lt;/code&gt;ï¼ˆRedo Log å¤§å°ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æå‡åˆ·ç›˜é¢‘ç‡ï¼ˆè°ƒæ•´ &lt;code&gt;innodb_io_capacity&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LRU é“¾è¡¨é”ç«äº‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç°è±¡&lt;/strong&gt;ï¼šé«˜å¹¶å‘ä¸‹ Buffer Pool å“åº”å»¶è¿Ÿã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šå¢åŠ  &lt;code&gt;innodb_buffer_pool_instances&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Buffer Pool é€šè¿‡&lt;strong&gt;å†…å­˜ç¼“å­˜ + æ™ºèƒ½æ·˜æ±°æœºåˆ¶ + å¼‚æ­¥åˆ·ç›˜&lt;/strong&gt;ï¼Œåœ¨ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„åŒæ—¶æå¤§æå‡äº†æ•°æ®åº“æ€§èƒ½ã€‚ä¼˜åŒ–æ ¸å¿ƒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®¹é‡é…ç½®&lt;/strong&gt;ï¼šæŒ‰ç‰©ç†å†…å­˜ 70%~80% åˆ†é…ï¼Œç›‘æ§å‘½ä¸­ç‡åŠ¨æ€è°ƒæ•´ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“æ„è®¾è®¡&lt;/strong&gt;ï¼šå¤šå®ä¾‹ã€æ”¹è¿› LRUã€é¢„è¯»æœºåˆ¶å‡å°‘ I/Oï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒä¹…åŒ–ååŒ&lt;/strong&gt;ï¼šä¸ Redo Log é…åˆå®ç°å´©æºƒæ¢å¤ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æç¤º&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;SHOW ENGINE INNODB STATUS\G&lt;/code&gt; å¯æŸ¥çœ‹ Buffer Pool å®æ—¶çŠ¶æ€ï¼ˆFree/LRU/Flush é“¾è¡¨è¯¦æƒ…ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="bæ ‘"&gt;B+æ ‘
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://imgcdn.qq.com/c0277959f6f95372"
loading="lazy"
alt="img"
&gt;&lt;img src="https://imgcdn.qq.com/2355b8546c73e4d9"
loading="lazy"
alt="img"
&gt;&lt;img src="https://imgcdn.qq.com/2befd32a52502484"
loading="lazy"
alt="img"
&gt;&lt;img src="https://imgcdn.qq.com/b0c01b12147c8267"
loading="lazy"
alt="img"
&gt;
B+æ ‘æ˜¯ä¸€ç§ä¸“ä¸ºç£ç›˜å­˜å‚¨ä¼˜åŒ–çš„å¹³è¡¡å¤šè·¯æœç´¢æ ‘ï¼Œå¹¿æ³›åº”ç”¨äºæ•°æ®åº“ç´¢å¼•ï¼ˆå¦‚MySQL InnoDBï¼‰å’Œæ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚NTFSã€ReiserFSï¼‰ã€‚å…¶æ ¸å¿ƒè®¾è®¡é€šè¿‡å‡å°‘ç£ç›˜I/Oæ¬¡æ•°ã€ä¼˜åŒ–èŒƒå›´æŸ¥è¯¢ï¼Œæ˜¾è‘—æå‡å¤§è§„æ¨¡æ•°æ®æ“ä½œçš„æ•ˆç‡ã€‚ä»¥ä¸‹ä»ç»“æ„ã€æ“ä½œã€ä¼˜åŠ¿åŠåœºæ™¯å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-bæ ‘çš„æ ¸å¿ƒç»“æ„"&gt;ğŸŒ³ B+æ ‘çš„æ ¸å¿ƒç»“æ„
&lt;/h3&gt;&lt;h4 id="åˆ†å±‚è®¾è®¡"&gt;&lt;strong&gt;åˆ†å±‚è®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å¶å­èŠ‚ç‚¹ï¼ˆLeaf Nodesï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨å®é™…æ•°æ®&lt;/strong&gt;ï¼ˆå¦‚æ•°æ®åº“ä¸­çš„è¡Œè®°å½•åœ°å€æˆ–æ–‡ä»¶å†…å®¹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒå‘é“¾è¡¨è¿æ¥&lt;/strong&gt;ï¼šæ‰€æœ‰å¶å­èŠ‚ç‚¹æŒ‰é”®å€¼å‡åºé“¾æ¥ï¼Œæ”¯æŒé«˜æ•ˆèŒƒå›´éå†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;éå¶å­èŠ‚ç‚¹ï¼ˆInternal Nodesï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»…å­˜å‚¨ç´¢å¼•é”®&lt;/strong&gt;ï¼ˆå¦‚ä¸»é”®å€¼ï¼‰ï¼Œ&lt;strong&gt;ä¸å­˜å‚¨å®é™…æ•°æ®&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­æŒ‡é’ˆç®¡ç†&lt;/strong&gt;ï¼šæ¯ä¸ªéå¶å­èŠ‚ç‚¹åŒ…å« &lt;code&gt;k&lt;/code&gt; ä¸ªé”®å’Œ &lt;code&gt;k+1&lt;/code&gt; ä¸ªå­æŒ‡é’ˆï¼ˆæŒ‡å‘ä¸‹å±‚èŠ‚ç‚¹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="çº¦æŸè§„åˆ™mé˜¶bæ ‘"&gt;&lt;strong&gt;çº¦æŸè§„åˆ™ï¼ˆmé˜¶B+æ ‘ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è§„åˆ™&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èŠ‚ç‚¹å®¹é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éæ ¹èŠ‚ç‚¹é”®æ•°èŒƒå›´ï¼š&lt;code&gt;âŒˆm/2âŒ‰-1 â‰¤ k â‰¤ m-1&lt;/code&gt;ï¼ˆæ ¹èŠ‚ç‚¹è‡³å°‘2ä¸ªå­èŠ‚ç‚¹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ‘é«˜å¹³è¡¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰å¶å­èŠ‚ç‚¹ä½äºåŒä¸€å±‚ï¼Œä¿è¯æ“ä½œç¨³å®šæ—¶é—´å¤æ‚åº¦ï¼ˆO(log n)ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å”¯ä¸€æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®ä»…å­˜äºå¶å­èŠ‚ç‚¹ï¼Œéå¶å­èŠ‚ç‚¹é”®å¯é‡å¤å‡ºç°ï¼ˆä½œä¸ºç´¢å¼•åˆ†éš”å€¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»“æ„ç¤ºä¾‹ï¼ˆ3é˜¶B+æ ‘ï¼‰&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; [10, 20] â† éå¶å­èŠ‚ç‚¹ï¼ˆä»…ç´¢å¼•ï¼‰
/ | \
[5,10] â†’ [10,15] â†’ [20,25] â†’ [NULL] â† å¶å­èŠ‚ç‚¹ï¼ˆå­˜å‚¨æ•°æ®+é“¾è¡¨æŒ‡é’ˆï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-bæ ‘çš„æ“ä½œåŸç†"&gt;âš™ï¸ B+æ ‘çš„æ“ä½œåŸç†
&lt;/h3&gt;&lt;h4 id="æŸ¥æ‰¾search"&gt;&lt;strong&gt;æŸ¥æ‰¾ï¼ˆSearchï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å•å€¼æŸ¥è¯¢&lt;/strong&gt;ï¼šä»æ ¹èŠ‚ç‚¹é€å±‚æ¯”è¾ƒé”®å€¼ï¼Œç›´è‡³å¶å­èŠ‚ç‚¹è·å–æ•°æ®ï¼ˆå³ä½¿ä¸­é—´åŒ¹é…ä¹Ÿç»§ç»­ä¸‹æ¢ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;èŒƒå›´æŸ¥è¯¢ï¼š
&lt;ul&gt;
&lt;li&gt;å®šä½èµ·å§‹é”®å€¼æ‰€åœ¨çš„å¶å­èŠ‚ç‚¹ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ²¿é“¾è¡¨é¡ºåºéå†è‡³ç»ˆæ­¢é”®å€¼ï¼Œé¿å…å›æº¯ä¸Šå±‚èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ’å…¥insert"&gt;&lt;strong&gt;æ’å…¥ï¼ˆInsertï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;å®šä½ç›®æ ‡å¶å­èŠ‚ç‚¹å¹¶æ’å…¥é”®å€¼ï¼›&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹åˆ†è£‚ï¼ˆè‹¥æº¢å‡ºï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;å°†å¶å­èŠ‚ç‚¹æ‹†åˆ†ä¸ºä¸¤ä¸ªæ–°èŠ‚ç‚¹ï¼ˆå·¦èŠ‚ç‚¹ä¿ç•™âŒˆm/2âŒ‰ä¸ªé”®ï¼Œå³èŠ‚ç‚¹ä¿ç•™å‰©ä½™é”®ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å¤åˆ¶å³èŠ‚ç‚¹æœ€å°é”®åˆ°çˆ¶èŠ‚ç‚¹ä½œä¸ºæ–°ç´¢å¼•ï¼ˆéå¶å­èŠ‚ç‚¹åˆ†è£‚æ—¶ä»…ç§»åŠ¨é”®ï¼Œä¸å¤åˆ¶æ•°æ®ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€’å½’æ£€æŸ¥çˆ¶èŠ‚ç‚¹æ˜¯å¦æº¢å‡ºï¼Œç›´è‡³æ ¹èŠ‚ç‚¹åˆ†è£‚ï¼ˆæ ‘é«˜+1ï¼‰ã€‚
&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š4é˜¶æ ‘æ’å…¥32å¯¼è‡´åˆ†è£‚ â†’ å¶å­èŠ‚ç‚¹åˆ†è£‚ï¼Œ36ä¸Šç§»çˆ¶èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="åˆ é™¤delete"&gt;&lt;strong&gt;åˆ é™¤ï¼ˆDeleteï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;åˆ é™¤å¶å­èŠ‚ç‚¹ä¸­çš„é”®å€¼ï¼›&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹åˆå¹¶ï¼ˆè‹¥ä¸‹æº¢ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥é”®æ•° &lt;code&gt;&amp;lt;âŒˆm/2âŒ‰-1&lt;/code&gt;ï¼Œå‘å…„å¼ŸèŠ‚ç‚¹å€Ÿé”®ï¼ˆå·¦æ—‹/å³æ—‹ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥å…„å¼ŸèŠ‚ç‚¹æ— å†—ä½™é”®ï¼Œä¸ç›¸é‚»èŠ‚ç‚¹åˆå¹¶ï¼Œé€’å½’è°ƒæ•´çˆ¶èŠ‚ç‚¹ç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-bæ ‘çš„æ ¸å¿ƒä¼˜åŠ¿"&gt;ğŸš€ B+æ ‘çš„æ ¸å¿ƒä¼˜åŠ¿
&lt;/h3&gt;&lt;h4 id="ç£ç›˜ioä¼˜åŒ–"&gt;&lt;strong&gt;ç£ç›˜I/Oä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ‰‡å‡ºï¼ˆFan-outï¼‰&lt;/strong&gt;ï¼šéå¶å­èŠ‚ç‚¹ä¸å­˜æ•°æ®ï¼Œå•èŠ‚ç‚¹å¯å®¹çº³æ›´å¤šé”®ï¼Œæ˜¾è‘—é™ä½æ ‘é«˜ï¼Œå‡å°‘ç£ç›˜è®¿é—®æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡åŠ è½½&lt;/strong&gt;ï¼šè¿ç»­å¶å­èŠ‚ç‚¹é“¾è¡¨åŠ é€Ÿå…¨è¡¨æ‰«æï¼ˆå¦‚æ•°æ®åº“&lt;code&gt;SELECT *&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æŸ¥è¯¢æ•ˆç‡ä¼˜åŠ¿"&gt;&lt;strong&gt;æŸ¥è¯¢æ•ˆç‡ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;B+æ ‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Bæ ‘&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å•ç‚¹æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¨³å®šO(log n)ï¼Œéœ€éå†è‡³å¶å­èŠ‚ç‚¹&lt;/td&gt;
&lt;td&gt;å¯èƒ½æå‰ç»ˆæ­¢ï¼ˆæ•°æ®å­˜å†…éƒ¨èŠ‚ç‚¹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é“¾è¡¨éå†ç›¸é‚»å¶å­èŠ‚ç‚¹ï¼ˆO(1)è·³è½¬ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€å›æº¯ä¸Šå±‚èŠ‚ç‚¹ï¼ˆéšæœºI/Oå¤šï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ç¼“å­˜å‹å¥½æ€§"&gt;&lt;strong&gt;ç¼“å­˜å‹å¥½æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å±€éƒ¨æ€§&lt;/strong&gt;ï¼šå¶å­èŠ‚ç‚¹æ•°æ®ç´§å¯†æ’åˆ—ï¼Œæé«˜ç¼“å­˜å‘½ä¸­ç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯"&gt;ğŸ–¥ï¸ åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ•°æ®åº“ç´¢å¼•ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MySQL InnoDB&lt;/strong&gt;ï¼šä¸»é”®ç´¢å¼•é‡‡ç”¨B+æ ‘ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨è¡Œæ•°æ®ï¼ˆèšç°‡ç´¢å¼•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢ä¼˜åŒ–&lt;/strong&gt;ï¼š&lt;code&gt;WHERE age BETWEEN 20 AND 30&lt;/code&gt; ç›´æ¥éå†é“¾è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶ç³»ç»Ÿï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;NTFS/ReiserFS&lt;/strong&gt;ï¼šç”¨B+æ ‘ç´¢å¼•æ–‡ä»¶å…ƒæ•°æ®ï¼ˆå¦‚æ–‡ä»¶åã€ä½ç½®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤§æ•°æ®å­˜å‚¨ï¼š
&lt;ul&gt;
&lt;li&gt;æ•°æ®ä»“åº“æ—¥å¿—åˆ†æï¼ˆé«˜æ•ˆæ‰«ææ—¶é—´èŒƒå›´æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-bæ ‘-vs-bæ ‘"&gt;âš–ï¸ B+æ ‘ vs. Bæ ‘
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;B+æ ‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Bæ ‘&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å­˜å‚¨ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…å¶å­èŠ‚ç‚¹&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰èŠ‚ç‚¹å‡å­˜æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é“¾è¡¨æ”¯æŒï¼ˆé«˜æ•ˆï¼‰&lt;/td&gt;
&lt;td&gt;éœ€å›æº¯ä¸Šå±‚ï¼ˆä½æ•ˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ‘é«˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ›´ä½ï¼ˆå†…éƒ¨èŠ‚ç‚¹çº¯ç´¢å¼•ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ï¼ˆèŠ‚ç‚¹å­˜æ•°æ®ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“ç´¢å¼•ã€æ–‡ä»¶ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;ç¼“å­˜ç³»ç»Ÿã€æ—©æœŸMongoDB&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;B+æ ‘é€šè¿‡&lt;strong&gt;æ•°æ®ä¸ç´¢å¼•åˆ†ç¦»&lt;/strong&gt;ï¼ˆå¶å­èŠ‚ç‚¹å­˜æ•°æ®+é“¾è¡¨ã€éå¶å­èŠ‚ç‚¹çº¯ç´¢å¼•ï¼‰å’Œ&lt;strong&gt;é«˜æ‰‡å‡ºè®¾è®¡&lt;/strong&gt;ï¼Œåœ¨ç£ç›˜å¯†é›†å‹åœºæ™¯ä¸­å®ç°é«˜æ•ˆæŸ¥è¯¢ï¼ˆå°¤å…¶èŒƒå›´æ“ä½œï¼‰ï¼Œæˆä¸ºç°ä»£æ•°æ®åº“ï¼ˆå¦‚MySQLï¼‰å’Œæ–‡ä»¶ç³»ç»Ÿçš„æ ¸å¿ƒåŸºç¡€è®¾æ–½ã€‚å…¶ä»£ä»·æ˜¯å®ç°å¤æ‚åº¦è¾ƒé«˜ï¼ˆå¦‚é“¾è¡¨ç»´æŠ¤ï¼‰ï¼Œä½†å¯¹è¯»å¤šå†™å°‘ã€æµ·é‡æ•°æ®åœºæ™¯çš„æ€§èƒ½æå‡æ˜¾è‘—ã€‚ç†è§£å…¶ç»“æ„æ˜¯ä¼˜åŒ–æ•°æ®åº“ç´¢å¼•è®¾è®¡çš„å…³é”®åŸºç¡€ã€‚&lt;/p&gt;
&lt;h2 id="æ§½æ•°ç»„"&gt;æ§½æ•°ç»„
&lt;/h2&gt;&lt;p&gt;InnoDB æ•°æ®é¡µä¸­çš„&lt;strong&gt;æ§½æ•°ç»„ï¼ˆSlot Arrayï¼‰&lt;/strong&gt; æ˜¯é¡µç›®å½•ï¼ˆPage Directoryï¼‰çš„æ ¸å¿ƒç»„ä»¶ï¼Œæœ¬è´¨æ˜¯&lt;strong&gt;ç”¨äºåŠ é€Ÿé¡µå†…è®°å½•æŸ¥æ‰¾çš„ç´¢å¼•ç»“æ„&lt;/strong&gt;ï¼Œé€šè¿‡äºŒåˆ†æ³•å¿«é€Ÿå®šä½ç›®æ ‡è®°å½•æ‰€åœ¨çš„åˆ†ç»„ï¼Œé¿å…å…¨é“¾è¡¨éå†ã€‚å…¶è®¾è®¡é€»è¾‘ä¸å®ç°æœºåˆ¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ§½æ•°ç»„çš„ä½œç”¨ä¸è®¾è®¡åŸç†"&gt;âš™ï¸ æ§½æ•°ç»„çš„ä½œç”¨ä¸è®¾è®¡åŸç†
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³é“¾è¡¨æŸ¥æ‰¾çš„ä½æ•ˆé—®é¢˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;InnoDB æ•°æ®é¡µä¸­çš„è®°å½•æŒ‰ä¸»é”®é¡ºåºç»„æˆ&lt;strong&gt;å•å‘é“¾è¡¨&lt;/strong&gt;ï¼ˆé€šè¿‡ &lt;code&gt;next_record&lt;/code&gt; æŒ‡é’ˆè¿æ¥ï¼‰ï¼Œç›´æ¥éå†é“¾è¡¨çš„å¤æ‚åº¦ä¸º O(n)ã€‚&lt;/li&gt;
&lt;li&gt;æ§½æ•°ç»„å°†è®°å½•åˆ†ç»„ï¼Œå­˜å‚¨æ¯ç»„æœ€å¤§è®°å½•çš„&lt;strong&gt;åœ°å€åç§»é‡&lt;/strong&gt;ï¼Œå®ç°äºŒåˆ†æŸ¥æ‰¾ï¼ˆå¤æ‚åº¦ O(log n)ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç»„è§„åˆ™ä¸æ§½çš„å½¢æˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰æœ‰æ•ˆè®°å½•ï¼ˆåŒ…æ‹¬è™šæ‹Ÿè®°å½• Infimum/Supremumï¼‰è¢«åˆ’åˆ†ä¸ºå¤šä¸ªç»„ï¼Œæ¯ç»„åŒ…å« 4-8 æ¡è®°å½•ï¼ˆé™¤é¦–å°¾ç»„å¤–ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¦–ç»„&lt;/strong&gt;ï¼šä»…åŒ…å«æœ€å°è®°å½•ï¼ˆInfimumï¼‰ï¼Œå›ºå®š 1 æ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°¾ç»„&lt;/strong&gt;ï¼šåŒ…å«æœ€å¤§è®°å½•ï¼ˆSupremumï¼‰ï¼Œè®°å½•æ•°åœ¨ 1-8 æ¡ä¹‹é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸­é—´ç»„&lt;/strong&gt;ï¼šæ¯ç»„ 4-8 æ¡è®°å½•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¯ç»„æœ€åä¸€æ¡è®°å½•ï¼ˆç»„å†…ä¸»é”®æœ€å¤§ï¼‰çš„ &lt;code&gt;n_owned&lt;/code&gt; å±æ€§æ ‡è®°ç»„å†…è®°å½•æ•°ï¼Œå…¶åœ°å€åç§»é‡è¢«æå–ä¸º&lt;strong&gt;æ§½ï¼ˆSlotï¼‰&lt;/strong&gt;ï¼ŒæŒ‰åºå­˜å‚¨äºé¡µå°¾éƒ¨ï¼ˆPage Directoryï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ§½æ•°ç»„çš„å·¥ä½œæµç¨‹ä»¥æŸ¥æ‰¾ä¸»é”®-k-ä¸ºä¾‹"&gt;ğŸ” æ§½æ•°ç»„çš„å·¥ä½œæµç¨‹ï¼ˆä»¥æŸ¥æ‰¾ä¸»é”® K ä¸ºä¾‹ï¼‰
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;äºŒåˆ†å®šä½ç›®æ ‡æ§½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨æ§½æ•°ç»„ä¸­äºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æ»¡è¶³æ¡ä»¶ï¼š
æ§½å€¼ â‰¤ K &amp;lt; ä¸‹ä¸€æ§½å€¼çš„æ§½ï¼ˆæ§½å€¼å³è¯¥æ§½æŒ‡å‘è®°å½•çš„ä¸»é”®ï¼‰ã€‚
ç¤ºä¾‹ï¼šè‹¥æ§½æ•°ç»„ä¸º [4, 8, 12, 16]ï¼ŒæŸ¥æ‰¾ K=11ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸­ä½æ§½ &lt;code&gt;8 &amp;lt; 11&lt;/code&gt; â†’ å‘å³ç»§ç»­ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸‹ä¸€ä¸­ä½æ§½ &lt;code&gt;12 &amp;gt; 11&lt;/code&gt; â†’ ç›®æ ‡åœ¨æ§½ &lt;code&gt;8&lt;/code&gt; å’Œ &lt;code&gt;12&lt;/code&gt; ä¹‹é—´ï¼Œå³æ§½ &lt;code&gt;8&lt;/code&gt; å¯¹åº”ç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éå†ç»„å†…é“¾è¡¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡æ§½ &lt;code&gt;8&lt;/code&gt; å®šä½åˆ°ç»„å†…ä¸»é”®æœ€å¤§çš„è®°å½•ï¼ˆä¸»é”®=8ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ²¿ &lt;code&gt;next_record&lt;/code&gt; æŒ‡é’ˆæ‰¾åˆ°ç»„å†…æœ€å°è®°å½•ï¼ˆä¸»é”®=9ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;éå†ç»„å†…é“¾è¡¨ï¼ˆ9â†’10â†’11ï¼‰ï¼Œå®šä½ç›®æ ‡è®°å½•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ§½æ•°ç»„çš„ç‰©ç†å­˜å‚¨ä¸ç»´æŠ¤"&gt;ğŸ§© æ§½æ•°ç»„çš„ç‰©ç†å­˜å‚¨ä¸ç»´æŠ¤
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®ä¸ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½äºæ•°æ®é¡µå°¾éƒ¨çš„ &lt;strong&gt;Page Directory&lt;/strong&gt; åŒºåŸŸï¼Œç”±å¤šä¸ªæ§½ï¼ˆSlotï¼‰ç»„æˆï¼Œæ¯ä¸ªæ§½å  &lt;strong&gt;2 å­—èŠ‚&lt;/strong&gt;ï¼Œå­˜å‚¨è®°å½•çš„åç§»é‡ã€‚&lt;/li&gt;
&lt;li&gt;æ§½çš„æ•°é‡ç”± &lt;code&gt;PAGE_N_DIR_SLOTS&lt;/code&gt;ï¼ˆPage Header ä¸­ï¼‰è®°å½•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ç»´æŠ¤æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ’å…¥è®°å½•ï¼š
&lt;ul&gt;
&lt;li&gt;æ–°è®°å½•æŒ‰ä¸»é”®é¡ºåºæ’å…¥é“¾è¡¨ï¼Œè‹¥ç»„å†…è®°å½•æ•°è¶…è¿‡ 8 æ¡ï¼Œåˆ™æ‹†åˆ†ä¸ºä¸¤ç»„ï¼ˆå¦‚ 8 æ¡æ‹†ä¸º 4+4ï¼‰ï¼Œæ–°å¢æ§½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ é™¤è®°å½•ï¼š
&lt;ul&gt;
&lt;li&gt;è®°å½•æ ‡è®° &lt;code&gt;delete_mask=1&lt;/code&gt; ç§»å…¥åƒåœ¾é“¾è¡¨ï¼Œè‹¥ç»„å†…è®°å½•æ•°ä½äº 4 æ¡ï¼Œåˆ™åˆå¹¶ç›¸é‚»ç»„å¹¶å‡å°‘æ§½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ§½æ•°ç»„çš„ä»·å€¼ä¸é™åˆ¶"&gt;âš–ï¸ æ§½æ•°ç»„çš„ä»·å€¼ä¸é™åˆ¶
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é™åˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æŸ¥è¯¢å¤æ‚åº¦ä» O(n) â†’ O(log n)&lt;/td&gt;
&lt;td&gt;ä»…æ”¯æŒä¸»é”®/ç´¢å¼•é”®æ’åºæŸ¥è¯¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‡å°‘ç£ç›˜ I/Oï¼ˆé¿å…å…¨é¡µæ‰«æï¼‰&lt;/td&gt;
&lt;td&gt;é¢‘ç¹å¢åˆ å¯èƒ½å¯¼è‡´æ§½é¢‘ç¹åˆ†è£‚åˆå¹¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸ B+ æ ‘ååŒåŠ é€Ÿç´¢å¼•å®šä½&lt;/td&gt;
&lt;td&gt;æ— æ³•è·³è¿‡åˆ†ç»„ç›´æ¥è®¿é—®è®°å½•&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ§½æ•°ç»„æ˜¯ InnoDB åœ¨æ•°æ®é¡µå†…å®ç°çš„&lt;strong&gt;å¾®å‹ç´¢å¼•&lt;/strong&gt;ï¼Œé€šè¿‡åˆ†ç»„+äºŒåˆ†æ³•å°†è®°å½•æŸ¥æ‰¾æ•ˆç‡æå‡è‡³å¯¹æ•°çº§ï¼Œæ˜¯ B+ æ ‘ç´¢å¼•çš„åº•å±‚æ”¯æ’‘ã€‚å…¶è®¾è®¡ä½“ç°äº†&lt;strong&gt;ç©ºé—´æ¢æ—¶é—´&lt;/strong&gt;çš„æ€æƒ³ï¼šä»¥å°‘é‡æ§½å­˜å‚¨ç©ºé—´æ¢å–é«˜æ•ˆæ£€ç´¢èƒ½åŠ›ï¼Œå°¤å…¶é€‚åˆä¸»é”®æŸ¥è¯¢ä¸èŒƒå›´æ‰«æã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šç†è§£æ§½æ•°ç»„æœºåˆ¶æœ‰åŠ©äºä¼˜åŒ–ç´¢å¼•è®¾è®¡ï¼ˆå¦‚é¿å…éšæœºå†™å…¥å¯¼è‡´çš„é¡µåˆ†è£‚ï¼‰åŠè¯Šæ–­æ…¢æŸ¥è¯¢é—®é¢˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="é¡µæ–­è£‚"&gt;é¡µæ–­è£‚
&lt;/h2&gt;&lt;p&gt;â€œé¡µæ–­è£‚â€ï¼ˆPartial Writeï¼‰æ˜¯æ•°æ®åº“ç³»ç»Ÿä¸­å› &lt;strong&gt;å†™å…¥æ“ä½œè¢«æ„å¤–ä¸­æ–­å¯¼è‡´ç£ç›˜é¡µæ•°æ®ä¸å®Œæ•´&lt;/strong&gt;çš„ç°è±¡ï¼Œå°¤å…¶åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ä¼šå¼•å‘ä¸¥é‡ä¸€è‡´æ€§é—®é¢˜ã€‚å…¶æ ¸å¿ƒæœºåˆ¶ä¸å½±å“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-é¡µæ–­è£‚çš„æˆå› ä¸æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;é¡µæ–­è£‚çš„æˆå› ä¸æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å—å¤§å°ä¸åŒ¹é…&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“é¡µ&lt;/strong&gt;ï¼ˆå¦‚InnoDBé»˜è®¤16KBï¼‰ç”±å¤šä¸ª&lt;strong&gt;æ“ä½œç³»ç»Ÿé¡µ&lt;/strong&gt;ï¼ˆé€šå¸¸4KBï¼‰ç»„æˆï¼Œè€ŒOSé¡µåˆç”±å¤šä¸ª&lt;strong&gt;ç£ç›˜æ‰‡åŒº&lt;/strong&gt;ï¼ˆé€šå¸¸512Bï¼‰æ„æˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™å…¥è¿‡ç¨‹&lt;/strong&gt;ï¼šæ•°æ®åº“é¡µéœ€æ‹†è§£ä¸ºå¤šä¸ªOSé¡µï¼Œå†è½¬æ¢ä¸ºæ‰‡åŒºå†™å…¥ç£ç›˜ã€‚è‹¥å†™å…¥ä¸­é€”å‘ç”Ÿå®•æœºï¼ˆå¦‚æ–­ç”µã€OSå´©æºƒï¼‰ï¼Œå¯èƒ½ä»…éƒ¨åˆ†æ‰‡åŒºå†™å…¥æˆåŠŸï¼Œå¯¼è‡´æ•°æ®åº“é¡µ&lt;strong&gt;åŠæˆªæ›´æ–°&lt;/strong&gt;ï¼Œå³é¡µæ–­è£‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;ç¤ºä¾‹&lt;/em&gt;ï¼š16KBçš„InnoDBé¡µéœ€å†™å…¥4ä¸ª4KBçš„OSé¡µã€‚è‹¥ç¬¬3ä¸ªOSé¡µå†™å…¥æ—¶å®•æœºï¼Œè¯¥æ•°æ®åº“é¡µå³å¤„äºæ–­è£‚çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—æ¢å¤çš„å±€é™æ€§&lt;/strong&gt;
InnoDBä½¿ç”¨&lt;strong&gt;ç‰©ç†é€»è¾‘æ—¥å¿—&lt;/strong&gt;â€‹ï¼ˆPhysiological Loggingï¼‰ï¼Œå…¶é‡åšï¼ˆRedoï¼‰æ—¥å¿—ä¾èµ–é¡µé¢çš„åˆå§‹ä¸€è‡´æ€§çŠ¶æ€ã€‚è‹¥é¡µé¢æœ¬èº«æ–­è£‚ï¼Œæ—¥å¿—æ— æ³•ä¿®å¤è¯¥é¡µï¼Œå¯¼è‡´å´©æºƒæ¢å¤å¤±è´¥ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é¡µæ–­è£‚çš„å±å®³"&gt;âš ï¸ &lt;strong&gt;é¡µæ–­è£‚çš„å±å®³&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸ä¸€è‡´&lt;/strong&gt;
æ–­è£‚é¡µå¯èƒ½åŒ…å«æ–°æ—§æ•°æ®æ··åˆï¼ˆå¦‚ç´¢å¼•åˆ†è£‚æœªå®Œæˆï¼‰ï¼Œç ´åB+æ ‘ç»“æ„ï¼Œå¯¼è‡´æŸ¥è¯¢ç»“æœé”™è¯¯æˆ–å´©æºƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å´©æºƒæ¢å¤å¤±æ•ˆ&lt;/strong&gt;
InnoDBä¾èµ–Redoæ—¥å¿—é‡æ”¾æ¢å¤æ•°æ®ï¼Œä½†æ–­è£‚é¡µæ— æ³•è¢«æ­£ç¡®è§£æï¼Œä½¿æ¢å¤è¿‡ç¨‹ä¸­æ–­ï¼Œæ•°æ®åº“æ— æ³•å¯åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡ä¸­æ–­é£é™©&lt;/strong&gt;
éœ€äººå·¥ä¿®å¤æˆ–ä»å¤‡ä»½æ¢å¤ï¼Œå¢åŠ åœæœºæ—¶é—´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-innodbçš„è§£å†³æ–¹æ¡ˆdoublewriteæŠ€æœ¯"&gt;ğŸ›¡ï¸ &lt;strong&gt;InnoDBçš„è§£å†³æ–¹æ¡ˆï¼šDoublewriteæŠ€æœ¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸ºè§£å†³é¡µæ–­è£‚ï¼ŒInnoDBå¼•å…¥&lt;strong&gt;Doublewrite Buffer&lt;/strong&gt;æœºåˆ¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŒå†™æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Step 1&lt;/strong&gt;ï¼šæ•°æ®é¡µå…ˆå†™å…¥å†…å­˜ä¸­çš„Doublewrite Bufferï¼ˆå…±äº«è¡¨ç©ºé—´å†…ï¼Œ2MBå›ºå®šåŒºåŸŸï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Step 2&lt;/strong&gt;ï¼šè°ƒç”¨&lt;code&gt;fsync()&lt;/code&gt;å°†Buffer&lt;strong&gt;é¡ºåºå†™å…¥&lt;/strong&gt;ç£ç›˜ï¼ˆè¿ç»­I/Oï¼Œé«˜æ•ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Step 3&lt;/strong&gt;ï¼šå†å°†æ•°æ®é¡µ&lt;strong&gt;ç¦»æ•£å†™å…¥&lt;/strong&gt;å®é™…è¡¨ç©ºé—´æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[æ•°æ®é¡µä¿®æ”¹] --&amp;gt; B[å†™å…¥Doublewrite Buffer]
B --&amp;gt; C[fsyncé¡ºåºå†™ç£ç›˜]
C --&amp;gt; D[å†™å…¥å®é™…è¡¨ç©ºé—´]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å´©æºƒæ¢å¤æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥å®é™…è¡¨ç©ºé—´é¡µæ–­è£‚ï¼Œä»DoublewriteåŒºè¯»å–å®Œæ•´å‰¯æœ¬è¦†ç›–æ–­è£‚é¡µã€‚&lt;/li&gt;
&lt;li&gt;å†åº”ç”¨Redoæ—¥å¿—ä¿®å¤æ•°æ®ï¼Œç¡®ä¿é¡µé¢ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;ä»£ä»·&lt;/em&gt;ï¼šé¢å¤–å†™æ“ä½œï¼ˆçº¦5-10%æ€§èƒ½æŸè€—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;æ”¶ç›Š&lt;/em&gt;ï¼šé¿å…é¡µæ–­è£‚å¯¼è‡´çš„æ•°æ®ç¾éš¾ï¼Œä¿éšœACIDç‰¹æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é¡µæ–­è£‚-vs-é¡µç¼ºå¤±page-fault"&gt;ğŸ”„ &lt;strong&gt;é¡µæ–­è£‚ vs. é¡µç¼ºå¤±ï¼ˆPage Faultï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;éœ€æ³¨æ„ä¸&lt;strong&gt;æ“ä½œç³»ç»Ÿé¡µç¼ºå¤±&lt;/strong&gt;ï¼ˆPage Faultï¼‰çš„åŒºåˆ«ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é¡µæ–­è£‚ï¼ˆPartial Writeï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é¡µç¼ºå¤±ï¼ˆPage Faultï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‘ç”Ÿåœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“å†™å…¥ç£ç›˜æ—¶ä¸­æ–­&lt;/td&gt;
&lt;td&gt;ç¨‹åºè®¿é—®æœªåŠ è½½åˆ°ç‰©ç†å†…å­˜çš„è™šæ‹Ÿé¡µ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®•æœºå¯¼è‡´ç£ç›˜æ‰‡åŒºå†™å…¥ä¸å®Œæ•´&lt;/td&gt;
&lt;td&gt;è™šæ‹Ÿé¡µæœªæ˜ å°„æˆ–æœªåŠ è½½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤„ç†æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Doublewriteç¼“å†²åŒºä¿®å¤&lt;/td&gt;
&lt;td&gt;æ“ä½œç³»ç»Ÿè°ƒå…¥ç¼ºå¤±é¡µï¼ˆç¡¬ä¸­æ–­éœ€ç£ç›˜I/Oï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å½±å“çº§åˆ«&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“ä¸€è‡´æ€§å´©æºƒ&lt;/td&gt;
&lt;td&gt;ç¨‹åºæ€§èƒ½ä¸‹é™ï¼ˆç¡¬ä¸­æ–­å»¶è¿Ÿé«˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;InnoDBå†…ç½®Doublewrite&lt;/td&gt;
&lt;td&gt;é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆå¦‚LRUï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é¡µç¼ºå¤±ç±»å‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¡¬æ€§ä¸­æ–­&lt;/strong&gt;ï¼šæ•°æ®éœ€ä»ç£ç›˜åŠ è½½ï¼ˆæœºæ¢°ç¡¬ç›˜å»¶è¿Ÿè¾¾æ¯«ç§’çº§ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯æ€§ä¸­æ–­&lt;/strong&gt;ï¼šé¡µå·²åœ¨å†…å­˜ä½†æœªæ³¨å†ŒMMUï¼ˆå¾®ç§’çº§ä¿®å¤ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é¡µæ–­è£‚æ˜¯æ•°æ®åº“å†™å…¥ä¸­æ–­å¼•å‘çš„&lt;strong&gt;ç£ç›˜çº§æ•°æ®æŸå&lt;/strong&gt;ï¼Œé€šè¿‡InnoDBçš„DoublewriteæŠ€æœ¯å°†&lt;strong&gt;éšæœºå†™è½¬ä¸ºé¡ºåºå†™+æ ¡éªŒ&lt;/strong&gt;ï¼Œä»¥å¯æ§æ€§èƒ½ä»£ä»·ä¿éšœæ•°æ®å®‰å…¨ã€‚è€Œæ“ä½œç³»ç»Ÿé¡µç¼ºå¤±æ˜¯&lt;strong&gt;å†…å­˜ç®¡ç†æœºåˆ¶&lt;/strong&gt;ï¼Œé€šè¿‡ç¼ºé¡µä¸­æ–­åŠ¨æ€åŠ è½½æ•°æ®ï¼ŒäºŒè€…æœ¬è´¨ä¸åŒä½†å‡ä¸ºç³»ç»Ÿå¯é æ€§çš„æ ¸å¿ƒè¯¾é¢˜ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼šé™¤éç¡®è®¤ç£ç›˜æ”¯æŒåŸå­å†™ï¼ˆå¦‚SSDçš„512e/4Kæ‰‡åŒºï¼‰ï¼Œå¦åˆ™åˆ‡å‹¿å…³é—­InnoDBçš„DoublewriteåŠŸèƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="innodb-é¡µæ–­è£‚"&gt;InnoDB é¡µæ–­è£‚
&lt;/h2&gt;&lt;p&gt;InnoDBå¼•æ“é€šè¿‡&lt;strong&gt;å¤šçº§æ ¡éªŒæœºåˆ¶&lt;/strong&gt;æ„ŸçŸ¥é¡µæ–­è£‚ï¼ˆPartial Page Writeï¼‰ï¼Œä¸»è¦ä¾èµ–&lt;strong&gt;é¡µç»“æ„æ ¡éªŒã€Doublewrite Bufferæ¯”å¯¹åŠRedo LogååŒéªŒè¯&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æœºåˆ¶ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-é¡µç»“æ„è‡ªæ ¡éªŒç‰©ç†å®Œæ•´æ€§éªŒè¯"&gt;ğŸ” é¡µç»“æ„è‡ªæ ¡éªŒï¼šç‰©ç†å®Œæ•´æ€§éªŒè¯
&lt;/h3&gt;&lt;p&gt;æ¯ä¸ªInnoDBæ•°æ®é¡µï¼ˆ16KBï¼‰åŒ…å«å›ºå®šæ ¼å¼çš„å¤´éƒ¨å’Œå°¾éƒ¨å…ƒæ•°æ®ï¼Œç”¨äºæ£€æµ‹ç‰©ç†ä¸€è‡´æ€§ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;File Trailerï¼ˆæ–‡ä»¶å°¾ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½äºé¡µæœ«å°¾çš„8å­—èŠ‚ï¼ŒåŒ…å«&lt;strong&gt;æ ¡éªŒå’Œï¼ˆChecksumï¼‰&lt;/strong&gt; å’Œ&lt;strong&gt;æ—¥å¿—åºåˆ—å·ï¼ˆLSNï¼‰&lt;/strong&gt; ã€‚&lt;/li&gt;
&lt;li&gt;å´©æºƒæ¢å¤æ—¶ï¼ŒInnoDBå¯¹æ¯”é¡µå¤´éƒ¨ï¼ˆFile Headerï¼‰ä¸å°¾éƒ¨çš„æ ¡éªŒå’Œï¼šè‹¥ä¸ä¸€è‡´ï¼Œè¡¨æ˜é¡µå†™å…¥ä¸å®Œæ•´ï¼ˆå¦‚ä»…å†™å…¥å‰4KBåå®•æœºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LSNï¼ˆLog Sequence Numberï¼‰æ ¡éªŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é¡µå¤´éƒ¨å­˜å‚¨æœ€åä¿®æ”¹çš„LSNï¼ŒFile Trailerå­˜å‚¨ç›¸åŒLSNçš„å‰¯æœ¬ã€‚è‹¥ä¸¤è€…ä¸åŒ¹é…ï¼Œè¯´æ˜é¡µæœªå®Œæ•´åˆ·ç›˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;æ„ŸçŸ¥é€»è¾‘&lt;/strong&gt;ï¼šé¡µåŠ è½½åˆ°å†…å­˜æ—¶å¼ºåˆ¶æ ¡éªŒï¼Œå¤±è´¥åˆ™æ ‡è®°ä¸º&amp;quot;æ–­è£‚é¡µ&amp;quot;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-doublewrite-bufferæ¯”å¯¹å‰¯æœ¬æ¢å¤æœºåˆ¶"&gt;ğŸ”„ Doublewrite Bufferæ¯”å¯¹ï¼šå‰¯æœ¬æ¢å¤æœºåˆ¶
&lt;/h3&gt;&lt;p&gt;è‹¥é¡µè‡ªæ ¡éªŒå¤±è´¥ï¼ŒInnoDBè½¬å‘Doublewrite Bufferï¼ˆä½äºå…±äº«è¡¨ç©ºé—´ibdata1ï¼‰éªŒè¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Doublewrite Bufferç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;2MBè¿ç»­ç©ºé—´ï¼ˆ128ä¸ªé¡µï¼‰ï¼Œåˆ†ä¸ºä¸¤ä¸ª1MBçš„Chunkï¼Œç”¨äºæš‚å­˜è„é¡µå‰¯æœ¬ã€‚&lt;/li&gt;
&lt;li&gt;è„é¡µåˆ·ç›˜æµç¨‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[Buffer Poolè„é¡µ] --&amp;gt; B[å†™å…¥Doublewrite Buffer]
B --&amp;gt; C[fsyncé¡ºåºå†™ç£ç›˜]
C --&amp;gt; D[å†™å…¥å®é™…è¡¨ç©ºé—´.ibdæ–‡ä»¶]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å´©æºƒæ¢å¤æ—¶çš„æ¯”å¯¹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥è¡¨ç©ºé—´ä¸­çš„é¡µæ ¡éªŒå¤±è´¥ï¼ŒInnoDBä»Doublewrite Bufferæå–å®Œæ•´å‰¯æœ¬è¦†ç›–æŸåé¡µã€‚&lt;/li&gt;
&lt;li&gt;è‹¥Doublewrite Bufferå‰¯æœ¬ä¹ŸæŸåï¼ˆæç½•è§ï¼‰ï¼Œåˆ™ä¾èµ–Redo Logä¿®å¤ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šDoublewriteæ˜¯é¡µæ–­è£‚çš„æ ¸å¿ƒè§£å†³æ–¹æ¡ˆï¼Œæä¾›&amp;quot;å¤‡ä»½é¡µ&amp;quot;ä¾›æ¢å¤ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-redo-logååŒéªŒè¯é€»è¾‘ä¸€è‡´æ€§å…œåº•"&gt;ğŸ“œ Redo LogååŒéªŒè¯ï¼šé€»è¾‘ä¸€è‡´æ€§å…œåº•
&lt;/h3&gt;&lt;p&gt;å½“Doublewriteä¸å¯ç”¨æ—¶ï¼ˆå¦‚ç¦ç”¨æˆ–å‰¯æœ¬æŸåï¼‰ï¼ŒInnoDBå°è¯•é€šè¿‡Redo Logä¿®å¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Redo Logçš„å±€é™æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Redo Logè®°å½•&lt;strong&gt;é¡µå†…é€»è¾‘å˜æ›´&lt;/strong&gt;ï¼ˆå¦‚&amp;quot;åœ¨é¡µXåç§»é‡Yå†™å…¥Z&amp;quot;ï¼‰ï¼Œä½†è¦æ±‚é¡µç‰©ç†ç»“æ„å®Œæ•´æ‰èƒ½åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;é¡µæ–­è£‚æ—¶ï¼Œé¡µå†…å…ƒæ•°æ®ï¼ˆå¦‚è®°å½•é“¾è¡¨ã€æ§½æ•°ç»„ï¼‰æŸåï¼ŒRedo Logæ— æ³•ç›´æ¥é‡æ”¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…œåº•ä¿®å¤ç­–ç•¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥é¡µæ–­è£‚ä¸”æ— æœ‰æ•ˆDoublewriteå‰¯æœ¬ï¼ŒInnoDBå°è¯•ï¼š
&lt;ol&gt;
&lt;li&gt;ä»ç£ç›˜åŠ è½½åŸå§‹é¡µï¼ˆå´©æºƒå‰ç‰ˆæœ¬ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é‡æ”¾Redo Logä¸­æ‰€æœ‰æ¶‰åŠè¯¥é¡µçš„ä¿®æ”¹ï¼Œé‡å»ºä¸€è‡´æ€§çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;æ­¤è¿‡ç¨‹ç¼“æ…¢ä¸”ä¾èµ–åŸå§‹é¡µå¯è¯»ï¼ŒæˆåŠŸç‡è¾ƒä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å´©æºƒæ¢å¤æµç¨‹å…¨é“¾è·¯æ„ŸçŸ¥é¡µæ–­è£‚"&gt;âš™ï¸ å´©æºƒæ¢å¤æµç¨‹ï¼šå…¨é“¾è·¯æ„ŸçŸ¥é¡µæ–­è£‚
&lt;/h3&gt;&lt;p&gt;InnoDBåœ¨å¯åŠ¨æ—¶æŒ‰åºæ‰§è¡Œä»¥ä¸‹æ­¥éª¤æ„ŸçŸ¥å¹¶ä¿®å¤é¡µæ–­è£‚ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é˜¶æ®µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é¡µæ–­è£‚å¤„ç†æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Redoå‰æ»š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åº”ç”¨Redo Logé‡åšå·²æäº¤äº‹åŠ¡&lt;/td&gt;
&lt;td&gt;è·³è¿‡æ–­è£‚é¡µï¼ˆå› æ— æ³•è§£æï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é¡µæ ¡éªŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ è½½è¡¨ç©ºé—´é¡µï¼Œæ ¡éªŒFile Header/Trailer&lt;/td&gt;
&lt;td&gt;æ ¡éªŒå¤±è´¥åˆ™æ ‡è®°ä¸ºæ–­è£‚é¡µ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Doublewriteæ¢å¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨Doublewriteå‰¯æœ¬è¦†ç›–æ–­è£‚é¡µ&lt;/td&gt;
&lt;td&gt;ä¼˜å…ˆä¿®å¤æ–­è£‚é¡µ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Undoå›æ»š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å›æ»šæœªæäº¤äº‹åŠ¡&lt;/td&gt;
&lt;td&gt;è‹¥æ–­è£‚é¡µæ¶‰åŠæœªæäº¤äº‹åŠ¡ï¼Œéœ€ç»“åˆUndo Logæ¸…ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼ºåˆ¶æ¢å¤æ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;innodb_force_recoveryâ‰¥1&lt;/code&gt;è·³è¿‡Redoå‰æ»šï¼Œä»…ä¿®å¤å…ƒæ•°æ®&lt;/td&gt;
&lt;td&gt;ç‰ºç‰²æ•°æ®ä¸€è‡´æ€§æ¢å–å¯åŠ¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“innodbå¦‚ä½•æ„ŸçŸ¥é¡µæ–­è£‚"&gt;ğŸ’ æ€»ç»“ï¼šInnoDBå¦‚ä½•æ„ŸçŸ¥é¡µæ–­è£‚
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¡µè‡ªæ ¡éªŒå¤±è´¥&lt;/strong&gt;ï¼šFile Headerä¸Trailerçš„æ ¡éªŒå’Œæˆ–LSNä¸åŒ¹é…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Doublewriteå‰¯æœ¬æ¯”å¯¹&lt;/strong&gt;ï¼šè¡¨ç©ºé—´é¡µæŸåæ—¶ï¼Œç”¨Doublewrite Bufferå®Œæ•´å‰¯æœ¬æ›¿æ¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Redo Logå…œåº•&lt;/strong&gt;ï¼šæç«¯æƒ…å†µä¸‹å°è¯•é‡æ”¾æ—¥å¿—é‡å»ºé¡µï¼ˆæ•ˆç‡ä½ä¸”ä¸å¯é ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ‡å‹¿å…³é—­Doublewrite&lt;/strong&gt;ï¼ˆé»˜è®¤å¼€å¯ï¼‰ï¼Œé™¤éä½¿ç”¨æ”¯æŒåŸå­å†™çš„å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚éƒ¨åˆ†é«˜çº§SSDï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é¡µæ–­è£‚æ˜¯ç‰©ç†æŸåï¼Œè€ŒInnoDBé€šè¿‡&lt;strong&gt;å†—ä½™å†™å…¥ï¼ˆDoublewriteï¼‰+ å¤šçº§æ ¡éªŒ&lt;/strong&gt;å®ç°é«˜å¯é æ€§ï¼Œä»£ä»·ä»…5%~10%å†™æ€§èƒ½æŸå¤±ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="é¦–å°¾æ ¡éªŒ"&gt;é¦–å°¾æ ¡éªŒ
&lt;/h2&gt;&lt;p&gt;InnoDBæ•°æ®é¡µå¤´éƒ¨ï¼ˆFile Headerï¼‰å’Œå°¾éƒ¨ï¼ˆFile Trailerï¼‰çš„æ ¡éªŒå’Œï¼ˆChecksumï¼‰åŠæ—¥å¿—åºåˆ—å·ï¼ˆLSNï¼‰æ˜¯ç¡®ä¿é¡µå®Œæ•´æ€§ä¸æ•°æ®ä¸€è‡´æ€§çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå…¶è®¡ç®—å’ŒéªŒè¯æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¡éªŒå’Œchecksumçš„è®¡ç®—ä¸ä½œç”¨"&gt;ğŸ”¢ &lt;strong&gt;æ ¡éªŒå’Œï¼ˆChecksumï¼‰çš„è®¡ç®—ä¸ä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—åŸç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç®—æ³•æ¼”è¿›&lt;/strong&gt;ï¼šæ—©æœŸç‰ˆæœ¬ä½¿ç”¨&lt;code&gt;InnoDBè‡ªæœ‰ç®—æ³•&lt;/code&gt;ï¼ˆå¦‚ç§»ä½å¼‚æˆ–ï¼‰ï¼ŒMySQL 5.7+ é»˜è®¤é‡‡ç”¨ &lt;strong&gt;CRC32&lt;/strong&gt;ï¼ˆå¤šé¡¹å¼ &lt;code&gt;0x1EDC6F41&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¾“å…¥æ•°æ®&lt;/strong&gt;ï¼šå¯¹æ•´ä¸ª16KBé¡µçš„å†…å®¹ï¼ˆé™¤File Trailerçš„8å­—èŠ‚å¤–ï¼‰è®¡ç®—æ ¡éªŒå€¼ã€‚&lt;/li&gt;
&lt;li&gt;å­˜å‚¨ä½ç½®ï¼š
&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶å¤´ï¼ˆFile Headerï¼‰ï¼š&lt;code&gt;FIL_PAGE_SPACE_OR_CHKSUM&lt;/code&gt;ï¼ˆ4å­—èŠ‚ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶å°¾ï¼ˆFile Trailerï¼‰ï¼šå‰4å­—èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éªŒè¯æµç¨‹&lt;/strong&gt;
å½“é¡µä»ç£ç›˜åŠ è½½åˆ°å†…å­˜æ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é‡æ–°è®¡ç®—å½“å‰é¡µçš„æ ¡éªŒå’Œ&lt;/strong&gt;ï¼ˆè·³è¿‡File Trailerï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”å¯¹ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥ä¸æ–‡ä»¶å¤´çš„æ ¡éªŒå’Œä¸ä¸€è‡´ â†’ é¡µä¼ è¾“ä¸­æ–­ï¼ˆå¦‚å†™å…¥æ—¶å®•æœºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‹¥ä¸æ–‡ä»¶å°¾çš„æ ¡éªŒå’Œä¸ä¸€è‡´ â†’ é¡µæœªå®Œæ•´åˆ·ç›˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ç›®çš„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é˜²é¡µæ–­è£‚ï¼ˆPartial Writeï¼‰&lt;/strong&gt;ï¼šç¡®ä¿16KBé¡µåœ¨å†™å…¥ç£ç›˜æ—¶ä¸ä¼šå› ç³»ç»Ÿå´©æºƒå¯¼è‡´éƒ¨åˆ†æ‰‡åŒºå†™å…¥ï¼ˆå¦‚ä»…å†™å…¥å‰4KBï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£é€å­—èŠ‚æ¯”å¯¹&lt;/strong&gt;ï¼šé€šè¿‡çŸ­æ ¡éªŒå€¼å¿«é€ŸéªŒè¯é•¿æ•°æ®ï¼Œé¿å…I/Oæ•ˆç‡æŸå¤±ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ—¥å¿—åºåˆ—å·lsnçš„è®¡ç®—ä¸ä½œç”¨"&gt;â±ï¸ &lt;strong&gt;æ—¥å¿—åºåˆ—å·ï¼ˆLSNï¼‰çš„è®¡ç®—ä¸ä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;LSNçš„æœ¬è´¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å…¨å±€é€’å¢çš„8å­—èŠ‚æ— ç¬¦å·æ•´æ•°ï¼Œæ ‡è®°Redo Logä¸­æ“ä½œçš„æ—¶åºä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;é¡µè¢«ä¿®æ”¹æ—¶ï¼Œ
å°†å½“å‰Redo Logçš„LSNå€¼
å†™å…¥ï¼š
&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶å¤´ï¼š&lt;code&gt;FIL_PAGE_LSN&lt;/code&gt;ï¼ˆ8å­—èŠ‚ï¼‰&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶å°¾ï¼šå4å­—èŠ‚ï¼ˆä»…å­˜å‚¨LSNçš„å4å­—èŠ‚ï¼Œå› é«˜ä½é€šå¸¸ä¸å˜ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éªŒè¯æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å´©æºƒæ¢å¤æ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯”å¯¹æ–‡ä»¶å¤´ä¸æ–‡ä»¶å°¾çš„LSNå€¼ï¼š&lt;/li&gt;
&lt;li&gt;è‹¥ä¸€è‡´ â†’ é¡µå·²å®Œæ•´å†™å…¥ã€‚
&lt;ul&gt;
&lt;li&gt;è‹¥æ–‡ä»¶å°¾LSN &amp;lt; æ–‡ä»¶å¤´LSN â†’ é¡µåˆ·ç›˜ä¸­æ–­ï¼ˆæ–‡ä»¶å¤´å…ˆå†™å…¥ï¼Œæ–‡ä»¶å°¾æœªå†™å…¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ ¡éªŒå’ŒååŒ&lt;/strong&gt;ï¼šLSNéªŒè¯é€»è¾‘ä¸€è‡´æ€§ï¼ˆæ“ä½œæ—¶åºï¼‰ï¼Œæ ¡éªŒå’ŒéªŒè¯ç‰©ç†å®Œæ•´æ€§ï¼ˆæ•°æ®å†…å®¹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ç›®çš„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å´©æºƒæ¢å¤å®šä½&lt;/strong&gt;ï¼šç¡®å®šå“ªäº›é¡µéœ€é€šè¿‡Redo Logé‡åšï¼ˆä»…é‡åšLSNå¤§äºç£ç›˜é¡µLSNçš„æ“ä½œï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…æ•°æ®å›é€€&lt;/strong&gt;ï¼šé˜²æ­¢å› éƒ¨åˆ†å†™å…¥å¯¼è‡´é¡µæ•°æ®ç‰ˆæœ¬å€’é€€ï¼ˆå¦‚å†™å…¥æ–°æ•°æ®åå´©æºƒï¼Œæ¢å¤æ—¶å›é€€åˆ°æ—§ç‰ˆæœ¬ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹ç¤ºä¾‹é¡µå†™å…¥ä¸å´©æºƒæ¢å¤"&gt;ğŸ”§ &lt;strong&gt;å·¥ä½œæµç¨‹ç¤ºä¾‹ï¼šé¡µå†™å…¥ä¸å´©æºƒæ¢å¤&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ­£å¸¸å†™å…¥æµç¨‹&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[å†…å­˜ä¸­ä¿®æ”¹é¡µ] --&amp;gt; B[è®¡ç®—æ–°æ ¡éªŒå’Œ]
B --&amp;gt; C[å†™å…¥æ–‡ä»¶å¤´ï¼šæ ¡éªŒå’Œ+LSN]
C --&amp;gt; D[å†™å…¥æ•´ä¸ªé¡µå†…å®¹]
D --&amp;gt; E[å†™å…¥æ–‡ä»¶å°¾ï¼šæ ¡éªŒå’Œ+LSN]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å´©æºƒæ¢å¤æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šå†™å…¥æ–‡ä»¶å¤´åæ–­ç”µï¼Œæ–‡ä»¶å°¾æœªå†™å…¥ã€‚&lt;/li&gt;
&lt;li&gt;æ£€æµ‹ï¼š
&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶å¤´æ ¡éªŒå’Œ â‰  æ–‡ä»¶å°¾æ ¡éªŒå’Œ â†’ &lt;strong&gt;é¡µç‰©ç†æŸå&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶å¤´LSN &amp;gt; æ–‡ä»¶å°¾LSN â†’ &lt;strong&gt;é¡µé€»è¾‘ä¸å®Œæ•´&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¿®å¤ï¼š
&lt;ul&gt;
&lt;li&gt;ä»Doublewrite BufferåŠ è½½å¤‡ä»½é¡µè¦†ç›–æŸåé¡µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç”¨Redo Logé‡åšLSNå¤§äºè¯¥é¡µåŸå§‹LSNçš„æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¡éªŒå’Œä¸lsnçš„ååŒå¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;æ ¡éªŒå’Œä¸LSNçš„ååŒå¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¡éªŒå’Œï¼ˆChecksumï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ—¥å¿—åºåˆ—å·ï¼ˆLSNï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éªŒè¯é¡µç‰©ç†å®Œæ•´æ€§ï¼ˆæ•°æ®æ˜¯å¦å®Œæ•´å†™å…¥ï¼‰&lt;/td&gt;
&lt;td&gt;éªŒè¯é¡µé€»è¾‘ä¸€è‡´æ€§ï¼ˆæ“ä½œæ˜¯å¦å®Œæ•´åˆ·ç›˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–‡ä»¶å¤´ + æ–‡ä»¶å°¾ï¼ˆå‰4å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;æ–‡ä»¶å¤´ï¼ˆ8å­—èŠ‚ï¼‰ + æ–‡ä»¶å°¾ï¼ˆå4å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¡ç®—ä¾æ®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¡µå†…å®¹çš„å“ˆå¸Œå€¼ï¼ˆCRC32ï¼‰&lt;/td&gt;
&lt;td&gt;Redo Logçš„å…¨å±€åºåˆ—å·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å´©æºƒæ¢å¤ä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ£€æµ‹é¡µæ–­è£‚ï¼ˆPartial Writeï¼‰&lt;/td&gt;
&lt;td&gt;å®šä½éœ€é‡åšçš„Redo Logæ“ä½œåŒºé—´&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ ¡éªŒç®—æ³•é€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;å¯é€šè¿‡&lt;code&gt;innodb_checksum_algorithm&lt;/code&gt;åˆ‡æ¢ç®—æ³•ï¼ˆå¦‚&lt;code&gt;crc32&lt;/code&gt;ã€&lt;code&gt;innodb&lt;/code&gt;ã€&lt;code&gt;none&lt;/code&gt;ï¼‰ï¼Œä½†CRC32çš„ç¢°æ’ç‡æ›´ä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½å½±å“ï¼š
&lt;ul&gt;
&lt;li&gt;CRC32è®¡ç®—éœ€æ¶ˆè€—CPUï¼Œä½†ç°ä»£å¤„ç†å™¨æ”¯æŒæŒ‡ä»¤çº§ä¼˜åŒ–ï¼Œå¼€é”€å¯å¿½ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸Doublewriteåä½œï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥æ ¡éªŒå’Œ/LSNéªŒè¯å¤±è´¥ï¼Œä¼˜å…ˆä»Doublewrite Bufferæ¢å¤å¤‡ä»½é¡µï¼Œè€Œéç›´æ¥ä¾èµ–Redo Logï¼ˆå› æ–­è£‚é¡µæ— æ³•è§£ææ—¥å¿—ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;InnoDBé€šè¿‡&lt;strong&gt;å¤´éƒ¨ä¸å°¾éƒ¨çš„æ ¡éªŒå’Œä¸LSN&lt;/strong&gt;æ„å»ºäº†åŒé‡ä¿éšœï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¡éªŒå’Œ&lt;/strong&gt; â†’ è§£å†³ç‰©ç†å±‚é¡µæ–­è£‚é—®é¢˜ï¼Œç¡®ä¿16KBæ•°æ®å®Œæ•´å†™å…¥ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LSN&lt;/strong&gt; â†’ è§£å†³é€»è¾‘å±‚æ“ä½œä¸­æ–­é—®é¢˜ï¼Œç²¾å‡†å®šä½Redo Logæ¢å¤ç‚¹ã€‚
äºŒè€…ååŒå·¥ä½œï¼Œæ˜¯InnoDBé«˜å¯é æ€§çš„åŸºçŸ³ï¼Œä¹Ÿæ˜¯å´©æºƒæ¢å¤èƒ½é«˜æ•ˆä¿®å¤æ•°æ®çš„æ ¸å¿ƒå‰æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="undo-logredo-log"&gt;UNDO LOGã€REDO LOG
&lt;/h2&gt;&lt;p&gt;UNDO LOG å’Œ REDO LOG æ˜¯æ•°æ®åº“äº‹åŠ¡å¤„ç†ä¸­ä¿éšœ &lt;strong&gt;ACID ç‰¹æ€§&lt;/strong&gt;ï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå°¤å…¶åœ¨ MySQL çš„ InnoDB å­˜å‚¨å¼•æ“ä¸­ååŒå·¥ä½œã€‚ä»¥ä¸‹æ˜¯ä¸¤è€…çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ—¥å¿—æ¦‚è¿°ä¸æ ¸å¿ƒç›®æ ‡"&gt;ğŸ“Š &lt;strong&gt;æ—¥å¿—æ¦‚è¿°ä¸æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ—¥å¿—ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ACID å…³è”&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è®¾è®¡æœ¬è´¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;REDO LOG&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¿è¯äº‹åŠ¡&lt;strong&gt;æŒä¹…æ€§&lt;/strong&gt;ï¼ˆDurabilityï¼‰&lt;/td&gt;
&lt;td&gt;æŒä¹…æ€§ï¼ˆDï¼‰&lt;/td&gt;
&lt;td&gt;è®°å½•ä¿®æ”¹åçš„&lt;strong&gt;ç‰©ç†å˜æ›´&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;UNDO LOG&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¿è¯äº‹åŠ¡&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;ï¼ˆAtomicityï¼‰&lt;/td&gt;
&lt;td&gt;åŸå­æ€§ï¼ˆAï¼‰ã€éš”ç¦»æ€§ï¼ˆIï¼‰&lt;/td&gt;
&lt;td&gt;è®°å½•ä¿®æ”¹å‰çš„&lt;strong&gt;é€»è¾‘é€†æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæœºåˆ¶ä¸å†™å…¥æµç¨‹"&gt;âš™ï¸ &lt;strong&gt;å·¥ä½œæœºåˆ¶ä¸å†™å…¥æµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="redo-logé‡åšæ—¥å¿—æŒä¹…æ€§ä¿éšœ"&gt;&lt;strong&gt;REDO LOGï¼šé‡åšæ—¥å¿—ï¼ˆæŒä¹…æ€§ä¿éšœï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒåŸç†&lt;/strong&gt;ï¼š
é‡‡ç”¨ â€‹&lt;strong&gt;WALï¼ˆWrite-Ahead Loggingï¼‰â€‹&lt;/strong&gt;â€‹ æœºåˆ¶ï¼šäº‹åŠ¡æäº¤å‰ï¼Œå…ˆå°†ä¿®æ”¹çš„ç‰©ç†æ“ä½œå†™å…¥ REDO LOG å¹¶æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå†å¼‚æ­¥åˆ·æ–°æ•°æ®é¡µåˆ°ç£ç›˜ã€‚&lt;/li&gt;
&lt;li&gt;å†™å…¥æµç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ä¿®æ”¹&lt;/strong&gt;ï¼šäº‹åŠ¡ä¿®æ”¹ Buffer Pool ä¸­çš„æ•°æ®é¡µï¼ˆäº§ç”Ÿè„é¡µï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—ç¼“å†²&lt;/strong&gt;ï¼šå°†ç‰©ç†å˜æ›´ï¼ˆå¦‚â€œé¡µå· Xï¼Œåç§»é‡ Y å†™å…¥å€¼ Zâ€ï¼‰å†™å…¥å†…å­˜ä¸­çš„ &lt;code&gt;redo log buffer&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—åˆ·ç›˜&lt;/strong&gt;ï¼šäº‹åŠ¡æäº¤æ—¶ï¼Œæ ¹æ®ç­–ç•¥ï¼ˆ&lt;code&gt;innodb_flush_log_at_trx_commit&lt;/code&gt;ï¼‰å°† &lt;code&gt;redo log buffer&lt;/code&gt; åˆ·å…¥ç£ç›˜çš„ &lt;code&gt;ib_logfile&lt;/code&gt; æ–‡ä»¶ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åˆ·ç›˜&lt;/strong&gt;ï¼šåå°çº¿ç¨‹å®šæœŸå°†è„é¡µåˆ·æ–°åˆ°è¡¨ç©ºé—´æ–‡ä»¶ï¼ˆ.ibdï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å´©æºƒæ¢å¤&lt;/strong&gt;ï¼š
å®•æœºé‡å¯åï¼Œé‡æ”¾ REDO LOG ä¸­å·²æäº¤äº‹åŠ¡çš„ç‰©ç†æ“ä½œï¼Œå°†æœªåˆ·ç›˜çš„è„é¡µä¿®å¤åˆ°æœ€æ–°çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[äº‹åŠ¡ä¿®æ”¹ Buffer Pool] --&amp;gt; B[è®°å½•ç‰©ç†å˜æ›´åˆ° redo log buffer]
B --&amp;gt; C{äº‹åŠ¡æäº¤}
C --&amp;gt;|ç­–ç•¥=1| D[åŒæ­¥åˆ·ç›˜ redo log]
C --&amp;gt;|ç­–ç•¥=0/2| E[å¼‚æ­¥åˆ·ç›˜]
D --&amp;gt; F[æ•°æ®é¡µå¼‚æ­¥åˆ·ç›˜]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="undo-logå›æ»šæ—¥å¿—åŸå­æ€§ä¸-mvcc-ä¿éšœ"&gt;&lt;strong&gt;UNDO LOGï¼šå›æ»šæ—¥å¿—ï¼ˆåŸå­æ€§ä¸ MVCC ä¿éšœï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒåŸç†&lt;/strong&gt;ï¼š
åœ¨æ•°æ®ä¿®æ”¹å‰ï¼Œè®°å½•ä¿®æ”¹å‰çš„æ—§å€¼ï¼ˆé€»è¾‘é€†æ“ä½œï¼‰ï¼Œç”¨äºå›æ»šæˆ–æ„å»ºå†å²ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;å†™å…¥æµç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ—§å€¼å¤‡ä»½&lt;/strong&gt;ï¼šäº‹åŠ¡ä¿®æ”¹æ•°æ®å‰ï¼Œå°†åŸå§‹æ•°æ®å¤‡ä»½åˆ° UNDO LOGï¼ˆå†…å­˜ â†’ ç£ç›˜ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆé€†æ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;INSERT â†’ è®°å½• DELETE&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;DELETE â†’ è®°å½• INSERT
&lt;ul&gt;
&lt;li&gt;UPDATE â†’ è®°å½•åå‘ UPDATEï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬é“¾æ„å»º&lt;/strong&gt;ï¼šUNDO LOG é€šè¿‡äº‹åŠ¡ IDï¼ˆtrx_idï¼‰å’ŒæŒ‡é’ˆå½¢æˆç‰ˆæœ¬é“¾ï¼Œæ”¯æŒ MVCCã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡å›æ»š&lt;/strong&gt;ï¼š
å›æ»šæ—¶æ‰§è¡Œ UNDO LOG ä¸­çš„é€†æ“ä½œï¼Œæ¢å¤æ•°æ®åˆ°ä¿®æ”¹å‰çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MVCC æ”¯æŒ&lt;/strong&gt;ï¼š
è¯»æ“ä½œé€šè¿‡ UNDO LOG ç‰ˆæœ¬é“¾è·å–ä¸€è‡´æ€§å¿«ç…§ï¼Œé¿å…è¯»å†™é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å´©æºƒæ¢å¤ä¸­çš„ååŒå·¥ä½œ"&gt;ğŸ”„ &lt;strong&gt;å´©æºƒæ¢å¤ä¸­çš„ååŒå·¥ä½œ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;InnoDB é‡å¯æ—¶ï¼Œé€šè¿‡ &lt;strong&gt;REDO + UNDO æ—¥å¿—ååŒæ¢å¤æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‰æ»šï¼ˆREDOï¼‰&lt;/strong&gt;ï¼š
é‡æ”¾ REDO LOGï¼Œæ¢å¤æ‰€æœ‰&lt;strong&gt;å·²æäº¤äº‹åŠ¡&lt;/strong&gt;çš„ä¿®æ”¹ï¼ˆä¿è¯æŒä¹…æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æ»šï¼ˆUNDOï¼‰&lt;/strong&gt;ï¼š
åˆ©ç”¨ UNDO LOG å›æ»šæ‰€æœ‰&lt;strong&gt;æœªæäº¤äº‹åŠ¡&lt;/strong&gt;çš„ä¿®æ”¹ï¼ˆä¿è¯åŸå­æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’ &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;REDO LOG è§£å†³â€œæäº¤åæ•°æ®æœªåˆ·ç›˜â€çš„ä¸¢å¤±é—®é¢˜ï¼›&lt;/li&gt;
&lt;li&gt;UNDO LOG è§£å†³â€œæœªæäº¤äº‹åŠ¡éƒ¨åˆ†åˆ·ç›˜â€çš„è„æ•°æ®é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜çº§ç‰¹æ€§ä¸åº”ç”¨åœºæ™¯"&gt;ğŸ§© &lt;strong&gt;é«˜çº§ç‰¹æ€§ä¸åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="redo-log-é«˜çº§ç‰¹æ€§"&gt;&lt;strong&gt;REDO LOG é«˜çº§ç‰¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¾ªç¯å†™å…¥ä¸ç©ºé—´å¤ç”¨&lt;/strong&gt;ï¼š
å›ºå®šå¤§å°çš„ &lt;code&gt;ib_logfile&lt;/code&gt; æ–‡ä»¶ç»„ï¼ˆå¦‚ &lt;code&gt;ib_logfile0/1&lt;/code&gt;ï¼‰ï¼Œå†™æ»¡åè¦†ç›–æœ€æ—©æ—¥å¿—ï¼ˆéœ€ç¡®ä¿å¯¹åº”è„é¡µå·²åˆ·ç›˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åˆ·ç›˜ç­–ç•¥ä¼˜åŒ–ï¼ˆinnodb_flush_log_at_trx_commitï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;=1&lt;/strong&gt;ï¼šæ¯æ¬¡æäº¤åŒæ­¥åˆ·ç›˜ï¼ˆå¼ºä¸€è‡´ï¼Œæ€§èƒ½ä½ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;=0&lt;/strong&gt;ï¼šæ¯ç§’å¼‚æ­¥åˆ·ç›˜ï¼ˆå¯èƒ½ä¸¢å¤± 1s æ•°æ®ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;=2&lt;/strong&gt;ï¼šå†™ OS ç¼“å­˜ï¼Œç”±ç³»ç»Ÿå†³å®šåˆ·ç›˜ï¼ˆå¹³è¡¡æ€§èƒ½ä¸å®‰å…¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="undo-log-é«˜çº§ç‰¹æ€§"&gt;&lt;strong&gt;UNDO LOG é«˜çº§ç‰¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®&lt;/strong&gt;ï¼š
é»˜è®¤å­˜äºç³»ç»Ÿè¡¨ç©ºé—´ï¼ˆ&lt;code&gt;ibdata1&lt;/code&gt;ï¼‰æˆ–ç‹¬ç«‹ UNDO è¡¨ç©ºé—´ï¼ˆMySQL 8.0+ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…ç†æœºåˆ¶&lt;/strong&gt;ï¼š
æäº¤çš„äº‹åŠ¡ UNDO LOG ç”±åå° &lt;code&gt;purge thread&lt;/code&gt; å»¶è¿Ÿæ¸…ç†ï¼ˆç¡®ä¿æ— æ´»è·ƒäº‹åŠ¡ä¾èµ–å†å²ç‰ˆæœ¬ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MVCC å®ç°ç»†èŠ‚&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªè¯»æ“ä½œç”Ÿæˆ &lt;code&gt;Read View&lt;/code&gt;ï¼Œè®°å½•æ´»è·ƒäº‹åŠ¡ IDï¼›&lt;/li&gt;
&lt;li&gt;é€šè¿‡ UNDO ç‰ˆæœ¬é“¾æ‰¾åˆ°å¯¹å½“å‰äº‹åŠ¡å¯è§çš„æ•°æ®ç‰ˆæœ¬ï¼ˆtrx_id â‰¤ min_active_idï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå·®å¼‚å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;æ ¸å¿ƒå·®å¼‚å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;REDO LOG&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;UNDO LOG&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç‰©ç†æ“ä½œï¼ˆé¡µå·ã€åç§»é‡ã€æ–°å€¼ï¼‰&lt;/td&gt;
&lt;td&gt;é€»è¾‘é€†æ“ä½œï¼ˆæ—§å€¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†™å…¥æ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®ä¿®æ”¹åï¼Œäº‹åŠ¡æäº¤å‰&lt;/td&gt;
&lt;td&gt;æ•°æ®ä¿®æ”¹å‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å´©æºƒæ¢å¤ â†’ &lt;strong&gt;æŒä¹…æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡å›æ»š + MVCC â†’ &lt;strong&gt;åŸå­æ€§ã€éš”ç¦»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç£ç›˜å­˜å‚¨å½¢å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç‹¬ç«‹æ–‡ä»¶ï¼ˆ&lt;code&gt;ib_logfile0/1&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;ç³»ç»Ÿè¡¨ç©ºé—´æˆ–ç‹¬ç«‹ UNDO è¡¨ç©ºé—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åˆ·ç›˜åå¯è¦†ç›–&lt;/td&gt;
&lt;td&gt;æ— äº‹åŠ¡ä¾èµ–åæ‰æ¸…ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡æ€è€ƒä¸æœ€ä½³å®è·µ"&gt;ğŸ› ï¸ &lt;strong&gt;è®¾è®¡æ€è€ƒä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ç§æ—¥å¿—ï¼Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;REDO LOG è§£å†³&lt;strong&gt;ç‰©ç†å±‚æŒä¹…åŒ–æ•ˆç‡&lt;/strong&gt;é—®é¢˜ï¼ˆé¡ºåºå†™æ›¿ä»£éšæœºå†™ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;UNDO LOG è§£å†³&lt;strong&gt;é€»è¾‘å±‚äº‹åŠ¡æ’¤é”€ä¸å¹¶å‘æ§åˆ¶&lt;/strong&gt;é—®é¢˜ï¼ˆç‰ˆæœ¬é“¾æ›¿ä»£å…¨å±€é”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–å»ºè®®&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;REDO LOGï¼š
&lt;ul&gt;
&lt;li&gt;å¢åŠ æ—¥å¿—æ–‡ä»¶å¤§å°ï¼ˆ&lt;code&gt;innodb_log_file_size&lt;/code&gt;ï¼‰å‡å°‘è¦†å†™é¢‘ç‡ï¼›&lt;/li&gt;
&lt;li&gt;é«˜æ€§èƒ½ SSD ç£ç›˜å­˜æ”¾æ—¥å¿—æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;UNDO LOGï¼š
&lt;ul&gt;
&lt;li&gt;MySQL 8.0+ å¯ç”¨ç‹¬ç«‹ UNDO è¡¨ç©ºé—´ï¼ˆ&lt;code&gt;innodb_undo_tablespaces&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é¿å…é•¿äº‹åŠ¡å †ç§¯ UNDO å†å²ç‰ˆæœ¬ï¼ˆé˜»å¡ç©ºé—´å›æ”¶ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹æ•…éšœåœºæ™¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;REDO LOG æŸå&lt;/strong&gt;ï¼šå¯¼è‡´å·²æäº¤äº‹åŠ¡ä¸¢å¤± â†’ éœ€ä»å¤‡ä»½æ¢å¤ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;UNDO LOG ç©ºé—´ä¸è¶³&lt;/strong&gt;ï¼šæ–°äº‹åŠ¡æ— æ³•å¼€å§‹ â†’ æ¸…ç†é•¿äº‹åŠ¡æˆ–æ‰©å®¹ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;REDO LOG&lt;/strong&gt; æ˜¯æ•°æ®åº“çš„â€œå®‰å…¨æ°”å›Šâ€ï¼Œé€šè¿‡&lt;strong&gt;ç‰©ç†æ“ä½œæ—¥å¿— + WAL æœºåˆ¶&lt;/strong&gt;ç¡®ä¿æäº¤äº‹åŠ¡æ°¸ä¸ä¸¢å¤±ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;UNDO LOG&lt;/strong&gt; æ˜¯äº‹åŠ¡çš„â€œæ—¶å…‰æœºâ€ï¼Œé€šè¿‡&lt;strong&gt;é€»è¾‘é€†æ“ä½œ + ç‰ˆæœ¬é“¾&lt;/strong&gt;å®ç°å›æ»šä¸æ— é”å¹¶å‘è¯»ï¼ˆMVCCï¼‰ï¼›
äºŒè€…ä»¥ç²¾å¯†åä½œä¿éšœäº†æ•°æ®åº“çš„é«˜å¯é ä¸é«˜å¹¶å‘ï¼Œæ˜¯ç†è§£ InnoDB äº‹åŠ¡å¼•æ“çš„åŸºçŸ³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="steal--force"&gt;&lt;strong&gt;Steal &amp;amp; Force&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;æœªæäº¤äº‹åŠ¡çš„éƒ¨åˆ†åˆ·ç›˜ç°è±¡æ˜¯æ•°æ®åº“ç³»ç»Ÿåœ¨&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–ä¸æ•°æ®ä¸€è‡´æ€§å¹³è¡¡&lt;/strong&gt;ä¸­çš„å¿…ç„¶ç»“æœï¼Œå…¶æ ¸å¿ƒæºäºç¼“å†²æ± ï¼ˆBuffer Poolï¼‰æœºåˆ¶ä¸åˆ·ç›˜ç­–ç•¥çš„è®¾è®¡ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åŸå› åŠæœºåˆ¶åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç¼“å†²æ± æœºåˆ¶ä¸å»¶è¿Ÿåˆ·ç›˜"&gt;âš™ï¸ &lt;strong&gt;ç¼“å†²æ± æœºåˆ¶ä¸å»¶è¿Ÿåˆ·ç›˜&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å†²æ± çš„ä½œç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®åº“ä½¿ç”¨ç¼“å†²æ± ï¼ˆBuffer Poolï¼‰ä½œä¸ºå†…å­˜ç¼“å­˜ï¼Œé¿å…æ¯æ¬¡è¯»å†™éƒ½ç›´æ¥æ“ä½œç£ç›˜ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡ä¿®æ”¹æ•°æ®æ—¶ï¼Œå…ˆä¿®æ”¹ç¼“å†²æ± ä¸­çš„é¡µï¼ˆäº§ç”Ÿè„é¡µï¼‰ï¼Œå†å¼‚æ­¥åˆ·ç›˜ã€‚è¿™ç§è®¾è®¡æ˜¾è‘—å‡å°‘ç£ç›˜I/Oï¼Œæå‡æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ·ç›˜ç­–ç•¥çš„æƒè¡¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;No Forceç­–ç•¥&lt;/strong&gt;ï¼šå·²æäº¤äº‹åŠ¡çš„è„é¡µ&lt;strong&gt;ä¸å¼ºåˆ¶ç«‹å³åˆ·ç›˜&lt;/strong&gt;ï¼Œå…è®¸å»¶è¿Ÿå†™å…¥ç£ç›˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Stealç­–ç•¥&lt;/strong&gt;ï¼šå…è®¸æœªæäº¤äº‹åŠ¡çš„è„é¡µ&lt;strong&gt;æå‰åˆ·ç›˜&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;çŸ›ç›¾ç‚¹&lt;/em&gt;ï¼šè‹¥å¼ºåˆ¶æ‰€æœ‰äº‹åŠ¡æäº¤åæ‰åˆ·ç›˜ï¼ˆNo Steal + Forceï¼‰ï¼Œæ€§èƒ½æä½ï¼›è‹¥å…è®¸æœªæäº¤äº‹åŠ¡åˆ·ç›˜ï¼ˆStealï¼‰ï¼Œåˆ™éœ€è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æœªæäº¤äº‹åŠ¡åˆ·ç›˜çš„è§¦å‘åœºæ™¯"&gt;ğŸ”„ &lt;strong&gt;æœªæäº¤äº‹åŠ¡åˆ·ç›˜çš„è§¦å‘åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åå°çº¿ç¨‹å®šæœŸåˆ·ç›˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;InnoDBåå°çº¿ç¨‹é»˜è®¤æ¯ç§’æ‰§è¡Œä¸€æ¬¡åˆ·ç›˜ï¼Œå°†ç¼“å†²æ± ä¸­çš„è„é¡µï¼ˆå«æœªæäº¤äº‹åŠ¡çš„ä¿®æ”¹ï¼‰å†™å…¥ç£ç›˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;ç›®çš„&lt;/em&gt;ï¼šé¿å…è„é¡µå †ç§¯å¯¼è‡´å†…å­˜ä¸è¶³æˆ–æ¢å¤æ—¶é—´è¿‡é•¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Redo Log Bufferç©ºé—´ä¸è¶³&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“Redo Log Bufferå ç”¨è¶…è¿‡&lt;code&gt;innodb_log_buffer_size&lt;/code&gt;ä¸€åŠæ—¶ï¼ˆé»˜è®¤8MBï¼‰ï¼Œä¼šè§¦å‘å†™ç›˜æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;æ³¨æ„&lt;/em&gt;ï¼šæ­¤æ—¶ä»…å†™å…¥æ“ä½œç³»ç»Ÿçš„Page Cacheï¼Œæœªè°ƒç”¨&lt;code&gt;fsync&lt;/code&gt;ï¼Œæ•°æ®ä»åœ¨å†…å­˜ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¶ä»–äº‹åŠ¡æäº¤è¿å¸¦å†™å…¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥äº‹åŠ¡Bæäº¤ä¸”&lt;code&gt;innodb_flush_log_at_trx_commit=1&lt;/code&gt;ï¼ŒRedo Log Bufferä¸­&lt;strong&gt;æ‰€æœ‰æ—¥å¿—&lt;/strong&gt;ï¼ˆå«å…¶ä»–æœªæäº¤äº‹åŠ¡çš„æ—¥å¿—ï¼‰ä¼šä¸€å¹¶åˆ·ç›˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;ç¤ºä¾‹&lt;/em&gt;ï¼šäº‹åŠ¡Aæœªæäº¤ï¼Œäº‹åŠ¡Bæäº¤æ—¶è¿å¸¦å°†äº‹åŠ¡Açš„Redoæ—¥å¿—å†™å…¥ç£ç›˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“å…³é—­æˆ–æ£€æŸ¥ç‚¹è§¦å‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ­£å¸¸å…³é—­æ•°æ®åº“æ—¶ï¼Œæ‰€æœ‰è„é¡µï¼ˆåŒ…æ‹¬æœªæäº¤äº‹åŠ¡çš„ä¿®æ”¹ï¼‰å¼ºåˆ¶åˆ·ç›˜ã€‚&lt;/li&gt;
&lt;li&gt;Checkpointæœºåˆ¶ä¸ºè…¾å‡ºRedo Logç©ºé—´ï¼Œä¼šæ¨è¿›åˆ·ç›˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-éƒ¨åˆ†åˆ·ç›˜çš„é£é™©ä¸è§£å†³æœºåˆ¶"&gt;âš ï¸ &lt;strong&gt;éƒ¨åˆ†åˆ·ç›˜çš„é£é™©ä¸è§£å†³æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸ä¸€è‡´é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æœªæäº¤äº‹åŠ¡çš„ä¿®æ”¹è‹¥å·²åˆ·ç›˜ï¼Œå®•æœºåä¼šå¯¼è‡´æ•°æ®é”™è¯¯ï¼ˆå¦‚å¹»è¯»æˆ–è„æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Undo Logçš„å›æ»šä¿éšœ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ ¸å¿ƒæœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡ä¿®æ”¹å‰ï¼Œæ—§æ•°æ®ä¼šå†™å…¥Undo Logã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å®•æœºé‡å¯åï¼Œé€šè¿‡Undo Logå›æ»šæœªæäº¤äº‹åŠ¡çš„ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;æµç¨‹ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[å®•æœºé‡å¯] --&amp;gt; B[Redo Logé‡åšå·²æäº¤äº‹åŠ¡]
B --&amp;gt; C[Undo Logå›æ»šæœªæäº¤äº‹åŠ¡]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;Redo Logçš„ååŒæ¢å¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Redo Logé‡åšå·²æäº¤äº‹åŠ¡çš„ä¿®æ”¹åï¼Œå†é€šè¿‡Undo Logé€†æ“ä½œæ¸…é™¤æœªæäº¤äº‹åŠ¡çš„å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸åŒåˆ·ç›˜ç­–ç•¥çš„å½±å“"&gt;âš–ï¸ &lt;strong&gt;ä¸åŒåˆ·ç›˜ç­–ç•¥çš„å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç­–ç•¥ç»„åˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœªæäº¤äº‹åŠ¡åˆ·ç›˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å·²æäº¤äº‹åŠ¡åˆ·ç›˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;éœ€ä¾èµ–çš„æ—¥å¿—&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½è¡¨ç°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;No Steal + Force&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ç¦æ­¢&lt;/td&gt;
&lt;td&gt;âœ… å¼ºåˆ¶&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;æä½ï¼ˆé¢‘ç¹åˆ·ç›˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;No Steal + No Force&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ç¦æ­¢&lt;/td&gt;
&lt;td&gt;âŒ å»¶è¿Ÿ&lt;/td&gt;
&lt;td&gt;Redo Log&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Steal + Force&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å…è®¸&lt;/td&gt;
&lt;td&gt;âœ… å¼ºåˆ¶&lt;/td&gt;
&lt;td&gt;Undo Log&lt;/td&gt;
&lt;td&gt;è¾ƒä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Steal + No Force&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å…è®¸&lt;/td&gt;
&lt;td&gt;âŒ å»¶è¿Ÿ&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Redo + Undo&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æœ€ä¼˜ï¼ˆé»˜è®¤ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;InnoDBé»˜è®¤é‡‡ç”¨Steal + No Force&lt;/strong&gt;ï¼šé€šè¿‡Undo Logè§£å†³æœªæäº¤äº‹åŠ¡åˆ·ç›˜çš„å‰¯ä½œç”¨ï¼Œä»¥Redo Logä¿éšœå·²æäº¤äº‹åŠ¡çš„æŒä¹…æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æœªæäº¤äº‹åŠ¡çš„éƒ¨åˆ†åˆ·ç›˜æ˜¯æ•°æ®åº“ä¸º&lt;strong&gt;ä¼˜åŒ–æ€§èƒ½&lt;/strong&gt;ï¼ˆå‡å°‘ç£ç›˜I/Oï¼‰è€Œä¸»åŠ¨è®¾è®¡çš„æœºåˆ¶ï¼Œå…¶è§¦å‘æ¡ä»¶åŒ…æ‹¬åå°çº¿ç¨‹åˆ·ç›˜ã€Redoç©ºé—´ä¸è¶³ã€å…¶ä»–äº‹åŠ¡æäº¤è¿å¸¦ç­‰ã€‚
é€šè¿‡ â€‹&lt;strong&gt;Undo Logå›æ»š&lt;/strong&gt;â€‹ + â€‹&lt;strong&gt;Redo Logé‡åš&lt;/strong&gt;çš„ååŒï¼ŒInnoDBåœ¨å´©æºƒæ¢å¤æ—¶èƒ½ä¿®å¤æ­¤ç±»æ•°æ®å¼‚å¸¸ï¼Œæœ€ç»ˆä¿éšœACIDç‰¹æ€§ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æ§é•¿äº‹åŠ¡ï¼ˆé¿å…Undo Logå †ç§¯ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;åˆç†é…ç½®&lt;code&gt;innodb_flush_log_at_trx_commit&lt;/code&gt;ï¼ˆé»˜è®¤1æœ€å®‰å…¨ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;SSDç¡¬ç›˜æå‡åˆ·ç›˜æ•ˆç‡ï¼Œé™ä½å»¶è¿Ÿåˆ·ç›˜é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="undo-ç‰ˆæœ¬é“¾"&gt;UNDO ç‰ˆæœ¬é“¾
&lt;/h2&gt;&lt;p&gt;UNDOç‰ˆæœ¬é“¾æ˜¯InnoDBå­˜å‚¨å¼•æ“å®ç°&lt;strong&gt;å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰&lt;/strong&gt; çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå®ƒé€šè¿‡ä¸²è”å†å²æ•°æ®ç‰ˆæœ¬ï¼Œæ”¯æŒäº‹åŠ¡å›æ»šã€ä¸€è‡´æ€§è¯»å’Œéš”ç¦»æ€§ä¿éšœã€‚å…¶æœ¬è´¨æ˜¯ä¸€æ¡ç”±&lt;strong&gt;éšè—å­—æ®µ&lt;code&gt;roll_pointer&lt;/code&gt;è¿æ¥çš„é€†å‘æ—¶é—´çº¿&lt;/strong&gt;ï¼Œè®°å½•åŒä¸€è¡Œæ•°æ®çš„æ‰€æœ‰ä¿®æ”¹å†å²ã€‚ä»¥ä¸‹ä»ç»“æ„ã€æœºåˆ¶åˆ°åº”ç”¨è¿›è¡Œç³»ç»Ÿè§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç‰©ç†ç»“æ„éšè—å­—æ®µä¸ç‰ˆæœ¬é“¾æ„å»º"&gt;â›“ï¸ &lt;strong&gt;ç‰©ç†ç»“æ„ï¼šéšè—å­—æ®µä¸ç‰ˆæœ¬é“¾æ„å»º&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éšè—å­—æ®µ&lt;/strong&gt;
æ¯æ¡èšç°‡ç´¢å¼•è®°å½•åŒ…å«ä¸¤ä¸ªå…³é”®éšè—å­—æ®µï¼ˆè‹¥è¡¨æ— ä¸»é”®åˆ™é¢å¤–ç”Ÿæˆ&lt;code&gt;row_id&lt;/code&gt;ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;trx_id&lt;/code&gt;ï¼ˆ6å­—èŠ‚ï¼‰&lt;/strong&gt;ï¼šæœ€è¿‘ä¸€æ¬¡ä¿®æ”¹è¯¥è®°å½•çš„äº‹åŠ¡IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;roll_pointer&lt;/code&gt;ï¼ˆ7å­—èŠ‚ï¼‰&lt;/strong&gt;ï¼šæŒ‡å‘æ—§ç‰ˆæœ¬æ•°æ®çš„undoæ—¥å¿—åœ°å€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¤ºä¾‹ï¼šäº‹åŠ¡80æ’å…¥è®°å½•åå­—æ®µå€¼ï¼š
&lt;code&gt;trx_id=80&lt;/code&gt;, &lt;code&gt;roll_pointer&lt;/code&gt; â†’ ç©ºï¼ˆæ— å†å²ç‰ˆæœ¬ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬é“¾å½¢æˆæµç¨‹&lt;/strong&gt;
æ¯æ¬¡æ›´æ–°æ“ä½œç”Ÿæˆä¸€æ¡undoæ—¥å¿—ï¼Œå¹¶é€šè¿‡&lt;code&gt;roll_pointer&lt;/code&gt;ä¸²è”æˆé“¾è¡¨ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[å½“å‰è®°å½•v3: trx_id=200] --&amp;gt;|roll_pointer| B[undoæ—¥å¿—v2: trx_id=100]
B --&amp;gt;|roll_pointer| C[undoæ—¥å¿—v1: trx_id=80]
C --&amp;gt;|roll_pointer| D[undoæ—¥å¿—v0: æ’å…¥å‰çŠ¶æ€]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤´èŠ‚ç‚¹&lt;/strong&gt;ï¼šå½“å‰è®°å½•æœ€æ–°å€¼ï¼ˆå¦‚v3ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°¾èŠ‚ç‚¹&lt;/strong&gt;ï¼šåˆå§‹æ’å…¥çŠ¶æ€ï¼ˆå¦‚v0ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæœºåˆ¶mvccä¸å¯è§æ€§åˆ¤æ–­"&gt;ğŸ” &lt;strong&gt;å·¥ä½œæœºåˆ¶ï¼šMVCCä¸å¯è§æ€§åˆ¤æ–­&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç‰ˆæœ¬é“¾é€šè¿‡ &lt;strong&gt;Read Viewï¼ˆè¯»è§†å›¾ï¼‰&lt;/strong&gt; å®ç°äº‹åŠ¡éš”ç¦»æ€§ï¼Œå…¶æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Read Viewç”Ÿæˆæ—¶æœº&lt;/strong&gt; ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;READ COMMITTED&lt;/strong&gt;ï¼šæ¯æ¬¡&lt;code&gt;SELECT&lt;/code&gt;ç”Ÿæˆæ–°Read Viewã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;REPEATABLE READ&lt;/strong&gt;ï¼šäº‹åŠ¡é¦–æ¬¡&lt;code&gt;SELECT&lt;/code&gt;ç”ŸæˆRead Viewï¼Œåç»­å¤ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Read Viewå…³é”®å±æ€§&lt;/strong&gt; ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;m_ids&lt;/code&gt;&lt;/strong&gt;ï¼šç”ŸæˆRead Viewæ—¶æ´»è·ƒäº‹åŠ¡IDåˆ—è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;min_trx_id&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;code&gt;m_ids&lt;/code&gt;ä¸­æœ€å°äº‹åŠ¡IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;max_trx_id&lt;/code&gt;&lt;/strong&gt;ï¼šç”ŸæˆRead Viewæ—¶ç³»ç»Ÿå°†åˆ†é…çš„ä¸‹ä¸ªäº‹åŠ¡IDã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬å¯è§æ€§è§„åˆ™&lt;/strong&gt;ï¼ˆæŒ‰é“¾ä»æ–°åˆ°æ—§éå†ï¼‰ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;trx_idèŒƒå›´&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¯è§æ€§åˆ¤æ–­&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;trx_id &amp;lt; min_trx_id&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯¥ç‰ˆæœ¬äº‹åŠ¡å·²æäº¤ â†’ å¯è§ âœ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;trx_id â‰¥ max_trx_id&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯¥ç‰ˆæœ¬ç”±æœªæ¥äº‹åŠ¡ç”Ÿæˆ â†’ ä¸å¯è§ âŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;min_trx_id â‰¤ trx_id &amp;lt; max_trx_id&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‹¥&lt;code&gt;trx_id&lt;/code&gt;åœ¨&lt;code&gt;m_ids&lt;/code&gt;ä¸­ â†’ äº‹åŠ¡æœªæäº¤ï¼ˆä¸å¯è§ âŒï¼‰ï¼› å¦åˆ™äº‹åŠ¡å·²æäº¤ï¼ˆå¯è§ âœ…ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼ˆREPEATABLE READï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡Aï¼ˆtrx_id=150ï¼‰Read Viewçš„&lt;code&gt;m_ids=[100,200]&lt;/code&gt;, &lt;code&gt;min_trx_id=100&lt;/code&gt;, &lt;code&gt;max_trx_id=250&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è®°å½•ç‰ˆæœ¬é“¾ï¼šv3(trx_id=200) â†’ v2(trx_id=100) â†’ v1(trx_id=80)ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ¤æ–­è¿‡ç¨‹&lt;/strong&gt;ï¼š
v3: trx_id=200 âˆˆ &lt;code&gt;m_ids&lt;/code&gt; â†’ ä¸å¯è§ âŒ
v2: trx_id=100 âˆˆ &lt;code&gt;m_ids&lt;/code&gt; â†’ ä¸å¯è§ âŒ
v1: trx_id=80 &amp;lt; &lt;code&gt;min_trx_id&lt;/code&gt; â†’ å¯è§ âœ… â†’ è¿”å›v1ç‰ˆæœ¬æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç‰¹æ®Šæ“ä½œçš„å¤„ç†é€»è¾‘"&gt;âš ï¸ &lt;strong&gt;ç‰¹æ®Šæ“ä½œçš„å¤„ç†é€»è¾‘&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;DELETEæ“ä½œ&lt;/strong&gt; ï¼š
&lt;ul&gt;
&lt;li&gt;ç‰©ç†åˆ é™¤ â†’ ä»…æ ‡è®°åˆ é™¤ä½ï¼ˆ&lt;code&gt;del_flag&lt;/code&gt;ï¼‰ï¼Œè®°å½•ä»å­˜äºç‰ˆæœ¬é“¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Purgeæœºåˆ¶&lt;/strong&gt;ï¼šåå°çº¿ç¨‹æ¸…ç†æ— Read Viewå¼•ç”¨çš„åˆ é™¤è®°å½•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;INSERTæ“ä½œ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ç”Ÿæˆ&lt;strong&gt;æ— &lt;code&gt;roll_pointer&lt;/code&gt;çš„undoæ—¥å¿—&lt;/strong&gt;ï¼ˆå› æ— å†å²ç‰ˆæœ¬ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ–°æ’å…¥è®°å½•&lt;code&gt;trx_id&lt;/code&gt;ä¸ºæ’å…¥äº‹åŠ¡IDã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ›´æ–°å†²çª&lt;/strong&gt; ï¼š
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡Aæœªæäº¤æ—¶ï¼Œäº‹åŠ¡Bæ›´æ–°åŒä¸€è®°å½• â†’ Bç­‰å¾…Açš„Xé”é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥Aå›æ»šï¼šBçš„æ›´æ–°åŸºäºAå·²æ¶ˆå¤±çš„ç‰ˆæœ¬ â†’ InnoDBæŠ›å‡º&lt;code&gt;ERROR 1205&lt;/code&gt;ï¼ˆé”è¶…æ—¶ï¼‰å¹¶å›æ»šBã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸è®¾è®¡æ„ä¹‰"&gt;ğŸ§© &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸è®¾è®¡æ„ä¹‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡å›æ»š&lt;/strong&gt;
äº‹åŠ¡å¤±è´¥æ—¶ï¼Œæ²¿ç‰ˆæœ¬é“¾æ‰§è¡Œundoæ—¥å¿—ä¸­çš„é€†æ“ä½œï¼ˆå¦‚UPDATEè¿˜åŸæ—§å€¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MVCCå®ç°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è¯»å†™ä¸é˜»å¡ï¼šè¯»æ“ä½œè®¿é—®å†å²ç‰ˆæœ¬ï¼Œæ— éœ€åŠ é”ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³å¹»è¯»ï¼ˆRRçº§åˆ«ï¼‰ï¼šé¦–æ¬¡Read Viewå†»ç»“å¯è§èŒƒå›´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äºŒçº§ç´¢å¼•å…¼å®¹æ€§&lt;/strong&gt;
äºŒçº§ç´¢å¼•æ— éšè—å­—æ®µï¼Œéœ€å›è¡¨åˆ°èšç°‡ç´¢å¼•è·å–&lt;code&gt;trx_id&lt;/code&gt;å’Œç‰ˆæœ¬é“¾ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç»´æŠ¤ä¸æ¸…ç†æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;ç»´æŠ¤ä¸æ¸…ç†æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;undoæ—¥å¿—ç±»å‹&lt;/strong&gt; ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Insert Undo&lt;/strong&gt;ï¼šäº‹åŠ¡æäº¤åç«‹å³åˆ é™¤ï¼ˆä»…ç”¨äºå›æ»šï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Update Undo&lt;/strong&gt;ï¼šç‰ˆæœ¬é“¾ç»„æˆéƒ¨åˆ† â†’ å»¶è¿Ÿæ¸…ç†ï¼ˆéœ€æ— æ´»è·ƒäº‹åŠ¡ä¾èµ–ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Purgeçº¿ç¨‹&lt;/strong&gt;
å®šæœŸæ¸…ç†æ— ç”¨çš„Update Undoæ—¥å¿—ï¼Œå›æ”¶ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿äº‹åŠ¡é£é™©&lt;/strong&gt;
æœªæäº¤äº‹åŠ¡ä¼šé˜»æ­¢å…¶Read Viewå…³è”çš„undoæ—¥å¿—æ¸…ç† â†’ å¯èƒ½è§¦å‘&lt;code&gt;innodb_undo_tablespaces&lt;/code&gt;ç©ºé—´ä¸è¶³ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“undoç‰ˆæœ¬é“¾çš„æ ¸å¿ƒä»·å€¼"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šUNDOç‰ˆæœ¬é“¾çš„æ ¸å¿ƒä»·å€¼&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;UNDOç‰ˆæœ¬é“¾æ˜¯InnoDBäº‹åŠ¡ç³»ç»Ÿçš„&lt;strong&gt;æ—¶ç©ºéš§é“&lt;/strong&gt;ï¼Œé€šè¿‡ä¸²è”æ•°æ®å†å²ç‰ˆæœ¬å®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;ï¼šäº‹åŠ¡å›æ»šæ—¶é€†å‘è¿˜åŸæ•°æ®ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;ï¼šRead Viewè¿‡æ»¤ä¸å¯è§ç‰ˆæœ¬ï¼Œå®ç°RC/RRéš”ç¦»çº§åˆ«ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é”è¯»&lt;/strong&gt;ï¼šMVCCæœºåˆ¶é¿å…è¯»å†™å†²çªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼šç›‘æ§é•¿äº‹åŠ¡ï¼ˆ&lt;code&gt;information_schema.innodb_trx&lt;/code&gt;ï¼‰é¿å…undoè†¨èƒ€ï¼Œå¹¶ç¡®ä¿&lt;code&gt;innodb_undo_log_truncate=ON&lt;/code&gt;å®šæœŸæ¸…ç†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="undo-æ—¥å¿—ç±»å‹"&gt;UNDO æ—¥å¿—ç±»å‹
&lt;/h2&gt;&lt;p&gt;UNDOæ—¥å¿—æ˜¯InnoDBå®ç°äº‹åŠ¡**åŸå­æ€§ï¼ˆå›æ»šï¼‰&lt;strong&gt;å’Œ&lt;/strong&gt;å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰**çš„æ ¸å¿ƒç»„ä»¶ï¼Œæ ¹æ®æ“ä½œç±»å‹å¯åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼Œå…¶ç»“æ„ã€ä½œç”¨åŠç”Ÿå‘½å‘¨æœŸå­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-insert-undo-logæ’å…¥å‹undoæ—¥å¿—"&gt;ğŸ“Œ &lt;strong&gt;Insert Undo Logï¼ˆæ’å…¥å‹UNDOæ—¥å¿—ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é€‚ç”¨æ“ä½œ&lt;/strong&gt;ï¼šä»…ç”±&lt;code&gt;INSERT&lt;/code&gt;è¯­å¥ç”Ÿæˆã€‚
â€‹&lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;â€‹ï¼šç”¨äºäº‹åŠ¡å›æ»šæ—¶&lt;strong&gt;åˆ é™¤æ–°æ’å…¥çš„è®°å½•&lt;/strong&gt;ã€‚
â€‹&lt;strong&gt;æ—¥å¿—æ ¼å¼&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;| end_of_record | undo_type=TRX_UNDO_INSERT_REC | undo_no | table_id | ä¸»é”®åˆ—ä¿¡æ¯(len+value) | start_of_record |
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»é”®åˆ—ä¿¡æ¯&lt;/strong&gt;ï¼šè®°å½•æ’å…¥è¡Œçš„ä¸»é”®å€¼ï¼ˆå•åˆ—æˆ–å¤šåˆ—ç»„åˆï¼‰ï¼Œå›æ»šæ—¶æŒ‰ä¸»é”®ç²¾å‡†åˆ é™¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éšè—åˆ—è®°å½•&lt;/strong&gt;ï¼šæ’å…¥åï¼Œèšç°‡ç´¢å¼•è®°å½•çš„&lt;code&gt;trx_id&lt;/code&gt;è®¾ä¸ºå½“å‰äº‹åŠ¡IDï¼Œ&lt;code&gt;roll_pointer&lt;/code&gt;æŒ‡å‘æ­¤UNDOæ—¥å¿—ã€‚
â€‹&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡æäº¤å&lt;strong&gt;ç«‹å³å¤±æ•ˆ&lt;/strong&gt;ï¼ˆå› MVCCæ— éœ€è¯»å–æ’å…¥å‰çš„ç©ºçŠ¶æ€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ—¥å¿—æ‰€åœ¨UNDOé¡µå¯è¢«&lt;strong&gt;å¿«é€Ÿé‡ç”¨&lt;/strong&gt;ï¼ˆåå°Purgeçº¿ç¨‹å¼‚æ­¥æ¸…ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-update-undo-logæ›´æ–°åˆ é™¤å‹undoæ—¥å¿—"&gt;ğŸ”„ &lt;strong&gt;Update Undo Logï¼ˆæ›´æ–°/åˆ é™¤å‹UNDOæ—¥å¿—ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é€‚ç”¨æ“ä½œ&lt;/strong&gt;ï¼šç”±&lt;code&gt;UPDATE&lt;/code&gt;æˆ–&lt;code&gt;DELETE&lt;/code&gt;è¯­å¥ç”Ÿæˆã€‚
â€‹&lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å›æ»šæ—¶&lt;strong&gt;æ¢å¤æ•°æ®æ—§å€¼&lt;/strong&gt;ï¼ˆUPDATEè¿˜åŸå­—æ®µï¼ŒDELETEå–æ¶ˆåˆ é™¤æ ‡è®°ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„å»ºMVCCç‰ˆæœ¬é“¾&lt;/strong&gt;ï¼Œä¾›å…¶ä»–äº‹åŠ¡è¯»å–å†å²å¿«ç…§ã€‚
â€‹&lt;strong&gt;æ—¥å¿—æ ¼å¼&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;| end_of_record | undo_type | table_id | info_bits | æ—§trx_id | æ—§roll_pointer | ä¸»é”®åˆ—ä¿¡æ¯ | ç´¢å¼•åˆ—ä¿¡æ¯ | start_of_record |
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—§å€¼ä¿ç•™&lt;/strong&gt;ï¼šè®°å½•è¢«ä¿®æ”¹/åˆ é™¤å‰çš„å®Œæ•´æ•°æ®ï¼ˆå«éšè—åˆ—&lt;code&gt;trx_id&lt;/code&gt;å’Œ&lt;code&gt;roll_pointer&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•åˆ—ä¿¡æ¯&lt;/strong&gt;ï¼šè®°å½•æ‰€æœ‰ç´¢å¼•å­—æ®µçš„æ—§å€¼ï¼Œç”¨äºPurgeé˜¶æ®µçš„ç‰©ç†åˆ é™¤ã€‚
â€‹&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡æäº¤å&lt;strong&gt;ä¸ä¼šç«‹å³åˆ é™¤&lt;/strong&gt;ï¼ˆMVCCå¯èƒ½ä»éœ€è®¿é—®å†å²ç‰ˆæœ¬ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;ç”±&lt;strong&gt;Purgeçº¿ç¨‹&lt;/strong&gt;åœ¨æ— æ´»è·ƒäº‹åŠ¡ä¾èµ–æ—¶å¼‚æ­¥æ¸…ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç‰¹æ®Šåœºæ™¯æ›´æ–°ä¸»é”®æ—¶çš„å¤åˆundoæ—¥å¿—"&gt;âš ï¸ &lt;strong&gt;ç‰¹æ®Šåœºæ™¯ï¼šæ›´æ–°ä¸»é”®æ—¶çš„å¤åˆUNDOæ—¥å¿—&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å½“&lt;code&gt;UPDATE&lt;/code&gt;æ“ä½œæ¶‰åŠ&lt;strong&gt;ä¸»é”®ä¿®æ”¹&lt;/strong&gt;æ—¶ï¼Œéœ€åŒæ—¶ç”Ÿæˆä¸¤ç§æ—¥å¿—ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Update Undo Log&lt;/strong&gt;ï¼šå°†æ—§ä¸»é”®è®°å½•æ ‡è®°ä¸ºåˆ é™¤ï¼ˆ&lt;code&gt;delete mark&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Insert Undo Log&lt;/strong&gt;ï¼šè®°å½•æ–°ä¸»é”®çš„æ’å…¥ä¿¡æ¯ï¼ˆå› ä¸»é”®å˜æ›´ç­‰æ•ˆäºåˆ é™¤+æ’å…¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¾‹å¦‚ï¼šå°†è¡Œè®°å½•çš„ä¸»é”®ä»Aæ”¹ä¸ºBï¼Œä¼šå…ˆæ ‡è®°Aä¸ºåˆ é™¤æ€ï¼Œå†æ’å…¥Bçš„æ–°è®°å½•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ç±»å‹å¯¹æ¯”ä¸å…³é”®å·®å¼‚"&gt;ğŸ“Š &lt;strong&gt;ç±»å‹å¯¹æ¯”ä¸å…³é”®å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Insert Undo Log&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Update Undo Log&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ“ä½œæ¥æº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;INSERT&lt;/td&gt;
&lt;td&gt;UPDATE / DELETE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å›æ»šåŠ¨ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰ä¸»é”®åˆ é™¤è®°å½•&lt;/td&gt;
&lt;td&gt;è¿˜åŸæ—§å€¼ / å–æ¶ˆåˆ é™¤æ ‡è®°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;MVCCä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸å‚ä¸ç‰ˆæœ¬é“¾&lt;/td&gt;
&lt;td&gt;âœ… æ„å»ºå†å²ç‰ˆæœ¬é“¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æäº¤åæ¸…ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç«‹å³é‡Šæ”¾&lt;/td&gt;
&lt;td&gt;âŒ å»¶è¿Ÿæ¸…ç†ï¼ˆPurgeçº¿ç¨‹å¼‚æ­¥å¤„ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç©ºé—´é‡ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ä¼˜å…ˆé‡ç”¨&lt;/td&gt;
&lt;td&gt;â— éœ€ç­‰å¾…æ— äº‹åŠ¡å¼•ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡æ„ä¹‰ä¸ç”Ÿäº§å»ºè®®"&gt;âš™ï¸ &lt;strong&gt;è®¾è®¡æ„ä¹‰ä¸ç”Ÿäº§å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;åŸå­æ€§ä¿éšœï¼š
&lt;ul&gt;
&lt;li&gt;Insert Undoå¿«é€Ÿæ¸…ç†æ–°æ•°æ®ï¼ŒUpdate Undoç²¾å‡†è¿˜åŸæ—§çŠ¶æ€ï¼ŒååŒå®ç°â€œæ“ä½œå½’é›¶â€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;MVCCåŸºçŸ³ï¼š
&lt;ul&gt;
&lt;li&gt;Update Undoçš„&lt;code&gt;roll_pointer&lt;/code&gt;ä¸²è”ç‰ˆæœ¬é“¾ï¼Œæ”¯æŒ&lt;code&gt;READ COMMITTED&lt;/code&gt;å’Œ&lt;code&gt;REPEATABLE READ&lt;/code&gt;éš”ç¦»çº§åˆ«ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–å»ºè®®ï¼š
&lt;ul&gt;
&lt;li&gt;ç›‘æ§é•¿äº‹åŠ¡ï¼šé¿å…Update Undoå †ç§¯å¯¼è‡´ç©ºé—´è†¨èƒ€ï¼ˆ&lt;code&gt;information_schema.innodb_trx&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯ç”¨ç‹¬ç«‹UNDOè¡¨ç©ºé—´ï¼šMySQL 8.0+å»ºè®®é…ç½®&lt;code&gt;innodb_undo_tablespaces&lt;/code&gt;éš”ç¦»å­˜å‚¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼šUNDOæ—¥å¿—é€šè¿‡&lt;strong&gt;ç±»å‹åˆ†åŒ–&lt;/strong&gt;å®ç°é«˜æ•ˆå›æ»šä¸å¹¶å‘æ§åˆ¶â€”â€”Insertå‹â€œå¿«è¿›å¿«å‡ºâ€ï¼ŒUpdateå‹â€œæŒä¹…æœåŠ¡â€ï¼ŒäºŒè€…ååŒæˆä¸ºInnoDBäº‹åŠ¡ç³»ç»Ÿçš„æ ¸å¿ƒæ”¯æŸ±ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="mvcc"&gt;MVCC
&lt;/h2&gt;&lt;p&gt;MVCCï¼ˆMulti-Version Concurrency Controlï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰æ˜¯ç°ä»£æ•°æ®åº“å®ç°é«˜å¹¶å‘äº‹åŠ¡å¤„ç†çš„æ ¸å¿ƒæœºåˆ¶ï¼Œé€šè¿‡ç»´æŠ¤æ•°æ®çš„å¤šä¸ªå†å²ç‰ˆæœ¬ï¼Œå®ç°è¯»å†™æ“ä½œå¹¶è¡Œæ‰§è¡Œï¼Œé¿å…ä¼ ç»Ÿé”æœºåˆ¶çš„æ€§èƒ½ç“¶é¢ˆã€‚ä»¥ä¸‹ä»&lt;strong&gt;å®ç°åŸç†ã€å·¥ä½œæµç¨‹ã€éš”ç¦»çº§åˆ«é€‚é…åŠä¼˜åŠ£&lt;/strong&gt;ç­‰æ–¹é¢å±•å¼€è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-mvcc-çš„æ ¸å¿ƒå®ç°æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;MVCC çš„æ ¸å¿ƒå®ç°æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="éšè—å­—æ®µä¸ç‰ˆæœ¬é“¾"&gt;&lt;strong&gt;éšè—å­—æ®µä¸ç‰ˆæœ¬é“¾&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;InnoDB ä¸ºæ¯è¡Œæ•°æ®æ·»åŠ ä¸‰ä¸ªéšè—å­—æ®µï¼Œæ„å»ºç‰ˆæœ¬é“¾åŸºç¡€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;DB_TRX_ID&lt;/code&gt;ï¼ˆ6å­—èŠ‚ï¼‰&lt;/strong&gt;ï¼šè®°å½•æœ€è¿‘ä¿®æ”¹è¯¥è¡Œçš„äº‹åŠ¡IDï¼ˆåŒ…æ‹¬æ’å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;DB_ROLL_PTR&lt;/code&gt;ï¼ˆ7å­—èŠ‚ï¼‰&lt;/strong&gt;ï¼šå›æ»šæŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥è¡Œåœ¨Undo Logä¸­çš„æ—§ç‰ˆæœ¬åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;DB_ROW_ID&lt;/code&gt;ï¼ˆ6å­—èŠ‚ï¼‰&lt;/strong&gt;ï¼šå½“è¡¨æ— ä¸»é”®æ—¶è‡ªåŠ¨ç”Ÿæˆçš„éšè—ä¸»é”®ã€‚
æ¯æ¬¡æ•°æ®ä¿®æ”¹ï¼ˆå¦‚UPDATEï¼‰æ—¶ï¼ŒInnoDBä¼šç”Ÿæˆæ–°çš„Undo Logè®°å½•æ—§å€¼ï¼Œå¹¶é€šè¿‡&lt;code&gt;DB_ROLL_PTR&lt;/code&gt;ä¸²è”æˆ&lt;strong&gt;ç‰ˆæœ¬é“¾&lt;/strong&gt;ï¼Œå½¢æˆå†å²å¿«ç…§é“¾è¡¨ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
å½“å‰è®°å½•[DB_TRX_ID=äº‹åŠ¡N] --&amp;gt;|DB_ROLL_PTR| ç‰ˆæœ¬1[DB_TRX_ID=äº‹åŠ¡M]
ç‰ˆæœ¬1 --&amp;gt;|DB_ROLL_PTR| ç‰ˆæœ¬2[DB_TRX_ID=äº‹åŠ¡K]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="undo-log-çš„ä½œç”¨"&gt;&lt;strong&gt;Undo Log çš„ä½œç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨å†å²ç‰ˆæœ¬&lt;/strong&gt;ï¼šæ•°æ®ä¿®æ”¹å‰çš„çŠ¶æ€ä¿å­˜åœ¨Undo Logä¸­ï¼Œç”¨äºå›æ»šå’ŒMVCCå¿«ç…§è¯»å–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬é“¾ç®¡ç†&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;DB_ROLL_PTR&lt;/code&gt;æŒ‡é’ˆï¼ŒåŒä¸€è¡Œæ•°æ®çš„å¤šä¸ªç‰ˆæœ¬å½¢æˆå•å‘é“¾è¡¨ï¼Œå¤´éƒ¨ä¸ºæœ€æ–°ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="read-viewè¯»è§†å›¾"&gt;&lt;strong&gt;Read Viewï¼ˆè¯»è§†å›¾ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å†³å®šäº‹åŠ¡è¯»å–å“ªä¸ªç‰ˆæœ¬çš„å…³é”®ç»„ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;m_ids&lt;/code&gt;&lt;/strong&gt;ï¼šç”ŸæˆRead Viewæ—¶æ´»è·ƒäº‹åŠ¡IDåˆ—è¡¨ï¼ˆæœªæäº¤äº‹åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;min_trx_id&lt;/code&gt;&lt;/strong&gt;ï¼šæ´»è·ƒäº‹åŠ¡ä¸­çš„æœ€å°IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;max_trx_id&lt;/code&gt;&lt;/strong&gt;ï¼šç³»ç»Ÿé¢„åˆ†é…çš„ä¸‹ä¸€ä¸ªäº‹åŠ¡IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;creator_trx_id&lt;/code&gt;&lt;/strong&gt;ï¼šåˆ›å»ºè¯¥Read Viewçš„äº‹åŠ¡IDã€‚
&lt;strong&gt;å¯è§æ€§åˆ¤æ–­è§„åˆ™&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;è‹¥ç‰ˆæœ¬&lt;code&gt;DB_TRX_ID&lt;/code&gt; &amp;lt; &lt;code&gt;min_trx_id&lt;/code&gt; â†’ &lt;strong&gt;å¯è§&lt;/strong&gt;ï¼ˆç‰ˆæœ¬ç”±å·²æäº¤äº‹åŠ¡ä¿®æ”¹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥&lt;code&gt;DB_TRX_ID&lt;/code&gt; â‰¥ &lt;code&gt;max_trx_id&lt;/code&gt; â†’ &lt;strong&gt;ä¸å¯è§&lt;/strong&gt;ï¼ˆç‰ˆæœ¬ç”±æœªæ¥äº‹åŠ¡ç”Ÿæˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ min_trx_id â‰¤ DB_TRX_ID &amp;lt; max_trx_idï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DB_TRX_ID&lt;/code&gt;åœ¨&lt;code&gt;m_ids&lt;/code&gt;ä¸­ â†’ &lt;strong&gt;ä¸å¯è§&lt;/strong&gt;ï¼ˆæœªæäº¤äº‹åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸åœ¨&lt;code&gt;m_ids&lt;/code&gt;ä¸­ â†’ &lt;strong&gt;å¯è§&lt;/strong&gt;ï¼ˆå·²æäº¤äº‹åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‹¥&lt;code&gt;DB_TRX_ID&lt;/code&gt; = &lt;code&gt;creator_trx_id&lt;/code&gt; â†’ &lt;strong&gt;å¯è§&lt;/strong&gt;ï¼ˆå½“å‰äº‹åŠ¡è‡ªèº«ä¿®æ”¹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šäº‹åŠ¡Aï¼ˆID=150ï¼‰çš„Read Viewä¸­&lt;code&gt;min_trx_id=100&lt;/code&gt;, &lt;code&gt;max_trx_id=250&lt;/code&gt;, &lt;code&gt;m_ids=[100,200]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥è®°å½•ç‰ˆæœ¬&lt;code&gt;DB_TRX_ID=200&lt;/code&gt;ï¼ˆåœ¨&lt;code&gt;m_ids&lt;/code&gt;ä¸­ï¼‰â†’ ä¸å¯è§ï¼Œéœ€å›æº¯æ—§ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;å›æº¯åˆ°&lt;code&gt;DB_TRX_ID=80&lt;/code&gt;ï¼ˆ&amp;lt;100ï¼‰â†’ å¯è§ï¼Œè¿”å›æ­¤ç‰ˆæœ¬æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-mvcc-çš„å·¥ä½œæµç¨‹"&gt;ğŸ”„ &lt;strong&gt;MVCC çš„å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="è¯»æ“ä½œå¿«ç…§è¯»"&gt;&lt;strong&gt;è¯»æ“ä½œï¼ˆå¿«ç…§è¯»ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ™®é€šSELECT&lt;/strong&gt;ï¼šåŸºäºRead ViewæŸ¥æ‰¾ç‰ˆæœ¬é“¾ä¸­ç¬¬ä¸€ä¸ªå¯è§çš„ç‰ˆæœ¬ï¼Œè¿”å›å†å²å¿«ç…§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é”è®¾è®¡&lt;/strong&gt;ï¼šè¯»æ“ä½œä¸é˜»å¡å†™æ“ä½œï¼Œå†™æ“ä½œä¹Ÿä¸é˜»å¡è¯»æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å†™æ“ä½œå½“å‰è¯»"&gt;&lt;strong&gt;å†™æ“ä½œï¼ˆå½“å‰è¯»ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;UPDATE/DELETE&lt;/strong&gt;ï¼šç”Ÿæˆæ–°ç‰ˆæœ¬å¹¶æ›´æ–°&lt;code&gt;DB_TRX_ID&lt;/code&gt;å’Œ&lt;code&gt;DB_ROLL_PTR&lt;/code&gt;ï¼ŒåŒæ—¶è®°å½•Undo Logã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;INSERT&lt;/strong&gt;ï¼šæ–°å»ºè®°å½•å¹¶è®¾ç½®&lt;code&gt;DB_TRX_ID&lt;/code&gt;ä¸ºå½“å‰äº‹åŠ¡IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ é”è¦æ±‚&lt;/strong&gt;ï¼šå†™æ“ä½œéœ€åŠ è¡Œé”ï¼ˆå¦‚Xé”ï¼‰ä¿è¯ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å´©æºƒæ¢å¤"&gt;&lt;strong&gt;å´©æºƒæ¢å¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redo Logé‡åš&lt;/strong&gt;ï¼šæ¢å¤å·²æäº¤äº‹åŠ¡çš„ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Undo Logå›æ»š&lt;/strong&gt;ï¼šæ’¤é”€æœªæäº¤äº‹åŠ¡çš„ä¿®æ”¹ï¼Œä¾èµ–ç‰ˆæœ¬é“¾è¿˜åŸæ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-mvcc-ä¸äº‹åŠ¡éš”ç¦»çº§åˆ«"&gt;ğŸ“Š &lt;strong&gt;MVCC ä¸äº‹åŠ¡éš”ç¦»çº§åˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸åŒéš”ç¦»çº§åˆ«é€šè¿‡è°ƒæ•´&lt;strong&gt;Read Viewç”Ÿæˆæ—¶æœº&lt;/strong&gt;å®ç°ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;éš”ç¦»çº§åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Read Viewç”Ÿæˆæ—¶æœº&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§£å†³çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹»è¯»å¤„ç†&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;READ COMMITTED&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯æ¬¡SELECTç”Ÿæˆæ–°çš„Read View&lt;/td&gt;
&lt;td&gt;è„è¯»&lt;/td&gt;
&lt;td&gt;âŒ å¯èƒ½å‡ºç°ï¼ˆè¯»åˆ°æ–°æäº¤çš„æ•°æ®ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;REPEATABLE READ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡é¦–æ¬¡SELECTç”Ÿæˆå›ºå®šRead View&lt;/td&gt;
&lt;td&gt;è„è¯»ã€ä¸å¯é‡å¤è¯»&lt;/td&gt;
&lt;td&gt;âœ… é€šè¿‡Next-Keyé”é˜²æ­¢ï¼ˆInnoDBç‰¹æœ‰ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;SERIALIZABLE&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ä¾èµ–MVCCï¼Œå®Œå…¨åŠ é”&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰å¹¶å‘é—®é¢˜&lt;/td&gt;
&lt;td&gt;âœ… é”è¡¨ä¿è¯ä¸²è¡Œæ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;READ UNCOMMITTED&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ä½¿ç”¨MVCC&lt;/td&gt;
&lt;td&gt;æ— ä¿éšœï¼ˆå¯èƒ½è¯»åˆ°æœªæäº¤æ•°æ®ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ å¯èƒ½å‡ºç°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RRçº§åˆ«ä¸‹ï¼Œé¦–æ¬¡SELECTçš„å¿«ç…§åœ¨äº‹åŠ¡æœŸé—´å›ºå®šï¼Œå› æ­¤åŒä¸€äº‹åŠ¡å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;RCçº§åˆ«ä¸‹ï¼Œæ¯æ¬¡SELECTå¯èƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡æ–°æäº¤çš„æ•°æ®ï¼ˆä¸å¯é‡å¤è¯»ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-mvcc-çš„ä¼˜ç¼ºç‚¹"&gt;âš–ï¸ &lt;strong&gt;MVCC çš„ä¼˜ç¼ºç‚¹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="-æ ¸å¿ƒä¼˜åŠ¿"&gt;âœ… &lt;strong&gt;æ ¸å¿ƒä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;é«˜å¹¶å‘æ€§èƒ½
&lt;ul&gt;
&lt;li&gt;è¯»å†™æ“ä½œæ— éœ€ç›¸äº’é˜»å¡ï¼Œæ˜¾è‘—æå‡ç³»ç»Ÿååé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®ä¸€è‡´æ€§ä¿éšœ
&lt;ul&gt;
&lt;li&gt;å¿«ç…§è¯»é¿å…è„è¯»ï¼ˆRCçº§åˆ«ï¼‰å’Œä¸å¯é‡å¤è¯»ï¼ˆRRçº§åˆ«ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‡å°‘æ­»é”
&lt;ul&gt;
&lt;li&gt;è¯»æ“ä½œæ— é”è®¾è®¡é™ä½æ­»é”æ¦‚ç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="-å›ºæœ‰ç¼ºé™·"&gt;âŒ &lt;strong&gt;å›ºæœ‰ç¼ºé™·&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;å­˜å‚¨å¼€é”€
&lt;ul&gt;
&lt;li&gt;å¤šç‰ˆæœ¬æ•°æ®å ç”¨é¢å¤–ç©ºé—´ï¼ˆUndo Logè†¨èƒ€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¸…ç†æˆæœ¬
&lt;ul&gt;
&lt;li&gt;Purgeçº¿ç¨‹éœ€æ¸…ç†æ— ç”¨çš„å†å²ç‰ˆæœ¬ï¼ˆé•¿äº‹åŠ¡ä¼šé˜»å¡æ¸…ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¹»è¯»é™åˆ¶
&lt;ul&gt;
&lt;li&gt;MVCCæœ¬èº«æ— æ³•å®Œå…¨è§£å†³å¹»è¯»ï¼ˆRRçº§åˆ«éœ€ä¾èµ–Next-Keyé”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é•¿äº‹åŠ¡é£é™©
&lt;ul&gt;
&lt;li&gt;æœªæäº¤äº‹åŠ¡ä¼šé˜»æ­¢Purgeçº¿ç¨‹æ¸…ç†å…¶ä¾èµ–çš„Undo Logï¼Œå¯¼è‡´&lt;strong&gt;ç‰ˆæœ¬è†¨èƒ€&lt;/strong&gt;ï¼ˆç›‘æ§&lt;code&gt;information_schema.innodb_trx&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;äºŒçº§ç´¢å¼•é™åˆ¶
&lt;ul&gt;
&lt;li&gt;äºŒçº§ç´¢å¼•ä¸å­˜å‚¨äº‹åŠ¡IDï¼Œéœ€å›è¡¨åˆ°èšç°‡ç´¢å¼•åˆ¤æ–­å¯è§æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–å»ºè®®
&lt;ul&gt;
&lt;li&gt;å¯ç”¨ç‹¬ç«‹Undoè¡¨ç©ºé—´ï¼ˆMySQL 8.0+é…ç½®&lt;code&gt;innodb_undo_tablespaces&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…RRçº§åˆ«ä¸‹çš„é•¿èŒƒå›´æŸ¥è¯¢ï¼ˆå¯èƒ½è§¦å‘Next-Keyé”ç«äº‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;MVCCæ˜¯æ•°æ®åº“é«˜å¹¶å‘çš„&lt;strong&gt;åŸºçŸ³æŠ€æœ¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬é“¾ + Read View&lt;/strong&gt; å®ç°éé˜»å¡å¿«ç…§è¯»ï¼Œè§£å†³è¯»å†™å†²çªï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Undo Logå¤šç‰ˆæœ¬å­˜å‚¨&lt;/strong&gt; æ”¯æŒäº‹åŠ¡å›æ»šä¸å†å²å¿«ç…§ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»çº§åˆ«é€‚é…&lt;/strong&gt; çµæ´»å¹³è¡¡æ€§èƒ½ä¸ä¸€è‡´æ€§éœ€æ±‚ã€‚
å…¶ä»·å€¼åœ¨äºä»¥&lt;strong&gt;ç©ºé—´æ¢æ—¶é—´&lt;/strong&gt;ï¼Œä¸ºOLTPåœºæ™¯æä¾›é«˜æ•ˆã€å®‰å…¨çš„å¹¶å‘æ§åˆ¶æ–¹æ¡ˆï¼Œä½†éœ€è­¦æƒ•å­˜å‚¨æˆæœ¬ä¸é•¿äº‹åŠ¡å¸¦æ¥çš„è¿ç»´æŒ‘æˆ˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="read-review"&gt;READ REVIEW
&lt;/h2&gt;&lt;p&gt;READ VIEWï¼ˆè¯»è§†å›¾ï¼‰æ˜¯MySQL InnoDBå­˜å‚¨å¼•æ“å®ç°MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰çš„æ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œå…¶æœ¬è´¨æ˜¯&lt;strong&gt;å†…å­˜ä¸­çš„ä¸´æ—¶å¿«ç…§&lt;/strong&gt;ï¼Œä¸ç›´æ¥æŒä¹…åŒ–å­˜å‚¨åˆ°ç£ç›˜ã€‚å…¶å­˜å‚¨ä½ç½®å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨ä½ç½®å†…å­˜ä¸­çš„åŠ¨æ€ç»“æ„"&gt;ğŸ’¾ &lt;strong&gt;å­˜å‚¨ä½ç½®ï¼šå†…å­˜ä¸­çš„åŠ¨æ€ç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;READ VIEW &lt;strong&gt;å®Œå…¨å­˜å‚¨åœ¨å†…å­˜ä¸­&lt;/strong&gt;ï¼Œç”±InnoDBäº‹åŠ¡ç³»ç»Ÿåœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºå’Œç»´æŠ¤ã€‚å…·ä½“åŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;m_ids&lt;/code&gt;&lt;/strong&gt;ï¼šç”ŸæˆREAD VIEWæ—¶æ‰€æœ‰æ´»è·ƒäº‹åŠ¡IDçš„æœ‰åºé›†åˆï¼ˆæ´»è·ƒäº‹åŠ¡æŒ‡å·²å¯åŠ¨ä½†æœªæäº¤çš„äº‹åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;min_trx_id&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;code&gt;m_ids&lt;/code&gt;ä¸­çš„æœ€å°äº‹åŠ¡IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;max_trx_id&lt;/code&gt;&lt;/strong&gt;ï¼šç”ŸæˆREAD VIEWæ—¶ï¼Œç³»ç»Ÿå³å°†åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„IDï¼ˆå³å½“å‰æœ€å¤§äº‹åŠ¡ID+1ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;creator_trx_id&lt;/code&gt;&lt;/strong&gt;ï¼šåˆ›å»ºè¯¥READ VIEWçš„äº‹åŠ¡è‡ªèº«IDã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š
äº‹åŠ¡Aï¼ˆID=100ï¼‰ç”ŸæˆREAD VIEWæ—¶ï¼Œæ´»è·ƒäº‹åŠ¡IDåˆ—è¡¨ä¸º[200, 300]ï¼Œåˆ™ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;m_ids = [200, 300]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;min_trx_id = 200&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;max_trx_id = 301&lt;/code&gt;ï¼ˆå‡è®¾ä¸‹ä¸€ä¸ªå¾…åˆ†é…äº‹åŠ¡IDï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;creator_trx_id = 100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿå‘½å‘¨æœŸä¾èµ–äº‹åŠ¡éš”ç¦»çº§åˆ«"&gt;â³ &lt;strong&gt;ç”Ÿå‘½å‘¨æœŸï¼šä¾èµ–äº‹åŠ¡éš”ç¦»çº§åˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;READ VIEWçš„åˆ›å»ºå’Œé”€æ¯ç”±äº‹åŠ¡éš”ç¦»çº§åˆ«å†³å®šï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;éš”ç¦»çº§åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;READ VIEWç”Ÿæˆæ—¶æœº&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é”€æ¯æ—¶æœº&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;REPEATABLE READ (RR)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡ä¸­é¦–æ¬¡å¿«ç…§è¯»ï¼ˆå¦‚SELECTï¼‰æ—¶ç”Ÿæˆ&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡ç»“æŸæ—¶ï¼ˆCOMMIT/ROLLBACKï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;READ COMMITTED (RC)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯æ¬¡å¿«ç…§è¯»å‰ç”Ÿæˆæ–°çš„READ VIEW&lt;/td&gt;
&lt;td&gt;å½“å‰SQLæ‰§è¡Œå®Œæˆå&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;READ UNCOMMITTED (RU)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸ä½¿ç”¨READ VIEW&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;SERIALIZABLE&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸ä½¿ç”¨READ VIEWï¼ˆä¾èµ–é”æœºåˆ¶ï¼‰&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®å·®å¼‚&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RRçº§åˆ«&lt;/strong&gt;ï¼šä¸€ä¸ªäº‹åŠ¡å†…å¤ç”¨åŒä¸€ä¸ªREAD VIEWï¼Œä¿è¯å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RCçº§åˆ«&lt;/strong&gt;ï¼šæ¯æ¬¡æŸ¥è¯¢ç”Ÿæˆæ–°READ VIEWï¼Œå¯èƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡æ–°æäº¤çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸æŒä¹…åŒ–ç»„ä»¶çš„å…³è”"&gt;ğŸ”— &lt;strong&gt;ä¸æŒä¹…åŒ–ç»„ä»¶çš„å…³è”&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è™½ç„¶READ VIEWæœ¬èº«ä¸è½ç›˜ï¼Œä½†å…¶ä¾èµ–çš„æ•°æ®æ¥æºäºæŒä¹…åŒ–ç»„ä»¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;äº‹åŠ¡IDæ¥æºï¼š
&lt;ul&gt;
&lt;li&gt;æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ï¼ˆ&lt;code&gt;m_ids&lt;/code&gt;ï¼‰ä»å…¨å±€äº‹åŠ¡ç³»ç»Ÿï¼ˆ&lt;code&gt;trx_sys&lt;/code&gt;ï¼‰çš„å†…å­˜ç»“æ„ä¸­è·å–ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡IDåˆ†é…åŸºäºç£ç›˜ä¸Šçš„&lt;strong&gt;äº‹åŠ¡ç³»ç»Ÿå…ƒæ•°æ®&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;INNODB_SYS_TABLESPACES&lt;/code&gt;ï¼‰ï¼Œä½†IDæœ¬èº«æ˜¯å†…å­˜åŠ¨æ€ç”Ÿæˆçš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‰ˆæœ¬é“¾ä¾èµ–ï¼š
&lt;ul&gt;
&lt;li&gt;READ VIEWé€šè¿‡æ•°æ®è¡Œçš„&lt;code&gt;trx_id&lt;/code&gt;å’Œ&lt;code&gt;roll_pointer&lt;/code&gt;å­—æ®µè®¿é—®UNDO LOGä¸­çš„å†å²ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;UNDO LOGå­˜å‚¨åœ¨&lt;strong&gt;ç‹¬ç«‹è¡¨ç©ºé—´æˆ–ç³»ç»Ÿè¡¨ç©ºé—´&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;ibdata1&lt;/code&gt;æˆ–&lt;code&gt;undo_001&lt;/code&gt;ï¼‰ï¼Œæ˜¯READ VIEWåˆ¤æ–­æ•°æ®å¯è§æ€§çš„æŒä¹…åŒ–åŸºç¡€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿäº§æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ç”Ÿäº§æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å†…å­˜å ç”¨ï¼š
&lt;ul&gt;
&lt;li&gt;é•¿äº‹åŠ¡æˆ–é«˜å¹¶å‘åœºæ™¯å¯èƒ½å †ç§¯å¤§é‡READ VIEWï¼Œå ç”¨å†…å­˜èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å»ºè®®&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;SHOW ENGINE INNODB STATUS&lt;/code&gt;è§‚å¯Ÿäº‹åŠ¡çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;RRçº§åˆ«ä¸‹READ VIEWå¤ç”¨å‡å°‘å†…å­˜åˆ†é…å¼€é”€ï¼Œå¯èƒ½æ¯”RCçº§åˆ«æ€§èƒ½æ›´é«˜ï¼ˆå¦‚sysbenchæµ‹è¯•ä¸­RRçš„QPSé«˜å‡º10%ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…é•¿äº‹åŠ¡ï¼šé˜²æ­¢READ VIEWé•¿æœŸæŒæœ‰å¯¼è‡´UNDO LOGæ— æ³•æ¸…ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å´©æºƒæ¢å¤ï¼š
&lt;ul&gt;
&lt;li&gt;æ•°æ®åº“é‡å¯åREAD VIEWä¸¢å¤±ï¼Œä½†é€šè¿‡REDO LOGé‡åšå’ŒUNDO LOGå›æ»šå¯é‡å»ºä¸€è‡´æ€§çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-11"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;READ VIEWæ˜¯InnoDB MVCCçš„&lt;strong&gt;å†…å­˜å¿«ç…§&lt;/strong&gt;ï¼Œæ ¸å¿ƒæ•°æ®å­˜å‚¨åœ¨å†…å­˜çš„äº‹åŠ¡ç³»ç»Ÿç»“æ„ä¸­ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸç”±éš”ç¦»çº§åˆ«åŠ¨æ€ç®¡ç†ã€‚å®ƒé€šè¿‡é“¾æ¥UNDO LOGçš„æŒä¹…åŒ–ç‰ˆæœ¬é“¾å®ç°æ•°æ®å¯è§æ€§åˆ¤æ–­ï¼Œæ˜¯å¹³è¡¡æ€§èƒ½ä¸ä¸€è‡´æ€§çš„å…³é”®è®¾è®¡ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;âš™ï¸ &lt;strong&gt;è¿ç»´æç¤º&lt;/strong&gt;ï¼šç›‘æ§é•¿äº‹åŠ¡ï¼ˆ&lt;code&gt;information_schema.innodb_trx&lt;/code&gt;ï¼‰å’ŒUNDOè¡¨ç©ºé—´ä½¿ç”¨ç‡ï¼Œé¿å…å†…å­˜ä¸å­˜å‚¨çš„è¿é”é—®é¢˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ•°æ®ä¸ä¸€è‡´"&gt;æ•°æ®ä¸ä¸€è‡´
&lt;/h2&gt;&lt;p&gt;åœ¨æ•°æ®åº“äº‹åŠ¡çš„å¹¶å‘æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¸ä¸€è‡´é—®é¢˜ä¸»è¦ç”±&lt;strong&gt;è„è¯»ï¼ˆDirty Readï¼‰&lt;/strong&gt;ã€&lt;strong&gt;ä¸å¯é‡å¤è¯»ï¼ˆNon-Repeatable Readï¼‰&lt;/strong&gt; å’Œ&lt;strong&gt;å¹»è¯»ï¼ˆPhantom Readï¼‰&lt;/strong&gt; ä¸‰ç±»é—®é¢˜æ„æˆã€‚è¿™äº›é—®é¢˜çš„æ ¹æºåœ¨äºäº‹åŠ¡éš”ç¦»æœºåˆ¶ä¸å®Œå–„ï¼Œå¯¼è‡´å¹¶å‘æ“ä½œç ´åæ•°æ®ä¸€è‡´æ€§ã€‚ä»¥ä¸‹ä»å®šä¹‰ã€åœºæ™¯ã€å½±å“åŠè§£å†³æ–¹æ¡ˆå±•å¼€åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è„è¯»dirty-read"&gt;âš ï¸ &lt;strong&gt;è„è¯»ï¼ˆDirty Readï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å¦ä¸€ä¸ª&lt;strong&gt;æœªæäº¤äº‹åŠ¡&lt;/strong&gt;ä¿®æ”¹çš„æ•°æ®ã€‚è‹¥æœªæäº¤äº‹åŠ¡å›æ»šï¼Œè¯»å–çš„æ•°æ®å³ä¸ºæ— æ•ˆçš„â€œè„æ•°æ®â€ã€‚
â€‹&lt;strong&gt;åœºæ™¯ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡Aä¿®æ”¹æŸè¡Œæ•°æ®ï¼ˆå¦‚å°†ä½™é¢ä»1000æ”¹ä¸º500ï¼‰ï¼Œæœªæäº¤ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡Bè¯»å–è¯¥è¡Œæ•°æ®ï¼Œå¾—åˆ°ä½™é¢=500ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡Aå›æ»šä¿®æ”¹ï¼ˆä½™é¢æ¢å¤ä¸º1000ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡BåŸºäºæ— æ•ˆæ•°æ®ï¼ˆä½™é¢=500ï¼‰ç»§ç»­æ“ä½œï¼Œå¯¼è‡´é€»è¾‘é”™è¯¯ã€‚
â€‹&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;â€‹ï¼šè¯»å–äº†å¯èƒ½è¢«æ’¤é”€çš„â€œåŠæˆå“â€æ•°æ®ã€‚
â€‹&lt;strong&gt;è§£å†³æ–¹å¼&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;li&gt;éš”ç¦»çº§åˆ«æå‡è‡³ &lt;strong&gt;è¯»å·²æäº¤ï¼ˆRead Committedï¼‰&lt;/strong&gt; æˆ–æ›´é«˜ï¼Œç¦æ­¢è¯»å–æœªæäº¤æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å¯é‡å¤è¯»non-repeatable-read"&gt;ğŸ”„ &lt;strong&gt;ä¸å¯é‡å¤è¯»ï¼ˆNon-Repeatable Readï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šåŒä¸€äº‹åŠ¡å†…å¤šæ¬¡è¯»å–&lt;strong&gt;åŒä¸€è¡Œæ•°æ®&lt;/strong&gt;ï¼Œç»“æœå› å…¶ä»–äº‹åŠ¡çš„&lt;strong&gt;ä¿®æ”¹æäº¤&lt;/strong&gt;è€Œä¸ä¸€è‡´ã€‚
â€‹&lt;strong&gt;åœºæ™¯ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡Aé¦–æ¬¡è¯»å–ä½™é¢=1000ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡Bä¿®æ”¹ä½™é¢ä¸º2000å¹¶æäº¤ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡Aå†æ¬¡è¯»å–åŒä¸€è¡Œï¼Œä½™é¢å˜ä¸º2000ï¼Œä¸ç¬¬ä¸€æ¬¡ç»“æœå†²çªã€‚
â€‹&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;â€‹ï¼šåŒä¸€è¡Œæ•°æ®åœ¨äº‹åŠ¡å†…â€œå˜è„¸â€ã€‚
â€‹&lt;strong&gt;ä¸è„è¯»åŒºåˆ«&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;li&gt;è„è¯»è¯»å–&lt;strong&gt;æœªæäº¤&lt;/strong&gt;æ•°æ®ï¼›ä¸å¯é‡å¤è¯»è¯»å–çš„æ˜¯&lt;strong&gt;å·²æäº¤&lt;/strong&gt;çš„ä¿®æ”¹ã€‚
â€‹&lt;strong&gt;è§£å†³æ–¹å¼&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;li&gt;éš”ç¦»çº§åˆ«æå‡è‡³ &lt;strong&gt;å¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰&lt;/strong&gt; ï¼Œé€šè¿‡äº‹åŠ¡å¿«ç…§å›ºå®šæ•°æ®è§†å›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¹»è¯»phantom-read"&gt;ğŸ‘» &lt;strong&gt;å¹»è¯»ï¼ˆPhantom Readï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šåŒä¸€äº‹åŠ¡å†…å¤šæ¬¡&lt;strong&gt;èŒƒå›´æŸ¥è¯¢&lt;/strong&gt;ï¼Œç»“æœé›†è¡Œæ•°å› å…¶ä»–äº‹åŠ¡çš„&lt;strong&gt;æ’å…¥æˆ–åˆ é™¤&lt;/strong&gt;è€Œå¢å‡ã€‚
â€‹&lt;strong&gt;åœºæ™¯ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡AæŸ¥è¯¢å¹´é¾„&amp;gt;30å²çš„ç”¨æˆ·ï¼Œè¿”å›10æ¡è®°å½•ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡Bæ’å…¥ä¸€æ¡å¹´é¾„=35å²çš„ç”¨æˆ·å¹¶æäº¤ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡Aå†æ¬¡æŸ¥è¯¢ï¼Œè¿”å›11æ¡è®°å½•ï¼Œå¤šå‡ºâ€œå¹»å½±è¡Œâ€ã€‚
â€‹&lt;strong&gt;ç‰¹æ®Šè§¦å‘&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–°å¯¼è‡´å¹»è¯»&lt;/strong&gt;ï¼šè‹¥äº‹åŠ¡Bæ›´æ–°æ•°æ®ï¼Œä½¿åŸæœ¬ä¸ç¬¦åˆæ¡ä»¶çš„è¡Œå˜ä¸ºç¬¦åˆæ¡ä»¶ï¼ˆå¦‚å¹´é¾„ä»25æ”¹ä¸º35ï¼‰ï¼Œä¹Ÿå¯èƒ½å¯¼è‡´å¹»è¯»ã€‚
â€‹&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;â€‹ï¼šæ•°æ®â€œå‡­ç©ºå‡ºç°æˆ–æ¶ˆå¤±â€ã€‚
â€‹&lt;strong&gt;ä¸ä¸å¯é‡å¤è¯»åŒºåˆ«&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;li&gt;ä¸å¯é‡å¤è¯»å…³æ³¨&lt;strong&gt;å•è¡Œæ•°æ®å€¼å˜åŒ–&lt;/strong&gt;ï¼›å¹»è¯»å…³æ³¨&lt;strong&gt;ç»“æœé›†è¡Œæ•°å˜åŒ–&lt;/strong&gt;ã€‚
â€‹&lt;strong&gt;è§£å†³æ–¹å¼&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸¥æ ¼æ–¹æ¡ˆ&lt;/strong&gt;ï¼šéš”ç¦»çº§åˆ«æå‡è‡³ &lt;strong&gt;ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰&lt;/strong&gt; ï¼Œé€šè¿‡èŒƒå›´é”ç¦æ­¢å…¶ä»–äº‹åŠ¡æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MySQLä¼˜åŒ–&lt;/strong&gt;ï¼šInnoDBåœ¨ &lt;strong&gt;å¯é‡å¤è¯»&lt;/strong&gt; çº§åˆ«é€šè¿‡ &lt;strong&gt;Next-Keyé”&lt;/strong&gt;ï¼ˆé—´éš™é”+è®°å½•é”ï¼‰éƒ¨åˆ†é¿å…å¹»è¯»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸é—®é¢˜è§£å†³èƒ½åŠ›"&gt;ğŸ“Š &lt;strong&gt;äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸é—®é¢˜è§£å†³èƒ½åŠ›&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸åŒéš”ç¦»çº§åˆ«å¯¹ä¸‰ç±»é—®é¢˜çš„é˜²æŠ¤èƒ½åŠ›å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;éš”ç¦»çº§åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;è„è¯»&lt;/th&gt;
&lt;th&gt;ä¸å¯é‡å¤è¯»&lt;/th&gt;
&lt;th&gt;å¹»è¯»&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»å·²æäº¤ï¼ˆRead Committedï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âš ï¸*&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸* MySQLçš„InnoDBå¼•æ“åœ¨å¯é‡å¤è¯»çº§åˆ«é€šè¿‡ &lt;strong&gt;MVCCå¿«ç…§è¯»+Next-Keyé”&lt;/strong&gt; è§„é¿äº†å¤§éƒ¨åˆ†å¹»è¯»ï¼Œä½†â€œå½“å‰è¯»â€ï¼ˆå¦‚&lt;code&gt;SELECT ... FOR UPDATE&lt;/code&gt;ï¼‰ä»å¯èƒ½å‘ç”Ÿã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…å½±å“ä¸è®¾è®¡å»ºè®®"&gt;âš–ï¸ &lt;strong&gt;å®é™…å½±å“ä¸è®¾è®¡å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ä¸šåŠ¡é£é™©ï¼š
&lt;ul&gt;
&lt;li&gt;è„è¯»ï¼šå¯¼è‡´åŸºäºæ— æ•ˆæ•°æ®çš„æ“ä½œï¼ˆå¦‚é”™è¯¯æ‰£æ¬¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯é‡å¤è¯»ï¼šç ´åäº‹åŠ¡å†…é€»è¾‘ä¸€è‡´æ€§ï¼ˆå¦‚æ ¡éªŒå¤±è´¥ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;å¹»è¯»ï¼šå½±å“ç»Ÿè®¡ç»“æœæˆ–å”¯ä¸€çº¦æŸï¼ˆå¦‚é‡å¤è®¢å•å·ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;éš”ç¦»çº§åˆ«é€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤æ¨è&lt;/strong&gt;ï¼šå¤šæ•°æ•°æ®åº“ï¼ˆå¦‚MySQLï¼‰é»˜è®¤ &lt;strong&gt;å¯é‡å¤è¯»&lt;/strong&gt;ï¼Œå¹³è¡¡æ€§èƒ½ä¸ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜ä¸€è‡´æ€§åœºæ™¯&lt;/strong&gt;ï¼šé‡‘èç³»ç»Ÿå¯é‡‡ç”¨ &lt;strong&gt;ä¸²è¡ŒåŒ–&lt;/strong&gt;ï¼Œä½†éœ€æ‰¿å—æ€§èƒ½æŸè€—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–å®è·µï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…é•¿äº‹åŠ¡ï¼Œå‡å°‘å¿«ç…§æŒæœ‰æ—¶é—´ï¼ˆå¦‚ç›‘æ§&lt;code&gt;information_schema.innodb_trx&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹å…³é”®æ“ä½œæ˜¾å¼åŠ é”ï¼ˆå¦‚&lt;code&gt;SELECT ... FOR UPDATE&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-12"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸‰ç±»æ•°æ®ä¸ä¸€è‡´é—®é¢˜é€çº§æ¼”è¿›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è„è¯»&lt;/strong&gt; â†’ è¯»å–æœªæäº¤çš„ä¸­é—´çŠ¶æ€ï¼ˆ&lt;strong&gt;åŠæˆå“æ•°æ®&lt;/strong&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¯é‡å¤è¯»&lt;/strong&gt; â†’ è¯»å–å·²æäº¤çš„ä¿®æ”¹ï¼ˆ&lt;strong&gt;å•è¡Œæ•°æ®å˜è„¸&lt;/strong&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹»è¯»&lt;/strong&gt; â†’ èŒƒå›´æ•°æ®å¢å‡ï¼ˆ&lt;strong&gt;è¡Œæ•°å¹»å½±å˜åŒ–&lt;/strong&gt;ï¼‰ã€‚
é€šè¿‡åˆç†é€‰æ‹©éš”ç¦»çº§åˆ«ï¼ˆå¦‚MySQLé»˜è®¤çš„&lt;strong&gt;å¯é‡å¤è¯»&lt;/strong&gt;ï¼‰å’Œé”æœºåˆ¶ï¼Œå¯åœ¨æ€§èƒ½ä¸ä¸€è‡´æ€§é—´å–å¾—å¹³è¡¡ã€‚éœ€è­¦æƒ•ï¼šâ€‹&lt;strong&gt;éš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œå¹¶å‘æ€§èƒ½è¶Šä½&lt;/strong&gt;ï¼Œéœ€æ ¹æ®ä¸šåŠ¡åœºæ™¯ç²¾ç»†åŒ–è®¾è®¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="é—´éš™é”"&gt;é—´éš™é”
&lt;/h2&gt;&lt;p&gt;åœ¨ MySQL InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œ&lt;strong&gt;è¡Œçº§é”&lt;/strong&gt;å’Œ&lt;strong&gt;MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰&lt;/strong&gt; é€šè¿‡ååŒåˆ†å·¥å®ç° &lt;strong&gt;è¯»å·²æäº¤ï¼ˆRead Committed, RCï¼‰&lt;/strong&gt; éš”ç¦»çº§åˆ«ï¼Œæ—¢é˜²æ­¢è„è¯»åˆæå‡å¹¶å‘æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯ä¸¤è€…çš„ååŒæœºåˆ¶åŠå®ç°ç»†èŠ‚ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-mvcc-çš„æ ¸å¿ƒä½œç”¨æ— é”è¯»å–å·²æäº¤æ•°æ®"&gt;âš™ï¸ &lt;strong&gt;MVCC çš„æ ¸å¿ƒä½œç”¨ï¼šæ— é”è¯»å–å·²æäº¤æ•°æ®&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;MVCC é€šè¿‡ &lt;strong&gt;å¤šç‰ˆæœ¬æ•°æ®å¿«ç…§&lt;/strong&gt; å®ç°è¯»æ“ä½œçš„æ— é˜»å¡ï¼Œç¡®ä¿æ¯æ¬¡æŸ¥è¯¢ä»…è¯»å–å·²æäº¤çš„æ•°æ®ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬é“¾ä¸ Read View&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éšè—å­—æ®µ&lt;/strong&gt;ï¼šæ¯è¡Œæ•°æ®åŒ…å« &lt;code&gt;DB_TRX_ID&lt;/code&gt;ï¼ˆæœ€è¿‘ä¿®æ”¹çš„äº‹åŠ¡IDï¼‰å’Œ &lt;code&gt;DB_ROLL_PTR&lt;/code&gt;ï¼ˆæŒ‡å‘ undo log å†å²ç‰ˆæœ¬çš„æŒ‡é’ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Read View ç”Ÿæˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RC éš”ç¦»çº§åˆ«ä¸‹&lt;/strong&gt;ï¼š&lt;strong&gt;æ¯ä¸ª SQL è¯­å¥æ‰§è¡Œæ—¶&lt;/strong&gt; ç”Ÿæˆç‹¬ç«‹çš„ Read Viewï¼Œè®°å½•å½“å‰æ´»è·ƒäº‹åŠ¡ ID åˆ—è¡¨åŠæœ€å¤§äº‹åŠ¡ IDã€‚&lt;/li&gt;
&lt;li&gt;å¯è§æ€§è§„åˆ™ï¼šä»…è¯»å–æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æ•°æ®ç‰ˆæœ¬ï¼š
&lt;ul&gt;
&lt;li&gt;è¡Œæ•°æ®çš„ &lt;code&gt;DB_TRX_ID&lt;/code&gt; &lt;strong&gt;å°äºå½“å‰ Read View çš„æœ€å°æ´»è·ƒäº‹åŠ¡ ID&lt;/strong&gt;ï¼ˆè¯´æ˜ä¿®æ”¹å·²æäº¤ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æˆ– &lt;code&gt;DB_TRX_ID&lt;/code&gt; &lt;strong&gt;ä¸åœ¨æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ä¸­&lt;/strong&gt;ï¼ˆè¯´æ˜äº‹åŠ¡å·²æäº¤ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜²è„è¯»åŸç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥æŸè¡Œæ•°æ®è¢«æœªæäº¤äº‹åŠ¡ä¿®æ”¹ï¼ˆ&lt;code&gt;DB_TRX_ID&lt;/code&gt; åœ¨æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ä¸­ï¼‰ï¼ŒRead View ä¼šé€šè¿‡ &lt;code&gt;DB_ROLL_PTR&lt;/code&gt; å®šä½åˆ° undo log ä¸­çš„ &lt;strong&gt;ä¸Šä¸€ä¸ªå·²æäº¤ç‰ˆæœ¬&lt;/strong&gt; è¿”å›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šäº‹åŠ¡ B æ›´æ–°æ•°æ®æœªæäº¤æ—¶ï¼Œäº‹åŠ¡ A æŸ¥è¯¢ä¼šè¯»å– undo log ä¸­çš„æ—§ç‰ˆæœ¬ï¼Œé¿å…è„è¯»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…è®¸ä¸å¯é‡å¤è¯»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å› æ¯æ¬¡æŸ¥è¯¢ç”Ÿæˆæ–° Read Viewï¼Œè‹¥ä¸¤æ¬¡æŸ¥è¯¢é—´æœ‰å…¶ä»–äº‹åŠ¡æäº¤ä¿®æ”¹ï¼Œç¬¬äºŒæ¬¡æŸ¥è¯¢ä¼šè¯»å–æ–°æäº¤çš„æ•°æ®ç‰ˆæœ¬ï¼Œå¯¼è‡´ç»“æœä¸ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¡Œçº§é”çš„æ ¸å¿ƒä½œç”¨å†™æ“ä½œå†²çªæ§åˆ¶"&gt;ğŸ”’ &lt;strong&gt;è¡Œçº§é”çš„æ ¸å¿ƒä½œç”¨ï¼šå†™æ“ä½œå†²çªæ§åˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;MVCC å¤„ç†è¯»æ“ä½œï¼Œè€Œè¡Œçº§é”è´Ÿè´£ç®¡ç† &lt;strong&gt;å†™æ“ä½œï¼ˆUPDATE/DELETEï¼‰çš„å¹¶å‘å†²çª&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é”ç±»å‹ä¸è¡Œä¸º&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ’ä»–é”ï¼ˆX Lockï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;å†™æ“ä½œï¼ˆå¦‚ &lt;code&gt;UPDATE&lt;/code&gt;ï¼‰è‡ªåŠ¨å¯¹ç›®æ ‡è¡ŒåŠ æ’ä»–é”ï¼Œ&lt;strong&gt;é˜»å¡å…¶ä»–äº‹åŠ¡å¯¹åŒä¸€è¡Œçš„å†™æ“ä½œ&lt;/strong&gt;ï¼ˆå¦‚å¹¶å‘ UPDATE éœ€ç­‰å¾…é”é‡Šæ”¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RC éš”ç¦»çº§åˆ«ä¸‹&lt;/strong&gt;ï¼š&lt;strong&gt;è¡Œé”åœ¨è¯­å¥æ‰§è¡Œåç«‹å³é‡Šæ”¾&lt;/strong&gt;ï¼ˆä¸ç­‰å¾…äº‹åŠ¡ç»“æŸï¼‰ï¼Œå‡å°‘é”æŒæœ‰æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;æ— é—´éš™é”ï¼ˆGap Lockï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;RC çº§åˆ«ç¦ç”¨é—´éš™é”ï¼Œä»…é”å®šå®é™…å­˜åœ¨çš„è¡Œï¼Œ&lt;strong&gt;å…è®¸å…¶ä»–äº‹åŠ¡åœ¨é—´éš™ä¸­æ’å…¥æ–°æ•°æ®&lt;/strong&gt;ï¼ˆå¯¼è‡´å¹»è¯»ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;å†™-è¯»ä¸é˜»å¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å†™æ“ä½œåŠ é”æœŸé—´ï¼Œ&lt;strong&gt;è¯»æ“ä½œä»å¯é€šè¿‡ MVCC è¯»å–æ—§ç‰ˆæœ¬æ•°æ®&lt;/strong&gt;ï¼ˆå†å²å¿«ç…§ï¼‰ï¼Œæ— éœ€ç­‰å¾…é”é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šäº‹åŠ¡ A æ›´æ–°æŸè¡Œæ—¶ï¼Œäº‹åŠ¡ B çš„ &lt;code&gt;SELECT&lt;/code&gt; é€šè¿‡ Read View è¯»å–æ›´æ–°å‰çš„ç‰ˆæœ¬ï¼Œé¿å…é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™-å†™å†²çªå¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶æ›´æ–°åŒä¸€è¡Œï¼Œåè¯·æ±‚é”çš„äº‹åŠ¡ä¼š&lt;strong&gt;é˜»å¡ç­‰å¾…&lt;/strong&gt;ï¼Œç›´åˆ°å…ˆæŒæœ‰é”çš„äº‹åŠ¡æäº¤æˆ–å›æ»šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ååŒæœºåˆ¶ä¸å·¥ä½œæµç¨‹"&gt;ğŸ¤ &lt;strong&gt;ååŒæœºåˆ¶ä¸å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;MVCC ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œçº§é”ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ååŒæ•ˆæœ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»ï¼ˆSELECTï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ Read View è¯»å–å·²æäº¤ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;æ— é”&lt;/td&gt;
&lt;td&gt;æ— é˜»å¡è¯»å–ï¼Œé¿å…è„è¯»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†™ï¼ˆUPDATEï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆæ–°ç‰ˆæœ¬å†™å…¥ï¼Œæ—§ç‰ˆå­˜ undo log&lt;/td&gt;
&lt;td&gt;åŠ è¡Œçº§æ’ä»–é”ï¼Œé˜»å¡å…¶ä»–å†™æ“ä½œ&lt;/td&gt;
&lt;td&gt;å†™æ“ä½œä¸²è¡ŒåŒ–ï¼Œé¿å…è„å†™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»å†™å¹¶å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»æ“ä½œè®¿é—®å†å²ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;å†™æ“ä½œé”å®šå½“å‰ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è¯»å†™äº’ä¸é˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="å…¸å‹æµç¨‹ç¤ºä¾‹"&gt;&lt;strong&gt;å…¸å‹æµç¨‹ç¤ºä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;-- äº‹åŠ¡ Aï¼ˆæ›´æ–°æ“ä½œï¼‰
BEGIN;
UPDATE users SET balance = 200 WHERE id = 1; -- å¯¹ id=1 åŠ  X é”ï¼Œç”Ÿæˆæ–°ç‰ˆæœ¬ï¼ˆDB_TRX_ID=101ï¼‰
-- äº‹åŠ¡ Bï¼ˆæŸ¥è¯¢æ“ä½œï¼Œä¸äº‹åŠ¡ A å¹¶å‘ï¼‰
BEGIN;
SELECT balance FROM users WHERE id = 1; -- ç”Ÿæˆ Read Viewï¼Œè‹¥äº‹åŠ¡ A æœªæäº¤ï¼Œè¯»å–æ—§ç‰ˆæœ¬ï¼ˆbalance=100ï¼‰
COMMIT;
-- äº‹åŠ¡ A æäº¤
COMMIT;
-- äº‹åŠ¡ Cï¼ˆæ›´æ–°åæŸ¥è¯¢ï¼‰
BEGIN;
SELECT balance FROM users WHERE id = 1; -- æ–° Read View è¯»å–äº‹åŠ¡ A æäº¤åçš„ç‰ˆæœ¬ï¼ˆbalance=200ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é˜²è„è¯»&lt;/strong&gt;ï¼šäº‹åŠ¡ B è¯»å–æ—§ç‰ˆæœ¬ï¼Œé¿å…çœ‹åˆ°äº‹åŠ¡ A æœªæäº¤çš„ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…è®¸ä¸å¯é‡å¤è¯»&lt;/strong&gt;ï¼šäº‹åŠ¡ C çœ‹åˆ°äº‹åŠ¡ A æäº¤åçš„æ–°å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™-å†™ä¸å¹¶å‘&lt;/strong&gt;ï¼šè‹¥äº‹åŠ¡ D åŒæ—¶æ›´æ–° id=1ï¼Œéœ€ç­‰å¾…äº‹åŠ¡ A çš„ X é”é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸ä¸€è‡´æ€§æƒè¡¡"&gt;âš–ï¸ &lt;strong&gt;æ€§èƒ½ä¸ä¸€è‡´æ€§æƒè¡¡&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é™åˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;MVCC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»æ“ä½œæ— é”ï¼Œé«˜å¹¶å‘è¯»åœºæ™¯æ€§èƒ½ä¼˜å¼‚&lt;/td&gt;
&lt;td&gt;ç»´æŠ¤ç‰ˆæœ¬é“¾å¢åŠ å­˜å‚¨å¼€é”€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¡Œçº§é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…å†™å†²çªï¼Œä¿è¯æ•°æ®ä¿®æ”¹åŸå­æ€§&lt;/td&gt;
&lt;td&gt;å†™é¢‘ç¹åœºæ™¯å¯èƒ½å¼•å‘é”ç­‰å¾…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ååŒè®¾è®¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»å†™äº’ä¸é˜»å¡ï¼Œååé‡é«˜&lt;/td&gt;
&lt;td&gt;ä¸è§£å†³å¹»è¯»ï¼ˆRC çº§åˆ«å…è®¸é—´éš™æ’å…¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘ OLTP ç³»ç»Ÿ&lt;/strong&gt;ï¼ˆå¦‚ç”µå•†ã€ç¤¾äº¤å¹³å°ï¼‰ï¼šè¯»å¤šå†™å°‘ï¼ŒRC çº§åˆ«åˆ©ç”¨ MVCC æ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡‘èå¼ºä¸€è‡´åœºæ™¯&lt;/strong&gt;ï¼šè‹¥éœ€é¿å…ä¸å¯é‡å¤è¯»æˆ–å¹»è¯»ï¼Œéœ€å‡çº§è‡³ &lt;strong&gt;å¯é‡å¤è¯»ï¼ˆRRï¼‰&lt;/strong&gt; çº§åˆ«ï¼ˆä½¿ç”¨äº‹åŠ¡çº§å¿«ç…§ + é—´éš™é”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-13"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;InnoDB é€šè¿‡ &lt;strong&gt;MVCC + è¡Œçº§é”&lt;/strong&gt; å®ç°è¯»å·²æäº¤éš”ç¦»çº§åˆ«ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;MVCC&lt;/strong&gt; ä¸ºæ¯æ¬¡æŸ¥è¯¢ç”Ÿæˆç‹¬ç«‹å¿«ç…§ï¼ˆRead Viewï¼‰ï¼Œç¡®ä¿&lt;strong&gt;ä»…è¯»å–å·²æäº¤æ•°æ®&lt;/strong&gt;ï¼Œé¿å…è„è¯»ï¼Œä½†å…è®¸ä¸å¯é‡å¤è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡Œçº§é”&lt;/strong&gt; åœ¨å†™æ“ä½œæ—¶åŠ æ’ä»–é”ï¼ˆX Lockï¼‰ï¼Œ&lt;strong&gt;é˜»å¡å…¶ä»–å¹¶å‘å†™æ“ä½œ&lt;/strong&gt;ï¼Œä½†è¯»æ“ä½œé€šè¿‡ MVCC æ— é”è®¿é—®å†å²ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ååŒä¼˜åŠ¿&lt;/strong&gt;ï¼šè¯»å†™æ“ä½œäº’ä¸é˜»å¡ï¼Œå…¼é¡¾ä¸€è‡´æ€§ä¸é«˜å¹¶å‘ï¼Œæˆä¸ºå¤šæ•° OLTP ç³»ç»Ÿçš„é»˜è®¤é€‰æ‹©ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šRC çº§åˆ«å› ç¦ç”¨é—´éš™é”è€Œå…è®¸å¹»è¯»ï¼Œéœ€æ ¹æ®ä¸šåŠ¡éœ€æ±‚æƒè¡¡éš”ç¦»çº§åˆ«é€‰æ‹©ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¯é‡å¤è¯»"&gt;å¯é‡å¤è¯»
&lt;/h2&gt;&lt;p&gt;åœ¨ MySQL InnoDB çš„å¯é‡å¤è¯»ï¼ˆRepeatable Read, RRï¼‰éš”ç¦»çº§åˆ«ä¸­ï¼Œ&lt;strong&gt;MVCCã€è¡Œé”å’Œé—´éš™é”é€šè¿‡ååŒåˆ†å·¥&lt;/strong&gt;ï¼Œå…±åŒå®ç°äº†æ•°æ®ä¸€è‡´æ€§ã€é¿å…ä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„ç›®æ ‡ã€‚ä»¥ä¸‹æ˜¯ä¸‰è€…ååŒå·¥ä½œçš„æ ¸å¿ƒæœºåˆ¶ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰å¤§ç»„ä»¶çš„åˆ†å·¥ä¸åä½œ"&gt;ğŸ”§ &lt;strong&gt;ä¸‰å¤§ç»„ä»¶çš„åˆ†å·¥ä¸åä½œ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;MVCC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æä¾›äº‹åŠ¡çº§ä¸€è‡´æ€§è§†å›¾&lt;/strong&gt;ï¼šç¡®ä¿äº‹åŠ¡å†…å¤šæ¬¡è¯»å–çš„æ•°æ®ç‰ˆæœ¬ä¸€è‡´ï¼Œé¿å…ä¸å¯é‡å¤è¯»ã€‚&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡å¼€å§‹æ—¶åˆ›å»º &lt;code&gt;Read View&lt;/code&gt;ï¼ˆè®°å½•æ´»è·ƒäº‹åŠ¡ ID åˆ—è¡¨ï¼‰ï¼ŒåŸºäº &lt;code&gt;DB_TRX_ID&lt;/code&gt; å’Œ &lt;code&gt;DB_ROLL_PTR&lt;/code&gt; è¯»å–å†å²ç‰ˆæœ¬ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¡Œé”ï¼ˆRecord Lockï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¿è¯å†™æ“ä½œçš„åŸå­æ€§&lt;/strong&gt;ï¼šé˜²æ­¢å¹¶å‘äº‹åŠ¡ä¿®æ”¹åŒä¸€è¡Œæ•°æ®ï¼Œé¿å…è„å†™å’Œä¸¢å¤±æ›´æ–°ã€‚&lt;/td&gt;
&lt;td&gt;å¯¹å½“å‰æ•°æ®è¡ŒåŠ æ’ä»–é”ï¼ˆX Lockï¼‰ï¼Œé˜»å¡å…¶ä»–äº‹åŠ¡çš„å¹¶å‘å†™æ“ä½œï¼ˆå¦‚ &lt;code&gt;UPDATE&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é—´éš™é”ï¼ˆGap Lockï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é˜²æ­¢å¹»è¯»&lt;/strong&gt;ï¼šé”å®šç´¢å¼•è®°å½•ä¹‹é—´çš„â€œé—´éš™â€ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡æ’å…¥æ–°æ•°æ®å½±å“èŒƒå›´æŸ¥è¯¢ç»“æœã€‚&lt;/td&gt;
&lt;td&gt;å¯¹ä¸å­˜åœ¨æ•°æ®çš„åŒºé—´ï¼ˆå¦‚ &lt;code&gt;(5, 10)&lt;/code&gt;ï¼‰åŠ é”ï¼Œé˜»å¡æ’å…¥æ“ä½œï¼ˆå¦‚ &lt;code&gt;INSERT id=7&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš™ï¸ &lt;strong&gt;ååŒé€»è¾‘&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯»æ“ä½œ&lt;/strong&gt;ï¼šé€šè¿‡ MVCC è¯»å–å¿«ç…§æ•°æ®ï¼ˆæ— é”ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™æ“ä½œ&lt;/strong&gt;ï¼šè¡Œé”ä¿æŠ¤å½“å‰æ•°æ®è¡Œï¼ˆé˜²å¹¶å‘å†™ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŒƒå›´æ“ä½œ&lt;/strong&gt;ï¼šé—´éš™é”é”å®šåŒºé—´ï¼ˆé˜²æ’å…¥æ–°æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å…·ä½“å®ç°æµç¨‹ä»¥ç¤ºä¾‹è¯´æ˜"&gt;ğŸ“Š &lt;strong&gt;å…·ä½“å®ç°æµç¨‹ï¼ˆä»¥ç¤ºä¾‹è¯´æ˜ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åœºæ™¯æè¿°"&gt;&lt;strong&gt;åœºæ™¯æè¿°&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;äº‹åŠ¡ A æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢ï¼ˆ&lt;code&gt;SELECT ... WHERE id BETWEEN 10 AND 20&lt;/code&gt;ï¼‰ï¼Œäº‹åŠ¡ B å°è¯•æ’å…¥ &lt;code&gt;id=15&lt;/code&gt; çš„æ–°è®°å½•ã€‚&lt;/p&gt;
&lt;h4 id="ååŒå·¥ä½œæµç¨‹"&gt;&lt;strong&gt;ååŒå·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ A å¯åŠ¨&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åˆ›å»º &lt;code&gt;Read View&lt;/code&gt;ï¼Œè®°å½•å½“å‰æ´»è·ƒäº‹åŠ¡ ID åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œ SELECTï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MVCC ç”Ÿæ•ˆ&lt;/strong&gt;ï¼šè¯»å– &lt;code&gt;id=10~20&lt;/code&gt; èŒƒå›´å†…å·²æäº¤çš„æ•°æ®ç‰ˆæœ¬ï¼ˆåŸºäºäº‹åŠ¡å¼€å§‹æ—¶çš„å¿«ç…§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é—´éš™é”ç”Ÿæ•ˆ&lt;/strong&gt;ï¼šå¯¹ç´¢å¼•åŒºé—´ &lt;code&gt;(10, 20)&lt;/code&gt; åŠ é”ï¼ˆè‹¥åŒºé—´å†…æœ‰ç©ºæ´ï¼Œå¦‚ &lt;code&gt;id=15&lt;/code&gt; ä¸å­˜åœ¨ï¼Œåˆ™é”å®š &lt;code&gt;(10, 20)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ B æ’å…¥æ•°æ®&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å°è¯•æ’å…¥ &lt;code&gt;id=15&lt;/code&gt;ï¼ˆä½äºäº‹åŠ¡ A é”å®šçš„é—´éš™å†…ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é—´éš™é”é˜»å¡&lt;/strong&gt;ï¼šäº‹åŠ¡ B è¢«é˜»å¡ï¼Œç›´åˆ°äº‹åŠ¡ A æäº¤æˆ–è¶…æ—¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ A å†æ¬¡æŸ¥è¯¢&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MVCC ä¿æŒä¸€è‡´æ€§&lt;/strong&gt;ï¼šä»è¯»å–äº‹åŠ¡å¼€å§‹æ—¶çš„å¿«ç…§æ•°æ®ï¼ˆå³ä½¿äº‹åŠ¡ B å·²æäº¤ï¼Œæ–°æ•°æ®å› ç‰ˆæœ¬å·æ›´é«˜ä¸å¯è§ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é—´éš™é”ä¿æŒç»“æœç¨³å®š&lt;/strong&gt;ï¼šæ— æ–°æ•°æ®æ’å…¥ï¼Œé¿å…å¹»è¯»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼šäº‹åŠ¡ A ä¸¤æ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´ï¼Œä¸”æ— å¹»è¯»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®åœºæ™¯ä¸‹çš„ååŒè§„åˆ™"&gt;âš ï¸ &lt;strong&gt;å…³é”®åœºæ™¯ä¸‹çš„ååŒè§„åˆ™&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;MVCC ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œé”ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é—´éš™é”ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœ€ç»ˆæ•ˆæœ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ™®é€š SELECT&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»å–å¿«ç…§ç‰ˆæœ¬ï¼ˆæ— é”ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸åŠ é”&lt;/td&gt;
&lt;td&gt;ä¸åŠ é”&lt;/td&gt;
&lt;td&gt;æ— é˜»å¡ï¼Œç»“æœä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢ï¼ˆWHERE id&amp;gt;10ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»å–å¿«ç…§ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;ä¸åŠ é”&lt;/td&gt;
&lt;td&gt;é”å®šåŒºé—´ï¼ˆå¦‚ &lt;code&gt;(10, +âˆ)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é˜²å¹»è¯»&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;UPDATE æŸè¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆæ–°ç‰ˆæœ¬ï¼ˆå†™å…¥ undo logï¼‰&lt;/td&gt;
&lt;td&gt;åŠ è¡Œçº§æ’ä»–é”ï¼ˆé˜»å¡å¹¶å‘å†™ï¼‰&lt;/td&gt;
&lt;td&gt;è‹¥æ¶‰åŠèŒƒå›´ï¼ŒåŠ é—´éš™é”&lt;/td&gt;
&lt;td&gt;é˜²è„å†™ + é˜²å¹»è¯»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;INSERT æ–°æ•°æ®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆæ–°ç‰ˆæœ¬ï¼ˆç‰ˆæœ¬å·é«˜äºæ—§äº‹åŠ¡ï¼‰&lt;/td&gt;
&lt;td&gt;æ— è¡Œé”ï¼ˆæ–°è¡Œæ— å†å²è®°å½•ï¼‰&lt;/td&gt;
&lt;td&gt;è‹¥ç›®æ ‡é—´éš™è¢«é”ï¼Œé˜»å¡æ’å…¥&lt;/td&gt;
&lt;td&gt;å—é—´éš™é”çº¦æŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸ä¸€è‡´æ€§çš„æƒè¡¡"&gt;âš–ï¸ &lt;strong&gt;æ€§èƒ½ä¸ä¸€è‡´æ€§çš„æƒè¡¡&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä»£ä»·&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;MVCC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»æ“ä½œæ— é”ï¼Œé«˜å¹¶å‘è¯»åœºæ™¯æ€§èƒ½ä¼˜å¼‚&lt;/td&gt;
&lt;td&gt;ç»´æŠ¤ç‰ˆæœ¬é“¾å¢åŠ å­˜å‚¨å¼€é”€ï¼Œé•¿äº‹åŠ¡å¯¼è‡´ undo log è†¨èƒ€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¡Œé”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…å†™å†²çªï¼Œä¿è¯æ•°æ®åŸå­æ€§&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘å†™åœºæ™¯å¯èƒ½é˜»å¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é—´éš™é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸¥æ ¼é˜²æ­¢å¹»è¯»&lt;/td&gt;
&lt;td&gt;é”èŒƒå›´è¿‡å¤§æ—¶é˜»å¡æ’å…¥ï¼Œå¯èƒ½å¼•å‘æ­»é”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ä¼˜åŒ–å»ºè®®"&gt;&lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å…¨è¡¨æ‰«æ&lt;/strong&gt;ï¼šèŒƒå›´æŸ¥è¯¢å°½é‡ä½¿ç”¨ç´¢å¼•ï¼Œç¼©å°é—´éš™é”èŒƒå›´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶äº‹åŠ¡é•¿åº¦&lt;/strong&gt;ï¼šå‡å°‘é•¿äº‹åŠ¡ï¼Œé¿å… &lt;code&gt;Read View&lt;/code&gt; å’Œé—´éš™é”é•¿æœŸæŒæœ‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•è®¾è®¡&lt;/strong&gt;ï¼šå”¯ä¸€ç´¢å¼•å¯å‡å°‘é—´éš™é”ä½¿ç”¨ï¼ˆç­‰å€¼æŸ¥è¯¢æ—¶é€€åŒ–ä¸ºè¡Œé”ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-14"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;InnoDB é€šè¿‡ &lt;strong&gt;MVCC + è¡Œé” + é—´éš™é”&lt;/strong&gt; å®ç°å¯é‡å¤è¯»ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;MVCC&lt;/strong&gt; æä¾›äº‹åŠ¡çº§å¿«ç…§ï¼ˆ&lt;code&gt;Read View&lt;/code&gt;ï¼‰ï¼Œ&lt;strong&gt;è§£å†³ä¸å¯é‡å¤è¯»&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡Œé”&lt;/strong&gt; ç¡®ä¿å†™æ“ä½œçš„åŸå­æ€§ï¼Œ&lt;strong&gt;é¿å…è„å†™&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é—´éš™é”&lt;/strong&gt; é”å®šç´¢å¼•åŒºé—´ï¼Œ&lt;strong&gt;å½»åº•é˜²æ­¢å¹»è¯»&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šé—´éš™é”æ˜¯ RR çº§åˆ«é˜²å¹»è¯»çš„æ ¸å¿ƒï¼Œä½†ä¹Ÿå¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚è‹¥ä¸šåŠ¡æ— éœ€ä¸¥æ ¼é˜²å¹»è¯»ï¼Œå¯é™çº§è‡³ &lt;strong&gt;è¯»å·²æäº¤ï¼ˆRCï¼‰&lt;/strong&gt; çº§åˆ«ï¼ˆç¦ç”¨é—´éš™é”ï¼‰ä»¥æå‡å¹¶å‘æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ä¸å¯é‡å¤è¯»"&gt;ä¸å¯é‡å¤è¯»
&lt;/h2&gt;&lt;p&gt;åœ¨MySQLçš„InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œ&lt;strong&gt;RCï¼ˆRead Committedï¼‰éš”ç¦»çº§åˆ«ä¸‹æ— æ³•è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œæ ¸å¿ƒåŸå› åœ¨äºMVCCæœºåˆ¶ä¸­Read Viewçš„ç”Ÿæˆç­–ç•¥&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-rcéš”ç¦»çº§åˆ«ä¸‹read-viewçš„ç”Ÿæˆæœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;RCéš”ç¦»çº§åˆ«ä¸‹Read Viewçš„ç”Ÿæˆæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åœ¨RCçº§åˆ«ä¸‹ï¼Œ&lt;strong&gt;æ¯æ¬¡æ‰§è¡Œå¿«ç…§è¯»ï¼ˆå¦‚æ™®é€šSELECTï¼‰æ—¶éƒ½ä¼šç”Ÿæˆæ–°çš„Read View&lt;/strong&gt;ã€‚Read Viewæ˜¯MVCCåˆ¤æ–­æ•°æ®å¯è§æ€§çš„å…³é”®ç»“æ„ï¼ŒåŒ…å«ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;m_ids&lt;/code&gt;ï¼šå½“å‰æ´»è·ƒäº‹åŠ¡IDé›†åˆï¼ˆæœªæäº¤äº‹åŠ¡ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;min_trx_id&lt;/code&gt;ï¼šæœ€å°æ´»è·ƒäº‹åŠ¡ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;max_trx_id&lt;/code&gt;ï¼šä¸‹ä¸€ä¸ªå¾…åˆ†é…äº‹åŠ¡ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;creator_trx_id&lt;/code&gt;ï¼šåˆ›å»ºRead Viewçš„äº‹åŠ¡ID
æ¯æ¬¡ç”ŸæˆRead Viewæ—¶ï¼Œè¿™äº›å€¼ä¼š&lt;strong&gt;åŠ¨æ€æ›´æ–°&lt;/strong&gt;ä»¥åæ˜ æœ€æ–°çš„æ•°æ®åº“çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å¯é‡å¤è¯»çš„äº§ç”Ÿè¿‡ç¨‹"&gt;ğŸ”„ &lt;strong&gt;ä¸å¯é‡å¤è¯»çš„äº§ç”Ÿè¿‡ç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é€šè¿‡å…¸å‹åœºæ™¯è¯´æ˜ï¼ˆå‡è®¾äº‹åŠ¡Aæ‰§è¡Œä¸¤æ¬¡æŸ¥è¯¢ï¼Œäº‹åŠ¡Båœ¨ä¸­é—´ä¿®æ”¹æ•°æ®ï¼‰ï¼š
1.
äº‹åŠ¡Aç¬¬ä¸€æ¬¡æŸ¥è¯¢&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”ŸæˆRead View1ï¼Œè®°å½•æ­¤æ—¶æ´»è·ƒäº‹åŠ¡ï¼ˆå¦‚äº‹åŠ¡Bæœªæäº¤ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;è‹¥äº‹åŠ¡Bä¿®æ”¹äº†æŸè¡Œä½†æœªæäº¤ï¼Œè¯¥è¡Œ&lt;code&gt;DB_TRX_ID&lt;/code&gt;åœ¨æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ä¸­ï¼Œäº‹åŠ¡Aé€šè¿‡ç‰ˆæœ¬é“¾è¯»å–&lt;strong&gt;ä¿®æ”¹å‰çš„æ—§ç‰ˆæœ¬&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;äº‹åŠ¡Bæäº¤ä¿®æ”¹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡Bæäº¤åï¼Œå…¶äº‹åŠ¡IDä»æ´»è·ƒåˆ—è¡¨ä¸­ç§»é™¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;äº‹åŠ¡Aç¬¬äºŒæ¬¡æŸ¥è¯¢&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿæˆæ–°çš„Read View2ï¼Œäº‹åŠ¡Bå·²æäº¤ï¼ˆä¸åœ¨æ´»è·ƒåˆ—è¡¨ä¸­ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡Aç›´æ¥è¯»å–&lt;strong&gt;äº‹åŠ¡Bæäº¤åçš„æ–°ç‰ˆæœ¬æ•°æ®&lt;/strong&gt;ï¼Œå¯¼è‡´ä¸¤æ¬¡æŸ¥è¯¢ç»“æœä¸ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š
RCçº§åˆ«ä¸‹æ¯æ¬¡æŸ¥è¯¢éƒ½åŸºäº&lt;strong&gt;æœ€æ–°çš„æäº¤çŠ¶æ€&lt;/strong&gt;ç”ŸæˆRead Viewï¼Œå› æ­¤èƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡çš„æ–°æäº¤ï¼Œä½†ç ´åäº†åŒä¸€äº‹åŠ¡å†…çš„ç»“æœä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸rréš”ç¦»çº§åˆ«çš„å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ä¸RRéš”ç¦»çº§åˆ«çš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RCï¼ˆè¯»å·²æäº¤ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RRï¼ˆå¯é‡å¤è¯»ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Read Viewç”Ÿæˆæ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯æ¬¡SELECTéƒ½ç”Ÿæˆæ–°Read View&lt;/td&gt;
&lt;td&gt;ä»…äº‹åŠ¡ç¬¬ä¸€æ¬¡SELECTæ—¶ç”Ÿæˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å¯è§æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ€»æ˜¯è¯»å–æœ€æ–°å·²æäº¤æ•°æ®&lt;/td&gt;
&lt;td&gt;å›ºå®šè¯»å–äº‹åŠ¡å¼€å§‹æ—¶çš„æ•°æ®å¿«ç…§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸å¯é‡å¤è¯»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½å‘ç”Ÿï¼ˆå› Read Viewæ›´æ–°ï¼‰&lt;/td&gt;
&lt;td&gt;é¿å…ï¼ˆå› Read Viewå¤ç”¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹»è¯»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½å‘ç”Ÿï¼ˆæ— é—´éš™é”ï¼‰&lt;/td&gt;
&lt;td&gt;é€šè¿‡é—´éš™é”+MVCCé¿å…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;ç¤ºä¾‹éªŒè¯&lt;/strong&gt;ï¼ˆæ¥è‡ªï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡AæŸ¥è¯¢ä½™é¢ä¸º100ï¼ˆRead View1ä¸­äº‹åŠ¡Bæœªæäº¤ï¼Œè¯»å–æ—§ç‰ˆæœ¬ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡Bæäº¤æ›´æ–°ä½™é¢ä¸º150ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡Aå†æ¬¡æŸ¥è¯¢ä½™é¢å˜ä¸º150ï¼ˆRead View2ä¸­äº‹åŠ¡Bå·²æäº¤ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-rcçº§åˆ«ä¸ºä½•ä¸è§£å†³ä¸å¯é‡å¤è¯»è®¾è®¡æƒè¡¡"&gt;âš ï¸ &lt;strong&gt;RCçº§åˆ«ä¸ºä½•ä¸è§£å†³ä¸å¯é‡å¤è¯»ï¼Ÿè®¾è®¡æƒè¡¡&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;RCçº§åˆ«çš„è®¾è®¡ç›®æ ‡æ˜¯&lt;strong&gt;ä¼˜å…ˆä¿è¯æ•°æ®å®æ—¶æ€§è€Œéä¸€è‡´æ€§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶æ€§éœ€æ±‚åœºæ™¯&lt;/strong&gt;ï¼šå¦‚ç¤¾äº¤åŠ¨æ€æµï¼Œç”¨æˆ·å¸Œæœ›ç«‹å³çœ‹åˆ°ä»–äººå‘å¸ƒçš„æ–°å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼šé¿å…é•¿äº‹åŠ¡æŒæœ‰æ—§Read Viewï¼Œå‡å°‘Undo Logå†å²ç‰ˆæœ¬ç»´æŠ¤å‹åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”æœºåˆ¶ç®€åŒ–&lt;/strong&gt;ï¼šRCçº§åˆ«ç¦ç”¨é—´éš™é”ï¼Œå‡å°‘æ­»é”æ¦‚ç‡ï¼Œæå‡å¹¶å‘å†™å…¥æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-15"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¹æœ¬åŸå› &lt;/strong&gt;ï¼šRCçº§åˆ«ä¸‹MVCCä¸ºæ¯æ¬¡æŸ¥è¯¢ç”Ÿæˆæ–°Read Viewï¼Œå¯¼è‡´åŒä¸€äº‹åŠ¡å†…å¤šæ¬¡è¯»å–å¯èƒ½çœ‹åˆ°å…¶ä»–äº‹åŠ¡æäº¤çš„æ–°ç‰ˆæœ¬æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨çŸ›ç›¾&lt;/strong&gt;ï¼šæ˜¯æ•°æ®åº“åœ¨&lt;strong&gt;å®æ—¶æ€§&lt;/strong&gt;ä¸&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;ä¹‹é—´çš„è®¾è®¡æƒè¡¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè‹¥ä¸šåŠ¡å®¹å¿ä¸å¯é‡å¤è¯»ï¼ˆå¦‚å®æ—¶æ•°æ®å±•ç¤ºï¼‰ï¼ŒRCçº§åˆ«æ˜¯é«˜æ€§èƒ½é€‰æ‹©ï¼›è‹¥éœ€å¼ºä¸€è‡´æ€§ï¼ˆå¦‚å¯¹è´¦ç³»ç»Ÿï¼‰ï¼Œåº”ä½¿ç”¨RRçº§åˆ«ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡å‘½ä»¤ &lt;code&gt;SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;&lt;/code&gt; å¯åˆ‡æ¢è‡³RCçº§åˆ«ï¼Œéœ€æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°¨æ…é€‰æ‹©ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="read-review-å¼€é”€"&gt;READ REVIEW å¼€é”€
&lt;/h2&gt;&lt;p&gt;åœ¨MySQL InnoDBä¸­ï¼Œæ¯æ¬¡é‡æ–°ç”ŸæˆRead Viewçš„æ€§èƒ½å¼€é”€éœ€è¦ç»“åˆå…¶å®ç°æœºåˆ¶å’Œåœºæ™¯ç»¼åˆè¯„ä¼°ã€‚ä»¥ä¸‹æ˜¯å…³é”®åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-read-viewç”Ÿæˆçš„æ ¸å¿ƒå¼€é”€æ¥æº"&gt;âš™ï¸ &lt;strong&gt;Read Viewç”Ÿæˆçš„æ ¸å¿ƒå¼€é”€æ¥æº&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€äº‹åŠ¡é”ç«äº‰ï¼ˆtrx_sys-&amp;gt;mutexï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”ŸæˆRead Viewéœ€&lt;strong&gt;æŒæœ‰å…¨å±€äº‹åŠ¡ç³»ç»Ÿé”ï¼ˆtrx_sys-&amp;gt;mutexï¼‰&lt;/strong&gt;ï¼Œä»¥æ‹·è´å½“å‰æ´»è·ƒäº‹åŠ¡IDåˆ—è¡¨ï¼ˆ&lt;code&gt;m_ids&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘åœºæ™¯ä¸‹&lt;/strong&gt;ï¼Œé¢‘ç¹è·å–è¯¥é”å¯èƒ½å¼•å‘ç«äº‰ï¼Œæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚ä¾‹å¦‚256å¹¶å‘æ—¶ï¼Œé”ç«äº‰å¯¼è‡´çš„å»¶è¿Ÿæ˜¾è‘—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ´»è·ƒäº‹åŠ¡åˆ—è¡¨æ‹·è´ï¼ˆm_idsï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;éœ€&lt;strong&gt;æ‹·è´å½“å‰æ‰€æœ‰æ´»è·ƒè¯»å†™äº‹åŠ¡ID&lt;/strong&gt;åˆ°&lt;code&gt;m_ids&lt;/code&gt;æ•°ç»„ï¼Œè‹¥æ´»è·ƒäº‹åŠ¡æ•°å¤šï¼ˆå¦‚&amp;gt;1000ï¼‰ï¼Œå†…å­˜åˆ†é…ä¸æ‹·è´å¼€é”€å¢å¤§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬é“¾éå†æˆæœ¬&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥æ•°æ®è¢«é¢‘ç¹æ›´æ–°ï¼Œ&lt;strong&gt;undo logç‰ˆæœ¬é“¾è¾ƒé•¿&lt;/strong&gt;ï¼Œéœ€å›æº¯æ›´å¤šç‰ˆæœ¬æ‰èƒ½æ‰¾åˆ°å¯è§æ•°æ®ï¼Œå¢åŠ CPUå¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸åŒéš”ç¦»çº§åˆ«çš„å¼€é”€å¯¹æ¯”"&gt;ğŸ”„ &lt;strong&gt;ä¸åŒéš”ç¦»çº§åˆ«çš„å¼€é”€å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;éš”ç¦»çº§åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Read Viewç”Ÿæˆé¢‘ç‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RCï¼ˆè¯»å·²æäº¤ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ¯æ¬¡å¿«ç…§è¯»ï¼ˆSELECTï¼‰éƒ½ç”Ÿæˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼€é”€æœ€å¤§ï¼šé«˜é¢‘ç”Ÿæˆæ˜“å¼•å‘é”ç«äº‰ï¼Œä½†å•æ¬¡ç”Ÿæˆè½»é‡ï¼ˆä»…æ‹·è´å½“å‰æ´»è·ƒäº‹åŠ¡ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RRï¼ˆå¯é‡å¤è¯»ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡é¦–æ¬¡å¿«ç…§è¯»æ—¶ç”Ÿæˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼€é”€è¾ƒå°ï¼šæ•´ä¸ªäº‹åŠ¡å¤ç”¨åŒä¸€Read Viewï¼Œé¿å…é‡å¤ç”Ÿæˆã€‚ä½†é•¿äº‹åŠ¡å¯èƒ½ä¿ç•™æ—§è§†å›¾ï¼Œå¢åŠ Purgeå‹åŠ›ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;å…³é”®æ•°æ®&lt;/strong&gt;ï¼šåœ¨256å¹¶å‘è¯»å†™æ··åˆæµ‹è¯•ä¸­ï¼ŒRRçš„QPSæ¯”RCé«˜å‡º10%+ï¼Œä¸»å› æ­£æ˜¯&lt;strong&gt;å‡å°‘Read Viewç”Ÿæˆæ¬¡æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åœºæ™¯æ€§èƒ½å½±å“"&gt;âš¡ &lt;strong&gt;å®é™…åœºæ™¯æ€§èƒ½å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘å†™å…¥åœºæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;RCçº§åˆ«é¢‘ç¹ç”ŸæˆRead Viewæ—¶ï¼Œ&lt;strong&gt;trx_sys-&amp;gt;mutexç«äº‰åŠ å‰§&lt;/strong&gt;ï¼Œå¯èƒ½å¯¼è‡´ååé‡éª¤é™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;ï¼šè‹¥ä¸šåŠ¡å®¹å¿ä¸å¯é‡å¤è¯»ï¼Œå¯æ”¹ç”¨RRçº§åˆ«å‡å°‘ç”Ÿæˆæ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿äº‹åŠ¡åœºæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;RRçº§åˆ«è™½å‡å°‘Read Viewç”Ÿæˆï¼Œä½†&lt;strong&gt;é•¿äº‹åŠ¡æŒæœ‰çš„æ—§Read Viewä¼šé˜»æ­¢Purgeçº¿ç¨‹æ¸…ç†æ—§ç‰ˆæœ¬&lt;/strong&gt;ï¼Œå¯¼è‡´undo logå †ç§¯ï¼Œæœ€ç»ˆå½±å“å†™å…¥æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åªè¯»äº‹åŠ¡ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;MySQL 5.7+ å¯¹åªè¯»äº‹åŠ¡&lt;strong&gt;ç¼“å­˜Read View&lt;/strong&gt;ï¼šè‹¥ç³»ç»Ÿæ— æ–°è¯»å†™äº‹åŠ¡ï¼Œå¯å¤ç”¨ç¼“å­˜ï¼Œé¿å…é‡å¤ç”Ÿæˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–ç­–ç•¥"&gt;ğŸ› ï¸ &lt;strong&gt;ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»çº§åˆ«é€‰æ‹©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆç”¨&lt;strong&gt;RRçº§åˆ«&lt;/strong&gt;ï¼Œå‡å°‘Read Viewç”Ÿæˆæ¬¡æ•°ï¼ˆå°¤å…¶å¹¶å‘è¯»å¤šçš„åœºæ™¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥éœ€å®æ—¶æ€§ï¼ˆå¦‚ç›‘æ§å¤§å±ï¼‰ï¼Œæ”¹ç”¨RCä½†éœ€è¯„ä¼°é”ç«äº‰ä»£ä»·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶äº‹åŠ¡ç²’åº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é•¿äº‹åŠ¡&lt;/strong&gt;ï¼šRRçº§åˆ«ä¸‹ï¼Œé•¿äº‹åŠ¡é˜»ç¢Purgeæ“ä½œï¼Œå®šæœŸæ£€æŸ¥&lt;code&gt;information_schema.innodb_trx&lt;/code&gt;å¤„ç†é˜»å¡äº‹åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‹†åˆ†å¤§äº‹åŠ¡&lt;/strong&gt;ï¼šå°†å¤§æŸ¥è¯¢æ‹†ä¸ºçŸ­äº‹åŠ¡ï¼Œé™ä½å•æ¬¡Read ViewæŒæœ‰æ—¶é—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ä¸æŸ¥è¯¢ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘ç‰ˆæœ¬é“¾å›æº¯&lt;/strong&gt;ï¼šå¯¹é¢‘ç¹æ›´æ–°çš„è¡¨ï¼Œç¡®ä¿æŸ¥è¯¢ä½¿ç”¨ç´¢å¼•ï¼ŒåŠ é€Ÿå¯è§ç‰ˆæœ¬å®šä½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å…¨è¡¨æ‰«æ&lt;/strong&gt;ï¼šå…¨è¡¨æ‰«æå¯èƒ½è§¦å‘æ›´å¤šä¸å¯è§æ•°æ®çš„ç‰ˆæœ¬é“¾éå†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-16"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼€é”€æ¥æº&lt;/strong&gt;ï¼šRead Viewç”Ÿæˆçš„ä¸»è¦å¼€é”€æ˜¯&lt;strong&gt;å…¨å±€é”ç«äº‰&lt;/strong&gt;å’Œ&lt;strong&gt;æ´»è·ƒäº‹åŠ¡åˆ—è¡¨æ‹·è´&lt;/strong&gt;ï¼Œé«˜å¹¶å‘æ—¶å¯èƒ½æˆä¸ºç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;åœºæ™¯å·®å¼‚ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RCçº§åˆ«&lt;/strong&gt;ï¼šé«˜é¢‘ç”Ÿæˆå¼€é”€å¤§ï¼Œé€‚åˆçŸ­äº‹åŠ¡ã€å®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RRçº§åˆ«&lt;/strong&gt;ï¼šå•æ¬¡ç”Ÿæˆå¼€é”€å°ï¼Œé€‚åˆè¯»å¤šå†™å°‘ã€éœ€ä¸€è‡´æ€§çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ ¸å¿ƒ&lt;/strong&gt;ï¼š&lt;strong&gt;å‡å°‘ç”Ÿæˆæ¬¡æ•°&lt;/strong&gt;ï¼ˆRRä¼˜å…ˆï¼‰ã€&lt;strong&gt;é¿å…é•¿äº‹åŠ¡&lt;/strong&gt;ã€&lt;strong&gt;ä¼˜åŒ–æŸ¥è¯¢ä¸ç´¢å¼•&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡å‘½ä»¤ &lt;code&gt;SHOW ENGINE INNODB STATUS&lt;/code&gt; å¯è§‚å¯Ÿäº‹åŠ¡é”ç«äº‰æƒ…å†µï¼ˆå¦‚&lt;code&gt;trx_sys-&amp;gt;mutex&lt;/code&gt;ç­‰å¾…æ—¶é—´ï¼‰ï¼Œè¾…åŠ©æ€§èƒ½è°ƒä¼˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="é¡µå†…éƒ¨ç£ç›˜ç¢ç‰‡æ¸…ç†"&gt;é¡µå†…éƒ¨ç£ç›˜ç¢ç‰‡æ¸…ç†
&lt;/h2&gt;&lt;p&gt;InnoDB å­˜å‚¨å¼•æ“åœ¨æ‰§è¡Œæ•°æ®åˆ é™¤æ“ä½œæ—¶ï¼Œä»…ä¼šæ ‡è®°è®°å½•çš„ &lt;code&gt;delete_flag&lt;/code&gt;ï¼ˆå³é€»è¾‘åˆ é™¤ï¼‰ï¼Œè€Œç‰©ç†ç©ºé—´çš„å›æ”¶å’Œç¢ç‰‡çš„æ¸…ç†åˆ™ä¾èµ–åå°æœºåˆ¶å’Œç‰¹å®šæ“ä½œã€‚ä»¥ä¸‹æ˜¯ç¢ç‰‡æ¸…ç†çš„è§¦å‘æ—¶æœºå’Œå®ç°æ–¹å¼ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚æ­¥æ¸…ç†æœºåˆ¶purge-çº¿ç¨‹"&gt;âš™ï¸ &lt;strong&gt;å¼‚æ­¥æ¸…ç†æœºåˆ¶ï¼šPurge çº¿ç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="purge-çº¿ç¨‹çš„ä½œç”¨"&gt;&lt;strong&gt;Purge çº¿ç¨‹çš„ä½œç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†åˆ é™¤&lt;/strong&gt;ï¼šPurge çº¿ç¨‹è´Ÿè´£æ¸…ç†è¢«æ ‡è®°ä¸ºåˆ é™¤ï¼ˆ&lt;code&gt;delete_flag=1&lt;/code&gt;ï¼‰çš„è®°å½•ï¼Œå¹¶å›æ”¶å…¶å ç”¨çš„ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…ç†æ¡ä»¶&lt;/strong&gt;ï¼šå½“è¢«åˆ é™¤çš„è®°å½•&lt;strong&gt;ä¸å†è¢«ä»»ä½•æ´»è·ƒäº‹åŠ¡å¼•ç”¨&lt;/strong&gt;æ—¶ï¼ˆå³æ—  Read View ä¾èµ–ï¼‰ï¼ŒPurge çº¿ç¨‹æ‰ä¼šå°†å…¶ç‰©ç†åˆ é™¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è§¦å‘æœºåˆ¶"&gt;&lt;strong&gt;è§¦å‘æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‘¨æœŸæ€§è¿è¡Œ&lt;/strong&gt;ï¼šPurge çº¿ç¨‹é»˜è®¤æ¯ç§’è¿è¡Œä¸€æ¬¡ï¼Œé€šè¿‡å‚æ•° &lt;code&gt;innodb_purge_threads&lt;/code&gt; å¯é…ç½®çº¿ç¨‹æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;ç©ºé—´å‹åŠ›è§¦å‘ï¼š
&lt;ul&gt;
&lt;li&gt;å½“è„é¡µæ¯”ä¾‹è¶…è¿‡ &lt;code&gt;innodb_max_dirty_pages_pct&lt;/code&gt; æ—¶ï¼Œä¼šè§¦å‘å¼ºåˆ¶åˆ·è„é¡µï¼Œé—´æ¥åŠ é€Ÿ Purgeã€‚&lt;/li&gt;
&lt;li&gt;Undo Log ç©ºé—´ä¸è¶³æ—¶ï¼Œç³»ç»Ÿä¼šä¼˜å…ˆæ¸…ç†æ—§çš„ Undo æ—¥å¿—ï¼Œé‡Šæ”¾ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é™åˆ¶"&gt;&lt;strong&gt;é™åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é•¿äº‹åŠ¡é˜»å¡&lt;/strong&gt;ï¼šè‹¥å­˜åœ¨é•¿äº‹åŠ¡ï¼ˆå¦‚æœªæäº¤çš„äº‹åŠ¡ï¼‰ï¼Œå…¶ Read View ä¼šé˜»æ­¢ Purge çº¿ç¨‹æ¸…ç†ç›¸å…³è®°å½•ï¼Œå¯¼è‡´ç¢ç‰‡å †ç§¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äºŒçº§ç´¢å¼•æ¸…ç†æ»å&lt;/strong&gt;ï¼šPurge ä»…å¤„ç†ä¸»é”®ç´¢å¼•ï¼ŒäºŒçº§ç´¢å¼•çš„æ¸…ç†éœ€é€šè¿‡åç»­æ“ä½œï¼ˆå¦‚ç´¢å¼•é‡å»ºï¼‰å®Œæˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»åŠ¨æ•´ç†æ‰‹åŠ¨ä¼˜åŒ–æ“ä½œ"&gt;ğŸ”§ &lt;strong&gt;ä¸»åŠ¨æ•´ç†ï¼šæ‰‹åŠ¨ä¼˜åŒ–æ“ä½œ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="optimize-table"&gt;&lt;strong&gt;&lt;code&gt;OPTIMIZE TABLE&lt;/code&gt; å‘½ä»¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šé‡å»ºè¡¨æ•°æ®ä¸ç´¢å¼•ï¼Œåˆå¹¶ç¢ç‰‡åŒ–çš„æ•°æ®é¡µï¼Œé‡Šæ”¾æœªä½¿ç”¨çš„ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;ï¼šåˆ›å»ºæ–°è¡¨ â†’ å¤åˆ¶æ•°æ® â†’ æ›¿æ¢æ—§è¡¨ï¼ˆè¿‡ç¨‹ä¸­ä¼šé”å®šè¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šç¢ç‰‡ç‡è¾ƒé«˜ï¼ˆå¦‚ &lt;code&gt;DATA_FREE&lt;/code&gt; æ˜¾è‘—å¤§äºæ•°æ®é•¿åº¦ï¼‰æˆ–æŸ¥è¯¢æ€§èƒ½æ˜æ˜¾ä¸‹é™æ—¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="alter-table"&gt;&lt;strong&gt;&lt;code&gt;ALTER TABLE&lt;/code&gt; é‡å»º&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å‘½ä»¤ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ALTER TABLE table_name ENGINE = InnoDB; -- é‡å»ºè¡¨ç»“æ„
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆæœ&lt;/strong&gt;ï¼šä¸ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt; ç±»ä¼¼ï¼Œä½†é”è¡¨æ—¶é—´æ›´çŸ­ï¼Œé€‚åˆå¤§è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åœ¨çº¿ç¢ç‰‡æ•´ç†ä»…é™-mariadbfacebook-åˆ†æ”¯"&gt;&lt;strong&gt;åœ¨çº¿ç¢ç‰‡æ•´ç†ï¼ˆä»…é™ MariaDB/Facebook åˆ†æ”¯ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é…ç½®å‚æ•°ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;innodb_defragment = ON -- å¯ç”¨åœ¨çº¿æ•´ç†
innodb_defragment_n_pages = 32 -- æ¯æ¬¡æ•´ç†çš„é¡µæ•°
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šæ— éœ€é‡å»ºè¡¨ï¼Œåå°å¼‚æ­¥åˆå¹¶ç¢ç‰‡é¡µï¼Œå‡å°‘ I/O å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-éšå¼æ¸…ç†æ•°æ®æ“ä½œè§¦å‘"&gt;ğŸ”„ &lt;strong&gt;éšå¼æ¸…ç†ï¼šæ•°æ®æ“ä½œè§¦å‘&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ’å…¥ä¸æ›´æ–°æ“ä½œ"&gt;&lt;strong&gt;æ’å…¥ä¸æ›´æ–°æ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´é‡ç”¨&lt;/strong&gt;ï¼šæ–°æ’å…¥çš„æ•°æ®ä¼šä¼˜å…ˆå¡«å……è¢«åˆ é™¤è®°å½•ç•™ä¸‹çš„ç©ºæ´ï¼ˆé¡µå†…ç¢ç‰‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é¡µåˆ†è£‚ä¸åˆå¹¶ï¼š
&lt;ul&gt;
&lt;li&gt;æ›´æ–°å¯¼è‡´æ•°æ®å¢é•¿æ—¶ï¼Œå¯èƒ½è§¦å‘é¡µåˆ†è£‚ï¼Œäº§ç”Ÿæ–°ç¢ç‰‡ï¼›&lt;/li&gt;
&lt;li&gt;è‹¥æ›´æ–°åæ•°æ®ç¼©å°ï¼Œå¯èƒ½è§¦å‘é¡µåˆå¹¶ï¼Œå‡å°‘ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ‰¹é‡åˆ é™¤ä¸"&gt;&lt;strong&gt;æ‰¹é‡åˆ é™¤ä¸ &lt;code&gt;TRUNCATE TABLE&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;TRUNCATE TABLE&lt;/code&gt;&lt;/strong&gt;ï¼šç›´æ¥é‡Šæ”¾æ•´ä¸ªè¡¨ç©ºé—´ï¼ˆé‡ç½®ä¸ºåˆå§‹çŠ¶æ€ï¼‰ï¼Œç¢ç‰‡æ¸…é›¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡åˆ é™¤&lt;/strong&gt;ï¼šå¤§é‡åˆ é™¤åæ‰§è¡Œ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt; å¯é«˜æ•ˆå›æ”¶ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç¢ç‰‡ç›‘æ§ä¸ä¼˜åŒ–å»ºè®®"&gt;ğŸ“Š &lt;strong&gt;ç¢ç‰‡ç›‘æ§ä¸ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç›‘æ§ç¢ç‰‡ç‡"&gt;&lt;strong&gt;ç›‘æ§ç¢ç‰‡ç‡&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;-- æŸ¥çœ‹è¡¨ç¢ç‰‡ç‡ï¼ˆDATA_FREE è¡¨ç¤ºæœªä½¿ç”¨ç©ºé—´ï¼‰
SELECT TABLE_NAME, DATA_FREE/1024/1024 AS data_free_MB
FROM INFORMATION_SCHEMA.TABLES
WHERE ENGINE = &amp;#39;InnoDB&amp;#39; AND TABLE_NAME = &amp;#39;your_table&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é˜ˆå€¼å»ºè®®&lt;/strong&gt;ï¼šè‹¥ &lt;code&gt;data_free_MB&lt;/code&gt; &amp;gt; è¡¨å¤§å°çš„ 10%ï¼Œéœ€è€ƒè™‘æ•´ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç”Ÿäº§ç¯å¢ƒå»ºè®®"&gt;&lt;strong&gt;ç”Ÿäº§ç¯å¢ƒå»ºè®®&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šæœŸç»´æŠ¤&lt;/strong&gt;ï¼šä½å³°æœŸæ‰§è¡Œ &lt;code&gt;OPTIMIZE TABLE&lt;/code&gt; æˆ–é…ç½®è‡ªåŠ¨ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é•¿äº‹åŠ¡&lt;/strong&gt;ï¼šç›‘æ§ &lt;code&gt;information_schema.innodb_trx&lt;/code&gt;ï¼ŒåŠæ—¶ç»“æŸé—²ç½®äº‹åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†åŒºè¡¨&lt;/strong&gt;ï¼šå¯¹å¤§è¡¨åˆ†åŒºï¼Œå‡å°‘å•æ¬¡æ•´ç†çš„å½±å“èŒƒå›´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ç¢ç‰‡æ¸…ç†çš„è§¦å‘æ—¶æœº"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šç¢ç‰‡æ¸…ç†çš„è§¦å‘æ—¶æœº&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¸…ç†æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•ˆæœ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Purge çº¿ç¨‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®°å½•æ— äº‹åŠ¡å¼•ç”¨ + å‘¨æœŸæ€§è¿è¡Œ/ç©ºé—´å‹åŠ›&lt;/td&gt;
&lt;td&gt;å›æ”¶ä¸»é”®ç´¢å¼•ç©ºé—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OPTIMIZE TABLE&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰‹åŠ¨æ‰§è¡Œæˆ–è®¡åˆ’ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;å…¨è¡¨ç¢ç‰‡æ•´ç†ï¼Œç©ºé—´å½»åº•é‡Šæ”¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ’å…¥/æ›´æ–°å¡«å……ç©ºæ´ã€é¡µåˆå¹¶&lt;/td&gt;
&lt;td&gt;å±€éƒ¨ç¢ç‰‡å‡å°‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;TRUNCATE&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¸…ç©ºè¡¨æ•°æ®&lt;/td&gt;
&lt;td&gt;ç«‹å³é‡Šæ”¾æ‰€æœ‰ç©ºé—´&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šInnoDB &lt;strong&gt;é»˜è®¤æ— è‡ªåŠ¨ç¢ç‰‡æ•´ç†æœºåˆ¶&lt;/strong&gt;ï¼Œéœ€ç»“åˆç›‘æ§ä¸æ‰‹åŠ¨å¹²é¢„ä¼˜åŒ–ç©ºé—´åˆ©ç”¨ç‡ã€‚å®šæœŸç»´æŠ¤æ˜¯é¿å…æ€§èƒ½ä¸‹é™çš„å…³é”®ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="uuid-ä¼˜åŒ–"&gt;UUID ä¼˜åŒ–
&lt;/h2&gt;&lt;p&gt;åœ¨MySQLä¸­ä½¿ç”¨UUIDä½œä¸ºéè‡ªå¢ä¸»é”®æ—¶ï¼Œå…¶éšæœºæ€§å’Œæ— åºæ€§ä¼šæ˜¾è‘—å½±å“æŸ¥è¯¢æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯é’ˆå¯¹UUIDä¸»é”®çš„ä¼˜åŒ–ç­–ç•¥åŠåŸç†åˆ†æï¼Œç»“åˆInnoDBå¼•æ“ç‰¹æ€§æä¾›è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-uuidä¸»é”®çš„æŸ¥è¯¢ç“¶é¢ˆ"&gt;âš™ï¸ &lt;strong&gt;UUIDä¸»é”®çš„æŸ¥è¯¢ç“¶é¢ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;èšç°‡ç´¢å¼•çš„ç‰©ç†æ— åºæ€§&lt;/strong&gt;
InnoDBè¡¨æ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼ˆIOTï¼‰ï¼Œæ•°æ®æŒ‰ä¸»é”®é¡ºåºç‰©ç†å­˜å‚¨ã€‚UUIDçš„éšæœºæ€§å¯¼è‡´æ–°æ’å…¥çš„æ•°æ®åˆ†æ•£åœ¨ç£ç›˜ä¸åŒä½ç½®ï¼Œå¼•å‘ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡µåˆ†è£‚&lt;/strong&gt;ï¼šé¢‘ç¹æ’å…¥éšæœºä¸»é”®æ—¶ï¼ŒB+æ ‘éœ€é¢‘ç¹åˆ†è£‚è°ƒæ•´ï¼Œå¢åŠ I/Oå¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜å¤±æ•ˆ&lt;/strong&gt;ï¼šéšæœºè®¿é—®ä½¿ç¼“å†²æ± ï¼ˆBuffer Poolï¼‰å‘½ä¸­ç‡ä¸‹é™ï¼Œçƒ­æ•°æ®è¢«æŒ¤å‡ºå†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ç©ºé—´è†¨èƒ€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CHAR(36)å ç”¨36å­—èŠ‚&lt;/strong&gt;ï¼Œè€Œè‡ªå¢BIGINTä»…8å­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;äºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨ä¸»é”®å€¼ï¼ŒUUIDè¿‡é•¿ä¼šæ˜¾è‘—æ‰©å¤§äºŒçº§ç´¢å¼•ä½“ç§¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Š &lt;strong&gt;æ•°æ®å¯¹æ¯”&lt;/strong&gt;ï¼š100ä¸‡æ•°æ®ä¸‹ï¼ŒUUIDä¸»é”®ç´¢å¼•å¤§å°ï¼ˆ38.5MBï¼‰è¿œè¶…è‡ªå¢IDï¼ˆ8.2MBï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢æ•ˆç‡ä½&lt;/strong&gt;
èŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚&lt;code&gt;WHERE id &amp;gt; 'xxx'&lt;/code&gt;ï¼‰éœ€æ‰«æå¤§é‡ä¸è¿ç»­çš„æ•°æ®é¡µï¼Œè€Œè‡ªå¢IDå¯å¿«é€Ÿå®šä½è¿ç»­é¡µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–ç­–ç•¥ä¸å®æˆ˜æ–¹æ¡ˆ"&gt;ğŸš€ &lt;strong&gt;ä¼˜åŒ–ç­–ç•¥ä¸å®æˆ˜æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="-äºŒè¿›åˆ¶å­˜å‚¨å‹ç¼©æ ¸å¿ƒä¼˜åŒ–"&gt;âœ… &lt;strong&gt;äºŒè¿›åˆ¶å­˜å‚¨å‹ç¼©ï¼ˆæ ¸å¿ƒä¼˜åŒ–ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ–¹æ³•ï¼šå°†UUIDè½¬æ¢ä¸º16å­—èŠ‚çš„
&lt;pre tabindex="0"&gt;&lt;code&gt;BINARY(16)
&lt;/code&gt;&lt;/pre&gt;ï¼Œè€Œé
&lt;pre tabindex="0"&gt;&lt;code&gt;CHAR(36)
```ï¼š
&lt;/code&gt;&lt;/pre&gt;CREATE TABLE users (
id BINARY(16) PRIMARY KEY,
name VARCHAR(100)
);
INSERT INTO users (id, name)
VALUES (UUID_TO_BIN(UUID()), &amp;lsquo;Alice&amp;rsquo;);
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;æ€§èƒ½æå‡ï¼š
&lt;ul&gt;
&lt;li&gt;ç´¢å¼•å¤§å°å‡å°‘55%ï¼ˆ36å­—èŠ‚â†’16å­—èŠ‚ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;èŒƒå›´æŸ¥è¯¢é€Ÿåº¦æå‡30%ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢è½¬æ¢ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM users WHERE id = UUID_TO_BIN(&amp;#39;f5a96171-0045-11e5-9cc7-fcaa1490706f&amp;#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-æ—¶é—´å‰ç¼€é‡æ’å‡å°‘é¡µåˆ†è£‚"&gt;â±ï¸ &lt;strong&gt;æ—¶é—´å‰ç¼€é‡æ’ï¼ˆå‡å°‘é¡µåˆ†è£‚ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼šè°ƒæ•´UUIDçš„å­—èŠ‚é¡ºåºï¼Œå°†æ—¶é—´æˆ³å‰ç½®ï¼ˆå¦‚MySQL 8.0çš„
&lt;pre tabindex="0"&gt;&lt;code&gt;UUID_TO_BIN(uuid, 1)
&lt;/code&gt;&lt;/pre&gt;ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;INSERT INTO users (id, name)
VALUES (UUID_TO_BIN(UUID(), 1), &amp;#39;Bob&amp;#39;); -- ç¬¬äºŒä¸ªå‚æ•°1è¡¨ç¤ºæ—¶é—´æˆ³å‰ç½®
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;æ–°æ•°æ®æŒ‰æ—¶é—´è¿‘ä¼¼é¡ºåºæ’å…¥ï¼Œå‡å°‘é¡µåˆ†è£‚60%ã€‚&lt;/li&gt;
&lt;li&gt;èŒƒå›´æŸ¥è¯¢åŸºäºæ—¶é—´èŒƒå›´æ—¶æ•ˆç‡æ›´é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-è¦†ç›–ç´¢å¼•ä¸æŸ¥è¯¢ä¼˜åŒ–"&gt;ğŸ” &lt;strong&gt;è¦†ç›–ç´¢å¼•ä¸æŸ¥è¯¢ä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é¿å…å…¨è¡¨æ‰«æï¼š
å¯¹é«˜é¢‘æŸ¥è¯¢å­—æ®µå»ºç«‹äºŒçº§ç´¢å¼•ï¼Œå¹¶åˆ©ç”¨è¦†ç›–ç´¢å¼•é¿å…å›è¡¨ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE INDEX idx_name ON users(name);
SELECT id FROM users WHERE name = &amp;#39;Alice&amp;#39;; -- è¦†ç›–ç´¢å¼•æ‰«æ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å¼ºåˆ¶ç´¢å¼•
ï¼ˆæç«¯åœºæ™¯ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM users FORCE INDEX(PRIMARY) WHERE id = UUID_TO_BIN(&amp;#39;...&amp;#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-ç»„åˆç´¢å¼•åˆ†å¸ƒå¼åœºæ™¯"&gt;ğŸ§© &lt;strong&gt;ç»„åˆç´¢å¼•ï¼ˆåˆ†å¸ƒå¼åœºæ™¯ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é€‚ç”¨åœºæ™¯ï¼šåˆ†åº“åˆ†è¡¨æ—¶ï¼Œä½¿ç”¨â€œåˆ†ç‰‡ID + UUIDâ€ç»„åˆä¸»é”®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CREATE TABLE users (
shard_id TINYINT, -- åˆ†ç‰‡æ ‡è¯†
uuid BINARY(16), -- å‹ç¼©UUID
PRIMARY KEY (shard_id, uuid)
);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;åŒä¸€åˆ†ç‰‡å†…æ•°æ®ç‰©ç†è¿ç»­ï¼Œå‡å°‘I/Oéšæœºæ€§ã€‚&lt;/li&gt;
&lt;li&gt;äºŒçº§ç´¢å¼•å¯ä»…ä½¿ç”¨&lt;code&gt;uuid&lt;/code&gt;å­—æ®µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-åº”ç”¨å±‚ç¼“å­˜"&gt;ğŸ’¾ &lt;strong&gt;åº”ç”¨å±‚ç¼“å­˜&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°ç¼“å­˜&lt;/strong&gt;ï¼šç”¨Redisç¼“å­˜çƒ­ç‚¹æŸ¥è¯¢ç»“æœï¼Œå‡å°‘æ•°æ®åº“å‹åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡æ˜ å°„&lt;/strong&gt;ï¼šåœ¨åº”ç”¨å±‚ç»´æŠ¤â€œUUID â†’ å†…å­˜å¯¹è±¡â€æ˜ å°„ï¼Œé¿å…é«˜é¢‘æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½å¯¹æ¯”ä¸æ–¹æ¡ˆé€‰å‹"&gt;ğŸ“Š &lt;strong&gt;æ€§èƒ½å¯¹æ¯”ä¸æ–¹æ¡ˆé€‰å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;æ’å…¥é€Ÿåº¦ï¼ˆæ¡/ç§’ï¼‰&lt;/th&gt;
&lt;th&gt;ç´¢å¼•å¤§å°ï¼ˆ100ä¸‡æ•°æ®ï¼‰&lt;/th&gt;
&lt;th&gt;èŒƒå›´æŸ¥è¯¢è€—æ—¶&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;è‡ªå¢IDï¼ˆBIGINTï¼‰&lt;/td&gt;
&lt;td&gt;12,345&lt;/td&gt;
&lt;td&gt;8.2MB&lt;/td&gt;
&lt;td&gt;12ms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UUIDï¼ˆCHAR(36)ï¼‰&lt;/td&gt;
&lt;td&gt;6,543&lt;/td&gt;
&lt;td&gt;38.5MB&lt;/td&gt;
&lt;td&gt;28ms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;UUIDï¼ˆBINARY(16))&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;8,900&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;17.2MB&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;18ms&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¶é—´å‰ç¼€BINARY(16)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;10,200&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;17.2MB&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;15ms&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å•æœºç³»ç»Ÿ&lt;/strong&gt;ï¼šä¼˜å…ˆç”¨è‡ªå¢IDï¼Œæ€§èƒ½æœ€ä¼˜ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆ†å¸ƒå¼ç³»ç»Ÿ&lt;/p&gt;
&lt;p&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥éœ€å¼ºå…¨å±€å”¯ä¸€ â†’ &lt;strong&gt;æ—¶é—´å‰ç¼€BINARY(16)&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æŸ¥è¯¢ä»¥æ—¶é—´èŒƒå›´ä¸ºä¸» â†’ &lt;strong&gt;åˆ†ç‰‡ID+æ—¶é—´æœ‰åºUUID&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å­˜å‚¨æ•æ„Ÿ â†’ &lt;strong&gt;çº¯BINARY(16)å‹ç¼©å­˜å‚¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-1"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ…ç”¨&lt;code&gt;ORDER BY UUID&lt;/code&gt;&lt;/strong&gt;ï¼šæ’åºæ¶ˆè€—å¤§é‡CPUå’Œä¸´æ—¶ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;ç›‘æ§é¡µåˆ†è£‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SHOW STATUS LIKE &amp;#39;innodb_page%&amp;#39;; -- å…³æ³¨åˆ†è£‚æ¬¡æ•°
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é•¿äº‹åŠ¡&lt;/strong&gt;ï¼šUUIDæ’å…¥æ…¢ï¼Œé•¿äº‹åŠ¡åŠ å‰§é”ç«äº‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-17"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¼˜åŒ–UUIDä¸»é”®æŸ¥è¯¢çš„æ ¸å¿ƒåœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å‹ç¼©&lt;/strong&gt; â†’ ç”¨&lt;code&gt;BINARY(16)&lt;/code&gt;æ›¿ä»£&lt;code&gt;CHAR(36)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†æœ‰åº&lt;/strong&gt; â†’ æ—¶é—´æˆ³å‰ç½®å‡å°‘é¡µåˆ†è£‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥è¯¢è§„é¿&lt;/strong&gt; â†’ è¦†ç›–ç´¢å¼•ä¸ç¼“å­˜é™ä½I/Oå‹åŠ›ã€‚
åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œç»¼åˆé‡‡ç”¨åˆ†ç‰‡ç»„åˆé”®ã€åº”ç”¨ç¼“å­˜ç­‰ç­–ç•¥ï¼Œå¯æœ€å¤§é™åº¦é€¼è¿‘è‡ªå¢IDçš„æ€§èƒ½ï¼ŒåŒæ—¶ä¿ç•™UUIDçš„å…¨å±€å”¯ä¸€ä¼˜åŠ¿ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ç´¢å¼•"&gt;ç´¢å¼•
&lt;/h2&gt;&lt;p&gt;InnoDBå­˜å‚¨å¼•æ“çš„ç´¢å¼•ä¸»è¦åŸºäº&lt;strong&gt;B+æ ‘ï¼ˆB+ Treeï¼‰&lt;/strong&gt; æ•°æ®ç»“æ„å®ç°ï¼Œè¿™æ˜¯å…¶é«˜æ•ˆæ”¯æŒäº‹åŠ¡ã€é«˜å¹¶å‘æŸ¥è¯¢åŠèŒƒå›´æ“ä½œçš„æ ¸å¿ƒè®¾è®¡ã€‚ä»¥ä¸‹ä»ç»“æ„åŸç†ã€ä¼˜åŠ¿åŸå› ã€å…·ä½“å®ç°åŠå¯¹æ¯”åˆ†æå±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ•°æ®ç»“æ„bæ ‘"&gt;â›“ï¸ &lt;strong&gt;æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šB+æ ‘&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;B+æ ‘çš„æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šè·¯å¹³è¡¡æ ‘&lt;/strong&gt;ï¼šæ¯ä¸ªéå¶å­èŠ‚ç‚¹å­˜å‚¨é”®å€¼ï¼ˆKeyï¼‰å’Œå­èŠ‚ç‚¹æŒ‡é’ˆï¼ˆPointerï¼‰ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨å®é™…æ•°æ®æˆ–ä¸»é”®å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å±‚è®¾è®¡&lt;/strong&gt;ï¼šæ ‘é«˜é€šå¸¸ä¸º3~4å±‚ï¼Œæ”¯æŒåƒä¸‡çº§æ•°æ®å­˜å‚¨ï¼ˆå¦‚16KBé¡µå¤§å°ä¸‹ï¼Œ3å±‚B+æ ‘å¯å®¹çº³çº¦&lt;strong&gt;16äº¿è¡Œæ•°æ®&lt;/strong&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¶å­èŠ‚ç‚¹åŒå‘é“¾è¡¨&lt;/strong&gt;ï¼šæ‰€æœ‰å¶å­èŠ‚ç‚¹é€šè¿‡åŒå‘æŒ‡é’ˆä¸²è”ï¼Œæ”¯æŒé«˜æ•ˆèŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚&lt;code&gt;BETWEEN&lt;/code&gt;ã€&lt;code&gt;ORDER BY&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸¤ç±»ç´¢å¼•çš„å®ç°å·®å¼‚&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç´¢å¼•ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¶å­èŠ‚ç‚¹å†…å®¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®å®šä½æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èšç°‡ç´¢å¼•ï¼ˆä¸»é”®ç´¢å¼•ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨å®Œæ•´æ•°æ®è¡Œ&lt;/td&gt;
&lt;td&gt;ç›´æ¥å®šä½æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äºŒçº§ç´¢å¼•ï¼ˆè¾…åŠ©ç´¢å¼•ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨ä¸»é”®å€¼&lt;/td&gt;
&lt;td&gt;éœ€å›è¡¨æŸ¥è¯¢èšç°‡ç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€‰æ‹©bæ ‘çš„æ ¸å¿ƒåŸå› "&gt;ğŸš€ &lt;strong&gt;é€‰æ‹©B+æ ‘çš„æ ¸å¿ƒåŸå› &lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¯¹æ¯”å…¶ä»–æ•°æ®ç»“æ„çš„åŠ£åŠ¿&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢æ•ˆç‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç£ç›˜I/Oä¼˜åŒ–&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å“ˆå¸Œç´¢å¼•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;éšæœºè®¿é—®ï¼Œä¸é€‚ç”¨ç£ç›˜&lt;/td&gt;
&lt;td&gt;çº¯ç­‰å€¼æŸ¥è¯¢ï¼ˆå¦‚Memoryå¼•æ“ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äºŒå‰æ ‘ï¼ˆBST/AVLï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€ä¸­åºéå†ï¼ˆéšæœºI/Oï¼‰&lt;/td&gt;
&lt;td&gt;æ ‘é«˜è¿‡é«˜ï¼ˆ1äº¿æ•°æ®éœ€27å±‚ï¼‰&lt;/td&gt;
&lt;td&gt;å†…å­˜å‹å°æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Bæ ‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€è·¨å±‚çº§éå†ï¼ˆéšæœºI/Oï¼‰&lt;/td&gt;
&lt;td&gt;èŠ‚ç‚¹å­˜å‚¨æ•°æ®ï¼Œæ‰‡å‡ºä½&lt;/td&gt;
&lt;td&gt;å°‘é‡æ•°æ®åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;B+æ ‘çš„å››å¤§ä¼˜åŠ¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ‰‡å‡ºï¼ˆFan-outï¼‰&lt;/strong&gt;ï¼šéå¶å­èŠ‚ç‚¹ä»…å­˜é”®å€¼+æŒ‡é’ˆï¼Œå•èŠ‚ç‚¹å¯å­˜å‚¨æ›´å¤šé”®ï¼ˆå¦‚1170ä¸ªï¼‰ï¼Œå¤§å¹…é™ä½æ ‘é«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºI/Oä¼˜åŒ–&lt;/strong&gt;ï¼šå¶å­èŠ‚ç‚¹åŒå‘é“¾è¡¨æ”¯æŒèŒƒå›´æŸ¥è¯¢çš„é¡ºåºéå†ï¼Œé¿å…éšæœºç£ç›˜è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¨³å®šæŸ¥è¯¢æ•ˆç‡&lt;/strong&gt;ï¼šæ‰€æœ‰æŸ¥è¯¢è·¯å¾„é•¿åº¦ç›¸åŒï¼ˆæ—¶é—´å¤æ‚åº¦ç¨³å®šä¸º&lt;code&gt;O(logN)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¦†ç›–ç´¢å¼•æ”¯æŒ&lt;/strong&gt;ï¼šè‹¥æŸ¥è¯¢å­—æ®µå‡åœ¨ç´¢å¼•ä¸­ï¼Œæ— éœ€å›è¡¨ï¼ˆå¦‚&lt;code&gt;SELECT id FROM table&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-bæ ‘åœ¨innodbä¸­çš„å…·ä½“å®ç°"&gt;âš™ï¸ &lt;strong&gt;B+æ ‘åœ¨InnoDBä¸­çš„å…·ä½“å®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†å­˜å‚¨ï¼šé¡µï¼ˆPageï¼‰ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤16KBé¡µ&lt;/strong&gt;ï¼šä¸ç£ç›˜å—å¯¹é½ï¼Œä¸€æ¬¡I/Oè¯»å–ä¸€é¡µã€‚&lt;/li&gt;
&lt;li&gt;é¡µå†…ç»„æˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Header&lt;/code&gt;ï¼šå­˜å‚¨å‰åé¡µæŒ‡é’ˆï¼ˆç»´æŠ¤åŒå‘é“¾è¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;User Records&lt;/code&gt;ï¼šæŒ‰ä¸»é”®é¡ºåºå­˜å‚¨æ•°æ®è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Page Directory&lt;/code&gt;ï¼šç¨€ç–ç›®å½•æ”¯æŒé¡µå†…äºŒåˆ†æŸ¥æ‰¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€å¹³è¡¡æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡µåˆ†è£‚ï¼ˆPage Splitï¼‰&lt;/strong&gt;ï¼šæ’å…¥å¯¼è‡´é¡µæº¢å‡ºæ—¶ï¼Œåˆ†è£‚ä¸ºä¸¤é¡µå¹¶æ›´æ–°çˆ¶èŠ‚ç‚¹æŒ‡é’ˆï¼ˆå¯èƒ½å¼•å‘çŸ­æš‚æ€§èƒ½æŠ–åŠ¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µåˆå¹¶ï¼ˆPage Mergeï¼‰&lt;/strong&gt;ï¼šåˆ é™¤åç›¸é‚»é¡µç©ºé—´è¶…é˜ˆå€¼ï¼ˆé»˜è®¤50%ï¼‰æ—¶åˆå¹¶ï¼Œå‡å°‘ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;ï¼šä¸»é”®è®¾ä¸ºè‡ªå¢æ•´å‹ï¼Œé¿å…éšæœºå€¼ï¼ˆå¦‚UUIDï¼‰å‡å°‘åˆ†è£‚æ¦‚ç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥è¯¢æµç¨‹ç¤ºä¾‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;äºŒçº§ç´¢å¼•æŸ¥è¯¢ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM users WHERE name = &amp;#39;Alice&amp;#39;; -- å‡è®¾nameæ˜¯äºŒçº§ç´¢å¼•
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;æ­¥éª¤1ï¼šåœ¨&lt;code&gt;name&lt;/code&gt;ç´¢å¼•æ ‘ä¸­æŸ¥æ‰¾&lt;code&gt;Alice&lt;/code&gt;ï¼Œè·å–ä¸»é”®å€¼ï¼ˆå¦‚&lt;code&gt;id=101&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ­¥éª¤2ï¼šé€šè¿‡ä¸»é”®&lt;code&gt;101&lt;/code&gt;å›è¡¨æŸ¥è¯¢èšç°‡ç´¢å¼•ï¼Œè·å–å®Œæ•´æ•°æ®è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸æœ€ä½³å®è·µ"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆæ˜¯B+æ ‘ï¼Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¹³è¡¡äº†&lt;strong&gt;æŸ¥è¯¢æ•ˆç‡&lt;/strong&gt;ï¼ˆç­‰å€¼/èŒƒå›´æ“ä½œï¼‰ã€&lt;strong&gt;ç£ç›˜I/Oä¼˜åŒ–&lt;/strong&gt;ï¼ˆé«˜æ‰‡å‡º+é¡ºåºè®¿é—®ï¼‰åŠ&lt;strong&gt;ç¨³å®šæ€§&lt;/strong&gt;ï¼ˆåŠ¨æ€å¹³è¡¡æ ‘ç»“æ„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡å»ºè®®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»é”®é€‰æ‹©&lt;/strong&gt;ï¼šè‡ªå¢æ•´å‹ &amp;gt; å•è°ƒå­—æ®µ &amp;gt; UUIDï¼Œå‡å°‘é¡µåˆ†è£‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•å­—æ®µé•¿åº¦&lt;/strong&gt;ï¼šé¿å…è¿‡é•¿ï¼ˆå¦‚&lt;code&gt;VARCHAR(255)&lt;/code&gt;ï¼‰ï¼Œå½±å“èŠ‚ç‚¹é”®æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è”åˆç´¢å¼•&lt;/strong&gt;ï¼šéµå¾ªæœ€å·¦å‰ç¼€åŸåˆ™ï¼ˆå¦‚&lt;code&gt;(a,b,c)&lt;/code&gt;ç´¢å¼•æ”¯æŒ&lt;code&gt;WHERE a=? AND b=?&lt;/code&gt;ï¼Œä¸æ”¯æŒ&lt;code&gt;WHERE b=?&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç›‘æ§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡&lt;code&gt;SHOW ENGINE INNODB STATUS&lt;/code&gt;è§‚å¯Ÿé¡µåˆ†è£‚é¢‘ç‡ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;EXPLAIN&lt;/code&gt;åˆ†ææŸ¥è¯¢æ˜¯å¦åˆ©ç”¨è¦†ç›–ç´¢å¼•æˆ–è§¦å‘å›è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æç¤º&lt;/strong&gt;ï¼šB+æ ‘æ˜¯æ•°æ®åº“ç´¢å¼•çš„å·¥ä¸šæ ‡å‡†è®¾è®¡ï¼Œç†è§£å…¶åŸç†å¯ä¼˜åŒ–SQLç¼–å†™ã€ç´¢å¼•è®¾è®¡åŠæ€§èƒ½è°ƒä¼˜ã€‚å¯¹äºè¶…å¤§è§„æ¨¡æ•°æ®ï¼ˆå¦‚åäº¿çº§ï¼‰ï¼Œå¯ç»“åˆåˆ†åŒºè¡¨æˆ–åˆ†åº“åˆ†è¡¨è¿›ä¸€æ­¥æ‰©å±•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="äºŒçº§ç´¢å¼•"&gt;äºŒçº§ç´¢å¼•
&lt;/h2&gt;&lt;p&gt;åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œéä¸»é”®ç´¢å¼•ï¼ˆä¹Ÿç§°ä¸ºäºŒçº§ç´¢å¼•ã€è¾…åŠ©ç´¢å¼•ï¼‰çš„å»ºç«‹æœºåˆ¶æ˜¯å…¶æ ¸å¿ƒè®¾è®¡ä¹‹ä¸€ï¼Œå…¶å®ç°åŸºäºB+æ ‘ç»“æ„ï¼Œä½†ä¸ä¸»é”®ç´¢å¼•ï¼ˆèšç°‡ç´¢å¼•ï¼‰å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹ä»å­˜å‚¨ç»“æ„ã€æ•°æ®ç»„ç»‡ã€æŸ¥è¯¢æœºåˆ¶åŠä¼˜åŒ–ç­–ç•¥å±•å¼€åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-äºŒçº§ç´¢å¼•çš„å­˜å‚¨ç»“æ„"&gt;â›“ï¸ &lt;strong&gt;äºŒçº§ç´¢å¼•çš„å­˜å‚¨ç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;B+æ ‘ç»„ç»‡&lt;/strong&gt;
æ¯ä¸ªäºŒçº§ç´¢å¼•ç‹¬ç«‹æ„å»ºä¸€æ£µB+æ ‘ï¼Œå…¶ç»“æ„ä¸èšç°‡ç´¢å¼•ç±»ä¼¼ï¼Œä½†&lt;strong&gt;å¶å­èŠ‚ç‚¹å­˜å‚¨çš„å†…å®¹ä¸åŒ&lt;/strong&gt;â€‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¶å­èŠ‚ç‚¹&lt;/strong&gt;ï¼šå­˜å‚¨ç´¢å¼•é”®å€¼ï¼ˆåˆ›å»ºç´¢å¼•çš„åˆ—å€¼ï¼‰ + å¯¹åº”è¡Œçš„&lt;strong&gt;ä¸»é”®å€¼&lt;/strong&gt;ï¼ˆéå®Œæ•´æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éå¶å­èŠ‚ç‚¹&lt;/strong&gt;ï¼šä»…å­˜å‚¨ç´¢å¼•é”®å€¼å’ŒæŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼ˆç”¨äºå¿«é€Ÿå®šä½å¶å­èŠ‚ç‚¹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šå¯¹&lt;code&gt;name&lt;/code&gt;åˆ—åˆ›å»ºç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨&lt;code&gt;(name_value, primary_key)&lt;/code&gt;ï¼Œå¦‚&lt;code&gt;('Alice', 101)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è”åˆç´¢å¼•çš„ç‰¹æ®Šæ€§&lt;/strong&gt;
è‹¥ç´¢å¼•åŒ…å«å¤šåˆ—ï¼ˆå¦‚&lt;code&gt;INDEX (a,b)&lt;/code&gt;ï¼‰ï¼ŒB+æ ‘æŒ‰&lt;strong&gt;æœ€å·¦å‰ç¼€åŸåˆ™&lt;/strong&gt;æ’åºï¼š
&lt;ul&gt;
&lt;li&gt;å…ˆæŒ‰&lt;code&gt;a&lt;/code&gt;æ’åºï¼Œ&lt;code&gt;a&lt;/code&gt;ç›¸åŒæ—¶æŒ‰&lt;code&gt;b&lt;/code&gt;æ’åºã€‚&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢æ—¶éœ€åŒ¹é…æœ€å·¦åˆ—ï¼ˆå¦‚&lt;code&gt;WHERE a=1 AND b=2&lt;/code&gt;å¯ç”¨ç´¢å¼•ï¼›&lt;code&gt;WHERE b=2&lt;/code&gt;ä¸å¯ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®ç»„ç»‡ä¸æŸ¥è¯¢æœºåˆ¶"&gt;ğŸ” &lt;strong&gt;æ•°æ®ç»„ç»‡ä¸æŸ¥è¯¢æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å›è¡¨æŸ¥è¯¢ï¼ˆå…³é”®æ­¥éª¤ï¼‰&lt;/strong&gt;
é€šè¿‡äºŒçº§ç´¢å¼•æŸ¥æ‰¾æ•°æ®éœ€&lt;strong&gt;ä¸¤æ¬¡B+æ ‘æœç´¢&lt;/strong&gt;â€‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤1&lt;/strong&gt;ï¼šåœ¨äºŒçº§ç´¢å¼•B+æ ‘ä¸­æŸ¥æ‰¾ç›®æ ‡é”®å€¼ï¼Œè·å–ä¸»é”®å€¼ï¼ˆå¦‚&lt;code&gt;name='Alice' â†’ primary_key=101&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤2&lt;/strong&gt;ï¼šç”¨ä¸»é”®å€¼åœ¨èšç°‡ç´¢å¼•B+æ ‘ä¸­æŸ¥æ‰¾å®Œæ•´è¡Œæ•°æ®ï¼ˆå›è¡¨ï¼‰ã€‚
â†’ &lt;em&gt;è‹¥æŸ¥è¯¢ä»…éœ€ç´¢å¼•åˆ—æˆ–ä¸»é”®ï¼Œå¯é¿å…å›è¡¨ï¼ˆè¦†ç›–ç´¢å¼•ï¼‰&lt;/em&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µå†…æ•°æ®å®šä½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªç´¢å¼•é¡µï¼ˆ16KBï¼‰åŒ…å«é¡µç›®å½•ï¼ˆPage Directoryï¼‰ï¼Œé€šè¿‡æ§½ï¼ˆSlotï¼‰å¯¹è®°å½•åˆ†ç»„ï¼Œæ”¯æŒé¡µå†…äºŒåˆ†æŸ¥æ‰¾ã€‚&lt;/li&gt;
&lt;li&gt;é¡µé—´é€šè¿‡åŒå‘é“¾è¡¨è¿æ¥ï¼Œæ”¯æŒèŒƒå›´æ‰«æï¼ˆå¦‚&lt;code&gt;WHERE name &amp;gt; 'A'&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç»´æŠ¤æœºåˆ¶ä¸æ€§èƒ½å½±å“"&gt;âš™ï¸ &lt;strong&gt;ç»´æŠ¤æœºåˆ¶ä¸æ€§èƒ½å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†™å…¥ä»£ä»·&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®æ’å…¥/æ›´æ–°æ—¶ï¼Œéœ€åŒæ­¥ä¿®æ”¹&lt;strong&gt;æ‰€æœ‰ç›¸å…³ç´¢å¼•&lt;/strong&gt;ï¼ˆèšç°‡ç´¢å¼• + æ‰€æœ‰äºŒçº§ç´¢å¼•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éšæœºä¸»é”®ï¼ˆå¦‚UUIDï¼‰æ˜“å¯¼è‡´é¡µåˆ†è£‚ï¼Œå¢åŠ I/Oå¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µåˆ†è£‚ä¸åˆå¹¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡µåˆ†è£‚&lt;/strong&gt;ï¼šå½“ç´¢å¼•é¡µç©ºé—´ä¸è¶³æ—¶ï¼Œåˆ†è£‚ä¸ºä¸¤é¡µå¹¶è°ƒæ•´B+æ ‘ç»“æ„ï¼ˆå½±å“å†™å…¥æ€§èƒ½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µåˆå¹¶&lt;/strong&gt;ï¼šç›¸é‚»é¡µç©ºé—²ç©ºé—´è¶…é˜ˆå€¼ï¼ˆé»˜è®¤50%ï¼‰æ—¶åˆå¹¶ï¼Œæé«˜ç©ºé—´åˆ©ç”¨ç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;äºŒçº§ç´¢å¼•å¶å­èŠ‚ç‚¹ä»…å­˜å‚¨é”®å€¼å’Œä¸»é”®ï¼Œä½†ä»éœ€ç‹¬ç«‹å­˜å‚¨ç©ºé—´ï¼ˆçº¦ä¸ºèšç°‡ç´¢å¼•çš„30%-70%ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è”åˆç´¢å¼•å¯å‡å°‘ç´¢å¼•æ•°é‡ï¼Œä½†å¯èƒ½å¢åŠ å•ç´¢å¼•å¤§å°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–ç­–ç•¥-1"&gt;ğŸš€ &lt;strong&gt;ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¦†ç›–ç´¢å¼•ï¼ˆé¿å…å›è¡¨ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è®¾è®¡ç´¢å¼•åŒ…å«æŸ¥è¯¢æ‰€éœ€åˆ—ï¼ˆå¦‚&lt;code&gt;SELECT name FROM users WHERE name='Alice'&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å‡å°‘ç£ç›˜I/Oï¼Œæå‡æŸ¥è¯¢é€Ÿåº¦30%ä»¥ä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ä¸‹æ¨ï¼ˆICPï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;MySQL 5.6+æ”¯æŒåœ¨äºŒçº§ç´¢å¼•å±‚è¿‡æ»¤æ•°æ®ï¼ˆå¦‚&lt;code&gt;WHERE name LIKE 'A%' AND age=30&lt;/code&gt;ï¼‰ï¼Œå‡å°‘å›è¡¨æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‰ç¼€ç´¢å¼•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹é•¿æ–‡æœ¬åˆ—ï¼ˆå¦‚&lt;code&gt;VARCHAR(255)&lt;/code&gt;ï¼‰ï¼Œä»…ç´¢å¼•å‰Nä¸ªå­—ç¬¦ï¼ˆéœ€å¹³è¡¡é€‰æ‹©æ€§ä¸é•¿åº¦ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¼&lt;/strong&gt;ï¼š&lt;code&gt;SELECT COUNT(DISTINCT LEFT(column, N))/COUNT(*)&lt;/code&gt;ï¼Œé€‰æ‹©æ€§ &amp;gt; 0.3 æ—¶æœ‰æ•ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå¢ä¸»é”®ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨è‡ªå¢ä¸»é”®ï¼ˆè€ŒéUUIDï¼‰å‡å°‘é¡µåˆ†è£‚ï¼Œæå‡æ’å…¥æ€§èƒ½ã€‚
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;èšç°‡ç´¢å¼•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;äºŒçº§ç´¢å¼•&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å¶å­èŠ‚ç‚¹å†…å®¹&lt;/td&gt;
&lt;td&gt;å®Œæ•´è¡Œæ•°æ®&lt;/td&gt;
&lt;td&gt;ç´¢å¼•åˆ—å€¼ + ä¸»é”®å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ•°é‡é™åˆ¶&lt;/td&gt;
&lt;td&gt;ä»…1ä¸ª&lt;/td&gt;
&lt;td&gt;å¯åˆ›å»ºå¤šä¸ª&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æŸ¥è¯¢è·¯å¾„&lt;/td&gt;
&lt;td&gt;ç›´æ¥å®šä½æ•°æ®&lt;/td&gt;
&lt;td&gt;éœ€å›è¡¨æŸ¥è¯¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç©ºé—´å ç”¨&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå«å…¨éƒ¨æ•°æ®ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆä»…ç´¢å¼•åˆ—+ä¸»é”®ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹-1"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•é€‰æ‹©æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€‰æ‹©æ€§ä½çš„åˆ—ï¼ˆå¦‚æ€§åˆ«ï¼‰å»ºç´¢å¼•æ•ˆç‡ä½ï¼ˆå…¨æ‰«æå¯èƒ½æ›´å¿«ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¼&lt;/strong&gt;ï¼šé€‰æ‹©æ€§ = å”¯ä¸€å€¼æ•°é‡ / æ€»è¡Œæ•°ï¼ˆ&amp;gt; 0.1 æ—¶é€‚ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”æœºåˆ¶å…³è”&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;äºŒçº§ç´¢å¼•æŸ¥è¯¢å¯èƒ½è§¦å‘é—´éš™é”ï¼ˆGap Lockï¼‰ï¼Œå½±å“å¹¶å‘ã€‚&lt;/li&gt;
&lt;li&gt;èŒƒå›´æŸ¥è¯¢æ—¶ï¼Œéå”¯ä¸€ç´¢å¼•æ˜“å¼•å‘é”å†²çªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»Ÿè®¡ä¿¡æ¯æ›´æ–°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®šæœŸæ‰§è¡Œ&lt;code&gt;ANALYZE TABLE&lt;/code&gt;æ›´æ–°ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯ï¼Œé¿å…ä¼˜åŒ–å™¨è¯¯åˆ¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-18"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;InnoDBçš„äºŒçº§ç´¢å¼•é€šè¿‡ç‹¬ç«‹çš„B+æ ‘ç»„ç»‡ç´¢å¼•é”®ä¸ä¸»é”®çš„æ˜ å°„å…³ç³»ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;åŠ é€Ÿéä¸»é”®æŸ¥è¯¢&lt;/strong&gt;ï¼Œä½†éœ€è­¦æƒ•å›è¡¨ä»£ä»·ã€‚ä¼˜åŒ–æ–¹å‘åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡å±‚é¢&lt;/strong&gt;ï¼šä¼˜å…ˆè¦†ç›–ç´¢å¼•ã€è”åˆç´¢å¼•ã€è‡ªå¢ä¸»é”®ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥è¯¢å±‚é¢&lt;/strong&gt;ï¼šåˆ©ç”¨ç´¢å¼•ä¸‹æ¨ã€é¿å…å‡½æ•°è½¬æ¢ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»´æŠ¤å±‚é¢&lt;/strong&gt;ï¼šç›‘æ§é¡µåˆ†è£‚é¢‘ç‡ã€æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ”„ &lt;strong&gt;æµç¨‹ç¤ºæ„&lt;/strong&gt;ï¼šäºŒçº§ç´¢å¼•æŸ¥è¯¢è·¯å¾„
â€‹&lt;strong&gt;æŸ¥è¯¢æ¡ä»¶ â†’ äºŒçº§ç´¢å¼•B+æ ‘ â†’ è·å–ä¸»é”®å€¼ â†’ èšç°‡ç´¢å¼•B+æ ‘ â†’ è¿”å›å®Œæ•´æ•°æ®&lt;/strong&gt;â€‹
é€šè¿‡åˆç†è®¾è®¡ï¼ŒäºŒçº§ç´¢å¼•å¯æ˜¾è‘—æå‡æŸ¥è¯¢æ•ˆç‡ï¼Œä½†éœ€åœ¨å­˜å‚¨æˆæœ¬ã€å†™å…¥æ€§èƒ½ä¸æŸ¥è¯¢é€Ÿåº¦é—´æƒè¡¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Mysqlã€‘sql</title><link>https://dyhes.github.io/p/mysqlsql/</link><pubDate>Mon, 02 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/mysqlsql/</guid><description>&lt;h2 id="explain"&gt;EXPLAIN
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ SQL ä¸­ &lt;code&gt;EXPLAIN&lt;/code&gt; å‘½ä»¤çš„å…¨é¢è§£æï¼Œæ¶µç›–å…¶ä½œç”¨ã€è¾“å‡ºå­—æ®µè¯¦è§£ã€æ€§èƒ½ä¼˜åŒ–åœºæ™¯åŠå®é™…åº”ç”¨æ¡ˆä¾‹ï¼Œç»“åˆ MySQL å®ç°ï¼ˆå…¶ä»–æ•°æ®åº“é€»è¾‘ç±»ä¼¼ä½†è¯­æ³•ç•¥æœ‰å·®å¼‚ï¼‰ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-explain-çš„ä½œç”¨"&gt;âš™ï¸ &lt;code&gt;EXPLAIN&lt;/code&gt; çš„ä½œç”¨
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;EXPLAIN&lt;/code&gt; ç”¨äºè·å– SQL æŸ¥è¯¢çš„&lt;strong&gt;æ‰§è¡Œè®¡åˆ’&lt;/strong&gt;ï¼ˆQuery Execution Planï¼‰ï¼Œæ­ç¤ºæ•°æ®åº“å¦‚ä½•æ‰§è¡ŒæŸ¥è¯¢ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ä½¿ç”¨æƒ…å†µ&lt;/strong&gt;ï¼ˆæ˜¯å¦ä½¿ç”¨ã€ä½¿ç”¨å“ªäº›ç´¢å¼•ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡¨è¿æ¥é¡ºåºä¸æ–¹å¼&lt;/strong&gt;ï¼ˆJOIN ç­–ç•¥ï¼‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢„ä¼°æ‰«æè¡Œæ•°&lt;/strong&gt;ï¼ˆ&lt;code&gt;rows&lt;/code&gt; å­—æ®µï¼‰&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ½œåœ¨æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;ï¼ˆå¦‚å…¨è¡¨æ‰«æã€ä¸´æ—¶è¡¨ã€æ–‡ä»¶æ’åºï¼‰&lt;a class="link" href="@ref" &gt;10,7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-explain-è¾“å‡ºå­—æ®µè¯¦è§£"&gt;ğŸ” &lt;code&gt;EXPLAIN&lt;/code&gt; è¾“å‡ºå­—æ®µè¯¦è§£
&lt;/h3&gt;&lt;p&gt;ä»¥ MySQL ä¸ºä¾‹ï¼Œ&lt;code&gt;EXPLAIN&lt;/code&gt; è¾“å‡ºåŒ…å«ä»¥ä¸‹æ ¸å¿ƒå­—æ®µï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å­—æ®µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…³é”®å€¼ç¤ºä¾‹ä¸æ„ä¹‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;id&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢åºåˆ—å·ï¼Œæ ‡è¯†æ‰§è¡Œé¡ºåºã€‚ç›¸åŒ &lt;code&gt;id&lt;/code&gt; æŒ‰é¡ºåºæ‰§è¡Œï¼›ä¸åŒ &lt;code&gt;id&lt;/code&gt; å€¼è¶Šå¤§è¶Šå…ˆæ‰§è¡Œã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;id=1&lt;/code&gt;ï¼ˆä¸»æŸ¥è¯¢ï¼‰ã€&lt;code&gt;id=2&lt;/code&gt;ï¼ˆå­æŸ¥è¯¢ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;select_type&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢ç±»å‹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SIMPLE&lt;/code&gt;ï¼ˆæ— å­æŸ¥è¯¢ï¼‰ã€&lt;code&gt;PRIMARY&lt;/code&gt;ï¼ˆå¤–å±‚æŸ¥è¯¢ï¼‰ã€&lt;code&gt;SUBQUERY&lt;/code&gt;ï¼ˆå­æŸ¥è¯¢ï¼‰ã€&lt;code&gt;DERIVED&lt;/code&gt;ï¼ˆæ´¾ç”Ÿè¡¨ï¼‰&lt;a class="link" href="@ref" &gt;5,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;table&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å½“å‰æ“ä½œçš„è¡¨å&lt;/td&gt;
&lt;td&gt;&lt;code&gt;users&lt;/code&gt;ï¼ˆå®é™…è¡¨ï¼‰ã€&lt;code&gt;&amp;lt;derived2&amp;gt;&lt;/code&gt;ï¼ˆæ´¾ç”Ÿè¡¨ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;type&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è®¿é—®ç±»å‹ï¼ˆæ€§èƒ½å…³é”®æŒ‡æ ‡ï¼‰&lt;/strong&gt; ä»ä¼˜åˆ°åŠ£æ’åºï¼š&lt;/td&gt;
&lt;td&gt;&lt;code&gt;const&lt;/code&gt; &amp;gt; &lt;code&gt;eq_ref&lt;/code&gt; &amp;gt; &lt;code&gt;ref&lt;/code&gt; &amp;gt; &lt;code&gt;range&lt;/code&gt; &amp;gt; &lt;code&gt;index&lt;/code&gt; &amp;gt; &lt;code&gt;ALL&lt;/code&gt;ï¼ˆå…¨è¡¨æ‰«æéœ€ä¼˜åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;possible_keys&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½ä½¿ç”¨çš„ç´¢å¼•&lt;/td&gt;
&lt;td&gt;&lt;code&gt;idx_age&lt;/code&gt;ï¼ˆå€™é€‰ç´¢å¼•åˆ—è¡¨ï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;key&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å®é™…ä½¿ç”¨çš„ç´¢å¼•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;idx_email&lt;/code&gt;ï¼ˆè‹¥ä¸º &lt;code&gt;NULL&lt;/code&gt; è¡¨ç¤ºæœªç”¨ç´¢å¼•ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;key_len&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç´¢å¼•ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œåæ˜ ç´¢å¼•åˆ©ç”¨ç¨‹åº¦&lt;/td&gt;
&lt;td&gt;&lt;code&gt;4&lt;/code&gt;ï¼ˆINT ç±»å‹ï¼‰ã€&lt;code&gt;152&lt;/code&gt;ï¼ˆVARCHAR(50) UTF8 ç´¢å¼•ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;rows&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é¢„ä¼°æ‰«æè¡Œæ•°&lt;/strong&gt;ï¼ˆè¶Šå°è¶Šå¥½ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;rows=1&lt;/code&gt;ï¼ˆé«˜æ•ˆï¼‰ã€&lt;code&gt;rows=10000&lt;/code&gt;ï¼ˆéœ€ä¼˜åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;filtered&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿”å›ç»“æœå æ‰«æè¡Œæ•°çš„ç™¾åˆ†æ¯”ï¼ˆMySQL 5.7+ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;filtered=100.00&lt;/code&gt;ï¼ˆå®Œå…¨åŒ¹é…ï¼‰ã€&lt;code&gt;filtered=10.00&lt;/code&gt;ï¼ˆä»… 10% æœ‰æ•ˆï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;Extra&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é¢å¤–æ‰§è¡Œä¿¡æ¯&lt;/strong&gt;ï¼ˆä¼˜åŒ–å…³é”®çº¿ç´¢ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Using index&lt;/code&gt;ï¼ˆè¦†ç›–ç´¢å¼•ï¼‰ã€&lt;code&gt;Using temporary&lt;/code&gt;ï¼ˆä¸´æ—¶è¡¨ï¼‰ã€&lt;code&gt;Using filesort&lt;/code&gt;ï¼ˆæ–‡ä»¶æ’åºéœ€ä¼˜åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®å­—æ®µæ·±åº¦è§£æ"&gt;ğŸš€ å…³é”®å­—æ®µæ·±åº¦è§£æ
&lt;/h3&gt;&lt;h4 id="type"&gt;&lt;strong&gt;&lt;code&gt;type&lt;/code&gt; è®¿é—®ç±»å‹ï¼ˆæ€§èƒ½æ ¸å¿ƒï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;const&lt;/code&gt;&lt;/strong&gt;ï¼šä¸»é”®/å”¯ä¸€ç´¢å¼•çš„ç­‰å€¼æŸ¥è¯¢ï¼ˆ&lt;code&gt;WHERE id = 1&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;eq_ref&lt;/code&gt;&lt;/strong&gt;ï¼šJOIN æ—¶ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•ï¼ˆ&lt;code&gt;ON t1.id = t2.id&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ref&lt;/code&gt;&lt;/strong&gt;ï¼šéå”¯ä¸€ç´¢å¼•çš„ç­‰å€¼æŸ¥è¯¢ï¼ˆ&lt;code&gt;WHERE name = 'Alice'&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;range&lt;/code&gt;&lt;/strong&gt;ï¼šç´¢å¼•èŒƒå›´æ‰«æï¼ˆ&lt;code&gt;BETWEEN&lt;/code&gt;ã€&lt;code&gt;&amp;gt;&lt;/code&gt;ã€&lt;code&gt;IN&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ALL&lt;/code&gt;&lt;/strong&gt;ï¼šå…¨è¡¨æ‰«æï¼ˆæ— ç´¢å¼•ï¼Œå¿…é¡»ä¼˜åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ä¼˜åŒ–ç›®æ ‡&lt;/strong&gt;ï¼šè‡³å°‘è¾¾åˆ° &lt;code&gt;range&lt;/code&gt; çº§åˆ«ï¼Œç†æƒ³çŠ¶æ€ä¸º &lt;code&gt;ref&lt;/code&gt; æˆ– &lt;code&gt;eq_ref&lt;/code&gt;&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id="extra"&gt;&lt;strong&gt;&lt;code&gt;Extra&lt;/code&gt; å­—æ®µå¸¸è§å€¼&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Using index&lt;/code&gt;&lt;/strong&gt;ï¼šè¦†ç›–ç´¢å¼•ï¼ˆæ— éœ€å›è¡¨æŸ¥æ•°æ®ï¼‰ï¼Œæ€§èƒ½æœ€ä¼˜&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Using where&lt;/code&gt;&lt;/strong&gt;ï¼šServer å±‚å¯¹å­˜å‚¨å¼•æ“è¿”å›çš„æ•°æ®è¿›è¡Œè¿‡æ»¤&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Using temporary&lt;/code&gt;&lt;/strong&gt;ï¼šä½¿ç”¨ä¸´æ—¶è¡¨ï¼ˆå¸¸è§äº &lt;code&gt;GROUP BY&lt;/code&gt;ã€&lt;code&gt;UNION&lt;/code&gt;ï¼‰ï¼Œéœ€ä¼˜åŒ–&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Using filesort&lt;/code&gt;&lt;/strong&gt;ï¼šé¢å¤–æ’åºï¼ˆ&lt;code&gt;ORDER BY&lt;/code&gt; æœªç”¨ç´¢å¼•ï¼‰ï¼Œå»ºè®®ä¸ºæ’åºå­—æ®µåŠ ç´¢å¼•&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–å®æˆ˜æ¡ˆä¾‹"&gt;âš¡ï¸ ä¼˜åŒ–å®æˆ˜æ¡ˆä¾‹
&lt;/h3&gt;&lt;h4 id="åœºæ™¯-1é¿å…å…¨è¡¨æ‰«æ"&gt;&lt;strong&gt;åœºæ™¯ 1ï¼šé¿å…å…¨è¡¨æ‰«æ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼štype=ALLï¼Œkey=NULL
&lt;pre tabindex="0"&gt;&lt;code&gt;EXPLAIN SELECT * FROM users WHERE phone = &amp;#39;123456789&amp;#39;; -- phone æ— ç´¢å¼•
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–ï¼šä¸º phone æ·»åŠ ç´¢å¼•
&lt;pre tabindex="0"&gt;&lt;code&gt;ALTER TABLE users ADD INDEX idx_phone(phone); -- ç±»å‹å˜ä¸º `ref`[8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åœºæ™¯-2æ¶ˆé™¤æ–‡ä»¶æ’åº"&gt;&lt;strong&gt;åœºæ™¯ 2ï¼šæ¶ˆé™¤æ–‡ä»¶æ’åº&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼šExtra=Using filesort
&lt;pre tabindex="0"&gt;&lt;code&gt;EXPLAIN SELECT * FROM products ORDER BY price; -- price æ— ç´¢å¼•
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–ï¼šä¸º price åˆ›å»ºç´¢å¼•
&lt;pre tabindex="0"&gt;&lt;code&gt;ALTER TABLE products ADD INDEX idx_price(price); -- æ’åºåˆ©ç”¨ç´¢å¼•ï¼Œé¿å… `filesort`[9](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åœºæ™¯-3åˆ©ç”¨è¦†ç›–ç´¢å¼•"&gt;&lt;strong&gt;åœºæ™¯ 3ï¼šåˆ©ç”¨è¦†ç›–ç´¢å¼•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼šæŸ¥è¯¢éœ€å›è¡¨ï¼ˆ
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT *
&lt;/code&gt;&lt;/pre&gt;å¯¼è‡´ç´¢å¼•æœªè¦†ç›–ï¼‰
&lt;pre tabindex="0"&gt;&lt;code&gt;EXPLAIN SELECT name, age FROM users WHERE department = &amp;#39;IT&amp;#39;; -- éœ€å›è¡¨æŸ¥ name/age
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–ï¼šåˆ›å»ºå¤åˆç´¢å¼•
&lt;pre tabindex="0"&gt;&lt;code&gt;ALTER TABLE users ADD INDEX idx_dep_name_age(department, name, age); -- Extra æ˜¾ç¤º `Using index`[5](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸åŒæ•°æ®åº“çš„-explain-å®ç°"&gt;ğŸŒ ä¸åŒæ•°æ®åº“çš„ &lt;code&gt;EXPLAIN&lt;/code&gt; å®ç°
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®åº“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;MySQL&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXPLAIN SELECT ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒ &lt;code&gt;FORMAT=JSON&lt;/code&gt;ã€&lt;code&gt;EXPLAIN ANALYZE&lt;/code&gt;ï¼ˆå®é™…æ‰§è¡Œï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PostgreSQL&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXPLAIN ANALYZE SELECT ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¾“å‡ºè¯¦ç»†æ‰§è¡Œæ—¶é—´åŠèµ„æºæ¶ˆè€—&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Oracle&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXPLAIN PLAN FOR SELECT ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç»“æœå­˜å…¥ &lt;code&gt;PLAN_TABLE&lt;/code&gt;ï¼Œéœ€ç”¨ &lt;code&gt;DBMS_XPLAN&lt;/code&gt; æŸ¥çœ‹&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL Server&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SET STATISTICS PROFILE ON&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰§è¡ŒåæŸ¥çœ‹æ¶ˆæ¯è¾“å‡º&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸æœ€ä½³å®è·µ"&gt;ğŸ’ æ€»ç»“ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ ¸å¿ƒå…³æ³¨ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;type&lt;/code&gt; é¿å… &lt;code&gt;ALL&lt;/code&gt; å’Œ &lt;code&gt;index&lt;/code&gt;ï¼Œè¿½æ±‚ &lt;code&gt;ref&lt;/code&gt; æˆ– &lt;code&gt;eq_ref&lt;/code&gt;&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Extra&lt;/code&gt; è­¦æƒ• &lt;code&gt;Using temporary&lt;/code&gt; å’Œ &lt;code&gt;Using filesort&lt;/code&gt;&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rows&lt;/code&gt; å’Œ &lt;code&gt;filtered&lt;/code&gt; è¯„ä¼°æ•°æ®è¿‡æ»¤æ•ˆç‡&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹æ…¢æŸ¥è¯¢ä½¿ç”¨ &lt;code&gt;EXPLAIN&lt;/code&gt; å®šä½ç“¶é¢ˆ â†’ é’ˆå¯¹æ€§æ·»åŠ /è°ƒæ•´ç´¢å¼• â†’ é‡å†™æŸ¥è¯¢ï¼ˆå¦‚é¿å… &lt;code&gt;SELECT *&lt;/code&gt;ï¼‰â†’ éªŒè¯ä¼˜åŒ–æ•ˆæœ&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é«˜é˜¶å·¥å…·ï¼š
&lt;ul&gt;
&lt;li&gt;MySQL 8.0+ ä½¿ç”¨ &lt;code&gt;EXPLAIN ANALYZE&lt;/code&gt; è·å–å®é™…æ‰§è¡Œæ—¶é—´&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç»“åˆæ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆ&lt;code&gt;slow_query_log&lt;/code&gt;ï¼‰å®šæœŸåˆ†æé«˜é¢‘ SQL&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“š å®Œæ•´ç¤ºä¾‹ä¸è¿›é˜¶æŠ€å·§å¯å‚è€ƒï¼š&lt;a class="link" href="https://dev.mysql.com/doc/refman/8.0/en/explain.html" target="_blank" rel="noopener"
&gt;MySQL EXPLAIN å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="extra-1"&gt;Extra
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å¯¹ MySQL ä¸­ &lt;code&gt;Using temporary&lt;/code&gt; å’Œ &lt;code&gt;Using filesort&lt;/code&gt; çš„è¯¦ç»†è§£é‡Šï¼ŒåŒ…æ‹¬å…¶äº§ç”ŸåŸå› ã€æ€§èƒ½å½±å“åŠä¼˜åŒ–ç­–ç•¥ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-using-temporary"&gt;ğŸ”§ &lt;strong&gt;Using Temporary&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å®šä¹‰ä¸è§¦å‘åœºæ™¯"&gt;&lt;strong&gt;å®šä¹‰ä¸è§¦å‘åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å«ä¹‰&lt;/strong&gt;ï¼šè¡¨ç¤º MySQL ä¸ºäº†æ‰§è¡ŒæŸ¥è¯¢ &lt;strong&gt;åˆ›å»ºäº†å†…éƒ¨ä¸´æ—¶è¡¨&lt;/strong&gt;ï¼ˆéç”¨æˆ·æ˜¾å¼åˆ›å»ºï¼‰ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨ä¸­é—´ç»“æœ&lt;a class="link" href="@ref" &gt;1,3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¸¸è§è§¦å‘åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;GROUP BY&lt;/code&gt; æˆ– &lt;code&gt;DISTINCT&lt;/code&gt; æ“ä½œï¼ˆå°¤å…¶å­—æ®µæ— ç´¢å¼•ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;UNION&lt;/code&gt; æŸ¥è¯¢ï¼ˆéœ€åˆå¹¶ç»“æœé›†å»é‡ï¼‰
&lt;ul&gt;
&lt;li&gt;å­æŸ¥è¯¢æˆ–æ´¾ç”Ÿè¡¨ï¼ˆ&lt;code&gt;DERIVED&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤šè¡¨è¿æ¥ä¸­ &lt;code&gt;ORDER BY&lt;/code&gt; çš„åˆ—ä¸åœ¨é©±åŠ¨è¡¨&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ€§èƒ½å½±å“"&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å†…å­˜ vs ç£ç›˜ï¼š
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨&lt;strong&gt;å†…å­˜ä¸´æ—¶è¡¨&lt;/strong&gt;ï¼ˆå— &lt;code&gt;tmp_table_size&lt;/code&gt; å’Œ &lt;code&gt;max_heap_table_size&lt;/code&gt; é™åˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®é‡è¶…é™æ—¶è½¬ä¸º&lt;strong&gt;ç£ç›˜ä¸´æ—¶è¡¨&lt;/strong&gt;ï¼ˆé»˜è®¤ MyISAM å¼•æ“ï¼‰ï¼Œå¼•å‘ç£ç›˜ I/Oï¼Œæ€§èƒ½éª¤é™&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æ§æŒ‡æ ‡ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;created_tmp_tables&lt;/code&gt;ï¼šå†…å­˜ä¸´æ—¶è¡¨åˆ›å»ºæ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;created_tmp_disk_tables&lt;/code&gt;ï¼šç£ç›˜ä¸´æ—¶è¡¨åˆ›å»ºæ¬¡æ•°ã€‚è‹¥æ¯”å€¼è¿‡é«˜éœ€ä¼˜åŒ–&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¼˜åŒ–ç­–ç•¥"&gt;&lt;strong&gt;ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…·ä½“æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç´¢å¼•ä¼˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸º &lt;code&gt;GROUP BY&lt;/code&gt;/&lt;code&gt;DISTINCT&lt;/code&gt; å­—æ®µæ·»åŠ ç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;ALTER TABLE device ADD INDEX idx_name(device_name)&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ”¹å†™æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨ &lt;code&gt;UNION ALL&lt;/code&gt; æ›¿ä»£ &lt;code&gt;UNION&lt;/code&gt;ï¼ˆé¿å…å»é‡ï¼‰ï¼›&lt;code&gt;GROUP BY&lt;/code&gt; ååŠ  &lt;code&gt;ORDER BY NULL&lt;/code&gt;ï¼ˆå–æ¶ˆé»˜è®¤æ’åºï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒæ•´å‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¢å¤§ &lt;code&gt;tmp_table_size&lt;/code&gt; å’Œ &lt;code&gt;max_heap_table_size&lt;/code&gt;ï¼ˆéœ€è¯„ä¼°å†…å­˜ï¼Œé¿å… OOMï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼ºåˆ¶ç£ç›˜ä¸´æ—¶è¡¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹å¤§æ•°æ®é‡èšåˆä½¿ç”¨ &lt;code&gt;SQL_BIG_RESULT&lt;/code&gt; æç¤ºï¼ˆå¦‚ &lt;code&gt;SELECT SQL_BIG_RESULT ...&lt;/code&gt;ï¼‰ï¼Œè·³è¿‡å†…å­˜ç›´æ¥ä½¿ç”¨ç£ç›˜&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼š
å¯¹ 10 ä¸‡è¡Œ &lt;code&gt;device&lt;/code&gt; è¡¨æŒ‰ &lt;code&gt;device_name&lt;/code&gt;ï¼ˆ5 ä¸‡å”¯ä¸€å€¼ï¼‰åˆ†ç»„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœªä¼˜åŒ–&lt;/strong&gt;ï¼šå…¨è¡¨æ‰«æ â†’ å†…å­˜ä¸è¶³è½¬ç£ç›˜ â†’ æ‰§è¡Œæ—¶é—´ 5 ç§’ï¼ŒCPU 99%&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–å&lt;/strong&gt;ï¼šä¸º &lt;code&gt;device_name&lt;/code&gt; åŠ ç´¢å¼• â†’ é¿å…ä¸´æ—¶è¡¨ â†’ æ‰§è¡Œæ—¶é—´é™è‡³æ¯«ç§’çº§ï¼ŒCPU é™è‡³ 10%&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-using-filesort"&gt;ğŸ“‚ &lt;strong&gt;Using Filesort&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å®šä¹‰ä¸è§¦å‘åœºæ™¯-1"&gt;&lt;strong&gt;å®šä¹‰ä¸è§¦å‘åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å«ä¹‰&lt;/strong&gt;ï¼šè¡¨ç¤º MySQL &lt;strong&gt;æ— æ³•ç”¨ç´¢å¼•å®Œæˆæ’åº&lt;/strong&gt;ï¼Œéœ€é¢å¤–æ‰§è¡Œæ’åºç®—æ³•ï¼ˆå³ä½¿æœªå†™å…¥ç£ç›˜ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¸¸è§è§¦å‘åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ORDER BY&lt;/code&gt; å­—æ®µæœªå»ºç«‹ç´¢å¼•æˆ–ç´¢å¼•ä¸åŒ¹é…ï¼ˆå¦‚è”åˆç´¢å¼•æœªæ»¡è¶³æœ€å·¦å‰ç¼€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹ç´¢å¼•å­—æ®µä½¿ç”¨å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;ORDER BY DATE(create_time)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤šåˆ—æ’åºæ—¶ç´¢å¼•å­—æ®µé¡ºåºä¸ &lt;code&gt;ORDER BY&lt;/code&gt; ä¸ä¸€è‡´&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ’åºç®—æ³•ä¸æ€§èƒ½"&gt;&lt;strong&gt;æ’åºç®—æ³•ä¸æ€§èƒ½&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç®—æ³•ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒè·¯æ’åº&lt;/strong&gt;ï¼ˆæ—§ï¼‰&lt;/td&gt;
&lt;td&gt;å…ˆå–æ’åºå­—æ®µ + ä¸»é”® â†’ æ’åº â†’ æŒ‰ä¸»é”®å›è¡¨æŸ¥æ•°æ®ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸¤æ¬¡ç£ç›˜ I/O&lt;/strong&gt;ï¼Œæ•ˆç‡ä½&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å•è·¯æ’åº&lt;/strong&gt;ï¼ˆæ–°ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰å­—æ®µ â†’ æ’åºï¼ˆé¿å…å›è¡¨ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;å†…å­˜å ç”¨é«˜ï¼Œä½†å‡å°‘ I/O&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©ä¾æ®&lt;/strong&gt;ï¼šç”± &lt;code&gt;sort_buffer_size&lt;/code&gt; å’Œå­—æ®µæ€»å¤§å°å†³å®šï¼Œä¼˜å…ˆå•è·¯æ’åº&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¼˜åŒ–ç­–ç•¥-1"&gt;&lt;strong&gt;ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…·ä½“æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç´¢å¼•ä¼˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸º &lt;code&gt;ORDER BY&lt;/code&gt; å­—æ®µå»ºç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;CREATE INDEX idx_price ON products(price)&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è”åˆç´¢å¼•è®¾è®¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹ &lt;code&gt;WHERE + ORDER BY&lt;/code&gt; åœºæ™¯å»ºè”åˆç´¢å¼•ï¼Œç¡®ä¿æ’åºå­—æ®µæ»¡è¶³æœ€å·¦å‰ç¼€ï¼ˆå¦‚ &lt;code&gt;(department, salary)&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¦†ç›–ç´¢å¼•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…æŸ¥è¯¢ç´¢å¼•å­—æ®µï¼ˆå¦‚ &lt;code&gt;SELECT id, name&lt;/code&gt;ï¼‰ï¼Œé¿å…å›è¡¨å¹¶åˆ©ç”¨ç´¢å¼•æ’åº&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°è°ƒæ•´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¢å¤§ &lt;code&gt;sort_buffer_size&lt;/code&gt;ï¼ˆæå‡å†…å­˜æ’åºèƒ½åŠ›ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼š
å¯¹ &lt;code&gt;products&lt;/code&gt; è¡¨æŒ‰ &lt;code&gt;price&lt;/code&gt; æ’åºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœªä¼˜åŒ–&lt;/strong&gt;ï¼š&lt;code&gt;type=ALL, Extra=Using filesort&lt;/code&gt; â†’ å…¨è¡¨æ‰«æ + æ–‡ä»¶æ’åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–å&lt;/strong&gt;ï¼šä¸º &lt;code&gt;price&lt;/code&gt; åŠ ç´¢å¼• â†’ &lt;code&gt;type=index, Extra=NULL&lt;/code&gt;ï¼ˆç´¢å¼•å¤©ç„¶æœ‰åºï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-using-temporary-vs-using-filesort-å¯¹æ¯”"&gt;ğŸ” &lt;strong&gt;Using Temporary vs Using Filesort å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹å¾&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Using Temporary&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Using Filesort&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºä¸´æ—¶è¡¨å­˜å‚¨ä¸­é—´ç»“æœ&lt;/td&gt;
&lt;td&gt;é¢å¤–æ’åºæ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦è§¦å‘æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;GROUP BY&lt;/code&gt;, &lt;code&gt;UNION&lt;/code&gt;, æ´¾ç”Ÿè¡¨&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ORDER BY&lt;/code&gt;ï¼ˆç´¢å¼•å¤±æ•ˆæ—¶ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼˜åŒ–ä¼˜å…ˆçº§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ ç´¢å¼• &amp;gt; è°ƒå‚æ•° &amp;gt; æ”¹å†™ SQL&lt;/td&gt;
&lt;td&gt;åŠ ç´¢å¼• &amp;gt; è®¾è®¡è”åˆç´¢å¼• &amp;gt; è¦†ç›–ç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†…å­˜è½¬ç£ç›˜ï¼ˆI/O å‹åŠ›ï¼‰&lt;/td&gt;
&lt;td&gt;ç£ç›˜ I/O æˆ–å†…å­˜ä¸è¶³ï¼ˆåŒè·¯æ’åºï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸æœ€ä½³å®è·µ-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;é¿å… &lt;code&gt;ALL&lt;/code&gt; å…¨è¡¨æ‰«æ â†’ é€šè¿‡ç´¢å¼•å‡å°‘æ•°æ®æ‰«æé‡&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¶ˆé™¤ &lt;code&gt;Using temporary&lt;/code&gt; â†’ ç¡®ä¿èšåˆå­—æ®µæœ‰ç´¢å¼•ï¼Œé¿å…ä¸­é—´è¡¨&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¶ˆé™¤ &lt;code&gt;Using filesort&lt;/code&gt; â†’ ç´¢å¼•éœ€è¦†ç›–æ’åºå­—æ®µä¸”æ»¡è¶³æœ€å·¦å‰ç¼€&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯Šæ–­å·¥å…·&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;EXPLAIN&lt;/code&gt; æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼Œå…³æ³¨ &lt;code&gt;type&lt;/code&gt; å’Œ &lt;code&gt;Extra&lt;/code&gt; å­—æ®µ&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç»“åˆ &lt;code&gt;EXPLAIN ANALYZE&lt;/code&gt;ï¼ˆMySQL 8.0+ï¼‰è·å–å®é™…æ‰§è¡Œæ—¶é—´&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»ˆæåŸåˆ™&lt;/strong&gt;ï¼š
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç´¢å¼•æ˜¯è§£å†³ä¸´æ—¶è¡¨ä¸æ–‡ä»¶æ’åºçš„æœ€æœ‰æ•ˆæ‰‹æ®µ&lt;/strong&gt;ï¼Œä½†éœ€æƒè¡¡å†™å…¥æ€§èƒ½ä¸å­˜å‚¨æˆæœ¬ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ç´¢å¼•è¯„ä¼°"&gt;ç´¢å¼•è¯„ä¼°
&lt;/h2&gt;&lt;p&gt;è¯„ä¼°æ•°æ®åº“ç´¢å¼•æ˜¯å¦ç”Ÿæ•ˆæ˜¯ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½çš„å…³é”®æ­¥éª¤ã€‚ä»¥ä¸‹ç»¼åˆå¤šç§æ–¹æ³•è¿›è¡Œç³»ç»Ÿåˆ†æï¼Œæ¶µç›–æ‰§è¡Œè®¡åˆ’æ£€æŸ¥ã€ç»Ÿè®¡ç›‘æ§ã€æ—¥å¿—åˆ†æåŠå¸¸è§å¤±æ•ˆåœºæ™¯æ’æŸ¥ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡Œè®¡åˆ’åˆ†ææ ¸å¿ƒæ–¹æ³•"&gt;ğŸ” æ‰§è¡Œè®¡åˆ’åˆ†æï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰
&lt;/h3&gt;&lt;p&gt;é€šè¿‡ &lt;code&gt;EXPLAIN&lt;/code&gt; æˆ– &lt;code&gt;EXPLAIN ANALYZE&lt;/code&gt; å‘½ä»¤æŸ¥çœ‹æŸ¥è¯¢ä¼˜åŒ–å™¨é€‰æ‹©çš„æ‰§è¡Œè®¡åˆ’ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®å­—æ®µè§£è¯»&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;type&lt;/code&gt;&lt;/strong&gt;ï¼šè®¿é—®ç±»å‹ã€‚è‹¥å€¼ä¸º &lt;code&gt;index&lt;/code&gt;ã€&lt;code&gt;range&lt;/code&gt;ã€&lt;code&gt;ref&lt;/code&gt; æˆ– &lt;code&gt;const&lt;/code&gt;ï¼Œè¯´æ˜ä½¿ç”¨äº†ç´¢å¼•ï¼›è‹¥ä¸º &lt;code&gt;ALL&lt;/code&gt;ï¼Œåˆ™å…¨è¡¨æ‰«æï¼ˆç´¢å¼•æœªç”Ÿæ•ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;key&lt;/code&gt;&lt;/strong&gt;ï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•åç§°ã€‚è‹¥ä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼Œç´¢å¼•æœªç”Ÿæ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;rows&lt;/code&gt;&lt;/strong&gt;ï¼šæ‰«æè¡Œæ•°ã€‚å€¼è¶Šå¤§ï¼Œå…¨è¡¨æ‰«æé£é™©è¶Šé«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Extra&lt;/code&gt;&lt;/strong&gt;ï¼šè‹¥æ˜¾ç¤º &lt;code&gt;Using index&lt;/code&gt;ï¼Œè¡¨ç¤ºè¦†ç›–ç´¢å¼•ç”Ÿæ•ˆï¼ˆæ— éœ€å›è¡¨ï¼‰ï¼›è‹¥ä¸º &lt;code&gt;Using where; Using index&lt;/code&gt;ï¼Œç´¢å¼•éƒ¨åˆ†ç”Ÿæ•ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œç¤ºä¾‹&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;EXPLAIN SELECT * FROM orders WHERE user_id = 100;
-- è§‚å¯Ÿ key å’Œ type å­—æ®µ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç´¢å¼•ä½¿ç”¨ç»Ÿè®¡ç›‘æ§"&gt;ğŸ“Š ç´¢å¼•ä½¿ç”¨ç»Ÿè®¡ç›‘æ§
&lt;/h3&gt;&lt;p&gt;é€šè¿‡ç³»ç»Ÿè¡¨è¿½è¸ªç´¢å¼•çš„å®é™…ä½¿ç”¨é¢‘ç‡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;MySQL&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- æŸ¥çœ‹ç´¢å¼•çš„è¯»å–/è·å–æ¬¡æ•°
SELECT object_name, index_name, count_read, COUNT_FETCH
FROM performance_schema.table_io_waits_summary_by_index_usage
WHERE object_name = &amp;#39;your_table&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;è‹¥ &lt;code&gt;count_read&lt;/code&gt; å’Œ &lt;code&gt;COUNT_FETCH&lt;/code&gt; é•¿æœŸä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œç´¢å¼•å¯èƒ½æœªè¢«ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Oracle/PLSQL&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT index_name, is_ind_used FROM dba_indexes
WHERE owner = &amp;#39;your_schema&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æ"&gt;âš ï¸ æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æ
&lt;/h3&gt;&lt;p&gt;å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œæ•æ‰æœªç”¨ç´¢å¼•çš„æŸ¥è¯¢ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é…ç½®æ–¹æ³•ï¼ˆMySQLï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;slow_query_log = ON
long_query_time = 2 # å®šä¹‰æ…¢æŸ¥è¯¢é˜ˆå€¼ï¼ˆç§’ï¼‰
log_queries_not_using_indexes = ON # è®°å½•æœªç”¨ç´¢å¼•çš„æŸ¥è¯¢
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ææ—¥å¿—&lt;/strong&gt;ï¼š
å®šæœŸæ£€æŸ¥æ—¥å¿—ä¸­è®°å½•çš„æ…¢æŸ¥è¯¢ï¼Œç¡®è®¤æ˜¯å¦å› ç´¢å¼•å¤±æ•ˆå¯¼è‡´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç´¢å¼•å¤±æ•ˆåœºæ™¯æ’æŸ¥"&gt;ğŸš« ç´¢å¼•å¤±æ•ˆåœºæ™¯æ’æŸ¥
&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹æƒ…å†µå¯èƒ½å¯¼è‡´ç´¢å¼•æœªç”Ÿæ•ˆï¼ˆéœ€ä¼˜åŒ–æŸ¥è¯¢æˆ–ç´¢å¼•è®¾è®¡ï¼‰ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹/åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;LIKE é€šé…ç¬¦å¼€å¤´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WHERE name LIKE '%abc'&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ”¹ç”¨åç¼€åŒ¹é…ï¼ˆ&lt;code&gt;'abc%'&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯¹ç´¢å¼•åˆ—ä½¿ç”¨å‡½æ•°/è®¡ç®—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WHERE YEAR(create_time) = 2023&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é¿å…åˆ—å‚ä¸è¿ç®—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OR è¿æ¥éç´¢å¼•åˆ—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WHERE id = 100 OR age &amp;gt; 30&lt;/code&gt;ï¼ˆè‹¥ &lt;code&gt;age&lt;/code&gt; æ— ç´¢å¼•ï¼‰&lt;/td&gt;
&lt;td&gt;æ‹†åˆ†æŸ¥è¯¢æˆ–ç”¨ &lt;code&gt;UNION&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ç±»å‹ä¸åŒ¹é…&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WHERE phone = 13800138000&lt;/code&gt;ï¼ˆ&lt;code&gt;phone&lt;/code&gt; ä¸º &lt;code&gt;varchar&lt;/code&gt;ï¼Œä¼ å…¥æ•°å€¼ï¼‰&lt;/td&gt;
&lt;td&gt;ä¿æŒç±»å‹ä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»„åˆç´¢å¼•æœªç”¨æœ€å·¦å‰ç¼€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç´¢å¼• &lt;code&gt;(a,b,c)&lt;/code&gt;ï¼ŒæŸ¥è¯¢æ¡ä»¶ç¼ºå¤± &lt;code&gt;a&lt;/code&gt; åˆ—ï¼ˆå¦‚ &lt;code&gt;WHERE b=1&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;è°ƒæ•´ç´¢å¼•é¡ºåºæˆ–æŸ¥è¯¢æ¡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç´¢å¼•æœ‰æ•ˆæ€§éªŒè¯å·¥å…·"&gt;âš™ï¸ ç´¢å¼•æœ‰æ•ˆæ€§éªŒè¯å·¥å…·
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;SHOW INDEX&lt;/code&gt;&lt;/strong&gt;ï¼š
æŸ¥çœ‹ç´¢å¼•çŠ¶æ€å’Œç±»å‹ï¼ˆå¦‚ &lt;code&gt;BTREE&lt;/code&gt; æ˜¯å¦æ­£å¸¸ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“æ€§èƒ½åˆ†æå™¨ï¼š
&lt;ul&gt;
&lt;li&gt;MySQL Performance Schemaï¼šè¿½è¸ªç´¢å¼• I/O å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;Percona Toolkitï¼šåˆ†æç´¢å¼•ä½¿ç”¨ç‡åŠç¢ç‰‡åŒ–ç¨‹åº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–å»ºè®®"&gt;ğŸ’ ä¼˜åŒ–å»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å®šæœŸç»´æŠ¤ç´¢å¼•ï¼š
&lt;ul&gt;
&lt;li&gt;é‡å»ºç¢ç‰‡åŒ–ç´¢å¼•ï¼ˆ&lt;code&gt;ALTER INDEX ... REBUILD&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ï¼ˆ&lt;code&gt;ANALYZE TABLE&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è®¾è®¡åŸåˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…å†—ä½™ç´¢å¼•ï¼Œä¼˜å…ˆä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ˆåŒ…å«æŸ¥è¯¢æ‰€éœ€å…¨éƒ¨å­—æ®µï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹é«˜é€‰æ‹©æ€§å­—æ®µï¼ˆå¦‚ç”¨æˆ·IDï¼‰å»ºç´¢å¼•ï¼Œä½åŸºæ•°å­—æ®µï¼ˆå¦‚æ€§åˆ«ï¼‰é¿å…ç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“æ­¥éª¤"&gt;ğŸ“ æ€»ç»“æ­¥éª¤
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ£€æŸ¥æ‰§è¡Œè®¡åˆ’&lt;/strong&gt; â†’ ç¡®è®¤ &lt;code&gt;type&lt;/code&gt; å’Œ &lt;code&gt;key&lt;/code&gt; å­—æ®µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§ä½¿ç”¨ç»Ÿè®¡&lt;/strong&gt; â†’ ç¡®è®¤ç´¢å¼•æ´»è·ƒåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—&lt;/strong&gt; â†’ å®šä½æœªç”¨ç´¢å¼•çš„ SQLã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’é™¤å¤±æ•ˆåœºæ™¯&lt;/strong&gt; â†’ ä¿®æ­£æŸ¥è¯¢æˆ–ç´¢å¼•è®¾è®¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®šæœŸç»´æŠ¤&lt;/strong&gt; â†’ é‡å»ºç´¢å¼•å¹¶æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ã€‚
é€šè¿‡ä¸Šè¿°æ–¹æ³•ï¼Œå¯ç³»ç»ŸåŒ–è¯Šæ–­ç´¢å¼•æœ‰æ•ˆæ€§ã€‚è‹¥é—®é¢˜å¤æ‚ï¼Œå»ºè®®ç»“åˆæ•°æ®åº“è‡ªå¸¦çš„æ€§èƒ½åˆ†æå·¥å…·ï¼ˆå¦‚ SQL Profilerï¼‰æ·±å…¥è¿½è¸ªã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="count"&gt;count
&lt;/h2&gt;&lt;p&gt;åœ¨ SQL ä¸­ï¼Œ&lt;code&gt;COUNT(*)&lt;/code&gt; å’Œ &lt;code&gt;COUNT(1)&lt;/code&gt; éƒ½ç”¨äºç»Ÿè®¡è¡¨ä¸­çš„è¡Œæ•°ï¼Œä½†ä¸¤è€…å¸¸è¢«è¯¯è§£ä¸ºå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ç»“åˆæ•°æ®åº“ä¼˜åŒ–æœºåˆ¶å’Œå®é™…æµ‹è¯•ï¼Œä»¥ä¸‹æ˜¯å…³é”®ç»“è®ºï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«ä¸å…±æ€§"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«ä¸å…±æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¯­ä¹‰ä¸ç»“æœ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;COUNT(*)&lt;/code&gt;&lt;/strong&gt;ï¼šç»Ÿè®¡è¡¨ä¸­&lt;strong&gt;æ‰€æœ‰è¡Œ&lt;/strong&gt;çš„æ•°é‡ï¼ŒåŒ…æ‹¬æ‰€æœ‰åˆ—å€¼ä¸º &lt;code&gt;NULL&lt;/code&gt; çš„è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;COUNT(1)&lt;/code&gt;&lt;/strong&gt;ï¼šç»Ÿè®¡è¡¨ä¸­&lt;strong&gt;æ‰€æœ‰è¡Œ&lt;/strong&gt;çš„æ•°é‡ï¼Œ&lt;code&gt;1&lt;/code&gt; ä½œä¸ºå¸¸é‡å ä½ç¬¦ï¼Œä¸è¯»å–å…·ä½“åˆ—å€¼ï¼Œç»“æœä¸ &lt;code&gt;COUNT(*)&lt;/code&gt; å®Œå…¨ä¸€è‡´ã€‚
&lt;em&gt;ğŸ‘‰ ä¸¤è€…å‡åŒ…å«æ‰€æœ‰è¡Œï¼Œä¸å­˜åœ¨ç»“æœå·®å¼‚ã€‚&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è¡¨ç°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç°ä»£æ•°æ®åº“ä¼˜åŒ–æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;MySQLï¼ˆInnoDBï¼‰ã€SQL Server ç­‰ä¸»æµæ•°æ®åº“å¯¹ &lt;code&gt;COUNT(*)&lt;/code&gt; å’Œ &lt;code&gt;COUNT(1)&lt;/code&gt; &lt;strong&gt;æ‰§è¡Œç›¸åŒçš„ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;ï¼Œæ€§èƒ½å·®å¼‚å¯å¿½ç•¥ï¼ˆé€šå¸¸ &amp;lt;1%ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚ InnoDB ä¼šä¼˜å…ˆéå†&lt;strong&gt;æœ€å°äºŒçº§ç´¢å¼•&lt;/strong&gt;ï¼ˆè€Œéèšç°‡ç´¢å¼•ï¼‰ç»Ÿè®¡è¡Œæ•°ï¼Œå‡å°‘ I/O å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‰¹æ®Šåœºæ™¯å·®å¼‚ï¼š
&lt;ul&gt;
&lt;li&gt;åœ¨ &lt;em&gt;ææ—§ç‰ˆæœ¬&lt;/em&gt; æˆ– &lt;em&gt;ç‰¹å®šå­˜å‚¨å¼•æ“&lt;/em&gt;ï¼ˆå¦‚ MyISAM æ—  &lt;code&gt;WHERE&lt;/code&gt; æ¡ä»¶æ—¶ï¼‰ä¸­ï¼Œ&lt;code&gt;COUNT(*)&lt;/code&gt; å¯èƒ½ç›´æ¥è¯»å–é¢„å­˜è¡Œæ•°ï¼Œç•¥å¿«äº &lt;code&gt;COUNT(1)&lt;/code&gt;ï¼Œä½†æ­¤æƒ…å†µç½•è§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ &lt;code&gt;COUNT(åˆ—å)&lt;/code&gt; çš„å¯¹æ¯”&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;COUNT(åˆ—å)&lt;/code&gt;&lt;/strong&gt;ï¼šä»…ç»Ÿè®¡è¯¥åˆ—&lt;strong&gt;é NULL å€¼&lt;/strong&gt;çš„è¡Œæ•°ï¼Œéœ€è¯»å–åˆ—æ•°æ®ï¼Œæ€§èƒ½é€šå¸¸ä½äº &lt;code&gt;COUNT(*)&lt;/code&gt; å’Œ &lt;code&gt;COUNT(1)&lt;/code&gt;ï¼ˆå°¤å…¶å½“åˆ—å«å¤§é‡ &lt;code&gt;NULL&lt;/code&gt; æˆ–æœªç´¢å¼•æ—¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ€§èƒ½æ’åºï¼š&lt;code&gt;COUNT(*) â‰ˆ COUNT(1) &amp;gt; COUNT(ä¸»é”®) &amp;gt; COUNT(æ™®é€šç´¢å¼•åˆ—) &amp;gt; COUNT(æœªç´¢å¼•åˆ—)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡ŒåŸç†ç®€æ"&gt;âš™ï¸ &lt;strong&gt;æ‰§è¡ŒåŸç†ç®€æ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;**&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;COUNT(*)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; COUNT(1)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æµç¨‹**ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¼˜åŒ–å™¨é€‰æ‹©æœ€å°äºŒçº§ç´¢å¼•ï¼ˆæˆ–èšç°‡ç´¢å¼•ï¼‰æ‰«æã€‚&lt;/li&gt;
&lt;li&gt;Server å±‚é€è¡Œç´¯åŠ è®¡æ•°å™¨ï¼Œ&lt;strong&gt;ä¸è¯»å–å®é™…åˆ—å€¼&lt;/strong&gt;ï¼ˆ&lt;code&gt;COUNT(1)&lt;/code&gt; çš„ &lt;code&gt;1&lt;/code&gt; ä»…ä½œå ä½ç¬¦ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;COUNT(åˆ—å)
&lt;/code&gt;&lt;/pre&gt;æµç¨‹**ï¼š
&lt;ol&gt;
&lt;li&gt;è¯»å–æŒ‡å®šåˆ—çš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;è¿‡æ»¤ &lt;code&gt;NULL&lt;/code&gt; å€¼åç´¯åŠ ï¼Œå¢åŠ é¢å¤–åˆ¤æ–­å¼€é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½å®æµ‹å¯¹æ¯”innodb-å¼•æ“"&gt;ğŸ“Š &lt;strong&gt;æ€§èƒ½å®æµ‹å¯¹æ¯”ï¼ˆInnoDB å¼•æ“ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;COUNT(1)&lt;/code&gt; è€—æ—¶&lt;/th&gt;
&lt;th&gt;&lt;code&gt;COUNT(*)&lt;/code&gt; è€—æ—¶&lt;/th&gt;
&lt;th&gt;&lt;code&gt;COUNT(id)&lt;/code&gt; è€—æ—¶&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;1000ä¸‡è¡Œå…¨è¡¨æ‰«æ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;4.19s&lt;/td&gt;
&lt;td&gt;4.16s&lt;/td&gt;
&lt;td&gt;4.23s&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç´¢å¼•è¦†ç›–æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;0.9s&lt;/td&gt;
&lt;td&gt;0.8s&lt;/td&gt;
&lt;td&gt;0.7s&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¹¶å‘ï¼ˆ10çº¿ç¨‹ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;34s&lt;/td&gt;
&lt;td&gt;33s&lt;/td&gt;
&lt;td&gt;37s&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ è¦†ç›–ç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;INDEX(status)&lt;/code&gt;ï¼‰å¯æ˜¾è‘—æå‡æ‰€æœ‰ &lt;code&gt;COUNT&lt;/code&gt; æ“ä½œçš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨å»ºè®®"&gt;ğŸ’ &lt;strong&gt;ä½¿ç”¨å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆé€‰æ‹© &lt;code&gt;COUNT(*)&lt;/code&gt;&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è¯­ä¹‰æ˜ç¡®ï¼ˆç»Ÿè®¡æ‰€æœ‰è¡Œï¼‰ï¼Œç¬¦åˆ SQL æ ‡å‡†ï¼Œä»£ç å¯è¯»æ€§é«˜ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ MySQL 8.0+ã€Oracleã€SQL Server ç­‰æ•°æ®åº“ä¸­ï¼Œå…¶ä¼˜åŒ–ç¨‹åº¦ä¸ &lt;code&gt;COUNT(1)&lt;/code&gt; å®Œå…¨ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å… &lt;code&gt;COUNT(åˆ—å)&lt;/code&gt; ç»Ÿè®¡è¡Œæ•°&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä»…éœ€ç»Ÿè®¡è¡Œæ•°æ—¶ï¼Œ&lt;code&gt;COUNT(åˆ—å)&lt;/code&gt; å› é¢å¤–æ£€æŸ¥ &lt;code&gt;NULL&lt;/code&gt; å€¼è€Œæ•ˆç‡æ›´ä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–å…³é”®&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ·»åŠ äºŒçº§ç´¢å¼•&lt;/strong&gt;ï¼šå°¤å…¶å¯¹ &lt;code&gt;WHERE&lt;/code&gt; æ¡ä»¶ä¸­çš„å­—æ®µå»ºç´¢å¼•ï¼Œå‡å°‘æ‰«æèŒƒå›´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¦†ç›–ç´¢å¼•&lt;/strong&gt;ï¼šè‹¥æŸ¥è¯¢éœ€ç»Ÿè®¡ç‰¹å®šæ¡ä»¶çš„è¡Œæ•°ï¼ˆå¦‚ &lt;code&gt;WHERE status=1&lt;/code&gt;ï¼‰ï¼Œå¯åˆ›å»ºè”åˆç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;(status, create_time)&lt;/code&gt;ï¼‰ï¼Œé¿å…å›è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ“ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;COUNT(*)&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;COUNT(1)&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»Ÿè®¡èŒƒå›´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰è¡Œ&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;NULL å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŒ…å« NULL è¡Œ&lt;/td&gt;
&lt;td&gt;åŒ…å« NULL è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼˜åŒ–åæœ€ä½³&lt;/td&gt;
&lt;td&gt;ä¸ &lt;code&gt;COUNT(*)&lt;/code&gt; ä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç å¯è¯»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ï¼ˆæ¨èï¼‰&lt;/td&gt;
&lt;td&gt;â­ï¸â­ï¸â­ï¸â­ï¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;âœ… &lt;strong&gt;ç»“è®º&lt;/strong&gt;ï¼š&lt;strong&gt;æ— å®è´¨åŒºåˆ«&lt;/strong&gt;ï¼Œä¼˜å…ˆç”¨ &lt;code&gt;COUNT(*)&lt;/code&gt;ï¼›æ€§èƒ½ç“¶é¢ˆæ—¶é€šè¿‡ç´¢å¼•ä¼˜åŒ–è€Œéæ”¹å†™ä¸º &lt;code&gt;COUNT(1)&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="where--having"&gt;where &amp;amp; having
&lt;/h2&gt;&lt;p&gt;WHERE å’Œ HAVING æ˜¯ SQL ä¸­ç”¨äºæ•°æ®è¿‡æ»¤çš„ä¸¤ä¸ªæ ¸å¿ƒå­å¥ï¼Œä½†å…¶ä½œç”¨æ—¶æœºã€å¯¹è±¡å’ŒåŠŸèƒ½å­˜åœ¨æœ¬è´¨å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯ç»“åˆæ‰§è¡Œæœºåˆ¶ã€ä½¿ç”¨åœºæ™¯å’Œä¼˜åŒ–åŸåˆ™çš„è¯¦ç»†å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;WHERE å­å¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;HAVING å­å¥&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½œç”¨æ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ &lt;code&gt;GROUP BY&lt;/code&gt; åˆ†ç»„&lt;strong&gt;ä¹‹å‰&lt;/strong&gt;æ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;åœ¨ &lt;code&gt;GROUP BY&lt;/code&gt; åˆ†ç»„&lt;strong&gt;ä¹‹å&lt;/strong&gt;æ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿‡æ»¤å¯¹è±¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸå§‹æ•°æ®è¡¨ä¸­çš„&lt;strong&gt;å•è¡Œè®°å½•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†ç»„åçš„&lt;strong&gt;èšåˆç»“æœ&lt;/strong&gt;ï¼ˆç»„çº§åˆ«ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èšåˆå‡½æ•°æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸å¯ä½¿ç”¨ï¼ˆå¦‚ &lt;code&gt;SUM()&lt;/code&gt;ã€&lt;code&gt;COUNT()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… å¯ä½¿ç”¨èšåˆå‡½æ•°ä½œä¸ºè¿‡æ»¤æ¡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—æ®µåˆ«å&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸å¯ä½¿ç”¨ &lt;code&gt;SELECT&lt;/code&gt; ä¸­çš„åˆ«å&lt;/td&gt;
&lt;td&gt;âœ… å¯ä½¿ç”¨ &lt;code&gt;SELECT&lt;/code&gt; ä¸­çš„åˆ«åï¼ˆå¦‚ &lt;code&gt;total_sales&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œé¡ºåº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FROM&lt;/code&gt; â†’ &lt;code&gt;WHERE&lt;/code&gt; â†’ &lt;code&gt;GROUP BY&lt;/code&gt; â†’ &lt;code&gt;SELECT&lt;/code&gt; â†’ &lt;code&gt;HAVING&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–åˆ†ç»„ç»“æœï¼Œåœ¨ &lt;code&gt;GROUP BY&lt;/code&gt; åç”Ÿæ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…³é”®è®°å¿†ç‚¹&lt;/strong&gt;ï¼šWHERE æ˜¯â€œè¡Œçº§è¿‡æ»¤å™¨â€ï¼ŒHAVING æ˜¯â€œç»„çº§è¿‡æ»¤å™¨â€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨åœºæ™¯ä¸ç¤ºä¾‹"&gt;âš™ï¸ &lt;strong&gt;ä½¿ç”¨åœºæ™¯ä¸ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="where-çš„å…¸å‹åœºæ™¯"&gt;&lt;strong&gt;WHERE çš„å…¸å‹åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;è¿‡æ»¤åŸå§‹æ•°æ®è¡Œï¼Œ&lt;strong&gt;ä¸ä¾èµ–åˆ†ç»„ç»“æœ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- æ‰¾å‡ºå·¥èµ„ &amp;gt; 5000 çš„å‘˜å·¥ï¼ˆæŒ‰è¡Œè¿‡æ»¤ï¼‰
SELECT name, salary FROM employees WHERE salary &amp;gt; 5000;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨&lt;/strong&gt;ï¼šåŸºç¡€æ¡ä»¶è¿‡æ»¤ï¼ˆæ—¥æœŸèŒƒå›´ã€çŠ¶æ€å€¼ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="having-çš„å…¸å‹åœºæ™¯"&gt;&lt;strong&gt;HAVING çš„å…¸å‹åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;è¿‡æ»¤&lt;strong&gt;åˆ†ç»„åçš„èšåˆç»“æœ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- æ‰¾å‡ºéƒ¨é—¨æ€»å·¥èµ„ &amp;gt; 10ä¸‡ çš„éƒ¨é—¨ï¼ˆæŒ‰ç»„è¿‡æ»¤ï¼‰
SELECT dept_id, SUM(salary) AS total_salary
FROM employees
GROUP BY dept_id
HAVING total_salary &amp;gt; 100000; -- ä½¿ç”¨èšåˆç»“æœè¿‡æ»¤
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨&lt;/strong&gt;ï¼šç»Ÿè®¡åç­›é€‰ï¼ˆç»„å†…å¹³å‡å€¼ã€æ€»æ•°ã€æœ€å¤§å€¼ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç»„åˆä½¿ç”¨åœºæ™¯"&gt;&lt;strong&gt;ç»„åˆä½¿ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;-- å…ˆè¿‡æ»¤è¡Œï¼ˆWHEREï¼‰ï¼Œå†åˆ†ç»„ç»Ÿè®¡ï¼Œæœ€åè¿‡æ»¤ç»„ï¼ˆHAVINGï¼‰
SELECT dept_id, AVG(salary) AS avg_salary
FROM employees
WHERE hire_date &amp;gt; &amp;#39;2023-01-01&amp;#39; -- è¿‡æ»¤æ–°å‘˜å·¥
GROUP BY dept_id
HAVING avg_salary &amp;gt; 8000; -- è¿‡æ»¤é«˜å¹³å‡è–ªèµ„çš„éƒ¨é—¨
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€»è¾‘é¡ºåº&lt;/strong&gt;ï¼š
&lt;code&gt;WHERE&lt;/code&gt; â†’ æ’é™¤è€å‘˜å·¥ â†’ &lt;code&gt;GROUP BY&lt;/code&gt; åˆ†ç»„ â†’ &lt;code&gt;HAVING&lt;/code&gt; ç­›é€‰é«˜è–ªéƒ¨é—¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§é”™è¯¯ä¸é¿å‘æŒ‡å—"&gt;âš ï¸ &lt;strong&gt;å¸¸è§é”™è¯¯ä¸é¿å‘æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é”™è¯¯ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é”™è¯¯ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› åŠä¿®æ­£&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;WHERE ä¸­ä½¿ç”¨èšåˆå‡½æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SELECT dept_id FROM employees WHERE COUNT(*) &amp;gt; 5&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ èšåˆå‡½æ•°æœªåˆ†ç»„å‰ä¸å¯ç”¨ â†’ æ”¹ç”¨ &lt;code&gt;HAVING&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;HAVING å¼•ç”¨éåˆ†ç»„å­—æ®µ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SELECT dept_id, salary GROUP BY dept_id HAVING salary &amp;gt; 5000&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ &lt;code&gt;salary&lt;/code&gt; æœªå‚ä¸åˆ†ç»„ â†’ æ”¹ç”¨ &lt;code&gt;WHERE&lt;/code&gt; æˆ–åœ¨ &lt;code&gt;GROUP BY&lt;/code&gt; ä¸­æ·»åŠ å­—æ®µ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ··æ·†è¿‡æ»¤æ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹åˆ†ç»„å­—æ®µç”¨ &lt;code&gt;HAVING&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;HAVING dept_id=1&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… åº”ä¼˜å…ˆç”¨ &lt;code&gt;WHERE&lt;/code&gt;ï¼ˆæ€§èƒ½æ›´ä¼˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–å»ºè®®"&gt;âš¡ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨ WHERE&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹åˆ†ç»„å­—æ®µçš„è¿‡æ»¤ï¼ˆå¦‚ &lt;code&gt;dept_id=1&lt;/code&gt;ï¼‰åº”å†™åœ¨ &lt;code&gt;WHERE&lt;/code&gt; ä¸­ï¼Œå‡å°‘åˆ†ç»„è®¡ç®—é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;é¿å… HAVING ä¸­çš„å¤æ‚è®¡ç®—&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ &lt;code&gt;HAVING SUM(price*quantity) &amp;gt; 1000&lt;/code&gt; å¯æ”¹ä¸ºå­æŸ¥è¯¢é¢„å…ˆè®¡ç®—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;ç´¢å¼•åˆ©ç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;WHERE&lt;/code&gt; æ¡ä»¶ä¸­çš„å­—æ®µå¯åŠ ç´¢å¼•åŠ é€Ÿè¿‡æ»¤ï¼›&lt;code&gt;HAVING&lt;/code&gt; ä¾èµ–åˆ†ç»„ç»“æœï¼Œç´¢å¼•ä¼˜åŒ–ç©ºé—´è¾ƒå°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è¿›é˜¶ä¸-on-å­å¥çš„å…³è”"&gt;ğŸ’ &lt;strong&gt;è¿›é˜¶ï¼šä¸ ON å­å¥çš„å…³è”&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åœ¨æ¶‰åŠå¤šè¡¨è¿æ¥æ—¶éœ€æ³¨æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ON vs WHEREï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ON
&lt;/code&gt;&lt;/pre&gt;ç”¨äºæŒ‡å®š
è¿æ¥æ¡ä»¶
ï¼ˆå¦‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; JOIN ... ON e.dept_id = d.id
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ï¼‰ï¼Œè€Œ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; WHERE
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç”¨äºè¿‡æ»¤è¿æ¥åçš„æ•°æ®è¡Œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…è¿æ¥æ—¶ä¸¤è€…ç­‰æ•ˆï¼Œå¤–è¿æ¥æ—¶ &lt;code&gt;ON&lt;/code&gt; å½±å“è¿æ¥ç»“æœï¼Œ&lt;code&gt;WHERE&lt;/code&gt; è¿‡æ»¤æœ€ç»ˆæ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ HAVING åä½œ&lt;/strong&gt;ï¼š
å¤šè¡¨è¿æ¥ååˆ†ç»„ç»Ÿè®¡çš„é€»è¾‘é¡ºåºï¼š
&lt;code&gt;FROM â†’ JOIN â†’ WHERE â†’ GROUP BY â†’ HAVING&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ“ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;WHERE&lt;/strong&gt;ï¼šè¡Œçº§è¿‡æ»¤ï¼Œä½œç”¨äºåŸå§‹æ•°æ®ï¼Œ&lt;strong&gt;ä¸å¯ç”¨èšåˆå‡½æ•°&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HAVING&lt;/strong&gt;ï¼šç»„çº§è¿‡æ»¤ï¼Œä½œç”¨äºåˆ†ç»„ç»“æœï¼Œ&lt;strong&gt;å¿…é¡»æ­é… &lt;code&gt;GROUP BY&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»„é‡‘å®è·µ&lt;/strong&gt;ï¼š
âœ… è¡Œè¿‡æ»¤ç”¨ &lt;code&gt;WHERE&lt;/code&gt;ï¼Œç»„è¿‡æ»¤ç”¨ &lt;code&gt;HAVING&lt;/code&gt;ï¼›
âœ… åˆ†ç»„å­—æ®µè¿‡æ»¤ä¼˜å…ˆå†™ &lt;code&gt;WHERE&lt;/code&gt;ï¼›
âœ… å¤šè¡¨æŸ¥è¯¢æ—¶å…ˆç”¨ &lt;code&gt;ON&lt;/code&gt; è¿æ¥ï¼Œå†ç”¨ &lt;code&gt;WHERE/HAVING&lt;/code&gt; è¿‡æ»¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æŒæ¡äºŒè€…å·®å¼‚å¯æ˜¾è‘—æå‡ SQL æŸ¥è¯¢æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚å»ºè®®é€šè¿‡æ‰§è¡Œè®¡åˆ’ï¼ˆ&lt;code&gt;EXPLAIN&lt;/code&gt;ï¼‰éªŒè¯ä¼˜åŒ–æ•ˆæœã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="group-by"&gt;Group by
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;GROUP BY&lt;/code&gt; æ˜¯ SQL ä¸­ç”¨äºæ•°æ®åˆ†ç»„å’Œèšåˆè®¡ç®—çš„æ ¸å¿ƒå­å¥ï¼Œé€šè¿‡å°†æ•°æ®é›†æŒ‰æŒ‡å®šåˆ—çš„å€¼åˆ’åˆ†æˆå¤šä¸ªå­é›†ï¼Œå†ç»“åˆèšåˆå‡½æ•°ï¼ˆå¦‚ &lt;code&gt;COUNT&lt;/code&gt;ã€&lt;code&gt;SUM&lt;/code&gt;ã€&lt;code&gt;AVG&lt;/code&gt; ç­‰ï¼‰å¯¹æ¯ä¸ªç»„è¿›è¡Œç»Ÿè®¡åˆ†æã€‚ä»¥ä¸‹æ˜¯å…¶è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸åŸç†"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½ä¸åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åˆ†ç»„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ ¹æ®ä¸€åˆ—æˆ–å¤šåˆ—çš„å€¼å°†æ•°æ®é›†åˆ’åˆ†ä¸ºé€»è¾‘ç»„ï¼Œ&lt;strong&gt;ç›¸åŒå€¼çš„è¡Œå½’å…¥åŒä¸€ç»„&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šæŒ‰éƒ¨é—¨åˆ†ç»„å‘˜å·¥è¡¨ï¼Œæ¯ä¸ªéƒ¨é—¨å½¢æˆä¸€ä¸ªç‹¬ç«‹ç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èšåˆè®¡ç®—&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹æ¯ä¸ªç»„åº”ç”¨èšåˆå‡½æ•°ï¼Œç”Ÿæˆç»„çº§åˆ«çš„ç»Ÿè®¡ç»“æœï¼ˆå¦‚æ€»å’Œã€å¹³å‡å€¼ã€è®¡æ•°ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT department, COUNT(*) AS emp_count, AVG(salary) AS avg_salary
FROM employees
GROUP BY department; -- ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨çš„å‘˜å·¥æ•°å’Œå¹³å‡è–ªèµ„[2,4](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸èšåˆå‡½æ•°çš„ç»‘å®šå…³ç³»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è§„åˆ™ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT
&lt;/code&gt;&lt;/pre&gt;ä¸­çš„éåˆ†ç»„åˆ—
å¿…é¡»
ä½¿ç”¨èšåˆå‡½æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
&lt;ul&gt;
&lt;li&gt;âœ… åˆæ³•ï¼š&lt;code&gt;SELECT department, SUM(salary)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;âŒ éæ³•ï¼š&lt;code&gt;SELECT department, salary&lt;/code&gt;ï¼ˆ&lt;code&gt;salary&lt;/code&gt; æœªèšåˆä¸”æœªåœ¨ &lt;code&gt;GROUP BY&lt;/code&gt; ä¸­ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åŸºç¡€è¯­æ³•ä¸ç¤ºä¾‹"&gt;ğŸ“Š &lt;strong&gt;åŸºç¡€è¯­æ³•ä¸ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºæœ¬è¯­æ³•"&gt;&lt;strong&gt;åŸºæœ¬è¯­æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT column1, aggregate_function(column2)
FROM table_name
[WHERE condition] -- åˆ†ç»„å‰è¿‡æ»¤
GROUP BY column1
[HAVING condition] -- åˆ†ç»„åè¿‡æ»¤
[ORDER BY column]; -- ç»“æœæ’åº
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å…¸å‹åœºæ™¯"&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å•åˆ—åˆ†ç»„&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT city, COUNT(customer_id) AS customer_count
FROM customers
GROUP BY city; -- ç»Ÿè®¡æ¯ä¸ªåŸå¸‚çš„å®¢æˆ·æ•°é‡[8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šåˆ—åˆ†ç»„&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT department, job_title, COUNT(*) AS emp_count
FROM employees
GROUP BY department, job_title; -- æŒ‰éƒ¨é—¨å’ŒèŒä½ç»Ÿè®¡å‘˜å·¥æ•°[2,4](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸èšåˆå‡½æ•°ç»“åˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SUM()&lt;/code&gt;ï¼šè®¡ç®—æ€»å’Œï¼ˆå¦‚è®¢å•æ€»é‡‘é¢ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AVG()&lt;/code&gt;ï¼šè®¡ç®—å¹³å‡å€¼ï¼ˆå¦‚éƒ¨é—¨å¹³å‡è–ªèµ„ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MAX()&lt;/code&gt;/&lt;code&gt;MIN()&lt;/code&gt;ï¼šè·å–æå€¼ï¼ˆå¦‚äº§å“æœ€é«˜/æœ€ä½ä»·æ ¼ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;COUNT()&lt;/code&gt;ï¼šè®¡æ•°ï¼ˆå¦‚å®¢æˆ·è®¢å•æ•°ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¿›é˜¶ç”¨æ³•"&gt;âš™ï¸ &lt;strong&gt;è¿›é˜¶ç”¨æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;HAVING&lt;/code&gt; å­å¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨åˆ†ç»„
å
è¿‡æ»¤ç»“æœï¼Œå¸¸ä¸èšåˆå‡½æ•°è”ç”¨ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT department, AVG(salary) AS avg_salary
FROM employees
GROUP BY department
HAVING AVG(salary) &amp;gt; 5000; -- ç­›é€‰å¹³å‡è–ªèµ„è¶…5000çš„éƒ¨é—¨[2,7](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;WITH ROLLUP&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿæˆå±‚æ¬¡åŒ–å°è®¡å’Œæ€»è®¡ï¼ˆå¦‚éƒ¨é—¨å°è®¡ã€å…¬å¸æ€»è®¡ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT department, job_title, SUM(salary)
FROM employees
GROUP BY department, job_title WITH ROLLUP; -- è¾“å‡ºéƒ¨é—¨å†…èŒä½å°è®¡åŠéƒ¨é—¨æ€»è®¡[1,4](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;WITH CUBE&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ç»„åˆæ±‡æ€»ï¼ˆå¦‚æŒ‰éƒ¨é—¨ã€æ€§åˆ«ã€èŒä½çš„å…¨ç»„åˆç»Ÿè®¡ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸å¸¸è§é”™è¯¯"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸å¸¸è§é”™è¯¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç»„åˆ—ä¸ &lt;code&gt;SELECT&lt;/code&gt; åˆ—è¡¨çš„åŒ¹é…&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SELECT&lt;/code&gt; ä¸­çš„éèšåˆåˆ—&lt;strong&gt;å¿…é¡»&lt;/strong&gt;å‡ºç°åœ¨ &lt;code&gt;GROUP BY&lt;/code&gt; ä¸­&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;NULL&lt;/code&gt; å€¼çš„å¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰ &lt;code&gt;NULL&lt;/code&gt; å€¼ä¼šè¢«è§†ä¸º&lt;strong&gt;åŒä¸€åˆ†ç»„&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;city&lt;/code&gt; ä¸º &lt;code&gt;NULL&lt;/code&gt; çš„å®¢æˆ·å½’ä¸ºä¸€ç»„ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;WHERE&lt;/code&gt; vs &lt;code&gt;HAVING&lt;/code&gt;&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å­å¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ‰§è¡Œæ—¶æœº&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;WHERE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ†ç»„&lt;strong&gt;å‰&lt;/strong&gt;è¿‡æ»¤è¡Œ&lt;/td&gt;
&lt;td&gt;ç­›é€‰åŸå§‹æ•°æ®ï¼ˆå¦‚ &lt;code&gt;salary &amp;gt; 5000&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;HAVING&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ†ç»„&lt;strong&gt;å&lt;/strong&gt;è¿‡æ»¤ç»„&lt;/td&gt;
&lt;td&gt;ç­›é€‰èšåˆç»“æœï¼ˆå¦‚ &lt;code&gt;AVG(salary) &amp;gt; 5000&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•&lt;/strong&gt;ï¼šä¸ºåˆ†ç»„åˆ—ï¼ˆå¦‚ &lt;code&gt;department&lt;/code&gt;ï¼‰åˆ›å»ºç´¢å¼•åŠ é€Ÿåˆ†ç»„è¿‡ç¨‹&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘åˆ†ç»„åˆ—&lt;/strong&gt;ï¼šé¿å…ä¸å¿…è¦çš„å¤šåˆ—åˆ†ç»„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢„å…ˆè¿‡æ»¤&lt;/strong&gt;ï¼šç”¨ &lt;code&gt;WHERE&lt;/code&gt; ç¼©å°æ•°æ®é›†å†åˆ†ç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯"&gt;ğŸ’ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”€å”®åˆ†æ&lt;/strong&gt;ï¼šæŒ‰äº§å“/åœ°åŒºç»Ÿè®¡é”€å”®é¢&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº“å­˜ç®¡ç†&lt;/strong&gt;ï¼šæŒ‰ä»“åº“/åˆ†ç±»æ±‡æ€»åº“å­˜é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”¨æˆ·è¡Œä¸ºåˆ†æ&lt;/strong&gt;ï¼šè®¡ç®—ç”¨æˆ·å¹³å‡è®¢å•æ•°ã€æ¶ˆè´¹æ€»é¢&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´¢åŠ¡æŠ¥å‘Š&lt;/strong&gt;ï¼šç”Ÿæˆéƒ¨é—¨é¢„ç®—å°è®¡æˆ–å…¬å¸æ€»è®¡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é”™è¯¯æ¡ˆä¾‹ä¸ä¿®æ­£"&gt;ğŸ”§ &lt;strong&gt;é”™è¯¯æ¡ˆä¾‹ä¸ä¿®æ­£&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯ï¼š&lt;code&gt;SELECT&lt;/code&gt; åŒ…å«æœªåˆ†ç»„åˆ—&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- é”™è¯¯ç¤ºä¾‹
SELECT name, department, AVG(salary)
FROM employees
GROUP BY department; -- `name` æœªåˆ†ç»„æˆ–èšåˆï¼
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;ä¿®æ­£&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT department, AVG(salary) -- ç§»é™¤éåˆ†ç»„åˆ— `name`
FROM employees
GROUP BY department;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯ï¼šæ··æ·† &lt;code&gt;WHERE&lt;/code&gt; å’Œ &lt;code&gt;HAVING&lt;/code&gt;&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- é”™è¯¯ï¼šèšåˆæ¡ä»¶è¯¯ç”¨ WHERE
SELECT department, AVG(salary)
FROM employees
WHERE AVG(salary) &amp;gt; 5000 -- WHERE ä¸èƒ½åŒ…å«èšåˆå‡½æ•°ï¼
GROUP BY department;
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;ä¿®æ­£&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT department, AVG(salary)
FROM employees
GROUP BY department
HAVING AVG(salary) &amp;gt; 5000; -- æ”¹ç”¨ HAVING[2](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;GROUP BY&lt;/code&gt; æ˜¯ SQL æ•°æ®èšåˆçš„åŸºçŸ³ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äº &lt;strong&gt;åˆ†ç»„ â†’ èšåˆ â†’ ç»Ÿè®¡åˆ†æ&lt;/strong&gt;ã€‚ä½¿ç”¨æ—¶éœ€ä¸¥æ ¼éµå¾ªè¯­æ³•è§„åˆ™ï¼Œç»“åˆåœºæ™¯é€‰æ‹© &lt;code&gt;ROLLUP&lt;/code&gt;/&lt;code&gt;CUBE&lt;/code&gt; ç­‰é«˜çº§åŠŸèƒ½ï¼Œå¹¶é€šè¿‡ç´¢å¼•å’Œé¢„è¿‡æ»¤ä¼˜åŒ–æ€§èƒ½ã€‚æŒæ¡å…¶ä¸ &lt;code&gt;HAVING&lt;/code&gt;ã€èšåˆå‡½æ•°çš„é…åˆé€»è¾‘ï¼Œå¯é«˜æ•ˆè§£å†³æ•°æ®åˆ†æä¸­çš„å¤æ‚æ±‡æ€»éœ€æ±‚&lt;a class="link" href="@ref" &gt;4,7,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="rollupcube"&gt;ROLLUP/CUBE
&lt;/h2&gt;&lt;p&gt;ROLLUPå’ŒCUBEæ˜¯SQLä¸­ç”¨äºå¤šç»´èšåˆåˆ†æçš„æ‰©å±•åŠŸèƒ½ï¼Œä¸»è¦ç”¨äºåœ¨&lt;code&gt;GROUP BY&lt;/code&gt;å­å¥ä¸­ç”Ÿæˆå±‚æ¬¡åŒ–æ±‡æ€»ï¼ˆROLLUPï¼‰æˆ–å…¨ç»´åº¦ç»„åˆæ±‡æ€»ï¼ˆCUBEï¼‰ã€‚ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«åœ¨äº&lt;strong&gt;æ±‡æ€»çš„ç»´åº¦ç»„åˆæ–¹å¼&lt;/strong&gt;ï¼Œé€‚ç”¨äºä¸åŒçš„æ•°æ®åˆ†æåœºæ™¯ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸åŒºåˆ«"&gt;ğŸ“Š &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸åŒºåˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ROLLUP&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CUBE&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ±‡æ€»é€»è¾‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰åˆ—é¡ºåº&lt;strong&gt;å±‚æ¬¡åŒ–æ±‡æ€»&lt;/strong&gt;ï¼ˆå¦‚ï¼šå¹´â†’æœˆâ†’æ—¥ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å…¨ç»´åº¦ç»„åˆæ±‡æ€»&lt;/strong&gt;ï¼ˆæ‰€æœ‰åˆ—çš„å¯èƒ½ç»„åˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»“æœé›†å¤§å°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»„åˆæ•° = &lt;em&gt;n+1&lt;/em&gt;ï¼ˆ&lt;em&gt;n&lt;/em&gt;ä¸ºç»´åº¦æ•°ï¼‰&lt;/td&gt;
&lt;td&gt;ç»„åˆæ•° = &lt;em&gt;2â¿&lt;/em&gt;ï¼ˆ&lt;em&gt;n&lt;/em&gt;ä¸ºç»´åº¦æ•°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªç„¶å±‚çº§æ•°æ®ï¼ˆå¦‚è¡Œæ”¿åŒºåˆ’ã€æ—¶é—´åºåˆ—ï¼‰&lt;/td&gt;
&lt;td&gt;æ— å±‚çº§å…³ç³»çš„å¤šç»´äº¤å‰åˆ†æï¼ˆå¦‚äº§å“+é¢œè‰²+å°ºå¯¸ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç©ºå€¼å«ä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ±‡æ€»è¡Œçš„ç»´åº¦åˆ—æ˜¾ç¤º&lt;code&gt;NULL&lt;/code&gt;ï¼Œè¡¨ç¤ºæ›´é«˜å±‚çº§æ±‡æ€»&lt;/td&gt;
&lt;td&gt;åŒROLLUPï¼Œä½†è¦†ç›–æ‰€æœ‰ç»´åº¦çš„ç‹¬ç«‹æ±‡æ€»è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®åŒºåˆ«&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ROLLUP å‡è®¾ç»´åº¦æœ‰å±‚çº§å…³ç³»ï¼ˆå¦‚&lt;code&gt;å›½å®¶â†’çœâ†’å¸‚&lt;/code&gt;ï¼‰ï¼Œä»…ç”Ÿæˆ&lt;strong&gt;ä»ç»†ç²’åº¦åˆ°æ€»ä½“çš„èšåˆè·¯å¾„&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;CUBE ä¸å‡è®¾å±‚çº§å…³ç³»ï¼Œç”Ÿæˆ&lt;strong&gt;æ‰€æœ‰ç»´åº¦çš„ç¬›å¡å°”ç§¯ç»„åˆ&lt;/strong&gt;ï¼ŒåŒ…æ‹¬å•ç»´åº¦æ±‡æ€»&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-è¯­æ³•ä¸å·¥ä½œæœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;è¯­æ³•ä¸å·¥ä½œæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="rollup-ç¤ºä¾‹ä¸æœºåˆ¶"&gt;&lt;strong&gt;ROLLUP ç¤ºä¾‹ä¸æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;-- æŒ‰éƒ¨é—¨ã€å‘˜å·¥æ±‡æ€»å·¥èµ„ï¼Œå¹¶é€çº§ç”Ÿæˆéƒ¨é—¨å°è®¡å’Œæ€»è®¡
SELECT éƒ¨é—¨, å‘˜å·¥, SUM(å·¥èµ„) AS Total
FROM DEPART
GROUP BY ROLLUP(éƒ¨é—¨, å‘˜å·¥);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¾“å‡ºç»“æœ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;éƒ¨é—¨&lt;/th&gt;
&lt;th&gt;å‘˜å·¥&lt;/th&gt;
&lt;th&gt;Total&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;å¼ ä¸‰&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;æå››&lt;/td&gt;
&lt;td&gt;200&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;300&lt;/strong&gt;ï¼ˆAéƒ¨é—¨å°è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;B&lt;/td&gt;
&lt;td&gt;ç‹äº”&lt;/td&gt;
&lt;td&gt;150&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;B&lt;/td&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;150&lt;/strong&gt;ï¼ˆBéƒ¨é—¨å°è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;450&lt;/strong&gt;ï¼ˆæ€»è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆæŒ‰&lt;code&gt;(éƒ¨é—¨, å‘˜å·¥)&lt;/code&gt;åˆ†ç»„ï¼›&lt;/li&gt;
&lt;li&gt;å†æŒ‰&lt;code&gt;(éƒ¨é—¨)&lt;/code&gt;åˆ†ç»„ï¼ˆå¿½ç•¥å‘˜å·¥ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æœ€åå…¨è¡¨æ±‡æ€»&lt;a class="link" href="@ref" &gt;1,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="cube-ç¤ºä¾‹ä¸æœºåˆ¶"&gt;&lt;strong&gt;CUBE ç¤ºä¾‹ä¸æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;-- æŒ‰äº§å“ã€é¢œè‰²æ±‡æ€»æ•°é‡ï¼Œç”Ÿæˆæ‰€æœ‰ç»„åˆçš„èšåˆ
SELECT Item, Color, SUM(Quantity) AS QtySum
FROM Inventory
GROUP BY CUBE(Item, Color);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¾“å‡ºç»“æœ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Item&lt;/th&gt;
&lt;th&gt;Color&lt;/th&gt;
&lt;th&gt;QtySum&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Chair&lt;/td&gt;
&lt;td&gt;Blue&lt;/td&gt;
&lt;td&gt;101&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Chair&lt;/td&gt;
&lt;td&gt;Red&lt;/td&gt;
&lt;td&gt;210&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Chair&lt;/td&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;311&lt;/strong&gt;ï¼ˆChairæ€»è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Table&lt;/td&gt;
&lt;td&gt;Blue&lt;/td&gt;
&lt;td&gt;124&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Table&lt;/td&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;347&lt;/strong&gt;ï¼ˆTableæ€»è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;Blue&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;225&lt;/strong&gt;ï¼ˆæ‰€æœ‰Blueæ€»è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;Red&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;433&lt;/strong&gt;ï¼ˆæ‰€æœ‰Redæ€»è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;658&lt;/strong&gt;ï¼ˆå…¨å±€æ€»è®¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç”Ÿæˆæ‰€æœ‰ç»„åˆï¼š&lt;code&gt;(Item, Color)&lt;/code&gt;, &lt;code&gt;(Item)&lt;/code&gt;, &lt;code&gt;(Color)&lt;/code&gt;, &lt;code&gt;()&lt;/code&gt;&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºå€¼å¤„ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ±‡æ€»è¡Œçš„
&lt;pre tabindex="0"&gt;&lt;code&gt;NULL
&lt;/code&gt;&lt;/pre&gt;æ˜¯å ä½ç¬¦ï¼Œéœ€ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;GROUPING()
&lt;/code&gt;&lt;/pre&gt;å‡½æ•°åŒºåˆ†å®é™…ç©ºå€¼ä¸æ±‡æ€»æ ‡è¯†ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT
CASE WHEN GROUPING(éƒ¨é—¨)=1 THEN &amp;#39;æ€»è®¡&amp;#39; ELSE éƒ¨é—¨ END AS éƒ¨é—¨,
SUM(å·¥èµ„)
FROM DEPART
GROUP BY ROLLUP(éƒ¨é—¨);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å®é™…æ•°æ®ä¸­çš„&lt;code&gt;NULL&lt;/code&gt;ä¼šè¢«èšåˆï¼Œä¸æ±‡æ€»è¡Œæ··æ·†&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”&lt;/strong&gt;ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;ROLLUPæ€§èƒ½&lt;/th&gt;
&lt;th&gt;CUBEæ€§èƒ½&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç»´åº¦å°‘ï¼ˆâ‰¤3ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… æ›´å¿«&lt;/td&gt;
&lt;td&gt;âš ï¸ ä¸­ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç»´åº¦å¤šï¼ˆ&amp;gt;3ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… é«˜æ•ˆ&lt;/td&gt;
&lt;td&gt;âŒ å¯èƒ½çˆ†ç‚¸ï¼ˆ&lt;em&gt;2â¿&lt;/em&gt;è¡Œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;å»ºè®®ï¼šå¤§æ•°æ®é›†é¿å…é«˜ç»´CUBEï¼Œæ”¹ç”¨&lt;strong&gt;GROUPING SETSè‡ªå®šä¹‰ç»„åˆ&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºæ•æ„Ÿæ€§&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ROLLUP ç»“æœä¾èµ–åˆ—é¡ºåºï¼š&lt;code&gt;ROLLUP(A,B)&lt;/code&gt; â‰  &lt;code&gt;ROLLUP(B,A)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;CUBE ç»“æœä¸é¡ºåºæ— å…³&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ"&gt;ğŸ› ï¸ &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="rollup-é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;ROLLUP é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŠ¥è¡¨å°è®¡ç”Ÿæˆ&lt;/strong&gt;ï¼š
æŒ‰æ—¶é—´å±‚çº§ï¼ˆå¹´â†’æœˆâ†’æ—¥ï¼‰ç»Ÿè®¡é”€å”®é¢ï¼Œç”Ÿæˆæœˆåº¦å°è®¡å’Œå¹´åº¦æ€»è®¡&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»„ç»‡ç»“æ„æ±‡æ€»&lt;/strong&gt;ï¼š
å…¬å¸â†’éƒ¨é—¨â†’å›¢é˜Ÿçš„äººåŠ›æˆæœ¬åˆ†æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="cube-é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;CUBE é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šç»´äº¤å‰åˆ†æ&lt;/strong&gt;ï¼š
äº§å“ç±»åˆ«ï¼ˆå¦‚æœè£…ï¼‰âœ• é¢œè‰² âœ• å°ºå¯¸çš„åº“å­˜é‡å…¨ç»„åˆç»Ÿè®¡&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— å±‚çº§å…³è”æŒ‡æ ‡&lt;/strong&gt;ï¼š
ç”¨æˆ·æ€§åˆ«ä¸è®¾å¤‡ç±»å‹çš„æ´»è·ƒåº¦äº¤å‰æŠ¥è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¼˜åŒ–å»ºè®®"&gt;&lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŠ¨æ€ç»´åº¦ï¼šä½¿ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;GROUPING SETS
&lt;/code&gt;&lt;/pre&gt;æ›¿ä»£CUBEï¼Œä»…è®¡ç®—æ‰€éœ€ç»„åˆï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- ä»…æ±‡æ€»éƒ¨é—¨å’Œå…¨å±€æ€»è®¡ï¼Œè·³è¿‡å‘˜å·¥å±‚çº§
SELECT éƒ¨é—¨, å‘˜å·¥, SUM(å·¥èµ„)
FROM DEPART
GROUP BY GROUPING SETS((éƒ¨é—¨, å‘˜å·¥), ());
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“æœç­›é€‰&lt;/strong&gt;ï¼šå°†CUBEæŸ¥è¯¢å­˜å…¥è§†å›¾ï¼ŒæŒ‰éœ€æŸ¥è¯¢å­é›†&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰å‹åŸåˆ™&lt;/strong&gt;ï¼š
âœ… æœ‰æ˜ç¡®å±‚çº§ â†’ â€‹&lt;strong&gt;ROLLUP&lt;/strong&gt;â€‹ï¼ˆå¦‚è´¢åŠ¡å‘¨æœŸæŠ¥è¡¨ï¼‰ï¼›
âœ… æ— å±‚çº§å…¨ç»„åˆ â†’ â€‹&lt;strong&gt;CUBE&lt;/strong&gt;â€‹ï¼ˆå¦‚å•†å“å±æ€§åˆ†æï¼‰ï¼›
âœ… å®šåˆ¶åŒ–éœ€æ±‚ â†’ â€‹&lt;strong&gt;GROUPING SETS&lt;/strong&gt;â€‹ï¼ˆæ€§èƒ½æœ€ä¼˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é¿å‘æŒ‡å—ï¼š
&lt;ul&gt;
&lt;li&gt;å§‹ç»ˆç”¨&lt;code&gt;GROUPING()&lt;/code&gt;æ ‡è¯†æ±‡æ€»è¡Œï¼›&lt;/li&gt;
&lt;li&gt;é¿å…è¶…è¿‡3ç»´çš„CUBEï¼›&lt;/li&gt;
&lt;li&gt;æ’åºè¾“å‡ºæ—¶æ˜¾å¼æ·»åŠ &lt;code&gt;ORDER BY&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡çµæ´»ç»„åˆè¿™äº›åŠŸèƒ½ï¼Œå¯é«˜æ•ˆå®ç°ä»åŸºç¡€å°è®¡åˆ°å¤æ‚å¤šç»´åˆ†æçš„å…¨é¢æ•°æ®èšåˆéœ€æ±‚ã€‚å®é™…åº”ç”¨ä¸­éœ€æƒè¡¡&lt;strong&gt;æ•°æ®è§„æ¨¡&lt;/strong&gt;ã€&lt;strong&gt;ç»´åº¦å¤æ‚åº¦&lt;/strong&gt;å’Œ&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="grouping-sets"&gt;GROUPING SETS
&lt;/h2&gt;&lt;p&gt;GROUPING SETS æ˜¯ SQL ä¸­ç”¨äº&lt;strong&gt;å¤šç»´èšåˆåˆ†æ&lt;/strong&gt;çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå®ƒå…è®¸åœ¨å•ä¸ªæŸ¥è¯¢ä¸­åŒæ—¶ç”Ÿæˆå¤šä¸ªåˆ†ç»„ç»´åº¦çš„èšåˆç»“æœï¼Œé¿å…äº†ä¼ ç»Ÿ &lt;code&gt;UNION ALL&lt;/code&gt; çš„å¤æ‚æ€§å’Œæ€§èƒ½ç“¶é¢ˆã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæ¦‚å¿µã€å·¥ä½œæœºåˆ¶ã€åº”ç”¨åœºæ™¯åŠä¼˜åŒ–æŠ€å·§å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸ä»·å€¼"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸ä»·å€¼&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½å®šä¹‰&lt;/strong&gt;
GROUPING SETS æ˜¯ &lt;code&gt;GROUP BY&lt;/code&gt; çš„æ‰©å±•ï¼Œé€šè¿‡æŒ‡å®šå¤šä¸ªåˆ†ç»„é›†åˆï¼ˆæ¯ä¸ªé›†åˆåŒ…å«ä¸€ç»„åˆ—ï¼‰ï¼Œåœ¨&lt;strong&gt;ä¸€æ¬¡æŸ¥è¯¢ä¸­ç”Ÿæˆå¤šç»„èšåˆç»“æœ&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT region, product, SUM(sales)
FROM sales_data
GROUP BY GROUPING SETS ((region), (product), (region, product));
&lt;/code&gt;&lt;/pre&gt;æ­¤æŸ¥è¯¢åŒæ—¶ç”Ÿæˆï¼š
&lt;ul&gt;
&lt;li&gt;æŒ‰ &lt;code&gt;region&lt;/code&gt; åˆ†ç»„çš„é”€å”®æ€»é¢&lt;/li&gt;
&lt;li&gt;æŒ‰ &lt;code&gt;product&lt;/code&gt; åˆ†ç»„çš„é”€å”®æ€»é¢&lt;/li&gt;
&lt;li&gt;æŒ‰ &lt;code&gt;region&lt;/code&gt; å’Œ &lt;code&gt;product&lt;/code&gt; ç»„åˆåˆ†ç»„çš„é”€å”®é¢ &lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä¼˜åŠ¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½é«˜æ•ˆ&lt;/strong&gt;ï¼šä»…æ‰«æä¸€æ¬¡åŸºè¡¨ï¼Œè€Œ &lt;code&gt;UNION ALL&lt;/code&gt; éœ€å¤šæ¬¡æ‰«æï¼ˆå°¤å…¶å¤§æ•°æ®é‡æ—¶æ€§èƒ½å·®å¼‚æ˜¾è‘—ï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç ç®€æ´&lt;/strong&gt;ï¼šæ›¿ä»£å†—é•¿çš„å¤šæ®µ &lt;code&gt;UNION ALL&lt;/code&gt; æŸ¥è¯¢ï¼Œæå‡å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;ï¼šæ”¯æŒä»»æ„è‡ªå®šä¹‰åˆ†ç»„ç»„åˆï¼Œä¸å±€é™äºå±‚çº§ï¼ˆROLLUPï¼‰æˆ–å…¨ç»„åˆï¼ˆCUBEï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¯­æ³•ä¸å·¥ä½œæœºåˆ¶-1"&gt;âš™ï¸ &lt;strong&gt;è¯­æ³•ä¸å·¥ä½œæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºæœ¬è¯­æ³•-1"&gt;&lt;strong&gt;åŸºæœ¬è¯­æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT col1, col2, SUM(metric)
FROM table
GROUP BY GROUPING SETS (
(col1, col2), -- ç»„åˆåˆ†ç»„
(col1), -- å•åˆ—åˆ†ç»„
(col2), -- å•åˆ—åˆ†ç»„
() -- å…¨å±€æ€»è®¡
);
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ‰§è¡Œæœºåˆ¶"&gt;&lt;strong&gt;æ‰§è¡Œæœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç»„é›†ç”Ÿæˆ&lt;/strong&gt;ï¼šæ•°æ®åº“ä¸ºæ¯ä¸ªåˆ†ç»„é›†ç‹¬ç«‹è®¡ç®—èšåˆç»“æœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“æœåˆå¹¶&lt;/strong&gt;ï¼šæ‰€æœ‰åˆ†ç»„é›†çš„ç»“æœç›´æ¥æ‹¼æ¥æˆå•ä¸€ç»“æœé›†ï¼Œç±»ä¼¼éšå¼ &lt;code&gt;UNION ALL&lt;/code&gt;ï¼Œä½†åº•å±‚ä»…éœ€ä¸€æ¬¡è¡¨æ‰«æ&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºå€¼å ä½&lt;/strong&gt;ï¼šæœªå‚ä¸å½“å‰åˆ†ç»„çš„åˆ—æ˜¾ç¤ºä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼ˆä¾‹å¦‚æŒ‰ &lt;code&gt;region&lt;/code&gt; åˆ†ç»„æ—¶ï¼Œ&lt;code&gt;product&lt;/code&gt; åˆ—å…¨ä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="åˆ†ç»„æ ‡è¯†å‡½æ•°"&gt;&lt;strong&gt;åˆ†ç»„æ ‡è¯†å‡½æ•°&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;GROUPING()
&lt;/code&gt;&lt;/pre&gt;**ï¼šæ ‡è¯†æŸåˆ—æ˜¯å¦å‚ä¸å½“å‰åˆ†ç»„ï¼ˆ0=å‚ä¸ï¼Œ1=æœªå‚ä¸ï¼‰ã€‚
ç¤ºä¾‹ï¼šåŒºåˆ†çœŸå®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; NULL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸æ±‡æ€»å ä½ç¬¦ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT
CASE GROUPING(region) WHEN 1 THEN &amp;#39;æ‰€æœ‰åœ°åŒº&amp;#39; ELSE region END AS region,
SUM(sales)
FROM sales_data
GROUP BY GROUPING SETS ((region), ());
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;GROUPING_ID()&lt;/code&gt;&lt;/strong&gt;ï¼šè¿”å›äºŒè¿›åˆ¶ä½å‘é‡ï¼ˆå¦‚ &lt;code&gt;01&lt;/code&gt; è¡¨ç¤ºä»…ç¬¬äºŒåˆ—æœªå‚ä¸ï¼‰ï¼Œç”¨äºæ ‡è¯†å½“å‰åˆ†ç»„ç»„åˆ&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ“Š &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å¤šç»´åº¦äº¤å‰æŠ¥è¡¨"&gt;&lt;strong&gt;å¤šç»´åº¦äº¤å‰æŠ¥è¡¨&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;éœ€æ±‚&lt;/strong&gt;ï¼šåŒæ—¶å±•ç¤ºæŒ‰åœ°åŒºã€äº§å“ã€åœ°åŒº+äº§å“çš„é”€å”®é¢ã€‚
â€‹&lt;strong&gt;ä¼ ç»Ÿæ–¹æ¡ˆ&lt;/strong&gt;â€‹ï¼šéœ€å†™ 3 ä¸ª &lt;code&gt;GROUP BY&lt;/code&gt; æŸ¥è¯¢ + &lt;code&gt;UNION ALL&lt;/code&gt;ã€‚
â€‹&lt;strong&gt;GROUPING SETS æ–¹æ¡ˆ&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT
region,
product,
SUM(sales) AS total_sales,
GROUPING_ID() AS group_id
FROM sales
GROUP BY GROUPING SETS ((region), (product), (region, product));
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¾“å‡º&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;region&lt;/th&gt;
&lt;th&gt;product&lt;/th&gt;
&lt;th&gt;total_sales&lt;/th&gt;
&lt;th&gt;group_id&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;North&lt;/td&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;1000&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NULL&lt;/td&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;500&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;North&lt;/td&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;300&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="åŠ¨æ€ç»´åº¦åˆ†æ"&gt;&lt;strong&gt;åŠ¨æ€ç»´åº¦åˆ†æ&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ç»“åˆä¸šåŠ¡å‚æ•°è¡¨ï¼ŒåŠ¨æ€ç”Ÿæˆåˆ†ç»„ç»„åˆï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GROUP BY GROUPING SETS (
(dim_time, dim_region),
(dim_product, dim_channel)
);
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä¸-rollupcube-ååŒ"&gt;&lt;strong&gt;ä¸ ROLLUP/CUBE ååŒ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ROLLUP ç­‰ä»·å½¢å¼&lt;/strong&gt;ï¼š
&lt;code&gt;ROLLUP(a,b) â‰¡ GROUPING SETS((a,b), (a), ())&lt;/code&gt;
é€‚ç”¨å±‚çº§æ±‡æ€»ï¼ˆå¦‚å¹´â†’æœˆâ†’æ—¥ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CUBE ç­‰ä»·å½¢å¼&lt;/strong&gt;ï¼š
&lt;code&gt;CUBE(a,b) â‰¡ GROUPING SETS((a,b), (a), (b), ())&lt;/code&gt;
é€‚ç”¨å…¨ç»´åº¦ç»„åˆï¼ˆå¦‚äº§å“Ã—é¢œè‰²Ã—å°ºå¯¸ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸ä¼˜åŒ–"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç©ºå€¼å¤„ç†"&gt;&lt;strong&gt;ç©ºå€¼å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šæ•°æ®ä¸­çš„çœŸå® &lt;code&gt;NULL&lt;/code&gt; ä¸æ±‡æ€»å ä½ç¬¦ &lt;code&gt;NULL&lt;/code&gt; æ··æ·†ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼šä½¿ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; GROUPING()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; COALESCE()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ˜¾å¼æ ‡è¯†
7ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT
COALESCE(region, &amp;#39;æ‰€æœ‰åœ°åŒº&amp;#39;) AS region_label,
SUM(sales)
FROM sales
GROUP BY GROUPING SETS ((region), ());
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ€§èƒ½ä¼˜åŒ–"&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ç­–ç•¥&lt;/strong&gt;ï¼šä¸ºåˆ†ç»„åˆ—åˆ›å»ºå¤åˆç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;(region, product)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘åˆ†ç»„åˆ—&lt;/strong&gt;ï¼šé¿å…ä¸å¿…è¦çš„é«˜ç»´åˆ†ç»„ï¼ˆå¦‚è¶…è¿‡ 4 åˆ—çš„ç»„åˆå¯èƒ½çˆ†ç‚¸å¼å¢é•¿ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿‡æ»¤å‰ç½®&lt;/strong&gt;ï¼šå…ˆç”¨ &lt;code&gt;WHERE&lt;/code&gt; ç¼©å°æ•°æ®é›†å†åˆ†ç»„&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…¼å®¹æ€§å·®å¼‚"&gt;&lt;strong&gt;å…¼å®¹æ€§å·®å¼‚&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è¯­æ³•å·®å¼‚ï¼š
&lt;ul&gt;
&lt;li&gt;PostgreSQL/Oracleï¼šæ”¯æŒå®Œæ•´è¯­æ³•ã€‚&lt;/li&gt;
&lt;li&gt;Hiveï¼šä½¿ç”¨ &lt;code&gt;GROUPING__ID&lt;/code&gt;ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰è€Œé &lt;code&gt;GROUPING_ID()&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡½æ•°æ”¯æŒ&lt;/strong&gt;ï¼šéƒ¨åˆ†æ•°æ®åº“ä¸æ”¯æŒ &lt;code&gt;GROUPING_ID()&lt;/code&gt; çš„å‚æ•°ä¼ é€’&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸-union-all-çš„å¯¹æ¯”"&gt;ğŸ’ &lt;strong&gt;ä¸ UNION ALL çš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;GROUPING SETS&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;UNION ALL&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œæ•ˆç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­ å•æ¬¡è¡¨æ‰«æ&lt;/td&gt;
&lt;td&gt;â­â­ å¤šæ¬¡è¡¨æ‰«æ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç ç®€æ´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­ å•è¯­å¥å®ç°å¤šåˆ†ç»„&lt;/td&gt;
&lt;td&gt;â­ éœ€å¤šä¸ªå­æŸ¥è¯¢ + æ‰‹åŠ¨è¡¥ &lt;code&gt;NULL&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯ç»´æŠ¤æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­ ä¿®æ”¹åªéœ€è°ƒæ•´åˆ†ç»„é›†&lt;/td&gt;
&lt;td&gt;â­ ä¿®æ”¹éœ€åŒæ­¥å¤šä¸ªå­æŸ¥è¯¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç©ºå€¼å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ éœ€ &lt;code&gt;GROUPING()&lt;/code&gt; è¾…åŠ©&lt;/td&gt;
&lt;td&gt;âœ… æ‰‹åŠ¨è¡¥ &lt;code&gt;NULL&lt;/code&gt; æ›´ç›´è§‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼šä¼˜å…ˆä½¿ç”¨ GROUPING SETSï¼ˆå°¤å…¶å¤§æ•°æ®é‡ï¼‰ï¼Œä»…å½“å…¼å®¹æ€§å—é™æ—¶æ”¹ç”¨ &lt;code&gt;UNION ALL&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“-1"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;GROUPING SETS æ˜¯ SQL å¤šç»´åˆ†æçš„&lt;strong&gt;æ ¸å¿ƒå·¥å…·&lt;/strong&gt;ï¼Œé€šè¿‡&lt;strong&gt;ä¸€æ¬¡æŸ¥è¯¢ç”Ÿæˆå¤šç»„èšåˆ&lt;/strong&gt;ï¼Œæ˜¾è‘—æå‡å¤æ‚æŠ¥è¡¨çš„å¼€å‘æ•ˆç‡å’Œæ‰§è¡Œæ€§èƒ½ã€‚æŒæ¡å…¶ä¸ &lt;code&gt;ROLLUP&lt;/code&gt;/&lt;code&gt;CUBE&lt;/code&gt; çš„å…³ç³»ã€åˆ†ç»„æ ‡è¯†å‡½æ•°åŠç©ºå€¼å¤„ç†æŠ€å·§ï¼Œå¯é«˜æ•ˆæ”¯æŒä»åŸºç¡€æ±‡æ€»åˆ°é«˜çº§äº¤å‰åˆ†æçš„å…¨åœºæ™¯éœ€æ±‚ã€‚å®è·µä¸­éœ€ç»“åˆæ•°æ®åº“ç‰¹æ€§ä¼˜åŒ–è¯­æ³•ï¼Œå¹¶é€šè¿‡é¢„è¿‡æ»¤å’Œç´¢å¼•è§„é¿æ€§èƒ½ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;h2 id="exists--in"&gt;exists &amp;amp; in
&lt;/h2&gt;&lt;p&gt;åœ¨ SQL ä¸­ï¼Œ&lt;code&gt;EXISTS&lt;/code&gt; å’Œ &lt;code&gt;IN&lt;/code&gt; å‡ç”¨äºå­æŸ¥è¯¢è¿‡æ»¤æ•°æ®ï¼Œä½†ä¸¤è€…åœ¨&lt;strong&gt;æ‰§è¡Œé€»è¾‘ã€æ€§èƒ½ã€é€‚ç”¨åœºæ™¯&lt;/strong&gt;ç­‰æ–¹é¢å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯ç»¼åˆå¯¹æ¯”åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”-1"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;EXISTS&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;IN&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡ŒåŸç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¾ªç¯éå†ä¸»è¡¨ï¼Œå¯¹æ¯è¡Œæ‰§è¡Œå­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢è¿”å›&lt;strong&gt;è‡³å°‘ä¸€è¡Œ&lt;/strong&gt;å³åŒ¹é…ï¼ˆçŸ­è·¯æœºåˆ¶ï¼‰&lt;/td&gt;
&lt;td&gt;å…ˆæ‰§è¡Œå­æŸ¥è¯¢ç”Ÿæˆç»“æœé›†ï¼Œä¸»è¡¨å­—æ®µä¸ç»“æœé›†è¿›è¡Œ&lt;strong&gt;å€¼åŒ¹é…&lt;/strong&gt;ï¼ˆç±»ä¼¼å¤šå€¼&lt;code&gt;OR&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¸ƒå°”å€¼ï¼ˆ&lt;code&gt;TRUE/FALSE&lt;/code&gt;ï¼‰ï¼Œä¸è¿”å›å…·ä½“æ•°æ®&lt;/td&gt;
&lt;td&gt;éœ€è¿”å›&lt;strong&gt;å…·ä½“å­—æ®µå€¼&lt;/strong&gt;çš„åˆ—è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å…³é”®ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­æŸ¥è¯¢ç»“æœé›†å¤§æ—¶æ›´ä¼˜ï¼ˆåŒ¹é…å³ç»ˆæ­¢ï¼‰&lt;/td&gt;
&lt;td&gt;å­æŸ¥è¯¢ç»“æœé›†å°æ—¶æ›´ä¼˜ï¼ˆé¿å…å¤šæ¬¡æ‰«æï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç´¢å¼•åˆ©ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–å­æŸ¥è¯¢è¡¨çš„ç´¢å¼•&lt;/td&gt;
&lt;td&gt;ä¾èµ–ä¸»æŸ¥è¯¢è¡¨çš„ç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;NULL å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿½ç•¥å­æŸ¥è¯¢ä¸­çš„ &lt;code&gt;NULL&lt;/code&gt;ï¼Œé€»è¾‘æ›´å®‰å…¨&lt;/td&gt;
&lt;td&gt;è‹¥å­æŸ¥è¯¢å« &lt;code&gt;NULL&lt;/code&gt;ï¼Œ&lt;code&gt;NOT IN&lt;/code&gt; å¯èƒ½è¿”å›ç©ºç»“æœ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½å¯¹æ¯”ä¸ä¼˜åŒ–å»ºè®®"&gt;âš¡ &lt;strong&gt;æ€§èƒ½å¯¹æ¯”ä¸ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ€§èƒ½å·®å¼‚çš„æœ¬è´¨"&gt;&lt;strong&gt;æ€§èƒ½å·®å¼‚çš„æœ¬è´¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;EXISTS
&lt;/code&gt;&lt;/pre&gt;ä¼˜åŠ¿åœºæ™¯ï¼š
å½“
å­æŸ¥è¯¢è¡¨å¤§ã€ä¸»è¡¨å°**æ—¶ï¼Œ
&lt;pre tabindex="0"&gt;&lt;code&gt;EXISTS
&lt;/code&gt;&lt;/pre&gt;é€šè¿‡çŸ­è·¯æœºåˆ¶å‡å°‘æ‰«æé‡ï¼ˆä¾‹ï¼šä¸»è¡¨ 1 ä¸‡è¡Œï¼Œå­è¡¨ 100 ä¸‡è¡Œï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;-- ç¤ºä¾‹ï¼šå¿«é€Ÿç­›é€‰æœ‰è®¢å•çš„å®¢æˆ·ï¼ˆOrders è¡¨å¤§ï¼‰
SELECT * FROM Customers c
WHERE EXISTS (SELECT 1 FROM Orders o WHERE o.customer_id = c.id);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;IN
&lt;/code&gt;&lt;/pre&gt;ä¼˜åŠ¿åœºæ™¯ï¼š
å½“
å­æŸ¥è¯¢è¡¨å°ã€ä¸»è¡¨å¤§**æ—¶ï¼Œ
&lt;pre tabindex="0"&gt;&lt;code&gt;IN
&lt;/code&gt;&lt;/pre&gt;ä»…éœ€ä¸€æ¬¡å­æŸ¥è¯¢æ‰«æï¼ˆä¾‹ï¼šå­æŸ¥è¯¢è¿”å› 100 ä¸ªå›ºå®šå€¼ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;-- ç¤ºä¾‹ï¼šç­›é€‰ç‰¹å®šåŸå¸‚çš„å®¢æˆ·ï¼ˆåŸå¸‚åˆ—è¡¨å°ï¼‰
SELECT * FROM Customers
WHERE city IN (&amp;#39;New York&amp;#39;, &amp;#39;London&amp;#39;, &amp;#39;Tokyo&amp;#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç´¢å¼•çš„å½±å“"&gt;&lt;strong&gt;ç´¢å¼•çš„å½±å“&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;EXISTS&lt;/code&gt;&lt;/strong&gt;ï¼šå­æŸ¥è¯¢å…³è”å­—æ®µéœ€ç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;Orders.customer_id&lt;/code&gt; ç´¢å¼•åŠ é€ŸåŒ¹é…ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;IN&lt;/code&gt;&lt;/strong&gt;ï¼šä¸»æŸ¥è¯¢å­—æ®µéœ€ç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;Customers.city&lt;/code&gt; ç´¢å¼•åŠ é€Ÿå€¼åŒ¹é…ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¼˜åŒ–åŸåˆ™"&gt;&lt;strong&gt;ä¼˜åŒ–åŸåˆ™&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èæ“ä½œç¬¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å­æŸ¥è¯¢ç»“æœé›†å¤§ + ä¸»è¡¨å°&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXISTS&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çŸ­è·¯æœºåˆ¶å‡å°‘æ‰«æ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­æŸ¥è¯¢ç»“æœé›†å° + ä¸»è¡¨å¤§&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IN&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é¿å…é€è¡Œè§¦å‘å­æŸ¥è¯¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é™æ€å€¼åˆ—è¡¨ï¼ˆå¦‚æšä¸¾å€¼ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IN&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¯­æ³•ç®€æ´ä¸”é«˜æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å…³è”æ¡ä»¶å¤æ‚ï¼ˆå¤šå­—æ®µå…³è”ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXISTS&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çµæ´»æ”¯æŒå¤šæ¡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯åˆ†æ"&gt;ğŸ§© &lt;strong&gt;é€‚ç”¨åœºæ™¯åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ¨èä½¿ç”¨"&gt;&lt;strong&gt;æ¨èä½¿ç”¨ &lt;code&gt;EXISTS&lt;/code&gt; çš„åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å­˜åœ¨æ€§æ£€æŸ¥
ï¼ˆå¦‚â€œæœ‰è®¢å•çš„å®¢æˆ·â€ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM Departments d
WHERE EXISTS (SELECT 1 FROM Employees e WHERE e.dept_id = d.id);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å­æŸ¥è¯¢å«å¤æ‚æ¡ä»¶
ï¼ˆå¦‚å¤šè¡¨å…³è”ã€èšåˆï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM Products p
WHERE EXISTS (
SELECT 1 FROM OrderDetails od
JOIN Orders o ON od.order_id = o.id
WHERE od.product_id = p.id AND o.date &amp;gt; &amp;#39;2025-01-01&amp;#39;
);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¨èä½¿ç”¨-1"&gt;&lt;strong&gt;æ¨èä½¿ç”¨ &lt;code&gt;IN&lt;/code&gt; çš„åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å›ºå®šå€¼åŒ¹é…
ï¼ˆå¦‚çŠ¶æ€æšä¸¾ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM Orders
WHERE status IN (&amp;#39;Pending&amp;#39;, &amp;#39;Shipped&amp;#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å­æŸ¥è¯¢ç»“æœé›†æå°
ï¼ˆå¦‚ä¸»é”®åˆ—è¡¨ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM Users
WHERE id IN (SELECT user_id FROM Admins WHERE active = 1);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-null-å€¼çš„å¤„ç†å·®å¼‚"&gt;âš ï¸ &lt;strong&gt;NULL å€¼çš„å¤„ç†å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;IN
&lt;/code&gt;&lt;/pre&gt;çš„é™·é˜±**ï¼š
è‹¥å­æŸ¥è¯¢è¿”å›&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; NULL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ï¼Œ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;NOT IN
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¼šå› &lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; NULL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ¯”è¾ƒå¤±è´¥è¿”å›ç©ºç»“æœï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- å‡è®¾å­æŸ¥è¯¢å« NULL å€¼
SELECT * FROM Table1
WHERE col NOT IN (SELECT col FROM Table2); -- å¯èƒ½è¿”å›ç©ºé›†
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;EXISTS
&lt;/code&gt;&lt;/pre&gt;çš„å®‰å…¨æ€§**ï¼š
é€»è¾‘ä»…å…³æ³¨è¡Œæ˜¯å¦å­˜åœ¨ï¼Œå¿½ç•¥&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; NULL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å€¼ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM Table1 t1
WHERE NOT EXISTS (SELECT 1 FROM Table2 t2 WHERE t2.col = t1.col);
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å¤šåˆ—æ“ä½œçš„æ”¯æŒ"&gt;ğŸ› ï¸ &lt;strong&gt;å¤šåˆ—æ“ä½œçš„æ”¯æŒ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;IN
&lt;/code&gt;&lt;/pre&gt;çš„é™åˆ¶**ï¼š
å¤šæ•°æ•°æ®åº“ï¼ˆå¦‚ Oracleã€SQL Serverï¼‰ä¸æ”¯æŒå¤šåˆ—ç›´æ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; IN
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ï¼ˆéœ€ç”¨å…ƒç»„è¯­æ³•ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- PostgreSQL/MySQL æ”¯æŒå¤šåˆ— IN
SELECT * FROM TableA
WHERE (col1, col2) IN (SELECT col1, col2 FROM TableB);
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;EXISTS
&lt;/code&gt;&lt;/pre&gt;çš„çµæ´»æ€§**ï¼š
å¤©ç„¶æ”¯æŒå¤šå­—æ®µå…³è”æ¡ä»¶ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM TableA a
WHERE EXISTS (
SELECT 1 FROM TableB b
WHERE b.col1 = a.col1 AND b.col2 = a.col2
);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“é€‰æ‹©ç­–ç•¥"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šé€‰æ‹©ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;EXISTS&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;IN&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒé€»è¾‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜åœ¨æ€§æ£€æŸ¥ï¼ˆå¸ƒå°”ç»“æœï¼‰&lt;/td&gt;
&lt;td&gt;å€¼é›†åˆåŒ¹é…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ä¼˜å…ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­æŸ¥è¯¢å¤§è¡¨ + ä¸»è¡¨å°&lt;/td&gt;
&lt;td&gt;å­æŸ¥è¯¢å°è¡¨ + ä¸»è¡¨å¤§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;NULL å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å®‰å…¨&lt;/td&gt;
&lt;td&gt;âŒ &lt;code&gt;NOT IN&lt;/code&gt; éœ€è°¨æ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€å…³è”ã€å¤æ‚æ¡ä»¶ã€å­˜åœ¨æ€§éªŒè¯&lt;/td&gt;
&lt;td&gt;é™æ€åˆ—è¡¨ã€ç®€å•å€¼åŒ¹é…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šåˆ—æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… åŸç”Ÿæ”¯æŒ&lt;/td&gt;
&lt;td&gt;âš ï¸ æ•°æ®åº“å…¼å®¹æ€§å·®å¼‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†³ç­–æ ‘&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;å­æŸ¥è¯¢ç»“æœæ˜¯å¦å¾ˆå°ï¼Ÿ â†’ &lt;strong&gt;æ˜¯&lt;/strong&gt; â†’ ç”¨ &lt;code&gt;IN&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;æ˜¯å¦éœ€æ£€æŸ¥â€œæ˜¯å¦å­˜åœ¨â€ï¼Ÿ â†’ &lt;strong&gt;æ˜¯&lt;/strong&gt; â†’ ç”¨ &lt;code&gt;EXISTS&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;æ˜¯å¦æ¶‰åŠå¤šå­—æ®µå…³è”ï¼Ÿ â†’ &lt;strong&gt;æ˜¯&lt;/strong&gt; â†’ ç”¨ &lt;code&gt;EXISTS&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;æ˜¯å¦é™æ€å€¼åˆ—è¡¨ï¼Ÿ â†’ &lt;strong&gt;æ˜¯&lt;/strong&gt; â†’ ç”¨ &lt;code&gt;IN&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;ç»ˆæå»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆç”¨ &lt;code&gt;EXISTS&lt;/code&gt; å¤„ç†å…³è”å­æŸ¥è¯¢å’Œå­˜åœ¨æ€§éªŒè¯ï¼›&lt;/li&gt;
&lt;li&gt;é™æ€å€¼æˆ–å°ç»“æœé›†ç”¨ &lt;code&gt;IN&lt;/code&gt; æ›´ç›´è§‚ï¼›&lt;/li&gt;
&lt;li&gt;ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…é€šè¿‡ &lt;code&gt;EXPLAIN&lt;/code&gt; éªŒè¯æ‰§è¡Œè®¡åˆ’ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="sqlæ³¨å…¥"&gt;SQLæ³¨å…¥
&lt;/h2&gt;&lt;p&gt;SQLæ³¨å…¥ï¼ˆSQL Injectionï¼‰æ˜¯ä¸€ç§é’ˆå¯¹æ•°æ®åº“å±‚çš„æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡åœ¨ç”¨æˆ·è¾“å…¥ä¸­æ’å…¥æ¶æ„SQLä»£ç ï¼Œæ¬ºéª—æ•°æ®åº“æ‰§è¡Œéæˆæƒæ“ä½œã€‚ä»¥ä¸‹ä»åŸç†ã€ç±»å‹ã€å±å®³åˆ°é˜²å¾¡è¿›è¡Œå…¨é¢åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ”»å‡»åŸç†åŠ¨æ€æ‹¼æ¥çš„è‡´å‘½ç¼ºé™·"&gt;âš™ï¸ &lt;strong&gt;æ”»å‡»åŸç†ï¼šåŠ¨æ€æ‹¼æ¥çš„è‡´å‘½ç¼ºé™·&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ¼æ´&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åº”ç”¨ç¨‹åºå°†
ç”¨æˆ·è¾“å…¥ç›´æ¥æ‹¼æ¥
åˆ°SQLè¯­å¥ä¸­ï¼Œæœªè¿›è¡Œè¿‡æ»¤æˆ–è½¬ä¹‰ï¼Œä¾‹å¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM users WHERE username = &amp;#39;$input_username&amp;#39; AND password = &amp;#39;$input_password&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å½“ç”¨æˆ·è¾“å…¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; admin&amp;#39; --
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ—¶ï¼ŒSQLå˜ä¸ºï¼š
&lt;code&gt;SELECT * FROM users WHERE username = 'admin' --' AND password = ''; -- å¯†ç éªŒè¯è¢«æ³¨é‡Š&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”»å‡»è€…é€šè¿‡æ³¨é‡Šç¬¦ï¼ˆ&lt;code&gt;--&lt;/code&gt;ï¼‰ã€é€»è¾‘ç¬¦ï¼ˆ&lt;code&gt;OR 1=1&lt;/code&gt;ï¼‰ç­‰ç¯¡æ”¹æŸ¥è¯¢é€»è¾‘&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;å¿…è¦æ¡ä»¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·å¯æ§åˆ¶è¾“å…¥ï¼ˆå¦‚è¡¨å•ã€URLå‚æ•°ï¼‰&lt;/li&gt;
&lt;li&gt;è¾“å…¥æ•°æ®è¢«ç›´æ¥æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ”»å‡»ç±»å‹ä¸æ‰‹æ³•"&gt;ğŸ” &lt;strong&gt;æ”»å‡»ç±»å‹ä¸æ‰‹æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æŒ‰æ³¨å…¥ç‚¹åˆ†ç±»"&gt;&lt;strong&gt;æŒ‰æ³¨å…¥ç‚¹åˆ†ç±»&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°å­—å‹æ³¨å…¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‚æ•°ä¸ºæ•´å‹ï¼ˆå¦‚IDï¼‰ï¼Œæ— éœ€å¼•å·é—­åˆ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;id=1 AND 1=1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—ç¬¦å‹æ³¨å…¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼Œéœ€å•å¼•å·é—­åˆ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;username='admin' OR '1'='1'&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœç´¢å‹æ³¨å…¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨&lt;code&gt;LIKE&lt;/code&gt;æ¨¡ç³ŠåŒ¹é…ï¼Œéœ€é—­åˆé€šé…ç¬¦&lt;/td&gt;
&lt;td&gt;&lt;code&gt;keyword=%' AND 1=1 --&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æŒ‰æ”»å‡»æŠ€æœ¯åˆ†ç±»"&gt;&lt;strong&gt;æŒ‰æ”»å‡»æŠ€æœ¯åˆ†ç±»&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-Basedï¼‰
åˆ©ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;UNION SELECT
&lt;/code&gt;&lt;/pre&gt;åˆå¹¶æŸ¥è¯¢ç»“æœï¼Œçªƒå–å…¶ä»–è¡¨æ•°æ®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;id=1 UNION SELECT username, password FROM users --
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸ƒå°”ç›²æ³¨ï¼ˆBoolean Blindï¼‰&lt;/strong&gt;
é€šè¿‡é¡µé¢è¿”å›çœŸ/å‡çŠ¶æ€æ¨æµ‹æ•°æ®ï¼ˆå¦‚ &lt;code&gt;AND SUBSTRING(database(),1,1)='a'&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´ç›²æ³¨ï¼ˆTime-Based Blindï¼‰&lt;/strong&gt;
åˆ©ç”¨å»¶è¿Ÿå‡½æ•°åˆ¤æ–­æ¡ä»¶æˆç«‹ï¼ˆå¦‚ &lt;code&gt;IF(1=1,SLEEP(5),0)&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ¥é”™æ³¨å…¥ï¼ˆError-Basedï¼‰&lt;/strong&gt;
è§¦å‘æ•°æ®åº“æŠ¥é”™æ³„éœ²ä¿¡æ¯ï¼ˆå¦‚ &lt;code&gt;AND GTID_SUBSET(concat(0x7e,version()),1)&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å±å®³ä»æ•°æ®æ³„éœ²åˆ°ç³»ç»Ÿæ²¦é™·"&gt;ğŸ’¥ &lt;strong&gt;å±å®³ï¼šä»æ•°æ®æ³„éœ²åˆ°ç³»ç»Ÿæ²¦é™·&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ•°æ®æ³„éœ²&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;çªƒå–ç”¨æˆ·éšç§ã€ä¿¡ç”¨å¡å·ç­‰æ•æ„Ÿä¿¡æ¯&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;æ•°æ®ç¯¡æ”¹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä¿®æ”¹æˆ–åˆ é™¤æ•°æ®åº“è®°å½•ï¼ˆå¦‚ &lt;code&gt;UPDATE users SET balance=0&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;ç³»ç»Ÿæ§åˆ¶&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åˆ©ç”¨æ•°æ®åº“ç‰¹æƒåŠŸèƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚SQL Serverçš„ &lt;code&gt;xp_cmdshell('rm -rf /')&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡å¤æ‚æŸ¥è¯¢è€—å°½æ•°æ®åº“èµ„æºï¼ˆå¦‚ &lt;code&gt;WHILE 1=1 SELECT * FROM large_table&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ æ®ç»Ÿè®¡ï¼Œ&lt;strong&gt;97%çš„æ•°æ®æ³„éœ²äº‹ä»¶ä¸SQLæ³¨å…¥ç›¸å…³&lt;/strong&gt;ï¼ˆBarclaycard, 2012ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é˜²å¾¡æªæ–½å¤šå±‚é˜²æŠ¤ä½“ç³»"&gt;ğŸ›¡ï¸ &lt;strong&gt;é˜²å¾¡æªæ–½ï¼šå¤šå±‚é˜²æŠ¤ä½“ç³»&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä»£ç å±‚é˜²å¾¡"&gt;&lt;strong&gt;ä»£ç å±‚é˜²å¾¡&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æªæ–½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•ˆæœ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°åŒ–æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥ï¼ˆPrepared Statementsï¼‰åˆ†ç¦»ä»£ç ä¸æ•°æ®&lt;/td&gt;
&lt;td&gt;âœ… æ ¹æ²»æ‹¼æ¥é—®é¢˜ï¼ˆæœ€æœ‰æ•ˆï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¾“å…¥è¿‡æ»¤ä¸è½¬ä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ &lt;code&gt;'&lt;/code&gt;â†’&lt;code&gt;\'&lt;/code&gt;ï¼‰ï¼Œæˆ–ä½¿ç”¨ç™½åå•éªŒè¯ï¼ˆå¦‚ä»…å…è®¸å­—æ¯æ•°å­—ï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ éœ€ç»“åˆå…¶ä»–æªæ–½ï¼ˆå¯èƒ½è¢«ç»•è¿‡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ORMæ¡†æ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Hibernateç­‰æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆå‚æ•°åŒ–SQL&lt;/td&gt;
&lt;td&gt;âœ… å‡å°‘æ‰‹å†™SQLé£é™©&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ç³»ç»Ÿå±‚åŠ å›º"&gt;&lt;strong&gt;ç³»ç»Ÿå±‚åŠ å›º&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ€å°æƒé™åŸåˆ™&lt;/strong&gt;ï¼šæ•°æ®åº“è´¦å·ä»…èµ‹äºˆå¿…è¦æƒé™ï¼ˆå¦‚ç¦ç”¨&lt;code&gt;DROP&lt;/code&gt;ã€&lt;code&gt;xp_cmdshell&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯ä¿¡æ¯éšè—&lt;/strong&gt;ï¼šç¦æ­¢å‘ç”¨æˆ·å±•ç¤ºæ•°æ®åº“æŠ¥é”™ç»†èŠ‚ï¼ˆé˜²ä¿¡æ¯æ³„éœ²ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰&lt;/strong&gt;ï¼šè¿‡æ»¤æ¶æ„è¯·æ±‚ï¼ˆå¦‚å«&lt;code&gt;UNION SELECT&lt;/code&gt;çš„æµé‡ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç®¡ç†æªæ–½"&gt;&lt;strong&gt;ç®¡ç†æªæ–½&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šæœŸæ¸—é€æµ‹è¯•&lt;/strong&gt;ï¼šä½¿ç”¨SQLMapç­‰å·¥å…·æ‰«ææ¼æ´&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨å¼€å‘åŸ¹è®­&lt;/strong&gt;ï¼šå¼ºåˆ¶è¦æ±‚å¼€å‘è€…å­¦ä¹ å®‰å…¨ç¼–ç è§„èŒƒ&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ”»å‡»æµç¨‹å›¾è§£"&gt;ğŸ”„ &lt;strong&gt;æ”»å‡»æµç¨‹å›¾è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[ç”¨æˆ·è¾“å…¥æ¶æ„æ•°æ®] --&amp;gt; B{åº”ç”¨ç¨‹åºæœªè¿‡æ»¤}
B --&amp;gt; C[æ‹¼æ¥æ¶æ„SQLè¯­å¥]
C --&amp;gt; D[æ•°æ®åº“æ‰§è¡Œéæ³•æ“ä½œ]
D --&amp;gt; E[æ•°æ®æ³„éœ²/ç³»ç»Ÿæ§åˆ¶]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¹æœ¬åŸå› &lt;/strong&gt;ï¼šä¿¡ä»»ç”¨æˆ·è¾“å…¥ + åŠ¨æ€SQLæ‹¼æ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜²å¾¡æ ¸å¿ƒ&lt;/strong&gt;ï¼š
âœ… â€‹&lt;strong&gt;å‚æ•°åŒ–æŸ¥è¯¢&lt;/strong&gt;â€‹ï¼ˆæœç»æ‹¼æ¥ï¼‰ + â€‹&lt;strong&gt;æœ€å°æƒé™&lt;/strong&gt;â€‹ï¼ˆé™åˆ¶ç ´åèŒƒå›´ï¼‰ + â€‹&lt;strong&gt;çºµæ·±é˜²å¾¡&lt;/strong&gt;â€‹ï¼ˆä»£ç +ç³»ç»Ÿ+ç®¡ç†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒç»­é˜²æŠ¤&lt;/strong&gt;ï¼šSQLæ³¨å…¥å˜ç§å±‚å‡ºä¸ç©·ï¼Œéœ€ç»“åˆè‡ªåŠ¨åŒ–å·¥å…·ä¸äººå·¥å®¡è®¡æŒç»­ç›‘æ§&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡åˆ†å±‚é˜²å¾¡ç­–ç•¥ï¼Œå¯å°†SQLæ³¨å…¥é£é™©é™è‡³æœ€ä½ã€‚å»ºè®®å¼€å‘è€…ä¼˜å…ˆé‡‡ç”¨ORMæ¡†æ¶ä¸é¢„ç¼–è¯‘è¯­å¥ï¼Œå¹¶å®šæœŸä½¿ç”¨SQLMapè¿›è¡Œæ¼æ´æ‰«æ&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å‚æ•°åŒ–æŸ¥è¯¢"&gt;å‚æ•°åŒ–æŸ¥è¯¢
&lt;/h2&gt;&lt;p&gt;å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆParameterized Queryï¼‰æ˜¯ä¸€ç§åœ¨SQLè¯­å¥ä¸­ä½¿ç”¨å ä½ç¬¦ä»£æ›¿å®é™…å€¼ï¼Œå¹¶å°†ç”¨æˆ·è¾“å…¥ä½œä¸ºå‚æ•°ä¼ é€’çš„æ•°æ®åº“æ“ä½œæŠ€æœ¯ã€‚å®ƒé€šè¿‡åˆ†ç¦»SQLé€»è¾‘ä¸æ•°æ®è¾“å…¥ï¼Œæ˜¾è‘—æå‡å®‰å…¨æ€§å’Œæ€§èƒ½ï¼Œæ˜¯é˜²èŒƒSQLæ³¨å…¥çš„é¦–é€‰æ–¹æ¡ˆã€‚ä»¥ä¸‹ä»åŸç†ã€ä¼˜åŠ¿ã€å®ç°åˆ°æœ€ä½³å®è·µè¿›è¡Œå…¨é¢è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸å·¥ä½œæœºåˆ¶"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸å·¥ä½œæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å ä½ç¬¦æ›¿ä»£å€¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;SQLè¯­å¥ä¸­éœ€åŠ¨æ€å¡«å…¥çš„å€¼ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ï¼‰è¢«æ›¿æ¢ä¸ºå ä½ç¬¦ï¼ˆå¦‚&lt;code&gt;@username&lt;/code&gt;ã€&lt;code&gt;?&lt;/code&gt;ï¼‰ï¼Œå®é™…å€¼é€šè¿‡å‚æ•°ç»‘å®šä¼ é€’&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM users WHERE username = @username; -- SQL Server
SELECT * FROM products WHERE id = ?; -- MySQL
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œæµç¨‹&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¢„ç¼–è¯‘&lt;/strong&gt;ï¼šæ•°æ®åº“å…ˆè§£æSQLç»“æ„ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼ˆä¸ä¾èµ–å…·ä½“å‚æ•°å€¼ï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°ç»‘å®š&lt;/strong&gt;ï¼šè¿è¡Œæ—¶å°†å®é™…å€¼å®‰å…¨æ³¨å…¥å ä½ç¬¦ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œä¼˜åŒ–&lt;/strong&gt;ï¼šç›¸åŒSQLç»“æ„å¤ç”¨é¢„ç¼–è¯‘è®¡åˆ’ï¼Œé¿å…é‡å¤è§£æ&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[SQLè¯­å¥é¢„ç¼–è¯‘] --&amp;gt; B[å‚æ•°ç»‘å®š]
B --&amp;gt; C[æ‰§è¡Œè®¡åˆ’å¤ç”¨]
C --&amp;gt; D[é«˜æ•ˆæ‰§è¡Œ]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä¼˜åŠ¿"&gt;ğŸ›¡ï¸ &lt;strong&gt;æ ¸å¿ƒä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœç»SQLæ³¨å…¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å‚æ•°å€¼è¢«ä¸¥æ ¼è§†ä¸ºæ•°æ®è€Œéä»£ç ï¼Œæ¶æ„è¾“å…¥ï¼ˆå¦‚&lt;code&gt;' OR 1=1 --&lt;/code&gt;ï¼‰æ— æ³•ç¯¡æ”¹æŸ¥è¯¢é€»è¾‘&lt;a class="link" href="@ref" &gt;1,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æå‡æ€§èƒ½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘ç¼–è¯‘å¼€é”€&lt;/strong&gt;ï¼šç›¸åŒSQLæ¨¡æ¿ä»…éœ€ç¼–è¯‘ä¸€æ¬¡ï¼Œåç»­æ‰§è¡Œç›´æ¥å¤ç”¨è®¡åˆ’&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ä¼˜åŒ–&lt;/strong&gt;ï¼šæ•°æ®åº“ç¼“å­˜å‚æ•°åŒ–æŸ¥è¯¢è®¡åˆ’ï¼Œé™ä½CPUå’Œå†…å­˜æ¶ˆè€—&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢å¼ºå¯ç»´æŠ¤æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;SQLé€»è¾‘ä¸æ•°æ®åˆ†ç¦»ï¼Œä»£ç æ›´æ¸…æ™°æ˜“è¯»ï¼Œä¿®æ”¹å‚æ•°æ— éœ€é‡å†™SQL&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å„æ•°æ®åº“å®ç°è¯­æ³•å¯¹æ¯”"&gt;âš™ï¸ &lt;strong&gt;å„æ•°æ®åº“å®ç°è¯­æ³•å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®åº“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å ä½ç¬¦æ ¼å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;SQL Server&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@å‚æ•°å&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;cmd.Parameters.AddWithValue(&amp;quot;@age&amp;quot;, 25)&lt;/code&gt; &lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;MySQL&lt;/td&gt;
&lt;td&gt;&lt;code&gt;?&lt;/code&gt; æˆ– &lt;code&gt;?param&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;cmd.Parameters.Add(&amp;quot;?name&amp;quot;, &amp;quot;Alice&amp;quot;)&lt;/code&gt; &lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PostgreSQL&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:å‚æ•°å&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;cmd.Parameters.Add(&amp;quot;:city&amp;quot;, &amp;quot;Paris&amp;quot;)&lt;/code&gt; &lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Oracle&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:å‚æ•°å&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŒPostgreSQL&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQLite&lt;/td&gt;
&lt;td&gt;&lt;code&gt;?&lt;/code&gt; æˆ– &lt;code&gt;:å‚æ•°å&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å…¼å®¹MySQL/PostgreSQLé£æ ¼ &lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç¼–ç¨‹è¯­è¨€ä¸­çš„å®ç°ç¤ºä¾‹"&gt;ğŸ’» &lt;strong&gt;ç¼–ç¨‹è¯­è¨€ä¸­çš„å®ç°ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="python-psycopg2"&gt;&lt;strong&gt;Python (psycopg2)&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;import psycopg2
conn = psycopg2.connect(database=&amp;#34;test&amp;#34;)
cur = conn.cursor()
query = &amp;#34;INSERT INTO orders (product, quantity) VALUES (%s, %s)&amp;#34; # å ä½ç¬¦
params = (&amp;#34;Laptop&amp;#34;, 3)
cur.execute(query, params) # å‚æ•°ç»‘å®š
conn.commit()
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="java-jdbc"&gt;&lt;strong&gt;Java (JDBC)&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;String sql = &amp;#34;UPDATE users SET email = ? WHERE id = ?&amp;#34;;
try (PreparedStatement stmt = conn.prepareStatement(sql)) {
stmt.setString(1, &amp;#34;user@example.com&amp;#34;); // ç»‘å®šå‚æ•°1
stmt.setInt(2, 1001); // ç»‘å®šå‚æ•°2
stmt.executeUpdate();
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="c-adonet"&gt;&lt;strong&gt;C# (ADO.NET)&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;using (SqlCommand cmd = new SqlCommand(&amp;#34;SELECT * FROM employees WHERE dept = @dept&amp;#34;, conn)) {
cmd.Parameters.AddWithValue(&amp;#34;@dept&amp;#34;, &amp;#34;Engineering&amp;#34;); // ç»‘å®šå‚æ•°
SqlDataReader reader = cmd.ExecuteReader();
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–å…³é”®ç‚¹"&gt;âš ï¸ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–å…³é”®ç‚¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ˜¾å¼æŒ‡å®šå‚æ•°ç±»å‹ä¸é•¿åº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯å˜é•¿åº¦ç±»å‹
ï¼ˆå¦‚
&lt;pre tabindex="0"&gt;&lt;code&gt;varchar
&lt;/code&gt;&lt;/pre&gt;ï¼‰ï¼šå¿…é¡»æŒ‡å®šé•¿åº¦ï¼ˆå¦‚
&lt;pre tabindex="0"&gt;&lt;code&gt;SqlDbType.VarChar, 50
&lt;/code&gt;&lt;/pre&gt;ï¼‰ï¼Œé¿å…å› å€¼é•¿åº¦å˜åŒ–å¯¼è‡´æ‰§è¡Œè®¡åˆ’æ— æ³•å¤ç”¨
3
ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ­£ç¡®ï¼šæŒ‡å®šé•¿åº¦
cmd.Parameters.Add(new SqlParameter(&amp;#34;@name&amp;#34;, SqlDbType.VarChar, 50) { Value = &amp;#34;Alice&amp;#34; });
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›ºå®šé•¿åº¦ç±»å‹&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;int&lt;/code&gt;ï¼‰ï¼šä»…éœ€æŒ‡å®šç±»å‹ï¼ˆå¦‚&lt;code&gt;SqlDbType.Int&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…åŠ¨æ€SQLæ‹¼æ¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å³ä½¿ä½¿ç”¨å‚æ•°åŒ–ï¼Œä¹Ÿåº”é¿å…é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥ç”ŸæˆåŠ¨æ€SQLï¼ˆå¦‚&lt;code&gt;SELECT * FROM {table}&lt;/code&gt;ï¼‰ï¼Œæ”¹ç”¨è®¾è®¡æ¨¡å¼ï¼ˆå¦‚ç­–ç•¥æ¨¡å¼ï¼‰æˆ–ORMæ¡†æ¶&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§è¯¯åŒºä¸é¿å‘æŒ‡å—"&gt;ğŸš« &lt;strong&gt;å¸¸è§è¯¯åŒºä¸é¿å‘æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è¯¯åŒº&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ­£è§£&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;â€œå†…éƒ¨ç³»ç»Ÿæ— éœ€å‚æ•°åŒ–â€&lt;/td&gt;
&lt;td&gt;ä»»ä½•ç³»ç»Ÿéƒ½å¯èƒ½å› è¾“å…¥æ¼æ´è¢«æ¸—é€ï¼Œå‚æ•°åŒ–æ˜¯åŸºç¡€é˜²çº¿&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;â€œå‚æ•°ç±»å‹/é•¿åº¦æ— å…³ç´§è¦â€&lt;/td&gt;
&lt;td&gt;æœªæŒ‡å®šé•¿åº¦æ—¶ï¼Œ&lt;code&gt;varchar&lt;/code&gt;å‚æ•°å› å€¼é•¿åº¦å˜åŒ–å¯¼è‡´è®¡åˆ’æ— æ³•å¤ç”¨ï¼Œæ€§èƒ½ä¸‹é™&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;â€œè½¬ä¹‰å‡½æ•°æ›¿ä»£å‚æ•°åŒ–â€&lt;/td&gt;
&lt;td&gt;&lt;code&gt;mysql_real_escape_string&lt;/code&gt;æ— æ³•é˜²å¾¡æ•°å€¼å‹æ³¨å…¥ï¼Œä¸”éé¢„ç¼–è¯‘æ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-è¿›é˜¶åº”ç”¨åœºæ™¯"&gt;ğŸ”§ &lt;strong&gt;è¿›é˜¶åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡æ“ä½œä¼˜åŒ–&lt;/strong&gt;
å•æ¬¡æäº¤å¤šç»„å‚æ•°ï¼Œå‡å°‘äº‹åŠ¡å¼€é”€ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;using (SqlTransaction trans = conn.BeginTransaction()) {
foreach (var user in users) {
cmd.Parameters[&amp;#34;@name&amp;#34;].Value = user.Name;
cmd.ExecuteNonQuery(); // å¤ç”¨åŒä¸€å‘½ä»¤
}
trans.Commit();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€è¿‡æ»¤ä¸åˆ†é¡µ&lt;/strong&gt;
å‚æ•°åŒ–å®ç°çµæ´»æŸ¥è¯¢ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- åˆ†é¡µæŸ¥è¯¢
SELECT * FROM products
ORDER BY id
OFFSET @offset ROWS FETCH NEXT @pageSize ROWS ONLY;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨è¿‡ç¨‹è°ƒç”¨&lt;/strong&gt;
å‚æ•°åŒ–ä¼ é€’å­˜å‚¨è¿‡ç¨‹å…¥å‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;EXEC GetUserDetails @userID = 123;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“æœ€ä½³å®è·µ"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šæœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼ºåˆ¶ä½¿ç”¨å‚æ•°åŒ–&lt;/strong&gt;ï¼šæ‰€æœ‰ç”¨æˆ·è¾“å…¥å¿…é¡»é€šè¿‡å‚æ•°ä¼ é€’ï¼Œç¦ç”¨å­—ç¬¦ä¸²æ‹¼æ¥SQLã€‚&lt;/li&gt;
&lt;li&gt;è§„èŒƒå‚æ•°å®šä¹‰ï¼š
&lt;ul&gt;
&lt;li&gt;å¯å˜é•¿åº¦ç±»å‹ï¼ˆ&lt;code&gt;varchar&lt;/code&gt;ç­‰ï¼‰æ˜¾å¼å£°æ˜é•¿åº¦ã€‚&lt;/li&gt;
&lt;li&gt;å€¼ç±»å‹ï¼ˆ&lt;code&gt;int&lt;/code&gt;/&lt;code&gt;datetime&lt;/code&gt;ç­‰ï¼‰æŒ‡å®šå‡†ç¡®ç±»å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“åˆORMæ¡†æ¶&lt;/strong&gt;ï¼šå¦‚Entity Frameworkã€Hibernateï¼Œè‡ªåŠ¨ç”Ÿæˆå‚æ•°åŒ–æŸ¥è¯¢&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®šæœŸå®¡è®¡SQL&lt;/strong&gt;ï¼šä½¿ç”¨SQLMapæ‰«ææ³¨å…¥æ¼æ´ï¼ŒéªŒè¯å‚æ•°åŒ–è¦†ç›–ç‡&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å‚æ•°åŒ–æŸ¥è¯¢æ˜¯æ•°æ®åº“å®‰å…¨çš„åŸºçŸ³ï¼Œå…¶æ€§èƒ½ä¼˜åŠ¿åœ¨å¹¶å‘åœºæ™¯ä¸‹å°¤ä¸ºæ˜¾è‘—ã€‚é€šè¿‡ä¸¥æ ¼éµå¾ªç±»å‹è§„èŒƒä¸å¤ç”¨æœºåˆ¶ï¼Œå¯åŒæ—¶å®ç°&lt;strong&gt;å®‰å…¨åŠ å›º&lt;/strong&gt;ä¸&lt;strong&gt;æ€§èƒ½æå‡&lt;/strong&gt;çš„åŒé‡ç›®æ ‡&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="update-join"&gt;UPDATE JOIN
&lt;/h2&gt;&lt;p&gt;UPDATE JOINæ˜¯SQLä¸­ç”¨äºåŸºäºå…³è”è¡¨æ•°æ®æ›´æ–°ç›®æ ‡è¡¨çš„å¼ºå¤§å·¥å…·ï¼Œç»“åˆäº†&lt;code&gt;UPDATE&lt;/code&gt;å’Œ&lt;code&gt;JOIN&lt;/code&gt;çš„åŠŸèƒ½ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€è¯­æ³•ã€åœºæ™¯åˆ°ä¼˜åŒ–è¿›è¡Œå…¨é¢è§£æï¼Œé‡ç‚¹ä»¥MySQLè¯­æ³•ä¸ºä¾‹ï¼Œå…¶ä»–æ•°æ®åº“é€»è¾‘ç±»ä¼¼ä½†è¯­æ³•å¯èƒ½æœ‰å·®å¼‚ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸ä½œç”¨"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸ä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;
UPDATE JOINé€šè¿‡&lt;strong&gt;å…³è”æ¡ä»¶&lt;/strong&gt;å°†ç›®æ ‡è¡¨ï¼ˆéœ€æ›´æ–°çš„è¡¨ï¼‰ä¸æºè¡¨ï¼ˆæä¾›æ•°æ®çš„è¡¨ï¼‰è¿æ¥ï¼Œç”¨æºè¡¨çš„æ•°æ®æˆ–è¡¨è¾¾å¼æ›´æ–°ç›®æ ‡è¡¨çš„æŒ‡å®šåˆ—ã€‚æ‰§è¡Œæµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥é˜¶æ®µ&lt;/strong&gt;ï¼šæ ¹æ®JOINç±»å‹ï¼ˆINNER/LEFT/RIGHTï¼‰åŒ¹é…ä¸¤è¡¨è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–°é˜¶æ®µ&lt;/strong&gt;ï¼šå¯¹åŒ¹é…è¡Œæ‰§è¡ŒSETæ“ä½œï¼Œä¿®æ”¹ç›®æ ‡è¡¨æ•°æ®&lt;a class="link" href="@ref" &gt;1,6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ™®é€šUPDATEçš„åŒºåˆ«&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¯¹æ¯”é¡¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ™®é€šUPDATE&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;UPDATE JOIN&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ•°æ®æ¥æº&lt;/td&gt;
&lt;td&gt;ä»…å½“å‰è¡¨&lt;/td&gt;
&lt;td&gt;å¯è·¨å¤šè¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ›´æ–°ä¾æ®&lt;/td&gt;
&lt;td&gt;ç›´æ¥èµ‹å€¼æˆ–è¡¨è¾¾å¼&lt;/td&gt;
&lt;td&gt;ä¾èµ–å…³è”è¡¨çš„å­—æ®µæˆ–è®¡ç®—ç»“æœ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é€‚ç”¨åœºæ™¯&lt;/td&gt;
&lt;td&gt;å•è¡¨æ•°æ®ä¿®æ”¹&lt;/td&gt;
&lt;td&gt;å¤šè¡¨å…³è”çš„æ‰¹é‡æ›´æ–°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¯­æ³•è¯¦è§£ä¸joinç±»å‹"&gt;ğŸ“ &lt;strong&gt;è¯­æ³•è¯¦è§£ä¸JOINç±»å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºç¡€è¯­æ³•ç»“æ„"&gt;&lt;strong&gt;åŸºç¡€è¯­æ³•ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE ç›®æ ‡è¡¨ [åˆ«å]
[INNER | LEFT | RIGHT] JOIN æºè¡¨ [åˆ«å] ON å…³è”æ¡ä»¶
SET ç›®æ ‡è¡¨.åˆ—1 = æºè¡¨.åˆ—2 [ï¼Œç›®æ ‡è¡¨.åˆ—2 = è¡¨è¾¾å¼ ...]
[WHERE è¿‡æ»¤æ¡ä»¶];
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç›®æ ‡è¡¨&lt;/strong&gt;ï¼šéœ€æ›´æ–°çš„ä¸»è¡¨ï¼Œå¿…é¡»ä½œä¸º&lt;code&gt;UPDATE&lt;/code&gt;åç¬¬ä¸€ä¸ªè¡¨&lt;a class="link" href="@ref" &gt;8,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æºè¡¨&lt;/strong&gt;ï¼šæä¾›æ•°æ®çš„å…³è”è¡¨ï¼Œæ”¯æŒå¤šè¡¨JOINï¼ˆéœ€å¤šæ¬¡&lt;code&gt;JOIN&lt;/code&gt;å­å¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³è”æ¡ä»¶&lt;/strong&gt;ï¼šå¦‚&lt;code&gt;ON ç›®æ ‡è¡¨.id = æºè¡¨.foreign_id&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SETå­å¥&lt;/strong&gt;ï¼šå¯æ›´æ–°å¤šåˆ—ï¼Œå€¼å¯ä¸ºæºè¡¨å­—æ®µã€è¡¨è¾¾å¼æˆ–å‡½æ•°ç»“æœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;WHERE&lt;/strong&gt;ï¼šå¯é€‰ï¼Œé™åˆ¶æ›´æ–°èŒƒå›´&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸åŒjoinç±»å‹çš„å½±å“"&gt;&lt;strong&gt;ä¸åŒJOINç±»å‹çš„å½±å“&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;JOINç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ›´æ–°èŒƒå›´&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;INNER JOIN&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…æ›´æ–°ä¸¤è¡¨åŒ¹é…çš„è¡Œ&lt;/td&gt;
&lt;td&gt;ç²¾ç¡®å…³è”æ›´æ–°ï¼ˆå¦‚ç”¨å•†å“è¡¨æ›´æ–°åº“å­˜ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;LEFT JOIN&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ›´æ–°ç›®æ ‡è¡¨æ‰€æœ‰è¡Œï¼ŒæœªåŒ¹é…çš„æºè¡¨å­—æ®µä¸º&lt;code&gt;NULL&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¸…ç†æ— æ•ˆæ•°æ®ï¼ˆå¦‚æ— åº“å­˜å•†å“æ ‡è®°åœäº§ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RIGHT JOIN&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ›´æ–°æºè¡¨æ‰€æœ‰è¡Œï¼ˆMySQLè¾ƒå°‘ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€åŒæ­¥æ›´æ–°ç›®æ ‡è¡¨ç¼ºå¤±è®°å½•çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ æ³¨ï¼šMySQLä¸æ”¯æŒ&lt;code&gt;FULL JOIN&lt;/code&gt;ï¼Œéœ€é€šè¿‡&lt;code&gt;LEFT JOIN + RIGHT JOIN&lt;/code&gt;æ¨¡æ‹Ÿ&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹"&gt;ğŸ› ï¸ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºç¡€æ•°æ®åŒæ­¥"&gt;&lt;strong&gt;åŸºç¡€æ•°æ®åŒæ­¥&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åœºæ™¯ï¼šç”¨å®¢æˆ·è¡¨æ›´æ–°è®¢å•è¡¨çš„å®¢æˆ·å§“å
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE orders o
INNER JOIN customers c ON o.customer_id = c.id
SET o.customer_name = c.name;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆæœ&lt;/strong&gt;ï¼šä»…æ›´æ–°&lt;code&gt;orders&lt;/code&gt;ä¸&lt;code&gt;customers&lt;/code&gt;åŒ¹é…çš„è¡Œ&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¡ä»¶æ›´æ–°ä¸è¡¨è¾¾å¼"&gt;&lt;strong&gt;æ¡ä»¶æ›´æ–°ä¸è¡¨è¾¾å¼&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åœºæ™¯ï¼šVIPå®¢æˆ·è®¢å•å¢åŠ æŠ˜æ‰£
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE orders o
LEFT JOIN customers c ON o.customer_id = c.id
SET o.discount_rate =
CASE
WHEN c.vip_level &amp;gt;= 3 THEN 0.2
WHEN c.vip_level = 2 THEN 0.15
ELSE 0.05
END;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®&lt;/strong&gt;ï¼š&lt;code&gt;LEFT JOIN&lt;/code&gt;ç¡®ä¿æ‰€æœ‰è®¢å•è¢«æ›´æ–°ï¼Œæ— å®¢æˆ·åŒ¹é…æ—¶ç”¨&lt;code&gt;ELSE&lt;/code&gt;é»˜è®¤å€¼&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤šè¡¨å…³è”ä¸èšåˆæ›´æ–°"&gt;&lt;strong&gt;å¤šè¡¨å…³è”ä¸èšåˆæ›´æ–°&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åœºæ™¯ï¼šæ›´æ–°ç”¨æˆ·æ€»æ¶ˆè´¹é‡‘é¢ï¼ˆåŸºäºè®¢å•è¡¨æ±‡æ€»ï¼‰
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE users u
JOIN (
SELECT user_id, SUM(amount) AS total
FROM orders
GROUP BY user_id
) o ON u.id = o.user_id
SET u.total_spent = o.total;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–&lt;/strong&gt;ï¼šå­æŸ¥è¯¢é¢„å…ˆèšåˆæ•°æ®ï¼Œå‡å°‘JOINè®¡ç®—é‡&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¸…ç†æ— æ•ˆæ•°æ®"&gt;&lt;strong&gt;æ¸…ç†æ— æ•ˆæ•°æ®&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åœºæ™¯ï¼šæ ‡è®°æ— åº“å­˜çš„å•†å“ä¸ºåœäº§
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE products p
LEFT JOIN inventory i ON p.id = i.product_id
SET p.status = &amp;#39;discontinued&amp;#39;
WHERE i.product_id IS NULL; -- æ— åº“å­˜è®°å½•
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–&lt;/strong&gt;ï¼š&lt;code&gt;LEFT JOIN&lt;/code&gt; + &lt;code&gt;WHERE&lt;/code&gt;è¿‡æ»¤æœªåŒ¹é…è¡Œ&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸é¿å‘æŒ‡å—"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸é¿å‘æŒ‡å—&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥æ¡ä»¶å‡†ç¡®æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é”™è¯¯æ¡ä»¶ï¼ˆå¦‚&lt;code&gt;ON ç›®æ ‡è¡¨.id = æºè¡¨.id&lt;/code&gt;è€Œéå¤–é”®ï¼‰ä¼šå¯¼è‡´å…¨è¡¨é”™è¯¯æ›´æ–°&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;NULLå€¼å¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;LEFT JOIN
&lt;/code&gt;&lt;/pre&gt;æ—¶ï¼Œæºè¡¨å­—æ®µå¯èƒ½ä¸º
&lt;pre tabindex="0"&gt;&lt;code&gt;NULL
&lt;/code&gt;&lt;/pre&gt;ï¼Œéœ€ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;IFNULL()
&lt;/code&gt;&lt;/pre&gt;æˆ–
&lt;pre tabindex="0"&gt;&lt;code&gt;COALESCE()
&lt;/code&gt;&lt;/pre&gt;è®¾ç½®é»˜è®¤å€¼ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SET o.discount = IFNULL(c.base_discount, 0.0);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•&lt;/strong&gt;ï¼šå…³è”å­—æ®µï¼ˆ&lt;code&gt;ON&lt;/code&gt;å­å¥ï¼‰å’Œ&lt;code&gt;WHERE&lt;/code&gt;æ¡ä»¶å­—æ®µå¿…é¡»ç´¢å¼•ï¼ŒåŠ é€Ÿè¿æ¥&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†æ‰¹æ›´æ–°ï¼šå¤§è¡¨æ›´æ–°ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;LIMIT
&lt;/code&gt;&lt;/pre&gt;æˆ–IDåˆ†æ®µï¼ˆé¿å…é”è¡¨ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE ... WHERE id BETWEEN 1 AND 1000;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å…¨è¡¨æ›´æ–°&lt;/strong&gt;ï¼šæ— &lt;code&gt;WHERE&lt;/code&gt;æ—¶é»˜è®¤æ›´æ–°æ‰€æœ‰è¡Œï¼Œå¯èƒ½å¼•å‘äº‹æ•…&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ä¸æµ‹è¯•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æµ‹è¯•å…ˆè¡Œï¼šç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT
&lt;/code&gt;&lt;/pre&gt;æ›¿æ¢
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE
&lt;/code&gt;&lt;/pre&gt;éªŒè¯ç»“æœï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM orders o JOIN ... -- ç¡®è®¤æ•°æ®å†æ”¹UPDATE
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡ä¿æŠ¤ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;START TRANSACTION;
UPDATE ... -- æ‰§è¡Œæ›´æ–°
ROLLBACK; -- æˆ– COMMIT;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤‡ä»½&lt;/strong&gt;ï¼š&lt;code&gt;CREATE TABLE backup SELECT * FROM target_table WHERE ...&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¿›é˜¶æŠ€å·§"&gt;âš¡ &lt;strong&gt;è¿›é˜¶æŠ€å·§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–°å¤šåˆ—+å¤šè¡¨å…³è”&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- åŒæ—¶æ›´æ–°å·¥èµ„å’Œå¥–é‡‘ï¼ˆä¾èµ–éƒ¨é—¨è¡¨ï¼‰
UPDATE employees e
LEFT JOIN departments d ON e.dept_id = d.id
SET e.salary = e.salary * 1.05,
e.bonus = IFNULL(d.annual_bonus, 0)
WHERE d.fiscal_year = 2023;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚é€»è¾‘ï¼šå­—ç¬¦ä¸²æ‹†åˆ†æ›´æ–°&lt;/strong&gt;
&lt;em&gt;åœºæ™¯&lt;/em&gt;ï¼šå†å²è¡¨çš„è´¦å·å­—æ®µï¼ˆé€—å·åˆ†éš”ï¼‰è½¬ç”¨æˆ·å&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE bus_history T1
JOIN (
SELECT T2.id, GROUP_CONCAT(T4.user_name) AS names
FROM bus_history T2
JOIN mysql.help_topic T3 ON ... -- æ‹†åˆ†é€»è¾‘
LEFT JOIN sys_user T4 ON ...
GROUP BY T2.id
) T5 ON T1.id = T5.id
SET T1.user_names = T5.names;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”ï¼šJOIN vs å­æŸ¥è¯¢&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;UPDATE JOIN&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…³è”ç®€å•æˆ–éœ€å¤šåˆ—æ›´æ–°&lt;/td&gt;
&lt;td&gt;æ›´é«˜ï¼ˆç´¢å¼•ä¼˜åŒ–åï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­æŸ¥è¯¢æ›´æ–°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•åˆ—æ›´æ–°ä¸”å­æŸ¥è¯¢ç»“æœå°&lt;/td&gt;
&lt;td&gt;å¯èƒ½æ›´æ…¢ï¼ˆéœ€ä¸´æ—¶è¡¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸å†³ç­–æµç¨‹"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ä¸å†³ç­–æµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ä½•æ—¶ä½¿ç”¨UPDATE JOINï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éœ€æ ¹æ®&lt;strong&gt;å…¶ä»–è¡¨æ•°æ®&lt;/strong&gt;æ›´æ–°ç›®æ ‡è¡¨æ—¶ âœ…&lt;/li&gt;
&lt;li&gt;æ›´æ–°é€»è¾‘æ¶‰åŠ&lt;strong&gt;å¤šå­—æ®µè®¡ç®—&lt;/strong&gt;æˆ–&lt;strong&gt;æ¡ä»¶åˆ†æ”¯&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;CASE&lt;/code&gt;ï¼‰âœ…&lt;/li&gt;
&lt;li&gt;éœ€&lt;strong&gt;æ‰¹é‡å¤„ç†&lt;/strong&gt;å…³è”æ•°æ®ï¼ˆå¦‚åº“å­˜åŒæ­¥ã€è®¢å•ç»Ÿè®¡ï¼‰âœ…
&lt;strong&gt;æ“ä½œæµç¨‹ï¼š&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph TB
A[æ˜ç¡®ç›®æ ‡è¡¨ä¸æ›´æ–°å­—æ®µ] --&amp;gt; B{æ˜¯å¦ä¾èµ–å…¶ä»–è¡¨æ•°æ®ï¼Ÿ}
B -- æ˜¯ --&amp;gt; C[é€‰æ‹©JOINç±»å‹ï¼šINNER/LEFT/RIGHT]
C --&amp;gt; D[è®¾è®¡å…³è”æ¡ä»¶ONå­å¥]
D --&amp;gt; E[è®¾ç½®æ›´æ–°é€»è¾‘SETå­å¥]
E --&amp;gt; F[æ·»åŠ WHEREè¿‡æ»¤èŒƒå›´]
F --&amp;gt; G[æµ‹è¯•ï¼šSELECTéªŒè¯æ•°æ®]
G --&amp;gt; H[æ‰§è¡Œï¼šäº‹åŠ¡ä¸­UPDATE]
B -- å¦ --&amp;gt; I[ä½¿ç”¨æ™®é€šUPDATE]
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;ç»ˆæå»ºè®®&lt;/strong&gt;ï¼šUPDATE JOINæ˜¯&lt;strong&gt;é«˜æ•ˆä½†é«˜é£é™©&lt;/strong&gt;æ“ä½œï¼ŒåŠ¡å¿…éµå¾ª &lt;strong&gt;â€œæµ‹è¯•-å¤‡ä»½-äº‹åŠ¡â€ä¸‰åŸåˆ™&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;1,4,9&lt;/a&gt;ã€‚å¯¹è¶…å¤§æ•°æ®é‡ï¼Œä¼˜å…ˆåˆ†æ‰¹æ¬¡æ›´æ–°å¹¶ç›‘æ§æ‰§è¡Œè®¡åˆ’ï¼ˆ&lt;code&gt;EXPLAIN UPDATE ...&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="è¡Œåˆ—è½¬æ¢"&gt;è¡Œåˆ—è½¬æ¢
&lt;/h2&gt;&lt;p&gt;è¡Œåˆ—è½¬æ¢æ˜¯SQLä¸­å¤„ç†æ•°æ®å±•ç¤ºç»“æ„çš„é‡è¦æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºå°†æ•°æ®ä»è¡Œæ ¼å¼è½¬ä¸ºåˆ—æ ¼å¼ï¼ˆè¡Œè½¬åˆ—/Pivotingï¼‰æˆ–åä¹‹ï¼ˆåˆ—è½¬è¡Œ/Unpivotingï¼‰ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒè¦ç‚¹ã€å®ç°æ–¹æ³•åŠåº”ç”¨åœºæ™¯çš„å…¨é¢è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸åˆ†ç±»"&gt;ğŸ”„ &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸åˆ†ç±»&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¡Œè½¬åˆ—ï¼ˆPivotingï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šå°†å¤šè¡Œæ•°æ®èšåˆä¸ºå•è¡Œï¼Œä¸åŒè¡Œä¸­çš„å€¼è½¬ä¸ºæ–°åˆ—ï¼ˆå¦‚æ¯æœˆé”€å”®æ•°æ®è½¬ä¸ºæœˆä»½åˆ—ï¼‰&lt;a class="link" href="@ref" &gt;1,5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šç”ŸæˆæŠ¥è¡¨ï¼ˆå¦‚æŒ‰äº§å“åˆ†ç±»å±•ç¤ºæœˆåº¦é”€å”®é¢ï¼‰&lt;a class="link" href="@ref" &gt;3,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ—è½¬è¡Œï¼ˆUnpivotingï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šå°†å¤šåˆ—æ•°æ®æ‹†åˆ†ä¸ºå¤šè¡Œï¼ŒåŸåˆ—åè½¬ä¸ºæ–°åˆ—çš„å€¼ï¼ˆå¦‚å°†â€œè¯­æ–‡â€â€œæ•°å­¦â€åˆ—è½¬ä¸ºâ€œç§‘ç›®â€è¡Œï¼‰&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šæ•°æ®æ¸…æ´—ã€é•¿æ ¼å¼è½¬æ¢ä»¥é€‚åº”åˆ†ææ¨¡å‹&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æŠ€æœ¯å®ç°æ–¹æ³•"&gt;âš™ï¸ &lt;strong&gt;æŠ€æœ¯å®ç°æ–¹æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="è¡Œè½¬åˆ—pivoting"&gt;&lt;strong&gt;è¡Œè½¬åˆ—ï¼ˆPivotingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CASE WHEN + èšåˆå‡½æ•°&lt;/strong&gt;ï¼ˆå…¼å®¹æ‰€æœ‰æ•°æ®åº“ï¼‰
&lt;pre tabindex="0"&gt;&lt;code&gt;-- ç¤ºä¾‹ï¼šæŒ‰æœˆç»Ÿè®¡äº§å“é”€å”®é¢
SELECT product,
SUM(CASE WHEN month = &amp;#39;Jan&amp;#39; THEN amount ELSE 0 END) AS Jan,
SUM(CASE WHEN month = &amp;#39;Feb&amp;#39; THEN amount ELSE 0 END) AS Feb
FROM sales
GROUP BY product;
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šé€šç”¨æ€§å¼ºï¼›&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šåˆ—å›ºå®šæ—¶éœ€æ‰‹åŠ¨ç¼–å†™å¤§é‡æ¡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PIVOTæ“ä½œç¬¦&lt;/strong&gt;ï¼ˆSQL Server/Oracleç­‰æ”¯æŒï¼‰
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM sales
PIVOT (SUM(amount) FOR month IN ([Jan], [Feb])) AS PivotTable;
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šè¯­æ³•ç®€æ´ï¼›&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ•°æ®åº“å…¼å®¹æ€§å·®ï¼ŒåŠ¨æ€åˆ—éœ€ç»“åˆåŠ¨æ€SQLã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€SQL&lt;/strong&gt;ï¼ˆå¤„ç†åŠ¨æ€åˆ—ï¼‰
é€šè¿‡æ‹¼æ¥SQLå­—ç¬¦ä¸²å®ç°åŠ¨æ€åˆ—ç”Ÿæˆï¼Œé€‚ç”¨äºåˆ—ä¸å›ºå®šçš„åœºæ™¯&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åˆ—è½¬è¡Œunpivoting"&gt;&lt;strong&gt;åˆ—è½¬è¡Œï¼ˆUnpivotingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;UNION ALL&lt;/strong&gt;ï¼ˆå…¼å®¹æ‰€æœ‰æ•°æ®åº“ï¼‰
&lt;pre tabindex="0"&gt;&lt;code&gt;-- ç¤ºä¾‹ï¼šå°†ç§‘ç›®åˆ—è½¬ä¸ºè¡Œ
SELECT name, &amp;#39;è¯­æ–‡&amp;#39; AS subject, chinese_score AS score FROM report
UNION ALL
SELECT name, &amp;#39;æ•°å­¦&amp;#39;, math_score FROM report;
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šç®€å•é€šç”¨ï¼›&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šä»£ç å†—ä½™ï¼Œåˆ—å¤šæ—¶ç»´æŠ¤å›°éš¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;UNPIVOTæ“ä½œç¬¦&lt;/strong&gt;ï¼ˆSQL Server/Oracleï¼‰
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT name, subject, score
FROM report
UNPIVOT (score FOR subject IN (chinese_score, math_score)) AS UnpivotTable;
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šé€»è¾‘æ¸…æ™°ï¼›&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šä»…é™éƒ¨åˆ†æ•°æ®åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;EXPLODEå‡½æ•°&lt;/strong&gt;ï¼ˆHive/Sparkç­‰å¤§æ•°æ®å¹³å°ï¼‰
é€‚ç”¨äºå¤„ç†æ•°ç»„æˆ–JSONæ ¼å¼çš„åˆ—æ‹†åˆ†&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸ä»·å€¼"&gt;ğŸ“Š &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸ä»·å€¼&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æŠ¥è¡¨ç”Ÿæˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºäº¤å‰è¡¨ï¼Œä¾¿äºå±•ç¤ºï¼ˆå¦‚é”€å”®æŠ¥è¡¨æŒ‰äº§å“åˆ†æœˆç»Ÿè®¡ï¼‰&lt;a class="link" href="@ref" &gt;1,3,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;æ•°æ®åˆ†æ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è¡Œè½¬åˆ—æ”¯æŒå¤šç»´åº¦å¯¹æ¯”ï¼ˆå¦‚ä¸åŒäº§å“å¹´åº¦é”€å”®é¢å¯¹æ¯”ï¼‰ï¼›åˆ—è½¬è¡Œé€‚é…ç»Ÿè®¡æ¨¡å‹ï¼ˆå¦‚çº¿æ€§å›å½’éœ€é•¿æ ¼å¼æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;æ•°æ®å¯è§†åŒ–&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è½¬æ¢åç»“æ„æ›´å¥‘åˆå·¥å…·è¦æ±‚ï¼ˆå¦‚Tableauä¸­éœ€â€œå±æ€§-å€¼â€æ ¼å¼ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–"&gt;âš ï¸ &lt;strong&gt;å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç©ºå€¼å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨&lt;code&gt;COALESCE()&lt;/code&gt;æˆ–&lt;code&gt;IFNULL()&lt;/code&gt;è®¾ç½®é»˜è®¤å€¼ï¼ˆå¦‚&lt;code&gt;COALESCE(amount, 0)&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ºå…³è”å­—æ®µå»ºç´¢å¼•ï¼›åˆ†æ‰¹æ¬¡å¤„ç†å¤§æ•°æ®ï¼›ç”¨ä¸´æ—¶è¡¨å­˜å‚¨ä¸­é—´ç»“æœ&lt;a class="link" href="@ref" &gt;3,10&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ¨æ€åˆ—ç»´æŠ¤å›°éš¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å°è£…å¤æ‚é€»è¾‘åˆ°è§†å›¾ï¼ˆViewï¼‰ï¼›åº”ç”¨å±‚åŠ¨æ€ç”ŸæˆSQLï¼ˆå¦‚Pythonæ‹¼æ¥ï¼‰&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ä¸ä¸€è‡´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éªŒè¯æºæ•°æ®å®Œæ•´æ€§ï¼›èšåˆå‡½æ•°éœ€åŒ¹é…ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚ç”¨SUMè€ŒéMAXï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ–¹æ³•é€‰å‹å»ºè®®"&gt;ğŸ’ &lt;strong&gt;æ–¹æ³•é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èæ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;è¡Œè½¬åˆ—ä¸”åˆ—å›ºå®š&lt;/td&gt;
&lt;td&gt;&lt;code&gt;CASE WHEN&lt;/code&gt;ï¼ˆé€šç”¨ï¼‰æˆ–&lt;code&gt;PIVOT&lt;/code&gt;ï¼ˆé«˜æ•ˆï¼‰&lt;/td&gt;
&lt;td&gt;å¹³è¡¡æ•ˆç‡ä¸å…¼å®¹æ€§&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åˆ—è½¬è¡Œä¸”åˆ—å°‘&lt;/td&gt;
&lt;td&gt;&lt;code&gt;UNION ALL&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•å¯é ï¼Œå…¨æ•°æ®åº“æ”¯æŒ&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŠ¨æ€åˆ—æˆ–å¤æ‚ä¸šåŠ¡é€»è¾‘&lt;/td&gt;
&lt;td&gt;åŠ¨æ€SQL + åº”ç”¨å±‚é€»è¾‘&lt;/td&gt;
&lt;td&gt;çµæ´»åº”å¯¹å˜åŒ–éœ€æ±‚&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤§æ•°æ®å¹³å°ï¼ˆHive/Sparkï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXPLODE&lt;/code&gt;æˆ–&lt;code&gt;LATERAL VIEW&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŸç”Ÿæ”¯æŒé«˜æ•ˆæ‹†åˆ†&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å®ä¾‹æ¼”ç¤º"&gt;ğŸŒ° &lt;strong&gt;å®ä¾‹æ¼”ç¤º&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è¡Œè½¬åˆ—&lt;/strong&gt;ï¼šå­¦ç”Ÿæˆç»©è¡¨æŒ‰ç§‘ç›®è½¬åˆ—&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT student_id,
MAX(CASE WHEN subject = &amp;#39;Math&amp;#39; THEN score END) AS Math,
MAX(CASE WHEN subject = &amp;#39;Science&amp;#39; THEN score END) AS Science
FROM grades
GROUP BY student_id;[2,5](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;åˆ—è½¬è¡Œ&lt;/strong&gt;ï¼šå­£åº¦æŠ¥è¡¨è½¬é•¿æ ¼å¼&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT product, &amp;#39;Q1&amp;#39; AS quarter, Q1_sales FROM report
UNION ALL
SELECT product, &amp;#39;Q2&amp;#39;, Q2_sales FROM report;[8,10](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼šè¡Œåˆ—è½¬æ¢æ˜¯æ•°æ®é‡å¡‘çš„æ ¸å¿ƒæŠ€èƒ½ï¼Œé€‰å‹éœ€æƒè¡¡&lt;strong&gt;æ•°æ®åº“æ”¯æŒ&lt;/strong&gt;ã€&lt;strong&gt;åˆ—æ˜¯å¦å›ºå®š&lt;/strong&gt;åŠ&lt;strong&gt;æ€§èƒ½éœ€æ±‚&lt;/strong&gt;ã€‚æŒæ¡&lt;code&gt;CASE WHEN&lt;/code&gt;å’Œ&lt;code&gt;UNION ALL&lt;/code&gt;å¯åº”å¯¹å¤šæ•°åœºæ™¯ï¼Œè€ŒåŠ¨æ€SQLå’Œä¸“ç”¨æ“ä½œç¬¦ï¼ˆ&lt;code&gt;PIVOT&lt;/code&gt;/&lt;code&gt;UNPIVOT&lt;/code&gt;ï¼‰èƒ½æå‡å¤æ‚éœ€æ±‚çš„æ•ˆç‡ã€‚å§‹ç»ˆéµå¾ª&lt;strong&gt;æµ‹è¯•â†’éªŒè¯â†’ä¼˜åŒ–&lt;/strong&gt;æµç¨‹ï¼Œç¡®ä¿æ•°æ®å‡†ç¡®æ€§ä¸æŸ¥è¯¢æ€§èƒ½&lt;a class="link" href="@ref" &gt;3,9,10&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="join"&gt;JOIN
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ SQL ä¸­ &lt;strong&gt;JOIN ç±»å‹&lt;/strong&gt;çš„å…¨é¢è§£æï¼Œæ¶µç›–åŸºç¡€ä¸è¿›é˜¶ç±»å‹ã€åº”ç”¨åœºæ™¯ã€æ‰§è¡Œæœºåˆ¶åŠæ€§èƒ½å»ºè®®ï¼Œç»“åˆå…³ç³»æ•°æ®åº“æ ¸å¿ƒåŸç†ä¸å®è·µæ¡ˆä¾‹è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åŸºç¡€-join-ç±»å‹"&gt;ğŸ”„ &lt;strong&gt;åŸºç¡€ JOIN ç±»å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å†…è¿æ¥-inner-join"&gt;&lt;strong&gt;å†…è¿æ¥ (INNER JOIN)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä»…è¿”å›ä¸¤è¡¨ä¸­&lt;strong&gt;åŒ¹é…æ¡ä»¶æˆç«‹&lt;/strong&gt;çš„è¡Œï¼ˆäº¤é›†ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯­æ³•ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT t1.col, t2.col
FROM table1 t1
INNER JOIN table2 t2 ON t1.key = t2.key;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šå…³è”è®¢å•ä¸å®¢æˆ·è¡¨ï¼Œä»…æ˜¾ç¤ºæœ‰å®¢æˆ·ä¿¡æ¯çš„è®¢å•&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šè‹¥è¿æ¥å­—æ®µå« &lt;code&gt;NULL&lt;/code&gt;ï¼Œåˆ™è¯¥è¡Œä¸å‚ä¸åŒ¹é…&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å·¦å¤–è¿æ¥-left-outer-join"&gt;&lt;strong&gt;å·¦å¤–è¿æ¥ (LEFT OUTER JOIN)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šè¿”å›&lt;strong&gt;å·¦è¡¨å…¨éƒ¨è¡Œ&lt;/strong&gt; + &lt;strong&gt;å³è¡¨åŒ¹é…è¡Œ&lt;/strong&gt;ï¼ˆæ— åŒ¹é…åˆ™å³è¡¨å­—æ®µä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯­æ³•ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT t1.col, t2.col
FROM table1 t1
LEFT JOIN table2 t2 ON t1.key = t2.key;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šåˆ—å‡ºæ‰€æœ‰å‘˜å·¥åŠå…¶éƒ¨é—¨ï¼ˆå«æœªåˆ†é…éƒ¨é—¨çš„å‘˜å·¥ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å˜ä½“ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;LEFT JOIN EXCLUDING INNER JOIN
&lt;/code&gt;&lt;/pre&gt;ï¼ˆä»…å·¦è¡¨ç‹¬æœ‰æ•°æ®ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT *
FROM t1 LEFT JOIN t2 ON t1.key = t2.key
WHERE t2.key IS NULL; -- æ’é™¤åŒ¹é…è¡Œ[3](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å³å¤–è¿æ¥-right-outer-join"&gt;&lt;strong&gt;å³å¤–è¿æ¥ (RIGHT OUTER JOIN)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šè¿”å›&lt;strong&gt;å³è¡¨å…¨éƒ¨è¡Œ&lt;/strong&gt; + &lt;strong&gt;å·¦è¡¨åŒ¹é…è¡Œ&lt;/strong&gt;ï¼ˆæ— åŒ¹é…åˆ™å·¦è¡¨å­—æ®µä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯­æ³•ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT t1.col, t2.col
FROM table1 t1
RIGHT JOIN table2 t2 ON t1.key = t2.key;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šæ˜¾ç¤ºæ‰€æœ‰éƒ¨é—¨åŠå‘˜å·¥ï¼ˆå«æ— å‘˜å·¥çš„éƒ¨é—¨ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;ï¼šå¤šæ•°åœºæ™¯å¯é€šè¿‡&lt;strong&gt;è°ƒæ¢è¡¨é¡ºåº&lt;/strong&gt; + &lt;strong&gt;LEFT JOIN&lt;/strong&gt; æ›¿ä»£&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…¨å¤–è¿æ¥-full-outer-join"&gt;&lt;strong&gt;å…¨å¤–è¿æ¥ (FULL OUTER JOIN)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šè¿”å›&lt;strong&gt;å·¦è¡¨ä¸å³è¡¨æ‰€æœ‰è¡Œ&lt;/strong&gt;ï¼ˆæ— åŒ¹é…åˆ™å¯¹æ–¹è¡¨å­—æ®µä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯­æ³•ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT t1.col, t2.col
FROM table1 t1
FULL JOIN table2 t2 ON t1.key = t2.key;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šåˆå¹¶ä¸¤æ•°æ®æºå®Œæ•´è®°å½•ï¼ˆå¦‚å‘˜å·¥ä¸éƒ¨é—¨å…¨é›†ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¼å®¹æ€§ï¼šMySQL éœ€ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; UNION
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ¨¡æ‹Ÿï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM t1 LEFT JOIN t2 ON ...
UNION
SELECT * FROM t1 RIGHT JOIN t2 ON ...; [8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="äº¤å‰è¿æ¥-cross-join"&gt;&lt;strong&gt;äº¤å‰è¿æ¥ (CROSS JOIN)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šè¿”å›ä¸¤è¡¨çš„&lt;strong&gt;ç¬›å¡å°”ç§¯&lt;/strong&gt;ï¼ˆæ‰€æœ‰è¡Œç»„åˆï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯­æ³•ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT t1.col, t2.col
FROM table1 t1
CROSS JOIN table2 t2; -- æ— éœ€ ON å­å¥
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šç”Ÿæˆç»„åˆçŸ©é˜µï¼ˆå¦‚äº§å“ä¸å°ºå¯¸çš„å…¨ç»„åˆï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½é£é™©&lt;/strong&gt;ï¼šæ•°æ®é‡å¤§æ—¶æ˜“å¯¼è‡´ç»“æœé›†çˆ†ç‚¸ï¼ˆ&lt;code&gt;n Ã— m&lt;/code&gt; è¡Œï¼‰&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç‰¹æ®Šä¸è¿›é˜¶-join-ç±»å‹"&gt;âš™ï¸ &lt;strong&gt;ç‰¹æ®Šä¸è¿›é˜¶ JOIN ç±»å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="è‡ªè¿æ¥-self-join"&gt;&lt;strong&gt;è‡ªè¿æ¥ (SELF JOIN)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼š&lt;strong&gt;åŒä¸€è¡¨&lt;/strong&gt;æŒ‰ä¸åŒåˆ«åè¿æ¥ï¼Œç”¨äºå±‚æ¬¡å…³ç³»æŸ¥è¯¢&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯­æ³•ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT e1.name AS Employee, e2.name AS Manager
FROM employees e1
JOIN employees e2 ON e1.manager_id = e2.employee_id; -- æŸ¥æ‰¾å‘˜å·¥åŠå…¶ç»ç†[5](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŠè¿æ¥-semi-join"&gt;&lt;strong&gt;åŠè¿æ¥ (SEMI JOIN)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä»…è¿”å›å·¦è¡¨ä¸­&lt;strong&gt;åœ¨å³è¡¨å­˜åœ¨åŒ¹é…&lt;/strong&gt;çš„è¡Œï¼ˆä¸è¿”å›å³è¡¨å­—æ®µï¼‰&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æ–¹å¼ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-- ä½¿ç”¨ EXISTS
SELECT * FROM t1
WHERE EXISTS (SELECT 1 FROM t2 WHERE t1.id = t2.id);
-- ä½¿ç”¨ IN (éœ€æ³¨æ„ NULL å¤„ç†)
SELECT * FROM t1
WHERE id IN (SELECT id FROM t2); [3,9](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šç­›é€‰æœ‰è®¢å•çš„å®¢æˆ·ï¼ˆæ— éœ€è®¢å•è¯¦æƒ…ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åè¿æ¥-anti-join"&gt;&lt;strong&gt;åè¿æ¥ (ANTI JOIN)&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šè¿”å›å·¦è¡¨ä¸­&lt;strong&gt;åœ¨å³è¡¨æ— åŒ¹é…&lt;/strong&gt;çš„è¡Œ&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯­æ³•ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM t1
WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE t1.id = t2.id);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šæŸ¥æ‰¾æœªåˆ†é…éƒ¨é—¨çš„å‘˜å·¥&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-join-æ‰§è¡Œæœºåˆ¶ä¸æ€§èƒ½ä¼˜åŒ–"&gt;ğŸ“Š &lt;strong&gt;JOIN æ‰§è¡Œæœºåˆ¶ä¸æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åº•å±‚ç®—æ³•"&gt;&lt;strong&gt;åº•å±‚ç®—æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç®—æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Nested Loop Join&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŒå±‚å¾ªç¯ï¼šå¤–å±‚é€è¡Œæ‰«æï¼Œå†…å±‚åŒ¹é…ï¼ˆæ— ç´¢å¼•æ—¶æ•ˆç‡ä½ï¼‰&lt;/td&gt;
&lt;td&gt;å°è¡¨é©±åŠ¨å¤§è¡¨&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Hash Join&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å“ˆå¸Œè¡¨æ„å»ºï¼šä¸€è¡¨å»ºå“ˆå¸Œï¼Œå¦ä¸€è¡¨æ¢æµ‹åŒ¹é…ï¼ˆMySQL 8.0+ é»˜è®¤ï¼‰&lt;/td&gt;
&lt;td&gt;å¤§æ•°æ®é‡ç­‰å€¼è¿æ¥&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Sort-Merge Join&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸¤è¡¨æ’åºåå½’å¹¶æ‰«æï¼ˆéœ€æœ‰åºæ•°æ®é›†ï¼‰&lt;/td&gt;
&lt;td&gt;éç­‰å€¼è¿æ¥æˆ–å·²æ’åºæ•°æ®&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æ€§èƒ½ä¼˜åŒ–å»ºè®®"&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ç´¢å¼•ç­–ç•¥ï¼š
&lt;ul&gt;
&lt;li&gt;å…³è”å­—æ®µå»ºç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;ON t1.id = t2.id&lt;/code&gt; éœ€ &lt;code&gt;t2.id&lt;/code&gt; ç´¢å¼•ï¼‰&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…å…¨è¡¨æ‰«æï¼šç¡®ä¿ &lt;code&gt;WHERE&lt;/code&gt; æ¡ä»¶å­—æ®µä¹Ÿæœ‰ç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ”¹å†™æŠ€å·§ï¼š
&lt;ul&gt;
&lt;li&gt;å°† &lt;code&gt;IN&lt;/code&gt;/&lt;code&gt;EXISTS&lt;/code&gt; å­æŸ¥è¯¢æ”¹ä¸º &lt;code&gt;JOIN&lt;/code&gt;ï¼ˆä¼˜åŒ–å™¨æ›´æ˜“é€‰æ‹©é«˜æ•ˆè®¡åˆ’ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¤§è¡¨æ‹†åˆ†ï¼šåˆ†æ‰¹å¤„ç†ï¼ˆå¦‚åˆ†é¡µæˆ–åˆ†åŒºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œè®¡åˆ’åˆ†æï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;EXPLAIN SELECT ...; -- æ£€æŸ¥æ˜¯å¦ä½¿ç”¨ç´¢å¼•ã€JOIN ç±»å‹[9](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-join-ç±»å‹é€‰å‹å†³ç­–æ ‘"&gt;ğŸ’ &lt;strong&gt;JOIN ç±»å‹é€‰å‹å†³ç­–æ ‘&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph TB
A[éœ€è¿”å›å“ªäº›æ•°æ®ï¼Ÿ]
A --&amp;gt; B[ä»…ä¸¤è¡¨äº¤é›†ï¼Ÿ] --&amp;gt;|æ˜¯| C[INNER JOIN]
A --&amp;gt; D[ä¿ç•™å•è¡¨å…¨éƒ¨æ•°æ®ï¼Ÿ] --&amp;gt;|å·¦è¡¨| E[LEFT JOIN]
D --&amp;gt;|å³è¡¨| F[RIGHT JOIN]
A --&amp;gt; G[éœ€ä¸¤è¡¨å…¨é›†ï¼Ÿ] --&amp;gt;|æ˜¯| H[FULL JOIN]
A --&amp;gt; I[ä»…åˆ¤æ–­å­˜åœ¨æ€§ï¼Ÿ] --&amp;gt;|æ˜¯| J[SEMI JOIN]
A --&amp;gt; K[éœ€æ’é™¤åŒ¹é…é¡¹ï¼Ÿ] --&amp;gt;|æ˜¯| L[ANTI JOIN]
A --&amp;gt; M[ç”Ÿæˆæ‰€æœ‰ç»„åˆï¼Ÿ] --&amp;gt;|æ˜¯| N[CROSS JOIN]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å¸¸è§é™·é˜±ä¸è§„é¿"&gt;âš ï¸ &lt;strong&gt;å¸¸è§é™·é˜±ä¸è§„é¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;NULL å€¼é—®é¢˜ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;NULL&lt;/code&gt; ä¸å‚ä¸ç­‰å€¼åŒ¹é…ï¼ˆå¦‚ &lt;code&gt;t1.id = t2.id&lt;/code&gt; ä¼šå¿½ç•¥ &lt;code&gt;NULL&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§£æ³•ï¼šç”¨ &lt;code&gt;IS NULL&lt;/code&gt; æ˜¾å¼å¤„ç†ï¼Œæˆ–æ”¹ç”¨ &lt;code&gt;COALESCE()&lt;/code&gt; èµ‹äºˆé»˜è®¤å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¬›å¡å°”ç§¯çˆ†ç‚¸ï¼š
&lt;ul&gt;
&lt;li&gt;æ— è¿æ¥æ¡ä»¶æˆ–æ¡ä»¶é”™è¯¯å¯¼è‡´ç»“æœé›†å‰§å¢ï¼ˆå¦‚æ¼å†™ &lt;code&gt;ON&lt;/code&gt; å­å¥ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½åŠ£åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;å¤§è¡¨ &lt;code&gt;JOIN&lt;/code&gt; æ— ç´¢å¼• â†’ å¼ºåˆ¶æŒ‡å®šç®—æ³•ï¼ˆå¦‚ &lt;code&gt;HASH JOIN&lt;/code&gt;ï¼‰æˆ–åˆ†æ²»å¤„ç†&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;æŒæ¡ JOIN ç±»å‹éœ€ç†è§£&lt;strong&gt;æ•°æ®é›†å…³ç³»&lt;/strong&gt;ä¸&lt;strong&gt;ä¸šåŠ¡éœ€æ±‚&lt;/strong&gt;ï¼Œç»“åˆæ‰§è¡Œè®¡åˆ’åˆ†æä¼˜åŒ–ã€‚å®è·µä¸­ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;INNER JOIN&lt;/code&gt;å’Œ &lt;code&gt;LEFT JOIN&lt;/code&gt;ï¼Œè°¨æ…ä½¿ç”¨ &lt;code&gt;CROSS JOIN&lt;/code&gt;ï¼Œå–„ç”¨ &lt;code&gt;SEMI/ANTI JOIN&lt;/code&gt; ç®€åŒ–é€»è¾‘ã€‚å§‹ç»ˆé€šè¿‡ &lt;code&gt;EXPLAIN&lt;/code&gt; éªŒè¯æ€§èƒ½è·¯å¾„&lt;a class="link" href="@ref" &gt;5,9,10&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¤æ‚åº¦"&gt;å¤æ‚åº¦
&lt;/h2&gt;&lt;p&gt;SQLä¸­çš„&lt;code&gt;JOIN&lt;/code&gt;æ“ä½œæ˜¯æ•°æ®åº“æŸ¥è¯¢çš„æ ¸å¿ƒï¼Œç”¨äºåˆå¹¶å¤šä¸ªè¡¨çš„å…³è”æ•°æ®ã€‚å…¶æ‰§è¡Œè¿‡ç¨‹æ¶‰åŠå¤šä¸ªé˜¶æ®µï¼Œä¸åŒç®—æ³•çš„æ—¶ç©ºå¤æ‚åº¦å·®å¼‚æ˜¾è‘—ã€‚ä»¥ä¸‹ä»æ‰§è¡Œæµç¨‹ã€ç®—æ³•åŸç†ã€å¤æ‚åº¦åˆ†æåŠä¼˜åŒ–ç­–ç•¥å››æ–¹é¢å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-joinæ‰§è¡Œçš„æ ¸å¿ƒæµç¨‹"&gt;ğŸ”„ &lt;strong&gt;JOINæ‰§è¡Œçš„æ ¸å¿ƒæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¬›å¡å°”ç§¯ç”Ÿæˆï¼ˆCross Joinï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®åº“é¦–å…ˆç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„è¡Œç»„åˆï¼ˆå·¦è¡¨æ¯è¡ŒÃ—å³è¡¨æ¯è¡Œï¼‰ï¼Œå½¢æˆä¸­é—´ç»“æœé›†ï¼ˆè™šè¡¨VT1ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šå·¦è¡¨3è¡Œã€å³è¡¨3è¡Œ â†’ ç¬›å¡å°”ç§¯9è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ä»·&lt;/strong&gt;ï¼šç©ºé—´å¤æ‚åº¦ &lt;em&gt;O(MÃ—N)&lt;/em&gt;ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;em&gt;O(MÃ—N)&lt;/em&gt;ï¼ˆMã€Nä¸ºä¸¤è¡¨è¡Œæ•°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ONæ¡ä»¶è¿‡æ»¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹VT1åº”ç”¨&lt;code&gt;ON&lt;/code&gt;æ¡ä»¶ï¼ˆå¦‚&lt;code&gt;a.id=b.id&lt;/code&gt;ï¼‰ï¼Œç­›é€‰æ»¡è¶³æ¡ä»¶çš„è¡Œç”ŸæˆVT2&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸‰å€¼é€»è¾‘å¤„ç†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;TRUE&lt;/code&gt;ï¼ˆåŒ¹é…æˆåŠŸï¼‰â†’ ä¿ç•™è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FALSE&lt;/code&gt;/&lt;code&gt;UNKNOWN&lt;/code&gt;ï¼ˆå¦‚å«&lt;code&gt;NULL&lt;/code&gt;ï¼‰â†’ ä¸¢å¼ƒè¡Œ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ·»åŠ å¤–éƒ¨è¡Œï¼ˆä»…å¤–è¿æ¥ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¦è¿æ¥&lt;/strong&gt;ï¼šå°†å·¦è¡¨æœªåŒ¹é…çš„è¡ŒåŠ å…¥VT2ï¼Œå³è¡¨å­—æ®µç½®&lt;code&gt;NULL&lt;/code&gt; â†’ ç”ŸæˆVT3&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å³è¿æ¥/å…¨è¿æ¥&lt;/strong&gt;ï¼šç±»ä¼¼é€»è¾‘ï¼Œä¿ç•™å³è¡¨æˆ–åŒè¡¨æ‰€æœ‰è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»è¦joinç®—æ³•åŠå¤æ‚åº¦åˆ†æ"&gt;âš™ï¸ &lt;strong&gt;ä¸»è¦JOINç®—æ³•åŠå¤æ‚åº¦åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åµŒå¥—å¾ªç¯è¿æ¥nested-loop-join-nlj"&gt;&lt;strong&gt;åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆNested Loop Join, NLJï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼š
å¤–å±‚å¾ªç¯éå†é©±åŠ¨è¡¨ï¼ˆå°è¡¨ï¼‰ï¼Œå†…å±‚å¾ªç¯éå†è¢«é©±åŠ¨è¡¨ï¼ˆå¤§è¡¨ï¼‰ï¼Œé€è¡ŒåŒ¹é…&lt;code&gt;ON&lt;/code&gt;æ¡ä»¶&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ—¶é—´å¤æ‚åº¦ï¼š
&lt;ul&gt;
&lt;li&gt;æ— ç´¢å¼•ï¼š&lt;em&gt;O(MÃ—N)&lt;/em&gt;ï¼ˆä¾‹å¦‚100ä¸‡Ã—1ä¸‡=100äº¿æ¬¡ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰ç´¢å¼•ï¼š&lt;em&gt;O(MÃ—logN)&lt;/em&gt;ï¼ˆå†…å±‚ä½¿ç”¨B+æ ‘ç´¢å¼•ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å¤æ‚åº¦&lt;/strong&gt;ï¼š&lt;em&gt;O(1)&lt;/em&gt;ï¼ˆä»…ç¼“å­˜å½“å‰è¡Œï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œæˆ–å†…å±‚è¡¨æœ‰é«˜æ•ˆç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å“ˆå¸Œè¿æ¥hash-join"&gt;&lt;strong&gt;å“ˆå¸Œè¿æ¥ï¼ˆHash Joinï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ„å»ºé˜¶æ®µ&lt;/strong&gt;ï¼šå¯¹å°è¡¨å»ºå“ˆå¸Œè¡¨ï¼ˆKeyä¸ºè¿æ¥åˆ—ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¢æµ‹é˜¶æ®µ&lt;/strong&gt;ï¼šæ‰«æå¤§è¡¨ï¼Œç”¨å“ˆå¸Œå‡½æ•°å®šä½åŒ¹é…è¡Œ&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ—¶é—´å¤æ‚åº¦ï¼š
&lt;ul&gt;
&lt;li&gt;æ„å»ºï¼š&lt;em&gt;O(M)&lt;/em&gt;ï¼Œæ¢æµ‹ï¼š&lt;em&gt;O(N)&lt;/em&gt; â†’ æ€»è®¡ &lt;em&gt;O(M+N)&lt;/em&gt;&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å¤æ‚åº¦&lt;/strong&gt;ï¼š&lt;em&gt;O(M)&lt;/em&gt;ï¼ˆéœ€å†…å­˜å­˜å‚¨å“ˆå¸Œè¡¨ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šç­‰å€¼è¿æ¥ã€å†…å­˜å……è¶³ã€æ— ç´¢å¼•çš„å¤§è¡¨å…³è”&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ’åºåˆå¹¶è¿æ¥merge-join"&gt;&lt;strong&gt;æ’åºåˆå¹¶è¿æ¥ï¼ˆMerge Joinï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;å…ˆå¯¹ä¸¤è¡¨æŒ‰è¿æ¥åˆ—æ’åº â†’ &lt;em&gt;O(MlogM + NlogN)&lt;/em&gt;&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åŒæŒ‡é’ˆé¡ºåºæ‰«æï¼Œåˆå¹¶åŒ¹é…è¡Œ â†’ &lt;em&gt;O(M+N)&lt;/em&gt;&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;ï¼šæ€»è®¡ &lt;em&gt;O(MlogM + NlogN)&lt;/em&gt;ï¼ˆæ’åºä¸»å¯¼ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å¤æ‚åº¦&lt;/strong&gt;ï¼š&lt;em&gt;O(1)&lt;/em&gt;ï¼ˆæµå¼å¤„ç†ï¼Œæ— éœ€é¢å¤–å†…å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè¡¨å·²æ’åºæˆ–éœ€å¤„ç†èŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚&lt;code&gt;BETWEEN&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å—åµŒå¥—å¾ªç¯block-nested-loop-bnl"&gt;&lt;strong&gt;å—åµŒå¥—å¾ªç¯ï¼ˆBlock Nested Loop, BNLï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼š
ç¼“å­˜é©±åŠ¨è¡¨çš„å¤šè¡Œï¼ˆ&lt;code&gt;join_buffer&lt;/code&gt;ï¼‰ï¼Œæ‰¹é‡ä¸è¢«é©±åŠ¨è¡¨åŒ¹é…ï¼Œå‡å°‘I/O&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;ï¼š&lt;em&gt;O(MÃ—N)&lt;/em&gt;ï¼ˆä½†æ‰«ææ¬¡æ•°é™ä¸º &lt;em&gt;M/BÃ—N&lt;/em&gt;ï¼ŒBä¸ºç¼“å­˜å—æ•°ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å¤æ‚åº¦&lt;/strong&gt;ï¼š&lt;em&gt;O(B)&lt;/em&gt;ï¼ˆBä¸º&lt;code&gt;join_buffer_size&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ— ç´¢å¼•ä¸”å†…å­˜æœ‰é™æ—¶æ›¿ä»£NLJ&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç®—æ³•æ€§èƒ½å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯"&gt;ğŸ“Š &lt;strong&gt;ç®—æ³•æ€§èƒ½å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç®—æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç©ºé—´å¤æ‚åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;NLJï¼ˆæ— ç´¢å¼•ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(MÃ—N)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(1)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;å°è¡¨é©±åŠ¨å¤§è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;NLJï¼ˆæœ‰ç´¢å¼•ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(MÃ—logN)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(1)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;è¢«é©±åŠ¨è¡¨è¿æ¥åˆ—æœ‰ç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Hash Join&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(M+N)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(M)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;ç­‰å€¼è¿æ¥ã€å†…å­˜å……è¶³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Merge Join&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(MlogM + NlogN)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(1)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;è¡¨å·²æ’åºæˆ–éœ€èŒƒå›´æŸ¥è¯¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;BNL&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(MÃ—N)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;O(B)&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;æ— ç´¢å¼•ä¸”&lt;code&gt;join_buffer&lt;/code&gt;å¯ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šMySQL 8.0+ é»˜è®¤ä¼˜å…ˆä½¿ç”¨Hash Joinï¼Œè‹¥å†…å­˜ä¸è¶³åˆ™é€€åŒ–è‡³BNL&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–ç­–ç•¥ä¸å®æˆ˜å»ºè®®"&gt;ğŸ› ï¸ &lt;strong&gt;ä¼˜åŒ–ç­–ç•¥ä¸å®æˆ˜å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºè¿æ¥åˆ—ï¼ˆ&lt;code&gt;ON a.id=b.id&lt;/code&gt;ï¼‰åŠ&lt;code&gt;WHERE&lt;/code&gt;æ¡ä»¶åˆ—å»ºç´¢å¼• â†’ å°†NLJæˆ–BNLè½¬ä¸ºé«˜æ•ˆç´¢å¼•æ‰«æ&lt;a class="link" href="@ref" &gt;8,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒæ•´è¿æ¥é¡ºåº&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰‹åŠ¨æŒ‡å®šå°è¡¨ä¸ºé©±åŠ¨è¡¨ï¼ˆå¦‚&lt;code&gt;STRAIGHT_JOIN&lt;/code&gt;ï¼‰ï¼Œå‡å°‘å¤–å±‚å¾ªç¯æ¬¡æ•°&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘æ•°æ®é›†å¤§å°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆè¿‡æ»¤å†è¿æ¥ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT *
FROM (SELECT * FROM big_table WHERE date &amp;gt; &amp;#39;2023-01-01&amp;#39;) AS b
JOIN small_table s ON b.id = s.id -- å…ˆè¿‡æ»¤å¤§è¡¨[9](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®å†…å­˜å‚æ•°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¢å¤§&lt;code&gt;join_buffer_size&lt;/code&gt;ï¼ˆé»˜è®¤256KBï¼‰ä»¥æå‡BNLæ•ˆç‡&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å¤æ‚è¡¨è¾¾å¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å°†&lt;code&gt;ON a.col+1 = b.col&lt;/code&gt;æ”¹å†™ä¸º&lt;code&gt;ON a.col = b.col-1&lt;/code&gt; â†’ ç¡®ä¿ç´¢å¼•å¯ç”¨&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æµç¨‹æœ¬è´¨&lt;/strong&gt;ï¼šç¬›å¡å°”ç§¯ â†’ è¿‡æ»¤ â†’ è¡¥å¤–éƒ¨è¡Œï¼ˆå¤–è¿æ¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®—æ³•é€‰æ‹©&lt;/strong&gt;ï¼š
âœ… å°è¡¨+ç´¢å¼• â†’ â€‹&lt;strong&gt;NLJ&lt;/strong&gt;â€‹
âœ… å¤§è¡¨ç­‰å€¼è¿æ¥ â†’ â€‹&lt;strong&gt;Hash Join&lt;/strong&gt;â€‹
âœ… é¢„æ’åºè¡¨ â†’ â€‹&lt;strong&gt;Merge Join&lt;/strong&gt;â€‹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ ¸å¿ƒ&lt;/strong&gt;ï¼š
â€‹&lt;strong&gt;ç´¢å¼•è®¾è®¡ &amp;gt; å†…å­˜é…ç½® &amp;gt; æŸ¥è¯¢é‡å†™&lt;/strong&gt;ã€‚
é¿å…æ— ç´¢å¼•çš„å¤§è¡¨JOINï¼ˆå¦‚BNLå¤æ‚åº¦&lt;em&gt;O(MÃ—N)&lt;/em&gt;ï¼‰ï¼Œå¦åˆ™æ˜“å¼•å‘æ€§èƒ½ç¾éš¾&lt;a class="link" href="@ref" &gt;8,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡&lt;code&gt;EXPLAIN&lt;/code&gt;åˆ†ææ‰§è¡Œè®¡åˆ’ï¼Œç»“åˆæ•°æ®åˆ†å¸ƒç‰¹å¾é€‰æ‹©æœ€ä¼˜ç­–ç•¥ï¼Œæ˜¯é«˜æ•ˆJOINçš„å…³é”®&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item></channel></rss>