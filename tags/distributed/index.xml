<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Distributed on é£é¸¿è¸é›ªæ³¥</title><link>https://dyhes.github.io/tags/distributed/</link><description>Recent content in Distributed on é£é¸¿è¸é›ªæ³¥</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 22 Oct 2025 16:26:59 +0800</lastBuildDate><atom:link href="https://dyhes.github.io/tags/distributed/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€Distributedã€‘Lock</title><link>https://dyhes.github.io/p/distributedlock/</link><pubDate>Thu, 03 Jul 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/distributedlock/</guid><description>&lt;h2 id="åˆ†å¸ƒå¼é”"&gt;åˆ†å¸ƒå¼é”
&lt;/h2&gt;&lt;p&gt;åˆ†å¸ƒå¼é”æ˜¯ä¸€ç§åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿç¯å¢ƒä¸‹åè°ƒå¤šä¸ªèŠ‚ç‚¹ï¼ˆè¿›ç¨‹ã€æœåŠ¡æˆ–çº¿ç¨‹ï¼‰å¯¹å…±äº«èµ„æºè¿›è¡Œäº’æ–¥è®¿é—®çš„åŒæ­¥æœºåˆ¶ã€‚å…¶æ ¸å¿ƒç›®çš„æ˜¯è§£å†³åˆ†å¸ƒå¼ç¯å¢ƒä¸­å› å¹¶å‘æ“ä½œå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´ã€é‡å¤æ‰§è¡Œæˆ–èµ„æºå†²çªé—®é¢˜ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é”"&gt;ğŸ”’ &lt;strong&gt;ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é”ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šä¸ªèŠ‚ç‚¹å¯èƒ½åŒæ—¶è®¿é—®å…±äº«èµ„æºï¼ˆå¦‚æ•°æ®åº“ã€ç¼“å­˜ã€æ–‡ä»¶ç­‰ï¼‰ï¼Œè‹¥ç¼ºä¹åè°ƒæœºåˆ¶ï¼Œä¼šå¯¼è‡´ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸ä¸€è‡´&lt;/strong&gt;ï¼šå¦‚åº“å­˜è¶…å–ï¼ˆå¤šä¸ªèŠ‚ç‚¹åŒæ—¶æ‰£å‡åº“å­˜ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡å¤æ“ä½œ&lt;/strong&gt;ï¼šå¦‚å®šæ—¶ä»»åŠ¡åœ¨å¤šä¸ªæœåŠ¡èŠ‚ç‚¹é‡å¤æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰æ€§ç ´å&lt;/strong&gt;ï¼šå¦‚æ”¯ä»˜æ¥å£å› ç½‘ç»œé‡è¯•è¢«å¤šæ¬¡è°ƒç”¨&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæµªè´¹&lt;/strong&gt;ï¼šå¦‚å¤šä¸ªèŠ‚ç‚¹åŒæ—¶ç”ŸæˆæŠ¥è¡¨&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†å¸ƒå¼é”çš„æ ¸å¿ƒç‰¹æ€§"&gt;âš™ï¸ &lt;strong&gt;åˆ†å¸ƒå¼é”çš„æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸ºå®ç°å¯é åè°ƒï¼Œåˆ†å¸ƒå¼é”éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;äº’æ–¥æ€§&lt;/strong&gt;ï¼šåŒä¸€æ—¶åˆ»ä»…ä¸€ä¸ªèŠ‚ç‚¹æŒæœ‰é”&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;ï¼šé”åªèƒ½ç”±æŒæœ‰è€…é‡Šæ”¾ï¼ˆé¿å…è¯¯åˆ ï¼‰ï¼Œé€šå¸¸é€šè¿‡å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚UUIDï¼‰å®ç°&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™æ€§&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹å´©æºƒæ—¶é”è‡ªåŠ¨å¤±æ•ˆï¼ˆé€šè¿‡è¶…æ—¶æœºåˆ¶ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;ä¸­é—´ä»¶é›†ç¾¤æ•…éšœæ—¶ä»èƒ½å·¥ä½œï¼ˆå¦‚Redisé›†ç¾¤ã€ZooKeeperé€‰ä¸¾ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="4"&gt;
&lt;li&gt;&lt;strong&gt;å¯é‡å…¥æ€§&lt;/strong&gt;ï¼šåŒä¸€èŠ‚ç‚¹å¯å¤šæ¬¡è·å–åŒä¸€æŠŠé”ï¼ˆé¿å…è‡ªæ­»é”ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨æ€§&lt;/strong&gt;ï¼šé”æœåŠ¡éœ€æ”¯æŒé«˜å¹¶å‘ä¸ä½å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµå®ç°æ–¹å¼åŠå¯¹æ¯”"&gt;ğŸ› ï¸ &lt;strong&gt;ä¸»æµå®ç°æ–¹å¼åŠå¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºäºæ•°æ®åº“"&gt;&lt;strong&gt;åŸºäºæ•°æ®åº“&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;å”¯ä¸€çº¦æŸï¼šæ’å…¥å”¯ä¸€é”®è®°å½•è¡¨ç¤ºè·å–é”ï¼ˆæˆåŠŸå³è·é”ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ’ä»–é”ï¼š&lt;code&gt;SELECT ... FOR UPDATE&lt;/code&gt;é”å®šæ•°æ®åº“è¡Œ&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå®ç°ç®€å•ï¼Œæ— éœ€é¢å¤–ç»„ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ€§èƒ½å·®ï¼ˆTPSé€šå¸¸&amp;lt;1000ï¼‰ï¼Œé¢‘ç¹IOæ“ä½œæˆç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ— è‡ªåŠ¨è¿‡æœŸæœºåˆ¶ï¼Œéœ€é¢å¤–æ¸…ç†æ­»é”&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸»ä»åˆ‡æ¢å¯èƒ½å¯¼è‡´é”ä¸¢å¤±&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šä½å¹¶å‘æµ‹è¯•ç¯å¢ƒæˆ–å°å‹ç³»ç»Ÿï¼ˆQPS&amp;lt;100ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸºäºredis"&gt;&lt;strong&gt;åŸºäºRedis&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;åŸå­å‘½ä»¤ï¼š&lt;code&gt;SET key value NX EX 10&lt;/code&gt;ï¼ˆä¸å­˜åœ¨æ—¶è®¾ç½®é”®å€¼ï¼Œå¹¶è®¾è¶…æ—¶ï¼‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é‡Šæ”¾é”ï¼šé€šè¿‡Luaè„šæœ¬éªŒè¯æŒæœ‰è€…å¹¶åˆ é™¤ï¼ˆä¿è¯åŸå­æ€§ï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é”ç»­æœŸï¼šå®ˆæŠ¤çº¿ç¨‹ï¼ˆçœ‹é—¨ç‹—ï¼‰è‡ªåŠ¨å»¶é•¿é”è¿‡æœŸæ—¶é—´&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;RedLockç®—æ³•ï¼šé€šè¿‡å¤šä¸ªç‹¬ç«‹Rediså®ä¾‹æŠ•ç¥¨ï¼Œè¿‡åŠæˆåŠŸæ‰è·é”ï¼ˆé˜²é›†ç¾¤æ•…éšœï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜æ€§èƒ½ï¼ˆå•å®ä¾‹TPSè¾¾10ä¸‡+ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°è½»é‡ï¼Œæ”¯æŒé«˜å¹¶å‘&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸»ä»å¼‚æ­¥å¤åˆ¶å¯èƒ½å¯¼è‡´é”ä¸¢å¤±ï¼ˆè„‘è£‚é—®é¢˜ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;éœ€ç²¾ç»†è°ƒä¼˜è¶…æ—¶æ—¶é—´ï¼ˆè¿‡çŸ­è¯¯é‡Šæ”¾ï¼Œè¿‡é•¿æ­»é”ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘åœºæ™¯ï¼ˆå¦‚ç§’æ€ç³»ç»Ÿï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸºäºzookeeper"&gt;&lt;strong&gt;åŸºäºZooKeeper&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼šå®¢æˆ·ç«¯åœ¨é”è·¯å¾„ä¸‹åˆ›å»ºä¸´æ—¶æœ‰åºèŠ‚ç‚¹ï¼Œæœ€å°åºå·èŠ‚ç‚¹è·é”&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç›‘å¬æœºåˆ¶ï¼šéæœ€å°èŠ‚ç‚¹ç›‘å¬å‰ä¸€èŠ‚ç‚¹åˆ é™¤äº‹ä»¶ï¼Œè§¦å‘åå°è¯•è·é”&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;å¼ºä¸€è‡´æ€§ï¼ˆåŸºäºZABåè®®ï¼‰ï¼Œå¯é æ€§é«˜&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹æ•…éšœæ—¶ä¸´æ—¶èŠ‚ç‚¹è‡ªåŠ¨åˆ é™¤ï¼ˆé¿å…æ­»é”ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;æ€§èƒ½è¾ƒä½ï¼ˆé”æ“ä½œè€—æ—¶10-50msï¼ŒTPSçº¦5000-10000ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°å¤æ‚ï¼Œéœ€ç»´æŠ¤ZKé›†ç¾¤&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå¯¹å¯é æ€§è¦æ±‚é«˜äºæ€§èƒ½çš„åœºæ™¯ï¼ˆå¦‚é‡‘èç³»ç»Ÿï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰ç§å®ç°æ–¹å¼å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ä¸‰ç§å®ç°æ–¹å¼å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®åº“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Redis&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ZooKeeper&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆ&amp;lt;1000 TPSï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå•å®ä¾‹10ä¸‡+ TPSï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆ5000-10000 TPSï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆä¸»ä»åˆ‡æ¢ä¸¢é”ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆä¾èµ–é›†ç¾¤æ¨¡å¼ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå¼ºä¸€è‡´æ€§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰&lt;/td&gt;
&lt;td&gt;å¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªåŠ¨å®¹é”™&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒï¼ˆéœ€æ‰‹åŠ¨æ¸…ç†æ­»é”ï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ï¼ˆéœ€è®¾ç½®è¶…æ—¶ï¼‰&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆä¸´æ—¶èŠ‚ç‚¹è‡ªåŠ¨åˆ é™¤ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å°å‹ç³»ç»Ÿã€æµ‹è¯•ç¯å¢ƒ&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ä¸šåŠ¡ï¼ˆå¦‚ç§’æ€ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜å¯é æ€§ç³»ç»Ÿï¼ˆå¦‚äº¤æ˜“ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"&gt;âš ï¸ &lt;strong&gt;å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ­»é”é£é™©
&lt;ul&gt;
&lt;li&gt;æ–¹æ¡ˆï¼šè®¾ç½®é”è¶…æ—¶ï¼ˆRedisçš„&lt;code&gt;EX&lt;/code&gt;å‚æ•°ã€ZKä¸´æ—¶èŠ‚ç‚¹ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é”è¯¯é‡Šæ”¾
&lt;ul&gt;
&lt;li&gt;æ–¹æ¡ˆï¼šç”¨å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚UUIDï¼‰éªŒè¯æŒæœ‰è€…ï¼ŒLuaè„šæœ¬ä¿è¯åŸå­æ“ä½œ&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é”ç»­æœŸéœ€æ±‚
&lt;ul&gt;
&lt;li&gt;æ–¹æ¡ˆï¼šçœ‹é—¨ç‹—æœºåˆ¶ï¼ˆRedissonï¼‰å®šæœŸå»¶é•¿é”æ—¶é—´&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é›†ç¾¤æ•…éšœ
&lt;ul&gt;
&lt;li&gt;æ–¹æ¡ˆï¼šRedLockå¤šå®ä¾‹æŠ•ç¥¨ã€ZKé€‰ä¸¾æœºåˆ¶&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;åˆ†å¸ƒå¼é”æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„â€œåè°ƒè€…â€ï¼Œé€šè¿‡äº’æ–¥è®¿é—®ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ä¸ä¸šåŠ¡æ­£ç¡®æ€§ã€‚&lt;strong&gt;é€‰å‹æ ¸å¿ƒåœ¨äºæƒè¡¡æ€§èƒ½ã€å¯é æ€§ä¸å¤æ‚åº¦&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… è¿½æ±‚æ€§èƒ½é€‰Redisï¼ˆé…åˆRedissonï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;âœ… å¼ºä¸€è‡´æ€§åœºæ™¯é€‰ZooKeeper&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;âš ï¸ æ•°æ®åº“é”ä»…é€‚ç”¨äºæä½å¹¶å‘æˆ–ä¸´æ—¶æ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚
å®é™…åº”ç”¨ä¸­ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨æˆç†Ÿæ¡†æ¶ï¼ˆå¦‚Redissonã€Curatorï¼‰ï¼Œé¿å…é‡å¤é€ è½®å­å¹¶è§„é¿åº•å±‚é£é™©&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="tps"&gt;TPS
&lt;/h2&gt;&lt;p&gt;åœ¨é«˜å¹¶å‘ç³»ç»Ÿä¸­ï¼Œ&lt;strong&gt;TPSï¼ˆTransactions Per Secondï¼Œæ¯ç§’äº‹åŠ¡æ•°ï¼‰&lt;/strong&gt; æ˜¯è¡¡é‡ç³»ç»Ÿå¤„ç†èƒ½åŠ›çš„æ ¸å¿ƒæŒ‡æ ‡ï¼Œè¡¨ç¤ºç³»ç»Ÿæ¯ç§’èƒ½å®Œæˆçš„å®Œæ•´ä¸šåŠ¡äº‹åŠ¡æ•°é‡ã€‚ä¸€ä¸ªâ€œäº‹åŠ¡â€é€šå¸¸æŒ‡ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡æ“ä½œé—­ç¯ï¼ˆä¾‹å¦‚ï¼šç”¨æˆ·ä¸‹å•åŒ…å«åº“å­˜æ‰£å‡ã€è®¢å•ç”Ÿæˆã€æ”¯ä»˜å¤„ç†ç­‰æ­¥éª¤ï¼‰ã€‚ä»¥ä¸‹æ˜¯å…³äºTPSçš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-tpsçš„æ ¸å¿ƒå®šä¹‰"&gt;âš™ï¸ &lt;strong&gt;TPSçš„æ ¸å¿ƒå®šä¹‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡çš„å®Œæ•´æ€§&lt;/strong&gt;
TPSå…³æ³¨çš„æ˜¯&lt;strong&gt;ä¸šåŠ¡é€»è¾‘çš„å®Œæ•´æ€§&lt;/strong&gt;ï¼Œè€Œéå•ä¸€è¯·æ±‚ã€‚ä¾‹å¦‚ï¼š
&lt;ul&gt;
&lt;li&gt;ç”µå•†ä¸‹å•ï¼šä¸€æ¬¡ä¸‹å•æ“ä½œå¯èƒ½è§¦å‘å¤šæ¬¡æ•°æ®åº“è¯»å†™ã€æœåŠ¡è°ƒç”¨ï¼Œä½†æ•´ä½“è®¡ä¸º1ä¸ªäº‹åŠ¡&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯ä»˜æµç¨‹ï¼šä»å‘èµ·æ”¯ä»˜åˆ°æ‰£æ¬¾æˆåŠŸã€ç”Ÿæˆå‡­è¯ï¼Œæ„æˆä¸€ä¸ªäº‹åŠ¡å•å…ƒ&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸QPSçš„åŒºåˆ«&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æŒ‡æ ‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;QPS&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯ç§’å¤„ç†çš„è¯·æ±‚æ•°ï¼ˆå¦‚APIè°ƒç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;æ¥å£å±‚æ€§èƒ½è¯„ä¼°ï¼ˆå¦‚æœç´¢å¼•æ“ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;TPS&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯ç§’å®Œæˆçš„ä¸šåŠ¡äº‹åŠ¡æ•°&lt;/td&gt;
&lt;td&gt;éœ€æ•°æ®ä¸€è‡´æ€§çš„æ ¸å¿ƒä¸šåŠ¡ï¼ˆå¦‚æ”¯ä»˜ã€è®¢å•ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³ç³»&lt;/strong&gt;ï¼šä¸€æ¬¡äº‹åŠ¡å¯èƒ½åŒ…å«å¤šæ¬¡è¯·æ±‚ï¼ˆQPSï¼‰ï¼Œä¾‹å¦‚ç”¨æˆ·æ³¨å†Œï¼ˆ1ä¸ªTPS = 3æ¬¡QPSï¼šéªŒè¯+å†™DB+å‘é‚®ä»¶ï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-tpsåœ¨é«˜å¹¶å‘åœºæ™¯çš„æ„ä¹‰"&gt;ğŸ“Š &lt;strong&gt;TPSåœ¨é«˜å¹¶å‘åœºæ™¯çš„æ„ä¹‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç³»ç»Ÿæ€§èƒ½çš„â€œç¡¬æŒ‡æ ‡â€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘èƒ½åŠ›&lt;/strong&gt;ï¼šTPSè¶Šé«˜ï¼Œç³»ç»Ÿåœ¨æµé‡æ´ªå³°ä¸‹å¤„ç†ä¸šåŠ¡çš„èƒ½åŠ›è¶Šå¼ºï¼ˆå¦‚é˜¿é‡ŒåŒ11å³°å€¼è¾¾58.3ä¸‡TPSï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡å¯é æ€§&lt;/strong&gt;ï¼šé«˜TPSç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼ˆå¦‚åº“å­˜ä¸è¶…å–ã€æ”¯ä»˜ä¸é‡å¤ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å…¶ä»–æŒ‡æ ‡çš„å…³è”&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å“åº”æ—¶é—´ï¼ˆRTï¼‰&lt;/strong&gt;ï¼šTPSä¸RTæˆåæ¯”ã€‚RTå‡é«˜æ—¶ï¼ŒTPSå¯èƒ½ä¸‹é™ï¼ˆä¾‹å¦‚æ•°æ®åº“é”ç«äº‰å¯¼è‡´å¤„ç†å˜æ…¢ï¼‰&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ•°&lt;/strong&gt;ï¼šç³»ç»Ÿå¹¶å‘æ•° = TPS Ã— å¹³å‡RTï¼ˆLittle&amp;rsquo;så®šå¾‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;ç¤ºä¾‹&lt;/em&gt;ï¼šè‹¥TPS=1000ï¼ŒRT=50msï¼Œåˆ™å¹¶å‘æ•° = 1000 Ã— 0.05 = 50ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-tpsçš„å…¸å‹ç“¶é¢ˆä¸ä¼˜åŒ–"&gt;âš ï¸ &lt;strong&gt;TPSçš„å…¸å‹ç“¶é¢ˆä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="-å¸¸è§ç“¶é¢ˆ"&gt;ğŸ”§ &lt;strong&gt;å¸¸è§ç“¶é¢ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“é”ç«äº‰&lt;/strong&gt;ï¼šé«˜é¢‘å†™æ“ä½œå¯¼è‡´è¡Œé”/è¡¨é”å †ç§¯&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡é“¾è·¯è¿‡é•¿&lt;/strong&gt;ï¼šå¾®æœåŠ¡æ¶æ„ä¸‹è·¨æœåŠ¡è°ƒç”¨å¢åŠ å¤±è´¥é£é™©ä¸å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºäº‰ç”¨&lt;/strong&gt;ï¼šCPUã€å†…å­˜ã€IOç­‰èµ„æºä¸è¶³å¯¼è‡´çº¿ç¨‹é˜»å¡&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-ä¼˜åŒ–æ–¹æ¡ˆ"&gt;ğŸš€ &lt;strong&gt;ä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…·ä½“æªæ–½&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¶æ„å±‚é¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;- åˆ†å¸ƒå¼æ¶æ„ï¼šæ°´å¹³æ‰©å±•æœåŠ¡èŠ‚ç‚¹ï¼ˆå¦‚K8Så®¹å™¨åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ï¼› - è¯»å†™åˆ†ç¦»ï¼šæ•°æ®åº“ä¸»ä»æ¶æ„åˆ†æ•£å‹åŠ›&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡æ‹†åˆ†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;- å¼‚æ­¥åŒ–ï¼šéæ ¸å¿ƒæ“ä½œï¼ˆå¦‚å‘é‚®ä»¶ï¼‰æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafka/RocketMQï¼‰å‰Šå³°&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®åº“ä¼˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;- ç´¢å¼•ä¼˜åŒ–ï¼šå‡å°‘å…¨è¡¨æ‰«æï¼› - åˆ†åº“åˆ†è¡¨ï¼šæŒ‰ä¸šåŠ¡æ‹†åˆ†æ•°æ®ï¼ˆå¦‚ç”¨æˆ·åº“ã€è®¢å•åº“ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜ä¸é™æµ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;- åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆRedisï¼‰ï¼šç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼ˆå¦‚å•†å“è¯¦æƒ…ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ï¼› - é™æµç†”æ–­ï¼ˆSentinelï¼‰ï¼šé˜²æ­¢é›ªå´©&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸åŒç³»ç»Ÿçš„tpsé«˜å¹¶å‘æ ‡å‡†"&gt;ğŸ“ˆ &lt;strong&gt;ä¸åŒç³»ç»Ÿçš„TPSé«˜å¹¶å‘æ ‡å‡†&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç³»ç»Ÿç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;TPSæ ‡å‡†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼ ç»Ÿæ•°æ®åº“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;500-1000 TPS&lt;/td&gt;
&lt;td&gt;MySQL/PostgreSQLå•æœºä¸Šé™&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼æ•°æ®åº“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1ä¸‡-10ä¸‡+ TPS&lt;/td&gt;
&lt;td&gt;Cassandra/MongoDBé›†ç¾¤å¯æ¨ªå‘æ‰©å±•&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¶…å¤§å‹ç³»ç»Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;50ä¸‡+ TPS&lt;/td&gt;
&lt;td&gt;éœ€å…¨å±€ä¼˜åŒ–ï¼ˆå¦‚é˜¿é‡ŒåŒ11æ¶æ„ï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šæ˜¯å¦â€œé«˜å¹¶å‘â€éœ€ç»“åˆåœºæ™¯ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸­å°ç³»ç»Ÿï¼šTPS&amp;gt;5000å³å¯ç§°é«˜å¹¶å‘&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;é‡‘èç³»ç»Ÿï¼šTPS&amp;gt;1ä¸‡æ˜¯åŸºç¡€è¦æ±‚&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;TPSæ˜¯è¡¡é‡é«˜å¹¶å‘ç³»ç»Ÿä¸šåŠ¡å¤„ç†èƒ½åŠ›çš„é»„é‡‘æŒ‡æ ‡ï¼Œå…¶æ ¸å¿ƒåœ¨äº&lt;strong&gt;äº‹åŠ¡çš„å®Œæ•´æ€§ä¸æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;ã€‚ä¼˜åŒ–TPSéœ€ä»æ¶æ„è®¾è®¡ï¼ˆåˆ†å¸ƒå¼/å¾®æœåŠ¡ï¼‰ã€èµ„æºç®¡ç†ï¼ˆç¼“å­˜/æ•°æ®åº“ï¼‰ã€æµé‡æ§åˆ¶ï¼ˆå‰Šå³°/é™æµï¼‰å¤šç»´åº¦å…¥æ‰‹ã€‚å®é™…åº”ç”¨ä¸­ï¼Œéœ€æ ¹æ®ä¸šåŠ¡åœºæ™¯è®¾å®šåˆç†ç›®æ ‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;æ™®é€šç³»ç»Ÿ&lt;/strong&gt;ï¼šèšç„¦TPS&amp;gt;1000ï¼Œé€šè¿‡åŸºç¡€ä¼˜åŒ–å®ç°ï¼›&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;è¶…å¤§å‹ç³»ç»Ÿ&lt;/strong&gt;ï¼šéœ€å…¨å±€ååŒï¼ˆå¦‚é˜¿é‡Œçº§æ¶æ„ï¼‰ï¼Œçªç ´10ä¸‡+TPSç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="redlock"&gt;REDLOCK
&lt;/h2&gt;&lt;p&gt;REDLOCKç®—æ³•ï¼ˆä¹Ÿç§°çº¢é”ï¼‰æ˜¯ç”±Redisä½œè€…Antirezæå‡ºçš„ä¸€ç§åˆ†å¸ƒå¼é”ç®—æ³•ï¼Œæ—¨åœ¨è§£å†³å•ç‚¹Rediså®ä¾‹ä½œä¸ºåˆ†å¸ƒå¼é”æ—¶çš„å¯é æ€§é—®é¢˜ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡&lt;strong&gt;å¤šèŠ‚ç‚¹ç‹¬ç«‹æŠ•ç¥¨æœºåˆ¶&lt;/strong&gt;æå‡é”çš„å®‰å…¨æ€§å’Œå®¹é”™æ€§ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€å·¥ä½œæµç¨‹ã€äº‰è®®ä¸ä¼˜åŒ–ç­‰æ–¹é¢è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†å¤šèŠ‚ç‚¹ååŒä¸å¤šæ•°æ´¾åŸåˆ™"&gt;ğŸ” æ ¸å¿ƒåŸç†ï¼šå¤šèŠ‚ç‚¹ååŒä¸å¤šæ•°æ´¾åŸåˆ™
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³å•ç‚¹æ•…éšœ&lt;/strong&gt;ï¼šå•ä¸ªRediså®ä¾‹å®•æœºæ—¶ï¼Œé”æœåŠ¡ä»å¯ç”¨&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æå‡å®¹é”™æ€§&lt;/strong&gt;ï¼šå…è®¸éƒ¨åˆ†èŠ‚ç‚¹å¤±è´¥ï¼ˆå¦‚Nä¸ªèŠ‚ç‚¹å®¹å¿âŒŠN/2âŒ‹æ•…éšœï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‹¬ç«‹èŠ‚ç‚¹éƒ¨ç½²&lt;/strong&gt;ï¼šä½¿ç”¨å¥‡æ•°ä¸ªï¼ˆå¦‚5ä¸ªï¼‰å®Œå…¨ç‹¬ç«‹çš„Rediså®ä¾‹ï¼Œé¿å…å…±äº«ç¡¬ä»¶æˆ–ç½‘ç»œ&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œæ§½æ— å…³æ€§&lt;/strong&gt;ï¼šèŠ‚ç‚¹ä¸ä¾èµ–Redis Clusterçš„åˆ†ç‰‡ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹å­˜å‚¨é”æ•°æ®&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ•°æ´¾åŸåˆ™ï¼ˆQuorumï¼‰&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯éœ€åœ¨å¤šæ•°èŠ‚ç‚¹ï¼ˆâ‰¥ N/2 +1ï¼‰æˆåŠŸè·å–é”æ‰è§†ä¸ºåŠ é”æˆåŠŸ&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹"&gt;âš™ï¸ å·¥ä½œæµç¨‹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ é”é˜¶æ®µ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆå”¯ä¸€æ ‡è¯†&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯ç”Ÿæˆéšæœºå€¼ï¼ˆå¦‚UUIDï¼‰ä½œä¸ºé”å€¼ï¼Œé˜²æ­¢è¯¯é‡Šæ”¾&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘è¯·æ±‚é”&lt;/strong&gt;ï¼šå‘æ‰€æœ‰èŠ‚ç‚¹å‘é€åŸå­å‘½ä»¤ï¼š&lt;code&gt;SET lock_name UUID NX PX TTL&lt;/code&gt;ï¼ˆTTLé€šå¸¸ä¸ºæ¯«ç§’çº§ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åˆ¤å®šæˆåŠŸæ¡ä»¶ï¼š
&lt;ul&gt;
&lt;li&gt;æˆåŠŸèŠ‚ç‚¹æ•° â‰¥ å¤šæ•°ï¼ˆå¦‚5èŠ‚ç‚¹éœ€â‰¥3ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€»è€—æ—¶ &amp;lt; TTL/2ï¼ˆé¿å…é”è¿‡æœŸåè¯¯åˆ¤ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒé”é˜¶æ®µ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”ç»­æœŸï¼ˆå¯é€‰ï¼‰&lt;/strong&gt;ï¼šé€šè¿‡å®ˆæŠ¤çº¿ç¨‹ï¼ˆå¦‚Redissonçš„Watch Dogï¼‰å®šæœŸå»¶é•¿é”TTLï¼Œé˜²æ­¢ä¸šåŠ¡æœªå®Œæˆé”è¶…æ—¶&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡Šæ”¾é˜¶æ®µ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå­é‡Šæ”¾&lt;/strong&gt;ï¼šå‘æ‰€æœ‰èŠ‚ç‚¹å‘é€Luaè„šæœ¬ï¼Œæ ¡éªŒUUIDåŒ¹é…ååˆ é™¤é”ï¼ˆé¿å…åˆ é”™ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹å¿éƒ¨åˆ†å¤±è´¥&lt;/strong&gt;ï¼šå³ä½¿éƒ¨åˆ†èŠ‚ç‚¹é‡Šæ”¾å¤±è´¥ï¼Œé”ä»ä¼šå› TTLè¿‡æœŸè‡ªåŠ¨å¤±æ•ˆ&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-äº‰è®®ä¸ç¼ºé™·"&gt;âš ï¸ äº‰è®®ä¸ç¼ºé™·
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é’Ÿæ¼‚ç§»é—®é¢˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹é—´æ—¶é’Ÿä¸åŒæ­¥å¯èƒ½å¯¼è‡´é”æå‰å¤±æ•ˆï¼ˆå¦‚èŠ‚ç‚¹Aè®¤ä¸ºé”æœªè¿‡æœŸï¼ŒèŠ‚ç‚¹Bå·²è¿‡æœŸé‡Šæ”¾ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;ï¼šä½¿ç”¨NTPåŒæ­¥æ—¶é’Ÿï¼Œç¼©çŸ­TTLå‡å°‘å½±å“&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GCåœé¡¿å¯¼è‡´é”å¤±æ•ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯GCåœé¡¿ï¼ˆStop-The-Worldï¼‰æœŸé—´é”è¿‡æœŸï¼Œæ¢å¤åè¯¯åˆ¤æŒé”æˆåŠŸï¼Œå¼•å‘å¹¶å‘å†²çª&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯Aåœ¨GCä¸­é”è¿‡æœŸï¼Œå®¢æˆ·ç«¯Bè·æ–°é”ï¼ŒAæ¢å¤åè¯¯ä»¥ä¸ºä»æŒé”&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¸å¤æ‚åº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œå¼€é”€å¤§&lt;/strong&gt;ï¼šå¤šèŠ‚ç‚¹é€šä¿¡å¢åŠ å»¶è¿Ÿï¼ˆå¦‚5èŠ‚ç‚¹éœ€5æ¬¡RTTï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°å¤æ‚&lt;/strong&gt;ï¼šéœ€å¤„ç†èŠ‚ç‚¹è¶…æ—¶ã€éƒ¨åˆ†æˆåŠŸç­‰è¾¹ç¼˜æƒ…å†µ&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®˜æ–¹æ€åº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Redissonç­‰åº“å·²å¼ƒç”¨RedLockï¼Œå› ä¸Šè¿°é—®é¢˜æ— å®Œç¾è§£ï¼Œè½¬è€Œæ¨è&lt;strong&gt;å•èŠ‚ç‚¹+æŒä¹…åŒ–+å»¶è¿Ÿé‡å¯&lt;/strong&gt;æ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–æ–¹æ¡ˆ-1"&gt;ğŸ› ï¸ ä¼˜åŒ–æ–¹æ¡ˆ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œå»¶è¿Ÿä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é‡‡ç”¨é«˜é€Ÿå†…ç½‘éƒ¨ç½²èŠ‚ç‚¹ï¼Œå‡å°‘RTT&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è®¾ç½®åŠ¨æ€TTLï¼šæ ¹æ®ä¸šåŠ¡è€—æ—¶è°ƒæ•´é”è¶…æ—¶æ—¶é—´&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ®µåŠ é”ï¼ˆShardingï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘å†™æ“ä½œï¼ˆå¦‚ç§’æ€åº“å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°&lt;/strong&gt;ï¼šå°†èµ„æºåˆ†æ®µï¼ˆå¦‚åº“å­˜åˆ†20æ®µï¼‰ï¼Œæ¯æ®µç‹¬ç«‹åŠ é”ï¼Œæå‡å¹¶å‘åº¦&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ··åˆå®¹é”™ç­–ç•¥&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;èŠ‚ç‚¹å®•æœºé‡å¯&lt;/td&gt;
&lt;td&gt;å®•æœºåç­‰å¾…TTLæ—¶é—´å†é‡å¯ï¼Œç¡®ä¿é”å·²è¿‡æœŸ&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è„‘è£‚ï¼ˆç½‘ç»œåˆ†åŒºï¼‰&lt;/td&gt;
&lt;td&gt;éƒ¨ç½²å“¨å…µ/é›†ç¾¤æ¨¡å¼ï¼Œåˆ†åŒºæ—¶ä¼˜å…ˆä¿éšœå¤šæ•°æ´¾èŠ‚ç‚¹å¯ç”¨æ€§&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;âš–ï¸ é€‚ç”¨åœºæ™¯ä¸æ›¿ä»£æ–¹æ¡ˆ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é‡‘èäº¤æ˜“ã€åº“å­˜æ‰£å‡ç­‰&lt;strong&gt;å¼ºä¸€è‡´æ€§è¦æ±‚é«˜&lt;/strong&gt;çš„åœºæ™¯&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯ç”¨æ€§ &amp;gt; æ€§èƒ½çš„åœºæ™¯ï¼ˆå¯å®¹å¿è¾ƒé«˜å»¶è¿Ÿï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å•RedisèŠ‚ç‚¹+æŒä¹…åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®ç°ç®€å•ï¼Œæ€§èƒ½é«˜&lt;/td&gt;
&lt;td&gt;å•ç‚¹æ•…éšœé£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ZooKeeperé”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´æ€§ï¼Œæ— æ—¶é’Ÿæ¼‚ç§»é—®é¢˜&lt;/td&gt;
&lt;td&gt;æ€§èƒ½è¾ƒä½ï¼ˆTPSâ‰ˆ5kï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RedLock&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®¹é”™æ€§é«˜ï¼Œé¿å…å•ç‚¹æ•…éšœ&lt;/td&gt;
&lt;td&gt;å®ç°å¤æ‚ï¼Œå­˜åœ¨GC/æ—¶é’Ÿé—®é¢˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;REDLOCKé€šè¿‡&lt;strong&gt;å¤šèŠ‚ç‚¹æŠ•ç¥¨æœºåˆ¶&lt;/strong&gt;æå‡äº†åˆ†å¸ƒå¼é”çš„å®¹é”™æ€§ï¼Œä½†æ—¶é’Ÿæ¼‚ç§»ã€GCåœé¡¿ç­‰é—®é¢˜ä½¿å…¶åœ¨æç«¯åœºæ™¯ä¸‹ä»å­˜åœ¨é£é™©ã€‚&lt;strong&gt;å®é™…å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;è°¨æ…é€‰å‹&lt;/strong&gt;ï¼šä»…åœ¨å¿…é¡»å®¹å¿å¤šèŠ‚ç‚¹æ•…éšœæ—¶ä½¿ç”¨ï¼Œä¼˜å…ˆè€ƒè™‘å•èŠ‚ç‚¹Redisï¼ˆä¸»ä»+æŒä¹…åŒ–ï¼‰æˆ–ZooKeeper&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;âš™ï¸ &lt;strong&gt;ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;ï¼šè‹¥éœ€ä½¿ç”¨ï¼Œç»“åˆåˆ†æ®µé”ã€NTPæ—¶é’ŸåŒæ­¥é™ä½é£é™©&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼šRedissonå·²å¼ƒç”¨RedLockï¼Œå¯æ”¹ç”¨å…¶&lt;strong&gt;å¯é‡å…¥é”ï¼ˆRLockï¼‰&lt;/strong&gt; æˆ–&lt;strong&gt;è”é”ï¼ˆMultiLockï¼‰&lt;/strong&gt; å®ç°ç±»ä¼¼å¤šèŠ‚ç‚¹å®¹é”™&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="çº¢é”ä¸»èŠ‚ç‚¹"&gt;çº¢é”ä¸»èŠ‚ç‚¹
&lt;/h2&gt;&lt;p&gt;åœ¨Redisçš„&lt;strong&gt;çº¢é”ï¼ˆRedLockï¼‰ç®—æ³•&lt;/strong&gt;ä¸­ï¼Œâ€œèŠ‚ç‚¹â€&lt;strong&gt;ä¸“æŒ‡ä¸»èŠ‚ç‚¹ï¼ˆMaster Nodeï¼‰ï¼Œä¸”ä¸åŒ…å«ä»èŠ‚ç‚¹ï¼ˆSlave Nodeï¼‰&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-çº¢é”èŠ‚ç‚¹çš„å®šä¹‰ä¸ç‰¹æ€§"&gt;ğŸ” &lt;strong&gt;çº¢é”èŠ‚ç‚¹çš„å®šä¹‰ä¸ç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹ç‹¬ç«‹æ€§è¦æ±‚&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çº¢é”è¦æ±‚ä½¿ç”¨&lt;strong&gt;å¤šä¸ªå®Œå…¨ç‹¬ç«‹çš„Redisä¸»èŠ‚ç‚¹&lt;/strong&gt;ï¼ˆé€šå¸¸ä¸º5ä¸ªå¥‡æ•°èŠ‚ç‚¹ï¼‰ï¼Œè¿™äº›èŠ‚ç‚¹éƒ¨ç½²åœ¨ä¸åŒçš„ç‰©ç†æœºæˆ–è™šæ‹Ÿæœºä¸Šï¼Œé¿å…å…±äº«ç¡¬ä»¶æˆ–ç½‘ç»œï¼Œé˜²æ­¢å…±å› æ•…éšœ&lt;a class="link" href="@ref" &gt;1,2,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ä¸»ä»å…³ç³»&lt;/strong&gt;ï¼šèŠ‚ç‚¹é—´ä¸å­˜åœ¨å¤åˆ¶æˆ–é›†ç¾¤åè°ƒæœºåˆ¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹å­˜å‚¨é”æ•°æ®ã€‚ä¾‹å¦‚ï¼Œ5ä¸ªèŠ‚ç‚¹å„è‡ªä¸ºä¸»èŠ‚ç‚¹ï¼Œäº’ä¸å…³è”&lt;a class="link" href="@ref" &gt;1,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’é™¤ä»èŠ‚ç‚¹çš„åŸå› &lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»ä»å¼‚æ­¥å¤åˆ¶çš„é£é™©&lt;/strong&gt;ï¼šè‹¥ä½¿ç”¨ä¸»ä»æ¶æ„ï¼Œä¸»èŠ‚ç‚¹å†™å…¥é”åè‹¥åœ¨åŒæ­¥åˆ°ä»èŠ‚ç‚¹å‰å®•æœºï¼Œä»èŠ‚ç‚¹å‡ä¸»åå¯èƒ½ä¸¢å¤±é”çŠ¶æ€ï¼Œå¯¼è‡´å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶è·å¾—é”ï¼ˆè„‘è£‚é—®é¢˜ï¼‰&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¢é”çš„è®¾è®¡ç›®æ ‡&lt;/strong&gt;ï¼šé€šè¿‡ç‹¬ç«‹èŠ‚ç‚¹+å¤šæ•°æ´¾æŠ•ç¥¨æœºåˆ¶ï¼ˆN/2+1ï¼‰è§„é¿ä¸»ä»å¤åˆ¶çš„æ•°æ®å»¶è¿Ÿé£é™©ï¼Œç¡®ä¿é”çš„å¼ºä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;2,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-èŠ‚ç‚¹è§’è‰²ä¸ç®—æ³•å®ç°"&gt;âš™ï¸ &lt;strong&gt;èŠ‚ç‚¹è§’è‰²ä¸ç®—æ³•å®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹åœ¨ç®—æ³•ä¸­çš„æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ é”é˜¶æ®µ&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å‘æ‰€æœ‰ä¸»èŠ‚ç‚¹å¹¶å‘å‘é€åŠ é”å‘½ä»¤ï¼ˆ&lt;code&gt;SET key random_value NX PX TTL&lt;/code&gt;ï¼‰ï¼Œè¦æ±‚å¤šæ•°èŠ‚ç‚¹ï¼ˆâ‰¥ N/2+1ï¼‰è¿”å›æˆåŠŸ&lt;a class="link" href="@ref" &gt;2,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™æ€§ä¿éšœ&lt;/strong&gt;ï¼šå³ä½¿éƒ¨åˆ†èŠ‚ç‚¹å®•æœºï¼ˆå¦‚5èŠ‚ç‚¹ä¸­å®•æœº2ä¸ªï¼‰ï¼Œåªè¦å‰©ä½™èŠ‚ç‚¹æ»¡è¶³å¤šæ•°ï¼ˆ3ä¸ªï¼‰ï¼Œé”æœåŠ¡ä»å¯ç”¨&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹éƒ¨ç½²è§„èŒƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°é‡è¦æ±‚&lt;/strong&gt;ï¼šè‡³å°‘5ä¸ªèŠ‚ç‚¹ï¼ˆæ¨èå¥‡æ•°ï¼‰ï¼Œç¡®ä¿å¤šæ•°æ´¾æœºåˆ¶æœ‰æ•ˆ&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†éš”ç¦»&lt;/strong&gt;ï¼šèŠ‚ç‚¹éœ€åˆ†æ•£éƒ¨ç½²ï¼Œé¿å…å…±ç”¨ç”µæºã€ç½‘ç»œç­‰å•ç‚¹æ•…éšœæº&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§è¯¯åŒºæ¾„æ¸…"&gt;âš ï¸ &lt;strong&gt;å¸¸è§è¯¯åŒºæ¾„æ¸…&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;âŒ ä¸»ä»èŠ‚ç‚¹æ··åˆä½¿ç”¨&lt;/strong&gt;
çº¢é”è¦æ±‚æ‰€æœ‰èŠ‚ç‚¹å‡ä¸ºç‹¬ç«‹ä¸»èŠ‚ç‚¹ï¼Œè‹¥æ··å…¥ä»èŠ‚ç‚¹ï¼Œä¼šå› å¤åˆ¶å»¶è¿Ÿç ´åé”çš„å®‰å…¨æ€§&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;âŒ é›†ç¾¤æ¨¡å¼æ›¿ä»£ç‹¬ç«‹èŠ‚ç‚¹&lt;/strong&gt;
Redis Clusteræœ¬èº«ä¾èµ–ä¸»ä»å¤åˆ¶ï¼Œä¸æ»¡è¶³çº¢é”çš„ç‹¬ç«‹æ€§è¦æ±‚ï¼Œéœ€æ‰‹åŠ¨é…ç½®å¤šä¸ªå•ç‚¹ä¸»èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;çº¢é”ç®—æ³•ä¸­çš„èŠ‚ç‚¹&lt;strong&gt;ä¸¥æ ¼é™å®šä¸ºç‹¬ç«‹çš„ä¸»èŠ‚ç‚¹&lt;/strong&gt;ï¼Œé€šè¿‡å¤šæ•°æ´¾æŠ•ç¥¨æœºåˆ¶å®ç°åˆ†å¸ƒå¼é”çš„é«˜å¯ç”¨ä¸å¼ºä¸€è‡´æ€§ã€‚è¿™ç§è®¾è®¡ç‰ºç‰²äº†éƒ¨åˆ†æ€§èƒ½ï¼ˆå¤šèŠ‚ç‚¹é€šä¿¡å¼€é”€ï¼‰ï¼Œä½†æ˜¾è‘—é™ä½äº†ä¸»ä»æ¶æ„çš„è„‘è£‚é£é™©ã€‚å®é™…éƒ¨ç½²æ—¶ï¼Œéœ€éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;âœ… &lt;strong&gt;èŠ‚ç‚¹ç‹¬ç«‹æ€§&lt;/strong&gt;ï¼š5ä¸ªï¼ˆæˆ–ä»¥ä¸Šï¼‰æ— å¤åˆ¶å…³ç³»çš„Redisä¸»èŠ‚ç‚¹ï¼›&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;é¿å…ä¸»ä»æ¶æ„&lt;/strong&gt;ï¼šä»èŠ‚ç‚¹ä¸å‚ä¸çº¢é”ç®—æ³•ï¼›&lt;/li&gt;
&lt;li&gt;ğŸ”§ &lt;strong&gt;éƒ¨ç½²éš”ç¦»&lt;/strong&gt;ï¼šèŠ‚ç‚¹åˆ†æ•£åœ¨ä¸åŒç‰©ç†ç¯å¢ƒï¼Œé¿å…å…±å› æ•…éšœ&lt;a class="link" href="@ref" &gt;1,2,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ‰©å±•è¯´æ˜&lt;/strong&gt;ï¼šç”±äºçº¢é”å­˜åœ¨GCåœé¡¿ã€æ—¶é’Ÿæ¼‚ç§»ç­‰äº‰è®®é—®é¢˜ï¼ŒRedissonç­‰æ¡†æ¶å·²å¼ƒç”¨è¯¥ç®—æ³•ï¼Œè½¬å‘å•èŠ‚ç‚¹+æŒä¹…åŒ–+å»¶è¿Ÿé‡å¯ç­‰æ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚ä½†å¯¹ç†è§£åˆ†å¸ƒå¼é”çš„æ¼”è¿›ä»æœ‰é‡è¦å‚è€ƒä»·å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ—¶é—´æ¼‚ç§»"&gt;æ—¶é—´æ¼‚ç§»
&lt;/h2&gt;&lt;p&gt;çº¢é”ï¼ˆRedLockï¼‰ç®—æ³•æ˜¯Rediså®˜æ–¹æå‡ºçš„åˆ†å¸ƒå¼é”æ–¹æ¡ˆï¼Œæ—¨åœ¨è§£å†³å•èŠ‚ç‚¹Redisçš„ä¸»ä»åˆ‡æ¢å¯¼è‡´é”å¤±æ•ˆé—®é¢˜ã€‚ç„¶è€Œï¼Œå…¶è®¾è®¡ä¸­å¯¹ç³»ç»Ÿæ—¶é’Ÿçš„ä¾èµ–å¼•å‘äº†æ—¶é—´æ¼‚ç§»ï¼ˆClock Driftï¼‰ç­‰å…³é”®äº‰è®®ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ—¶é—´æ¼‚ç§»é—®é¢˜çš„æœ¬è´¨"&gt;â° &lt;strong&gt;æ—¶é—´æ¼‚ç§»é—®é¢˜çš„æœ¬è´¨&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ—¶é’Ÿæ¼‚ç§»çš„å®šä¹‰"&gt;&lt;strong&gt;æ—¶é’Ÿæ¼‚ç§»çš„å®šä¹‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¹æœ¬åŸå› &lt;/strong&gt;ï¼šRedLockä¾èµ–å„RedisèŠ‚ç‚¹çš„ç³»ç»Ÿæ—¶é—´ï¼ˆ&lt;code&gt;gettimeofday&lt;/code&gt;ï¼‰ï¼Œè€Œé&lt;strong&gt;å•è°ƒé€’å¢æ—¶é’Ÿ&lt;/strong&gt;ã€‚å½“ç³»ç»Ÿæ—¶é—´å› NTPåŒæ­¥ã€äººä¸ºä¿®æ”¹æˆ–ç¡¬ä»¶æ•…éšœå‘ç”Ÿè·³è·ƒæ—¶ï¼Œä¼šå¯¼è‡´é”çš„å®é™…æœ‰æ•ˆæœŸä¸é¢„æœŸä¸ç¬¦&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´å‘å‰è·³è·ƒ&lt;/strong&gt;ï¼šé”æå‰å¤±æ•ˆï¼Œå…¶ä»–å®¢æˆ·ç«¯å¯èƒ½è·å–é”ï¼Œç ´åäº’æ–¥æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´å‘åè·³è·ƒ&lt;/strong&gt;ï¼šé”æœ‰æ•ˆæœŸè¢«å»¶é•¿ï¼Œå¯¼è‡´é”è¢«é•¿æ—¶é—´å ç”¨&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é”æœ‰æ•ˆæœŸçš„è®¡ç®—åå·®"&gt;&lt;strong&gt;é”æœ‰æ•ˆæœŸçš„è®¡ç®—åå·®&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å®¢æˆ·ç«¯è®¡ç®—é”å‰©ä½™æœ‰æ•ˆæœŸæ—¶ï¼Œè‹¥æœ¬åœ°æ—¶é’Ÿä¸RedisèŠ‚ç‚¹æ—¶é’Ÿä¸ä¸€è‡´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯¯åˆ¤é”æœªè¿‡æœŸ&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å¯èƒ½ç»§ç»­æ“ä½œå·²å¤±æ•ˆçš„é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯¯åˆ¤é”å·²è¿‡æœŸ&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å¯èƒ½æ”¾å¼ƒæœªå¤±æ•ˆçš„é”ï¼Œå¯¼è‡´èµ„æºé—²ç½®&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ—¶é—´æ¼‚ç§»å¼•å‘çš„å®‰å…¨é—®é¢˜"&gt;âš ï¸ &lt;strong&gt;æ—¶é—´æ¼‚ç§»å¼•å‘çš„å®‰å…¨é—®é¢˜&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é”æå‰å¤±æ•ˆmartinçš„åœºæ™¯ä¸€"&gt;&lt;strong&gt;é”æå‰å¤±æ•ˆï¼ˆMartinçš„åœºæ™¯ä¸€ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;å®¢æˆ·ç«¯Aè·å–é”åå‘ç”ŸGCæš‚åœï¼ˆæˆ–ç½‘ç»œå»¶è¿Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é”å› æ—¶é—´æ¼‚ç§»æå‰è¿‡æœŸã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯Bè·å–é”å¹¶æ“ä½œå…±äº«èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯Aæ¢å¤åç»§ç»­æ“ä½œï¼Œä¸Bå†²çª&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç¼ºé™·&lt;/strong&gt;ï¼šRedLockæœªæä¾›&lt;strong&gt;Fencing Token&lt;/strong&gt;ï¼ˆé€’å¢ä»¤ç‰Œï¼‰ï¼Œæ— æ³•é˜»æ­¢è¿‡æœŸå®¢æˆ·ç«¯çš„æ“ä½œ&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤šå®¢æˆ·ç«¯åŒæ—¶æŒé”martinçš„åœºæ™¯äºŒ"&gt;&lt;strong&gt;å¤šå®¢æˆ·ç«¯åŒæ—¶æŒé”ï¼ˆMartinçš„åœºæ™¯äºŒï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;å®¢æˆ·ç«¯Aåœ¨èŠ‚ç‚¹Aã€Bã€Cè·å–é”ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;èŠ‚ç‚¹Cå› æ—¶é—´æ¼‚ç§»æå‰é‡Šæ”¾é”ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯Båœ¨èŠ‚ç‚¹Cã€Dã€Eè·å–é”ã€‚&lt;/li&gt;
&lt;li&gt;Aä¸BåŒæ—¶æŒé”ï¼Œäº’æ–¥æ€§å¤±æ•ˆ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="ç½‘ç»œå»¶è¿Ÿä¸æ—¶é’Ÿæ¼‚ç§»å åŠ martinçš„åœºæ™¯ä¸‰"&gt;&lt;strong&gt;ç½‘ç»œå»¶è¿Ÿä¸æ—¶é’Ÿæ¼‚ç§»å åŠ ï¼ˆMartinçš„åœºæ™¯ä¸‰ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å®¢æˆ·ç«¯åœ¨è·å–é”è¿‡ç¨‹ä¸­å‘ç”Ÿé•¿æ—¶é—´GCï¼Œé”è¿‡æœŸåä»æ”¶åˆ°æˆåŠŸå“åº”ï¼Œå¯¼è‡´å¤šä¸ªå®¢æˆ·ç«¯è¯¯åˆ¤æŒé”æˆåŠŸï¼ˆå°½ç®¡RedLocké€šè¿‡æ­¥éª¤3çš„è€—æ—¶æ£€æµ‹å¯ç¼“è§£æ­¤é—®é¢˜ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å…¶ä»–å…³é”®é—®é¢˜"&gt;ğŸ› ï¸ &lt;strong&gt;å…¶ä»–å…³é”®é—®é¢˜&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç½‘ç»œå»¶è¿Ÿä¸è¿›ç¨‹æš‚åœ"&gt;&lt;strong&gt;ç½‘ç»œå»¶è¿Ÿä¸è¿›ç¨‹æš‚åœ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºå‡è®¾ç¼ºé™·&lt;/strong&gt;ï¼šRedLockè¦æ±‚ç½‘ç»œå»¶è¿Ÿå’Œè¿›ç¨‹æš‚åœæ—¶é—´&lt;strong&gt;è¿œå°äºé”çš„TTL&lt;/strong&gt;ã€‚ä½†ç°å®ä¸­ï¼Œé•¿æ—¶é—´GCæˆ–ç½‘ç»œåˆ†åŒºå¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯åœ¨é”è¿‡æœŸåä»ç»§ç»­æ“ä½œ&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼šè‹¥é”TTL=10ç§’ï¼Œä½†GCæš‚åœé•¿è¾¾15ç§’ï¼Œé”å¤±æ•ˆåä¸šåŠ¡é€»è¾‘ä»åœ¨æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•…éšœæ¢å¤ä¸æŒä¹…åŒ–"&gt;&lt;strong&gt;æ•…éšœæ¢å¤ä¸æŒä¹…åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸¢å¤±é£é™©&lt;/strong&gt;ï¼šè‹¥RedisèŠ‚ç‚¹å´©æºƒåæœªæŒä¹…åŒ–é”ä¿¡æ¯ï¼Œé‡å¯åé”çŠ¶æ€ä¸¢å¤±ï¼Œå…¶ä»–å®¢æˆ·ç«¯å¯é‡æ–°è·å–åŒä¸€æŠŠé”&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿé‡å¯çš„å±€é™&lt;/strong&gt;ï¼šå®˜æ–¹å»ºè®®èŠ‚ç‚¹å´©æºƒåå»¶è¿ŸTTLæ—¶é—´å†é‡å¯ï¼Œä½†æ— æ³•è§£å†³æ—¶é—´æ¼‚ç§»é—®é¢˜&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ€§èƒ½ä¸å¤æ‚åº¦"&gt;&lt;strong&gt;æ€§èƒ½ä¸å¤æ‚åº¦&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šèŠ‚ç‚¹é€šä¿¡å¼€é”€&lt;/strong&gt;ï¼šéœ€è‡³å°‘5ä¸ªç‹¬ç«‹RedisèŠ‚ç‚¹ï¼Œæ¯æ¬¡é”æ“ä½œéœ€å¤šè½®ç½‘ç»œè¯·æ±‚ï¼Œé«˜å¹¶å‘ä¸‹å¯èƒ½æˆä¸ºç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´æˆæœ¬&lt;/strong&gt;ï¼šéœ€ä¿è¯å¤šèŠ‚ç‚¹æ—¶é’ŸåŒæ­¥ï¼Œä¸”éƒ¨ç½²å¤æ‚åº¦æ˜¾è‘—å¢åŠ &lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è§£å†³æ–¹æ¡ˆä¸äº‰è®®"&gt;ğŸ§© &lt;strong&gt;è§£å†³æ–¹æ¡ˆä¸äº‰è®®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="antirezçš„è¾©æŠ¤"&gt;&lt;strong&gt;Antirezçš„è¾©æŠ¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é’Ÿè¯¯å·®å®¹å¿&lt;/strong&gt;ï¼šå…è®¸10%ä»¥å†…çš„æ—¶é’Ÿæ¼‚ç§»ï¼ˆå¦‚TTL=5ç§’æ—¶ï¼Œå®é™…4.5~5.5ç§’å‡å¯æ¥å—ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´çº¦æŸ&lt;/strong&gt;ï¼šé€šè¿‡ç¦ç”¨NTPè‡ªåŠ¨åŒæ­¥ã€ä½¿ç”¨ç¡¬ä»¶æ—¶é’Ÿæºé™ä½æ—¶é—´è·³è·ƒæ¦‚ç‡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼šä½¿ç”¨å”¯ä¸€ä»¤ç‰Œï¼ˆUnique Tokenï¼‰å®ç°&lt;strong&gt;Check and Set&lt;/strong&gt;æ“ä½œï¼Œç¡®ä¿èµ„æºæ“ä½œçš„åŸå­æ€§&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="martinçš„æ”¹è¿›å»ºè®®"&gt;&lt;strong&gt;Martinçš„æ”¹è¿›å»ºè®®&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼•å…¥Fencing Token&lt;/strong&gt;ï¼šä¸ºé”ç»‘å®šé€’å¢ä»¤ç‰Œï¼Œèµ„æºæ“ä½œæ—¶æ ¡éªŒä»¤ç‰Œæ—¶åºæ€§ï¼ˆå¦‚ZooKeeperçš„zxidï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡‡ç”¨å¼ºä¸€è‡´æ€§ç³»ç»Ÿ&lt;/strong&gt;ï¼šå¦‚etcdæˆ–ZooKeeperï¼Œç‰ºç‰²éƒ¨åˆ†æ€§èƒ½æ¢å–å®‰å…¨æ€§&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å·¥ç¨‹å®è·µä¼˜åŒ–"&gt;&lt;strong&gt;å·¥ç¨‹å®è·µä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redissonçš„çœ‹é—¨ç‹—æœºåˆ¶&lt;/strong&gt;ï¼šè‡ªåŠ¨ç»­æœŸé”ï¼ˆé»˜è®¤30ç§’ç»­æœŸï¼‰ï¼Œå‡å°‘é”è¿‡æœŸé£é™©ï¼Œä½†æ— æ³•è§£å†³æ—¶é’Ÿè·³è·ƒé—®é¢˜&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ··åˆé”ç­–ç•¥&lt;/strong&gt;ï¼šå¯¹ä½æ•æ„Ÿåœºæ™¯ç”¨RedLockï¼Œé«˜æ•æ„Ÿåœºæ™¯ç»“åˆæ•°æ®åº“äº‹åŠ¡æˆ–ZooKeeper&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“çº¢é”çš„é€‚ç”¨æ€§ä¸å±€é™æ€§"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šçº¢é”çš„é€‚ç”¨æ€§ä¸å±€é™æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…å•ç‚¹æ•…éšœï¼ˆéœ€å¤šæ•°èŠ‚ç‚¹å­˜æ´»ï¼‰&lt;/td&gt;
&lt;td&gt;æ—¶é—´æ¼‚ç§»å¯èƒ½ç ´åäº’æ–¥æ€§&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼˜äºå•èŠ‚ç‚¹Redisä¸»ä»æ¶æ„&lt;/td&gt;
&lt;td&gt;ç¼ºä¹Fencing Tokenï¼Œæ— æ³•é˜²è¿‡æœŸæ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜äºå¼ºä¸€è‡´æ€§ç³»ç»Ÿï¼ˆå¦‚ZooKeeperï¼‰&lt;/td&gt;
&lt;td&gt;å¤šèŠ‚ç‚¹é€šä¿¡å¼€é”€æ˜¾è‘—&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿ç»´å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½äºå¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²çš„å¼ºä¸€è‡´æ€§ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;éœ€æ—¶é’ŸåŒæ­¥ä¸èŠ‚ç‚¹å¥åº·ç›‘æ§&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å»ºè®®é€‰æ‹©åœºæ™¯&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;âœ… â€‹&lt;strong&gt;å¯å®¹å¿ä½æ¦‚ç‡é”å¤±æ•ˆ&lt;/strong&gt;â€‹ï¼šå¦‚ç§’æ€åº“å­˜æ‰£å‡ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;âœ… â€‹&lt;strong&gt;æ—¶é’Ÿç¯å¢ƒç¨³å®š&lt;/strong&gt;â€‹ï¼šå¦‚ç‰©ç†æœºéƒ¨ç½²ä¸”ç¦ç”¨NTPè‡ªåŠ¨åŒæ­¥ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;âŒ â€‹&lt;strong&gt;å¼ºä¸€è‡´æ€§è¦æ±‚&lt;/strong&gt;â€‹ï¼šå¦‚é‡‘èäº¤æ˜“ï¼Œåº”æ”¹ç”¨ZooKeeperæˆ–æ•°æ®åº“é”&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;æ­£å¦‚åˆ†å¸ƒå¼ç³»ç»Ÿé¢†åŸŸçš„ç»å…¸ç»“è®ºï¼š&lt;strong&gt;â€œæ²¡æœ‰å®Œç¾çš„åˆ†å¸ƒå¼é”ï¼Œåªæœ‰é€‚åˆåœºæ™¯çš„æƒè¡¡â€&lt;/strong&gt;ã€‚çº¢é”åœ¨å¤šæ•°åœºæ™¯ä¸‹å¯å¹³è¡¡æ€§èƒ½ä¸å¯é æ€§ï¼Œä½†éœ€ä¸¥æ ¼è§„é¿å…¶æ—¶é’Ÿæ•æ„Ÿæ€§çš„ç¡¬ä¼¤&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ntp"&gt;NTP
&lt;/h2&gt;&lt;p&gt;NTPï¼ˆNetwork Time Protocolï¼Œç½‘ç»œæ—¶é—´åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºåŒæ­¥è®¡ç®—æœºç½‘ç»œä¸­å„è®¾å¤‡ç³»ç»Ÿæ—¶é’Ÿçš„åº”ç”¨å±‚åè®®ï¼Œå±äºTCP/IPåè®®æ—ã€‚å…¶æ ¸å¿ƒç›®æ ‡æ˜¯è§£å†³åˆ†å¸ƒå¼ç¯å¢ƒä¸­è®¾å¤‡æ—¶é’Ÿä¸ä¸€è‡´çš„é—®é¢˜ï¼Œé€šè¿‡åˆ†å±‚æ¶æ„å’Œç²¾å¯†ç®—æ³•å®ç°é«˜ç²¾åº¦æ—¶é—´åŒæ­¥ï¼ˆå±€åŸŸç½‘è¯¯å·®&amp;lt;1æ¯«ç§’ï¼Œå¹¿åŸŸç½‘è¯¯å·®&amp;lt;50æ¯«ç§’ï¼‰&lt;a class="link" href="@ref" &gt;1,3,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸å·¥ä½œæœºåˆ¶"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸å·¥ä½œæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å±‚æ—¶é—´æºæ¶æ„ï¼ˆStratumï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Stratum 0&lt;/strong&gt;ï¼šé«˜ç²¾åº¦æ—¶é—´æºï¼ˆå¦‚åŸå­é’Ÿã€GPSå«æ˜Ÿæ—¶é’Ÿï¼‰ï¼Œä¸ç›´æ¥å‚ä¸ç½‘ç»œåŒæ­¥&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Stratum 1&lt;/strong&gt;ï¼šç›´æ¥è¿æ¥Stratum 0çš„è®¾å¤‡ï¼ˆå¦‚æ—¶é—´æœåŠ¡å™¨ï¼‰ï¼Œä½œä¸ºä¸»æ—¶é—´æºå‘ç½‘ç»œåˆ†å‘æ—¶é—´&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Stratum 2/3&lt;/strong&gt;ï¼šä»ä¸Šå±‚æœåŠ¡å™¨åŒæ­¥æ—¶é—´ï¼Œå±‚çº§é€’å¢ï¼ˆStratumå€¼è¶Šå¤§ï¼Œç²¾åº¦è¶Šä½ï¼‰ï¼Œæœ€é«˜è‡³Stratum 15ï¼ˆæœªåŒæ­¥çŠ¶æ€ï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´åŒæ­¥è¿‡ç¨‹&lt;/strong&gt;
å®¢æˆ·ç«¯é€šè¿‡å››æ¬¡æ—¶é—´æˆ³äº¤æ¢è®¡ç®—æ—¶é—´åå·®ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Tâ‚&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚çš„æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tâ‚‚&lt;/strong&gt;ï¼šæœåŠ¡å™¨æ¥æ”¶è¯·æ±‚çš„æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tâ‚ƒ&lt;/strong&gt;ï¼šæœåŠ¡å™¨å‘é€å“åº”çš„æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tâ‚„&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯æ¥æ”¶å“åº”çš„æ—¶é—´ã€‚
é€šè¿‡å…¬å¼è®¡ç®—ç½‘ç»œå»¶è¿Ÿï¼ˆ&lt;code&gt;Î´ = (Tâ‚„ - Tâ‚) - (Tâ‚ƒ - Tâ‚‚)&lt;/code&gt;ï¼‰å’Œæ—¶é—´åç§»ï¼ˆ&lt;code&gt;Î¸ = [(Tâ‚‚ - Tâ‚) + (Tâ‚ƒ - Tâ‚„)] / 2&lt;/code&gt;ï¼‰ï¼Œå®¢æˆ·ç«¯æ®æ­¤è°ƒæ•´æœ¬åœ°æ—¶é’Ÿ&lt;a class="link" href="@ref" &gt;3,7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™ä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šæºæ ¡éªŒ&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯åŒæ—¶æŸ¥è¯¢å¤šä¸ªæœåŠ¡å™¨ï¼Œé€šè¿‡ç®—æ³•è¿‡æ»¤å¼‚å¸¸å€¼ï¼ˆå¦‚ç½‘ç»œæŠ–åŠ¨æˆ–æ•…éšœèŠ‚ç‚¹ï¼‰&lt;a class="link" href="@ref" &gt;1,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é’Ÿæ¼‚ç§»è¡¥å¿&lt;/strong&gt;ï¼šä½¿ç”¨å†å²æ•°æ®é¢„æµ‹æ—¶é’Ÿæ¼‚ç§»ï¼Œå³ä½¿æ–­ç½‘ä¹Ÿèƒ½ç»´æŒçŸ­æœŸç²¾åº¦&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æŠ€æœ¯ä¸æ¨¡å¼"&gt;âš™ï¸ &lt;strong&gt;å…³é”®æŠ€æœ¯ä¸æ¨¡å¼&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œæ¨¡å¼&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®¢æˆ·ç«¯/æœåŠ¡å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¸¸è§„è®¾å¤‡åŒæ­¥ï¼ˆå¦‚PCã€è·¯ç”±å™¨ï¼‰&lt;/td&gt;
&lt;td&gt;å®¢æˆ·ç«¯ä¸»åŠ¨è¯·æ±‚ï¼ŒæœåŠ¡å™¨å“åº”&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯¹ç­‰ä½“ï¼ˆSymmetricï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœåŠ¡å™¨é—´äº’ç›¸åŒæ­¥ï¼ˆå¦‚Stratum 2èŠ‚ç‚¹é—´ï¼‰&lt;/td&gt;
&lt;td&gt;åŒå‘æ—¶é—´æ ¡å‡†ï¼Œæå‡å†—ä½™æ€§&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¿æ’­/ç»„æ’­&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤§è§„æ¨¡å±€åŸŸç½‘ï¼ˆå¦‚å·¥ä¸šæ§åˆ¶ç½‘ç»œï¼‰&lt;/td&gt;
&lt;td&gt;æœåŠ¡å™¨å‘¨æœŸæ€§å¹¿æ’­æ—¶é—´ï¼Œå®¢æˆ·ç«¯è¢«åŠ¨æ¥æ”¶&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èº«ä»½éªŒè¯&lt;/strong&gt;ï¼šä½¿ç”¨HMAC-SHA256åŠ å¯†å¯†é’¥ï¼Œé˜²æ­¢ä¼ªé€ æ—¶é—´æº&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¿é—®æ§åˆ¶&lt;/strong&gt;ï¼šé™åˆ¶ç‰¹å®šIPæˆ–ç½‘æ®µè®¿é—®NTPæœåŠ¡ï¼ˆå¦‚&lt;code&gt;ntp access-group&lt;/code&gt;å‘½ä»¤ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯"&gt;ğŸŒ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é‡‘èäº¤æ˜“ç³»ç»Ÿ&lt;/strong&gt;
ç¡®ä¿å…¨çƒäº¤æ˜“è®¢å•çš„æ—¶é—´æˆ³ä¸€è‡´ï¼ˆå¦‚å¾®ç§’çº§åŒæ­¥ï¼‰ï¼Œé¿å…å› æ—¶é’Ÿåå·®å¯¼è‡´çš„ç»“ç®—çº çº·&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼ç³»ç»Ÿä¸æ—¥å¿—ç®¡ç†&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç»Ÿä¸€æœåŠ¡å™¨ã€æ•°æ®åº“çš„æ—¥å¿—æ—¶é—´æˆ³ï¼Œä¾¿äºæ•…éšœè¿½è¸ªï¼ˆå¦‚è·¨è®¾å¤‡æ—¥å¿—å…³è”åˆ†æï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;Hadoopé›†ç¾¤ä¾èµ–NTPåè°ƒä»»åŠ¡è°ƒåº¦ï¼Œé˜²æ­¢æ•°æ®å†™å…¥å†²çª&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä¸šè‡ªåŠ¨åŒ–&lt;/strong&gt;
å·¥å‚è®¾å¤‡ï¼ˆå¦‚PLCæ§åˆ¶å™¨ï¼‰éœ€åŒæ­¥è‡³æ¯«ç§’çº§ï¼Œç¡®ä¿è£…é…çº¿ååŒè¿ä½œ&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œå®‰å…¨&lt;/strong&gt;
è¯ä¹¦æœ‰æ•ˆæœŸéªŒè¯ã€Kerberosèº«ä»½è®¤è¯å‡ä¾èµ–ç²¾ç¡®æ—¶é—´ï¼Œé˜²æ­¢é‡æ”¾æ”»å‡»&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å±€é™æ€§ä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;âš ï¸ &lt;strong&gt;å±€é™æ€§ä¸æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é’Ÿè·³è·ƒé£é™©&lt;/strong&gt;ï¼šNTPä¾èµ–ç³»ç»Ÿæ—¶é’Ÿï¼Œè‹¥æœåŠ¡å™¨æ—¶é—´è¢«æ‰‹åŠ¨ä¿®æ”¹æˆ–NTPåè®®é­æ”»å‡»ï¼Œä¼šå¯¼è‡´åŒæ­¥å¤±æ•ˆ&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç²¾åº¦ç“¶é¢ˆ&lt;/strong&gt;ï¼šå¹¿åŸŸç½‘å»¶è¿Ÿé™åˆ¶ç²¾åº¦ï¼ˆé€šå¸¸&amp;gt;10msï¼‰ï¼Œä¸é€‚ç”¨çº³ç§’çº§éœ€æ±‚åœºæ™¯ï¼ˆå¦‚é«˜é¢‘äº¤æ˜“ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;PTPï¼ˆPrecision Time Protocolï¼‰&lt;/strong&gt;ï¼šé€šè¿‡ç¡¬ä»¶æ—¶é—´æˆ³å®ç°çº³ç§’çº§åŒæ­¥ï¼Œç”¨äº5GåŸºç«™ã€å·¥ä¸šä»¥å¤ªç½‘&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SNTPï¼ˆç®€å•NTPï¼‰&lt;/strong&gt;ï¼šç®€åŒ–NTPåŠŸèƒ½ï¼Œé€‚ç”¨äºåµŒå…¥å¼è®¾å¤‡ç­‰ä½èµ„æºåœºæ™¯ï¼Œä½†ç²¾åº¦è¾ƒä½&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;NTPæ˜¯äº’è”ç½‘æ—¶é—´åŒæ­¥çš„åŸºçŸ³ï¼Œé€šè¿‡åˆ†å±‚æ¶æ„å’Œæ™ºèƒ½ç®—æ³•å¹³è¡¡ç²¾åº¦ä¸å¯é æ€§ã€‚å…¶ä»·å€¼åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å°¤ä¸ºçªå‡ºâ€”â€”&lt;strong&gt;ç»Ÿä¸€çš„æ—¶é—´çº¿æ˜¯æ•°æ®ä¸€è‡´æ€§ä¸ä¸šåŠ¡è¿è´¯æ€§çš„å‰æ&lt;/strong&gt;ã€‚å°½ç®¡å­˜åœ¨æ—¶é’Ÿæ¼‚ç§»å’Œå®‰å…¨æŒ‘æˆ˜ï¼Œç»“åˆå†—ä½™è®¾è®¡ï¼ˆå¦‚å¤šStratum 1æºï¼‰ä¸åŠ å¯†æ‰‹æ®µåï¼ŒNTPä»æ˜¯é‡‘èã€é€šä¿¡ã€å·¥ä¸šç­‰é¢†åŸŸçš„é¦–é€‰æ–¹æ¡ˆã€‚å¯¹æ›´é«˜ç²¾åº¦åœºæ™¯ï¼Œå¯è½¬å‘PTPï¼›å¯¹ç®€æ˜“è®¾å¤‡ï¼ŒSNTPæä¾›äº†è½»é‡æ›¿ä»£&lt;a class="link" href="@ref" &gt;1,7,10&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="ä»£æ›¿æ–¹æ¡ˆ"&gt;ä»£æ›¿æ–¹æ¡ˆ
&lt;/h2&gt;&lt;p&gt;çº¢é”ï¼ˆRedLockï¼‰ç®—æ³•æ˜¯Redisä½œè€…æå‡ºçš„åˆ†å¸ƒå¼é”æ–¹æ¡ˆï¼Œæ—¨åœ¨è§£å†³Redisä¸»ä»æ¶æ„ä¸‹çš„é”å¤±æ•ˆé—®é¢˜ï¼Œä½†å…¶ä¾èµ–å¤šèŠ‚ç‚¹æ—¶é’ŸåŒæ­¥å’Œå¤æ‚äº¤äº’ï¼Œå­˜åœ¨å®‰å…¨æ€§äº‰è®®ï¼ˆå¦‚æ—¶é’Ÿæ¼‚ç§»ã€ç½‘ç»œåˆ†åŒºé£é™©ï¼‰&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚ä»¥ä¸‹ä»æŠ€æœ¯åŸç†ã€é€‚ç”¨åœºæ™¯å’Œå·¥ç¨‹å®è·µè§’åº¦ï¼Œè¯¦ç»†ä»‹ç»å…¶æ›¿ä»£æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¼ºä¸€è‡´æ€§åè°ƒæœåŠ¡æ–¹æ¡ˆ"&gt;ğŸ”’ &lt;strong&gt;å¼ºä¸€è‡´æ€§åè°ƒæœåŠ¡æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="zookeeper"&gt;&lt;strong&gt;ZooKeeper&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;åŸºäº&lt;strong&gt;ä¸´æ—¶æœ‰åºèŠ‚ç‚¹&lt;/strong&gt;å®ç°é”ï¼šå®¢æˆ·ç«¯åœ¨æŒ‡å®šè·¯å¾„ä¸‹åˆ›å»ºä¸´æ—¶æœ‰åºèŠ‚ç‚¹ï¼Œç›‘å¬æ¯”è‡ªèº«åºå·å°çš„èŠ‚ç‚¹åˆ é™¤äº‹ä»¶ï¼Œæœ€å°åºå·èŠ‚ç‚¹è·å–é”&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼šè¯æœºåˆ¶&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯ä¸ZooKeeperä¿æŒå¿ƒè·³ï¼Œä¼šè¯è¶…æ—¶è‡ªåŠ¨åˆ é™¤èŠ‚ç‚¹é‡Šæ”¾é”ï¼Œé¿å…æ­»é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºä¸€è‡´æ€§&lt;/strong&gt;ï¼šé€šè¿‡ZABåè®®ï¼ˆç±»Paxosï¼‰ä¿è¯é›†ç¾¤çŠ¶æ€ä¸€è‡´ï¼Œé”äº’æ–¥æ€§ä¸¥æ ¼&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— æ—¶é’Ÿä¾èµ–&lt;/strong&gt;ï¼šä¸ä¾èµ–ç³»ç»Ÿæ—¶é—´ï¼Œè§„é¿æ—¶é’Ÿæ¼‚ç§»é—®é¢˜ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨å®¹é”™&lt;/strong&gt;ï¼šèŠ‚ç‚¹æ•…éšœæ—¶ä¸´æ—¶èŠ‚ç‚¹è‡ªåŠ¨æ¸…é™¤ï¼Œé”å³æ—¶é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€‚ç”¨åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;é‡‘èäº¤æ˜“ã€åˆ†å¸ƒå¼äº‹åŠ¡ç­‰å¯¹&lt;strong&gt;å®‰å…¨æ€§è¦æ±‚æé«˜&lt;/strong&gt;çš„åœºæ™¯&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="etcd"&gt;&lt;strong&gt;etcd&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç§Ÿçº¦ï¼ˆLeaseï¼‰æœºåˆ¶&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯åˆ›å»ºç§Ÿçº¦ï¼ˆTTLï¼‰ï¼Œç»‘å®šé”®å€¼å¯¹ï¼›é”åˆ°æœŸè‡ªåŠ¨åˆ é™¤é”®&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æ“ä½œ&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;txn&lt;/code&gt;å‘½ä»¤åŸå­åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨å¹¶å†™å…¥ï¼Œé¿å…å¹¶å‘å†²çªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çº¿æ€§ä¸€è‡´æ€§&lt;/strong&gt;ï¼šRaftåè®®ä¿è¯è¯»å†™æ“ä½œçš„å¼ºä¸€è‡´æ€§ï¼Œé”çŠ¶æ€å…¨å±€å¯è§&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ€§èƒ½&lt;/strong&gt;ï¼šç›¸æ¯”ZooKeeperï¼Œetcdçš„gRPCæ¥å£å’Œå†…å­˜å­˜å‚¨æä¾›æ›´ä½å»¶è¿Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š
KubernetesæœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†ç­‰éœ€&lt;strong&gt;é«˜å¯é é”&lt;/strong&gt;çš„åœºæ™¯&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®åº“å±‚æ–¹æ¡ˆ"&gt;ğŸ’¾ &lt;strong&gt;æ•°æ®åº“å±‚æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å”¯ä¸€çº¦æŸä¸ä¹è§‚é”"&gt;&lt;strong&gt;å”¯ä¸€çº¦æŸä¸ä¹è§‚é”&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å”¯ä¸€ç´¢å¼•&lt;/strong&gt;ï¼šä¸šåŠ¡è¡¨æ·»åŠ é”æ ‡è¯†å­—æ®µï¼ˆå¦‚&lt;code&gt;lock_key&lt;/code&gt;ï¼‰ï¼Œé€šè¿‡&lt;code&gt;INSERT&lt;/code&gt;ç«äº‰é”ï¼ˆå”¯ä¸€ç´¢å¼•é˜²é‡å¤ï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¹è§‚é”&lt;/strong&gt;ï¼šåŸºäºç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³æ›´æ–°æ•°æ®ï¼Œæ›´æ–°å¤±è´¥åˆ™é”è·å–å¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— é¢å¤–ä¾èµ–&lt;/strong&gt;ï¼šå¤ç”¨ç°æœ‰æ•°æ®åº“ï¼Œé™ä½è¿ç»´å¤æ‚åº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡æ”¯æŒ&lt;/strong&gt;ï¼šç»“åˆæ•°æ®åº“äº‹åŠ¡ï¼Œä¿è¯é”æ“ä½œä¸ä¸šåŠ¡é€»è¾‘åŸå­æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å±€é™ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;ï¼šé«˜å¹¶å‘ä¸‹é¢‘ç¹ç«äº‰é”å¯èƒ½å¼•å‘æ•°æ®åº“æ€§èƒ½ä¸‹é™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š
å·²å¼ºä¾èµ–æ•°æ®åº“ä¸”&lt;strong&gt;å¹¶å‘é‡ä¸­ç­‰&lt;/strong&gt;çš„ç³»ç»Ÿï¼ˆå¦‚è®¢å•ç³»ç»Ÿï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ‚²è§‚é”select-for-update"&gt;&lt;strong&gt;æ‚²è§‚é”ï¼ˆSELECT FOR UPDATEï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼š
äº‹åŠ¡ä¸­æ‰§è¡Œ&lt;code&gt;SELECT ... FOR UPDATE&lt;/code&gt;é”å®šç›®æ ‡æ•°æ®è¡Œï¼Œå…¶ä»–äº‹åŠ¡é˜»å¡ç­‰å¾…&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å®ç°ç®€å•ï¼Œä¸ä¸šåŠ¡é€»è¾‘æ— ç¼é›†æˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ­»é”é£é™©éœ€è¶…æ—¶æœºåˆ¶æˆ–æ­»é”æ£€æµ‹ã€‚&lt;/li&gt;
&lt;li&gt;é•¿äº‹åŠ¡å¯¼è‡´è¿æ¥æ± è€—å°½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-redisç”Ÿæ€å¢å¼ºæ–¹æ¡ˆ"&gt;âš¡ &lt;strong&gt;Redisç”Ÿæ€å¢å¼ºæ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="redisä¼ä¸šç‰ˆwaitå‘½ä»¤"&gt;&lt;strong&gt;Redisä¼ä¸šç‰ˆï¼ˆWAITå‘½ä»¤ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯åŠ é”åæ‰§è¡Œ&lt;code&gt;WAIT N&lt;/code&gt;ï¼Œå¼ºåˆ¶ç­‰å¾…é”æ•°æ®åŒæ­¥åˆ°Nä¸ªå‰¯æœ¬ï¼Œå†æ‰§è¡Œä¸šåŠ¡é€»è¾‘&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;å…¼å®¹Redisåè®®ï¼Œæ— éœ€æ”¹é€ å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;li&gt;é™ä½ä¸»ä»åˆ‡æ¢å¯¼è‡´çš„é”ä¸¢å¤±æ¦‚ç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å±€é™ï¼š
&lt;ul&gt;
&lt;li&gt;å¢åŠ æ“ä½œå»¶è¿Ÿï¼ˆåŒæ­¥ç­‰å¾…æ—¶é—´ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸è§£å†³æ—¶é’Ÿæ¼‚ç§»é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="redissonè”é”multilock"&gt;&lt;strong&gt;Redissonè”é”ï¼ˆMultiLockï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼š
åŒæ—¶é”å®šå¤šä¸ªèµ„æºï¼ˆå¦‚è®¢å•ã€åº“å­˜ï¼‰ï¼ŒåŸå­æ€§ä¿è¯å¤šèµ„æºæ“ä½œ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨æ€§&lt;/strong&gt;ï¼š
â€‹&lt;strong&gt;ä»…é€‚ç”¨äºå¤šèµ„æºäº‹åŠ¡&lt;/strong&gt;ï¼Œä¸è§£å†³å•é”çš„é«˜å¯ç”¨é—®é¢˜&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸šåŠ¡å±‚å®¹é”™æ–¹æ¡ˆ"&gt;ğŸ›¡ï¸ &lt;strong&gt;ä¸šåŠ¡å±‚å®¹é”™æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="fencing-tokené˜²æŠ¤ä»¤ç‰Œ"&gt;&lt;strong&gt;Fencing Tokenï¼ˆé˜²æŠ¤ä»¤ç‰Œï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;é”æœåŠ¡è¿”å›å•è°ƒé€’å¢çš„ä»¤ç‰Œï¼ˆå¦‚ZooKeeperçš„zxidï¼‰ï¼Œä¸šåŠ¡æ“ä½œæ—¶æ ¡éªŒä»¤ç‰Œæ—¶åºæ€§&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ä»¤ç‰Œè¿‡æœŸï¼ˆé”å¤±æ•ˆåè¢«å…¶ä»–å®¢æˆ·ç«¯å ç”¨ï¼‰ï¼Œæ‹’ç»æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»·å€¼&lt;/strong&gt;ï¼š
è§£å†³é”å¤±æ•ˆå&lt;strong&gt;æ®‹ç•™æ“ä½œ&lt;/strong&gt;çš„å®‰å…¨é—®é¢˜ï¼Œæ˜¯çº¢é”çš„è¡¥å……æœºåˆ¶&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼‚æ­¥ç»­æœŸä¸è¶…æ—¶ç†”æ–­"&gt;&lt;strong&gt;å¼‚æ­¥ç»­æœŸä¸è¶…æ—¶ç†”æ–­&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†ï¼š
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯è·å–é”åå¯åŠ¨å¼‚æ­¥ä»»åŠ¡ç»­æœŸï¼ˆç±»ä¼¼Redissonçœ‹é—¨ç‹—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸šåŠ¡é€»è¾‘è¶…æ—¶åˆ™ä¸»åŠ¨ç†”æ–­ï¼Œé˜²æ­¢é”è¿‡æœŸåç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š
é•¿ä»»åŠ¡ä¸”&lt;strong&gt;å¯å®¹å¿çŸ­æš‚é”å¤±æ•ˆ&lt;/strong&gt;çš„ç³»ç»Ÿï¼ˆå¦‚æ•°æ®åˆ†æï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹å»ºè®®"&gt;ğŸ“Š &lt;strong&gt;æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¤æ‚åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ZooKeeper&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­&lt;/td&gt;
&lt;td&gt;â­â­â­â­&lt;/td&gt;
&lt;td&gt;é‡‘èã€å¼ºä¸€è‡´æ€§è¦æ±‚åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;etcd&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;Kubernetesç”Ÿæ€ã€é«˜å¹¶å‘é…ç½®ç®¡ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®åº“å”¯ä¸€çº¦æŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“å¼ºä¾èµ–çš„ä¸­ç­‰å¹¶å‘ç³»ç»Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Redisä¼ä¸šç‰ˆï¼ˆWAITï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­&lt;/td&gt;
&lt;td&gt;å·²ç”¨Redisä¸”éœ€å¿«é€Ÿå¢å¼ºé”å¯é æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Fencing Token&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;ä½œä¸ºçº¢é”çš„è¡¥å……æœºåˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="é€‰å‹å»ºè®®"&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;å¼ºä¸€è‡´æ€§è¦æ±‚&lt;/strong&gt;ï¼šé¦–é€‰ZooKeeperæˆ–etcdï¼Œå°¤å…¶é‡‘èåœºæ™¯&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;Redisç”Ÿæ€å…¼å®¹&lt;/strong&gt;ï¼šRedisä¼ä¸šç‰ˆ + WAITå‘½ä»¤ï¼Œæˆ–Redissoné»˜è®¤é”ï¼ˆéçº¢é”ï¼‰ + Fencing Token&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;æˆæœ¬æ•æ„Ÿä¸”éå…³é”®è·¯å¾„&lt;/strong&gt;ï¼šæ•°æ®åº“å”¯ä¸€çº¦æŸ + ä¸šåŠ¡é‡è¯•ã€‚&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;æ…ç”¨çº¢é”&lt;/strong&gt;ï¼šä»…åœ¨å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²ä¸”æœ‰æ—¶é’Ÿç›‘æ§æ—¶è€ƒè™‘ï¼Œé…åˆFencing Tokenä½¿ç”¨&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;çº¢é”çš„æ›¿ä»£æ–¹æ¡ˆæœ¬è´¨æ˜¯åœ¨&lt;strong&gt;å®‰å…¨æ€§ã€æ€§èƒ½ã€å¤æ‚åº¦&lt;/strong&gt;ä¸‰è€…é—´æƒè¡¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¼ºä¸€è‡´ç³»ç»Ÿï¼ˆZooKeeper/etcdï¼‰ç‰ºç‰²éƒ¨åˆ†æ€§èƒ½æ¢å–ç»å¯¹å®‰å…¨ï¼›&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“æ–¹æ¡ˆä»¥ä¸šåŠ¡ä¾µå…¥æ€§é™ä½å¤–éƒ¨ä¾èµ–ï¼›&lt;/li&gt;
&lt;li&gt;Rediså¢å¼ºæ–¹æ¡ˆå¹³è¡¡è¿ç§»æˆæœ¬å’Œå¯é æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ­£å¦‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸“å®¶ Martin Kleppmann æ‰€è¿°ï¼š&lt;strong&gt;â€œé”çš„æœ¬è´¨æ˜¯å…±è¯†é—®é¢˜ï¼Œè€Œå…±è¯†éœ€ä¾èµ–åº•å±‚å­˜å‚¨çš„å¯é æ€§â€&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚åœ¨å·¥ç¨‹å®è·µä¸­ï¼Œç»“åˆä¸šåŠ¡å®¹å¿åº¦é€‰æ‹©æ–¹æ¡ˆï¼Œå¹¶è¾…ä»¥Fencing Tokenç­‰æœºåˆ¶ï¼Œæ‰æ˜¯æ„å»ºå¥å£®åˆ†å¸ƒå¼é”çš„å…³é”®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="netty"&gt;Netty
&lt;/h2&gt;&lt;p&gt;Netty æ˜¯ä¸€ä¸ª&lt;strong&gt;åŸºäº Java NIO çš„å¼‚æ­¥äº‹ä»¶é©±åŠ¨ç½‘ç»œæ¡†æ¶&lt;/strong&gt;ï¼Œç”± JBOSS å›¢é˜Ÿå¼€å‘ï¼Œæ—¨åœ¨ç®€åŒ–é«˜æ€§èƒ½ã€é«˜å¯é æ€§ç½‘ç»œåº”ç”¨çš„å¼€å‘ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒç‰¹æ€§ã€æ¶æ„è®¾è®¡ã€åº”ç”¨åœºæ™¯åŠå®æˆ˜ç¤ºä¾‹å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ€§èƒ½ä¸ä½å»¶è¿Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é›¶æ‹·è´æŠ€æœ¯&lt;/strong&gt;ï¼šä½¿ç”¨å †å¤–ç›´æ¥å†…å­˜ï¼ˆ&lt;code&gt;Direct ByteBuf&lt;/code&gt;ï¼‰ï¼Œé¿å…æ•°æ®åœ¨ JVM å †ä¸å†…æ ¸ç©ºé—´é—´å¤šæ¬¡æ‹·è´ï¼Œæå‡ I/O æ•ˆç‡&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜æ± æœºåˆ¶&lt;/strong&gt;ï¼šé‡ç”¨ç¼“å†²åŒºå¯¹è±¡ï¼Œå‡å°‘é¢‘ç¹å†…å­˜åˆ†é…/å›æ”¶çš„ GC å‹åŠ›&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é”åŒ–è®¾è®¡&lt;/strong&gt;ï¼šé€šè¿‡çº¿ç¨‹ç»‘å®šï¼ˆæ¯ä¸ª &lt;code&gt;Channel&lt;/code&gt; ç»‘å®šå›ºå®š &lt;code&gt;EventLoop&lt;/code&gt;ï¼‰å’Œä¸²è¡Œå¤„ç†é“¾ï¼Œé¿å…å¤šçº¿ç¨‹ç«äº‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥äº‹ä»¶é©±åŠ¨æ¨¡å‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éé˜»å¡ I/O&lt;/strong&gt;ï¼šåŸºäº &lt;code&gt;Selector&lt;/code&gt; å¤šè·¯å¤ç”¨ï¼Œå•çº¿ç¨‹å¯å¤„ç†æ•°åƒè¿æ¥ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Future-Listener æœºåˆ¶&lt;/strong&gt;ï¼šå¼‚æ­¥æ“ä½œç»“æœé€šè¿‡å›è°ƒé€šçŸ¥ï¼Œé¿å…çº¿ç¨‹é˜»å¡&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿ƒè·³æ£€æµ‹&lt;/strong&gt;ï¼šå†…ç½®å¿ƒè·³æœºåˆ¶è‡ªåŠ¨ç®¡ç†è¿æ¥çŠ¶æ€ï¼Œé˜²æ­¢åƒµå°¸è¿æ¥&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»å¯æ‰©å±•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡å—åŒ–åè®®æ”¯æŒ&lt;/strong&gt;ï¼šå†…ç½® HTTP/WebSocket/TCP/UDP ç­‰åè®®ç¼–è§£ç å™¨ï¼Œæ”¯æŒè‡ªå®šä¹‰åè®®ï¼ˆå¦‚ RPC ç§æœ‰åè®®ï¼‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é“¾å¼å¤„ç†å™¨ï¼ˆ&lt;code&gt;ChannelPipeline&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼šé€šè¿‡æ·»åŠ /ç§»é™¤ &lt;code&gt;ChannelHandler&lt;/code&gt; åŠ¨æ€æ‰©å±•å¤„ç†é€»è¾‘ï¼ˆå¦‚åŠ å¯†ã€å‹ç¼©ã€ä¸šåŠ¡å¤„ç†ï¼‰&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶æ„è®¾è®¡"&gt;âš™ï¸ &lt;strong&gt;æ¶æ„è®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç»„ä»¶&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»„ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Channel&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç½‘ç»œè¿æ¥æŠ½è±¡ï¼ˆå¦‚ TCP Socketï¼‰ï¼Œæ”¯æŒè¯»å†™æ“ä½œ&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;EventLoop&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;äº‹ä»¶å¾ªç¯çº¿ç¨‹ï¼Œç›‘å¬ I/O äº‹ä»¶å¹¶è°ƒåº¦ &lt;code&gt;ChannelHandler&lt;/code&gt; æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ChannelHandler&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¤„ç†å…¥ç«™/å‡ºç«™æ•°æ®ï¼ˆå¦‚ç¼–è§£ç ã€ä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œåˆ†ä¸º &lt;code&gt;Inbound&lt;/code&gt;/&lt;code&gt;Outbound&lt;/code&gt; ä¸¤ç±»&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ChannelPipeline&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ChannelHandler&lt;/code&gt; çš„è´£ä»»é“¾ï¼Œæ•°æ®æŒ‰é¡ºåºæµç»å„å¤„ç†å™¨&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ByteBuf&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é«˜æ•ˆæ•°æ®å®¹å™¨ï¼Œæ”¯æŒåŠ¨æ€æ‰©å®¹å’Œå¼•ç”¨è®¡æ•°å†…å­˜ç®¡ç†&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ¨¡å‹ï¼šReactor æ¨¡å¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸»ä»å¤šçº¿ç¨‹æ¨¡å‹ï¼ˆæ¨èï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;BossGroup&lt;/strong&gt;ï¼šè´Ÿè´£æ¥æ”¶è¿æ¥ï¼ˆ&lt;code&gt;accept&lt;/code&gt; äº‹ä»¶ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;WorkerGroup&lt;/strong&gt;ï¼šå¤„ç†è¿æ¥çš„è¯»å†™äº‹ä»¶ï¼ˆ&lt;code&gt;read/write&lt;/code&gt;ï¼‰åŠä¸šåŠ¡é€»è¾‘&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šèŒè´£åˆ†ç¦»ï¼Œé¿å…å•ç‚¹ç“¶é¢ˆï¼Œæ”¯æŒæ°´å¹³æ‰©å±•&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥å®¹é”™&lt;/strong&gt;ï¼šè‡ªåŠ¨é‡è¿ã€æ•…éšœèŠ‚ç‚¹å‰”é™¤ï¼ˆé›†ç¾¤æ¨¡å¼ä¸‹ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SSL/TLS æ”¯æŒ&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;SslHandler&lt;/code&gt; å®ç°åŠ å¯†é€šä¿¡ï¼Œä¿éšœæ•°æ®å®‰å…¨&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯-1"&gt;ğŸŒ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å³æ—¶é€šè®¯ï¼ˆIMï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒç™¾ä¸‡çº§é•¿è¿æ¥ï¼ˆå¦‚å¾®ä¿¡åç«¯åŸºäº Netty å®ç°ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šèŠå¤©å®¤æ¶ˆæ¯å¹¿æ’­ï¼ˆé€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;ChannelGroup
&lt;/code&gt;&lt;/pre&gt;ç®¡ç†è¿æ¥ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public class ChatHandler extends SimpleChannelInboundHandler&amp;lt;String&amp;gt; {
private static ChannelGroup group = new DefaultChannelGroup(GlobalEventExecutor.INSTANCE);
@Override
public void channelActive(ChannelHandlerContext ctx) {
group.add(ctx.channel()); // æ–°è¿æ¥åŠ å…¥ç¾¤ç»„
}
@Override
protected void channelRead0(ChannelHandlerContext ctx, String msg) {
group.writeAndFlush(&amp;#34;[Client] &amp;#34; + msg); // å¹¿æ’­æ¶ˆæ¯
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼ç³»ç»Ÿé€šä¿¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½œä¸º Dubboã€RocketMQ ç­‰æ¡†æ¶çš„åº•å±‚é€šä¿¡å±‚&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é«˜æ€§èƒ½ RPC è°ƒç”¨ï¼šé€šè¿‡è‡ªå®šä¹‰åè®®å®ç°æœåŠ¡è°ƒç”¨ä¸åºåˆ—åŒ–&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶æ•°æ®æµå¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¸¸æˆæœåŠ¡å™¨ï¼ˆä½å»¶è¿Ÿå¸§åŒæ­¥ï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é‡‘èäº¤æ˜“ç³»ç»Ÿï¼ˆå¾®ç§’çº§å“åº”ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘å…³ä¸ä»£ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;API ç½‘å…³ï¼ˆå¦‚ Spring Cloud Gateway åŸºäº Nettyï¼‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åå‘ä»£ç†è´Ÿè½½å‡è¡¡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®æˆ˜ç¤ºä¾‹ç®€æ˜“-http-æœåŠ¡å™¨"&gt;ğŸ’» &lt;strong&gt;å®æˆ˜ç¤ºä¾‹ï¼šç®€æ˜“ HTTP æœåŠ¡å™¨&lt;/strong&gt;
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HttpServer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EventLoopGroup&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bossGroup&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NioEventLoopGroup&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ¥æ”¶è¿æ¥&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EventLoopGroup&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;workerGroup&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NioEventLoopGroup&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å¤„ç† I/O&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ServerBootstrap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bootstrap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ServerBootstrap&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bootstrap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bossGroup&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;workerGroup&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NioServerSocketChannel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;childHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ChannelInitializer&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;SocketChannel&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;protected&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;initChannel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SocketChannel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;pipeline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addLast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HttpServerCodec&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// HTTP ç¼–è§£ç &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addLast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SimpleChannelInboundHandler&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;HttpObject&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;protected&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;channelRead0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ChannelHandlerContext&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HttpObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;instanceof&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FullHttpRequest&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FullHttpResponse&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DefaultFullHttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HttpVersion&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;HTTP_1_1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HttpResponseStatus&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;OK&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Unpooled&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;copiedBuffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Hello Netty!&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CharsetUtil&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;UTF_8&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;writeAndFlush&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ChannelFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bootstrap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;8080&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="na"&gt;sync&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;closeFuture&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;sync&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bossGroup&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;shutdownGracefully&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;workerGroup&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;shutdownGracefully&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šè®¿é—® &lt;code&gt;http://localhost:8080&lt;/code&gt; è¿”å› &amp;ldquo;Hello Netty!&amp;quot;&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŠæ—¶é‡Šæ”¾ &lt;code&gt;ByteBuf&lt;/code&gt; é˜²æ­¢å†…å­˜æ³„æ¼ï¼ˆé€šè¿‡ &lt;code&gt;ReferenceCountUtil.release()&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åˆç†é…ç½®çº¿ç¨‹æ•°ï¼š&lt;code&gt;WorkerGroup&lt;/code&gt; çº¿ç¨‹æ•°å»ºè®®ä¸º CPU æ ¸æ•°Ã—2&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é‡å†™ &lt;code&gt;exceptionCaught()&lt;/code&gt; æ–¹æ³•æ•è·é“¾è·¯å¼‚å¸¸&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;ChannelFuture.addListener()&lt;/code&gt; ç›‘å¬å¼‚æ­¥æ“ä½œç»“æœ&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è°ƒä¼˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¼€å¯ TCP å‚æ•°ä¼˜åŒ–ï¼ˆå¦‚ &lt;code&gt;SO_BACKLOG&lt;/code&gt; è®¾ç½®è¿æ¥é˜Ÿåˆ—å¤§å°ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…åœ¨ &lt;code&gt;ChannelHandler&lt;/code&gt; ä¸­æ‰§è¡Œé˜»å¡æ“ä½œï¼ˆæ”¹ç”¨ä¸šåŠ¡çº¿ç¨‹æ± ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Netty å‡­å€Ÿ&lt;strong&gt;å¼‚æ­¥äº‹ä»¶é©±åŠ¨æ¶æ„&lt;/strong&gt;ã€&lt;strong&gt;é›¶æ‹·è´ä¸å†…å­˜æ± ä¼˜åŒ–&lt;/strong&gt;ã€&lt;strong&gt;çµæ´»çš„çº¿ç¨‹æ¨¡å‹&lt;/strong&gt;ï¼Œæˆä¸ºé«˜å¹¶å‘ç½‘ç»œåº”ç”¨çš„å·¥ä¸šçº§æ ‡å‡†æ¡†æ¶ï¼Œå°¤å…¶é€‚ç”¨äºï¼š
âœ… éœ€è¦ç™¾ä¸‡çº§é•¿è¿æ¥çš„ IM ç³»ç»Ÿ
âœ… ä½å»¶è¿Ÿå®æ—¶äº¤äº’åœºæ™¯ï¼ˆæ¸¸æˆã€é‡‘èï¼‰
âœ… åˆ†å¸ƒå¼ä¸­é—´ä»¶åº•å±‚é€šä¿¡&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å­¦ä¹ å»ºè®®&lt;/strong&gt;ï¼šä» NIO åŸºç¡€ç†è§£å¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œå†é€šè¿‡ &lt;a class="link" href="https://netty.io/" target="_blank" rel="noopener"
&gt;Netty å®˜æ–¹ç¤ºä¾‹&lt;/a&gt; å®è·µ &lt;code&gt;ChannelHandler&lt;/code&gt; ä¸ &lt;code&gt;Pipeline&lt;/code&gt;è®¾è®¡&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨ &lt;strong&gt;ä¸»ä»å¤šçº¿ç¨‹æ¨¡å‹&lt;/strong&gt; å¹¶é…ç½® SSL/TLS åŠ å¯†ï¼Œä»¥å…¼é¡¾æ€§èƒ½ä¸å®‰å…¨&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="redisson"&gt;Redisson
&lt;/h2&gt;&lt;p&gt;Redisson æ˜¯ä¸€ä¸ªåŸºäº Redis çš„é«˜æ€§èƒ½ Java å®¢æˆ·ç«¯ï¼Œä¸“æ³¨äºåˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘ã€‚å®ƒä¸ä»…å°è£…äº† Redis çš„åŸºç¡€æ“ä½œï¼Œè¿˜æä¾›äº†ä¸°å¯Œçš„åˆ†å¸ƒå¼æ•°æ®ç»“æ„å’Œå¹¶å‘å·¥å…·ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿä»¥ç±»ä¼¼æœ¬åœ°æ“ä½œçš„æ–¹å¼å¤„ç†åˆ†å¸ƒå¼èµ„æºã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒç‰¹æ€§å’Œå·¥ä½œæœºåˆ¶çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸ç‰¹æ€§"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½ä¸ç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼é”ï¼ˆRLockï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨ç»­æœŸï¼ˆçœ‹é—¨ç‹—æœºåˆ¶ï¼‰&lt;/strong&gt;ï¼šé»˜è®¤åŠ é” 30 ç§’ï¼Œè‹¥ä¸šåŠ¡æœªæ‰§è¡Œå®Œï¼Œåå°çº¿ç¨‹æ¯ 10 ç§’è‡ªåŠ¨ç»­æœŸï¼Œé¿å…é”è¿‡æœŸå¤±æ•ˆ&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”ç±»å‹ä¸°å¯Œ&lt;/strong&gt;ï¼šæ”¯æŒå¯é‡å…¥é”ã€å…¬å¹³é”ã€è”é”ï¼ˆMultiLockï¼‰åŠçº¢é”ï¼ˆRedLockï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ä»£ç ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;RLock lock = redisson.getLock(&amp;#34;orderLock&amp;#34;);
lock.lock(30, TimeUnit.SECONDS); // è‡ªåŠ¨ç»­æœŸ
try { /* ä¸šåŠ¡é€»è¾‘ */ } finally { lock.unlock(); }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼é›†åˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RMap&lt;/strong&gt;ï¼šæ”¯æŒæœ¬åœ°ç¼“å­˜ï¼ˆå‡å°‘ç½‘ç»œå¼€é”€ï¼‰ã€åŸå­æ“ä½œï¼ˆå¦‚ &lt;code&gt;putIfAbsent&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RDelayedQueue&lt;/strong&gt;ï¼šå®ç°å»¶æ—¶ä»»åŠ¡ï¼Œå¦‚è®¢å•è¶…æ—¶å¤„ç†ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;RBlockingQueue&amp;lt;String&amp;gt; queue = redisson.getBlockingQueue(&amp;#34;orderQueue&amp;#34;);
RDelayedQueue&amp;lt;String&amp;gt; delayedQueue = redisson.getDelayedQueue(queue);
delayedQueue.offer(&amp;#34;order123&amp;#34;, 30, TimeUnit.MINUTES); // 30åˆ†é’Ÿåå…¥é˜Ÿ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RList/RSet&lt;/strong&gt;ï¼šæ”¯æŒåˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„é›†åˆæ“ä½œï¼ˆäº¤å¹¶å·®é›†ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™æµä¸åŒæ­¥å·¥å…·&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RRateLimiter&lt;/strong&gt;ï¼šåŸºäºä»¤ç‰Œæ¡¶ç®—æ³•æ§åˆ¶è¯·æ±‚é€Ÿç‡
&lt;pre tabindex="0"&gt;&lt;code&gt;RRateLimiter limiter = redisson.getRateLimiter(&amp;#34;apiLimiter&amp;#34;);
limiter.trySetRate(RateType.OVERALL, 5, 1, TimeUnit.SECONDS); // æ¯ç§’5ä¸ªä»¤ç‰Œ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RCountDownLatch&lt;/strong&gt;ï¼šåˆ†å¸ƒå¼é—­é”ï¼Œç”¨äºå¤šèŠ‚ç‚¹ä»»åŠ¡ååŒï¼ˆå¦‚ç­‰å¾…æ‰€æœ‰æœåŠ¡å°±ç»ªï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RSemaphore&lt;/strong&gt;ï¼šæ§åˆ¶å¹¶å‘èµ„æºè®¿é—®æ•°é‡&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼å¯¹è±¡ä¸ç¼“å­˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RBucket&lt;/strong&gt;ï¼šå­˜å‚¨ä»»æ„ Java å¯¹è±¡ï¼Œæ”¯æŒ TTL å’ŒåŸå­æ“ä½œï¼ˆå¦‚ CASï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RMapCache&lt;/strong&gt;ï¼šæ”¯æŒæ¡ç›®çº§è¿‡æœŸæ—¶é—´çš„ç¼“å­˜&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¶æ„è®¾è®¡ä¸æ ¸å¿ƒæœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;æ¶æ„è®¾è®¡ä¸æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åº•å±‚é€šä¿¡æ¨¡å‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºäº Netty&lt;/strong&gt;ï¼šå¼‚æ­¥éé˜»å¡ I/Oï¼Œé€šè¿‡è¿æ¥æ± ç®¡ç†èµ„æºï¼Œæ”¯æŒé«˜å¹¶å‘&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åè®®å…¼å®¹&lt;/strong&gt;ï¼šæ”¯æŒ Redis 3.0 è‡³ 7.2 åŠ Valkey 7.2.5+&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨æ”¯æŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šéƒ¨ç½²æ¨¡å¼&lt;/strong&gt;ï¼šå•èŠ‚ç‚¹ã€ä¸»ä»ã€å“¨å…µã€é›†ç¾¤æ¨¡å¼ï¼Œè‡ªåŠ¨å¤„ç†æ•…éšœè½¬ç§»å’Œè´Ÿè½½å‡è¡¡&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿ƒè·³æ£€æµ‹ä¸é‡è¿&lt;/strong&gt;ï¼šå†…ç½®æ–­è·¯å™¨æ¨¡å¼ï¼ŒèŠ‚ç‚¹æ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§ä¿éšœ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Lua è„šæœ¬åŸå­æ“ä½œ&lt;/strong&gt;ï¼šæ‰€æœ‰åˆ†å¸ƒå¼æ“ä½œï¼ˆå¦‚é”è·å–ã€è®¡æ•°å™¨æ›´æ–°ï¼‰é€šè¿‡ Lua è„šæœ¬ç¡®ä¿åŸå­æ€§&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥å¤‡ä»½&lt;/strong&gt;ï¼šå†™æ“ä½œåŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼Œä½†ä¸»ä»å¤åˆ¶ä¸ºå¼‚æ­¥ï¼ˆéœ€æ³¨æ„è„‘è£‚é£é™©ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯"&gt;ğŸ’» &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Redisson æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;RLock + RDelayedQueue&lt;/td&gt;
&lt;td&gt;ç¡®ä¿ä»»åŠ¡å”¯ä¸€æ‰§è¡Œï¼Œæ”¯æŒå»¶æ—¶è§¦å‘&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¹¶å‘é™æµ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;RRateLimiter&lt;/td&gt;
&lt;td&gt;ç²¾å‡†æ§åˆ¶ API/æœåŠ¡è¯·æ±‚é€Ÿç‡&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…±äº«ä¼šè¯/ç¼“å­˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;RMapCache&lt;/td&gt;
&lt;td&gt;è·¨æœåŠ¡å…±äº«æ•°æ®ï¼Œæ¡ç›®çº§è¿‡æœŸç®¡ç†&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼è®¡ç®—ååŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;RCountDownLatch&lt;/td&gt;
&lt;td&gt;å¤šèŠ‚ç‚¹ä»»åŠ¡åŒæ­¥ï¼ˆå¦‚æ‰¹é‡å¤„ç†ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸å±€é™æ€§"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸å±€é™æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯ç»´æŠ¤å¤§é‡è¿æ¥å’Œç¼“å­˜ï¼Œå¯èƒ½æ¶ˆè€—è¾ƒé«˜å†…å­˜&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥å¤åˆ¶é£é™©&lt;/strong&gt;ï¼šä¸»ä»åˆ‡æ¢æ—¶å¯èƒ½ä¸¢å¤±æœªåŒæ­¥æ•°æ®ï¼ˆéœ€é…ç½® &lt;code&gt;min-slaves-to-write&lt;/code&gt; é™ä½é£é™©ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½è¾¹ç•Œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚æ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt;ï¼šè™½æä¾› RQueueï¼Œä½†æŒä¹…åŒ–å’Œé¡ºåºæ€§ä¸å¦‚ Kafka/RabbitMQï¼Œä»…é€‚åˆè½»é‡çº§åœºæ™¯&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”çš„äº‰è®®&lt;/strong&gt;ï¼šçº¢é”ï¼ˆRedLockï¼‰å› æ—¶é’Ÿæ¼‚ç§»å’Œ GC åœé¡¿é—®é¢˜ï¼Œç”Ÿäº§ç¯å¢ƒæ…ç”¨&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥æ± è°ƒå‚&lt;/strong&gt;ï¼šæ ¹æ®å¹¶å‘é‡è°ƒæ•´ &lt;code&gt;connectionPoolSize&lt;/code&gt;ï¼ˆé»˜è®¤ 64ï¼‰å’Œ &lt;code&gt;idleConnectionTimeout&lt;/code&gt;ï¼ˆé»˜è®¤ 10 ç§’ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åºåˆ—åŒ–ä¼˜åŒ–&lt;/strong&gt;ï¼šä½¿ç”¨ Kryo æˆ– Avro ç¼–è§£ç å™¨æå‡åºåˆ—åŒ–æ•ˆç‡&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-spring-boot-é›†æˆç¤ºä¾‹"&gt;ğŸ› ï¸ &lt;strong&gt;Spring Boot é›†æˆç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;yml&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nl"&gt;redisson&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;singleServerConfig&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;redis://localhost:6379&amp;#34;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connectionPoolSize&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;32&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;idleConnectionTimeout&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;threads&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;8&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å¤„ç†æ ¸æ•°&lt;/span&gt;&lt;span class="err"&gt;Ã—&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;7&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@ref&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedissonClient&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;redisson&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Config&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Config&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;useSingleServer&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;setAddress&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;redis://localhost:6379&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Redisson&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redisson é€šè¿‡ &lt;strong&gt;é«˜å±‚ API å°è£…&lt;/strong&gt; å°†åˆ†å¸ƒå¼å¤æ‚æ€§ç®€åŒ–ä¸ºæœ¬åœ°åŒ–æ“ä½œï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š
âœ… â€‹&lt;strong&gt;å¼€å‘æ•ˆç‡æå‡&lt;/strong&gt;â€‹ï¼šé¿å…æ‰‹åŠ¨å®ç°é”ç»­æœŸã€æ•°æ®åˆ†ç‰‡ç­‰åº•å±‚é€»è¾‘ã€‚
âœ… â€‹&lt;strong&gt;å¼¹æ€§æ¶æ„&lt;/strong&gt;â€‹ï¼šé€‚é…ä»å•æœºåˆ°äº‘åŸç”Ÿå¤šç§ç¯å¢ƒï¼Œé€šè¿‡ Netty å’Œè¿æ¥æ± ä¿éšœæ€§èƒ½ã€‚
â›” â€‹&lt;strong&gt;ä½¿ç”¨å»ºè®®&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼é”é¦–é€‰ &lt;code&gt;RLock&lt;/code&gt;ï¼ˆè€Œé RedLockï¼‰ï¼Œç»“åˆçœ‹é—¨ç‹—æœºåˆ¶é¿å…æ­»é”ã€‚&lt;/li&gt;
&lt;li&gt;é«˜è¦æ±‚æ¶ˆæ¯åœºæ™¯ç”¨ä¸“ä¸š MQ æ›¿ä»£ &lt;code&gt;RQueue&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç”Ÿäº§ç¯å¢ƒé…ç½®å“¨å…µ/é›†ç¾¤æ¨¡å¼ï¼Œå¹¶é€šè¿‡ &lt;code&gt;WAIT&lt;/code&gt; å‘½ä»¤å¢å¼ºæ•°æ®ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½œä¸º Redis ç”Ÿæ€çš„â€œç‘å£«å†›åˆ€â€ï¼ŒRedisson åœ¨åˆ†å¸ƒå¼é”ã€å®æ—¶è®¡ç®—ã€ç¼“å­˜ç®¡ç†ä¸­æ˜¾è‘—é™ä½å¼€å‘æˆæœ¬ï¼Œä½†å…¶èµ„æºæ¶ˆè€—å’Œå¼‚æ­¥é£é™©éœ€åœ¨æ¶æ„è®¾è®¡æ—¶å……åˆ†æƒè¡¡&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="watch-dog"&gt;watch dog
&lt;/h2&gt;&lt;p&gt;Redisson çš„ &lt;strong&gt;Watch Dogï¼ˆçœ‹é—¨ç‹—ï¼‰æœºåˆ¶&lt;/strong&gt; æ˜¯åˆ†å¸ƒå¼é”çš„æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºè‡ªåŠ¨ç»­æœŸé”çš„è¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢ä¸šåŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡é”æŒæœ‰æ—¶é—´å¯¼è‡´çš„å¹¶å‘é—®é¢˜ã€‚ä»¥ä¸‹ä»åŸç†ã€å·¥ä½œæµç¨‹ã€é…ç½®åŠæœ€ä½³å®è·µå±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä½œç”¨"&gt;ğŸ”’ &lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é—®é¢˜èƒŒæ™¯
&lt;ul&gt;
&lt;li&gt;å½“çº¿ç¨‹è·å–é”åï¼Œè‹¥ä¸šåŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡é”çš„è¿‡æœŸæ—¶é—´ï¼ˆå¦‚é»˜è®¤30ç§’ï¼‰ï¼Œé”å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è·å–ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´æˆ–å¹¶å‘å†²çª&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆ
&lt;ul&gt;
&lt;li&gt;Watch Dog é€šè¿‡&lt;strong&gt;åå°å®šæ—¶ä»»åŠ¡&lt;/strong&gt;å®šæœŸæ£€æŸ¥é”çŠ¶æ€ï¼Œå¹¶è‡ªåŠ¨å»¶é•¿é”çš„è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤ç»­æœŸè‡³30ç§’ï¼‰ï¼Œç¡®ä¿ä¸šåŠ¡å®Œæˆå‰é”æŒç»­æœ‰æ•ˆ&lt;a class="link" href="@ref" &gt;1,4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹-1"&gt;âš™ï¸ &lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å¯åŠ¨æ¡ä»¶"&gt;&lt;strong&gt;å¯åŠ¨æ¡ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨å¯åŠ¨&lt;/strong&gt;ï¼šå½“ä½¿ç”¨ &lt;code&gt;lock()&lt;/code&gt; æˆ– &lt;code&gt;tryLock()&lt;/code&gt; &lt;strong&gt;ä¸æŒ‡å®š &lt;code&gt;leaseTime&lt;/code&gt;&lt;/strong&gt; æ—¶ï¼ˆå¦‚ &lt;code&gt;lock.lock()&lt;/code&gt;ï¼‰ï¼ŒRedisson é»˜è®¤å¯ç”¨ Watch Dog&lt;a class="link" href="@ref" &gt;1,4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰‹åŠ¨å…³é—­&lt;/strong&gt;ï¼šè‹¥æŒ‡å®š &lt;code&gt;leaseTime&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;lock.lock(10, TimeUnit.SECONDS)&lt;/code&gt;ï¼‰ï¼Œåˆ™ç¦ç”¨ Watch Dogï¼Œé”åˆ°æœŸè‡ªåŠ¨é‡Šæ”¾&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç»­æœŸé€»è¾‘"&gt;&lt;strong&gt;ç»­æœŸé€»è¾‘&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šæ—¶ä»»åŠ¡&lt;/strong&gt;ï¼šé”è·å–æˆåŠŸåï¼Œå¯åŠ¨åå°ä»»åŠ¡ï¼ˆåŸºäº Netty çš„ &lt;code&gt;HashedWheelTimer&lt;/code&gt;ï¼‰ï¼Œé»˜è®¤&lt;strong&gt;æ¯10ç§’&lt;/strong&gt;æ£€æŸ¥ä¸€æ¬¡é”çŠ¶æ€&lt;a class="link" href="@ref" &gt;1,4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç»­æœŸæ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥é”ä»è¢«å½“å‰çº¿ç¨‹æŒæœ‰ï¼Œåˆ™æ‰§è¡Œ Lua è„šæœ¬é‡ç½®è¿‡æœŸæ—¶é—´ä¸º &lt;strong&gt;30ç§’&lt;/strong&gt;ï¼ˆé»˜è®¤å€¼ï¼‰&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;if redis.call(&amp;#39;hexists&amp;#39;, KEYS[1], ARGV[2]) == 1 then
redis.call(&amp;#39;pexpire&amp;#39;, KEYS[1], ARGV[1]); -- ARGV[1]=30ç§’
return 1;
end;
return 0;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€’å½’ç»­æœŸ&lt;/strong&gt;ï¼šç»­æœŸæˆåŠŸåï¼Œä»»åŠ¡é€’å½’è°ƒç”¨è‡ªèº«ï¼Œå½¢æˆæŒç»­ä¿æ´»&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åœæ­¢æœºåˆ¶"&gt;&lt;strong&gt;åœæ­¢æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­£å¸¸é‡Šæ”¾&lt;/strong&gt;ï¼šè°ƒç”¨ &lt;code&gt;unlock()&lt;/code&gt; æ—¶ï¼Œæ¸…ç†ç»­æœŸä»»åŠ¡å¹¶é‡Šæ”¾é”&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸ç»ˆæ­¢&lt;/strong&gt;ï¼šè‹¥å®¢æˆ·ç«¯å®•æœºæˆ–ç½‘ç»œæ–­å¼€ï¼ŒWatch Dog åœæ­¢ç»­æœŸï¼Œé”åœ¨&lt;strong&gt;30ç§’åè‡ªåŠ¨é‡Šæ”¾&lt;/strong&gt;ï¼Œé¿å…æ­»é”&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é…ç½®å‚æ•°"&gt;âš¡ï¸ &lt;strong&gt;å…³é”®é…ç½®å‚æ•°&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é»˜è®¤å€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;lockWatchdogTimeout&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;30,000 ms&lt;/td&gt;
&lt;td&gt;é”çš„é»˜è®¤è¿‡æœŸæ—¶é—´ï¼ˆæœªæŒ‡å®š &lt;code&gt;leaseTime&lt;/code&gt; æ—¶ç”Ÿæ•ˆï¼‰&lt;a class="link" href="@ref" &gt;1,4,8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»­æœŸé—´éš”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;10,000 ms&lt;/td&gt;
&lt;td&gt;å®šæ—¶ä»»åŠ¡æ£€æŸ¥é—´éš”ï¼ˆ&lt;code&gt;lockWatchdogTimeout / 3&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;leaseTime&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;-1&lt;/td&gt;
&lt;td&gt;è‹¥æ‰‹åŠ¨æŒ‡å®šï¼ˆå¦‚ &lt;code&gt;lock(10, SECONDS)&lt;/code&gt;ï¼‰ï¼Œåˆ™ç¦ç”¨ Watch Dog&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ å¯é€šè¿‡ &lt;code&gt;Config.lockWatchdogTimeout&lt;/code&gt; è°ƒæ•´é»˜è®¤è¶…æ—¶æ—¶é—´&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯-1"&gt;ğŸ§© &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ˜¯å¦æ¨è Watch Dog&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸šåŠ¡æ—¶é—´ä¸ç¡®å®š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ¨è&lt;/td&gt;
&lt;td&gt;å¦‚ç½‘ç»œè¯·æ±‚ã€å¤æ‚è®¡ç®—ï¼Œéœ€åŠ¨æ€ç»­æœŸé˜²æ­¢é”è¶…æ—¶&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éœ€é˜² GC/ç½‘ç»œé˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ¨è&lt;/td&gt;
&lt;td&gt;é¿å…å› çº¿ç¨‹æš‚åœå¯¼è‡´é”æ„å¤–é‡Šæ”¾&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯é¢„ä¼°ä¸šåŠ¡æ—¶é—´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ¨è&lt;/td&gt;
&lt;td&gt;æ˜ç¡®é”æŒæœ‰æ—¶é—´æ—¶ï¼Œç›´æ¥æŒ‡å®š &lt;code&gt;leaseTime&lt;/code&gt; æ›´é«˜æ•ˆ&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸¥æ ¼è¦æ±‚é”æŒ‰æ—¶é‡Šæ”¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ¨è&lt;/td&gt;
&lt;td&gt;å¦‚å®šæ—¶ä»»åŠ¡éœ€ç²¾ç¡®æ§åˆ¶é”é‡Šæ”¾æ—¶æœº&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é”æ³„æ¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŠ¡å¿…åœ¨ &lt;code&gt;try-finally&lt;/code&gt; ä¸­è°ƒç”¨ &lt;code&gt;unlock()&lt;/code&gt;ï¼Œé˜²æ­¢å¼‚å¸¸å¯¼è‡´é”æœªé‡Šæ”¾&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æœªæ˜¾å¼é‡Šæ”¾ï¼ŒWatch Dog ä¼šæŒç»­ç»­æœŸï¼Œå¯¼è‡´é”é•¿æœŸå ç”¨&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çŸ­ä»»åŠ¡&lt;/strong&gt;ï¼šæŒ‡å®š &lt;code&gt;leaseTime&lt;/code&gt; ç¦ç”¨ Watch Dogï¼Œå‡å°‘ç»­æœŸå¼€é”€&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿ä»»åŠ¡&lt;/strong&gt;ï¼šè°ƒæ•´ &lt;code&gt;lockWatchdogTimeout&lt;/code&gt;ï¼ˆå¦‚60ç§’ï¼‰ï¼Œé™ä½ç»­æœŸé¢‘ç‡&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨ä¿éšœ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œæŠ–åŠ¨&lt;/strong&gt;ï¼šRedisson å†…ç½®é‡è¯•æœºåˆ¶ï¼ˆ&lt;code&gt;retryAttempts&lt;/code&gt;ï¼‰ï¼Œç»­æœŸå¤±è´¥è‡ªåŠ¨é‡è¯•&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤æ¨¡å¼&lt;/strong&gt;ï¼šWatch Dog å…¼å®¹ Redis é›†ç¾¤ï¼Œä¾èµ–é”®è¿‡æœŸæœºåˆ¶è€ŒéèŠ‚ç‚¹çŠ¶æ€&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§ä¸æ—¥å¿—&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è®°å½•é”è·å–/é‡Šæ”¾æ—¥å¿—ï¼Œä¾¿äºæ’æŸ¥ç»­æœŸå¤±è´¥æˆ–é”æ³„æ¼é—®é¢˜&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç›‘æ§ Redis è¿æ¥çŠ¶æ€ï¼Œç¡®ä¿ç»­æœŸå‘½ä»¤å¯è¾¾&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šWatch Dog é€šè¿‡ &lt;strong&gt;åå°çº¿ç¨‹ + Lua è„šæœ¬ç»­æœŸ&lt;/strong&gt;ï¼Œè§£å†³äº†åˆ†å¸ƒå¼é”åœ¨é•¿ä¸šåŠ¡åœºæ™¯ä¸‹çš„&lt;strong&gt;è‡ªåŠ¨ä¿æ´»é—®é¢˜&lt;/strong&gt;ï¼Œå…¼é¡¾å®‰å…¨æ€§ä¸å¯é æ€§&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡å“²å­¦&lt;/strong&gt;ï¼šä»¥&lt;strong&gt;ç©ºé—´æ¢ç¨³å®šæ€§&lt;/strong&gt;ï¼Œç”¨é¢å¤–çº¿ç¨‹ç›‘æ§é”çŠ¶æ€ï¼Œæ¢å–ä¸šåŠ¡é€»è¾‘çš„æ— ä¾µå…¥ç»­æœŸ&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼š
âœ… å¤šæ•°åœºæ™¯ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆä¸æŒ‡å®š &lt;code&gt;leaseTime&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚
âœ… ç»“åˆä¸šåŠ¡ä¼˜åŒ–é”ç²’åº¦ï¼ˆå¦‚ &lt;code&gt;lock:order:1001&lt;/code&gt; è€Œéå…¨å±€é”ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç±»æ¯”&lt;/strong&gt;ï¼šå¦‚åŒä¿é™©ä¸å®ˆæŠ¤ç”µè·¯ï¼ŒWatch Dog æ˜¯åˆ†å¸ƒå¼é”çš„â€œéšå½¢ä¿é•–â€ï¼Œåœ¨ä¸šåŠ¡èƒŒåé»˜é»˜ç»­å‘½ï¼Œç¡®ä¿é«˜å¹¶å‘ä¸‹æ•°æ®å¼ºä¸€è‡´&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="redisson-é”"&gt;Redisson é”
&lt;/h2&gt;&lt;p&gt;Redisson çš„åˆ†å¸ƒå¼é”æ˜¯å…¶æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œé€šè¿‡ç»“åˆ Redis çš„åŸå­æ“ä½œå’Œæ™ºèƒ½æœºåˆ¶ï¼Œè§£å†³äº†åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„èµ„æºäº’æ–¥è®¿é—®é—®é¢˜ã€‚ä»¥ä¸‹ä»è®¾è®¡ç†å¿µã€åº•å±‚æœºåˆ¶ã€é”ç±»å‹ã€ä½¿ç”¨åœºæ™¯åŠä¼˜åŒ–ç­–ç•¥å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡ç†å¿µä¸æ ¸å¿ƒç‰¹æ€§"&gt;ğŸ” &lt;strong&gt;è®¾è®¡ç†å¿µä¸æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;
æ»¡è¶³åˆ†å¸ƒå¼é”äº”å¤§åˆšéœ€ï¼šâ€‹&lt;strong&gt;ç‹¬å æ€§&lt;/strong&gt;â€‹ï¼ˆäº’æ–¥è®¿é—®ï¼‰ã€&lt;strong&gt;é«˜å¯ç”¨&lt;/strong&gt;â€‹ï¼ˆé›†ç¾¤å®¹é”™ï¼‰ã€&lt;strong&gt;é˜²æ­»é”&lt;/strong&gt;â€‹ï¼ˆè¶…æ—¶é‡Šæ”¾ï¼‰ã€&lt;strong&gt;ä¸ä¹±æŠ¢&lt;/strong&gt;â€‹ï¼ˆçº¿ç¨‹ç»‘å®šï¼‰ã€&lt;strong&gt;å¯é‡å…¥&lt;/strong&gt;â€‹ï¼ˆåŒä¸€çº¿ç¨‹å¤šæ¬¡åŠ é”ï¼‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…³é”®ç‰¹æ€§
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯é‡å…¥é”&lt;/strong&gt;ï¼šåŒä¸€çº¿ç¨‹å¯é‡å¤è·å–åŒä¸€æŠŠé”ï¼Œé€šè¿‡ Redis Hash ç»“æ„è®°å½•çº¿ç¨‹ ID å’Œé‡å…¥æ¬¡æ•°&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨ç»­æœŸï¼ˆWatchdogï¼‰&lt;/strong&gt;ï¼šé»˜è®¤æ¯ 10 ç§’å°†é”æœ‰æ•ˆæœŸç»­è‡³ 30 ç§’ï¼Œé¿å…ä¸šåŠ¡æœªå®Œæˆé”è¶…æ—¶é‡Šæ”¾&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”ç±»å‹å¤šæ ·&lt;/strong&gt;ï¼šæ”¯æŒå…¬å¹³é”ã€éå…¬å¹³é”ã€è”é”ï¼ˆMultiLockï¼‰ã€è¯»å†™é”ç­‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;åº•å±‚å®ç°æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸå­æ€§æ“ä½œlua-è„šæœ¬"&gt;&lt;strong&gt;åŸå­æ€§æ“ä½œï¼šLua è„šæœ¬&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ é”è„šæœ¬&lt;/strong&gt;ï¼šæ£€æŸ¥é”æ˜¯å¦å­˜åœ¨ â†’ ä¸å­˜åœ¨åˆ™åˆ›å»º Hash é”®ï¼ˆKey: é”å, Field: çº¿ç¨‹ID, Value: è®¡æ•°å™¨1ï¼‰ï¼›å­˜åœ¨åˆ™æ ¡éªŒçº¿ç¨‹IDå¹¶é‡å…¥ï¼ˆè®¡æ•°å™¨+1ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£é”è„šæœ¬&lt;/strong&gt;ï¼šæ ¡éªŒçº¿ç¨‹ID â†’ è®¡æ•°å™¨å‡1 â†’ è‹¥å½’é›¶åˆ™åˆ é™¤é”ï¼Œå¹¶å‘å¸ƒè§£é”æ¶ˆæ¯é€šçŸ¥ç­‰å¾…çº¿ç¨‹&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-- åŠ é”è„šæœ¬ç®€åŒ–ç‰ˆ
if redis.call(&amp;#39;exists&amp;#39;, KEYS[1]) == 0 then
redis.call(&amp;#39;hset&amp;#39;, KEYS[1], ARGV[1], 1) -- ARGV[1]=çº¿ç¨‹ID
redis.call(&amp;#39;pexpire&amp;#39;, KEYS[1], ARGV[2]) -- ARGV[2]=è¶…æ—¶æ—¶é—´
return 1
end
if redis.call(&amp;#39;hexists&amp;#39;, KEYS[1], ARGV[1]) == 1 then
redis.call(&amp;#39;hincrby&amp;#39;, KEYS[1], ARGV[1], 1) -- é‡å…¥è®¡æ•°
return 1
end
return 0
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="é”ç»­æœŸä¸æ•…éšœæ¢å¤"&gt;&lt;strong&gt;é”ç»­æœŸä¸æ•…éšœæ¢å¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Watchdog æœºåˆ¶&lt;/strong&gt;ï¼šåå°çº¿ç¨‹å®šæ—¶ç»­æœŸï¼ˆé»˜è®¤ &lt;code&gt;lockWatchdogTimeout=30s&lt;/code&gt;ï¼‰ï¼Œè‹¥å®¢æˆ·ç«¯å®•æœºï¼Œé”è¶…æ—¶è‡ªåŠ¨é‡Šæ”¾&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©æ§åˆ¶&lt;/strong&gt;ï¼šè‹¥æ˜¾å¼æŒ‡å®š &lt;code&gt;leaseTime&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;lock(10, SECONDS)&lt;/code&gt;ï¼‰ï¼Œåˆ™ç¦ç”¨ Watchdogï¼Œé”åˆ°æœŸå¼ºåˆ¶é‡Šæ”¾&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é”ç«äº‰ä¸é‡è¯•"&gt;&lt;strong&gt;é”ç«äº‰ä¸é‡è¯•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‘å¸ƒè®¢é˜…æ¨¡å‹&lt;/strong&gt;ï¼šå½“é”è¢«å ç”¨æ—¶ï¼Œå½“å‰çº¿ç¨‹è®¢é˜…è§£é”é¢‘é“ï¼Œé¿å…è½®è¯¢æ¶ˆè€—èµ„æºï¼›é”é‡Šæ”¾åé€šè¿‡æ¶ˆæ¯é€šçŸ¥å”¤é†’ç­‰å¾…çº¿ç¨‹&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡è¯•ç­–ç•¥&lt;/strong&gt;ï¼š&lt;code&gt;tryLock(waitTime, leaseTime, unit)&lt;/code&gt; æ”¯æŒè®¾ç½®æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œè¶…æ—¶è¿”å›å¤±è´¥&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é”ç±»å‹ä¸é€‚ç”¨åœºæ™¯"&gt;ğŸ§© &lt;strong&gt;é”ç±»å‹ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é”ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¬å¹³é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ Redis List è®°å½•è¯·æ±‚é¡ºåºï¼ŒZSet æ§åˆ¶è¶…æ—¶ï¼Œç¡®ä¿ FIFO è·å–é”&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;èµ„æºåˆ†é…æ•æ„Ÿï¼ˆå¦‚è®¢å•åˆ†æ‰¹å¤„ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éå…¬å¹³é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥ç«äº‰é”ï¼Œå…è®¸æ’é˜Ÿï¼ˆé»˜è®¤æ¨¡å¼ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘åœºæ™¯ï¼ˆå¦‚ç§’æ€åº“å­˜æ‰£å‡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è”é” (MultiLock)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€åŒæ—¶è·å–å¤šæŠŠé”ï¼ˆåŸå­æ€§ï¼‰ï¼Œå…¨éƒ¨æˆåŠŸæ‰ç®—åŠ é”æˆåŠŸ&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;å¤šèµ„æºäº‹åŠ¡ï¼ˆå¦‚è®¢å•+åº“å­˜è”åŠ¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»å†™é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»é”å…±äº«ï¼Œå†™é”ç‹¬å ï¼Œé€šè¿‡ä¸¤ä¸ª Hash ç»“æ„åˆ†ç¦»è¯»å†™çŠ¶æ€&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;è¯»å¤šå†™å°‘ï¼ˆå¦‚é…ç½®ä¸­å¿ƒçƒ­æ›´æ–°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¢é” (RedLock)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‘å¤šä¸ªç‹¬ç«‹ Redis èŠ‚ç‚¹åŠ é”ï¼Œå¤šæ•°æˆåŠŸæ‰ç®—è·å–ï¼ˆå®˜æ–¹å·²ä¸æ¨èï¼‰&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;éœ€è§„é¿ä¸»ä»åˆ‡æ¢é£é™©çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;çº¢é”äº‰è®®&lt;/strong&gt;ï¼šå› æ—¶é’Ÿæ¼‚ç§»å’Œç½‘ç»œåˆ†åŒºé£é™©ï¼Œçº¢é”å®‰å…¨æ€§å­˜ç–‘ï¼Œå»ºè®®æ”¹ç”¨ ZooKeeper/etcd å¼ºä¸€è‡´æ€§æ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é”çš„è·å–é‡Šæ”¾ä¸å®¹é”™"&gt;ğŸ”§ &lt;strong&gt;é”çš„è·å–ã€é‡Šæ”¾ä¸å®¹é”™&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ é”æµç¨‹&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;RLock lock = redisson.getLock(&amp;#34;orderLock&amp;#34;);
try {
// å°è¯•åŠ é”ï¼šç­‰å¾…10ç§’ï¼Œé”æŒæœ‰30ç§’
boolean acquired = lock.tryLock(10, 30, TimeUnit.SECONDS);
if (acquired) {
// æ‰§è¡Œä¸šåŠ¡é€»è¾‘
updateOrder();
}
} finally {
if (lock.isHeldByCurrentThread()) {
lock.unlock(); // ä»…é‡Šæ”¾å½“å‰çº¿ç¨‹æŒæœ‰çš„é”
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š&lt;code&gt;lock.isHeldByCurrentThread()&lt;/code&gt; é˜²æ­¢è¯¯é‡Šå…¶ä»–çº¿ç¨‹çš„é”&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡Šæ”¾ä¸å¼‚å¸¸å¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºåˆ¶é‡Šæ”¾&lt;/strong&gt;ï¼šè‹¥æœªä¸»åŠ¨è§£é”ï¼Œé”è¶…æ—¶åè‡ªåŠ¨åˆ é™¤ï¼ˆé»˜è®¤ 30 ç§’ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®•æœºæ¢å¤&lt;/strong&gt;ï¼šWatchdog åœæ­¢ç»­æœŸåï¼ŒRedis è‡ªåŠ¨æ¸…ç†è¿‡æœŸé”&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜çº§ç‰¹æ€§ä¸ä¼˜åŒ–å»ºè®®"&gt;ğŸš€ &lt;strong&gt;é«˜çº§ç‰¹æ€§ä¸ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é”ç»­æœŸæ‰‹åŠ¨æ§åˆ¶&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;lock.lock(10, TimeUnit.SECONDS); // ç¦ç”¨Watchdog
lock.expire(30, TimeUnit.SECONDS); // æ‰‹åŠ¨é‡ç½®è¶…æ—¶
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”ç²’åº¦ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ®µé”&lt;/strong&gt;ï¼šå°†çƒ­ç‚¹èµ„æºæ‹†åˆ†ä¸ºå¤šä¸ªå­é”ï¼ˆå¦‚ &lt;code&gt;product_lock_1001_segment1&lt;/code&gt;ï¼‰ï¼Œæå‡å¹¶å‘åº¦&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”åè®¾è®¡&lt;/strong&gt;ï¼šé¿å…åŠ¨æ€æ ‡è¯†ï¼ˆå¦‚æ—¶é—´æˆ³ï¼‰ï¼Œå›ºå®šä¸šåŠ¡é”®ï¼ˆå¦‚ &lt;code&gt;xxl:job:task&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¸å¯é æ€§æƒè¡¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜é¢‘åœºæ™¯&lt;/strong&gt;ï¼šä¼˜å…ˆç”¨ Redis+Lua åŸå­è„šæœ¬ï¼ˆæ— é”è®¾è®¡ï¼ŒQPS 5ä¸‡+ï¼‰ï¼Œå¦‚ç§’æ€åº“å­˜æ‰£å‡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚äº‹åŠ¡&lt;/strong&gt;ï¼šç”¨ Redisson é”ä¿éšœè·¨èµ„æºæ“ä½œçš„åŸå­æ€§ï¼Œä½†éœ€è¯„ä¼°æ•°æ®åº“ç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“é€‰å‹ä¸æœ€ä½³å®è·µ"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šé€‰å‹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€åœºæ™¯&lt;/strong&gt;ï¼šé»˜è®¤éå…¬å¹³é” + Watchdogï¼ˆä¸šåŠ¡æ—¶é—´ä¸å¯é¢„æµ‹æ—¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼ºä¸€è‡´æ€§éœ€æ±‚&lt;/strong&gt;ï¼šé¿å…çº¢é”ï¼Œæ”¹ç”¨ ZooKeeper/etcdã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;è¯»å¤šå†™å°‘ â†’ è¯»å†™é”ï¼›
&lt;ul&gt;
&lt;li&gt;è¶…é«˜å¹¶å‘ â†’ Redis Lua è„šæœ¬ï¼ˆæ— é”åŒ–ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å‘æŒ‡å—&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;é”åå›ºå®šåŒ–ã€é¿å…åµŒå¥—é”ç«äº‰ï¼›&lt;/li&gt;
&lt;li&gt;æ˜¾å¼æŒ‡å®š &lt;code&gt;leaseTime&lt;/code&gt; éœ€è°¨æ…ï¼ˆç¦ç”¨ Watchdogï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;ç»“åˆ &lt;code&gt;finally&lt;/code&gt; å—ç¡®ä¿é”é‡Šæ”¾&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ­£å¦‚ Martin Kleppmann æ‰€è¿°ï¼š&lt;strong&gt;â€œåˆ†å¸ƒå¼é”çš„æœ¬è´¨æ˜¯å…±è¯†é—®é¢˜ï¼Œéœ€ç»“åˆä¸šåŠ¡å®¹å¿åº¦è®¾è®¡â€&lt;/strong&gt;ã€‚Redisson é€šè¿‡ Lua åŸå­æ€§ã€Watchdog ç»­æœŸã€å¯é‡å…¥è®¾è®¡ï¼Œåœ¨å¤šæ•°åœºæ™¯ä¸‹å¹³è¡¡äº†æ€§èƒ½ä¸å®‰å…¨æ€§ï¼Œä½†éœ€è­¦æƒ•é›†ç¾¤æ¶æ„ä¸‹çš„ä¸»ä»åŒæ­¥é£é™©ï¼Œå¿…è¦æ—¶é‡‡ç”¨æ··åˆæ–¹æ¡ˆï¼ˆå¦‚ Lua + æ•°æ®åº“äº‹åŠ¡å…œåº•ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¯é‡å…¥é”"&gt;å¯é‡å…¥é”
&lt;/h2&gt;&lt;p&gt;å¯é‡å…¥é”ï¼ˆReentrant Lockï¼‰çš„æ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;å…è®¸åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å–åŒä¸€æŠŠé”&lt;/strong&gt;ï¼Œé¿å…å› åµŒå¥—æˆ–é€’å½’è°ƒç”¨å¯¼è‡´çš„æ­»é”ã€‚ä»¥ä¸‹é€šè¿‡å…·ä½“åœºæ™¯å’Œä»£ç ç¤ºä¾‹è¯´æ˜å…¶å…¸å‹åº”ç”¨ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-é€’å½’è°ƒç”¨åœºæ™¯"&gt;ğŸ”„ &lt;strong&gt;é€’å½’è°ƒç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šé€’å½’å‡½æ•°éœ€é‡å¤è®¿é—®åŒä¸€èµ„æºï¼Œè‹¥é”ä¸å¯é‡å…¥ï¼Œçº¿ç¨‹ä¼šåœ¨ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶é˜»å¡è‡ªèº«ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼šè®¡ç®—é˜¶ä¹˜æ—¶ï¼Œé€’å½’è°ƒç”¨éœ€åå¤åŠ é”ä¿æŠ¤å…±äº«å˜é‡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class Factorial {
private final ReentrantLock lock = new ReentrantLock();
private int result = 1;
public int compute(int n) {
lock.lock();
try {
if (n &amp;lt;= 1) return result;
result *= n;
return compute(n - 1); // é€’å½’è°ƒç”¨éœ€é‡å…¥é”
} finally {
lock.unlock();
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;ï¼šè‹¥é”ä¸å¯é‡å…¥ï¼Œ&lt;code&gt;compute(n-1)&lt;/code&gt;ä¼šå› çº¿ç¨‹å·²æŒé”è€Œé˜»å¡ï¼Œå¯¼è‡´æ­»é”ã€‚å¯é‡å…¥é”é€šè¿‡è®¡æ•°å™¨ï¼ˆ&lt;code&gt;state++&lt;/code&gt;ï¼‰æ”¯æŒå¤šæ¬¡åŠ é”&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åµŒå¥—æ–¹æ³•è°ƒç”¨åœºæ™¯"&gt;ğŸ”— &lt;strong&gt;åµŒå¥—æ–¹æ³•è°ƒç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šå¤–å±‚æ–¹æ³•æŒé”åè°ƒç”¨å†…å±‚æ–¹æ³•ï¼Œè‹¥å†…å±‚éœ€åŒä¸€é”ï¼Œä¸å¯é‡å…¥é”ä¼šæ­»é”ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼šè®¢å•åˆ›å»ºåè°ƒç”¨æ”¯ä»˜é€»è¾‘ï¼Œä¸¤è€…éœ€å…±äº«è®¢å•é”ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class OrderService {
private final ReentrantLock lock = new ReentrantLock();
public void createOrder() {
lock.lock();
try {
validateOrder(); // è°ƒç”¨éœ€é”çš„å†…å±‚æ–¹æ³•
processPayment(); // å†æ¬¡é‡å…¥é”
} finally {
lock.unlock();
}
}
private void processPayment() {
lock.lock(); // åŒä¸€çº¿ç¨‹å¯é‡å…¥
try { /* æ”¯ä»˜é€»è¾‘ */ }
finally { lock.unlock(); }
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;ï¼š&lt;code&gt;processPayment()&lt;/code&gt;å› ä¸&lt;code&gt;createOrder()&lt;/code&gt;åŒçº¿ç¨‹ï¼Œå¯é‡å…¥é”é¿å…æ­»é”&lt;a class="link" href="@ref" &gt;1,4,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†å¸ƒå¼ç³»ç»Ÿå›æ»šåœºæ™¯"&gt;ğŸŒ &lt;strong&gt;åˆ†å¸ƒå¼ç³»ç»Ÿå›æ»šåœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šè®¢å•åˆ›å»ºåå¼‚å¸¸éœ€å›æ»šï¼Œå›æ»šé€»è¾‘éœ€è·å–åŒä¸€è®¢å•é”ï¼ˆå¦‚Redisåˆ†å¸ƒå¼é”ï¼‰ã€‚
â€‹&lt;strong&gt;åœºæ™¯&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çº¿ç¨‹Aåˆ›å»ºè®¢å•ï¼Œè·å–é”&lt;code&gt;Lock:Order_1001&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åç»­é€»è¾‘å¼‚å¸¸ï¼Œè°ƒç”¨å›æ»šæ¥å£å–æ¶ˆè®¢å•ã€‚&lt;/li&gt;
&lt;li&gt;å›æ»šé€»è¾‘éœ€å†æ¬¡è·å–&lt;code&gt;Lock:Order_1001&lt;/code&gt;ï¼ˆåŒä¸€çº¿ç¨‹ï¼‰ã€‚
â€‹&lt;strong&gt;å®ç°&lt;/strong&gt;â€‹ï¼ˆRedissonç¤ºä¾‹ï¼‰ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;RLock lock = redissonClient.getLock(&amp;#34;Order_1001&amp;#34;);
lock.lock(); // åˆ›å»ºè®¢å•æ—¶åŠ é”
try {
createOrder();
} catch (Exception e) {
cancelOrder(); // å›æ»šä¸­å†æ¬¡è°ƒç”¨lock.lock()
} finally {
lock.unlock();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;ï¼šå¯é‡å…¥ç‰¹æ€§ç¡®ä¿çº¿ç¨‹Aåœ¨å›æ»šæ—¶èƒ½é‡å…¥é”ï¼Œé¿å…å› é”è¢«è‡ªèº«å ç”¨è€Œé˜»å¡&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-çˆ¶å­ç±»ç»§æ‰¿åœºæ™¯"&gt;ğŸ‘¨â€ğŸ‘¦ &lt;strong&gt;çˆ¶å­ç±»ç»§æ‰¿åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šå­ç±»æ–¹æ³•è¦†ç›–çˆ¶ç±»æ–¹æ³•æ—¶ï¼Œè‹¥ä¸¤è€…éœ€åŒä¸€é”ï¼Œä¸å¯é‡å…¥é”ä¼šæ­»é”ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Parent {
protected ReentrantLock lock = new ReentrantLock();
public void update() {
lock.lock();
try { /* çˆ¶ç±»é€»è¾‘ */ }
finally { lock.unlock(); }
}
}
class Child extends Parent {
@Override
public void update() {
lock.lock(); // å­ç±»é‡å…¥é”
try {
super.update(); // è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼ˆéœ€é”ï¼‰
/* å­ç±»æ‰©å±•é€»è¾‘ */
} finally {
lock.unlock();
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;ï¼šå­ç±»è°ƒç”¨&lt;code&gt;super.update()&lt;/code&gt;æ—¶ï¼Œå› ä¸å­ç±»æ–¹æ³•åŒçº¿ç¨‹ï¼Œå¯é‡å…¥é”å…è®¸çˆ¶ç±»æ–¹æ³•è·å–é”&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¯é‡å…¥é”-vs-ä¸å¯é‡å…¥é”åœºæ™¯å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;å¯é‡å…¥é” vs ä¸å¯é‡å…¥é”åœºæ™¯å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¯é‡å…¥é”&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¸å¯é‡å…¥é”&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€’å½’è°ƒç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒå¤šæ¬¡é‡å…¥ï¼Œæ— æ­»é” &lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;âŒ çº¿ç¨‹è‡ªé˜»å¡ï¼Œæ­»é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åµŒå¥—æ–¹æ³•è°ƒç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å†…å±‚æ–¹æ³•å¯é‡å…¥é” &lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;âŒ å†…å±‚æ–¹æ³•æ— æ³•è·å–é”ï¼Œæ­»é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼å›æ»š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… åŒä¸€çº¿ç¨‹é‡å…¥é”å¤„ç†å¼‚å¸¸ &lt;a class="link" href="@ref" &gt;2&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;âŒ å›æ»šé€»è¾‘é˜»å¡ï¼Œæ•°æ®ä¸ä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çˆ¶å­ç±»æ–¹æ³•ç»§æ‰¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å­ç±»è°ƒç”¨çˆ¶ç±»æ–¹æ³•å¯é‡å…¥ &lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;âŒ çˆ¶ç±»æ–¹æ³•æ— æ³•è·å–é”ï¼Œæ­»é”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å¯é‡å…¥é”çš„æ ¸å¿ƒåº”ç”¨åœºæ™¯å›´ç»•&lt;strong&gt;åŒä¸€çº¿ç¨‹å†…å¤šæ¬¡è®¿é—®é”èµ„æº&lt;/strong&gt;çš„éœ€æ±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€’å½’ç®—æ³•&lt;/strong&gt;ï¼šé¿å…é€’å½’æ·±åº¦ä¸é”æ·±åº¦å†²çª&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•åµŒå¥—è°ƒç”¨&lt;/strong&gt;ï¼šç¡®ä¿å¤–å±‚ä¸å†…å±‚æ–¹æ³•å…±äº«é”æ—¶ä¸æ­»é”&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†ä¸å›æ»š&lt;/strong&gt;ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿä¸­åŒä¸€çº¿ç¨‹éœ€é‡å…¥é”å¤„ç†å›æ»š&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘å¯¹è±¡è®¾è®¡&lt;/strong&gt;ï¼šæ”¯æŒçˆ¶å­ç±»æ–¹æ³•é”ç»§æ‰¿&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;ï¼šå§‹ç»ˆåœ¨&lt;code&gt;finally&lt;/code&gt;å—é‡Šæ”¾é”ï¼Œç¡®ä¿è®¡æ•°å™¨å½’é›¶ï¼›é¿å…é”åµŒå¥—å±‚çº§è¿‡æ·±å¯¼è‡´æ€§èƒ½ä¸‹é™&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚åœ¨å¤æ‚ä¸šåŠ¡ä¸­ï¼Œå¯é‡å…¥é”é€šè¿‡ç»´æŠ¤çº¿ç¨‹æ ‡è¯†å’Œè®¡æ•°å™¨ï¼ˆå¦‚&lt;code&gt;state&lt;/code&gt;å­—æ®µï¼‰ï¼Œä»¥ç¨é«˜çš„å®ç°å¤æ‚åº¦æ¢å–æ›´å¼ºçš„çµæ´»æ€§&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="éå…¬å¹³é”"&gt;éå…¬å¹³é”
&lt;/h2&gt;&lt;p&gt;éå…¬å¹³é”ï¼ˆNon-Fair Lockï¼‰æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­ä¸€ç§&lt;strong&gt;å…è®¸çº¿ç¨‹æ’é˜ŸæŠ¢å é”èµ„æº&lt;/strong&gt;çš„é”æœºåˆ¶ã€‚å…¶æ ¸å¿ƒç‰¹ç‚¹æ˜¯&lt;strong&gt;ä¸ä¿è¯çº¿ç¨‹è·å–é”çš„é¡ºåºä¸è¯·æ±‚é¡ºåºä¸€è‡´&lt;/strong&gt;ï¼Œæ–°è¯·æ±‚çš„çº¿ç¨‹å¯ç›´æ¥å°è¯•æŠ¢å é”ï¼Œè€ŒéæŒ‰ç­‰å¾…é˜Ÿåˆ—æ’é˜Ÿã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æŠ¢å å¼é”è·å–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“é”é‡Šæ”¾æ—¶ï¼Œ&lt;strong&gt;æ–°æ¥çš„çº¿ç¨‹å¯ç›´æ¥å°è¯•è·å–é”&lt;/strong&gt;ï¼Œæ— éœ€æ£€æŸ¥ç­‰å¾…é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹æ’é˜Ÿ&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æŠ¢å æˆåŠŸï¼Œåˆ™ç«‹å³æŒæœ‰é”ï¼›å¤±è´¥åˆ™åŠ å…¥ç­‰å¾…é˜Ÿåˆ—å°¾éƒ¨&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šçº¿ç¨‹Aé‡Šæ”¾é”æ—¶ï¼Œæ–°çº¿ç¨‹Bè‹¥ç›´æ¥æŠ¢å æˆåŠŸï¼Œåˆ™è·³è¿‡å·²åœ¨é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹Cã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é˜Ÿåˆ—æ£€æŸ¥ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;éå…¬å¹³é”åœ¨å°è¯•è·å–é”æ—¶&lt;strong&gt;è·³è¿‡é˜Ÿåˆ—æ£€æŸ¥&lt;/strong&gt;ï¼ˆå…¬å¹³é”éœ€è°ƒç”¨ &lt;code&gt;hasQueuedPredecessors()&lt;/code&gt; åˆ¤æ–­é˜Ÿåˆ—é¡ºåºï¼‰ï¼Œç›´æ¥é€šè¿‡ &lt;strong&gt;CASï¼ˆCompare-And-Swapï¼‰&lt;/strong&gt; æ“ä½œæŠ¢å é”&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šå‡å°‘çº¿ç¨‹çŠ¶æ€åˆ‡æ¢ï¼ˆè¿è¡Œæ€â†’é˜»å¡æ€ï¼‰çš„å¼€é”€ï¼Œæå‡ååé‡&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç‰¹ç‚¹ä¸æ€§èƒ½"&gt;ğŸ“Š &lt;strong&gt;ç‰¹ç‚¹ä¸æ€§èƒ½&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;éå…¬å¹³é”&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¬å¹³é”&lt;/strong&gt;ï¼ˆå¯¹æ¯”å‚è€ƒï¼‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”åˆ†é…é¡ºåº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éšæœºæ€§å¼ºï¼Œå…è®¸æ’é˜Ÿ&lt;/td&gt;
&lt;td&gt;ä¸¥æ ¼æŒ‰FIFOé˜Ÿåˆ—åˆ†é…&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå‡å°‘çº¿ç¨‹åˆ‡æ¢ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒä½ï¼ˆéœ€ç»´æŠ¤é˜Ÿåˆ—ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹é¥¥é¥¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½å‘ç”Ÿï¼ˆæŸäº›çº¿ç¨‹é•¿æœŸæŠ¢ä¸åˆ°é”ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸ä¼šå‘ç”Ÿ&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å»¶è¿Ÿç¨³å®šæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ³¢åŠ¨å¤§ï¼ˆæ’é˜Ÿå¯¼è‡´ä¸ç¡®å®šæ€§ï¼‰&lt;/td&gt;
&lt;td&gt;æ›´ç¨³å®š&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å®æµ‹&lt;/strong&gt;ï¼šåœ¨64çº¿ç¨‹é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œéå…¬å¹³é”çš„ååç‡å¯è¾¾å…¬å¹³é”çš„ &lt;strong&gt;10å€ä»¥ä¸Š&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ½œåœ¨é£é™©çº¿ç¨‹é¥¥é¥¿starvation"&gt;âš ï¸ &lt;strong&gt;æ½œåœ¨é£é™©ï¼šçº¿ç¨‹é¥¥é¥¿ï¼ˆStarvationï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;ï¼šæ–°çº¿ç¨‹é¢‘ç¹æ’é˜Ÿï¼Œå¯èƒ½å¯¼è‡´ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹&lt;strong&gt;é•¿æœŸæ— æ³•è·å–é”&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼šè‹¥æŸçº¿ç¨‹å› ä¼˜å…ˆçº§ä½æˆ–æ‰§è¡Œé€Ÿåº¦æ…¢ï¼Œå¯èƒ½åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹æŒç»­è¢«æ–°çº¿ç¨‹æŠ¢å é”èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-javaä¸­çš„å®ç°"&gt;ğŸ’» &lt;strong&gt;Javaä¸­çš„å®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ReentrantLock&lt;/code&gt; é»˜è®¤æ˜¯éå…¬å¹³é”&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ReentrantLock lock = new ReentrantLock(); // é»˜è®¤éå…¬å¹³é”
ReentrantLock fairLock = new ReentrantLock(true); // éœ€æ˜¾å¼æŒ‡å®šå…¬å¹³é”[4,6](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;synchronized&lt;/code&gt; å…³é”®å­—åº•å±‚ä¸ºéå…¬å¹³é”&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;JVMé€šè¿‡ &lt;strong&gt;ObjectMonitor&lt;/strong&gt; å®ç°ï¼Œä¸æ”¯æŒé…ç½®ä¸ºå…¬å¹³é”&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯-2"&gt;âš¡ &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘çŸ­æœŸä»»åŠ¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ç¼“å­˜ç³»ç»Ÿï¼ˆRedisï¼‰ã€çº¿ç¨‹æ± ä»»åŠ¡è°ƒåº¦ï¼Œé”æŒæœ‰æ—¶é—´çŸ­ï¼Œæ’é˜Ÿèƒ½æ˜¾è‘—æå‡å“åº”é€Ÿåº¦&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ååé‡ä¼˜å…ˆåœºæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®åº“è¿æ¥æ± ã€ç§’æ€ç³»ç»Ÿç­‰ï¼Œå…è®¸ç‰ºç‰²éƒ¨åˆ†å…¬å¹³æ€§ä»¥æ¢å–æ€§èƒ½&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ä½¿ç”¨çš„åœºæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;éœ€ä¸¥æ ¼æŒ‰åºæ‰§è¡Œçš„ç³»ç»Ÿï¼ˆå¦‚é‡‘èäº¤æ˜“ã€å®¡è®¡æ—¥å¿—ï¼‰ï¼Œæ­¤æ—¶å…¬å¹³é”æ›´åˆé€‚&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä»£ç ç¤ºä¾‹ä¸è¡Œä¸ºåˆ†æ"&gt;ğŸ”§ &lt;strong&gt;ä»£ç ç¤ºä¾‹ä¸è¡Œä¸ºåˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.concurrent.locks.ReentrantLock;
public class NonFairLockDemo {
public static void main(String[] args) {
ReentrantLock lock = new ReentrantLock(); // éå…¬å¹³é”
for (int i = 0; i &amp;lt; 5; i++) {
new Thread(() -&amp;gt; {
lock.lock();
try {
System.out.println(Thread.currentThread().getName() + &amp;#34; acquired lock&amp;#34;);
} finally {
lock.unlock();
}
}, &amp;#34;Thread-&amp;#34; + i).start();
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å…¸å‹è¾“å‡º&lt;/strong&gt;ï¼ˆæ— åºæ€§ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Thread-0 acquired lock
Thread-2 acquired lock // åå¯åŠ¨çš„Thread-2æ’é˜ŸæˆåŠŸ
Thread-1 acquired lock
Thread-4 acquired lock
Thread-3 acquired lock
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éå…¬å¹³é”çš„æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šé€šè¿‡&lt;strong&gt;å…è®¸æ’é˜ŸæŠ¢å &lt;/strong&gt;ï¼Œå¤§å¹…æå‡ç³»ç»Ÿååé‡ï¼Œå°¤å…¶é€‚åˆé«˜å¹¶å‘çŸ­æœŸä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ä»·&lt;/strong&gt;ï¼šå¯èƒ½å¼•å‘çº¿ç¨‹é¥¥é¥¿ï¼Œä¸”é”åˆ†é…é¡ºåºä¸å¯é¢„æµ‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š
âœ… ä¼˜å…ˆé€‰æ‹©éå…¬å¹³é”ï¼šé€‚ç”¨äº â€‹&lt;strong&gt;90%+ çš„é«˜å¹¶å‘åœºæ™¯&lt;/strong&gt;â€‹ï¼ˆJavaé»˜è®¤ç­–ç•¥çš„åˆç†æ€§ä½“ç°ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚
âŒ ä»…å½“ä¸šåŠ¡å¼ºéœ€æ±‚æ—¶ç”¨å…¬å¹³é”ï¼šå¦‚è®¢å•å¤„ç†ã€å®æ—¶å®¡è®¡ç­‰éœ€ä¸¥æ ¼é¡ºåºçš„åœºæ™¯&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ­£å¦‚å¹¶å‘ç¼–ç¨‹çš„é»„é‡‘å‡†åˆ™ï¼š&lt;strong&gt;â€œéå…¬å¹³é”ç”¨æ€§èƒ½æ¢å…¬å¹³ï¼Œè€Œå…¬å¹³é”ç”¨å…¬å¹³æ¢æ€§èƒ½â€&lt;/strong&gt;ã€‚ç†è§£å…¶æœºåˆ¶å·®å¼‚ï¼Œæ–¹èƒ½é’ˆå¯¹åœºæ™¯ç²¾å‡†é€‰å‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Distributedã€‘XXL-JOB</title><link>https://dyhes.github.io/p/distributedxxl-job/</link><pubDate>Wed, 02 Jul 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/distributedxxl-job/</guid><description>&lt;h2 id="xxljobspringexecutor"&gt;XxlJobSpringExecutor
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;XxlJobSpringExecutor&lt;/code&gt; æ˜¯ XXL-JOB æ‰§è¡Œå™¨çš„æ ¸å¿ƒå®ç°ç±»ï¼Œä¸“ä¸º Spring/Spring Boot ç¯å¢ƒè®¾è®¡ï¼Œè´Ÿè´£&lt;strong&gt;ä»»åŠ¡æ³¨å†Œã€æ‰§è¡Œå™¨å¯åŠ¨ã€èµ„æºç®¡ç†åŠç”Ÿå‘½å‘¨æœŸæ§åˆ¶&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯å…¶è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸è®¾è®¡"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½ä¸è®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç±»ç»§æ‰¿ä¸æ¥å£å®ç°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç»§æ‰¿ &lt;code&gt;XxlJobExecutor&lt;/code&gt;ï¼šå¤ç”¨åŸºç¡€æ‰§è¡Œå™¨é€»è¾‘ï¼ˆå¦‚ä»»åŠ¡è°ƒåº¦ã€å›è°ƒå¤„ç†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ç° Spring æ¥å£ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ApplicationContextAware&lt;/code&gt;&lt;/strong&gt;ï¼šè·å– Spring å®¹å™¨ä¸Šä¸‹æ–‡ï¼Œç”¨äºæ‰«æä»»åŠ¡æ³¨è§£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;SmartInitializingSingleton&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨æ‰€æœ‰å•ä¾‹ Bean åˆå§‹åŒ–å®Œæˆåè§¦å‘æ‰§è¡Œå™¨å¯åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;DisposableBean&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨ Bean é”€æ¯æ—¶å…³é—­èµ„æºï¼ˆå¦‚çº¿ç¨‹æ± ã€Netty æœåŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒèŒè´£&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰«æ &lt;code&gt;@XxlJob&lt;/code&gt; æ³¨è§£çš„æ–¹æ³•å¹¶æ³¨å†Œä¸ºä»»åŠ¡å¤„ç†å™¨ï¼ˆJobHandlerï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯åŠ¨æ‰§è¡Œå™¨å†…åµŒçš„ Netty HTTP æœåŠ¡ï¼ˆé»˜è®¤ç«¯å£ &lt;code&gt;9999&lt;/code&gt;ï¼‰ï¼Œæ¥æ”¶è°ƒåº¦ä¸­å¿ƒçš„è§¦å‘è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;ç®¡ç†æ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œã€ä»»åŠ¡å›è°ƒã€æ—¥å¿—æ¸…ç†ç­‰åå°çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¯åŠ¨æµç¨‹è¯¦è§£"&gt;âš™ï¸ &lt;strong&gt;å¯åŠ¨æµç¨‹è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åœ¨ &lt;code&gt;afterSingletonsInstantiated()&lt;/code&gt; æ–¹æ³•ä¸­å®Œæˆåˆå§‹åŒ–ï¼ˆè°ƒç”¨æ—¶æœºï¼šæ‰€æœ‰å•ä¾‹ Bean åˆå§‹åŒ–å®Œæˆåï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡æ³¨å†Œ&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;private void initJobHandlerMethodRepository(ApplicationContext context) {
// 1. æ‰«ææ‰€æœ‰Beanä¸­è¢«@XxlJobæ³¨è§£çš„æ–¹æ³•
Map&amp;lt;Method, XxlJob&amp;gt; annotatedMethods = MethodIntrospector.selectMethods(beanClass, method -&amp;gt;
AnnotatedElementUtils.findMergedAnnotation(method, XxlJob.class));
// 2. æ ¡éªŒæ–¹æ³•ç­¾åï¼ˆå‚æ•°éœ€ä¸ºStringï¼Œè¿”å›å€¼éœ€ä¸ºReturnTï¼‰
if (!(method.getParameterTypes().length == 1 &amp;amp;&amp;amp; method.getParameterTypes()[0].isAssignableFrom(String.class))) {
throw new RuntimeException(&amp;#34;æ–¹æ³•å‚æ•°ç±»å‹éæ³•&amp;#34;);
}
// 3. æ³¨å†ŒJobHandleråˆ°ä»“åº“
registJobHandler(name, new MethodJobHandler(bean, method, initMethod, destroyMethod));
}
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä»»åŠ¡åï¼ˆ&lt;code&gt;xxlJob.value()&lt;/code&gt;ï¼‰å¿…é¡»å”¯ä¸€ï¼Œå¦åˆ™å†²çªæŠ¥é”™ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒé…ç½® &lt;code&gt;init&lt;/code&gt; å’Œ &lt;code&gt;destroy&lt;/code&gt; æ–¹æ³•ï¼Œç”¨äºä»»åŠ¡åˆå§‹åŒ–å’Œèµ„æºæ¸…ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹åŒ– GlueFactory&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GlueFactory.refreshInstance(1); // 1 è¡¨ç¤ºä½¿ç”¨SpringGlueFactory
&lt;/code&gt;&lt;/pre&gt;ç”¨äºæ”¯æŒåŠ¨æ€è„šæœ¬ä»»åŠ¡ï¼ˆå¦‚ Groovyï¼‰çš„ä¾èµ–æ³¨å…¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯åŠ¨çˆ¶ç±»æ‰§è¡Œå™¨&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;super.start(); // è°ƒç”¨XxlJobExecutorçš„å¯åŠ¨é€»è¾‘
&lt;/code&gt;&lt;/pre&gt;å†…éƒ¨æµç¨‹åŒ…æ‹¬ï¼š
&lt;ul&gt;
&lt;li&gt;åˆå§‹åŒ–æ—¥å¿—è·¯å¾„ï¼ˆ&lt;code&gt;XxlJobFileAppender.initLogPath()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯åŠ¨å®ˆæŠ¤çº¿ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;JobLogFileCleanThread&lt;/code&gt;ï¼šæ¸…ç†è¿‡æœŸæ—¥å¿—ï¼ˆé»˜è®¤ä¿ç•™ 30 å¤©ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TriggerCallbackThread&lt;/code&gt;ï¼šå‘è°ƒåº¦ä¸­å¿ƒå›è°ƒä»»åŠ¡ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯åŠ¨ Netty æœåŠ¡ï¼ˆ&lt;code&gt;initEmbedServer()&lt;/code&gt;ï¼‰ï¼Œç›‘å¬è°ƒåº¦è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€šä¿¡æœºåˆ¶"&gt;ğŸŒ &lt;strong&gt;é€šä¿¡æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è°ƒåº¦è¯·æ±‚å¤„ç†æµç¨‹&lt;/strong&gt;
è°ƒåº¦ä¸­å¿ƒé€šè¿‡ HTTP è°ƒç”¨æ‰§è¡Œå™¨çš„ &lt;code&gt;/run&lt;/code&gt; æ¥å£ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[è°ƒåº¦ä¸­å¿ƒHTTPè¯·æ±‚] --&amp;gt; B(NettyæœåŠ¡)
B --&amp;gt; C{è·¯ç”±è‡³ExecutorBiz.run}
C --&amp;gt; D[æ ¹æ®ä»»åŠ¡åä»jobHandlerRepositoryè·å–JobHandler]
D --&amp;gt; E[æäº¤ä»»åŠ¡è‡³çº¿ç¨‹æ± æ‰§è¡Œ]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›è°ƒæœºåˆ¶&lt;/strong&gt;
ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œç»“æœé€šè¿‡ &lt;code&gt;TriggerCallbackThread&lt;/code&gt; å¼‚æ­¥å›è°ƒè‡³è°ƒåº¦ä¸­å¿ƒï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é…ç½®é¡¹"&gt;âš ï¸ &lt;strong&gt;å…³é”®é…ç½®é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;é€šè¿‡ Spring é…ç½®ç±»æ³¨å…¥å‚æ•°ï¼ˆç¤ºä¾‹ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Bean
public XxlJobSpringExecutor xxlJobExecutor() {
XxlJobSpringExecutor executor = new XxlJobSpringExecutor();
executor.setAdminAddresses(&amp;#34;http://localhost:8080/xxl-job-admin&amp;#34;); // è°ƒåº¦ä¸­å¿ƒåœ°å€
executor.setAppname(&amp;#34;my-executor-app&amp;#34;); // æ‰§è¡Œå™¨å”¯ä¸€æ ‡è¯†
executor.setPort(9999); // æ‰§è¡Œå™¨ç«¯å£ï¼ˆéœ€é¿å…å†²çªï¼‰
executor.setAccessToken(&amp;#34;default_token&amp;#34;); // é€šä¿¡Token
executor.setLogPath(&amp;#34;/data/logs&amp;#34;); // ä»»åŠ¡æ—¥å¿—è·¯å¾„
return executor;
}
&lt;/code&gt;&lt;/pre&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¿…å¡«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;adminAddresses&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;è°ƒåº¦ä¸­å¿ƒé›†ç¾¤åœ°å€ï¼ˆé€—å·åˆ†éš”ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;appname&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œå™¨åç§°ï¼ŒåŒä¸€é›†ç¾¤å†…ç›¸åŒåç§°çš„æ‰§è¡Œå™¨è§†ä¸ºåŒä¸€åˆ†ç»„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;port&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œå™¨ç«¯å£ï¼ˆé»˜è®¤ &lt;code&gt;9999&lt;/code&gt;ï¼Œå¤šå®ä¾‹éœ€ä¸åŒç«¯å£ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;logRetentionDays&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;æ—¥å¿—ä¿ç•™å¤©æ•°ï¼ˆé»˜è®¤ &lt;code&gt;30&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–"&gt;ğŸ› ï¸ &lt;strong&gt;å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç«¯å£å†²çª&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¤šå®ä¾‹éƒ¨ç½²æ—¶éœ€æ˜¾å¼é…ç½®ä¸åŒç«¯å£ï¼ˆ&lt;code&gt;executor.setPort()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡æ‰«æå¤±è´¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; @XxlJob
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ³¨è§£çš„æ–¹æ³•æ»¡è¶³ç­¾åè¦æ±‚ï¼š
&lt;code&gt;@XxlJob(&amp;quot;taskName&amp;quot;) public ReturnT&amp;lt;String&amp;gt; handler(String param) { ... } // å‚æ•°ä¸ºStringï¼Œè¿”å›ReturnT&lt;/code&gt;
3. &lt;strong&gt;èµ„æºæ¸…ç†&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œå™¨å…³é—­æ—¶ï¼ˆå¦‚æœåŠ¡ä¸‹çº¿ï¼‰ï¼Œè‡ªåŠ¨è°ƒç”¨ &lt;code&gt;destroy()&lt;/code&gt; é‡Šæ”¾çº¿ç¨‹å’Œç½‘ç»œèµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;XxlJobSpringExecutor&lt;/code&gt; é€šè¿‡ &lt;strong&gt;ä¸ Spring ç”Ÿå‘½å‘¨æœŸæ·±åº¦é›†æˆ&lt;/strong&gt;ï¼Œå®ç°äº†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨åŒ–ä»»åŠ¡æ³¨å†Œ&lt;/strong&gt;ï¼šåŸºäºæ³¨è§£æ‰«æç®€åŒ–å¼€å‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ‰˜ç®¡&lt;/strong&gt;ï¼šä¾èµ– Spring å®¹å™¨ç®¡ç†çº¿ç¨‹ã€ç½‘ç»œç­‰èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨ä¿éšœ&lt;/strong&gt;ï¼šå†…ç½®å¿ƒè·³æ£€æµ‹ã€æ•…éšœè½¬ç§»ã€æ—¥å¿—æ¸…ç†ç­‰æœºåˆ¶ã€‚
å®ƒæ˜¯ XXL-JOB åœ¨ Spring ç”Ÿæ€ä¸­çš„æ ¸å¿ƒé€‚é…å™¨ï¼Œæå¤§é™ä½äº†åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦çš„é›†æˆå¤æ‚åº¦ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="xxl-job-è‡ªåŠ¨é…ç½®"&gt;XXL-JOB è‡ªåŠ¨é…ç½®
&lt;/h2&gt;&lt;p&gt;åœ¨ Spring Boot é¡¹ç›®ä¸­å¯¼å…¥ &lt;code&gt;xxl-job-core&lt;/code&gt; ä¾èµ–åï¼Œå…¶è‡ªåŠ¨é…ç½®è¿‡ç¨‹ä¸»è¦åŸºäº &lt;strong&gt;Spring Boot çš„è‡ªåŠ¨è£…é…æœºåˆ¶&lt;/strong&gt;å’Œ &lt;strong&gt;æ¡ä»¶æ³¨è§£&lt;/strong&gt; å®ç°ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†åŸç†å’Œæµç¨‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è‡ªåŠ¨é…ç½®è§¦å‘æœºåˆ¶"&gt;ğŸ”§ è‡ªåŠ¨é…ç½®è§¦å‘æœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;spring.factories&lt;/code&gt; æ³¨å†Œè‡ªåŠ¨é…ç½®ç±»&lt;/strong&gt;
&lt;code&gt;xxl-job-core&lt;/code&gt; åœ¨ &lt;code&gt;META-INF/spring.factories&lt;/code&gt; æ–‡ä»¶ä¸­å£°æ˜äº†è‡ªåŠ¨é…ç½®ç±»ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.xxl.job.core.executor.impl.XxlJobSpringExecutor
&lt;/code&gt;&lt;/pre&gt;Spring Boot å¯åŠ¨æ—¶ä¼šæ‰«æè¯¥æ–‡ä»¶ï¼Œè‡ªåŠ¨åŠ è½½ &lt;code&gt;XxlJobSpringExecutor&lt;/code&gt; ç›¸å…³é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ä»¶æ³¨è§£æ§åˆ¶ç”Ÿæ•ˆé€»è¾‘&lt;/strong&gt;
&lt;code&gt;XxlJobSpringExecutor&lt;/code&gt; çš„åˆå§‹åŒ–ä¾èµ–ä»¥ä¸‹æ¡ä»¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;@ConditionalOnClass(XxlJobSpringExecutor.class)&lt;/code&gt;ï¼šç¡®ä¿ç±»è·¯å¾„ä¸­å­˜åœ¨ &lt;code&gt;xxl-job-core&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;@ConditionalOnProperty(prefix = &amp;quot;xxl.job&amp;quot;, value = &amp;quot;enabled&amp;quot;, havingValue = &amp;quot;true&amp;quot;, matchIfMissing = true)&lt;/code&gt;ï¼šé»˜è®¤å¯ç”¨é…ç½®ï¼ˆå¯é€šè¿‡ &lt;code&gt;xxl.job.enabled=false&lt;/code&gt; ç¦ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è‡ªåŠ¨é…ç½®æ ¸å¿ƒæµç¨‹"&gt;âš™ï¸ è‡ªåŠ¨é…ç½®æ ¸å¿ƒæµç¨‹
&lt;/h3&gt;&lt;h4 id="å‚æ•°ç»‘å®šä¸-bean-åˆå§‹åŒ–"&gt;&lt;strong&gt;å‚æ•°ç»‘å®šä¸ Bean åˆå§‹åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é…ç½®å‚æ•°åŠ è½½ï¼š
è‡ªåŠ¨è¯»å–&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; application.yml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; application.properties
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸­&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; xxl.job
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å‰ç¼€çš„é…ç½®é¡¹ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;xxl:
job:
admin:
addresses: http://localhost:8080/xxl-job-admin
executor:
appname: my-app
port: 9999
accessToken: default_token
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ›å»º &lt;code&gt;XxlJobSpringExecutor&lt;/code&gt; Bean&lt;/strong&gt;ï¼š
é€šè¿‡ &lt;code&gt;@Bean&lt;/code&gt; æ–¹æ³•åˆå§‹åŒ–æ‰§è¡Œå™¨å®ä¾‹ï¼Œå¹¶æ³¨å…¥é…ç½®å‚æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ‰§è¡Œå™¨å¯åŠ¨ä¸ä»»åŠ¡æ³¨å†Œ"&gt;&lt;strong&gt;æ‰§è¡Œå™¨å¯åŠ¨ä¸ä»»åŠ¡æ³¨å†Œ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸå›è°ƒ&lt;/strong&gt;ï¼š
&lt;code&gt;XxlJobSpringExecutor&lt;/code&gt; å®ç° &lt;code&gt;SmartInitializingSingleton&lt;/code&gt; æ¥å£ï¼Œåœ¨ â€‹&lt;strong&gt;æ‰€æœ‰å•ä¾‹ Bean åˆå§‹åŒ–å®Œæˆå&lt;/strong&gt;â€‹ å¯åŠ¨æ‰§è¡Œå™¨ï¼ˆè°ƒç”¨ &lt;code&gt;start()&lt;/code&gt; æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»»åŠ¡æ‰«æä¸æ³¨å†Œï¼š
æ‰«ææ‰€æœ‰ Spring Bean ä¸­è¢«&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; @XxlJob
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ³¨è§£çš„æ–¹æ³•ï¼Œå°†å…¶æ³¨å†Œä¸ºä»»åŠ¡å¤„ç†å™¨ï¼ˆJobHandlerï¼‰ã€‚
ç¤ºä¾‹ä»£ç ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Component
public class MyJobHandler {
@XxlJob(&amp;#34;demoJobHandler&amp;#34;)
public ReturnT&amp;lt;String&amp;gt; execute(String param) {
// ä»»åŠ¡é€»è¾‘
return ReturnT.SUCCESS;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="é€šä¿¡æœåŠ¡å¯åŠ¨"&gt;&lt;strong&gt;é€šä¿¡æœåŠ¡å¯åŠ¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å†…åµŒ Netty æœåŠ¡å™¨å¯åŠ¨ï¼Œé»˜è®¤ç›‘å¬ &lt;code&gt;9999&lt;/code&gt; ç«¯å£ï¼Œæ¥æ”¶è°ƒåº¦ä¸­å¿ƒçš„ HTTP è¯·æ±‚ï¼ˆå¦‚ &lt;code&gt;/run&lt;/code&gt; è§¦å‘ä»»åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯åŠ¨åå°çº¿ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¿ƒè·³çº¿ç¨‹&lt;/strong&gt;ï¼šå®šæœŸå‘è°ƒåº¦ä¸­å¿ƒæ³¨å†Œæ‰§è¡Œå™¨åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›è°ƒçº¿ç¨‹&lt;/strong&gt;ï¼šå¼‚æ­¥è¿”å›ä»»åŠ¡æ‰§è¡Œç»“æœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—æ¸…ç†çº¿ç¨‹&lt;/strong&gt;ï¼šå®šæœŸæ¸…ç†è¿‡æœŸä»»åŠ¡æ—¥å¿—ï¼ˆé»˜è®¤ä¿ç•™ 30 å¤©ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é…ç½®é¡¹ä¸æ‰©å±•"&gt;ğŸ”Œ å…³é”®é…ç½®é¡¹ä¸æ‰©å±•
&lt;/h3&gt;&lt;h4 id="å¿…é¡»é…ç½®é¡¹"&gt;&lt;strong&gt;å¿…é¡»é…ç½®é¡¹&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹å€¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;xxl.job.admin.addresses&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è°ƒåº¦ä¸­å¿ƒåœ°å€&lt;/td&gt;
&lt;td&gt;&lt;code&gt;http://localhost:8080/xxl-job-admin&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;xxl.job.executor.appname&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œå™¨å”¯ä¸€æ ‡è¯†&lt;/td&gt;
&lt;td&gt;&lt;code&gt;my-app-executor&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;xxl.job.accessToken&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è°ƒåº¦ä¸­å¿ƒä¸æ‰§è¡Œå™¨é€šä¿¡ä»¤ç‰Œ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;default_token&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="å¯é€‰ä¼˜åŒ–é¡¹"&gt;&lt;strong&gt;å¯é€‰ä¼˜åŒ–é¡¹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;xxl:
job:
executor:
port: 9999 # å¤šå®ä¾‹éœ€é¿å…ç«¯å£å†²çª
logpath: /data/logs/xxl-job # æ—¥å¿—å­˜å‚¨è·¯å¾„
logretentiondays: 30 # æ—¥å¿—ä¿ç•™å¤©æ•°
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="è‡ªå®šä¹‰è¦†ç›–é»˜è®¤é…ç½®"&gt;&lt;strong&gt;è‡ªå®šä¹‰è¦†ç›–é»˜è®¤é…ç½®&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;è‹¥éœ€è¦†ç›–è‡ªåŠ¨é…ç½®çš„ Beanï¼Œå¯æ‰‹åŠ¨å£°æ˜ &lt;code&gt;XxlJobSpringExecutor&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Configuration
public class CustomXxlJobConfig {
@Bean
public XxlJobSpringExecutor xxlJobExecutor(Environment env) {
XxlJobSpringExecutor executor = new XxlJobSpringExecutor();
executor.setAdminAddresses(env.getProperty(&amp;#34;xxl.job.admin.addresses&amp;#34;));
executor.setAppname(env.getProperty(&amp;#34;xxl.job.executor.appname&amp;#34;));
// å…¶ä»–è‡ªå®šä¹‰å‚æ•°
return executor;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜ä¸æ’æŸ¥"&gt;âš ï¸ å¸¸è§é—®é¢˜ä¸æ’æŸ¥
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨æœªæ³¨å†Œåˆ°è°ƒåº¦ä¸­å¿ƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥ &lt;code&gt;appname&lt;/code&gt; æ˜¯å¦ä¸è°ƒåº¦ä¸­å¿ƒé…ç½®ä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®è®¤ç½‘ç»œè¿é€šæ€§ï¼ˆæ‰§è¡Œå™¨éœ€èƒ½è®¿é—®è°ƒåº¦ä¸­å¿ƒåœ°å€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@XxlJob&lt;/code&gt; ä»»åŠ¡æœªè¢«æ‰«æ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿ä»»åŠ¡ç±»è¢« Spring ç®¡ç†ï¼ˆå¦‚æ·»åŠ  &lt;code&gt;@Component&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éªŒè¯æ–¹æ³•ç­¾åç¬¦åˆè¦æ±‚ï¼š&lt;code&gt;ReturnT&amp;lt;String&amp;gt; methodName(String param)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç«¯å£å†²çª&lt;/strong&gt;
å¤šå®ä¾‹éƒ¨ç½²æ—¶ï¼Œæ˜¾å¼é…ç½®ä¸åŒç«¯å£ï¼š&lt;code&gt;xxl.job.executor.port=9999&lt;/code&gt; â†’ &lt;code&gt;10000&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Spring Boot é›†æˆ XXL-JOB çš„è‡ªåŠ¨é…ç½®æµç¨‹å¯å½’çº³ä¸ºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–è§¦å‘&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;spring.factories&lt;/code&gt; åŠ è½½æ‰§è¡Œå™¨é…ç½®ç±»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°æ³¨å…¥&lt;/strong&gt;ï¼šç»‘å®šé…ç½®æ–‡ä»¶ä¸­çš„ &lt;code&gt;xxl.job&lt;/code&gt; å‚æ•°åˆ° &lt;code&gt;XxlJobSpringExecutor&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡æ³¨å†Œ&lt;/strong&gt;ï¼šæ‰«æ &lt;code&gt;@XxlJob&lt;/code&gt; æ³¨è§£æ–¹æ³•å¹¶æ³¨å†Œä¸º JobHandlerã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡å¯åŠ¨&lt;/strong&gt;ï¼šåˆå§‹åŒ– Netty æœåŠ¡ã€å¿ƒè·³çº¿ç¨‹åŠå›è°ƒçº¿ç¨‹ã€‚
é€šè¿‡æ­¤æœºåˆ¶ï¼Œå¼€å‘è€…åªéœ€ &lt;strong&gt;å¼•å…¥ä¾èµ– + é…ç½®å‚æ•° + æ·»åŠ æ³¨è§£&lt;/strong&gt; å³å¯å¿«é€Ÿæ¥å…¥åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™æ¨¡æ¿ä»£ç ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="è‡ªåŠ¨é…ç½®ç±»"&gt;è‡ªåŠ¨é…ç½®ç±»
&lt;/h2&gt;&lt;p&gt;META-INF/spring.factories æ˜¯ Spring Boot è‡ªåŠ¨é…ç½®æœºåˆ¶çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œé€šè¿‡&lt;strong&gt;çº¦å®šä¼˜äºé…ç½®&lt;/strong&gt;çš„åŸåˆ™å®ç°æ¨¡å—åŒ–æ‰©å±•ã€‚ä»¥ä¸‹ä»ä½œç”¨æœºåˆ¶ã€å®ç°åŸç†ã€åº”ç”¨åœºæ™¯åŠæœ€ä½³å®è·µå››æ–¹é¢æ·±å…¥è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä½œç”¨ä¸æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒä½œç”¨ä¸æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è‡ªåŠ¨é…ç½®å…¥å£&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶ä½äº Jar åŒ…çš„ &lt;code&gt;META-INF/spring.factories&lt;/code&gt; è·¯å¾„ä¸‹ï¼Œæ ¼å¼ä¸ºé”®å€¼å¯¹ï¼ˆKey-Valueï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®é”®å&lt;/strong&gt;ï¼š&lt;code&gt;org.springframework.boot.autoconfigure.EnableAutoConfiguration&lt;/code&gt;ï¼Œå…¶å€¼åˆ—å‡ºæ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»çš„å…¨é™å®šåï¼ˆé€—å·åˆ†éš”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ—¶æœº&lt;/strong&gt;ï¼šSpring Boot å¯åŠ¨æ—¶ï¼Œé€šè¿‡ &lt;code&gt;@SpringBootApplication&lt;/code&gt; â†’ &lt;code&gt;@EnableAutoConfiguration&lt;/code&gt; è§¦å‘åŠ è½½è¿™äº›é…ç½®ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³åŒ…æ‰«æé™åˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;@ComponentScan&lt;/code&gt; ä»…æ‰«æä¸»åŒ…è·¯å¾„ä¸‹çš„ Beanï¼Œè€Œ &lt;code&gt;spring.factories&lt;/code&gt; å¯&lt;strong&gt;åŠ è½½ç¬¬ä¸‰æ–¹ä¾èµ–æˆ–å­æ¨¡å—ä¸­çš„é…ç½®ç±»&lt;/strong&gt;ï¼ˆå¦‚ MyBatisã€Redis ç­‰ Starter çš„è‡ªåŠ¨é…ç½®ï¼‰ã€‚
&lt;em&gt;ç¤ºä¾‹&lt;/em&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.example.config.DataSourceConfig,\
com.example.config.CacheConfig
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ‰©å±• Spring åŠŸèƒ½&lt;/strong&gt;
é™¤è‡ªåŠ¨é…ç½®å¤–ï¼Œè¿˜æ”¯æŒæ³¨å†Œå…¶ä»–æ‰©å±•ç»„ä»¶ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ‰©å±•ç‚¹ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹é”®å&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ApplicationContextInitializer&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®¹å™¨åˆå§‹åŒ–å‰æ‰§è¡Œé€»è¾‘&lt;/td&gt;
&lt;td&gt;&lt;code&gt;org.springframework.context.ApplicationContextInitializer&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ApplicationListener&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç›‘å¬ Spring äº‹ä»¶ï¼ˆå¦‚ä¸Šä¸‹æ–‡åˆ·æ–°ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;org.springframework.context.ApplicationListener&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;EnvironmentPostProcessor&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€ä¿®æ”¹ç¯å¢ƒå˜é‡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;org.springframework.boot.env.EnvironmentPostProcessor&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°åŸç†springfactoriesloader"&gt;ğŸ”¬ &lt;strong&gt;å®ç°åŸç†ï¼šSpringFactoriesLoader&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Spring Boot é€šè¿‡ &lt;code&gt;SpringFactoriesLoader&lt;/code&gt; ç±»åŠ è½½ &lt;code&gt;spring.factories&lt;/code&gt;ï¼Œæµç¨‹å¦‚ä¸‹ï¼š
1.
æ–‡ä»¶æ‰«æ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éå† ClassLoader ä¸‹æ‰€æœ‰ Jar åŒ…çš„ &lt;code&gt;META-INF/spring.factories&lt;/code&gt; æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;è§£æä¸ç¼“å­˜&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å°†æ–‡ä»¶å†…å®¹è§£æä¸º &lt;code&gt;Map&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt;&lt;/code&gt;ï¼ˆKey=æ¥å£ç±»åï¼ŒValue=å®ç°ç±»åˆ—è¡¨ï¼‰å¹¶ç¼“å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;ç±»åŠ è½½ä¸å®ä¾‹åŒ–&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; loadFactories()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ–¹æ³•ï¼š
- æ ¹æ®æ¥å£åè·å–å®ç°ç±»ååˆ—è¡¨ï¼›
- åå°„å®ä¾‹åŒ–ç±»ï¼ˆé€šè¿‡ &lt;code&gt;Class.forName()&lt;/code&gt; + æ„é€ å™¨ï¼‰ã€‚
4.
æ¡ä»¶è£…é…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨é…ç½®ç±»é€šå¸¸é…åˆ
æ¡ä»¶æ³¨è§£
æ§åˆ¶ç”Ÿæ•ˆï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Configuration
@ConditionalOnClass(DataSource.class) // å­˜åœ¨DataSourceç±»æ‰ç”Ÿæ•ˆ
@ConditionalOnMissingBean(JdbcTemplate.class) // å®¹å™¨æ— JdbcTemplate Beanæ‰ç”Ÿæ•ˆ
public class DataSourceAutoConfiguration {
@Bean
public DataSource dataSource() { ... }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ› ï¸ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Spring Boot Starter å¼€å‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå®šä¹‰ Starter&lt;/strong&gt;ï¼šåœ¨ Starter ä¸­é…ç½® &lt;code&gt;spring.factories&lt;/code&gt;ï¼Œä½¿ç”¨è€…åªéœ€å¼•å…¥ä¾èµ–å³è‡ªåŠ¨åŠ è½½é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;# my-starter çš„ spring.factories
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.mystarter.config.MyAutoConfiguration
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ¨¡å—é¡¹ç›®å…±äº«é…ç½®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šCommon æ¨¡å—çš„é…ç½®ç±»æ— æ³•è¢«ä¸»æ¨¡å—æ‰«æã€‚&lt;/li&gt;
&lt;li&gt;æ–¹æ¡ˆï¼šåœ¨ Common æ¨¡å—çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; META-INF/spring.factories
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸­å£°æ˜é…ç½®ç±»ï¼Œä¸»æ¨¡å—ä¾èµ–åè‡ªåŠ¨åŠ è½½ï¼š
&lt;code&gt;# hm-common æ¨¡å—çš„é…ç½® org.springframework.boot.autoconfigure.EnableAutoConfiguration=\ com.hmall.common.config.MyBatisConfig,\ com.hmall.common.config.MvcConfig&lt;/code&gt;
3. &lt;strong&gt;é›†æˆç¬¬ä¸‰æ–¹æ¡†æ¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ MyBatis-Plus é€šè¿‡&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; spring.factories
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ³¨å†Œè‡ªåŠ¨é…ç½®ç±»ï¼š
&lt;code&gt;org.springframework.boot.autoconfigure.EnableAutoConfiguration=\ com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é…ç½®å†²çª&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¡ä»¶æ³¨è§£&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;@ConditionalOnClass&lt;/code&gt;ã€&lt;code&gt;@ConditionalOnProperty&lt;/code&gt; ç­‰ç¡®ä¿é…ç½®ä»…åœ¨æ»¡è¶³æ¡ä»¶æ—¶ç”Ÿæ•ˆã€‚&lt;/li&gt;
&lt;li&gt;ç¦ç”¨è‡ªåŠ¨é…ç½®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;spring.autoconfigure.exclude=com.example.config.UnwantedConfig
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘æ‰«æèŒƒå›´&lt;/strong&gt;ï¼šä»…å£°æ˜å¿…è¦çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œé¿å…åŠ è½½æœªä½¿ç”¨çš„ç»„ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜æœºåˆ¶&lt;/strong&gt;ï¼š&lt;code&gt;SpringFactoriesLoader&lt;/code&gt; ä¼šç¼“å­˜å·²åŠ è½½çš„é…ç½®ï¼Œé¿å…é‡å¤è§£æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒè¯•æŠ€å·§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥çœ‹ç”Ÿæ•ˆçš„é…ç½®ç±»&lt;/strong&gt;ï¼šå¯åŠ¨æ—¶æ·»åŠ  &lt;code&gt;--debug&lt;/code&gt; å‚æ•°ï¼Œæ—¥å¿—è¾“å‡ºæ‰€æœ‰åŒ¹é…çš„è‡ªåŠ¨é…ç½®ç±»ã€‚&lt;/li&gt;
&lt;li&gt;æ—¥å¿—ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Positive matches:
DataSourceAutoConfiguration matched
- @ConditionalOnClass found required class &amp;#39;javax.sql.DataSource&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼š&lt;code&gt;META-INF/spring.factories&lt;/code&gt; æ˜¯ Spring Boot &lt;strong&gt;è‡ªåŠ¨åŒ–é…ç½®çš„åŸºçŸ³&lt;/strong&gt;ï¼Œé€šè¿‡è§£è€¦é…ç½®ç±»ä¸ä¸»åº”ç”¨ï¼Œå®ç°â€œå¼€ç®±å³ç”¨â€çš„æ¨¡å—åŒ–æ‰©å±•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®æµç¨‹&lt;/strong&gt;ï¼š&lt;code&gt;@EnableAutoConfiguration&lt;/code&gt; â†’ &lt;code&gt;SpringFactoriesLoader&lt;/code&gt; â†’ æ¡ä»¶è£…é… â†’ Bean æ³¨å†Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šStarter å¼€å‘ã€å¤šæ¨¡å—å…±äº«é…ç½®ã€ç¬¬ä¸‰æ–¹æ¡†æ¶é›†æˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡åˆç†ä½¿ç”¨æ­¤æœºåˆ¶ï¼Œå¼€å‘è€…å¯æ˜¾è‘—å‡å°‘æ ·æ¿ä»£ç ï¼Œæå‡ç³»ç»Ÿå¯ç»´æŠ¤æ€§ï¼Œä½†éœ€è­¦æƒ•é…ç½®å†²çªä¸å†—ä½™åŠ è½½é—®é¢˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ‰§è¡Œå™¨å’Œä»»åŠ¡å¤„ç†å™¨"&gt;æ‰§è¡Œå™¨å’Œä»»åŠ¡å¤„ç†å™¨
&lt;/h2&gt;&lt;p&gt;æ˜¯çš„ï¼Œ&lt;strong&gt;ä¸€ä¸ªæ‰§è¡Œå™¨ï¼ˆExecutorï¼‰å¯ä»¥å¯¹åº”å¤šä¸ªä»»åŠ¡å¤„ç†å™¨ï¼ˆJobHandlerï¼‰&lt;/strong&gt;ã€‚è¿™æ˜¯ XXL-JOB æ¶æ„è®¾è®¡çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œé€šè¿‡è§£è€¦æ‰§è¡Œå™¨ä¸å…·ä½“ä»»åŠ¡é€»è¾‘ï¼Œå®ç°äº†çµæ´»çš„ä»»åŠ¡ç®¡ç†å’Œè°ƒåº¦ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡Œå™¨ä¸ä»»åŠ¡å¤„ç†å™¨çš„å…³ç³»"&gt;ğŸ”§ &lt;strong&gt;æ‰§è¡Œå™¨ä¸ä»»åŠ¡å¤„ç†å™¨çš„å…³ç³»&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨ï¼ˆExecutorï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œå™¨æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡èŠ‚ç‚¹ï¼ˆæˆ–é›†æˆåœ¨ä¸šåŠ¡æœåŠ¡ä¸­ï¼‰ï¼Œè´Ÿè´£&lt;strong&gt;æ¥æ”¶è°ƒåº¦ä¸­å¿ƒçš„æŒ‡ä»¤&lt;/strong&gt;å¹¶æ‰§è¡Œä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªæ‰§è¡Œå™¨åœ¨å¯åŠ¨æ—¶éœ€é…ç½®å”¯ä¸€çš„ &lt;code&gt;appname&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;xxl-job-executor-sample&lt;/code&gt;ï¼‰ï¼Œä½œä¸ºå…¶åœ¨è°ƒåº¦ä¸­å¿ƒçš„æ ‡è¯†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡å¤„ç†å™¨ï¼ˆJobHandlerï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»»åŠ¡å¤„ç†å™¨æ˜¯&lt;strong&gt;å…·ä½“çš„ä¸šåŠ¡é€»è¾‘å®ç°&lt;/strong&gt;ï¼Œé€šè¿‡ &lt;code&gt;@XxlJob&lt;/code&gt; æ³¨è§£æ ‡è®°çš„æ–¹æ³•å®šä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªä»»åŠ¡å¤„ç†å™¨éœ€æŒ‡å®šå”¯ä¸€åç§°ï¼ˆå¦‚ &lt;code&gt;demoJobHandler&lt;/code&gt;ï¼‰ï¼Œè¯¥åç§°éœ€ä¸è°ƒåº¦ä¸­å¿ƒçš„ä»»åŠ¡é…ç½®ä¸­çš„ &lt;code&gt;JobHandler&lt;/code&gt; å­—æ®µä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€å¯¹å¤šçš„å®ç°æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;ä¸€å¯¹å¤šçš„å®ç°æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç ç¤ºä¾‹ï¼šä¸€ä¸ªæ‰§è¡Œå™¨åŒ…å«å¤šä¸ªä»»åŠ¡å¤„ç†å™¨&lt;/strong&gt;
åœ¨åŒä¸€ä¸ªæ‰§è¡Œå™¨é¡¹ç›®ä¸­ï¼Œå¯å®šä¹‰å¤šä¸ªå¸¦ &lt;code&gt;@XxlJob&lt;/code&gt; æ³¨è§£çš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Component
public class MyJobHandlers {
// å¤„ç†å™¨1
@XxlJob(&amp;#34;taskAHandler&amp;#34;)
public void handleTaskA() {
// ä¸šåŠ¡é€»è¾‘A
}
// å¤„ç†å™¨2
@XxlJob(&amp;#34;taskBHandler&amp;#34;)
public void handleTaskB(String param) {
// ä¸šåŠ¡é€»è¾‘Bï¼ˆæ”¯æŒå‚æ•°ï¼‰
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œå™¨å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰«ææ‰€æœ‰ &lt;code&gt;@XxlJob&lt;/code&gt; æ³¨è§£çš„æ–¹æ³•ï¼Œå¹¶å°†å®ƒä»¬æ³¨å†Œåˆ°è°ƒåº¦ä¸­å¿ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒåº¦ä¸­å¿ƒé…ç½®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨è°ƒåº¦ä¸­å¿ƒçš„ä»»åŠ¡ç®¡ç†é¡µé¢ï¼Œéœ€ä¸ºæ¯ä¸ªä»»åŠ¡å¤„ç†å™¨å•ç‹¬åˆ›å»ºä»»åŠ¡é…ç½®ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨&lt;/strong&gt;ï¼šé€‰æ‹©ç›¸åŒçš„æ‰§è¡Œå™¨åç§°ï¼ˆå¦‚ &lt;code&gt;xxl-job-executor-sample&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;JobHandler&lt;/strong&gt;ï¼šå¡«å†™å¯¹åº”çš„æ³¨è§£åç§°ï¼ˆå¦‚ &lt;code&gt;taskAHandler&lt;/code&gt;ã€&lt;code&gt;taskBHandler&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è°ƒåº¦ä¸­å¿ƒæ ¹æ® &lt;code&gt;JobHandler&lt;/code&gt; åç§°å°†ä»»åŠ¡è·¯ç”±åˆ°æ‰§è¡Œå™¨çš„å…·ä½“æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡Œå™¨çš„ä»»åŠ¡æ³¨å†Œæµç¨‹"&gt;ğŸ“Š &lt;strong&gt;æ‰§è¡Œå™¨çš„ä»»åŠ¡æ³¨å†Œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¯åŠ¨æ—¶è‡ªåŠ¨æ³¨å†Œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œå™¨å¯åŠ¨åï¼Œå‘è°ƒåº¦ä¸­å¿ƒå‘é€æ³¨å†Œè¯·æ±‚ï¼ŒåŒ…å«è‡ªèº«çš„ &lt;code&gt;appname&lt;/code&gt;ã€IPã€ç«¯å£åŠæ‰€æœ‰ &lt;code&gt;@XxlJob&lt;/code&gt; æ–¹æ³•åç§°ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒåº¦ä¸­å¿ƒå°†æ³¨å†Œä¿¡æ¯å­˜å‚¨åˆ°è¡¨ &lt;code&gt;xxl_job_registry&lt;/code&gt; ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒåº¦ä¸­å¿ƒçš„ä»»åŠ¡ç»‘å®š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨è°ƒåº¦ä¸­å¿ƒåˆ›å»ºä»»åŠ¡æ—¶ï¼Œéœ€é€‰æ‹©ç›®æ ‡æ‰§è¡Œå™¨ï¼Œå¹¶å¡«å†™å¯¹åº”çš„ &lt;code&gt;JobHandler&lt;/code&gt; åç§°ã€‚&lt;/li&gt;
&lt;li&gt;ä»»åŠ¡è§¦å‘æ—¶ï¼Œè°ƒåº¦ä¸­å¿ƒæ ¹æ® &lt;code&gt;JobHandler&lt;/code&gt; åç§°ä»æ‰§è¡Œå™¨çš„æ³¨å†Œåˆ—è¡¨ä¸­åŒ¹é…å…·ä½“æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸ä¼˜åŠ¿"&gt;ğŸ’¡ &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯ç¤ºä¾‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç”µå•†ç³»ç»Ÿï¼šä¸€ä¸ªè®¢å•æœåŠ¡ï¼ˆæ‰§è¡Œå™¨ï¼‰å¯åŒ…å«å¤šä¸ªä»»åŠ¡å¤„ç†å™¨ï¼Œå¦‚ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;orderTimeoutHandler&lt;/code&gt;ï¼ˆå¤„ç†è¶…æ—¶è®¢å•ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;inventorySyncHandler&lt;/code&gt;ï¼ˆåŒæ­¥åº“å­˜æ•°æ®ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;couponExpireHandler&lt;/code&gt;ï¼ˆä¼˜æƒ åˆ¸è¿‡æœŸæé†’ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºå¤ç”¨&lt;/strong&gt;ï¼šå¤šä¸ªä»»åŠ¡å…±äº«åŒä¸€æ‰§è¡Œå™¨çš„çº¿ç¨‹æ± ã€æ—¥å¿—ç®¡ç†ç­‰èµ„æºï¼Œå‡å°‘éƒ¨ç½²å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´ç®€åŒ–&lt;/strong&gt;ï¼šåªéœ€ç»´æŠ¤ä¸€ä¸ªæ‰§è¡Œå™¨æœåŠ¡ï¼Œé¿å…å¤šèŠ‚ç‚¹é…ç½®å†—ä½™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ‰©å±•&lt;/strong&gt;ï¼šæ–°å¢ä»»åŠ¡åªéœ€æ·»åŠ æ³¨è§£å¹¶é…ç½®è°ƒåº¦ä¸­å¿ƒï¼Œæ— éœ€é‡å¯æ‰§è¡Œå™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;JobHandler åç§°å†²çª&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŒä¸€æ‰§è¡Œå™¨å†…ï¼Œä¸åŒä»»åŠ¡çš„ &lt;code&gt;@XxlJob&lt;/code&gt; åç§°å¿…é¡»å”¯ä¸€ï¼Œå¦åˆ™æ³¨å†Œä¼šå¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨çº¿ç¨‹æ± é…ç½®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥å¤šä¸ªä»»åŠ¡å¹¶å‘é«˜ï¼Œéœ€è°ƒæ•´çº¿ç¨‹æ± å‚æ•°ï¼ˆæ ¸å¿ƒ/æœ€å¤§çº¿ç¨‹æ•°ã€é˜Ÿåˆ—å¤§å°ï¼‰ï¼Œé¿å…ä»»åŠ¡é˜»å¡ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;xxl.job.executor.threadpool.coreSize=20
xxl.job.executor.threadpool.maxSize=200
xxl.job.executor.threadpool.queueSize=1000
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡éš”ç¦»æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é«˜ä¼˜å…ˆçº§ä»»åŠ¡ä¸ä½ä¼˜å…ˆçº§ä»»åŠ¡æ··éƒ¨æ—¶ï¼Œå»ºè®®é€šè¿‡&lt;strong&gt;è·¯ç”±ç­–ç•¥&lt;/strong&gt;ï¼ˆå¦‚å¿™ç¢Œè½¬ç§»ï¼‰æˆ–&lt;strong&gt;ç‹¬ç«‹çº¿ç¨‹æ± &lt;/strong&gt;éš”ç¦»ï¼Œé¿å…ç›¸äº’å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸€ä¸ªæ‰§è¡Œå™¨å¯ç®¡ç†å¤šä¸ªä»»åŠ¡å¤„ç†å™¨&lt;/strong&gt;ï¼Œé€šè¿‡ &lt;code&gt;@XxlJob&lt;/code&gt; æ³¨è§£å®ç°ä»»åŠ¡ä¸æ‰§è¡Œå™¨çš„è§£è€¦ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒåº¦ä¸­å¿ƒé€šè¿‡ &lt;strong&gt;æ‰§è¡Œå™¨åç§° + JobHandler åç§°&lt;/strong&gt; å”¯ä¸€ç¡®å®šä»»åŠ¡é€»è¾‘ï¼Œå®ç°ç²¾å‡†è·¯ç”±ã€‚&lt;/li&gt;
&lt;li&gt;åˆç†é…ç½®çº¿ç¨‹æ± å’Œè·¯ç”±ç­–ç•¥ï¼Œå¯å……åˆ†å‘æŒ¥ XXL-JOB åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹çš„çµæ´»æ€§ä¸é«˜å¹¶å‘èƒ½åŠ›ã€‚
é€šè¿‡æ­¤è®¾è®¡ï¼ŒXXL-JOB åœ¨ä¿è¯è°ƒåº¦æ•ˆç‡çš„åŒæ—¶ï¼Œæ˜¾è‘—é™ä½äº†ç³»ç»Ÿå¤æ‚åº¦å’Œè¿ç»´æˆæœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="æ‰§è¡Œå™¨æ³¨å†Œ"&gt;æ‰§è¡Œå™¨æ³¨å†Œ
&lt;/h2&gt;&lt;p&gt;XXL-JOBçš„ä»»åŠ¡æ³¨å†Œæ˜¯ä¸€ä¸ªç»“åˆä»£ç é…ç½®ä¸è°ƒåº¦ä¸­å¿ƒæ“ä½œçš„è¿‡ç¨‹ï¼Œå…¶æ ¸å¿ƒåœ¨äº&lt;strong&gt;æ‰§è¡Œå™¨è‡ªåŠ¨æ³¨å†Œä»»åŠ¡åˆ—è¡¨åˆ°è°ƒåº¦ä¸­å¿ƒ&lt;/strong&gt;ï¼Œå¹¶åœ¨è°ƒåº¦ä¸­å¿ƒæ‰‹åŠ¨é…ç½®ä»»åŠ¡è§¦å‘è§„åˆ™ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æµç¨‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡Œå™¨è‡ªåŠ¨æ³¨å†Œå…³é”®æ­¥éª¤"&gt;ğŸ”§ æ‰§è¡Œå™¨è‡ªåŠ¨æ³¨å†Œï¼ˆå…³é”®æ­¥éª¤ï¼‰
&lt;/h3&gt;&lt;p&gt;å½“æ‰§è¡Œå™¨ï¼ˆExecutorï¼‰å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨å‘è°ƒåº¦ä¸­å¿ƒæ³¨å†Œå…¶å¯æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ï¼ˆå³ä»£ç ä¸­æ ‡è®°çš„ä»»åŠ¡æ–¹æ³•ï¼‰ï¼Œè¿™æ˜¯é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç æ³¨è§£é…ç½®&lt;/strong&gt;
åœ¨Spring Beançš„æ–¹æ³•ä¸Šæ·»åŠ &lt;code&gt;@XxlJob&lt;/code&gt;æ³¨è§£ï¼ŒæŒ‡å®šä»»åŠ¡åç§°ï¼ˆéœ€ä¸è°ƒåº¦ä¸­å¿ƒé…ç½®ä¸€è‡´ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Component
public class MyJobHandler {
@XxlJob(&amp;#34;myJobHandler&amp;#34;) // ä»»åŠ¡åç§°
public void execute() {
XxlJobHelper.log(&amp;#34;ä»»åŠ¡æ‰§è¡Œä¸­...&amp;#34;);
// ä¸šåŠ¡é€»è¾‘
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨å‚æ•°é…ç½®&lt;/strong&gt;
åœ¨&lt;code&gt;application.yml&lt;/code&gt;ä¸­é…ç½®æ‰§è¡Œå™¨ä¿¡æ¯ï¼Œç¡®ä¿ä¸è°ƒåº¦ä¸­å¿ƒé€šä¿¡ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;xxl:
job:
admin:
addresses: http://localhost:8080/xxl-job-admin # è°ƒåº¦ä¸­å¿ƒåœ°å€
executor:
appname: xxl-job-executor-sample # æ‰§è¡Œå™¨åç§°ï¼ˆé›†ç¾¤å”¯ä¸€æ ‡è¯†ï¼‰
port: 9999 # æ‰§è¡Œå™¨ç«¯å£
logpath: /data/applogs/xxl-job # æ—¥å¿—è·¯å¾„
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨å¯åŠ¨ä¸æ³¨å†Œ&lt;/strong&gt;
æ‰§è¡Œå™¨å¯åŠ¨æ—¶ï¼Œé€šè¿‡&lt;code&gt;XxlJobSpringExecutor&lt;/code&gt;è‡ªåŠ¨æ‰«æ&lt;code&gt;@XxlJob&lt;/code&gt;æ³¨è§£çš„æ–¹æ³•ï¼Œå¹¶å‘è°ƒåº¦ä¸­å¿ƒæ³¨å†Œå…¶åœ°å€å’Œä»»åŠ¡åˆ—è¡¨ã€‚æ³¨å†Œä¿¡æ¯åŒ…æ‹¬ï¼š
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œå™¨åç§°ï¼ˆ&lt;code&gt;appname&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;IPåœ°å€ï¼ˆè‡ªåŠ¨è·å–æˆ–æ‰‹åŠ¨é…ç½®ï¼‰&lt;/li&gt;
&lt;li&gt;ç«¯å£å·&lt;/li&gt;
&lt;li&gt;ä»»åŠ¡Handleråç§°åˆ—è¡¨ï¼ˆå¦‚&lt;code&gt;myJobHandler&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è°ƒåº¦ä¸­å¿ƒæ‰‹åŠ¨é…ç½®ä»»åŠ¡"&gt;ğŸ–¥ï¸ è°ƒåº¦ä¸­å¿ƒæ‰‹åŠ¨é…ç½®ä»»åŠ¡
&lt;/h3&gt;&lt;p&gt;æ‰§è¡Œå™¨æ³¨å†ŒæˆåŠŸåï¼Œéœ€åœ¨è°ƒåº¦ä¸­å¿ƒç®¡ç†ç•Œé¢é…ç½®ä»»åŠ¡è§¦å‘è§„åˆ™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç™»å½•è°ƒåº¦ä¸­å¿ƒ&lt;/strong&gt;
è®¿é—®&lt;code&gt;http://localhost:8080/xxl-job-admin&lt;/code&gt;ï¼ˆé»˜è®¤è´¦å·&lt;code&gt;admin/123456&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æ‰§è¡Œå™¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¯å¾„&lt;/strong&gt;ï¼šæ‰§è¡Œå™¨ç®¡ç† â†’ æ–°å¢æ‰§è¡Œå™¨&lt;/li&gt;
&lt;li&gt;å…³é”®å‚æ•°ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ‰§è¡Œå™¨åç§°&lt;/td&gt;
&lt;td&gt;ä¸ä»£ç ä¸­&lt;code&gt;appname&lt;/code&gt;ä¸€è‡´ï¼ˆå¦‚&lt;code&gt;xxl-job-executor-sample&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ³¨å†Œæ–¹å¼&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è‡ªåŠ¨æ³¨å†Œ&lt;/strong&gt;ï¼ˆæ¨èï¼‰æˆ–æ‰‹åŠ¨å½•å…¥IP+ç«¯å£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœºå™¨åœ°å€&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨æ³¨å†Œæ—¶ç•™ç©ºï¼Œæ‰‹åŠ¨æ³¨å†Œéœ€å¡«å†™&lt;code&gt;IP:PORT&lt;/code&gt;ï¼ˆå¦‚&lt;code&gt;192.168.1.1:9999&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ›å»ºè°ƒåº¦ä»»åŠ¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¯å¾„&lt;/strong&gt;ï¼šä»»åŠ¡ç®¡ç† â†’ æ–°å¢ä»»åŠ¡&lt;/li&gt;
&lt;li&gt;å…³é”®å‚æ•°ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹å€¼&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ‰§è¡Œå™¨&lt;/td&gt;
&lt;td&gt;&lt;code&gt;xxl-job-executor-sample&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©å·²æ³¨å†Œçš„æ‰§è¡Œå™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;JobHandler&lt;/td&gt;
&lt;td&gt;&lt;code&gt;myJobHandler&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸ä»£ç ä¸­&lt;code&gt;@XxlJob(&amp;quot;myJobHandler&amp;quot;)&lt;/code&gt;ä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Cronè¡¨è¾¾å¼&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0 * * * * ?&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è·¯ç”±ç­–ç•¥&lt;/td&gt;
&lt;td&gt;è½®è¯¢/æ•…éšœè½¬ç§»&lt;/td&gt;
&lt;td&gt;é›†ç¾¤ç¯å¢ƒä¸‹ä»»åŠ¡åˆ†é…è§„åˆ™&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨å†ŒçŠ¶æ€éªŒè¯"&gt;âœ… æ³¨å†ŒçŠ¶æ€éªŒè¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨åˆ—è¡¨æ£€æŸ¥&lt;/strong&gt;
åœ¨è°ƒåº¦ä¸­å¿ƒçš„&lt;strong&gt;æ‰§è¡Œå™¨ç®¡ç†&lt;/strong&gt;é¡µé¢ï¼ŒæŸ¥çœ‹ç›®æ ‡æ‰§è¡Œå™¨çŠ¶æ€æ˜¯å¦ä¸º&lt;strong&gt;åœ¨çº¿&lt;/strong&gt;â€‹ï¼ˆç»¿è‰²æ ‡è¯†ï¼‰ï¼Œå¹¶ç¡®è®¤æ³¨å†Œçš„ä»»åŠ¡Handlerå·²æ˜¾ç¤ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰‹åŠ¨è§¦å‘æµ‹è¯•&lt;/strong&gt;
åœ¨ä»»åŠ¡ç®¡ç†é¡µé¢ï¼Œç‚¹å‡»&lt;strong&gt;æ‰§è¡Œä¸€æ¬¡&lt;/strong&gt;ï¼Œè§‚å¯Ÿæ—¥å¿—è¾“å‡ºï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è°ƒåº¦æ—¥å¿—&lt;/strong&gt;ï¼šè°ƒåº¦ä¸­å¿ƒæ˜¾ç¤ºä»»åŠ¡è§¦å‘çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨æ—¥å¿—&lt;/strong&gt;ï¼šæ§åˆ¶å°æˆ–&lt;code&gt;logpath&lt;/code&gt;ç›®å½•ä¸‹è¾“å‡º&lt;code&gt;XxlJobHelper.log&lt;/code&gt;çš„å†…å®¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜çº§åœºæ™¯é…ç½®"&gt;âš™ï¸ é«˜çº§åœºæ™¯é…ç½®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤éƒ¨ç½²&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨é›†ç¾¤&lt;/strong&gt;ï¼šå¤šä¸ªæ‰§è¡Œå™¨ä½¿ç”¨ç›¸åŒ&lt;code&gt;appname&lt;/code&gt;ï¼Œè°ƒåº¦ä¸­å¿ƒè‡ªåŠ¨æŒ‰è·¯ç”±ç­–ç•¥åˆ†é…ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒåº¦ä¸­å¿ƒé›†ç¾¤&lt;/strong&gt;ï¼šé€šè¿‡Nginxè´Ÿè½½å‡è¡¡ï¼ŒDBé…ç½®éœ€ä¿æŒä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dockerç¯å¢ƒæ³¨å†Œ&lt;/strong&gt;
æ‰§è¡Œå™¨å®¹å™¨éœ€é…ç½®ç¯å¢ƒå˜é‡&lt;code&gt;XXL_JOB_ADMIN_ADDRESS=http://xxl-job-admin:8080&lt;/code&gt;ï¼Œç¡®ä¿èƒ½è®¿é—®è°ƒåº¦ä¸­å¿ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€åˆ†ç‰‡ä»»åŠ¡&lt;/strong&gt;
åœ¨ä»»åŠ¡ä»£ç ä¸­é€šè¿‡&lt;code&gt;XxlJobHelper.getShardIndex()&lt;/code&gt;è·å–åˆ†ç‰‡å‚æ•°ï¼Œå®ç°å¹¶è¡Œå¤„ç†å¤§æ•°æ®ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;XXL-JOBçš„ä»»åŠ¡æ³¨å†Œæµç¨‹å¯å½’çº³ä¸ºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨ä¾§&lt;/strong&gt;ï¼šä»£ç æ³¨è§£å£°æ˜ä»»åŠ¡ â†’ é…ç½®æ‰§è¡Œå™¨å‚æ•° â†’ å¯åŠ¨æ—¶è‡ªåŠ¨æ³¨å†Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒåº¦ä¸­å¿ƒä¾§&lt;/strong&gt;ï¼šæ‰‹åŠ¨é…ç½®æ‰§è¡Œå™¨ â†’ åˆ›å»ºä»»åŠ¡å¹¶ç»‘å®šJobHandler â†’ è®¾ç½®è§¦å‘è§„åˆ™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è”åŠ¨éªŒè¯&lt;/strong&gt;ï¼šé€šè¿‡æ—¥å¿—å’Œæ‰‹åŠ¨è§¦å‘ç¡®è®¤æ³¨å†ŒæˆåŠŸã€‚
é€šè¿‡æ­¤è®¾è®¡ï¼ŒXXL-JOBå®ç°äº†&lt;strong&gt;è§£è€¦çš„ä»»åŠ¡æ³¨å†Œä¸è°ƒåº¦æœºåˆ¶&lt;/strong&gt;ï¼Œæ—¢ä¿éšœäº†æ‰§è¡Œå™¨çš„çµæ´»æ€§ï¼Œåˆé€šè¿‡ä¸­å¿ƒåŒ–æ§åˆ¶æå‡äº†ä»»åŠ¡ç®¡ç†çš„å¯é æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ä»»åŠ¡æäº¤"&gt;ä»»åŠ¡æäº¤
&lt;/h2&gt;&lt;p&gt;åœ¨ Spring Boot ä¸­å¿«é€Ÿè¯·æ±‚ XXL-JOB æäº¤ä»»åŠ¡ï¼Œå¯é€šè¿‡&lt;strong&gt;è°ƒåº¦ä¸­å¿ƒç®¡ç†ç•Œé¢&lt;/strong&gt;æˆ– &lt;strong&gt;API æ¥å£è°ƒç”¨&lt;/strong&gt;ä¸¤ç§æ–¹å¼å®ç°ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ­¥éª¤å’Œä¼˜åŒ–æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åŸºç¡€é…ç½®æ‰§è¡Œå™¨æ³¨å†Œä¸ä»»åŠ¡å®šä¹‰"&gt;ğŸ”§ åŸºç¡€é…ç½®ï¼ˆæ‰§è¡Œå™¨æ³¨å†Œä¸ä»»åŠ¡å®šä¹‰ï¼‰
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨é…ç½®&lt;/strong&gt;
åœ¨ &lt;code&gt;application.yml&lt;/code&gt; ä¸­é…ç½®æ‰§è¡Œå™¨ä¿¡æ¯ï¼Œç¡®ä¿ä¸è°ƒåº¦ä¸­å¿ƒé€šä¿¡ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;xxl:
job:
admin:
addresses: http://xxl-job-admin-host:port/xxl-job-admin # è°ƒåº¦ä¸­å¿ƒåœ°å€
executor:
appname: your-executor-app # æ‰§è¡Œå™¨å”¯ä¸€æ ‡è¯†
port: 9999 # æ‰§è¡Œå™¨ç«¯å£
accessToken: default_token # ä¸è°ƒåº¦ä¸­å¿ƒä¸€è‡´çš„Token
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰ä»»åŠ¡å¤„ç†å™¨&lt;/strong&gt;
ä½¿ç”¨ &lt;code&gt;@XxlJob&lt;/code&gt; æ³¨è§£å£°æ˜ä»»åŠ¡é€»è¾‘ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Component
public class TaskHandlers {
@XxlJob(&amp;#34;demoTask&amp;#34;)
public ReturnT&amp;lt;String&amp;gt; execute(String param) {
// ä¸šåŠ¡é€»è¾‘
return ReturnT.SUCCESS;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š&lt;code&gt;@XxlJob(&amp;quot;demoTask&amp;quot;)&lt;/code&gt; ä¸­çš„åç§°éœ€ä¸è°ƒåº¦ä¸­å¿ƒä»»åŠ¡é…ç½®çš„ &lt;strong&gt;JobHandler&lt;/strong&gt; ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€šè¿‡-api-æ¥å£å¿«é€Ÿæäº¤ä»»åŠ¡"&gt;âš¡ é€šè¿‡ API æ¥å£å¿«é€Ÿæäº¤ä»»åŠ¡
&lt;/h3&gt;&lt;p&gt;XXL-JOB è°ƒåº¦ä¸­å¿ƒæä¾› RESTful æ¥å£ï¼Œå¯é€šè¿‡ HTTP è¯·æ±‚è§¦å‘ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯å°è£…å·¥å…·ç±»ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;h4 id="ç™»å½•è®¤è¯è·å–-cookie"&gt;&lt;strong&gt;ç™»å½•è®¤è¯è·å– Cookie&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;public class XxlJobApiUtil {
private static final String LOGIN_URL = &amp;#34;http://xxl-job-admin-host:port/xxl-job-admin/login&amp;#34;;
private static final String COOKIE_NAME = &amp;#34;XXL_JOB_LOGIN_IDENTITY&amp;#34;;
public static String getAuthCookie() {
// å‘é€ç™»å½•è¯·æ±‚ï¼ˆç¤ºä¾‹ä½¿ç”¨ Hutool HTTP å·¥å…·ï¼‰
HttpResponse response = HttpRequest.post(LOGIN_URL)
.form(&amp;#34;userName&amp;#34;, &amp;#34;admin&amp;#34;)
.form(&amp;#34;password&amp;#34;, &amp;#34;123456&amp;#34;)
.execute();
return response.getCookie(COOKIE_NAME);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="è°ƒç”¨ä»»åŠ¡è§¦å‘æ¥å£"&gt;&lt;strong&gt;è°ƒç”¨ä»»åŠ¡è§¦å‘æ¥å£&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;public class XxlJobApiUtil {
// è§¦å‘ä»»åŠ¡æ‰§è¡Œï¼ˆæ”¯æŒå•æ¬¡è§¦å‘ï¼‰
public static boolean triggerJob(int jobId, String executorParam) {
String url = &amp;#34;http://xxl-job-admin-host:port/xxl-job-admin/jobinfo/trigger&amp;#34;;
String cookie = getAuthCookie();
HttpResponse response = HttpRequest.post(url)
.header(&amp;#34;Cookie&amp;#34;, COOKIE_NAME + &amp;#34;=&amp;#34; + cookie)
.form(&amp;#34;id&amp;#34;, jobId)
.form(&amp;#34;executorParam&amp;#34;, executorParam)
.execute();
return response.isOk() &amp;amp;&amp;amp; JSON.parseObject(response.body()).getInteger(&amp;#34;code&amp;#34;) == 200;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å‚æ•°è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;jobId&lt;/code&gt;ï¼šè°ƒåº¦ä¸­å¿ƒä»»åŠ¡ç®¡ç†é¡µé¢çš„ä»»åŠ¡IDï¼ˆæ–°å¢ä»»åŠ¡åè·å–ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;executorParam&lt;/code&gt;ï¼šä¼ é€’ç»™ä»»åŠ¡çš„å‚æ•°ï¼ˆå¯é€‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è°ƒåº¦ä¸­å¿ƒä»»åŠ¡æ¥å£è¯´æ˜"&gt;ğŸ“Š è°ƒåº¦ä¸­å¿ƒä»»åŠ¡æ¥å£è¯´æ˜
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¥å£ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;URL è·¯å¾„&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…³é”®å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç™»å½•è®¤è¯&lt;/td&gt;
&lt;td&gt;&lt;code&gt;/login&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–èº«ä»½éªŒè¯ Cookie&lt;/td&gt;
&lt;td&gt;&lt;code&gt;userName&lt;/code&gt;, &lt;code&gt;password&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è§¦å‘ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;/jobinfo/trigger&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç«‹å³æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;id&lt;/code&gt;ï¼ˆä»»åŠ¡IDï¼‰, &lt;code&gt;executorParam&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¯åŠ¨/åœæ­¢ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;/jobinfo/start&lt;/code&gt;, &lt;code&gt;/jobinfo/stop&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯åœä»»åŠ¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;id&lt;/code&gt;ï¼ˆä»»åŠ¡IDï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ–°å¢ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;/jobinfo/add&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€åˆ›å»ºä»»åŠ¡&lt;/td&gt;
&lt;td&gt;å®Œæ•´ä»»åŠ¡é…ç½®JSON&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åŠ¨æ€åˆ›å»ºä»»åŠ¡é«˜çº§åœºæ™¯"&gt;ğŸ›  åŠ¨æ€åˆ›å»ºä»»åŠ¡ï¼ˆé«˜çº§åœºæ™¯ï¼‰
&lt;/h3&gt;&lt;p&gt;è‹¥éœ€å®Œå…¨é€šè¿‡ä»£ç åŠ¨æ€æ³¨å†Œä»»åŠ¡ï¼Œå¯è°ƒç”¨è°ƒåº¦ä¸­å¿ƒçš„ &lt;code&gt;/jobinfo/add&lt;/code&gt; æ¥å£ï¼Œä¼ é€’ JSON æ ¼å¼çš„ä»»åŠ¡é…ç½®ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// ç¤ºä¾‹ï¼šåŠ¨æ€åˆ›å»ºæ¯åˆ†é’Ÿæ‰§è¡Œçš„ä»»åŠ¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;createDynamicJob&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;http://xxl-job-admin-host:port/xxl-job-admin/jobinfo/add&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;getAuthCookie&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;jobGroup&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ‰§è¡Œå™¨IDï¼ˆåœ¨è°ƒåº¦ä¸­å¿ƒæ‰§è¡Œå™¨ç®¡ç†é¡µé¢æŸ¥çœ‹ï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;jobDesc&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;åŠ¨æ€ä»»åŠ¡ç¤ºä¾‹&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;author&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;scheduleType&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;CRON&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;scheduleConf&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;0 * * * * ?&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Cron è¡¨è¾¾å¼&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;glueType&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;BEAN&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;executorHandler&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;demoTask&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ä¸@XxlJobåç§°ä¸€è‡´&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;executorParam&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;test_param&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HttpRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Cookie&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;COOKIE_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;=&amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;form&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jobConfig&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šåŠ¨æ€åˆ›å»ºéœ€æå‰åœ¨è°ƒåº¦ä¸­å¿ƒé…ç½®å¥½æ‰§è¡Œå™¨ï¼ˆ&lt;code&gt;jobGroup&lt;/code&gt; å¯¹åº”æ‰§è¡Œå™¨IDï¼‰ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–-1"&gt;âš ï¸ å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡è§¦å‘å¤±è´¥æ’æŸ¥&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;401 é”™è¯¯&lt;/strong&gt;ï¼šæ£€æŸ¥ &lt;code&gt;accessToken&lt;/code&gt; æ˜¯å¦ä¸è°ƒåº¦ä¸­å¿ƒä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;500 é”™è¯¯&lt;/strong&gt;ï¼šç¡®è®¤ä»»åŠ¡IDå­˜åœ¨ï¼Œä¸” &lt;code&gt;executorHandler&lt;/code&gt; åç§°æ— æ‹¼å†™é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œè¿é€šæ€§&lt;/strong&gt;ï¼šç¡®ä¿æ‰§è¡Œå™¨ä¸è°ƒåº¦ä¸­å¿ƒåŒå‘å¯è¾¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨ä¼˜åŒ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Token æ ¡éªŒ&lt;/strong&gt;ï¼šç”Ÿäº§ç¯å¢ƒåŠ¡å¿…é…ç½® &lt;code&gt;accessToken&lt;/code&gt; é˜²æ­¢æœªæˆæƒè®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™æ§åˆ¶&lt;/strong&gt;ï¼šé¿å…ç›´æ¥æš´éœ²è°ƒåº¦ä¸­å¿ƒæ¥å£ï¼Œå¯é€šè¿‡ç½‘å…³æˆ–ä¸­é—´å±‚ä»£ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Cookie ç¼“å­˜&lt;/strong&gt;ï¼šç™»å½• Cookie æœ‰æ•ˆæœŸè¾ƒé•¿ï¼ˆé»˜è®¤7å¤©ï¼‰ï¼Œå¯ç¼“å­˜å¤ç”¨é¿å…é¢‘ç¹ç™»å½•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥è§¦å‘&lt;/strong&gt;ï¼šå¯¹è€—æ—¶ä»»åŠ¡é‡‡ç”¨å¼‚æ­¥è§¦å‘ï¼Œé¿å… HTTP è¯·æ±‚é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç®€æ˜“ä»»åŠ¡è§¦å‘&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;XxlJobApiUtil.triggerJob(jobId, param)&lt;/code&gt; ç›´æ¥è§¦å‘ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ä»»åŠ¡ç®¡ç†&lt;/strong&gt;ï¼šè°ƒç”¨è°ƒåº¦ä¸­å¿ƒ REST API å®ç°ä»»åŠ¡å¢åˆ æ”¹æŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒé…ç½®è¦ç‚¹ï¼š
&lt;ol&gt;
&lt;li&gt;æ‰§è¡Œå™¨ &lt;code&gt;appname&lt;/code&gt; å’Œè°ƒåº¦ä¸­å¿ƒåœ°å€éœ€ä¸€è‡´ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;@XxlJob&lt;/code&gt; åç§°ä¸è°ƒåº¦ä¸­å¿ƒä»»åŠ¡é…ç½®çš„ &lt;code&gt;JobHandler&lt;/code&gt; å®Œå…¨åŒ¹é…ï¼›&lt;/li&gt;
&lt;li&gt;API è°ƒç”¨éœ€æºå¸¦æœ‰æ•ˆèº«ä»½ Cookieã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å·¥å…·ç±»å®Œæ•´ç¤ºä¾‹å¯å‚è€ƒ &lt;a class="link" href="https://blog.csdn.net/weixin_45626288/article/details/131561138" target="_blank" rel="noopener"
&gt;XXL-JOB åŠ¨æ€ä»»åŠ¡å·¥å…·ç±»&lt;/a&gt;ã€‚é€šè¿‡æ­¤æ–¹æ¡ˆï¼Œæ— éœ€ç™»å½•ç®¡ç†ç•Œé¢å³å¯é«˜æ•ˆé›†æˆä»»åŠ¡è°ƒåº¦èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="è´Ÿè½½å‡è¡¡"&gt;è´Ÿè½½å‡è¡¡
&lt;/h2&gt;&lt;p&gt;åœ¨åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼ˆå¦‚XXL-JOBï¼‰ä¸­ï¼Œå¤šä¸ªåŒåæ‰§è¡Œå™¨ï¼ˆå³åŒä¸€&lt;code&gt;appname&lt;/code&gt;çš„æ‰§è¡Œå™¨ï¼‰é€šè¿‡&lt;strong&gt;æ‰§è¡Œå™¨é›†ç¾¤&lt;/strong&gt;æœºåˆ¶å®ç°è´Ÿè½½å‡è¡¡ã€‚è°ƒåº¦ä¸­å¿ƒä¼šæ ¹æ®é¢„è®¾çš„è·¯ç”±ç­–ç•¥å°†ä»»åŠ¡åŠ¨æ€åˆ†é…ç»™é›†ç¾¤ä¸­çš„ä¸åŒèŠ‚ç‚¹ï¼Œç¡®ä¿ä»»åŠ¡å‡åŒ€åˆ†å‘å¹¶æå‡ç³»ç»Ÿååé‡å’Œå®¹é”™èƒ½åŠ›ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒå®ç°æœºåˆ¶åŠé…ç½®è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡Œå™¨é›†ç¾¤çš„æ³¨å†Œä¸å‘ç°"&gt;ğŸ”§ &lt;strong&gt;æ‰§è¡Œå™¨é›†ç¾¤çš„æ³¨å†Œä¸å‘ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤æ ‡è¯†&lt;/strong&gt;
å¤šä¸ªæ‰§è¡Œå™¨é…ç½®ç›¸åŒçš„&lt;code&gt;appname&lt;/code&gt;ï¼ˆå¦‚&lt;code&gt;order-service-executor&lt;/code&gt;ï¼‰ï¼Œå³è§†ä¸ºåŒä¸€é›†ç¾¤ã€‚å¯åŠ¨æ—¶ï¼Œæ¯ä¸ªæ‰§è¡Œå™¨è‡ªåŠ¨å‘è°ƒåº¦ä¸­å¿ƒæ³¨å†Œè‡ªèº«çš„IPã€ç«¯å£åŠä»»åŠ¡å¤„ç†å™¨åˆ—è¡¨ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;xxl:
job:
executor:
appname: order-service-executor # é›†ç¾¤å”¯ä¸€æ ‡è¯†
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿ƒè·³ç»´æŠ¤&lt;/strong&gt;
æ‰§è¡Œå™¨å®šæœŸï¼ˆé»˜è®¤30ç§’ï¼‰å‘è°ƒåº¦ä¸­å¿ƒå‘é€å¿ƒè·³ï¼Œæ›´æ–°å­˜æ´»çŠ¶æ€ã€‚è°ƒåº¦ä¸­å¿ƒé€šè¿‡å¿ƒè·³æ£€æµ‹å®æ—¶æ„ŸçŸ¥èŠ‚ç‚¹å¥åº·åº¦ï¼Œè‡ªåŠ¨å‰”é™¤æ•…éšœèŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä»»åŠ¡è·¯ç”±ç­–ç•¥è´Ÿè½½å‡è¡¡æ ¸å¿ƒ"&gt;âš™ï¸ &lt;strong&gt;ä»»åŠ¡è·¯ç”±ç­–ç•¥ï¼ˆè´Ÿè½½å‡è¡¡æ ¸å¿ƒï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è°ƒåº¦ä¸­å¿ƒæ”¯æŒå¤šç§è·¯ç”±ç­–ç•¥ï¼Œä»»åŠ¡è§¦å‘æ—¶æ ¹æ®ç­–ç•¥é€‰æ‹©ç›®æ ‡æ‰§è¡Œå™¨ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨ç­–ç•¥åŠé€‚ç”¨åœºæ™¯ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è·¯ç”±ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹ vs ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è½®è¯¢ï¼ˆRound Robinï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰èŠ‚ç‚¹æ³¨å†Œé¡ºåºä¾æ¬¡åˆ†é…ä»»åŠ¡ï¼Œå¾ªç¯å¾€å¤ã€‚&lt;/td&gt;
&lt;td&gt;å„èŠ‚ç‚¹æ€§èƒ½å‡è¡¡çš„æ— çŠ¶æ€ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;âœ… å®ç°ç®€å•ï¼›âŒ æ— æ³•æ„ŸçŸ¥èŠ‚ç‚¹å®æ—¶è´Ÿè½½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éšæœºï¼ˆRandomï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éšæœºé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹å¤„ç†ä»»åŠ¡ã€‚&lt;/td&gt;
&lt;td&gt;æµ‹è¯•ç¯å¢ƒæˆ–ä½å¹¶å‘åœºæ™¯&lt;/td&gt;
&lt;td&gt;âœ… ç®€å•å¿«é€Ÿï¼›âŒ å¯èƒ½é€ æˆè´Ÿè½½ä¸å‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹ä»»åŠ¡IDå“ˆå¸Œæ˜ å°„åˆ°2^32ç¯å½¢ç©ºé—´ï¼Œé¡ºæ—¶é’ˆé€‰æ‹©æœ€è¿‘èŠ‚ç‚¹ã€‚&lt;/td&gt;
&lt;td&gt;éœ€ä¼šè¯ä¿æŒçš„ä»»åŠ¡ï¼ˆå¦‚é¡ºåºä¾èµ–ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… èŠ‚ç‚¹å¢å‡å½±å“å°ï¼›âŒ å®ç°å¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ€å°‘è¿æ¥ï¼ˆLeast Connectionsï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©å½“å‰æ´»è·ƒä»»åŠ¡æ•°æœ€å°‘çš„èŠ‚ç‚¹ã€‚&lt;/td&gt;
&lt;td&gt;CPUå¯†é›†å‹æˆ–é•¿è€—æ—¶ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;âœ… åŠ¨æ€è´Ÿè½½å‡è¡¡ï¼›âŒ éœ€å®æ—¶ç›‘æ§èŠ‚ç‚¹çŠ¶æ€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•…éšœè½¬ç§»ï¼ˆFailoverï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¦–æ¬¡é€‰æ‹©é¦–ä¸ªèŠ‚ç‚¹ï¼Œå¤±è´¥åè‡ªåŠ¨åˆ‡æ¢è‡³ä¸‹ä¸€èŠ‚ç‚¹é‡è¯•ã€‚&lt;/td&gt;
&lt;td&gt;é«˜å¯é æ€§è¦æ±‚çš„ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;âœ… æé«˜æˆåŠŸç‡ï¼›âŒ é‡è¯•å¢åŠ å»¶è¿Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¿™ç¢Œè½¬ç§»ï¼ˆBusyOverï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼˜å…ˆé€‰æ‹©ç©ºé—²èŠ‚ç‚¹ï¼›è‹¥å‡å¿™ç¢Œï¼Œä»»åŠ¡è¿›å…¥é˜Ÿåˆ—ç­‰å¾…æˆ–ä¸¢å¼ƒã€‚&lt;/td&gt;
&lt;td&gt;çªå‘æµé‡æˆ–èµ„æºç´§å¼ åœºæ™¯&lt;/td&gt;
&lt;td&gt;âœ… é¿å…é›ªå´©ï¼›âŒ å¯èƒ½ä¸¢å¼ƒä»»åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;ç­–ç•¥é€‰æ‹©ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®¢å•è¶…æ—¶æ£€æŸ¥ï¼ˆæ— çŠ¶æ€ï¼‰â†’ &lt;strong&gt;è½®è¯¢&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;è´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆï¼ˆé•¿è€—æ—¶ï¼‰â†’ &lt;strong&gt;æœ€å°‘è¿æ¥&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æ”¯ä»˜å›è°ƒé€šçŸ¥ï¼ˆéœ€é¡ºåºï¼‰â†’ &lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é…ç½®ä¸ä¼˜åŒ–å®è·µ"&gt;ğŸ› ï¸ &lt;strong&gt;é…ç½®ä¸ä¼˜åŒ–å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è°ƒåº¦ä¸­å¿ƒé…ç½®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¯å¾„&lt;/strong&gt;ï¼šä»»åŠ¡ç®¡ç† â†’ æ–°å¢/ç¼–è¾‘ä»»åŠ¡ â†’ è·¯ç”±ç­–ç•¥&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;ï¼šä»ä¸‹æ‹‰æ¡†é€‰æ‹©ç­–ç•¥ï¼ˆå¦‚&lt;code&gt;CONSISTENT_HASH&lt;/code&gt;ï¼‰ã€‚
&lt;a class="link" href="https://example.com/xxl-job-route-config.png" target="_blank" rel="noopener"
&gt;https://example.com/xxl-job-route-config.png&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨çº¿ç¨‹æ± ä¼˜åŒ–&lt;/strong&gt;
é€šè¿‡è°ƒæ•´çº¿ç¨‹æ± å‚æ•°é¿å…å•èŠ‚ç‚¹è¿‡è½½ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;xxl:
job:
executor:
threadpool:
coreSize: 20 # æ ¸å¿ƒçº¿ç¨‹æ•°
maxSize: 200 # æœ€å¤§çº¿ç¨‹æ•°
queueSize: 1000 # ä»»åŠ¡é˜Ÿåˆ—å®¹é‡
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æƒé‡æ‰©å±•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå®šä¹‰ç­–ç•¥&lt;/strong&gt;ï¼šç»§æ‰¿&lt;code&gt;com.xxl.job.core.route.ExecutorRouter&lt;/code&gt;æ¥å£ï¼Œå®ç°æƒé‡é€»è¾‘ï¼ˆå¦‚æ ¹æ®CPU/å†…å­˜åŠ¨æ€è°ƒæ•´ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨å†Œ&lt;/strong&gt;ï¼šé€šè¿‡Springæ³¨å…¥è‡ªå®šä¹‰è·¯ç”±å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚å¸¸å¤„ç†ä¸é«˜å¯ç”¨"&gt;âš ï¸ &lt;strong&gt;å¼‚å¸¸å¤„ç†ä¸é«˜å¯ç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¿ƒè·³æ•…éšœè½¬ç§»&lt;/strong&gt;
è°ƒåº¦ä¸­å¿ƒæ£€æµ‹åˆ°èŠ‚ç‚¹å¤±è”ï¼ˆå¿ƒè·³è¶…æ—¶ï¼‰åï¼Œè‡ªåŠ¨å°†åç»­ä»»åŠ¡è·¯ç”±è‡³å…¶ä»–èŠ‚ç‚¹ï¼Œå¹¶è§¦å‘å‘Šè­¦ï¼ˆé‚®ä»¶/çŸ­ä¿¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡é‡è¯•æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¤±è´¥ä»»åŠ¡æŒ‰ç­–ç•¥é‡è¯•ï¼ˆå¦‚å›ºå®šé—´éš”ã€æŒ‡æ•°é€€é¿ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é‡è¯•æ¬¡æ•°è¶…é™åï¼Œä»»åŠ¡è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—äººå·¥å¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç‰‡å®¹é”™&lt;/strong&gt;
åˆ†ç‰‡ä»»åŠ¡ä¸­ï¼Œè‹¥æŸèŠ‚ç‚¹æ•…éšœï¼Œå‰©ä½™åˆ†ç‰‡ç”±å­˜æ´»èŠ‚ç‚¹æ¥ç®¡ï¼Œç¡®ä¿ä»»åŠ¡å®Œæ•´æ‰§è¡Œã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;@XxlJob(&amp;#34;shardingJob&amp;#34;)
public ReturnT&amp;lt;String&amp;gt; shardingJob(String param) {
int shardIndex = XxlJobHelper.getShardIndex(); // å½“å‰åˆ†ç‰‡ç´¢å¼•
int shardTotal = XxlJobHelper.getShardTotal(); // æ€»åˆ†ç‰‡æ•°
// ä¸šåŠ¡é€»è¾‘
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;ï¼šåŒåæ‰§è¡Œå™¨é›†ç¾¤ + åŠ¨æ€è·¯ç”±ç­–ç•¥ + å¿ƒè·³å¥åº·æ£€æµ‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­–ç•¥é€‰æ‹©&lt;/strong&gt;ï¼šæ ¹æ®ä¸šåŠ¡ç‰¹æ€§ï¼ˆçŠ¶æ€ä¾èµ–ã€è€—æ—¶ã€å¯é æ€§ï¼‰åŒ¹é…è·¯ç”±ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;ï¼šçº¿ç¨‹æ± è°ƒä¼˜ &amp;gt; è‡ªå®šä¹‰è·¯ç”± &amp;gt; åˆ†ç‰‡å®¹é”™ &amp;gt; é‡è¯•é€€é¿ã€‚
é€šè¿‡åˆç†é…ç½®è·¯ç”±ç­–ç•¥åŠå®¹é”™æœºåˆ¶ï¼ŒåŒåæ‰§è¡Œå™¨é›†ç¾¤å¯å®ç°è¿‘çº¿æ€§çš„æ°´å¹³æ‰©å±•èƒ½åŠ›ï¼Œæ”¯æ’‘ç™¾ä¸‡çº§ä»»åŠ¡è°ƒåº¦ã€‚å®é™…éƒ¨ç½²ä¸­ï¼Œå»ºè®®ç»“åˆç›‘æ§æ—¥å¿—ï¼ˆå¦‚Prometheus + Grafanaï¼‰å®æ—¶è§‚æµ‹èŠ‚ç‚¹è´Ÿè½½ï¼ŒåŠ¨æ€è°ƒæ•´ç­–ç•¥ä»¥åº”å¯¹æµé‡æ³¢åŠ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="è°ƒåº¦ç®—æ³•"&gt;è°ƒåº¦ç®—æ³•
&lt;/h2&gt;&lt;p&gt;XXL-JOBçš„è°ƒåº¦ç®—æ³•æ˜¯å…¶åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦èƒ½åŠ›çš„æ ¸å¿ƒï¼Œä¸»è¦åŒ…æ‹¬&lt;strong&gt;ä»»åŠ¡è§¦å‘æœºåˆ¶&lt;/strong&gt;ã€&lt;strong&gt;æ‰§è¡Œå™¨è·¯ç”±ç­–ç•¥&lt;/strong&gt;å’Œ&lt;strong&gt;åˆ†ç‰‡ä»»åŠ¡å¤„ç†&lt;/strong&gt;ä¸‰å¤§éƒ¨åˆ†ã€‚ä»¥ä¸‹ä»åŸç†ã€å®ç°åŠä¼˜åŒ–è§’åº¦è¿›è¡Œè¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä»»åŠ¡è§¦å‘æœºåˆ¶ç±»æ—¶é—´è½®æ¨¡å‹"&gt;â±ï¸ &lt;strong&gt;ä»»åŠ¡è§¦å‘æœºåˆ¶ï¼šç±»æ—¶é—´è½®æ¨¡å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;XXL-JOBçš„è°ƒåº¦ä¸­å¿ƒé€šè¿‡&lt;strong&gt;é¢„è¯»æ‰«æ + æ—¶é—´è½®é˜Ÿåˆ—&lt;/strong&gt;å®ç°é«˜æ•ˆä»»åŠ¡è§¦å‘ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è°ƒåº¦çº¿ç¨‹ï¼ˆScheduleThreadï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯5ç§’æ‰«ææ•°æ®åº“ï¼ˆ&lt;code&gt;xxl_job_info&lt;/code&gt;è¡¨ï¼‰ï¼Œé¢„è¯»æœªæ¥5ç§’å†…éœ€æ‰§è¡Œçš„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®ä»»åŠ¡çš„ä¸‹æ¬¡è§¦å‘æ—¶é—´åˆ’åˆ†ä¸ºä¸‰ç±»ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·²è¿‡æœŸ &amp;gt;5s&lt;/strong&gt;ï¼šæ ¹æ®é…ç½®é€‰æ‹©â€œå¿½ç•¥â€æˆ–â€œç«‹å³æ‰§è¡Œâ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿‡æœŸ â‰¤5s&lt;/strong&gt;ï¼šç«‹å³æ‰§è¡Œï¼Œå¹¶æ”¾å…¥æ—¶é—´è½®ç­‰å¾…ä¸‹æ¬¡è§¦å‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªåˆ°æœŸä½†5så†…è§¦å‘&lt;/strong&gt;ï¼šç›´æ¥æ”¾å…¥æ—¶é—´è½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ›´æ–°ä»»åŠ¡çš„ä¸‹æ¬¡è§¦å‘æ—¶é—´ï¼Œé¿å…é‡å¤è°ƒåº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´è½®çº¿ç¨‹ï¼ˆRingThreadï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ—¶é—´è½®ä¸ºç¯å½¢ç»“æ„ï¼ŒåŒ…å«60ä¸ªæ¡¶ï¼ˆæ¯æ¡¶ä»£è¡¨1ç§’ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ç§’ä»å½“å‰æ¡¶å’Œå‰ä¸€ä¸ªæ¡¶ä¸­å–å‡ºä»»åŠ¡ï¼Œäº¤ç»™&lt;strong&gt;å¿«æ…¢çº¿ç¨‹æ± &lt;/strong&gt;å¼‚æ­¥è§¦å‘ã€‚&lt;/li&gt;
&lt;li&gt;å¿«æ…¢çº¿ç¨‹æ± åˆ†ç¦»ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;ä»»åŠ¡è§¦å‘è€—æ—¶ &amp;gt;500ms æ—¶æ ‡è®°ä¸ºâ€œæ…¢ä»»åŠ¡â€ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥1åˆ†é’Ÿå†…æ…¢ä»»åŠ¡è§¦å‘è¶…10æ¬¡ï¼Œåç»­è§¦å‘ç§»äº¤æ…¢çº¿ç¨‹æ± ï¼Œé¿å…é˜»å¡å¸¸è§„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼ä¸€è‡´æ€§ä¿éšœ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒåº¦ä¸­å¿ƒé›†ç¾¤é€šè¿‡æ•°æ®åº“é”å®ç°åˆ†å¸ƒå¼åè°ƒï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM xxl_job_lock WHERE lock_name = &amp;#39;schedule_lock&amp;#39; FOR UPDATE
&lt;/code&gt;&lt;/pre&gt;ä»…æŒæœ‰é”çš„å®ä¾‹å¯æ‰§è¡Œè°ƒåº¦ï¼Œé¿å…é‡å¤è§¦å‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡Œå™¨è·¯ç”±ç­–ç•¥"&gt;ğŸ”€ &lt;strong&gt;æ‰§è¡Œå™¨è·¯ç”±ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è°ƒåº¦ä¸­å¿ƒæ ¹æ®é…ç½®çš„è·¯ç”±ç­–ç•¥é€‰æ‹©æ‰§è¡Œå™¨å®ä¾‹ï¼Œæ ¸å¿ƒç®—æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è·¯ç”±ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç®—æ³•åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†ç‰‡å¹¿æ’­&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‘æ‰€æœ‰æ‰§è¡Œå™¨å®ä¾‹å¹¿æ’­ä»»åŠ¡ï¼Œæ¯ä¸ªå®ä¾‹é€šè¿‡åˆ†ç‰‡å‚æ•°ï¼ˆ&lt;code&gt;shardIndex/shardTotal&lt;/code&gt;ï¼‰å¤„ç†ä¸åŒæ•°æ®&lt;/td&gt;
&lt;td&gt;å¤§æ•°æ®å¹¶è¡Œå¤„ç†ï¼ˆå¦‚åˆ†åº“åˆ†è¡¨æŸ¥è¯¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹&lt;code&gt;jobId&lt;/code&gt;åšMD5å“ˆå¸Œç”Ÿæˆ32ä½å€¼ï¼Œæ˜ å°„åˆ°è™šæ‹ŸèŠ‚ç‚¹ç¯ï¼Œä¿è¯ç›¸åŒä»»åŠ¡å§‹ç»ˆè·¯ç”±åˆ°åŒä¸€æ‰§è¡Œå™¨&lt;/td&gt;
&lt;td&gt;éœ€ä»»åŠ¡ä¸æ‰§è¡Œå™¨ç»‘å®šçš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•…éšœè½¬ç§»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰é¡ºåºæ£€æµ‹æ‰§è¡Œå™¨å¿ƒè·³ï¼Œé€‰æ‹©é¦–ä¸ªå­˜æ´»èŠ‚ç‚¹&lt;/td&gt;
&lt;td&gt;é«˜å¯ç”¨è¦æ±‚åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¿™ç¢Œè½¬ç§»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ£€æµ‹æ‰§è¡Œå™¨è´Ÿè½½ï¼Œé€‰æ‹©ç©ºé—²èŠ‚ç‚¹æ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;é¿å…æ‰§è¡Œå™¨è¿‡è½½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è½®è¯¢/éšæœº/é¦–å°¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‡åŒ€åˆ†é…æˆ–éšæœºé€‰æ‹©èŠ‚ç‚¹&lt;/td&gt;
&lt;td&gt;ç®€å•è´Ÿè½½å‡è¡¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ†ç‰‡å¹¿æ’­ä»»åŠ¡éœ€å¼€å‘è€…åœ¨ä»£ç ä¸­æ˜¾å¼å¤„ç†åˆ†ç‰‡é€»è¾‘ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM table WHERE MOD(id, #{shardTotal}) = #{shardIndex}
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†ç‰‡ä»»åŠ¡çš„é«˜çº§æ§åˆ¶"&gt;âš™ï¸ &lt;strong&gt;åˆ†ç‰‡ä»»åŠ¡çš„é«˜çº§æ§åˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åˆ†ç‰‡ä»»åŠ¡æ”¯æŒåŠ¨æ€è°ƒæ•´å¹¶å‘åº¦ï¼Œå¸¸è§æ–¹æ¡ˆå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»æ§åˆ¶å¹¶è¡ŒèŠ‚ç‚¹æ•°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä»»åŠ¡å‚æ•°ä¼ å…¥&lt;code&gt;executeNodeNum&lt;/code&gt;ï¼ˆå®é™…éœ€æ‰§è¡Œçš„èŠ‚ç‚¹æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œå™¨æ¯”è¾ƒåˆ†ç‰‡åºå·
&lt;pre tabindex="0"&gt;&lt;code&gt;shardIndex
&lt;/code&gt;&lt;/pre&gt;ä¸
&lt;pre tabindex="0"&gt;&lt;code&gt;executeNodeNum
&lt;/code&gt;&lt;/pre&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;if (shardIndex &amp;gt; (executeNodeNum - 1)) {
return; // è·³è¿‡æ‰§è¡Œ
}
shardTotal = executeNodeNum; // é‡ç½®æ€»åˆ†ç‰‡æ•°
&lt;/code&gt;&lt;/pre&gt;å®ç°åŠ¨æ€ç¼©/æ‰©å®¹å¹¶è¡ŒèŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æå‡å•èŠ‚ç‚¹å¹¶å‘èƒ½åŠ›&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ1&lt;/strong&gt;ï¼šä»»åŠ¡å†…å†åˆ†ç‰‡ï¼Œç»“åˆçº¿ç¨‹æ± å¹¶è¡Œå¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;æ–¹æ¡ˆ2ï¼šé…ç½®å¤šä¸ªç›¸åŒJobHandlerçš„ä»»åŠ¡ï¼Œä¼ å…¥ç¼–å·
&lt;pre tabindex="0"&gt;&lt;code&gt;M
&lt;/code&gt;&lt;/pre&gt;ï¼Œé‡æ–°è®¡ç®—åˆ†ç‰‡å‚æ•°ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;newShardIndex = (åŸåˆ†ç‰‡åºå· * M) + ä»»åŠ¡ç¼–å·;
newShardTotal = åŸæ€»åˆ†ç‰‡æ•° * M;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–è®¾è®¡"&gt;âš¡ï¸ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–è®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å¼‚æ­¥è§¦å‘æœºåˆ¶&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒåº¦çº¿ç¨‹ä»…è´Ÿè´£ä»»åŠ¡è®¡ç®—ï¼ŒHTTPè¯·æ±‚è°ƒç”¨æ‰§è¡Œå™¨ç”±çº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œï¼Œé¿å…é˜»å¡è°ƒåº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å¢é‡æ³¨å†Œä¸å¿ƒè·³&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œå™¨å¯åŠ¨æ—¶æ³¨å†ŒIPå’Œç«¯å£è‡³è°ƒåº¦ä¸­å¿ƒï¼Œåç»­æ¯30ç§’ä¸ŠæŠ¥å¿ƒè·³ï¼Œç»´æŠ¤å¯ç”¨èŠ‚ç‚¹åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;æ—¥å¿—ä¸å›è°ƒåˆ†ç¦»&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä»»åŠ¡æ‰§è¡Œç»“æœé€šè¿‡ç‹¬ç«‹å›è°ƒçº¿ç¨‹å¼‚æ­¥é€šçŸ¥è°ƒåº¦ä¸­å¿ƒï¼Œå‡å°‘ä¸»æµç¨‹å»¶è¿Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;XXL-JOBçš„è°ƒåº¦ç®—æ³•é€šè¿‡ &lt;strong&gt;â€œé¢„è¯»+æ—¶é—´è½®â€è§¦å‘&lt;/strong&gt;ã€&lt;strong&gt;å¤šæ ·åŒ–è·¯ç”±ç­–ç•¥&lt;/strong&gt;åŠ&lt;strong&gt;åŠ¨æ€åˆ†ç‰‡æ§åˆ¶&lt;/strong&gt;ï¼Œå®ç°äº†é«˜ååã€ä½å»¶è¿Ÿçš„åˆ†å¸ƒå¼è°ƒåº¦èƒ½åŠ›ã€‚å…¶è®¾è®¡äº®ç‚¹åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡çº§åˆ†å¸ƒå¼é”&lt;/strong&gt;ï¼šåŸºäºæ•°æ®åº“é”æ›¿ä»£å¤æ‚ä¸­é—´ä»¶ï¼Œé™ä½éƒ¨ç½²æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼¹æ€§åˆ†ç‰‡&lt;/strong&gt;ï¼šæ”¯æŒè¿è¡Œæ—¶è°ƒæ•´å¹¶è¡Œåº¦ï¼Œé€‚é…ä¸šåŠ¡æ³¢åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœè‡ªæ²»&lt;/strong&gt;ï¼šå¿™ç¢Œè½¬ç§»ã€æ•…éšœè½¬ç§»ç­‰ç­–ç•¥ä¿éšœä»»åŠ¡é«˜å¯ç”¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…åº”ç”¨ä¸­ï¼Œå»ºè®®ç»“åˆ&lt;strong&gt;åˆ†ç‰‡å¹¿æ’­+åŠ¨æ€å‚æ•°&lt;/strong&gt;å¤„ç†å¤§æ•°æ®ä»»åŠ¡ï¼Œå¹¶é€šè¿‡&lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/strong&gt;ç»‘å®šæœ‰çŠ¶æ€ä»»åŠ¡ï¼Œä»¥æœ€å¤§åŒ–åˆ©ç”¨è°ƒåº¦èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¿«æ…¢çº¿ç¨‹æ± "&gt;å¿«æ…¢çº¿ç¨‹æ± 
&lt;/h2&gt;&lt;p&gt;å¿«æ…¢çº¿ç¨‹æ± å¼‚æ­¥è§¦å‘æ˜¯ä¸€ç§åœ¨åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼ˆå¦‚XXL-JOBï¼‰ä¸­ç”¨äº&lt;strong&gt;ä¼˜åŒ–ä»»åŠ¡æ‰§è¡Œæ€§èƒ½ä¸ç³»ç»Ÿç¨³å®šæ€§&lt;/strong&gt;çš„è®¾è®¡æ¨¡å¼ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡åŒºåˆ†ä»»åŠ¡çš„æ‰§è¡Œè€—æ—¶ç‰¹æ€§ï¼Œå°†ä»»åŠ¡åŠ¨æ€åˆ†é…åˆ°ä¸åŒçš„çº¿ç¨‹æ± ä¸­å¤„ç†ï¼Œé¿å…é•¿è€—æ—¶ä»»åŠ¡é˜»å¡çŸ­è€—æ—¶ä»»åŠ¡ï¼Œä»è€Œæå‡æ•´ä½“è°ƒåº¦ååé‡å’Œå“åº”é€Ÿåº¦ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ± åˆ†ç±»&lt;/strong&gt;
XXL-JOB è°ƒåº¦ä¸­å¿ƒå†…éƒ¨ç»´æŠ¤ä¸¤ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æ± ï¼š
&lt;ul&gt;
&lt;li&gt;å¿«çº¿ç¨‹æ± ï¼ˆFast Trigger Poolï¼‰
å¤„ç†çŸ­è€—æ—¶ä»»åŠ¡ï¼ˆé»˜è®¤é˜ˆå€¼ â‰¤500msï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;ï¼šé»˜è®¤æ ¸å¿ƒçº¿ç¨‹æ•°10ï¼Œæœ€å¤§çº¿ç¨‹æ•°â‰¥200ï¼Œé˜Ÿåˆ—å®¹é‡1000ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ…¢çº¿ç¨‹æ± ï¼ˆSlow Trigger Poolï¼‰
å¤„ç†é•¿è€—æ—¶æˆ–é¢‘ç¹è¶…æ—¶çš„ä»»åŠ¡ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;ï¼šé»˜è®¤æ ¸å¿ƒçº¿ç¨‹æ•°10ï¼Œæœ€å¤§çº¿ç¨‹æ•°â‰¥100ï¼Œé˜Ÿåˆ—å®¹é‡2000ï¼ˆæ›´å¤§é˜Ÿåˆ—é¿å…ä»»åŠ¡ä¸¢å¼ƒï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€é™çº§è§„åˆ™&lt;/strong&gt;
ä»»åŠ¡åˆ†é…ç­–ç•¥åŸºäºå†å²æ‰§è¡Œè€—æ—¶åŠ¨æ€è°ƒæ•´ï¼š
&lt;ul&gt;
&lt;li&gt;ä»»åŠ¡è§¦å‘åï¼Œè‹¥æ‰§è¡Œè€—æ—¶ &amp;gt;500msï¼Œè®°å½•è¯¥ä»»åŠ¡IDçš„è¶…æ—¶æ¬¡æ•°ï¼ˆé€šè¿‡ &lt;code&gt;jobTimeoutCountMap&lt;/code&gt; ç»Ÿè®¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™çº§æ¡ä»¶&lt;/strong&gt;ï¼šè‹¥æŸä»»åŠ¡åœ¨ &lt;strong&gt;1åˆ†é’Ÿå†…è¶…æ—¶æ¬¡æ•° â‰¥10æ¬¡&lt;/strong&gt;ï¼Œåç»­è§¦å‘è‡ªåŠ¨ä»å¿«çº¿ç¨‹æ± é™çº§è‡³æ…¢çº¿ç¨‹æ± å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®šæœŸé‡ç½®&lt;/strong&gt;ï¼šæ¯å°æ—¶æ¸…ç©ºè¶…æ—¶è®¡æ•°ï¼Œé¿å…æ…¢ä»»åŠ¡æ°¸ä¹…é™çº§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹"&gt;ğŸ”„ &lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡æäº¤&lt;/strong&gt;
è°ƒåº¦ä¸­å¿ƒæ¥æ”¶åˆ°ä»»åŠ¡è§¦å‘è¯·æ±‚ï¼ˆå¦‚å®šæ—¶è§¦å‘ã€æ‰‹åŠ¨æ‰§è¡Œï¼‰åï¼š
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆå°è¯•æäº¤è‡³å¿«çº¿ç¨‹æ± ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ä»»åŠ¡æ»¡è¶³é™çº§æ¡ä»¶ï¼ˆå†å²è¶…æ—¶é¢‘ç¹ï¼‰ï¼Œåˆ™æäº¤è‡³æ…¢çº¿ç¨‹æ± ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥æ‰§è¡Œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ± è°ƒç”¨ &lt;code&gt;XxlJobTrigger.trigger()&lt;/code&gt; æ–¹æ³•ï¼Œ&lt;strong&gt;å¼‚æ­¥&lt;/strong&gt;å‘æ‰§è¡Œå™¨å‘é€HTTPè°ƒåº¦è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒåº¦ä¸­å¿ƒä¸ç­‰å¾…æ‰§è¡Œç»“æœï¼Œé€šè¿‡è§£è€¦è§¦å‘ä¸æ‰§è¡Œè¿‡ç¨‹æ”¯æŒé«˜å¹¶å‘ä»»åŠ¡è°ƒåº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºéš”ç¦»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¿«çº¿ç¨‹æ± &lt;/strong&gt;ï¼šä¿éšœé«˜é¢‘çŸ­ä»»åŠ¡çš„ä½å»¶è¿Ÿï¼ˆå¦‚å®æ—¶æ€§è¦æ±‚é«˜çš„çŠ¶æ€æ£€æŸ¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ…¢çº¿ç¨‹æ± &lt;/strong&gt;ï¼šéš”ç¦»é•¿è€—æ—¶ä»»åŠ¡ï¼ˆå¦‚æŠ¥è¡¨ç”Ÿæˆã€å¤§æ•°æ®å¤„ç†ï¼‰ï¼Œé¿å…å…¶é˜»å¡ç³»ç»Ÿæ ¸å¿ƒè°ƒåº¦èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡ä¼˜åŠ¿"&gt;ğŸ’¡ &lt;strong&gt;è®¾è®¡ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æå‡ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿«ä»»åŠ¡ä¸è¢«æ…¢ä»»åŠ¡æ‹–ç´¯ï¼Œçº¿ç¨‹èµ„æºé«˜æ•ˆå¤ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‡å°‘å»¶è¿Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çŸ­ä»»åŠ¡æ— éœ€æ’é˜Ÿç­‰å¾…é•¿ä»»åŠ¡é‡Šæ”¾çº¿ç¨‹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é˜²æ­¢é›ªå´©&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ…¢ä»»åŠ¡å †ç§¯æ—¶ï¼Œå¿«ä»»åŠ¡ä»å¯æ­£å¸¸æ‰§è¡Œï¼Œé¿å…çº§è”æ•…éšœã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ¨æ€è‡ªé€‚åº”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— éœ€äººå·¥æ ‡æ³¨ä»»åŠ¡ç±»å‹ï¼Œç³»ç»Ÿè‡ªåŠ¨æ ¹æ®å†å²è¡¨ç°åˆ†ç±»ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°çµæ´»è°ƒä¼˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒæ ¹æ®ä¸šåŠ¡è´Ÿè½½è°ƒæ•´çº¿ç¨‹æ± å¤§å°ï¼ˆå¦‚IOå¯†é›†å‹ä»»åŠ¡å¯æ‰©å¤§æ…¢çº¿ç¨‹æ± é˜Ÿåˆ—ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é…ç½®ä¸ä¼˜åŒ–å»ºè®®"&gt;âš ï¸ &lt;strong&gt;é…ç½®ä¸ä¼˜åŒ–å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°è°ƒæ•´&lt;/strong&gt;
åœ¨ &lt;code&gt;xxl-job-admin&lt;/code&gt; é…ç½®æ–‡ä»¶ä¸­åŠ¨æ€è®¾ç½®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;# è°ƒåº¦ä¸­å¿ƒé…ç½®
xxl.job.triggerpool.fast.max=200 # å¿«çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°
xxl.job.triggerpool.slow.max=100 # æ…¢çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°
&lt;/code&gt;&lt;/pre&gt;ç”Ÿäº§ç¯å¢ƒä¸­éœ€æ ¹æ®ä»»åŠ¡å¹³å‡è€—æ—¶ç›‘æ§åŠ¨æ€è°ƒæ•´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡ç±»å‹é€‚é…&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CPUå¯†é›†å‹ä»»åŠ¡&lt;/strong&gt;ï¼šå¢å¤§å¿«çº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;IOå¯†é›†å‹ä»»åŠ¡&lt;/strong&gt;ï¼šæ‰©å¤§æ…¢çº¿ç¨‹æ± é˜Ÿåˆ—å®¹é‡ï¼Œé¿å…ä»»åŠ¡å †ç§¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å‘Šè­¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ—¥å¿—å…³æ³¨ &lt;code&gt;jobTimeoutCountMap&lt;/code&gt; ä¸­é«˜é¢‘è¶…æ—¶çš„ä»»åŠ¡ï¼Œä¼˜åŒ–å…¶é€»è¾‘æˆ–æ‹†åˆ†å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;æ…¢çº¿ç¨‹æ± é˜Ÿåˆ—æ»¡è½½æ—¶éœ€æ‰©å®¹æˆ–ä¼˜åŒ–ä»»åŠ¡åˆ†ç‰‡ç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å¿«æ…¢çº¿ç¨‹æ± å¼‚æ­¥è§¦å‘é€šè¿‡ &lt;strong&gt;èµ„æºåˆ†çº§ç®¡æ§&lt;/strong&gt; å’Œ &lt;strong&gt;åŠ¨æ€é™çº§æœºåˆ¶&lt;/strong&gt;ï¼Œè§£å†³äº†æ··åˆä»»åŠ¡åœºæ™¯ä¸‹çš„æ€§èƒ½ç“¶é¢ˆé—®é¢˜ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥åŒ–&lt;/strong&gt;ï¼šä»»åŠ¡è§¦å‘ä¸æ‰§è¡Œè§£è€¦ï¼Œé¿å…è°ƒåº¦çº¿ç¨‹é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™ºèƒ½åŒ–&lt;/strong&gt;ï¼šåŸºäºå†å²è€—æ—¶åŠ¨æ€åˆ†ç±»ä»»åŠ¡ï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;ï¼šä¿éšœé«˜é¢‘çŸ­ä»»åŠ¡çš„ä½å»¶è¿Ÿï¼ŒåŒæ—¶å®¹çº³é•¿è€—æ—¶ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…åº”ç”¨ä¸­ï¼Œè¯¥è®¾è®¡å¯æ”¯æ’‘å•æœº &lt;strong&gt;5000+ä»»åŠ¡/ç§’&lt;/strong&gt; çš„è§¦å‘é‡ï¼ˆå¦‚ç¤¾åŒºæ¡ˆä¾‹ï¼š10èŠ‚ç‚¹æ‰§è¡Œå™¨å¤„ç†2W+ä»»åŠ¡/å°æ—¶ï¼‰ï¼Œä½†éœ€ç»“åˆæ•°æ®åº“ä¼˜åŒ–ï¼ˆå¦‚æ—¥å¿—åˆ†è¡¨ï¼‰é¿å…å†™å…¥ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ä»»åŠ¡æ­£ç¡®æ‰§è¡Œ"&gt;ä»»åŠ¡æ­£ç¡®æ‰§è¡Œ
&lt;/h2&gt;&lt;p&gt;XXL-JOB åœ¨å¼‚æ­¥è§¦å‘ä»»åŠ¡æ—¶ï¼Œé€šè¿‡&lt;strong&gt;å¤šå±‚æ¬¡ååŒæœºåˆ¶&lt;/strong&gt;ç¡®ä¿ä»»åŠ¡æ­£ç¡®æ‰§è¡Œï¼ˆå®Œæˆä¸”ä¸é‡å¤ï¼‰ï¼Œæ¶µç›–è°ƒåº¦ä¸­å¿ƒã€æ‰§è¡Œå™¨ã€ä¸šåŠ¡é€»è¾‘ä¸‰ä¸ªå±‚çº§çš„è®¾è®¡ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒä¿éšœæœºåˆ¶åŠå®ç°åŸç†ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è°ƒåº¦ä¸­å¿ƒå±‚é˜²é‡è°ƒåº¦ä¸åˆ†å¸ƒå¼åè°ƒ"&gt;âš™ï¸ &lt;strong&gt;è°ƒåº¦ä¸­å¿ƒå±‚ï¼šé˜²é‡è°ƒåº¦ä¸åˆ†å¸ƒå¼åè°ƒ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“è¡Œé”é˜²å¹¶å‘è°ƒåº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒåº¦ä¸­å¿ƒé›†ç¾¤é€šè¿‡æ•°æ®åº“è¡Œé”ï¼ˆ
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT ... FOR UPDATE
&lt;/code&gt;&lt;/pre&gt;ï¼‰ä¿è¯åŒä¸€ä»»åŠ¡ä»…è¢«ä¸€ä¸ªå®ä¾‹è°ƒåº¦ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SELECT * FROM xxl_job_lock WHERE lock_name = &amp;#39;schedule_lock&amp;#39; FOR UPDATE
&lt;/code&gt;&lt;/pre&gt;åªæœ‰æŒæœ‰é”çš„è°ƒåº¦ä¸­å¿ƒå®ä¾‹å¯è§¦å‘ä»»åŠ¡ï¼Œé¿å…é›†ç¾¤ç¯å¢ƒä¸‹é‡å¤è°ƒåº¦ã€‚&lt;/li&gt;
&lt;li&gt;è§¦å‘æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;è°ƒåº¦çº¿ç¨‹é¢„è¯»æœªæ¥5ç§’ä»»åŠ¡ â†’ è·å–é” â†’ è§¦å‘ä»»åŠ¡ â†’ é‡Šæ”¾é” â†’ æ›´æ–°ä»»åŠ¡ä¸‹æ¬¡è§¦å‘æ—¶é—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡çŠ¶æ€æœºç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»»åŠ¡è§¦å‘åï¼ŒçŠ¶æ€æ ‡è®°ä¸ºâ€œæ‰§è¡Œä¸­â€ï¼Œè°ƒåº¦ä¸­å¿ƒæ”¶åˆ°æ‰§è¡Œå™¨å›è°ƒå‰ä¸ä¼šå†æ¬¡è§¦å‘åŒä¸€ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;å¤±è´¥é‡è¯•æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥æ‰§è¡Œå™¨æœªå“åº”æˆ–æ‰§è¡Œå¤±è´¥ï¼Œæ ¹æ®é…ç½®çš„é‡è¯•æ¬¡æ•°ï¼ˆ&lt;code&gt;executor_fail_retry_count&lt;/code&gt;ï¼‰è‡ªåŠ¨é‡è¯•ï¼Œé¿å…ä»»åŠ¡ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡Œå™¨å±‚ä»»åŠ¡éš”ç¦»ä¸å¹‚ç­‰æ§åˆ¶"&gt;âš¡ï¸ &lt;strong&gt;æ‰§è¡Œå™¨å±‚ï¼šä»»åŠ¡éš”ç¦»ä¸å¹‚ç­‰æ§åˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å•æœºä»»åŠ¡é˜²å¹¶å‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡
é˜»å¡å¤„ç†ç­–ç•¥
æ§åˆ¶åŒä¸€ä»»åŠ¡åœ¨å•æ‰§è¡Œå™¨å®ä¾‹ä¸Šçš„å¹¶å‘ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œä¸º&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;SERIAL_EXECUTION&lt;/code&gt;ï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
&lt;td&gt;ä»»åŠ¡è¿›å…¥é˜Ÿåˆ—ä¸²è¡Œæ‰§è¡Œï¼Œæ–°ä»»åŠ¡æ’é˜Ÿç­‰å¾…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DISCARD_LATER&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸¢å¼ƒæ–°ä»»åŠ¡ï¼Œæ ‡è®°ä¸ºå¤±è´¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;COVER_EARLY&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç»ˆæ­¢å½“å‰ä»»åŠ¡ï¼Œç«‹å³æ‰§è¡Œæ–°ä»»åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;ä¾‹å¦‚ï¼šè€—æ—¶ä»»åŠ¡é…ç½®&lt;code&gt;COVER_EARLY&lt;/code&gt;å¯é¿å…å †ç§¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†ç‰‡å¹¿æ’­ä»»åŠ¡é˜²é‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†ç‰‡ä»»åŠ¡é€šè¿‡å‚æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; shardIndex/shardTotal
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åˆ’åˆ†æ•°æ®èŒƒå›´ï¼š
&lt;code&gt;int shardIndex = XxlJobHelper.getShardIndex(); // å½“å‰åˆ†ç‰‡åºå· int shardTotal = XxlJobHelper.getShardTotal(); // æ€»åˆ†ç‰‡æ•°&lt;/code&gt;
æ¯ä¸ªæ‰§è¡Œå™¨å®ä¾‹ä»…å¤„ç†æŒ‡å®šåˆ†ç‰‡çš„æ•°æ®ï¼Œå¤©ç„¶é¿å…é‡å¤ã€‚
3. &lt;strong&gt;çº¿ç¨‹æ± éš”ç¦»ä¸è¶…æ—¶æ§åˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œå™¨ä¸ºæ¯ä¸ªä»»åŠ¡åˆ›å»ºç‹¬ç«‹çº¿ç¨‹ï¼ˆ&lt;code&gt;JobThread&lt;/code&gt;ï¼‰ï¼Œé€šè¿‡ &lt;code&gt;Future.get(timeout)&lt;/code&gt; æ§åˆ¶å•ä»»åŠ¡è¶…æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;è¶…æ—¶ä»»åŠ¡è‡ªåŠ¨ä¸­æ–­ï¼Œé˜²æ­¢çº¿ç¨‹é˜»å¡å¯¼è‡´åç»­ä»»åŠ¡ç§¯å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸šåŠ¡å±‚å¹‚ç­‰æ€§ä¸æœ€ç»ˆä¸€è‡´æ€§"&gt;ğŸ›¡ï¸ &lt;strong&gt;ä¸šåŠ¡å±‚ï¼šå¹‚ç­‰æ€§ä¸æœ€ç»ˆä¸€è‡´æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¹‚ç­‰è®¾è®¡å…œåº•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å³ä½¿è°ƒåº¦æˆ–æ‰§è¡Œå±‚é˜²é‡å¤±æ•ˆï¼Œä¸šåŠ¡é€»è¾‘éœ€ä¿è¯å¹‚ç­‰æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“å”¯ä¸€çº¦æŸ&lt;/strong&gt;ï¼šå¦‚è®¢å•å·å”¯ä¸€ç´¢å¼•ï¼Œé‡å¤æ’å…¥ç›´æ¥æŠ¥é”™ã€‚&lt;/li&gt;
&lt;li&gt;ä¹è§‚é”ï¼šæ›´æ–°æ•°æ®æ—¶æ ¡éªŒç‰ˆæœ¬å·ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;UPDATE table SET status=1 WHERE id=#{id} AND version=#{version}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;åˆ†å¸ƒå¼é”ï¼šä»»åŠ¡æ‰§è¡Œå‰è·å–Redisé”ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;String lockKey = &amp;#34;job_lock:&amp;#34; + jobId;
if (redis.setIfAbsent(lockKey, &amp;#34;1&amp;#34;, 30, SECONDS)) {
// æ‰§è¡Œä¸šåŠ¡é€»è¾‘
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—è¿½è¸ªä¸å›è°ƒç¡®è®¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯æ¬¡è°ƒåº¦ç”Ÿæˆå”¯ä¸€æ—¥å¿—IDï¼ˆ&lt;code&gt;log_id&lt;/code&gt;ï¼‰ï¼Œæ‰§è¡Œå™¨ä¸ŠæŠ¥ç»“æœæ—¶æºå¸¦è¯¥IDã€‚è°ƒåº¦ä¸­å¿ƒæ ¡éªŒIDçŠ¶æ€ï¼Œæ‹’ç»é‡å¤å›è°ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥å›è°ƒé˜Ÿåˆ—&lt;/strong&gt;ï¼šæ‰§è¡Œå™¨å°†ç»“æœæ”¾å…¥å†…å­˜é˜Ÿåˆ—ï¼Œç”±ç‹¬ç«‹çº¿ç¨‹æ‰¹é‡å›è°ƒï¼Œç¡®ä¿æœ€ç»ˆä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®¹é”™ä¸ç›‘æ§ä¿éšœ"&gt;ğŸ”§ &lt;strong&gt;å®¹é”™ä¸ç›‘æ§ä¿éšœ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœè½¬ç§»ä¸å¿™ç¢Œè½¬ç§»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥æ‰§è¡Œå™¨å®•æœºï¼Œè°ƒåº¦ä¸­å¿ƒé€šè¿‡å¿ƒè·³æ£€æµ‹ï¼ˆ30ç§’ä¸ŠæŠ¥ï¼‰è‡ªåŠ¨åˆ‡æ¢è‡³å¥åº·èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;å¿™ç¢Œè½¬ç§»ç­–ç•¥ï¼ˆ&lt;code&gt;BUSYOVER&lt;/code&gt;ï¼‰å°†ä»»åŠ¡è·¯ç”±è‡³ç©ºé—²å®ä¾‹ï¼Œé¿å…å•ç‚¹è¿‡è½½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—ä¸ç›‘æ§å‘Šè­¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒåº¦ä¸­å¿ƒè®°å½•ä»»åŠ¡æ—¥å¿—ï¼ˆ&lt;code&gt;xxl_job_log&lt;/code&gt;ï¼‰ï¼Œæ”¯æŒæŒ‰æ—¶é—´ã€çŠ¶æ€ç­›é€‰ã€‚&lt;/li&gt;
&lt;li&gt;é…ç½®ä»»åŠ¡å¤±è´¥å‘Šè­¦ï¼ˆé‚®ä»¶/çŸ­ä¿¡ï¼‰ï¼Œå®æ—¶æ„ŸçŸ¥å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“å¤šå±‚æ¬¡ååŒè®¾è®¡"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šå¤šå±‚æ¬¡ååŒè®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å±‚çº§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é˜²é‡æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®Œæˆä¿éšœæœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒåº¦ä¸­å¿ƒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“é” + çŠ¶æ€æœº&lt;/td&gt;
&lt;td&gt;é‡è¯•ç­–ç•¥ + è¶…æ—¶æ§åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œå™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡ç­–ç•¥ + åˆ†ç‰‡å‚æ•°&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹æ± éš”ç¦» + å›è°ƒé˜Ÿåˆ—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸šåŠ¡é€»è¾‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¹‚ç­‰è®¾è®¡ï¼ˆDBé”/åˆ†å¸ƒå¼é”ï¼‰&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡æ§åˆ¶ + å¼‚æ­¥è¡¥å¿&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®å®è·µå»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çŸ­ä»»åŠ¡ç”¨&lt;code&gt;SERIAL_EXECUTION&lt;/code&gt;ï¼Œé•¿ä»»åŠ¡ç”¨&lt;code&gt;COVER_EARLY&lt;/code&gt;é¿å…å †ç§¯ï¼›&lt;/li&gt;
&lt;li&gt;å¤§æ•°æ®ä»»åŠ¡å¿…ç”¨&lt;strong&gt;åˆ†ç‰‡å¹¿æ’­&lt;/strong&gt;ï¼Œç»“åˆ&lt;code&gt;shardIndex&lt;/code&gt;åˆ†å‰²æ•°æ®æºï¼›&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒä¸šåŠ¡éœ€å®ç°&lt;strong&gt;ä¸‰å±‚å¹‚ç­‰&lt;/strong&gt;ï¼ˆè°ƒåº¦ä¸­å¿ƒé” + æ‰§è¡Œå™¨åˆ†ç‰‡ + ä¸šåŠ¡DBçº¦æŸï¼‰ã€‚
é€šè¿‡ä¸Šè¿°æœºåˆ¶ï¼ŒXXL-JOBåœ¨å¼‚æ­¥ã€åˆ†å¸ƒå¼çš„å¤æ‚ç¯å¢ƒä¸‹ï¼Œå®ç°äº†ä»»åŠ¡æ‰§è¡Œçš„&lt;strong&gt;é«˜å¯é ä¸é«˜ä¸€è‡´&lt;/strong&gt;ã€‚å®é™…åº”ç”¨ä¸­éœ€æ ¹æ®ä¸šåŠ¡åœºæ™¯ç»„åˆç­–ç•¥ï¼Œå¹¶è¾…ä»¥ç›‘æ§å‘Šè­¦åŠæ—¶å¹²é¢„å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;</description></item></channel></rss>