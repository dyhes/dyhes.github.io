<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>NowCoder Redis on é£é¸¿è¸é›ªæ³¥</title><link>https://dyhes.github.io/tags/nowcoder-redis/</link><description>Recent content in NowCoder Redis on é£é¸¿è¸é›ªæ³¥</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 30 Sep 2025 19:46:00 +0800</lastBuildDate><atom:link href="https://dyhes.github.io/tags/nowcoder-redis/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€NowCoderã€‘Redis</title><link>https://dyhes.github.io/p/nowcoderredis/</link><pubDate>Thu, 11 Sep 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/nowcoderredis/</guid><description>&lt;h2 id="pipeline--transaction"&gt;Pipeline &amp;amp; Transaction
&lt;/h2&gt;&lt;p&gt;Redis çš„ Pipeliningï¼ˆç®¡é“ï¼‰å’Œ Transactionsï¼ˆäº‹åŠ¡ï¼‰æ˜¯ä¸¤ç§ç”¨äºæå‡æ€§èƒ½æˆ–ä¿è¯æ“ä½œæ‰¹å¤„ç†ç‰¹æ€§çš„é‡è¦æœºåˆ¶ï¼Œå®ƒä»¬é€‚ç”¨äºä¸åŒçš„åœºæ™¯ï¼Œä¹Ÿå„æœ‰ç‰¹ç‚¹ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ è¯¦ç»†è§£é‡Šå®ƒä»¬çš„å·¥ä½œåŸç†ã€åŒºåˆ«ä»¥åŠä½¿ç”¨æ³¨æ„äº‹é¡¹ã€‚&lt;/p&gt;
&lt;h2 id="-æ ¸å¿ƒæ‘˜è¦"&gt;âœ¨ æ ¸å¿ƒæ‘˜è¦
&lt;/h2&gt;&lt;p&gt;Redis çš„ &lt;strong&gt;Pipeliningï¼ˆç®¡é“ï¼‰&lt;/strong&gt; æ˜¯ä¸€ç§é€šè¿‡&lt;strong&gt;å‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°ï¼ˆRTTï¼‰&lt;/strong&gt; æ¥æ˜¾è‘—æå‡æ‰¹é‡å‘½ä»¤æ‰§è¡Œæ€§èƒ½çš„å®¢æˆ·ç«¯æŠ€æœ¯ï¼Œå®ƒå°†å¤šæ¡å‘½ä»¤æ‰“åŒ…å‘é€ï¼ŒæœåŠ¡å™¨é¡ºåºæ‰§è¡Œåä¸€æ¬¡æ€§è¿”å›ç»“æœï¼Œä½†&lt;strong&gt;ä¸ä¿è¯åŸå­æ€§&lt;/strong&gt;ã€‚è€Œ &lt;strong&gt;Transactionsï¼ˆäº‹åŠ¡ï¼‰&lt;/strong&gt; åˆ™é€šè¿‡ &lt;code&gt;MULTI&lt;/code&gt;ã€&lt;code&gt;EXEC&lt;/code&gt;ç­‰å‘½ä»¤å°†ä¸€ç»„æ“ä½œä½œä¸ºä¸€ä¸ª&lt;strong&gt;éš”ç¦»çš„ã€é¡ºåºçš„å•å…ƒ&lt;/strong&gt;æ‰§è¡Œï¼Œæä¾›&lt;strong&gt;æœ‰é™çš„åŸå­æ€§&lt;/strong&gt;ï¼ˆå³æœåŠ¡å™¨ä¿è¯é¡ºåºæ‰§è¡Œä¸”æœŸé—´ä¸è¢«ä¸­æ–­ï¼Œä½†å‘ç”Ÿè¿è¡Œæ—¶é”™è¯¯æ—¶ä¸ä¼šå›æ»šï¼‰å’Œ&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;ï¼Œå¹¶èƒ½é€šè¿‡ &lt;code&gt;WATCH&lt;/code&gt;å‘½ä»¤å®ç°&lt;strong&gt;ä¹è§‚é”&lt;/strong&gt;æœºåˆ¶ï¼Œé€‚ç”¨äºéœ€è¦ä¿è¯ä¸€ç»„å‘½ä»¤é¡ºåºæ‰§è¡Œä¸”ä¸å—å…¶ä»–å®¢æˆ·ç«¯å¹²æ‰°çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ èƒ½å¿«é€ŸæŠŠæ¡ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«ï¼Œæˆ‘å‡†å¤‡äº†ä¸€ä¸ªå¯¹æ¯”è¡¨æ ¼ï¼š&lt;/p&gt;
&lt;h3 id="-pipelining-ä¸-transactions-æ ¸å¿ƒåŒºåˆ«ä¸€è§ˆ"&gt;ğŸ“Š Pipelining ä¸ Transactions æ ¸å¿ƒåŒºåˆ«ä¸€è§ˆ
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;Pipelining (ç®¡é“)&lt;/th&gt;
&lt;th&gt;Transactions (äº‹åŠ¡, MULTI/EXEC)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒç›®çš„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æå‡æ€§èƒ½ï¼Œå‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•° (RTT)&lt;/td&gt;
&lt;td&gt;ä¿è¯å‘½ä»¤é¡ºåºæ‰§è¡Œï¼Œæä¾›æœ‰é™åŸå­æ€§å’Œéš”ç¦»æ€§ï¼Œæ”¯æŒä¹è§‚é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— &lt;/td&gt;
&lt;td&gt;âš ï¸ æœ‰é™ (å‘½ä»¤é”™è¯¯ä¸ä¼šå¯¼è‡´å›æ»š)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— &lt;/td&gt;
&lt;td&gt;âœ… æœ‰ (æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘½ä»¤æ‰“æ–­)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸­é—´å‘½ä»¤å¤±è´¥ä¸å½±å“åç»­æ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;è¯­æ³•é”™è¯¯å¯¼è‡´äº‹åŠ¡å¤±æ•ˆï¼›è¿è¡Œæ—¶é”™è¯¯ä¸å½±å“å…¶ä»–å‘½ä»¤æ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç½‘ç»œå¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æå¤§å‡å°‘ RTT&lt;/td&gt;
&lt;td&gt;ç›¸æ¯”ç®¡é“ï¼Œä»æœ‰å¤šæ¬¡ RTT (MULTI, å‘½ä»¤å…¥é˜Ÿ, EXEC)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤§é‡æ— å› æœå…³ç³»çš„æ‰¹é‡å†™å…¥ã€æŸ¥è¯¢&lt;/td&gt;
&lt;td&gt;éœ€è¦é¡ºåºæ‰§è¡Œå’Œç®€å•åŸå­æ€§çš„æ“ä½œ (å¦‚å…ˆè¯»åå†™)ã€é…åˆ WATCH å®ç°ä¹è§‚é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœåŠ¡å™¨å†…å­˜å‹åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½å­˜åœ¨ (å“åº”ç¼“å†²åœ¨å†…å­˜)&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒå°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–æ€§æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ åç»­å‘½ä»¤æ— æ³•ä¾èµ–å‰åºå‘½ä»¤çš„ç»“æœ&lt;/td&gt;
&lt;td&gt;âœ… åç»­å‘½ä»¤å¯ä»¥ä¾èµ–å‰åºå‘½ä»¤çš„ç»“æœ (å› ä¸ºé¡ºåºæ‰§è¡Œ)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šè¯¦ç»†è§£é‡Šå®ƒä»¬çš„å·¥ä½œåŸç†å’Œæœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;h2 id="1--redis-pipelining-ç®¡é“"&gt;1 ğŸ”„ Redis Pipelining (ç®¡é“)
&lt;/h2&gt;&lt;p&gt;Pipelining æ˜¯ä¸€ç§å®¢æˆ·ç«¯æŠ€æœ¯ï¼Œæ—¨åœ¨ä¼˜åŒ–æ‰¹é‡å‘½ä»¤çš„æ‰§è¡Œæ•ˆç‡ã€‚&lt;/p&gt;
&lt;h3 id="11-å·¥ä½œåŸç†"&gt;1.1 å·¥ä½œåŸç†
&lt;/h3&gt;&lt;p&gt;Redis åŸºäºè¯·æ±‚/å“åº”æ¨¡å‹çš„ TCP æœåŠ¡ã€‚æ™®é€šæ¨¡å¼ä¸‹ï¼Œæ¯æ¡å‘½ä»¤éƒ½éœ€ç»å†ï¼šå®¢æˆ·ç«¯å‘é€ â†’ æœåŠ¡å™¨å¤„ç† â†’ æœåŠ¡å™¨è¿”å› â†’ å®¢æˆ·ç«¯æ¥æ”¶ä¸‹ä¸€ä¸ªå‘½ä»¤ã€‚æ¯ä¸ªå‘½ä»¤éƒ½ä¼šæ¶ˆè€—ä¸€ä¸ª&lt;strong&gt;ç½‘ç»œå¾€è¿”æ—¶é—´ (RTT)&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Pipelining å°†å¤šæ¡å‘½ä»¤ä¸€æ¬¡æ€§å‘é€ç»™æœåŠ¡å™¨ï¼Œè€Œä¸å¿…ç­‰å¾…æ¯æ¡å‘½ä»¤çš„å“åº”ã€‚æœåŠ¡å™¨ä¼šé¡ºåºæ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œå¹¶å°†æ‰€æœ‰ç»“æœä¸€æ¬¡æ€§è¿”å›ç»™å®¢æˆ·ç«¯ã€‚è¿™å°±åƒæ˜¯è®©ä½ ä¸€æ¬¡æ€§æ‹¿å®Œæ‰€æœ‰å¿«é€’ï¼Œè€Œä¸æ˜¯æ¯åˆ°ä¸€ä¸ªå¿«é€’å°±ä¸‹æ¥¼å–ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;h3 id="12-æ€§èƒ½æå‡çš„å…³é”®"&gt;1.2 æ€§èƒ½æå‡çš„å…³é”®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤§å¹…å‡å°‘ RTT&lt;/strong&gt;ï¼šä¸»è¦ä¼˜åŒ–ç‚¹ã€‚å°† N æ¬¡ RTT ç¼©å‡ä¸º 1 æ¬¡æˆ–æå°‘æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™ä½ç³»ç»Ÿè°ƒç”¨å¼€é”€&lt;/strong&gt;ï¼šå‡å°‘ &lt;code&gt;read()&lt;/code&gt;å’Œ &lt;code&gt;write()&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°ï¼Œä»è€Œå‡å°‘ç”¨æˆ·æ€ä¸å†…æ ¸æ€åˆ‡æ¢çš„å¼€é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="13-ä½¿ç”¨ç¤ºä¾‹-java-jedis"&gt;1.3 ä½¿ç”¨ç¤ºä¾‹ (Java Jedis)
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;Jedis jedis = new Jedis(&amp;#34;localhost&amp;#34;, 6379);
Pipeline pipeline = jedis.pipelined(); // è·å–Pipelineå¯¹è±¡
// å°†å¤šæ¡å‘½ä»¤åŠ å…¥ç®¡é“
for (int i = 0; i &amp;lt; 10000; i++) {
pipeline.set(&amp;#34;key:&amp;#34; + i, &amp;#34;value:&amp;#34; + i);
}
// åŒæ­¥æ‰§è¡Œç®¡é“ä¸­çš„æ‰€æœ‰å‘½ä»¤ï¼Œå¹¶è·å–å“åº”åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰
// List&amp;lt;Object&amp;gt; responses = pipeline.syncAndReturnAll();
pipeline.sync(); // åªåŒæ­¥ï¼Œä¸è·å–å“åº”
jedis.close();
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="14-æ³¨æ„äº‹é¡¹"&gt;1.4 æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹æ¬¡å¤§å°&lt;/strong&gt;ï¼šé¿å…å•æ¬¡ç®¡é“ä¸­åŒ…å«è¿‡å¤šå‘½ä»¤ï¼ˆå¦‚æ•°ä¸‡æ¡ï¼‰ï¼Œä»¥å…ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡å™¨å†…å­˜å‹åŠ›&lt;/strong&gt;ï¼šæœåŠ¡å™¨éœ€ç¼“å­˜æ‰€æœ‰å‘½ä»¤çš„å“åº”ï¼Œç›´åˆ°å…¨éƒ¨æ‰§è¡Œå®Œæ¯•æ‰è¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯é˜»å¡&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯ç­‰å¾…æ‰€æœ‰å“åº”è¿”å›æ—¶å¯èƒ½é˜»å¡æ—¶é—´è¿‡é•¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šå°†å¤§æ‰¹æ¬¡æ“ä½œæ‹†åˆ†ä¸ºå¤šä¸ªè¾ƒå°æ‰¹æ¬¡ï¼ˆå¦‚æ¯æ‰¹ 10k æ¡å‘½ä»¤ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;ï¼šè‹¥ç®¡é“ä¸­æŸæ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œ&lt;strong&gt;åç»­å‘½ä»¤ä»ä¼šç»§ç»­æ‰§è¡Œ&lt;/strong&gt;ã€‚å®¢æˆ·ç«¯éœ€éå†å“åº”åˆ—è¡¨æ£€æŸ¥æ¯æ¡å‘½ä»¤çš„ç»“æœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— åŸå­æ€§ä¿è¯&lt;/strong&gt;ï¼šç®¡é“ä¸­çš„å‘½ä»¤å¯èƒ½ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤æ’é˜Ÿã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— å‘½ä»¤ä¾èµ–æ€§&lt;/strong&gt;ï¼šä¸èƒ½åœ¨ç®¡é“ä¸­å…ˆ &lt;code&gt;INCR&lt;/code&gt;ä¸€ä¸ªé”®ç„¶åç«‹å³ &lt;code&gt;GET&lt;/code&gt;å®ƒï¼Œå› ä¸ºæ‰€æœ‰å‘½ä»¤åœ¨å‘é€æ—¶å¹¶æœªæ‰§è¡Œï¼Œ&lt;code&gt;GET&lt;/code&gt;æ— æ³•è·å–åˆ° &lt;code&gt;INCR&lt;/code&gt;åçš„ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="2--redis-transactions-äº‹åŠ¡"&gt;2 âš–ï¸ Redis Transactions (äº‹åŠ¡)
&lt;/h2&gt;&lt;p&gt;Redis äº‹åŠ¡æä¾›äº†ä¸€ç§å°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…ï¼Œç„¶åä¸€æ¬¡æ€§ã€æŒ‰é¡ºåºæ‰§è¡Œçš„æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h3 id="21-äº‹åŠ¡å‘½ä»¤ä¸æµç¨‹"&gt;2.1 äº‹åŠ¡å‘½ä»¤ä¸æµç¨‹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;code&gt;MULTI&lt;/code&gt;ï¼š&lt;strong&gt;å¼€å¯äº‹åŠ¡&lt;/strong&gt;ã€‚åç»­å‘½ä»¤è¢«æ”¾å…¥é˜Ÿåˆ—ï¼Œä¸ä¼šç«‹å³æ‰§è¡Œï¼ŒæœåŠ¡å™¨è¿”å› &lt;code&gt;QUEUED&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;å‘½ä»¤å…¥é˜Ÿ&lt;/code&gt;ï¼šåœ¨ &lt;code&gt;MULTI&lt;/code&gt;åè¾“å…¥å‘½ä»¤ï¼Œå®ƒä»¬ä¼šè¢«æœåŠ¡å™¨ç¼“å­˜åˆ°è¯¥å®¢æˆ·ç«¯çš„äº‹åŠ¡é˜Ÿåˆ—ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;EXEC&lt;/code&gt;ï¼š&lt;strong&gt;æ‰§è¡Œäº‹åŠ¡&lt;/strong&gt;ã€‚æœåŠ¡å™¨æŒ‰é¡ºåºæ‰§è¡Œäº‹åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤ï¼Œå¹¶è¿”å›æ‰€æœ‰ç»“æœã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DISCARD&lt;/code&gt;ï¼š&lt;strong&gt;å–æ¶ˆäº‹åŠ¡&lt;/strong&gt;ã€‚æ¸…ç©ºäº‹åŠ¡é˜Ÿåˆ—å¹¶é€€å‡ºäº‹åŠ¡æ¨¡å¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="22-åŸå­æ€§ä¸é”™è¯¯å¤„ç†"&gt;2.2 åŸå­æ€§ä¸é”™è¯¯å¤„ç†
&lt;/h3&gt;&lt;p&gt;Redis äº‹åŠ¡çš„åŸå­æ€§&lt;strong&gt;ä¸ä¼ ç»Ÿæ•°æ®åº“ä¸åŒ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯­æ³•é”™è¯¯&lt;/strong&gt;ï¼ˆå¦‚å‘½ä»¤ä¸å­˜åœ¨ã€å‚æ•°é”™è¯¯ï¼‰ï¼šåœ¨å‘½ä»¤å…¥é˜Ÿæ—¶å°±ä¼šè¢«æ£€æµ‹åˆ°ã€‚&lt;strong&gt;åœ¨ Redis 2.6.5 ä¹‹åï¼Œå¦‚æœ &lt;code&gt;MULTI&lt;/code&gt;åæœ‰å‘½ä»¤å…¥é˜Ÿå¤±è´¥ï¼ˆè¯­æ³•é”™è¯¯ï¼‰ï¼Œæ‰§è¡Œ &lt;code&gt;EXEC&lt;/code&gt;æ—¶æ•´ä¸ªäº‹åŠ¡éƒ½ä¸ä¼šæ‰§è¡Œ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶é”™è¯¯&lt;/strong&gt;ï¼ˆå¦‚å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ &lt;code&gt;INCR&lt;/code&gt;ï¼‰ï¼š&lt;strong&gt;åªæœ‰å‡ºé”™çš„å‘½ä»¤ä¼šå¤±è´¥ï¼Œäº‹åŠ¡ä¸­çš„å…¶ä»–å‘½ä»¤ä»ä¼šç»§ç»­æ‰§è¡Œ&lt;/strong&gt;ã€‚Redis &lt;strong&gt;ä¸ä¼šè‡ªåŠ¨å›æ»š&lt;/strong&gt;å·²æˆåŠŸæ‰§è¡Œçš„å‘½ä»¤ã€‚è¿™æ˜¯å› ä¸º Redis è®¾è®¡è¿½æ±‚ç®€å•é«˜æ•ˆï¼Œå›æ»šæœºåˆ¶ä¼šå¢åŠ å¤æ‚æ€§å’Œæ€§èƒ½å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="23-watchä¹è§‚é”"&gt;2.3 Watchï¼šä¹è§‚é”
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;WATCH&lt;/code&gt;å‘½ä»¤æ˜¯å®ç° CASï¼ˆCheck-And-Setï¼‰æ“ä½œçš„åŸºç¡€ï¼Œç”¨äºå®ç°&lt;strong&gt;ä¹è§‚é”&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;MULTI&lt;/code&gt;ä¹‹å‰ï¼Œä½¿ç”¨ &lt;code&gt;WATCH&lt;/code&gt;ç›‘æ§ä¸€ä¸ªæˆ–å¤šä¸ªé”®ã€‚å¦‚æœäº‹åŠ¡æ‰§è¡Œï¼ˆ&lt;code&gt;EXEC&lt;/code&gt;ï¼‰ä¹‹å‰ï¼Œæœ‰ä»»ä½•è¢«ç›‘è§†çš„é”®è¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹ï¼Œé‚£ä¹ˆå½“å‰å®¢æˆ·ç«¯çš„äº‹åŠ¡å°†ä¼šè¢«æ”¾å¼ƒï¼ˆ&lt;code&gt;EXEC&lt;/code&gt;è¿”å› &lt;code&gt;nil&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹æµç¨‹&lt;/strong&gt;ï¼š
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;WATCH key&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¯»å– &lt;code&gt;key&lt;/code&gt;çš„å€¼å¹¶è¿›è¡Œä¸šåŠ¡é€»è¾‘è®¡ç®—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MULTI&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ ¹æ®è®¡ç®—ç»“æœåœ¨äº‹åŠ¡ä¸­ä¿®æ”¹ &lt;code&gt;key&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;EXEC&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœ &lt;code&gt;EXEC&lt;/code&gt;è¿”å› &lt;code&gt;nil&lt;/code&gt;ï¼Œè¯´æ˜ç›‘è§†çš„ &lt;code&gt;key&lt;/code&gt;å·²è¢«ä¿®æ”¹ï¼Œäº‹åŠ¡æ‰§è¡Œå¤±è´¥ã€‚é€šå¸¸éœ€è¦&lt;strong&gt;é‡è¯•&lt;/strong&gt;æ•´ä¸ªæµç¨‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# å®¢æˆ·ç«¯ A
127.0.0.1:6379&amp;gt; WATCH balance
OK
127.0.0.1:6379&amp;gt; GET balance
&amp;#34;100&amp;#34;
127.0.0.1:6379&amp;gt; MULTI
OK
127.0.0.1:6379&amp;gt; SET balance 50
QUEUED
# æ­¤æ—¶å®¢æˆ·ç«¯ B æ‰§è¡Œäº†ï¼šSET balance 200
127.0.0.1:6379&amp;gt; EXEC
(nil) # äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå› ä¸º balance å·²è¢«å®¢æˆ·ç«¯ B ä¿®æ”¹
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="24-ä½¿ç”¨ç¤ºä¾‹-java-jedis"&gt;2.4 ä½¿ç”¨ç¤ºä¾‹ (Java Jedis)
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;Jedis jedis = new Jedis(&amp;#34;localhost&amp;#34;, 6379);
try {
jedis.watch(&amp;#34;key1&amp;#34;, &amp;#34;key2&amp;#34;); // ç›‘è§†é”®
// æ¨¡æ‹Ÿä¸€äº›éœ€è¦è¯»å–è¢«ç›‘è§†é”®çš„ä¸šåŠ¡é€»è¾‘
String value1 = jedis.get(&amp;#34;key1&amp;#34;);
// ... æ ¹æ®value1è¿›è¡Œè®¡ç®— ...
Transaction transaction = jedis.multi(); // å¼€å¯äº‹åŠ¡
transaction.set(&amp;#34;key1&amp;#34;, &amp;#34;newValue&amp;#34;);
transaction.incrBy(&amp;#34;key2&amp;#34;, 10);
List&amp;lt;Object&amp;gt; results = transaction.exec(); // æ‰§è¡Œäº‹åŠ¡
if (results == null) {
// äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œé€šå¸¸å› ä¸ºWATCHçš„é”®è¢«ä¿®æ”¹ï¼Œéœ€è¦é‡è¯•
System.out.println(&amp;#34;Transaction aborted, retry needed.&amp;#34;);
} else {
// äº‹åŠ¡æ‰§è¡ŒæˆåŠŸ
System.out.println(&amp;#34;Transaction executed: &amp;#34; + results);
}
} catch (Exception e) {
e.printStackTrace();
} finally {
jedis.unwatch(); // å¯é€‰çš„ï¼Œå–æ¶ˆç›‘è§†ã€‚æ³¨æ„ï¼šè¿æ¥å…³é—­æˆ–EXEC/DISCARDåç›‘è§†ä¼šè‡ªåŠ¨å–æ¶ˆã€‚
jedis.close();
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="25-æ³¨æ„äº‹é¡¹"&gt;2.5 æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ”¯æŒå›æ»š&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€é‡è¦çš„ç‰¹æ€§ã€‚å¼€å‘è€…éœ€è¦ç¡®ä¿äº‹åŠ¡ä¸­çš„å‘½ä»¤é€»è¾‘æ­£ç¡®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;ï¼šäº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯éš”ç¦»çš„ã€‚Redis æ˜¯å•çº¿ç¨‹å¤„ç†å‘½ä»¤ï¼Œä¿è¯äº†äº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤åœ¨ &lt;code&gt;EXEC&lt;/code&gt;æ‰§è¡Œæ—¶ä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤æ‰“æ–­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;ï¼šäº‹åŠ¡ä¼šé˜»å¡å…¶ä»–å‘½ä»¤ã€‚ç”±äºäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤åœ¨ &lt;code&gt;EXEC&lt;/code&gt;æ—¶æ‰çœŸæ­£æ‰§è¡Œï¼Œä¸”æ‰§è¡ŒæœŸé—´ä¼šå ç”¨ Redis ä¸»çº¿ç¨‹ï¼Œå¦‚æœäº‹åŠ¡åŒ…å«å¤§é‡å‘½ä»¤ï¼Œå¯èƒ½ä¼šé˜»å¡å…¶ä»–å®¢æˆ·ç«¯ï¼Œå½±å“æ•´ä½“æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="3--å¦‚ä½•é€‰æ‹©-pipelining-ä¸-transactions"&gt;3 ğŸ’¡ å¦‚ä½•é€‰æ‹© Pipelining ä¸ Transactions
&lt;/h2&gt;&lt;p&gt;ç†è§£ä¸¤è€…çš„åŒºåˆ«åï¼Œé€‰æ‹©å°±å˜å¾—æ¸…æ™°äº†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿½æ±‚æè‡´æ€§èƒ½ï¼Œå¤„ç†å¤§é‡æ— ä¾èµ–å…³ç³»çš„å‘½ä»¤&lt;/strong&gt;ï¼šé€‰æ‹© &lt;strong&gt;Pipelining&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼šæ‰¹é‡å¯¼å…¥æ•°æ®ã€ç¼“å­˜é¢„çƒ­ã€æ‰¹é‡åˆ é™¤æˆ–æŸ¥è¯¢æ— å…³é”®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦ä¿è¯ä¸€ç»„å‘½ä»¤é¡ºåºæ‰§è¡Œä¸”ä¸­é—´ä¸è¢«å¹²æ‰°ï¼Œæˆ–æœ‰ç®€å•åŸå­æ€§éœ€æ±‚&lt;/strong&gt;ï¼šé€‰æ‹© &lt;strong&gt;Transactions&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼š
&lt;ul&gt;
&lt;li&gt;ç®€å•çš„å…ˆè¯»åå†™ï¼ˆå¦‚æ£€æŸ¥åº“å­˜åå†æ‰£å‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éœ€è¦ä¾èµ–å‰åºå‘½ä»¤ç»“æœçš„è¿ç»­æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;é…åˆ &lt;code&gt;WATCH&lt;/code&gt;å®ç°ä¹è§‚é”ï¼Œé¿å…å¹¶å‘ä¿®æ”¹ï¼ˆå¦‚ä½™é¢ä¿®æ”¹ã€ç§’æ€åº“å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äºŒè€…ç»“åˆ&lt;/strong&gt;ï¼šå¯ä»¥åœ¨ä¸€ä¸ª &lt;code&gt;MULTI&lt;/code&gt;/&lt;code&gt;EXEC&lt;/code&gt;äº‹åŠ¡å†…éƒ¨ä½¿ç”¨ Pipelining çš„ç‰¹æ€§ï¼ˆå› ä¸ºäº‹åŠ¡æœ¬èº«ä¹Ÿæ˜¯æ‰¹é‡å‘é€å‘½ä»¤ï¼‰ï¼Œä½†è¿™é€šå¸¸ç”±å®¢æˆ·ç«¯é©±åŠ¨ï¼Œæ„ä¹‰ä¸å¤§ã€‚æ›´å¸¸è§çš„æ˜¯åœ¨éœ€è¦ä¹è§‚é”çš„æ‰¹é‡æ“ä½œä¸­ï¼Œä½¿ç”¨ &lt;code&gt;WATCH&lt;/code&gt;+ &lt;code&gt;MULTI&lt;/code&gt;+ (å¤šä¸ªå‘½ä»¤) + &lt;code&gt;EXEC&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="4--æ€»ç»“ä¸æœ€ä½³å®è·µ"&gt;4 ğŸ“ æ€»ç»“ä¸æœ€ä½³å®è·µ
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç†è§£æœ¬è´¨&lt;/strong&gt;ï¼šPipelining æ˜¯&lt;strong&gt;ç½‘ç»œä¼˜åŒ–&lt;/strong&gt;ï¼ŒTransactions æ˜¯&lt;strong&gt;å‘½ä»¤åˆ†ç»„ä¸éš”ç¦»&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶æ‰¹æ¬¡&lt;/strong&gt;ï¼šä½¿ç”¨ Pipelining æ—¶ï¼Œ&lt;strong&gt;åˆç†æ§åˆ¶æ¯æ¬¡æäº¤çš„å‘½ä»¤æ•°é‡&lt;/strong&gt;ï¼ˆå¦‚ 10kï¼‰ï¼Œé¿å…æœåŠ¡å™¨å†…å­˜å‹åŠ›å’Œå®¢æˆ·ç«¯é•¿æ—¶é—´é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å–„ç”¨ WATCH&lt;/strong&gt;ï¼šåœ¨äº‹åŠ¡ä¸­ï¼Œå¯¹éœ€è¦ä¿è¯ä¸€è‡´æ€§çš„å…³é”®æ•°æ®ä½¿ç”¨ &lt;code&gt;WATCH&lt;/code&gt;å®ç°ä¹è§‚é”ï¼Œå¹¶å‡†å¤‡å¥½é‡è¯•æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç†é”™è¯¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹äº Pipeliningï¼Œ&lt;strong&gt;æ£€æŸ¥æ‰€æœ‰å“åº”&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äº Transactionsï¼Œ&lt;strong&gt;å¤„ç† &lt;code&gt;EXEC&lt;/code&gt;è¿”å›çš„åˆ—è¡¨ä¸­çš„é”™è¯¯&lt;/strong&gt;ï¼Œå¹¶æ³¨æ„è¯­æ³•é”™è¯¯ä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡å¤±æ•ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯„ä¼°éœ€æ±‚&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;çº¯æ‰¹é‡æ’å…¥ã€åˆ é™¤ç­‰æ— ä¾èµ–æ“ä½œ -&amp;gt; Pipeliningã€‚&lt;/li&gt;
&lt;li&gt;æœ‰å…³é”®æ•°æ®éœ€è¦ä¿è¯ä¸€è‡´æ€§ï¼ˆå¦‚ä½™é¢ã€åº“å­˜ï¼‰-&amp;gt; Transactions + &lt;code&gt;WATCH&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åªæ˜¯éœ€è¦æŒ‰é¡ºåºæ‰§è¡Œä¸€ç³»åˆ—å‘½ä»¤ -&amp;gt; Transactionsã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ Redis çš„ Pipelining å’Œ Transactionsã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; MATCH (src)-[e: call_method_edge | scheduler_method_edge |
http_endpoint_method_edge]-&amp;gt;(dst) where e.has_generated == false RETURN
properties(src).ai_desc as src_desc, { name: type(e), src: src(e), dst: dst(e), props:
properties(e) } as e, properties(dst).ai_desc as dst_desc LIMIT 500
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="geo-redis"&gt;GEO Redis
&lt;/h2&gt;&lt;p&gt;Redis Geospatial åŠŸèƒ½æä¾›äº†ä¸€å¥—å¼ºå¤§çš„å‘½ä»¤ï¼Œç”¨äºå­˜å‚¨ã€æŸ¥è¯¢å’Œè®¡ç®—åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œéå¸¸é€‚åˆå¼€å‘åŸºäºä½ç½®çš„æœåŠ¡ï¼ˆLBSï¼‰åº”ç”¨ã€‚å…¶åº•å±‚åŸºäºæœ‰åºé›†åˆï¼ˆSorted Setï¼‰å®ç°ï¼Œé€šè¿‡ Geohash ç¼–ç å°†ç»çº¬åº¦è½¬æ¢ä¸ºä¸€ç»´åˆ†å€¼è¿›è¡Œé«˜æ•ˆå­˜å‚¨å’ŒèŒƒå›´æŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ Redis Geospatial æ ¸å¿ƒå‘½ä»¤çš„è¯¦ç»†ä»‹ç»ã€åº”ç”¨åœºæ™¯åŠä½¿ç”¨ç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;h3 id="-ä¸€redis-geo-æ ¸å¿ƒå‘½ä»¤è¯¦è§£"&gt;ğŸ—ºï¸ ä¸€ã€Redis GEO æ ¸å¿ƒå‘½ä»¤è¯¦è§£
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‘½ä»¤&lt;/th&gt;
&lt;th&gt;åŠŸèƒ½æè¿°&lt;/th&gt;
&lt;th&gt;æ—¶é—´å¤æ‚åº¦&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GEOADD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªåœ°ç†ä½ç½®ï¼ˆç»åº¦ã€çº¬åº¦ã€åç§°ï¼‰åˆ°æŒ‡å®š key&lt;/td&gt;
&lt;td&gt;O(log(N))ï¼ŒN æ˜¯æ’åºé›†ä¸­çš„å…ƒç´ æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GEOPOS&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜çš„åœ°ç†ä½ç½®åæ ‡ï¼ˆç»åº¦ã€çº¬åº¦ï¼‰&lt;/td&gt;
&lt;td&gt;O(log(N))ï¼ŒN æ˜¯æ’åºé›†ä¸­çš„å…ƒç´ æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GEODIST&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®¡ç®—ä¸¤ä¸ªæˆå‘˜ä¹‹é—´çš„ç›´çº¿è·ç¦»&lt;/td&gt;
&lt;td&gt;O(log(N))ï¼ŒN æ˜¯æ’åºé›†ä¸­çš„å…ƒç´ æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GEOHASH&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜çš„ Geohash ç¼–ç å€¼&lt;/td&gt;
&lt;td&gt;O(log(N))ï¼ŒN æ˜¯æ’åºé›†ä¸­çš„å…ƒç´ æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GEORADIUS&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œè¿”å›æŒ‡å®šåŠå¾„å†…çš„æˆå‘˜&lt;/td&gt;
&lt;td&gt;O(N+log(M))ï¼ŒN æ˜¯åŠå¾„å†…çš„å…ƒç´ æ•°ï¼ŒM æ˜¯æ’åºé›†ä¸­çš„å…ƒç´ æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GEORADIUSBYMEMBER&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»¥æŒ‡å®šçš„æˆå‘˜ä¸ºä¸­å¿ƒï¼Œè¿”å›æŒ‡å®šåŠå¾„å†…çš„å…¶ä»–æˆå‘˜&lt;/td&gt;
&lt;td&gt;O(N+log(M))ï¼ŒN æ˜¯åŠå¾„å†…çš„å…ƒç´ æ•°ï¼ŒM æ˜¯æ’åºé›†ä¸­çš„å…ƒç´ æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GEOSEARCH&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;(v6.2+) æ›´å¼ºå¤§çš„æœç´¢å‘½ä»¤ï¼Œæ”¯æŒåœ†å½¢å’ŒçŸ©å½¢åŒºåŸŸæŸ¥è¯¢&lt;/td&gt;
&lt;td&gt;O(N+log(M))ï¼ŒN æ˜¯èŒƒå›´å†…çš„å…ƒç´ æ•°ï¼ŒM æ˜¯æ’åºé›†ä¸­çš„å…ƒç´ æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GEOSEARCHSTORE&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;(v6.2+) å°† GEOSEARCH çš„ç»“æœå­˜å‚¨åˆ°ä¸€ä¸ªæ–°çš„ key ä¸­&lt;/td&gt;
&lt;td&gt;O(N+log(M))ï¼ŒN æ˜¯èŒƒå›´å†…çš„å…ƒç´ æ•°ï¼ŒM æ˜¯æ’åºé›†ä¸­çš„å…ƒç´ æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="1-geoaddæ·»åŠ åœ°ç†ä½ç½®"&gt;1. GEOADDï¼šæ·»åŠ åœ°ç†ä½ç½®
&lt;/h4&gt;&lt;p&gt;å°†æŒ‡å®šçš„åœ°ç†ç©ºé—´ä½ç½®ï¼ˆçº¬åº¦ã€ç»åº¦ã€åç§°ï¼‰æ·»åŠ åˆ°æŒ‡å®šçš„ key ä¸­ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;ï¼š&lt;code&gt;GEOADD key [NX|XX] [CH] longitude latitude member [longitude latitude member ...]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;NX&lt;/code&gt;ï¼šä»…æ·»åŠ æ–°æˆå‘˜ï¼Œä¸æ›´æ–°å·²å­˜åœ¨çš„æˆå‘˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XX&lt;/code&gt;ï¼šä»…æ›´æ–°å·²å­˜åœ¨çš„æˆå‘˜ï¼Œä¸æ·»åŠ æ–°æˆå‘˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CH&lt;/code&gt;ï¼šè¿”å›è¢«æ›´æ”¹ï¼ˆæ–°å¢æˆ–æ›´æ–°ï¼‰çš„æˆå‘˜æ•°é‡ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–°å¢æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;longitude latitude member&lt;/code&gt;ï¼šç»åº¦ã€çº¬åº¦ã€æˆå‘˜åç§°ã€‚å¯æ·»åŠ å¤šä¸ªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;ï¼šæˆåŠŸæ·»åŠ åˆ°æœ‰åºé›†åˆä¸­çš„æˆå‘˜æ•°é‡ï¼ˆå¦‚æœä½¿ç”¨äº† &lt;code&gt;CH&lt;/code&gt;é€‰é¡¹ï¼Œåˆ™è¿”å›è¢«æ›´æ”¹çš„æ•°é‡ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# æ·»åŠ å•ä¸ªä½ç½®
GEOADD cities:geo 116.397128 39.916527 &amp;#34;Beijing&amp;#34;
# è¾“å‡º: (integer) 1
# æ·»åŠ å¤šä¸ªä½ç½®
GEOADD cities:geo 121.473701 31.230416 &amp;#34;Shanghai&amp;#34; 114.305393 30.593099 &amp;#34;Wuhan&amp;#34;
# è¾“å‡º: (integer) 2
# ä½¿ç”¨NXé€‰é¡¹ä»…æ·»åŠ æ–°æˆå‘˜
GEOADD cities:geo NX 116.397128 39.916527 &amp;#34;Beijing&amp;#34; # å·²å­˜åœ¨ï¼Œä¸ä¼šæ›´æ–°
# è¾“å‡º: (integer) 0
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-geoposè·å–åœ°ç†åæ ‡"&gt;2. GEOPOSï¼šè·å–åœ°ç†åæ ‡
&lt;/h4&gt;&lt;p&gt;è¿”å›æŒ‡å®š key ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜çš„åœ°ç†åæ ‡ï¼ˆç»åº¦å’Œçº¬åº¦ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;ï¼š&lt;code&gt;GEOPOS key member [member ...]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;ï¼šä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å‡ä¸ºä¸€ä¸ªåæ ‡å¯¹ï¼ˆç»åº¦, çº¬åº¦ï¼‰ï¼›å¦‚æœæˆå‘˜ä¸å­˜åœ¨ï¼Œåˆ™å¯¹åº”è¿”å› &lt;code&gt;nil&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GEOPOS cities:geo Beijing Shanghai Guangzhou
# è¾“å‡º:
# 1) 1) &amp;#34;116.39712828397750854&amp;#34; # åŒ—äº¬ç»åº¦
# 2) &amp;#34;39.91652688240519322&amp;#34; # åŒ—äº¬çº¬åº¦
# 2) 1) &amp;#34;121.47370100021362305&amp;#34; # ä¸Šæµ·ç»åº¦
# 2) &amp;#34;31.23041599968796415&amp;#34; # ä¸Šæµ·çº¬åº¦
# 3) (nil) # å¹¿å·ä¸å­˜åœ¨
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-geodistè®¡ç®—ä¸¤åœ°è·ç¦»"&gt;3. GEODISTï¼šè®¡ç®—ä¸¤åœ°è·ç¦»
&lt;/h4&gt;&lt;p&gt;è¿”å›ä¸¤ä¸ªç»™å®šæˆå‘˜ä¹‹é—´çš„è·ç¦»ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;ï¼š&lt;code&gt;GEODIST key member1 member2 [unit]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å‚æ•° unit&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;m&lt;/code&gt;ï¼šç±³ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;km&lt;/code&gt;ï¼šåƒç±³ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mi&lt;/code&gt;ï¼šè‹±é‡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ft&lt;/code&gt;ï¼šè‹±å°ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;ï¼šè®¡ç®—å‡ºçš„è·ç¦»ï¼ˆåŒç²¾åº¦æµ®ç‚¹æ•°ï¼‰ï¼Œä»¥æŒ‡å®šçš„å•ä½è¡¨ç¤ºã€‚å¦‚æœæŸä¸ªæˆå‘˜ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› &lt;code&gt;nil&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GEODIST cities:geo Beijing Shanghai km # è®¡ç®—åŒ—äº¬åˆ°ä¸Šæµ·çš„ç›´çº¿è·ç¦»ï¼ˆåƒç±³ï¼‰
# è¾“å‡º: &amp;#34;1068.4354&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="4-geohashè·å–-geohash-å€¼"&gt;4. GEOHASHï¼šè·å– Geohash å€¼
&lt;/h4&gt;&lt;p&gt;è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜çš„ Geohash ç¼–ç å€¼ã€‚Geohash æ˜¯ä¸€ç§å°†äºŒç»´ç»çº¬åº¦ç¼–ç ä¸ºä¸€ç»´å­—ç¬¦ä¸²çš„ç®—æ³•ï¼Œå­—ç¬¦ä¸²è¶Šç›¸ä¼¼ï¼Œé€šå¸¸è¡¨ç¤ºåœ°ç†ä½ç½®è¶Šæ¥è¿‘ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;ï¼š&lt;code&gt;GEOHASH key member [member ...]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;ï¼šä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å¯¹åº”æˆå‘˜çš„ Geohash å­—ç¬¦ä¸²ã€‚å¦‚æœæˆå‘˜ä¸å­˜åœ¨ï¼Œåˆ™å¯¹åº”è¿”å› &lt;code&gt;nil&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GEOHASH cities:geo Beijing Shanghai
# è¾“å‡º:
# 1) &amp;#34;wx4g0s5w8e0&amp;#34; # åŒ—äº¬çš„Geohashå€¼
# 2) &amp;#34;wtw3sjt9vg0&amp;#34; # ä¸Šæµ·çš„Geohashå€¼
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="5-georadiusåŸºäºåæ ‡æŸ¥è¯¢åŠå¾„å†…çš„æˆå‘˜"&gt;5. GEORADIUSï¼šåŸºäºåæ ‡æŸ¥è¯¢åŠå¾„å†…çš„æˆå‘˜
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ï¼ˆæ³¨æ„ï¼šRedis 6.2 åŠä»¥ä¸Šç‰ˆæœ¬å»ºè®®ä½¿ç”¨ &lt;code&gt;GEOSEARCH&lt;/code&gt;å‘½ä»¤æ›¿ä»£æ­¤å‘½ä»¤ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œè¿”å›æŒ‡å®šåŠå¾„å†…çš„æˆå‘˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;ï¼š&lt;code&gt;GEORADIUS key longitude latitude radius unit [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count [ANY]] [ASC|DESC] [STORE key] [STOREDIST key]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¸¸ç”¨é€‰é¡¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;WITHDIST&lt;/code&gt;ï¼šåŒæ—¶è¿”å›æˆå‘˜ä¸ä¸­å¿ƒç‚¹çš„è·ç¦»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WITHCOORD&lt;/code&gt;ï¼šåŒæ—¶è¿”å›æˆå‘˜çš„ç»çº¬åº¦åæ ‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WITHHASH&lt;/code&gt;ï¼šåŒæ—¶è¿”å›æˆå‘˜çš„åŸå§‹ Geohash ç¼–ç åˆ†å€¼ï¼ˆ52ä½æœ‰ç¬¦å·æ•´æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;COUNT count&lt;/code&gt;ï¼šé™åˆ¶è¿”å›ç»“æœçš„æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ASC|DESC&lt;/code&gt;ï¼šæŒ‰è·ç¦»å‡åºæˆ–é™åºæ’åˆ—ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# æŸ¥è¯¢ç»åº¦116.40ã€çº¬åº¦39.90ä¸ºä¸­å¿ƒï¼ŒåŠå¾„1000å…¬é‡Œå†…çš„åŸå¸‚ï¼Œè¿”å›è·ç¦»å’Œåæ ‡ï¼ŒæŒ‰è·ç¦»å‡åºæ’åˆ—ï¼Œæœ€å¤šè¿”å›3ä¸ª
GEORADIUS cities:geo 116.40 39.90 1000 km WITHDIST WITHCOORD ASC COUNT 3
# è¾“å‡º:
# 1) 1) &amp;#34;Beijing&amp;#34; # æˆå‘˜åç§°
# 2) &amp;#34;108.5672&amp;#34; # è·ç¦»ä¸­å¿ƒç‚¹çš„è·ç¦»ï¼ˆkmï¼‰
# 3) 1) &amp;#34;116.39712828397750854&amp;#34; # ç»åº¦
# 2) &amp;#34;39.91652688240519322&amp;#34; # çº¬åº¦
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="6-georadiusbymemberåŸºäºæˆå‘˜æŸ¥è¯¢åŠå¾„å†…çš„æˆå‘˜"&gt;6. GEORADIUSBYMEMBERï¼šåŸºäºæˆå‘˜æŸ¥è¯¢åŠå¾„å†…çš„æˆå‘˜
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ï¼ˆæ³¨æ„ï¼šRedis 6.2 åŠä»¥ä¸Šç‰ˆæœ¬å»ºè®®ä½¿ç”¨ &lt;code&gt;GEOSEARCH&lt;/code&gt;å‘½ä»¤æ›¿ä»£æ­¤å‘½ä»¤ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»¥æŒ‡å®šçš„æˆå‘˜ä¸ºä¸­å¿ƒï¼Œè¿”å›æŒ‡å®šåŠå¾„å†…çš„å…¶ä»–æˆå‘˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;ï¼š&lt;code&gt;GEORADIUSBYMEMBER key member radius unit [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count [ANY]] [ASC|DESC] [STORE key] [STOREDIST key]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# ä»¥åŒ—äº¬ä¸ºä¸­å¿ƒï¼ŒæŸ¥è¯¢åŠå¾„1500å…¬é‡Œå†…çš„åŸå¸‚ï¼Œå¹¶è¿”å›è·ç¦»
GEORADIUSBYMEMBER cities:geo Beijing 1500 km WITHDIST
# è¾“å‡º:
# 1) 1) &amp;#34;Beijing&amp;#34; # æˆå‘˜åç§°
# 2) &amp;#34;0.0000&amp;#34; # è·ç¦»ï¼ˆä¸è‡ªèº«çš„è·ç¦»ä¸º0ï¼‰
# 2) 1) &amp;#34;Wuhan&amp;#34;
# 2) &amp;#34;1068.4354&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="7-geosearchå¼ºå¤§æœç´¢v62"&gt;7. GEOSEARCHï¼šå¼ºå¤§æœç´¢ï¼ˆv6.2+ï¼‰
&lt;/h4&gt;&lt;p&gt;Redis 6.2 å¼•å…¥çš„æ–°å‘½ä»¤ï¼Œæ•´åˆå¹¶å¢å¼ºäº† &lt;code&gt;GEORADIUS&lt;/code&gt;å’Œ &lt;code&gt;GEORADIUSBYMEMBER&lt;/code&gt;çš„åŠŸèƒ½ï¼Œè¯­æ³•æ›´ç»Ÿä¸€æ¸…æ™°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;ï¼š&lt;code&gt;GEOSEARCH key FROMMEMBER member | FROMLONLAT longitude latitude BYRADIUS radius unit | BYBOX width height unit [ASC|DESC] [COUNT count [ANY]] [WITHCOORD] [WITHDIST] [WITHHASH]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®å‚æ•°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;FROMMEMBER member&lt;/code&gt;ï¼šæŒ‡å®šä¸­å¿ƒç‚¹æˆå‘˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FROMLONLAT longitude latitude&lt;/code&gt;ï¼šæŒ‡å®šä¸­å¿ƒç‚¹ç»çº¬åº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BYRADIUS radius unit&lt;/code&gt;ï¼šæŒ‰åœ†å½¢èŒƒå›´æœç´¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BYBOX width height unit&lt;/code&gt;ï¼šæŒ‰çŸ©å½¢èŒƒå›´æœç´¢ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# ä»åŒ—äº¬æˆå‘˜å‡ºå‘ï¼Œæœç´¢1000å…¬é‡Œå†…çš„åŸå¸‚ï¼Œè¿”å›è·ç¦»å’Œåæ ‡ï¼ŒæŒ‰è·ç¦»å‡åº
GEOSEARCH cities:geo FROMMEMBER Beijing BYRADIUS 1000 km WITHDIST WITHCOORD ASC
# ä»ç»åº¦116.40ã€çº¬åº¦39.90å‡ºå‘ï¼Œæœç´¢ä¸€ä¸ª200km x 200kmçš„çŸ©å½¢åŒºåŸŸå†…çš„åŸå¸‚
GEOSEARCH cities:geo FROMLONLAT 116.40 39.90 BYBOX 200 200 km WITHDIST
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="8-geosearchstoreå­˜å‚¨æœç´¢ç»“æœv62"&gt;8. GEOSEARCHSTOREï¼šå­˜å‚¨æœç´¢ç»“æœï¼ˆv6.2+ï¼‰
&lt;/h4&gt;&lt;p&gt;å°† &lt;code&gt;GEOSEARCH&lt;/code&gt;å‘½ä»¤çš„æœç´¢ç»“æœå­˜å‚¨åˆ°ä¸€ä¸ªæ–°çš„ key ä¸­ï¼Œé€‚ç”¨äºéœ€è¦æŒä¹…åŒ–æˆ–åç»­å¤„ç†æœç´¢ç»“æœçš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;ï¼š&lt;code&gt;GEOSEARCHSTORE destination source FROMMEMBER member | FROMLONLAT longitude latitude BYRADIUS radius unit | BYBOX width height unit [ASC|DESC] [COUNT count [ANY]] [STOREDIST]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å‚æ•° &lt;code&gt;STOREDIST&lt;/code&gt;&lt;/strong&gt;ï¼šå­˜å‚¨æ—¶ä½¿ç”¨è·ç¦»ä½œä¸ºåˆ†å€¼ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„ Geohash åˆ†å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# å°†åŒ—äº¬1000å…¬é‡Œå†…çš„åŸå¸‚æœç´¢ç»“æœå­˜å‚¨åˆ°æ–°çš„é”® &amp;#39;near_beijing&amp;#39; ä¸­
GEOSEARCHSTORE near_beijing cities:geo FROMMEMBER Beijing BYRADIUS 1000 km ASC
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-äºŒredis-geo-åº”ç”¨åœºæ™¯ä¸ä½¿ç”¨æŠ€å·§"&gt;ğŸ“ äºŒã€Redis GEO åº”ç”¨åœºæ™¯ä¸ä½¿ç”¨æŠ€å·§
&lt;/h3&gt;&lt;p&gt;Redis Geospatial å‘½ä»¤éå¸¸é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é™„è¿‘çš„äºº/åœ°ç‚¹&lt;/strong&gt;ï¼šå¿«é€ŸæŸ¥æ‰¾ç”¨æˆ·å‘¨å›´ä¸€å®šèŒƒå›´å†…çš„å•†å®¶ã€æœ‹å‹æˆ–å…¶ä»–å…´è¶£ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·ç¦»è®¡ç®—&lt;/strong&gt;ï¼šç‰©æµã€å¤–å–ç­‰è¡Œä¸šè®¡ç®—ä¸¤ç‚¹é—´çš„ç›´çº¿è·ç¦»ï¼ˆè¯·æ³¨æ„è¿™æ˜¯çƒé¢è·ç¦»ï¼Œè€Œéå®é™…é“è·¯è·ç¦»ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœ°ç†å›´æ &lt;/strong&gt;ï¼šç›‘æ§è®¾å¤‡æˆ–ç”¨æˆ·æ˜¯å¦è¿›å…¥æˆ–ç¦»å¼€æŸä¸ªç‰¹å®šåœ°ç†åŒºåŸŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çƒ­é—¨åŒºåŸŸåˆ†æ&lt;/strong&gt;ï¼šé€šè¿‡åˆ†æåœ°ç†ä½ç½®æ•°æ®çš„åˆ†å¸ƒï¼Œäº†è§£åŸå¸‚çš„çƒ­ç‚¹åŒºåŸŸæˆ–äººç¾¤èšé›†åœ°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨æŠ€å·§ä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åº•å±‚æ˜¯ Sorted Set&lt;/strong&gt;ï¼šGEO ç±»å‹çš„ key æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª ZSETï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;ZREM&lt;/code&gt;æ¥åˆ é™¤æˆå‘˜ï¼Œä½¿ç”¨ &lt;code&gt;ZRANGE&lt;/code&gt;ç­‰å‘½ä»¤æ¥æŸ¥çœ‹æ‰€æœ‰æˆå‘˜ï¼ˆä½†çœ‹åˆ°çš„æ˜¯ Geohash åˆ†å€¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åæ ‡ç²¾åº¦&lt;/strong&gt;ï¼šæœ‰æ•ˆçš„ç»åº¦èŒƒå›´æ˜¯ -180 åˆ° 180 åº¦ï¼Œçº¬åº¦èŒƒå›´æ˜¯ -85.05112878 åˆ° 85.05112878 åº¦ã€‚è¶…å‡ºèŒƒå›´çš„åæ ‡ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œé”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è€ƒé‡&lt;/strong&gt;ï¼šå½“é›†åˆä¸­æˆå‘˜æ•°é‡æå¤§æ—¶ï¼ŒèŒƒå›´æŸ¥è¯¢å‘½ä»¤ï¼ˆå¦‚ &lt;code&gt;GEORADIUS&lt;/code&gt;ï¼‰å¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚å¯ä»¥è€ƒè™‘æŒ‰åœ°ç†åŒºåŸŸå¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼Œä½¿ç”¨å¤šä¸ª key æ¥å­˜å‚¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡çº§å‘½ä»¤&lt;/strong&gt;ï¼šå¦‚æœä½¿ç”¨çš„æ˜¯ Redis 6.2 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œ&lt;strong&gt;å»ºè®®ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;GEOSEARCH&lt;/code&gt;å’Œ &lt;code&gt;GEOSEARCHSTORE&lt;/code&gt;å‘½ä»¤&lt;/strong&gt;ï¼Œå®ƒä»¬æä¾›äº†æ›´ç»Ÿä¸€çš„è¯­æ³•å’Œé¢å¤–çš„åŠŸèƒ½ï¼ˆå¦‚çŸ©å½¢èŒƒå›´æŸ¥è¯¢ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚å½¢çŠ¶å¤„ç†&lt;/strong&gt;ï¼šRedis GEO åŸç”Ÿæ”¯æŒåœ†å½¢å’ŒçŸ©å½¢èŒƒå›´æŸ¥è¯¢ã€‚å¯¹äºæ›´å¤æ‚çš„å¤šè¾¹å½¢åŒºåŸŸåˆ¤æ–­ï¼Œéœ€è¦åœ¨åº”ç”¨å±‚ç»“åˆå…¶ä»–ç®—æ³•ï¼ˆå¦‚å°„çº¿æ³•ï¼‰æ¥å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ Redis Geospatial å‘½ä»¤ä»‹ç»èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨å®ƒæ¥æ„å»ºä½ çš„åŸºäºä½ç½®æœåŠ¡çš„åº”ç”¨ï¼&lt;/p&gt;
&lt;h2 id="redis-äº‹åŠ¡"&gt;REDIS äº‹åŠ¡
&lt;/h2&gt;&lt;p&gt;Redis äº‹åŠ¡æä¾›äº†ä¸€ç§å°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…ï¼Œç„¶åä¸€æ¬¡æ€§ã€æŒ‰é¡ºåºæ‰§è¡Œçš„æœºåˆ¶ã€‚å®ƒå¹¶éä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ä¸­çš„äº‹åŠ¡ï¼Œç†è§£å…¶ç‹¬ç‰¹æ€§å’Œå·¥ä½œåŸç†å¯¹æ­£ç¡®ä½¿ç”¨è‡³å…³é‡è¦ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ è¯¦ç»†è§£æ Redis äº‹åŠ¡çš„æ ¸å¿ƒè¦ç‚¹ã€‚&lt;/p&gt;
&lt;h3 id="-ä¸€æ ¸å¿ƒæ¦‚å¿µä¸å‘½ä»¤"&gt;ğŸ§  ä¸€ã€æ ¸å¿ƒæ¦‚å¿µä¸å‘½ä»¤
&lt;/h3&gt;&lt;p&gt;Redis äº‹åŠ¡çš„æœ¬è´¨æ˜¯&lt;strong&gt;å‘½ä»¤é˜Ÿåˆ—&lt;/strong&gt;ã€‚é€šè¿‡ &lt;code&gt;MULTI&lt;/code&gt;ã€&lt;code&gt;EXEC&lt;/code&gt;ã€&lt;code&gt;DISCARD&lt;/code&gt;å’Œ &lt;code&gt;WATCH&lt;/code&gt;å››ä¸ªå‘½ä»¤å®ç°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;MULTI&lt;/code&gt;&lt;/strong&gt;ï¼šæ ‡è®°äº‹åŠ¡å¼€å§‹ã€‚æ­¤åæ‰€æœ‰å‘½ä»¤éƒ½è¿›å…¥é˜Ÿåˆ—ï¼Œä¸ä¼šç«‹å³æ‰§è¡Œï¼ŒæœåŠ¡å™¨è¿”å› &lt;code&gt;QUEUED&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;EXEC&lt;/code&gt;&lt;/strong&gt;ï¼šæ‰§è¡Œäº‹åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤ï¼ŒæŒ‰é¡ºåºè¿”å›æ¯ä¸ªå‘½ä»¤çš„ç»“æœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;DISCARD&lt;/code&gt;&lt;/strong&gt;ï¼šæ¸…ç©ºäº‹åŠ¡é˜Ÿåˆ—ï¼Œå¹¶æ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;WATCH&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;MULTI&lt;/code&gt;ä¹‹å‰æ‰§è¡Œï¼Œç”¨äºç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ªé”®ã€‚è¿™æ˜¯ Redis å®ç°&lt;strong&gt;ä¹è§‚é”&lt;/strong&gt;çš„å…³é”®ã€‚å¦‚æœåœ¨ &lt;code&gt;EXEC&lt;/code&gt;æ‰§è¡Œå‰ï¼Œä»»ä½•è¢«ç›‘è§†çš„é”®è¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹ï¼Œåˆ™å½“å‰äº‹åŠ¡å°†è¢«æ‰“æ–­ï¼ˆè¿”å› &lt;code&gt;nil&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-äºŒäº‹åŠ¡æ‰§è¡Œæµç¨‹ä¸é˜¶æ®µ"&gt;ğŸ”„ äºŒã€äº‹åŠ¡æ‰§è¡Œæµç¨‹ä¸é˜¶æ®µ
&lt;/h3&gt;&lt;p&gt;ä¸€ä¸ª Redis äº‹åŠ¡ä»å¼€å§‹åˆ°ç»“æŸä¼šç»å†ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼€å¯äº‹åŠ¡&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯æ‰§è¡Œ &lt;code&gt;MULTI&lt;/code&gt;å‘½ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‘½ä»¤å…¥é˜Ÿ&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å‘é€éœ€è¦åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤ä¼šè¢«æœåŠ¡å™¨æ”¾å…¥é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œäº‹åŠ¡&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯æ‰§è¡Œ &lt;code&gt;EXEC&lt;/code&gt;å‘½ä»¤ï¼ŒæœåŠ¡å™¨æŒ‰é¡ºåºæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸‰é”™è¯¯å¤„ç†ä¸åŸå­æ€§"&gt;âš ï¸ ä¸‰ã€é”™è¯¯å¤„ç†ä¸åŸå­æ€§
&lt;/h3&gt;&lt;p&gt;Redis äº‹åŠ¡çš„åŸå­æ€§ï¼ˆAtomicityï¼‰ä¸ä¼ ç»Ÿæ•°æ®åº“ä¸åŒï¼Œè¿™æ˜¯æœ€éœ€è¦ç†è§£çš„ä¸€ç‚¹ã€‚é”™è¯¯åˆ†ä¸ºä¸¤ç§ï¼Œå¤„ç†æ–¹å¼ä¹Ÿä¸åŒï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é”™è¯¯ç±»å‹&lt;/th&gt;
&lt;th&gt;è§¦å‘æ—¶æœº&lt;/th&gt;
&lt;th&gt;å¯¹äº‹åŠ¡çš„å½±å“&lt;/th&gt;
&lt;th&gt;æ˜¯å¦ä¿è¯åŸå­æ€§&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¥é˜Ÿé”™è¯¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‘½ä»¤å…¥é˜Ÿæ—¶ï¼ˆå¦‚è¯­æ³•é”™è¯¯ã€å‘½ä»¤ä¸å­˜åœ¨ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ•´ä¸ªäº‹åŠ¡è¢«æ‹’ç»æ‰§è¡Œ&lt;/strong&gt;ï¼Œ&lt;code&gt;EXEC&lt;/code&gt;è¿”å›é”™è¯¯&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿è¡Œæ—¶é”™è¯¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‘½ä»¤æ‰§è¡Œæ—¶ï¼ˆå¦‚å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ &lt;code&gt;INCR&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åªæœ‰å¤±è´¥çš„å‘½ä»¤ä¸æ‰§è¡Œï¼Œå…¶ä»–å‘½ä»¤ç»§ç»­æ‰§è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¦&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…¥é˜Ÿé”™è¯¯ï¼ˆåŸå­æ€§ï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;gt; MULTI
OK
&amp;gt; SET key1 value1
QUEUED
&amp;gt; NONEXISTINGCOMMAND # è¿™æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„å‘½ä»¤ï¼Œå…¥é˜Ÿæ—¶å³æŠ¥é”™
(error) ERR unknown command &amp;#39;NONEXISTINGCOMMAND&amp;#39;
&amp;gt; EXEC # æ‰§è¡Œäº‹åŠ¡æ—¶ä¼šå› ä¹‹å‰çš„é”™è¯¯è€Œå¤±è´¥
(error) EXECABORT Transaction discarded because of previous errors.
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¿è¡Œæ—¶é”™è¯¯ï¼ˆéåŸå­æ€§ï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;gt; SET key1 &amp;#34;hello&amp;#34; # è®¾ç½®ä¸€ä¸ªå­—ç¬¦ä¸²
OK
&amp;gt; MULTI
OK
&amp;gt; INCR key1 # å°è¯•å¯¹å­—ç¬¦ä¸²åšé€’å¢ï¼ˆä¼šå¤±è´¥ï¼‰
QUEUED
&amp;gt; SET key2 &amp;#34;world&amp;#34; # å¦ä¸€ä¸ªæ­£ç¡®çš„å‘½ä»¤
QUEUED
&amp;gt; EXEC
1) (error) ERR value is not an integer or out of range # ç¬¬ä¸€æ¡å‘½ä»¤æ‰§è¡Œé”™è¯¯
2) OK # ç¬¬äºŒæ¡å‘½ä»¤æˆåŠŸæ‰§è¡Œäº†ï¼
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å››watch-ä¸ä¹è§‚é”"&gt;ğŸ›¡ï¸ å››ã€WATCH ä¸ä¹è§‚é”
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;WATCH&lt;/code&gt;å‘½ä»¤æ˜¯ Redis å®ç°&lt;strong&gt;ä¹è§‚é”ï¼ˆOptimistic Lockï¼‰&lt;/strong&gt; çš„æ ¸å¿ƒæœºåˆ¶ï¼Œç”¨äºè§£å†³å¹¶å‘ä¿®æ”¹é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®¢æˆ·ç«¯ä½¿ç”¨ &lt;code&gt;WATCH&lt;/code&gt;ç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ªé”®ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯å¼€å¯äº‹åŠ¡ï¼ˆ&lt;code&gt;MULTI&lt;/code&gt;ï¼‰å¹¶æ’é˜Ÿå‘½ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;å½“æ‰§è¡Œ &lt;code&gt;EXEC&lt;/code&gt;æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæ£€æŸ¥æ‰€æœ‰è¢«ç›‘è§†çš„é”®&lt;strong&gt;è‡ª &lt;code&gt;WATCH&lt;/code&gt;åæ˜¯å¦è¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹è¿‡&lt;/strong&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;å¦‚æœ&lt;strong&gt;æ²¡æœ‰&lt;/strong&gt;è¢«ä¿®æ”¹ï¼Œäº‹åŠ¡å°†æ­£å¸¸æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœ&lt;strong&gt;æœ‰&lt;/strong&gt;è¢«ä¿®æ”¹ï¼Œäº‹åŠ¡å°†&lt;strong&gt;ä¸ä¼šæ‰§è¡Œ&lt;/strong&gt;ï¼ˆè¿”å› &lt;code&gt;nil&lt;/code&gt;ï¼‰ï¼Œå®¢æˆ·ç«¯é€šå¸¸éœ€è¦è¿›è¡Œé‡è¯•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹åœºæ™¯&lt;/strong&gt;ï¼šå®ç°ä¸€ä¸ªå®‰å…¨çš„ä½™é¢æ‰£å‡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# å®¢æˆ·ç«¯ A
&amp;gt; WATCH balance:user1 # ç›‘è§†ç”¨æˆ·ä½™é¢
OK
&amp;gt; GET balance:user1 # è·å–å½“å‰ä½™é¢ï¼Œå‡è®¾æ˜¯ 100
&amp;#34;100&amp;#34;
&amp;gt; MULTI
OK
&amp;gt; DECRBY balance:user1 20 # è®¡åˆ’æ‰£å‡ 20
QUEUED
# æ­¤æ—¶ï¼Œå®¢æˆ·ç«¯ B ä¿®æ”¹äº† balance:user1ï¼Œå°†å…¶è®¾ç½®ä¸º 50
&amp;gt; EXEC # å®¢æˆ·ç«¯ A æ‰§è¡Œäº‹åŠ¡
(nil) # äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå› ä¸ºè¢«ç›‘è§†çš„é”®åœ¨æœŸé—´è¢«ä¿®æ”¹
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ A çš„æ‰£å‡æ“ä½œä¸ä¼šæ‰§è¡Œï¼Œä»è€Œé¿å…äº†æ•°æ®ä¸ä¸€è‡´ã€‚å¼€å‘è€…é€šå¸¸ä¼šåœ¨ä»£ç ä¸­æ•è·è¿™ç§å¤±è´¥å¹¶è¿›è¡Œé‡è¯•ã€‚&lt;/p&gt;
&lt;h3 id="-äº”acid-ç‰¹æ€§åˆ†æ"&gt;ğŸ“Š äº”ã€ACID ç‰¹æ€§åˆ†æ
&lt;/h3&gt;&lt;p&gt;Redis äº‹åŠ¡å¯¹ ACID ç‰¹æ€§çš„æ”¯æŒä¸ä¼ ç»Ÿæ•°æ®åº“æœ‰æ‰€åŒºåˆ«ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;æ”¯æŒæƒ…å†µ&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§ (Atomicity)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éƒ¨åˆ†æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦‚å‰æ‰€è¿°ï¼Œ&lt;strong&gt;ä»…å½“æ‰€æœ‰å‘½ä»¤éƒ½æˆåŠŸæˆ–å‘ç”Ÿå…¥é˜Ÿé”™è¯¯æ—¶æ‰å…·æœ‰åŸå­æ€§&lt;/strong&gt;ã€‚è¿è¡Œæ—¶é”™è¯¯ä¼šå¯¼è‡´éƒ¨åˆ†æˆåŠŸã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€è‡´æ€§ (Consistency)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº‹åŠ¡æ‰§è¡Œåï¼Œæ•°æ®åº“ä¼šä¿æŒä¸€è‡´çŠ¶æ€ã€‚å…¥é˜Ÿé”™è¯¯æˆ– &lt;code&gt;WATCH&lt;/code&gt;å¤±è´¥ä¼šé˜»æ­¢ä¸ä¸€è‡´äº‹åŠ¡çš„æ‰§è¡Œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éš”ç¦»æ€§ (Isolation)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å®Œå…¨æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Redis çš„å•çº¿ç¨‹æ¨¡å‹ä¿è¯äº†æ‰€æœ‰å‘½ä»¤æ€»æ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œäº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ‰“æ–­ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŒä¹…æ€§ (Durability)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–é…ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å–å†³äº Redis çš„æŒä¹…åŒ–è®¾ç½®ï¼ˆRDB å¿«ç…§æˆ– AOF æ—¥å¿—ï¼‰ã€‚å³ä½¿å¼€å¯äº†æŒä¹…åŒ–ï¼Œä¹Ÿå­˜åœ¨æ•°æ®ä¸¢å¤±çš„çª—å£æœŸã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å…­äº‹åŠ¡çš„å±€é™æ€§"&gt;âš–ï¸ å…­ã€äº‹åŠ¡çš„å±€é™æ€§
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ”¯æŒå›æ»š (Rollback)&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€æ˜¾è‘—çš„å±€é™ã€‚ä¸€æ—¦æŸä¸ªå‘½ä»¤åœ¨ &lt;code&gt;EXEC&lt;/code&gt;é˜¶æ®µæˆåŠŸæ‰§è¡Œï¼Œå³ä½¿åç»­å‘½ä»¤å¤±è´¥ï¼Œä¹Ÿæ— æ³•æ’¤é”€å·²æ‰§è¡Œçš„å‘½ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤é™åˆ¶&lt;/strong&gt;ï¼šåœ¨ Redis Cluster æ¨¡å¼ä¸‹ï¼Œ&lt;strong&gt;ä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤å¿…é¡»å­˜å‚¨åœ¨åŒä¸€ä¸ªå“ˆå¸Œæ§½ (hash slot) ä¸­&lt;/strong&gt;ï¼Œå¦åˆ™äº‹åŠ¡ä¼šå¤±è´¥ã€‚è¿™å¤§å¤§é™åˆ¶äº†äº‹åŠ¡åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;ï¼šé•¿æ—¶é—´è¿è¡Œçš„äº‹åŠ¡ï¼ˆå‘½ä»¤é˜Ÿåˆ—å¾ˆé•¿ï¼‰ä¼šé˜»å¡æœåŠ¡å™¨ï¼Œå› ä¸º Redis æ˜¯å•çº¿ç¨‹çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸ƒæœ€ä½³å®è·µä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;ğŸ’¡ ä¸ƒã€æœ€ä½³å®è·µä¸æ›¿ä»£æ–¹æ¡ˆ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¿æŒäº‹åŠ¡çŸ­å°&lt;/strong&gt;ï¼šé¿å…åœ¨äº‹åŠ¡ä¸­æ”¾å…¥è¿‡å¤šå‘½ä»¤ï¼Œä»¥å‡å°‘å¯¹ Redis æœåŠ¡å™¨çš„é˜»å¡æ—¶é—´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å–„ç”¨ &lt;code&gt;WATCH&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨æ¶‰åŠå¹¶å‘æ•°æ®ä¿®æ”¹çš„åœºæ™¯ï¼ˆå¦‚åº“å­˜æ‰£å‡ã€ä½™é¢å˜æ›´ï¼‰ä¸‹ï¼ŒåŠ¡å¿…ä½¿ç”¨ &lt;code&gt;WATCH&lt;/code&gt;å®ç°ä¹è§‚é”ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è€ƒè™‘ä½¿ç”¨ Lua è„šæœ¬&lt;/strong&gt;ï¼šå¯¹äºéœ€è¦&lt;strong&gt;å¼ºåŸå­æ€§&lt;/strong&gt;çš„å¤æ‚æ“ä½œï¼Œ&lt;strong&gt;Lua è„šæœ¬æ˜¯æ›´å¥½çš„é€‰æ‹©&lt;/strong&gt;ã€‚æ•´ä¸ªè„šæœ¬åœ¨æ‰§è¡Œæ—¶æ˜¯åŸå­æ€§çš„ï¼Œä¸­é—´ä¸ä¼šæ’å…¥å…¶ä»–å‘½ä»¤ï¼Œå¹¶ä¸”é€»è¾‘å¯ä»¥éå¸¸çµæ´»ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;EVAL &amp;#34;local current = redis.call(&amp;#39;GET&amp;#39;, KEYS[1]); if tonumber(current) &amp;gt;= tonumber(ARGV[1]) then return redis.call(&amp;#39;DECRBY&amp;#39;, KEYS[1], ARGV[1]); else return -1; end;&amp;#34; 1 inventory:item1 5
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Pipeline ä¸äº‹åŠ¡çš„åŒºåˆ«&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Pipeline&lt;/strong&gt; ä¸»è¦ç›®çš„æ˜¯&lt;strong&gt;å‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°&lt;/strong&gt;ï¼Œå°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…å‘é€ï¼ŒæœåŠ¡å™¨ä¾ç„¶é€æ¡æ‰§è¡Œï¼Œ&lt;strong&gt;ä¸ä¿è¯åŸå­æ€§&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡&lt;/strong&gt; çš„æ ¸å¿ƒæ˜¯&lt;strong&gt;ä¿è¯å‘½ä»¤çš„éš”ç¦»æ€§å’Œé¡ºåºæ€§&lt;/strong&gt;ï¼ˆå°½ç®¡åŸå­æ€§ä¸å¼ºï¼‰ï¼Œæ‰€æœ‰å‘½ä»¤åœ¨ &lt;code&gt;EXEC&lt;/code&gt;æ—¶ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Redis äº‹åŠ¡æ˜¯ä¸€ä¸ª&lt;strong&gt;å‘½ä»¤æ‰“åŒ…å’Œé¡ºåºæ‰§è¡Œçš„æœºåˆ¶&lt;/strong&gt;ï¼Œå®ƒæä¾›äº†&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;å’Œ&lt;strong&gt;ä¸€å®šçš„åŸå­æ€§&lt;/strong&gt;ï¼ˆé’ˆå¯¹å…¥é˜Ÿé”™è¯¯ï¼‰ã€‚å…¶ä¸»è¦ä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¡®ä¿ä¸€æ‰¹å‘½ä»¤ä¸è¢«å…¶ä»–å®¢æˆ·ç«¯æ‰“æ–­&lt;/strong&gt;ï¼ˆéš”ç¦»æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ &lt;strong&gt;&lt;code&gt;WATCH&lt;/code&gt;æœºåˆ¶&lt;/strong&gt;åœ¨åº”ç”¨å±‚å®ç°&lt;strong&gt;ä¹è§‚é”&lt;/strong&gt;ï¼Œå¤„ç†ç®€å•å¹¶å‘é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºéœ€è¦å¼ºåŸå­æ€§æˆ–å¤æ‚é€»è¾‘çš„åœºæ™¯ï¼Œåº”ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ &lt;strong&gt;Lua è„šæœ¬&lt;/strong&gt;ã€‚ç†è§£è¿™äº›ç‰¹æ€§å’Œå±€é™ï¼Œèƒ½å¸®åŠ©ä½ åœ¨æ­£ç¡®çš„åœºæ™¯ä¸‹æœ‰æ•ˆåœ°ä½¿ç”¨ Redis äº‹åŠ¡ã€‚&lt;/p&gt;
&lt;h2 id="culster-replicate"&gt;Culster Replicate
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;CLUSTER REPLICATE&lt;/code&gt;æ˜¯ Redis Cluster ä¸­ç”¨äº&lt;strong&gt;æ‰‹åŠ¨ç®¡ç†ä¸»ä»å…³ç³»&lt;/strong&gt;çš„æ ¸å¿ƒå‘½ä»¤ã€‚å®ƒå…è®¸ä½ å°†ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å®šä¸ºå¦ä¸€ä¸ªèŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼ˆSlaveï¼‰ï¼Œä»è€Œå»ºç«‹å¤åˆ¶å…³ç³»ï¼Œè¿™æ˜¯å®ç°é›†ç¾¤&lt;strong&gt;é«˜å¯ç”¨æ€§&lt;/strong&gt;å’Œ&lt;strong&gt;æ•°æ®å†—ä½™&lt;/strong&gt;çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº† &lt;code&gt;CLUSTER REPLICATE&lt;/code&gt;å‘½ä»¤çš„æ ¸å¿ƒä¿¡æ¯ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ–¹é¢&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸºæœ¬è¯­æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;CLUSTER REPLICATE &amp;lt;master-node-id&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å°†å½“å‰æ‰§è¡Œçš„èŠ‚ç‚¹é…ç½®ä¸ºæŒ‡å®š &lt;code&gt;master-node-id&lt;/code&gt;çš„ä»èŠ‚ç‚¹ï¼Œå¹¶å¼€å§‹å¤åˆ¶å…¶æ•°æ®ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œå‰æ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1. æ‰€æœ‰èŠ‚ç‚¹å‡å·²å¯åŠ¨å¹¶åŠ å…¥é›†ç¾¤ï¼ˆé€šè¿‡ &lt;code&gt;CLUSTER MEET&lt;/code&gt;ï¼‰ã€‚ 2. æ‰§è¡Œå‘½ä»¤çš„èŠ‚ç‚¹å¿…é¡»æ˜¯&lt;strong&gt;ç©ºèŠ‚ç‚¹&lt;/strong&gt;ï¼ˆæœªåˆ†é…æ§½ä¸”éä»»ä½•èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿæ•ˆç»“æœ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰§è¡ŒèŠ‚ç‚¹æˆä¸ºä»èŠ‚ç‚¹ï¼Œå¼€å§‹å¼‚æ­¥å¤åˆ¶ä¸»èŠ‚ç‚¹çš„æ•°æ®ï¼Œå¹¶åœ¨ä¸»èŠ‚ç‚¹æ•…éšœæ—¶å…·å¤‡è¢«æå‡ä¸ºæ–°ä¸»èŠ‚ç‚¹çš„èµ„æ ¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1. é›†ç¾¤åˆå§‹åŒ–åæ‰‹åŠ¨å»ºç«‹ä¸»ä»å…³ç³»ã€‚ 2. é›†ç¾¤æ‰©å®¹æ—¶æ·»åŠ æ–°çš„ä»èŠ‚ç‚¹ã€‚ 3. è°ƒæ•´ç°æœ‰å¤åˆ¶å…³ç³»ï¼ˆå¤åˆ¶è¿ç§»ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å‘½ä»¤è¯­æ³•ä¸å‚æ•°"&gt;ğŸ–¥ï¸ å‘½ä»¤è¯­æ³•ä¸å‚æ•°
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;CLUSTER REPLICATE &amp;lt;master-node-id&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;&amp;lt;master-node-id&amp;gt;&lt;/code&gt;&lt;/strong&gt;ï¼šè¿™æ˜¯ç›®æ ‡ä¸»èŠ‚ç‚¹åœ¨é›†ç¾¤ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚å®ƒæ˜¯ä¸€ä¸ªç”± 40 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ &lt;code&gt;3a2b5c9d1e0f4a7b8c6d5e4f3a2b1c0d9e8f7a6&lt;/code&gt;ï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡åœ¨ä»»ä½•é›†ç¾¤èŠ‚ç‚¹ä¸Šæ‰§è¡Œ &lt;code&gt;CLUSTER NODES&lt;/code&gt;å‘½ä»¤æ¥æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹çš„ ID å’Œè§’è‰²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¦‚ä½•ä½¿ç”¨æ­¥éª¤ä¸ç¤ºä¾‹"&gt;ğŸ“œ å¦‚ä½•ä½¿ç”¨ï¼šæ­¥éª¤ä¸ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;å‡è®¾ä½ æœ‰ä¸€ä¸ªå·²è¿è¡Œçš„ Redis Clusterï¼Œå…¶ä¸­åŒ…å«ä¸»èŠ‚ç‚¹ &lt;code&gt;M1&lt;/code&gt;(ID: &lt;code&gt;master-id-123&lt;/code&gt;)ï¼Œä½ æƒ³å°†å¦ä¸€ä¸ªèŠ‚ç‚¹ &lt;code&gt;S1&lt;/code&gt;é…ç½®ä¸ºå…¶ä»èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¡®è®¤ä¸»èŠ‚ç‚¹ ID&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;è¿æ¥åˆ°é›†ç¾¤ä¸­çš„ä»»æ„èŠ‚ç‚¹ï¼Œæ‰§è¡Œ &lt;code&gt;CLUSTER NODES&lt;/code&gt;ï¼Œåœ¨è¾“å‡ºåˆ—è¡¨ä¸­æ‰¾åˆ°ä½ æƒ³è¦ä½œä¸ºä¸»èŠ‚ç‚¹çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œå¹¶è®°å½•å…¶å®Œæ•´çš„èŠ‚ç‚¹ IDã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;$ redis-cli -c -p 6379
127.0.0.1:6379&amp;gt; CLUSTER NODES
... master-id-123 172.18.0.2:7001@17001 master - 0 1650000000000 1 connected 0-5460 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åœ¨ä»èŠ‚ç‚¹ä¸Šæ‰§è¡Œå‘½ä»¤&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;è¿æ¥åˆ°&lt;strong&gt;ä½ æƒ³è¦è®¾ç½®ä¸ºä»èŠ‚ç‚¹&lt;/strong&gt;çš„ Redis å®ä¾‹ï¼ˆä¾‹å¦‚ &lt;code&gt;S1&lt;/code&gt;ï¼Œè¿è¡Œåœ¨ &lt;code&gt;172.18.0.5:7004&lt;/code&gt;ï¼‰ï¼Œç„¶åæ‰§è¡Œ &lt;code&gt;CLUSTER REPLICATE&lt;/code&gt;å‘½ä»¤å¹¶æŒ‡å®šä¸Šä¸€æ­¥æ‰¾åˆ°çš„ä¸»èŠ‚ç‚¹ IDã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;$ redis-cli -c -h 172.18.0.5 -p 7004 # è¿æ¥åˆ°æœªæ¥å°†ä»èŠ‚ç‚¹çš„S1
172.18.0.5:7004&amp;gt; CLUSTER REPLICATE master-id-123
OK
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éªŒè¯å¤åˆ¶å…³ç³»&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å†æ¬¡åœ¨ä»»ä½•é›†ç¾¤èŠ‚ç‚¹ä¸Šæ‰§è¡Œ &lt;code&gt;CLUSTER NODES&lt;/code&gt;ã€‚å¦‚æœé…ç½®æˆåŠŸï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼Œæ˜ç¡®æ˜¾ç¤ºäº†ä¸»ä»å…³ç³»ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;master-id-123 172.18.0.2:7001@17001 master - 0 1650000001000 1 connected 0-5460
slave-id-456 172.18.0.5:7004@17004 slave master-id-123 0 1650000002000 4 connected
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¾“å‡ºä¸­çš„ &lt;code&gt;slave master-id-123&lt;/code&gt;è¡¨ç¤ºèŠ‚ç‚¹ &lt;code&gt;slave-id-456&lt;/code&gt;æ˜¯ &lt;code&gt;master-id-123&lt;/code&gt;çš„ä»èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸»è¦åº”ç”¨åœºæ™¯"&gt;âš™ï¸ ä¸»è¦åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åˆå§‹åŒ–é›†ç¾¤æ—¶æ‰‹åŠ¨æŒ‡å®šä¸»ä»å…³ç³»&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;redis-cli --cluster create&lt;/code&gt;åˆ›å»ºé›†ç¾¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;--cluster-replicas &amp;lt;num&amp;gt;&lt;/code&gt;å‚æ•°è‡ªåŠ¨åˆ†é…ä¸»ä»å…³ç³»ã€‚ä½†å¦‚æœä½ å¸Œæœ›&lt;strong&gt;ç²¾ç¡®æ§åˆ¶&lt;/strong&gt;å“ªä¸ªä»èŠ‚ç‚¹å¤åˆ¶å“ªä¸ªä¸»èŠ‚ç‚¹ï¼Œå¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªåªæœ‰ä¸»èŠ‚ç‚¹çš„é›†ç¾¤ï¼ˆä½¿ç”¨ &lt;code&gt;--cluster-replicas 0&lt;/code&gt;ï¼‰ï¼Œç„¶åé€šè¿‡ &lt;code&gt;CLUSTER REPLICATE&lt;/code&gt;å‘½ä»¤æ‰‹åŠ¨ä¸ºæ¯ä¸ªä¸»èŠ‚ç‚¹æ·»åŠ ä½ å¸Œæœ›çš„ä»èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é›†ç¾¤æ‰©å®¹ï¼Œæ·»åŠ æ–°çš„ä»èŠ‚ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å½“ä½ éœ€è¦å‘ç°æœ‰é›†ç¾¤æ·»åŠ æ–°çš„ä»èŠ‚ç‚¹ä»¥æå‡è¯»èƒ½åŠ›æˆ–å¢å¼ºé«˜å¯ç”¨æ€§æ—¶ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯åŠ¨ä¸€ä¸ªæ–°çš„ Redis å®ä¾‹ï¼Œå¹¶ä½¿ç”¨ &lt;code&gt;CLUSTER MEET&lt;/code&gt;å‘½ä»¤è®©å…¶åŠ å…¥é›†ç¾¤ï¼ˆæˆ–ä½¿ç”¨ &lt;code&gt;redis-cli --cluster add-node&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®ä¿æ–°èŠ‚ç‚¹æ˜¯ç©ºçš„ï¼ˆæ²¡æœ‰åˆ†é…å“ˆå¸Œæ§½ï¼Œä¹Ÿä¸æ˜¯ä»»ä½•èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨è¯¥æ–°èŠ‚ç‚¹ä¸Šæ‰§è¡Œ &lt;code&gt;CLUSTER REPLICATE &amp;lt;master-node-id&amp;gt;&lt;/code&gt;ï¼Œä½¿å…¶æˆä¸ºæŒ‡å®šä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è°ƒæ•´å¤åˆ¶å…³ç³»ï¼ˆå¤åˆ¶è¿ç§»ï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥é€šè¿‡ &lt;code&gt;CLUSTER REPLICATE&lt;/code&gt;å‘½ä»¤å°†ä¸€ä¸ªä»èŠ‚ç‚¹&lt;strong&gt;é‡æ–°æŒ‡å®š&lt;/strong&gt;ç»™å¦ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œä»èŠ‚ç‚¹ &lt;code&gt;S1&lt;/code&gt;å½“å‰å¤åˆ¶ä¸»èŠ‚ç‚¹ &lt;code&gt;M1&lt;/code&gt;ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨ä¸Šé¢æ‰§è¡Œ &lt;code&gt;CLUSTER REPLICATE &amp;lt;M2-node-id&amp;gt;&lt;/code&gt;å‘½ä»¤ï¼Œè®©å…¶æ”¹ä¸ºå¤åˆ¶ä¸»èŠ‚ç‚¹ &lt;code&gt;M2&lt;/code&gt;ã€‚è¿™åœ¨&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;æˆ–&lt;strong&gt;æ•…éšœæ¢å¤åé‡æ–°å¹³è¡¡é›†ç¾¤&lt;/strong&gt;æ—¶éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-é‡è¦æ³¨æ„äº‹é¡¹"&gt;âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹çŠ¶æ€&lt;/strong&gt;ï¼šæ‰§è¡Œ &lt;code&gt;CLUSTER REPLICATE&lt;/code&gt;å‘½ä»¤çš„èŠ‚ç‚¹å¿…é¡»æ˜¯ä¸€ä¸ª&lt;strong&gt;ç©ºèŠ‚ç‚¹&lt;/strong&gt;ï¼Œå³å®ƒä¸èƒ½æ˜¯ä»»ä½•å“ˆå¸Œæ§½çš„æŒæœ‰è€…ï¼Œå¹¶ä¸”å½“å‰ä¸èƒ½æ˜¯ä»»ä½•å…¶ä»–èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ã€‚å¦‚æœè¯¥èŠ‚ç‚¹ä¹‹å‰æ˜¯ä¸»èŠ‚ç‚¹å¹¶æŒæœ‰å“ˆå¸Œæ§½ï¼Œä½ éœ€è¦å…ˆä½¿ç”¨ &lt;code&gt;redis-cli --cluster reshard&lt;/code&gt;ç­‰å‘½ä»¤å°†å…¶æ§½ä½è¿ç§»åˆ°å…¶ä»–ä¸»èŠ‚ç‚¹ï¼Œå¹¶é‡ç½®è¯¥èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åŒæ­¥&lt;/strong&gt;ï¼šä¸€æ—¦å¤åˆ¶å…³ç³»å»ºç«‹ï¼Œä»èŠ‚ç‚¹ä¼š&lt;strong&gt;å¼‚æ­¥åœ°&lt;/strong&gt;å¼€å§‹ä»ä¸»èŠ‚ç‚¹åŒæ­¥æ•°æ®ã€‚åœ¨æ­¤æœŸé—´ï¼Œä»èŠ‚ç‚¹çš„æ•°æ®å¯èƒ½ä¼šæš‚æ—¶è½åäºä¸»èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æŒä¹…åŒ–&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;CLUSTER REPLICATE&lt;/code&gt;è®¾ç½®çš„å¤åˆ¶å…³ç³»ä¼šè¢«æŒä¹…åŒ–åˆ°è¯¥èŠ‚ç‚¹çš„é›†ç¾¤é…ç½®æ–‡ä»¶ï¼ˆç”± &lt;code&gt;cluster-config-file&lt;/code&gt;æŒ‡å®šï¼‰ä¸­ã€‚èŠ‚ç‚¹é‡å¯åä¼šè‡ªåŠ¨æ¢å¤æ­¤å¤åˆ¶å…³ç³»ï¼Œæ— éœ€é‡æ–°é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨æ€§&lt;/strong&gt;ï¼šä¸€æ—¦ä»èŠ‚ç‚¹æˆåŠŸå¤åˆ¶æŸä¸ªä¸»èŠ‚ç‚¹ï¼Œå®ƒå°±æˆä¸ºäº†è¯¥ä¸»èŠ‚ç‚¹çš„å¤‡ä»½ã€‚å¦‚æœè¯¥ä¸»èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œé›†ç¾¤çš„æ•…éšœè½¬ç§»æœºåˆ¶ï¼ˆç”±å…¶ä»–ä¸»èŠ‚ç‚¹æŠ•ç¥¨ï¼‰å¯èƒ½ä¼š&lt;strong&gt;è‡ªåŠ¨å°†è¯¥ä»èŠ‚ç‚¹æå‡ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹&lt;/strong&gt;ï¼Œä»è€Œä¿è¯é›†ç¾¤ç»§ç»­æ­£å¸¸æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;code&gt;CLUSTER REPLICATE&lt;/code&gt;å‘½ä»¤ä¸ºä½ æä¾›äº†çµæ´»æ‰‹åŠ¨ç®¡ç† Redis Cluster ä¸»ä»å¤åˆ¶å…³ç³»çš„èƒ½åŠ›ã€‚æ— è®ºæ˜¯åˆå§‹åŒ–é›†ç¾¤ã€æ‰©å®¹è¿˜æ˜¯è°ƒæ•´æ¶æ„ï¼Œå®ƒéƒ½æ˜¯ä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚&lt;/p&gt;
&lt;h2 id="moved--ask"&gt;MOVED &amp;amp; ASK
&lt;/h2&gt;&lt;p&gt;Redis Cluster ä½¿ç”¨ MOVED å’Œ ASK è¿™ä¸¤ç§é‡å®šå‘æœºåˆ¶æ¥å¼•å¯¼å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå®ƒä»¬åœ¨é›†ç¾¤æ‰©ç¼©å®¹å’Œæ•°æ®è¿ç§»è¿‡ç¨‹ä¸­è‡³å…³é‡è¦ã€‚è™½ç„¶éƒ½ç”¨äºé‡å®šå‘ï¼Œä½†å…¶è®¾è®¡ç›®çš„ã€è§¦å‘æ—¶æœºå’Œå®¢æˆ·ç«¯å¤„ç†é€»è¾‘æœ‰æœ¬è´¨åŒºåˆ«ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒä»¬çš„æ ¸å¿ƒå·®å¼‚ï¼Œå¸®ä½ å¿«é€ŸæŠŠæ¡è¦ç‚¹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§å¯¹æ¯”&lt;/th&gt;
&lt;th&gt;MOVED é‡å®šå‘&lt;/th&gt;
&lt;th&gt;ASK é‡å®šå‘&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¹æœ¬æ€§è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ°¸ä¹…æ€§&lt;/strong&gt;é‡å®šå‘&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸´æ—¶æ€§&lt;/strong&gt;é‡å®šå‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®çš„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šçŸ¥å®¢æˆ·ç«¯&lt;strong&gt;æ§½çš„æ‰€æœ‰æƒå·²å‘ç”Ÿæ°¸ä¹…å˜æ›´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨æ•°æ®è¿ç§»è¿‡ç¨‹ä¸­ï¼ŒæŒ‡å¯¼å®¢æˆ·ç«¯&lt;strong&gt;ä¸´æ—¶è®¿é—®&lt;/strong&gt;å¦ä¸€ä¸ªèŠ‚ç‚¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§¦å‘æ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é›†ç¾¤æ‹“æ‰‘å·²ç¨³å®šï¼Œ&lt;strong&gt;æ§½çš„åˆ†é…å…³ç³»å·²å®Œæˆæ°¸ä¹…è½¬ç§»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ§½æ­£å¤„äº &lt;strong&gt;&lt;code&gt;MIGRATING&lt;/code&gt;/&lt;code&gt;IMPORTING&lt;/code&gt;&lt;/strong&gt; çš„è¿ç§»è¿‡ç¨‹ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®¢æˆ·ç«¯å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¿…é¡»æ›´æ–°&lt;/strong&gt;æœ¬åœ°ç¼“å­˜çš„æ§½-èŠ‚ç‚¹æ˜ å°„&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç¦æ­¢æ›´æ–°&lt;/strong&gt;æœ¬åœ°ç¼“å­˜çš„æ§½-èŠ‚ç‚¹æ˜ å°„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‰ç½®å‘½ä»¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;éœ€å…ˆå‘ç›®æ ‡èŠ‚ç‚¹å‘é€ &lt;strong&gt;&lt;code&gt;ASKING&lt;/code&gt;&lt;/strong&gt; å‘½ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”™è¯¯æ ¼å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MOVED &amp;lt;slot&amp;gt; &amp;lt;target-node-ip:port&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ASK &amp;lt;slot&amp;gt; &amp;lt;target-node-ip:port&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»æ¯”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¬å¸å…¬å‘Šï¼š&lt;strong&gt;æŸä¸ªéƒ¨é—¨å·²æ°¸ä¹…æ¬è¿è‡³æ–°åœ°å€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‰å°æŒ‡å¼•ï¼š&lt;strong&gt;â€œæ‚¨æ‰¾çš„äººä¸´æ—¶åœ¨éš”å£ä¼šè®®å®¤å¼€ä¼šâ€&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸å·¥ä½œæµç¨‹"&gt;ğŸ§  æ ¸å¿ƒæ¦‚å¿µä¸å·¥ä½œæµç¨‹
&lt;/h3&gt;&lt;h4 id="-moved-é‡å®šå‘æ°¸ä¹…æ¬å®¶"&gt;ğŸ”„ &lt;strong&gt;MOVED é‡å®šå‘ï¼šæ°¸ä¹…æ¬å®¶&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;MOVED é‡å®šå‘æ„å‘³ç€å“ˆå¸Œæ§½çš„ç®¡ç†æƒå·²å®Œæˆ&lt;strong&gt;æ°¸ä¹…æ€§ç§»äº¤&lt;/strong&gt;ã€‚å½“å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªé”®ï¼Œè€Œè¯¥é”®æ‰€å±çš„æ§½å·²ä¸å†ç”±å½“å‰èŠ‚ç‚¹è´Ÿè´£æ—¶ï¼ŒèŠ‚ç‚¹ä¼šè¿”å› MOVED é”™è¯¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;ï¼š
&lt;ol&gt;
&lt;li&gt;å®¢æˆ·ç«¯å‘èŠ‚ç‚¹Aè¯·æ±‚æ“ä½œé”® &lt;code&gt;key1&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹Aè®¡ç®— &lt;code&gt;key1&lt;/code&gt;çš„æ§½ä½ï¼Œå‘ç°è¯¥æ§½å·²&lt;strong&gt;æ°¸ä¹…åˆ†é…&lt;/strong&gt;ç»™èŠ‚ç‚¹Bã€‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹Aå‘å®¢æˆ·ç«¯å›å¤ &lt;code&gt;MOVED &amp;lt;slot&amp;gt; &amp;lt;node-B-ip:port&amp;gt;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™ºèƒ½å®¢æˆ·ç«¯&lt;/strong&gt;ä¼š&lt;strong&gt;æ›´æ–°å…¶æœ¬åœ°æ§½æ˜ å°„è¡¨&lt;/strong&gt;ï¼Œå°†å¯¹åº”æ§½æ°¸ä¹…æŒ‡å‘èŠ‚ç‚¹Bã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯é‡æ–°å‘èŠ‚ç‚¹Bå‘é€è¯·æ±‚ï¼Œå¹¶ä¸”åç»­å¯¹è¯¥æ§½çš„æ‰€æœ‰è¯·æ±‚éƒ½å°†ç›´æ¥å‘å¾€èŠ‚ç‚¹Bã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-ask-é‡å®šå‘ä¸´æ—¶æŒ‡å¼•"&gt;ğŸ”„ &lt;strong&gt;ASK é‡å®šå‘ï¼šä¸´æ—¶æŒ‡å¼•&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ASK é‡å®šå‘å‘ç”Ÿåœ¨å“ˆå¸Œæ§½&lt;strong&gt;æ­£åœ¨è¿ç§»&lt;/strong&gt;çš„è¿‡ç¨‹ä¸­ã€‚æ­¤æ—¶ï¼Œæ§½çš„æ‰€æœ‰æƒåœ¨æ³•å¾‹ä¸Šï¼ˆé›†ç¾¤å…ƒæ•°æ®ï¼‰ä»å±æºèŠ‚ç‚¹ï¼Œä½†éƒ¨åˆ†æ•°æ®åœ¨ç‰©ç†ä¸Šå¯èƒ½å·²è½¬ç§»åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;ï¼š
&lt;ol&gt;
&lt;li&gt;æ§½Xæ­£ä»èŠ‚ç‚¹Aè¿ç§»è‡³èŠ‚ç‚¹Bã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯å‘èŠ‚ç‚¹Aï¼ˆæ­¤æ—¶ä»ä¸ºæ§½Xçš„å®˜æ–¹æ‰€æœ‰è€…ï¼‰è¯·æ±‚é”® &lt;code&gt;key2&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹Aå‘ç° &lt;code&gt;key2&lt;/code&gt;&lt;strong&gt;å·²ä¸åœ¨æœ¬åœ°&lt;/strong&gt;ï¼ˆå·²è¿ç§»è‡³èŠ‚ç‚¹Bï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹Aå‘å®¢æˆ·ç«¯å›å¤ &lt;code&gt;ASK &amp;lt;slot&amp;gt; &amp;lt;node-B-ip:port&amp;gt;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯ä¼š&lt;strong&gt;ä¸´æ—¶&lt;/strong&gt;å‘èŠ‚ç‚¹Bå‘é€ä¸€ä¸ª &lt;code&gt;ASKING&lt;/code&gt;å‘½ä»¤ï¼Œç´§æ¥ç€å‘é€åŸæœ¬å¯¹ &lt;code&gt;key2&lt;/code&gt;çš„æ“ä½œå‘½ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹Bæ”¶åˆ° &lt;code&gt;ASKING&lt;/code&gt;åï¼Œä¼š&lt;strong&gt;ä¸´æ—¶å…è®¸&lt;/strong&gt;å¤„ç†è¿™ä¸ªæœ¬ä¸å±äºè‡ªå·±çš„æ§½çš„è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯&lt;strong&gt;ä¸ä¼šæ›´æ–°&lt;/strong&gt;å…¶æœ¬åœ°æ§½æ˜ å°„ç¼“å­˜ã€‚ä¸‹æ¬¡è¯·æ±‚åŒä¸€æ§½çš„å…¶ä»–é”®æ—¶ï¼Œå®ƒä»ä¼šå…ˆè¯¢é—®èŠ‚ç‚¹Aã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†æ›´ç›´è§‚åœ°å±•ç¤º ASK é‡å®šå‘åœ¨æ•°æ®è¿ç§»è¿‡ç¨‹ä¸­çš„å·¥ä½œæµç¨‹ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„åºåˆ—å›¾ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;sequenceDiagram
participant C as å®¢æˆ·ç«¯
participant A as æºèŠ‚ç‚¹ (Node A)&amp;lt;br&amp;gt;çŠ¶æ€: MIGRATING
participant B as ç›®æ ‡èŠ‚ç‚¹ (Node B)&amp;lt;br&amp;gt;çŠ¶æ€: IMPORTING
C-&amp;gt;&amp;gt;A: è¯·æ±‚ GET key2ï¼ˆå±äºæ­£åœ¨è¿ç§»çš„æ§½ï¼‰
A-&amp;gt;&amp;gt;A: æ£€æŸ¥å‘ç° key2 å·²è¿å‡º
A--&amp;gt;&amp;gt;C: å›å¤ ASK é”™è¯¯&amp;lt;br/&amp;gt;ASK &amp;lt;slot&amp;gt; &amp;lt;node-B-ip:port&amp;gt;
C-&amp;gt;&amp;gt;B: å‘é€ ASKING å‘½ä»¤
B-&amp;gt;&amp;gt;B: æ ‡è®°ä¸´æ—¶è®¸å¯
B--&amp;gt;&amp;gt;C: å›å¤ OK
C-&amp;gt;&amp;gt;B: å†æ¬¡å‘é€ GET key2 è¯·æ±‚
B-&amp;gt;&amp;gt;B: æ­£å¸¸å¤„ç†è¯·æ±‚ï¼ˆkey2å·²åœ¨æ­¤ï¼‰
B--&amp;gt;&amp;gt;C: è¿”å› key2 çš„å€¼
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ç§æœºåˆ¶"&gt;ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ç§æœºåˆ¶ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;è¿™ä¸¤ç§æœºåˆ¶ååŒå·¥ä½œï¼Œä»¥åœ¨æ‰©å±•æ€§å’Œä¸€è‡´æ€§ä¹‹é—´å–å¾—å¹³è¡¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MOVED&lt;/strong&gt; ç”¨äº&lt;strong&gt;é«˜æ•ˆæ›´æ–°&lt;/strong&gt;ï¼šä¸€æ—¦è¿ç§»å®Œæˆï¼Œé€šè¿‡ MOVED è®©æ‰€æœ‰å®¢æˆ·ç«¯å¿«é€Ÿæ›´æ–°ç¼“å­˜ï¼Œå°†æµé‡æ°¸ä¹…è½¬å‘æ–°èŠ‚ç‚¹ï¼Œé¿å…ä¸å¿…è¦çš„é¢å¤–è·³è½¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ASK&lt;/strong&gt; ç”¨äº&lt;strong&gt;è¿ç§»æœŸæ§åˆ¶&lt;/strong&gt;ï¼šåœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œé˜²æ­¢æ‰€æœ‰å®¢æˆ·ç«¯å› é›¶æ˜Ÿå‡ ä¸ªå·²è¿ç§»çš„ key è€Œç›²ç›®æ›´æ–°å…¶æ§½æ˜ å°„ç¼“å­˜ï¼Œä»è€Œé¿å…å¯¹&lt;strong&gt;å°šæœªè¿ç§»&lt;/strong&gt;çš„ key çš„è¯·æ±‚è¢«é”™è¯¯åœ°å‘é€åˆ°æ–°èŠ‚ç‚¹ã€‚å®ƒç¡®ä¿äº†åœ¨æ‰€æœ‰æƒå˜æ›´çš„â€œè¿‡æ¸¡æœŸâ€å†…ï¼Œè¯·æ±‚è·¯ç”±çš„ç²¾ç¡®æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ç»™å¼€å‘è€…çš„å»ºè®®"&gt;ğŸ› ï¸ ç»™å¼€å‘è€…çš„å»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¡®ä¿å®¢æˆ·ç«¯æ˜¯â€œæ™ºèƒ½çš„â€&lt;/strong&gt;ï¼šä½ çš„ Redis å®¢æˆ·ç«¯åº“å¿…é¡»èƒ½æ­£ç¡®è¯†åˆ«å’Œå¤„ç† &lt;code&gt;MOVED&lt;/code&gt;åŠ &lt;code&gt;ASK&lt;/code&gt;å“åº”ï¼Œå¹¶è‡ªåŠ¨å®Œæˆé‡å®šå‘æ“ä½œã€‚å¸¸è§çš„ç¼–ç¨‹è¯­è¨€éƒ½æœ‰æ”¯æŒé›†ç¾¤çš„å®¢æˆ·ç«¯åº“ï¼ˆå¦‚ Java çš„ Lettuceã€Jedisï¼›Python çš„ redis-py-clusterï¼›Go çš„ go-redis ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§ä¸é‡è¯•&lt;/strong&gt;ï¼šåœ¨å®¢æˆ·ç«¯å®ç°ä¸­ï¼Œåº”ä¸ºé‡å®šå‘è®¾ç½®åˆç†çš„é‡è¯•æœºåˆ¶ï¼Œå¹¶è­¦æƒ•é‡å®šå‘å¾ªç¯ï¼ˆå°½ç®¡ç½•è§ï¼‰ï¼Œè¿™é€šå¸¸æ„å‘³ç€é›†ç¾¤å…ƒæ•°æ®å‡ºç°æ··ä¹±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´å½±å“&lt;/strong&gt;ï¼šåœ¨è¿›è¡Œé›†ç¾¤æ‰©ç¼©å®¹ï¼ˆæ§½è¿ç§»ï¼‰æ—¶ï¼Œé¢‘ç¹çš„ &lt;code&gt;ASK&lt;/code&gt;é‡å®šå‘å¯èƒ½ä¼šå¯¼è‡´å®¢æˆ·ç«¯è¯·æ±‚çš„å»¶è¿Ÿç•¥æœ‰å¢åŠ ã€‚å»ºè®®åœ¨ä¸šåŠ¡ä½å³°æœŸè¿›è¡Œè¿™ç±»æ“ä½œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ç¼“å­˜ç©¿é€å‡»ç©¿é›ªå´©"&gt;ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©
&lt;/h2&gt;&lt;p&gt;ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿å’Œç¼“å­˜é›ªå´©æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸è§çš„ä¸‰ç±»ç¼“å­˜é—®é¢˜ï¼Œç†è§£å®ƒä»¬çš„åŒºåˆ«å¹¶é‡‡å–æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆï¼Œå¯¹ä¿éšœç³»ç»Ÿç¨³å®šæ€§å’Œé«˜æ€§èƒ½è‡³å…³é‡è¦ã€‚ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªå¯¹æ¯”è¡¨æ ¼å¸®ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒåŒºåˆ«ï¼Œç„¶åè¯¦ç»†è§£é‡Šæ¯ç§é—®é¢˜åŠå…¶åº”å¯¹ç­–ç•¥ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é—®é¢˜ç±»å‹&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒç‰¹å¾ä¸å®šä¹‰&lt;/th&gt;
&lt;th&gt;è§¦å‘æ¡ä»¶ä¸åœºæ™¯ä¸¾ä¾‹&lt;/th&gt;
&lt;th&gt;ä¸»è¦å½±å“ä¸é£é™©&lt;/th&gt;
&lt;th&gt;å…³é”®è§£å†³æ–¹æ¡ˆ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜ç©¿é€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢&lt;strong&gt;ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨&lt;/strong&gt;çš„æ•°æ®ï¼Œè¯·æ±‚ç›´æ¥ç©¿é€ç¼“å­˜å±‚ï¼ŒæŒç»­å†²å‡»æ•°æ®åº“ã€‚&lt;/td&gt;
&lt;td&gt;æ¶æ„æ”»å‡»ï¼ˆå¦‚æ‰¹é‡è¯·æ±‚éæ³•IDï¼‰ã€ä¸šåŠ¡é€»è¾‘æ¼æ´æˆ–æ•°æ®å¶ç„¶ç¼ºå¤±ã€‚&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“èµ„æºè¢«å¤§é‡æ— æ•ˆæŸ¥è¯¢æ¶ˆè€—ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¸ƒéš†è¿‡æ»¤å™¨&lt;/strong&gt;é¢„åˆ¤ã€&lt;strong&gt;ç¼“å­˜ç©ºå€¼&lt;/strong&gt;ï¼ˆçŸ­æ—¶é—´ï¼‰ã€&lt;strong&gt;è¯·æ±‚å‚æ•°æ ¡éªŒ&lt;/strong&gt;ä¸&lt;strong&gt;é™æµ&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜å‡»ç©¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æŸä¸ªçƒ­ç‚¹keyçªç„¶å¤±æ•ˆ&lt;/strong&gt;çš„ç¬é—´ï¼Œå¤§é‡å¹¶å‘è¯·æ±‚ç›´æ¥æ¶Œå‘æ•°æ®åº“ã€‚&lt;/td&gt;
&lt;td&gt;çƒ­ç‚¹æ•°æ®ï¼ˆå¦‚ç§’æ€å•†å“ã€çƒ­é—¨æ–°é—»ï¼‰ç¼“å­˜è¿‡æœŸæˆ–è¢«æ„å¤–åˆ é™¤ã€‚&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“ç¬é—´æ‰¿å—æé«˜å¹¶å‘å‹åŠ›ï¼Œå¯èƒ½å¼•å‘å´©æºƒæˆ–è¿é”ååº”ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;äº’æ–¥é”&lt;/strong&gt;ï¼ˆé˜²å¹¶å‘æ‰“åº“ï¼‰ã€&lt;strong&gt;é€»è¾‘è¿‡æœŸ&lt;/strong&gt;ï¼ˆæ°¸ä¸è¿‡æœŸ+å¼‚æ­¥æ›´æ–°ï¼‰ã€&lt;strong&gt;çƒ­ç‚¹æ•°æ®é¢„åŠ è½½&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜é›ªå´©&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤§é‡ç¼“å­˜keyåœ¨åŒä¸€æ—¶é—´æ®µå†…é›†ä¸­å¤±æ•ˆ&lt;/strong&gt;æˆ–ç¼“å­˜æœåŠ¡æ•´ä½“å®•æœºï¼Œå¯¼è‡´è¯·æ±‚æ´ªå³°ç›´å‡»æ•°æ®åº“ã€‚&lt;/td&gt;
&lt;td&gt;ç¼“å­˜è¿‡æœŸæ—¶é—´è®¾ç½®è¿‡äºé›†ä¸­ã€ç¼“å­˜é›†ç¾¤æ•…éšœã€‚&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“è´Ÿè½½éª¤å¢ï¼Œææ˜“å¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œå½±å“èŒƒå›´å¹¿ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éšæœºåŒ–è¿‡æœŸæ—¶é—´&lt;/strong&gt;ã€&lt;strong&gt;å¤šçº§ç¼“å­˜&lt;/strong&gt;ï¼ˆæœ¬åœ°+åˆ†å¸ƒå¼ï¼‰ã€&lt;strong&gt;æœåŠ¡ç†”æ–­ä¸é™çº§&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ·±å…¥ç†è§£ä¸è§£å†³æ–¹æ¡ˆ"&gt;ğŸ§  æ·±å…¥ç†è§£ä¸è§£å†³æ–¹æ¡ˆ
&lt;/h3&gt;&lt;h4 id="-1-ç¼“å­˜ç©¿é€-cache-penetration"&gt;ğŸš« 1. ç¼“å­˜ç©¿é€ (Cache Penetration)
&lt;/h4&gt;&lt;p&gt;ç¼“å­˜ç©¿é€æ˜¯æŒ‡æŸ¥è¯¢ä¸€ä¸ª&lt;strong&gt;æ ¹æœ¬ä¸å­˜åœ¨çš„æ•°æ®&lt;/strong&gt;ã€‚è¿™ä¸ªæ•°æ®åœ¨ç¼“å­˜ä¸­æŸ¥ä¸åˆ°ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šç›´è¾¾æ•°æ®åº“ï¼Œç¼“å­˜å±‚å¤±å»äº†ä¿æŠ¤ä½œç”¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€è·¯&lt;/strong&gt;ï¼šåœ¨ç¼“å­˜å±‚æ‹¦æˆªè¿™äº›â€œä¸å­˜åœ¨â€çš„è¯·æ±‚ï¼Œé˜²æ­¢å®ƒä»¬åˆ°è¾¾æ•°æ®åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¸ƒéš†è¿‡æ»¤å™¨ (Bloom Filter)&lt;/strong&gt;ï¼šä¸€ç§é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œç”¨äºåˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦&lt;strong&gt;å¯èƒ½å­˜åœ¨äº&lt;/strong&gt;é›†åˆä¸­ã€‚å®ƒä¼šå°†æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„keyå“ˆå¸Œåˆ°ä¸€ä¸ªä½å›¾ä¸­ã€‚æŸ¥è¯¢æ—¶ï¼Œå¦‚æœå¸ƒéš†è¿‡æ»¤å™¨è¯´æŸä¸ªkeyä¸å­˜åœ¨ï¼Œé‚£å®ƒä¸€å®šä¸å­˜åœ¨ï¼Œå¯ä»¥ç›´æ¥è¿”å›ã€‚æ³¨æ„ï¼Œå®ƒå¯èƒ½å­˜åœ¨æå°çš„è¯¯åˆ¤ç‡ï¼ˆåˆ¤æ–­ä¸ºå­˜åœ¨ï¼Œä½†å®é™…å¯èƒ½ä¸å­˜åœ¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ç©ºå¯¹è±¡&lt;/strong&gt;ï¼šå³ä½¿æ•°æ®åº“æŸ¥è¯¢ç»“æœä¸ºç©ºï¼Œä¹Ÿåœ¨ç¼“å­˜ä¸­å­˜å‚¨ä¸€ä¸ªç©ºå€¼ï¼ˆæˆ–ç‰¹æ®Šæ ‡è®°ï¼‰ï¼Œå¹¶è®¾ç½®ä¸€ä¸ª&lt;strong&gt;è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´&lt;/strong&gt;ï¼ˆå¦‚1-5åˆ†é’Ÿï¼‰ã€‚è¿™æ ·ï¼Œåç»­ç›¸åŒçš„è¯·æ±‚åœ¨çŸ­æ—¶é—´å†…å°±ä¼šå‘½ä¸­è¿™ä¸ªç©ºç¼“å­˜ï¼Œä»è€Œä¿æŠ¤æ•°æ®åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£å±‚å¢å¼ºæ ¡éªŒ&lt;/strong&gt;ï¼šå¯¹è¯·æ±‚å‚æ•°è¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼Œä¾‹å¦‚æ£€æŸ¥IDæ˜¯å¦ä¸ºæ­£æ•´æ•°ã€æ˜¯å¦ç¬¦åˆæ ¼å¼ç­‰ï¼Œä»è¯·æ±‚æºå¤´æ‹¦æˆªæ‰æ˜æ˜¾éæ³•çš„è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-2-ç¼“å­˜å‡»ç©¿-cache-breakdown"&gt;âš¡ 2. ç¼“å­˜å‡»ç©¿ (Cache Breakdown)
&lt;/h4&gt;&lt;p&gt;ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ä¸€ä¸ª&lt;strong&gt;è®¿é—®éå¸¸é¢‘ç¹çš„çƒ­ç‚¹key&lt;/strong&gt;åœ¨&lt;strong&gt;å¤±æ•ˆçš„ç¬é—´&lt;/strong&gt;ï¼Œå¤§é‡è¯·æ±‚åŒæ—¶æ¶Œæ¥ï¼Œå‡»ç©¿ç¼“å­˜ï¼Œå…¨éƒ¨ç›´æ¥è®¿é—®æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€è·¯&lt;/strong&gt;ï¼šé˜²æ­¢åœ¨çƒ­ç‚¹keyå¤±æ•ˆçš„ç¬é—´ï¼Œå¤§é‡çº¿ç¨‹åŒæ—¶å»æ•°æ®åº“é‡å»ºç¼“å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº’æ–¥é” (Mutex Lock)&lt;/strong&gt;ï¼šå½“ç¼“å­˜å¤±æ•ˆæ—¶ï¼Œä¸æ˜¯æ‰€æœ‰çº¿ç¨‹éƒ½å»æŸ¥æ•°æ®åº“ï¼Œè€Œæ˜¯è®©&lt;strong&gt;ä¸€ä¸ªçº¿ç¨‹&lt;/strong&gt;ï¼ˆé€šå¸¸é€šè¿‡åˆ†å¸ƒå¼é”å®ç°ï¼‰å»æŸ¥è¯¢æ•°æ®åº“å¹¶é‡å»ºç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…æˆ–é‡è¯•è¯»å–æ–°ç¼“å­˜ã€‚è¿™é€šå¸¸ç»“åˆâ€œåŒé‡æ£€æŸ¥â€æ¨¡å¼ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€»è¾‘è¿‡æœŸ&lt;/strong&gt;ï¼šä¸ç»™çƒ­ç‚¹keyè®¾ç½®ç‰©ç†è¿‡æœŸæ—¶é—´ï¼Œè€Œæ˜¯å°†è¿‡æœŸæ—¶é—´ä¿¡æ¯å­˜å‚¨åœ¨valueä¸­ã€‚å½“å‘ç°æ•°æ®é€»è¾‘ä¸Šè¿‡æœŸæ—¶ï¼Œç”±å•ä¸ªçº¿ç¨‹å¼‚æ­¥å»æ›´æ–°ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹åœ¨æ­¤æœŸé—´ä»è¿”å›æ—§çš„ã€å¯èƒ½è¿‡æœŸçš„æ•°æ®ï¼Œä»è€Œä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ&lt;/strong&gt;ï¼šå¯¹æçƒ­ç‚¹æ•°æ®ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®ä¸ºæ°¸ä¸è¿‡æœŸï¼Œé€šè¿‡åå°ä»»åŠ¡æˆ–æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥æ›´æ–°ç¼“å­˜ï¼Œç¡®ä¿æ•°æ®ä¸ä¼šå› è¿‡æœŸè€Œå¤±æ•ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-3-ç¼“å­˜é›ªå´©-cache-avalanche"&gt;â„ï¸ 3. ç¼“å­˜é›ªå´© (Cache Avalanche)
&lt;/h4&gt;&lt;p&gt;ç¼“å­˜é›ªå´©æ˜¯æŒ‡&lt;strong&gt;å¤§é‡ç¼“å­˜keyåœ¨åŒä¸€æ—¶é—´æ®µå†…é›†ä¸­å¤±æ•ˆ&lt;/strong&gt;ï¼Œæˆ–è€…&lt;strong&gt;ç¼“å­˜æœåŠ¡ï¼ˆå¦‚Redisé›†ç¾¤ï¼‰æ•´ä½“å®•æœº&lt;/strong&gt;ï¼Œå¯¼è‡´æ‰€æœ‰è¯·æ±‚éƒ½æ— æ³•å‘½ä¸­ç¼“å­˜ï¼Œå…¨éƒ¨æ¶Œå‘æ•°æ®åº“ï¼Œé€ æˆæ•°æ®åº“å‹åŠ›éª¤å¢ç”šè‡³å´©æºƒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€è·¯&lt;/strong&gt;ï¼šé¿å…å¤§é‡keyåŒæ—¶å¤±æ•ˆï¼›åœ¨ç¼“å­˜å±‚å¤±æ•ˆæ—¶ï¼Œæœ‰åå¤‡æ–¹æ¡ˆä¿æŠ¤æ•°æ®åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éšæœºåŒ–è¿‡æœŸæ—¶é—´&lt;/strong&gt;ï¼šä¸ºç¼“å­˜keyçš„TTLè®¾ç½®ä¸€ä¸ªåŸºç¡€å€¼åŠ ä¸Šä¸€ä¸ªéšæœºå€¼ï¼ˆå¦‚ &lt;code&gt;3600 + random(600)&lt;/code&gt;ï¼‰ï¼Œè®©keyçš„è¿‡æœŸæ—¶é—´å°½å¯èƒ½åˆ†æ•£ï¼Œé¿å…åŒæ—¶å¤±æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº§ç¼“å­˜&lt;/strong&gt;ï¼šæ„å»ºå¤šçº§ç¼“å­˜æ¶æ„ï¼Œå¦‚æœ¬åœ°ç¼“å­˜ï¼ˆCaffeine/Guavaï¼‰ + åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆRedisï¼‰ã€‚å³ä½¿Rediså®•æœºï¼Œæœ¬åœ°ç¼“å­˜ä»èƒ½æŠµæŒ¡ä¸€éƒ¨åˆ†è¯·æ±‚ï¼Œä¸ºæ¢å¤ç³»ç»Ÿäº‰å–æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡ç†”æ–­ä¸é™çº§&lt;/strong&gt;ï¼šå½“ç³»ç»Ÿæ£€æµ‹åˆ°æ•°æ®åº“å‹åŠ›è¿‡å¤§æˆ–å¤§é‡è¯·æ±‚å¤±è´¥æ—¶ï¼Œå¯ä»¥å¯åŠ¨&lt;strong&gt;ç†”æ–­æœºåˆ¶&lt;/strong&gt;ï¼Œæš‚æ—¶åœæ­¢è®¿é—®æ•°æ®åº“ï¼Œç›´æ¥è¿”å›é»˜è®¤å€¼ã€é”™è¯¯é¡µé¢æˆ–æ’é˜Ÿç­‰å¾…ã€‚&lt;strong&gt;é™çº§&lt;/strong&gt;åˆ™æ˜¯æš‚æ—¶å…³é—­ä¸€äº›éæ ¸å¿ƒæœåŠ¡ï¼Œä¿è¯æ ¸å¿ƒæœåŠ¡çš„å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å®æˆ˜å»ºè®®"&gt;ğŸ’¡ å®æˆ˜å»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç»„åˆä½¿ç”¨&lt;/strong&gt;ï¼šåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œé€šå¸¸éœ€è¦æ ¹æ®ä¸šåŠ¡åœºæ™¯ç»„åˆä½¿ç”¨å¤šç§æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼ŒåŒæ—¶ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å’Œç¼“å­˜ç©ºå€¼æ¥åº”å¯¹ç©¿é€ï¼Œä½¿ç”¨äº’æ–¥é”å’Œéšæœºè¿‡æœŸæ—¶é—´æ¥åº”å¯¹å‡»ç©¿å’Œé›ªå´©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§é¢„è­¦&lt;/strong&gt;ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§ç³»ç»Ÿï¼Œå¯†åˆ‡å…³æ³¨&lt;strong&gt;ç¼“å­˜å‘½ä¸­ç‡&lt;/strong&gt;ã€&lt;strong&gt;æ•°æ®åº“è´Ÿè½½&lt;/strong&gt;å’Œ&lt;strong&gt;å“åº”æ—¶é—´&lt;/strong&gt;ç­‰å…³é”®æŒ‡æ ‡ï¼Œè®¾ç½®é˜ˆå€¼å‘Šè­¦ï¼Œä»¥ä¾¿åŠæ—¶å‘ç°é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é‡è§„åˆ’&lt;/strong&gt;ï¼šæ ¹æ®ä¸šåŠ¡è§„æ¨¡åˆç†è§„åˆ’ç¼“å­˜å’Œæ•°æ®åº“çš„å®¹é‡ï¼Œå¹¶é¢„ç•™ä¸€å®šçš„ç¼“å†²ç©ºé—´ä»¥åº”å¯¹æµé‡å³°å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¹æ®ç³»ç»Ÿè§„æ¨¡é€‰æ‹©&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å°å‹ç³»ç»Ÿ&lt;/strong&gt;ï¼šå¯ä¼˜å…ˆé‡‡ç”¨&lt;strong&gt;éšæœºè¿‡æœŸæ—¶é—´&lt;/strong&gt;ã€&lt;strong&gt;ç¼“å­˜ç©ºå€¼&lt;/strong&gt;ã€&lt;strong&gt;å‚æ•°æ ¡éªŒ&lt;/strong&gt;ç­‰ç®€å•ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸­å¤§å‹ç³»ç»Ÿ&lt;/strong&gt;ï¼šå¿…é¡»å¼•å…¥&lt;strong&gt;å¸ƒéš†è¿‡æ»¤å™¨&lt;/strong&gt;ã€&lt;strong&gt;åˆ†å¸ƒå¼é”&lt;/strong&gt;ã€&lt;strong&gt;å¤šçº§ç¼“å­˜&lt;/strong&gt;ã€&lt;strong&gt;ç†”æ–­é™çº§&lt;/strong&gt;ç­‰æ›´å¤æ‚çš„æ‰‹æ®µæ¥ä¿éšœç³»ç»Ÿç¨³å®šæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„å¯¹æ¯”å’Œè§£å†³æ–¹æ¡ˆèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œåº”å¯¹ç¼“å­˜ç³»ç»Ÿä¸­çš„è¿™äº›å…¸å‹é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id="sentinel"&gt;SENTINEL
&lt;/h2&gt;&lt;p&gt;Rediså“¨å…µèŠ‚ç‚¹æä¾›äº†ä¸€ç³»åˆ—ä¸“ç”¨å‘½ä»¤ï¼Œç”¨äºç›‘æ§ã€ç®¡ç†å’Œç»´æŠ¤Redisçš„é«˜å¯ç”¨æ€§ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†è¿™äº›æ ¸å¿ƒå‘½ä»¤ï¼Œæ–¹ä¾¿ä½ å¿«é€Ÿäº†è§£å…¶ç”¨é€”ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‘½ä»¤ç±»åˆ«&lt;/th&gt;
&lt;th&gt;å‘½ä»¤ç¤ºä¾‹&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒç”¨é€”&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›‘æ§ä¸æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SENTINEL MASTERS&lt;/code&gt;, &lt;code&gt;SENTINEL SLAVES &amp;lt;master-name&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–å“¨å…µç³»ç»Ÿå†…ä¸»èŠ‚ç‚¹ã€ä»èŠ‚ç‚¹åŠå…¶ä»–å“¨å…µèŠ‚ç‚¹çš„æ‹“æ‰‘ç»“æ„å’ŒçŠ¶æ€ä¿¡æ¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é…ç½®ç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SENTINEL MONITOR &amp;lt;name&amp;gt; &amp;lt;ip&amp;gt; &amp;lt;port&amp;gt; &amp;lt;quorum&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€æ·»åŠ æˆ–ç§»é™¤å“¨å…µç›‘æ§çš„ä¸»èŠ‚ç‚¹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•…éšœè½¬ç§»æ§åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SENTINEL FAILOVER &amp;lt;master-name&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸»åŠ¨è§¦å‘æˆ–é‡ç½®æ•…éšœè½¬ç§»çŠ¶æ€ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£è¿™äº›å‘½ä»¤çš„å…·ä½“ç”¨æ³•å’Œåœºæ™¯ã€‚&lt;/p&gt;
&lt;h3 id="-ç›‘æ§ä¸æŸ¥è¯¢å‘½ä»¤"&gt;ğŸ” ç›‘æ§ä¸æŸ¥è¯¢å‘½ä»¤
&lt;/h3&gt;&lt;p&gt;è¿™ç±»å‘½ä»¤ç”¨äºå®æ—¶æŒæ¡å“¨å…µç³»ç»Ÿçš„å¥åº·çŠ¶å†µå’Œæ‹“æ‰‘ç»“æ„ï¼Œæ˜¯æ—¥å¸¸è¿ç»´çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è·å–ä¸»èŠ‚ç‚¹ä¿¡æ¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SENTINEL MASTERS&lt;/code&gt;ï¼šåˆ—å‡ºå½“å‰å“¨å…µå®ä¾‹ç›‘æ§çš„&lt;strong&gt;æ‰€æœ‰ä¸»èŠ‚ç‚¹&lt;/strong&gt;çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬åç§°ã€IPã€ç«¯å£ã€çŠ¶æ€ã€ä»èŠ‚ç‚¹æ•°é‡ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SENTINEL MASTER &amp;lt;master-name&amp;gt;&lt;/code&gt;ï¼šè·å–&lt;strong&gt;æŒ‡å®šä¸»èŠ‚ç‚¹&lt;/strong&gt;çš„è¯¦ç»†ç›‘æ§ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·å–ä»èŠ‚ç‚¹ä¸å“¨å…µèŠ‚ç‚¹ä¿¡æ¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SENTINEL SLAVES &amp;lt;master-name&amp;gt;&lt;/code&gt;ï¼šåˆ—å‡ºæŒ‡å®šä¸»èŠ‚ç‚¹ä¸‹çš„&lt;strong&gt;æ‰€æœ‰ä»èŠ‚ç‚¹&lt;/strong&gt;çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚IPã€ç«¯å£ã€å¤åˆ¶åç§»é‡ã€å¥åº·çŠ¶æ€ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SENTINEL SENTINELS &amp;lt;master-name&amp;gt;&lt;/code&gt;ï¼šåˆ—å‡ºç›‘æ§åŒä¸€ä¸»èŠ‚ç‚¹çš„&lt;strong&gt;å…¶ä»–æ‰€æœ‰å“¨å…µèŠ‚ç‚¹&lt;/strong&gt;çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„IPåœ°å€å’Œç«¯å£ã€‚è¿™å¯¹äºäº†è§£å“¨å…µé›†ç¾¤çš„æ„æˆéå¸¸æœ‰ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥è¯¢å…³é”®åœ°å€ä¸çŠ¶æ€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SENTINEL GET-MASTER-ADDR-BY-NAME &amp;lt;master-name&amp;gt;&lt;/code&gt;ï¼šè¿™æ˜¯å®¢æˆ·ç«¯è¿æ¥æ—¶æœ€å¸¸ç”¨çš„å‘½ä»¤ä¹‹ä¸€ï¼Œç›´æ¥è¿”å›&lt;strong&gt;å½“å‰ä¸»èŠ‚ç‚¹çš„IPå’Œç«¯å£&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SENTINEL IS-MASTER-DOWN-BY-ADDR &amp;lt;ip&amp;gt; &amp;lt;port&amp;gt;&lt;/code&gt;ï¼šæ­¤å‘½ä»¤ä¸»è¦ç”¨äºå“¨å…µèŠ‚ç‚¹é—´çš„é€šä¿¡ï¼Œç”¨äºåå•†å’Œåˆ¤æ–­ä¸€ä¸ªä¸»èŠ‚ç‚¹æ˜¯å¦&lt;strong&gt;å®¢è§‚ä¸‹çº¿&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SENTINEL CKQUORUM &amp;lt;master-name&amp;gt;&lt;/code&gt;ï¼šç”¨äº&lt;strong&gt;æ£€æŸ¥&lt;/strong&gt;å½“å‰æœ‰æ•ˆçš„å“¨å…µèŠ‚ç‚¹æ•°é‡æ˜¯å¦è¾¾åˆ°äº†é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„&lt;code&gt;quorum&lt;/code&gt;ï¼ˆæ³•å®šäººæ•°ï¼‰å€¼ï¼Œè¿™æ˜¯åˆ¤æ–­ä¸»èŠ‚ç‚¹èƒ½å¦è¢«å®¢è§‚ä¸‹çº¿çš„å…³é”®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-é…ç½®ç®¡ç†å‘½ä»¤"&gt;âš™ï¸ é…ç½®ç®¡ç†å‘½ä»¤
&lt;/h3&gt;&lt;p&gt;è¿™äº›å‘½ä»¤å…è®¸ä½ åŠ¨æ€è°ƒæ•´å“¨å…µçš„ç›‘æ§å¯¹è±¡ï¼Œæ— éœ€é‡å¯æœåŠ¡ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ·»åŠ ç›‘æ§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SENTINEL MONITOR &amp;lt;name&amp;gt; &amp;lt;ip&amp;gt; &amp;lt;port&amp;gt; &amp;lt;quorum&amp;gt;&lt;/code&gt;ï¼šæ­¤å‘½ä»¤ç”¨äº&lt;strong&gt;åŠ¨æ€åœ°&lt;/strong&gt;è®©å“¨å…µå¼€å§‹ç›‘æ§ä¸€ä¸ªæ–°çš„ä¸»èŠ‚ç‚¹ã€‚å‚æ•°å«ä¹‰ä¸é…ç½®æ–‡ä»¶ä¸­çš„&lt;code&gt;sentinel monitor&lt;/code&gt;æŒ‡ä»¤å®Œå…¨ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç§»é™¤ç›‘æ§ç›®æ ‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SENTINEL REMOVE &amp;lt;name&amp;gt;&lt;/code&gt;ï¼šè®©å“¨å…µ&lt;strong&gt;åœæ­¢ç›‘æ§&lt;/strong&gt;æŒ‡å®šçš„ä¸»èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡ç½®ä¸æ¸…ç†é…ç½®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SENTINEL RESET &amp;lt;pattern&amp;gt;&lt;/code&gt;ï¼šå°†å“¨å…µä¸­åŒ¹é…æŒ‡å®šæ¨¡å¼ï¼ˆå¦‚&lt;code&gt;*&lt;/code&gt;ä»£è¡¨æ‰€æœ‰ï¼‰çš„ä¸»èŠ‚ç‚¹çŠ¶æ€&lt;strong&gt;é‡ç½®&lt;/strong&gt;ã€‚è¿™ä¼šæ¸…é™¤å·²çŸ¥çš„ä»èŠ‚ç‚¹ã€å…¶ä»–å“¨å…µç­‰ä¿¡æ¯ï¼Œç„¶åé‡æ–°é€šè¿‡INFOå‘½ä»¤å‘ç°ï¼Œå¸¸ç”¨äºæ¢å¤æŸäº›å¼‚å¸¸çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SENTINEL FLUSHCONFIG&lt;/code&gt;ï¼š&lt;strong&gt;å¼ºåˆ¶å°†å½“å‰å“¨å…µçš„é…ç½®é‡å†™åˆ°ç£ç›˜æ–‡ä»¶&lt;/strong&gt;ã€‚å“¨å…µåœ¨æ¥æ”¶åˆ°æ–°é…ç½®æ—¶é€šå¸¸ä¼šè‡ªåŠ¨å®Œæˆæ­¤æ“ä½œï¼Œä½†åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼ˆå¦‚ç£ç›˜æƒé™é—®é¢˜å¯¼è‡´è‡ªåŠ¨å†™å…¥å¤±è´¥åé—®é¢˜å·²ä¿®å¤ï¼‰ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨æ‰§è¡Œæ­¤å‘½ä»¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ•…éšœè½¬ç§»æ§åˆ¶å‘½ä»¤"&gt;ğŸš¨ æ•…éšœè½¬ç§»æ§åˆ¶å‘½ä»¤
&lt;/h3&gt;&lt;p&gt;è¿™ç±»å‘½ä»¤ç”¨äºä¸»åŠ¨å¹²é¢„æ•…éšœè½¬ç§»è¿‡ç¨‹ï¼Œé€šå¸¸åœ¨ç»´æŠ¤åœºæ™¯ä¸‹ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SENTINEL FAILOVER &amp;lt;master-name&amp;gt;&lt;/code&gt;ï¼šæ­¤å‘½ä»¤å¯ä»¥&lt;strong&gt;å¼ºåˆ¶å¯¹æŒ‡å®šçš„ä¸»èŠ‚ç‚¹æ‰§è¡Œæ•…éšœè½¬ç§»&lt;/strong&gt;ï¼Œå³ä½¿è¯¥ä¸»èŠ‚ç‚¹å½“å‰è¿è¡Œæ­£å¸¸ã€‚è¿™åœ¨è®¡åˆ’å†…ç»´æŠ¤æ—¶éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œä½ éœ€è¦åœ¨ä¸åœæœçš„æƒ…å†µä¸‹é‡å¯ä¸»èŠ‚ç‚¹æ‰€åœ¨çš„æœåŠ¡å™¨ï¼Œå¯ä»¥å…ˆç”¨æ­¤å‘½ä»¤å°†ä¸»èŠ‚ç‚¹å¹³æ»‘åœ°åˆ‡æ¢åˆ°ä¸€å°ä»èŠ‚ç‚¹ä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é‡è¦æç¤ºä¸æœ€ä½³å®è·µ"&gt;ğŸ’¡ é‡è¦æç¤ºä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;p&gt;åœ¨ä½¿ç”¨è¿™äº›å‘½ä»¤æ—¶ï¼Œæœ‰å‡ ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æƒé™ä¸å®‰å…¨&lt;/strong&gt;ï¼šç¡®ä¿åªæœ‰æˆæƒçš„å®¢æˆ·ç«¯æ‰èƒ½è¿æ¥åˆ°å“¨å…µèŠ‚ç‚¹çš„ç«¯å£ï¼ˆé»˜è®¤26379ï¼‰ï¼Œå› ä¸ºé€šè¿‡è¿™äº›å‘½ä»¤å¯ä»¥æ§åˆ¶æ•´ä¸ªRedisé«˜å¯ç”¨æ¶æ„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æŒä¹…åŒ–&lt;/strong&gt;ï¼šé€šè¿‡å‘½ä»¤è¿›è¡Œçš„åŠ¨æ€ä¿®æ”¹ï¼ˆå¦‚&lt;code&gt;MONITOR&lt;/code&gt;æˆ–&lt;code&gt;REMOVE&lt;/code&gt;ï¼‰é€šå¸¸ä¼šè¢«å“¨å…µè‡ªåŠ¨æŒä¹…åŒ–åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œéœ€è¦é‡å¯å“¨å…µæˆ–ä½¿ç”¨&lt;code&gt;SENTINEL FLUSHCONFIG&lt;/code&gt;å‘½ä»¤æ¥ç¡®ä¿é…ç½®ç”Ÿæ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œä¸è¿æ¥&lt;/strong&gt;ï¼šç¡®ä¿å“¨å…µèŠ‚ç‚¹ä¹‹é—´ä»¥åŠå“¨å…µä¸æ‰€æœ‰Redisæ•°æ®èŠ‚ç‚¹ï¼ˆä¸»ä»ï¼‰ä¹‹é—´çš„ç½‘ç»œè¿æ¥ç¨³å®šä¸”ä½å»¶è¿Ÿï¼Œè¿™æ˜¯å“¨å…µæ­£ç¡®åˆ¤æ–­èŠ‚ç‚¹çŠ¶æ€çš„åŸºç¡€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„å‘½ä»¤ä»‹ç»èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨Rediså“¨å…µï¼å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šå‘½ä»¤çš„ç”¨æ³•æˆ–åº”ç”¨åœºæ™¯æœ‰æ›´æ·±å…¥çš„ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="éƒ¨åˆ†å¤åˆ¶"&gt;éƒ¨åˆ†å¤åˆ¶
&lt;/h2&gt;&lt;p&gt;Redis çš„éƒ¨åˆ†å¤åˆ¶æ˜¯ä¸€é¡¹å…³é”®ä¼˜åŒ–ï¼Œå®ƒæ˜¾è‘—æå‡äº†ä¸»ä»å¤åˆ¶çš„æ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†ç½‘ç»œä¸ç¨³å®šç­‰åœºæ™¯æ—¶ã€‚ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡å…¨è²Œï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªè¡¨æ ¼æ¥å¯¹æ¯”éƒ¨åˆ†å¤åˆ¶ä¸å…¨é‡å¤åˆ¶çš„æ ¸å¿ƒå·®å¼‚ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§å¯¹æ¯”&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¨é‡å¤åˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;éƒ¨åˆ†å¤åˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§¦å‘åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»èŠ‚ç‚¹&lt;strong&gt;åˆæ¬¡å»ºç«‹å¤åˆ¶&lt;/strong&gt;ï¼Œæˆ–æ— æ³•è¿›è¡Œéƒ¨åˆ†å¤åˆ¶æ—¶&lt;/td&gt;
&lt;td&gt;ä¸»ä»èŠ‚ç‚¹é—´å› &lt;strong&gt;ç½‘ç»œé—ªæ–­&lt;/strong&gt;ç­‰åŸå› å¯¼è‡´æ•°æ®ä¸¢å¤±åé‡è¿&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸»èŠ‚ç‚¹&lt;strong&gt;å…¨éƒ¨æ•°æ®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…æ–­å¼€è¿æ¥æœŸé—´&lt;strong&gt;ç¼ºå¤±çš„éƒ¨åˆ†æ•°æ®&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºå¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éå¸¸å·¨å¤§ï¼Œå¯¹ä¸»ä»èŠ‚ç‚¹å’Œç½‘ç»œå¸¦å®½é€ æˆå‹åŠ›&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¼€é”€å¾ˆå°&lt;/strong&gt;ï¼Œä»…ä¼ è¾“å°‘é‡æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒå‘½ä»¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SYNC&lt;/code&gt;(æ—§ç‰ˆ) / &lt;code&gt;PSYNC&lt;/code&gt;(æ–°ç‰ˆï¼Œè§¦å‘å…¨é‡)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PSYNC {runId} {offset}&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•ˆç‡å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®é‡å¤§æ—¶è€—æ—¶ä¹…ï¼Œå¯èƒ½å½±å“æœåŠ¡å¯ç”¨æ€§&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜æ•ˆå¿«é€Ÿ&lt;/strong&gt;ï¼Œå¯¹æœåŠ¡å½±å“å¾®ä¹å…¶å¾®&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-éƒ¨åˆ†å¤åˆ¶çš„ä¸‰å¤§æ”¯æŸ±"&gt;ğŸ”‹ éƒ¨åˆ†å¤åˆ¶çš„ä¸‰å¤§æ”¯æŸ±
&lt;/h3&gt;&lt;p&gt;éƒ¨åˆ†å¤åˆ¶çš„å®ç°ä¾èµ–äºä¸‰ä¸ªæ ¸å¿ƒæœºåˆ¶ï¼Œå®ƒä»¬å…±åŒåä½œï¼Œä½¿å¾—é«˜æ•ˆåŒæ­¥æˆä¸ºå¯èƒ½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤åˆ¶åç§»é‡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹ä¼šåˆ†åˆ«ç»´æŠ¤ä¸€ä¸ª&lt;strong&gt;å¤åˆ¶åç§»é‡&lt;/strong&gt;ã€‚ä¸»èŠ‚ç‚¹æ¯æ¬¡å‘ä»èŠ‚ç‚¹ä¼ æ’­Nä¸ªå­—èŠ‚çš„æ•°æ®åï¼Œè‡ªèº«çš„åç§»é‡å°±ä¼šå¢åŠ Nï¼›ä»èŠ‚ç‚¹æ¯æ¬¡æ”¶åˆ°ä¸»èŠ‚ç‚¹ä¼ æ¥çš„Nä¸ªå­—èŠ‚æ•°æ®åï¼Œè‡ªèº«çš„åç§»é‡ä¹Ÿå¢åŠ Nã€‚é€šè¿‡å¯¹æ¯”ä¸»ä»èŠ‚ç‚¹çš„åç§»é‡ï¼Œå¯ä»¥åˆ¤æ–­ä¸¤è€…æ•°æ®æ˜¯å¦ä¸€è‡´ã€‚å½“ä»èŠ‚ç‚¹é‡è¿æ—¶ï¼Œä¼šå°†è‡ªå·±çš„åç§»é‡ä¸ŠæŠ¥ç»™ä¸»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹ä¾¿èƒ½çŸ¥é“ä»èŠ‚ç‚¹ç¼ºå¤±äº†å“ªäº›æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤åˆ¶ç§¯å‹ç¼“å†²åŒº&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯å®ç°éƒ¨åˆ†å¤åˆ¶çš„&lt;strong&gt;å…³é”®ç»„ä»¶&lt;/strong&gt;ã€‚å®ƒæ˜¯ç”±ä¸»èŠ‚ç‚¹ç»´æŠ¤çš„ä¸€ä¸ª&lt;strong&gt;å›ºå®šé•¿åº¦ã€å…ˆè¿›å…ˆå‡º(FIFO)çš„é˜Ÿåˆ—&lt;/strong&gt;ï¼Œé»˜è®¤å¤§å°ä¸º1MBã€‚å½“ä¸»èŠ‚ç‚¹æœ‰è¿æ¥çš„ä»èŠ‚ç‚¹æ—¶ï¼Œå®ƒä¼šæŠŠæ¯æ¬¡æ‰§è¡Œçš„å†™å‘½ä»¤&lt;strong&gt;ä¸ä»…å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œè¿˜ä¼šå†™å…¥è¿™ä¸ªç¼“å†²åŒº&lt;/strong&gt;ï¼Œå¹¶ä¸”é˜Ÿåˆ—ä¸­çš„æ¯ä¸ªå­—èŠ‚éƒ½å¯¹åº”ç€ä¸€ä¸ªå¤åˆ¶åç§»é‡ã€‚ç”±äºé˜Ÿåˆ—é•¿åº¦å›ºå®šï¼Œæœ€æ–°çš„å‘½ä»¤ä¼šæŒ¤å‡ºæœ€æ—§çš„å‘½ä»¤ï¼Œå› æ­¤å®ƒåªä¿å­˜æœ€è¿‘ä¸€æ®µæ—¶é—´å†…çš„å†™æ“ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœåŠ¡å™¨è¿è¡ŒID&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªRedisèŠ‚ç‚¹å¯åŠ¨æ—¶éƒ½ä¼šåŠ¨æ€ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„&lt;strong&gt;è¿è¡ŒID&lt;/strong&gt;ã€‚ä»èŠ‚ç‚¹åœ¨åˆæ¬¡è¿æ¥ä¸»èŠ‚ç‚¹æ—¶ä¼šä¿å­˜ä¸»èŠ‚ç‚¹çš„è¿è¡ŒIDã€‚å½“ä»èŠ‚ç‚¹æ–­çº¿é‡è¿æ—¶ï¼Œä¼šå°†ä¹‹å‰ä¿å­˜çš„è¿è¡ŒIDå‘é€ç»™å½“å‰ä¸»èŠ‚ç‚¹ã€‚å¦‚æœIDä¸€è‡´ï¼Œè¯´æ˜ä»èŠ‚ç‚¹ä¹‹å‰å¤åˆ¶çš„å°±æ˜¯å½“å‰è¿™ä¸ªä¸»èŠ‚ç‚¹ï¼Œæœ‰è¿›è¡Œéƒ¨åˆ†å¤åˆ¶çš„å¯èƒ½ï¼›å¦‚æœIDä¸åŒï¼ˆä¾‹å¦‚ä¸»èŠ‚ç‚¹é‡å¯è¿‡ï¼‰ï¼Œåˆ™å¿…é¡»è¿›è¡Œå…¨é‡å¤åˆ¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-éƒ¨åˆ†å¤åˆ¶çš„å·¥ä½œæµç¨‹"&gt;ğŸ”„ éƒ¨åˆ†å¤åˆ¶çš„å·¥ä½œæµç¨‹
&lt;/h3&gt;&lt;p&gt;å½“ä»èŠ‚ç‚¹ç½‘ç»œä¸­æ–­åæ¢å¤å¹¶é‡æ–°è¿æ¥ä¸»èŠ‚ç‚¹æ—¶ï¼Œéƒ¨åˆ†å¤åˆ¶çš„æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥æ¢å¤ä¸PSYNCè¯·æ±‚&lt;/strong&gt;ï¼šç½‘ç»œæ¢å¤åï¼Œä»èŠ‚ç‚¹é‡æ–°è¿æ¥ä¸Šä¸»èŠ‚ç‚¹ï¼Œå¹¶å‘é€ &lt;code&gt;PSYNC&lt;/code&gt;å‘½ä»¤ï¼Œè¯¥å‘½ä»¤æºå¸¦äº†ä¹‹å‰ä¿å­˜çš„ä¸»èŠ‚ç‚¹è¿è¡ŒIDå’Œå½“å‰çš„å¤åˆ¶åç§»é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸»èŠ‚ç‚¹éªŒè¯&lt;/strong&gt;ï¼šä¸»èŠ‚ç‚¹æ¥æ”¶åˆ°å‘½ä»¤åï¼Œå…ˆæ ¸å¯¹è¿è¡ŒIDæ˜¯å¦ä¸è‡ªèº«ä¸€è‡´ã€‚å¦‚æœä¸åŒï¼Œå›å¤ &lt;code&gt;+FULLRESYNC&lt;/code&gt;è§¦å‘å…¨é‡å¤åˆ¶ã€‚å¦‚æœä¸€è‡´ï¼Œåˆ™æ ¹æ®ä»èŠ‚ç‚¹å‘æ¥çš„åç§»é‡ï¼Œæ£€æŸ¥è¯¥åç§»é‡ä¹‹åçš„æ•°æ®æ˜¯å¦è¿˜å­˜åœ¨äº&lt;strong&gt;å¤åˆ¶ç§¯å‹ç¼“å†²åŒº&lt;/strong&gt;ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡ŒåŒæ­¥&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éƒ¨åˆ†å¤åˆ¶&lt;/strong&gt;ï¼šå¦‚æœåç§»é‡ä¹‹åçš„æ•°æ®éƒ½åœ¨ç¼“å†²åŒºå†…ï¼Œä¸»èŠ‚ç‚¹ä¼šå›å¤ &lt;code&gt;+CONTINUE&lt;/code&gt;ï¼Œç„¶åå°†ç¼“å†²åŒºä¸­ä»èŠ‚ç‚¹ç¼ºå¤±çš„é‚£éƒ¨åˆ†æ•°æ®å‘é€è¿‡å»ã€‚ä»èŠ‚ç‚¹æ¥æ”¶å¹¶æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œå³å¯è¿½ä¸Šä¸»èŠ‚ç‚¹çš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨é‡å¤åˆ¶&lt;/strong&gt;ï¼šå¦‚æœä»èŠ‚ç‚¹ç¼ºå¤±çš„æ•°æ®å·²ç»è¢«æ–°æ•°æ®æŒ¤å‡ºç¼“å†²åŒºï¼Œä¸»èŠ‚ç‚¹ä¼šåˆ¤å®šæ— æ³•è¿›è¡Œéƒ¨åˆ†å¤åˆ¶ï¼Œè¿›è€Œè§¦å‘å…¨é‡å¤åˆ¶æµç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-é…ç½®ä¸ä¼˜åŒ–å»ºè®®"&gt;âš™ï¸ é…ç½®ä¸ä¼˜åŒ–å»ºè®®
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†ç¡®ä¿éƒ¨åˆ†å¤åˆ¶åœ¨å¤§å¤šæ•°ç½‘ç»œé—ªæ–­æƒ…å†µä¸‹éƒ½èƒ½ç”Ÿæ•ˆï¼Œåˆç†çš„é…ç½®è‡³å…³é‡è¦ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è°ƒæ•´å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå¤§å°&lt;/strong&gt;ï¼šé»˜è®¤çš„1MBç¼“å†²åŒºåœ¨å¾ˆå¤šç”Ÿäº§ç¯å¢ƒä¸­å¯èƒ½åå°ã€‚ä½ å¯ä»¥æ ¹æ®å…¬å¼æ¥ä¼°ç®—ä¸€ä¸ªåˆç†çš„å¤§å°ï¼š&lt;code&gt;ç¼“å†²åŒºå¤§å° = å¹³å‡å†™å…¥é€Ÿç‡(å­—èŠ‚/ç§’) Ã— æœ€å¤§é¢„æœŸç½‘ç»œä¸­æ–­æ—¶é—´(ç§’) Ã— å®‰å…¨ç³»æ•°(1.5-2)&lt;/code&gt;ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¹³å‡æ¯ç§’å†™å…¥100KBï¼Œé¢„è®¡æœ€é•¿ä¸­æ–­æ—¶é—´ä¸º60ç§’ï¼Œé‚£ä¹ˆç¼“å†²åŒºå¤§å°å¯è®¾ç½®ä¸ºçº¦ &lt;code&gt;100KB/s * 60s * 2 = 12MB&lt;/code&gt;ã€‚é€šè¿‡ä¿®æ”¹Redisé…ç½®æ–‡ä»¶ä¸­çš„ &lt;code&gt;repl-backlog-size&lt;/code&gt;å‚æ•°å¯ä»¥è°ƒæ•´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å¤åˆ¶çŠ¶æ€&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;INFO replication&lt;/code&gt;å‘½ä»¤å¯ä»¥æŸ¥çœ‹ä¸»ä»èŠ‚ç‚¹çš„å¤åˆ¶åç§»é‡ï¼ˆ&lt;code&gt;master_repl_offset&lt;/code&gt;å’Œ &lt;code&gt;slave_repl_offset&lt;/code&gt;ï¼‰ï¼Œä»è€Œç›‘æ§å¤åˆ¶å»¶è¿Ÿå’Œä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“ä¸å±€é™"&gt;ğŸ’ æ€»ç»“ä¸å±€é™
&lt;/h3&gt;&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼ŒRedisçš„éƒ¨åˆ†å¤åˆ¶æœºåˆ¶é€šè¿‡&lt;strong&gt;å¤åˆ¶åç§»é‡ã€ç§¯å‹ç¼“å†²åŒºå’Œè¿è¡ŒID&lt;/strong&gt;çš„ååŒå·¥ä½œï¼Œå°†ç½‘ç»œä¸­æ–­åçš„æ•°æ®åŒæ­¥ä»£ä»·ä»æ˜‚è´µçš„å…¨é‡å¤åˆ¶é™è‡³æœ€ä½ï¼Œæå¤§åœ°æå‡äº†Redisé›†ç¾¤çš„å¥å£®æ€§å’Œæ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéƒ¨åˆ†å¤åˆ¶å¹¶éä¸‡èƒ½ã€‚å¦‚æœç½‘ç»œä¸­æ–­æ—¶é—´è¿‡é•¿ï¼Œå¯¼è‡´ä»èŠ‚ç‚¹ç¼ºå¤±çš„æ•°æ®è¶…å‡ºäº†ç§¯å‹ç¼“å†²åŒºçš„å®¹é‡ï¼Œæˆ–è€…ä¸»èŠ‚ç‚¹æœ¬èº«å‘ç”Ÿå˜æ›´ï¼ˆè¿è¡ŒIDæ”¹å˜ï¼‰ï¼Œéƒ¨åˆ†å¤åˆ¶å°±ä¼š&lt;strong&gt;é€€åŒ–ä¸ºå…¨é‡å¤åˆ¶&lt;/strong&gt;ã€‚å› æ­¤ï¼Œåˆç†è®¾ç½®ç¼“å†²åŒºå¤§å°å’Œè®¾è®¡ç½‘ç»œæ¶æ„ä»ç„¶æ˜¯ä¿è¯é«˜å¯ç”¨çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£Rediséƒ¨åˆ†å¤åˆ¶çš„å·¥ä½œåŸç†ã€‚&lt;/p&gt;
&lt;h2 id="å¤åˆ¶ç§¯å‹ç¼“å†²åŒº"&gt;å¤åˆ¶ç§¯å‹ç¼“å†²åŒº
&lt;/h2&gt;&lt;p&gt;Redis çš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºæ˜¯ä¸»ä»å¤åˆ¶ä¸­å®ç°&lt;strong&gt;éƒ¨åˆ†å¤åˆ¶&lt;/strong&gt;çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒé€šè¿‡åœ¨ä¸»èŠ‚ç‚¹ä¸Šç¼“å­˜æœ€è¿‘ä¼ æ’­çš„å†™å‘½ä»¤ï¼Œæå¤§ä¼˜åŒ–äº†ç½‘ç»œé—ªæ–­ç­‰åœºæ™¯ä¸‹çš„æ•°æ®åŒæ­¥æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå¸®ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒæ¦‚å¿µã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸»èŠ‚ç‚¹ç»´æŠ¤çš„ä¸€ä¸ª&lt;strong&gt;å›ºå®šé•¿åº¦ã€å…ˆè¿›å…ˆå‡º (FIFO) çš„é˜Ÿåˆ—&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼“å­˜æœ€è¿‘ä¼ æ’­çš„å†™å‘½ä»¤ï¼Œä¸ºå› ç½‘ç»œä¸­æ–­è€Œæ•°æ®è½åçš„ä»èŠ‚ç‚¹æä¾›&lt;strong&gt;éƒ¨åˆ†å¤åˆ¶&lt;/strong&gt;çš„æ•°æ®æ¥æºï¼Œé¿å…å…¨é‡å¤åˆ¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»èŠ‚ç‚¹é‡è¿ä¸»èŠ‚ç‚¹åï¼Œä¸»èŠ‚ç‚¹å‘ç°å…¶ç¼ºå¤±çš„æ•°æ®ä»å­˜åœ¨äºè¯¥ç¼“å†²åŒºä¸­ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®ä¼˜åŠ¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›¸æ¯”å…¨é‡å¤åˆ¶ï¼Œ&lt;strong&gt;å¤§å¹…å‡å°‘æ•°æ®ä¼ è¾“é‡å’ŒåŒæ­¥æ—¶é—´&lt;/strong&gt;ï¼Œé™ä½å¯¹ä¸»ä»èŠ‚ç‚¹å’Œç½‘ç»œå¸¦å®½çš„å‹åŠ›ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®¹é‡é™åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å›ºå®šå¤§å°ï¼Œæ—§æ•°æ®ä¼šè¢«æ–°æ•°æ®æŒ¤å‡ºã€‚è‹¥ä»èŠ‚ç‚¹ç¼ºå¤±çš„æ•°æ®å·²ä¸åœ¨ç¼“å†²åŒºå†…ï¼Œåˆ™&lt;strong&gt;é€€åŒ–ä¸ºå…¨é‡å¤åˆ¶&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›¸å…³é…ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;repl-backlog-size&lt;/code&gt;ï¼šè®¾ç½®ç¼“å†²åŒºå¤§å°ï¼ˆé»˜è®¤1MBï¼‰ã€‚&lt;code&gt;repl-backlog-ttl&lt;/code&gt;ï¼šè®¾ç½®ä¸»èŠ‚ç‚¹æ— è¿æ¥æ—¶ç¼“å†²åŒºçš„ä¿ç•™æ—¶é—´ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å·¥ä½œåŸç†å¦‚ä½•å®ç°éƒ¨åˆ†å¤åˆ¶"&gt;ğŸ’¡ å·¥ä½œåŸç†ï¼šå¦‚ä½•å®ç°éƒ¨åˆ†å¤åˆ¶
&lt;/h3&gt;&lt;p&gt;å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå®ç°éƒ¨åˆ†å¤åˆ¶ï¼Œä¸»è¦ä¾èµ–ä¸‰ä¸ªå…³é”®æœºåˆ¶ååŒå·¥ä½œï¼š&lt;strong&gt;å¤åˆ¶åç§»é‡&lt;/strong&gt;ã€&lt;strong&gt;ç¼“å†²åŒºæ•°æ®ç»“æ„&lt;/strong&gt;å’Œ &lt;strong&gt;PSYNC å‘½ä»¤&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤åˆ¶åç§»é‡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸»èŠ‚ç‚¹å’Œæ¯ä¸ªä»èŠ‚ç‚¹éƒ½ä¼šå„è‡ªç»´æŠ¤ä¸€ä¸ª&lt;strong&gt;å¤åˆ¶åç§»é‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸»èŠ‚ç‚¹æ¯æ¬¡å‘ä»èŠ‚ç‚¹å‘é€Nä¸ªå­—èŠ‚çš„æ•°æ®åï¼Œä¼šå°†è‡ªèº«çš„åç§»é‡å¢åŠ Nã€‚&lt;/li&gt;
&lt;li&gt;ä»èŠ‚ç‚¹æ¯æ”¶åˆ°ä¸»èŠ‚ç‚¹ä¼ æ¥çš„Nä¸ªå­—èŠ‚æ•°æ®åï¼Œä¹Ÿä¼šå°†è‡ªèº«çš„åç§»é‡å¢åŠ Nã€‚&lt;/li&gt;
&lt;li&gt;ä»èŠ‚ç‚¹ä¼šæ¯ç§’å‘ä¸»èŠ‚ç‚¹ä¸ŠæŠ¥è‡ªå·±çš„åç§»é‡ã€‚é€šè¿‡å¯¹æ¯”ä¸»ä»åç§»é‡ï¼Œå¯ä»¥åˆ¤æ–­æ•°æ®æ˜¯å¦ä¸€è‡´ã€‚è‹¥ä»èŠ‚ç‚¹çš„åç§»é‡å°äºä¸»èŠ‚ç‚¹ï¼Œåˆ™è¯´æ˜æœ‰æ•°æ®ç¼ºå¤±ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¼“å†²åŒºçš„æ•°æ®ç»“æ„ä¸æ›´æ–°&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¼“å†²åŒºæ˜¯ä¸€ä¸ª&lt;strong&gt;å›ºå®šé•¿åº¦çš„é˜Ÿåˆ—&lt;/strong&gt;ï¼Œé™¤äº†ä¿å­˜å†™å‘½ä»¤ï¼Œè¿˜ä¼šè®°å½•æ¯ä¸ªå­—èŠ‚å¯¹åº”çš„å¤åˆ¶åç§»é‡ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å‘½ä»¤ä¼ æ’­é˜¶æ®µï¼Œä¸»èŠ‚ç‚¹åœ¨å°†å†™å‘½ä»¤å‘é€ç»™ä»èŠ‚ç‚¹çš„&lt;strong&gt;åŒæ—¶&lt;/strong&gt;ï¼Œä¹Ÿä¼šå°†å‘½ä»¤å†™å…¥è¿™ä¸ªç¼“å†²åŒºã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºé˜Ÿåˆ—é•¿åº¦å›ºå®šï¼Œå½“æ–°æ•°æ®å†™å…¥æ—¶ï¼Œæœ€æ—§çš„çš„æ•°æ®ä¼šè¢«æŒ¤å‡ºã€‚å› æ­¤ï¼Œå®ƒåªèƒ½ä¿å­˜&lt;strong&gt;æœ€è¿‘ä¸€æ®µæ—¶é—´å†…&lt;/strong&gt;çš„å†™å‘½ä»¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;PSYNC å‘½ä»¤çš„æµç¨‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“ä»èŠ‚ç‚¹ç½‘ç»œä¸­æ–­åé‡è¿ä¸»èŠ‚ç‚¹æ—¶ï¼Œéƒ¨åˆ†å¤åˆ¶çš„æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»èŠ‚ç‚¹å‘ä¸»èŠ‚ç‚¹å‘é€ &lt;code&gt;PSYNC&lt;/code&gt;å‘½ä»¤ï¼Œå¹¶æºå¸¦ä¸¤ä¸ªå…³é”®ä¿¡æ¯ï¼šè‡ªå·±ä¹‹å‰å¤åˆ¶çš„ä¸»èŠ‚ç‚¹çš„è¿è¡ŒIDå’Œå½“å‰çš„å¤åˆ¶åç§»é‡ã€‚&lt;/li&gt;
&lt;li&gt;ä¸»èŠ‚ç‚¹é¦–å…ˆéªŒè¯è¿è¡ŒIDæ˜¯å¦ä¸è‡ªèº«å½“å‰IDä¸€è‡´ã€‚å¦‚æœä¸åŒï¼Œè¯´æ˜ä»èŠ‚ç‚¹ä¹‹å‰å¤åˆ¶çš„ä¸æ˜¯è‡ªå·±ï¼Œéœ€è¦è¿›è¡Œå…¨é‡å¤åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè¿è¡ŒIDåŒ¹é…ï¼Œä¸»èŠ‚ç‚¹åˆ™æ£€æŸ¥ä»èŠ‚ç‚¹å‘é€çš„åç§»é‡ã€‚ä¸»èŠ‚ç‚¹ä¼šæ£€æŸ¥ä»èŠ‚ç‚¹çš„åç§»é‡ä¹‹åçš„æ•°æ®æ˜¯å¦ä»ç„¶å­˜åœ¨äºå¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éƒ¨åˆ†å¤åˆ¶&lt;/strong&gt;ï¼šå¦‚æœåç§»é‡ä¹‹åçš„æ•°æ®éƒ½åœ¨ç¼“å†²åŒºä¸­ï¼Œä¸»èŠ‚ç‚¹ä¼šå‘ä»èŠ‚ç‚¹å‘é€ &lt;code&gt;+CONTINUE&lt;/code&gt;å“åº”ï¼Œç„¶åä»…å°†ç¼“å†²åŒºé‡Œä»èŠ‚ç‚¹ç¼ºå¤±çš„é‚£éƒ¨åˆ†æ•°æ®å‘é€è¿‡å»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨é‡å¤åˆ¶&lt;/strong&gt;ï¼šå¦‚æœä»èŠ‚ç‚¹ç¼ºå¤±çš„æ•°æ®å·²ç»è¢«æ–°æ•°æ®ä»ç¼“å†²åŒºä¸­æŒ¤å‡ºï¼Œä¸»èŠ‚ç‚¹ä¼šåˆ¤å®šæ— æ³•è¿›è¡Œéƒ¨åˆ†å¤åˆ¶ï¼Œè¿›è€Œè§¦å‘å…¨é‡å¤åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-é…ç½®å»ºè®®ä¸ä¼˜åŒ–"&gt;ğŸ”§ é…ç½®å»ºè®®ä¸ä¼˜åŒ–
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†å……åˆ†å‘æŒ¥éƒ¨åˆ†å¤åˆ¶çš„ä¼˜åŠ¿ï¼Œåˆç†çš„é…ç½®è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è®¾ç½®åˆé€‚çš„ç¼“å†²åŒºå¤§å°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤çš„1MBé€šå¸¸åœ¨ç”Ÿäº§ç¯å¢ƒä¸­&lt;strong&gt;åå°&lt;/strong&gt;ã€‚ä½ éœ€è¦æ ¹æ®ç½‘ç»œæƒ…å†µå’Œä¸šåŠ¡è´Ÿè½½æ¥è°ƒæ•´ &lt;code&gt;repl-backlog-size&lt;/code&gt;å‚æ•°ã€‚ä¸€ä¸ªç®€å•çš„ä¼°ç®—æ–¹æ³•æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ç¼“å†²åŒºå¤§å° = å¹³å‡ç½‘ç»œä¸­æ–­æ—¶é—´(ç§’) Ã— ä¸»èŠ‚ç‚¹å¹³å‡æ¯ç§’å†™å…¥æ•°æ®é‡(å­—èŠ‚)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚æœç½‘ç»œä¸­æ–­å¹³å‡æ—¶é—´ä¸º60ç§’ï¼Œä¸»èŠ‚ç‚¹å¹³å‡æ¯ç§’äº§ç”Ÿ100KBçš„å†™å‘½ä»¤ï¼Œé‚£ä¹ˆç¼“å†²åŒºå¤§å°è‡³å°‘åº”è®¾ä¸º6MBã€‚ä¸ºäº†ä¿é™©èµ·è§ï¼Œé€šå¸¸å»ºè®®è®¾ç½®ä¸ºä¼°ç®—å€¼çš„2å€ï¼Œä¾‹å¦‚12MBã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç†è§£ &lt;code&gt;repl-backlog-ttl&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå‚æ•°æŒ‡å®šå½“æ‰€æœ‰ä»èŠ‚ç‚¹éƒ½ä¸ä¸»èŠ‚ç‚¹æ–­å¼€è¿æ¥åï¼Œä¸»èŠ‚ç‚¹ä¼šç­‰å¾…å¤šé•¿æ—¶é—´ï¼ˆé»˜è®¤ä¸º3600ç§’ï¼Œ1å°æ—¶ï¼‰åæ‰é‡Šæ”¾å¤åˆ¶ç§¯å‹ç¼“å†²åŒºçš„å†…å­˜ã€‚å¦‚æœé¢„è®¡ä»èŠ‚ç‚¹ä¼šé•¿æ—¶é—´æ–­å¼€ï¼Œå¯ä»¥é€‚å½“è°ƒå°æ­¤å€¼ä»¥é‡Šæ”¾å†…å­˜ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ ¸å¿ƒä»·å€¼ä¸æ¼”è¿›"&gt;ğŸ’ æ ¸å¿ƒä»·å€¼ä¸æ¼”è¿›
&lt;/h3&gt;&lt;p&gt;å¤åˆ¶ç§¯å‹ç¼“å†²åŒºçš„å¼•å…¥ï¼ˆä»Redis 2.8å¼€å§‹ï¼‰æ˜¯Rediså¤åˆ¶æœºåˆ¶çš„ä¸€ä¸ªé‡å¤§é£è·ƒã€‚å®ƒå°†ç½‘ç»œä¸­æ–­åçš„æ•°æ®åŒæ­¥ä»å¿…é¡»è¿›è¡Œçš„ã€é«˜å¼€é”€çš„&lt;strong&gt;å…¨é‡å¤åˆ¶&lt;/strong&gt;ï¼Œä¼˜åŒ–ä¸ºåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹çš„ã€é«˜æ•ˆçš„&lt;strong&gt;éƒ¨åˆ†å¤åˆ¶&lt;/strong&gt;ï¼Œæ˜¾è‘—æå‡äº†Redisçš„å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;åç»­çš„PSYNC2ï¼ˆRedis 4.0ï¼‰è¿›ä¸€æ­¥ä¼˜åŒ–äº†åœ¨ä¸»ä»åˆ‡æ¢æˆ–ä»å®ä¾‹é‡å¯ç­‰åœºæ™¯ä¸‹çš„è¡¨ç°ï¼Œä½†å…¶æ ¸å¿ƒæ€æƒ³ä»ç„¶ä¾èµ–äºå¤åˆ¶ç§¯å‹ç¼“å†²åŒºæ‰€æä¾›çš„æ•°æ®å¤‡ä»½èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£Rediså¤åˆ¶ç§¯å‹ç¼“å†²åŒºè¿™ä¸€é‡è¦æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h2 id="ä¸»ä»å¤åˆ¶"&gt;ä¸»ä»å¤åˆ¶
&lt;/h2&gt;&lt;p&gt;Redis ä¸»ä»å¤åˆ¶é‡‡ç”¨ç”±ä¸»èŠ‚ç‚¹ä¸»åŠ¨å°†æ•°æ®å˜æ›´æ¨é€ç»™ä»èŠ‚ç‚¹çš„æ¨¡å¼ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨æ•°æ®ä¸€è‡´æ€§ã€å®æ—¶æ€§å’Œç³»ç»Ÿæ€§èƒ½ä¹‹é—´å–å¾—æœ€ä½³å¹³è¡¡ã€‚è¿™ç§è®¾è®¡æ˜¯Rediså®ç°é«˜å¯ç”¨æ¶æ„çš„åŸºçŸ³ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€ŸæŠ“ä½æ ¸å¿ƒï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯¹æ¯”äº†â€œä¸»æ¨ä»â€æ¨¡å¼ä¸å‡æƒ³çš„â€œä»æ‹‰ä¸»â€æ¨¡å¼çš„å…³é”®å·®å¼‚ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¯¹æ¯”ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¸»èŠ‚ç‚¹æ¨é€æ¨¡å¼ (Rediså®é™…é‡‡ç”¨)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä»èŠ‚ç‚¹æ‹‰å–æ¨¡å¼ (å¯¹æ¯”å‚è€ƒ)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å®æ—¶æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜&lt;/strong&gt;ã€‚ä¸»èŠ‚ç‚¹åœ¨è‡ªèº«æ‰§è¡Œå†™å‘½ä»¤å&lt;strong&gt;ç«‹å³å¯åŠ¨æ¨é€&lt;/strong&gt;ï¼Œä»èŠ‚ç‚¹æ•°æ®å»¶è¿Ÿè¾ƒä½ã€‚&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒä½ã€‚ä»èŠ‚ç‚¹éœ€è¦å‘¨æœŸæ€§åœ°è¯¢é—®ä¸»èŠ‚ç‚¹æ˜¯å¦æœ‰æ–°æ•°æ®ï¼Œå¿…ç„¶å­˜åœ¨é—´éš”ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»èŠ‚ç‚¹å‹åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¯æ§&lt;/strong&gt;ã€‚ä¸»èŠ‚ç‚¹åœ¨å†™æ“ä½œå®Œæˆåï¼Œåªéœ€å°†å‘½ä»¤å†™å…¥æ¯ä¸ªä»èŠ‚ç‚¹çš„è¿æ¥ç¼“å†²åŒºï¼Œç”±åå°è¿›ç¨‹å¼‚æ­¥å‘é€ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¯èƒ½äº§ç”Ÿç©ºè¯·æ±‚&lt;/strong&gt;ã€‚å³ä½¿æ²¡æœ‰æ•°æ®æ›´æ–°ï¼Œä»èŠ‚ç‚¹çš„é¢‘ç¹è½®è¯¢ä¹Ÿä¼šæ¶ˆè€—ä¸»èŠ‚ç‚¹çš„CPUå’Œç½‘ç»œèµ„æºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç½‘ç»œæ•ˆç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è¾ƒé«˜&lt;/strong&gt;ã€‚é€šå¸¸åªåœ¨æœ‰æ•°æ®å˜æ›´æ—¶äº§ç”Ÿç½‘ç»œæµé‡ï¼Œä¸”å¯åˆå¹¶å¤šä¸ªå‘½ä»¤è¿›è¡Œæ‰¹é‡ä¼ è¾“ã€‚&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒä½ã€‚è½®è¯¢è¯·æ±‚å¯èƒ½å¤§éƒ¨åˆ†æ˜¯â€œç©ºè·‘â€ï¼Œæ— æ•ˆé€šä¿¡æ¯”ä¾‹è¾ƒé«˜ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡å¤æ‚æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸»èŠ‚ç‚¹é€»è¾‘ç¨å¤æ‚&lt;/strong&gt;ï¼Œéœ€ç»´æŠ¤æ¯ä¸ªä»èŠ‚ç‚¹çš„å¤åˆ¶çŠ¶æ€å’Œç¼“å†²åŒºã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä»èŠ‚ç‚¹é€»è¾‘å¤æ‚&lt;/strong&gt;ï¼Œéœ€è¦å„è‡ªç»´æŠ¤æ‹‰å–åç§»é‡å’Œå¤„ç†æ‹‰å–å¤±è´¥ç­‰é€»è¾‘ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€è‡´æ€§ä¿éšœ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¼º&lt;/strong&gt;ã€‚ä¸»èŠ‚ç‚¹æ§åˆ¶æ•°æ®åˆ†å‘é¡ºåºï¼Œæ‰€æœ‰ä»èŠ‚ç‚¹ä»¥ç›¸åŒé¡ºåºæ¥æ”¶å‘½ä»¤ï¼Œæ˜“äºä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹å¤æ‚ã€‚éœ€è¦é¢å¤–æœºåˆ¶æ¥ä¿è¯å¤šä¸ªä»èŠ‚ç‚¹åœ¨æ‹‰å–æ—¶æ•°æ®è§†å›¾çš„ä¸€è‡´æ€§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ¨é€æ¨¡å¼çš„å·¥ä½œæµç¨‹"&gt;ğŸ”„ æ¨é€æ¨¡å¼çš„å·¥ä½œæµç¨‹
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†è®©ä½ æ›´ç›´è§‚åœ°ç†è§£ä¸»èŠ‚ç‚¹å¦‚ä½•æ¨é€æ•°æ®ï¼Œä¸‹å›¾æç»˜äº†ä»ä¸€æ¡å†™å‘½ä»¤å‘ç”Ÿåˆ°æˆåŠŸå¤åˆ¶åˆ°ä»èŠ‚ç‚¹çš„å®Œæ•´æ•°æ®æµã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;flowchart TD
A[å®¢æˆ·ç«¯å‘ä¸»èŠ‚ç‚¹å‘é€å†™å‘½ä»¤] --&amp;gt; B[ä¸»èŠ‚ç‚¹æœ¬åœ°æ‰§è¡Œå‘½ä»¤]
B --&amp;gt; C{ä¸»èŠ‚ç‚¹æ˜¯å¦å¯ç”¨AOF?}
C -- æ˜¯ --&amp;gt; D[å†™å…¥AOFç¼“å†²åŒº]
C -- å¦ --&amp;gt; E
D --&amp;gt; E[å°†å‘½ä»¤å†™å…¥&amp;lt;br&amp;gt;æ‰€æœ‰ä»èŠ‚ç‚¹çš„å¤åˆ¶ç¼“å†²åŒº&amp;lt;br&amp;gt;ä¸å¤åˆ¶ç§¯å‹ç¼“å†²åŒº]
E --&amp;gt; F[ä¸»èŠ‚ç‚¹é€šè¿‡å·²å»ºç«‹çš„&amp;lt;br&amp;gt;é•¿è¿æ¥å°†å‘½ä»¤å¼‚æ­¥æ¨é€è‡³ä»èŠ‚ç‚¹]
F --&amp;gt; G[ä»èŠ‚ç‚¹æ¥æ”¶å‘½ä»¤å¹¶æ‰§è¡Œ]
G --&amp;gt; H[ä»èŠ‚ç‚¹å‘ä¸»èŠ‚ç‚¹&amp;lt;br&amp;gt;å‘é€ACKåŠæœ€æ–°å¤åˆ¶åç§»é‡]
H --&amp;gt; I[ä¸»èŠ‚ç‚¹æ›´æ–°è¯¥ä»èŠ‚ç‚¹çš„çŠ¶æ€]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªæµç¨‹ä½“ç°äº†æ¨é€æ¨¡å¼çš„å‡ ä¸ªå…³é”®ä¼˜åŠ¿ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥éé˜»å¡&lt;/strong&gt;ï¼šä¸»èŠ‚ç‚¹åœ¨å°†å‘½ä»¤æ”¾å…¥å¤åˆ¶ç¼“å†²åŒºï¼ˆReplication Bufferï¼‰åå°±å¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–è¯·æ±‚ï¼Œå®é™…çš„ç½‘ç»œä¼ è¾“ç”±åå°è¿›ç¨‹å®Œæˆï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•ä¸€æ•°æ®æµ&lt;/strong&gt;ï¼šæ•°æ®ä»ä¸»èŠ‚ç‚¹â€œä¸€â€å¯¹â€œå¤šâ€åœ°åˆ†å‘ç»™æ‰€æœ‰ä»èŠ‚ç‚¹ï¼Œè·¯å¾„æ¸…æ™°é«˜æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€å¯ç›‘æ§&lt;/strong&gt;ï¼šä»èŠ‚ç‚¹ä¼šå®šæœŸå‘ä¸»èŠ‚ç‚¹æŠ¥å‘Šè‡ªå·±çš„å¤åˆ¶åç§»é‡ï¼ˆReplication Offsetï¼‰ï¼Œä¸»èŠ‚ç‚¹é€šè¿‡å¯¹æ¯”åç§»é‡å¯ä»¥ç›‘æ§æ¯ä¸ªä»èŠ‚ç‚¹çš„æ•°æ®åŒæ­¥çŠ¶æ€å’Œå»¶è¿Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸ºä»€ä¹ˆä¸æ˜¯ä»èŠ‚ç‚¹æ¥æ‹‰å–"&gt;ğŸ’¡ ä¸ºä»€ä¹ˆä¸æ˜¯ä»èŠ‚ç‚¹æ¥æ‹‰å–ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;è™½ç„¶ä»èŠ‚ç‚¹æ‹‰å–çš„æ¨¡å¼åœ¨éƒ¨åˆ†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜åœ¨ï¼Œä½†å¯¹äºRedisçš„ä¸»ä»å¤åˆ¶ç›®æ ‡è€Œè¨€ï¼Œæ¨é€æ¨¡å¼æ˜¯æ›´ä¼˜çš„é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶æ€§å·®è·&lt;/strong&gt;ï¼šæ‹‰å–æ¨¡å¼å¿…ç„¶å¼•å…¥è½®è¯¢é—´éš”ï¼Œéš¾ä»¥è¾¾åˆ°æ¨é€æ¨¡å¼çš„ä½å»¶è¿Ÿæ•°æ®åŒæ­¥æ•ˆæœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ¶ˆè€—&lt;/strong&gt;ï¼šåœ¨å†™æ“ä½œä¸é¢‘ç¹çš„åœºæ™¯ä¸‹ï¼Œæ‹‰å–æ¨¡å¼ä¼šäº§ç”Ÿå¤§é‡æ— æ•°æ®çš„â€œç©ºè½®è¯¢â€è¯·æ±‚ï¼Œæµªè´¹ç½‘ç»œå’ŒCPUèµ„æºã€‚è€Œæ¨é€æ¨¡å¼åªåœ¨æœ‰å®é™…æ•°æ®å˜æ›´æ—¶äº§ç”Ÿæµé‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€»è¾‘å¤æ‚æ€§&lt;/strong&gt;ï¼šå¦‚æœé‡‡ç”¨æ‹‰å–ï¼Œæ¯ä¸ªä»èŠ‚ç‚¹éƒ½éœ€è¦ç‹¬ç«‹ç»´æŠ¤ä¸€å¥—æ‹‰å–é€»è¾‘å’Œåç§»é‡ç®¡ç†ï¼Œåœ¨é›†ç¾¤è§„æ¨¡å¤§æ—¶ä¼šç»™ä¸»èŠ‚ç‚¹å¸¦æ¥æ›´å¤æ‚çš„ç®¡ç†è´Ÿæ‹…ã€‚è€Œæ¨é€æ¨¡å¼ç”±ä¸»èŠ‚ç‚¹ç»Ÿä¸€ç®¡ç†æ•°æ®æµï¼Œæ¶æ„æ›´ç®€æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ½œåœ¨æŒ‘æˆ˜ä¸ä¼˜åŒ–"&gt;âš ï¸ æ½œåœ¨æŒ‘æˆ˜ä¸ä¼˜åŒ–
&lt;/h3&gt;&lt;p&gt;å½“ç„¶ï¼Œæ¨é€æ¨¡å¼ä¹Ÿéå®Œç¾ï¼Œå®ƒå¯èƒ½ç»™ä¸»èŠ‚ç‚¹å¸¦æ¥å‹åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨ä»èŠ‚ç‚¹æ•°é‡å¤šã€ç½‘ç»œå»¶è¿Ÿé«˜æˆ–ä»èŠ‚ç‚¹å¤„ç†é€Ÿåº¦æ…¢çš„æƒ…å†µä¸‹ã€‚å› ä¸ºä¸»èŠ‚ç‚¹éœ€è¦ä¸º&lt;strong&gt;æ¯ä¸ªä»èŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„å¤åˆ¶ç¼“å†²åŒºï¼ˆReplication Bufferï¼‰&lt;/strong&gt;ã€‚å¦‚æœæŸä¸ªä»èŠ‚ç‚¹åŒæ­¥å¤ªæ…¢ï¼Œä¼šå¯¼è‡´å®ƒçš„ç¼“å†²åŒºæŒç»­ç§¯å‹ï¼Œå ç”¨å¤§é‡ä¸»èŠ‚ç‚¹å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;Redisæä¾›äº† &lt;code&gt;client-output-buffer-limit&lt;/code&gt;é…ç½®é¡¹æ¥é™åˆ¶ç¼“å†²åŒºå¤§å°ï¼Œå½“ç¼“å†²åŒºè¶…è¿‡é™åˆ¶æ—¶ï¼Œä¸»èŠ‚ç‚¹ä¼šæ–­å¼€ä¸è¯¥ä»èŠ‚ç‚¹çš„è¿æ¥ï¼Œè¿™æ˜¯ä¸€ç§è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼ŒRedisé€‰æ‹©ä¸»èŠ‚ç‚¹æ¨é€çš„æ¨¡å¼ï¼Œæ˜¯åœ¨æƒè¡¡äº†&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§ã€å®æ—¶æ€§ã€æ€§èƒ½å¼€é”€å’Œç³»ç»Ÿå¤æ‚åº¦&lt;/strong&gt;ä¹‹åçš„æœ€ä½³å†³ç­–ã€‚å®ƒç¡®ä¿äº†ä»èŠ‚ç‚¹èƒ½å°½å¯èƒ½å¿«åœ°ä¿æŒä¸ä¸»èŠ‚ç‚¹çš„æ•°æ®åŒæ­¥ï¼ŒåŒæ—¶ä½¿æ•´ä¸ªå¤åˆ¶æ¶æ„æ¸…æ™°ã€é«˜æ•ˆï¼Œä¸ºRedisçš„é«˜å¯ç”¨å’Œè¯»å†™åˆ†ç¦»ç‰¹æ€§æä¾›äº†åšå®åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ é€å½»åœ°ç†è§£Redisä¸»ä»å¤åˆ¶çš„è¿™ä¸€æ ¸å¿ƒè®¾è®¡ã€‚&lt;/p&gt;
&lt;h2 id="æ•…éšœè½¬ç§»"&gt;æ•…éšœè½¬ç§»
&lt;/h2&gt;&lt;p&gt;Redis æ•…éšœè½¬ç§»ï¼ˆFailoverï¼‰æ˜¯ Redis å®ç°é«˜å¯ç”¨çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå®ƒèƒ½åœ¨ä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰å‘ç”Ÿæ•…éšœæ—¶ï¼Œè‡ªåŠ¨å°†ä¸€ä¸ªä»èŠ‚ç‚¹ï¼ˆSlaveï¼‰æå‡ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯æœåŠ¡æŒç»­å¯ç”¨ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€ŸæŠ“ä½æ ¸å¿ƒè„‰ç»œã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æœºåˆ¶ç»„ä»¶&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒèŒè´£&lt;/th&gt;
&lt;th&gt;å…³é”®ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Sentinelï¼ˆå“¨å…µï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç›‘æ§&lt;/strong&gt;ï¼šæŒç»­æ£€æŸ¥ä¸»ä»èŠ‚ç‚¹å¥åº·çŠ¶æ€ã€‚ &lt;strong&gt;å†³ç­–&lt;/strong&gt;ï¼šåˆ¤æ–­ä¸»èŠ‚ç‚¹æ˜¯å¦ä¸‹çº¿å¹¶è§¦å‘æ•…éšœè½¬ç§»ã€‚ &lt;strong&gt;é€šçŸ¥&lt;/strong&gt;ï¼šå‘ŠçŸ¥å®¢æˆ·ç«¯å’Œå…¶ä½™èŠ‚ç‚¹æ–°ä¸»èŠ‚ç‚¹ä¿¡æ¯ã€‚&lt;/td&gt;
&lt;td&gt;ç‹¬ç«‹éƒ¨ç½²çš„ç‰¹æ®Š Redis è¿›ç¨‹ï¼Œä¸å­˜å‚¨æ•°æ®ï¼Œä¸“æ³¨äºç®¡ç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Redis Clusterï¼ˆé›†ç¾¤ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®åˆ†ç‰‡&lt;/strong&gt;ï¼šå°†æ•°æ®åˆ†å¸ƒåˆ°ä¸åŒä¸»èŠ‚ç‚¹ã€‚ &lt;strong&gt;å†…éƒ¨åè°ƒ&lt;/strong&gt;ï¼šèŠ‚ç‚¹é—´é€šè¿‡ Gossip åè®®é€šä¿¡ï¼Œå…±åŒå®Œæˆæ•…éšœæ£€æµ‹å’Œè½¬ç§»ã€‚&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼æ¶æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹å…¼å…·æ•°æ®å­˜å‚¨å’Œé›†ç¾¤ç®¡ç†åŠŸèƒ½ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ•…éšœè½¬ç§»å¦‚ä½•å·¥ä½œ"&gt;ğŸ’¡ æ•…éšœè½¬ç§»å¦‚ä½•å·¥ä½œ
&lt;/h3&gt;&lt;p&gt;Redis ä¸»è¦é€šè¿‡ä¸¤ç§æ¨¡å¼å®ç°æ•…éšœè½¬ç§»ï¼š&lt;strong&gt;Sentinel æ¨¡å¼&lt;/strong&gt;å’Œ &lt;strong&gt;Cluster æ¨¡å¼&lt;/strong&gt;ã€‚å®ƒä»¬çš„æ ¸å¿ƒç›®æ ‡ä¸€è‡´ï¼Œä½†å®ç°è·¯å¾„å’Œé€‚ç”¨åœºæ™¯æœ‰æ‰€ä¸åŒã€‚&lt;/p&gt;
&lt;h4 id="-sentinelå“¨å…µæ¨¡å¼"&gt;ğŸ” Sentinelï¼ˆå“¨å…µï¼‰æ¨¡å¼
&lt;/h4&gt;&lt;p&gt;Sentinel æ¨¡å¼åœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥ä¸€ä¸ªç‹¬ç«‹çš„â€œå“¨å…µâ€ç³»ç»Ÿæ¥ç®¡ç†æ•…éšœè½¬ç§»ã€‚å…¶å·¥ä½œæµç¨‹ç¯ç¯ç›¸æ‰£ï¼Œä¸‹å›¾æ¸…æ™°åœ°å±•ç¤ºäº†ä»æ•…éšœå‘ç”Ÿåˆ°æœåŠ¡æ¢å¤çš„å®Œæ•´è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;flowchart TD
A[Sentinel å®šæ—¶PINGä¸»èŠ‚ç‚¹] --&amp;gt; B{ä¸»èŠ‚ç‚¹è¶…æ—¶æœªå“åº”?}
B -- æ˜¯ --&amp;gt; C[æ ‡è®°ä¸»èŠ‚ç‚¹ä¸º&amp;#39;ä¸»è§‚ä¸‹çº¿&amp;#39;ï¼ˆSDOWNï¼‰]
B -- å¦ --&amp;gt; A
C --&amp;gt; D[Sentinel å‘å…¶ä»–Sentinelç¡®è®¤]
D --&amp;gt; E{è¾¾åˆ°æ³•å®šä¸ªæ•°åŒæ„?}
E -- æ˜¯ --&amp;gt; F[æ ‡è®°ä¸»èŠ‚ç‚¹ä¸º&amp;#39;å®¢è§‚ä¸‹çº¿&amp;#39;ï¼ˆODOWNï¼‰]
E -- å¦ --&amp;gt; C
F --&amp;gt; G[Sentinelé—´é€‰ä¸¾å‡ºLeader]
G --&amp;gt; H[Leader Sentinelæ‰§è¡Œæ•…éšœè½¬ç§»]
H --&amp;gt; I[é€‰æ‹©æœ€åˆé€‚çš„ä»èŠ‚ç‚¹]
I --&amp;gt; J[å°†å…¶æå‡ä¸ºæ–°ä¸»èŠ‚ç‚¹&amp;lt;br&amp;gt;ï¼ˆSLAVEOF NO ONEï¼‰]
J --&amp;gt; K[é€šçŸ¥å…¶ä»–ä»èŠ‚ç‚¹å¤åˆ¶æ–°ä¸»èŠ‚ç‚¹]
K --&amp;gt; L[æ›´æ–°å®¢æˆ·ç«¯é…ç½®]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹çš„å…³é”®æ­¥éª¤åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸»è§‚ä¸‹çº¿ï¼ˆSDOWNï¼‰ä¸å®¢è§‚ä¸‹çº¿ï¼ˆODOWNï¼‰&lt;/strong&gt;ï¼šæ¯ä¸ª Sentinel ä¼šæ¯ç§’å‘ä¸»ä»èŠ‚ç‚¹å‘é€ PING å‘½ä»¤è¿›è¡Œå¿ƒè·³æ£€æµ‹ã€‚å¦‚æœæŸä¸ª Sentinel å‘ç°ä¸»èŠ‚ç‚¹åœ¨æŒ‡å®šæ—¶é—´å†…ï¼ˆå¦‚ &lt;code&gt;down-after-milliseconds 30000&lt;/code&gt;ï¼‰æ²¡æœ‰æœ‰æ•ˆå›å¤ï¼ˆå¦‚è¶…æ—¶æˆ–è¿”å›é”™è¯¯ï¼‰ï¼Œå®ƒä¼š&lt;strong&gt;ä¸»è§‚åœ°&lt;/strong&gt;è®¤ä¸ºä¸»èŠ‚ç‚¹ä¸‹çº¿äº†ã€‚ä½†å•ä¸ª Sentinel çš„åˆ¤æ–­å¯èƒ½å‡ºé”™ã€‚å› æ­¤ï¼Œè¿™ä¸ª Sentinel ä¼šå’¨è¯¢å…¶ä»–ä¹Ÿåœ¨ç›‘æ§è¯¥ä¸»èŠ‚ç‚¹çš„ Sentinelã€‚å½“åŒæ„ä¸»èŠ‚ç‚¹ä¸‹çº¿çš„ Sentinel æ•°é‡è¾¾åˆ°é…ç½®çš„æ³•å®šä¸ªæ•°ï¼ˆquorumï¼Œå¦‚ &lt;code&gt;sentinel monitor mymaster 192.168.1.10 6379 2&lt;/code&gt;ä¸­çš„ 2ï¼‰æ—¶ï¼Œä¸»èŠ‚ç‚¹è¢«æ ‡è®°ä¸º&lt;strong&gt;å®¢è§‚ä¸‹çº¿&lt;/strong&gt;ï¼Œè¿™æ‰çœŸæ­£è§¦å‘æ•…éšœè½¬ç§»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ä¸¾é¢†å¤´ Sentinel&lt;/strong&gt;ï¼šå½“å®¢è§‚ä¸‹çº¿æˆç«‹ï¼Œå¤šä¸ª Sentinel ä¼šé€šè¿‡ç±»ä¼¼ Raft çš„ç®—æ³•é€‰ä¸¾å‡ºä¸€ä¸ª &lt;strong&gt;Leader&lt;/strong&gt;ï¼Œç”±å®ƒæ¥è´Ÿè´£æ‰§è¡Œå…·ä½“çš„æ•…éšœè½¬ç§»æ“ä½œï¼Œé¿å…å†³ç­–æ··ä¹±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©æ–°ä¸»èŠ‚ç‚¹&lt;/strong&gt;ï¼šé¢†å¤´ Sentinel ä¼šä»åŸä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ä¸­ï¼Œæ ¹æ®&lt;strong&gt;ä¼˜å…ˆçº§ï¼ˆreplica-priorityï¼‰&lt;/strong&gt;ã€&lt;strong&gt;æ•°æ®å¤åˆ¶åç§»é‡ï¼ˆå¤åˆ¶æœ€å®Œæ•´çš„ï¼‰&lt;/strong&gt; ä»¥åŠ &lt;strong&gt;è¿è¡ŒID&lt;/strong&gt; ç­‰æ¡ä»¶ï¼Œç­›é€‰å‡ºæœ€åˆé€‚çš„ä¸€ä¸ªä½œä¸ºæ–°ä¸»èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ‡æ¢ä¸é€šçŸ¥&lt;/strong&gt;ï¼šé¢†å¤´ Sentinel ä¼šå‘é€‰ä¸­çš„ä»èŠ‚ç‚¹å‘é€ &lt;code&gt;SLAVEOF NO ONE&lt;/code&gt;å‘½ä»¤ï¼Œä½¿å…¶æ™‹å‡ä¸ºä¸»èŠ‚ç‚¹ã€‚ç„¶åï¼Œå®ƒä¼šé€šçŸ¥å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶è¿™ä¸ªæ–°ä¸»èŠ‚ç‚¹ï¼Œå¹¶æœ€ç»ˆå°†æ–°çš„ä¸»èŠ‚ç‚¹åœ°å€é€šçŸ¥ç»™å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="-redis-clusteré›†ç¾¤æ¨¡å¼"&gt;ğŸ”— Redis Clusterï¼ˆé›†ç¾¤ï¼‰æ¨¡å¼
&lt;/h4&gt;&lt;p&gt;åœ¨ Cluster æ¨¡å¼ä¸‹ï¼Œæ•…éšœè½¬ç§»çš„åŠŸèƒ½è¢«é›†æˆåˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸­ï¼Œæ— éœ€é¢å¤–éƒ¨ç½² Sentinelã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœæ£€æµ‹&lt;/strong&gt;ï¼šé›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šå®šæœŸå‘å…¶ä»–èŠ‚ç‚¹å‘é€ PING æ¶ˆæ¯ã€‚å¦‚æœæŸä¸ªä¸»èŠ‚ç‚¹ï¼ˆNode Aï¼‰åœ¨ç‰¹å®šæ—¶é—´å†…æ²¡æœ‰å“åº” PONGï¼Œå…¶ä»–èŠ‚ç‚¹å°±ä¼šå°†å…¶æ ‡è®°ä¸º&lt;strong&gt;ç–‘ä¼¼ä¸‹çº¿ï¼ˆPFailï¼‰&lt;/strong&gt;ã€‚è¿™ä¸€ä¿¡æ¯ä¼šé€šè¿‡ &lt;strong&gt;Gossip åè®®&lt;/strong&gt;åœ¨é›†ç¾¤å†…ä¼ æ’­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœç¡®è®¤&lt;/strong&gt;ï¼šå½“é›†ç¾¤ä¸­è¶…è¿‡åŠæ•°çš„æŒæœ‰æ§½ï¼ˆslotï¼‰çš„ä¸»èŠ‚ç‚¹éƒ½è®¤ä¸º Node A ç–‘ä¼¼ä¸‹çº¿æ—¶ï¼ŒNode A è¢«æ­£å¼æ ‡è®°ä¸º&lt;strong&gt;å·²ä¸‹çº¿ï¼ˆFailï¼‰&lt;/strong&gt;ã€‚éšåï¼Œé›†ç¾¤ä¼šå‘æ‰€æœ‰èŠ‚ç‚¹å¹¿æ’­ä¸€æ¡ FAIL æ¶ˆæ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»èŠ‚ç‚¹æ™‹å‡&lt;/strong&gt;ï¼šä¸€æ—¦ Node A è¢«ç¡®è®¤ä¸ºå·²ä¸‹çº¿ï¼Œå…¶å±ä¸‹çš„ä¸€ä¸ªä»èŠ‚ç‚¹ä¼šè‡ªåŠ¨å‘èµ·é€‰ä¸¾ï¼Œç»é›†ç¾¤ä¸­å…¶ä»–ä¸»èŠ‚ç‚¹æŠ•ç¥¨åŒæ„åï¼Œæ™‹å‡ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶æ¥ç®¡ Node A è´Ÿè´£çš„æ‰€æœ‰å“ˆå¸Œæ§½ï¼ˆHash Slotï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤é…ç½®æ›´æ–°&lt;/strong&gt;ï¼šæ–°ä¸»èŠ‚ç‚¹çš„ä¿¡æ¯ä¼šé€šè¿‡ Gossip åè®®è¿…é€Ÿæ‰©æ•£åˆ°æ•´ä¸ªé›†ç¾¤ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šæ›´æ–°æœ¬åœ°çš„é›†ç¾¤é…ç½®ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-sentinel-ä¸-cluster-æ¨¡å¼å¯¹æ¯”"&gt;ğŸ†š Sentinel ä¸ Cluster æ¨¡å¼å¯¹æ¯”
&lt;/h3&gt;&lt;p&gt;äº†è§£ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«ï¼Œèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°è¿›è¡ŒæŠ€æœ¯é€‰å‹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¯¹æ¯”ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Sentinel æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Cluster æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¯ç”¨æ€§ï¼ˆHAï¼‰&lt;/strong&gt;ï¼Œæä¾›ä¸»ä»è‡ªåŠ¨æ•…éšœåˆ‡æ¢ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¯æ‰©å±•æ€§ + é«˜å¯ç”¨æ€§&lt;/strong&gt;ï¼Œå®ç°æ•°æ®åˆ†ç‰‡å’Œåˆ†å¸ƒå¼å­˜å‚¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®åˆ†å¸ƒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸»ä»èŠ‚ç‚¹å­˜å‚¨&lt;strong&gt;å…¨é‡æ•°æ®&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;td&gt;æ•°æ®&lt;strong&gt;åˆ†ç‰‡&lt;/strong&gt;å­˜å‚¨åœ¨å¤šä¸ªä¸»èŠ‚ç‚¹ä¸Šã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†™æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†™æ“ä½œé›†ä¸­åœ¨å•ä¸€ä¸»èŠ‚ç‚¹ï¼Œæ— æ³•æ°´å¹³æ‰©å±•ã€‚&lt;/td&gt;
&lt;td&gt;å†™è¯·æ±‚å¯åˆ†æ•£åˆ°å¤šä¸ªä¸»èŠ‚ç‚¹ï¼Œæå‡æ•´ä½“å†™ååé‡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®é‡ä¸å¤§ï¼Œéœ€è¦é«˜å¯ç”¨è¯»æœåŠ¡çš„åœºæ™¯ã€‚&lt;/td&gt;
&lt;td&gt;æ•°æ®é‡å·¨å¤§ï¼Œéœ€è¦é«˜æ€§èƒ½è¯»å†™å’Œé«˜å¯ç”¨æ€§çš„åœºæ™¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;å®ç°é«˜å¯ç”¨çš„åŒæ—¶ï¼Œä¹Ÿéœ€å…³æ³¨ä»¥ä¸‹æŒ‘æˆ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è„‘è£‚é—®é¢˜ï¼ˆSplit-brainï¼‰&lt;/strong&gt;ï¼šåœ¨ç½‘ç»œåˆ†åŒºç­‰æç«¯æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°åœ¨ä¸¤ä¸ªç½‘ç»œåˆ†åŒºä¸­åŒæ—¶å­˜åœ¨æ´»è·ƒçš„ä¸»èŠ‚ç‚¹ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚Sentinel çš„ &lt;strong&gt;quorum&lt;/strong&gt; æœºåˆ¶å’Œ Cluster çš„&lt;strong&gt;å¤šæ•°æ´¾æŠ•ç¥¨&lt;/strong&gt;éƒ½æ˜¯ä¸ºäº†å°½é‡å‡å°‘æ­¤ç±»é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;ï¼šRedis ä¸»ä»å¤åˆ¶æ˜¯&lt;strong&gt;å¼‚æ­¥&lt;/strong&gt;çš„ã€‚åœ¨æ•…éšœåˆ‡æ¢çš„ç¬é—´ï¼Œæ–°ä¸»èŠ‚ç‚¹å¯èƒ½å°šæœªå®Œå…¨åŒæ­¥åŸä¸»èŠ‚ç‚¹çš„æœ€æ–°æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´å°‘é‡æ•°æ®ä¸¢å¤±ã€‚å¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´é…ç½®ï¼ˆå¦‚ &lt;code&gt;min-replicas-to-write&lt;/code&gt;ï¼‰æ¥å¢å¼ºä¸€è‡´æ€§ï¼Œä½†è¿™é€šå¸¸ä¼šå½±å“æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯æ”¯æŒ&lt;/strong&gt;ï¼šä½¿ç”¨ Cluster æˆ– Sentinel æ¨¡å¼æ—¶ï¼Œéœ€è¦ç¡®ä¿å®¢æˆ·ç«¯åº“æ”¯æŒå¹¶æ­£ç¡®é…ç½®ï¼Œèƒ½å¤Ÿæ„ŸçŸ¥æ‹“æ‰‘å˜åŒ–å¹¶é‡å®šå‘è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ å…¨é¢ç†è§£ Redis çš„æ•…éšœè½¬ç§»æœºåˆ¶ã€‚å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„é…ç½®ç»†èŠ‚æœ‰è¿›ä¸€æ­¥å…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;</description></item></channel></rss>