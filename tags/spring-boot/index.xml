<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Spring Boot on é£é¸¿è¸é›ªæ³¥</title><link>https://dyhes.github.io/tags/spring-boot/</link><description>Recent content in Spring Boot on é£é¸¿è¸é›ªæ³¥</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 30 Sep 2025 19:46:00 +0800</lastBuildDate><atom:link href="https://dyhes.github.io/tags/spring-boot/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€Spring Bootã€‘Source Code</title><link>https://dyhes.github.io/p/spring-bootsource-code/</link><pubDate>Thu, 25 Sep 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/spring-bootsource-code/</guid><description>&lt;h2 id="bootstrapregistryinitializer"&gt;BootstrapRegistryInitializer
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;æ˜¯ Spring Boot åº”ç”¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¸€ä¸ª&lt;strong&gt;æ—©æœŸä¸”å…³é”®&lt;/strong&gt;çš„æ‰©å±•ç‚¹ï¼Œå®ƒå…è®¸ä½ åœ¨ Spring åº”ç”¨ä¸Šä¸‹æ–‡ï¼ˆ&lt;code&gt;ApplicationContext&lt;/code&gt;ï¼‰æ­£å¼åˆ›å»ºä¹‹å‰ï¼Œæ‰§è¡Œè‡ªå®šä¹‰çš„åˆå§‹åŒ–é€»è¾‘å¹¶æ³¨å†Œä¸€äº›éœ€è¦åœ¨å¯åŠ¨æ—©æœŸé˜¶æ®µä½¿ç”¨çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹èµ·æ•´ä½“è®¤çŸ¥ï¼Œä¸‹è¡¨æ¦‚æ‹¬äº† &lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;çš„æ ¸å¿ƒç‰¹æ€§ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒè¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ &lt;code&gt;ApplicationContext&lt;/code&gt;åˆ›å»ºä¹‹å‰ï¼Œè¿›è¡Œæ—©æœŸå¯¹è±¡æ³¨å†Œå’Œåˆå§‹åŒ–ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œæ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SpringApplication.run()&lt;/code&gt;æ–¹æ³•çš„æ—©æœŸé˜¶æ®µï¼Œåœ¨åˆ›å»º &lt;code&gt;ApplicationContext&lt;/code&gt;ä¹‹å‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;code&gt;BootstrapRegistry&lt;/code&gt;æ³¨å†Œå¯¹è±¡ã€æ·»åŠ å…³é—­äº‹ä»¶ç›‘å¬å™¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é…ç½®æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ &lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶ä¸­å£°æ˜ï¼Œæˆ–é€šè¿‡ &lt;code&gt;SpringApplication.addBootstrapRegistryInitializer()&lt;/code&gt;æ–¹æ³•æ·»åŠ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ³¨å†Œçš„å¯¹è±¡åœ¨ &lt;code&gt;ApplicationContext&lt;/code&gt;å‡†å¤‡å°±ç»ªåï¼Œé»˜è®¤ä¸å†å¯ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-è®¾è®¡ç›®æ ‡ä¸é€‚ç”¨åœºæ™¯"&gt;ğŸ’¡ è®¾è®¡ç›®æ ‡ä¸é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;Spring Boot è®¾è®¡ &lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;ä¸»è¦æ˜¯ä¸ºäº†è§£å†³ä¸€äº›éœ€è¦åœ¨ &lt;strong&gt;IoC å®¹å™¨å®Œå…¨å¯åŠ¨ä¹‹å‰&lt;/strong&gt; å°±å®Œæˆçš„åˆå§‹åŒ–éœ€æ±‚ï¼Œå®ç°ç¯å¢ƒéš”ç¦»ï¼Œå¹¶ä¼˜åŒ–å¯åŠ¨æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒçš„å…¸å‹åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤–éƒ¨é…ç½®é¢„åŠ è½½&lt;/strong&gt;ï¼šåœ¨åŠ è½½æœ¬åœ° &lt;code&gt;application.properties&lt;/code&gt;ä¹‹å‰ï¼Œä¼˜å…ˆä»è¿œç¨‹é…ç½®ä¸­å¿ƒï¼ˆå¦‚ Spring Cloud Configã€Nacosï¼‰æ‹‰å–é…ç½®ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€è®¾æ–½åˆå§‹åŒ–&lt;/strong&gt;ï¼šæå‰åˆå§‹åŒ–ä¸€äº›åŸºç¡€ç»„ä»¶ï¼Œå¦‚æ—¥å¿—ç³»ç»Ÿã€ç›‘æ§ä»£ç†ï¼ˆPrometheus Clientï¼‰ã€åˆ†å¸ƒå¼è¿½è¸ªå·¥å…·ï¼ˆZipkinï¼‰ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜‚è´µèµ„æºé¢„æ³¨å†Œ&lt;/strong&gt;ï¼šæ³¨å†Œé‚£äº›åˆ›å»ºæˆæœ¬è¾ƒé«˜çš„å¯¹è±¡åŸå‹ï¼Œå¦‚æ•°æ®åº“è¿æ¥æ± ã€ç¼“å­˜å®¢æˆ·ç«¯ç­‰ï¼Œä»¥ä¾¿åœ¨åç»­çš„è‡ªåŠ¨é…ç½®ä¸­å¤ç”¨ï¼Œé¿å…é‡å¤åˆ›å»ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†å¯åŠ¨æµç¨‹ä¸­çš„è§’è‰²"&gt;ğŸ” æ ¸å¿ƒåŸç†ï¼šå¯åŠ¨æµç¨‹ä¸­çš„è§’è‰²
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;çš„è°ƒç”¨æ˜¯ Spring Boot å¯åŠ¨æµç¨‹ä¸­çš„ä¸€ä¸ªç²¾ç¡®æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ è½½å®ç°ç±»&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;SpringApplication&lt;/code&gt;çš„æ„é€ é˜¶æ®µï¼Œé€šè¿‡ &lt;code&gt;SpringFactoriesLoader&lt;/code&gt;ä» &lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶ä¸­åŠ è½½æ‰€æœ‰å£°æ˜çš„ &lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;å®ç°ç±»ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œ &lt;strong&gt;&lt;code&gt;createBootstrapContext&lt;/code&gt;&lt;/strong&gt; æ–¹æ³•ï¼šåœ¨ &lt;code&gt;run()&lt;/code&gt;æ–¹æ³•ä¸­ï¼Œç´§éšå…¶åçš„æ˜¯åˆ›å»º &lt;code&gt;BootstrapContext&lt;/code&gt;ï¼ˆ&lt;code&gt;BootstrapRegistry&lt;/code&gt;çš„é»˜è®¤å®ç°ï¼‰å¹¶éå†è°ƒç”¨æ‰€æœ‰ &lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;å®ç°ç±»çš„ &lt;code&gt;initialize&lt;/code&gt;æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•ä½¿ç”¨ç¼–ç ä¸é…ç½®å®è·µ"&gt;âš™ï¸ å¦‚ä½•ä½¿ç”¨ï¼šç¼–ç ä¸é…ç½®å®è·µ
&lt;/h3&gt;&lt;h4 id="1-å®ç°æ¥å£"&gt;1. å®ç°æ¥å£
&lt;/h4&gt;&lt;p&gt;ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç±»æ¥å®ç° &lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;æ¥å£ï¼Œå¹¶é‡å†™å…¶ &lt;code&gt;initialize&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç¤ºä¾‹ï¼šæ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰çš„é…ç½®å®¢æˆ·ç«¯
public class MyConfigClientInitializer implements BootstrapRegistryInitializer {
@Override
public void initialize(BootstrapRegistry registry) {
// 1. æ³¨å†Œå¯¹è±¡ï¼ˆä½¿ç”¨å»¶è¿Ÿåˆå§‹åŒ–ä¼˜åŒ–æ€§èƒ½ï¼‰
registry.register(ConfigClient.class, context -&amp;gt; {
// ä»æ—©æœŸç¯å¢ƒä¸­è·å–é…ç½®æœåŠ¡å™¨åœ°å€
String serverUrl = context.get(Environment.class).getProperty(&amp;#34;config.server.url&amp;#34;);
return new ConfigClient(serverUrl); // InstanceSupplier å…è®¸å»¶è¿Ÿåˆ›å»º
});
// 2. æ·»åŠ å…³é—­ç›‘å¬å™¨ï¼Œç”¨äºèµ„æºæ¸…ç†æˆ–å¯¹è±¡è½¬ç§»
registry.addCloseListener(event -&amp;gt; {
// ä»äº‹ä»¶ä¸­è·å–BootstrapContextå’ŒApplicationContext
ConfigClient client = event.getBootstrapContext().get(ConfigClient.class);
// åœ¨BootstrapContextå…³é—­å‰æ‰§è¡Œæ¸…ç†æ“ä½œ
client.shutdown();
// å¯é€‰ï¼šå°†å¯¹è±¡æ³¨å†Œä¸ºSpring Beanï¼Œä»¥ä¾¿åº”ç”¨åç»­ä½¿ç”¨
// event.getApplicationContext().getBeanFactory().registerSingleton(&amp;#34;configClient&amp;#34;, client);
});
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="2-æ³¨å†Œå®ç°ç±»"&gt;2. æ³¨å†Œå®ç°ç±»
&lt;/h4&gt;&lt;p&gt;è®© Spring Boot å‘ç°ä½ çš„å®ç°ç±»ï¼Œä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é€šè¿‡ &lt;code&gt;spring.factories&lt;/code&gt;æ–‡ä»¶ï¼ˆæ¨èï¼‰&lt;/strong&gt;ï¼šåœ¨é¡¹ç›®çš„ &lt;code&gt;src/main/resources/META-INF/&lt;/code&gt;ç›®å½•ä¸‹åˆ›å»º &lt;code&gt;spring.factories&lt;/code&gt;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;org.springframework.boot.BootstrapRegistryInitializer=com.example.MyConfigClientInitializer
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é€šè¿‡ &lt;code&gt;SpringApplication&lt;/code&gt;API&lt;/strong&gt;ï¼šåœ¨å¯åŠ¨ç±»ä¸­ç›´æ¥æ·»åŠ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@SpringBootApplication
public class MyApplication {
public static void main(String[] args) {
SpringApplication app = new SpringApplication(MyApplication.class);
app.addBootstrapRegistryInitializer(new MyConfigClientInitializer());
app.run(args);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å…³é”®æ³¨æ„äº‹é¡¹"&gt;âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;æ—¶ï¼Œè¯·åŠ¡å¿…ç•™æ„ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ä¾èµ–æ³¨å…¥&lt;/strong&gt;ï¼š&lt;code&gt;initialize&lt;/code&gt;æ–¹æ³•æ‰§è¡Œæ—¶ï¼ŒSpring IoC å®¹å™¨å°šæœªåˆ›å»ºï¼Œå› æ­¤ &lt;strong&gt;&lt;code&gt;@Autowired&lt;/code&gt;ã€&lt;code&gt;@Value&lt;/code&gt;ç­‰ä¾èµ–æ³¨å…¥æ³¨è§£åœ¨æ­¤å¤„æ— æ•ˆ&lt;/strong&gt;ã€‚æ‰€æœ‰éœ€è¦çš„å‚æ•°éƒ½åº”é€šè¿‡ &lt;code&gt;BootstrapRegistry&lt;/code&gt;æˆ– &lt;code&gt;BootstrapContext&lt;/code&gt;è·å–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å–„ç”¨å»¶è¿Ÿåˆå§‹åŒ–&lt;/strong&gt;ï¼šå¯¹äºåˆ›å»ºæˆæœ¬è¾ƒé«˜çš„å¯¹è±¡ï¼Œå»ºè®®ä½¿ç”¨ &lt;code&gt;InstanceSupplier&lt;/code&gt;è¿›è¡Œå»¶è¿Ÿåˆå§‹åŒ–ï¼ˆå¦‚ä¸Šé¢ä»£ç ç¤ºä¾‹æ‰€ç¤ºï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥ &lt;code&gt;new&lt;/code&gt;ä¸€ä¸ªå®ä¾‹ï¼Œè¿™æœ‰åŠ©äºæå‡åº”ç”¨å¯åŠ¨é€Ÿåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç†è§£å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæ³¨å†Œåˆ° &lt;code&gt;BootstrapRegistry&lt;/code&gt;çš„å¯¹è±¡åªåœ¨ &lt;strong&gt;ä»å¯åŠ¨å¼€å§‹åˆ° &lt;code&gt;ApplicationContext&lt;/code&gt;å‡†å¤‡å¥½ä¹‹å‰&lt;/strong&gt; è¿™æ®µæ—¶é—´å†…å¯ç”¨ã€‚å¦‚æœéœ€è¦åœ¨å®¹å™¨å®Œå…¨å¯åŠ¨åç»§ç»­ä½¿ç”¨è¿™äº›å¯¹è±¡ï¼Œå¿…é¡»åœ¨ &lt;code&gt;BootstrapContextClosedEvent&lt;/code&gt;ç›‘å¬å™¨ä¸­æ‰‹åŠ¨å°†å…¶æ³¨å†Œä¸ºå•ä¾‹ Beanã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;æ˜¯ Spring Boot æä¾›çš„ä¸€ä¸ªå¼ºå¤§ä¸”ç²¾å‡†çš„æ‰©å±•ç‚¹ï¼Œå®ƒå°†ä¸€äº›å…³é”®åˆå§‹åŒ–ä»»åŠ¡å‰ç½®ï¼Œç¡®ä¿äº†åº”ç”¨çš„ç¨³å¥å¯åŠ¨å’Œæ¨¡å—é—´çš„æ¸…æ™°éš”ç¦»ã€‚ç†è§£å¹¶æ°å½“åœ°ä½¿ç”¨å®ƒï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ è§£å†³ä¸€äº›åœ¨ä¼ ç»Ÿ Spring Bean ç”Ÿå‘½å‘¨æœŸä¸­éš¾ä»¥å¤„ç†çš„å¤æ‚åˆå§‹åŒ–éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œè¿ç”¨ &lt;code&gt;BootstrapRegistryInitializer&lt;/code&gt;ã€‚å¦‚æœä½ å¯¹å…·ä½“çš„å®ç°ç»†èŠ‚æˆ–ä¸å…¶ä»–æ‰©å±•ç‚¹çš„é…åˆæœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="meta-infspringfactories"&gt;META-INF/spring.factories
&lt;/h2&gt;&lt;p&gt;å½“ä½ å‘ Spring Boot é¡¹ç›®å¼•å…¥ä¸€ä¸ª JAR åŒ…æ—¶ï¼Œå…¶ &lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶&lt;strong&gt;ä¸ä¼šåœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨åˆå¹¶&lt;/strong&gt;ã€‚è¿™äº›æ–‡ä»¶çš„å†…å®¹æ˜¯åœ¨&lt;strong&gt;åº”ç”¨å¯åŠ¨æ—¶ï¼ˆè¿è¡Œæ—¶ï¼‰&lt;/strong&gt; ç”± Spring Boot æ¡†æ¶åŠ¨æ€æ‰«æå’Œåˆå¹¶çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿäº†è§£å¤„ç†æ—¶æœºå’Œæ–¹å¼ï¼Œæˆ‘ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æ¦‚æ‹¬ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é˜¶æ®µ&lt;/th&gt;
&lt;th&gt;å¤„ç†æ–¹å¼&lt;/th&gt;
&lt;th&gt;å…³é”®ç‚¹/å·¥å…·&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–è¯‘æ—¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é»˜è®¤ä¸è‡ªåŠ¨åˆå¹¶ã€‚åŒåçš„ &lt;code&gt;spring.factories&lt;/code&gt;æ–‡ä»¶å¯èƒ½ç›¸äº’è¦†ç›–ã€‚&lt;/td&gt;
&lt;td&gt;éœ€è¦ Maven Shade Plugin ç­‰å·¥å…·æ‰‹åŠ¨é…ç½®åˆå¹¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿è¡Œæ—¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Spring Boot è‡ªåŠ¨æ‰«ææ‰€æœ‰ä¾èµ– JAR åŒ…ä¸­çš„ &lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶å¹¶åˆå¹¶ã€‚&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;code&gt;SpringFactoriesLoader&lt;/code&gt;ç±»åŠ è½½å’Œè§£æã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-è¿è¡Œæ—¶åˆå¹¶çš„ç»†èŠ‚"&gt;ğŸ”§ è¿è¡Œæ—¶åˆå¹¶çš„ç»†èŠ‚
&lt;/h3&gt;&lt;p&gt;Spring Boot çš„è‡ªåŠ¨é…ç½®æœºåˆ¶æ ¸å¿ƒä¾èµ–äºè¯»å– &lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶ã€‚åœ¨åº”ç”¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰«ææ‰€æœ‰ JAR&lt;/strong&gt;ï¼šSpring Boot ä¼šæ‰«æç±»è·¯å¾„ä¸‹æ‰€æœ‰ JAR åŒ…ä¸­çš„ &lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆå¹¶å†…å®¹&lt;/strong&gt;ï¼š&lt;code&gt;SpringFactoriesLoader&lt;/code&gt;ä¼šå°†è¿™äº›æ–‡ä»¶ä¸­ç›¸åŒé”®ï¼ˆKeyï¼‰å¯¹åº”çš„å€¼ï¼ˆValueï¼‰åˆå¹¶åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚ä¾‹å¦‚ï¼Œæ‰€æœ‰ JAR ä¸­ &lt;code&gt;EnableAutoConfiguration&lt;/code&gt;é”®å¯¹åº”çš„é…ç½®ç±»éƒ½ä¼šè¢«æ”¶é›†èµ·æ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç†å†²çª&lt;/strong&gt;ï¼šå¦‚æœå¤šä¸ªé…ç½®ç±»å®šä¹‰äº†ç›¸åŒçš„ Beanï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;@ConditionalOnMissingBean&lt;/code&gt;ç­‰æ¡ä»¶æ³¨è§£æ¥é¿å…å†²çªï¼Œç¡®ä¿åªæœ‰ä¸€ä»½ç”Ÿæ•ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ç¼–è¯‘æ—¶éœ€æ³¨æ„çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"&gt;âš ï¸ ç¼–è¯‘æ—¶éœ€æ³¨æ„çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ
&lt;/h3&gt;&lt;p&gt;è™½ç„¶åœ¨è¿è¡Œæ—¶ Spring Boot ä¼šå¤„ç†åˆå¹¶ï¼Œä½†åœ¨&lt;strong&gt;æ‰“åŒ…é˜¶æ®µ&lt;/strong&gt;ï¼ˆç¼–è¯‘æ—¶ï¼‰ï¼Œå¦‚æœä½ éœ€è¦å°†å¤šä¸ªæ¨¡å—æˆ–ä¾èµ–æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ &amp;ldquo;uber-jar&amp;rdquo;ï¼ˆæ¯”å¦‚ä½¿ç”¨ &lt;code&gt;maven-assembly-plugin&lt;/code&gt;æˆ– &lt;code&gt;maven-shade-plugin&lt;/code&gt;ï¼‰ï¼Œå°±å¯èƒ½å‡ºç°åŒå &lt;code&gt;spring.factories&lt;/code&gt;æ–‡ä»¶ç›¸äº’è¦†ç›–çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;strong&gt;&lt;code&gt;maven-shade-plugin&lt;/code&gt;&lt;/strong&gt; æ’ä»¶ï¼Œå¹¶é…ç½® &lt;code&gt;AppendingTransformer&lt;/code&gt;æ¥æŒ‡å®šéœ€è¦åˆå¹¶çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;build&amp;gt;
&amp;lt;plugins&amp;gt;
&amp;lt;plugin&amp;gt;
&amp;lt;groupId&amp;gt;org.apache.maven.plugins&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;maven-shade-plugin&amp;lt;/artifactId&amp;gt;
&amp;lt;version&amp;gt;3.5.0&amp;lt;/version&amp;gt; &amp;lt;!-- è¯·ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ --&amp;gt;
&amp;lt;executions&amp;gt;
&amp;lt;execution&amp;gt;
&amp;lt;phase&amp;gt;package&amp;lt;/phase&amp;gt;
&amp;lt;goals&amp;gt;
&amp;lt;goal&amp;gt;shade&amp;lt;/goal&amp;gt;
&amp;lt;/goals&amp;gt;
&amp;lt;configuration&amp;gt;
&amp;lt;transformers&amp;gt;
&amp;lt;!-- å¤„ç† META-INF/spring.factories æ–‡ä»¶çš„åˆå¹¶ --&amp;gt;
&amp;lt;transformer implementation=&amp;#34;org.apache.maven.plugins.shade.resource.AppendingTransformer&amp;#34;&amp;gt;
&amp;lt;resource&amp;gt;META-INF/spring.factories&amp;lt;/resource&amp;gt;
&amp;lt;/transformer&amp;gt;
&amp;lt;!-- å¦‚æœéœ€è¦ï¼Œè¿˜å¯ä»¥å¤„ç†å…¶ä»–Springé…ç½®æ–‡ä»¶ --&amp;gt;
&amp;lt;transformer implementation=&amp;#34;org.apache.maven.plugins.shade.resource.AppendingTransformer&amp;#34;&amp;gt;
&amp;lt;resource&amp;gt;META-INF/spring.handlers&amp;lt;/resource&amp;gt;
&amp;lt;/transformer&amp;gt;
&amp;lt;transformer implementation=&amp;#34;org.apache.maven.plugins.shade.resource.AppendingTransformer&amp;#34;&amp;gt;
&amp;lt;resource&amp;gt;META-INF/spring.schemas&amp;lt;/resource&amp;gt;
&amp;lt;/transformer&amp;gt;
&amp;lt;/transformers&amp;gt;
&amp;lt;/configuration&amp;gt;
&amp;lt;/execution&amp;gt;
&amp;lt;/executions&amp;gt;
&amp;lt;/plugin&amp;gt;
&amp;lt;/plugins&amp;gt;
&amp;lt;/build&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-æœ€ä½³å®è·µå»ºè®®"&gt;ğŸ’¡ æœ€ä½³å®è·µå»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å… Key å†²çª&lt;/strong&gt;ï¼šåœ¨è‡ªå®šä¹‰ Starter æ—¶ï¼Œå°½é‡ç¡®ä¿è‡ªåŠ¨é…ç½®ç±»çš„ Bean å®šä¹‰ä½¿ç”¨ &lt;code&gt;@ConditionalOnMissingBean&lt;/code&gt;æ³¨è§£ï¼Œè¿™æ ·å³ä½¿å¤šä¸ªé…ç½®ç±»è¢«åŠ è½½ï¼Œä¹Ÿèƒ½é¿å… Bean é‡å¤å®šä¹‰çš„å†²çªã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡å—åŒ–è®¾è®¡&lt;/strong&gt;ï¼šéµå¾ª Spring Boot å®˜æ–¹å»ºè®®ï¼Œå°† Starter çš„æ ¸å¿ƒä¾èµ–ä¸è‡ªåŠ¨é…ç½®æ¨¡å—ï¼ˆautoconfigureï¼‰åˆ†ç¦»ï¼Œè¿™æ ·å¯ä»¥æ›´çµæ´»åœ°ç®¡ç†ä¾èµ–å’Œé…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº†è§£æ–°ç‰¹æ€§&lt;/strong&gt;ï¼šä» Spring Boot 2.7 å¼€å§‹ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ &lt;code&gt;META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports&lt;/code&gt;æ–‡ä»¶æ¥æ›¿ä»£ &lt;code&gt;spring.factories&lt;/code&gt;ä¸­è‡ªåŠ¨é…ç½®çš„æ³¨å†Œæ–¹å¼ï¼Œè¿™ç§æ–¹å¼èƒ½æ›´æ¸…æ™°åœ°ç®¡ç†è‡ªåŠ¨é…ç½®ç±»ä¸”é¿å…ä¸€äº›åˆå¹¶é—®é¢˜ã€‚ä½†è¯·æ³¨æ„ï¼ŒåŸæœ‰çš„ &lt;code&gt;spring.factories&lt;/code&gt;æ–¹å¼ä»ç„¶æ”¯æŒã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œä½ ä¸éœ€è¦åœ¨ç¼–è¯‘æ—¶æ‹…å¿ƒ &lt;code&gt;META-INF/spring.factories&lt;/code&gt;çš„åˆå¹¶é—®é¢˜ï¼ŒSpring Boot åœ¨åº”ç”¨å¯åŠ¨æ—¶ä¼šå¦¥å–„å¤„ç†ã€‚åªæœ‰åœ¨éœ€è¦åˆ¶ä½œä¸€ä¸ªå¤§è€Œå…¨çš„ &amp;ldquo;uber-jar&amp;rdquo; æ—¶ï¼Œæ‰éœ€é€šè¿‡ &lt;code&gt;maven-shade-plugin&lt;/code&gt;ç­‰å·¥å…·åœ¨æ‰“åŒ…é˜¶æ®µæ‰‹åŠ¨é…ç½®åˆå¹¶ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œå¤„ç† Spring Boot ä¸­çš„é…ç½®åˆå¹¶é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id="applicationcontextinitializer"&gt;ApplicationContextInitializer
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ApplicationContextInitializer&lt;/code&gt;æ˜¯ Spring Boot æä¾›çš„ä¸€ä¸ªå…³é”®æ‰©å±•ç‚¹ï¼Œå…è®¸ä½ åœ¨ Spring åº”ç”¨ä¸Šä¸‹æ–‡ï¼ˆ&lt;code&gt;ApplicationContext&lt;/code&gt;ï¼‰æ­£å¼åˆ·æ–°ä¹‹å‰ï¼Œæ‰§è¡Œè‡ªå®šä¹‰çš„åˆå§‹åŒ–é€»è¾‘ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå¸®åŠ©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤è¯†ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒè¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ Spring åº”ç”¨ä¸Šä¸‹æ–‡åˆ·æ–°å‰ï¼Œå¯¹å…¶è¿›è¡Œç¼–ç¨‹æ–¹å¼çš„åˆå§‹åŒ–å’Œå®šåˆ¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œæ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ApplicationContext&lt;/code&gt;åˆ›å»ºä¹‹åã€&lt;code&gt;refresh()&lt;/code&gt;æ–¹æ³•è°ƒç”¨ä¹‹å‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é…ç½®ç¯å¢ƒå±æ€§ã€æ³¨å†Œ Bean å®šä¹‰ã€æ·»åŠ åç½®å¤„ç†å™¨ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é…ç½®æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;code&gt;spring.factories&lt;/code&gt;æ–‡ä»¶ã€&lt;code&gt;application.properties&lt;/code&gt;æˆ–ç¼–ç¨‹æ–¹å¼æ·»åŠ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒä½œç”¨ä¸é€‚ç”¨åœºæ™¯"&gt;ğŸ’¡ æ ¸å¿ƒä½œç”¨ä¸é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ApplicationContextInitializer&lt;/code&gt;çš„æ ¸å¿ƒä»·å€¼åœ¨äºå…¶ &lt;strong&gt;ç²¾å‡†çš„æ‰§è¡Œæ—¶æœº&lt;/strong&gt;ã€‚å®ƒè®©ä½ èƒ½å¤Ÿåœ¨ Spring å®¹å™¨åŠ è½½ Bean å®šä¹‰ã€åˆ›å»º Bean å®ä¾‹ä¹‹å‰ï¼Œå°±å¯¹å®¹å™¨æœ¬èº«è¿›è¡Œé…ç½® ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒçš„å…¸å‹åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ç¯å¢ƒé…ç½®&lt;/strong&gt;ï¼šæ ¹æ®è¿è¡Œç¯å¢ƒï¼ˆå¦‚å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰åŠ¨æ€è®¾ç½®æˆ–è¦†ç›–ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—©æœŸ Bean æ³¨å†Œ&lt;/strong&gt;ï¼šåœ¨å®¹å™¨åˆ·æ–°å‰ï¼Œé€šè¿‡ &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;åŠ¨æ€æ³¨å†Œè‡ªå®šä¹‰çš„ Bean å®šä¹‰ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨å†Œåç½®å¤„ç†å™¨&lt;/strong&gt;ï¼šæå‰æ³¨å†Œè‡ªå®šä¹‰çš„ &lt;code&gt;BeanFactoryPostProcessor&lt;/code&gt;æˆ– &lt;code&gt;BeanPostProcessor&lt;/code&gt;ï¼Œä»¥å½±å“åç»­çš„ Bean åˆ›å»ºè¿‡ç¨‹ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ä»¶æ£€æŸ¥å’ŒåŸºç¡€è®¾æ–½åˆå§‹åŒ–&lt;/strong&gt;ï¼šåœ¨å®¹å™¨å¯åŠ¨å‰è¿›è¡Œå¿…è¦çš„ç³»ç»Ÿèµ„æºæ£€æŸ¥ï¼Œæˆ–åˆå§‹åŒ–ä¸€äº›åŸºç¡€ç»„ä»¶ï¼Œå¦‚æ—¥å¿—æ¡†æ¶ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¦‚ä½•ä½¿ç”¨å®ç°ä¸æ³¨å†Œ"&gt;âš™ï¸ å¦‚ä½•ä½¿ç”¨ï¼šå®ç°ä¸æ³¨å†Œ
&lt;/h3&gt;&lt;h4 id="1-å®ç°æ¥å£-1"&gt;1. å®ç°æ¥å£
&lt;/h4&gt;&lt;p&gt;åˆ›å»ºä¸€ä¸ªç±»å®ç° &lt;code&gt;ApplicationContextInitializer&amp;lt;ConfigurableApplicationContext&amp;gt;&lt;/code&gt;æ¥å£ï¼Œå¹¶é‡å†™ &lt;code&gt;initialize&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import org.springframework.context.ApplicationContextInitializer;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.MapPropertySource;
import java.util.HashMap;
import java.util.Map;
public class CustomApplicationContextInitializer implements ApplicationContextInitializer&amp;lt;ConfigurableApplicationContext&amp;gt; {
@Override
public void initialize(ConfigurableApplicationContext applicationContext) {
// è·å–ç¯å¢ƒé…ç½®
ConfigurableEnvironment environment = applicationContext.getEnvironment();
// å‡†å¤‡è‡ªå®šä¹‰é…ç½®
Map&amp;lt;String, Object&amp;gt; customProperties = new HashMap&amp;lt;&amp;gt;();
customProperties.put(&amp;#34;server.port&amp;#34;, &amp;#34;8081&amp;#34;);
customProperties.put(&amp;#34;app.custom.setting&amp;#34;, &amp;#34;initialized&amp;#34;);
// å°†è‡ªå®šä¹‰é…ç½®æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œå¹¶è®¾ç½®ä¼˜å…ˆçº§
MapPropertySource propertySource = new MapPropertySource(&amp;#34;customInitializer&amp;#34;, customProperties);
environment.getPropertySources().addFirst(propertySource);
System.out.println(&amp;#34;CustomApplicationContextInitializer has been executed.&amp;#34;);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="2-æ³¨å†Œå®ç°ç±»-1"&gt;2. æ³¨å†Œå®ç°ç±»
&lt;/h4&gt;&lt;p&gt;è®© Spring Boot è¯†åˆ«åˆ°ä½ çš„ &lt;code&gt;ApplicationContextInitializer&lt;/code&gt;æœ‰ä¸‰ç§ä¸»è¦æ–¹å¼ï¼Œå®ƒä»¬çš„&lt;strong&gt;åŠ è½½ä¼˜å…ˆçº§&lt;/strong&gt;ä»é«˜åˆ°ä½å¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é…ç½®æ–‡ä»¶æ³¨å†Œï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;code&gt;application.properties&lt;/code&gt;æˆ– &lt;code&gt;application.yml&lt;/code&gt;ä¸­é…ç½®ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# application.properties
context.initializer.classes=com.yourpackage.CustomApplicationContextInitializer
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;# application.yml
context:
initializer:
classes: com.yourpackage.CustomApplicationContextInitializer
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Spring Factories æœºåˆ¶æ³¨å†Œ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨é¡¹ç›®çš„ &lt;code&gt;src/main/resources/META-INF/&lt;/code&gt;ç›®å½•ä¸‹åˆ›å»º &lt;code&gt;spring.factories&lt;/code&gt;æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;org.springframework.context.ApplicationContextInitializer=com.yourpackage.CustomApplicationContextInitializer
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¼–ç¨‹æ–¹å¼æ³¨å†Œï¼ˆä¼˜å…ˆçº§æœ€ä½ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å¯åŠ¨ç±»çš„ &lt;code&gt;main&lt;/code&gt;æ–¹æ³•ä¸­ï¼Œé€šè¿‡ &lt;code&gt;SpringApplication&lt;/code&gt;å®ä¾‹æ·»åŠ ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@SpringBootApplication
public class MyApplication {
public static void main(String[] args) {
SpringApplication application = new SpringApplication(MyApplication.class);
application.addInitializers(new CustomApplicationContextInitializer());
application.run(args);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="3-æ§åˆ¶æ‰§è¡Œé¡ºåº"&gt;3. æ§åˆ¶æ‰§è¡Œé¡ºåº
&lt;/h4&gt;&lt;p&gt;å¦‚æœå®šä¹‰äº†å¤šä¸ª &lt;code&gt;ApplicationContextInitializer&lt;/code&gt;ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;@Order&lt;/code&gt;æ³¨è§£æˆ–å®ç° &lt;code&gt;Ordered&lt;/code&gt;æ¥å£æ¥æ§åˆ¶å®ƒä»¬çš„æ‰§è¡Œé¡ºåºã€‚&lt;strong&gt;æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Order(1) // æ­¤åˆå§‹åŒ–å™¨å°†ä¼˜å…ˆæ‰§è¡Œ
public class FirstInitializer implements ApplicationContextInitializer&amp;lt;ConfigurableApplicationContext&amp;gt; {
// ... initialize æ–¹æ³•å®ç°
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;code&gt;@Order&lt;/code&gt;æ³¨è§£å¯¹é€šè¿‡ &lt;code&gt;context.initializer.classes&lt;/code&gt;é…ç½®çš„åˆå§‹åŒ–å™¨ä¸ç”Ÿæ•ˆï¼Œè¿™ç±»åˆå§‹åŒ–å™¨æ€»æ˜¯æœ€å…ˆæ‰§è¡Œ ã€‚&lt;/p&gt;
&lt;h3 id="-æ‰§è¡Œæ—¶æœºä¸æºç ç®€æ"&gt;ğŸ” æ‰§è¡Œæ—¶æœºä¸æºç ç®€æ
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ApplicationContextInitializer&lt;/code&gt;çš„è°ƒç”¨å‘ç”Ÿåœ¨ Spring Boot å¯åŠ¨æµç¨‹çš„ &lt;code&gt;run()&lt;/code&gt;æ–¹æ³•ä¸­ï¼Œå…·ä½“æ˜¯åœ¨ &lt;code&gt;prepareContext&lt;/code&gt;é˜¶æ®µ ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ ¸å¿ƒé€»è¾‘å¯ä»¥ç®€åŒ–ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ è½½&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;SpringApplication&lt;/code&gt;æ„é€ æ—¶ï¼Œé€šè¿‡ &lt;code&gt;SpringFactoriesLoader&lt;/code&gt;ä» &lt;code&gt;META-INF/spring.factories&lt;/code&gt;ç­‰ä½ç½®åŠ è½½æ‰€æœ‰å®ç°ç±»çš„å®ä¾‹ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’åº&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;AnnotationAwareOrderComparator&lt;/code&gt;å¯¹æ”¶é›†åˆ°çš„åˆå§‹åŒ–å™¨è¿›è¡Œæ’åº ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œ&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;prepareContext&lt;/code&gt;æ–¹æ³•ä¸­ï¼Œè°ƒç”¨ &lt;code&gt;applyInitializers(context)&lt;/code&gt;æ–¹æ³•ï¼Œéå†å¹¶æ‰§è¡Œæ‰€æœ‰åˆå§‹åŒ–å™¨çš„ &lt;code&gt;initialize&lt;/code&gt;æ–¹æ³• ã€‚æ­¤æ—¶ï¼Œ&lt;code&gt;ApplicationContext&lt;/code&gt;å·²åˆ›å»ºä½†æœªåˆ·æ–°ï¼ˆ&lt;code&gt;refresh&lt;/code&gt;ï¼‰ï¼Œæ˜¯è¿›è¡Œè‡ªå®šä¹‰æ“ä½œçš„ç†æƒ³æ—¶æœº ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹"&gt;âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…è€—æ—¶æ“ä½œ&lt;/strong&gt;ï¼šåœ¨æ­¤é˜¶æ®µåº”é¿å…æ‰§è¡Œå¤æ‚çš„æˆ–è€—æ—¶çš„æ“ä½œï¼Œå› ä¸ºè¿™ä¼šå½±å“åº”ç”¨çš„å¯åŠ¨é€Ÿåº¦ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°¨æ…è¿›è¡Œ Bean æ“ä½œ&lt;/strong&gt;ï¼šæ­¤æ—¶ Spring å®¹å™¨å°šæœªåˆ·æ–°ï¼Œæ— æ³•ç›´æ¥è·å–æˆ–æ“ä½œ Beanã€‚å¦‚éœ€æ³¨å†Œ Beanï¼Œåº”é€šè¿‡ &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;è¿›è¡Œ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç†è§£ç¯å¢ƒå°±ç»ªç¨‹åº¦&lt;/strong&gt;ï¼šè™½ç„¶å¯ä»¥è®¿é—® &lt;code&gt;Environment&lt;/code&gt;ï¼Œä½†è¦æ„è¯†åˆ°æŸäº›å±æ€§å¯èƒ½è¿˜æœªå®Œå…¨åŠ è½½æˆ–è§£æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ApplicationContextInitializer&lt;/code&gt;æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ Spring Boot æ‰©å±•ç‚¹ï¼Œå®ƒé€šè¿‡åœ¨åº”ç”¨ä¸Šä¸‹æ–‡ç”Ÿå‘½å‘¨æœŸçš„ç²¾ç¡®æ—¶åˆ»ä»‹å…¥ï¼Œä¸ºä½ æä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚æ— è®ºæ˜¯è¿›è¡Œç¯å¢ƒå®šåˆ¶ã€æ—©æœŸé…ç½®è¿˜æ˜¯æ¡ä»¶æ£€æŸ¥ï¼Œç†è§£å’Œæ­£ç¡®ä½¿ç”¨å®ƒéƒ½èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°æ§åˆ¶ Spring Boot åº”ç”¨çš„å¯åŠ¨è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£å’Œæœ‰æ•ˆè¿ç”¨ &lt;code&gt;ApplicationContextInitializer&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id="configurableapplicationcontext"&gt;ConfigurableApplicationContext
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;å’Œ &lt;code&gt;ApplicationContext&lt;/code&gt;æ˜¯ Spring æ¡†æ¶ä¸­å…³ç³»ç´§å¯†çš„ä¸¤ä¸ªæ ¸å¿ƒæ¥å£ã€‚ç®€å•æ¥è¯´ï¼Œ&lt;strong&gt;&lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;æ˜¯ &lt;code&gt;ApplicationContext&lt;/code&gt;çš„æ‰©å±•&lt;/strong&gt;ï¼Œå®ƒæä¾›äº†é…ç½®å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†çš„èƒ½åŠ›ï¼Œè€Œ &lt;code&gt;ApplicationContext&lt;/code&gt;ä¸»è¦å®šä¹‰äº†ä½œä¸ºä¸€ä¸ªé«˜çº§å®¹å™¨å¯¹å¤–æä¾›çš„åŸºæœ¬åªè¯»æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡å…¨å±€ï¼Œä¸‹è¡¨æ¸…æ™°åœ°å±•ç¤ºäº†å®ƒä»¬ä¹‹é—´çš„æ ¸å¿ƒåŒºåˆ«ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;ApplicationContext&lt;/th&gt;
&lt;th&gt;ConfigurableApplicationContext&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¥å£å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¡¶çº§æ¥å£ï¼Œå®šä¹‰äº†å®¹å™¨çš„åŸºç¡€åªè¯»æ“ä½œã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿è‡ª &lt;code&gt;ApplicationContext&lt;/code&gt;&lt;/strong&gt;ï¼Œæ˜¯å…¶å­æ¥å£ï¼Œå¢åŠ äº†é…ç½®å’Œç®¡ç†æ–¹æ³•ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒèƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾›&lt;strong&gt;åªè¯»&lt;/strong&gt;è®¿é—®ï¼Œå¦‚è·å–Beanã€å›½é™…åŒ–æ¶ˆæ¯ã€äº‹ä»¶å‘å¸ƒã€èµ„æºåŠ è½½ç­‰ã€‚&lt;/td&gt;
&lt;td&gt;æä¾›&lt;strong&gt;å¯é…ç½®&lt;/strong&gt;å’Œ&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/strong&gt;èƒ½åŠ›ï¼Œå¦‚è®¾ç½®ç¯å¢ƒã€åˆ·æ–°å®¹å™¨ã€å…³é—­å®¹å™¨ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®çš„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½œä¸ºåº”ç”¨ç¨‹åºä¸Springå®¹å™¨äº¤äº’çš„&lt;strong&gt;ç¨³å®šå®¢æˆ·ç«¯è§†å›¾&lt;/strong&gt;ï¼Œç¡®ä¿æ“ä½œçš„å®‰å…¨æ€§ã€‚&lt;/td&gt;
&lt;td&gt;ä¸»è¦ä¸ºSpringæ¡†æ¶å†…éƒ¨æˆ–éœ€è¦æ·±åº¦å®šåˆ¶çš„åœºæ™¯æä¾›&lt;strong&gt;é…ç½®å’Œç®¡ç†çš„å…¥å£&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;getBean()&lt;/code&gt;, &lt;code&gt;getMessage()&lt;/code&gt;, &lt;code&gt;publishEvent()&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;refresh()&lt;/code&gt;, &lt;code&gt;close()&lt;/code&gt;, &lt;code&gt;addBeanFactoryPostProcessor()&lt;/code&gt;, &lt;code&gt;setEnvironment()&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ç›´æ¥æä¾›ç”Ÿå‘½å‘¨æœŸçš„å¯åŠ¨/åœæ­¢æ§åˆ¶ã€‚&lt;/td&gt;
&lt;td&gt;ç»§æ‰¿äº† &lt;code&gt;Lifecycle&lt;/code&gt;æ¥å£ï¼Œå¯ä»¥æ˜¾å¼åœ°&lt;strong&gt;å¯åŠ¨&lt;/strong&gt;ã€&lt;strong&gt;åˆ·æ–°&lt;/strong&gt;å’Œ&lt;strong&gt;å…³é—­&lt;/strong&gt;åº”ç”¨ä¸Šä¸‹æ–‡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ·±å…¥ç†è§£è§’è‰²ä¸è®¾è®¡"&gt;ğŸ’¡ æ·±å…¥ç†è§£è§’è‰²ä¸è®¾è®¡
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;ApplicationContext&lt;/code&gt;ï¼šç¨³å®šçš„â€œæœåŠ¡çª—å£â€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥æŠŠ &lt;code&gt;ApplicationContext&lt;/code&gt;æƒ³è±¡æˆä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„æœåŠ¡çª—å£ã€‚åº”ç”¨ç¨‹åºé€šè¿‡å®ƒæ¥è·å–Beanã€è¯»å–å›½é™…åŒ–æ¶ˆæ¯ã€å‘å¸ƒåº”ç”¨äº‹ä»¶æˆ–åŠ è½½èµ„æºã€‚å®ƒæ‰¿è¯ºæä¾›è¿™äº›æœåŠ¡ï¼Œä½†éšè—äº†å†…éƒ¨å¦‚ä½•å®ç°å’Œé…ç½®çš„ç»†èŠ‚ã€‚è¿™ç§â€œåªè¯»â€ç‰¹æ€§ä½¿å¾—å®ƒæˆä¸ºåº”ç”¨ç¨‹åºä»£ç ä¸Springå®¹å™¨äº¤äº’çš„ç†æƒ³æ¥å£ï¼Œå› ä¸ºå®ƒå®‰å…¨ã€ç¨³å®šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;ï¼šå†…éƒ¨çš„â€œæ§åˆ¶ä¸­å¿ƒâ€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è€Œ &lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;åˆ™åƒæ˜¯åå°çš„æ§åˆ¶ä¸­å¿ƒã€‚å®ƒç»§æ‰¿äº†é‚£ä¸ªâ€œæœåŠ¡çª—å£â€çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä½†æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæä¾›äº†å„ç§â€œæŒ‰é’®â€å’Œâ€œå¼€å…³â€æ¥é…ç½®å’Œæ“çºµå®¹å™¨æœ¬èº«ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è®¾ç½®å…¶çˆ¶ä¸Šä¸‹æ–‡ã€æ·»åŠ åç½®å¤„ç†å™¨ã€è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæˆ–è€…ç›´æ¥å‘½ä»¤å®¹å™¨åˆ·æ–°ï¼ˆé‡æ–°åŠ è½½é…ç½®ï¼‰æˆ–å…³é—­ã€‚è¿™ä¸ªæ¥å£çš„è®¾è®¡ä¸»è¦æ˜¯ä¸ºäº†æ¡†æ¶å†…éƒ¨ä½¿ç”¨ï¼Œæˆ–è€…åœ¨åº”ç”¨å¯åŠ¨æ—¶éœ€è¦é«˜åº¦å®šåˆ¶åŒ–å®¹å™¨çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;Spring æ¡†æ¶é‡‡ç”¨è¿™ç§å°†â€œè¯»â€å’Œâ€œå†™â€èŒè´£åˆ†ç¦»åˆ°ä¸¤ä¸ªæ¥å£çš„è®¾è®¡ï¼Œæå¤§åœ°æé«˜äº†ä»£ç çš„æ¸…æ™°åº¦å’Œçµæ´»æ€§ï¼Œæ˜¯ä¸€ç§éå¸¸ä¼˜ç§€çš„è®¾è®¡æ¨¡å¼å®è·µã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¦‚ä½•ä½¿ç”¨-configurableapplicationcontext"&gt;ğŸ”§ å¦‚ä½•ä½¿ç”¨ ConfigurableApplicationContext
&lt;/h3&gt;&lt;p&gt;åœ¨å…¸å‹çš„Spring Bootåº”ç”¨ä¸­ï¼Œä½ é€šå¸¸ä¸ä¼šç›´æ¥å®ä¾‹åŒ– &lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;ï¼Œä½†ä½ çš„ç¡®åœ¨ä½¿ç”¨å®ƒã€‚&lt;code&gt;SpringApplication.run()&lt;/code&gt;æ–¹æ³•è¿”å›çš„å°±æ˜¯ä¸€ä¸ª &lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;å®ä¾‹ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@SpringBootApplication
public class MyApplication {
public static void main(String[] args) {
// è¿”å›çš„å®é™…æ˜¯ ConfigurableApplicationContext ç±»å‹
ConfigurableApplicationContext context = SpringApplication.run(MyApplication.class, args);
// ä¾‹å¦‚ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦æ³¨å†Œæ–°çš„å•ä¾‹Bean
// context.getBeanFactory().registerSingleton(&amp;#34;myNewBean&amp;#34;, new MyNewBean());
// åº”ç”¨ç»“æŸæ—¶ï¼Œå¯ä»¥è°ƒç”¨closeæ–¹æ³•ï¼Œä¸è¿‡Spring Booté€šå¸¸ä¼šè‡ªåŠ¨å¤„ç†
// context.close();
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;code&gt;ApplicationContext&lt;/code&gt;æ˜¯é¢å‘åº”ç”¨çš„&lt;strong&gt;ä½¿ç”¨æ¥å£&lt;/strong&gt;ï¼Œè€Œ &lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;æ˜¯é¢å‘æ¡†æ¶çš„&lt;strong&gt;é…ç½®å’Œç®¡ç†æ¥å£&lt;/strong&gt;ã€‚åè€…åœ¨å‰è€…çš„åŸºç¡€ä¸Šï¼Œèµ‹äºˆäº†å®¹å™¨åŠ¨æ€é…ç½®å’Œå®Œæ•´ç”Ÿå‘½å‘¨æœŸæ§åˆ¶çš„èƒ½åŠ›ï¼Œæ˜¯Spring IOCå®¹å™¨æ›´åŠ å¼ºå¤§å’Œçµæ´»çš„ä¸€é¢ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°ç†è§£ä¸¤è€…çš„åŒºåˆ«å’Œè”ç³»ï¼&lt;/p&gt;
&lt;h2 id="application-listener"&gt;Application Listener
&lt;/h2&gt;&lt;p&gt;ApplicationListener æ˜¯ Spring æ¡†æ¶&lt;strong&gt;äº‹ä»¶é©±åŠ¨ç¼–ç¨‹æ¨¡å‹&lt;/strong&gt;çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒå®ç°äº†ç»å…¸çš„&lt;strong&gt;è§‚å¯Ÿè€…æ¨¡å¼&lt;/strong&gt;ï¼Œå…è®¸ä½ çš„åº”ç”¨ç»„ä»¶å¯¹ Spring å®¹å™¨ä¸­å‘ç”Ÿçš„ç‰¹å®šäº‹ä»¶åšå‡ºååº”ï¼Œä»è€Œå®ç°ä¸šåŠ¡è§£è€¦ã€æé«˜å¯æ‰©å±•æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹è¡¨æ¦‚æ‹¬äº†å…¶æ ¸å¿ƒä¿¡æ¯ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒè¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒè§’è‰²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›‘å¬å™¨ (&lt;code&gt;ApplicationListener&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›‘å¬ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;äº‹ä»¶ (&lt;code&gt;ApplicationEvent&lt;/code&gt;åŠå…¶å­ç±»)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®ç° &lt;code&gt;onApplicationEvent(E event)&lt;/code&gt;æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®ç‰¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»å‹å®‰å…¨ (é€šè¿‡æ³›å‹æŒ‡å®šäº‹ä»¶ç±»å‹)ã€å¼‚æ­¥æ”¯æŒã€æ‰§è¡Œé¡ºåºæ§åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®ç°ç»„ä»¶é—´çš„æ¾è€¦åˆé€šä¿¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸ä»·å€¼"&gt;ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µä¸ä»·å€¼
&lt;/h3&gt;&lt;p&gt;Spring çš„äº‹ä»¶æœºåˆ¶ç”±ä¸‰ä¸ªæ ¸å¿ƒéƒ¨åˆ†æ„æˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‹ä»¶ (&lt;code&gt;ApplicationEvent&lt;/code&gt;)&lt;/strong&gt;ï¼šä¼ é€’æ¶ˆæ¯çš„è½½ä½“ï¼Œæ‰€æœ‰äº‹ä»¶çš„æ ¹ç±»ã€‚å¯ä»¥æ˜¯ Spring å†…ç½®çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½ çš„è‡ªå®šä¹‰ä¸šåŠ¡äº‹ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘å¬å™¨ (&lt;code&gt;ApplicationListener&lt;/code&gt;)&lt;/strong&gt;ï¼šè´Ÿè´£æ¥æ”¶å¹¶å¤„ç†äº‹ä»¶çš„æ ¸å¿ƒæ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹ä»¶å‘å¸ƒè€… (&lt;code&gt;ApplicationEventPublisher&lt;/code&gt;)&lt;/strong&gt;ï¼šç”¨äºå‘å¸ƒäº‹ä»¶çš„æ¥å£ï¼ŒSpring çš„ &lt;code&gt;ApplicationContext&lt;/code&gt;æœ¬èº«å°±å®ç°äº†æ­¤æ¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ç§è®¾è®¡çš„ä¸»è¦ä»·å€¼åœ¨äº&lt;strong&gt;è§£è€¦&lt;/strong&gt;ã€‚äº‹ä»¶å‘å¸ƒè€…æ— éœ€çŸ¥é“æœ‰å“ªäº›ç›‘å¬å™¨å­˜åœ¨ï¼Œåªéœ€å‘å¸ƒäº‹ä»¶ï¼›ç›‘å¬å™¨ä¹Ÿåªå…³å¿ƒè‡ªå·±æ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚è¿™ä½¿å¾—æ·»åŠ æ–°çš„ä¸šåŠ¡å¤„ç†é€»è¾‘å˜å¾—éå¸¸ç®€å•ï¼Œåªéœ€å¢åŠ æ–°çš„ç›‘å¬å™¨å³å¯ï¼Œæ— éœ€ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œæå¤§åœ°æå‡äº†ä»£ç çš„å†…èšæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚&lt;/p&gt;
&lt;h3 id="-å¦‚ä½•å®ç°ä¸€ä¸ªç›‘å¬å™¨"&gt;ğŸ› ï¸ å¦‚ä½•å®ç°ä¸€ä¸ªç›‘å¬å™¨
&lt;/h3&gt;&lt;p&gt;ä½ æœ‰ä¸¤ç§ä¸»è¦æ–¹å¼æ¥åˆ›å»ºäº‹ä»¶ç›‘å¬å™¨ï¼Œç°ä»£ Springï¼ˆ4.2+ï¼‰æ›´æ¨èä½¿ç”¨æ³¨è§£æ–¹å¼ã€‚&lt;/p&gt;
&lt;h4 id="æ–¹å¼ä¸€å®ç°-applicationlisteneræ¥å£ç»å…¸æ–¹å¼"&gt;æ–¹å¼ä¸€ï¼šå®ç° &lt;code&gt;ApplicationListener&lt;/code&gt;æ¥å£ï¼ˆç»å…¸æ–¹å¼ï¼‰
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯ä¸€ç§ç›´æ¥çš„æ–¹å¼ï¼Œéœ€è¦å®ç°æ¥å£å¹¶æŒ‡å®šæ³›å‹äº‹ä»¶ç±»å‹ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import org.springframework.context.ApplicationListener;
import org.springframework.context.event.ContextRefreshedEvent;
import org.springframework.stereotype.Component;
@Component
public class ContextRefreshListener implements ApplicationListener&amp;lt;ContextRefreshedEvent&amp;gt; {
@Override
public void onApplicationEvent(ContextRefreshedEvent event) {
// å®¹å™¨åˆ·æ–°å®Œæˆåæ‰§è¡Œåˆå§‹åŒ–é€»è¾‘
System.out.println(&amp;#34;å®¹å™¨åˆ·æ–°å®Œæˆï¼ŒåŠ è½½çš„Beanæ•°é‡: &amp;#34; + event.getApplicationContext().getBeanDefinitionCount());
initCache();
preloadData();
}
// ... å…¶ä»–è‡ªå®šä¹‰æ–¹æ³•
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ–¹å¼äºŒä½¿ç”¨-eventlisteneræ³¨è§£æ¨èæ–¹å¼"&gt;æ–¹å¼äºŒï¼šä½¿ç”¨ &lt;code&gt;@EventListener&lt;/code&gt;æ³¨è§£ï¼ˆæ¨èæ–¹å¼ï¼‰
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯æ›´ç®€æ´ã€çµæ´»çš„æ–¹å¼ã€‚ä½ å¯ä»¥åœ¨ä»»ä½• Spring ç®¡ç†çš„ Bean çš„æ–¹æ³•ä¸Šä½¿ç”¨æ­¤æ³¨è§£ï¼Œæ–¹æ³•å‚æ•°å®šä¹‰äº†è¦ç›‘å¬çš„äº‹ä»¶ç±»å‹ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import org.springframework.context.event.EventListener;
import org.springframework.scheduling.annotation.Async;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;
@Component
public class AnnotationBasedListeners {
// ç›‘å¬å®¹å™¨åˆ·æ–°äº‹ä»¶
@EventListener
public void handleContextRefreshed(ContextRefreshedEvent event) {
System.out.println(&amp;#34;æ”¶åˆ°å®¹å™¨åˆ·æ–°äº‹ä»¶&amp;#34;);
}
// å¼‚æ­¥å¤„ç†è‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶æŒ‡å®šé¡ºåº
@EventListener
@Async
@Order(1)
public void handleOrderCreated(OrderCreatedEvent event) {
System.out.println(&amp;#34;å¼‚æ­¥å¤„ç†è®¢å•äº‹ä»¶: &amp;#34; + event.getOrderId());
}
// æ¡ä»¶åŒ–ç›‘å¬ï¼ˆä»…å½“è®¢å•é‡‘é¢å¤§äº1000æ—¶è§¦å‘ï¼‰
@EventListener(condition = &amp;#34;#event.order.amount &amp;gt; 1000&amp;#34;)
public void handleLargeOrder(OrderCreatedEvent event) {
System.out.println(&amp;#34;å¤„ç†å¤§é¢è®¢å•: &amp;#34; + event.getOrderId());
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¦ä½¿å¼‚æ­¥ç›‘å¬ç”Ÿæ•ˆï¼Œåˆ«å¿˜äº†åœ¨é…ç½®ç±»ä¸Šæ·»åŠ  &lt;code&gt;@EnableAsync&lt;/code&gt;æ³¨è§£ã€‚&lt;/p&gt;
&lt;h3 id="-äº‹ä»¶ç±»å‹å†…ç½®ä¸è‡ªå®šä¹‰"&gt;ğŸ“š äº‹ä»¶ç±»å‹ï¼šå†…ç½®ä¸è‡ªå®šä¹‰
&lt;/h3&gt;&lt;h4 id="spring-å†…ç½®äº‹ä»¶"&gt;Spring å†…ç½®äº‹ä»¶
&lt;/h4&gt;&lt;p&gt;Spring å®¹å™¨ä¼šåœ¨å…¶ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒèŠ‚ç‚¹è‡ªåŠ¨å‘å¸ƒä»¥ä¸‹æ ¸å¿ƒäº‹ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ContextRefreshedEvent&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ &lt;code&gt;ApplicationContext&lt;/code&gt;è¢«åˆå§‹åŒ–æˆ–åˆ·æ–°ï¼ˆè°ƒç”¨ &lt;code&gt;refresh()&lt;/code&gt;æ–¹æ³•ï¼‰æ—¶å‘å¸ƒã€‚æ­¤æ—¶æ‰€æœ‰å•ä¾‹ Bean å·²å®ä¾‹åŒ–å®Œæˆï¼Œæ˜¯è¿›è¡Œç¼“å­˜é¢„çƒ­æˆ–æ•°æ®é¢„åŠ è½½çš„ç†æƒ³æ—¶æœºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ContextStartedEvent&lt;/code&gt;&lt;/strong&gt;ï¼šå½“å®¹å™¨è°ƒç”¨ &lt;code&gt;start()&lt;/code&gt;æ–¹æ³•æ—¶å‘å¸ƒï¼Œé€šå¸¸ç”¨äºé‡å¯å·²åœæ­¢çš„ Beanã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ContextStoppedEvent&lt;/code&gt;&lt;/strong&gt;ï¼šå½“å®¹å™¨è°ƒç”¨ &lt;code&gt;stop()&lt;/code&gt;æ–¹æ³•æ—¶å‘å¸ƒï¼Œç”¨äºåœæ­¢æ‰€æœ‰ Beanã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ContextClosedEvent&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ &lt;code&gt;ApplicationContext&lt;/code&gt;è¢«å…³é—­æ—¶å‘å¸ƒã€‚å®¹å™¨å…³é—­åï¼Œå•ä¾‹ Bean ä¼šè¢«é”€æ¯ï¼Œè¿™æ˜¯è¿›è¡Œèµ„æºæ¸…ç†çš„ä¿¡å·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶"&gt;åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶
&lt;/h4&gt;&lt;p&gt;ä½ å¯ä»¥è½»æ¾å®šä¹‰è‡ªå·±çš„ä¸šåŠ¡äº‹ä»¶ã€‚ä» Spring 4.2 å¼€å§‹ï¼Œäº‹ä»¶ç±»ä¸å†éœ€è¦å¼ºåˆ¶ç»§æ‰¿ &lt;code&gt;ApplicationEvent&lt;/code&gt;ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•æ™®é€š Java å¯¹è±¡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// è‡ªå®šä¹‰è®¢å•åˆ›å»ºäº‹ä»¶
public class OrderCreatedEvent {
private String orderId;
private BigDecimal amount;
// æ„é€ æ–¹æ³•ã€getterã€setter...
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å¦‚ä½•å‘å¸ƒäº‹ä»¶"&gt;ğŸš€ å¦‚ä½•å‘å¸ƒäº‹ä»¶
&lt;/h3&gt;&lt;p&gt;åœ¨éœ€è¦è§¦å‘ä¸šåŠ¡é€»è¾‘çš„åœ°æ–¹ï¼Œä½ å¯ä»¥é€šè¿‡ &lt;code&gt;ApplicationEventPublisher&lt;/code&gt;æ¥å‘å¸ƒäº‹ä»¶ã€‚ç”±äº &lt;code&gt;ApplicationContext&lt;/code&gt;ä¹Ÿå®ç°äº†è¯¥æ¥å£ï¼Œä½ é€šå¸¸å¯ä»¥æ³¨å…¥å®ƒæ¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import org.springframework.context.ApplicationEventPublisher;
import org.springframework.stereotype.Service;
@Service
public class OrderService {
private final ApplicationEventPublisher eventPublisher;
// é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥
public OrderService(ApplicationEventPublisher eventPublisher) {
this.eventPublisher = eventPublisher;
}
public Order createOrder(OrderRequest request) {
// åˆ›å»ºè®¢å•çš„ä¸šåŠ¡é€»è¾‘...
Order order = new Order(request);
// å‘å¸ƒè®¢å•åˆ›å»ºäº‹ä»¶
eventPublisher.publishEvent(new OrderCreatedEvent(order));
return order;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µ"&gt;âš™ï¸ é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¼‚æ­¥äº‹ä»¶å¤„ç†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œäº‹ä»¶ç›‘å¬æ˜¯åŒæ­¥çš„ã€‚å¦‚æœä¸€ä¸ªç›‘å¬å™¨æ‰§è¡Œç¼“æ…¢ï¼Œä¼šé˜»å¡å‘å¸ƒçº¿ç¨‹å’Œåç»­ç›‘å¬å™¨ã€‚ä½¿ç”¨ &lt;code&gt;@Async&lt;/code&gt;æ³¨è§£å¯ä»¥å®ç°å¼‚æ­¥å¤„ç†ï¼Œè¿™å¯¹äºå‘é€é‚®ä»¶ã€è®°å½•æ—¥å¿—ç­‰éæ ¸å¿ƒæˆ–è€—æ—¶æ“ä½œéå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç›‘å¬å™¨æ‰§è¡Œé¡ºåºæ§åˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“å¤šä¸ªç›‘å¬å™¨ç›‘å¬åŒä¸€äº‹ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;@Order&lt;/code&gt;æ³¨è§£æ¥æ§åˆ¶å®ƒä»¬çš„æ‰§è¡Œé¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆæ‰§è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;äº‹åŠ¡ç»‘å®šäº‹ä»¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Spring æä¾›äº† &lt;code&gt;@TransactionalEventListener&lt;/code&gt;æ³¨è§£ï¼Œå®ƒå…è®¸ä½ å°†ç›‘å¬å™¨çš„æ‰§è¡Œä¸äº‹åŠ¡çš„ç‰¹å®šé˜¶æ®µï¼ˆå¦‚ AFTER_COMMITï¼‰ç»‘å®šï¼Œç¡®ä¿äº‹ä»¶å¤„ç†åªåœ¨äº‹åŠ¡æˆåŠŸæäº¤åå‘ç”Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µå»ºè®®&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¿æŒç›‘å¬å™¨è½»é‡çº§&lt;/strong&gt;ï¼šé¿å…åœ¨ç›‘å¬å™¨ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œè‹¥æ— æ³•é¿å…ï¼ŒåŠ¡å¿…ä½¿ç”¨å¼‚æ­¥å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿æŒæ— çŠ¶æ€&lt;/strong&gt;ï¼šç›‘å¬å™¨åº”æ˜¯å•ä¾‹ä¸”æ— çŠ¶æ€çš„ï¼Œé¿å…åœ¨ç›‘å¬å™¨å†…éƒ¨ç»´æŠ¤æ˜“å˜çš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åšå¥½å¼‚å¸¸å¤„ç†&lt;/strong&gt;ï¼šåœ¨ç›‘å¬å™¨å†…éƒ¨å¦¥å–„å¤„ç†å¼‚å¸¸ï¼Œé˜²æ­¢å¼‚å¸¸æ‰©æ•£å½±å“äº‹ä»¶å‘å¸ƒè€…æˆ–å…¶ä»–ç›‘å¬å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹ä»¶å‘½å&lt;/strong&gt;ï¼šæ¨èä½¿ç”¨è¿‡å»æ—¶æ€å‘½åäº‹ä»¶ï¼ˆå¦‚ &lt;code&gt;OrderCreated&lt;/code&gt;ï¼‰ï¼Œè¡¨æ˜å®ƒæ˜¯å·²å‘ç”Ÿçš„äº‹å®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜æ’æŸ¥"&gt;âš ï¸ å¸¸è§é—®é¢˜æ’æŸ¥
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç›‘å¬å™¨æœªè§¦å‘&lt;/strong&gt;ï¼šæ£€æŸ¥ç›‘å¬å™¨æ˜¯å¦å·²æ˜¯ Spring Beanï¼ˆå¦‚æ·»åŠ äº† &lt;code&gt;@Component&lt;/code&gt;ï¼‰ï¼›ç¡®è®¤äº‹ä»¶æ˜¯å¦æ­£ç¡®å‘å¸ƒï¼›æ£€æŸ¥äº‹ä»¶ç±»å‹æ˜¯å¦ä¸ç›‘å¬å™¨æ³›å‹æˆ–æ–¹æ³•å‚æ•°ç±»å‹åŒ¹é…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥ç›‘å¬å™¨ä¸ç”Ÿæ•ˆ&lt;/strong&gt;ï¼šæ£€æŸ¥æ˜¯å¦åœ¨é…ç½®ç±»ä¸Šæ·»åŠ äº† &lt;code&gt;@EnableAsync&lt;/code&gt;æ³¨è§£ï¼Œå¹¶é…ç½®äº†åˆé€‚çš„çº¿ç¨‹æ± ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡äº‹ä»¶ç›‘å¬å™¨ä¸è§¦å‘&lt;/strong&gt;ï¼šç¡®è®¤ä½¿ç”¨çš„æ˜¯ &lt;code&gt;@TransactionalEventListener&lt;/code&gt;ï¼Œå¹¶æ£€æŸ¥ç›¸å…³äº‹åŠ¡æ˜¯å¦æˆåŠŸæäº¤æˆ–å›æ»šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ApplicationListener&lt;/code&gt;æ˜¯ Spring æ¡†æ¶ä¸­å®ç°æ¾è€¦åˆé€šä¿¡çš„å¼ºå¤§å·¥å…·ã€‚é€šè¿‡äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œä½ å¯ä»¥å°†åº”ç”¨çš„ä¸åŒæ¨¡å—è§£è€¦ï¼Œä½¿ä»£ç æ›´åŠ çµæ´»ã€å¯æ‰©å±•å’Œæ˜“äºç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ ç†è§£å’Œè¿ç”¨ &lt;code&gt;ApplicationListener&lt;/code&gt;ã€‚å¦‚æœä½ å¯¹æŸä¸ªå…·ä½“ç‰¹æ€§æˆ–ä½¿ç”¨åœºæ™¯æœ‰æ›´æ·±å…¥çš„ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="configurableenvironment"&gt;ConfigurableEnvironment
&lt;/h2&gt;&lt;p&gt;ConfigurableEnvironment æ˜¯ Spring æ¡†æ¶ä¸­ç”¨äºç¯å¢ƒé…ç½®çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒæä¾›äº†ç»Ÿä¸€çš„æœºåˆ¶æ¥ç®¡ç†å’Œè®¿é—®åº”ç”¨ç¨‹åºçš„å„ç§é…ç½®æ•°æ®ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒçš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†å’Œä¸»è¦èŒè´£ï¼Œå¸®åŠ©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ¨¡å—/æ¥å£&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒèŒè´£&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Environment (çˆ¶æ¥å£)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾›å¯¹ç¯å¢ƒ&lt;strong&gt;åªè¯»è®¿é—®&lt;/strong&gt;çš„åŸºæœ¬èƒ½åŠ›ï¼Œå¦‚è·å–å±æ€§ã€æ£€æŸ¥æ¿€æ´»çš„é…ç½®æ–‡ä»¶ï¼ˆProfileï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ConfigurablePropertyResolver (çˆ¶æ¥å£)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾›&lt;strong&gt;å±æ€§è§£æ&lt;/strong&gt;çš„é«˜çº§é…ç½®èƒ½åŠ›ï¼ŒåŒ…æ‹¬ç±»å‹è½¬æ¢ã€å ä½ç¬¦å¤„ç†ã€å¿…éœ€å±æ€§éªŒè¯ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ConfigurableEnvironment (æœ¬ä½“)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿å¹¶èåˆ&lt;/strong&gt;ä¸Šè¿°ä¸¤è€…ï¼Œå¹¶å¢åŠ &lt;strong&gt;åŠ¨æ€é…ç½®&lt;/strong&gt;èƒ½åŠ›ï¼Œå¦‚ç®¡ç†å±æ€§æºï¼ˆPropertySourcesï¼‰ã€è®¾ç½®æ´»åŠ¨/é»˜è®¤é…ç½®æ–‡ä»¶ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼"&gt;ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼
&lt;/h3&gt;&lt;p&gt;ConfigurableEnvironment çš„æ ¸å¿ƒä»·å€¼åœ¨äºå®ƒå°†åº”ç”¨ç¨‹åºä¸å…·ä½“çš„è¿è¡Œç¯å¢ƒè§£è€¦ï¼Œä¸ºä½ æä¾›äº†ä¸€ä¸ªç»Ÿä¸€ä¸”å¼ºå¤§çš„é…ç½®ç®¡ç†å…¥å£ã€‚å®ƒçš„è®¾è®¡ä¸»è¦æœåŠ¡äºä¸¤ä¸ªå…³é”®æ–¹é¢ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æ–‡ä»¶ï¼ˆProfilesï¼‰&lt;/strong&gt;ï¼šå®ç°&lt;strong&gt;ç¯å¢ƒéš”ç¦»&lt;/strong&gt;ã€‚é€šè¿‡é¢„è®¾çš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ &lt;code&gt;dev&lt;/code&gt;, &lt;code&gt;test&lt;/code&gt;, &lt;code&gt;prod&lt;/code&gt;ï¼‰ï¼Œä½ å¯ä»¥æ§åˆ¶ä¸åŒç¯å¢ƒä¸‹å“ªäº› Bean åº”è¯¥è¢«æ³¨å†Œï¼Œå“ªäº›é…ç½®åº”è¯¥ç”Ÿæ•ˆã€‚è¿™åœ¨ Spring ä¸­é€šå¸¸é€šè¿‡ &lt;code&gt;@Profile&lt;/code&gt;æ³¨è§£æ¥å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±æ€§ï¼ˆPropertiesï¼‰&lt;/strong&gt;ï¼šå®ç°&lt;strong&gt;é…ç½®é›†ä¸­åŒ–ä¸å¤–éƒ¨åŒ–&lt;/strong&gt;ã€‚å±æ€§å¯ä»¥æ¥æºäºå¤šç§æ¸ é“ï¼Œå¦‚ &lt;code&gt;.properties&lt;/code&gt;/&lt;code&gt;.yml&lt;/code&gt;æ–‡ä»¶ã€JVM ç³»ç»Ÿå±æ€§ã€æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡ã€Servlet ä¸Šä¸‹æ–‡å‚æ•°ç­‰ã€‚ConfigurableEnvironment çš„ä½œç”¨å°±æ˜¯å°†è¿™äº›åˆ†æ•£çš„æ¥æºç»Ÿä¸€ç®¡ç†ï¼Œå¹¶æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£æ¥è·å–å’Œè§£æè¿™äº›å±æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ ¸å¿ƒæ“ä½œä¸ä½¿ç”¨æ–¹æ³•"&gt;âš™ï¸ æ ¸å¿ƒæ“ä½œä¸ä½¿ç”¨æ–¹æ³•
&lt;/h3&gt;&lt;h4 id="1-ç®¡ç†é…ç½®æ–‡ä»¶profiles"&gt;1. ç®¡ç†é…ç½®æ–‡ä»¶ï¼ˆProfilesï¼‰
&lt;/h4&gt;&lt;p&gt;é…ç½®æ–‡ä»¶å…è®¸ä½ æ ¹æ®ç¯å¢ƒï¼ˆå¦‚å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰æ¿€æ´»ä¸åŒçš„é…ç½®æˆ– Bean å®šä¹‰ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// åˆ›å»ºç¯å¢ƒå®ä¾‹ï¼ˆåœ¨Spring Bootåº”ç”¨ä¸­ï¼Œé€šå¸¸é€šè¿‡æ³¨å…¥è·å–ï¼‰
ConfigurableEnvironment environment = new StandardEnvironment();
// 1. è®¾ç½®æ´»åŠ¨é…ç½®æ–‡ä»¶ï¼ˆå°†æ›¿æ¢æ‰€æœ‰ç°æœ‰æ´»åŠ¨é…ç½®ï¼‰
environment.setActiveProfiles(&amp;#34;dev&amp;#34;, &amp;#34;test&amp;#34;);
// 2. æ·»åŠ æ´»åŠ¨é…ç½®æ–‡ä»¶ï¼ˆåœ¨ç°æœ‰é…ç½®åŸºç¡€ä¸Šè¿½åŠ ï¼‰
environment.addActiveProfile(&amp;#34;integration&amp;#34;);
// 3. è®¾ç½®é»˜è®¤é…ç½®æ–‡ä»¶ï¼ˆå½“æ²¡æœ‰æ´»åŠ¨é…ç½®æ—¶ç”Ÿæ•ˆï¼‰
environment.setDefaultProfiles(&amp;#34;default&amp;#34;);
// æ£€æŸ¥é…ç½®æ˜¯å¦ç”Ÿæ•ˆ
String[] activeProfiles = environment.getActiveProfiles(); // è·å–æ‰€æœ‰æ´»åŠ¨é…ç½®
boolean isTestActive = environment.acceptsProfiles(&amp;#34;test&amp;#34;); // æ£€æŸ¥ç‰¹å®šé…ç½®æ˜¯å¦æ¿€æ´»
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šè®¾ç½®æ´»åŠ¨æˆ–é»˜è®¤é…ç½®æ–‡ä»¶çš„æ“ä½œ&lt;strong&gt;å¿…é¡»åœ¨ Spring å®¹å™¨åˆ·æ–°ï¼ˆrefreshï¼‰ä¹‹å‰å®Œæˆ&lt;/strong&gt;ï¼Œé€šå¸¸å¯ä»¥åœ¨ &lt;code&gt;ApplicationContextInitializer&lt;/code&gt;ä¸­å®ç°ã€‚&lt;/p&gt;
&lt;h4 id="2-ç®¡ç†å±æ€§æºpropertysources"&gt;2. ç®¡ç†å±æ€§æºï¼ˆPropertySourcesï¼‰
&lt;/h4&gt;&lt;p&gt;å±æ€§æºæ˜¯å®é™…å­˜å‚¨é…ç½®é”®å€¼å¯¹çš„è½½ä½“ã€‚ConfigurableEnvironment é€šè¿‡ &lt;code&gt;MutablePropertySources&lt;/code&gt;å¯¹è±¡ç®¡ç†ä¸€ä¸ªå±æ€§æºåˆ—è¡¨ï¼Œæ­¤åˆ—è¡¨çš„&lt;strong&gt;é¡ºåºå†³å®šäº†å±æ€§æŸ¥æ‰¾çš„ä¼˜å…ˆçº§&lt;/strong&gt;ï¼ˆè¶Šé å‰çš„æºä¼˜å…ˆçº§è¶Šé«˜ï¼‰ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// è·å–å¯å˜çš„å±æ€§æºé›†åˆ
MutablePropertySources propertySources = environment.getPropertySources();
// ç¤ºä¾‹1ï¼šæ·»åŠ ä¸€ä¸ªæœ€é«˜ä¼˜å…ˆçº§çš„è‡ªå®šä¹‰å±æ€§æºï¼ˆé¦–å…ˆè¢«æŸ¥æ‰¾ï¼‰
Map&amp;lt;String, Object&amp;gt; customMap = new HashMap&amp;lt;&amp;gt;();
customMap.put(&amp;#34;app.name&amp;#34;, &amp;#34;MyApp&amp;#34;);
propertySources.addFirst(new MapPropertySource(&amp;#34;myHighPrioritySource&amp;#34;, customMap));
// ç¤ºä¾‹2ï¼šæ·»åŠ ä¸€ä¸ªæœ€ä½ä¼˜å…ˆçº§çš„å±æ€§æºï¼ˆæœ€åè¢«æŸ¥æ‰¾ï¼‰
propertySources.addLast(new MapPropertySource(&amp;#34;myLowPrioritySource&amp;#34;, anotherMap));
// ç¤ºä¾‹3ï¼šç§»é™¤ç³»ç»Ÿå±æ€§æºï¼ˆå¦‚ä¸å¸Œæœ›åº”ç”¨ç¨‹åºè®¿é—®JVMç³»ç»Ÿå±æ€§ï¼‰
propertySources.remove(StandardEnvironment.SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME);
// ç¤ºä¾‹4ï¼šåœ¨æŒ‡å®šå±æ€§æºä¹‹å‰æ’å…¥
propertySources.addBefore(&amp;#34;systemEnvironmentSource&amp;#34;, new MapPropertySource(&amp;#34;mySource&amp;#34;, myMap));
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="3-å±æ€§è§£æä¸è·å–"&gt;3. å±æ€§è§£æä¸è·å–
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯æœ€ç»ˆç›®çš„â€”â€”ä»ç¯å¢ƒä¸­è·å–ä½ éœ€è¦çš„é…ç½®å€¼ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// 1. è·å–ç³»ç»Ÿå±æ€§ï¼ˆJVMçš„-Då‚æ•°ï¼‰å’Œç¯å¢ƒå˜é‡
Map&amp;lt;String, Object&amp;gt; systemProperties = environment.getSystemProperties();
Map&amp;lt;String, Object&amp;gt; systemEnvironment = environment.getSystemEnvironment();
// 2. è·å–ä»»æ„å±æ€§çš„å€¼ï¼ˆæœ€å¸¸ç”¨æ–¹æ³•ï¼‰
// ç®€å•è·å–ï¼Œä¸å­˜åœ¨åˆ™è¿”å›null
String appName = environment.getProperty(&amp;#34;app.name&amp;#34;);
// å¸¦é»˜è®¤å€¼çš„è·å–
String appNameWithDefault = environment.getProperty(&amp;#34;app.name&amp;#34;, &amp;#34;DefaultApp&amp;#34;);
// è·å–å¹¶è‡ªåŠ¨è½¬æ¢ä¸ºæŒ‡å®šç±»å‹
Integer serverPort = environment.getProperty(&amp;#34;server.port&amp;#34;, Integer.class, 8080);
// è·å–å¿…é¡»å­˜åœ¨çš„å±æ€§ï¼Œä¸å­˜åœ¨åˆ™æŠ›å‡ºå¼‚å¸¸
String requiredKey = environment.getRequiredProperty(&amp;#34;required.key&amp;#34;);
// 3. è§£æå ä½ç¬¦ ï¼ˆä¾‹å¦‚ï¼Œå±æ€§å€¼å¯èƒ½æ˜¯ &amp;#34;${app.host:localhost}&amp;#34; ï¼‰
String resolvedValue = environment.resolvePlaceholders(&amp;#34;Base URL: ${app.url:http://default}&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-ä¸»è¦å®ç°ç±»"&gt;ğŸ” ä¸»è¦å®ç°ç±»
&lt;/h3&gt;&lt;p&gt;Spring ä¸ºä¸åŒçš„åº”ç”¨åœºæ™¯æä¾›äº†å…·ä½“çš„å®ç°ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å®ç°ç±»&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;th&gt;ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;StandardEnvironment&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ ‡å‡†çš„ç‹¬ç«‹Javaåº”ç”¨ç¨‹åº&lt;/td&gt;
&lt;td&gt;é»˜è®¤åŒ…å«&lt;strong&gt;ç³»ç»Ÿå±æ€§&lt;/strong&gt;ï¼ˆ&lt;code&gt;systemProperties&lt;/code&gt;ï¼‰å’Œ&lt;strong&gt;ç³»ç»Ÿç¯å¢ƒå˜é‡&lt;/strong&gt;ï¼ˆ&lt;code&gt;systemEnvironment&lt;/code&gt;ï¼‰ä¸¤ä¸ªå±æ€§æºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;StandardServletEnvironment&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Webåº”ç”¨ç¨‹åºï¼ˆåŸºäºServletï¼‰&lt;/td&gt;
&lt;td&gt;ç»§æ‰¿è‡ª &lt;code&gt;StandardEnvironment&lt;/code&gt;ï¼Œå¹¶é¢å¤–å¢åŠ äº† &lt;strong&gt;&lt;code&gt;servletConfigInitParams&lt;/code&gt;&lt;/strong&gt;ï¼ˆServleté…ç½®å‚æ•°ï¼‰å’Œ &lt;strong&gt;&lt;code&gt;servletContextInitParams&lt;/code&gt;&lt;/strong&gt;ï¼ˆServletä¸Šä¸‹æ–‡å‚æ•°ï¼‰ç­‰å±æ€§æºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;MockEnvironment&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•å…ƒæµ‹è¯•&lt;/td&gt;
&lt;td&gt;ç”¨äºæ¨¡æ‹Ÿç¯å¢ƒï¼Œå¯ä»¥æ–¹ä¾¿åœ°è®¾ç½®å’Œæ“æ§å±æ€§ï¼Œè€Œä¸ä¾èµ–äºçœŸå®çš„ç³»ç»Ÿç¯å¢ƒã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å®é™…åº”ç”¨ä¸æœ€ä½³å®è·µ"&gt;ğŸ’» å®é™…åº”ç”¨ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;h4 id="1-å¤šç¯å¢ƒé…ç½®"&gt;1. å¤šç¯å¢ƒé…ç½®
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯ ConfigurableEnvironment æœ€ç»å…¸çš„åº”ç”¨ã€‚é€šè¿‡åœ¨ä»£ç ä¸­è®¾ç½®ä¸åŒçš„æ´»åŠ¨é…ç½®æ–‡ä»¶ï¼Œæ¥åŠ è½½å¯¹åº”ç¯å¢ƒçš„é…ç½®ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Configuration
public class AppConfig {
@Autowired
private ConfigurableEnvironment environment;
@Bean
@Profile(&amp;#34;dev&amp;#34;) // æ­¤Beanä»…åœ¨ &amp;#34;dev&amp;#34; é…ç½®æ–‡ä»¶æ¿€æ´»æ—¶åˆ›å»º
public DataSource devDataSource() {
return new EmbeddedDatabaseBuilder().setType(EmbeddedDatabaseType.H2).build();
}
@Bean
@Profile(&amp;#34;prod&amp;#34;) // æ­¤Beanä»…åœ¨ &amp;#34;prod&amp;#34; é…ç½®æ–‡ä»¶æ¿€æ´»æ—¶åˆ›å»º
public DataSource prodDataSource() {
// ç”Ÿäº§ç¯å¢ƒçš„æ•°æ®æºé…ç½®
// å¯ä»¥ä»ç¯å¢ƒä¸­è¯»å–JDBC URLç­‰å‚æ•°
String url = environment.getProperty(&amp;#34;spring.datasource.url&amp;#34;);
// ... åˆ›å»ºå¹¶è¿”å›ç”Ÿäº§æ•°æ®æº
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="2-åŠ¨æ€é…ç½®æ›´æ–°"&gt;2. åŠ¨æ€é…ç½®æ›´æ–°
&lt;/h4&gt;&lt;p&gt;åˆ©ç”¨å…¶å¯å˜çš„ç‰¹æ€§ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹é…ç½®ï¼Œè¿™åœ¨å®ç°é…ç½®çƒ­åŠ è½½ç­‰é«˜çº§åŠŸèƒ½æ—¶éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Service
public class DynamicConfigService {
@Autowired
private ConfigurableEnvironment environment;
public void updateProperty(String key, String value) {
MutablePropertySources sources = environment.getPropertySources();
// æŸ¥æ‰¾æˆ–åˆ›å»ºä¸€ä¸ªåä¸º&amp;#34;dynamicSource&amp;#34;çš„å¯å†™å±æ€§æº
MapPropertySource dynamicSource = (MapPropertySource) sources.get(&amp;#34;dynamicSource&amp;#34;);
if (dynamicSource == null) {
Map&amp;lt;String, Object&amp;gt; map = new HashMap&amp;lt;&amp;gt;();
dynamicSource = new MapPropertySource(&amp;#34;dynamicSource&amp;#34;, map);
sources.addFirst(dynamicSource); // æ·»åŠ åˆ°æœ€å‰ä»¥æ‹¥æœ‰æœ€é«˜ä¼˜å…ˆçº§
}
// æ›´æ–°å±æ€§
dynamicSource.getSource().put(key, value);
// æ³¨æ„ï¼šæ­¤æ“ä½œä¸ä¼šè‡ªåŠ¨æ›´æ–°å·²åˆå§‹åŒ–çš„å•ä¾‹Beanä¸­é€šè¿‡@Valueæ³¨å…¥çš„å€¼ï¼Œé€šå¸¸éœ€è¦é…åˆ@RefreshScopeç­‰æœºåˆ¶ã€‚
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="3-è‡ªå®šä¹‰å±æ€§æº"&gt;3. è‡ªå®šä¹‰å±æ€§æº
&lt;/h4&gt;&lt;p&gt;ä½ å¯ä»¥é›†æˆä»»ä½•ä½ æƒ³è¦çš„é…ç½®æ¥æºï¼Œæ¯”å¦‚ä»æ•°æ®åº“ã€è¿œç¨‹é…ç½®ä¸­å¿ƒï¼ˆå¦‚Apolloã€Nacosï¼‰è¯»å–é…ç½®ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ä¸€ä¸ªç®€å•çš„ä»æ•°æ®åº“è¯»å–é…ç½®çš„å±æ€§æºç¤ºä¾‹
public class DatabasePropertySource extends PropertySource&amp;lt;DataSource&amp;gt; {
public DatabasePropertySource(String name, DataSource dataSource) {
super(name, dataSource);
}
@Override
public Object getProperty(String key) {
// å®ç°ä»æ•°æ®åº“æŸ¥è¯¢é…ç½®çš„é€»è¾‘
try (Connection conn = getSource().getConnection();
PreparedStatement stmt = conn.prepareStatement(&amp;#34;SELECT value FROM config_table WHERE key = ?&amp;#34;)) {
stmt.setString(1, key);
ResultSet rs = stmt.executeQuery();
return rs.next() ? rs.getString(&amp;#34;value&amp;#34;) : null;
} catch (SQLException e) {
throw new RuntimeException(&amp;#34;Failed to read property from database&amp;#34;, e);
}
}
}
// æ³¨å†Œè‡ªå®šä¹‰å±æ€§æºï¼ˆé€šå¸¸åœ¨ApplicationContextInitializeræˆ–EnvironmentPostProcessorä¸­ï¼‰
environment.getPropertySources().addLast(new DatabasePropertySource(&amp;#34;dbPropertySource&amp;#34;, dataSource));
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å¸¸è§é—®é¢˜ä¸æŠ€å·§"&gt;âš ï¸ å¸¸è§é—®é¢˜ä¸æŠ€å·§
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å±æ€§è¦†ç›–ä¸ä¼˜å…ˆçº§&lt;/strong&gt;ï¼šç‰¢è®°å±æ€§æºçš„é¡ºåºå°±æ˜¯ä¼˜å…ˆçº§ã€‚å½“ä½ å‘ç°è·å–çš„å±æ€§å€¼ä¸æ˜¯é¢„æœŸå€¼æ—¶ï¼Œæ£€æŸ¥ä¸€ä¸‹å±æ€§æºçš„é¡ºåºï¼Œå¯èƒ½æ˜¯é«˜ä¼˜å…ˆçº§çš„æºè¦†ç›–äº†ä½ä¼˜å…ˆçº§æºçš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®ç”Ÿæ•ˆæ—¶æœº&lt;/strong&gt;ï¼šåœ¨Spring Bootåº”ç”¨ä¸­ï¼Œå¦‚æœä½ æƒ³é€šè¿‡ä»£ç ï¼ˆå¦‚&lt;code&gt;setActiveProfiles&lt;/code&gt;ï¼‰è®¾ç½®é…ç½®æ–‡ä»¶ï¼ŒåŠ¡å¿…ç¡®ä¿è¯¥æ“ä½œåœ¨&lt;code&gt;ApplicationContext&lt;/code&gt;çš„&lt;code&gt;refresh()&lt;/code&gt;æ–¹æ³•è°ƒç”¨ä¹‹å‰å®Œæˆã€‚ä¸€ä¸ªå¸¸è§çš„åšæ³•æ˜¯å®ç°&lt;code&gt;ApplicationContextInitializer&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å ä½ç¬¦è§£æå™¨é…åˆ&lt;/strong&gt;ï¼šè¦è®©&lt;code&gt;@Value(&amp;quot;${property.name}&amp;quot;)&lt;/code&gt;è¿™æ ·çš„æ³¨è§£ç”Ÿæ•ˆï¼Œä½ éœ€è¦é…ç½®ä¸€ä¸ª&lt;code&gt;PropertySourcesPlaceholderConfigurer&lt;/code&gt;ï¼Œå®ƒä¼šåˆ©ç”¨ConfigurableEnvironmentæ¥è§£æå ä½ç¬¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ConfigurableEnvironment æ˜¯ Spring æ¡†æ¶ç¯å¢ƒæŠ½è±¡çš„æ ¸å¿ƒã€‚å®ƒé€šè¿‡&lt;strong&gt;å±æ€§æºï¼ˆPropertySourcesï¼‰&lt;strong&gt;å’Œ&lt;/strong&gt;é…ç½®æ–‡ä»¶ï¼ˆProfilesï¼‰&lt;/strong&gt; è¿™ä¸¤å¤§æ”¯æŸ±ï¼Œä¸ºä½ æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„é…ç½®ç®¡ç†èƒ½åŠ›ã€‚æ— è®ºæ˜¯å¤„ç†ç®€å•çš„å¤šç¯å¢ƒé…ç½®ï¼Œè¿˜æ˜¯å®ç°å¤æ‚çš„åŠ¨æ€é…ç½®æ›´æ–°å’Œè‡ªå®šä¹‰é…ç½®æºï¼Œç†è§£å¹¶å–„ç”¨ ConfigurableEnvironment éƒ½æ˜¯å…³é”®ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£å¹¶åœ¨å®é™…é¡¹ç›®ä¸­æœ‰æ•ˆè¿ç”¨ ConfigurableEnvironmentã€‚&lt;/p&gt;
&lt;h2 id="startup"&gt;StartUp
&lt;/h2&gt;&lt;p&gt;ConfigurableEnvironment æ˜¯ Spring æ¡†æ¶ä¸­ç”¨äºç¯å¢ƒé…ç½®çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒæä¾›äº†ç»Ÿä¸€çš„æœºåˆ¶æ¥ç®¡ç†å’Œè®¿é—®åº”ç”¨ç¨‹åºçš„å„ç§é…ç½®æ•°æ®ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒçš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†å’Œä¸»è¦èŒè´£ï¼Œå¸®åŠ©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ¨¡å—/æ¥å£&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒèŒè´£&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Environment (çˆ¶æ¥å£)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾›å¯¹ç¯å¢ƒ&lt;strong&gt;åªè¯»è®¿é—®&lt;/strong&gt;çš„åŸºæœ¬èƒ½åŠ›ï¼Œå¦‚è·å–å±æ€§ã€æ£€æŸ¥æ¿€æ´»çš„é…ç½®æ–‡ä»¶ï¼ˆProfileï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ConfigurablePropertyResolver (çˆ¶æ¥å£)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾›&lt;strong&gt;å±æ€§è§£æ&lt;/strong&gt;çš„é«˜çº§é…ç½®èƒ½åŠ›ï¼ŒåŒ…æ‹¬ç±»å‹è½¬æ¢ã€å ä½ç¬¦å¤„ç†ã€å¿…éœ€å±æ€§éªŒè¯ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ConfigurableEnvironment (æœ¬ä½“)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿å¹¶èåˆ&lt;/strong&gt;ä¸Šè¿°ä¸¤è€…ï¼Œå¹¶å¢åŠ &lt;strong&gt;åŠ¨æ€é…ç½®&lt;/strong&gt;èƒ½åŠ›ï¼Œå¦‚ç®¡ç†å±æ€§æºï¼ˆPropertySourcesï¼‰ã€è®¾ç½®æ´»åŠ¨/é»˜è®¤é…ç½®æ–‡ä»¶ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼-1"&gt;ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼
&lt;/h3&gt;&lt;p&gt;ConfigurableEnvironment çš„æ ¸å¿ƒä»·å€¼åœ¨äºå®ƒå°†åº”ç”¨ç¨‹åºä¸å…·ä½“çš„è¿è¡Œç¯å¢ƒè§£è€¦ï¼Œä¸ºä½ æä¾›äº†ä¸€ä¸ªç»Ÿä¸€ä¸”å¼ºå¤§çš„é…ç½®ç®¡ç†å…¥å£ã€‚å®ƒçš„è®¾è®¡ä¸»è¦æœåŠ¡äºä¸¤ä¸ªå…³é”®æ–¹é¢ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æ–‡ä»¶ï¼ˆProfilesï¼‰&lt;/strong&gt;ï¼šå®ç°&lt;strong&gt;ç¯å¢ƒéš”ç¦»&lt;/strong&gt;ã€‚é€šè¿‡é¢„è®¾çš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ &lt;code&gt;dev&lt;/code&gt;, &lt;code&gt;test&lt;/code&gt;, &lt;code&gt;prod&lt;/code&gt;ï¼‰ï¼Œä½ å¯ä»¥æ§åˆ¶ä¸åŒç¯å¢ƒä¸‹å“ªäº› Bean åº”è¯¥è¢«æ³¨å†Œï¼Œå“ªäº›é…ç½®åº”è¯¥ç”Ÿæ•ˆã€‚è¿™åœ¨ Spring ä¸­é€šå¸¸é€šè¿‡ &lt;code&gt;@Profile&lt;/code&gt;æ³¨è§£æ¥å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±æ€§ï¼ˆPropertiesï¼‰&lt;/strong&gt;ï¼šå®ç°&lt;strong&gt;é…ç½®é›†ä¸­åŒ–ä¸å¤–éƒ¨åŒ–&lt;/strong&gt;ã€‚å±æ€§å¯ä»¥æ¥æºäºå¤šç§æ¸ é“ï¼Œå¦‚ &lt;code&gt;.properties&lt;/code&gt;/&lt;code&gt;.yml&lt;/code&gt;æ–‡ä»¶ã€JVM ç³»ç»Ÿå±æ€§ã€æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡ã€Servlet ä¸Šä¸‹æ–‡å‚æ•°ç­‰ã€‚ConfigurableEnvironment çš„ä½œç”¨å°±æ˜¯å°†è¿™äº›åˆ†æ•£çš„æ¥æºç»Ÿä¸€ç®¡ç†ï¼Œå¹¶æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£æ¥è·å–å’Œè§£æè¿™äº›å±æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ ¸å¿ƒæ“ä½œä¸ä½¿ç”¨æ–¹æ³•-1"&gt;âš™ï¸ æ ¸å¿ƒæ“ä½œä¸ä½¿ç”¨æ–¹æ³•
&lt;/h3&gt;&lt;h4 id="1-ç®¡ç†é…ç½®æ–‡ä»¶profiles-1"&gt;1. ç®¡ç†é…ç½®æ–‡ä»¶ï¼ˆProfilesï¼‰
&lt;/h4&gt;&lt;p&gt;é…ç½®æ–‡ä»¶å…è®¸ä½ æ ¹æ®ç¯å¢ƒï¼ˆå¦‚å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰æ¿€æ´»ä¸åŒçš„é…ç½®æˆ– Bean å®šä¹‰ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// åˆ›å»ºç¯å¢ƒå®ä¾‹ï¼ˆåœ¨Spring Bootåº”ç”¨ä¸­ï¼Œé€šå¸¸é€šè¿‡æ³¨å…¥è·å–ï¼‰
ConfigurableEnvironment environment = new StandardEnvironment();
// 1. è®¾ç½®æ´»åŠ¨é…ç½®æ–‡ä»¶ï¼ˆå°†æ›¿æ¢æ‰€æœ‰ç°æœ‰æ´»åŠ¨é…ç½®ï¼‰
environment.setActiveProfiles(&amp;#34;dev&amp;#34;, &amp;#34;test&amp;#34;);
// 2. æ·»åŠ æ´»åŠ¨é…ç½®æ–‡ä»¶ï¼ˆåœ¨ç°æœ‰é…ç½®åŸºç¡€ä¸Šè¿½åŠ ï¼‰
environment.addActiveProfile(&amp;#34;integration&amp;#34;);
// 3. è®¾ç½®é»˜è®¤é…ç½®æ–‡ä»¶ï¼ˆå½“æ²¡æœ‰æ´»åŠ¨é…ç½®æ—¶ç”Ÿæ•ˆï¼‰
environment.setDefaultProfiles(&amp;#34;default&amp;#34;);
// æ£€æŸ¥é…ç½®æ˜¯å¦ç”Ÿæ•ˆ
String[] activeProfiles = environment.getActiveProfiles(); // è·å–æ‰€æœ‰æ´»åŠ¨é…ç½®
boolean isTestActive = environment.acceptsProfiles(&amp;#34;test&amp;#34;); // æ£€æŸ¥ç‰¹å®šé…ç½®æ˜¯å¦æ¿€æ´»
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šè®¾ç½®æ´»åŠ¨æˆ–é»˜è®¤é…ç½®æ–‡ä»¶çš„æ“ä½œ&lt;strong&gt;å¿…é¡»åœ¨ Spring å®¹å™¨åˆ·æ–°ï¼ˆrefreshï¼‰ä¹‹å‰å®Œæˆ&lt;/strong&gt;ï¼Œé€šå¸¸å¯ä»¥åœ¨ &lt;code&gt;ApplicationContextInitializer&lt;/code&gt;ä¸­å®ç°ã€‚&lt;/p&gt;
&lt;h4 id="2-ç®¡ç†å±æ€§æºpropertysources-1"&gt;2. ç®¡ç†å±æ€§æºï¼ˆPropertySourcesï¼‰
&lt;/h4&gt;&lt;p&gt;å±æ€§æºæ˜¯å®é™…å­˜å‚¨é…ç½®é”®å€¼å¯¹çš„è½½ä½“ã€‚ConfigurableEnvironment é€šè¿‡ &lt;code&gt;MutablePropertySources&lt;/code&gt;å¯¹è±¡ç®¡ç†ä¸€ä¸ªå±æ€§æºåˆ—è¡¨ï¼Œæ­¤åˆ—è¡¨çš„&lt;strong&gt;é¡ºåºå†³å®šäº†å±æ€§æŸ¥æ‰¾çš„ä¼˜å…ˆçº§&lt;/strong&gt;ï¼ˆè¶Šé å‰çš„æºä¼˜å…ˆçº§è¶Šé«˜ï¼‰ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// è·å–å¯å˜çš„å±æ€§æºé›†åˆ
MutablePropertySources propertySources = environment.getPropertySources();
// ç¤ºä¾‹1ï¼šæ·»åŠ ä¸€ä¸ªæœ€é«˜ä¼˜å…ˆçº§çš„è‡ªå®šä¹‰å±æ€§æºï¼ˆé¦–å…ˆè¢«æŸ¥æ‰¾ï¼‰
Map&amp;lt;String, Object&amp;gt; customMap = new HashMap&amp;lt;&amp;gt;();
customMap.put(&amp;#34;app.name&amp;#34;, &amp;#34;MyApp&amp;#34;);
propertySources.addFirst(new MapPropertySource(&amp;#34;myHighPrioritySource&amp;#34;, customMap));
// ç¤ºä¾‹2ï¼šæ·»åŠ ä¸€ä¸ªæœ€ä½ä¼˜å…ˆçº§çš„å±æ€§æºï¼ˆæœ€åè¢«æŸ¥æ‰¾ï¼‰
propertySources.addLast(new MapPropertySource(&amp;#34;myLowPrioritySource&amp;#34;, anotherMap));
// ç¤ºä¾‹3ï¼šç§»é™¤ç³»ç»Ÿå±æ€§æºï¼ˆå¦‚ä¸å¸Œæœ›åº”ç”¨ç¨‹åºè®¿é—®JVMç³»ç»Ÿå±æ€§ï¼‰
propertySources.remove(StandardEnvironment.SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME);
// ç¤ºä¾‹4ï¼šåœ¨æŒ‡å®šå±æ€§æºä¹‹å‰æ’å…¥
propertySources.addBefore(&amp;#34;systemEnvironmentSource&amp;#34;, new MapPropertySource(&amp;#34;mySource&amp;#34;, myMap));
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="3-å±æ€§è§£æä¸è·å–-1"&gt;3. å±æ€§è§£æä¸è·å–
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯æœ€ç»ˆç›®çš„â€”â€”ä»ç¯å¢ƒä¸­è·å–ä½ éœ€è¦çš„é…ç½®å€¼ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// 1. è·å–ç³»ç»Ÿå±æ€§ï¼ˆJVMçš„-Då‚æ•°ï¼‰å’Œç¯å¢ƒå˜é‡
Map&amp;lt;String, Object&amp;gt; systemProperties = environment.getSystemProperties();
Map&amp;lt;String, Object&amp;gt; systemEnvironment = environment.getSystemEnvironment();
// 2. è·å–ä»»æ„å±æ€§çš„å€¼ï¼ˆæœ€å¸¸ç”¨æ–¹æ³•ï¼‰
// ç®€å•è·å–ï¼Œä¸å­˜åœ¨åˆ™è¿”å›null
String appName = environment.getProperty(&amp;#34;app.name&amp;#34;);
// å¸¦é»˜è®¤å€¼çš„è·å–
String appNameWithDefault = environment.getProperty(&amp;#34;app.name&amp;#34;, &amp;#34;DefaultApp&amp;#34;);
// è·å–å¹¶è‡ªåŠ¨è½¬æ¢ä¸ºæŒ‡å®šç±»å‹
Integer serverPort = environment.getProperty(&amp;#34;server.port&amp;#34;, Integer.class, 8080);
// è·å–å¿…é¡»å­˜åœ¨çš„å±æ€§ï¼Œä¸å­˜åœ¨åˆ™æŠ›å‡ºå¼‚å¸¸
String requiredKey = environment.getRequiredProperty(&amp;#34;required.key&amp;#34;);
// 3. è§£æå ä½ç¬¦ ï¼ˆä¾‹å¦‚ï¼Œå±æ€§å€¼å¯èƒ½æ˜¯ &amp;#34;${app.host:localhost}&amp;#34; ï¼‰
String resolvedValue = environment.resolvePlaceholders(&amp;#34;Base URL: ${app.url:http://default}&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-ä¸»è¦å®ç°ç±»-1"&gt;ğŸ” ä¸»è¦å®ç°ç±»
&lt;/h3&gt;&lt;p&gt;Spring ä¸ºä¸åŒçš„åº”ç”¨åœºæ™¯æä¾›äº†å…·ä½“çš„å®ç°ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å®ç°ç±»&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;th&gt;ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;StandardEnvironment&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ ‡å‡†çš„ç‹¬ç«‹Javaåº”ç”¨ç¨‹åº&lt;/td&gt;
&lt;td&gt;é»˜è®¤åŒ…å«&lt;strong&gt;ç³»ç»Ÿå±æ€§&lt;/strong&gt;ï¼ˆ&lt;code&gt;systemProperties&lt;/code&gt;ï¼‰å’Œ&lt;strong&gt;ç³»ç»Ÿç¯å¢ƒå˜é‡&lt;/strong&gt;ï¼ˆ&lt;code&gt;systemEnvironment&lt;/code&gt;ï¼‰ä¸¤ä¸ªå±æ€§æºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;StandardServletEnvironment&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Webåº”ç”¨ç¨‹åºï¼ˆåŸºäºServletï¼‰&lt;/td&gt;
&lt;td&gt;ç»§æ‰¿è‡ª &lt;code&gt;StandardEnvironment&lt;/code&gt;ï¼Œå¹¶é¢å¤–å¢åŠ äº† &lt;strong&gt;&lt;code&gt;servletConfigInitParams&lt;/code&gt;&lt;/strong&gt;ï¼ˆServleté…ç½®å‚æ•°ï¼‰å’Œ &lt;strong&gt;&lt;code&gt;servletContextInitParams&lt;/code&gt;&lt;/strong&gt;ï¼ˆServletä¸Šä¸‹æ–‡å‚æ•°ï¼‰ç­‰å±æ€§æºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;MockEnvironment&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•å…ƒæµ‹è¯•&lt;/td&gt;
&lt;td&gt;ç”¨äºæ¨¡æ‹Ÿç¯å¢ƒï¼Œå¯ä»¥æ–¹ä¾¿åœ°è®¾ç½®å’Œæ“æ§å±æ€§ï¼Œè€Œä¸ä¾èµ–äºçœŸå®çš„ç³»ç»Ÿç¯å¢ƒã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å®é™…åº”ç”¨ä¸æœ€ä½³å®è·µ-1"&gt;ğŸ’» å®é™…åº”ç”¨ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;h4 id="1-å¤šç¯å¢ƒé…ç½®-1"&gt;1. å¤šç¯å¢ƒé…ç½®
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯ ConfigurableEnvironment æœ€ç»å…¸çš„åº”ç”¨ã€‚é€šè¿‡åœ¨ä»£ç ä¸­è®¾ç½®ä¸åŒçš„æ´»åŠ¨é…ç½®æ–‡ä»¶ï¼Œæ¥åŠ è½½å¯¹åº”ç¯å¢ƒçš„é…ç½®ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Configuration
public class AppConfig {
@Autowired
private ConfigurableEnvironment environment;
@Bean
@Profile(&amp;#34;dev&amp;#34;) // æ­¤Beanä»…åœ¨ &amp;#34;dev&amp;#34; é…ç½®æ–‡ä»¶æ¿€æ´»æ—¶åˆ›å»º
public DataSource devDataSource() {
return new EmbeddedDatabaseBuilder().setType(EmbeddedDatabaseType.H2).build();
}
@Bean
@Profile(&amp;#34;prod&amp;#34;) // æ­¤Beanä»…åœ¨ &amp;#34;prod&amp;#34; é…ç½®æ–‡ä»¶æ¿€æ´»æ—¶åˆ›å»º
public DataSource prodDataSource() {
// ç”Ÿäº§ç¯å¢ƒçš„æ•°æ®æºé…ç½®
// å¯ä»¥ä»ç¯å¢ƒä¸­è¯»å–JDBC URLç­‰å‚æ•°
String url = environment.getProperty(&amp;#34;spring.datasource.url&amp;#34;);
// ... åˆ›å»ºå¹¶è¿”å›ç”Ÿäº§æ•°æ®æº
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="2-åŠ¨æ€é…ç½®æ›´æ–°-1"&gt;2. åŠ¨æ€é…ç½®æ›´æ–°
&lt;/h4&gt;&lt;p&gt;åˆ©ç”¨å…¶å¯å˜çš„ç‰¹æ€§ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹é…ç½®ï¼Œè¿™åœ¨å®ç°é…ç½®çƒ­åŠ è½½ç­‰é«˜çº§åŠŸèƒ½æ—¶éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Service
public class DynamicConfigService {
@Autowired
private ConfigurableEnvironment environment;
public void updateProperty(String key, String value) {
MutablePropertySources sources = environment.getPropertySources();
// æŸ¥æ‰¾æˆ–åˆ›å»ºä¸€ä¸ªåä¸º&amp;#34;dynamicSource&amp;#34;çš„å¯å†™å±æ€§æº
MapPropertySource dynamicSource = (MapPropertySource) sources.get(&amp;#34;dynamicSource&amp;#34;);
if (dynamicSource == null) {
Map&amp;lt;String, Object&amp;gt; map = new HashMap&amp;lt;&amp;gt;();
dynamicSource = new MapPropertySource(&amp;#34;dynamicSource&amp;#34;, map);
sources.addFirst(dynamicSource); // æ·»åŠ åˆ°æœ€å‰ä»¥æ‹¥æœ‰æœ€é«˜ä¼˜å…ˆçº§
}
// æ›´æ–°å±æ€§
dynamicSource.getSource().put(key, value);
// æ³¨æ„ï¼šæ­¤æ“ä½œä¸ä¼šè‡ªåŠ¨æ›´æ–°å·²åˆå§‹åŒ–çš„å•ä¾‹Beanä¸­é€šè¿‡@Valueæ³¨å…¥çš„å€¼ï¼Œé€šå¸¸éœ€è¦é…åˆ@RefreshScopeç­‰æœºåˆ¶ã€‚
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="3-è‡ªå®šä¹‰å±æ€§æº-1"&gt;3. è‡ªå®šä¹‰å±æ€§æº
&lt;/h4&gt;&lt;p&gt;ä½ å¯ä»¥é›†æˆä»»ä½•ä½ æƒ³è¦çš„é…ç½®æ¥æºï¼Œæ¯”å¦‚ä»æ•°æ®åº“ã€è¿œç¨‹é…ç½®ä¸­å¿ƒï¼ˆå¦‚Apolloã€Nacosï¼‰è¯»å–é…ç½®ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ä¸€ä¸ªç®€å•çš„ä»æ•°æ®åº“è¯»å–é…ç½®çš„å±æ€§æºç¤ºä¾‹
public class DatabasePropertySource extends PropertySource&amp;lt;DataSource&amp;gt; {
public DatabasePropertySource(String name, DataSource dataSource) {
super(name, dataSource);
}
@Override
public Object getProperty(String key) {
// å®ç°ä»æ•°æ®åº“æŸ¥è¯¢é…ç½®çš„é€»è¾‘
try (Connection conn = getSource().getConnection();
PreparedStatement stmt = conn.prepareStatement(&amp;#34;SELECT value FROM config_table WHERE key = ?&amp;#34;)) {
stmt.setString(1, key);
ResultSet rs = stmt.executeQuery();
return rs.next() ? rs.getString(&amp;#34;value&amp;#34;) : null;
} catch (SQLException e) {
throw new RuntimeException(&amp;#34;Failed to read property from database&amp;#34;, e);
}
}
}
// æ³¨å†Œè‡ªå®šä¹‰å±æ€§æºï¼ˆé€šå¸¸åœ¨ApplicationContextInitializeræˆ–EnvironmentPostProcessorä¸­ï¼‰
environment.getPropertySources().addLast(new DatabasePropertySource(&amp;#34;dbPropertySource&amp;#34;, dataSource));
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å¸¸è§é—®é¢˜ä¸æŠ€å·§-1"&gt;âš ï¸ å¸¸è§é—®é¢˜ä¸æŠ€å·§
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å±æ€§è¦†ç›–ä¸ä¼˜å…ˆçº§&lt;/strong&gt;ï¼šç‰¢è®°å±æ€§æºçš„é¡ºåºå°±æ˜¯ä¼˜å…ˆçº§ã€‚å½“ä½ å‘ç°è·å–çš„å±æ€§å€¼ä¸æ˜¯é¢„æœŸå€¼æ—¶ï¼Œæ£€æŸ¥ä¸€ä¸‹å±æ€§æºçš„é¡ºåºï¼Œå¯èƒ½æ˜¯é«˜ä¼˜å…ˆçº§çš„æºè¦†ç›–äº†ä½ä¼˜å…ˆçº§æºçš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®ç”Ÿæ•ˆæ—¶æœº&lt;/strong&gt;ï¼šåœ¨Spring Bootåº”ç”¨ä¸­ï¼Œå¦‚æœä½ æƒ³é€šè¿‡ä»£ç ï¼ˆå¦‚&lt;code&gt;setActiveProfiles&lt;/code&gt;ï¼‰è®¾ç½®é…ç½®æ–‡ä»¶ï¼ŒåŠ¡å¿…ç¡®ä¿è¯¥æ“ä½œåœ¨&lt;code&gt;ApplicationContext&lt;/code&gt;çš„&lt;code&gt;refresh()&lt;/code&gt;æ–¹æ³•è°ƒç”¨ä¹‹å‰å®Œæˆã€‚ä¸€ä¸ªå¸¸è§çš„åšæ³•æ˜¯å®ç°&lt;code&gt;ApplicationContextInitializer&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å ä½ç¬¦è§£æå™¨é…åˆ&lt;/strong&gt;ï¼šè¦è®©&lt;code&gt;@Value(&amp;quot;${property.name}&amp;quot;)&lt;/code&gt;è¿™æ ·çš„æ³¨è§£ç”Ÿæ•ˆï¼Œä½ éœ€è¦é…ç½®ä¸€ä¸ª&lt;code&gt;PropertySourcesPlaceholderConfigurer&lt;/code&gt;ï¼Œå®ƒä¼šåˆ©ç”¨ConfigurableEnvironmentæ¥è§£æå ä½ç¬¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ConfigurableEnvironment æ˜¯ Spring æ¡†æ¶ç¯å¢ƒæŠ½è±¡çš„æ ¸å¿ƒã€‚å®ƒé€šè¿‡&lt;strong&gt;å±æ€§æºï¼ˆPropertySourcesï¼‰&lt;strong&gt;å’Œ&lt;/strong&gt;é…ç½®æ–‡ä»¶ï¼ˆProfilesï¼‰&lt;/strong&gt; è¿™ä¸¤å¤§æ”¯æŸ±ï¼Œä¸ºä½ æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„é…ç½®ç®¡ç†èƒ½åŠ›ã€‚æ— è®ºæ˜¯å¤„ç†ç®€å•çš„å¤šç¯å¢ƒé…ç½®ï¼Œè¿˜æ˜¯å®ç°å¤æ‚çš„åŠ¨æ€é…ç½®æ›´æ–°å’Œè‡ªå®šä¹‰é…ç½®æºï¼Œç†è§£å¹¶å–„ç”¨ ConfigurableEnvironment éƒ½æ˜¯å…³é”®ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£å¹¶åœ¨å®é™…é¡¹ç›®ä¸­æœ‰æ•ˆè¿ç”¨ ConfigurableEnvironmentã€‚&lt;/p&gt;
&lt;h2 id="applicationcontextfactory"&gt;ApplicationContextFactory
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ApplicationContextFactory&lt;/code&gt;æ˜¯ Spring Boot ä¸­ä¸€ä¸ªè´Ÿè´£&lt;strong&gt;æ ¹æ®åº”ç”¨ç±»å‹åˆ›å»ºç›¸åº”åº”ç”¨ä¸Šä¸‹æ–‡&lt;/strong&gt;çš„æ ¸å¿ƒå·¥å‚æ¥å£ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹è¡¨æ¦‚æ‹¬äº†å®ƒçš„æ ¸å¿ƒä¿¡æ¯ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th style="text-align: left"&gt;æ ¸å¿ƒè¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ ¹æ® &lt;code&gt;WebApplicationType&lt;/code&gt; åˆ›å»ºé€‚åˆçš„ &lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;ï¼Œå®ç°åº”ç”¨ä¸Šä¸‹æ–‡åˆ›å»ºçš„&lt;strong&gt;è§£è€¦&lt;/strong&gt;ä¸&lt;strong&gt;å¯æ‰©å±•&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;æ ¸å¿ƒæ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;ConfigurableApplicationContext create(WebApplicationType webApplicationType)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;é»˜è®¤å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;DefaultApplicationContextFactory&lt;/code&gt;ï¼Œé€šè¿‡ SPI æœºåˆ¶ä» &lt;code&gt;spring.factories&lt;/code&gt; åŠ è½½å€™é€‰å·¥å‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;å†…ç½®å·¥å‚&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;AnnotationConfigServletWebServerApplicationContext.Factory&lt;/code&gt;ï¼ˆServlet Webåº”ç”¨ï¼‰ã€&lt;code&gt;AnnotationConfigReactiveWebServerApplicationContext.Factory&lt;/code&gt;ï¼ˆReactive Webåº”ç”¨ï¼‰ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;æ‰©å±•æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;å®ç° &lt;code&gt;ApplicationContextFactory&lt;/code&gt; æ¥å£ï¼Œå¹¶åœ¨ &lt;code&gt;META-INF/spring.factories&lt;/code&gt; ä¸­æ³¨å†Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸æ¥å£è®¾è®¡"&gt;ğŸ”§ æ ¸å¿ƒåŠŸèƒ½ä¸æ¥å£è®¾è®¡
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ApplicationContextFactory&lt;/code&gt;æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå…¶æ ¸å¿ƒæ–¹æ³•æ˜¯ &lt;code&gt;create&lt;/code&gt;ï¼Œå®ƒæ ¹æ®ä¼ å…¥çš„ &lt;code&gt;WebApplicationType&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;SERVLET&lt;/code&gt;ã€&lt;code&gt;REACTIVE&lt;/code&gt;æˆ– &lt;code&gt;NONE&lt;/code&gt;ï¼‰æ¥åˆ›å»ºå¯¹åº”çš„ &lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;å®ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡ï¼Œè¯¥æ¥å£è¿˜æä¾›äº†è·å–å’Œåˆ›å»º &lt;code&gt;ConfigurableEnvironment&lt;/code&gt;ï¼ˆç¯å¢ƒï¼‰çš„é»˜è®¤æ–¹æ³•ï¼Œä½“ç°äº†ç¯å¢ƒä¸ä¸Šä¸‹æ–‡ç±»å‹çš„å…³è”æ€§ã€‚&lt;/p&gt;
&lt;h3 id="-é»˜è®¤å®ç°ä¸åˆ›å»ºæµç¨‹"&gt;ğŸ“œ é»˜è®¤å®ç°ä¸åˆ›å»ºæµç¨‹
&lt;/h3&gt;&lt;p&gt;Spring Boot çš„é»˜è®¤åˆ›å»ºé€»è¾‘ä¸»è¦ç”± &lt;code&gt;DefaultApplicationContextFactory&lt;/code&gt;æ‰¿æ‹…ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;SPIæœºåˆ¶åŠ è½½&lt;/strong&gt;ï¼š&lt;code&gt;DefaultApplicationContextFactory&lt;/code&gt;ä¼šé€šè¿‡ &lt;code&gt;SpringFactoriesLoader&lt;/code&gt;ä»ç±»è·¯å¾„ä¸‹æ‰€æœ‰ &lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶ä¸­åŠ è½½ &lt;code&gt;ApplicationContextFactory&lt;/code&gt;çš„å®ç°ç±»ã€‚ åœ¨ Spring Boot ä¸­ï¼Œé»˜è®¤ä¼šåŠ è½½ &lt;code&gt;AnnotationConfigServletWebServerApplicationContext.Factory&lt;/code&gt;å’Œ &lt;code&gt;AnnotationConfigReactiveWebServerApplicationContext.Factory&lt;/code&gt;ç­‰å€™é€‰å·¥å‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éå†å€™é€‰å·¥å‚&lt;/strong&gt;ï¼šæ ¹æ® &lt;code&gt;WebApplicationType&lt;/code&gt;ï¼ŒæŒ‰é¡ºåºè°ƒç”¨æ¯ä¸ªå€™é€‰å·¥å‚çš„ &lt;code&gt;create&lt;/code&gt;æ–¹æ³•ã€‚ä¸€æ—¦æŸä¸ªå·¥å‚è¿”å›äº†éç©ºçš„ &lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;ï¼Œå°±å°†å…¶ä½œä¸ºç»“æœè¿”å›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤é™çº§ç­–ç•¥&lt;/strong&gt;ï¼šå¦‚æœæ‰€æœ‰å€™é€‰å·¥å‚éƒ½æ— æ³•åˆ›å»ºåˆé€‚çš„åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„ &lt;code&gt;AnnotationConfigApplicationContext::new&lt;/code&gt;ä½œä¸ºé™çº§æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¯¹äº &lt;code&gt;WebApplicationType.SERVLET&lt;/code&gt;ç±»å‹ï¼Œæœ€ç»ˆä¼šç”± &lt;code&gt;ServletWebServerApplicationContextFactory&lt;/code&gt;åˆ›å»º &lt;code&gt;AnnotationConfigServletWebServerApplicationContext&lt;/code&gt;å®ä¾‹ã€‚ åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œä¼šåŒæ—¶åˆå§‹åŒ– IoC å®¹å™¨ï¼ˆå¦‚ &lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;ï¼‰å’Œå¿…è¦çš„ Bean åç½®å¤„ç†å™¨ï¼ˆå¦‚ &lt;code&gt;ConfigurationClassPostProcessor&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="-å†…ç½®çš„-applicationcontext-ç±»å‹"&gt;ğŸŒ å†…ç½®çš„ ApplicationContext ç±»å‹
&lt;/h3&gt;&lt;p&gt;Spring Boot ä¸ºä¸åŒçš„åº”ç”¨æ¨¡å¼æä¾›äº†ç›¸åº”çš„åº”ç”¨ä¸Šä¸‹æ–‡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§ç±»å‹åŠå…¶å¯¹åº”çš„å·¥å‚ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åº”ç”¨ç±»å‹&lt;/th&gt;
&lt;th&gt;åº”ç”¨ä¸Šä¸‹æ–‡å®ç°&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Servlet Web åº”ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;AnnotationConfigServletWebServerApplicationContext&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒæ³¨è§£é…ç½®ï¼Œå†…åµŒ Servlet Web æœåŠ¡å™¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Reactive Web åº”ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;AnnotationConfigReactiveWebServerApplicationContext&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒæ³¨è§£é…ç½®ï¼Œç”¨äºå“åº”å¼ Web åº”ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é Web åº”ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;AnnotationConfigApplicationContext&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ‡å‡†çš„æ³¨è§£é…ç½®åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œé€‚ç”¨äºæ§åˆ¶å°åº”ç”¨ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¦‚ä½•è‡ªå®šä¹‰ä¸æ‰©å±•"&gt;ğŸ› ï¸ å¦‚ä½•è‡ªå®šä¹‰ä¸æ‰©å±•
&lt;/h3&gt;&lt;p&gt;ä½ å¯ä»¥é€šè¿‡å®ç°è‡ªå·±çš„ &lt;code&gt;ApplicationContextFactory&lt;/code&gt;æ¥å®Œå…¨æ§åˆ¶åº”ç”¨ä¸Šä¸‹æ–‡çš„åˆ›å»ºè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æ¥å£&lt;/strong&gt;ï¼šåˆ›å»ºä¸€ä¸ªç±»å®ç° &lt;code&gt;ApplicationContextFactory&lt;/code&gt;æ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨å†Œå®ç°&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;src/main/resources/META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶ä¸­å£°æ˜ä½ çš„å®ç°ç±»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;org.springframework.boot.ApplicationContextFactory=com.example.MyCustomApplicationContextFactory
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Spring Boot çš„ &lt;code&gt;ApplicationContextFactory&lt;/code&gt;ä¹Ÿæä¾›äº†ä¾¿æ·çš„é™æ€å·¥å‚æ–¹æ³•ï¼Œç”¨äºå¿«é€Ÿåˆ›å»ºåŸºäºç‰¹å®šç±»æˆ–ä¾›åº”å•†çš„å·¥å‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ApplicationContextFactory ofContextClass(Class&amp;lt;? extends ConfigurableApplicationContext&amp;gt; contextClass)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ApplicationContextFactory of(Supplier&amp;lt;ConfigurableApplicationContext&amp;gt; supplier)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-åœ¨å¯åŠ¨æµç¨‹ä¸­çš„è§’è‰²"&gt;âš™ï¸ åœ¨å¯åŠ¨æµç¨‹ä¸­çš„è§’è‰²
&lt;/h3&gt;&lt;p&gt;åœ¨ &lt;code&gt;SpringApplication.run()&lt;/code&gt;æ–¹æ³•ä¸­ï¼Œ&lt;code&gt;ApplicationContextFactory&lt;/code&gt;çš„è°ƒç”¨æ˜¯åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡çš„å…³é”®ä¸€æ­¥ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class SpringApplication {
protected ConfigurableApplicationContext createApplicationContext() {
// å§”æ‰˜ç»™ applicationContextFactory æ ¹æ®åº”ç”¨ç±»å‹åˆ›å»ºä¸Šä¸‹æ–‡
return this.applicationContextFactory.create(this.webApplicationType);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªæ–¹æ³•åœ¨å‡†å¤‡å¥½ç¯å¢ƒï¼ˆ&lt;code&gt;Environment&lt;/code&gt;ï¼‰ä¹‹åã€åˆ·æ–°ä¸Šä¸‹æ–‡ï¼ˆ&lt;code&gt;refreshContext&lt;/code&gt;ï¼‰ä¹‹å‰è¢«è°ƒç”¨ï¼Œç¡®ä¿äº†åº”ç”¨ä¸Šä¸‹æ–‡èƒ½å¤Ÿæ ¹æ®å·²ç¡®å®šçš„åº”ç”¨ç±»å‹å’Œç¯å¢ƒè¿›è¡Œåˆ›å»ºå’Œåç»­é…ç½®ã€‚&lt;/p&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ApplicationContextFactory&lt;/code&gt;æ˜¯ Spring Boot å¯åŠ¨æµç¨‹ä¸­ä¸€ä¸ªç²¾å·§çš„æŠ½è±¡ï¼Œå®ƒå°†&lt;strong&gt;åº”ç”¨ç±»å‹çš„åˆ¤æ–­&lt;/strong&gt;ä¸&lt;strong&gt;å…·ä½“åº”ç”¨ä¸Šä¸‹æ–‡çš„å®ä¾‹åŒ–&lt;/strong&gt;è§£è€¦ã€‚é€šè¿‡ SPI æœºåˆ¶å’Œé»˜è®¤å®ç°ï¼ŒSpring Boot æä¾›äº†å¼€ç®±å³ç”¨çš„å¼ºå¤§åŠŸèƒ½ï¼ŒåŒæ—¶ä¿ç•™äº†é«˜åº¦çš„å¯æ‰©å±•æ€§ï¼Œå…è®¸å¼€å‘è€…æ ¹æ®ç‰¹æ®Šéœ€æ±‚å®šåˆ¶åº”ç”¨ä¸Šä¸‹æ–‡çš„åˆ›å»ºé€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ &lt;code&gt;ApplicationContextFactory&lt;/code&gt;åœ¨ Spring Boot ç”Ÿæ€ç³»ç»Ÿä¸­çš„é‡è¦ä½œç”¨ã€‚&lt;/p&gt;
&lt;h2 id="servlet--reactive"&gt;SERVLET &amp;amp; REACTIVE
&lt;/h2&gt;&lt;p&gt;SERVLET å’Œ REACTIVE æ˜¯ Spring Boot ä¸­æ„å»º Web åº”ç”¨çš„ä¸¤ç§æ ¸å¿ƒæ¨¡å‹ï¼Œå®ƒä»¬åœ¨è®¾è®¡å“²å­¦ã€æ€§èƒ½ç‰¹æ€§å’Œé€‚ç”¨åœºæ™¯ä¸Šæœ‰ç€æ ¹æœ¬çš„ä¸åŒã€‚ä¸ºäº†å¸®ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ¸…æ™°åœ°å¯¹æ¯”äº†å®ƒä»¬çš„æ ¸å¿ƒå·®å¼‚ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;SERVLET (Spring MVC)&lt;/th&gt;
&lt;th&gt;REACTIVE (Spring WebFlux)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–ç¨‹æ¨¡å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åŒæ­¥é˜»å¡ I/O&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¼‚æ­¥éé˜»å¡ I/O&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹æ¨¡å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯ä¸ªè¯·æ±‚å ç”¨ä¸€ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹æ± ï¼‰&lt;/td&gt;
&lt;td&gt;äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰ï¼Œå°‘é‡çº¿ç¨‹å¤„ç†å¤§é‡è¯·æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒä¾èµ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;spring-boot-starter-web&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;spring-boot-starter-webflux&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é»˜è®¤æœåŠ¡å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Tomcat&lt;/td&gt;
&lt;td&gt;Netty&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºæ¶ˆè€—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ï¼ˆä¸å¹¶å‘çº¿ç¨‹æ•°æ­£ç›¸å…³ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒä½ï¼ˆçº¿ç¨‹å¤ç”¨ç‡æé«˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å—é™äºçº¿ç¨‹æ± å¤§å°&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ä¸‹æ›´å…·ä¼˜åŠ¿ï¼Œæ”¯æŒä¸‡çº§è¿æ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–ç¨‹å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹ç®€å•ç›´è§‚ï¼Œæ˜“äºè°ƒè¯•&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ç†è§£å“åº”å¼ç¼–ç¨‹èŒƒå¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èƒŒå‹æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åŸç”Ÿæ”¯æŒ&lt;/strong&gt;ï¼Œæ˜¯æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«è¯¦è§£"&gt;ğŸ’¡ æ ¸å¿ƒåŒºåˆ«è¯¦è§£
&lt;/h3&gt;&lt;h4 id="1-å·¥ä½œåŸç†ä¸çº¿ç¨‹æ¨¡å‹"&gt;1. å·¥ä½œåŸç†ä¸çº¿ç¨‹æ¨¡å‹
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯ä¸¤è€…æœ€æ ¹æœ¬çš„åŒºåˆ«ï¼Œç›´æ¥å†³å®šäº†å…¶æ€§èƒ½å’Œèµ„æºä½¿ç”¨æ¨¡å¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;SERVLETï¼ˆåŒæ­¥é˜»å¡ï¼‰&lt;/strong&gt;ï¼šåŸºäºç»å…¸çš„ &lt;strong&gt;â€œä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹â€&lt;/strong&gt; æ¨¡å‹ã€‚å½“è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œå®¹å™¨ï¼ˆå¦‚Tomcatï¼‰ä¼šä»çº¿ç¨‹æ± ä¸­åˆ†é…ä¸€ä¸ªä¸“ç”¨çº¿ç¨‹æ¥å¤„ç†è¯¥è¯·æ±‚ã€‚åœ¨è¿™ä¸ªçº¿ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°I/Oæ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ã€è°ƒç”¨å…¶ä»–æœåŠ¡ï¼‰ï¼Œçº¿ç¨‹ä¼š&lt;strong&gt;è¢«é˜»å¡&lt;/strong&gt;ï¼Œç›´åˆ°æ”¶åˆ°å“åº”åæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚è¿™æ„å‘³ç€åœ¨I/Oç­‰å¾…æœŸé—´ï¼Œå®è´µçš„çº¿ç¨‹èµ„æºå¤„äºé—²ç½®çŠ¶æ€ï¼Œæ— æ³•å¤„ç†å…¶ä»–è¯·æ±‚ã€‚ä¸ºäº†åº”å¯¹é«˜å¹¶å‘ï¼Œå°±éœ€è¦æ‰©å¤§çº¿ç¨‹æ± ï¼Œä½†çº¿ç¨‹æœ¬èº«æ˜¯æ˜‚è´µçš„èµ„æºï¼Œå¤§é‡çº¿ç¨‹ä¼šå¯¼è‡´å·¨å¤§çš„å†…å­˜å¼€é”€å’Œé¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;REACTIVEï¼ˆå¼‚æ­¥éé˜»å¡ï¼‰&lt;/strong&gt;ï¼šåŸºäº&lt;strong&gt;äº‹ä»¶é©±åŠ¨&lt;/strong&gt;å’Œ&lt;strong&gt;å‡½æ•°å¼ç¼–ç¨‹&lt;/strong&gt;æ€æƒ³ã€‚å®ƒé‡‡ç”¨&lt;strong&gt;äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰&lt;/strong&gt; æœºåˆ¶ï¼Œä½¿ç”¨å°‘é‡ï¼ˆé€šå¸¸ä¸ºCPUæ ¸å¿ƒæ•°ï¼‰çº¿ç¨‹æ¥å¤„ç†å¤§é‡çš„ç½‘ç»œè¿æ¥ã€‚å½“I/Oæ“ä½œå‘ç”Ÿæ—¶ï¼Œä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œè€Œæ˜¯æ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°åç«‹å³è¿”å›ã€‚å½“æ•°æ®å°±ç»ªæ—¶ï¼Œäº‹ä»¶å¾ªç¯ä¼šè§¦å‘å›è°ƒå‡½æ•°è¿›è¡Œåç»­å¤„ç†ã€‚è¿™æ ·ï¼Œæœ‰é™çš„çº¿ç¨‹èµ„æºå§‹ç»ˆåœ¨å¿™ç¢ŒçŠ¶æ€ï¼Œè€Œä¸æ˜¯åœ¨ç­‰å¾…ï¼Œä»è€Œæå¤§åœ°æå‡äº†èµ„æºåˆ©ç”¨ç‡å’Œç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-æŠ€æœ¯æ ˆä¸ä¾èµ–"&gt;2. æŠ€æœ¯æ ˆä¸ä¾èµ–
&lt;/h4&gt;&lt;p&gt;ä½ çš„é€‰æ‹©ä¼šç›´æ¥å†³å®šé¡¹ç›®çš„åŸºç¡€æŠ€æœ¯æ ˆã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;SERVLET&lt;/strong&gt;ï¼šå¼•å…¥ &lt;code&gt;spring-boot-starter-web&lt;/code&gt;ä¾èµ–ï¼Œé»˜è®¤ä¼šåµŒå…¥ &lt;strong&gt;Tomcat&lt;/strong&gt; ä½œä¸ºServletå®¹å™¨ã€‚ä½ ä¹Ÿå¯ä»¥è½»æ¾åœ°æ›¿æ¢ä¸ºJettyæˆ–Undertowã€‚å…¶ç¼–ç¨‹æ¨¡å‹å»ºç«‹åœ¨å¤§å®¶éå¸¸ç†Ÿæ‚‰çš„ &lt;code&gt;@Controller&lt;/code&gt;, &lt;code&gt;@RequestMapping&lt;/code&gt;ç­‰æ³¨è§£ä¹‹ä¸Šï¼Œå¼€å‘æ¨¡å¼å›ºå®šä¸”æˆç†Ÿã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;REACTIVE&lt;/strong&gt;ï¼šéœ€è¦å¼•å…¥ &lt;code&gt;spring-boot-starter-webflux&lt;/code&gt;ä¾èµ–ï¼Œé»˜è®¤ä½¿ç”¨ &lt;strong&gt;Netty&lt;/strong&gt; ä½œä¸ºæœåŠ¡å™¨ã€‚å…¶æ ¸å¿ƒæ˜¯ &lt;strong&gt;Reactor&lt;/strong&gt; åº“ï¼Œä½ éœ€è¦ä½¿ç”¨ &lt;code&gt;Mono&lt;/code&gt;å’Œ &lt;code&gt;Flux&lt;/code&gt;è¿™ä¸¤ç§ä»£è¡¨0-1ä¸ªå’Œ0-Nä¸ªå…ƒç´ çš„å¼‚æ­¥æ•°æ®æµç±»å‹æ¥æ„å»ºä½ çš„ä»£ç ã€‚å®ƒæ”¯æŒä¸¤ç§ç¼–ç¨‹æ¨¡å‹ï¼šç±»MVCçš„æ³¨è§£æ¨¡å‹å’Œæ›´çµæ´»çš„å‡½æ•°å¼è·¯ç”±æ¨¡å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-èƒŒå‹backpressureæœºåˆ¶"&gt;3. èƒŒå‹ï¼ˆBackpressureï¼‰æœºåˆ¶
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯å“åº”å¼ç¼–ç¨‹ç‹¬æœ‰çš„é‡è¦ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;REACTIVE æ”¯æŒèƒŒå‹&lt;/strong&gt;ï¼šåœ¨æ•°æ®æµå¤„ç†ä¸­ï¼Œå½“ç”Ÿäº§è€…çš„æ•°æ®äº§ç”Ÿé€Ÿåº¦è¿œå¿«äºæ¶ˆè´¹è€…çš„å¤„ç†é€Ÿåº¦æ—¶ï¼ŒèƒŒå‹æœºåˆ¶å…è®¸æ¶ˆè´¹è€…&lt;strong&gt;å‘ä¸Šæ¸¸å‘å‡ºä¿¡å·ï¼Œå‘ŠçŸ¥â€œæˆ‘å¤„ç†ä¸è¿‡æ¥äº†ï¼Œè¯·æ…¢ä¸€ç‚¹â€&lt;/strong&gt;ã€‚è¿™èƒ½æœ‰æ•ˆåœ°é˜²æ­¢å¿«é€Ÿæ•°æ®æºæ·¹æ²¡æ¶ˆè´¹è€…ï¼Œä»è€Œæå‡ç³»ç»Ÿçš„å¼¹æ€§å’Œç¨³å®šæ€§ã€‚SERVLETæ¨¡å‹ä¸å…·å¤‡è¿™ç§èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©"&gt;ğŸ¯ å¦‚ä½•é€‰æ‹©ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;äº†è§£äº†åŒºåˆ«åï¼Œå…³é”®åœ¨äºå¦‚ä½•ä¸ºä½ çš„é¡¹ç›®åšå‡ºæ­£ç¡®é€‰æ‹©ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹© SERVLET (Spring MVC) çš„æƒ…å†µ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å›¢é˜Ÿç†Ÿæ‚‰åº¦&lt;/strong&gt;ï¼šå›¢é˜Ÿå¯¹Servletæ¨¡å‹å’ŒåŒæ­¥ç¼–ç¨‹éå¸¸ç†Ÿæ‚‰ï¼Œå­¦ä¹ æˆæœ¬ä½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡¹ç›®éœ€æ±‚&lt;/strong&gt;ï¼šå¼€å‘çš„æ˜¯ä¼ ç»Ÿçš„CRUDåº”ç”¨ã€å†…éƒ¨ç®¡ç†ç³»ç»Ÿæˆ–å¹¶å‘è¦æ±‚ä¸é«˜çš„RESTful APIã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæ€ä¾èµ–&lt;/strong&gt;ï¼šé¡¹ç›®ä¸¥é‡ä¾èµ–ä¸é˜»å¡å¼I/Oç´§å¯†é›†æˆçš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚æŸäº›ä¼ ç»Ÿçš„JPAå®ç°æˆ–SDKï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€å•æ€§ä¼˜å…ˆ&lt;/strong&gt;ï¼šé¡¹ç›®å‘¨æœŸç´§ï¼Œè¿½æ±‚å¼€å‘æ•ˆç‡ã€å¯ç»´æŠ¤æ€§å’Œæ˜“äºè°ƒè¯•ï¼Œæ­¤æ—¶SERVLETçš„ç®€å•ç›´è§‚æ˜¯å·¨å¤§ä¼˜åŠ¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹© REACTIVE (Spring WebFlux) çš„æƒ…å†µ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘ä¸ä½å»¶è¿Ÿ&lt;/strong&gt;ï¼šåº”ç”¨éœ€è¦å¤„ç†å¤§é‡å¹¶å‘è¿æ¥ï¼ˆå¦‚æ¶ˆæ¯æ¨é€ã€èŠå¤©å®¤ã€å®æ—¶æ•°æ®æµå¤„ç†ï¼‰ï¼Œå¹¶ä¸”å¯¹å“åº”å»¶è¿Ÿæœ‰æé«˜è¦æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;I/Oå¯†é›†å‹åœºæ™¯&lt;/strong&gt;ï¼šç³»ç»Ÿéœ€è¦é¢‘ç¹åœ°è¿›è¡Œé«˜å»¶è¿Ÿçš„I/Oæ“ä½œï¼ˆå¦‚è°ƒç”¨å¤šä¸ªå¾®æœåŠ¡ï¼‰ï¼Œå¹¶ä¸”å¸Œæœ›ç”¨æœ€å°‘çš„èµ„æºæ¥æ”¯æ’‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµå¼æ•°æ®å¤„ç†&lt;/strong&gt;ï¼šéœ€è¦å¤„ç†å¦‚SSEï¼ˆServer-Sent Eventsï¼‰æˆ–WebSocketç­‰æŒç»­çš„æ•°æ®æµã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯å‰ç»æ€§&lt;/strong&gt;ï¼šå›¢é˜Ÿå¸Œæœ›å­¦ä¹ å’Œä½¿ç”¨æ›´å‰æ²¿çš„æŠ€æœ¯ï¼Œä¸ºæœªæ¥åšå‡†å¤‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-éœ€è¦æ³¨æ„çš„è¯¯åŒº"&gt;âš ï¸ éœ€è¦æ³¨æ„çš„è¯¯åŒº
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;REACTIVE å¹¶éæ€»æ˜¯æ›´å¿«&lt;/strong&gt;ï¼šåœ¨ä½å¹¶å‘åœºæ™¯ä¸‹ï¼Œä¸¤è€…çš„æ€§èƒ½å·®å¼‚å¯èƒ½ä¸æ˜æ˜¾ã€‚REACTIVEçš„ä¼˜åŠ¿åªæœ‰åœ¨é«˜å¹¶å‘ã€é«˜I/Oç­‰å¾…çš„åœºæ™¯ä¸‹æ‰èƒ½å……åˆ†å‘æŒ¥ã€‚å¯¹äºCPUå¯†é›†å‹ä»»åŠ¡ï¼ŒREACTIVEå¹¶æ— ä¼˜åŠ¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;â€œå…¨æ ˆå“åº”å¼â€æ‰æœ‰æ„ä¹‰&lt;/strong&gt;ï¼šä»…ä»…åœ¨Webå±‚ä½¿ç”¨REACTIVEï¼Œè€Œæ•°æ®è®¿é—®å±‚ï¼ˆå¦‚JDBCï¼‰ä»ç„¶æ˜¯é˜»å¡çš„ï¼Œé‚£ä¹ˆæ•´ä¸ªé“¾æ¡æœ€ç»ˆè¿˜æ˜¯ä¼šè¢«é˜»å¡æ“ä½œæ‹–ç´¯ï¼Œæ— æ³•å‘æŒ¥éé˜»å¡çš„å¨åŠ›ã€‚çœŸæ­£çš„æ”¶ç›Šæ¥è‡ªäºä»æ§åˆ¶å™¨åˆ°æ•°æ®åº“é©±åŠ¨ç¨‹åºçš„&lt;strong&gt;å…¨é“¾è·¯éé˜»å¡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;strong&gt;SERVLETåƒæ˜¯ä¸€ä¸ªæ¥å¾…èƒ½åŠ›å›ºå®šã€æ¯ä¸ªå®¢æˆ·é…ä¸€ä¸ªä¸“å±ç®¡å®¶çš„é¤å…ï¼›è€ŒREACTIVEåˆ™åƒæ˜¯ä¸€ä¸ªç”±å°‘æ•°å‡ ä¸ªé«˜æ•ˆæœåŠ¡å‘˜é€šè¿‡æ™ºèƒ½å¯¹è®²æœºåŒæ—¶åè°ƒæœåŠ¡å¤§é‡æ¡Œå°çš„é¤å…&lt;/strong&gt;ã€‚å‰è€…ç¨³å®šå¯é ï¼Œé€‚åˆå¸¸è§„å®¢æµï¼›åè€…æ•ˆç‡æé«˜ï¼Œæ“…é•¿åº”å¯¹å®¢æµé«˜å³°ã€‚&lt;/p&gt;
&lt;p&gt;é€‰æ‹©å“ªç§æ¨¡å‹ï¼Œæœ€ç»ˆå–å†³äºä½ çš„å…·ä½“ä¸šåŠ¡éœ€æ±‚ã€å›¢é˜Ÿçš„æŠ€æœ¯å‚¨å¤‡å’Œå¯¹ç³»ç»Ÿæ‰©å±•æ€§çš„æœŸæœ›ã€‚å¯¹äºå¤§å¤šæ•°ä¼ ç»Ÿä¸šåŠ¡åº”ç”¨ï¼ŒSERVLETä¾ç„¶æ˜¯éå¸¸ç¨³å¥å’Œé«˜æ•ˆçš„é€‰æ‹©ã€‚è€Œå½“ä½ é¢ä¸´çœŸæ­£çš„é«˜å¹¶å‘ã€æµå¼æ•°æ®å¤„ç†æŒ‘æˆ˜æ—¶ï¼ŒREACTIVEå°†ä¸ºä½ æä¾›å¼ºå¤§çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„å¯¹æ¯”èƒ½å¸®åŠ©ä½ åšå‡ºæ¸…æ™°çš„æŠ€æœ¯å†³ç­–ï¼&lt;/p&gt;
&lt;h2 id="preparecontext"&gt;prepareContext
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;prepareContext&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DefaultBootstrapContext&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bootstrapContext&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ConfigurableApplicationContext&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ConfigurableEnvironment&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SpringApplicationRunListeners&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;listeners&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ApplicationArguments&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;applicationArguments&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Banner&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;printedBanner&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setEnvironment&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;postProcessApplicationContext&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addAotGeneratedInitializerIfNecessary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;initializers&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;applyInitializers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;listeners&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;contextPrepared&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bootstrapContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;properties&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isLogStartupInfo&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;logStartupInfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getParent&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;logStartupInfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;logStartupProfileInfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ConfigurableListableBeanFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;beanFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBeanFactory&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;beanFactory&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;registerSingleton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;springApplicationArguments&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;applicationArguments&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;printedBanner&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;beanFactory&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;registerSingleton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;springBootBanner&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;printedBanner&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;beanFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;instanceof&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AbstractAutowireCapableBeanFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;autowireCapableBeanFactory&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;autowireCapableBeanFactory&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setAllowCircularReferences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;properties&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isAllowCircularReferences&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;beanFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;instanceof&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DefaultListableBeanFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;listableBeanFactory&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;listableBeanFactory&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setAllowBeanDefinitionOverriding&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;properties&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isAllowBeanDefinitionOverriding&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;properties&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isLazyInitialization&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addBeanFactoryPostProcessor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LazyInitializationBeanFactoryPostProcessor&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;properties&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isKeepAlive&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addApplicationListener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KeepAlive&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addBeanFactoryPostProcessor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PropertySourceOrderingBeanFactoryPostProcessor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;AotDetector&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;useGeneratedArtifacts&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sources&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAllSources&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Assert&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;notEmpty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sources&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Sources must not be empty&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sources&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toArray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;listeners&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;contextLoaded&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ æä¾›çš„è¿™æ®µä»£ç æ˜¯ Spring Boot åº”ç”¨ä¸­å‡†å¤‡åº”ç”¨ä¸Šä¸‹æ–‡ï¼ˆ&lt;code&gt;ApplicationContext&lt;/code&gt;ï¼‰çš„æ ¸å¿ƒç¯èŠ‚ã€‚ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡å…¨å±€ï¼Œä¸‹è¡¨è¯¦ç»†è§£æäº† &lt;code&gt;prepareContext&lt;/code&gt;æ–¹æ³•çš„å…³é”®æ­¥éª¤åŠå…¶ä½œç”¨ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ­¥éª¤&lt;/th&gt;
&lt;th&gt;å…³é”®æ–¹æ³•/æ“ä½œ&lt;/th&gt;
&lt;th&gt;ä¸»è¦ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;1. ç¯å¢ƒè®¾ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;context.setEnvironment(environment)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°†å·²é…ç½®å¥½çš„ &lt;code&gt;Environment&lt;/code&gt;ï¼ˆåŒ…å«å±æ€§æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ç­‰ï¼‰è®¾ç½®åˆ°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ï¼Œç»Ÿä¸€ç¯å¢ƒé…ç½®ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;2. ä¸Šä¸‹æ–‡åç½®å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;postProcessApplicationContext(context)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯¹åº”ç”¨ä¸Šä¸‹æ–‡è¿›è¡Œåç½®å¤„ç†ï¼Œä¾‹å¦‚æ³¨å†Œ &lt;code&gt;BeanNameGenerator&lt;/code&gt;ã€è®¾ç½® &lt;code&gt;ResourceLoader&lt;/code&gt;å’Œ &lt;code&gt;ConversionService&lt;/code&gt;ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;3. æ‰§è¡Œåˆå§‹åŒ–å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;applyInitializers(context)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œæ‰€æœ‰ &lt;code&gt;ApplicationContextInitializer&lt;/code&gt;å®ç°ç±»çš„ &lt;code&gt;initialize&lt;/code&gt;æ–¹æ³•ï¼Œç”¨äºåœ¨å®¹å™¨åˆ·æ–°å‰å¯¹ä¸Šä¸‹æ–‡è¿›è¡Œè‡ªå®šä¹‰åˆå§‹åŒ–ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;4. å‘å¸ƒä¸Šä¸‹æ–‡å‡†å¤‡äº‹ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;listeners.contextPrepared(context)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‘å¸ƒ &lt;code&gt;ApplicationContextInitializedEvent&lt;/code&gt;äº‹ä»¶ï¼Œé€šçŸ¥ç›‘å¬å™¨åº”ç”¨ä¸Šä¸‹æ–‡å·²å‡†å¤‡å°±ç»ªï¼ˆä½†æ­¤æ—¶å°šæ— Beanå®šä¹‰åŠ è½½ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;5. å…³é—­å¼•å¯¼ä¸Šä¸‹æ–‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;bootstrapContext.close(context)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å…³é—­ &lt;code&gt;BootstrapContext&lt;/code&gt;ï¼Œå¹¶å°†å…¶ä¸­çš„å†…å®¹è½¬ç§»åˆ°å½“å‰çš„åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ï¼ˆè¿™æ˜¯æ–°ç‰ˆæœ¬ä»£ç ç›¸è¾ƒäºæ—§ç‰ˆæœ¬çš„ä¸€ä¸ªæ˜¾è‘—å˜åŒ–ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;6. æ‰“å°å¯åŠ¨ä¿¡æ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;logStartupInfo&lt;/code&gt;, &lt;code&gt;logStartupProfileInfo&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åœ¨æ—¥å¿—ä¸­è¾“å‡ºåº”ç”¨å¯åŠ¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¯åŠ¨ç±»ã€PIDã€è·¯å¾„ä»¥åŠæ¿€æ´»çš„é…ç½®æ–‡ä»¶ï¼ˆprofilesï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;7. æ³¨å†Œå…³é”®å•ä¾‹Bean&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;registerSingleton(&amp;quot;springApplicationArguments&amp;quot;, ...)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°†åº”ç”¨å‚æ•°ï¼ˆ&lt;code&gt;ApplicationArguments&lt;/code&gt;ï¼‰å’ŒBannerå¯¹è±¡ä½œä¸ºå•ä¾‹Beanæ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼Œä¾¿äºåç»­ä¾èµ–æ³¨å…¥ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;8. é…ç½®BeanFactory&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®å¾ªç¯å¼•ç”¨ã€Beanå®šä¹‰è¦†ç›–ç­‰å±æ€§&lt;/td&gt;
&lt;td&gt;æ ¹æ®é…ç½®å†³å®šæ˜¯å¦å…è®¸å¾ªç¯å¼•ç”¨å’ŒBeanå®šä¹‰è¦†ç›–ï¼Œå¹¶å¯èƒ½æ·»åŠ å»¶è¿Ÿåˆå§‹åŒ–ç­‰åç½®å¤„ç†å™¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;9. åŠ è½½æºæ•°æ®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;load(context, sources.toArray(...))&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°†ä¸»å¯åŠ¨ç±»ï¼ˆå³&lt;code&gt;sources&lt;/code&gt;ï¼‰åŠ è½½åˆ°å®¹å™¨ä¸­ï¼Œè§£æå…¶ä¸Šçš„æ³¨è§£ï¼ˆå¦‚&lt;code&gt;@SpringBootApplication&lt;/code&gt;ï¼‰ï¼Œå¹¶æ³¨å†Œç›¸åº”çš„Beanå®šä¹‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;10. å‘å¸ƒä¸Šä¸‹æ–‡åŠ è½½äº‹ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;listeners.contextLoaded(context)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‘å¸ƒ &lt;code&gt;ApplicationPreparedEvent&lt;/code&gt;äº‹ä»¶ï¼Œé€šçŸ¥ç›‘å¬å™¨Beanå®šä¹‰å·²åŠ è½½å®Œæˆï¼ˆä½†æ­¤æ—¶Beanå°šæœªå®ä¾‹åŒ–ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å…³é”®æ­¥éª¤è¯¦è§£"&gt;ğŸ’¡ å…³é”®æ­¥éª¤è¯¦è§£
&lt;/h3&gt;&lt;h4 id="1-ç¯å¢ƒè®¾ç½®ä¸ç¯å¢ƒç»Ÿä¸€"&gt;1. ç¯å¢ƒè®¾ç½®ä¸ç¯å¢ƒç»Ÿä¸€
&lt;/h4&gt;&lt;p&gt;è¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼Œå®ƒç¡®ä¿äº†åº”ç”¨ä¸Šä¸‹æ–‡ä½¿ç”¨çš„æ˜¯åœ¨SpringApplicationè¿è¡Œé˜¶æ®µå·²ç»åˆ›å»ºå¹¶é…ç½®å¥½çš„&lt;code&gt;Environment&lt;/code&gt;å¯¹è±¡ã€‚è¿™ä¸ª&lt;code&gt;Environment&lt;/code&gt;å¯¹è±¡å·²ç»åŒ…å«äº†ä»&lt;code&gt;application.properties&lt;/code&gt;ã€&lt;code&gt;application.yml&lt;/code&gt;ã€ç³»ç»Ÿå±æ€§ã€ç¯å¢ƒå˜é‡ç­‰æ‰€æœ‰æ¸ é“è§£æå¾—åˆ°çš„å±æ€§æºï¼ˆPropertySourcesï¼‰ã€‚é€šè¿‡&lt;code&gt;context.setEnvironment(environment)&lt;/code&gt;ï¼Œåº”ç”¨ä¸Šä¸‹æ–‡ä¸SpringApplicationä½¿ç”¨äº†å®Œå…¨ç›¸åŒçš„ç¯å¢ƒé…ç½®ï¼Œä¸ºåç»­çš„Beanåˆ›å»ºå’Œå±æ€§æ³¨å…¥å¥ å®šäº†åŸºç¡€ã€‚&lt;/p&gt;
&lt;h4 id="2-æ‰§è¡Œåˆå§‹åŒ–å™¨initializers"&gt;2. æ‰§è¡Œåˆå§‹åŒ–å™¨ï¼ˆInitializersï¼‰
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;applyInitializers(context)&lt;/code&gt;æ–¹æ³•ä¼šéå†å¹¶æ‰§è¡Œæ‰€æœ‰é€šè¿‡&lt;code&gt;spring.factories&lt;/code&gt;æœºåˆ¶åŠ è½½åˆ°çš„&lt;code&gt;ApplicationContextInitializer&lt;/code&gt;å®ç°ã€‚è¿™äº›åˆå§‹åŒ–å™¨æ˜¯Spring Bootæä¾›çš„ä¸€ä¸ª&lt;strong&gt;é‡è¦æ‰©å±•ç‚¹&lt;/strong&gt;ï¼Œå…è®¸ä½ åœ¨IoCå®¹å™¨åˆ·æ–°ä¹‹å‰ï¼Œå¯¹&lt;code&gt;ConfigurableApplicationContext&lt;/code&gt;è¿›è¡Œç¼–ç¨‹å¼çš„å®šåˆ¶ã€‚ä¾‹å¦‚ï¼Œå†…ç½®çš„&lt;code&gt;ContextIdApplicationContextInitializer&lt;/code&gt;ä¼šä¸ºåº”ç”¨ä¸Šä¸‹æ–‡è®¾ç½®ä¸€ä¸ªIDï¼Œè€Œ&lt;code&gt;ServerPortInfoApplicationContextInitializer&lt;/code&gt;åˆ™ä¼šæ³¨å†Œä¸€ä¸ªç›‘å¬å™¨æ¥è·å–å†…åµŒWebæœåŠ¡å™¨çš„å®é™…ç«¯å£ã€‚&lt;/p&gt;
&lt;h4 id="3-å¼•å¯¼ä¸Šä¸‹æ–‡çš„å…³é—­ä¸èµ„æºè½¬ç§»"&gt;3. å¼•å¯¼ä¸Šä¸‹æ–‡çš„å…³é—­ä¸èµ„æºè½¬ç§»
&lt;/h4&gt;&lt;p&gt;ä½ æä¾›çš„ä»£ç ä¸­&lt;code&gt;bootstrapContext.close(context)&lt;/code&gt;æ˜¯ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç»†èŠ‚ã€‚&lt;code&gt;BootstrapContext&lt;/code&gt;ä¸»è¦ç”¨äºåº”ç”¨çš„&lt;strong&gt;æ—©æœŸå¯åŠ¨é˜¶æ®µ&lt;/strong&gt;ï¼Œä¾‹å¦‚åœ¨Spring Cloudç¯å¢ƒä¸­åŠ è½½è¿œç¨‹é…ç½®ã€‚å½“ä¸»åº”ç”¨ä¸Šä¸‹æ–‡å‡†å¤‡å°±ç»ªæ—¶ï¼Œ&lt;code&gt;BootstrapContext&lt;/code&gt;çš„ä½¿å‘½å°±å®Œæˆäº†ã€‚è°ƒç”¨&lt;code&gt;close&lt;/code&gt;æ–¹æ³•ä¼šè§¦å‘å…¶å…³é—­äº‹ä»¶ï¼Œå¹¶é€šå¸¸å°†å…¶æŒæœ‰çš„èµ„æºï¼ˆå¦‚ä¸€äº›æ—©æœŸçš„å•ä¾‹Beanï¼‰è½¬ç§»åˆ°ä¸»åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ï¼Œç¡®ä¿å®ƒä»¬åœ¨ä¸»åº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…å¯ç”¨ã€‚&lt;/p&gt;
&lt;h4 id="4-åŠ è½½æºæ•°æ®sourceä¸beanå®šä¹‰æ³¨å†Œ"&gt;4. åŠ è½½æºæ•°æ®ï¼ˆSourceï¼‰ä¸Beanå®šä¹‰æ³¨å†Œ
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;load(context, sources...)&lt;/code&gt;æ˜¯æ•´ä¸ªæµç¨‹ä¸­çš„&lt;strong&gt;æ ¸å¿ƒæ­¥éª¤ä¹‹ä¸€&lt;/strong&gt;ã€‚è¿™é‡Œçš„&lt;code&gt;sources&lt;/code&gt;é€šå¸¸å°±æ˜¯ä½ çš„ä¸»å¯åŠ¨ç±»ï¼ˆä¾‹å¦‚&lt;code&gt;Application.class&lt;/code&gt;ï¼‰ã€‚è¯¥æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª&lt;code&gt;BeanDefinitionLoader&lt;/code&gt;ï¼Œå®ƒä¼šè§£æä½ çš„å¯åŠ¨ç±»ä¸Šçš„æ³¨è§£ï¼ˆå¦‚&lt;code&gt;@SpringBootApplication&lt;/code&gt;ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¤åˆæ³¨è§£ï¼ŒåŒ…å«äº†&lt;code&gt;@Configuration&lt;/code&gt;ï¼‰ã€‚è§£æçš„ç»“æœæ˜¯ï¼Œä½ çš„å¯åŠ¨ç±»æœ¬èº«ä¼šè¢«æ³¨å†Œä¸ºä¸€ä¸ªBeanå®šä¹‰ï¼ˆBeanDefinitionï¼‰åˆ°å®¹å™¨çš„&lt;code&gt;BeanDefinitionMap&lt;/code&gt;ä¸­ã€‚è¿™æ˜¯åç»­ç»„ä»¶æ‰«æï¼ˆ&lt;code&gt;@ComponentScan&lt;/code&gt;ï¼‰å’Œè‡ªåŠ¨é…ç½®ï¼ˆ&lt;code&gt;@EnableAutoConfiguration&lt;/code&gt;ï¼‰å¾—ä»¥æ‰§è¡Œçš„èµ·ç‚¹ã€‚&lt;/p&gt;
&lt;h4 id="5-äº‹ä»¶é©±åŠ¨çš„å¯åŠ¨æµç¨‹"&gt;5. äº‹ä»¶é©±åŠ¨çš„å¯åŠ¨æµç¨‹
&lt;/h4&gt;&lt;p&gt;åœ¨æ•´ä¸ª&lt;code&gt;prepareContext&lt;/code&gt;è¿‡ç¨‹ä¸­ï¼ŒSpring Booté€šè¿‡&lt;code&gt;SpringApplicationRunListeners&lt;/code&gt;å‘å¸ƒäº†å¤šä¸ªäº‹ä»¶ï¼ˆå¦‚&lt;code&gt;contextPrepared&lt;/code&gt;å’Œ&lt;code&gt;contextLoaded&lt;/code&gt;ï¼‰ã€‚è¿™ç§&lt;strong&gt;äº‹ä»¶é©±åŠ¨æœºåˆ¶&lt;/strong&gt;æ˜¯Spring Bootæ¡†æ¶é«˜åº¦å¯æ‰©å±•æ€§çš„ä½“ç°ã€‚å„ç§ç›‘å¬å™¨ï¼ˆå¦‚&lt;code&gt;ConfigFileApplicationListener&lt;/code&gt;, &lt;code&gt;LoggingApplicationListener&lt;/code&gt;ï¼‰é€šè¿‡ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸçš„ç‰¹å®šèŠ‚ç‚¹æ‰§è¡Œç›¸åº”çš„é€»è¾‘ï¼Œä»è€Œå®ç°äº†åŠŸèƒ½çš„æ¨¡å—åŒ–å’Œè§£è€¦ã€‚&lt;/p&gt;
&lt;h3 id="-ç‰ˆæœ¬å·®å¼‚è¯´æ˜"&gt;âš ï¸ ç‰ˆæœ¬å·®å¼‚è¯´æ˜
&lt;/h3&gt;&lt;p&gt;ä½ æä¾›çš„ä»£ç ç‰‡æ®µä¸ä¸€äº›æœç´¢ç»“æœï¼ˆåŸºäºSpring Boot 2.xï¼‰å±•ç¤ºçš„ç»å…¸&lt;code&gt;prepareContext&lt;/code&gt;æ–¹æ³•å­˜åœ¨ä¸€äº›å·®å¼‚ï¼Œä¸»è¦ä½“ç°åœ¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°åˆ—è¡¨&lt;/strong&gt;ï¼šä½ çš„ä»£ç å¤šäº†ä¸€ä¸ª&lt;code&gt;DefaultBootstrapContext bootstrapContext&lt;/code&gt;å‚æ•°ï¼Œè¿™åæ˜ äº†æ–°ç‰ˆæœ¬å¯¹å¼•å¯¼æµç¨‹çš„å¢å¼ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AOTæ”¯æŒ&lt;/strong&gt;ï¼šä½ çš„ä»£ç ä¸­å‡ºç°äº†&lt;code&gt;this.addAotGeneratedInitializerIfNecessary(this.initializers)&lt;/code&gt;å’Œ&lt;code&gt;if (!AotDetector.useGeneratedArtifacts())&lt;/code&gt;ç­‰é€»è¾‘ï¼Œè¿™äº›æ˜¯Spring Bootä¸ºæ”¯æŒ&lt;strong&gt;AOTï¼ˆAhead-Of-Timeï¼‰ç¼–è¯‘&lt;/strong&gt;ï¼ˆå¸¸ç”¨äºGraalVM Native Imageï¼‰è€Œå¼•å…¥çš„æ–°ç‰¹æ€§ã€‚åœ¨AOTæ¨¡å¼ä¸‹ï¼Œéƒ¨åˆ†ä¼ ç»Ÿçš„åå°„å’ŒåŠ¨æ€å¤„ç†ä¼šè¢«é¢„å…ˆç”Ÿæˆçš„ä»£ç æ›¿ä»£ï¼Œå› æ­¤åŠ è½½æºæ•°æ®çš„é€»è¾‘ï¼ˆ&lt;code&gt;this.load&lt;/code&gt;ï¼‰åœ¨AOTæ¨¡å¼ä¸‹å¯èƒ½è¢«è·³è¿‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;prepareContext&lt;/code&gt;æ–¹æ³•æ˜¯Spring Bootåº”ç”¨å¯åŠ¨è¿‡ç¨‹ä¸­æ‰¿ä¸Šå¯ä¸‹çš„å…³é”®é˜¶æ®µã€‚å®ƒæ­å»ºäº†IoCå®¹å™¨çš„åŸºæœ¬éª¨æ¶ï¼š&lt;strong&gt;ç»Ÿä¸€äº†ç¯å¢ƒé…ç½®ã€æ‰§è¡Œäº†è‡ªå®šä¹‰åˆå§‹åŒ–ã€æ³¨å†Œäº†æ ¸å¿ƒçš„å•ä¾‹å¯¹è±¡ã€åŠ è½½äº†å¯åŠ¨ç±»å¹¶å‘å¸ƒäº†å…³é”®äº‹ä»¶&lt;/strong&gt;ï¼Œä¸ºç´§éšå…¶åçš„å®¹å™¨åˆ·æ–°ï¼ˆ&lt;code&gt;refreshContext&lt;/code&gt;ï¼‰â€”â€”å³Beançš„å®ä¾‹åŒ–ã€ä¾èµ–æ³¨å…¥ç­‰æ ¸å¿ƒæµç¨‹â€”â€”åšå¥½äº†å…¨éƒ¨å‡†å¤‡å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ é€å½»ç†è§£Spring Bootåº”ç”¨ä¸Šä¸‹æ–‡çš„å‡†å¤‡è¿‡ç¨‹ã€‚å¦‚æœä½ å¯¹æŸä¸ªå…·ä½“æ­¥éª¤æˆ–æ‰©å±•ç‚¹è¿˜æœ‰æ›´æ·±å…¥çš„ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="beanfactory"&gt;BeanFactory
&lt;/h2&gt;&lt;p&gt;BeanFactory æ˜¯ Spring æ¡†æ¶çš„&lt;strong&gt;å¿ƒè„&lt;/strong&gt;ï¼Œå®ƒæ˜¯ Spring IoCï¼ˆæ§åˆ¶åè½¬ï¼‰å®¹å™¨çš„æ ¸å¿ƒæ¥å£ï¼Œè´Ÿè´£ç®¡ç†åº”ç”¨ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼ˆå³ Beanï¼‰çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹è¡¨æ±‡æ€»äº†å®ƒçš„æ ¸å¿ƒä¿¡æ¯ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒè¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒè§’è‰²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Spring IoC å®¹å™¨çš„é¡¶å±‚æ¥å£ï¼Œæ˜¯å¯¹è±¡çš„â€œè¶…çº§å·¥å‚â€å’Œç®¡ç†ä¸­å¿ƒã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦èŒè´£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Bean çš„å®ä¾‹åŒ–ã€ä¾èµ–æ³¨å…¥ (DI)ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€ä½œç”¨åŸŸæ§åˆ¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®ç°æ§åˆ¶åè½¬ (IoC) å’Œä¾èµ–æ³¨å…¥ (DI)ï¼Œå°†å¯¹è±¡åˆ›å»ºä¸ä½¿ç”¨çš„èŒè´£ä»åº”ç”¨ä»£ç åè½¬ç»™å®¹å™¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®ç‰¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒå¤šç§ä½œç”¨åŸŸï¼ˆå•ä¾‹ã€åŸå‹ç­‰ï¼‰ã€å»¶è¿ŸåŠ è½½ã€ä¸ BeanDefinition æœºåˆ¶è§£è€¦ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒå®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;ï¼ˆæœ€å¸¸ç”¨ã€åŠŸèƒ½æœ€å®Œæ•´çš„å®ç°ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼-2"&gt;ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼
&lt;/h3&gt;&lt;p&gt;BeanFactory çš„æ ¸å¿ƒä»·å€¼åœ¨äºå®ƒå®ç°äº† &lt;strong&gt;â€œæ§åˆ¶åè½¬â€&lt;/strong&gt; è¿™ä¸€æ ¸å¿ƒç¼–ç¨‹æ€æƒ³ã€‚åº”ç”¨ç¨‹åºä¸å†è‡ªå·±ç”¨ &lt;code&gt;new&lt;/code&gt;å…³é”®å­—æ¥åˆ›å»ºå’Œç®¡ç†å¯¹è±¡ï¼Œè€Œæ˜¯ç”± BeanFactory è¿™ä¸ªå®¹å™¨æ¥ç»Ÿä¸€è´Ÿè´£ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦&lt;/strong&gt;ï¼šå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ç”±å®¹å™¨æ³¨å…¥ï¼Œé™ä½äº†ä»£ç çš„è€¦åˆåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºç»Ÿä¸€ç®¡ç†&lt;/strong&gt;ï¼šå®¹å™¨å¯ä»¥é«˜æ•ˆåœ°ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆåˆ›å»ºã€åˆå§‹åŒ–ã€é”€æ¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»é…ç½®&lt;/strong&gt;ï¼šé€šè¿‡é…ç½®ï¼ˆXMLã€æ³¨è§£ã€Java Configï¼‰ï¼Œå¯ä»¥è½»æ¾æ”¹å˜ Bean çš„è¡Œä¸ºå’Œä½œç”¨åŸŸï¼Œè€Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ ¸å¿ƒæ¥å£ä¸æ–¹æ³•"&gt;ğŸ“š æ ¸å¿ƒæ¥å£ä¸æ–¹æ³•
&lt;/h3&gt;&lt;p&gt;BeanFactory æ¥å£å®šä¹‰äº†ä¸€ç³»åˆ—ç®¡ç† Bean çš„æ ¸å¿ƒæ–¹æ³•ï¼Œå¯ä»¥å½’çº³ä¸ºä»¥ä¸‹å‡ ç±» ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·å– Bean å®ä¾‹&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€æ ¸å¿ƒçš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Object getBean(String name) throws BeansException;
&amp;lt;T&amp;gt; T getBean(String name, Class&amp;lt;T&amp;gt; requiredType) throws BeansException;
&amp;lt;T&amp;gt; T getBean(Class&amp;lt;T&amp;gt; requiredType) throws BeansException;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥ Bean ç‰¹æ€§&lt;/strong&gt;ï¼šç”¨äºæŸ¥è¯¢ Bean çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;boolean containsBean(String name); // æ£€æŸ¥æ˜¯å¦å­˜åœ¨æŒ‡å®šåç§°çš„Bean
boolean isSingleton(String name) throws NoSuchBeanDefinitionException; // æ˜¯å¦ä¸ºå•ä¾‹
boolean isPrototype(String name) throws NoSuchBeanDefinitionException; // æ˜¯å¦ä¸ºåŸå‹ï¼ˆæ¯æ¬¡è¯·æ±‚åˆ›å»ºæ–°å®ä¾‹ï¼‰
Class&amp;lt;?&amp;gt; getType(String name) throws NoSuchBeanDefinitionException; // è·å–Beançš„ç±»å‹
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·å–åˆ«åç­‰å…¶ä»–ä¿¡æ¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] getAliases(String name); // è·å–Beançš„æ‰€æœ‰åˆ«å
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ ¸å¿ƒå®ç°defaultlistablebeanfactory"&gt;âš™ï¸ æ ¸å¿ƒå®ç°ï¼šDefaultListableBeanFactory
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;æ˜¯ Spring ä¸­&lt;strong&gt;åŠŸèƒ½æœ€å®Œæ•´ã€æœ€å¸¸ç”¨&lt;/strong&gt;çš„ BeanFactory å®ç° ã€‚å®ƒä¸ä»…å®ç°äº† &lt;code&gt;BeanFactory&lt;/code&gt;æ¥å£ï¼Œè¿˜å®ç°äº† &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;æ¥å£ï¼Œè¿™æ„å‘³ç€å®ƒå…·å¤‡æ³¨å†Œå’Œç®¡ç† Bean å®šä¹‰ï¼ˆ&lt;code&gt;BeanDefinition&lt;/code&gt;ï¼‰çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒçš„å†…éƒ¨é€šè¿‡ä¸¤ä¸ªæ ¸å¿ƒæ•°æ®ç»“æ„æ¥ç®¡ç† Bean çš„å®šä¹‰ä¿¡æ¯ ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;beanDefinitionMap&lt;/code&gt;ï¼šä¸€ä¸ª &lt;code&gt;ConcurrentHashMap&lt;/code&gt;ï¼Œç”¨äºå­˜å‚¨ Bean åç§°ä¸ &lt;code&gt;BeanDefinition&lt;/code&gt;çš„æ˜ å°„å…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;beanDefinitionNames&lt;/code&gt;ï¼šä¸€ä¸ª &lt;code&gt;ArrayList&lt;/code&gt;ï¼Œå­˜å‚¨æ‰€æœ‰å·²æ³¨å†Œçš„ Bean åç§°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨å†Œ Bean å®šä¹‰çš„æ–¹æ³•å¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public void registerBeanDefinition(String beanName, BeanDefinition beanDefinition) {
this.beanDefinitionMap.put(beanName, beanDefinition);
this.beanDefinitionNames.add(beanName);
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-bean-çš„åŠ è½½æµç¨‹ä¸ç”Ÿå‘½å‘¨æœŸ"&gt;ğŸ”„ Bean çš„åŠ è½½æµç¨‹ä¸ç”Ÿå‘½å‘¨æœŸ
&lt;/h3&gt;&lt;p&gt;å½“ä½ è°ƒç”¨ &lt;code&gt;getBean()&lt;/code&gt;æ–¹æ³•æ—¶ï¼ŒSpring ä¼šè§¦å‘ä¸€ç³»åˆ—å¤æ‚çš„å†…éƒ¨æµç¨‹æ¥åˆ›å»ºæˆ–è·å– Bean å®ä¾‹ã€‚å…¶ç®€åŒ–åçš„æ ¸å¿ƒè°ƒç”¨é“¾å¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;getBean()&lt;/code&gt;â†’ &lt;code&gt;doGetBean()&lt;/code&gt;â†’ &lt;code&gt;getSingleton()&lt;/code&gt;ï¼ˆå°è¯•ä»ç¼“å­˜è·å–ï¼‰â†’ &lt;code&gt;createBean()&lt;/code&gt;â†’ &lt;code&gt;doCreateBean()&lt;/code&gt;â†’ &lt;code&gt;populateBean()&lt;/code&gt;ï¼ˆå±æ€§æ³¨å…¥ï¼‰â†’ &lt;code&gt;initializeBean()&lt;/code&gt;ï¼ˆåˆå§‹åŒ–ï¼‰&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª Bean çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®ä¾‹åŒ–&lt;/strong&gt;ï¼šé€šè¿‡æ„é€ æ–¹æ³•æˆ–å·¥å‚æ–¹æ³•åˆ›å»º Bean çš„å®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±æ€§å¡«å……ï¼ˆä¾èµ–æ³¨å…¥ï¼‰&lt;/strong&gt;ï¼šå°† Bean æ‰€ä¾èµ–çš„å…¶ä»– Bean æˆ–å€¼æ³¨å…¥åˆ°å¯¹åº”å±æ€§ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Aware æ¥å£å›è°ƒ&lt;/strong&gt;ï¼šå¦‚æœ Bean å®ç°äº†è¯¸å¦‚ &lt;code&gt;BeanNameAware&lt;/code&gt;ã€&lt;code&gt;BeanFactoryAware&lt;/code&gt;ç­‰æ¥å£ï¼Œå®¹å™¨ä¼šå›è°ƒç›¸åº”æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BeanPostProcessor å‰ç½®å¤„ç†&lt;/strong&gt;ï¼šè°ƒç”¨æ‰€æœ‰ &lt;code&gt;BeanPostProcessor&lt;/code&gt;çš„ &lt;code&gt;postProcessBeforeInitialization&lt;/code&gt;æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹åŒ–&lt;/strong&gt;ï¼šæ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•ï¼Œå¦‚ &lt;code&gt;@PostConstruct&lt;/code&gt;æ³¨è§£çš„æ–¹æ³•ã€&lt;code&gt;InitializingBean&lt;/code&gt;æ¥å£çš„ &lt;code&gt;afterPropertiesSet&lt;/code&gt;æ–¹æ³•æˆ–è‡ªå®šä¹‰çš„ &lt;code&gt;init-method&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BeanPostProcessor åç½®å¤„ç†&lt;/strong&gt;ï¼šè°ƒç”¨æ‰€æœ‰ &lt;code&gt;BeanPostProcessor&lt;/code&gt;çš„ &lt;code&gt;postProcessAfterInitialization&lt;/code&gt;æ–¹æ³•ã€‚&lt;strong&gt;AOP ä»£ç†é€šå¸¸åœ¨æ­¤é˜¶æ®µç”Ÿæˆ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨&lt;/strong&gt;ï¼šBean å®Œå…¨å°±ç»ªï¼Œå¯ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”€æ¯&lt;/strong&gt;ï¼šå®¹å™¨å…³é—­æ—¶ï¼Œæ‰§è¡Œé”€æ¯æ–¹æ³•ï¼Œå¦‚ &lt;code&gt;@PreDestroy&lt;/code&gt;æ³¨è§£çš„æ–¹æ³•ã€&lt;code&gt;DisposableBean&lt;/code&gt;æ¥å£çš„ &lt;code&gt;destroy&lt;/code&gt;æ–¹æ³•æˆ–è‡ªå®šä¹‰çš„ &lt;code&gt;destroy-method&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-beanfactory-ä¸-applicationcontext-çš„å…³ç³»"&gt;ğŸ”„ BeanFactory ä¸ ApplicationContext çš„å…³ç³»
&lt;/h3&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦ä¸”å¸¸è§çš„æ¦‚å¿µåŒºåˆ† ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;BeanFactory&lt;/strong&gt; æ˜¯ &lt;strong&gt;åŸºç¡€æ¥å£&lt;/strong&gt;ï¼Œæä¾›äº† IoC å®¹å™¨æœ€æ ¸å¿ƒã€æœ€åŸºæœ¬çš„åŠŸèƒ½ï¼ˆå¦‚ &lt;code&gt;getBean&lt;/code&gt;ã€ä¾èµ–æ³¨å…¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ApplicationContext&lt;/strong&gt; æ˜¯ &lt;strong&gt;BeanFactory çš„å­æ¥å£&lt;/strong&gt;ï¼Œåœ¨ç»§æ‰¿æ‰€æœ‰åŸºç¡€åŠŸèƒ½çš„åŒæ—¶ï¼Œå¢åŠ äº†å¤§é‡ä¼ä¸šçº§ç‰¹æ€§ï¼Œä½¿å…¶æˆä¸ºæ›´å¼ºå¤§çš„â€œåº”ç”¨ä¸Šä¸‹æ–‡â€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ä¸»è¦åŒºåˆ«&lt;/strong&gt; ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;BeanFactory&lt;/th&gt;
&lt;th&gt;ApplicationContext&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®¹å™¨ç‰¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºç¡€ IoC åŠŸèƒ½&lt;/td&gt;
&lt;td&gt;BeanFactory çš„è¶…é›†ï¼Œå¢åŠ å›½é™…åŒ–ã€äº‹ä»¶å‘å¸ƒã€èµ„æºåŠ è½½ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ è½½ç­–ç•¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æŒ‰éœ€åŠ è½½ (Lazy)&lt;/strong&gt;ï¼Œåªæœ‰åœ¨è°ƒç”¨ &lt;code&gt;getBean()&lt;/code&gt;æ—¶æ‰å®ä¾‹åŒ– Bean&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é¢„åŠ è½½ (Eager)&lt;/strong&gt;ï¼Œå®¹å™¨å¯åŠ¨æ—¶å³åˆ›å»ºæ‰€æœ‰å•ä¾‹ Beanï¼ˆå¯é…ç½®ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;èµ„æºæåº¦å—é™çš„åµŒå…¥å¼ç³»ç»Ÿç­‰&lt;/td&gt;
&lt;td&gt;ç»å¤§å¤šæ•°æ ‡å‡†ä¼ä¸šçº§åº”ç”¨ï¼Œæ˜¯ Spring Boot çš„é»˜è®¤é€‰æ‹©&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;strong&gt;ApplicationContext æ˜¯åŠŸèƒ½æ›´å…¨é¢çš„ BeanFactory&lt;/strong&gt;ã€‚åœ¨ç°ä»£ Spring åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹æ€»æ˜¯ç›´æ¥ä½¿ç”¨ &lt;code&gt;ApplicationContext&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;AnnotationConfigApplicationContext&lt;/code&gt;ï¼‰ï¼Œä½†å®ƒçš„åº•å±‚æ ¸å¿ƒä¾ç„¶æ˜¯ &lt;code&gt;BeanFactory&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id="-æ³¨æ„beanfactory-ä¸-factorybean-çš„åŒºåˆ«"&gt;âš ï¸ æ³¨æ„ï¼šBeanFactory ä¸ FactoryBean çš„åŒºåˆ«
&lt;/h3&gt;&lt;p&gt;è¿™ä¸¤ä¸ªåç§°ç›¸ä¼¼ä½†&lt;strong&gt;å®Œå…¨ä¸åŒ&lt;/strong&gt;ï¼Œææ˜“æ··æ·† ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;BeanFactory&lt;/strong&gt;ï¼šæ˜¯ &lt;strong&gt;IoC å®¹å™¨æœ¬èº«&lt;/strong&gt;ï¼Œæ˜¯ä¸€ä¸ªå·¨å¤§çš„å·¥å‚ï¼Œè´Ÿè´£ç”Ÿäº§å’Œç®¡ç†&lt;strong&gt;æ‰€æœ‰&lt;/strong&gt; Beanã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;FactoryBean&lt;/strong&gt;ï¼šæ˜¯ä¸€ä¸ª&lt;strong&gt;ç‰¹æ®Šçš„ Bean&lt;/strong&gt;ï¼Œå®ƒæ˜¯ä¸€ä¸ªèƒ½ç”Ÿäº§å…¶ä»– Bean çš„å·¥å‚ã€‚å½“ä½ å‘å®¹å™¨è·å–ä¸€ä¸ª &lt;code&gt;FactoryBean&lt;/code&gt;æ—¶ï¼Œé»˜è®¤å¾—åˆ°çš„æ˜¯å®ƒ &lt;code&gt;getObject()&lt;/code&gt;æ–¹æ³•è¿”å›çš„äº§å“å¯¹è±¡ã€‚å¦‚æœä½ æƒ³è·å– &lt;code&gt;FactoryBean&lt;/code&gt;æœ¬èº«ï¼Œéœ€è¦åœ¨ Bean åç§°å‰åŠ  &lt;code&gt;&amp;amp;&lt;/code&gt;ç¬¦å·ï¼ˆä¾‹å¦‚ &lt;code&gt;getBean(&amp;quot;&amp;amp;myFactoryBean&amp;quot;)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æ¯”å–»ç†è§£&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;BeanFactory&lt;/strong&gt; å°±åƒæ˜¯ä¸€å®¶&lt;strong&gt;æ±½è½¦åˆ¶é€ å‚&lt;/strong&gt;ï¼Œå®ƒèƒ½ç”Ÿäº§å„ç§æ±½è½¦ï¼ˆBeanï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;FactoryBean&lt;/strong&gt; å°±åƒæ˜¯è¿™å®¶å·¥å‚é‡Œä¸€æ¡&lt;strong&gt;ç‰¹æ®Šçš„ç”Ÿäº§çº¿&lt;/strong&gt;ï¼Œè¿™æ¡ç”Ÿäº§çº¿æœ¬èº«ä¹Ÿéœ€è¦åœ¨å·¥å‚é‡Œæ³¨å†Œï¼ˆå®ƒæ˜¯ä¸€ä¸ª Beanï¼‰ï¼Œä½†å®ƒä¸“é—¨è´Ÿè´£ç”Ÿäº§æŸç§ç‰¹å®šå‹å·çš„å‘åŠ¨æœºï¼ˆå¦ä¸€ä¸ª Beanï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;BeanFactory æ˜¯ Spring æ¡†æ¶çš„åŸºçŸ³ï¼Œç†è§£äº†å®ƒå°±æŠ“ä½äº† Spring IoC çš„æ ¸å¿ƒã€‚å®ƒé€šè¿‡å°†å¯¹è±¡çš„åˆ›å»ºã€ç»„è£…å’Œç®¡ç†æƒä»ä»£ç ä¸­å‰¥ç¦»ï¼Œäº¤ç”±å®¹å™¨ç»Ÿä¸€å¤„ç†ï¼Œæå¤§åœ°æé«˜äº†ç¨‹åºçš„çµæ´»æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§ã€‚è™½ç„¶åœ¨å®é™…å¼€å‘ä¸­æˆ‘ä»¬æ›´å¤šåœ°ä½¿ç”¨å…¶å­æ¥å£ ApplicationContextï¼Œä½†å®ƒçš„è®¾è®¡æ€æƒ³å’Œè¿ä½œæœºåˆ¶æ˜¯æ·±å…¥æŒæ¡ Spring çš„å…³é”®ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ é€å½»ç†è§£ BeanFactoryã€‚å¦‚æœä½ å¯¹ Bean çš„ç”Ÿå‘½å‘¨æœŸç»†èŠ‚ã€æ‰©å±•ç‚¹ï¼ˆå¦‚ BeanPostProcessorï¼‰æˆ–å…¶ä»–ç›¸å…³ä¸»é¢˜æœ‰è¿›ä¸€æ­¥çš„å…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="å­ç±»"&gt;å­ç±»
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;åŠå…¶ç›¸å…³çš„å­æ¥å£æ˜¯ Spring IoC å®¹å™¨çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œå®ƒä»¬é€šè¿‡&lt;strong&gt;èŒè´£åˆ†ç¦»å’ŒåŠŸèƒ½ç»„åˆ&lt;/strong&gt;çš„æ–¹å¼ï¼Œä¸º Spring å®¹å™¨æä¾›äº†é«˜åº¦å¯é…ç½®å’Œå¯æ‰©å±•çš„èƒ½åŠ›ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹è¡¨æ¸…æ™°åœ°å±•ç¤ºäº†è¿™äº›å…³é”®æ¥å£çš„æ ¸å¿ƒèŒè´£ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ¥å£åç§°&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒèŒè´£&lt;/th&gt;
&lt;th&gt;å…³é”®ç‰¹æ€§&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ConfigurableBeanFactory&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾› Bean å·¥å‚çš„&lt;strong&gt;åŸºç¡€é…ç½®èƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®ç±»åŠ è½½å™¨ã€ç±»å‹è½¬æ¢æœåŠ¡ã€å±æ€§ç¼–è¾‘å™¨ã€ä½œç”¨åŸŸï¼ˆå•ä¾‹/åŸå‹ï¼‰ç®¡ç†ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ListableBeanFactory&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾› Bean çš„&lt;strong&gt;åˆ—ä¸¾å’ŒæŸ¥è¯¢èƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰¹é‡è·å– Bean åç§°ã€æ ¹æ®ç±»å‹è·å–æ‰€æœ‰ Bean å®ä¾‹ã€æ£€æŸ¥ Bean å®šä¹‰ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;AutowireCapableBeanFactory&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾› Bean çš„&lt;strong&gt;è‡ªåŠ¨è£…é…å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/strong&gt;èƒ½åŠ›&lt;/td&gt;
&lt;td&gt;åœ¨å®¹å™¨å¤–åˆ›å»ºã€é…ç½®å’Œè£…é… Bean å®ä¾‹ï¼Œå¤„ç†ä¾èµ–æ³¨å…¥ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸Šè¿°æ‰€æœ‰æ¥å£åŠŸèƒ½çš„é›†å¤§æˆè€…&lt;/strong&gt;ï¼Œæ˜¯åŠŸèƒ½æœ€å®Œæ•´çš„ Bean å·¥å‚&lt;/td&gt;
&lt;td&gt;ç»§æ‰¿ä»¥ä¸Šæ‰€æœ‰æ¥å£ï¼Œæ”¯æŒ Bean å®šä¹‰çš„æ³¨å†Œã€å†»ç»“ã€é¢„å®ä¾‹åŒ–ç­‰é«˜çº§æ“ä½œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å„æ¥å£çš„è¯¦ç»†ä½œç”¨"&gt;ğŸ’¡ å„æ¥å£çš„è¯¦ç»†ä½œç”¨
&lt;/h3&gt;&lt;h4 id="1-configurablebeanfactoryåŸºç¡€é…ç½®çš„åŸºçŸ³"&gt;1. ConfigurableBeanFactoryï¼šåŸºç¡€é…ç½®çš„åŸºçŸ³
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;ConfigurableBeanFactory&lt;/code&gt;ä¸º Bean å·¥å‚æä¾›äº†åº•å±‚çš„é…ç½®èƒ½åŠ›ï¼Œæ˜¯è¿›è¡Œç²¾ç»†åŒ–ç®¡ç†çš„åŸºç¡€ã€‚å®ƒçš„ä¸»è¦ä½œç”¨åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç®¡ç†ä½œç”¨åŸŸ&lt;/strong&gt;ï¼šå…è®¸è®¾ç½® Bean æ˜¯å•ä¾‹ï¼ˆSingletonï¼‰è¿˜æ˜¯åŸå‹ï¼ˆPrototypeï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç†ä¾èµ–&lt;/strong&gt;ï¼šå¯é…ç½®æ˜¯å¦å…è®¸ Bean ä¹‹é—´çš„å¾ªç¯å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹è½¬æ¢&lt;/strong&gt;ï¼šè®¾ç½® &lt;code&gt;TypeConverter&lt;/code&gt;å’Œ &lt;code&gt;PropertyEditorRegistrar&lt;/code&gt;ï¼Œç”¨äºå¤„ç†å±æ€§å€¼çš„ç±»å‹è½¬æ¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®¡ç†åç½®å¤„ç†å™¨&lt;/strong&gt;ï¼šæ³¨å†Œ &lt;code&gt;BeanPostProcessor&lt;/code&gt;ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨ Bean åˆå§‹åŒ–å‰åä»‹å…¥å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨å†Œå•ä¾‹å¯¹è±¡&lt;/strong&gt;ï¼šæä¾›æ–¹æ³•ç›´æ¥æ³¨å†Œå·²æœ‰çš„å•ä¾‹å¯¹è±¡åˆ°å®¹å™¨ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-listablebeanfactoryå¼ºå¤§çš„æŸ¥è¯¢ä¸åˆ—ä¸¾å·¥å…·"&gt;2. ListableBeanFactoryï¼šå¼ºå¤§çš„æŸ¥è¯¢ä¸åˆ—ä¸¾å·¥å…·
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;ListableBeanFactory&lt;/code&gt;çš„æ ¸å¿ƒä»·å€¼åœ¨äºå…¶&lt;strong&gt;æ‰¹é‡æ“ä½œå’ŒæŸ¥è¯¢èƒ½åŠ›&lt;/strong&gt;ï¼Œè¿™æ˜¯åŸºç¡€çš„ &lt;code&gt;BeanFactory&lt;/code&gt;æ¥å£æ‰€ä¸å…·å¤‡çš„ã€‚é€šè¿‡å®ƒï¼Œä½ å¯ä»¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·å–æ‰€æœ‰ Bean çš„åç§°&lt;/strong&gt;ï¼š&lt;code&gt;String[] getBeanDefinitionNames()&lt;/code&gt;æ–¹æ³•å¯ä»¥æ‹¿åˆ°å®¹å™¨ä¸­æ‰€æœ‰ Bean å®šä¹‰çš„åç§°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒ‰ç±»å‹æŸ¥æ‰¾ Bean&lt;/strong&gt;ï¼š&lt;code&gt;&amp;lt;T&amp;gt; Map&amp;lt;String, T&amp;gt; getBeansOfType(@Nullable Class&amp;lt;T&amp;gt; type)&lt;/code&gt;æ–¹æ³•èƒ½è·å–æ‰€æœ‰åŒ¹é…æŒ‡å®šç±»å‹çš„ Bean å®ä¾‹åŠå…¶åç§°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ£€æŸ¥æ³¨è§£&lt;/strong&gt;ï¼š&lt;code&gt;String[] getBeanNamesForAnnotation(Class&amp;lt;? extends Annotation&amp;gt; annotationType)&lt;/code&gt;æ–¹æ³•å¯ä»¥æ‰¾åˆ°æ‰€æœ‰å¸¦æœ‰ç‰¹å®šæ³¨è§£çš„ Bean åç§°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-autowirecapablebeanfactoryå®¹å™¨å¤–çš„è£…é…å·¥"&gt;3. AutowireCapableBeanFactoryï¼šå®¹å™¨å¤–çš„è£…é…å·¥
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;AutowireCapableBeanFactory&lt;/code&gt;æ‰©å±•äº† Bean çš„åˆ›å»ºå’Œè£…é…æ–¹å¼ï¼Œä½¿å…¶ä¸ä»…èƒ½åœ¨å®¹å™¨å†…éƒ¨å·¥ä½œï¼Œè¿˜èƒ½&lt;strong&gt;åœ¨å®¹å™¨å¤–éƒ¨ç‹¬ç«‹å®Œæˆ Bean çš„å®ä¾‹åŒ–ã€ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–è¿‡ç¨‹&lt;/strong&gt;ã€‚è¿™åœ¨é›†æˆç¬¬ä¸‰æ–¹æ¡†æ¶æˆ–éœ€è¦åœ¨é Spring ç®¡ç†ç¯å¢ƒä¸­åˆ›å»º Bean æ—¶éå¸¸æœ‰ç”¨ã€‚å…¶ä¸»è¦æ–¹æ³•åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;createBean(Class&amp;lt;T&amp;gt; beanClass)&lt;/code&gt;ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Bean å®ä¾‹å¹¶å®Œæˆå…¶ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;autowireBean(Object existingBean)&lt;/code&gt;ï¼šå¯¹ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡è¿›è¡Œä¾èµ–æ³¨å…¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;configureBean(Object existingBean, String beanName)&lt;/code&gt;ï¼šé…ç½®ä¸€ä¸ªå·²å­˜åœ¨çš„ Beanï¼ŒåŒ…æ‹¬ä¾èµ–æ³¨å…¥å’Œåº”ç”¨åç½®å¤„ç†å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="4-configurablelistablebeanfactoryåŠŸèƒ½å…¨é›†æˆçš„ç»ˆæå½¢æ€"&gt;4. ConfigurableListableBeanFactoryï¼šåŠŸèƒ½å…¨é›†æˆçš„ç»ˆæå½¢æ€
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;æ˜¯ Spring å®¹å™¨ä¸­&lt;strong&gt;åŠŸèƒ½æœ€å¼ºå¤§ã€æœ€æ ¸å¿ƒçš„ Bean å·¥å‚æ¥å£&lt;/strong&gt;ã€‚å®ƒç»§æ‰¿äº†ä¸Šè¿°æ‰€æœ‰æ¥å£ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ äº†å…³é”®åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ³¨å†Œå’Œå†»ç»“ Bean å®šä¹‰&lt;/strong&gt;ï¼šå¯ä»¥ç¼–ç¨‹å¼åœ°æ³¨å†Œæ–°çš„ &lt;code&gt;BeanDefinition&lt;/code&gt;ï¼Œå¹¶å¯ä»¥â€œå†»ç»“â€æ‰€æœ‰ Bean å®šä¹‰ï¼Œé˜²æ­¢åç»­ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¢„å®ä¾‹åŒ–å•ä¾‹ Bean&lt;/strong&gt;ï¼šç¡®ä¿æ‰€æœ‰éå»¶è¿ŸåŠ è½½çš„å•ä¾‹ Bean åœ¨å®¹å™¨å¯åŠ¨æ—¶å°±è¢«åˆ›å»ºå¥½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è§£æä¾èµ–&lt;/strong&gt;ï¼šå½“å­˜åœ¨æœªè§£æçš„ä¾èµ–æ—¶ï¼ˆå¦‚ &lt;code&gt;@Autowired&lt;/code&gt;æ³¨å…¥çš„å€™é€‰ Bean æœ‰å¤šä¸ªï¼‰ï¼Œå®ƒå¯ä»¥ä½œä¸ºå†³ç­–è€…ä»‹å…¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Spring åº”ç”¨ä¸Šä¸‹æ–‡ï¼ˆå¦‚ &lt;code&gt;AnnotationConfigApplicationContext&lt;/code&gt;ï¼‰çš„å¯åŠ¨æµç¨‹ä¸­ï¼Œ&lt;code&gt;refresh()&lt;/code&gt;æ–¹æ³•çš„æ ¸å¿ƒæ­¥éª¤ä¹‹ä¸€å°±æ˜¯è·å–ä¸€ä¸ª &lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;å®ä¾‹ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œ Bean å®šä¹‰çš„åŠ è½½ã€åç½®å¤„ç†å™¨çš„æ³¨å†Œä»¥åŠå•ä¾‹ Bean çš„é¢„å®ä¾‹åŒ–ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸»è¦å®ç°defaultlistablebeanfactory"&gt;ğŸ› ï¸ ä¸»è¦å®ç°ï¼šDefaultListableBeanFactory
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;æ˜¯ &lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;æ¥å£çš„&lt;strong&gt;é»˜è®¤ä¸”æœ€å¸¸ç”¨çš„å®ç°ç±»&lt;/strong&gt;ã€‚å®ƒæ˜¯æ•´ä¸ª Spring IoC å®¹å™¨çš„åŸºç¡€ï¼Œæ— è®ºæ˜¯åŸºäº XML çš„ç»å…¸é…ç½®è¿˜æ˜¯ç°ä»£çš„æ³¨è§£é…ç½®ï¼Œå…¶åº•å±‚æœ€ç»ˆéƒ½ä¼šä½¿ç”¨ &lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®ƒå†…éƒ¨ä½¿ç”¨ä¸€ä¸ª &lt;code&gt;ConcurrentHashMap&lt;/code&gt;ï¼ˆé€šå¸¸æ˜¯ &lt;code&gt;beanDefinitionMap&lt;/code&gt;ï¼‰æ¥å­˜å‚¨æ‰€æœ‰ Bean çš„å®šä¹‰ï¼ˆ&lt;code&gt;BeanDefinition&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Spring åº”ç”¨ä¸Šä¸‹æ–‡ï¼ˆ&lt;code&gt;ApplicationContext&lt;/code&gt;ï¼‰å®é™…ä¸Š&lt;strong&gt;æŒæœ‰ä¸€ä¸ª &lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;å®ä¾‹ä½œä¸ºå…¶å§”æ‰˜çš„ Bean å·¥å‚&lt;/strong&gt;ï¼Œè®¸å¤šå…·ä½“çš„ Bean ç®¡ç†æ“ä½œéƒ½å§”æ‰˜ç»™è¿™ä¸ªå®ä¾‹æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-åœ¨-spring-å¯åŠ¨æµç¨‹ä¸­çš„è§’è‰²"&gt;ğŸ”„ åœ¨ Spring å¯åŠ¨æµç¨‹ä¸­çš„è§’è‰²
&lt;/h3&gt;&lt;p&gt;è¿™äº›æ¥å£ï¼Œç‰¹åˆ«æ˜¯ &lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;ï¼Œåœ¨ Spring å®¹å™¨çš„å¯åŠ¨è¿‡ç¨‹ä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ã€‚ä»¥ &lt;code&gt;AbstractApplicationContext.refresh()&lt;/code&gt;æ–¹æ³•ä¸ºä¾‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;obtainFreshBeanFactory()&lt;/code&gt;&lt;/strong&gt;ï¼šæ­¤æ–¹æ³•ä¼šè§¦å‘ Bean å·¥å‚çš„åˆ›å»ºå’Œåˆ·æ–°ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ª &lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šåŠ è½½é…ç½®æ–‡ä»¶ï¼ˆå¦‚ XMLï¼‰ï¼Œè§£æå‡ºæ‰€æœ‰çš„ &lt;code&gt;BeanDefinition&lt;/code&gt;å¹¶æ³¨å†Œåˆ°å·¥å‚ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;prepareBeanFactory(beanFactory)&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨æ­¤é˜¶æ®µï¼ŒSpring ä¼šå¯¹è·å–åˆ°çš„ &lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;è¿›è¡Œä¸€ç³»åˆ—é…ç½®ï¼Œä¾‹å¦‚è®¾ç½®ç±»åŠ è½½å™¨ã€æ³¨å†Œä¸€äº›å†…ç½®çš„ Beanï¼ˆå¦‚ &lt;code&gt;Environment&lt;/code&gt;ï¼‰ä»¥åŠæ·»åŠ å…³é”®çš„ &lt;code&gt;BeanPostProcessor&lt;/code&gt;ï¼ˆå¦‚å¤„ç† &lt;code&gt;@Autowired&lt;/code&gt;çš„ &lt;code&gt;AutowiredAnnotationBeanPostProcessor&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;invokeBeanFactoryPostProcessors(beanFactory)&lt;/code&gt;&lt;/strong&gt;ï¼šè°ƒç”¨æ‰€æœ‰ &lt;code&gt;BeanFactoryPostProcessor&lt;/code&gt;ï¼Œå®ƒä»¬å¯ä»¥æ‹¿åˆ° &lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;å¹¶å¯¹å…¶ä¸­çš„ &lt;code&gt;BeanDefinition&lt;/code&gt;è¿›è¡Œä¿®æ”¹æˆ–å¢å¼ºã€‚è¿™æ˜¯ Spring æ‰©å±•æ€§çš„ä¸€å¤§ä½“ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;finishBeanFactoryInitialization(beanFactory)&lt;/code&gt;&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€åä¸€æ­¥ï¼Œ&lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;ä¼šè´Ÿè´£å®ä¾‹åŒ–æ‰€æœ‰éå»¶è¿ŸåŠ è½½çš„å•ä¾‹ Beanï¼Œå®Œæˆä¾èµ–æ³¨å…¥ï¼Œå¹¶æ‰§è¡Œå®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-11"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼ŒSpring é€šè¿‡å°† &lt;code&gt;BeanFactory&lt;/code&gt;çš„åŠŸèƒ½åˆ†è§£ä¸ºå¤šä¸ªç‰¹å®šçš„å­æ¥å£ï¼Œå†é€šè¿‡ &lt;code&gt;ConfigurableListableBeanFactory&lt;/code&gt;è¿›è¡Œæ•´åˆï¼Œå®ç°äº†&lt;strong&gt;é«˜å†…èšã€ä½è€¦åˆ&lt;/strong&gt;çš„è®¾è®¡ã€‚è¿™ç§è®¾è®¡ä½¿å¾— Spring å®¹å™¨æ—¢å…·å¤‡äº†å¼ºå¤§çš„åŸºç¡€åŠŸèƒ½ï¼Œåˆä¿æŒäº†æé«˜çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°ç†è§£è¿™äº› BeanFactory å­æ¥å£çš„ä¸åŒä½œç”¨ã€‚&lt;/p&gt;
&lt;h2 id="beandefinitionregistry"&gt;BeanDefinitionRegistry
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;æ˜¯ Spring IoC å®¹å™¨ä¸­&lt;strong&gt;ç®¡ç† Bean å®šä¹‰ï¼ˆ&lt;code&gt;BeanDefinition&lt;/code&gt;ï¼‰çš„æ ¸å¿ƒæ³¨å†Œæ¥å£&lt;/strong&gt;ï¼Œå®ƒè´Ÿè´£æ³¨å†Œã€ç§»é™¤ã€æŸ¥è¯¢å’Œç®¡ç†æ‰€æœ‰ Bean çš„é…ç½®å…ƒæ•°æ®ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹è¡¨æ¸…æ™°åœ°å±•ç¤ºäº†å®ƒçš„æ ¸å¿ƒèŒè´£å’Œä¸»è¦å®ç°ç±»ã€‚&lt;/p&gt;
&lt;p&gt;| ç‰¹æ€§ç»´åº¦ | æ ¸å¿ƒè¯´æ˜ |&lt;/p&gt;
&lt;p&gt;| :&amp;mdash; | :&amp;mdash; | :&amp;mdash; |&lt;/p&gt;
&lt;p&gt;| &lt;strong&gt;æ ¸å¿ƒè§’è‰²&lt;/strong&gt; | Bean å®šä¹‰ï¼ˆ&lt;code&gt;BeanDefinition&lt;/code&gt;ï¼‰çš„æ³¨å†Œä¸­å¿ƒï¼Œæ˜¯ Spring IoC å®¹å™¨çš„â€œåå†Œâ€æˆ–â€œèŠ±åå†Œâ€ã€‚ |&lt;/p&gt;
&lt;p&gt;| &lt;strong&gt;ä¸»è¦èŒè´£&lt;/strong&gt; | æä¾›å¯¹ &lt;code&gt;BeanDefinition&lt;/code&gt;çš„&lt;strong&gt;å¢åˆ æ”¹æŸ¥&lt;/strong&gt;ç­‰æ“ä½œï¼Œæ˜¯ Spring å®¹å™¨ç®¡ç† Bean å…ƒæ•°æ®çš„ç»Ÿä¸€å…¥å£ã€‚ |&lt;/p&gt;
&lt;p&gt;| &lt;strong&gt;å…³é”®ç‰¹æ€§&lt;/strong&gt; | æ”¯æŒåˆ«åç®¡ç†ã€Bean å®šä¹‰è¦†ç›–ç­–ç•¥ã€åˆå¹¶çˆ¶å­ Bean å®šä¹‰ã€çº¿ç¨‹å®‰å…¨çš„æ³¨å†Œè¡¨æ“ä½œã€‚ |&lt;/p&gt;
&lt;p&gt;| &lt;strong&gt;æ ¸å¿ƒå®ç°&lt;/strong&gt; | &lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;ï¼ˆæœ€å¸¸ç”¨ï¼‰ã€&lt;code&gt;GenericApplicationContext&lt;/code&gt;ã€&lt;code&gt;SimpleBeanDefinitionRegistry&lt;/code&gt;ï¼ˆç”¨äºæµ‹è¯•ï¼‰ã€‚ |&lt;/p&gt;
&lt;h3 id="-æ ¸å¿ƒæ¥å£æ–¹æ³•"&gt;ğŸ’¡ æ ¸å¿ƒæ¥å£æ–¹æ³•
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;æ¥å£å®šä¹‰äº†ä¸€å¥—å®Œæ•´çš„æ–¹æ³•æ¥ç®¡ç† Bean å®šä¹‰ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ ¸å¿ƒæ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ³¨å†Œ Bean å®šä¹‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;void registerBeanDefinition(String beanName, BeanDefinition beanDefinition) throws BeanDefinitionStoreException;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç§»é™¤ Bean å®šä¹‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;void removeBeanDefinition(String beanName) throws NoSuchBeanDefinitionException;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·å– Bean å®šä¹‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;BeanDefinition getBeanDefinition(String beanName) throws NoSuchBeanDefinitionException;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥æ˜¯å¦å­˜åœ¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;boolean containsBeanDefinition(String beanName);&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·å–æ‰€æœ‰ Bean åç§°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;String[] getBeanDefinitionNames();&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·å– Bean å®šä¹‰æ•°é‡&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;int getBeanDefinitionCount();&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥åç§°æ˜¯å¦å·²ä½¿ç”¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;boolean isBeanNameInUse(String beanName);&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸»è¦å®ç°ç±»-2"&gt;ğŸ› ï¸ ä¸»è¦å®ç°ç±»
&lt;/h3&gt;&lt;p&gt;Spring æä¾›äº†å‡ ä¸ªé‡è¦çš„ &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;å®ç°ç±»ï¼Œé€‚ç”¨äºä¸åŒçš„åœºæ™¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;&lt;/strong&gt;ï¼šè¿™æ˜¯&lt;strong&gt;æœ€å¸¸ç”¨ã€åŠŸèƒ½æœ€å®Œæ•´&lt;/strong&gt;çš„å®ç°ã€‚å®ƒä¸ä»…æ˜¯ &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;ï¼Œè¿˜æ˜¯ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„ &lt;code&gt;BeanFactory&lt;/code&gt;ã€‚å®ƒå†…éƒ¨ä½¿ç”¨ &lt;code&gt;ConcurrentHashMap&lt;/code&gt;æ¥å­˜å‚¨ Bean å®šä¹‰ï¼Œç¡®ä¿äº†çº¿ç¨‹å®‰å…¨ã€‚Spring çš„åº”ç”¨ä¸Šä¸‹æ–‡ï¼ˆå¦‚ &lt;code&gt;AnnotationConfigApplicationContext&lt;/code&gt;ï¼‰å†…éƒ¨é€šå¸¸ä¹Ÿå§”æ‰˜ç»™å®ƒæ¥å¤„ç† Bean å®šä¹‰çš„æ³¨å†Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;GenericApplicationContext&lt;/code&gt;&lt;/strong&gt;ï¼šä½œä¸ºé€šç”¨çš„ &lt;code&gt;ApplicationContext&lt;/code&gt;ï¼Œå®ƒå®ç°äº† &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;æ¥å£ï¼Œä½†å…¶å†…éƒ¨å…³äº Bean å®šä¹‰æ³¨å†Œçš„å…·ä½“å®ç°é€šå¸¸&lt;strong&gt;å§”æ‰˜ç»™ä¸€ä¸ª &lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;&lt;/strong&gt; å®ä¾‹æ¥å®Œæˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;SimpleBeanDefinitionRegistry&lt;/code&gt;&lt;/strong&gt;ï¼šè¿™æ˜¯ä¸€ä¸ª&lt;strong&gt;ç®€å•çš„å®ç°&lt;/strong&gt;ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–å·¥å…·åœºæ™¯ã€‚å®ƒä»…æä¾›äº†åŸºæœ¬çš„æ³¨å†Œè¡¨åŠŸèƒ½ï¼Œä¸å…·å¤‡å®Œæ•´çš„ Bean å·¥å‚èƒ½åŠ›ï¼ˆå¦‚ä¾èµ–æ³¨å…¥ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å·¥ä½œåŸç†ä¸å†…éƒ¨ç»“æ„"&gt;âš™ï¸ å·¥ä½œåŸç†ä¸å†…éƒ¨ç»“æ„
&lt;/h3&gt;&lt;p&gt;ä»¥æœ€å¸¸ç”¨çš„ &lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;ä¸ºä¾‹ï¼Œå…¶å†…éƒ¨é€šè¿‡ä¸¤ä¸ªæ ¸å¿ƒæ•°æ®ç»“æ„æ¥ç®¡ç† Bean å®šä¹‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;beanDefinitionMap&lt;/code&gt;&lt;/strong&gt;ï¼šä¸€ä¸ª &lt;code&gt;ConcurrentHashMap&amp;lt;String, BeanDefinition&amp;gt;&lt;/code&gt;ï¼Œç”¨äºå­˜å‚¨ Bean åç§°ä¸ &lt;code&gt;BeanDefinition&lt;/code&gt;å¯¹è±¡çš„æ˜ å°„å…³ç³»ã€‚è¿™æ˜¯çœŸæ­£çš„å®šä¹‰å­˜å‚¨å®¹å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;beanDefinitionNames&lt;/code&gt;&lt;/strong&gt;ï¼šä¸€ä¸ª &lt;code&gt;ArrayList&amp;lt;String&amp;gt;&lt;/code&gt;ï¼ŒæŒ‰æ³¨å†Œé¡ºåºä¿å­˜æ‰€æœ‰ Bean çš„åç§°ã€‚è¿™ç»´æŠ¤äº† Bean çš„æ³¨å†Œé¡ºåºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æ³¨å†Œæµç¨‹&lt;/strong&gt;ï¼ˆæ‘˜è‡ª &lt;code&gt;DefaultListableBeanFactory.registerBeanDefinition&lt;/code&gt;æ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘ï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°æ ¡éªŒ&lt;/strong&gt;ï¼šæ£€æŸ¥ &lt;code&gt;beanName&lt;/code&gt;å’Œ &lt;code&gt;beanDefinition&lt;/code&gt;æ˜¯å¦ä¸ºç©ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰éªŒè¯&lt;/strong&gt;ï¼šå¦‚æœ &lt;code&gt;BeanDefinition&lt;/code&gt;æ˜¯ &lt;code&gt;AbstractBeanDefinition&lt;/code&gt;ç±»å‹ï¼Œä¼šè°ƒç”¨å…¶ &lt;code&gt;validate()&lt;/code&gt;æ–¹æ³•è¿›è¡Œæ ¡éªŒï¼Œä¾‹å¦‚æ£€æŸ¥æ–¹æ³•è¦†ç›–ï¼ˆ&lt;code&gt;lookup-method&lt;/code&gt;, &lt;code&gt;replaced-method&lt;/code&gt;ï¼‰å’Œå·¥å‚æ–¹æ³•æ˜¯å¦å†²çªã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç†è¦†ç›–&lt;/strong&gt;ï¼šæ£€æŸ¥è¯¥ &lt;code&gt;beanName&lt;/code&gt;æ˜¯å¦å·²å­˜åœ¨å®šä¹‰ã€‚
&lt;ul&gt;
&lt;li&gt;å¦‚æœå­˜åœ¨ï¼Œæ ¹æ® &lt;code&gt;isAllowBeanDefinitionOverriding()&lt;/code&gt;çš„é…ç½®å†³å®šæ˜¯æŠ›å‡ºå¼‚å¸¸è¿˜æ˜¯è¦†ç›–åŸæœ‰å®šä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å°†æ–°å®šä¹‰æ”¾å…¥ &lt;code&gt;beanDefinitionMap&lt;/code&gt;ï¼Œå¹¶å°† &lt;code&gt;beanName&lt;/code&gt;æ·»åŠ åˆ° &lt;code&gt;beanDefinitionNames&lt;/code&gt;åˆ—è¡¨ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€å¤„ç†&lt;/strong&gt;ï¼šæ ¹æ®å®¹å™¨æ˜¯å¦å·²å¼€å§‹åˆ›å»º Beanï¼ˆ&lt;code&gt;hasBeanCreationStarted()&lt;/code&gt;ï¼‰ï¼Œé‡‡ç”¨ä¸åŒçš„åŒæ­¥ç­–ç•¥æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸»è¦ä½œç”¨ä¸ä»·å€¼"&gt;ğŸ¯ ä¸»è¦ä½œç”¨ä¸ä»·å€¼
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;åœ¨ Spring æ¡†æ¶ä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ï¼Œå…¶æ ¸å¿ƒä»·å€¼ä½“ç°åœ¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºè§£æçš„ç»Ÿä¸€æ€§&lt;/strong&gt;ï¼šæ— è®º Bean å®šä¹‰æ¥è‡ª XMLã€æ³¨è§£è¿˜æ˜¯ Java é…ç½®ï¼Œæœ€ç»ˆéƒ½ä¼šè¢«è§£æä¸ºç»Ÿä¸€çš„ &lt;code&gt;BeanDefinition&lt;/code&gt;å¯¹è±¡å¹¶æ³¨å†Œåˆ° &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;ä¸­ã€‚è¿™ä½¿å¾— Spring å®¹å™¨èƒ½å¤Ÿä»¥ä¸€è‡´çš„æ–¹å¼å¤„ç†æ‰€æœ‰é…ç½®æºï¼Œé¿å…äº†ä¸ºæ¯ç§é…ç½®æ–¹å¼ç»´æŠ¤å•ç‹¬çš„æ•°æ®ç»“æ„ï¼Œé™ä½äº†å¤æ‚æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–æŸ¥æ‰¾å’Œæ³¨å…¥çš„ä¸­å¿ƒåŒ–&lt;/strong&gt;ï¼šå®ƒä¸ºä¾èµ–æŸ¥æ‰¾å’Œæ³¨å…¥æä¾›äº†ä¸€ä¸ªä¸­å¿ƒåŒ–çš„å­˜å‚¨åº“ã€‚å½“ Spring éœ€è¦æ³¨å…¥ä¸€ä¸ªä¾èµ–æ—¶ï¼Œå¯ä»¥ç›´æ¥ä»æ³¨å†Œè¡¨ä¸­å¿«é€ŸæŸ¥è¯¢å¯¹åº”çš„ &lt;code&gt;BeanDefinition&lt;/code&gt;ï¼Œè€Œæ— éœ€é‡æ–°è§£æåŸå§‹é…ç½®èµ„æºï¼Œæå‡äº†æ€§èƒ½å¹¶ç¡®ä¿äº†å‡†ç¡®æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¯æŒ Bean å®šä¹‰çš„åˆå¹¶&lt;/strong&gt;ï¼šåœ¨å¤„ç†çˆ¶å­ Bean å®šä¹‰ï¼ˆä¸»è¦åœ¨ XML é…ç½®ä¸­ï¼‰æ—¶ï¼Œ&lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;ï¼ˆå…·ä½“æ˜¯ &lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;ï¼‰è´Ÿè´£å°†å­å®šä¹‰å’Œçˆ¶å®šä¹‰åˆå¹¶ä¸ºä¸€ä¸ªå®Œæ•´çš„ &lt;code&gt;RootBeanDefinition&lt;/code&gt;ï¼Œè¿™ä¸ªåˆå¹¶åçš„å®šä¹‰åŒ…å«äº†åˆ›å»º Bean å®ä¾‹æ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®éªŒè¯&lt;/strong&gt;ï¼šæ‰€æœ‰ Bean å®šä¹‰æ³¨å†Œå®Œæˆåï¼ŒSpring å¯ä»¥åˆ©ç”¨æ³¨å†Œè¡¨è¿›è¡Œå…¨å±€çš„é…ç½®éªŒè¯ï¼Œä¾‹å¦‚æ£€æŸ¥å¾ªç¯ä¾èµ–ã€ç¡®ä¿ Bean å®šä¹‰çš„å®Œæ•´æ€§ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„åŸºç¡€&lt;/strong&gt;ï¼šå®ƒå­˜å‚¨äº† Bean çš„åˆå§‹åŒ–æ–¹æ³•ã€é”€æ¯æ–¹æ³•ç­‰ç”Ÿå‘½å‘¨æœŸå…ƒæ•°æ®ï¼Œä¸º Spring å®¹å™¨ç®¡ç† Bean çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸæä¾›äº†åŸºç¡€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•ä½¿ç”¨"&gt;ğŸ’» å¦‚ä½•ä½¿ç”¨
&lt;/h3&gt;&lt;p&gt;ä½ å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼ä½¿ç”¨ &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;æ¥åŠ¨æ€æ³¨å†Œ Beanï¼Œè¿™åœ¨éœ€è¦æ ¹æ®æ¡ä»¶æˆ–è¿è¡Œæ—¶ä¿¡æ¯æ¥æ³¨å†Œ Bean æ—¶éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.beans.factory.support.DefaultListableBeanFactory;
import org.springframework.beans.factory.support.RootBeanDefinition;
public class ManualRegistrationDemo {
public static void main(String[] args) {
// 1. åˆ›å»º BeanDefinitionRegistry (ä»¥ DefaultListableBeanFactory ä¸ºä¾‹)
DefaultListableBeanFactory registry = new DefaultListableBeanFactory();
// 2. åˆ›å»º BeanDefinitionï¼Œå¹¶è®¾ç½®å±æ€§ï¼ˆè¿™é‡Œä»¥ RootBeanDefinition ä¸ºä¾‹ï¼‰
RootBeanDefinition beanDefinition = new RootBeanDefinition(MyService.class);
beanDefinition.getPropertyValues().addPropertyValue(&amp;#34;message&amp;#34;, &amp;#34;Hello, Dynamic Bean!&amp;#34;);
// 3. æ³¨å†Œåˆ° Registry ä¸­
registry.registerBeanDefinition(&amp;#34;myService&amp;#34;, beanDefinition);
// 4. ä»å®¹å™¨ä¸­è·å–å¹¶ä½¿ç”¨ Bean
MyService myService = registry.getBean(&amp;#34;myService&amp;#34;, MyService.class);
myService.sayMessage(); // è¾“å‡º: Hello, Dynamic Bean!
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨æ›´é«˜çº§çš„åœºæ™¯ä¸­ï¼Œä½ å¯ä»¥å®ç° &lt;code&gt;ImportBeanDefinitionRegistrar&lt;/code&gt;æ¥å£ï¼Œåœ¨ Spring å®¹å™¨å¯åŠ¨æ—¶åŠ¨æ€æ³¨å†Œ Bean å®šä¹‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import org.springframework.beans.factory.support.BeanDefinitionRegistry;
import org.springframework.context.annotation.ImportBeanDefinitionRegistrar;
import org.springframework.core.type.AnnotationMetadata;
public class MyCustomRegistrar implements ImportBeanDefinitionRegistrar {
@Override
public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {
// åœ¨è¿™é‡Œå¯ä»¥æ ¹æ®æ³¨è§£å…ƒä¿¡æ¯åŠ¨æ€åˆ›å»ºå’Œæ³¨å†Œ BeanDefinition
RootBeanDefinition beanDefinition = new RootBeanDefinition(MyDynamicBean.class);
registry.registerBeanDefinition(&amp;#34;myDynamicBean&amp;#34;, beanDefinition);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-æ€»ç»“-12"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œ&lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;æ˜¯ Spring IoC å®¹å™¨&lt;strong&gt;ä¸å¯æˆ–ç¼ºçš„åŸºçŸ³&lt;/strong&gt;ã€‚å®ƒä½œä¸ºä¸€ä¸ªä¸­å¿ƒåŒ–çš„æ³¨å†Œè¡¨ï¼Œç»Ÿä¸€ç®¡ç†ç€æ‰€æœ‰ Bean çš„é…ç½®å…ƒæ•°æ®ï¼Œä¸ºåç»­çš„ Bean å®ä¾‹åŒ–ã€ä¾èµ–æ³¨å…¥å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚ç†è§£ &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;çš„å·¥ä½œåŸç†ï¼Œå¯¹äºæ·±å…¥æŒæ¡ Spring å®¹å™¨çš„å†…éƒ¨æœºåˆ¶è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ é€å½»ç†è§£ &lt;code&gt;BeanDefinitionRegistry&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id="beanpostprocessor"&gt;BeanPostProcessor
&lt;/h2&gt;&lt;p&gt;BeanPostProcessor æ˜¯ Spring æ¡†æ¶ä¸­ä¸€ä¸ªæå…¶é‡è¦çš„æ‰©å±•æ¥å£ï¼Œå®ƒå°±åƒä¸€ä½åœ¨ Bean è¯ç”Ÿè¿‡ç¨‹ä¸­è¿›è¡Œç²¾åŠ å·¥çš„â€œé­”æ³•å¸ˆâ€ï¼Œå…è®¸ä½ åœ¨æ¯ä¸ª Bean å®ä¾‹åˆå§‹åŒ–å‰åæ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œæ˜¯ Spring IoC å®¹å™¨å¼ºå¤§æ‰©å±•èƒ½åŠ›çš„æ ¸å¿ƒæ”¯æŸ±ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡å…¨å±€ï¼Œä¸‹è¡¨æ¸…æ™°åœ°å±•ç¤ºäº† Bean åˆ›å»ºè¿‡ç¨‹ä¸­çš„å…³é”®é˜¶æ®µåŠå…¶ä¸ &lt;code&gt;BeanPostProcessor&lt;/code&gt;çš„å…³è”ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒæ“ä½œ&lt;/th&gt;
&lt;th&gt;BeanPostProcessor çš„ä»‹å…¥ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;â‘  å®ä¾‹åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»º Bean å®ä¾‹&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;â‘¡ å±æ€§å¡«å……&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–æ³¨å…¥ï¼ˆå¦‚é€šè¿‡ &lt;code&gt;@Autowired&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;â‘¢ åˆå§‹åŒ–å‰å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Aware æ¥å£å›è°ƒ&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;BeanNameAware&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;postProcessBeforeInitialization&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;â‘£ åˆå§‹åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;@PostConstruct&lt;/code&gt;ã€&lt;code&gt;InitializingBean&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;â‘¤ åˆå§‹åŒ–åå¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;postProcessAfterInitialization&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;â‘¥ å°±ç»ª&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Bean å®Œå…¨åˆ›å»ºï¼Œå¯ä¾›ä½¿ç”¨&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;â‘¦ é”€æ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®¹å™¨å…³é—­ï¼Œè°ƒç”¨é”€æ¯æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;@PreDestroy&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒæ–¹æ³•ä¸æ‰§è¡Œæ—¶æœº"&gt;ğŸ’¡ æ ¸å¿ƒæ–¹æ³•ä¸æ‰§è¡Œæ—¶æœº
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;BeanPostProcessor&lt;/code&gt;æ¥å£ä¸»è¦å®šä¹‰äº†ä¸¤ä¸ªå›è°ƒæ–¹æ³•ï¼Œå®ƒä»¬å°±åƒä¸¤ä¸ªç²¾ç¡®çš„é’©å­ï¼ˆHookï¼‰ï¼ŒåµŒå…¥åœ¨ Bean çš„ç”Ÿå‘½å‘¨æœŸä¸­ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public interface BeanPostProcessor {
// åœ¨ Bean åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¦‚ @PostConstructï¼‰ä¹‹å‰è¢«è°ƒç”¨
default Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
return bean;
}
// åœ¨ Bean åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¦‚ @PostConstructï¼‰ä¹‹åè¢«è°ƒç”¨
default Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
return bean;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;postProcessBeforeInitialization&lt;/code&gt;&lt;/strong&gt;ï¼šè¯¥æ–¹æ³•åœ¨ Bean çš„åˆå§‹åŒ–å›è°ƒï¼ˆä¾‹å¦‚ &lt;code&gt;@PostConstruct&lt;/code&gt;æ³¨è§£çš„æ–¹æ³•ã€&lt;code&gt;InitializingBean&lt;/code&gt;æ¥å£çš„ &lt;code&gt;afterPropertiesSet&lt;/code&gt;æ–¹æ³•æˆ–è‡ªå®šä¹‰çš„ &lt;code&gt;init-method&lt;/code&gt;ï¼‰&lt;strong&gt;ä¹‹å‰&lt;/strong&gt;æ‰§è¡Œã€‚é€‚åˆè¿›è¡Œä¸€äº›å‰ç½®å¤„ç†ï¼Œå¦‚ä¿®æ”¹å±æ€§å€¼ã€è¿›è¡Œæ ¡éªŒç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;postProcessAfterInitialization&lt;/code&gt;&lt;/strong&gt;ï¼šè¯¥æ–¹æ³•åœ¨ Bean å®Œæˆæ‰€æœ‰åˆå§‹åŒ–å›è°ƒ&lt;strong&gt;ä¹‹å&lt;/strong&gt;æ‰§è¡Œã€‚è¿™æ˜¯å¯¹ Bean è¿›è¡Œæœ€ç»ˆåŠ å·¥çš„æœºä¼šï¼Œ&lt;strong&gt;Spring AOP åˆ›å»ºä»£ç†å¯¹è±¡å°±åœ¨è¿™ä¸ªé˜¶æ®µå®Œæˆ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-spring-å†…ç½®çš„å…³é”®å®ç°"&gt;ğŸ› ï¸ Spring å†…ç½®çš„å…³é”®å®ç°
&lt;/h3&gt;&lt;p&gt;Spring æ¡†æ¶è‡ªèº«çš„è®¸å¤šå¼ºå¤§åŠŸèƒ½æ­£æ˜¯é€šè¿‡å†…ç½®çš„ &lt;code&gt;BeanPostProcessor&lt;/code&gt;å®ç°çš„ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å®ç°ç±»&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒèŒè´£&lt;/th&gt;
&lt;th&gt;æ”¯æŒçš„æ³¨è§£/åŠŸèƒ½&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;AutowiredAnnotationBeanPostProcessor&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤„ç†ä¾èµ–æ³¨å…¥&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@Autowired&lt;/code&gt;, &lt;code&gt;@Value&lt;/code&gt;, &lt;code&gt;@Inject&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;CommonAnnotationBeanPostProcessor&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤„ç† JSR-250 å¸¸è§æ³¨è§£&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@PostConstruct&lt;/code&gt;, &lt;code&gt;@PreDestroy&lt;/code&gt;, &lt;code&gt;@Resource&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ApplicationContextAwareProcessor&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ³¨å…¥ Spring ä¸Šä¸‹æ–‡ç›¸å…³å¯¹è±¡&lt;/td&gt;
&lt;td&gt;å„ç§ &lt;code&gt;Aware&lt;/code&gt;æ¥å£ï¼ˆå¦‚ &lt;code&gt;ApplicationContextAware&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;AbstractAutoProxyCreator&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;AOP ä»£ç†åˆ›å»º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ºè¢« &lt;code&gt;@Aspect&lt;/code&gt;ç­‰æ³¨è§£çš„ Bean ç”Ÿæˆä»£ç†å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¦‚ä½•è‡ªå®šä¹‰-beanpostprocessor"&gt;ğŸ’» å¦‚ä½•è‡ªå®šä¹‰ BeanPostProcessor
&lt;/h3&gt;&lt;p&gt;åˆ›å»ºä½ è‡ªå·±çš„ &lt;code&gt;BeanPostProcessor&lt;/code&gt;éå¸¸ç®€å•ï¼Œåªéœ€å®ç°æ¥å£å¹¶å°†å…¶æ³¨å†Œåˆ° Spring å®¹å™¨å³å¯ã€‚&lt;/p&gt;
&lt;h4 id="1-å®ç°æ¥å£-2"&gt;1. å®ç°æ¥å£
&lt;/h4&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®ƒåœ¨æ¯ä¸ª Bean åˆå§‹åŒ–å‰åæ‰“å°æ—¥å¿—ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import org.springframework.beans.BeansException;
import org.springframework.beans.factory.config.BeanPostProcessor;
import org.springframework.stereotype.Component;
@Component
public class LoggingBeanPostProcessor implements BeanPostProcessor {
@Override
public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
System.out.println(&amp;#34;[Before Init] Bean Name: &amp;#34; + beanName + &amp;#34;, Type: &amp;#34; + bean.getClass().getSimpleName());
// ä½ å¯ä»¥åœ¨è¿™é‡Œå¯¹ bean è¿›è¡Œä¿®æ”¹æˆ–åŒ…è£…
return bean; // å¿…é¡»è¿”å› bean å¯¹è±¡ï¼ˆå¯ä»¥æ˜¯åŸå§‹å¯¹è±¡æˆ–åŒ…è£…åçš„å¯¹è±¡ï¼‰
}
@Override
public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
System.out.println(&amp;#34;[After Init] Bean Name: &amp;#34; + beanName + &amp;#34;, Type: &amp;#34; + bean.getClass().getSimpleName());
return bean;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="2-æ³¨å†Œåˆ°å®¹å™¨"&gt;2. æ³¨å†Œåˆ°å®¹å™¨
&lt;/h4&gt;&lt;p&gt;è®© Spring è¯†åˆ«ä½ çš„ &lt;code&gt;BeanPostProcessor&lt;/code&gt;ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;@Component&lt;/code&gt;ç­‰æ³¨è§£&lt;/strong&gt;ï¼šå¦‚ä¸Šä¾‹æ‰€ç¤ºï¼ŒSpring ä¼šè‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€šè¿‡ &lt;code&gt;@Bean&lt;/code&gt;åœ¨é…ç½®ç±»ä¸­æ˜¾å¼æ³¨å†Œ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ¯ å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;BeanPostProcessor&lt;/code&gt;çš„çµæ´»æ€§ä½¿å…¶èƒ½å¤Ÿåº”ç”¨äºå¤šç§åœºæ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ç° AOP åŠ¨æ€ä»£ç†&lt;/strong&gt;ï¼šSpring AOP çš„æ ¸å¿ƒ &lt;code&gt;AbstractAutoProxyCreator&lt;/code&gt;å°±æ˜¯ä¸€ä¸ª &lt;code&gt;BeanPostProcessor&lt;/code&gt;ï¼Œå®ƒåœ¨ &lt;code&gt;postProcessAfterInitialization&lt;/code&gt;æ–¹æ³•ä¸­ä¸ºåŒ¹é…åˆ‡ç‚¹çš„ Bean åˆ›å»ºä»£ç†å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç†è‡ªå®šä¹‰æ³¨è§£&lt;/strong&gt;ï¼šä½ å¯ä»¥åˆ©ç”¨å®ƒæ‰«æ Bean ä¸­çš„è‡ªå®šä¹‰æ³¨è§£ï¼ˆå¦‚ &lt;code&gt;@EncryptField&lt;/code&gt;ï¼‰ï¼Œå¹¶åœ¨åˆå§‹åŒ–é˜¶æ®µå¯¹æ³¨è§£å­—æ®µè¿›è¡ŒåŠ å¯†ç­‰å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç›‘æ§ä¸æ—¥å¿—&lt;/strong&gt;ï¼šå¯ä»¥åœ¨åˆå§‹åŒ–å‰åè®°å½•æ—¶é—´ç‚¹ï¼Œè®¡ç®— Bean çš„åˆ›å»ºè€—æ—¶ï¼Œç”¨äºæ€§èƒ½åˆ†æã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AB æµ‹è¯•è·¯ç”±&lt;/strong&gt;ï¼šå¦‚æœç´¢ç»“æœä¸­æåˆ°çš„æ¡ˆä¾‹ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªè·¯ç”±ä»£ç†ï¼Œæ ¹æ®é…ç½®åŠ¨æ€å†³å®šæ³¨å…¥å“ªä¸ªç‰ˆæœ¬çš„ Bean å®ç°ï¼Œä½¿ä¸šåŠ¡ä»£ç æ›´ç®€æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é‡è¦ä½¿ç”¨é¡»çŸ¥"&gt;âš ï¸ é‡è¦ä½¿ç”¨é¡»çŸ¥
&lt;/h3&gt;&lt;p&gt;åœ¨ä½¿ç”¨ &lt;code&gt;BeanPostProcessor&lt;/code&gt;æ—¶ï¼Œæœ‰å‡ ä¸ªå…³é”®ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨èŒƒå›´&lt;/strong&gt;ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œä½ å®ç°çš„ &lt;code&gt;BeanPostProcessor&lt;/code&gt;ä¼š&lt;strong&gt;ä½œç”¨äºå®¹å™¨ä¸­çš„æ¯ä¸€ä¸ª Bean&lt;/strong&gt;ã€‚å¦‚æœåªæƒ³å¤„ç†ç‰¹å®šç±»å‹çš„ Beanï¼Œéœ€è¦åœ¨æ–¹æ³•å†…éƒ¨è¿›è¡Œåˆ¤æ–­ï¼ˆä¾‹å¦‚ &lt;code&gt;if (bean instanceof MyService)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œé¡ºåº&lt;/strong&gt;ï¼šå½“å­˜åœ¨å¤šä¸ª &lt;code&gt;BeanPostProcessor&lt;/code&gt;æ—¶ï¼Œå®ƒä»¬çš„æ‰§è¡Œé¡ºåºå¾ˆé‡è¦ã€‚ä½ å¯ä»¥é€šè¿‡å®ç° &lt;code&gt;PriorityOrdered&lt;/code&gt;æˆ– &lt;code&gt;Ordered&lt;/code&gt;æ¥å£ï¼Œæˆ–ä½¿ç”¨ &lt;code&gt;@Order&lt;/code&gt;æ³¨è§£æ¥æ§åˆ¶é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æå‰åˆå§‹åŒ–&lt;/strong&gt;ï¼šSpring å®¹å™¨ä¼š&lt;strong&gt;ä¼˜å…ˆåˆå§‹åŒ–æ‰€æœ‰çš„ &lt;code&gt;BeanPostProcessor&lt;/code&gt;&lt;/strong&gt;ï¼Œç„¶åå†åˆå§‹åŒ–å…¶ä»–æ™®é€šçš„ Beanã€‚å› æ­¤ï¼Œåœ¨ &lt;code&gt;BeanPostProcessor&lt;/code&gt;ä¸­ä¾èµ–å…¶ä»–æ™®é€š Bean æ—¶éœ€è¦å°å¿ƒå¾ªç¯ä¾èµ–é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;ï¼šä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•éƒ½å¿…é¡»è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ˆé€šå¸¸æ˜¯ä¼ å…¥çš„ &lt;code&gt;bean&lt;/code&gt;æœ¬èº«ï¼Œä¹Ÿå¯èƒ½æ˜¯å…¶åŒ…è£…ç±»ï¼Œå¦‚ä»£ç†å¯¹è±¡ï¼‰ã€‚&lt;strong&gt;ä¸è¦è¿”å› &lt;code&gt;null&lt;/code&gt;&lt;/strong&gt;ï¼Œå¦åˆ™ä¼šç ´ååç»­å¤„ç†æµç¨‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-13"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œ&lt;code&gt;BeanPostProcessor&lt;/code&gt;æ˜¯ Spring æ¡†æ¶ä¸ºå¼€å‘è€…æä¾›çš„ä¸€æŠŠåˆ©å™¨ï¼Œå®ƒé€šè¿‡ä»‹å…¥ Bean ç”Ÿå‘½å‘¨æœŸçš„å…³é”®èŠ‚ç‚¹ï¼Œå®ç°äº†æ§åˆ¶åè½¬å®¹å™¨çš„é«˜åº¦å¯æ‰©å±•æ€§ã€‚æ— è®ºæ˜¯ Spring è‡ªèº«çš„ AOPã€äº‹åŠ¡ç®¡ç†ç­‰é«˜çº§åŠŸèƒ½ï¼Œè¿˜æ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­çš„å„ç§å®šåˆ¶åŒ–éœ€æ±‚ï¼Œéƒ½ç¦»ä¸å¼€å®ƒçš„æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£å¹¶æœ‰æ•ˆè¿ç”¨ &lt;code&gt;BeanPostProcessor&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id="åˆå§‹åŒ–é¡ºåº"&gt;åˆå§‹åŒ–é¡ºåº
&lt;/h2&gt;&lt;p&gt;äº†è§£ Spring Bean åˆå§‹åŒ–æ–¹æ³•çš„æ‰§è¡Œé¡ºåºå’ŒèƒŒåçš„åŸå› ï¼Œå¯¹ç¼–å†™å¯é ä»£ç å¾ˆé‡è¦ã€‚é€šè¿‡ä¸‹é¢çš„è¡¨æ ¼å’Œè®²è§£ï¼Œä½ ä¼šæ˜ç™½ä¸ºä»€ä¹ˆå®ƒä»¬çš„é¡ºåºæ˜¯å›ºå®šçš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒä¿¡æ¯ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æ¦‚æ‹¬è¿™ä¸‰ç§åˆå§‹åŒ–æœºåˆ¶çš„å…³é”®ç‚¹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åˆå§‹åŒ–æœºåˆ¶&lt;/th&gt;
&lt;th&gt;æ‰§è¡Œæ—¶æœºï¼ˆé¡ºåºï¼‰&lt;/th&gt;
&lt;th&gt;å¤„ç†æ–¹å¼&lt;/th&gt;
&lt;th&gt;ä¸»è¦ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;@PostConstruct&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€æ—©&lt;/td&gt;
&lt;td&gt;ç”± &lt;code&gt;CommonAnnotationBeanPostProcessor&lt;/code&gt;åœ¨ &lt;code&gt;postProcessBeforeInitialization&lt;/code&gt;é˜¶æ®µé€šè¿‡&lt;strong&gt;åå°„&lt;/strong&gt;è°ƒç”¨&lt;/td&gt;
&lt;td&gt;åŸºäº JSR-250 æ ‡å‡†æ³¨è§£ï¼Œä¸ Spring æ¡†æ¶&lt;strong&gt;è§£è€¦&lt;/strong&gt;ï¼Œæ¨èä½¿ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;InitializingBean&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¶æ¬¡&lt;/td&gt;
&lt;td&gt;Spring å®¹å™¨ç›´æ¥è°ƒç”¨æ¥å£çš„ &lt;code&gt;afterPropertiesSet()&lt;/code&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Spring åŸç”Ÿæ¥å£ï¼Œä¸æ¡†æ¶&lt;strong&gt;è€¦åˆ&lt;/strong&gt;è¾ƒç´§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;init-method&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€æ™š&lt;/td&gt;
&lt;td&gt;Spring å®¹å™¨é€šè¿‡&lt;strong&gt;åå°„&lt;/strong&gt;è°ƒç”¨é…ç½®ä¸­æŒ‡å®šçš„æ–¹æ³•&lt;/td&gt;
&lt;td&gt;é€šè¿‡é…ç½®æŒ‡å®šï¼Œ&lt;strong&gt;æ— éœ€ä¿®æ”¹æºç &lt;/strong&gt;ï¼Œçµæ´»æ€§é«˜ï¼Œå¸¸ç”¨äºé›†æˆç¬¬ä¸‰æ–¹åº“&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-spring-å®¹å™¨åˆå§‹åŒ–-bean-çš„æµç¨‹"&gt;ğŸ” Spring å®¹å™¨åˆå§‹åŒ– Bean çš„æµç¨‹
&lt;/h3&gt;&lt;p&gt;è¦ç†è§£é¡ºåºï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ Spring åœ¨åˆ›å»ºä¸€ä¸ª Bean å¹¶å®Œæˆä¾èµ–æ³¨å…¥åï¼Œå¦‚ä½•æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®ä¾‹åŒ– &amp;amp; å±æ€§æ³¨å…¥&lt;/strong&gt;ï¼šå®¹å™¨é€šè¿‡æ„é€ å™¨åˆ›å»º Bean å®ä¾‹ï¼Œå¹¶é€šè¿‡åå°„å®Œæˆå±æ€§æ³¨å…¥ï¼ˆå¦‚ &lt;code&gt;@Autowired&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Aware æ¥å£å›è°ƒ&lt;/strong&gt;ï¼šå¦‚æœ Bean å®ç°äº†å„ç§ &lt;code&gt;Aware&lt;/code&gt;æ¥å£ï¼ˆå¦‚ &lt;code&gt;BeanNameAware&lt;/code&gt;ï¼‰ï¼Œæ­¤æ—¶ä¼šå›è°ƒå…¶æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BeanPostProcessor å‰ç½®å¤„ç†&lt;/strong&gt;ï¼šè¿™æ˜¯ &lt;strong&gt;&lt;code&gt;@PostConstruct&lt;/code&gt;æ‰§è¡Œçš„åœ°æ–¹&lt;/strong&gt;ã€‚æ‰€æœ‰ &lt;code&gt;BeanPostProcessor&lt;/code&gt;çš„ &lt;code&gt;postProcessBeforeInitialization&lt;/code&gt;æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚å…¶ä¸­ï¼Œ&lt;code&gt;CommonAnnotationBeanPostProcessor&lt;/code&gt;ä¼šæ£€æŸ¥ Bean çš„æ–¹æ³•æ˜¯å¦è¢« &lt;code&gt;@PostConstruct&lt;/code&gt;æ ‡æ³¨ï¼Œå¦‚æœæœ‰ï¼Œåˆ™é€šè¿‡&lt;strong&gt;åå°„&lt;/strong&gt;è°ƒç”¨å®ƒä»¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼ŒSpring æ£€æŸ¥ Bean æ˜¯å¦å®ç°äº† &lt;code&gt;InitializingBean&lt;/code&gt;æ¥å£ã€‚å¦‚æœæ˜¯ï¼Œåˆ™&lt;strong&gt;ç›´æ¥è°ƒç”¨&lt;/strong&gt;å…¶ &lt;code&gt;afterPropertiesSet()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;æ¥ç€ï¼ŒSpring æ£€æŸ¥ Bean çš„å®šä¹‰ä¸­æ˜¯å¦é…ç½®äº†è‡ªå®šä¹‰çš„ &lt;code&gt;init-method&lt;/code&gt;ã€‚å¦‚æœæœ‰ï¼Œåˆ™é€šè¿‡&lt;strong&gt;åå°„&lt;/strong&gt;è°ƒç”¨è¯¥æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BeanPostProcessor åç½®å¤„ç†&lt;/strong&gt;ï¼šæ‰€æœ‰ &lt;code&gt;BeanPostProcessor&lt;/code&gt;çš„ &lt;code&gt;postProcessAfterInitialization&lt;/code&gt;æ–¹æ³•è¢«è°ƒç”¨ã€‚&lt;strong&gt;AOP ä»£ç†é€šå¸¸åœ¨æ­¤é˜¶æ®µç”Ÿæˆ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Bean å°±ç»ª&lt;/strong&gt;ï¼šæ­¤æ—¶ Bean å·²å®Œå…¨åˆå§‹åŒ–ï¼Œå¯è¢«åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› æ­¤ï¼Œé¡ºåº &lt;strong&gt;&lt;code&gt;@PostConstruct&lt;/code&gt;â†’ &lt;code&gt;InitializingBean&lt;/code&gt;â†’ &lt;code&gt;init-method&lt;/code&gt;&lt;/strong&gt; æ˜¯ç”± Spring çš„ç”Ÿå‘½å‘¨æœŸæµç¨‹&lt;strong&gt;ä¸¥æ ¼å®šä¹‰&lt;/strong&gt;çš„ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ºä½•æ˜¯è¿™ä¸ªé¡ºåº"&gt;ğŸ’¡ ä¸ºä½•æ˜¯è¿™ä¸ªé¡ºåºï¼Ÿ
&lt;/h3&gt;&lt;p&gt;è¿™ä¸ªé¡ºåºä½“ç°äº† Spring çš„è®¾è®¡å“²å­¦å’Œæƒè¡¡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@PostConstruct&lt;/code&gt;æœ€å…ˆï¼ˆæœ€æ¨èï¼‰&lt;/strong&gt;ï¼šå› ä¸ºå®ƒåŸºäº &lt;strong&gt;JSR-250 æ ‡å‡†&lt;/strong&gt;ï¼Œè€Œé Spring ç‰¹æœ‰ã€‚è¿™å‡å°‘äº†ä»£ç ä¸ Spring æ¡†æ¶çš„è€¦åˆï¼Œæ„å‘³ç€ä½ çš„åˆå§‹åŒ–é€»è¾‘æ›´ä¾¿æºã€‚Spring é€šè¿‡ &lt;code&gt;BeanPostProcessor&lt;/code&gt;è¿™ç§&lt;strong&gt;æ‰©å±•æœºåˆ¶&lt;/strong&gt;æ¥æ”¯æŒå®ƒï¼Œè€Œ &lt;code&gt;BeanPostProcessor&lt;/code&gt;æœ¬èº«çš„æ‰§è¡Œå°±åœ¨ç›´æ¥çš„åˆå§‹åŒ–æ–¹æ³•è°ƒç”¨ä¹‹å‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;InitializingBean&lt;/code&gt;å…¶æ¬¡&lt;/strong&gt;ï¼šè¿™æ˜¯ä¸€ä¸ª Spring çš„&lt;strong&gt;åŸç”Ÿæ¥å£&lt;/strong&gt;ã€‚å®ç°å®ƒå°±æ„å‘³ç€ä½ çš„ä»£ç å’Œ Spring æ¡†æ¶ç»‘å®šäº†ã€‚å®ƒçš„è°ƒç”¨æ˜¯ Spring ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„ä¸€éƒ¨åˆ†ï¼Œç›´æ¥ä¸”é«˜æ•ˆï¼Œä½†ç‰ºç‰²äº†çµæ´»æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;init-method&lt;/code&gt;æœ€åï¼ˆæœ€çµæ´»ï¼‰&lt;/strong&gt;ï¼šå®ƒé€šè¿‡&lt;strong&gt;å¤–éƒ¨é…ç½®&lt;/strong&gt;æŒ‡å®šæ–¹æ³•åï¼Œ&lt;strong&gt;å®Œå…¨ä¸éœ€è¦ä¿®æ”¹ Bean çš„æºä»£ç &lt;/strong&gt;ã€‚è¿™ç§è§£è€¦ä½¿å¾—å®ƒä¸ºé›†æˆé‚£äº›ä½ æ— æ³•ä¿®æ”¹æºç çš„ç¬¬ä¸‰æ–¹åº“æä¾›äº†æå¤§çš„ä¾¿åˆ©ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©-1"&gt;ğŸ› ï¸ å¦‚ä½•é€‰æ‹©ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;äº†è§£åŸç†åï¼Œåœ¨å®é™…å¼€å‘ä¸­å¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¦–é€‰ &lt;code&gt;@PostConstruct&lt;/code&gt;&lt;/strong&gt;ï¼šé€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯ï¼Œç‰¹åˆ«æ˜¯ç°ä»£åŸºäºæ³¨è§£çš„ Spring Boot åº”ç”¨ã€‚å®ƒ&lt;strong&gt;ä»£ç ä¾µå…¥æ€§ä½&lt;/strong&gt;ï¼Œç¬¦åˆ Java æ ‡å‡†ï¼Œæ¸…æ™°ç›´è§‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ…ç”¨ &lt;code&gt;InitializingBean&lt;/code&gt;&lt;/strong&gt;ï¼šé™¤ééœ€è¦ä¸ Spring çš„æŸäº›ç”Ÿå‘½å‘¨æœŸ&lt;strong&gt;ç´§å¯†é›†æˆ&lt;/strong&gt;ï¼Œé€šå¸¸æ›´æ¨èä½¿ç”¨ &lt;code&gt;@PostConstruct&lt;/code&gt;ï¼Œå› ä¸ºå®ƒèƒ½é¿å…ä»£ç ä¸ Spring æ¡†æ¶çš„è€¦åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ç”¨ &lt;code&gt;init-method&lt;/code&gt;&lt;/strong&gt;ï¼šå½“éœ€è¦ä¸º&lt;strong&gt;ç¬¬ä¸‰æ–¹åº“&lt;/strong&gt;çš„ç±»æ·»åŠ åˆå§‹åŒ–é€»è¾‘ï¼Œæˆ–è€…ä½ å¸Œæœ›åˆå§‹åŒ–æ–¹æ³•åèƒ½é€šè¿‡&lt;strong&gt;å¤–éƒ¨é…ç½®&lt;/strong&gt;çµæ´»æŒ‡å®šæ—¶ï¼Œå®ƒéå¸¸æœ‰ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…åœ¨åŒä¸€ä¸ª Bean ä¸­æ··åˆä½¿ç”¨å¤šç§æ–¹å¼&lt;/strong&gt;ï¼šè¿™ä¼šä½¿åˆå§‹åŒ–é€»è¾‘åˆ†æ•£ï¼Œé™ä½å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚é€šå¸¸&lt;strong&gt;é€‰æ‹©ä¸€ç§&lt;/strong&gt;å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹åŒ–ä¸­çš„å¼‚å¸¸&lt;/strong&gt;ï¼šå¦‚æœåˆå§‹åŒ–æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œä¼šé˜»æ­¢ Bean çš„åˆ›å»ºï¼Œå¯èƒ½å¯¼è‡´åº”ç”¨ä¸Šä¸‹æ–‡å¯åŠ¨å¤±è´¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸå‹ Bean&lt;/strong&gt;ï¼šå¯¹äºä½œç”¨åŸŸä¸º &lt;code&gt;prototype&lt;/code&gt;çš„ Beanï¼Œå…¶åˆå§‹åŒ–æ–¹æ³•æ¯æ¬¡éƒ½ä¼šåœ¨è·å–æ–°å®ä¾‹æ—¶è°ƒç”¨ï¼Œä½† Spring ä¸ç®¡ç†å…¶é”€æ¯ç”Ÿå‘½å‘¨æœŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£ Spring Bean çš„åˆå§‹åŒ–æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h2 id="refresh"&gt;refresh()
&lt;/h2&gt;&lt;p&gt;ApplicationContext çš„ &lt;code&gt;refresh()&lt;/code&gt;æ–¹æ³•æ˜¯ Spring IoC å®¹å™¨å¯åŠ¨çš„æ ¸å¿ƒæµç¨‹ï¼Œå®ƒå°±åƒ Spring åº”ç”¨çš„å¯åŠ¨å¼•æ“ï¼ŒæŒ‰æ­¥éª¤å®Œæˆä»é…ç½®åŠ è½½åˆ°åº”ç”¨å®Œå…¨å°±ç»ªçš„æ‰€æœ‰å…³é”®ä»»åŠ¡ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹å›¾æ¸…æ™°åœ°å±•ç¤ºäº†è¿™ä¸ªæµç¨‹çš„12ä¸ªæ ¸å¿ƒæ­¥éª¤åŠå…¶ä¸»è¦å·¥ä½œï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;flowchart TD
A[å¼€å§‹ refresh()] --&amp;gt; B[prepareRefresh()&amp;lt;br&amp;gt;å‡†å¤‡åˆ·æ–°]
B --&amp;gt; C[obtainFreshBeanFactory()&amp;lt;br&amp;gt;è·å–BeanFactory]
C --&amp;gt; D[prepareBeanFactory()&amp;lt;br&amp;gt;é…ç½®BeanFactory]
D --&amp;gt; E[postProcessBeanFactory()&amp;lt;br&amp;gt;å­ç±»æ‰©å±•]
E --&amp;gt; F[invokeBeanFactoryPostProcessors()&amp;lt;br&amp;gt;æ‰§è¡ŒBeanå·¥å‚åå¤„ç†å™¨]
F --&amp;gt; G[registerBeanPostProcessors()&amp;lt;br&amp;gt;æ³¨å†ŒBeanåå¤„ç†å™¨]
G --&amp;gt; H[initMessageSource()&amp;lt;br&amp;gt;åˆå§‹åŒ–æ¶ˆæ¯æº]
H --&amp;gt; I[initApplicationEventMulticaster()&amp;lt;br&amp;gt;åˆå§‹åŒ–äº‹ä»¶å¹¿æ’­å™¨]
I --&amp;gt; J[onRefresh()&amp;lt;br&amp;gt;å­ç±»æ‰©å±•]
J --&amp;gt; K[registerListeners()&amp;lt;br&amp;gt;æ³¨å†Œç›‘å¬å™¨]
K --&amp;gt; L[finishBeanFactoryInitialization()&amp;lt;br&amp;gt;åˆå§‹åŒ–å•ä¾‹Bean]
L --&amp;gt; M[finishRefresh()&amp;lt;br&amp;gt;å®Œæˆåˆ·æ–°]
M --&amp;gt; N[å®¹å™¨å°±ç»ª]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†è§£ææ¯ä¸ªé˜¶æ®µçš„æ ¸å¿ƒå·¥ä½œã€‚&lt;/p&gt;
&lt;h3 id="-ç¬¬ä¸€é˜¶æ®µç¯å¢ƒå‡†å¤‡ä¸-beanfactory-åˆå§‹åŒ–"&gt;ğŸ’¡ ç¬¬ä¸€é˜¶æ®µï¼šç¯å¢ƒå‡†å¤‡ä¸ BeanFactory åˆå§‹åŒ–
&lt;/h3&gt;&lt;p&gt;è¿™ä¸€é˜¶æ®µä¸»è¦å®Œæˆå®¹å™¨å¯åŠ¨å‰çš„â€œåŸºå»ºâ€å·¥ä½œï¼Œä¸ºåç»­çš„ Bean åŠ è½½å’Œå®ä¾‹åŒ–æ­å»ºèˆå°ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;prepareRefresh()&lt;/code&gt;- å‡†å¤‡åˆ·æ–°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ–¹æ³•æ˜¯åˆ·æ–°è¿‡ç¨‹çš„èµ·ç‚¹ï¼Œä¸»è¦è´Ÿè´£åˆå§‹åŒ–ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚å®ƒä¼šè®¾ç½®å®¹å™¨çš„å¯åŠ¨æ—¶é—´æˆ³å’Œæ´»è·ƒçŠ¶æ€ï¼Œåˆå§‹åŒ– &lt;strong&gt;&lt;code&gt;Environment&lt;/code&gt;&lt;/strong&gt; å¯¹è±¡ï¼ˆè¯¥å¯¹è±¡ç®¡ç†ç€ç³»ç»Ÿå±æ€§ã€ç¯å¢ƒå˜é‡å’Œè‡ªå®šä¹‰é…ç½®æ–‡ä»¶ç­‰å±æ€§æºï¼‰ï¼Œå¹¶å¯¹å¿…è¦çš„å±æ€§è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿åç»­æµç¨‹èƒ½åœ¨ä¸€ä¸ªå®šä¹‰è‰¯å¥½çš„ç¯å¢ƒä¸‹è¿›è¡Œ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;obtainFreshBeanFactory()&lt;/code&gt;- è·å– BeanFactory&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œå®¹å™¨ä¼š&lt;strong&gt;åˆ›å»ºæˆ–åˆ·æ–°å…¶å†…éƒ¨çš„ &lt;code&gt;BeanFactory&lt;/code&gt;&lt;/strong&gt;ï¼ˆé€šå¸¸æ˜¯ &lt;code&gt;DefaultListableBeanFactory&lt;/code&gt;ï¼‰ã€‚è¿™ä¸ª &lt;code&gt;BeanFactory&lt;/code&gt;æ˜¯ Spring å®¹å™¨çœŸæ­£ç®¡ç† Bean çš„â€œå·¥ä½œå°â€ã€‚æ ¸å¿ƒä»»åŠ¡æ˜¯åŠ è½½é…ç½®æºï¼ˆå¦‚ XML æ–‡ä»¶æˆ–æ³¨è§£é…ç½®ç±»ï¼‰ï¼Œå°†å…¶è§£æä¸ºä¸€ä¸ªä¸ª &lt;strong&gt;&lt;code&gt;BeanDefinition&lt;/code&gt;&lt;/strong&gt; å¯¹è±¡ï¼Œå¹¶å°†è¿™äº› Bean çš„â€œè“å›¾â€æ³¨å†Œåˆ° &lt;code&gt;BeanFactory&lt;/code&gt;ä¸­ ã€‚ä½ å¯ä»¥å°†å…¶ç†è§£ä¸ºå°†æ‰€æœ‰é›¶ä»¶çš„è®¾è®¡å›¾çº¸å½•å…¥å·¥å‚çš„æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;prepareBeanFactory()&lt;/code&gt;- é…ç½® BeanFactory&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è·å–åˆ°åŸºç¡€çš„ &lt;code&gt;BeanFactory&lt;/code&gt;åï¼Œæ­¤æ­¥éª¤ä¼šå¯¹å…¶è¿›è¡Œâ€œç²¾è£…ä¿®â€ã€‚å®ƒé…ç½®äº†ç±»åŠ è½½å™¨ã€&lt;strong&gt;SPELè¡¨è¾¾å¼è§£æå™¨&lt;/strong&gt;ã€å±æ€§ç¼–è¾‘å™¨ç­‰å¿…è¦ç»„ä»¶ã€‚åŒæ—¶ï¼Œå®ƒä¼šæ³¨å†Œä¸€äº›å…³é”®çš„&lt;strong&gt;å†…ç½® &lt;code&gt;BeanPostProcessor&lt;/code&gt;&lt;/strong&gt;ï¼Œä¾‹å¦‚ç”¨äºå¤„ç† &lt;code&gt;Aware&lt;/code&gt;æ¥å£çš„ &lt;code&gt;ApplicationContextAwareProcessor&lt;/code&gt;ï¼Œä¸ºå®¹å™¨çš„é«˜çº§åŠŸèƒ½æ‰“ä¸‹åŸºç¡€ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;postProcessBeanFactory()&lt;/code&gt;- BeanFactory åç½®å¤„ç†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ª&lt;strong&gt;é¢„ç•™çš„æ¨¡æ¿æ–¹æ³•&lt;/strong&gt;ï¼Œå…è®¸å…·ä½“çš„ &lt;code&gt;ApplicationContext&lt;/code&gt;å­ç±»ï¼ˆå¦‚ç”¨äº Web ç¯å¢ƒçš„å®ç°ï¼‰æ ¹æ®è‡ªèº«éœ€æ±‚ï¼Œå¯¹ &lt;code&gt;BeanFactory&lt;/code&gt;è¿›è¡Œè¿›ä¸€æ­¥çš„å®šåˆ¶ï¼Œä¾‹å¦‚æ³¨å†Œæ–°çš„ä½œç”¨åŸŸï¼ˆScopeï¼‰å¦‚ &lt;code&gt;request&lt;/code&gt;æˆ– &lt;code&gt;session&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ç¬¬äºŒé˜¶æ®µæ‰©å±•ç‚¹è°ƒç”¨ä¸åŠŸèƒ½ç»„ä»¶åˆå§‹åŒ–"&gt;ğŸ”§ ç¬¬äºŒé˜¶æ®µï¼šæ‰©å±•ç‚¹è°ƒç”¨ä¸åŠŸèƒ½ç»„ä»¶åˆå§‹åŒ–
&lt;/h3&gt;&lt;p&gt;åœ¨ Bean å®ä¾‹åŒ–ä¹‹å‰ï¼ŒSpring æä¾›äº†å¼ºå¤§çš„æ‰©å±•æœºåˆ¶ï¼Œå…è®¸å¼€å‘è€…ä»‹å…¥å®¹å™¨çš„é…ç½®è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;invokeBeanFactoryPostProcessors()&lt;/code&gt;- è°ƒç”¨ BeanFactory åå¤„ç†å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ Spring æ¡†æ¶ä¸­ä¸€ä¸ª&lt;strong&gt;æå…¶é‡è¦çš„æ‰©å±•ç‚¹&lt;/strong&gt;ã€‚æ­¤æ­¥éª¤ä¼šå®ä¾‹åŒ–å¹¶è°ƒç”¨æ‰€æœ‰ &lt;code&gt;BeanFactoryPostProcessor&lt;/code&gt;çš„å®ç°ã€‚è¿™äº›å¤„ç†å™¨æœ‰æƒåœ¨ Bean å®ä¾‹åŒ–&lt;strong&gt;ä¹‹å‰&lt;/strong&gt;ï¼Œ&lt;strong&gt;ä¿®æ”¹&lt;/strong&gt;å·²æ³¨å†Œçš„ &lt;code&gt;BeanDefinition&lt;/code&gt;ã€‚æœ€å…¸å‹çš„ä¾‹å­æ˜¯ &lt;code&gt;ConfigurationClassPostProcessor&lt;/code&gt;ï¼Œå®ƒè´Ÿè´£è§£æ &lt;code&gt;@Configuration&lt;/code&gt;ã€&lt;code&gt;@Bean&lt;/code&gt;ç­‰æ³¨è§£ï¼›ä»¥åŠ &lt;code&gt;PropertySourcesPlaceholderConfigurer&lt;/code&gt;ï¼Œç”¨äºè§£æ &lt;code&gt;${...}&lt;/code&gt;å ä½ç¬¦ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;registerBeanPostProcessors()&lt;/code&gt;- æ³¨å†Œ Bean åå¤„ç†å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ­¥éª¤è´Ÿè´£ä» &lt;code&gt;BeanFactory&lt;/code&gt;ä¸­æŸ¥æ‰¾æ‰€æœ‰ &lt;code&gt;BeanPostProcessor&lt;/code&gt;çš„å®ç°ï¼Œå¹¶å°†å®ƒä»¬æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œåªæ˜¯&lt;strong&gt;æ³¨å†Œ&lt;/strong&gt;ï¼ŒçœŸæ­£çš„è°ƒç”¨å‘ç”Ÿåœ¨åç»­ Bean çš„å®ä¾‹åŒ–è¿‡ç¨‹ä¸­ã€‚&lt;code&gt;BeanPostProcessor&lt;/code&gt;æ˜¯å½±å“ Bean ç”Ÿå‘½å‘¨æœŸçš„å¦ä¸€ä¸ªå…³é”®æ‰©å±•ç‚¹ï¼Œå¸¸ç”¨äºå¤„ç†ä¾èµ–æ³¨å…¥ï¼ˆå¦‚ &lt;code&gt;@Autowired&lt;/code&gt;ï¼‰ã€AOP ä»£ç†åˆ›å»ºç­‰ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;initMessageSource()&lt;/code&gt;- åˆå§‹åŒ–å›½é™…åŒ–æ¶ˆæ¯æº&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ­¥éª¤ä¸ºå®¹å™¨æä¾›&lt;strong&gt;å›½é™…åŒ–ï¼ˆi18nï¼‰&lt;/strong&gt; æ”¯æŒã€‚å®ƒä¼šæŸ¥æ‰¾åä¸º &lt;code&gt;messageSource&lt;/code&gt;çš„ Beanï¼Œå¦‚æœå­˜åœ¨åˆ™ä½¿ç”¨å®ƒï¼Œå¦åˆ™ä¼šåˆå§‹åŒ–ä¸€ä¸ªé»˜è®¤çš„å®ç°ï¼Œç”¨äºè§£æä¸åŒè¯­è¨€ç¯å¢ƒçš„æ¶ˆæ¯ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;initApplicationEventMulticaster()&lt;/code&gt;- åˆå§‹åŒ–åº”ç”¨äº‹ä»¶å¹¿æ’­å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ­¥éª¤åˆå§‹åŒ–äº† Spring &lt;strong&gt;äº‹ä»¶é©±åŠ¨æ¨¡å‹&lt;/strong&gt;çš„æ ¸å¿ƒç»„ä»¶â€”â€”äº‹ä»¶å¹¿æ’­å™¨ã€‚åŒæ ·ï¼Œå®ƒä¼šå°è¯•æŸ¥æ‰¾åä¸º &lt;code&gt;applicationEventMulticaster&lt;/code&gt;çš„ Beanï¼Œè‹¥æœªæ‰¾åˆ°åˆ™ä½¿ç”¨é»˜è®¤çš„ &lt;code&gt;SimpleApplicationEventMulticaster&lt;/code&gt;ã€‚è¿™ä¸ªå¹¿æ’­å™¨è´Ÿè´£å°†å‘å¸ƒçš„äº‹ä»¶é€šçŸ¥ç»™æ‰€æœ‰ç›¸å…³çš„ç›‘å¬å™¨ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ç¬¬ä¸‰é˜¶æ®µå®¹å™¨åˆ·æ–°ä¸-bean-å®ä¾‹åŒ–"&gt;ğŸš€ ç¬¬ä¸‰é˜¶æ®µï¼šå®¹å™¨åˆ·æ–°ä¸ Bean å®ä¾‹åŒ–
&lt;/h3&gt;&lt;p&gt;è¿™æ˜¯å¯åŠ¨æµç¨‹çš„å†²åˆºé˜¶æ®µï¼Œå®¹å™¨å°†å®Œæˆæ‰€æœ‰å‡†å¤‡å·¥ä½œå¹¶æ­£å¼å¯åŠ¨ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;onRefresh()&lt;/code&gt;- æ¨¡æ¿æ–¹æ³•ï¼šå­å®¹å™¨åˆ·æ–°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯å¦ä¸€ä¸ª&lt;strong&gt;æ¨¡æ¿æ–¹æ³•&lt;/strong&gt;ï¼Œå…è®¸ç‰¹å®šçš„ &lt;code&gt;ApplicationContext&lt;/code&gt;å­ç±»åœ¨æ­¤æ—¶æœºæ‰§è¡Œç‰¹æ®Šé€»è¾‘ã€‚ä¾‹å¦‚ï¼Œ&lt;strong&gt;Spring Boot çš„ &lt;code&gt;ServletWebServerApplicationContext&lt;/code&gt;å°±åœ¨æ­¤æ–¹æ³•ä¸­åˆ›å»ºå¹¶å¯åŠ¨äº†å†…åµŒçš„ Web æœåŠ¡å™¨ï¼ˆå¦‚ Tomcatï¼‰&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;registerListeners()&lt;/code&gt;- æ³¨å†Œåº”ç”¨ç›‘å¬å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ­¥éª¤ä¼šæ³¨å†Œæ‰€æœ‰å®ç°äº† &lt;code&gt;ApplicationListener&lt;/code&gt;æ¥å£çš„ç›‘å¬å™¨ Beanï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°ä¹‹å‰åˆå§‹åŒ–çš„äº‹ä»¶å¹¿æ’­å™¨ä¸­ã€‚åŒæ—¶ï¼Œå®ƒä¼šå‘å¸ƒåœ¨åˆ·æ–°è¿‡ç¨‹ä¸­å¯èƒ½ç§¯å‹çš„â€œæ—©æœŸåº”ç”¨äº‹ä»¶â€ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;finishBeanFactoryInitialization()&lt;/code&gt;- å®Œæˆ BeanFactory çš„åˆå§‹åŒ–&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ &lt;code&gt;refresh()&lt;/code&gt;æ–¹æ³•ä¸­&lt;strong&gt;æœ€é‡é‡çº§çš„ä¸€æ­¥&lt;/strong&gt;ã€‚åœ¨æ­¤æ­¥éª¤ä¸­ï¼ŒSpring å®¹å™¨ä¼š&lt;strong&gt;å®ä¾‹åŒ–æ‰€æœ‰éå»¶è¿ŸåŠ è½½çš„å•ä¾‹ Bean&lt;/strong&gt;ã€‚å®ƒéå†æ‰€æœ‰å·²æ³¨å†Œçš„ &lt;code&gt;BeanDefinition&lt;/code&gt;ï¼Œè°ƒç”¨ &lt;code&gt;getBean()&lt;/code&gt;æ–¹æ³•ï¼Œè§¦å‘ Bean çš„åˆ›å»ºã€ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–ï¼ˆå¦‚è°ƒç”¨ &lt;code&gt;@PostConstruct&lt;/code&gt;æ–¹æ³•ï¼‰ã€‚è‡³æ­¤ï¼Œæ‰€æœ‰å•ä¾‹ Bean éƒ½å·²åˆ›å»ºå®Œæ¯•å¹¶æ”¾å…¥å•ä¾‹æ± ä¸­ï¼Œåº”ç”¨ç¨‹åºçš„æ ¸å¿ƒç»„ä»¶å°±ç»ª ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;finishRefresh()&lt;/code&gt;- å®Œæˆåˆ·æ–°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯æ•´ä¸ªå¯åŠ¨æµç¨‹çš„æ”¶å®˜ä¹‹ä½œã€‚å®ƒä¼šæ¸…ç©ºèµ„æºç¼“å­˜ï¼Œåˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸå¤„ç†å™¨ï¼Œå¹¶æœ€ç»ˆå‘å¸ƒ &lt;strong&gt;&lt;code&gt;ContextRefreshedEvent&lt;/code&gt;&lt;/strong&gt; äº‹ä»¶ï¼Œæ­£å¼å®£å‘Šå®¹å™¨åˆ·æ–°å®Œæˆã€‚æ­¤åï¼Œ&lt;code&gt;ApplicationContext&lt;/code&gt;ä¾¿å¤„äºå®Œå…¨æ´»åŠ¨çŠ¶æ€ï¼Œå¯ä»¥å¯¹å¤–æä¾›æœåŠ¡äº† ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-14"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œ&lt;code&gt;ApplicationContext&lt;/code&gt;çš„ &lt;code&gt;refresh()&lt;/code&gt;è¿‡ç¨‹æ˜¯ä¸€ä¸ªè®¾è®¡ç²¾å¦™ã€æ­¥éª¤æ¸…æ™°çš„æµæ°´çº¿ã€‚å®ƒä»ç¯å¢ƒå‡†å¤‡å¼€å§‹ï¼Œé€æ­¥å®Œæˆé…ç½®åŠ è½½ã€æ‰©å±•ç‚¹è°ƒç”¨ã€åŠŸèƒ½ç»„ä»¶åˆå§‹åŒ–ï¼Œæœ€ç»ˆå®ä¾‹åŒ–æ‰€æœ‰å•ä¾‹ Bean å¹¶å¯åŠ¨å®¹å™¨ã€‚ç†è§£è¿™ä¸€è¿‡ç¨‹ï¼Œå¯¹äºæŒæ¡ Spring æ¡†æ¶çš„å†…éƒ¨æœºåˆ¶ã€è¿›è¡Œé«˜çº§å®šåˆ¶å’Œæ•…éšœæ’æŸ¥éƒ½è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£æå¯¹ä½ æœ‰å¸®åŠ©ï¼å¦‚æœä½ å¯¹å…¶ä¸­æŸä¸ªå…·ä½“æ­¥éª¤ç‰¹åˆ«æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;</description></item><item><title>ã€Redisã€‘In Spring Boot</title><link>https://dyhes.github.io/p/redisin-spring-boot/</link><pubDate>Mon, 23 Sep 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/redisin-spring-boot/</guid><description>&lt;h2 id="dependency"&gt;dependency
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;dependency&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;groupId&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;springframework&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;boot&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;groupId&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;artifactId&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;boot&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;starter&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;redis&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;artifactId&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;dependency&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="applicationproperties"&gt;application.properties
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;redis&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;redis&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;6379&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="composeyaml"&gt;compose.yaml
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-dockerfile" data-lang="dockerfile"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;redis:&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; &lt;span class="c1"&gt;# ä¸ â€™redis:latest&amp;#39; subtle differences&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; image: redis:latest&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; container_name: postopia-redis&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; ports:&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; - &lt;span class="s2"&gt;&amp;#34;6379:6379&amp;#34;&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="config"&gt;Config
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Configuration&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RedisConfig&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisConnectionFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;redisConnectionFactory&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LettuceConnectionFactory&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisTemplate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RedisConnectionFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connectionFactory&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisTemplate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisTemplate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setConnectionFactory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;connectionFactory&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Use String serializers for keys&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setKeySerializer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StringRedisSerializer&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setValueSerializer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StringRedisSerializer&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="service"&gt;Service
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Service&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RedisService&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Autowired&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisTemplate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;setByMinute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;minute&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;opsForValue&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;minute&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TimeUnit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MINUTES&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;opsForValue&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>ã€Spring Bootã€‘Uploaded Image Processing</title><link>https://dyhes.github.io/p/spring-bootuploaded-image-processing/</link><pubDate>Sat, 13 Jul 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/spring-bootuploaded-image-processing/</guid><description>&lt;h2 id="example"&gt;example
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;org.springframework.http.ResponseEntity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;org.springframework.web.bind.annotation.*&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;org.springframework.web.multipart.MultipartFile&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.io.IOException&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.nio.file.Files&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.nio.file.Path&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.nio.file.Paths&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.util.UUID&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@RestController&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@RequestMapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;/api/users&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserController&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AVATAR_UPLOAD_DIR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;uploads/avatars/&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@PostMapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;/register&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ResponseEntity&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;registerUser&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@RequestPart&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;userInfo&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserRegistrationDto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userInfo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@RequestParam&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;avatar&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MultipartFile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;avatarFile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Generate a unique user ID&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UUID&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;randomUUID&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Process user information&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Registering user: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getUsername&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Email: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getEmail&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Here you would typically save the user information to a database&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Process avatar if provided&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;avatarUrl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;avatarFile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;avatarFile&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isEmpty&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;avatarUrl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;saveAvatar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;avatarFile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userId&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Construct response&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;User registered successfully. &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Username: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getUsername&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;, Email: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getEmail&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;avatarUrl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;, Avatar URL: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;avatarUrl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ResponseEntity&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;saveAvatar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MultipartFile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userId&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fileName&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;_&amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getOriginalFilename&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Paths&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AVATAR_UPLOAD_DIR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fileName&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Files&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBytes&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;/avatars/&amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fileName&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Return the relative URL&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printStackTrace&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserRegistrationDto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Note: In a real application, never store passwords in plain text&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We use &lt;code&gt;@RequestPart&lt;/code&gt; for userInfo because it&amp;rsquo;s a complex object (JSON data) that needs to be deserialized into a &lt;code&gt;UserRegistrationDto&lt;/code&gt; object.
We use &lt;code&gt;@RequestParam&lt;/code&gt; for avatarFile because it&amp;rsquo;s a simple file upload. While we could use &lt;code&gt;@RequestPart&lt;/code&gt; here &lt;strong&gt;as well&lt;/strong&gt;, &lt;code&gt;@RequestParam&lt;/code&gt; is sufficient and clearly indicates that it&amp;rsquo;s an optional parameter.&lt;/p&gt;
&lt;h2 id="requestpart"&gt;@RequestPart
&lt;/h2&gt;&lt;h2 id="requestparam"&gt;@RequestParam
&lt;/h2&gt;&lt;p&gt;Typically used for simple values like strings, numbers, or booleans.
By default, parameters are required. You can make them optional by setting &lt;strong&gt;required = false&lt;/strong&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For GET requests, it looks at &lt;strong&gt;query parameters&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;For requests with application/x-www-form-urlencoded, it looks at the &lt;strong&gt;form data&lt;/strong&gt; in the request body.&lt;/li&gt;
&lt;li&gt;For requests with multipart/form-data, it can look at &lt;strong&gt;both&lt;/strong&gt; the URL and the parts of the multipart request.&lt;/li&gt;
&lt;li&gt;It can even extract data from the &lt;strong&gt;query string for POST requests&lt;/strong&gt;, which is occasionally useful.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="compare-with-pathvariable"&gt;compare with @PathVariable
&lt;/h3&gt;&lt;h4 id="pathvariable"&gt;@PathVariable
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Used to handle &lt;strong&gt;template variables&lt;/strong&gt; in the request URI.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Part of the path&lt;/strong&gt; itself, not a query string.&lt;/li&gt;
&lt;li&gt;Typically used for &lt;strong&gt;mandatory&lt;/strong&gt; parameters that identify a resource.&lt;/li&gt;
&lt;li&gt;Cannot have default values (if the value is not in the URL, the route won&amp;rsquo;t match).&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@GetMapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;/users/{id}&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;getUser&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@PathVariable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Implementation&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="request-body"&gt;@Request Body
&lt;/h2&gt;&lt;p&gt;For application/json or application/xml&lt;/p&gt;
&lt;h2 id="applicationx-www-form-urlencoded-and-multipartform-data"&gt;&lt;code&gt;application/x-www-form-urlencoded&lt;/code&gt; and &lt;code&gt;multipart/form-data&lt;/code&gt;
&lt;/h2&gt;&lt;h3 id="applicationx-www-form-urlencoded"&gt;&lt;code&gt;application/x-www-form-urlencoded&lt;/code&gt;
&lt;/h3&gt;&lt;p&gt;This is the default content type for HTML form submissions and is widely used for sending simple data.&lt;/p&gt;
&lt;h4 id="key-characteristics"&gt;Key characteristics
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Data is encoded in &lt;strong&gt;key-value&lt;/strong&gt; pairs&lt;/li&gt;
&lt;li&gt;Keys and values are &lt;strong&gt;URL-encoded&lt;/strong&gt; (spaces become &amp;lsquo;+&amp;rsquo; or &amp;lsquo;%20&amp;rsquo;, special characters are percent-encoded)&lt;/li&gt;
&lt;li&gt;Pairs are separated by &amp;lsquo;&lt;strong&gt;&amp;amp;&lt;/strong&gt;&amp;rsquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="pros"&gt;Pros
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Simple and widely supported&lt;/li&gt;
&lt;li&gt;Efficient for small amounts of text data&lt;/li&gt;
&lt;li&gt;Easy to generate and parse&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="cons"&gt;â €Cons
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Not suitable for sending large amounts of data&lt;/li&gt;
&lt;li&gt;Not efficient for sending binary data (like files)&lt;/li&gt;
&lt;li&gt;Can become unwieldy with complex data structures&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="multipartform-data"&gt;&lt;code&gt;multipart/form-data&lt;/code&gt;
&lt;/h3&gt;&lt;p&gt;This content type is used when the form includes &lt;strong&gt;files, non-ASCII data&lt;/strong&gt;, or when you need to send &lt;strong&gt;binary data&lt;/strong&gt;.&lt;/p&gt;
&lt;h4 id="key-characteristics-1"&gt;Key characteristics
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;The body is divided into &lt;strong&gt;separate parts&lt;/strong&gt;, each representing a form field or file&lt;/li&gt;
&lt;li&gt;Each part can have &lt;strong&gt;its own content type&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Parts are separated &lt;strong&gt;by a boundary delimiter&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="example-1"&gt;example
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-http" data-lang="http"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;--boundary
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;Content-Disposition: form-data; name=&amp;#34;name&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;John Doe
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;--boundary
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;Content-Disposition: form-data; name=&amp;#34;file&amp;#34;; filename=&amp;#34;example.txt&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;Content-Type: text/plain
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;[File content goes here]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;--boundary--
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="pros-1"&gt;Pros
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Can handle file uploads &lt;strong&gt;efficiently&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Supports &lt;strong&gt;mixed data types&lt;/strong&gt; (text fields and files) in a single request&lt;/li&gt;
&lt;li&gt;Better for sending large amounts of data or binary data&lt;/li&gt;
&lt;li&gt;Each part can have its own content type&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="cons-1"&gt;â €Cons
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;More complex to parse and generate&lt;/li&gt;
&lt;li&gt;Slightly larger overhead due to boundaries and headers&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="get-method"&gt;Get Method
&lt;/h2&gt;&lt;h3 id="http-specification"&gt;HTTP Specification
&lt;/h3&gt;&lt;p&gt;According to the HTTP/1.1 specification (RFC 7231), a GET request &lt;strong&gt;can have a body&lt;/strong&gt;. However, the specification also states that a GET request with a body &lt;strong&gt;has no defined semantics, meaning servers are not required to process or even acknowledge the body&lt;/strong&gt;.&lt;/p&gt;
&lt;h3 id="real-world-practice"&gt;Real-world Practice
&lt;/h3&gt;&lt;p&gt;In practice, while it&amp;rsquo;s &lt;strong&gt;technically possible&lt;/strong&gt; to send a body with a GET request, it&amp;rsquo;s generally &lt;strong&gt;discouraged&lt;/strong&gt; and often not supported for several reasons:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Many servers, clients, and proxies &lt;strong&gt;ignore&lt;/strong&gt; the body of a GET request.&lt;/li&gt;
&lt;li&gt;Some implementations might &lt;strong&gt;reject&lt;/strong&gt; GET requests with a body.&lt;/li&gt;
&lt;li&gt;It goes against the &lt;strong&gt;intended&lt;/strong&gt; use of GET as defined in the HTTP specification.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="restful-api-design"&gt;RESTful API Design
&lt;/h3&gt;&lt;p&gt;In RESTful API design, GET requests are meant to be &lt;strong&gt;safe and idempotent&lt;/strong&gt;. They should retrieve resources without modifying server state. Including a body in a GET request could imply that the request is intended to modify something, which contradicts these principles.&lt;/p&gt;</description></item><item><title>Many-One Relationship</title><link>https://dyhes.github.io/p/many-one-relationship/</link><pubDate>Thu, 11 Jul 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/many-one-relationship/</guid><description>&lt;img src="https://dyhes.github.io/covers/cover19.png" alt="Featured image of post Many-One Relationship" /&gt;&lt;h2 id="onetomany"&gt;@OneToMany
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;This annotation is used to define a one-to-many relationship between two entities.&lt;/li&gt;
&lt;li&gt;Itâ€™s typically &lt;strong&gt;used on the â€œoneâ€ side&lt;/strong&gt; of the relationship.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Department&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@OneToMany&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mappedBy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;department&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cascade&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CascadeType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ALL&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;employees&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="manytoone"&gt;@ManyToOne
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;This annotation is used to define a many-to-one relationship between two entities.&lt;/li&gt;
&lt;li&gt;Itâ€™s typically &lt;strong&gt;used on the â€œmanyâ€ side&lt;/strong&gt; of the relationship.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@ManyToOne&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@JoinColumn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;department_id&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Department&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;department&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Often, @OneToMany and @ManyToOne are used together to create a bidirectional relationship. The @OneToMany side uses mappedBy to indicate the field that owns the relationship. The @ManyToOne side use @JoinColumn to specify the &lt;strong&gt;foreign key column&lt;/strong&gt;.&lt;/p&gt;
&lt;h2 id="cascade-operation"&gt;Cascade operation
&lt;/h2&gt;&lt;p&gt;Cascade operations in ORM frameworks like Hibernate and JPA allow you to &lt;strong&gt;automatically apply operations performed on a parent entity to its associated child entities&lt;/strong&gt;. This feature is particularly useful in managing relationships between entities and can significantly simplify database operations.&lt;/p&gt;
&lt;h3 id="types"&gt;Types
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;PERSIST: Saves the child entity when the parent is saved.&lt;/li&gt;
&lt;li&gt;MERGE: Updates the child entity when the parent is updated.&lt;/li&gt;
&lt;li&gt;REMOVE: Deletes the child entity when the parent is deleted.&lt;/li&gt;
&lt;li&gt;REFRESH: Refreshes the child entity when the parent is refreshed.&lt;/li&gt;
&lt;li&gt;DETACH: Detaches the child entity when the parent is detached (from the persistence context).&lt;/li&gt;
&lt;li&gt;ALL: Applies all cascade types (PERSIST, MERGE, REMOVE, REFRESH, DETACH).&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="usage"&gt;Usage
&lt;/h3&gt;&lt;p&gt;You can specify cascade operations in the @OneToMany, @ManyToOne, @OneToOne, or @ManyToMany annotations:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@OneToMany&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cascade&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CascadeType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ALL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ChildEntity&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;children&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@OneToMany&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cascade&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;CascadeType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;PERSIST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CascadeType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MERGE&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ChildEntity&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;children&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="considerations"&gt;Considerations
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Orphan Removal: Used in conjunction with cascading, orphanRemoval = true will remove child entities that are no longer referenced by the parent.&lt;/li&gt;
&lt;li&gt;Bi-directional Relationships: Be cautious with cascade operations in &lt;strong&gt;bi-directional relationships&lt;/strong&gt; to avoid unintended side effects.&lt;/li&gt;
&lt;li&gt;Performance: Cascading can &lt;strong&gt;impact performance&lt;/strong&gt;, especially with large datasets. Use it judiciously&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>One-One Relationship</title><link>https://dyhes.github.io/p/one-one-relationship/</link><pubDate>Thu, 11 Jul 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/one-one-relationship/</guid><description>&lt;img src="https://dyhes.github.io/covers/cover21.jpg" alt="Featured image of post One-One Relationship" /&gt;&lt;p&gt;A one-to-one relationship means that each instance of an entity is associated with precisely one instance of another entity. This relationship is bidirectional or unidirectional:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Unidirectional One-to-One&lt;/strong&gt;: One entity has a reference to another entity, but not vice versa.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Bidirectional One-to-One&lt;/strong&gt;: Both entities have references to each other.
In the context of object-relational mapping (ORM) in Java, specifically when using Java Persistence API (JPA) or Hibernate, theÂ @OneToOneÂ annotation is used to define a one-to-one relationship between two entities.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// unidirectional &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strategy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GenerationType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;IDENTITY&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@OneToOne&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cascade&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CascadeType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ALL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@JoinColumn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;profile_id&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;referencedColumnName&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserProfile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userProfile&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserProfile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strategy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GenerationType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;IDENTITY&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//bidirectional&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strategy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GenerationType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;IDENTITY&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@OneToOne&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cascade&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CascadeType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ALL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mappedBy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserProfile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userProfile&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserProfile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strategy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GenerationType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;IDENTITY&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@OneToOne&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@JoinColumn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;user_id&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>Many-Many Relationship</title><link>https://dyhes.github.io/p/many-many-relationship/</link><pubDate>Wed, 10 Jul 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/many-many-relationship/</guid><description>&lt;img src="https://dyhes.github.io/covers/cover20.jpg" alt="Featured image of post Many-Many Relationship" /&gt;&lt;h2 id="manytomany"&gt;@ManyToMany
&lt;/h2&gt;&lt;p&gt;TheÂ @ManyToManyÂ annotation is used in Java persistence frameworks, particularly in Java Persistence API (JPA) and Object-Relational Mapping (ORM) tools like Hibernate. Itâ€™s used to define a &lt;strong&gt;many-to-many relationship&lt;/strong&gt; between two entities.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Relationship: It represents a relationship where multiple instances of one entity can be associated with multiple instances of another entity.&lt;/li&gt;
&lt;li&gt;Database representation: In a relational database, this is typically implemented using a join table that contains foreign keys to both entities.&lt;/li&gt;
&lt;li&gt;Bidirectional vs Unidirectional: The relationship can be &lt;strong&gt;bidirectional&lt;/strong&gt; (defined on both entities) or &lt;strong&gt;unidirectional&lt;/strong&gt; (defined on only one entity, namely the owning one).&lt;/li&gt;
&lt;li&gt;Usage: Itâ€™s typically used on a &lt;strong&gt;collection field&lt;/strong&gt; in an entity class.&lt;/li&gt;
&lt;li&gt;Join Table: By default, JPA will create a join table, but you can &lt;strong&gt;customize&lt;/strong&gt; this using the &lt;strong&gt;@JoinTable&lt;/strong&gt; annotation.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;students&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Student&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@ManyToMany&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@JoinTable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;student_course&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;joinColumns&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@JoinColumn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;student_id&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inverseJoinColumns&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@JoinColumn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;course_id&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Course&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;signedCourses&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;courses&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Course&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@ManyToMany&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mappedBy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;signedCourses&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Student&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;students&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In this example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A student can enroll in multiple courses, and a course can have multiple students.&lt;/li&gt;
&lt;li&gt;TheÂ @JoinTableÂ annotation specifies the details of the join table.&lt;/li&gt;
&lt;li&gt;TheÂ mappedByÂ attribute in theÂ CourseÂ entity indicates thatÂ StudentÂ is the owning side of the relationship.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When using @ManyToMany, consider these best practices:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Use Set&lt;/strong&gt; instead of List to avoid duplicate entries.&lt;/li&gt;
&lt;li&gt;Be cautious with bidirectional relationships, as they can &lt;strong&gt;lead to performance issues&lt;/strong&gt; if not managed properly.&lt;/li&gt;
&lt;li&gt;Consider using &lt;strong&gt;lazy loading&lt;/strong&gt; (fetch = FetchType.LAZY) to improve performance.&lt;/li&gt;
&lt;li&gt;In some cases, it might be better to model the relationship as &lt;strong&gt;two one-to-many&lt;/strong&gt; relationships with an intermediate entity, especially if you need to store &lt;strong&gt;additional information&lt;/strong&gt; about the relationship.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="mappedby"&gt;mappedBy
&lt;/h2&gt;&lt;p&gt;TheÂ mappedByÂ attribute in aÂ @ManyToManyÂ relationship is used to indicate the non-owning side of a &lt;strong&gt;bidirectional&lt;/strong&gt; relationship.Â &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;In aÂ @ManyToManyÂ relationship, one side needs to be the owning side, and the other is the non-owning (inverse) side.&lt;/li&gt;
&lt;li&gt;The owning side is where &lt;strong&gt;theÂ @JoinTableÂ is specified&lt;/strong&gt; (if using a custom join table).&lt;/li&gt;
&lt;li&gt;The non-owning side usesÂ mappedByÂ to &lt;strong&gt;refer to the property&lt;/strong&gt; on the owning side.
Key Points&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Only&lt;/strong&gt; the owning side of the relationship is responsible for updating the join table.&lt;/li&gt;
&lt;li&gt;Changes made to the non-owning side &lt;strong&gt;wonâ€™t be reflected in the database&lt;/strong&gt; unless the owning side is also updated.
Benefits&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Prevents duplicate&lt;/strong&gt; join tables.&lt;/li&gt;
&lt;li&gt;Clarifies which side of the relationship is responsible for managing the association.
Common Mistake:&lt;/li&gt;
&lt;li&gt;Forgetting to specifyÂ mappedByÂ on one side, which can lead to &lt;strong&gt;two separate join table&lt;/strong&gt;s being created.
Bidirectional Relationship Management:&lt;/li&gt;
&lt;li&gt;Even thoughÂ mappedByÂ is specified, you typically need to update both sides of the relationship in your Java code &lt;strong&gt;for consistency.&lt;/strong&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;student&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCourses&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;course&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;course&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getStudents&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;student&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Database Perspective:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The database structure is the same regardless of which side is the owning side.&lt;/li&gt;
&lt;li&gt;The choice affects how JPA manages the relationship, not the underlying database schema.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="lazy-loading"&gt;lazy loading
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Lazy loading means that an object &lt;strong&gt;doesnâ€™t load all of its associated data&lt;/strong&gt; from the database when itâ€™s first retrieved.&lt;/li&gt;
&lt;li&gt;Instead, it loads only the data it needs immediately and loads other related data &lt;strong&gt;only when itâ€™s specifically requested&lt;/strong&gt;.
In ORM Context:&lt;/li&gt;
&lt;li&gt;When you fetch an entity from the database, lazy loading allows you to retrieve the entity &lt;strong&gt;without immediately loading all of its associated entities or collections&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;The associated data is loaded only when you try to &lt;strong&gt;access it&lt;/strong&gt;.
When to use:&lt;/li&gt;
&lt;li&gt;Use lazy loading for associations that are not always needed.&lt;/li&gt;
&lt;li&gt;Use eager loading for associations that are almost always needed with the main entity.
Implementation:&lt;/li&gt;
&lt;li&gt;In JPA, lazy loading is often the default &lt;strong&gt;for collection associations&lt;/strong&gt; (@OneToMany,Â @ManyToMany).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;For single-valued associations&lt;/strong&gt; (@ManyToOne,Â @OneToOne), eager loading is usually the default.
Best Practices:&lt;/li&gt;
&lt;li&gt;Use lazy loading as the default strategy.&lt;/li&gt;
&lt;li&gt;Switch to eager loading only when youâ€™re certain that the related data is always needed.&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Spring Boot in practiceã€‘Notes</title><link>https://dyhes.github.io/p/spring-boot-in-practicenotes/</link><pubDate>Tue, 02 Jul 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/spring-boot-in-practicenotes/</guid><description>&lt;p&gt;&lt;a class="link" href="https://reader-service.fcdn.sk/?source=3c6b6838ceb712e38b66a0ca2cde230f44274dac2f09fba71ffdc61842816357&amp;amp;download_location=https%3A%2F%2Fsinglelogin.re%2Fdl%2F21754907%2F994075" target="_blank" rel="noopener"
&gt;Link&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="spring-boot"&gt;Spring boot
&lt;/h2&gt;&lt;p&gt;Spring Boot is an open source extension of the Spring Framework designed to simplify the Spring application development.&lt;/p&gt;
&lt;p&gt;Spring Boot was introduced as a subproject under the Spring Framework to empower developers with a fast startup experience and exempt them from most of the configuration hazards.&lt;/p&gt;
&lt;p&gt;It provides an additional layer between the Spring Framework for the user to simplify certain configuration aspects.&lt;/p&gt;
&lt;p&gt;A Spring Boot web application can be either Servlet-based or reactive type.&lt;/p&gt;
&lt;h3 id="components"&gt;Components
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;spring-boot&lt;/p&gt;
&lt;p&gt;This is the &lt;strong&gt;primary&lt;/strong&gt; Spring Boot component that provides support to other components. For example, it contains the &lt;strong&gt;SpringApplication class&lt;/strong&gt;, which contains several static methods to create a standalone Spring Boot application. It also provides support for embedded web servers (e.g., Tomcat) and supports externalized application configurations (e.g., database details of your application), etc.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;spring-boot-autoconfigure&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Spring-boot-starters&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;spring-boot-actuator&lt;/p&gt;
&lt;p&gt;In the context of software, particularly within the Spring Boot framework, â€œActuatorâ€ refers to a set of tools and features that provide insights into the applicationâ€™s runtime behavior and health.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;spring-boot-actuator-autoconfigure&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;spring-boot-loader&lt;/p&gt;
&lt;p&gt;This component allows a Spring Boot application to be packaged as a single fat JAR file, including all dependencies and the embedded web servers that can be run standalone. You donâ€™t use this module independently; instead, it is used along with Maven or Gradle plugins&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;spring-boot-devtools&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="lombok"&gt;Lombok
&lt;/h3&gt;&lt;p&gt;&lt;a class="link" href="https://projectlombok.org/" target="_blank" rel="noopener"
&gt;Lombok&lt;/a&gt; is a Java library that automatically generates the constructors, getter, setter, toString, and others based on the presence of a few annotations in the plain old Java object (POJO) class.&lt;/p&gt;
&lt;h3 id="pojo"&gt;POJO
&lt;/h3&gt;&lt;p&gt;A Plain Old Java Object (POJO) is a simple Java object that does not adhere to any special rules or conventions beyond those required by the Java Language Specification. The term is used to emphasize that these objects are free from the constraints typically imposed by more complex frameworks or libraries.&lt;/p&gt;
&lt;h3 id="record"&gt;Record
&lt;/h3&gt;&lt;p&gt;Java 14 has introduced the concept of records in the Java language. Records are immutable data classes that require you to specify only the type and name of the fields. The Java compiler can then generate the equals, hashCode, and toString methods. It also generates the private final fields, getter methods, and public constructor.&lt;/p&gt;
&lt;h3 id="pomxml-file"&gt;pom.xml file
&lt;/h3&gt;&lt;p&gt;TheÂ pom.xmlÂ file is a fundamental component of a Maven-based Java project. Maven is a build automation tool used primarily for Java projects, andÂ pom.xmlÂ (Project Object Model) is the configuration file that defines the projectâ€™s dependencies, build configuration, and other project-specific settings.&lt;/p&gt;
&lt;h3 id="applicationpropertiesfile"&gt;application.propertiesÂ file
&lt;/h3&gt;&lt;p&gt;TheÂ application.propertiesÂ file is a key configuration file used in Spring Boot applications. It allows developers to define various settings and configurations for the application in a simple and readable format.Â &lt;/p&gt;
&lt;h3 id="war-vs-ear"&gt;WAR vs EAR
&lt;/h3&gt;&lt;p&gt;In general, to run a web application, you build and package the application components in a WAR or EAR archive file and deploy it into a web (e.g., Apache Tomcat) or application server (e.g., Red Hat JBoss). Spring Boot simplifies this process to a certain degree. It does not enforce you to build a WAR or EAR file of your application. Instead, it lets you run the Spring Boot application like a regular Java application using a conventional main() method.&lt;/p&gt;
&lt;h3 id="java-bean"&gt;Java Bean
&lt;/h3&gt;&lt;p&gt;A JavaBean is a reusable software component that follows &lt;strong&gt;specific conventions&lt;/strong&gt; defined by the JavaBeans specification. JavaBeans are used for &lt;strong&gt;encapsulating many objects into a single object&lt;/strong&gt; (the bean), so they can be passed around as a single bean object.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1 Default Constructor:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A JavaBean must have a no-argument (default) constructor. This allows the bean to be easily instantiated.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2&lt;/strong&gt; &lt;strong&gt;Properties:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Properties are private fields that are accessed and modified through public getter and setter methods.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3&lt;/strong&gt; &lt;strong&gt;Serializable:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A JavaBean should implement theÂ SerializableÂ interface to allow its state to be saved and restored.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4&lt;/strong&gt; &lt;strong&gt;Accessor Methods:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Getter and setter methods follow a specific naming convention (getPropertyNameÂ for getters andÂ setPropertyNameÂ for setters).
The â€œBeanâ€ part of the term is a metaphor borrowed from the agricultural sense of the word, implying something small, lightweight, and reusable.&lt;/p&gt;
&lt;h3 id="springbootapplication"&gt;@SpringBootApplication
&lt;/h3&gt;&lt;p&gt;@SpringBootApplication annotation is a convenient annotation that consists of three annotations:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;@EnableAutoConfiguration&lt;/p&gt;
&lt;p&gt;provides the necessary support for Spring Boot to autoconfigure your application based on the JAR dependencies present in the application
classpath&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@ComponentScan&lt;/p&gt;
&lt;p&gt;Provides support to scan the packages for Spring components in the application.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="spring-component"&gt;Spring Component
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;A component in Spring is a Java bean that is managed by Spring&lt;/strong&gt; and annotated with the &lt;strong&gt;@Component, @Bean, or specialized component annotations&lt;/strong&gt;. With the presence of @ComponentScan annotation, the Spring Boot application scans for all components present in the &lt;strong&gt;root package and sub-packages&lt;/strong&gt; under it to manage their lifecycle. The key point to remember with ComponentScan is that the scan starts from a root package and continues to all child packages. Thus, if you have packages that are not in the root or its sub-package, none of those components will be scanned by the component scan.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@SpringBootConfiguration
This annotation indicates that &lt;strong&gt;the annotated class provides the Spring Boot application configuration&lt;/strong&gt;. It is meta-annotated with Spring @Configuration annotation so that the configurations in the annotated class can be found automatically by Spring Boot. Thus, the beans defined in this main class can be autodetected and loaded by Spring.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="run-method"&gt;run() method
&lt;/h3&gt;&lt;p&gt;Most of the time, youâ€™ll use the staticÂ run()Â method ofÂ SpringApplicationÂ to bootstrap and launch your application. Spring Boot performs several activities while it executes theÂ run()Â method:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1&lt;/strong&gt; &lt;strong&gt;Creates an instance of an&lt;/strong&gt;Â &lt;strong&gt;ApplicationContext&lt;/strong&gt;Â based on the libraries present in the classpath.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2&lt;/strong&gt; &lt;strong&gt;Registers a&lt;/strong&gt;Â &lt;strong&gt;CommandLinePropertySource&lt;/strong&gt;Â to expose command line arguments as Spring properties.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3&lt;/strong&gt; &lt;strong&gt;Refreshes the&lt;/strong&gt;Â &lt;strong&gt;ApplicationContext&lt;/strong&gt;Â created at step 1 to load all singleton beans.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4&lt;/strong&gt; &lt;strong&gt;Triggers the&lt;/strong&gt;Â &lt;strong&gt;ApplicationRunners&lt;/strong&gt;Â &lt;strong&gt;and&lt;/strong&gt;Â &lt;strong&gt;CommandRunners&lt;/strong&gt;Â configured in the application.&lt;/p&gt;
&lt;p&gt;Most Java applications you develop consist of objects. These objects interact with each other, and there are dependencies among them. To effectively manage object creation and interdependencies, Spring uses the principles ofÂ &lt;strong&gt;dependency injection (DI)&lt;/strong&gt;.
This dependency injection or theÂ &lt;strong&gt;inversion of control (IoC)&lt;/strong&gt;Â approach lets Spring create the objects (or, more appropriately, theÂ &lt;strong&gt;beans&lt;/strong&gt;Â in Spring parlance) and inject the dependencies externally.
The bean definitions are presented to Spring either through theÂ &lt;strong&gt;XML bean definition files&lt;/strong&gt;Â (e.g.,Â applicationContext.xml) or through the annotation-based configurations (@ConfigurationÂ annotation). Spring loads these bean definitions and keeps them available in theÂ &lt;strong&gt;Spring IoC container&lt;/strong&gt;. TheÂ ApplicationContextÂ interface acts as theÂ &lt;strong&gt;Spring IoC Container&lt;/strong&gt;. Spring provides a plethora ofÂ ApplicationContextÂ implementations based on the application type (Servlet or Reactive application), the bean definition configurations (e.g., to load from classpath or annotation), and so on.&lt;/p&gt;
&lt;p&gt;AlthoughÂ @EventListenerÂ works well in most circumstances, it does not work for events that are published very early in the application start-up, such asÂ ApplicationStartingEventÂ andÂ ApplicationEnvironmentPreparedEvent.&lt;/p&gt;
&lt;p&gt;By default, Spring Boot reads the application.properties or application.yml file from the following locations:&lt;/p&gt;
&lt;p&gt;1 The classpath root&lt;/p&gt;
&lt;p&gt;2 The classpathÂ /configÂ package&lt;/p&gt;
&lt;p&gt;3 The current directory&lt;/p&gt;
&lt;p&gt;4 TheÂ /configÂ subdirectory in the current directory&lt;/p&gt;
&lt;p&gt;5 Immediate child directories of theÂ /configÂ subdirectory&lt;/p&gt;
&lt;p&gt;You can maintain the profile-specific property files with the application-{profile}.properties (or .yml) file.
You can activate a profile (e.g.,Â devÂ orÂ test) using theÂ spring.profiles.activeÂ Spring Boot property.&lt;/p&gt;
&lt;p&gt;1 The application properties (properties or the YAML file) packaged inside the application JAR
2 Profile-specific application properties packaged inside the application JAR
3 The application properties (properties or the YAML file) packaged outside the application JAR
4 Profile-specific application properties packaged outside the application JAR&lt;/p&gt;
&lt;p&gt;Following is the order in which properties get precedence. The higher sequence number overrides the properties of the lower sequence number:
1 SpringApplication
2 @PropertySource
3 Config data file
4 OS environment variable
5 Command line arguments&lt;/p&gt;
&lt;p&gt;BothÂ @BeanÂ andÂ @ComponentÂ annotations let you &lt;strong&gt;instruct Spring to create instances&lt;/strong&gt; of the annotated class, but their usage is slightly different. You typically use theÂ @BeanÂ annotation for the classes for which &lt;strong&gt;you donâ€™t have access to the source code&lt;/strong&gt;. Thus, you define a bean and return a new instance of the class. For theÂ @ComponentÂ annotation, as you have access to the source Java file, you can simply annotate the class with this annotation.BothÂ @BeanÂ andÂ @ComponentÂ annotations let you instruct Spring to create instances of the annotated class, but their usage is slightly different. You typically use theÂ @BeanÂ annotation for the classes for which you donâ€™t have access to the source code. Thus, you define a bean and return a new instance of the class. For theÂ @ComponentÂ annotation, as you have access to the source Java file, you can simply annotate the class with this annotation.&lt;/p&gt;
&lt;p&gt;TheÂ CommandLineRunnerÂ is a useful feature that is frequently used to perform several application initialization activities. In aÂ CommandLineRunnerÂ implementation, you also have access to the command line arguments through theÂ argsÂ parameter.&lt;/p&gt;
&lt;p&gt;Bean Validation, part of the Java EE (Enterprise Edition) specification, is a framework that provides a standard way to enforce constraints on the properties of JavaBeans. These constraints ensure that the data within beans meets certain criteria before it is processed or persisted.Â &lt;/p&gt;
&lt;p&gt;Java annotations are a powerful feature introduced in &lt;strong&gt;Java 5&lt;/strong&gt; that provide a way to add &lt;strong&gt;metadata&lt;/strong&gt; to Java code. They can be applied to various elements of the code, including classes, methods, fields, parameters, and more. Annotations &lt;strong&gt;do not change&lt;/strong&gt; the action of the compiled program but can be used by the compiler and runtime tools to &lt;strong&gt;generate code, analyze code, and perform other tasks&lt;/strong&gt;.&lt;/p&gt;
&lt;h2 id="spring-data"&gt;Spring Data
&lt;/h2&gt;&lt;p&gt;&lt;a class="link" href="https://spring.io/projects/spring-data" target="_blank" rel="noopener"
&gt;Spring Data&lt;/a&gt;Â lets you access data from a variety of data sources (e.g., relational and nonrelational databases, MapReduce databases, and cloud-based data services). It attempts to provide a uniform, easy-to-use, and familiar programming model through the Spring Framework.&lt;/p&gt;
&lt;p&gt;It is an umbrella project under the Spring Framework that contains several sub-projects, each of which targets a specific database. For instance, the &lt;strong&gt;Spring Data JPA module is specific to relational databases&lt;/strong&gt; (e.g., H2, MySQL, PostgreSQL). Similarly, Spring Data MongoDB aims to provide support for the MongoDB database.&lt;/p&gt;
&lt;p&gt;Java Database Connectivity (JDBC) is a &lt;strong&gt;standard API&lt;/strong&gt; provided by Java that allows Java applications to interact with relational databases in a vendor-independent manner. JDBC provides a set of interfaces and classes that enable developers to connect to a database, execute SQL queries, and retrieve results. It serves as a bridge between Java applications and various database management systems (DBMS).&lt;/p&gt;
&lt;p&gt;Java Persistence API (JPA) is &lt;strong&gt;a specification for object-relational mapping&lt;/strong&gt; (ORM) in Java, which allows developers to manage relational data in Java applications using an object-oriented paradigm. JPA provides a standard way to map Java objects to database tables and to manage persistent data in applications.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;JDBC:&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;JDBC is a &lt;strong&gt;low-level&lt;/strong&gt; API for interacting with relational databases. It provides a set of interfaces and classes for connecting to a database, executing SQL queries, and retrieving results. JDBC is database-centric and requires developers to write SQL queries and manage the mapping between Java objects and database tables &lt;strong&gt;manually&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;JPA:&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;JPA is a &lt;strong&gt;high-level&lt;/strong&gt; API for object-relational mapping (ORM). It abstracts the database interactions and &lt;strong&gt;allows developers to work with Java objects instead of SQL queries&lt;/strong&gt;. JPA automatically maps Java objects to database tables and handles CRUD (Create, Read, Update, Delete) operations, making it easier to manage persistent data in an object-oriented way.
JPA itself is not an implementation but a set of guidelines implemented by various ORM frameworks like &lt;strong&gt;Hibernate&lt;/strong&gt;, EclipseLink, and &lt;strong&gt;Spring Data JPA&lt;/strong&gt;.
Hibernate is the default JPA provider in Spring Data JPA.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;MyBatis is a persistence framework that offers SQL mapping. It emphasizes direct SQL use, providing a higher degree of control over SQL queries and their execution. Unlike traditional ORM frameworks, &lt;strong&gt;MyBatis does not map Java objects to database tables but rather maps SQL statements to Java methods&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;One of the core themes of Spring Data is to provide a &lt;strong&gt;consistent&lt;/strong&gt; programming model
to access various data sources.&lt;/p&gt;
&lt;p&gt;Spring Data provides a &lt;strong&gt;repository abstraction layer&lt;/strong&gt; across the supported databases as a common programming model. The abstraction is contained in the Spring Data Commons module, and it provides several useful interfaces that let you perform the standard create, read, update, and delete (CRUD) operations as well as executing queries. This abstraction layer is the topmost layer and acts as the foundation for other Spring Data modules.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://dyhes.github.io/image%202.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;As part of the database configuration, Spring Boot automatically configures theÂ &lt;a class="link" href="https://github.com/brettwooldridge/HikariCP" target="_blank" rel="noopener"
&gt;HikariCP&lt;/a&gt;Â database connection pool. A database connection pool contains one or more database connections that are generally created at the time of application startup and available for use by the application.
The benefit of a database connection pool is that a set of database connections are created at the application startup and available for use by the application. Thus, you donâ€™t create a new connection each time you need a database connection and close it once done. The application can take a connection from the pool, use it, and return to the pool. Spring Boot uses HikariCP as the default database connection pool library.
&lt;img src="https://dyhes.github.io/image%203.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;Spring Boot can load the SQL scripts from the classpath (e.g., theÂ src/main/resourcesÂ folder) or a preconfigured location. By default, you define theÂ schema.sqlÂ file to provide all DDL scripts and define theÂ data.sqlÂ file to include the DML scripts and place them inside theÂ src/main/resourcesÂ folder for Spring Boot to detect and execute these files.
To begin with, if you are using a database other than an embedded (in-memory) database, you need to setÂ spring.sql.init.modeÂ toÂ alwaysÂ in theÂ application.propertiesÂ file.
In this schema initialization-based approach, Spring Boot re-creates the schema each time you restart the application. There is no database schema versioning done by Spring Boot.&lt;/p&gt;
&lt;p&gt;In this schema initialization-based approach, Spring Boot re-creates the schema each time you restart the application. There is no database schema versioning done by Spring Boot.
In addition to theÂ schema.sqlÂ andÂ data.sqlÂ files, Spring Boot also supports database-specific SQLs. For instance, if your application supports multiple database types, and there are SQL syntax differences, you can useÂ schema-${platform}.sqlÂ andÂ data-${platform}.sqlÂ files.&lt;/p&gt;
&lt;p&gt;Spring Data uses this marker interface Repository as the primary abstraction for a data source.
&lt;img src="https://dyhes.github.io/image%204.png"
loading="lazy"
&gt;
In addition to theÂ CrudRepository, Spring Data also provides aÂ PagingAndSortingRepository, which extends theÂ CrudRepositoryÂ and provides additional support for pagination and sorting of the entities.&lt;/p&gt;
&lt;p&gt;@Entity marks a java class as a jpa entity
@Table provides the database table details
@Column provides mapping information between the Java fields and the associated column name in the table.
@Repository marks a class as a spring repository&lt;/p&gt;
&lt;h2 id="spring-security"&gt;Spring Security
&lt;/h2&gt;&lt;p&gt;The following part comes from spring security official website
Spring Security provides comprehensive support forÂ &lt;a class="link" href="https://en.wikipedia.org/wiki/Authentication" target="_blank" rel="noopener"
&gt;authentication&lt;/a&gt;. Authentication is how we &lt;strong&gt;verify the identity&lt;/strong&gt; of who is trying to access a particular resource.&lt;/p&gt;
&lt;p&gt;Spring Securityâ€™sÂ PasswordEncoderÂ interface is used to perform a one-way transformation of a password to let the password be stored securely.&lt;/p&gt;
&lt;p&gt;To mitigate the effectiveness of Rainbow Tables, developers were encouraged to use salted passwords.&lt;/p&gt;
&lt;p&gt;Adaptive one-way functions:
Can be adjusted to require more computational resources as hardware improves
Examples of adaptive one-way functions that should be used includeÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html#authentication-password-storage-bcrypt" target="_blank" rel="noopener"
&gt;bcrypt&lt;/a&gt;,Â &lt;a class="link" href="https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html#authentication-password-storage-pbkdf2" target="_blank" rel="noopener"
&gt;PBKDF2&lt;/a&gt;,Â &lt;a class="link" href="https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html#authentication-password-storage-scrypt" target="_blank" rel="noopener"
&gt;scrypt&lt;/a&gt;, andÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html#authentication-password-storage-argon2" target="_blank" rel="noopener"
&gt;argon2&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;PasswordEncoder&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;passwordEncoder&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PasswordEncoderFactories&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;createDelegatingPasswordEncoder&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;DelegatingPasswordEncoder Storage Format&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-text" data-lang="text"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;{id}encodedPassword
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;e.g.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;{bcrypt}$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM/BG
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;UserDetails&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;withDefaultPasswordEncoder&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;username&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;password&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;roles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getPassword&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// {bcrypt}$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM/BG&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Spring Security provides comprehensive support forÂ &lt;a class="link" href="https://en.wikipedia.org/wiki/Authorization" target="_blank" rel="noopener"
&gt;authorization&lt;/a&gt;. Authorization is &lt;strong&gt;determining who is allowed&lt;/strong&gt; to access a particular resource. Spring Security providesÂ &lt;a class="link" href="https://en.wikipedia.org/wiki/Defense_in_depth_%28computing%29" target="_blank" rel="noopener"
&gt;defense in depth&lt;/a&gt;Â by allowing for request based authorization and method based authorization.&lt;/p&gt;
&lt;p&gt;Prevent CSRF (cross site request forgery)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Synchronizer token request&lt;/li&gt;
&lt;li&gt;Samesite attribute
Spring Security does not directly control the creation of the session cookie, so it does not provide support for the SameSite attribute.Â &lt;a class="link" href="https://spring.io/projects/spring-session" target="_blank" rel="noopener"
&gt;Spring Session&lt;/a&gt;Â provides support for theÂ SameSiteÂ attribute in servlet-based applications.Â 
&lt;strong&gt;Safe Methods Must be Read-only&lt;/strong&gt;
ForÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/features/exploits/csrf.html#csrf-protection" target="_blank" rel="noopener"
&gt;either protection&lt;/a&gt;Â against CSRF to work, the application must ensure thatÂ &lt;a class="link" href="https://tools.ietf.org/html/rfc7231#section-4.2.1" target="_blank" rel="noopener"
&gt;&amp;ldquo;safe&amp;rdquo; HTTP methods are read-only&lt;/a&gt;. This means that requests with the HTTPÂ GET,Â HEAD,Â OPTIONS, andÂ TRACEÂ methods should not change the state of the application.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Default Security Headers&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-http" data-lang="http"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;Cache-Control: no-cache, no-store, max-age=0, must-revalidate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;Pragma: no-cache
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;Expires: 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;X-Content-Type-Options: nosniff
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;Strict-Transport-Security: max-age=31536000 ; includeSubDomains(https only)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;X-Frame-Options: DENY
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;X-XSS-Protection: 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Spring Security provides &lt;strong&gt;Spring Data integration&lt;/strong&gt; that allows referring to the current user within your queries. It is not only useful but necessary to include the user in the queries to support paged results since filtering the results afterwards would not scale.&lt;/p&gt;
&lt;p&gt;In most environments, Security is stored on a perÂ ThreadÂ basis. This means that when work is done on a newÂ Thread, theÂ SecurityContextÂ is lost. Spring Security provides some infrastructure to help make this much easier for users. Spring Security provides low level abstractions for working with Spring Security in multi-threaded environments.Â &lt;/p&gt;
&lt;p&gt;The default arrangement of Spring Boot and Spring Security affords the following behaviors at runtime:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Requires an authenticated userÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authorization/authorize-http-requests.html" target="_blank" rel="noopener"
&gt;for any endpoint&lt;/a&gt;Â (including Bootâ€™sÂ /errorÂ endpoint)&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/user-details-service.html" target="_blank" rel="noopener"
&gt;Registers a default user&lt;/a&gt;Â with a generated password at startup (the password is logged to the console; in the preceding example, the password isÂ 8e557245-73e2-4286-969a-ff57fe326336)&lt;/li&gt;
&lt;li&gt;ProtectsÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/password-encoder.html" target="_blank" rel="noopener"
&gt;password storage with BCrypt&lt;/a&gt;Â as well as others&lt;/li&gt;
&lt;li&gt;Provides form-basedÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html" target="_blank" rel="noopener"
&gt;login&lt;/a&gt;Â andÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/logout.html" target="_blank" rel="noopener"
&gt;logout&lt;/a&gt;Â flows&lt;/li&gt;
&lt;li&gt;AuthenticatesÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html" target="_blank" rel="noopener"
&gt;form-based login&lt;/a&gt;Â as well asÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/basic.html" target="_blank" rel="noopener"
&gt;HTTP Basic&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Provides content negotiation; for web requests, redirects to the login page; for service requests, returns aÂ 401 Unauthorized&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/exploits/csrf.html" target="_blank" rel="noopener"
&gt;Mitigates CSRF&lt;/a&gt;Â attacks&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/session-management.html#ns-session-fixation" target="_blank" rel="noopener"
&gt;Mitigates Session Fixation&lt;/a&gt;Â attacks&lt;/li&gt;
&lt;li&gt;WritesÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-hsts" target="_blank" rel="noopener"
&gt;Strict-Transport-Security&lt;/a&gt;Â toÂ &lt;a class="link" href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security" target="_blank" rel="noopener"
&gt;ensure HTTPS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;WritesÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-content-type-options" target="_blank" rel="noopener"
&gt;X-Content-Type-Options&lt;/a&gt;Â to mitigateÂ &lt;a class="link" href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-content-type-options" target="_blank" rel="noopener"
&gt;sniffing attacks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;WritesÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-cache-control" target="_blank" rel="noopener"
&gt;Cache Control headers&lt;/a&gt;Â that protect authenticated resources&lt;/li&gt;
&lt;li&gt;WritesÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-frame-options" target="_blank" rel="noopener"
&gt;X-Frame-Options&lt;/a&gt;Â to mitigateÂ &lt;a class="link" href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-frame-options" target="_blank" rel="noopener"
&gt;Clickjacking&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Integrates withÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/integrations/servlet-api.html" target="_blank" rel="noopener"
&gt;HttpServletRequest&amp;rsquo;s authentication methods&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;PublishesÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/events.html" target="_blank" rel="noopener"
&gt;authentication success and failure events&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;FilterChain&lt;/strong&gt;
Spring Securityâ€™s Servlet support is based on &lt;strong&gt;Servlet Filters&lt;/strong&gt;. The following image shows the typical layering of the handlers for a single HTTP request.
&lt;img src="https://dyhes.github.io/filterchain.png"
loading="lazy"
&gt;
The client sends a request to the application, and the container creates aÂ FilterChain, which contains theÂ FilterÂ &lt;strong&gt;instances&lt;/strong&gt; andÂ ServletÂ that should process theÂ HttpServletRequest, based on the path of the request URI. In a Spring MVC application, theÂ ServletÂ is an instance ofÂ &lt;a class="link" href="https://docs.spring.io/spring-framework/docs/6.1.9/reference/html/web.html#mvc-servlet" target="_blank" rel="noopener"
&gt;DispatcherServlet&lt;/a&gt;.
At most, oneÂ ServletÂ can handle a singleÂ HttpServletRequestÂ andÂ HttpServletResponse.
more than oneÂ FilterÂ can be used to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Prevent downstreamÂ FilterÂ instances or theÂ ServletÂ from being invoked. In this case, theÂ FilterÂ typically writes theÂ HttpServletResponse.&lt;/li&gt;
&lt;li&gt;Modify theÂ HttpServletRequestÂ orÂ HttpServletResponseÂ used by the downstreamÂ FilterÂ instances and theÂ Servlet.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;doFilter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ServletRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ServletResponse&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FilterChain&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// do something before the rest of the application&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;doFilter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// invoke the rest of the application&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// do something after the rest of the application&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;DelegatingFilterProxy&lt;/strong&gt;
Spring provides aÂ &lt;strong&gt;FilterÂ implementation&lt;/strong&gt; namedÂ &lt;a class="link" href="https://docs.spring.io/spring-framework/docs/6.1.9/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html" target="_blank" rel="noopener"
&gt;DelegatingFilterProxy&lt;/a&gt;Â that allows &lt;strong&gt;bridging&lt;/strong&gt; between the Servlet containerâ€™s lifecycle and Springâ€™sÂ ApplicationContext. The Servlet container allows registeringÂ FilterÂ instances by using its own standards, but it is not aware of Spring-defined Beans. You can registerÂ DelegatingFilterProxyÂ through the standard Servlet container mechanisms but delegate all the work to a Spring Bean that implementsÂ Filter.&lt;/p&gt;
&lt;p&gt;Here is a picture of howÂ DelegatingFilterProxyÂ fits into theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filters-review" target="_blank" rel="noopener"
&gt;FilterÂ instances and theÂ FilterChain&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://dyhes.github.io/image%205.png"
loading="lazy"
&gt;
DelegatingFilterProxyÂ looks upÂ &lt;em&gt;Bean Filter 0&lt;/em&gt;Â from theÂ ApplicationContextÂ and then invokesÂ &lt;em&gt;Bean Filter0&lt;/em&gt;.Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;FilterChainProxy&lt;/strong&gt;
&lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/SecurityFilterChain.html" target="_blank" rel="noopener"
&gt;SecurityFilterChain&lt;/a&gt;Â is used byÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filterchainproxy" target="_blank" rel="noopener"
&gt;FilterChainProxy&lt;/a&gt;Â to determine which Spring SecurityÂ FilterÂ instances should be invoked for the current request.
&lt;img src="https://dyhes.github.io/image%206.png"
loading="lazy"
&gt;
TheÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-security-filters" target="_blank" rel="noopener"
&gt;Security Filters&lt;/a&gt;Â inÂ SecurityFilterChainÂ are typically &lt;strong&gt;Beans&lt;/strong&gt;, but they are registered withÂ FilterChainProxyÂ instead ofÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-delegatingfilterproxy" target="_blank" rel="noopener"
&gt;DelegatingFilterProxy&lt;/a&gt;.Â FilterChainProxyÂ provides a number of advantages to registering directly with the Servlet container orÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-delegatingfilterproxy" target="_blank" rel="noopener"
&gt;DelegatingFilterProxy&lt;/a&gt;. First, it provides a starting point for all of Spring Securityâ€™s Servlet support. For that reason&lt;/p&gt;
&lt;p&gt;FilterChainProxyÂ is &lt;strong&gt;central&lt;/strong&gt; to Spring Security usage, it can perform tasks that are not viewed as optional. For example, it clears out theÂ SecurityContextÂ to avoid memory leaks. It also applies Spring Securityâ€™sÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/exploits/firewall.html#servlet-httpfirewall" target="_blank" rel="noopener"
&gt;HttpFirewall&lt;/a&gt;Â to protect applications against certain types of attacks.
In addition, it provides more flexibility in determining when aÂ SecurityFilterChainÂ should be invoked. In a Servlet container,Â FilterÂ instances are invoked based upon the URL alone. However,Â &lt;strong&gt;FilterChainProxyÂ can determine invocation based upon anything in theÂ HttpServletRequest&lt;/strong&gt;Â by using theÂ RequestMatcherÂ interface.
&lt;img src="https://dyhes.github.io/image%207.png"
loading="lazy"
&gt;
&lt;strong&gt;Security Filters&lt;/strong&gt;
Most of the time, the default security filters are enough to provide security to your application. However, there might be times that you want to add a customÂ FilterÂ to the security filter chain.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TenantFilter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Filter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;doFilter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ServletRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;servletRequest&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ServletResponse&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;servletResponse&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FilterChain&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;filterChain&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ServletException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HttpServletRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpServletRequest&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;servletRequest&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HttpServletResponse&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpServletResponse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;servletResponse&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tenantId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getHeader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;X-Tenant-Id&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;hasAccess&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;isUserAllowed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tenantId&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hasAccess&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;filterChain&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;doFilter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;throw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AccessDeniedException&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Access denied&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Configuration&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@EnableWebSecurity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SecurityConfig&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SecurityFilterChain&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;filterChain&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpSecurity&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Exception&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;csrf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Customizer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;withDefaults&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;authorizeHttpRequests&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authorize&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authorize&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;anyRequest&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;authenticated&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;httpBasic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Customizer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;withDefaults&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;formLogin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Customizer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;withDefaults&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addFilterBefore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TenantFilter&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AuthorizationFilter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Be careful when you declare your filter as a Spring bean, either by annotating it withÂ @ComponentÂ or by declaring it as a bean in your configuration, because Spring Boot will automaticallyÂ &lt;a class="link" href="https://docs.spring.io/spring-boot/docs/3.1.1/reference/html/web.html#web.servlet.embedded-container.servlets-filters-listeners.beans" target="_blank" rel="noopener"
&gt;register it with the embedded container&lt;/a&gt;. That may cause the filter to be invoked twice, once by the container and once by Spring Security and in a different order.
&lt;strong&gt;Exception Handing&lt;/strong&gt;
ExceptionTranslationFilterÂ is inserted into theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filterchainproxy" target="_blank" rel="noopener"
&gt;FilterChainProxy&lt;/a&gt;Â as one of theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-security-filters" target="_blank" rel="noopener"
&gt;Security Filters&lt;/a&gt;.
TheÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/access/ExceptionTranslationFilter.html" target="_blank" rel="noopener"
&gt;ExceptionTranslationFilter&lt;/a&gt;Â allows translation ofÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/access/AccessDeniedException.html" target="_blank" rel="noopener"
&gt;AccessDeniedException&lt;/a&gt;Â andÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api//org/springframework/security/core/AuthenticationException.html" target="_blank" rel="noopener"
&gt;AuthenticationException&lt;/a&gt;Â into HTTP responses.
&lt;img src="https://dyhes.github.io/image%208.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If the user is &lt;strong&gt;not authenticated&lt;/strong&gt; or it is anÂ AuthenticationException, thenÂ &lt;em&gt;Start Authentication&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;TheÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder" target="_blank" rel="noopener"
&gt;SecurityContextHolder&lt;/a&gt;Â is cleared out.&lt;/li&gt;
&lt;li&gt;TheÂ HttpServletRequestÂ isÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#savedrequests" target="_blank" rel="noopener"
&gt;saved&lt;/a&gt;Â so that it can be used to replay the original request once authentication is successful.&lt;/li&gt;
&lt;li&gt;TheÂ AuthenticationEntryPointÂ is used to request credentials from the client. For example, it might redirect to a log in page or send aÂ WWW-AuthenticateÂ header.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;If it is anÂ AccessDeniedException, thenÂ &lt;em&gt;Access Denied&lt;/em&gt;. TheÂ AccessDeniedHandlerÂ is invoked to handle access denied.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;If the application does not throw an AccessDeniedException or an AuthenticationException, then ExceptionTranslationFilter does not do anything.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="authentication"&gt;Authentication
&lt;/h3&gt;&lt;p&gt;At the heart of Spring Securityâ€™s &lt;strong&gt;authentication model&lt;/strong&gt; is theÂ SecurityContextHolder. It contains theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontext" target="_blank" rel="noopener"
&gt;SecurityContext&lt;/a&gt;.
&lt;img src="https://dyhes.github.io/securitycontextholder.png"
loading="lazy"
&gt;
TheÂ SecurityContextHolderÂ is where Spring Security stores the details of who isÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/features/authentication/index.html#authentication" target="_blank" rel="noopener"
&gt;authenticated&lt;/a&gt;. Spring Security does not care how theÂ SecurityContextHolderÂ is populated. If it contains a value, it is used as the currently authenticated user.&lt;/p&gt;
&lt;p&gt;Get currently authenticated user&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;SecurityContext&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SecurityContextHolder&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getContext&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Authentication&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authentication&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAuthentication&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authentication&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;principal&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authentication&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getPrincipal&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Collection&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;extends&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GrantedAuthority&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authorities&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authentication&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAuthorities&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;By default,Â SecurityContextHolderÂ uses aÂ ThreadLocalÂ to store these details, which means that &lt;strong&gt;theÂ SecurityContextÂ is always available to methods in the same thread&lt;/strong&gt;, even if theÂ SecurityContextÂ is not explicitly passed around as an argument to those methods.Â Â Using aÂ ThreadLocalÂ in this way is quite safe if you take care to clear the thread after the present principalâ€™s request is processed. Spring Securityâ€™sÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filterchainproxy" target="_blank" rel="noopener"
&gt;FilterChainProxy&lt;/a&gt;Â ensures that theÂ SecurityContextÂ is always cleared.
Â &lt;strong&gt;Authentication&lt;/strong&gt;
â €TheÂ AuthenticationÂ contains:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;principal&lt;/strong&gt;: Identifies the user. When authenticating with a username/password this is often an instance ofÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/user-details.html#servlet-authentication-userdetails" target="_blank" rel="noopener"
&gt;UserDetails&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;credentials&lt;/strong&gt;: Often a password. In many cases, this is cleared after the user is authenticated, to ensure that it is not leaked.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;authorities&lt;/strong&gt;: TheÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-granted-authority" target="_blank" rel="noopener"
&gt;GrantedAuthority&lt;/a&gt;Â instances are high-level permissions the user is granted. Two examples are roles and scopes.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/authentication/AuthenticationManager.html" target="_blank" rel="noopener"
&gt;AuthenticationManager&lt;/a&gt;Â is the API that defines &lt;strong&gt;how Spring Securityâ€™s Filters performÂ &lt;a class="link" href="**https://docs.spring.io/spring-security/reference/features/authentication/index.html#authentication" &gt;authentication&lt;/a&gt;&lt;/strong&gt;. TheÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication" target="_blank" rel="noopener"
&gt;Authentication&lt;/a&gt;Â that is returned is then set on theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder" target="_blank" rel="noopener"
&gt;SecurityContextHolder&lt;/a&gt;Â by the controller (that is, byÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-security-filters" target="_blank" rel="noopener"
&gt;Spring Securityâ€™sÂ FiltersÂ instances&lt;/a&gt;) that invoked theÂ AuthenticationManager.
While the implementation ofÂ AuthenticationManagerÂ could be anything, the most common implementation isÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-providermanager" target="_blank" rel="noopener"
&gt;ProviderManager&lt;/a&gt;.
&lt;img src="https://dyhes.github.io/image%209.png"
loading="lazy"
&gt;
ProviderManagerÂ delegates to &lt;strong&gt;aÂ List&lt;/strong&gt;Â ofÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authenticationprovider" target="_blank" rel="noopener"
&gt;AuthenticationProvider&lt;/a&gt;Â instances. EachÂ AuthenticationProviderÂ has an opportunity to indicate that authentication should be successful, fail, or indicate it cannot make a decision and allow a downstreamÂ AuthenticationProviderÂ to decide. If none of the configuredÂ AuthenticationProviderÂ instances can authenticate, authentication fails with aÂ &lt;strong&gt;ProviderNotFoundException&lt;/strong&gt;, which is a specialÂ AuthenticationExceptionÂ that indicates that theÂ ProviderManagerÂ was not configured to support the type ofÂ AuthenticationÂ that was passed into it.
In practice eachÂ AuthenticationProviderÂ knows how to &lt;strong&gt;perform a specific type of authentication&lt;/strong&gt;. For example, oneÂ AuthenticationProviderÂ might be able to validate a username/password, while another might be able to authenticate a SAML assertion. This lets eachÂ AuthenticationProviderÂ do a very specific type of authentication while supporting multiple types of authentication and expose only a singleÂ AuthenticationManagerÂ bean.
ProviderManagerÂ also allows configuring &lt;strong&gt;an optional parentÂ AuthenticationManager&lt;/strong&gt;, which is consulted in the event that noÂ AuthenticationProviderÂ can perform authentication. The parent can be any type ofÂ AuthenticationManager, but it is often an instance ofÂ ProviderManager.
In fact, multipleÂ ProviderManagerÂ instances might share the same parentÂ AuthenticationManager. This is somewhat common in scenarios where there are multipleÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-securityfilterchain" target="_blank" rel="noopener"
&gt;SecurityFilterChain&lt;/a&gt;Â instances that have some authentication in common (the shared parentÂ AuthenticationManager), but also different authentication mechanisms (the differentÂ ProviderManagerÂ instances).
&lt;img src="https://dyhes.github.io/image%2010.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;When a client makes an unauthenticated request to a resource that they are not authorized to access. In this case, an implementation ofÂ &lt;strong&gt;AuthenticationEntryPoint&lt;/strong&gt;Â is used to request credentials from the client. TheÂ AuthenticationEntryPointÂ implementation might perform aÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html#servlet-authentication-form" target="_blank" rel="noopener"
&gt;redirect to a log in page&lt;/a&gt;, respond with anÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/basic.html#servlet-authentication-basic" target="_blank" rel="noopener"
&gt;WWW-Authenticate&lt;/a&gt;Â header, or take other action.
&lt;strong&gt;AbstractAuthenticationProcessingFilter&lt;/strong&gt;
&lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/AbstractAuthenticationProcessingFilter.html" target="_blank" rel="noopener"
&gt;AbstractAuthenticationProcessingFilter&lt;/a&gt;Â is used as a baseÂ FilterÂ for &lt;strong&gt;authenticating a userâ€™s credentials&lt;/strong&gt;.
&lt;img src="https://dyhes.github.io/image%2011.png"
loading="lazy"
&gt;
When the user submits their credentials, theÂ AbstractAuthenticationProcessingFilterÂ creates anÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication" target="_blank" rel="noopener"
&gt;Authentication&lt;/a&gt;Â from theÂ HttpServletRequestÂ to be authenticated. The type ofÂ AuthenticationÂ created depends on the subclass ofÂ AbstractAuthenticationProcessingFilter. For example,Â &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html#servlet-authentication-usernamepasswordauthenticationfilter" target="_blank" rel="noopener"
&gt;UsernamePasswordAuthenticationFilter&lt;/a&gt;Â creates aÂ UsernamePasswordAuthenticationTokenÂ from aÂ &lt;em&gt;username&lt;/em&gt;Â andÂ &lt;em&gt;password&lt;/em&gt;Â that are submitted in theÂ HttpServletRequest.
Next, theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication" target="_blank" rel="noopener"
&gt;Authentication&lt;/a&gt;Â is passed into theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authenticationmanager" target="_blank" rel="noopener"
&gt;AuthenticationManager&lt;/a&gt;Â to be authenticated.
If authentication fails, thenÂ &lt;em&gt;Failure&lt;/em&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;TheÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder" target="_blank" rel="noopener"
&gt;SecurityContextHolder&lt;/a&gt;Â is cleared out.&lt;/li&gt;
&lt;li&gt;RememberMeServices.loginFailÂ is invoked. If remember me is not configured, this is a no-op. See theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/rememberme/package-frame.html" target="_blank" rel="noopener"
&gt;rememberme&lt;/a&gt;Â package.&lt;/li&gt;
&lt;li&gt;AuthenticationFailureHandlerÂ is invoked. See theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/AuthenticationFailureHandler.html" target="_blank" rel="noopener"
&gt;AuthenticationFailureHandler&lt;/a&gt;Â interface.
If authentication is successful, thenÂ &lt;em&gt;Success&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;SessionAuthenticationStrategyÂ is notified of a new login. See theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/session/SessionAuthenticationStrategy.html" target="_blank" rel="noopener"
&gt;SessionAuthenticationStrategy&lt;/a&gt;Â interface.&lt;/li&gt;
&lt;li&gt;TheÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication" target="_blank" rel="noopener"
&gt;Authentication&lt;/a&gt;Â is set on theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder" target="_blank" rel="noopener"
&gt;SecurityContextHolder&lt;/a&gt;. Later, if you need to save theÂ SecurityContextÂ so that it can be automatically set on future requests,Â SecurityContextRepository#saveContextÂ must be explicitly invoked. See theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/SecurityContextHolderFilter.html" target="_blank" rel="noopener"
&gt;SecurityContextHolderFilter&lt;/a&gt;Â class.&lt;/li&gt;
&lt;li&gt;RememberMeServices.loginSuccessÂ is invoked. If remember me is not configured, this is a no-op. See theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/rememberme/package-frame.html" target="_blank" rel="noopener"
&gt;rememberme&lt;/a&gt;Â package.&lt;/li&gt;
&lt;li&gt;ApplicationEventPublisherÂ publishes anÂ InteractiveAuthenticationSuccessEvent.&lt;/li&gt;
&lt;li&gt;AuthenticationSuccessHandlerÂ is invoked. See theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/AuthenticationSuccessHandler.html" target="_blank" rel="noopener"
&gt;AuthenticationSuccessHandler&lt;/a&gt;Â interface.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="usernamepassword-authentication"&gt;â €Username/Password Authentication
&lt;/h4&gt;&lt;p&gt;authenticate users via a REST APIÂ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Configuration&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@EnableWebSecurity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SecurityConfig&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SecurityFilterChain&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;securityFilterChain&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpSecurity&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Exception&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;authorizeHttpRequests&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;authorize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authorize&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;requestMatchers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;/login&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="na"&gt;permitAll&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;anyRequest&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;authenticated&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AuthenticationManager&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;authenticationManager&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserDetailsService&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userDetailsService&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PasswordEncoder&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;passwordEncoder&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DaoAuthenticationProvider&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authenticationProvider&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DaoAuthenticationProvider&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authenticationProvider&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setUserDetailsService&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;userDetailsService&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authenticationProvider&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setPasswordEncoder&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;passwordEncoder&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ProviderManager&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authenticationProvider&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserDetailsService&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;userDetailsService&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserDetails&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userDetails&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;withDefaultPasswordEncoder&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;username&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;password&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;roles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;USER&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;InMemoryUserDetailsManager&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;userDetails&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PasswordEncoder&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;passwordEncoder&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PasswordEncoderFactories&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;createDelegatingPasswordEncoder&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@RestController&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LoginController&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AuthenticationManager&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authenticationManager&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;LoginController&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuthenticationManager&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authenticationManager&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;authenticationManager&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authenticationManager&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@PostMapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;/login&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ResponseEntity&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Void&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@RequestBody&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LoginRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;loginRequest&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Authentication&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authenticationRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UsernamePasswordAuthenticationToken&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unauthenticated&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loginRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;username&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;loginRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;password&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Authentication&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authenticationResponse&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;authenticationManager&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;authenticate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authenticationRequest&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ...&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;record&lt;/span&gt; &lt;span class="nc"&gt;LoginRequest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Built-in mechanism for reading a username:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html" target="_blank" rel="noopener"
&gt;Form&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/basic.html" target="_blank" rel="noopener"
&gt;Basic&lt;/a&gt;
WWW-Authenticate header&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/digest.html" target="_blank" rel="noopener"
&gt;Digest&lt;/a&gt;
You should not use Digest Authentication in modern applications, because it is not considered to be secure.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;DaoAuthenticationProvider&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/authentication/dao/DaoAuthenticationProvider.html" target="_blank" rel="noopener"
&gt;DaoAuthenticationProvider&lt;/a&gt;Â is anÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authenticationprovider" target="_blank" rel="noopener"
&gt;AuthenticationProvider&lt;/a&gt;Â implementation that uses aÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/user-details-service.html#servlet-authentication-userdetailsservice" target="_blank" rel="noopener"
&gt;UserDetailsService&lt;/a&gt;Â andÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/password-encoder.html#servlet-authentication-password-storage" target="_blank" rel="noopener"
&gt;PasswordEncoder&lt;/a&gt;Â to authenticate a username and password.
&lt;img src="https://dyhes.github.io/image%2012.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;h4 id="persistence"&gt;&lt;strong&gt;Persistence&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;in Spring Security the association of the user to future requests is made using &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/SecurityContextRepository.html" target="_blank" rel="noopener"
&gt;SecurityContextRepository&lt;/a&gt;. The default implementation ofÂ SecurityContextRepositoryÂ isÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/DelegatingSecurityContextRepository.html" target="_blank" rel="noopener"
&gt;DelegatingSecurityContextRepository&lt;/a&gt;Â which delegates to the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#httpsecuritycontextrepository" target="_blank" rel="noopener"
&gt;HttpSessionSecurityContextRepository&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#requestattributesecuritycontextrepository" target="_blank" rel="noopener"
&gt;RequestAttributeSecurityContextRepository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;NullSecurityContextRepository&lt;/strong&gt;
If it is not desirable to associate theÂ SecurityContextÂ to anÂ HttpSessionÂ (i.e. when authenticating with OAuth) theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/NullSecurityContextRepository.html" target="_blank" rel="noopener"
&gt;NullSecurityContextRepository&lt;/a&gt;Â is an implementation ofÂ SecurityContextRepositoryÂ that does nothing.&lt;/p&gt;
&lt;p&gt;The&lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/SecurityContextPersistenceFilter.html" target="_blank" rel="noopener"
&gt;SecurityContextPersistenceFilter&lt;/a&gt;Â is responsible for persisting theÂ SecurityContextÂ between requests using theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#securitycontextrepository" target="_blank" rel="noopener"
&gt;SecurityContextRepository&lt;/a&gt;.
&lt;img src="https://dyhes.github.io/image%2013.png"
loading="lazy"
&gt;
&lt;strong&gt;SecurityContextHolderFilter&lt;/strong&gt;
The &lt;a class="link" href="https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/SecurityContextHolderFilter.html" target="_blank" rel="noopener"
&gt;SecurityContextHolderFilter&lt;/a&gt;Â is responsible for loading theÂ SecurityContextÂ between requests using theÂ &lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#securitycontextrepository" target="_blank" rel="noopener"
&gt;SecurityContextRepository&lt;/a&gt;.
&lt;img src="https://dyhes.github.io/image%2014.png"
loading="lazy"
&gt;
Unlike,&lt;a class="link" href="https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#securitycontextpersistencefilter" target="_blank" rel="noopener"
&gt;SecurityContextPersistenceFilter&lt;/a&gt;,Â SecurityContextHolderFilterÂ only loads theÂ SecurityContextÂ it does not save theÂ SecurityContext. This means that when usingÂ SecurityContextHolderFilter, it is required that theÂ SecurityContextÂ is explicitly saved.&lt;/p&gt;
&lt;h2 id="restful-api"&gt;Restful API
&lt;/h2&gt;&lt;p&gt;@RestController&lt;/p&gt;
&lt;p&gt;@Service&lt;/p&gt;
&lt;p&gt;@Reposity&lt;/p&gt;</description></item></channel></rss>