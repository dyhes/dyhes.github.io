<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Java on é£é¸¿è¸é›ªæ³¥</title><link>https://dyhes.github.io/tags/java/</link><description>Recent content in Java on é£é¸¿è¸é›ªæ³¥</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 22 Oct 2025 16:27:30 +0800</lastBuildDate><atom:link href="https://dyhes.github.io/tags/java/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€NowCoderã€‘JAVA 2</title><link>https://dyhes.github.io/p/nowcoderjava-2/</link><pubDate>Wed, 01 Oct 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/nowcoderjava-2/</guid><description>&lt;h2 id="è‡ªåŠ¨è£…ç®±"&gt;è‡ªåŠ¨è£…ç®±
&lt;/h2&gt;&lt;p&gt;è‡ªåŠ¨è£…ç®±ï¼ˆAutoboxingï¼‰å’Œè‡ªåŠ¨æ‹†ç®±ï¼ˆAuto-unboxingï¼‰æ˜¯ Java 5 å¼•å…¥çš„é‡è¦ç‰¹æ€§ï¼Œå®ƒä»¬ç®€åŒ–äº†åŸºæœ¬æ•°æ®ç±»å‹ä¸å…¶å¯¹åº”åŒ…è£…ç±»ä¹‹é—´çš„è½¬æ¢ï¼Œè®©ä»£ç æ›´ç®€æ´ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€ŸæŠ“ä½æ ¸å¿ƒè¦ç‚¹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;å®šä¹‰&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹&lt;/th&gt;
&lt;th&gt;åº•å±‚åŸç†&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªåŠ¨è£…ç®±&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨å°†åŸºæœ¬æ•°æ®ç±»å‹å€¼è½¬æ¢ä¸ºå¯¹åº”çš„åŒ…è£…ç±»å¯¹è±¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Integer i = 100;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘å™¨è°ƒç”¨ &lt;code&gt;Integer.valueOf(100)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªåŠ¨æ‹†ç®±&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨å°†åŒ…è£…ç±»å¯¹è±¡è½¬æ¢ä¸ºå¯¹åº”çš„åŸºæœ¬æ•°æ®ç±»å‹å€¼&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int j = i;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘å™¨è°ƒç”¨ &lt;code&gt;i.intValue()&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ä¸ºä½•éœ€è¦è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±"&gt;ğŸ’¡ ä¸ºä½•éœ€è¦è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±
&lt;/h3&gt;&lt;p&gt;åœ¨ Java è¿™æ ·çš„é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œå¾ˆå¤šåœ°æ–¹ï¼ˆæ¯”å¦‚é›†åˆæ¡†æ¶ &lt;code&gt;ArrayList&lt;/code&gt;ã€&lt;code&gt;HashMap&lt;/code&gt;ï¼‰åªèƒ½æ“ä½œå¯¹è±¡ã€‚è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±ä½¿å¾—æˆ‘ä»¬æ—¢èƒ½åˆ©ç”¨åŸºæœ¬æ•°æ®ç±»å‹çš„é«˜æ•ˆï¼Œåˆèƒ½åœ¨éœ€è¦å¯¹è±¡çš„åœºåˆæ— ç¼ä½¿ç”¨å®ƒä»¬ï¼Œæå¤§åœ°æå‡äº†ä»£ç çš„ç®€æ´æ€§å’Œå¯è¯»æ€§ ã€‚&lt;/p&gt;
&lt;h3 id="-å·¥ä½œåŸç†ä¸ç»†èŠ‚"&gt;ğŸ” å·¥ä½œåŸç†ä¸ç»†èŠ‚
&lt;/h3&gt;&lt;p&gt;è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±æ˜¯ Java ç¼–è¯‘å™¨æä¾›çš„â€œè¯­æ³•ç³–â€ï¼Œç¼–è¯‘æ—¶ç¼–è¯‘å™¨ä¼šå¸®ä½ æ’å…¥å¿…è¦çš„è½¬æ¢ä»£ç  ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨è£…ç®±çš„åº•å±‚&lt;/strong&gt;ï¼šå®é™…è°ƒç”¨çš„æ˜¯åŒ…è£…ç±»çš„ &lt;code&gt;valueOf()&lt;/code&gt;æ–¹æ³•ï¼Œä¾‹å¦‚ &lt;code&gt;Integer.valueOf()&lt;/code&gt;ï¼Œè€Œä¸æ˜¯ &lt;code&gt;new Integer()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨æ‹†ç®±çš„åº•å±‚&lt;/strong&gt;ï¼šå®é™…è°ƒç”¨çš„æ˜¯åŒ…è£…ç±»çš„ &lt;code&gt;xxxValue()&lt;/code&gt;æ–¹æ³•ï¼Œä¾‹å¦‚ &lt;code&gt;Integer.intValue()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ&lt;strong&gt;åŒ…è£…ç±»çš„ç¼“å­˜æœºåˆ¶&lt;/strong&gt;ã€‚ä»¥ &lt;code&gt;Integer&lt;/code&gt;ä¸ºä¾‹ï¼Œå¯¹äº &lt;strong&gt;-128 åˆ° 127&lt;/strong&gt; ä¹‹é—´çš„æ•´æ•°ï¼Œ&lt;code&gt;valueOf()&lt;/code&gt;æ–¹æ³•ä¼šè¿”å›é¢„å…ˆåˆ›å»ºå¥½çš„ç¼“å­˜å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½åˆ›å»ºæ–°å¯¹è±¡ ã€‚å› æ­¤ï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…ç”¨ &lt;code&gt;==&lt;/code&gt;æ¯”è¾ƒå¯èƒ½ä¸º &lt;code&gt;true&lt;/code&gt;ï¼Œä½†è¶…å‡ºæ­¤èŒƒå›´åˆ™ç»“æœä¸º &lt;code&gt;false&lt;/code&gt;ã€‚&lt;strong&gt;è¿›è¡Œå€¼æ¯”è¾ƒæ—¶ï¼Œæ›´å¯é çš„æ–¹å¼æ˜¯ä½¿ç”¨ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Integer a = 127;
Integer b = 127;
System.out.println(a == b); // true, å› ä¸ºå‘½ä¸­äº†ç¼“å­˜
Integer c = 128;
Integer d = 128;
System.out.println(c == d); // false, å› ä¸ºè¶…å‡ºäº†ç¼“å­˜èŒƒå›´ï¼Œæ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡
System.out.println(c.equals(d)); // true, æ¯”è¾ƒçš„æ˜¯å€¼
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹"&gt;âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;å°½ç®¡è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±å¾ˆæ–¹ä¾¿ï¼Œä½†åœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;ï¼šæ¯æ¬¡è£…ç®±éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ˆå°½ç®¡å°æ•´æ•°æœ‰ç¼“å­˜ï¼‰ï¼Œè€Œæ‹†ç®±éœ€è¦è°ƒç”¨æ–¹æ³•ã€‚åœ¨&lt;strong&gt;å¤§é‡å¾ªç¯æˆ–æ€§èƒ½æ•æ„Ÿçš„ä»£ç &lt;/strong&gt;ä¸­ï¼Œé¢‘ç¹çš„è£…ç®±/æ‹†ç®±å¯èƒ½ä¼šå¸¦æ¥ä¸å¿…è¦çš„å†…å­˜å¼€é”€å’Œåƒåœ¾å›æ”¶å‹åŠ›ã€‚åœ¨è¿™äº›åœºæ™¯ä¸‹ï¼Œç›´æ¥ä½¿ç”¨åŸºæœ¬ç±»å‹é€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹© ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç©ºæŒ‡é’ˆé£é™©&lt;/strong&gt;ï¼šåŒ…è£…ç±»å¯¹è±¡å¯ä»¥ä¸º &lt;code&gt;null&lt;/code&gt;ï¼Œè€ŒåŸºæœ¬ç±»å‹ä¸èƒ½ã€‚å¦‚æœå¯¹ä¸€ä¸ªå€¼ä¸º &lt;code&gt;null&lt;/code&gt;çš„åŒ…è£…ç±»å¯¹è±¡è¿›è¡Œè‡ªåŠ¨æ‹†ç®±ï¼Œä¼šæŠ›å‡º &lt;code&gt;NullPointerException&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Integer nullInteger = null;
int num = nullInteger; // è¿è¡Œæ—¶æŠ›å‡º NullPointerException
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¼“å­˜æœºåˆ¶çš„å½±å“&lt;/strong&gt;ï¼šå¦‚ä¸Šæ–‡æ‰€è¿°ï¼ŒåŒ…è£…ç±»çš„ç¼“å­˜æœºåˆ¶ä¼šå½±å“ &lt;code&gt;==&lt;/code&gt;è¿ç®—ç¬¦çš„æ¯”è¾ƒç»“æœã€‚å¯¹äºå€¼çš„æ¯”è¾ƒï¼Œåº”ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³• ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±æ˜¯ Java å¼€å‘ä¸­çš„å®ç”¨ç‰¹æ€§ï¼Œå®ƒä»¬é€šè¿‡åœ¨åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»ä¹‹é—´æ¶èµ·ä¸€åº§è‡ªåŠ¨åŒ–çš„æ¡¥æ¢ï¼Œè®©ä»£ç ç¼–å†™æ›´åŠ ä¾¿æ·ã€‚ç†è§£å…¶èƒŒåçš„åŸç†å’Œæ³¨æ„äº‹é¡¹ï¼Œèƒ½å¸®åŠ©ä½ åœ¨äº«å—ä¾¿åˆ©çš„åŒæ—¶ï¼Œå†™å‡ºæ›´å¥å£®ã€é«˜æ•ˆçš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šå¯¹ä½ æœ‰å¸®åŠ©ï¼å¦‚æœä½ å¯¹æŸä¸ªç»†èŠ‚è¿˜æƒ³æ·±å…¥äº†è§£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="èŒƒå‹"&gt;èŒƒå‹
&lt;/h2&gt;&lt;p&gt;æ³›å‹ã€é€†å˜å’Œåå˜æ˜¯ç±»å‹ç³»ç»Ÿä¸­æ—¢é‡è¦åˆå®¹æ˜“è®©äººå›°æƒ‘çš„æ¦‚å¿µã€‚ä¸ºäº†å¸®åŠ©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“å°è±¡ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒä»¬çš„æ ¸å¿ƒç‰¹å¾å’Œè®¾è®¡è€ƒé‡ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ¦‚å¿µ&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒå®šä¹‰&lt;/th&gt;
&lt;th&gt;å…¸å‹è¯­æ³•/åœºæ™¯&lt;/th&gt;
&lt;th&gt;å…³é”®çº¦æŸä¸è®¾è®¡è€ƒé‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ³›å‹ (Generics)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‚æ•°åŒ–ç±»å‹ï¼Œåˆ›å»ºå¯å¤ç”¨ä¸”ç±»å‹å®‰å…¨çš„ä»£ç ç»„ä»¶ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;List&amp;lt;String&amp;gt;&lt;/code&gt;, &lt;code&gt;Box&amp;lt;T&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è§£å†³åŸå§‹ç±»å‹çš„ç±»å‹å®‰å…¨é—®é¢˜ï¼›Javaé€šè¿‡ç±»å‹æ“¦é™¤å®ç°ï¼Œå¯èƒ½å¯¼è‡´è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ä¸¢å¤±ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åå˜ (Covariance)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœ &lt;code&gt;Cat&lt;/code&gt;æ˜¯ &lt;code&gt;Animal&lt;/code&gt;çš„å­ç±»å‹ï¼Œåˆ™ &lt;code&gt;Generic&amp;lt;Cat&amp;gt;&lt;/code&gt;ä¹Ÿæ˜¯ &lt;code&gt;Generic&amp;lt;Animal&amp;gt;&lt;/code&gt;çš„å­ç±»å‹ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;? extends Animal&amp;gt;&lt;/code&gt;(Java)ï¼Œ&lt;code&gt;out T&lt;/code&gt;(Kotlin)ï¼Œæ•°ç»„ï¼ˆJavaä¸­&lt;code&gt;String[]&lt;/code&gt;å¯èµ‹å€¼ç»™&lt;code&gt;Object[]&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åªè¯»å®‰å…¨&lt;/strong&gt;ã€‚å…è®¸è¯»å–ï¼ˆè¿”å›æ›´å…·ä½“çš„ç±»å‹ï¼‰ï¼Œä½†ç¦æ­¢å†™å…¥ï¼ˆæ— æ³•ä¿è¯ç±»å‹å®‰å…¨ï¼‰ã€‚Javaæ•°ç»„çš„åå˜æ˜¯å†å²è®¾è®¡ï¼Œå¯èƒ½å¯¼è‡´&lt;code&gt;ArrayStoreException&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€†å˜ (Contravariance)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœ &lt;code&gt;Cat&lt;/code&gt;æ˜¯ &lt;code&gt;Animal&lt;/code&gt;çš„å­ç±»å‹ï¼Œåˆ™ &lt;code&gt;Generic&amp;lt;Animal&amp;gt;&lt;/code&gt;æ˜¯ &lt;code&gt;Generic&amp;lt;Cat&amp;gt;&lt;/code&gt;çš„å­ç±»å‹ï¼ˆç»§æ‰¿å…³ç³»åè½¬ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;? super Cat&amp;gt;&lt;/code&gt;(Java)ï¼Œ&lt;code&gt;in T&lt;/code&gt;(Kotlin)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å†™å…¥å®‰å…¨&lt;/strong&gt;ã€‚å…è®¸å†™å…¥ï¼ˆæ¥å—å…·ä½“ç±»å‹åŠå…¶å­ç±»ï¼‰ï¼Œä½†è¯»å–ä¸å®‰å…¨ï¼ˆåªèƒ½è¯»å–ä¸º&lt;code&gt;Object&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ä¸ºä½•éœ€è¦æ³›å‹"&gt;ğŸ’¡ ä¸ºä½•éœ€è¦æ³›å‹
&lt;/h3&gt;&lt;p&gt;åœ¨æ³›å‹å‡ºç°ä¹‹å‰ï¼Œä½¿ç”¨é›†åˆç±»ç­‰é€šç”¨æ•°æ®ç»“æ„æ—¶ï¼Œéœ€è¦å°†å…ƒç´ è§†ä¸º &lt;code&gt;Object&lt;/code&gt;ç±»å‹ã€‚è¿™å¸¦æ¥äº†ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹ä¸å®‰å…¨&lt;/strong&gt;ï¼šç¼–è¯‘å™¨æ— æ³•æ£€æŸ¥æ·»åŠ çš„å…ƒç´ ç±»å‹æ˜¯å¦æ­£ç¡®ï¼Œåªèƒ½ä¾èµ–ç¨‹åºå‘˜è‡ªå·±ä¿è¯ï¼Œå®¹æ˜“åœ¨è¿è¡Œæ—¶å‡ºç° &lt;code&gt;ClassCastException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¹ççš„ç±»å‹è½¬æ¢&lt;/strong&gt;ï¼šæ¯æ¬¡ä»é›†åˆä¸­å–å‡ºå…ƒç´ ï¼Œéƒ½éœ€è¦è¿›è¡Œæ˜¾å¼çš„å‘ä¸‹ç±»å‹è½¬æ¢ï¼Œä»£ç å†—é•¿ä¸”å®¹æ˜“å‡ºé”™ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ³›å‹é€šè¿‡åœ¨ç¼–è¯‘æœŸå¼ºåˆ¶æ‰§è¡Œç±»å‹çº¦æŸï¼Œå®Œç¾åœ°è§£å†³äº†è¿™äº›é—®é¢˜ã€‚å®ƒè®©ç±»å‹æˆä¸ºå‚æ•°ï¼Œä½¿å¾—ç±»ã€æ¥å£å’Œæ–¹æ³•å¯ä»¥åœ¨ä¸åŒç±»å‹çš„å¯¹è±¡ä¸Šæ“ä½œï¼ŒåŒæ—¶ä¿è¯ç¼–è¯‘æ—¶çš„ç±»å‹å®‰å…¨ ã€‚&lt;/p&gt;
&lt;h3 id="-ç†è§£åå˜æ”¾å®½è¯»å–çš„é™åˆ¶"&gt;ğŸ”„ ç†è§£åå˜ï¼šæ”¾å®½è¯»å–çš„é™åˆ¶
&lt;/h3&gt;&lt;p&gt;åå˜çš„æ ¸å¿ƒç›´è§‰æ˜¯ &lt;strong&gt;&amp;ldquo;æ˜¯ä¸€ç§&amp;quot;çš„å…³ç³»å¯ä»¥ä¼ é€’&lt;/strong&gt;ã€‚å¦‚æœ &lt;code&gt;Dog&lt;/code&gt;æ˜¯ä¸€ç§ &lt;code&gt;Animal&lt;/code&gt;ï¼Œé‚£ä¹ˆä¸€ç¯®å­ &lt;code&gt;Dog&lt;/code&gt;ï¼ˆ&lt;code&gt;List&amp;lt;Dog&amp;gt;&lt;/code&gt;ï¼‰ä¹Ÿåº”è¯¥å¯ä»¥è¢«è§†ä¸ºä¸€ç¯®å­ &lt;code&gt;Animal&lt;/code&gt;ï¼ˆ&lt;code&gt;List&amp;lt;Animal&amp;gt;&lt;/code&gt;ï¼‰æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚è¯»å–å…¶ä¸­çš„å…ƒç´  ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œè¿™ç§æ”¾å®½æ˜¯æœ‰ä»£ä»·çš„ï¼š&lt;strong&gt;åå˜ç»“æ„æ˜¯åªè¯»çš„&lt;/strong&gt;ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå¦‚æœå…è®¸å†™å…¥ï¼Œå°±ä¼šç ´åç±»å‹å®‰å…¨ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;Dog&amp;gt; dogs = new ArrayList&amp;lt;&amp;gt;();
List&amp;lt;? extends Animal&amp;gt; animals = dogs; // åå˜ï¼Œåˆæ³•
animals.add(new Cat()); // ç¼–è¯‘é”™è¯¯ï¼å¦åˆ™ dogs é‡Œä¼šæ··å…¥ Cat
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç¼–è¯‘å™¨ä¼šé˜»æ­¢ &lt;code&gt;add&lt;/code&gt;æ“ä½œï¼Œå› ä¸ºå®ƒæ— æ³•ç¡®å®š &lt;code&gt;animals&lt;/code&gt;å®é™…å¼•ç”¨çš„é›†åˆå…·ä½“å…è®¸æ·»åŠ å“ªç§ &lt;code&gt;Animal&lt;/code&gt;çš„å­ç±»ï¼ˆå¯èƒ½æ˜¯ &lt;code&gt;Dog&lt;/code&gt;ï¼Œä¹Ÿå¯èƒ½æ˜¯ &lt;code&gt;Cat&lt;/code&gt;ï¼‰ã€‚å› æ­¤ï¼Œå¯¹å£°æ˜ä¸ºåå˜çš„æ³›å‹é›†åˆï¼Œåªèƒ½ä»ä¸­å®‰å…¨åœ° &lt;strong&gt;è¯»å–&lt;/strong&gt; å…ƒç´ ï¼ˆè¯»å‡ºçš„ç±»å‹æ˜¯ &lt;code&gt;Animal&lt;/code&gt;ï¼‰ï¼Œè€Œä¸èƒ½ &lt;strong&gt;å†™å…¥&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;p&gt;Java ä¸­çš„æ•°ç»„è¢«è®¾è®¡ä¸ºåå˜çš„ï¼Œä½†è¿™è¢«æ™®éè®¤ä¸ºæ˜¯ä¸€ä¸ªå†å²æ€§çš„è®¾è®¡ç¼ºé™·ï¼Œå› ä¸ºå®ƒä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º &lt;code&gt;ArrayStoreException&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id="-ç†è§£é€†å˜æ”¾å®½å†™å…¥çš„é™åˆ¶"&gt;ğŸ”ƒ ç†è§£é€†å˜ï¼šæ”¾å®½å†™å…¥çš„é™åˆ¶
&lt;/h3&gt;&lt;p&gt;é€†å˜ç›´è§‚ä¸Šä¸é‚£ä¹ˆå¥½ç†è§£ã€‚å®ƒåè½¬äº†å­ç±»å‹å…³ç³»ï¼šå¦‚æœ &lt;code&gt;Dog&lt;/code&gt;æ˜¯ä¸€ç§ &lt;code&gt;Animal&lt;/code&gt;ï¼Œé‚£ä¹ˆä¸€ä¸ªå¤„ç† &lt;code&gt;Animal&lt;/code&gt;çš„å®¹å™¨ï¼ˆ&lt;code&gt;List&amp;lt;Animal&amp;gt;&lt;/code&gt;ï¼‰åè€Œå¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªå¤„ç† &lt;code&gt;Dog&lt;/code&gt;çš„å®¹å™¨ï¼ˆ&lt;code&gt;List&amp;lt;Dog&amp;gt;&lt;/code&gt;ï¼‰æ¥ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ &lt;strong&gt;å†™å…¥&lt;/strong&gt; æ“ä½œä¸Š ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¿™æ ·æœ‰ç”¨ï¼Ÿå› ä¸ºè¿™æ ·çš„å®¹å™¨èƒ½å¤Ÿæ¥å— &lt;code&gt;Dog&lt;/code&gt;ä»¥åŠä»»ä½• &lt;code&gt;Dog&lt;/code&gt;çš„å­ç±»ã€‚é€†å˜çš„æ ¸å¿ƒåœ¨äº &lt;strong&gt;æ”¯æŒå®‰å…¨å†™å…¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;Animal&amp;gt; animals = new ArrayList&amp;lt;&amp;gt;();
List&amp;lt;? super Dog&amp;gt; dogConsumer = animals; // é€†å˜ï¼Œåˆæ³•
dogConsumer.add(new Dog()); // å®‰å…¨ï¼ŒDog å¯ä»¥è¢«åŠ å…¥ Animal é›†åˆ
dogConsumer.add(new Labrador()); // å®‰å…¨ï¼ŒLabrador æ˜¯ Dog çš„å­ç±»
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä½†æ˜¯ï¼Œä»é€†å˜ç»“æ„ä¸­ &lt;strong&gt;è¯»å–&lt;/strong&gt; æ•°æ®æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºæ— æ³•ç¡®å®šå–å‡ºçš„å¯¹è±¡å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼Œåªèƒ½çŸ¥é“å®ƒæ˜¯ &lt;code&gt;Object&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id="-åº”ç”¨åŸåˆ™ä¸å¤šè¯­è¨€è§†è§’"&gt;ğŸ“š åº”ç”¨åŸåˆ™ä¸å¤šè¯­è¨€è§†è§’
&lt;/h3&gt;&lt;p&gt;ç†è§£è¿™äº›æ¦‚å¿µåï¼Œå…³é”®åœ¨äºåº”ç”¨ã€‚&lt;strong&gt;PECS åŸåˆ™&lt;/strong&gt;ï¼ˆProducer-Extends, Consumer-Superï¼‰æ˜¯ Java ä¸­ä½¿ç”¨é€šé…ç¬¦çš„é‡è¦æŒ‡å— ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…ï¼ˆProducerï¼‰&lt;/strong&gt;ï¼šå¦‚æœä½ éœ€è¦ä¸€ä¸ªæä¾› &lt;code&gt;T&lt;/code&gt;ç±»å‹æ•°æ®çš„å¯¹è±¡ï¼ˆç”Ÿäº§è€…ï¼‰ï¼Œä½¿ç”¨ &lt;code&gt;&amp;lt;? extends T&amp;gt;&lt;/code&gt;ï¼ˆåå˜ï¼‰ï¼Œå› ä¸ºä½ åªä»ä¸­è¯»å–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰&lt;/strong&gt;ï¼šå¦‚æœä½ éœ€è¦ä¸€ä¸ªæ¥æ”¶ &lt;code&gt;T&lt;/code&gt;ç±»å‹æ•°æ®çš„å¯¹è±¡ï¼ˆæ¶ˆè´¹è€…ï¼‰ï¼Œä½¿ç”¨ &lt;code&gt;&amp;lt;? super T&amp;gt;&lt;/code&gt;ï¼ˆé€†å˜ï¼‰ï¼Œå› ä¸ºä½ åªå‘å®ƒå†™å…¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;java.util.Collections&lt;/code&gt;çš„ &lt;code&gt;copy&lt;/code&gt;æ–¹æ³•æ˜¯ä¸€ä¸ªç»å…¸ä¾‹å­ ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public static &amp;lt;T&amp;gt; void copy(List&amp;lt;? super T&amp;gt; dest, List&amp;lt;? extends T&amp;gt; src)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é‡Œï¼Œ&lt;code&gt;src&lt;/code&gt;æ˜¯ç”Ÿäº§è€…ï¼Œæ•…ç”¨ &lt;code&gt;extends&lt;/code&gt;ï¼›&lt;code&gt;dest&lt;/code&gt;æ˜¯æ¶ˆè´¹è€…ï¼Œæ•…ç”¨ &lt;code&gt;super&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒè¯­è¨€å¯¹å‹å˜çš„å¤„ç†å„æœ‰ç‰¹è‰²ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Kotlin&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;out&lt;/code&gt;ï¼ˆåå˜ï¼‰å’Œ &lt;code&gt;in&lt;/code&gt;ï¼ˆé€†å˜ï¼‰å…³é”®å­—åœ¨&lt;strong&gt;å£°æ˜å¤„&lt;/strong&gt;æŒ‡å®šå‹å˜ï¼Œæ›´åŠ ç®€æ´ç›´è§‚ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;C#&lt;/strong&gt;ï¼šä¸ Java ç±»ä¼¼ï¼Œä¹Ÿæ”¯æŒä½¿ç”¨æ¥å£ï¼ˆå¦‚ &lt;code&gt;IEnumerable&amp;lt;out T&amp;gt;&lt;/code&gt;ï¼‰åœ¨å£°æ˜å¤„å®šä¹‰å‹å˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Scala&lt;/strong&gt;ï¼šåŒæ ·æ”¯æŒå£°æ˜å¤„å‹å˜ï¼Œä½¿ç”¨ &lt;code&gt;[+T]&lt;/code&gt;è¡¨ç¤ºåå˜ï¼Œ&lt;code&gt;[-T]&lt;/code&gt;è¡¨ç¤ºé€†å˜ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ³›å‹æä¾›äº†ç±»å‹å®‰å…¨çš„æŠ½è±¡ï¼Œè€Œé€†å˜å’Œåå˜åˆ™æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ çš„çµæ´»æ€§ï¼Œå…è®¸æ›´æ™ºèƒ½çš„ç±»å‹å…³ç³»ä¼ é€’ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ³›å‹&lt;/strong&gt;ï¼šè®©ä»£ç åœ¨ç¼–è¯‘æ—¶æ›´å®‰å…¨ï¼Œåœ¨è¡¨è¾¾ä¸Šæ›´æ¸…æ™°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åå˜(&lt;code&gt;extends&lt;/code&gt;/&lt;code&gt;out&lt;/code&gt;)&lt;/strong&gt;ï¼šå…³æ³¨äº&lt;strong&gt;å®‰å…¨åœ°ä»æ³›å‹ç»“æ„ä¸­è¯»å–&lt;/strong&gt;æ•°æ®ï¼Œé€‚ç”¨äºç”Ÿäº§è€…åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€†å˜(&lt;code&gt;super&lt;/code&gt;/&lt;code&gt;in&lt;/code&gt;)&lt;/strong&gt;ï¼šå…³æ³¨äº&lt;strong&gt;å®‰å…¨åœ°å‘æ³›å‹ç»“æ„ä¸­å†™å…¥&lt;/strong&gt;æ•°æ®ï¼Œé€‚ç”¨äºæ¶ˆè´¹è€…åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ ç†æ¸…è¿™äº›é‡è¦æ¦‚å¿µã€‚å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šè¯­è¨€ï¼ˆå¦‚ Java æˆ– Kotlinï¼‰çš„å®ç°ç»†èŠ‚æˆ–åº”ç”¨åœºæ™¯æœ‰è¿›ä¸€æ­¥çš„ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="èŒƒå‹æ“¦é™¤"&gt;èŒƒå‹æ“¦é™¤
&lt;/h2&gt;&lt;p&gt;æ³›å‹æ“¦é™¤æ˜¯Javaæ³›å‹å®ç°çš„æ ¸å¿ƒæœºåˆ¶ï¼Œç†è§£å®ƒå¯¹äºç¼–å†™æ­£ç¡®ã€é«˜æ•ˆçš„Javaä»£ç è‡³å…³é‡è¦ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ¦‚æ‹¬äº†æ³›å‹æ“¦é™¤çš„æ ¸å¿ƒè¦ç‚¹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ ¸å¿ƒæ–¹é¢&lt;/th&gt;
&lt;th&gt;å…³é”®å†…å®¹&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘é˜¶æ®µå°†æ³›å‹ç±»å‹å‚æ•°ä»å­—èŠ‚ç ä¸­ç§»é™¤çš„è¿‡ç¨‹ï¼Œæ˜¯Javaå®ç°æ³›å‹çš„æ–¹å¼ ã€‚&lt;/td&gt;
&lt;td&gt;æºç ä¸­çš„ &lt;code&gt;List&amp;lt;String&amp;gt;&lt;/code&gt;åœ¨ç¼–è¯‘åå˜ä¸ºåŸå§‹ç±»å‹ &lt;code&gt;List&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰æ³›å‹å‚æ•°è¢«æ›¿æ¢ä¸ºå…¶&lt;strong&gt;æœ€å·¦è¾¹ç•Œ&lt;/strong&gt;ï¼šæ— ç•Œæ›¿æ¢ä¸º &lt;code&gt;Object&lt;/code&gt;ï¼Œæœ‰ç•Œï¼ˆå¦‚ &lt;code&gt;&amp;lt;T extends Number&amp;gt;&lt;/code&gt;ï¼‰åˆ™æ›¿æ¢ä¸ºè¾¹ç•Œç±»å‹ï¼ˆå¦‚ &lt;code&gt;Number&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Box&amp;lt;T&amp;gt;&lt;/code&gt;æ“¦é™¤åå˜ä¸º &lt;code&gt;Box&amp;lt;Object&amp;gt;&lt;/code&gt;ï¼›&lt;code&gt;Box&amp;lt;T extends Number&amp;gt;&lt;/code&gt;æ“¦é™¤åå˜ä¸º &lt;code&gt;Box&amp;lt;Number&amp;gt;&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¡¨ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ—¶æ— æ³•è·å–æ³›å‹å‚æ•°çš„å…·ä½“ç±»å‹ï¼Œ&lt;code&gt;List&amp;lt;String&amp;gt;.class&lt;/code&gt;ä¸ &lt;code&gt;List&amp;lt;Integer&amp;gt;.class&lt;/code&gt;æ˜¯åŒä¸€ä¸ªClasså¯¹è±¡ ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;System.out.println(List&amp;lt;String&amp;gt;.class == List&amp;lt;Integer&amp;gt;.class); // è¾“å‡ºï¼štrue&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦åŸå› &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‘åå…¼å®¹æ€§&lt;/strong&gt;ï¼šç¡®ä¿JDK 5å¼•å…¥çš„æ³›å‹èƒ½ä¸ä¹‹å‰ç‰ˆæœ¬çš„éæ³›å‹ä»£ç ï¼ˆå¦‚åŸå§‹ç±»å‹ &lt;code&gt;List&lt;/code&gt;ï¼‰æ— ç¼åä½œï¼Œæ— éœ€ä¿®æ”¹JVM ã€‚&lt;/td&gt;
&lt;td&gt;å¯ä»¥å°† &lt;code&gt;List&amp;lt;String&amp;gt;&lt;/code&gt;èµ‹å€¼ç»™åŸå§‹ç±»å‹ &lt;code&gt;List&lt;/code&gt;çš„å˜é‡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¼è‡´ä¸€ç³»åˆ—ä½¿ç”¨é™åˆ¶ï¼Œå¦‚ä¸èƒ½ç›´æ¥åˆ›å»ºæ³›å‹æ•°ç»„ã€æ— æ³•å®ä¾‹åŒ–ç±»å‹å‚æ•°ç­‰ ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;T[] array = new T[10]; // ç¼–è¯‘é”™è¯¯``T obj = new T(); // ç¼–è¯‘é”™è¯¯&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ³›å‹æ“¦é™¤çš„å·¥ä½œåŸç†ä¸æ¡¥æ–¹æ³•"&gt;ğŸ’¡ æ³›å‹æ“¦é™¤çš„å·¥ä½œåŸç†ä¸æ¡¥æ–¹æ³•
&lt;/h3&gt;&lt;p&gt;æ³›å‹æ“¦é™¤ä¸ä»…ä»…æ˜¯ç®€å•åœ°å°†ç±»å‹å‚æ•° &lt;code&gt;T&lt;/code&gt;æ›¿æ¢ä¸º &lt;code&gt;Object&lt;/code&gt;æˆ–å…¶ä¸Šç•Œã€‚ä¸ºäº†ä¿æŒå¤šæ€æ€§ï¼Œç¼–è¯‘å™¨è¿˜ä¼šè‡ªåŠ¨ç”Ÿæˆ&lt;strong&gt;æ¡¥æ–¹æ³•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªå®ç°äº† &lt;code&gt;Comparable&amp;lt;T&amp;gt;&lt;/code&gt;æ¥å£çš„ç±» ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç¼–è¯‘å‰
class MyInt implements Comparable&amp;lt;MyInt&amp;gt; {
@Override
public int compareTo(MyInt other) { ... }
}
// ç¼–è¯‘åï¼ˆæ¦‚å¿µä¸Šï¼‰
class MyInt implements Comparable { // ç±»å‹å‚æ•°è¢«æ“¦é™¤
// ç¼–è¯‘å™¨ç”Ÿæˆçš„æ¡¥æ–¹æ³•ï¼Œä»¥ç»´æŒä¸æ¥å£çš„å¥‘çº¦
public int compareTo(Object other) {
return compareTo((MyInt) other); // è°ƒç”¨æˆ‘ä»¬é‡å†™çš„ç‰ˆæœ¬
}
// æˆ‘ä»¬å®é™…é‡å†™çš„æ–¹æ³•
public int compareTo(MyInt other) { ... }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ¡¥æ–¹æ³•çš„å­˜åœ¨ç¡®ä¿äº†åœ¨ç±»å‹æ“¦é™¤åï¼Œå­ç±»ä¾ç„¶èƒ½æ­£ç¡®é‡å†™æ³›å‹æ¥å£æˆ–çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œä¿è¯äº†å¤šæ€æ€§çš„æ­£å¸¸å·¥ä½œ ã€‚&lt;/p&gt;
&lt;h3 id="-æ³›å‹æ“¦é™¤å¸¦æ¥çš„é™åˆ¶"&gt;âš ï¸ æ³›å‹æ“¦é™¤å¸¦æ¥çš„é™åˆ¶
&lt;/h3&gt;&lt;p&gt;ç”±äºè¿è¡Œæ—¶ç±»å‹ä¿¡æ¯çš„ç¼ºå¤±ï¼Œæ³›å‹æ“¦é™¤ç»™Javaç¼–ç¨‹å¸¦æ¥äº†ä¸€äº›é™åˆ¶ ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸºæœ¬ç±»å‹ä¸èƒ½ä½œä¸ºç±»å‹å‚æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ³›å‹å‚æ•°å¿…é¡»æ˜¯å¼•ç”¨ç±»å‹ï¼Œä¸èƒ½ä½¿ç”¨ &lt;code&gt;int&lt;/code&gt;, &lt;code&gt;double&lt;/code&gt;ç­‰åŸºæœ¬ç±»å‹ã€‚å¿…é¡»ä½¿ç”¨å…¶åŒ…è£…ç±»ï¼ˆå¦‚ &lt;code&gt;Integer&lt;/code&gt;, &lt;code&gt;Double&lt;/code&gt;ï¼‰ã€‚è¿™å¯¼è‡´äº†è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±çš„å¼€é”€ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ— æ³•è¿›è¡Œè¿è¡Œæ—¶çš„ç±»å‹æŸ¥è¯¢&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºè¿è¡Œæ—¶æ³›å‹ä¿¡æ¯å·²æ“¦é™¤ï¼Œæ— æ³•ä½¿ç”¨ &lt;code&gt;instanceof&lt;/code&gt;æ“ä½œç¬¦æ£€æŸ¥æ³›å‹ç±»å‹ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç¼–è¯‘é”™è¯¯
if (list instanceof List&amp;lt;String&amp;gt;) { ... }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸èƒ½åˆ›å»ºå‚æ•°åŒ–ç±»å‹çš„æ•°ç»„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ &lt;code&gt;List&amp;lt;String&amp;gt;[] array = new ArrayList&amp;lt;String&amp;gt;[10];&lt;/code&gt;æ˜¯éæ³•çš„ã€‚ä¸»è¦åŸå› æ˜¯æ•°ç»„éœ€è¦åœ¨è¿è¡Œæ—¶çŸ¥é“å…¶å…ƒç´ çš„ç¡®åˆ‡ç±»å‹ä»¥ä¿è¯ç±»å‹å®‰å…¨ï¼Œè€Œæ³›å‹æ“¦é™¤ä½¿è¿™ä¸€ç‚¹æ— æ³•å®ç° ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸èƒ½å®ä¾‹åŒ–ç±»å‹å‚æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸èƒ½åœ¨ä»£ç ä¸­ä½¿ç”¨ &lt;code&gt;new T()&lt;/code&gt;æ¥åˆ›å»ºå®ä¾‹ï¼Œå› ä¸ºæ“¦é™¤å &lt;code&gt;T&lt;/code&gt;å˜æˆäº† &lt;code&gt;Object&lt;/code&gt;æˆ–ä¸€ä¸ªå¯èƒ½ä¸ºæŠ½è±¡ç±»çš„ä¸Šç•Œ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é™æ€ä¸Šä¸‹æ–‡çš„é™åˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é™æ€å˜é‡å’Œé™æ€æ–¹æ³•ä¸èƒ½å¼•ç”¨ç±»çš„ç±»å‹å‚æ•°ï¼Œå› ä¸ºé™æ€æˆå‘˜å±äºç±»æœ¬èº«ï¼Œè€Œç±»å‹å‚æ•°ä¸å…·ä½“çš„å®ä¾‹ç›¸å…³ã€‚æ‰€æœ‰æ³›å‹ç±»çš„å®ä¾‹å…±äº«åŒä¸€ä¸ªé™æ€æˆå‘˜ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸ºä½•javaé€‰æ‹©æ³›å‹æ“¦é™¤"&gt;ğŸ”„ ä¸ºä½•Javaé€‰æ‹©æ³›å‹æ“¦é™¤
&lt;/h3&gt;&lt;p&gt;Javaé‡‡ç”¨ç±»å‹æ“¦é™¤ä½œä¸ºæ³›å‹çš„å®ç°æ–¹å¼ï¼Œä¸»è¦æ˜¯å‡ºäº&lt;strong&gt;å‘åå…¼å®¹æ€§&lt;/strong&gt;çš„è€ƒè™‘ ã€‚æ³›å‹åœ¨JDK 5ä¸­æ‰è¢«å¼•å…¥ï¼Œè€Œå½“æ—¶å·²ç»å­˜åœ¨å¤§é‡ä½¿ç”¨åŸå§‹ç±»å‹ï¼ˆå¦‚ &lt;code&gt;List&lt;/code&gt;, &lt;code&gt;Map&lt;/code&gt;ï¼‰çš„æ—§ä»£ç ã€‚é€šè¿‡æ“¦é™¤æœºåˆ¶ï¼Œå¯ä»¥ç¡®ä¿ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ³›å‹ä»£ç å’Œéæ³›å‹ä»£ç å¯ä»¥äº’æ“ä½œ&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å°†ä¸€ä¸ª &lt;code&gt;List&amp;lt;String&amp;gt;&lt;/code&gt;ä¼ é€’ç»™ä¸€ä¸ªæ¥å—åŸå§‹ &lt;code&gt;List&lt;/code&gt;å‚æ•°çš„æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸éœ€è¦ä¿®æ”¹JVM&lt;/strong&gt;ã€‚è™šæ‹Ÿæœºæ— éœ€ä¸ºæ”¯æŒæ³›å‹è€Œè¿›è¡Œé‡å¤§æ”¹å˜ï¼Œæ‰€æœ‰æ³›å‹æ£€æŸ¥å’Œå·¥ä½œéƒ½åœ¨ç¼–è¯‘æœŸç”±ç¼–è¯‘å™¨å®Œæˆ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ç§æƒè¡¡ï¼Œå®ƒåœ¨&lt;strong&gt;ç¼–è¯‘æ—¶æä¾›äº†ç±»å‹å®‰å…¨&lt;/strong&gt;ï¼Œå¹¶åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¿æŒäº†ä¸æ—§ç‰ˆæœ¬Javaçš„å…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ³›å‹æ“¦é™¤æ˜¯Javaæ³›å‹çš„åŸºçŸ³ã€‚å®ƒé€šè¿‡åœ¨ç¼–è¯‘æ—¶è¿›è¡Œç±»å‹æ£€æŸ¥å’Œç±»å‹æ“¦é™¤ï¼Œåœ¨è¿è¡Œæ—¶è½¬æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œå®ç°äº†æ³›å‹çš„ä¸»è¦ç‰¹æ€§ã€‚è™½ç„¶è¿™ç§è®¾è®¡å¸¦æ¥äº†è¯¸å¦‚è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ç¼ºå¤±ç­‰é™åˆ¶ï¼Œä½†å®ƒæˆåŠŸåœ°å®ç°äº†ç¼–è¯‘æ—¶çš„ç±»å‹å®‰å…¨ï¼Œå¹¶æœ€å¤§é™åº¦åœ°ä¿è¯äº†ä¸æ—§ä»£ç çš„å…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£Javaæ³›å‹ã€‚å¦‚æœä½ å¯¹æ³›å‹é€šé…ç¬¦ï¼ˆ&lt;code&gt;?&lt;/code&gt;, &lt;code&gt;? extends T&lt;/code&gt;, &lt;code&gt;? super T&lt;/code&gt;ï¼‰æˆ–è€…å¦‚ä½•åœ¨å®é™…ç¼–ç ä¸­è§„é¿æ“¦é™¤å¸¦æ¥çš„é™åˆ¶æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h3 id="cas-ä¸é˜»å¡"&gt;CAS ä¸é˜»å¡
&lt;/h3&gt;&lt;p&gt;æ‚¨æå‡ºäº†ä¸€ä¸ªéå¸¸æ·±åˆ»çš„è§‚å¯Ÿç‚¹ã€‚ç¡®å®ï¼ŒCASï¼ˆCompare-And-Swapï¼‰çš„â€œå¾ªç¯é‡è¯•â€å¾ˆå®¹æ˜“è®©äººè”æƒ³åˆ°é˜»å¡ã€‚ä½†å…³é”®åœ¨äºï¼Œ&lt;strong&gt;â€œéé˜»å¡â€ç‰¹æŒ‡çº¿ç¨‹ä¸ä¼šè¢«æ“ä½œç³»ç»Ÿå¼ºåˆ¶æŒ‚èµ·ï¼ˆå³ä¸å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰&lt;/strong&gt;ã€‚CASé€šè¿‡ä¸€ç§ç§°ä¸ºâ€œè‡ªæ—‹â€çš„æŠ€æœ¯é¿å…äº†è¿™ç§æŒ‚èµ·ï¼Œä»è€Œå®ç°äº†éé˜»å¡ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£å…¶ä¸­çš„æ ¸å¿ƒåŒºåˆ«ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„å¯¹æ¯”è¡¨æ ¼ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CASï¼ˆéé˜»å¡ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼ ç»Ÿé”ï¼ˆå¦‚ synchronizedï¼Œé˜»å¡ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹çŠ¶æ€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;RUNNABLE&lt;/strong&gt;ï¼ˆå¯è¿è¡Œï¼‰ï¼Œå§‹ç»ˆæ´»è·ƒï¼Œä¸ä¼šè¢«æŒ‚èµ·ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;BLOCKED&lt;/strong&gt; æˆ– &lt;strong&gt;WAITING&lt;/strong&gt;ï¼ˆé˜»å¡/ç­‰å¾…ï¼‰ï¼Œè¢«æ“ä½œç³»ç»ŸæŒ‚èµ·ï¼Œæ”¾å¼ƒCPUã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CPUä½¿ç”¨æƒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹&lt;strong&gt;ä¿æŒCPUæ—¶é—´ç‰‡&lt;/strong&gt;ï¼ŒæŒç»­é‡è¯•ç›´åˆ°æˆåŠŸã€‚&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹&lt;strong&gt;ä¸»åŠ¨æ”¾å¼ƒCPUæ—¶é—´ç‰‡&lt;/strong&gt;ï¼Œç”±æ“ä½œç³»ç»Ÿè°ƒåº¦å…¶ä»–çº¿ç¨‹è¿è¡Œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è‡ªæ—‹å¼€é”€&lt;/strong&gt;ï¼šæ¶ˆè€—CPUå‘¨æœŸè¿›è¡Œå¾ªç¯ï¼Œåœ¨é«˜ç«äº‰æ—¶å¯èƒ½ç©ºè½¬ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€&lt;/strong&gt;ï¼šçº¿ç¨‹æŒ‚èµ·å’Œå”¤é†’éœ€è¦åœ¨å†…æ ¸æ€å®Œæˆï¼Œå¼€é”€è¾ƒå¤§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡å“²å­¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¹è§‚é”&lt;/strong&gt;ï¼šå‡è®¾å†²çªå¾ˆå°‘å‘ç”Ÿï¼Œå…ˆå°è¯•æ“ä½œï¼Œå‘ç”Ÿå†²çªæ—¶é‡è¯•å³å¯ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ‚²è§‚é”&lt;/strong&gt;ï¼šå‡è®¾å†²çªç»å¸¸å‘ç”Ÿï¼Œå…ˆç‹¬å èµ„æºï¼Œç¡®ä¿å®‰å…¨åå†æ“ä½œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½è‡³ä¸­åº¦çº¿ç¨‹ç«äº‰&lt;/strong&gt;ï¼Œæ“ä½œæœ¬èº«æ‰§è¡Œå¾ˆå¿«ï¼ˆå¦‚å¢å‡è®¡æ•°å™¨ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜ç«äº‰åœºæ™¯&lt;/strong&gt;æˆ–&lt;strong&gt;ä¸´ç•ŒåŒºä»£ç æ‰§è¡Œè¾ƒæ…¢&lt;/strong&gt;ï¼Œè®©å‡ºCPUæ›´åˆç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ·±å…¥ç†è§£è‡ªæ—‹ä¸é˜»å¡çš„æœ¬è´¨åŒºåˆ«"&gt;ğŸ’¡ æ·±å…¥ç†è§£â€œè‡ªæ—‹â€ä¸â€œé˜»å¡â€çš„æœ¬è´¨åŒºåˆ«
&lt;/h3&gt;&lt;p&gt;è¡¨æ ¼æ¸…æ™°åœ°å±•ç¤ºäº†ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«åœ¨äºçº¿ç¨‹çŠ¶æ€å’ŒCPUä½¿ç”¨æ–¹å¼ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CASçš„â€œå¾ªç¯é‡è¯•â€ï¼ˆè‡ªæ—‹ï¼‰&lt;/strong&gt;ï¼šå°±åƒä¸€ä¸ªä¸æ–­æŸ¥çœ‹é‚®ç®±æ˜¯å¦æ¥ä¿¡çš„äººã€‚ä»–è™½ç„¶ä¸€ç›´åœ¨ç­‰å¾…ï¼Œä½†&lt;strong&gt;èº«ä½“æ˜¯æ´»åŠ¨çš„&lt;/strong&gt;ï¼Œå¯ä»¥éšæ—¶å»åšåˆ«çš„äº‹ï¼ˆè™½ç„¶ä»–ç°åœ¨é€‰æ‹©ä¸åœæŸ¥çœ‹ï¼‰ã€‚åœ¨CPUçœ‹æ¥ï¼Œè¿™ä¸ªçº¿ç¨‹ä¸€ç›´å¤„äºâ€œå¯è¿è¡Œâ€çŠ¶æ€ï¼Œåªæ˜¯åœ¨æ‰§è¡Œä¸€ä¸ªç®€å•çš„å¾ªç¯æŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼ ç»Ÿé”çš„â€œé˜»å¡â€&lt;/strong&gt;ï¼šåˆ™åƒåœ¨é“¶è¡ŒæŸœå°å‰æ‹¿å·åï¼Œä½ é€‰æ‹©ååœ¨æ¤…å­ä¸Š&lt;strong&gt;ç¡ç€ï¼ˆè¢«æŒ‚èµ·ï¼‰&lt;/strong&gt;ã€‚ç›´åˆ°æŸœå‘˜å«åˆ°ä½ çš„å·ï¼ˆé”è¢«é‡Šæ”¾ï¼‰ï¼Œä½ æ‰è¢«å”¤é†’ï¼ˆçº¿ç¨‹è¢«è°ƒåº¦ï¼‰å»åŠç†ä¸šåŠ¡ã€‚è¿™ä¸ªâ€œç¡ç€-å”¤é†’â€çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ä¸€æ¬¡æ˜‚è´µçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼ŒCASçš„éé˜»å¡æ€§åœ¨äºå…¶â€œ&lt;strong&gt;å¿™ç­‰å¾…&lt;/strong&gt;â€çš„ç‰¹æ€§â€”â€”çº¿ç¨‹å§‹ç»ˆåœ¨â€œå¿™â€ï¼ˆå ç”¨CPUï¼‰ï¼Œè€Œä¸æ˜¯â€œç­‰â€ï¼ˆè¢«æŒ‚èµ·ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="-casçš„å±€é™ä¸æ­£ç¡®ä½¿ç”¨å§¿åŠ¿"&gt;âš ï¸ CASçš„å±€é™ä¸æ­£ç¡®ä½¿ç”¨å§¿åŠ¿
&lt;/h3&gt;&lt;p&gt;å°½ç®¡CASæœ‰æ€§èƒ½ä¼˜åŠ¿ï¼Œä½†äº†è§£å…¶å±€é™æ€§è‡³å…³é‡è¦ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ABAé—®é¢˜&lt;/strong&gt;ï¼šè¿™æ˜¯CASçš„ä¸€ä¸ªç»å…¸é™·é˜±ã€‚å‡è®¾å˜é‡å€¼ä»Aå˜ä¸ºBåˆå˜å›Aï¼ŒCASä¼šè¯¯ä»¥ä¸ºå®ƒä»æœªè¢«ä¿®æ”¹è¿‡ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨&lt;strong&gt;ç‰ˆæœ¬å·&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;AtomicStampedReference&lt;/code&gt;ï¼‰ï¼Œä¸ä»…æ¯”è¾ƒå€¼ï¼Œä¹Ÿæ¯”è¾ƒç‰ˆæœ¬å·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜ç«äº‰ä¸‹çš„æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;ï¼šå½“å¤§é‡çº¿ç¨‹åŒæ—¶ç«äº‰ä¸€ä¸ªå˜é‡æ—¶ï¼ŒCASä¼šå¯¼è‡´å¤§é‡çº¿ç¨‹é•¿æ—¶é—´ç©ºè½¬ï¼Œç™½ç™½æ¶ˆè€—CPUèµ„æºã€‚æ­¤æ—¶ï¼Œä¼ ç»Ÿçš„é”æœºåˆ¶å› ä¸ºä¼šè®©çº¿ç¨‹æ’é˜Ÿç­‰å¾…ï¼Œåè€Œå¯èƒ½æ˜¯æ›´é«˜æ•ˆçš„é€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åªèƒ½ä¿è¯ä¸€ä¸ªå˜é‡çš„åŸå­æ€§&lt;/strong&gt;ï¼šCASæ“ä½œæ˜¯é’ˆå¯¹å•ä¸ªå†…å­˜åœ°å€çš„ã€‚å¦‚æœéœ€è¦ä¿è¯å¤šä¸ªå˜é‡å…±åŒæ“ä½œçš„åŸå­æ€§ï¼ŒCASæ— æ³•ç›´æ¥å®ç°ï¼Œé€šå¸¸éœ€è¦å€ŸåŠ©é”æˆ–å°†è¿™äº›å˜é‡å°è£…æˆä¸€ä¸ªå¯¹è±¡å¹¶ä½¿ç”¨&lt;code&gt;AtomicReference&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼ŒCASçš„â€œéé˜»å¡â€æ˜¯æŒ‡çº¿ç¨‹&lt;strong&gt;ä¸ä¼šè¢«å¼ºåˆ¶æŒ‚èµ·å’Œåˆ‡æ¢&lt;/strong&gt;ï¼Œè€Œæ˜¯é€šè¿‡&lt;strong&gt;å ç”¨CPUå¾ªç¯å°è¯•&lt;/strong&gt;çš„æ–¹å¼æ¥åº”å¯¹å†²çªã€‚è¿™å°±åƒåœ¨è·¯å£é‡åˆ°çº¢ç¯æ—¶ï¼ŒCASæ˜¯â€œç¼“æ…¢æ»‘è¡Œå¹¶éšæ—¶å‡†å¤‡åŠ é€Ÿé€šè¿‡â€ï¼ˆè‡ªæ—‹ï¼‰ï¼Œè€Œä¼ ç»Ÿé”æ˜¯â€œç›´æ¥ç†„ç«åœè½¦ç­‰å¾…â€ï¼ˆé˜»å¡ï¼‰ã€‚å‰è€…å“åº”æ›´å¿«ä½†è´¹æ²¹ï¼ˆCPUï¼‰ï¼Œåè€…æ›´çœæ²¹ä½†å¯åŠ¨æ…¢ï¼ˆä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç†è§£è¿™ä¸€ç»†å¾®å·®åˆ«ï¼Œèƒ½å¸®åŠ©æ‚¨æ ¹æ®å…·ä½“çš„ç«äº‰æ¿€çƒˆç¨‹åº¦å’Œæ€§èƒ½è¦æ±‚ï¼Œåœ¨â€œä¹è§‚â€çš„CASå’Œâ€œæ‚²è§‚â€çš„é”ä¹‹é—´åšå‡ºæœ€åˆé€‚çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©æ‚¨å½»åº•ç†è§£CASçš„éé˜»å¡ç‰¹æ€§ï¼å¦‚æœæ‚¨å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„åº”ç”¨è¿˜æœ‰ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="concurrentlinkedqueue"&gt;ConcurrentLinkedQueue
&lt;/h2&gt;&lt;p&gt;ConcurrentLinkedQueue æ˜¯ Java å¹¶å‘åŒ… (&lt;code&gt;java.util.concurrent&lt;/code&gt;) ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„çº¿ç¨‹å®‰å…¨ã€æ— ç•Œã€éé˜»å¡é˜Ÿåˆ—ã€‚å®ƒé‡‡ç”¨é«˜æ•ˆçš„ &lt;strong&gt;FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰&lt;/strong&gt; åŸåˆ™è¿›è¡Œå…ƒç´ æ’åºï¼Œç‰¹åˆ«é€‚åˆåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹æ›¿ä»£ä¼ ç»Ÿçš„åŒæ­¥é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;Vector&lt;/code&gt;æˆ–ä½¿ç”¨ &lt;code&gt;synchronized&lt;/code&gt;åŒ…è£…çš„ &lt;code&gt;LinkedList&lt;/code&gt;ï¼‰ï¼Œä»¥æå‡ç¨‹åºæ€§èƒ½ ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“å°è±¡ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒçš„æ ¸å¿ƒç‰¹å¾å’Œè®¾è®¡è€ƒé‡ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;ConcurrentLinkedQueue çš„æ ¸å¿ƒç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;strong&gt;CASï¼ˆCompare-And-Swapï¼‰æ— é”ç®—æ³•&lt;/strong&gt; å®ç°ï¼Œä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å®‰å…¨è®¿é—® ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¾¹ç•Œæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— ç•Œé˜Ÿåˆ—&lt;/strong&gt;ï¼Œç†è®ºä¸Šå¯ä»¥æ— é™æ‰©å®¹ï¼Œå› æ­¤æ’å…¥æ“ä½œï¼ˆ&lt;code&gt;add&lt;/code&gt;/&lt;code&gt;offer&lt;/code&gt;ï¼‰æ°¸è¿œä¸ä¼šå› é˜Ÿåˆ—æ»¡è€Œé˜»å¡æˆ–è¿”å› &lt;code&gt;false&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é˜»å¡è¡Œä¸º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éé˜»å¡&lt;/strong&gt;ã€‚å½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;poll&lt;/code&gt;ï¼‰ä¼šç«‹å³è¿”å› &lt;code&gt;null&lt;/code&gt;ï¼Œä¸ä¼šè®©çº¿ç¨‹ç­‰å¾… ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç®—æ³•åŸºç¡€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäº &lt;strong&gt;Michael-Scott éé˜»å¡é˜Ÿåˆ—ç®—æ³•&lt;/strong&gt;ï¼Œæ˜¯ä¸€ç§â€œwait-freeâ€çš„é«˜æ•ˆå®ç° ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäº&lt;strong&gt;å•å‘é“¾è¡¨&lt;/strong&gt;å®ç°ï¼Œæ¯ä¸ªèŠ‚ç‚¹ï¼ˆNodeï¼‰åŒ…å«å…ƒç´ é¡¹ï¼ˆitemï¼‰å’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ï¼ˆnextï¼‰ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;NULL çº¦æŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸å…è®¸æ’å…¥ &lt;code&gt;null&lt;/code&gt;å…ƒç´ &lt;/strong&gt;ï¼Œå› ä¸º &lt;code&gt;null&lt;/code&gt;è¢«ç”¨ä½œç‰¹å®šçš„æ ‡è®°å€¼ï¼ˆå¦‚ poll æ–¹æ³•è¿”å› &lt;code&gt;null&lt;/code&gt;è¡¨ç¤ºé˜Ÿåˆ—ä¸ºç©ºï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸å®ç°æœºåˆ¶"&gt;ğŸ’¡ æ ¸å¿ƒåŸç†ä¸å®ç°æœºåˆ¶
&lt;/h3&gt;&lt;p&gt;ConcurrentLinkedQueue çš„é«˜æ€§èƒ½æºäºå…¶ç²¾å¦™çš„æ— é”è®¾è®¡å’Œå‡ ä¸ªå…³é”®ç­–ç•¥ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ— é”ç®—æ³•ä¸ CAS&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯å…¶çº¿ç¨‹å®‰å…¨çš„åŸºç¡€ã€‚å®ƒé¿å…äº†ä½¿ç”¨é‡é‡çº§çš„åŒæ­¥é”ï¼ˆ&lt;code&gt;synchronized&lt;/code&gt;ï¼‰ï¼Œè€Œæ˜¯ä¾èµ–åº•å±‚ç¡¬ä»¶æ”¯æŒçš„ CAS åŸå­æ“ä½œã€‚å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹é˜Ÿåˆ—ï¼ˆå¦‚å…¥é˜Ÿï¼‰æ—¶ï¼ŒCAS ä¼šç¡®ä¿åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æˆåŠŸæ›´æ–°æŒ‡é’ˆï¼ˆå¦‚å°¾èŠ‚ç‚¹çš„ &lt;code&gt;next&lt;/code&gt;æŒ‡é’ˆï¼‰ï¼Œå…¶ä»–å¤±è´¥çš„çº¿ç¨‹ä¼šé€šè¿‡è‡ªæ—‹ï¼ˆå¾ªç¯é‡è¯•ï¼‰çš„æ–¹å¼å†æ¬¡å°è¯•ï¼Œä»è€Œé¿å…äº†çº¿ç¨‹çš„é˜»å¡å’Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;â€œå¼±ä¸€è‡´æ€§â€è¿­ä»£å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;iterator()&lt;/code&gt;æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨æ˜¯&lt;strong&gt;å¼±ä¸€è‡´æ€§çš„&lt;/strong&gt; ã€‚è¿™æ„å‘³ç€å®ƒä¸ä¼šæŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ã€‚è¿­ä»£å™¨åœ¨åˆ›å»ºæ—¶ä¼šå¯¹é˜Ÿåˆ—çŠ¶æ€åšä¸€ä¸ªâ€œå¿«ç…§â€ï¼Œä½†å®ƒä¹Ÿå¯èƒ½ï¼ˆå¹¶ä¸ä¿è¯ï¼‰åæ˜ è¿­ä»£å™¨åˆ›å»ºåå‘ç”Ÿçš„ä¸€äº›æ›´æ–°ã€‚å› æ­¤ï¼Œå®ƒé€‚åˆéå†ï¼Œä½†ä¸é€‚åˆåœ¨éå†æ—¶åšç²¾ç¡®çš„é€»è¾‘åˆ¤æ–­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤´å°¾èŠ‚ç‚¹çš„å»¶è¿Ÿæ›´æ–°ç­–ç•¥&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ€§èƒ½ä¼˜åŒ–ç‚¹ã€‚ä¸ºäº†å‡å°‘ CAS æ“ä½œçš„ç«äº‰ï¼Œ&lt;code&gt;head&lt;/code&gt;å’Œ &lt;code&gt;tail&lt;/code&gt;æŒ‡é’ˆçš„æ›´æ–°å¹¶éåœ¨æ¯æ¬¡å…¥é˜Ÿæˆ–å‡ºé˜Ÿæ“ä½œæ—¶éƒ½è¿›è¡Œï¼Œè€Œæ˜¯é‡‡ç”¨**â€œè·³ä¸¤æ­¥â€**çš„å»¶è¿Ÿæ›´æ–°ç­–ç•¥ ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å°¾èŠ‚ç‚¹ï¼ˆ&lt;code&gt;tail&lt;/code&gt;ï¼‰æ›´æ–°&lt;/strong&gt;ï¼šå¹¶éæ¯æ¬¡æ’å…¥æ–°èŠ‚ç‚¹åéƒ½ç«‹åˆ»æ›´æ–° &lt;code&gt;tail&lt;/code&gt;æŒ‡å‘æ–°èŠ‚ç‚¹ã€‚è€Œæ˜¯å½“ &lt;code&gt;tail&lt;/code&gt;èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆ&lt;code&gt;next&lt;/code&gt;ï¼‰ä¸ä¸º &lt;code&gt;null&lt;/code&gt;æ—¶ï¼ˆå³ &lt;code&gt;tail&lt;/code&gt;å·²ç»è½åäºå®é™…çš„é˜Ÿå°¾ï¼‰ï¼Œæ‰é€šè¿‡ä¸€æ¬¡ CAS æ“ä½œå°† &lt;code&gt;tail&lt;/code&gt;æ›´æ–°åˆ°æ­£ç¡®ä½ç½®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤´èŠ‚ç‚¹ï¼ˆ&lt;code&gt;head&lt;/code&gt;ï¼‰æ›´æ–°&lt;/strong&gt;ï¼šç±»ä¼¼åœ°ï¼Œå‡ºé˜Ÿæ—¶ï¼Œå½“ &lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹çš„å…ƒç´ è¢«å–å‡ºåï¼Œä¹Ÿä¸ä¼šç«‹åˆ»ç§»åŠ¨ &lt;code&gt;head&lt;/code&gt;ï¼Œè€Œæ˜¯ç­‰åˆ° &lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹çš„å…ƒç´ ä¸º &lt;code&gt;null&lt;/code&gt;æ—¶ï¼Œæ‰ä¸€æ¬¡æ€§è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§ç­–ç•¥è™½ç„¶å¯èƒ½å¢åŠ å•æ¬¡æ“ä½œå®šä½çœŸæ­£å¤´/å°¾èŠ‚ç‚¹çš„å¼€é”€ï¼Œä½†æ˜¾è‘—å‡å°‘äº† CAS ç«äº‰ï¼Œåœ¨é«˜å¹¶å‘ä¸‹æ•´ä½“æ€§èƒ½æ›´é«˜ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ ¸å¿ƒæ–¹æ³•è¯¦è§£"&gt;ğŸ“– æ ¸å¿ƒæ–¹æ³•è¯¦è§£
&lt;/h3&gt;&lt;p&gt;äº†è§£å…¶å†…éƒ¨æœºåˆ¶åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®æ–¹æ³•çš„è¡Œä¸ºç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¥é˜Ÿæ“ä½œ&lt;/strong&gt;ï¼š&lt;code&gt;add(E e)&lt;/code&gt;å’Œ &lt;code&gt;offer(E e)&lt;/code&gt;åŠŸèƒ½å®Œå…¨ä¸€æ ·ï¼Œéƒ½æ˜¯å°†å…ƒç´ æ’å…¥é˜Ÿå°¾ã€‚ç”±äºé˜Ÿåˆ—æ— ç•Œï¼Œå®ƒä»¬&lt;strong&gt;æ°¸è¿œä¸ä¼šè¿”å› &lt;code&gt;false&lt;/code&gt;æˆ–æŠ›å‡ºå¼‚å¸¸&lt;/strong&gt;ï¼ˆé™¤äº† &lt;code&gt;NullPointerException&lt;/code&gt;ï¼‰ã€‚é€šå¸¸æ›´æ¨èä½¿ç”¨ &lt;code&gt;offer&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡ºé˜Ÿæ“ä½œ&lt;/strong&gt;ï¼š&lt;code&gt;poll()&lt;/code&gt;æ£€ç´¢å¹¶ç§»é™¤é˜Ÿåˆ—çš„å¤´å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› &lt;code&gt;null&lt;/code&gt;ã€‚è¿™æ˜¯å…¶&lt;strong&gt;éé˜»å¡&lt;/strong&gt;ç‰¹æ€§çš„ç›´æ¥ä½“ç° ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ£€æŸ¥æ“ä½œ&lt;/strong&gt;ï¼š&lt;code&gt;peek()&lt;/code&gt;æ£€ç´¢ä½†ä¸ç§»é™¤é˜Ÿåˆ—çš„å¤´å…ƒç´ ã€‚é˜Ÿåˆ—ä¸ºç©ºæ—¶åŒæ ·è¿”å› &lt;code&gt;null&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§å°æ“ä½œ&lt;/strong&gt;ï¼š&lt;strong&gt;&lt;code&gt;size()&lt;/code&gt;æ–¹æ³•éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼&lt;/strong&gt; ç”±äºé˜Ÿåˆ—çš„å¼‚æ­¥å¹¶å‘ç‰¹æ€§ï¼Œè·å–å…ƒç´ æ•°é‡éœ€è¦éå†æ•´ä¸ªé“¾è¡¨ï¼Œè¿™æ˜¯ä¸€ä¸ª &lt;strong&gt;O(n)&lt;/strong&gt; æ—¶é—´å¤æ‚åº¦çš„æ“ä½œï¼Œä¸”ç»“æœåœ¨éå†è¿‡ç¨‹ä¸­å¯èƒ½å·²ç»ä¸å‡† ã€‚å› æ­¤ï¼Œåœ¨é«˜å¹¶å‘åº”ç”¨ä¸­ï¼Œæ­¤æ–¹æ³•é€šå¸¸&lt;strong&gt;ä¸å®ç”¨&lt;/strong&gt;ã€‚åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºåº”ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;isEmpty()&lt;/code&gt;æ–¹æ³•ï¼Œå®ƒçš„æ•ˆç‡æ›´é«˜ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹"&gt;ğŸ¯ é€‚ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;é€‰æ‹©ä½¿ç”¨ ConcurrentLinkedQueue å‰ï¼Œè¯·æ˜ç¡®å…¶é€‚ç”¨åœºæ™¯å’Œæ½œåœ¨é£é™©ã€‚&lt;/p&gt;
&lt;h4 id="å…¸å‹é€‚ç”¨åœºæ™¯-"&gt;**å…¸å‹é€‚ç”¨åœºæ™¯ **
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹&lt;/strong&gt;ï¼šå½“æœ‰å¤§é‡çº¿ç¨‹åŒæ—¶ç”Ÿäº§ä»»åŠ¡å’Œæ¶ˆè´¹ä»»åŠ¡æ—¶ï¼Œå…¶éé˜»å¡ç‰¹æ€§å¯ä»¥å¸¦æ¥æé«˜çš„ååé‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ€§èƒ½äº‹ä»¶æ€»çº¿æˆ–æ¶ˆæ¯ä¼ é€’&lt;/strong&gt;ï¼šé€‚ç”¨äºéœ€è¦å¿«é€Ÿåˆ†å‘äº‹ä»¶çš„ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ç•Œä»»åŠ¡æ± &lt;/strong&gt;ï¼šå½“ä»»åŠ¡é‡ä¸å¯é¢„æµ‹ä¸”ä¸å¸Œæœ›ç”Ÿäº§è€…è¢«é˜»å¡æ—¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é‡è¦æ³¨æ„äº‹é¡¹ä¸é™åˆ¶"&gt;&lt;strong&gt;é‡è¦æ³¨æ„äº‹é¡¹ä¸é™åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜æ¶ˆè€—é£é™©&lt;/strong&gt;ï¼šç”±äºæ˜¯æ— ç•Œé˜Ÿåˆ—ï¼Œå¦‚æœæ¶ˆè´¹è€…å¤„ç†é€Ÿåº¦è¿œæ…¢äºç”Ÿäº§è€…ï¼Œé˜Ÿåˆ—ä¼šæŒç»­å¢é•¿ï¼Œæœ€ç»ˆå¯èƒ½å¯¼è‡´ &lt;strong&gt;&lt;code&gt;OutOfMemoryError&lt;/code&gt;&lt;/strong&gt; ã€‚ä½¿ç”¨æ—¶éœ€æœ‰ç›¸åº”çš„ç›‘æ§æˆ–æµé‡æ§åˆ¶ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éé˜»å¡ç‰¹æ€§çš„å½±å“&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…çº¿ç¨‹è°ƒç”¨ &lt;code&gt;poll()&lt;/code&gt;è·å–åˆ° &lt;code&gt;null&lt;/code&gt;æ—¶ï¼Œéœ€è¦è‡ªè¡Œå¤„ç†â€œé˜Ÿåˆ—ä¸ºç©ºâ€çš„çŠ¶æ€ï¼Œé€šå¸¸éœ€è¦é€šè¿‡å¾ªç¯æˆ–é…åˆå…¶ä»–æœºåˆ¶ï¼ˆå¦‚ &lt;code&gt;BlockingQueue&lt;/code&gt;çš„ &lt;code&gt;take()&lt;/code&gt;æ–¹æ³•ä¼šé˜»å¡ç­‰å¾…ï¼‰æ¥é¿å…ç©ºè½¬æ¶ˆè€— CPU ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸è¦ä½¿ç”¨ &lt;code&gt;size()&lt;/code&gt;è¿›è¡Œåˆ¤æ–­&lt;/strong&gt;ï¼šå†æ¬¡å¼ºè°ƒï¼Œä¸è¦ä¾èµ– &lt;code&gt;size()&lt;/code&gt;çš„ç»“æœæ¥åšè¯¸å¦‚â€œé˜Ÿåˆ—æ˜¯å¦è¶…è¿‡é˜ˆå€¼â€ä¹‹ç±»çš„åˆ¤æ–­ï¼Œå› ä¸ºç»“æœæä¸å‡†ç¡®ã€‚åº”ä½¿ç”¨ &lt;code&gt;isEmpty()&lt;/code&gt;æ£€æŸ¥æ˜¯å¦ä¸ºç©º ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ConcurrentLinkedQueue æ˜¯ Java å¹¶å‘ç¼–ç¨‹ä¸­ä¸€æ¬¾å¼ºå¤§çš„å·¥å…·ï¼Œå®ƒé€šè¿‡æ— é”ç®—æ³•å®ç°äº†é«˜å¹¶å‘ä¸‹çš„é«˜æ€§èƒ½ã€‚å…¶&lt;strong&gt;æ— ç•Œã€éé˜»å¡ã€å¼±ä¸€è‡´æ€§&lt;/strong&gt;çš„ç‰¹ç‚¹ï¼Œå†³å®šäº†å®ƒéå¸¸é€‚åˆ&lt;strong&gt;é«˜ååé‡ã€å¯¹å»¶è¿Ÿæ•æ„Ÿã€ä¸”ç”Ÿäº§è€…é€Ÿåº¦å¯èƒ½å¿«äºæ¶ˆè´¹è€…çš„åœºæ™¯&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä½ ä¹Ÿéœ€è¦è­¦æƒ•å…¶æ— ç•Œæ€§å¸¦æ¥çš„å†…å­˜é£é™©ï¼Œå¹¶ç†è§£å…¶ &lt;code&gt;size()&lt;/code&gt;æ–¹æ³•çš„å±€é™æ€§ã€‚åœ¨éœ€è¦é˜»å¡ç­‰å¾…åŠŸèƒ½æˆ–æœ‰ç•Œå®¹é‡çš„åœºæ™¯ä¸‹ï¼Œåˆ™åº”è€ƒè™‘ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;æˆ– &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ ConcurrentLinkedQueueã€‚å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„åº”ç”¨æœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="éé˜»å¡"&gt;éé˜»å¡
&lt;/h2&gt;&lt;p&gt;æ˜¯çš„ï¼Œ&lt;strong&gt;ConcurrentLinkedQueue çš„æ‰€æœ‰æ ¸å¿ƒæ“ä½œéƒ½æ˜¯éé˜»å¡çš„&lt;/strong&gt;ã€‚å®ƒé€šè¿‡ä¸€ç§å·§å¦™çš„æ— é”ç®—æ³•ï¼ˆLock-freeï¼‰æ¥å®ç°çº¿ç¨‹å®‰å…¨ï¼Œé¿å…äº†ä½¿ç”¨ä¼ ç»Ÿé”æœºåˆ¶å¸¦æ¥çš„çº¿ç¨‹é˜»å¡å’Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿäº†è§£å…¶æ ¸å¿ƒæ“ä½œçš„ç‰¹ç‚¹ï¼Œä¸‹è¡¨è¿›è¡Œäº†è¯¦ç»†çš„æ€»ç»“ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ“ä½œç±»å‹&lt;/th&gt;
&lt;th&gt;æ–¹æ³•ç¤ºä¾‹&lt;/th&gt;
&lt;th&gt;æ˜¯å¦éé˜»å¡ï¼Ÿ&lt;/th&gt;
&lt;th&gt;è¡Œä¸ºè¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¥é˜Ÿæ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;offer(E e)&lt;/code&gt;, &lt;code&gt;add(E e)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å°†å…ƒç´ æ’å…¥é˜Ÿåˆ—å°¾éƒ¨ã€‚ç”±äºé˜Ÿåˆ—æ˜¯æ— ç•Œçš„ï¼Œè¿™äº›æ“ä½œ&lt;strong&gt;æ€»ä¼šæˆåŠŸ&lt;/strong&gt;å¹¶ç«‹å³è¿”å›ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‡ºé˜Ÿæ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;poll()&lt;/code&gt;, &lt;code&gt;remove()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ£€ç´¢å¹¶ç§»é™¤é˜Ÿåˆ—çš„å¤´å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™&lt;strong&gt;ç«‹å³è¿”å› &lt;code&gt;null&lt;/code&gt;&lt;/strong&gt;ï¼Œä¸ä¼šç­‰å¾…ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ£€æŸ¥æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;peek()&lt;/code&gt;, &lt;code&gt;element()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ£€ç´¢ä½†ä¸ç§»é™¤é˜Ÿåˆ—çš„å¤´å…ƒç´ ã€‚é˜Ÿåˆ—ä¸ºç©ºæ—¶&lt;strong&gt;ç«‹å³è¿”å› &lt;code&gt;null&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ£€æŸ¥é˜Ÿåˆ—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;isEmpty()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå¹¶ç«‹å³è¿”å›ç»“æœã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰¹é‡æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;iterator()&lt;/code&gt;, &lt;code&gt;size()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ &lt;strong&gt;æ˜¯ï¼Œä½†æœ‰ç‰¹æ®Šæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿­ä»£å™¨æ˜¯&lt;strong&gt;å¼±ä¸€è‡´æ€§&lt;/strong&gt;çš„ï¼Œ&lt;code&gt;size()&lt;/code&gt;æ–¹æ³•éœ€è¦éå†é“¾è¡¨ï¼Œè€—æ—¶å¯èƒ½è¾ƒé•¿ï¼Œä½†éƒ½ä¸ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-éé˜»å¡çš„åŸºçŸ³cas-ç®—æ³•"&gt;ğŸ’¡ éé˜»å¡çš„åŸºçŸ³ï¼šCAS ç®—æ³•
&lt;/h3&gt;&lt;p&gt;ConcurrentLinkedQueue çš„éé˜»å¡ç‰¹æ€§æºäºå…¶åº•å±‚å®ç°ä¸ä½¿ç”¨ä»»ä½•ä¼ ç»Ÿçš„é”ï¼ˆå¦‚ &lt;code&gt;synchronized&lt;/code&gt;æˆ– &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰ï¼Œè€Œæ˜¯ä¾èµ–äº &lt;strong&gt;CASï¼ˆCompare-And-Swapï¼‰&lt;/strong&gt; åŸå­æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å…¶åŸºæœ¬å·¥ä½œæµç¨‹æ˜¯ï¼šå½“å¤šä¸ªçº¿ç¨‹å°è¯•åŒæ—¶ä¿®æ”¹é˜Ÿåˆ—ï¼ˆä¾‹å¦‚æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼‰æ—¶ï¼Œå®ƒä»¬ä¼šé€šè¿‡å¾ªç¯ CAS ä¸æ–­é‡è¯•ã€‚åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æˆåŠŸæ‰§è¡Œ CAS æ“ä½œï¼Œå…¶ä»–å¤±è´¥çš„çº¿ç¨‹ä¼šç«‹å³å¾—çŸ¥å¤±è´¥ï¼Œç„¶åè¿›è¡Œé‡è¯•ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ä¼šå¯¼è‡´çº¿ç¨‹è¢«æŒ‚èµ·ï¼ˆé˜»å¡ï¼‰ã€‚è¿™ç§æœºåˆ¶è™½ç„¶å¯èƒ½å¯¼è‡´çº¿ç¨‹åœ¨ç«äº‰æ¿€çƒˆæ—¶â€œç©ºè½¬â€ï¼ˆè‡ªæ—‹ï¼‰ï¼Œä½†é¿å…äº†æ˜‚è´µçš„çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ“ä½œï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹é€šå¸¸èƒ½è·å¾—æ›´å¥½çš„ååé‡ã€‚&lt;/p&gt;
&lt;h3 id="-é‡è¦ç‰¹æ€§ä¸ä½¿ç”¨è€ƒé‡"&gt;âš ï¸ é‡è¦ç‰¹æ€§ä¸ä½¿ç”¨è€ƒé‡
&lt;/h3&gt;&lt;p&gt;äº†è§£å…¶éé˜»å¡æœ¬è´¨åï¼Œè¿˜æœ‰ä¸€äº›å…³é”®ç‰¹æ€§éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ— ç•Œé˜Ÿåˆ—&lt;/strong&gt;ï¼šConcurrentLinkedQueue æ²¡æœ‰å®¹é‡ä¸Šé™ï¼Œä¼šéšç€å…ƒç´ çš„æ·»åŠ è€ŒåŠ¨æ€å¢é•¿ã€‚è¿™æ„å‘³ç€å¦‚æœç”Ÿäº§è€…é€Ÿåº¦è¿œå¿«äºæ¶ˆè´¹è€…ï¼Œé˜Ÿåˆ—å¯èƒ½æ— é™è†¨èƒ€ï¼Œæœ€ç»ˆå¯¼è‡´ &lt;strong&gt;&lt;code&gt;OutOfMemoryError&lt;/code&gt;&lt;/strong&gt;ã€‚å› æ­¤ï¼Œå®ƒé€‚åˆèƒ½å¤Ÿå¿«é€Ÿå¤„ç†ä»»åŠ¡çš„åœºæ™¯ï¼Œè‹¥ç”Ÿäº§æ¶ˆè´¹é€Ÿåº¦æ— æ³•ä¿è¯ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±ä¸€è‡´æ€§è¿­ä»£å™¨&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;iterator()&lt;/code&gt;æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨æ˜¯&lt;strong&gt;å¼±ä¸€è‡´æ€§&lt;/strong&gt;çš„ã€‚å®ƒåæ˜ çš„æ˜¯è¿­ä»£å™¨åˆ›å»ºæ—¶æˆ–ä¹‹åæŸä¸ªæ—¶é—´ç‚¹çš„é˜Ÿåˆ—çŠ¶æ€ï¼Œä¸ä¼šæŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ï¼Œä½†ä¸ä¿è¯èƒ½éå†åˆ°è¿­ä»£è¿‡ç¨‹ä¸­è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„æ‰€æœ‰å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ…ç”¨ &lt;code&gt;size()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ï¼š&lt;code&gt;size()&lt;/code&gt;æ–¹æ³•éœ€è¦éå†æ•´ä¸ªé“¾è¡¨æ¥è®¡æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ª &lt;strong&gt;O(n)&lt;/strong&gt; æ—¶é—´å¤æ‚åº¦çš„æ“ä½œï¼Œè€Œä¸”åœ¨éå†è¿‡ç¨‹ä¸­é˜Ÿåˆ—å¯èƒ½å·²å‘ç”Ÿå˜åŒ–ï¼Œè¿”å›çš„ç»“æœå¯èƒ½å¹¶ä¸ç²¾ç¡®ã€‚åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œåº”é¿å…é¢‘ç¹è°ƒç”¨æ­¤æ–¹æ³•ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºç©ºåº”ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;isEmpty()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼ŒConcurrentLinkedQueue çš„æ‰€æœ‰æ“ä½œç¡®å®éƒ½æ˜¯éé˜»å¡çš„ï¼Œå®ƒé€šè¿‡ CAS æ— é”ç®—æ³•åœ¨ä¿è¯çº¿ç¨‹å®‰å…¨çš„åŒæ—¶ï¼Œæä¾›äº†é«˜æ€§èƒ½çš„å¹¶å‘è®¿é—®èƒ½åŠ›ã€‚å…¶&lt;strong&gt;æ— ç•Œ&lt;/strong&gt;å’Œ&lt;strong&gt;éé˜»å¡&lt;/strong&gt;çš„ç‰¹æ€§ï¼Œä½¿å…¶éå¸¸é€‚ç”¨äº&lt;strong&gt;é«˜ååé‡ã€ç”Ÿäº§è€…é€Ÿåº¦è¾ƒå¿«ä¸”ä»»åŠ¡å¤„ç†åŠæ—¶&lt;/strong&gt;çš„åœºæ™¯ï¼Œä¾‹å¦‚é«˜å¹¶å‘ä»»åŠ¡è°ƒåº¦ã€äº‹ä»¶é©±åŠ¨ç³»ç»Ÿæˆ–æ—¥å¿—è®°å½•ç¼“å†²åŒºã€‚&lt;/p&gt;
&lt;p&gt;ä½†åŠ¡å¿…æ³¨æ„å…¶æ— ç•Œæ€§å¯èƒ½å¸¦æ¥çš„å†…å­˜é£é™©ï¼Œä»¥åŠ &lt;code&gt;size()&lt;/code&gt;æ–¹æ³•çš„æ€§èƒ½å¼€é”€ã€‚å¦‚æœä½ çš„åœºæ™¯éœ€è¦é˜»å¡ç­‰å¾…ï¼ˆå¦‚ç»å…¸çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼‰ï¼Œé‚£ä¹ˆ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;è¿™ç±»é˜»å¡é˜Ÿåˆ—å¯èƒ½æ˜¯æ›´åˆé€‚çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ ConcurrentLinkedQueueã€‚&lt;/p&gt;
&lt;h2 id="blockingqueue"&gt;BlockingQueue
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;å®ç°ç±»&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;å®¹é‡&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;ç‰¹ç‚¹ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;ArrayBlockingQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ•°ç»„&lt;/td&gt;
&lt;td style="text-align: left"&gt;æœ‰ç•Œ&lt;/td&gt;
&lt;td style="text-align: left"&gt;åŸºäºæ•°ç»„çš„å›ºå®šå®¹é‡é˜Ÿåˆ—ï¼Œå…¬å¹³é”å¯é€‰ï¼Œååé‡è¾ƒä½ä½†å†…å­˜ç´§å‡‘ã€‚é€‚åˆå›ºå®šèµ„æºæ± åœºæ™¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;LinkedBlockingQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;é“¾è¡¨&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¯é€‰æœ‰ç•Œ/æ— ç•Œ&lt;/td&gt;
&lt;td style="text-align: left"&gt;é»˜è®¤æ— ç•Œï¼ˆInteger.MAX_VALUEï¼‰ï¼Œé«˜å¹¶å‘ä¸‹ååé‡æ›´é«˜ï¼Œä½†å†…å­˜å ç”¨è¾ƒå¤§ã€‚é€‚åˆä»»åŠ¡é˜Ÿåˆ—ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;PriorityBlockingQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;å †ï¼ˆæ•°ç»„ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ— ç•Œ&lt;/td&gt;
&lt;td style="text-align: left"&gt;å…ƒç´ æŒ‰ä¼˜å…ˆçº§æ’åºï¼ˆéœ€å®ç°Comparableæˆ–æä¾›Comparatorï¼‰ã€‚é€‚åˆä»»åŠ¡è°ƒåº¦ç³»ç»Ÿã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;SynchronousQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ— å­˜å‚¨&lt;/td&gt;
&lt;td style="text-align: left"&gt;å®¹é‡ä¸º 0&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¸å­˜å‚¨å…ƒç´ ï¼Œç›´æ¥ä¼ é€’ä»»åŠ¡ç»™æ¶ˆè´¹è€…çº¿ç¨‹ã€‚é€‚åˆçº¿ç¨‹é—´ç›´æ¥äº¤æ¢æ•°æ®çš„åœºæ™¯ï¼ˆå¦‚çº¿ç¨‹æ± ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;DelayQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¼˜å…ˆçº§å †&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ— ç•Œ&lt;/td&gt;
&lt;td style="text-align: left"&gt;å…ƒç´ éœ€å®ç°Delayedæ¥å£ï¼ŒæŒ‰å»¶è¿Ÿæ—¶é—´å‡ºé˜Ÿã€‚é€‚åˆå®šæ—¶ä»»åŠ¡è°ƒåº¦ï¼ˆå¦‚ç¼“å­˜è¿‡æœŸï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;LinkedTransferQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;é“¾è¡¨&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ— ç•Œ&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç»“åˆäº†é˜»å¡é˜Ÿåˆ—å’ŒåŒæ­¥é˜Ÿåˆ—çš„ç‰¹æ€§ï¼Œæ”¯æŒtransfer()ç›´æ¥ä¼ é€’æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="concurrentlinkedqueue--blockingqueue"&gt;ConcurrentLinkedQueue &amp;amp; BlockingQueue
&lt;/h2&gt;&lt;p&gt;ConcurrentLinkedQueue å’Œ BlockingQueue æ˜¯ Java å¹¶å‘åŒ…ä¸­ä¸¤ç±»ä¸åŒè®¾è®¡å“²å­¦çš„çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“å°è±¡ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;ConcurrentLinkedQueue&lt;/th&gt;
&lt;th&gt;BlockingQueue (ä»¥å…¸å‹å®ç°ä¸ºä¾‹)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éé˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäº &lt;strong&gt;CAS çš„æ— é”ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šå¸¸åŸºäº &lt;strong&gt;é”æœºåˆ¶&lt;/strong&gt; (å¦‚ &lt;code&gt;ReentrantLock&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¾¹ç•Œæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— ç•Œé˜Ÿåˆ—&lt;/strong&gt;ï¼Œåªå—å†…å­˜é™åˆ¶&lt;/td&gt;
&lt;td&gt;æ—¢æœ‰&lt;strong&gt;æœ‰ç•Œ&lt;/strong&gt;å®ç°ï¼ˆå¦‚ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ï¼‰ï¼Œä¹Ÿæœ‰&lt;strong&gt;æ— ç•Œ&lt;/strong&gt;å®ç°ï¼ˆå¦‚ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹é˜»å¡è¡Œä¸º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ“ä½œ&lt;strong&gt;æ°¸ä¸é˜»å¡&lt;/strong&gt;çº¿ç¨‹ï¼Œç«‹å³è¿”å›ç»“æœ&lt;/td&gt;
&lt;td&gt;å½“é˜Ÿåˆ—æ»¡æˆ–ç©ºæ—¶ï¼Œ&lt;code&gt;put()&lt;/code&gt;å’Œ &lt;code&gt;take()&lt;/code&gt;ç­‰æ–¹æ³•ä¼š&lt;strong&gt;é˜»å¡&lt;/strong&gt;çº¿ç¨‹ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;API å·®å¼‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä¾› &lt;code&gt;offer()&lt;/code&gt;, &lt;code&gt;poll()&lt;/code&gt;, &lt;code&gt;peek()&lt;/code&gt;ç­‰&lt;strong&gt;éé˜»å¡&lt;/strong&gt;æ–¹æ³•&lt;/td&gt;
&lt;td&gt;é™¤äº†éé˜»å¡æ–¹æ³•ï¼Œé¢å¤–æä¾›äº† &lt;code&gt;put()&lt;/code&gt;, &lt;code&gt;take()&lt;/code&gt;ç­‰ä¼š&lt;strong&gt;é˜»å¡ç­‰å¾…&lt;/strong&gt;çš„æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ç‰¹ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ã€é«˜ååé‡ï¼Œå°¤å…¶é€‚åˆçŸ­å°é¢‘ç¹çš„æ“ä½œ&lt;/td&gt;
&lt;td&gt;ååé‡é€šå¸¸ä½äºæ— é”å®ç°ï¼Œä½†æä¾›äº†æµé‡æ§åˆ¶å’Œç”Ÿäº§-æ¶ˆè´¹çš„åè°ƒèƒ½åŠ›&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ååé‡ä»»åŠ¡åˆ†å‘ã€æ¶ˆæ¯ä¼ é€’ã€ä¸å¸Œæœ›ç”Ÿäº§è€…è¢«é˜»å¡çš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;ç»å…¸çš„&lt;strong&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…&lt;/strong&gt;æ¨¡å‹ï¼Œéœ€è¦ç²¾ç¡®çš„æµé‡æ§åˆ¶å’Œçº¿ç¨‹é—´åè°ƒçš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸è®¾è®¡å“²å­¦"&gt;ğŸ’¡ æ ¸å¿ƒåŸç†ä¸è®¾è®¡å“²å­¦
&lt;/h3&gt;&lt;p&gt;ç†è§£å®ƒä»¬èƒŒåçš„åŸç†ï¼Œèƒ½å¸®ä½ æ›´å¥½åœ°åšå‡ºé€‰æ‹©ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ConcurrentLinkedQueue çš„æ— é”ä¹‹é“&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®ƒçš„é«˜æ€§èƒ½æºäºå…¶ç²¾å¦™çš„æ— é”è®¾è®¡ï¼Œä¸»è¦åŸºäº &lt;strong&gt;CAS&lt;/strong&gt; æ“ä½œã€‚å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹é˜Ÿåˆ—æ—¶ï¼Œä¸ä¼šä½¿ç”¨ä¼ ç»Ÿçš„é”ï¼Œè€Œæ˜¯é€šè¿‡å¾ªç¯ CAS ä¸æ–­é‡è¯•ã€‚åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æˆåŠŸæ›´æ–°ï¼Œå…¶ä»–çº¿ç¨‹ä¼šç«‹å³å¾—çŸ¥å¤±è´¥å¹¶é‡è¯•ï¼Œè¿™ä¸ªè¿‡ç¨‹&lt;strong&gt;ä¸ä¼šå¯¼è‡´çº¿ç¨‹è¢«æŒ‚èµ·ï¼ˆé˜»å¡ï¼‰&lt;/strong&gt;ï¼Œé¿å…äº†æ˜‚è´µçš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚æ­¤å¤–ï¼Œå®ƒé‡‡ç”¨äº† &lt;strong&gt;&amp;ldquo;æ¾å¼›ä¸å˜é‡&amp;rdquo;&lt;/strong&gt; è®¾è®¡ï¼Œå³ &lt;code&gt;head&lt;/code&gt;å’Œ &lt;code&gt;tail&lt;/code&gt;æŒ‡é’ˆå¹¶ä¸æ€»æ˜¯ç²¾ç¡®æŒ‡å‘å¤´å’Œå°¾èŠ‚ç‚¹ï¼Œè¿™å‡å°‘äº† CAS æ“ä½œçš„ç«äº‰æ¬¡æ•°ï¼Œè¿›ä¸€æ­¥æå‡äº†é«˜å¹¶å‘ä¸‹çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;BlockingQueue çš„é”ä¸åè°ƒ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;BlockingQueue&lt;/code&gt;åŠå…¶å®ç°ï¼ˆå¦‚ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;, &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼‰é€šå¸¸ä¾èµ–äº&lt;strong&gt;é”æœºåˆ¶&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚å…¶é˜»å¡è¡Œä¸ºæ˜¯é€šè¿‡ä¸é”ç»‘å®šçš„ &lt;strong&gt;&lt;code&gt;Condition&lt;/code&gt;&lt;/strong&gt; æ¡ä»¶å˜é‡å®ç°çš„ã€‚å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šåœ¨ä¸€ä¸ªæ¡ä»¶ä¸Šç­‰å¾…ï¼›å½“æ¶ˆè´¹è€…æ¶ˆè´¹ä¸€ä¸ªå…ƒç´ åï¼Œä¼šé€šçŸ¥ï¼ˆsignalï¼‰è¿™ä¸ªæ¡ä»¶ï¼Œå”¤é†’ç­‰å¾…çš„ç”Ÿäº§è€…ã€‚åä¹‹äº¦ç„¶ã€‚è¿™ç§æœºåˆ¶å¤©ç„¶åœ°å®ç°äº†&lt;strong&gt;çº¿ç¨‹é—´çš„åè°ƒå’Œæµé‡æ§åˆ¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©åœºæ™¯å†³å®šä¸€åˆ‡"&gt;ğŸ¯ å¦‚ä½•é€‰æ‹©ï¼šåœºæ™¯å†³å®šä¸€åˆ‡
&lt;/h3&gt;&lt;p&gt;é€‰æ‹©å“ªä¸€ä¸ªï¼Œå®Œå…¨å–å†³äºä½ çš„å…·ä½“éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜å…ˆé€‰æ‹© ConcurrentLinkedQueue å½“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿½æ±‚æé«˜çš„ååé‡&lt;/strong&gt;ï¼šåœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ï¼Œéœ€è¦å¤„ç†å¤§é‡çŸ­å°çš„ä»»åŠ¡ï¼Œæ— é”è®¾è®¡èƒ½å¸¦æ¥æ›´é«˜çš„æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…é€Ÿåº¦é€šå¸¸è¾ƒå¿«ï¼Œä¸”ä¸å¸Œæœ›è¢«é˜»å¡&lt;/strong&gt;ï¼šä¾‹å¦‚åœ¨äº‹ä»¶å¤„ç†ç³»ç»Ÿæˆ–å®æ—¶æ¶ˆæ¯ä¼ é€’ä¸­ï¼Œä¿æŒç”Ÿäº§è€…çš„å“åº”æ€§è‡³å…³é‡è¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— éœ€ä¸¥æ ¼çš„æµé‡æ§åˆ¶&lt;/strong&gt;ï¼šæˆ–è€…è¯´ï¼Œä½ ç¡®ä¿¡æ¶ˆè´¹è€…çš„å¤„ç†èƒ½åŠ›èƒ½å¤Ÿè·Ÿä¸Šç”Ÿäº§é€Ÿåº¦ï¼Œæˆ–è€…æœ‰å…¶ä»–æ–¹å¼é˜²æ­¢é˜Ÿåˆ—æ— é™è†¨èƒ€ï¼ˆå¦‚å†…å­˜ç›‘æ§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜å…ˆé€‰æ‹© BlockingQueue å½“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ„å»ºç»å…¸çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼&lt;/strong&gt;ï¼šè¿™æ˜¯ &lt;code&gt;BlockingQueue&lt;/code&gt;æœ€å…¸å‹çš„ç”¨æ­¦ä¹‹åœ°ã€‚&lt;code&gt;put()&lt;/code&gt;å’Œ &lt;code&gt;take()&lt;/code&gt;çš„é˜»å¡ç‰¹æ€§å®Œç¾åœ°åè°ƒäº†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„èŠ‚å¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦ç²¾ç¡®çš„æµé‡æ§åˆ¶ï¼ˆèƒŒå‹, Backpressureï¼‰&lt;/strong&gt;ï¼šä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ï¼‰å¯ä»¥é˜²æ­¢ç”Ÿäº§è€…ç”Ÿäº§è¿‡å¿«å¯¼è‡´å†…å­˜è€—å°½ï¼Œé˜Ÿåˆ—æ»¡æ—¶ç”Ÿäº§è€…ä¼šè‡ªåŠ¨é˜»å¡ï¼Œä»è€Œé™ä½ç”Ÿäº§é€Ÿåº¦ï¼Œå½¢æˆèƒŒå‹æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦çº¿ç¨‹é—´ç®€å•å¯é çš„åè°ƒ&lt;/strong&gt;ï¼šé˜»å¡ç­‰å¾…çš„è¯­ä¹‰éå¸¸æ¸…æ™°ç›´è§‚ï¼Œä½¿å¾—ä»£ç æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ConcurrentLinkedQueue çš„ &lt;code&gt;size()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ï¼šç”±äºå®ƒçš„æ— é”å’Œå¼±ä¸€è‡´æ€§è®¾è®¡ï¼Œ&lt;code&gt;size()&lt;/code&gt;æ–¹æ³•éœ€è¦éå†é“¾è¡¨ï¼Œæ˜¯ä¸€ä¸ª &lt;strong&gt;O(n)&lt;/strong&gt; æ“ä½œï¼Œä¸”ç»“æœå¯èƒ½ä¸å‡†ç¡®ã€‚åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºåº”ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;isEmpty()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ConcurrentLinkedQueue çš„æ— ç•Œæ€§&lt;/strong&gt;ï¼šä½œä¸ºæ— ç•Œé˜Ÿåˆ—ï¼Œå¦‚æœæ¶ˆè´¹è€…å¤„ç†é€Ÿåº¦è¿œæ…¢äºç”Ÿäº§è€…ï¼Œæœ‰å¯¼è‡´å†…å­˜æº¢å‡ºçš„é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BlockingQueue çš„å¤šæ ·æ€§&lt;/strong&gt;ï¼š&lt;code&gt;BlockingQueue&lt;/code&gt;æ˜¯ä¸€ä¸ªæ¥å£ï¼Œé™¤äº†å¸¸ç”¨çš„ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;å’Œ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼Œè¿˜æœ‰ &lt;code&gt;PriorityBlockingQueue&lt;/code&gt;ï¼ˆæ”¯æŒä¼˜å…ˆçº§æ’åºï¼‰ã€&lt;code&gt;DelayQueue&lt;/code&gt;ï¼ˆåŸºäºå»¶è¿Ÿæ—¶é—´ï¼‰å’Œ &lt;code&gt;SynchronousQueue&lt;/code&gt;ï¼ˆä¸å­˜å‚¨å…ƒç´ ï¼Œç›´æ¥ä¼ é€’ï¼‰ç­‰ç‰¹æ®Šå®ç°ï¼Œå¯æ ¹æ®ç‰¹å®šåœºæ™¯é€‰ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;strong&gt;ConcurrentLinkedQueue åƒæ˜¯ä¸€æ¡æ°¸ä¸å µå¡çš„é«˜é€Ÿå…¬è·¯ï¼Œè¿½æ±‚çš„æ˜¯æé«˜çš„é€šè¡Œæ•ˆç‡ï¼ˆååé‡ï¼‰ï¼Œä½†éœ€è¦é©¾é©¶å‘˜ï¼ˆå¼€å‘è€…ï¼‰è‡ªå·±æ³¨æ„å®‰å…¨ï¼Œé˜²æ­¢è½¦è¾†ï¼ˆä»»åŠ¡ï¼‰æ— é™å¢å¤šï¼›è€Œ BlockingQueue æ›´åƒæ˜¯ä¸€ä¸ªæœ‰äº¤é€šç¯å’Œå®¹é‡çš„äº¤å‰è·¯å£ï¼Œé€šè¿‡æš‚æ—¶çš„ç­‰å¾…ï¼ˆé˜»å¡ï¼‰æ¥ç¡®ä¿äº¤é€šï¼ˆç”Ÿäº§æ¶ˆè´¹ï¼‰æœ‰åºã€å®‰å…¨ï¼Œä¸ä¼šå¤±æ§ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ åšå‡ºæœ€åˆé€‚çš„æŠ€æœ¯é€‰å‹ã€‚å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šåœºæ™¯æœ‰æ›´å¤šç»†èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="concurrentskiplist"&gt;ConcurrentSkipList
&lt;/h2&gt;&lt;p&gt;ConcurrentSkipListSet æ˜¯ Java å¹¶å‘åŒ…ä¸­ä¸€ä¸ªçº¿ç¨‹å®‰å…¨ã€åŸºäºè·³è·ƒè¡¨å®ç°çš„æœ‰åºé›†åˆã€‚ä¸ºäº†è®©ä½ å¿«é€ŸæŠ“ä½æ ¸å¿ƒï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒçš„å…³é”®ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;ConcurrentSkipListSet çš„æ ¸å¿ƒç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;strong&gt;CAS æ— é”ç®—æ³•&lt;/strong&gt; å®ç°ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¹¶å‘å®‰å…¨è®¿é—® ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…ƒç´ é»˜è®¤æŒ‰&lt;strong&gt;è‡ªç„¶é¡ºåº&lt;/strong&gt;æˆ–åˆ›å»ºæ—¶æä¾›çš„ &lt;strong&gt;Comparator&lt;/strong&gt; æ’åºï¼Œå®ç° &lt;code&gt;NavigableSet&lt;/code&gt;æ¥å£ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäº &lt;strong&gt;è·³è·ƒè¡¨&lt;/strong&gt;ï¼Œä¸€ç§æ¦‚ç‡æ€§çš„åˆ†å±‚ç´¢å¼•ç»“æ„ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ“ä½œçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º &lt;strong&gt;O(log n)&lt;/strong&gt; ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¾¹ç•Œæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— ç•Œé›†åˆ&lt;/strong&gt;ï¼Œåªå—å†…å­˜é™åˆ¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;NULL çº¦æŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸å…è®¸æ’å…¥ &lt;code&gt;null&lt;/code&gt;å…ƒç´ &lt;/strong&gt; ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿­ä»£å™¨ç‰¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¼±ä¸€è‡´æ€§&lt;/strong&gt;ï¼Œä¸ä¼šæŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ï¼Œä½†ä¸ä¿è¯åæ˜ éå†è¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ›´æ–° ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;size()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éæ’å®šæ—¶é—´æ“ä½œ&lt;/strong&gt;ï¼Œéœ€è¦éå†è®¡æ•°ï¼Œé«˜å¹¶å‘ä¸‹ç»“æœå¯èƒ½ä¸å‡†ç¡®ï¼Œé€šå¸¸ä¸å®ç”¨ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†è·³è·ƒè¡¨ä¸å¹¶å‘æ§åˆ¶"&gt;ğŸ’¡ æ ¸å¿ƒåŸç†ï¼šè·³è·ƒè¡¨ä¸å¹¶å‘æ§åˆ¶
&lt;/h3&gt;&lt;p&gt;ConcurrentSkipListSet çš„é«˜æ€§èƒ½æºäºå…¶ç²¾å¦™çš„åº•å±‚è®¾è®¡ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·³è·ƒè¡¨çš„ç»“æ„ä¸æ“ä½œ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è·³è·ƒè¡¨å¯ä»¥ç†è§£ä¸º&lt;strong&gt;å¤šå±‚é“¾è¡¨&lt;/strong&gt;çš„ç»„åˆ ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åº•å±‚&lt;/strong&gt;ï¼šä¸€ä¸ªåŒ…å«æ‰€æœ‰å…ƒç´ çš„æœ‰åºé“¾è¡¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸Šå±‚&lt;/strong&gt;ï¼šä½œä¸ºåº•å±‚é“¾è¡¨çš„â€œå¿«é€Ÿé€šé“â€æˆ–ç´¢å¼•ï¼Œå±‚æ•°è¶Šé«˜ï¼ŒèŠ‚ç‚¹è¶Šç¨€ç–ã€‚æ¯ä¸ªèŠ‚ç‚¹æ’å…¥æ—¶ï¼Œå…¶å±‚çº§ç”±éšæœºç®—æ³•å†³å®šï¼ˆå¦‚ç±»ä¼¼æŠ›ç¡¬å¸ï¼Œæœ‰50%çš„æ¦‚ç‡æå‡ä¸€å±‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿›è¡ŒæŸ¥æ‰¾æ—¶ï¼Œç®—æ³•ä»æœ€é«˜å±‚å¼€å§‹ï¼Œå‘å³å‰è¿›ç›´åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å€¼å¤§äºç›®æ ‡ï¼Œç„¶åä¸‹é™ä¸€å±‚ç»§ç»­æŸ¥æ‰¾ï¼Œå¦‚æ­¤åå¤ï¼Œä»è€Œè·³è¿‡å¤§é‡ä¸å¿…è¦çš„æ¯”è¾ƒï¼Œå®ç°é«˜æ•ˆè®¿é—® ã€‚æ’å…¥å’Œåˆ é™¤æ“ä½œä¹ŸåŸºäºç±»ä¼¼çš„æŸ¥æ‰¾é€»è¾‘ï¼Œå¹¶æ›´æ–°ç›¸å…³å±‚çš„æŒ‡é’ˆ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹¶å‘å®‰å…¨å®ç°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ConcurrentSkipListSet çš„çº¿ç¨‹å®‰å…¨ä¸æ˜¯é€šè¿‡ä¼ ç»Ÿçš„é”æœºåˆ¶ï¼Œè€Œæ˜¯ä¾èµ–äº &lt;strong&gt;CAS æ“ä½œ&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹é˜Ÿåˆ—æ—¶ï¼ŒCAS ä¼šç¡®ä¿åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æˆåŠŸæ›´æ–°æŒ‡é’ˆï¼Œå…¶ä»–å¤±è´¥çš„çº¿ç¨‹ä¼šç«‹å³é‡è¯•ã€‚è¿™ä¸ªè¿‡ç¨‹&lt;strong&gt;ä¸ä¼šå¯¼è‡´çº¿ç¨‹è¢«æŒ‚èµ·ï¼ˆé˜»å¡ï¼‰&lt;/strong&gt;ï¼Œé¿å…äº†æ˜‚è´µçš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå› æ­¤åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹èƒ½å®ç°å¾ˆé«˜çš„ååé‡ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸»è¦æ–¹æ³•ä¸ä½¿ç”¨ç¤ºä¾‹"&gt;ğŸ“– ä¸»è¦æ–¹æ³•ä¸ä½¿ç”¨ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;äº†è§£åŸç†åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„ä¸»è¦æ–¹æ³•å’Œå¦‚ä½•ä½¿ç”¨å®ƒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ“ä½œ&lt;/strong&gt;ï¼š&lt;code&gt;add(E e)&lt;/code&gt;, &lt;code&gt;contains(Object o)&lt;/code&gt;, &lt;code&gt;remove(Object o)&lt;/code&gt;ç­‰å•å…ƒç´ æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º O(log n) ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŒƒå›´è§†å›¾æ“ä½œ&lt;/strong&gt;ï¼šå¾—ç›Šäºæœ‰åºæ€§ï¼Œå®ƒæä¾›äº† &lt;code&gt;subSet&lt;/code&gt;, &lt;code&gt;headSet&lt;/code&gt;, &lt;code&gt;tailSet&lt;/code&gt;ç­‰æ–¹æ³•ï¼Œå¯ä»¥é«˜æ•ˆåœ°è·å–æŸä¸ªåŒºé—´å†…çš„å…ƒç´ è§†å›¾ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¼èˆªæ“ä½œ&lt;/strong&gt;ï¼šä½œä¸º &lt;code&gt;NavigableSet&lt;/code&gt;ï¼Œå®ƒæ”¯æŒ &lt;code&gt;ceiling&lt;/code&gt;ï¼ˆå¤§äºç­‰äºç»™å®šå…ƒç´ çš„æœ€å°å…ƒç´ ï¼‰ã€&lt;code&gt;floor&lt;/code&gt;ï¼ˆå°äºç­‰äºç»™å®šå…ƒç´ çš„æœ€å¤§å…ƒç´ ï¼‰ã€&lt;code&gt;higher&lt;/code&gt;ã€&lt;code&gt;lower&lt;/code&gt;ç­‰å¯¼èˆªæ–¹æ³• ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹ä»£ç ï¼šåŸºæœ¬ä½¿ç”¨&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.concurrent.ConcurrentSkipListSet;
public class Example {
public static void main(String[] args) {
// åˆ›å»ºé›†åˆï¼ŒæŒ‰è‡ªç„¶é¡ºåºæ’åº
ConcurrentSkipListSet&amp;lt;Integer&amp;gt; set = new ConcurrentSkipListSet&amp;lt;&amp;gt;();
// æ·»åŠ å…ƒç´ 
set.add(5);
set.add(2);
set.add(8);
// è¾“å‡ºä¼šè‡ªåŠ¨æ’åºï¼š[2, 5, 8]
System.out.println(&amp;#34;Set contents: &amp;#34; + set);
// è·å–å­é›† [2, 5]
System.out.println(&amp;#34;HeadSet (&amp;lt;5): &amp;#34; + set.headSet(5));
// ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼ˆä¾‹å¦‚ï¼Œé™åºï¼‰
ConcurrentSkipListSet&amp;lt;Integer&amp;gt; descendingSet =
new ConcurrentSkipListSet&amp;lt;&amp;gt;(Comparator.reverseOrder());
descendingSet.addAll(set);
// è¾“å‡ºï¼š[8, 5, 2]
System.out.println(&amp;#34;Descending set: &amp;#34; + descendingSet);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹-1"&gt;ğŸ¯ é€‚ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;é€‰æ‹©ä½¿ç”¨ ConcurrentSkipListSet å‰ï¼Œè¯·æ˜ç¡®å…¶é€‚ç”¨åœºæ™¯å’Œæ½œåœ¨é™åˆ¶ã€‚&lt;/p&gt;
&lt;h4 id="å…¸å‹é€‚ç”¨åœºæ™¯--1"&gt;**å…¸å‹é€‚ç”¨åœºæ™¯ **
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘æœ‰åºé›†åˆ&lt;/strong&gt;ï¼šå¦‚å®æ—¶&lt;strong&gt;æ’è¡Œæ¦œ&lt;/strong&gt;ã€&lt;strong&gt;ç§¯åˆ†æ¦œ&lt;/strong&gt;ç­‰ï¼Œéœ€è¦å¤šçº¿ç¨‹å®‰å…¨åœ°æ’å…¥ã€æ›´æ–°å’ŒæŒ‰é¡ºåºè¯»å–æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦é«˜æ•ˆèŒƒå›´æŸ¥è¯¢çš„åœºæ™¯&lt;/strong&gt;ï¼šä¾‹å¦‚ï¼Œéœ€è¦é¢‘ç¹æŸ¥æ‰¾æŸä¸ªåˆ†æ•°æ®µæˆ–IDåŒºé—´çš„æ‰€æœ‰å…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£ &lt;code&gt;TreeSet&lt;/code&gt;çš„å¹¶å‘ç‰ˆæœ¬&lt;/strong&gt;ï¼šå½“éœ€è¦ä¸€ä¸ªçº¿ç¨‹å®‰å…¨ä¸”æœ‰åºçš„é›†åˆæ—¶ï¼Œ&lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;æ˜¯ &lt;code&gt;TreeSet&lt;/code&gt;çš„ç†æƒ³æ›¿ä»£å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é‡è¦æ³¨æ„äº‹é¡¹ä¸é™åˆ¶-1"&gt;&lt;strong&gt;é‡è¦æ³¨æ„äº‹é¡¹ä¸é™åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;ï¼šè·³è·ƒè¡¨çš„å¤šå±‚ç´¢å¼•ç»“æ„å¯¼è‡´å…¶&lt;strong&gt;å†…å­˜å ç”¨é«˜äº &lt;code&gt;HashSet&lt;/code&gt;æˆ–æ™®é€šçš„é“¾è¡¨&lt;/strong&gt; ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ…ç”¨ &lt;code&gt;size()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ï¼š&lt;code&gt;size()&lt;/code&gt;æ–¹æ³•éœ€è¦éå†æ•´ä¸ªé›†åˆè®¡æ•°ï¼Œæ˜¯ &lt;strong&gt;O(n)&lt;/strong&gt; æ“ä½œï¼Œä¸”åœ¨å¹¶å‘ç¯å¢ƒä¸‹ç»“æœå¯èƒ½ä¸å‡†ç¡®ã€‚åˆ¤æ–­æ˜¯å¦ä¸ºç©ºåº”ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;isEmpty()&lt;/code&gt;æ–¹æ³• ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±ä¸€è‡´æ€§è¿­ä»£å™¨&lt;/strong&gt;ï¼šè¿­ä»£å™¨åæ˜ çš„æ˜¯åˆ›å»ºæ—¶åˆ»æˆ–ä¹‹åæŸä¸ªç‚¹çš„é›†åˆçŠ¶æ€ï¼Œä¸ä¿è¯èƒ½éå†åˆ°è¿­ä»£è¿‡ç¨‹ä¸­æ‰€æœ‰æ–°åŠ å…¥æˆ–åˆ é™¤çš„å…ƒç´ ï¼Œä½†ä¹Ÿä¸ä¼šæŠ›å‡ºå¼‚å¸¸ ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸å…¶ä»–é›†åˆçš„å¯¹æ¯”"&gt;ğŸ”„ ä¸å…¶ä»–é›†åˆçš„å¯¹æ¯”
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†å¸®åŠ©ä½ æ›´å¥½åœ°è¿›è¡ŒæŠ€æœ¯é€‰å‹ï¼Œä¸‹é¢æ˜¯ä¸å…¶å®ƒå¸¸ç”¨ Set çš„å¯¹æ¯” ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;&lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;TreeSet&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;CopyOnWriteArraySet&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;ConcurrentHashMap.KeySetView&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è·³è·ƒè¡¨&lt;/td&gt;
&lt;td&gt;çº¢é»‘æ ‘&lt;/td&gt;
&lt;td&gt;åŠ¨æ€æ•°ç»„&lt;/td&gt;
&lt;td&gt;å“ˆå¸Œè¡¨+é“¾è¡¨/æ ‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜ï¼ˆæ— é”ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆéœ€å¤–éƒ¨åŒæ­¥ï¼‰&lt;/td&gt;
&lt;td&gt;å†™æ“ä½œæ€§èƒ½å·®ï¼ˆéœ€å¤åˆ¶ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éå¸¸é«˜&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¹¶å‘+æœ‰åº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹æœ‰åº&lt;/td&gt;
&lt;td&gt;è¯»å¤šå†™æå°‘&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¹¶å‘+æ— åº&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;æ˜¯ Java å¹¶å‘ç¼–ç¨‹ä¸­ä¸€æ¬¾å¼ºå¤§çš„å·¥å…·ï¼Œå®ƒåœ¨&lt;strong&gt;é«˜ååé‡ã€éœ€è¦å…ƒç´ æœ‰åºä¸”å¹¶å‘è®¿é—®&lt;/strong&gt;çš„åœºæ™¯ä¸‹è¡¨ç°å‡ºè‰²ã€‚å…¶&lt;strong&gt;æ— é”ã€åŸºäºè·³è·ƒè¡¨&lt;/strong&gt;çš„è®¾è®¡ä½¿å…¶åœ¨ä¿è¯çº¿ç¨‹å®‰å…¨çš„åŒæ—¶ï¼Œæä¾›äº†è‰¯å¥½çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä½ ä¹Ÿéœ€è¦äº†è§£å…¶&lt;strong&gt;å†…å­˜å¼€é”€è¾ƒé«˜&lt;/strong&gt;ã€&lt;strong&gt;&lt;code&gt;size()&lt;/code&gt;æ–¹æ³•æ•ˆç‡ä½&lt;/strong&gt;ç­‰ç‰¹ç‚¹ã€‚å¦‚æœä½ çš„åœºæ™¯ä¸éœ€è¦å…ƒç´ æœ‰åºï¼Œé‚£ä¹ˆ &lt;code&gt;ConcurrentHashMap.KeySetView&lt;/code&gt;å¯èƒ½ä¼šæ˜¯æ€§èƒ½æ›´å¥½çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£å¹¶æ­£ç¡®ä½¿ç”¨ &lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;ã€‚å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„åº”ç”¨æœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="hashmap"&gt;HashMap
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th style="text-align: left"&gt;JDK7 å®ç°&lt;/th&gt;
&lt;th style="text-align: left"&gt;JDK8 å®ç°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;åº•å±‚ç»“æ„&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ•°ç»„ + é“¾è¡¨ï¼ˆEntry èŠ‚ç‚¹ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ•°ç»„ + é“¾è¡¨/çº¢é»‘æ ‘ï¼ˆNode/TreeNode èŠ‚ç‚¹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;å†²çªè§£å†³&lt;/td&gt;
&lt;td style="text-align: left"&gt;é“¾è¡¨ï¼ˆé•¿åº¦æ— é™åˆ¶ï¼ŒæŸ¥æ‰¾ O(n)ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;é“¾è¡¨é•¿åº¦ â‰¥8 ä¸”æ•°ç»„é•¿åº¦ â‰¥64 æ—¶è½¬ä¸ºçº¢é»‘æ ‘ï¼ˆæŸ¥æ‰¾ O(logn)ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;æ’å…¥æ–¹å¼&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¤´æ’æ³•ï¼ˆæ–°èŠ‚ç‚¹æ’å…¥é“¾è¡¨å¤´éƒ¨ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å°¾æ’æ³•ï¼ˆæ–°èŠ‚ç‚¹æ’å…¥é“¾è¡¨å°¾éƒ¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;æ‰©å®¹æ—¶å“ˆå¸Œè®¡ç®—&lt;/td&gt;
&lt;td style="text-align: left"&gt;é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼ˆhash()æ–¹æ³•ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;é€šè¿‡hash &amp;amp; oldCapåˆ¤æ–­æ˜¯å¦éœ€è¦ç§»åŠ¨ï¼ˆæ— éœ€é‡æ–°è®¡ç®—å“ˆå¸Œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;æ­»å¾ªç¯é—®é¢˜&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¤šçº¿ç¨‹æ‰©å®¹æ—¶å¯èƒ½å¯¼è‡´é“¾è¡¨æˆç¯ï¼ˆæ­»å¾ªç¯ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å°¾æ’æ³•é¿å…äº†æ­»å¾ªç¯ï¼Œä½†ä»å­˜åœ¨æ•°æ®è¦†ç›–é—®é¢˜ï¼ˆçº¿ç¨‹ä¸å®‰å…¨æœ¬è´¨æœªå˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="concurrenthashmap"&gt;ConcurrentHashMap
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;ç»´åº¦&lt;/th&gt;
&lt;th style="text-align: left"&gt;JDK 7&lt;/th&gt;
&lt;th style="text-align: left"&gt;JDK 8&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;åº•å±‚ç»“æ„&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ•°ç»„ + é“¾è¡¨ + åˆ†æ®µé”ï¼ˆSegmentï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ•°ç»„ + é“¾è¡¨/çº¢é»‘æ ‘ + CAS + synchronized&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;é”ç²’åº¦&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ®µçº§é”ï¼ˆæ¯ä¸ª Segment ç‹¬ç«‹åŠ é”ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;èŠ‚ç‚¹çº§é”ï¼ˆä»…é”å®šé“¾è¡¨å¤´æˆ–çº¢é»‘æ ‘æ ¹èŠ‚ç‚¹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;å¹¶å‘æ€§èƒ½&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¸­ç­‰ï¼ˆæ”¯æŒå¤šæ®µå¹¶å‘ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;é«˜ï¼ˆç»†ç²’åº¦é” + æ— é”è¯»ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;æ‰©å®¹æœºåˆ¶&lt;/td&gt;
&lt;td style="text-align: left"&gt;å…¨é‡æ‰©å®¹ï¼ˆå•çº¿ç¨‹å®Œæˆï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¹¶å‘æ‰©å®¹ï¼ˆå¤šçº¿ç¨‹åä½œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;å®ç°ç±»&lt;/th&gt;
&lt;th style="text-align: left"&gt;çº¿ç¨‹å®‰å…¨æœºåˆ¶&lt;/th&gt;
&lt;th style="text-align: left"&gt;è¯»æ€§èƒ½&lt;/th&gt;
&lt;th style="text-align: left"&gt;å†™æ€§èƒ½&lt;/th&gt;
&lt;th style="text-align: left"&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;ConcurrentHashMap&lt;/td&gt;
&lt;td style="text-align: left"&gt;CAS + ç»†ç²’åº¦é”&lt;/td&gt;
&lt;td style="text-align: left"&gt;æé«˜&lt;/td&gt;
&lt;td style="text-align: left"&gt;é«˜&lt;/td&gt;
&lt;td style="text-align: left"&gt;é«˜å¹¶å‘è¯»å†™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;Hashtable&lt;/td&gt;
&lt;td style="text-align: left"&gt;å…¨å±€é”ï¼ˆsynchronizedï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä½&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä½&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä½å¹¶å‘åœºæ™¯ï¼ˆå·²æ·˜æ±°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;Collections.synchronizedMap&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ–¹æ³•çº§åŒæ­¥é”&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¸­ç­‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¸­ç­‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç®€å•åŒæ­¥éœ€æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;CopyOnWriteç³»åˆ—&lt;/td&gt;
&lt;td style="text-align: left"&gt;å†™æ—¶å¤åˆ¶&lt;/td&gt;
&lt;td style="text-align: left"&gt;æé«˜&lt;/td&gt;
&lt;td style="text-align: left"&gt;æä½&lt;/td&gt;
&lt;td style="text-align: left"&gt;è¯»å¤šå†™å°‘ï¼ˆå¦‚é…ç½®ç¼“å­˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="concurrentskiplistmap"&gt;ConcurrentSkipListMap
&lt;/h2&gt;&lt;p&gt;ã€‚æœ‰çš„ã€‚åœ¨Javaä¸­ï¼Œå¦‚æœä½ éœ€è¦ä¸€ä¸ªæ—¢&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;åˆèƒ½ä¿æŒå…ƒç´ &lt;strong&gt;é¡ºåº&lt;/strong&gt;çš„Mapï¼Œä¸»è¦æœ‰ä¸¤ä¸ªæ ¸å¿ƒé€‰æ‹©ï¼š&lt;code&gt;ConcurrentSkipListMap&lt;/code&gt;å’Œé€šè¿‡åŒ…è£…&lt;code&gt;LinkedHashMap&lt;/code&gt;å¾—åˆ°çš„åŒæ­¥Mapã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯ä»¥å¸®ä½ å¿«é€Ÿäº†è§£å®ƒä»¬çš„ä¸»è¦ç‰¹ç‚¹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;&lt;code&gt;ConcurrentSkipListMap&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;Collections.synchronizedMap(new LinkedHashMap&amp;lt;&amp;gt;())&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰&lt;strong&gt;é”®çš„è‡ªç„¶é¡ºåº&lt;/strong&gt;æˆ–&lt;strong&gt;è‡ªå®šä¹‰æ¯”è¾ƒå™¨&lt;/strong&gt;æ’åº&lt;/td&gt;
&lt;td&gt;æŒ‰&lt;strong&gt;å…ƒç´ çš„æ’å…¥é¡ºåº&lt;/strong&gt;æ’åº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨åŸç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— é”ç®—æ³•ï¼ˆCASï¼‰&lt;/strong&gt;ï¼Œé«˜å¹¶å‘ä¸‹æ€§èƒ½æ›´å¥½&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åŒæ­¥é”ï¼ˆsynchronizedï¼‰&lt;/strong&gt;ï¼Œé”ä½æ•´ä¸ªMapå¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è·³è·ƒè¡¨ï¼ˆSkip Listï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å“ˆå¸Œè¡¨ + åŒå‘é“¾è¡¨&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ç‰¹ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»å†™çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º &lt;strong&gt;O(log n)&lt;/strong&gt;ï¼Œé«˜å¹¶å‘ååé‡é«˜&lt;/td&gt;
&lt;td&gt;è¯»å†™å¹³å‡æ—¶é—´å¤æ‚åº¦è¿‘ &lt;strong&gt;O(1)&lt;/strong&gt;ï¼Œä½†åœ¨é«˜å¹¶å‘ä¸‹é”ç«äº‰å¯èƒ½æˆä¸ºç“¶é¢ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ä¸”éœ€è¦&lt;strong&gt;é”®æ’åº&lt;/strong&gt;çš„åœºæ™¯ï¼ˆå¦‚å®æ—¶æ’è¡Œæ¦œã€å¸¦é¡ºåºçš„è°ƒåº¦ç³»ç»Ÿï¼‰&lt;/td&gt;
&lt;td&gt;å¹¶å‘åº¦ä¸é«˜ä½†éœ€è¦&lt;strong&gt;ä¿æŒæ’å…¥é¡ºåº&lt;/strong&gt;çš„åœºæ™¯ï¼ˆå¦‚é¡ºåºæ—¥å¿—è®°å½•ã€ç¼“å­˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©"&gt;ğŸ’¡ å¦‚ä½•é€‰æ‹©
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹© &lt;code&gt;ConcurrentSkipListMap&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ä½ çš„åº”ç”¨åœºæ™¯æ˜¯&lt;strong&gt;é«˜å¹¶å‘&lt;/strong&gt;çš„ï¼Œå¹¶ä¸”éœ€è¦&lt;strong&gt;é”®ï¼ˆKeyï¼‰æŒ‰ç…§ä¸€å®šçš„é¡ºåºæ’åˆ—&lt;/strong&gt;æ—¶ï¼Œå®ƒæ˜¯ç†æƒ³é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œå®ç°ä¸€ä¸ªå¤šçº¿ç¨‹æ›´æ–°çš„å®æ—¶ç§¯åˆ†æ¦œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©åŒæ­¥çš„ &lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ä½ çš„å¹¶å‘å‹åŠ›&lt;strong&gt;ä¸å¤§&lt;/strong&gt;ï¼Œä½†éå¸¸çœ‹é‡&lt;strong&gt;å…ƒç´ æ’å…¥çš„é¡ºåº&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼Œéœ€è¦ç¡®ä¿éå†Mapæ—¶çš„é¡ºåºå’Œæ”¾å…¥æ—¶çš„é¡ºåºå®Œå…¨ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-1"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;ï¼š&lt;code&gt;ConcurrentSkipListMap&lt;/code&gt;ç”±äºåŸºäºè·³è¡¨å®ç°ï¼Œåœ¨éå¹¶å‘æˆ–ä½å¹¶å‘æƒ…å†µä¸‹ï¼Œå…¶æ€§èƒ½å¯èƒ½ä¸å¦‚æ™®é€šçš„&lt;code&gt;HashMap&lt;/code&gt;ã€‚è€ŒåŒæ­¥çš„&lt;code&gt;LinkedHashMap&lt;/code&gt;åœ¨é«˜å¹¶å‘ä¸‹ä¼šå› é”ç«äº‰å¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;NULLé”®å€¼&lt;/strong&gt;ï¼š&lt;code&gt;ConcurrentSkipListMap&lt;/code&gt;&lt;strong&gt;ä¸å…è®¸&lt;/strong&gt;ä½¿ç”¨&lt;code&gt;null&lt;/code&gt;ä½œä¸ºé”®æˆ–å€¼ã€‚åœ¨ä½¿ç”¨æ—¶éœ€è¦ç•™æ„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´ç°ä»£çš„é€‰æ‹©&lt;/strong&gt;ï¼šå¯¹äºé«˜å¹¶å‘ä½†ä¸éœ€è¦æ’åºçš„åœºæ™¯ï¼Œ&lt;code&gt;ConcurrentHashMap&lt;/code&gt;é€šå¸¸æ˜¯æ€§èƒ½æœ€å¥½çš„é€‰æ‹©ï¼Œä½†å®ƒä¸ä¿è¯é¡ºåºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½æ¢³ç†èƒ½å¸®åŠ©ä½ æ ¹æ®å…·ä½“éœ€æ±‚åšå‡ºæœ€åˆé€‚çš„é€‰æ‹©ã€‚å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šåœºæ™¯æœ‰æ›´å¤šç»†èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="object-ç±»"&gt;Object ç±»
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;å¸¸è§åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;toString()&lt;/td&gt;
&lt;td style="text-align: left"&gt;è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼&lt;/td&gt;
&lt;td style="text-align: left"&gt;è°ƒè¯•ã€æ—¥å¿—è¾“å‡º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;equals(Object obj)&lt;/td&gt;
&lt;td style="text-align: left"&gt;åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦â€œé€»è¾‘ç›¸ç­‰â€&lt;/td&gt;
&lt;td style="text-align: left"&gt;è‡ªå®šä¹‰å¯¹è±¡å†…å®¹æ¯”è¾ƒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;hashCode()&lt;/td&gt;
&lt;td style="text-align: left"&gt;è¿”å›å¯¹è±¡çš„å“ˆå¸Œç ï¼ˆç”¨äºå“ˆå¸Œè¡¨å­˜å‚¨ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;é›†åˆç±»ï¼ˆå¦‚HashMapã€HashSetï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;getClass()&lt;/td&gt;
&lt;td style="text-align: left"&gt;è¿”å›å¯¹è±¡çš„è¿è¡Œæ—¶ç±»ï¼ˆClasså¯¹è±¡ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;åå°„ã€ç±»å‹æ£€æŸ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;clone()&lt;/td&gt;
&lt;td style="text-align: left"&gt;åˆ›å»ºå¹¶è¿”å›å¯¹è±¡çš„å‰¯æœ¬ï¼ˆæµ…æ‹·è´ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¯¹è±¡å¤åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;finalize()&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¯¹è±¡è¢«åƒåœ¾å›æ”¶å‰è°ƒç”¨ï¼ˆå·²åºŸå¼ƒï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;èµ„æºæ¸…ç†ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;wait()ã€wait(long timeout)ã€wait(long timeout, int nanos)&lt;/td&gt;
&lt;td style="text-align: left"&gt;è®©å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ˆéœ€åœ¨åŒæ­¥å—ä¸­ä½¿ç”¨ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;çº¿ç¨‹é—´é€šä¿¡ï¼ˆç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;notify()ã€notifyAll()&lt;/td&gt;
&lt;td style="text-align: left"&gt;å”¤é†’ç­‰å¾…è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼ˆéœ€åœ¨åŒæ­¥å—ä¸­ä½¿ç”¨ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;çº¿ç¨‹é—´é€šä¿¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;registerNatives()&lt;/td&gt;
&lt;td style="text-align: left"&gt;æœ¬åœ°æ–¹æ³•ï¼Œç”¨äºæ³¨å†Œæœ¬åœ°æ–¹æ³•å®ç°ï¼ˆç”± JVM å†…éƒ¨ä½¿ç”¨ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¾ˆå°‘ç”¨ï¼Œæ— éœ€å…³æ³¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="å¼•ç”¨æ‹·è´--æµ…æ‹·è´"&gt;å¼•ç”¨æ‹·è´ &amp;amp; æµ…æ‹·è´
&lt;/h2&gt;&lt;p&gt;åœ¨Javaä¸­ï¼Œå¼•ç”¨æ‹·è´å’Œæµ…æ‹·è´æ˜¯ä¸¤ç§ä¸åŒçš„å¯¹è±¡å¤åˆ¶æ–¹å¼ï¼Œæ ¸å¿ƒåŒºåˆ«åœ¨äº&lt;strong&gt;æ˜¯å¦åˆ›å»ºäº†æ–°å¯¹è±¡&lt;/strong&gt;ä»¥åŠ&lt;strong&gt;å¯¹åŸå§‹å¯¹è±¡å†…éƒ¨å¼•ç”¨ç±»å‹å­—æ®µçš„å¤„ç†æ–¹å¼&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„è¡¨æ ¼å¯ä»¥å¸®ä½ å¿«é€ŸæŠŠæ¡å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;å¼•ç”¨æ‹·è´&lt;/th&gt;
&lt;th&gt;æµ…æ‹·è´&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–°å¯¹è±¡åˆ›å»º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸åˆ›å»ºæ–°å¯¹è±¡ï¼Œä»…å¤åˆ¶å¼•ç”¨&lt;/td&gt;
&lt;td&gt;åˆ›å»ºæ–°å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå †å†…å­˜å¯¹è±¡&lt;/td&gt;
&lt;td&gt;æ–°å¯¹è±¡å’ŒåŸå¯¹è±¡çš„åŸºæœ¬ç±»å‹å­—æ®µç‹¬ç«‹ï¼Œä½†å¼•ç”¨ç±»å‹å­—æ®µæŒ‡å‘åŒä¸€å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯¹è±¡ç‹¬ç«‹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®Œå…¨å…±äº«ï¼Œä¿®æ”¹ä»»ä¸€å¼•ç”¨éƒ½ä¼šå½±å“å¦ä¸€æ–¹&lt;/td&gt;
&lt;td&gt;åŸºæœ¬ç±»å‹å­—æ®µç‹¬ç«‹ï¼Œä¿®æ”¹å¼•ç”¨ç±»å‹å­—æ®µä¼šç›¸äº’å½±å“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥èµ‹å€¼ï¼ˆ&lt;code&gt;=&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å®ç°&lt;code&gt;Cloneable&lt;/code&gt;æ¥å£å¹¶é‡å†™&lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— é¢å¤–å¼€é”€&lt;/td&gt;
&lt;td&gt;å¼€é”€è¾ƒä½&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ä»£ç ç¤ºä¾‹ä¸è§£æ"&gt;ğŸ’» ä»£ç ç¤ºä¾‹ä¸è§£æ
&lt;/h3&gt;&lt;p&gt;é€šè¿‡å…·ä½“çš„ä»£ç å¯ä»¥æ›´ç›´è§‚åœ°ç†è§£å®ƒä»¬çš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¼•ç”¨æ‹·è´ç¤ºä¾‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¼•ç”¨æ‹·è´åªæ˜¯ç»™å·²æœ‰çš„å¯¹è±¡å¢åŠ äº†ä¸€ä¸ªâ€œåˆ«åâ€ï¼Œä¸¤ä¸ªå˜é‡å®é™…ä¸Šæ“ä½œçš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Person p1 = new Person(&amp;#34;Alice&amp;#34;, new Address(&amp;#34;åŒ—äº¬&amp;#34;));
Person p2 = p1; // å¼•ç”¨æ‹·è´ï¼šp1 å’Œ p2 æŒ‡å‘å†…å­˜ä¸­çš„åŒä¸€ä¸ªPersonå¯¹è±¡
p2.setName(&amp;#34;Bob&amp;#34;); // ä¿®æ”¹p2çš„name
p2.getAddress().setCity(&amp;#34;ä¸Šæµ·&amp;#34;); // ä¿®æ”¹p2çš„address
System.out.println(p1.getName()); // è¾“å‡º &amp;#34;Bob&amp;#34;ï¼Œp1çš„nameä¹Ÿè¢«ä¿®æ”¹äº†
System.out.println(p1.getAddress().getCity()); // è¾“å‡º &amp;#34;ä¸Šæµ·&amp;#34;ï¼Œp1çš„addressä¹Ÿè¢«ä¿®æ”¹äº†
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æµ…æ‹·è´ç¤ºä¾‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æµ…æ‹·è´åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä½†å¯¹äºå¯¹è±¡å†…éƒ¨çš„å¼•ç”¨ç±»å‹å­—æ®µï¼ˆå¦‚&lt;code&gt;Address&lt;/code&gt;ï¼‰ï¼Œå®ƒåªå¤åˆ¶äº†å¼•ç”¨åœ°å€ã€‚å› æ­¤ï¼Œæ–°æ—§å¯¹è±¡å…±äº«åŒä¸€ä¸ª&lt;code&gt;Address&lt;/code&gt;å®ä¾‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// å‡è®¾Personç±»å®ç°äº†Cloneableæ¥å£ï¼Œå¹¶é‡å†™äº†clone()æ–¹æ³•
Person p1 = new Person(&amp;#34;Alice&amp;#34;, new Address(&amp;#34;åŒ—äº¬&amp;#34;));
Person p2 = (Person) p1.clone(); // æµ…æ‹·è´ï¼šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„Personå¯¹è±¡
p2.setName(&amp;#34;Bob&amp;#34;); // ä¿®æ”¹p2çš„nameï¼ˆåŸºæœ¬ç±»å‹æˆ–Stringï¼‰ï¼Œä¸å½±å“p1
p2.getAddress().setCity(&amp;#34;ä¸Šæµ·&amp;#34;); // ä¿®æ”¹p2çš„addressï¼ˆå¼•ç”¨ç±»å‹ï¼‰ï¼Œp1çš„addressä¹Ÿéšä¹‹æ”¹å˜ï¼
System.out.println(p1.getName()); // è¾“å‡º &amp;#34;Alice&amp;#34;ï¼Œp1çš„nameæœªå—å½±å“
System.out.println(p1.getAddress().getCity()); // è¾“å‡º &amp;#34;ä¸Šæµ·&amp;#34;ï¼Œp1çš„addressè¢«ä¿®æ”¹äº†
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-æ€»ç»“ä¸å¦‚ä½•é€‰æ‹©"&gt;ğŸ’ æ€»ç»“ä¸å¦‚ä½•é€‰æ‹©
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œå¼•ç”¨æ‹·è´æ˜¯&lt;strong&gt;å¤šä¸ªæ ‡ç­¾è´´åœ¨åŒä¸€ä»½å®ç‰©ä¸Š&lt;/strong&gt;ï¼Œè€Œæµ…æ‹·è´æ˜¯&lt;strong&gt;å¤å°äº†ä¸€ä»½è¡¨å•ï¼Œä½†è¡¨å•ä¸Šâ€œç´§æ€¥è”ç³»äººâ€çš„ç”µè¯è¿˜æ˜¯åŸæ¥é‚£ä¸ª&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é€‰æ‹©ä½¿ç”¨å“ªç§æ–¹å¼æ—¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼•ç”¨æ‹·è´&lt;/strong&gt;ï¼šå½“ä½ ç¡®å®éœ€è¦å…±äº«åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”ä»»ä½•ä¸€æ–¹å¯¹å¯¹è±¡çš„ä¿®æ”¹éƒ½éœ€è¦å¯¹å¦ä¸€æ–¹å¯è§æ—¶ä½¿ç”¨ï¼ˆä½†éœ€è°¨æ…ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;ï¼šå½“éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½†å¯¹è±¡å†…éƒ¨åŒ…å«çš„å¼•ç”¨æ•°æ®æ˜¯åªè¯»çš„ã€ä¸å¯å˜çš„ï¼Œæˆ–è€…ä½ æ„¿æ„å…±äº«è¿™äº›å†…éƒ¨æ•°æ®æ—¶ï¼Œä½¿ç”¨æµ…æ‹·è´æ˜¯é«˜æ•ˆä¸”åˆé€‚çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœä½ å¸Œæœ›æ–°æ—§å¯¹è±¡å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ï¼Œåˆ™éœ€è¦ä½¿ç”¨&lt;strong&gt;æ·±æ‹·è´&lt;/strong&gt;æ¥é€’å½’åœ°å¤åˆ¶æ‰€æœ‰å±‚çº§çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°ç†è§£å¼•ç”¨æ‹·è´å’Œæµ…æ‹·è´çš„åŒºåˆ«ã€‚å¦‚æœä½ å¯¹æ·±æ‹·è´çš„å…·ä½“å®ç°ï¼ˆå¦‚é€šè¿‡åºåˆ—åŒ–æˆ–å·¥å…·åº“ï¼‰æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="registernatives"&gt;registerNatives
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;registerNatives&lt;/code&gt;æ˜¯ Java åº•å±‚å¼€å‘ä¸­ä¸€ä¸ªå…³é”®æœºåˆ¶ï¼Œå®ƒè´Ÿè´£åœ¨ Java ä»£ç å’Œæœ¬åœ°ä»£ç ï¼ˆå¦‚ C/C++ï¼‰ä¹‹é—´å»ºç«‹æ¡¥æ¢ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿäº†è§£å…¶æ ¸å¿ƒç‰¹ç‚¹ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒä¸ä¼ ç»Ÿæ–¹å¼çš„ä¸»è¦åŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼ ç»Ÿé™æ€æ³¨å†Œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;registerNatives&lt;/code&gt;åŠ¨æ€æ³¨å†Œ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»‘å®šæ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–å›ºå®šçš„ JNI å‡½æ•°åè§„åˆ™è‡ªåŠ¨ç»‘å®š&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;code&gt;RegisterNatives&lt;/code&gt;å‡½æ•°æ‰‹åŠ¨ç»‘å®š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‡½æ•°å&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†—é•¿ä¸”ä¸¥æ ¼ï¼Œå¿…é¡»éµå¾ª &lt;code&gt;Java_åŒ…å_ç±»å_æ–¹æ³•å&lt;/code&gt;æ ¼å¼&lt;/td&gt;
&lt;td&gt;è‡ªç”±å‘½åï¼Œæ— éœ€éµå¾ªç‰¹å®šè§„åˆ™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½è¡¨ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¦–æ¬¡è°ƒç”¨æ—¶ï¼ŒJVM éœ€æŸ¥æ‰¾ç¬¦å·è¡¨ï¼Œæœ‰å»¶è¿Ÿ&lt;/td&gt;
&lt;td&gt;é¢„å…ˆç»‘å®šï¼Œ&lt;strong&gt;æ— é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿ&lt;/strong&gt;ï¼Œæ€§èƒ½æ›´ä¼˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ŒJava æ–¹æ³•åæˆ–ç­¾åå˜æ›´éœ€é‡æ–°ç”Ÿæˆå¤´æ–‡ä»¶å¹¶ç¼–è¯‘&lt;/td&gt;
&lt;td&gt;é«˜ï¼Œå¯åœ¨è¿è¡Œæ—¶æ›´æ–°æ˜ å°„å…³ç³»ï¼Œ&lt;strong&gt;è§£è€¦æ€§å¼º&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç å®‰å…¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ¬åœ°å‡½æ•°åæš´éœ²å®ç°ç»†èŠ‚&lt;/td&gt;
&lt;td&gt;éšè—å®é™…å®ç°å‡½æ•°åï¼Œå¢å¼ºå®‰å…¨æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸å·¥ä½œæµç¨‹"&gt;ğŸ’¡ æ ¸å¿ƒåŸç†ä¸å·¥ä½œæµç¨‹
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;registerNatives&lt;/code&gt;çš„æœ¬è´¨æ˜¯ &lt;strong&gt;â€œåŠ¨æ€æ³¨å†Œâ€&lt;/strong&gt; ã€‚å®ƒé€šè¿‡åœ¨ Java ç±»åŠ è½½æ—¶ï¼Œä¸»åŠ¨å»ºç«‹ Java å£°æ˜çš„ &lt;code&gt;native&lt;/code&gt;æ–¹æ³•ä¸æœ¬åœ°å‡½æ•°å®ç°çš„æ˜ å°„å…³ç³»ï¼Œå–ä»£äº† JVM é»˜è®¤çš„æŒ‰åç§°æŸ¥æ‰¾è§„åˆ™ ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java å±‚å£°æ˜ä¸è§¦å‘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ Java ç±»ï¼ˆå¦‚ &lt;code&gt;java.lang.Object&lt;/code&gt;ï¼‰ä¸­ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªç‰¹æ®Šçš„é™æ€åˆå§‹åŒ–å—ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class Object {
private static native void registerNatives(); // 1. å£°æ˜æœ¬åœ°æ³¨å†Œæ–¹æ³•
static {
registerNatives(); // 2. ç±»åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œ
}
// å…¶ä»–æœ¬åœ°æ–¹æ³•ï¼Œå¦‚ hashCodeã€wait ç­‰
public native int hashCode();
public final native void notify();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å½“ JVM åŠ è½½è¿™ä¸ªç±»æ—¶ï¼Œä¼šæ‰§è¡Œé™æ€å—ï¼Œè°ƒç”¨ &lt;code&gt;registerNatives()&lt;/code&gt;æ–¹æ³• ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœ¬åœ°å±‚çš„æ˜ å°„æ³¨å†Œ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬åœ°ä»£ç ï¼ˆC/C++ï¼‰ä¸­ï¼Œéœ€è¦å®ç°è¿™ä¸ª &lt;code&gt;registerNatives&lt;/code&gt;å‡½æ•°ã€‚å…¶æ ¸å¿ƒæ˜¯ä½¿ç”¨ &lt;strong&gt;&lt;code&gt;JNINativeMethod&lt;/code&gt;&lt;/strong&gt; ç»“æ„ä½“æ•°ç»„æ¥å®šä¹‰æ˜ å°„å…³ç³»ï¼Œç„¶åè°ƒç”¨ &lt;strong&gt;&lt;code&gt;JNIEnv-&amp;gt;RegisterNatives()&lt;/code&gt;&lt;/strong&gt; å‡½æ•°å®Œæˆæ³¨å†Œ ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;JNINativeMethod&lt;/code&gt;ç»“æ„ä½“&lt;/strong&gt;ï¼šè¿™æ˜¯æ˜ å°„å…³ç³»çš„â€œè”ç³»äººç™»è®°è¡¨â€ï¼ŒåŒ…å«ä¸‰ä¸ªå­—æ®µ ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;name&lt;/code&gt;: Java ä¸­çš„ native æ–¹æ³•åï¼ˆå¦‚ &lt;code&gt;&amp;quot;hashCode&amp;quot;&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;signature&lt;/code&gt;: æ–¹æ³•çš„ JNI ç­¾åï¼Œæè¿°å‚æ•°å’Œè¿”å›å€¼ç±»å‹ï¼ˆå¦‚ &lt;code&gt;&amp;quot;()I&amp;quot;&lt;/code&gt;è¡¨ç¤ºæ— å‚è¿”å› intï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;fnPtr&lt;/code&gt;: æŒ‡å‘æœ¬åœ°å®ç°å‡½æ•°çš„å‡½æ•°æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨å†Œè¿‡ç¨‹&lt;/strong&gt;ï¼šé€šå¸¸åœ¨ JNI åº“è¢«åŠ è½½æ—¶æ‰§è¡Œçš„ &lt;code&gt;JNI_OnLoad&lt;/code&gt;å‡½æ•°ä¸­å®Œæˆ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å®ç°æµç¨‹ä¸ç¤ºä¾‹"&gt;ğŸ”§ å®ç°æµç¨‹ä¸ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ä½¿ç”¨ &lt;code&gt;registerNatives&lt;/code&gt;è¿›è¡ŒåŠ¨æ€æ³¨å†Œçš„å…¸å‹æ­¥éª¤å’Œä»£ç æ¡†æ¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. Java ä»£ç å±‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½ çš„ Java ç±»å£°æ˜ native æ–¹æ³•å¹¶åŠ è½½åº“ï¼Œè¿™ä¸é™æ€æ³¨å†Œæ— å¼‚ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class MyNativeClass {
public native String getNativeString(); // å£°æ˜nativeæ–¹æ³•
static {
System.loadLibrary(&amp;#34;mynativelib&amp;#34;); // åŠ è½½åŒ…å«å®ç°çš„æœ¬åœ°åº“
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;2. æœ¬åœ°ä»£ç ï¼ˆC/C++ï¼‰å®ç°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯åŠ¨æ€æ³¨å†Œçš„æ ¸å¿ƒæ‰€åœ¨ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#include &amp;lt;jni.h&amp;gt;
// 1. å®ç°æœ¬åœ°å‡½æ•°ï¼ˆå‡½æ•°åå¯è‡ªç”±å®šä¹‰ï¼‰
jstring getString(JNIEnv* env, jobject thisObj) {
return env-&amp;gt;NewStringUTF(&amp;#34;Hello from dynamic registration!&amp;#34;);
}
// 2. å®šä¹‰æ–¹æ³•æ˜ å°„è¡¨
static JNINativeMethod methodMappings[] = {
{&amp;#34;getNativeString&amp;#34;, &amp;#34;()Ljava/lang/String;&amp;#34;, (void*)&amp;amp;getString} // å»ºç«‹æ˜ å°„
};
// 3. å®ç° JNI_OnLoad å‡½æ•°ï¼ˆåº“åŠ è½½å…¥å£ï¼‰
JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* reserved) {
JNIEnv* env;
if (vm-&amp;gt;GetEnv((void**)&amp;amp;env, JNI_VERSION_1_6) != JNI_OK) {
return JNI_ERR; // è·å–JNIç¯å¢ƒå¤±è´¥
}
// æ‰¾åˆ°è¦æ³¨å†Œçš„Javaç±»
jclass clazz = env-&amp;gt;FindClass(&amp;#34;com/example/MyNativeClass&amp;#34;);
if (clazz == NULL) {
return JNI_ERR;
}
// æ‰§è¡Œæ³¨å†Œï¼å°†æ˜ å°„è¡¨ä¸Javaç±»å…³è”
if (env-&amp;gt;RegisterNatives(clazz, methodMappings,
sizeof(methodMappings) / sizeof(methodMappings[0])) &amp;lt; 0) {
return JNI_ERR; // æ³¨å†Œå¤±è´¥
}
return JNI_VERSION_1_6; // è¿”å›JNIç‰ˆæœ¬å·
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå½“ &lt;code&gt;System.loadLibrary(&amp;quot;mynativelib&amp;quot;)&lt;/code&gt;æ‰§è¡Œæ—¶ï¼Œ&lt;code&gt;JNI_OnLoad&lt;/code&gt;è¢«è°ƒç”¨ï¼Œ&lt;code&gt;getNativeString&lt;/code&gt;æ–¹æ³•ä¾¿æˆåŠŸç»‘å®šåˆ°æœ¬åœ°çš„ &lt;code&gt;getString&lt;/code&gt;å‡½æ•° ã€‚&lt;/p&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;registerNatives&lt;/code&gt;æœºåˆ¶æ˜¯ JNI ç¼–ç¨‹ä¸­ä¸€é¡¹æå‡æ€§èƒ½ã€çµæ´»æ€§å’Œä»£ç ç»´æŠ¤æ€§çš„é‡è¦æŠ€æœ¯ã€‚å®ƒé€šè¿‡ä¸»åŠ¨æ³¨å†Œå–ä»£è¢«åŠ¨æŸ¥æ‰¾ï¼Œä½¿å¾— Java ä¸æœ¬åœ°ä»£ç çš„åä½œæ›´åŠ é«˜æ•ˆå’Œå¯æ§ã€‚å¯¹äºéœ€è¦é¢‘ç¹è°ƒç”¨æœ¬åœ°æ–¹æ³•æˆ–å¯¹æ€§èƒ½æœ‰è¾ƒé«˜è¦æ±‚çš„é¡¹ç›®ï¼Œ&lt;strong&gt;ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ &lt;code&gt;registerNatives&lt;/code&gt;è¿›è¡ŒåŠ¨æ€æ³¨å†Œ&lt;/strong&gt; æ˜¯éå¸¸å€¼å¾—æ¨èçš„åšæ³• ã€‚è€Œå¯¹äºç®€å•çš„ã€ä¸€æ¬¡æ€§è°ƒç”¨çš„åœºæ™¯ï¼Œä¼ ç»Ÿçš„é™æ€æ³¨å†Œæ–¹å¼åˆ™å› å…¶ç®€å•æ€§ä»æ˜¯ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£ &lt;code&gt;registerNatives&lt;/code&gt;ã€‚å¦‚æœä½ å¯¹ JNI æ–¹æ³•ç­¾åç­‰ç»†èŠ‚æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="c-static"&gt;C++ static
&lt;/h2&gt;&lt;p&gt;åœ¨ C++ ä¸­ï¼Œ&lt;code&gt;static&lt;/code&gt;æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½å…³é”®å­—ï¼Œå®ƒçš„ä½œç”¨æ ¹æ®ä½¿ç”¨åœºæ™¯æœ‰æ‰€ä¸åŒï¼Œä¸»è¦ç›®çš„åœ¨äºæ”¹å˜å˜é‡æˆ–å‡½æ•°çš„&lt;strong&gt;å­˜å‚¨å‘¨æœŸ&lt;/strong&gt;å’Œ&lt;strong&gt;å¯è§æ€§ï¼ˆä½œç”¨åŸŸï¼‰&lt;/strong&gt;ã€‚ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡å…¨è²Œï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒçš„æ ¸å¿ƒç”¨é€”ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ä½œç”¨åœºæ™¯&lt;/th&gt;
&lt;th&gt;ä¸»è¦åŠŸèƒ½&lt;/th&gt;
&lt;th&gt;å…³é”®ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å±€éƒ¨å˜é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å»¶é•¿ç”Ÿå‘½å‘¨æœŸï¼Œä¿æŒå€¼æŒä¹…&lt;/td&gt;
&lt;td&gt;åªåœ¨å‡½æ•°å†…å¯è§ï¼Œä½†ç”Ÿå‘½å‘¨æœŸè´¯ç©¿æ•´ä¸ªç¨‹åºè¿è¡ŒæœŸï¼Œåªåˆå§‹åŒ–ä¸€æ¬¡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¨å±€å˜é‡/å‡½æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é™åˆ¶ä½œç”¨åŸŸï¼Œéšè—ç¬¦å·&lt;/td&gt;
&lt;td&gt;å°†å˜é‡æˆ–å‡½æ•°çš„ä½œç”¨åŸŸé™åˆ¶åœ¨&lt;strong&gt;å½“å‰æ–‡ä»¶å†…&lt;/strong&gt;ï¼Œé¿å…ä¸å…¶ä»–æ–‡ä»¶çš„åŒåç¬¦å·å†²çªã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»æˆå‘˜å˜é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®ç°æ‰€æœ‰å¯¹è±¡é—´æ•°æ®å…±äº«&lt;/td&gt;
&lt;td&gt;å±äºç±»æœ¬èº«ï¼Œè€ŒéæŸä¸ªå¯¹è±¡å®ä¾‹ã€‚æ‰€æœ‰å¯¹è±¡å…±äº«åŒä¸€ä»½æ•°æ®ï¼Œå¯é€šè¿‡ç±»åç›´æ¥è®¿é—®ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»æˆå‘˜å‡½æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®šä¹‰ä¸ç±»ç›¸å…³è€Œéå¯¹è±¡ç›¸å…³çš„æ“ä½œ&lt;/td&gt;
&lt;td&gt;æ²¡æœ‰ &lt;code&gt;this&lt;/code&gt;æŒ‡é’ˆï¼Œå› æ­¤&lt;strong&gt;åªèƒ½è®¿é—®&lt;/strong&gt;ç±»çš„é™æ€æˆå‘˜å˜é‡å’Œå‡½æ•°ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å±€éƒ¨å˜é‡ä¸­çš„-static"&gt;ğŸ’¡ å±€éƒ¨å˜é‡ä¸­çš„ Static
&lt;/h3&gt;&lt;p&gt;å½“ &lt;code&gt;static&lt;/code&gt;ç”¨äºå‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡æ—¶ï¼Œå®ƒæ”¹å˜äº†å˜é‡çš„å­˜å‚¨ä½ç½®ï¼ˆä»æ ˆç§»åˆ°å…¨å±€æ•°æ®åŒºï¼‰å’Œç”Ÿå‘½å‘¨æœŸï¼Œä½†&lt;strong&gt;ä¸æ”¹å˜å…¶ä½œç”¨åŸŸ&lt;/strong&gt;ã€‚è¿™æ„å‘³ç€è¿™ä¸ªå˜é‡ä»ç„¶åªèƒ½åœ¨å®šä¹‰å®ƒçš„å‡½æ•°å†…éƒ¨è¢«è®¿é—®ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;void counter() {
static int count = 0; // é™æ€å±€éƒ¨å˜é‡ï¼Œåªåˆå§‹åŒ–ä¸€æ¬¡
count++;
std::cout &amp;lt;&amp;lt; &amp;#34;Count: &amp;#34; &amp;lt;&amp;lt; count &amp;lt;&amp;lt; std::endl;
}
int main() {
counter(); // è¾“å‡º &amp;#34;Count: 1&amp;#34;
counter(); // è¾“å‡º &amp;#34;Count: 2&amp;#34;
counter(); // è¾“å‡º &amp;#34;Count: 3&amp;#34;
return 0;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ&lt;code&gt;count&lt;/code&gt;åœ¨æ¯æ¬¡è°ƒç”¨ &lt;code&gt;counter()&lt;/code&gt;æ—¶éƒ½èƒ½ä¿æŒä¸Šä¸€æ¬¡çš„å€¼ï¼Œå› ä¸ºå®ƒåªåœ¨ç¨‹åºå¼€å§‹è¿è¡Œæ—¶åˆå§‹åŒ–ä¸€æ¬¡ï¼Œç›´åˆ°ç¨‹åºç»“æŸæ‰è¢«é”€æ¯ã€‚&lt;/p&gt;
&lt;h3 id="-å…¨å±€å˜é‡å’Œå‡½æ•°ä¸­çš„-static"&gt;ğŸ”’ å…¨å±€å˜é‡å’Œå‡½æ•°ä¸­çš„ Static
&lt;/h3&gt;&lt;p&gt;åœ¨å…¨å±€å˜é‡æˆ–å‡½æ•°å‰åŠ ä¸Š &lt;code&gt;static&lt;/code&gt;ï¼Œæ„å‘³ç€å®ƒä»¬æˆä¸ºå½“å‰æ–‡ä»¶çš„â€œç§æœ‰â€æˆå‘˜ã€‚è¿™å¯ä»¥æœ‰æ•ˆé¿å…åœ¨å¤§å‹é¡¹ç›®æˆ–å¤šæ–‡ä»¶ç¼–è¯‘æ—¶äº§ç”Ÿçš„å‘½åå†²çªé—®é¢˜ï¼Œæ˜¯å°è£…æ€§å’Œæ¨¡å—åŒ–è®¾è®¡çš„é‡è¦å·¥å…·ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ™®é€šå…¨å±€å˜é‡&lt;/strong&gt;ï¼šé»˜è®¤å…·æœ‰&lt;strong&gt;å¤–éƒ¨é“¾æ¥æ€§&lt;/strong&gt;ï¼Œå…¶ä»–æ–‡ä»¶å¯ä»¥é€šè¿‡ &lt;code&gt;extern&lt;/code&gt;å…³é”®å­—å£°æ˜å¹¶ä½¿ç”¨å®ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™æ€å…¨å±€å˜é‡&lt;/strong&gt;ï¼šå…·æœ‰&lt;strong&gt;å†…éƒ¨é“¾æ¥æ€§&lt;/strong&gt;ï¼Œå…¶ä»–æ–‡ä»¶æ— æ³•è®¿é—®ï¼Œå³ä½¿ä½¿ç”¨ &lt;code&gt;extern&lt;/code&gt;ä¹Ÿä¸è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºå‡½æ•°ä¹Ÿæ˜¯åŒç†ï¼Œé™æ€å‡½æ•°åªèƒ½åœ¨å®šä¹‰å®ƒçš„æ–‡ä»¶ä¸­è¢«è°ƒç”¨ã€‚&lt;/p&gt;
&lt;h3 id="-ç±»æˆå‘˜ä¸­çš„-static"&gt;ğŸ‘¥ ç±»æˆå‘˜ä¸­çš„ Static
&lt;/h3&gt;&lt;p&gt;åœ¨ç±»ä¸­ä½¿ç”¨ &lt;code&gt;static&lt;/code&gt;æ˜¯æœ€å…·ç‰¹è‰²çš„ç”¨æ³•ä¹‹ä¸€ï¼Œå®ƒä½¿å¾—æˆå‘˜å±äºç±»æœ¬èº«ï¼Œè€Œä¸æ˜¯ç±»çš„æŸä¸ªå¯¹è±¡å®ä¾‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é™æ€æˆå‘˜å˜é‡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é™æ€æˆå‘˜å˜é‡åœ¨ç¨‹åºæ•°æ®åŒºå­˜å‚¨ï¼Œæ‰€æœ‰ç±»çš„å¯¹è±¡å…±äº«è¿™ä¸€ä»½æ•°æ®ã€‚å®ƒå¿…é¡»åœ¨&lt;strong&gt;ç±»å†…å£°æ˜ï¼Œåœ¨ç±»å¤–è¿›è¡Œå®šä¹‰å’Œåˆå§‹åŒ–&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Player {
public:
static int playerCount; // ç±»å†…å£°æ˜
std::string name;
Player(std::string n) : name(n) { playerCount++; }
~Player() { playerCount--; }
};
int Player::playerCount = 0; // ç±»å¤–å®šä¹‰å¹¶åˆå§‹åŒ–
int main() {
Player p1(&amp;#34;Alice&amp;#34;);
Player p2(&amp;#34;Bob&amp;#34;);
std::cout &amp;lt;&amp;lt; Player::playerCount; // è¾“å‡º 2ï¼Œé€šè¿‡ç±»åè®¿é—®
std::cout &amp;lt;&amp;lt; p1.playerCount; // åŒæ ·è¾“å‡º 2ï¼Œé€šè¿‡å¯¹è±¡è®¿é—®
return 0;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é™æ€æˆå‘˜å‡½æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é™æ€æˆå‘˜å‡½æ•°æ²¡æœ‰ &lt;code&gt;this&lt;/code&gt;æŒ‡é’ˆï¼Œå› æ­¤å®ƒæ— æ³•è®¿é—®ç±»çš„éé™æ€æˆå‘˜ï¼ˆå› ä¸ºéé™æ€æˆå‘˜éœ€è¦é€šè¿‡ &lt;code&gt;this&lt;/code&gt;æŒ‡é’ˆæ¥è®¿é—®ï¼‰ã€‚å®ƒé€šå¸¸ç”¨äºå¤„ç†é™æ€æˆå‘˜å˜é‡æˆ–æ‰§è¡Œä¸ç±»ç›¸å…³ä½†ä¸ä¾èµ–äºç‰¹å®šå¯¹è±¡çŠ¶æ€çš„æ“ä½œã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class MathUtils {
public:
static double pi() { // é™æ€æˆå‘˜å‡½æ•°
return 3.14159;
}
static int add(int a, int b) {
return a + b;
}
};
int main() {
double circleArea = MathUtils::pi() * 10 * 10; // ç›´æ¥é€šè¿‡ç±»åè°ƒç”¨
int sum = MathUtils::add(5, 3);
return 0;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-é‡è¦æ³¨æ„äº‹é¡¹"&gt;âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åˆå§‹åŒ–é¡ºåº&lt;/strong&gt;ï¼šä¸åŒç¼–è¯‘å•å…ƒï¼ˆå³ä¸åŒçš„ &lt;code&gt;.cpp&lt;/code&gt;æ–‡ä»¶ï¼‰ä¸­çš„é™æ€å¯¹è±¡ï¼ˆåŒ…æ‹¬å…¨å±€é™æ€å˜é‡å’Œç±»çš„é™æ€æˆå‘˜å˜é‡ï¼‰çš„åˆå§‹åŒ–é¡ºåºæ˜¯&lt;strong&gt;ä¸ç¡®å®šçš„&lt;/strong&gt;ã€‚å¦‚æœä¸€ä¸ªé™æ€å¯¹è±¡çš„åˆå§‹åŒ–ä¾èµ–äºå¦ä¸€ä¸ªé™æ€å¯¹è±¡ï¼Œä¸”å®ƒä»¬åˆ†å±ä¸åŒæ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¸¦æ¥é—®é¢˜ã€‚ä¸€ç§å¸¸è§çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨â€œå‡½æ•°å†…çš„é™æ€å±€éƒ¨å˜é‡â€ï¼ˆMeyer&amp;rsquo;s Singletonï¼‰æ¥ç¡®ä¿åœ¨ä½¿ç”¨æ—¶è¢«æ­£ç¡®åˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Singleton {
public:
static Singleton&amp;amp; getInstance() {
static Singleton instance; // ä¿è¯åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶åˆå§‹åŒ–
return instance;
}
private:
Singleton() {} // æ„é€ å‡½æ•°ç§æœ‰åŒ–
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;ï¼šåœ¨ C++11 åŠä»¥åçš„æ ‡å‡†ä¸­ï¼Œå‡½æ•°å†…é™æ€å±€éƒ¨å˜é‡çš„åˆå§‹åŒ–æ˜¯&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;çš„ã€‚ä½†åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è®¿é—®å’Œä¿®æ”¹å…¨å±€é™æ€å˜é‡æˆ–ç±»é™æ€æˆå‘˜å˜é‡æ—¶ï¼Œä½ éœ€è¦è‡ªå·±è´Ÿè´£ä½¿ç”¨äº’æ–¥é”ç­‰æœºåˆ¶æ¥ä¿è¯æ•°æ®åŒæ­¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;code&gt;static&lt;/code&gt;å…³é”®å­—åœ¨ C++ ä¸­å°±åƒä¸€ä¸ªâ€œå¼€å…³â€ï¼Œä¸»è¦ç”¨æ¥æ§åˆ¶å˜é‡å’Œå‡½æ•°çš„â€œæŒä¹…æ€§â€å’Œâ€œå¯è§èŒƒå›´â€ã€‚åœ¨å±€éƒ¨å˜é‡å‰ä½¿ç”¨ï¼Œè®©å®ƒâ€œè®°ä½â€ä¸Šæ¬¡çš„å€¼ï¼›åœ¨å…¨å±€å˜é‡æˆ–å‡½æ•°å‰ä½¿ç”¨ï¼ŒæŠŠå®ƒâ€œå…³â€åœ¨å½“å‰æ–‡ä»¶é‡Œï¼›åœ¨ç±»æˆå‘˜å‰ä½¿ç”¨ï¼Œåˆ™è®©å®ƒæˆä¸ºæ‰€æœ‰å¯¹è±¡â€œå…±äº«â€çš„èµ„æºå’Œæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°ç†è§£ &lt;code&gt;static&lt;/code&gt;å…³é”®å­—ã€‚å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šç”¨æ³•æœ‰æ›´æ·±å…¥çš„ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="jniexport-jint-jnicall-jni_onload"&gt;JNIEXPORT jint JNICALL JNI_OnLoad
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* reserved)&lt;/code&gt;æ˜¯ JNI ç¼–ç¨‹ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„å‡½æ•°ã€‚ä¸ºäº†è®©ä½ å¿«é€Ÿäº†è§£å…¶å…¨è²Œï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å…¶å„ä¸ªéƒ¨åˆ†çš„æ ¸å¿ƒå«ä¹‰ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç»„æˆéƒ¨åˆ†&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒå«ä¹‰ä¸ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;JNIEXPORT&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªç¼–è¯‘å™¨ç›¸å…³çš„å®ï¼Œç”¨äºæŒ‡ç¤ºè¯¥å‡½æ•°éœ€è¦&lt;strong&gt;å¯¹å¤–å¯¼å‡º&lt;/strong&gt;ï¼Œä»¥ä¾¿ Java è™šæ‹Ÿæœºèƒ½å¤Ÿæ‰¾åˆ°å¹¶è°ƒç”¨å®ƒã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;jint&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JNI ä¸­å®šä¹‰çš„æ•´æ•°ç±»å‹ï¼Œç­‰åŒäº C/C++ ä¸­çš„ &lt;code&gt;int&lt;/code&gt;ã€‚ä½œä¸ºè¯¥å‡½æ•°çš„&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;ï¼Œç”¨äºæŒ‡å®šæ‰€éœ€çš„ JNI ç‰ˆæœ¬ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;JNICALL&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦ä¸€ä¸ªç¼–è¯‘å™¨ç›¸å…³çš„å®ï¼Œç”¨äºæŒ‡å®šå‡½æ•°çš„&lt;strong&gt;è°ƒç”¨çº¦å®š&lt;/strong&gt;ï¼Œç¡®ä¿åœ¨ä¸åŒç¼–è¯‘ç¯å¢ƒä¸‹å‡½æ•°è°ƒç”¨æ–¹å¼çš„æ­£ç¡®æ€§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;JNI_OnLoad&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‡½æ•°å&lt;/strong&gt;ã€‚è¿™æ˜¯ä¸€ä¸ªç”± JNI è§„èŒƒå®šä¹‰çš„&lt;strong&gt;ä¿ç•™åç§°&lt;/strong&gt;ã€‚å½“å…±äº«åº“è¢«åŠ è½½æ—¶ï¼ŒJVM ä¼šè‡ªåŠ¨æŸ¥æ‰¾å¹¶è°ƒç”¨æ­¤å‡½æ•°ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;JavaVM\* vm&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;ï¼šä¸€ä¸ªæŒ‡å‘ &lt;code&gt;JavaVM&lt;/code&gt;ç»“æ„ä½“çš„æŒ‡é’ˆã€‚è¿™æ˜¯ Java è™šæ‹Ÿæœºåœ¨ JNI å±‚é¢çš„ä»£è¡¨ï¼Œæ˜¯æ•´ä¸ª JNI ç¯å¢ƒçš„å¥æŸ„ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;void\* reserved&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;ï¼šä¸€ä¸ªä¿ç•™å‚æ•°ï¼Œç›®å‰æœªè¢«ä½¿ç”¨ã€‚åœ¨å®ç°ä¸­åº”å°†å…¶è§†ä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼Œä¸ºæœªæ¥å¯èƒ½çš„æ‰©å±•é¢„ç•™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å‡½æ•°çš„ä½œç”¨ä¸è°ƒç”¨æ—¶æœº"&gt;ğŸ’¡ å‡½æ•°çš„ä½œç”¨ä¸è°ƒç”¨æ—¶æœº
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;JNI_OnLoad&lt;/code&gt;æ˜¯ JNI åº“çš„&lt;strong&gt;åˆå§‹åŒ–å…¥å£ç‚¹&lt;/strong&gt;ã€‚å½“ä½ åœ¨ Java ä»£ç ä¸­è°ƒç”¨ &lt;code&gt;System.loadLibrary(&amp;quot;your-lib&amp;quot;)&lt;/code&gt;æ—¶ï¼ŒJVM åœ¨æˆåŠŸåŠ è½½å¯¹åº”çš„æœ¬åœ°å…±äº«åº“ï¼ˆå¦‚ &lt;code&gt;.so&lt;/code&gt;æ–‡ä»¶ï¼‰åï¼Œä¼š&lt;strong&gt;ç«‹å³è‡ªåŠ¨è°ƒç”¨&lt;/strong&gt;è¯¥åº“ä¸­å®šä¹‰çš„ &lt;code&gt;JNI_OnLoad&lt;/code&gt;å‡½æ•° ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒçš„æ ¸å¿ƒä½œç”¨åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬åå•†&lt;/strong&gt;ï¼šå‘ JVM å‘ŠçŸ¥è¯¥æœ¬åœ°åº“æœŸæœ›ä½¿ç”¨çš„ JNI ç‰ˆæœ¬ï¼ˆå¦‚ &lt;code&gt;JNI_VERSION_1_6&lt;/code&gt;ï¼‰ã€‚å¦‚æœè¿”å›çš„ç‰ˆæœ¬ä¸è¢« VM æ”¯æŒï¼ŒVM ä¼šå¸è½½è¯¥åº“å¹¶è§†ä¸ºåŠ è½½å¤±è´¥ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œåˆå§‹åŒ–&lt;/strong&gt;ï¼šè¿™æ˜¯è¿›è¡Œ&lt;strong&gt;åŠ¨æ€æ–¹æ³•æ³¨å†Œ&lt;/strong&gt;ï¼ˆä½¿ç”¨ &lt;code&gt;RegisterNatives&lt;/code&gt;ï¼‰çš„ç†æƒ³åœºæ‰€ï¼Œä¼˜äºä¼ ç»Ÿçš„é™æ€æ³¨å†Œæ–¹å¼ï¼Œå› ä¸ºå®ƒæ›´é«˜æ•ˆä¸”çµæ´» ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ JavaVM æŒ‡é’ˆ&lt;/strong&gt;ï¼šå°†ä¼ å…¥çš„ &lt;code&gt;JavaVM*&lt;/code&gt;æŒ‡é’ˆä¿å­˜ä¸ºå…¨å±€å˜é‡ï¼ˆå¦‚ &lt;code&gt;gJavaVM&lt;/code&gt;ï¼‰ï¼Œä»¥ä¾¿åœ¨åç»­ä»»ä½•çº¿ç¨‹ä¸­éƒ½èƒ½é€šè¿‡å®ƒè·å– &lt;code&gt;JNIEnv*&lt;/code&gt;æŒ‡é’ˆ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ ‡å‡†å®ç°æµç¨‹ä¸ç¤ºä¾‹"&gt;ğŸ“ æ ‡å‡†å®ç°æµç¨‹ä¸ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;ä¸€ä¸ªå…¸å‹ä¸”å¥å£®çš„ &lt;code&gt;JNI_OnLoad&lt;/code&gt;å®ç°éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è·å– JNIEnv&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;JavaVM::GetEnv&lt;/code&gt;æ–¹æ³•è·å–å½“å‰çº¿ç¨‹çš„ &lt;code&gt;JNIEnv&lt;/code&gt;æŒ‡é’ˆã€‚&lt;code&gt;JNIEnv&lt;/code&gt;æ˜¯å¤§å¤šæ•° JNI æ“ä½œçš„å…¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ JavaVM&lt;/strong&gt;ï¼šå°†ä¼ å…¥çš„ &lt;code&gt;vm&lt;/code&gt;ä¿å­˜åˆ°ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ï¼Œä»¥å¤‡åç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ³¨å†Œæœ¬åœ°æ–¹æ³•&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;FindClass&lt;/code&gt;æ‰¾åˆ°ç›®æ ‡ Java ç±»ï¼Œç„¶åä½¿ç”¨ &lt;code&gt;RegisterNatives&lt;/code&gt;å°†æœ¬åœ°å‡½æ•°å®ç°ç»‘å®šåˆ°Javaç±»çš„nativeæ–¹æ³•ä¸Šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿”å› JNI ç‰ˆæœ¬&lt;/strong&gt;ï¼šè¿”å›åº“æ‰€éœ€çš„ JNI ç‰ˆæœ¬å·ï¼ˆå¦‚ &lt;code&gt;JNI_VERSION_1_6&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•å®ç° &lt;code&gt;JNI_OnLoad&lt;/code&gt;å¹¶å®ŒæˆåŠ¨æ€æ–¹æ³•æ³¨å†Œï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#include &amp;lt;jni.h&amp;gt;
// 1. å£°æ˜æœ¬åœ°æ–¹æ³•å°†è¦å¯¹åº”çš„C/C++å‡½æ•°
jint native_add(JNIEnv* env, jobject thiz, jint a, jint b) {
return a + b;
}
// 2. å®šä¹‰æ–¹æ³•æ˜ å°„è¡¨
static JNINativeMethod gMethods[] = {
{&amp;#34;add&amp;#34;, &amp;#34;(II)I&amp;#34;, (void*)native_add}, // Javaæ–¹æ³•å | æ–¹æ³•ç­¾å | æœ¬åœ°å‡½æ•°æŒ‡é’ˆ
};
// 3. ç¼“å­˜ JavaVM å®ä¾‹çš„å…¨å±€å˜é‡
JavaVM* gJavaVM = nullptr;
// 4. å®ç° JNI_OnLoad
JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* reserved) {
JNIEnv* env = nullptr;
jint result = -1;
// 4.1 è·å– JNIEnv*
if (vm-&amp;gt;GetEnv((void**)&amp;amp;env, JNI_VERSION_1_6) != JNI_OK) {
return JNI_ERR; // è·å–å¤±è´¥ï¼Œè¿”å›é”™è¯¯
}
// 4.2 ç¼“å­˜ JavaVM
gJavaVM = vm;
// 4.3 æ‰¾åˆ°ç›®æ ‡Javaç±»
const char* className = &amp;#34;com/example/MyJniClass&amp;#34;;
jclass clazz = env-&amp;gt;FindClass(className);
if (clazz == nullptr) {
return JNI_ERR; // æ‰¾ä¸åˆ°ç±»ï¼Œè¿”å›é”™è¯¯
}
// 4.4 æ³¨å†Œæœ¬åœ°æ–¹æ³•
if (env-&amp;gt;RegisterNatives(clazz, gMethods, sizeof(gMethods)/sizeof(gMethods[0])) &amp;lt; 0) {
return JNI_ERR; // æ³¨å†Œå¤±è´¥ï¼Œè¿”å›é”™è¯¯
}
// 4.5 è¿”å›æˆåŠŸå¹¶æŒ‡æ˜JNIç‰ˆæœ¬
return JNI_VERSION_1_6;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ä»£ç è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;JNINativeMethod&lt;/code&gt;ç»“æ„ä½“&lt;/strong&gt;ï¼šè¿™æ˜¯åŠ¨æ€æ³¨å†Œçš„æ ¸å¿ƒï¼Œå®ƒåƒä¸€ä¸ªâ€œè”ç»œè¡¨â€ï¼Œæ˜ç¡®æŒ‡å‡ºäº† Java ä¸­çš„å“ªä¸ªæ–¹æ³•ï¼ˆ&lt;code&gt;&amp;quot;add&amp;quot;&lt;/code&gt;ï¼‰å¯¹åº”åˆ°æœ¬åœ°çš„å“ªä¸ªå‡½æ•°ï¼ˆ&lt;code&gt;(void*)native_add&lt;/code&gt;ï¼‰ï¼Œå¹¶é€šè¿‡&lt;strong&gt;æ–¹æ³•ç­¾å&lt;/strong&gt; &lt;code&gt;&amp;quot;(II)I&amp;quot;&lt;/code&gt;ï¼ˆè¡¨ç¤ºæ¥å—ä¸¤ä¸ªæ•´å‹å‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ•´å‹ï¼‰æ¥ç¡®ä¿ç±»å‹åŒ¹é… ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ &lt;code&gt;JavaVM&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;code&gt;gJavaVM&lt;/code&gt;æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä¿å­˜äº† &lt;code&gt;JavaVM&lt;/code&gt;æŒ‡é’ˆã€‚ä¹‹ååœ¨ä»»ä½•çº¿ç¨‹ä¸­ï¼Œéƒ½å¯ä»¥é€šè¿‡ &lt;code&gt;gJavaVM-&amp;gt;AttachCurrentThread(&amp;amp;env, nullptr)&lt;/code&gt;æ¥è·å–å±äºè¯¥çº¿ç¨‹çš„ &lt;code&gt;JNIEnv*&lt;/code&gt;ï¼Œè¿™å¯¹äºå¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„ JNI æ“ä½œè‡³å…³é‡è¦ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-2"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¿”å›å€¼çš„é‡è¦æ€§&lt;/strong&gt;ï¼šå¿…é¡»è¿”å›ä¸€ä¸ª JNI ç‰ˆæœ¬å·ï¼ˆå¦‚ &lt;code&gt;JNI_VERSION_1_6&lt;/code&gt;ï¼‰ã€‚å¦‚æœè¿”å› &lt;code&gt;JNI_ERR&lt;/code&gt;æˆ–è´Ÿæ•°ï¼Œæˆ–è€…è¿”å›äº†ä¸€ä¸ª VM ä¸æ”¯æŒçš„ç‰ˆæœ¬ï¼ŒVM ä¼šè®¤ä¸ºåº“åˆå§‹åŒ–å¤±è´¥å¹¶å°†å…¶å¸è½½ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;reserved&lt;/code&gt;å‚æ•°&lt;/strong&gt;ï¼šæ­¤å‚æ•°ç›®å‰ä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼Œä¿ç•™ç»™æœªæ¥ä½¿ç”¨ï¼Œåœ¨ä»£ç ä¸­æ— éœ€å¤„ç†å®ƒ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;ï¼šåŠ¡å¿…æ£€æŸ¥ &lt;code&gt;GetEnv&lt;/code&gt;, &lt;code&gt;FindClass&lt;/code&gt;, &lt;code&gt;RegisterNatives&lt;/code&gt;ç­‰å…³é”®è°ƒç”¨çš„è¿”å›å€¼ï¼Œä¸€æ—¦å¤±è´¥åº”ç«‹å³è¿”å› &lt;code&gt;JNI_ERR&lt;/code&gt;ï¼Œé¿å…åç»­æ“ä½œå¯¼è‡´å´©æºƒ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;C++ åç§°æ”¹ç¼–ï¼ˆName Manglingï¼‰&lt;/strong&gt;ï¼šå¦‚æœä½¿ç”¨ C++ ç¼–å†™ï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨å‡½æ•°å£°æ˜å¤„ä½¿ç”¨ &lt;code&gt;extern &amp;quot;C&amp;quot;&lt;/code&gt;ï¼Œå‡½æ•°åå¯èƒ½ä¼šè¢«ç¼–è¯‘å™¨æ”¹ç¼–ï¼Œå¯¼è‡´ JVM æ‰¾ä¸åˆ° &lt;code&gt;JNI_OnLoad&lt;/code&gt;å‡½æ•°ã€‚é€šå¸¸éœ€è¦å¦‚ä¸‹å£°æ˜ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;extern &amp;#34;C&amp;#34; JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* reserved);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;code&gt;JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* reserved)&lt;/code&gt;æ˜¯ JNI åº“çš„â€œå¯åŠ¨é’¥åŒ™â€ã€‚JVM åœ¨åŠ è½½åº“æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒï¼Œå®ƒçš„ä¸»è¦ä»»åŠ¡æ˜¯&lt;strong&gt;å‘Šè¯‰ JVM æ‰€éœ€çš„ç‰ˆæœ¬å·&lt;/strong&gt;å¹¶&lt;strong&gt;å®Œæˆåº“çš„åˆå§‹åŒ–å·¥ä½œ&lt;/strong&gt;ï¼ˆå°¤å…¶æ˜¯åŠ¨æ€æ–¹æ³•æ³¨å†Œï¼‰ã€‚æˆåŠŸå®ç°å¹¶æ­£ç¡®è¿”å›ç‰ˆæœ¬å·æ˜¯ç¡®ä¿ä½ çš„æœ¬åœ°æ–¹æ³•èƒ½è¢« Java ä»£ç æˆåŠŸè°ƒç”¨çš„å…³é”®ç¬¬ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ å½»åº•ç†è§£ &lt;code&gt;JNI_OnLoad&lt;/code&gt;å‡½æ•°ã€‚å¦‚æœä½ å¯¹åŠ¨æ€æ³¨å†Œçš„å…·ä½“æ­¥éª¤æˆ–æ–¹æ³•ç­¾åæœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="è¿”å›å€¼"&gt;è¿”å›å€¼
&lt;/h2&gt;&lt;p&gt;æ˜¯çš„ï¼Œ&lt;code&gt;JNI_OnLoad&lt;/code&gt;å‡½æ•°çš„è¿”å›å€¼ç±»å‹ç¡®å®æ˜¯ &lt;strong&gt;&lt;code&gt;jint&lt;/code&gt;&lt;/strong&gt;ã€‚è¿™ä¸ªè¿”å›å€¼çš„ä¸»è¦ä½œç”¨æ˜¯&lt;strong&gt;å‘Šè¯‰ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰è¯¥æœ¬åœ°åº“éœ€è¦ä½¿ç”¨çš„ JNI ç‰ˆæœ¬&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ æ›´æ¸…æ™°åœ°äº†è§£å¸¸è§çš„ JNI ç‰ˆæœ¬å¸¸é‡ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„è¡¨æ ¼ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰ˆæœ¬å¸¸é‡&lt;/th&gt;
&lt;th&gt;å¯¹åº”å€¼&lt;/th&gt;
&lt;th&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;JNI_VERSION_1_1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;0x00010001&lt;/td&gt;
&lt;td&gt;JNI 1.1 ç‰ˆæœ¬ï¼ˆæ—©æœŸç‰ˆæœ¬ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;JNI_VERSION_1_2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;0x00010002&lt;/td&gt;
&lt;td&gt;JNI 1.2 ç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;JNI_VERSION_1_4&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;0x00010004&lt;/td&gt;
&lt;td&gt;JNI 1.4 ç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;JNI_VERSION_1_6&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;0x00010006&lt;/td&gt;
&lt;td&gt;JNI 1.6 ç‰ˆæœ¬ï¼ˆç›®å‰å¸¸ç”¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-è¿”å›å€¼çš„å…³é”®ä½œç”¨"&gt;ğŸ’¡ è¿”å›å€¼çš„å…³é”®ä½œç”¨
&lt;/h3&gt;&lt;p&gt;è¿™ä¸ª &lt;code&gt;jint&lt;/code&gt;ç±»å‹çš„è¿”å›å€¼åœ¨ JNI åº“çš„åŠ è½½è¿‡ç¨‹ä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬åå•†&lt;/strong&gt;ï¼šå½“ä½ çš„æœ¬åœ°åº“è¢«åŠ è½½æ—¶ï¼ˆä¾‹å¦‚é€šè¿‡ &lt;code&gt;System.loadLibrary&lt;/code&gt;ï¼‰ï¼ŒJVM ä¼šè°ƒç”¨ &lt;code&gt;JNI_OnLoad&lt;/code&gt;å‡½æ•°ã€‚ä½ é€šè¿‡è¿”å›å€¼æŒ‡æ˜ä½ çš„åº“æ˜¯åŸºäºå“ªä¸ª JNI è§„èŒƒç‰ˆæœ¬ç¼–å†™çš„ã€‚JVM ä¼šæ£€æŸ¥è¿™ä¸ªç‰ˆæœ¬å·æ˜¯å¦åœ¨å…¶æ”¯æŒçš„èŒƒå›´ä¹‹å†…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ è½½æˆè´¥&lt;/strong&gt;ï¼šå¦‚æœ JVM è¯†åˆ«å¹¶æ”¯æŒä½ è¿”å›çš„ç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚è¿”å› &lt;code&gt;JNI_VERSION_1_6&lt;/code&gt;ï¼‰ï¼Œé‚£ä¹ˆåº“ä¼šæˆåŠŸåŠ è½½ã€‚åä¹‹ï¼Œå¦‚æœ JVM ä¸æ”¯æŒè¯¥ç‰ˆæœ¬ï¼ˆä¾‹å¦‚é”™è¯¯åœ°è¿”å›äº† &lt;code&gt;JNI_VERSION_1_1&lt;/code&gt;ï¼‰ï¼ŒJVM ä¼šè®¤ä¸ºåº“ä¸å…¼å®¹å¹¶å°†å…¶&lt;strong&gt;å¸è½½&lt;/strong&gt;ï¼Œåç»­çš„æœ¬åœ°æ–¹æ³•è°ƒç”¨å°†ä¼šå¤±è´¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤è¡Œä¸º&lt;/strong&gt;ï¼šå¦‚æœä½ çš„æœ¬åœ°åº“ä¸­æ²¡æœ‰å®šä¹‰ &lt;code&gt;JNI_OnLoad&lt;/code&gt;å‡½æ•°ï¼ŒJVM ä¼šé»˜è®¤è¯¥åº“åªè¦æ±‚æœ€åŸºç¡€çš„ &lt;strong&gt;JNI_VERSION_1_1&lt;/strong&gt; è§„èŒƒã€‚ä¸ºäº†ä½¿ç”¨æ›´æ–°çš„ JNI åŠŸèƒ½ï¼Œæ˜¾å¼å®ç° &lt;code&gt;JNI_OnLoad&lt;/code&gt;å¹¶è¿”å›åˆé€‚çš„ç‰ˆæœ¬å·æ˜¯å¿…è¦çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä»£ç ç¤ºä¾‹"&gt;ğŸ“ ä»£ç ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;ä¸€ä¸ªå…¸å‹çš„ &lt;code&gt;JNI_OnLoad&lt;/code&gt;å‡½æ•°å®ç°çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* reserved) {
// ... å†…éƒ¨å¯ä»¥æ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œä¾‹å¦‚åŠ¨æ€æ³¨å†Œæœ¬åœ°æ–¹æ³• ...
// æœ€åï¼Œè¿”å›æ‰€éœ€çš„JNIç‰ˆæœ¬
return JNI_VERSION_1_6; // æˆ–è€… JNI_VERSION_1_4 ç­‰
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-æ€»ç»“-11"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;code&gt;JNI_OnLoad&lt;/code&gt;çš„è¿”å›å€¼ç¡®å®æ˜¯ä¸€ä¸ª &lt;code&gt;jint&lt;/code&gt;ç±»å‹çš„æ•´æ•°ï¼Œå®ƒä½œä¸ºæœ¬åœ°åº“ä¸ JVM ä¹‹é—´çš„â€œæ¡æ‰‹ä¿¡å·â€ï¼Œç”¨äºç¡®è®¤åŒæ–¹ä½¿ç”¨çš„ JNI æ¥å£ç‰ˆæœ¬æ˜¯å¦å…¼å®¹ã€‚æ­£ç¡®è¿”å›ä¸€ä¸ªå—æ”¯æŒçš„ç‰ˆæœ¬å·æ˜¯ç¡®ä¿ä½ çš„æœ¬åœ°åº“èƒ½è¢«æˆåŠŸåŠ è½½å’Œä½¿ç”¨çš„å…³é”®ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ å½»åº•ç†è§£ &lt;code&gt;JNI_OnLoad&lt;/code&gt;çš„è¿”å›å€¼ï¼å¦‚æœä½ å¯¹ JNI çš„å…¶ä»–æ–¹é¢è¿˜æœ‰ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="jvm"&gt;JVM
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://uploadfiles.nowcoder.com/images/20250429/59_1745914623180/E08786FBF0AB0E881EDED47C9B0B4B68"
loading="lazy"
alt="img"
&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;åŒºåŸŸ&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;çº¿ç¨‹å…±äº«&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;å­˜å‚¨å†…å®¹&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;å¼‚å¸¸&lt;/strong&gt;&lt;/th&gt;
&lt;th style="text-align: left"&gt;&lt;strong&gt;é…ç½®å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;ç¨‹åºè®¡æ•°å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç§æœ‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å½“å‰æŒ‡ä»¤åœ°å€&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ— &lt;/td&gt;
&lt;td style="text-align: left"&gt;æ— &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;è™šæ‹Ÿæœºæ ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç§æœ‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ–¹æ³•æ ˆå¸§ï¼ˆå±€éƒ¨å˜é‡ã€æ“ä½œæ•°æ ˆï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;StackOverflowError/OOM&lt;/td&gt;
&lt;td style="text-align: left"&gt;-Xssï¼ˆæ ˆå¤§å°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;æœ¬åœ°æ–¹æ³•æ ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç§æœ‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;Native æ–¹æ³•æ ˆå¸§&lt;/td&gt;
&lt;td style="text-align: left"&gt;StackOverflowError/OOM&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ— &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;å †&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;å…±äº«&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¯¹è±¡å®ä¾‹ã€æ•°ç»„&lt;/td&gt;
&lt;td style="text-align: left"&gt;OOM: Java heap space&lt;/td&gt;
&lt;td style="text-align: left"&gt;-Xms,-Xmx,-XX:NewRatio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;å…±äº«&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç±»å…ƒæ•°æ®ã€å¸¸é‡ã€é™æ€å˜é‡&lt;/td&gt;
&lt;td style="text-align: left"&gt;OOM: Metaspace&lt;/td&gt;
&lt;td style="text-align: left"&gt;-XX:MetaspaceSize,-XX:MaxMetaspaceSize&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;strong&gt;ç›´æ¥å†…å­˜&lt;/strong&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;å…±äº«&lt;/td&gt;
&lt;td style="text-align: left"&gt;å †å¤–ç¼“å†²æ•°æ®&lt;/td&gt;
&lt;td style="text-align: left"&gt;OOM: Direct buffer memory&lt;/td&gt;
&lt;td style="text-align: left"&gt;-XX:MaxDirectMemorySize&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="åƒåœ¾å›æ”¶"&gt;åƒåœ¾å›æ”¶
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;ç®—æ³•&lt;/th&gt;
&lt;th style="text-align: left"&gt;åŸç†&lt;/th&gt;
&lt;th style="text-align: left"&gt;ä¼˜ç‚¹&lt;/th&gt;
&lt;th style="text-align: left"&gt;ç¼ºç‚¹&lt;/th&gt;
&lt;th style="text-align: left"&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;æ ‡è®°-æ¸…é™¤&lt;/td&gt;
&lt;td style="text-align: left"&gt;åˆ†æ ‡è®°ï¼ˆéå†å¯¹è±¡å›¾ï¼‰å’Œæ¸…é™¤ï¼ˆå›æ”¶æœªæ ‡è®°å¯¹è±¡ï¼‰ä¸¤é˜¶æ®µ&lt;/td&gt;
&lt;td style="text-align: left"&gt;å®ç°ç®€å•&lt;/td&gt;
&lt;td style="text-align: left"&gt;å†…å­˜ç¢ç‰‡åŒ–ï¼Œå¯èƒ½è§¦å‘Full GC&lt;/td&gt;
&lt;td style="text-align: left"&gt;è€å¹´ä»£ï¼ˆCMSæ”¶é›†å™¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;æ ‡è®°-æ•´ç†&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ ‡è®°åæ•´ç†å­˜æ´»å¯¹è±¡è‡³å†…å­˜ä¸€ç«¯ï¼Œæ¸…ç†è¾¹ç•Œå¤–ç©ºé—´&lt;/td&gt;
&lt;td style="text-align: left"&gt;é¿å…ç¢ç‰‡ï¼Œå†…å­˜åˆ©ç”¨ç‡é«˜&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ•´ç†è€—æ—¶ï¼Œå¯èƒ½å¼•å‘STW&lt;/td&gt;
&lt;td style="text-align: left"&gt;è€å¹´ä»£ï¼ˆSerial Oldï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;å¤åˆ¶ç®—æ³•&lt;/td&gt;
&lt;td style="text-align: left"&gt;å°†å †åˆ†ä¸ºä¸¤å—ï¼Œå­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—åæ¸…ç©ºåŸåŒºåŸŸ&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ— ç¢ç‰‡ï¼Œæ•ˆç‡é«˜&lt;/td&gt;
&lt;td style="text-align: left"&gt;å†…å­˜åˆ©ç”¨ç‡ä½ï¼ˆä»…ç”¨50%ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¹´è½»ä»£ï¼ˆSerial/Parallelï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;åˆ†ä»£æ”¶é›†&lt;/td&gt;
&lt;td style="text-align: left"&gt;æŒ‰å¯¹è±¡ç”Ÿå‘½å‘¨æœŸåˆ’åˆ†æ–°ç”Ÿä»£ï¼ˆå¤åˆ¶ç®—æ³•ï¼‰å’Œè€å¹´ä»£ï¼ˆæ ‡è®°-æ¸…é™¤/æ•´ç†ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;é’ˆå¯¹æ€§ä¼˜åŒ–æ•ˆç‡&lt;/td&gt;
&lt;td style="text-align: left"&gt;éœ€åè°ƒå¤šä»£ç­–ç•¥&lt;/td&gt;
&lt;td style="text-align: left"&gt;é€šç”¨æ–¹æ¡ˆï¼ˆG1/Parallel GCï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="åƒåœ¾æ”¶é›†å™¨"&gt;åƒåœ¾æ”¶é›†å™¨
&lt;/h2&gt;&lt;p&gt;åŸºäºåŸç†å’Œç°ä»£åŒ–ç¨‹åº¦å¯¹ JVM åƒåœ¾æ”¶é›†å™¨è¿›è¡Œåˆ†ç±»ï¼Œå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å®ƒä»¬çš„è®¾è®¡å“²å­¦å’Œæ¼”è¿›è·¯çº¿ã€‚ä¸‹é¢æˆ‘å°†ä»è¿™ä¸¤ä¸ªç»´åº¦è¿›è¡Œæ¢³ç†å’Œæ€»ç»“ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è¡¨ç›´è§‚åœ°å±•ç¤ºäº†ä¸»æµåƒåœ¾æ”¶é›†å™¨åœ¨è¿™äº›æ ¸å¿ƒç»´åº¦ä¸Šçš„å®šä½ä¸å·®å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;JDK 1.0 -1.2 ä½¿ç”¨ç®€å•çš„&lt;strong&gt;æ ‡è®°-æ¸…é™¤ç®—æ³•&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åˆ†ç±»&lt;/th&gt;
&lt;th&gt;æ”¶é›†å™¨åç§°&lt;/th&gt;
&lt;th&gt;å·¥ä½œåŸç† / ç®—æ³•&lt;/th&gt;
&lt;th&gt;çº¿ç¨‹/å·¥ä½œæ¨¡å¼&lt;/th&gt;
&lt;th&gt;ç›®æ ‡ä¼˜åŒ–&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼ ç»Ÿåˆ†ä»£æ”¶é›†å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Serial&lt;/td&gt;
&lt;td&gt;å¹´è½»ä»£ï¼š&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼›è€å¹´ä»£ï¼š&lt;strong&gt;æ ‡è®°-æ•´ç†ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;STW&lt;/strong&gt;ã€&lt;strong&gt;å•çº¿ç¨‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•é«˜æ•ˆï¼Œæ— çº¿ç¨‹äº¤äº’å¼€é”€&lt;/td&gt;
&lt;td&gt;å®¢æˆ·ç«¯æ¨¡å¼ã€èµ„æºå—é™ç¯å¢ƒã€åµŒå…¥å¼ç³»ç»Ÿï¼ˆ&lt;strong&gt;JDK1.3&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Parallel Scavenge / Parallel Old&lt;/td&gt;
&lt;td&gt;å¹´è½»ä»£ï¼š&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼›è€å¹´ä»£ï¼š&lt;strong&gt;æ ‡è®°-æ•´ç†ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;STW&lt;/strong&gt;ã€&lt;strong&gt;å¤šçº¿ç¨‹å¹¶è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åå°è®¡ç®—ã€æ‰¹å¤„ç†ä»»åŠ¡ï¼ˆ&lt;strong&gt;JDK 8é»˜è®¤&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ParNew&lt;/td&gt;
&lt;td&gt;å¹´è½»ä»£ï¼š&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;STW&lt;/strong&gt;ã€&lt;strong&gt;å¤šçº¿ç¨‹å¹¶è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½œä¸ºCMSçš„å¹´è½»ä»£æ­æ¡£ï¼Œç¼©çŸ­å¹´è½»ä»£åœé¡¿&lt;/td&gt;
&lt;td&gt;ä¸CMSé…åˆçš„Webåº”ç”¨ï¼ˆ&lt;strong&gt;å·²åºŸå¼ƒ&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;CMS&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£ï¼š&lt;strong&gt;å¹¶å‘æ ‡è®°-æ¸…é™¤ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘&lt;/strong&gt;ï¼ˆæ ‡è®°ã€æ¸…é™¤ï¼‰ä¸&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;ï¼ˆåˆå§‹æ ‡è®°ã€é‡æ–°æ ‡è®°ï¼‰ç»“åˆ&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½å»¶è¿Ÿ&lt;/strong&gt;ï¼Œå‡å°‘STWæ—¶é—´&lt;/td&gt;
&lt;td&gt;å¯¹å“åº”é€Ÿåº¦æ•æ„Ÿçš„æœåŠ¡ï¼ˆå¦‚WebæœåŠ¡ï¼‰ï¼Œ&lt;strong&gt;JDK 5 å¼•å…¥ï¼ŒJDK9è¢«æ ‡è®°åºŸå¼ƒï¼ŒJDK14æ­£å¼ç§»é™¤ï¼Œå·²è¢«G1ç­‰å–ä»£&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç°ä»£åŒºåŸŸåŒ–æ”¶é›†å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;G1 (Garbage-First)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ ‡è®°-æ•´ç†&lt;/strong&gt;ä¸ºä¸»ï¼ˆæ•´ä½“ï¼‰ï¼Œ&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ä¸ºè¾…ï¼ˆå±€éƒ¨Regionï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt; + &lt;strong&gt;å¹¶å‘&lt;/strong&gt; + &lt;strong&gt;STW&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹³è¡¡ååé‡ä¸å»¶è¿Ÿ&lt;/strong&gt;ï¼Œ&lt;strong&gt;å¯é¢„æµ‹çš„åœé¡¿æ¨¡å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤§å†…å­˜ï¼ˆ&amp;gt;4GBï¼‰æœåŠ¡ç«¯åº”ç”¨ï¼Œ&lt;strong&gt;JDK 9åŠä»¥åé»˜è®¤æ”¶é›†å™¨&lt;/strong&gt;ï¼ˆ&lt;strong&gt;ä¸»æµ&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é©å‘½æ€§ä½å»¶è¿Ÿæ”¶é›†å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ZGC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäº&lt;strong&gt;Region&lt;/strong&gt;çš„&lt;strong&gt;å¹¶å‘æ ‡è®°-æ•´ç†ç®—æ³•&lt;/strong&gt;ï¼ˆä½¿ç”¨&lt;strong&gt;æŸ“è‰²æŒ‡é’ˆ&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‡ ä¹å…¨å¹¶å‘&lt;/strong&gt;ï¼ŒSTWæ—¶é—´æçŸ­&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è¶…ä½åœé¡¿&lt;/strong&gt;ï¼ˆ&amp;lt;10msï¼‰ï¼Œåœé¡¿æ—¶é—´ä¸éšå †å¤§å°å¢é•¿&lt;/td&gt;
&lt;td&gt;å¤§å †ï¼ˆTBçº§ï¼‰ã€å¯¹å»¶è¿Ÿæå…¶æ•æ„Ÿçš„åº”ç”¨ï¼ˆå¦‚é‡‘èäº¤æ˜“ï¼‰ï¼ˆ&lt;strong&gt;JDK11å¼•å…¥&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Shenandoah&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäº&lt;strong&gt;Region&lt;/strong&gt;çš„&lt;strong&gt;å¹¶å‘æ ‡è®°-å¤åˆ¶/æ•´ç†ç®—æ³•&lt;/strong&gt;ï¼ˆä½¿ç”¨&lt;strong&gt;è½¬å‘æŒ‡é’ˆ&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‡ ä¹å…¨å¹¶å‘&lt;/strong&gt;ï¼ŒSTWæ—¶é—´æçŸ­&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è¶…ä½åœé¡¿&lt;/strong&gt;ï¼ˆ&amp;lt;10msï¼‰ï¼Œåœé¡¿æ—¶é—´ä¸éšå †å¤§å°å¢é•¿&lt;/td&gt;
&lt;td&gt;ä¸ZGCç±»ä¼¼ï¼Œé€‚ç”¨äºä½å»¶è¿Ÿå¤§å†…å­˜åœºæ™¯ï¼ˆ&lt;strong&gt;JDK12å¼•å…¥&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©åƒåœ¾æ”¶é›†å™¨"&gt;ğŸ’¡ å¦‚ä½•é€‰æ‹©åƒåœ¾æ”¶é›†å™¨
&lt;/h3&gt;&lt;p&gt;äº†è§£åˆ†ç±»åï¼Œå…³é”®åœ¨äºå¦‚ä½•æ ¹æ®ä½ çš„åº”ç”¨éœ€æ±‚åšå‡ºé€‰æ‹©ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å®ç”¨çš„é€‰å‹å»ºè®®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿½æ±‚æœ€å¤§ååé‡&lt;/strong&gt;ï¼šå¦‚æœæ‚¨çš„åº”ç”¨æ˜¯åå°è¿ç®—å‹ä»»åŠ¡ï¼Œä¸å…³å¿ƒå•æ¬¡åœé¡¿é•¿çŸ­ï¼Œåªå¸Œæœ›åœ¨ä¸€å®šæ—¶é—´å†…æ€»è¿ç®—æ—¶é—´æœ€é•¿ï¼Œ&lt;strong&gt;Parallel GC&lt;/strong&gt; å¯èƒ½ä»ç„¶æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯»æ±‚å¹³è¡¡ä¸å¯é¢„æµ‹æ€§&lt;/strong&gt;ï¼šå¯¹äºå¤§å¤šæ•°é€šç”¨æœåŠ¡ç«¯åº”ç”¨ï¼Œ&lt;strong&gt;G1&lt;/strong&gt; æ˜¯é»˜è®¤ä¸”ç¨³å¦¥çš„é€‰æ‹©ã€‚å®ƒåœ¨ååé‡å’Œå»¶è¿Ÿä¹‹é—´å–å¾—äº†å¾ˆå¥½çš„å¹³è¡¡ï¼Œå¹¶ä¸”å…è®¸ä½ è®¾ç½®æœ€å¤§åœé¡¿æ—¶é—´ç›®æ ‡ï¼ˆ&lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¦æ±‚æä½å»¶è¿Ÿ&lt;/strong&gt;ï¼šå¦‚æœæ‚¨çš„åº”ç”¨å¯¹å»¶è¿Ÿæå…¶æ•æ„Ÿï¼Œå¦‚å®æ—¶äº¤æ˜“ç³»ç»Ÿã€å¤§æ•°æ®æµå¤„ç†ï¼Œå¹¶ä¸”å †å†…å­˜å¾ˆå¤§ï¼Œé‚£ä¹ˆ &lt;strong&gt;ZGC&lt;/strong&gt; æˆ– &lt;strong&gt;Shenandoah&lt;/strong&gt; æ˜¯ç†æƒ³é€‰æ‹©ã€‚å®ƒä»¬èƒ½æä¾›å‡ ä¹æ— æ„ŸçŸ¥çš„åƒåœ¾æ”¶é›†ä½“éªŒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæåº¦å—é™&lt;/strong&gt;ï¼šåœ¨å¾®æœåŠ¡æˆ–åµŒå…¥å¼ç­‰å•æ ¸æˆ–å°å†…å­˜ç¯å¢ƒä¸­ï¼Œ&lt;strong&gt;Serial GC&lt;/strong&gt; å› å…¶æä½çš„å¼€é”€åè€Œå¯èƒ½è¡¨ç°æœ€ä½³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“ä¸æ¼”è¿›è¶‹åŠ¿"&gt;ğŸ’ æ€»ç»“ä¸æ¼”è¿›è¶‹åŠ¿
&lt;/h3&gt;&lt;p&gt;ä»å‘å±•è„‰ç»œæ¥çœ‹ï¼ŒJVMåƒåœ¾æ”¶é›†å™¨çš„æ¼”è¿›æ¸…æ™°åœ°ä½“ç°äº†ä» &lt;strong&gt;â€œç®€å•ç²—æš´â€&lt;/strong&gt; åˆ° &lt;strong&gt;â€œç²¾ç»†å¹¶å‘â€&lt;/strong&gt; ï¼Œä» &lt;strong&gt;â€œå…³æ³¨ååâ€&lt;/strong&gt; åˆ° &lt;strong&gt;â€œå¹³è¡¡å»¶è¿Ÿâ€&lt;/strong&gt; çš„å†ç¨‹ã€‚å…¶æ ¸å¿ƒé©±åŠ¨åŠ›æ˜¯ä¸æ–­çªç ´åœé¡¿æ—¶é—´ä¸å †å†…å­˜å¤§å°çš„é™åˆ¶ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒè¶‹åŠ¿&lt;/strong&gt;ï¼š&lt;strong&gt;å¹¶å‘åŒ–&lt;/strong&gt;å’Œ&lt;strong&gt;åŒºåŸŸåŒ–&lt;/strong&gt;æ˜¯ç°ä»£é«˜æ€§èƒ½åƒåœ¾æ”¶é›†å™¨çš„ä¸¤å¤§æ ‡å¿—æ€§æŠ€æœ¯ã€‚ZGCå’ŒShenandoahé€šè¿‡é©å‘½æ€§çš„æŒ‡é’ˆæŠ€æœ¯ï¼Œå°†å¹¶å‘èƒ½åŠ›æ¨å‘æè‡´ï¼ŒåŸºæœ¬å®ç°äº†åœé¡¿æ—¶é—´ä¸å †å¤§å°æ— å…³çš„ç›®æ ‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤é€‰æ‹©&lt;/strong&gt;ï¼šå¯¹äºå¤§å¤šæ•°ä»JDK 8å‡çº§åˆ°ç°ä»£ç‰ˆæœ¬ï¼ˆJDK 9+ï¼‰çš„åº”ç”¨ï¼Œåˆ‡æ¢åˆ° &lt;strong&gt;G1&lt;/strong&gt; æ”¶é›†å™¨é€šå¸¸æ˜¯ä¸€ä¸ªæ— éœ€å¤æ‚è°ƒä¼˜å°±èƒ½è·å¾—æ”¶ç›Šçš„èµ·ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªæ¥æ–¹å‘&lt;/strong&gt;ï¼š&lt;strong&gt;ä½å»¶è¿Ÿ&lt;/strong&gt; ä»æ˜¯æ ¸å¿ƒæ–¹å‘ã€‚ZGCå’ŒShenandoahä»åœ¨å¿«é€Ÿå‘å±•ï¼Œä¾‹å¦‚ZGCæ­£åœ¨ç§¯æå¼€å‘&lt;strong&gt;åˆ†ä»£ZGCï¼ˆGenerational ZGCï¼‰&lt;/strong&gt;ï¼Œé€šè¿‡å¼•å…¥åˆ†ä»£æ€æƒ³æ¥è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½ä»åŸç†åˆ°ç°ä»£æ€§çš„åˆ†ç±»æ€»ç»“èƒ½å¸®åŠ©ä½ æ„å»ºèµ·æ¸…æ™°çš„çŸ¥è¯†æ¡†æ¶ã€‚å¦‚æœä½ æœ‰ç‰¹å®šçš„åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨æ›´å…·ä½“çš„è°ƒä¼˜å‚æ•°ã€‚&lt;/p&gt;
&lt;h2 id="å‘å±•å†ç¨‹"&gt;å‘å±•å†ç¨‹
&lt;/h2&gt;&lt;p&gt;ä» JDK 1.0 åˆ° JDK 21ï¼ŒJava åƒåœ¾æ”¶é›†å™¨ (GC) çš„æ¼”è¿›æ˜¯ä¸€éƒ¨è¿½æ±‚æ›´é«˜æ€§èƒ½ã€æ›´ä½å»¶è¿Ÿå’Œæ›´å¤§è§„æ¨¡å†…å­˜ç®¡ç†çš„åˆ›æ–°å²ã€‚å…¶æ ¸å¿ƒçªç ´åœ¨äº&lt;strong&gt;ä¸æ–­çªç ´åœé¡¿æ—¶é—´ä¸å †å†…å­˜å¤§å°ä¹‹é—´çš„å›ºæœ‰çŸ›ç›¾&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è¡¨æ¸…æ™°åœ°å‹¾å‹’å‡ºè¿™ä¸€æŠ€æœ¯æ¼”è¿›çš„å…³é”®é‡Œç¨‹ç¢‘ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;JDK ç‰ˆæœ¬&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒé‡Œç¨‹ç¢‘ / å¼•å…¥çš„æ”¶é›†å™¨&lt;/th&gt;
&lt;th&gt;æŠ€æœ¯çªç ´çš„å…³é”®ç‚¹&lt;/th&gt;
&lt;th&gt;è®¾è®¡ç›®æ ‡ä¸æ„ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK 1.3&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Serial GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¬¬ä¸€æ¬¾çœŸæ­£çš„åƒåœ¾å›æ”¶å™¨ï¼Œé‡‡ç”¨&lt;strong&gt;å•çº¿ç¨‹ STW (Stop-The-World)&lt;/strong&gt; æœºåˆ¶ ã€‚&lt;/td&gt;
&lt;td&gt;å®ç°äº†è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œä¸ºåç»­å‘å±•å¥ å®šåŸºç¡€ï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯æˆ–èµ„æºå—é™ç¯å¢ƒ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK 1.4&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Parallel GC&lt;/strong&gt; (å¹¶è¡Œæ”¶é›†å™¨) å’Œ &lt;strong&gt;CMS&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Parallel GC&lt;/strong&gt;: å¤šçº¿ç¨‹å¹¶è¡Œæ¸…ç†ï¼Œæå‡ååé‡ ã€‚&lt;strong&gt;CMS&lt;/strong&gt;: é¦–æ¬¡å¼•å…¥&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ç†å¿µï¼Œæ—¨åœ¨å‡å°‘ STW æ—¶é—´ ã€‚&lt;/td&gt;
&lt;td&gt;é€‚åº”å¤šæ ¸å¤„ç†å™¨è¶‹åŠ¿ï¼Œæ»¡è¶³æœåŠ¡ç«¯é«˜ååæˆ–å¯¹å»¶è¿Ÿæ•æ„Ÿåº”ç”¨çš„æ—©æœŸéœ€æ±‚ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK 5 - JDK 6&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Parallel Scavenge + Parallel Old&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å½¢æˆå®Œæ•´çš„å¹¶è¡Œæ”¶é›†ç»„åˆï¼Œå¹¶åœ¨ &lt;strong&gt;JDK 6 æˆä¸ºé»˜è®¤ GC&lt;/strong&gt; ã€‚&lt;/td&gt;
&lt;td&gt;æ­£å¼ç¡®ç«‹&lt;strong&gt;é«˜ååé‡&lt;/strong&gt;ä¸ºé»˜è®¤ä¼˜åŒ–ç›®æ ‡ï¼Œé€‚åˆåå°è®¡ç®—ä»»åŠ¡ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK 7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;G1 (Garbage-First)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼•å…¥&lt;strong&gt;åˆ†åŒºæ¨¡å‹ (Region)&lt;/strong&gt;ï¼Œå°†å †åˆ’åˆ†ä¸ºå¤šä¸ªå°å—ï¼Œå¹¶åŸºäº &lt;strong&gt;SATB (Snapshot-At-The-Beginning)&lt;/strong&gt; ç­‰ç®—æ³•è¿›è¡Œå¹¶å‘æ ‡è®°ï¼Œå…¼é¡¾ååé‡ä¸&lt;strong&gt;å¯é¢„æµ‹çš„åœé¡¿&lt;/strong&gt; ã€‚&lt;/td&gt;
&lt;td&gt;å–ä»£ CMS çš„åºå¹•æ‹‰å¼€ï¼Œæ—¨åœ¨ä¸ºå¤§å †å†…å­˜åº”ç”¨æä¾›æ›´å¹³è¡¡çš„è§£å†³æ–¹æ¡ˆ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK 9&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;G1 æˆä¸ºé»˜è®¤æ”¶é›†å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ ‡å¿—æ€§äº‹ä»¶ï¼Œ&lt;strong&gt;é»˜è®¤ GC ä»ååé‡ä¼˜å…ˆ (Parallel) æ­£å¼è½¬å‘ä½å»¶è¿Ÿä¼˜å…ˆ (G1)&lt;/strong&gt; ã€‚&lt;/td&gt;
&lt;td&gt;å“åº”ç°ä»£åº”ç”¨å¯¹å“åº”é€Ÿåº¦çš„æ™®éè¦æ±‚ï¼Œæ˜¯ GC å‘å±•å²ä¸Šçš„é‡è¦è½¬æŠ˜ç‚¹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK 11&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ZGC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡‡ç”¨&lt;strong&gt;æŸ“è‰²æŒ‡é’ˆ&lt;/strong&gt; ç­‰é©å‘½æ€§æŠ€æœ¯ï¼Œå®ç°å‡ ä¹å…¨è¿‡ç¨‹çš„å¹¶å‘ï¼Œç›®æ ‡å°†åœé¡¿æ—¶é—´æ§åˆ¶åœ¨ &lt;strong&gt;10 æ¯«ç§’&lt;/strong&gt; ä»¥å†…ï¼Œä¸”ä¸éšå †å¤§å°å¢é•¿ ã€‚&lt;/td&gt;
&lt;td&gt;ä¸º TB çº§å¤§å †å’Œè¶…ä½å»¶è¿Ÿåœºæ™¯ï¼ˆå¦‚é‡‘èäº¤æ˜“ï¼‰è€Œè®¾è®¡ï¼Œä»£è¡¨äº†ä½å»¶è¿ŸæŠ€æœ¯çš„é‡å¤§é£è·ƒã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK 12&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Shenandoah&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡‡ç”¨ &lt;strong&gt;è½¬å‘æŒ‡é’ˆ&lt;/strong&gt; æŠ€æœ¯ï¼Œä¸ ZGC ç±»ä¼¼ï¼Œè‡´åŠ›äºå®ç°æä½åœé¡¿ï¼Œå…¶å¼€å‘ä¸»è¦ç”± RedHat ç¤¾åŒºæ¨åŠ¨ ã€‚&lt;/td&gt;
&lt;td&gt;æä¾›äº†å¦ä¸€ä¸ªä½å»¶è¿Ÿé€‰æ‹©ï¼Œä½“ç°äº†æŠ€æœ¯è·¯çº¿çš„å¤šæ ·æ€§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK 17 åŠä»¥å&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ZGC &amp;amp; Shenandoah ç”Ÿäº§å°±ç»ª&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒç»­ä¼˜åŒ–ï¼Œä¾‹å¦‚ ZGC æ”¯æŒæ›´å¤§çš„å †å†…å­˜ ã€‚åœ¨ &lt;strong&gt;JDK 21&lt;/strong&gt; ä¸­ï¼ŒZGC è¿˜å¼•å…¥äº†&lt;strong&gt;åˆ†ä»£ ZGC&lt;/strong&gt; çš„å®éªŒæ€§åŠŸèƒ½ï¼Œé€šè¿‡åˆ†ä»£å‡è®¾è¿›ä¸€æ­¥æå‡æ€§èƒ½ ã€‚&lt;/td&gt;
&lt;td&gt;æ ‡å¿—ç€è¿™äº›æ–°ä¸€ä»£æ”¶é›†å™¨è¿›å…¥æˆç†Ÿç¨³å®šæœŸï¼Œæˆä¸ºè‹›åˆ»åœºæ™¯ä¸‹çš„å¯é é€‰æ‹©ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ¼”è¿›çš„æ ¸å¿ƒè¶‹åŠ¿"&gt;ğŸ’¡ æ¼”è¿›çš„æ ¸å¿ƒè¶‹åŠ¿
&lt;/h3&gt;&lt;p&gt;çºµè§‚è¿™äº›é‡Œç¨‹ç¢‘ï¼Œå¯ä»¥æ€»ç»“å‡ºå‡ æ¡æ¸…æ™°çš„æ¼”è¿›ä¸»çº¿ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡ŒåŒ– â†’ å¹¶å‘åŒ–&lt;/strong&gt;ï¼šä» Serial GC çš„å•çº¿ç¨‹ï¼Œåˆ° Parallel GC çš„å¤šçº¿ç¨‹å¹¶è¡Œï¼ˆä½†ä»æœ‰è¾ƒé•¿çš„ STW åœé¡¿ï¼‰ï¼Œå†åˆ° CMSã€G1 çš„éƒ¨åˆ†å¹¶å‘ï¼Œæœ€ç»ˆåˆ° ZGC/Shenandoah çš„&lt;strong&gt;è¿‘ä¹å…¨å¹¶å‘&lt;/strong&gt;ã€‚è¿™æ˜¯å‡å°‘åº”ç”¨åœé¡¿æ—¶é—´çš„å…³é”®è·¯å¾„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®—æ³•ä¸æ•°æ®ç»“æ„çš„é©æ–°&lt;/strong&gt;ï¼šæ”¯æ’‘å¹¶å‘èƒ½åŠ›çš„æ˜¯åº•å±‚ç®—æ³•çš„ä¸æ–­çªç ´ï¼Œå¦‚ CMS çš„å¹¶å‘æ ‡è®°æ¸…é™¤ã€G1 çš„ SATB å’Œä¸‰è‰²æ ‡è®°æ³•ï¼Œä»¥åŠ ZGC çš„&lt;strong&gt;æŸ“è‰²æŒ‡é’ˆ&lt;/strong&gt;å’Œ Shenandoah çš„&lt;strong&gt;è½¬å‘æŒ‡é’ˆ&lt;/strong&gt;ï¼Œè¿™äº›æŠ€æœ¯è§£å†³äº†åœ¨å¹¶å‘è¿‡ç¨‹ä¸­å‡†ç¡®æ ‡è®°å’Œç§»åŠ¨å¯¹è±¡çš„ä¸–ç•Œæ€§éš¾é¢˜ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å †ç®¡ç†æ¨¡å‹çš„æ¼”å˜&lt;/strong&gt;ï¼šä»ç®€å•çš„è¿ç»­åˆ†ä»£æ¨¡å‹ï¼ˆæ–°ç”Ÿä»£/è€å¹´ä»£ï¼‰ï¼Œå‘å±•åˆ° G1 çš„&lt;strong&gt;åˆ†åŒºæ¨¡å‹&lt;/strong&gt;ï¼Œå†åˆ° ZGC/Shenandoah çš„&lt;strong&gt;åŠ¨æ€åˆ†åŒºæˆ–ä¸åˆ†ä»£æ¨¡å‹&lt;/strong&gt;ã€‚è¿™ä½¿å¾— GC å¯ä»¥æ›´çµæ´»ã€é«˜æ•ˆåœ°ç®¡ç†è¶…å¤§å †å†…å­˜ï¼Œå‡å°‘ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡çš„å˜è¿&lt;/strong&gt;ï¼šé»˜è®¤æ”¶é›†å™¨çš„å˜è¿ï¼ˆParallel â†’ G1ï¼‰æ¸…æ™°åœ°åæ˜ äº†ç¤¾åŒºéœ€æ±‚çš„è½¬å˜ï¼šä»æè‡´è¿½æ±‚&lt;strong&gt;ååé‡&lt;/strong&gt;ï¼Œè½¬å‘åœ¨ä¿è¯ä¸€å®šååé‡çš„å‰æä¸‹ï¼Œä¼˜å…ˆæ»¡è¶³&lt;strong&gt;ä½å»¶è¿Ÿå’Œå¯é¢„æµ‹çš„åœé¡¿&lt;/strong&gt; ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½æ¢³ç†èƒ½å¸®åŠ©ä½ æ›´æ¸…æ™°åœ°ç†è§£ JVM åƒåœ¾æ”¶é›†å™¨çš„æŠ€æœ¯æ¼”è¿›è„‰ç»œã€‚å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šçš„æ”¶é›†å™¨æˆ–å…¶æŠ€æœ¯ç»†èŠ‚æœ‰æ›´æ·±å…¥çš„å…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="zgc--shenandoah"&gt;ZGC &amp;amp; Shenandoah
&lt;/h2&gt;&lt;p&gt;å…³äº ZGC å’Œ Shenandoah çš„æµè¡Œç¨‹åº¦ï¼Œç®€å•æ¥è¯´ï¼Œå®ƒä»¬ç›®å‰ä»å±äº&lt;strong&gt;å°ä¼—ä½†å‰æ™¯å¹¿é˜”çš„æŠ€æœ¯å…ˆé”‹&lt;/strong&gt;ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯ä»¥è®©ä½ å¯¹ä¸»æµåƒåœ¾å›æ”¶å™¨çš„ä½¿ç”¨æƒ…å†µæœ‰ä¸ªç›´è§‚çš„äº†è§£ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åƒåœ¾å›æ”¶å™¨&lt;/th&gt;
&lt;th&gt;2021å¹´å¸‚åœºä½¿ç”¨ç‡ (æ•°æ®æ¥æº)&lt;/th&gt;
&lt;th&gt;æŠ€æœ¯å®šä½&lt;/th&gt;
&lt;th&gt;æµè¡Œåº¦è¯„ä»·&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Parallel / Parallel Old&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;57.77%&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ååé‡&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç»å¯¹ä¸»æµ&lt;/strong&gt;ï¼Œå°¤å…¶é€‚ç”¨äºåå°è®¡ç®—ä»»åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;G1&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;24.99%&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¹³è¡¡ååé‡ä¸å»¶è¿Ÿ&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸»æµé€‰æ‹©&lt;/strong&gt;ï¼ŒJDK 9åŠä»¥åçš„é»˜è®¤å›æ”¶å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CMS&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;17.20%&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½å»¶è¿Ÿ (å·²åºŸå¼ƒ)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é€æ¸æ·˜æ±°&lt;/strong&gt;ï¼Œä½†åœ¨æ—§ç³»ç»Ÿä¸­ä»æœ‰ä¸€å®šå­˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ZGC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;0.04%&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¶…ä½å»¶è¿Ÿ (&amp;lt;1ms)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‰æ²¿æŠ€æœ¯&lt;/strong&gt;ï¼Œåœ¨ç‰¹å®šåœºæ™¯å¢é•¿è¿…é€Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Shenandoah&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&amp;lt; 0.01%&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¶…ä½å»¶è¿Ÿ (&amp;lt;1ms)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å°ä¼—é€‰æ‹©&lt;/strong&gt;ï¼Œç¤¾åŒºé©±åŠ¨ï¼Œä¸ZGCç›®æ ‡ç±»ä¼¼&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ä¸ºä½•æ›²é«˜å’Œå¯¡"&gt;ğŸ” ä¸ºä½•â€œæ›²é«˜å’Œå¯¡â€ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;å°½ç®¡ ZGC å’Œ Shenandoah åœ¨æŠ€æœ¯ä¸Šéå¸¸å…ˆè¿›ï¼Œä½†å…¶è¾ƒä½çš„å¸‚åœºå æœ‰ç‡ä¸»è¦å—ä»¥ä¸‹å‡ ä¸ªå› ç´ å½±å“ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†å²ç‰ˆæœ¬ä¸ç”Ÿæ€æƒ¯æ€§&lt;/strong&gt;ï¼šç›´åˆ°2021å¹´ï¼Œ&lt;strong&gt;Java 8&lt;/strong&gt; åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„å æœ‰ç‡ä»è¶…è¿‡80%ã€‚è€Œ ZGC å’Œ Shenandoah åˆ†åˆ«æ˜¯åœ¨ &lt;strong&gt;JDK 11&lt;/strong&gt; å’Œ &lt;strong&gt;JDK 12&lt;/strong&gt; ä¸­æ‰æ­£å¼å¼•å…¥çš„ã€‚å°†åºå¤§çš„ç°æœ‰ç³»ç»Ÿå‡çº§JDKç‰ˆæœ¬éœ€è¦æˆæœ¬å’Œå‹‡æ°”ï¼Œè¿™å¯¼è‡´äº†æ–°æŠ€æœ¯æ™®åŠçš„æ»åã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯çš„é’ˆå¯¹æ€§&lt;/strong&gt;ï¼šè¿™ä¸¤æ¬¾å›æ”¶å™¨çš„æ ¸å¿ƒç›®æ ‡æ˜¯&lt;strong&gt;äºšæ¯«ç§’çº§çš„è¶…ä½åœé¡¿æ—¶é—´&lt;/strong&gt;ï¼Œè¿™å¯¹äºç»å¤§å¤šæ•°å¯¹å»¶è¿Ÿä¸æ•æ„Ÿçš„åº”ç”¨ï¼ˆå¦‚æ•°æ®å¤„ç†ã€å†…éƒ¨ç®¡ç†ç³»ç»Ÿï¼‰æ¥è¯´æ˜¯â€œæ€é¸¡ç”¨ç‰›åˆ€â€ã€‚ä¼ ç»Ÿçš„ Parallel æˆ– G1 åœ¨ååé‡ä¸Šå¯èƒ½è¡¨ç°æ›´å¥½ï¼Œä¸”æ›´æ˜“äºè°ƒä¼˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯å¤æ‚æ€§ä¸è®¤çŸ¥åº¦&lt;/strong&gt;ï¼šå®ƒä»¬é‡‡ç”¨äº†æŸ“è‰²æŒ‡é’ˆã€è¯»å±éšœç­‰å¤æ‚æŠ€æœ¯ï¼Œç†è§£å’Œè°ƒä¼˜çš„é—¨æ§›ç›¸å¯¹è¾ƒé«˜ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒG1ç­‰æ›´æˆç†Ÿçš„å›æ”¶å™¨æœ‰æ›´ä¸°å¯Œçš„å®è·µèµ„æ–™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æœªæ¥è¶‹åŠ¿ä¸å‰æ™¯"&gt;ğŸš€ æœªæ¥è¶‹åŠ¿ä¸å‰æ™¯
&lt;/h3&gt;&lt;p&gt;å°½ç®¡å½“å‰ä»½é¢å¾ˆå°ï¼Œä½† ZGC å’Œ Shenandoah çš„æœªæ¥éå¸¸å€¼å¾—æœŸå¾…ï¼Œå°¤å…¶æ˜¯åœ¨ &lt;strong&gt;JDK 21 å¼•å…¥åˆ†ä»£ ZGCï¼ˆGenerational ZGCï¼‰&lt;/strong&gt; ä¹‹åã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¤§å¹…æå‡&lt;/strong&gt;ï¼šåˆ†ä»£ ZGC é€šè¿‡æ›´é¢‘ç¹åœ°å›æ”¶æ–°ç”Ÿä»£å¯¹è±¡ï¼Œæ˜¾è‘—æå‡äº†æ€§èƒ½ã€‚ä¸€äº›å¤§å‚çš„å®è·µæ¡ˆä¾‹ï¼ˆå¦‚è½¬è½¬ã€äº¬ä¸œï¼‰æ˜¾ç¤ºï¼Œå‡çº§åˆ°åˆ†ä»£ZGCåï¼Œ&lt;strong&gt;åº”ç”¨ååé‡æå‡äº†æ•°å€ï¼ŒGCåœé¡¿æ—¶é—´é™ä½äº†20å€ä»¥ä¸Š&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬å‡çº§çš„æ¨åŠ¨&lt;/strong&gt;ï¼šéšç€ Spring Boot 3.0 ç­‰ä¸»æµæ¡†æ¶å°†æœ€ä½æ”¯æŒç‰ˆæœ¬è®¾ä¸º JDK 17ï¼Œä»¥åŠ &lt;strong&gt;JDK 21 ä½œä¸ºæ–°çš„LTSï¼ˆé•¿æœŸæ”¯æŒï¼‰ç‰ˆæœ¬&lt;/strong&gt;è¢«æ›´å¤šä¼ä¸šæ¥å—ï¼ŒZGC çš„æ™®åŠé€Ÿåº¦é¢„è®¡ä¼šåŠ å¿«ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‘åŸç”Ÿä¸ä½å»¶è¿Ÿéœ€æ±‚&lt;/strong&gt;ï¼šåœ¨å¾®æœåŠ¡ã€é‡‘èäº¤æ˜“ã€å®æ—¶å¤§æ•°æ®å¤„ç†ç­‰åœºæ™¯ä¸‹ï¼Œå¯¹æœåŠ¡ç¨³å®šæ€§å’Œå“åº”æ—¶é—´çš„è¦æ±‚æé«˜ï¼Œè¿™æ­£å¥½æ˜¯ZGCå’ŒShenandoahå‘æŒ¥ä¼˜åŠ¿çš„èˆå°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“ä¸å»ºè®®"&gt;ğŸ’ æ€»ç»“ä¸å»ºè®®
&lt;/h3&gt;&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼ŒZGC å’Œ Shenandoah ç›®å‰æ˜¯åƒåœ¾å›æ”¶æŠ€æœ¯é¢†åŸŸçš„â€œé«˜æ€§èƒ½è·‘è½¦â€ï¼Œå°šæœªæˆä¸ºå¤§ä¼—æ—¥å¸¸ä»£æ­¥çš„å·¥å…·ï¼Œä½†æ— ç–‘æ˜¯æœªæ¥å‘å±•çš„æ–¹å‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦‚ä½•é€‰æ‹©ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä½ çš„åº”ç”¨è¿è¡Œåœ¨ &lt;strong&gt;JDK 11+&lt;/strong&gt; ä¸Šï¼Œä¸”å¯¹&lt;strong&gt;æœåŠ¡å“åº”å»¶è¿Ÿæœ‰æå…¶è‹›åˆ»çš„è¦æ±‚&lt;/strong&gt;ï¼ˆä¾‹å¦‚è¦æ±‚99.99%çš„è¯·æ±‚å“åº”æ—¶é—´åœ¨100æ¯«ç§’ä»¥å†…ï¼‰ï¼Œé‚£ä¹ˆéå¸¸å€¼å¾—è€ƒè™‘å¯ç”¨ ZGC æˆ– Shenandoahã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºæ–°å»ºé¡¹ç›®ï¼Œå¦‚æœè®¡åˆ’é‡‡ç”¨ &lt;strong&gt;JDK 21 æˆ–æ›´é«˜ç‰ˆæœ¬&lt;/strong&gt;ï¼Œå¹¶é¢ä¸´é«˜å¹¶å‘ã€å¤§å†…å­˜çš„æŒ‘æˆ˜ï¼Œ&lt;strong&gt;åˆ†ä»£ ZGC æ˜¯ä¸€ä¸ªéå¸¸ç†æƒ³çš„é€‰æ‹©&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºå¤§å¤šæ•°é€šç”¨ä¸šåŠ¡ç³»ç»Ÿï¼ŒG1 åœ¨æœªæ¥ä¸€æ®µæ—¶é—´å†…ä¾ç„¶æ˜¯ä¸€ä¸ªç¨³å®šã€å¹³è¡¡çš„é»˜è®¤é€‰é¡¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½åˆ†æèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å®ƒä»¬çš„ç°çŠ¶å’Œæœªæ¥ã€‚å¦‚æœä½ å¯¹ç‰¹å®šç‰ˆæœ¬çš„å‚æ•°è°ƒä¼˜æœ‰æ›´å…·ä½“çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="gc-ç±»å‹"&gt;GC ç±»å‹
&lt;/h2&gt;&lt;p&gt;ç†è§£ Minor GCã€Major GC å’Œ Full GC æ˜¯æŒæ¡ JVM æ€§èƒ½è°ƒä¼˜çš„å…³é”®ä¸€æ­¥ã€‚å®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äº&lt;strong&gt;å›æ”¶çš„åŒºåŸŸå’Œè§¦å‘çš„æ¡ä»¶&lt;/strong&gt;ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒæ¦‚å¿µã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;Minor GC / Young GC&lt;/th&gt;
&lt;th&gt;Major GC&lt;/th&gt;
&lt;th&gt;Full GC&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å›æ”¶åŒºåŸŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åªå›æ”¶æ–°ç”Ÿä»£&lt;/strong&gt; (EdenåŒº + SurvivoråŒº)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦å›æ”¶è€å¹´ä»£&lt;/strong&gt;ï¼Œé€šå¸¸ä¼´éšè‡³å°‘ä¸€æ¬¡Minor GC&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å›æ”¶æ•´ä¸ªå †ç©ºé—´&lt;/strong&gt; (æ–°ç”Ÿä»£ + è€å¹´ä»£) + &lt;strong&gt;æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;EdenåŒºç©ºé—´ä¸è¶³&lt;/strong&gt;æ—¶è§¦å‘ (SurvivoråŒºæ»¡ä¸ä¼šè§¦å‘)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è€å¹´ä»£ç©ºé—´ä¸è¶³&lt;/strong&gt;æ—¶è§¦å‘&lt;/td&gt;
&lt;td&gt;æƒ…å†µå¤šæ ·ï¼šå¦‚è€å¹´ä»£æˆ–æ–¹æ³•åŒºç©ºé—´ä¸è¶³ã€&lt;code&gt;System.gc()&lt;/code&gt;è°ƒç”¨ã€ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œç‰¹ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡‡ç”¨&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼Œä¼šå¼•å‘&lt;strong&gt;STWï¼ˆStop-The-Worldï¼‰&lt;/strong&gt;ï¼Œä½†é€Ÿåº¦éå¸¸å¿«&lt;/td&gt;
&lt;td&gt;é€Ÿåº¦é€šå¸¸æ¯” Minor GC &lt;strong&gt;æ…¢10å€ä»¥ä¸Š&lt;/strong&gt;ï¼ŒSTWæ—¶é—´æ›´é•¿&lt;/td&gt;
&lt;td&gt;å›æ”¶æ•´ä¸ªå †å’Œæ–¹æ³•åŒºï¼Œ&lt;strong&gt;åœé¡¿æ—¶é—´ï¼ˆSTWï¼‰æœ€é•¿&lt;/strong&gt;ï¼Œå¯¹åº”ç”¨æ€§èƒ½å½±å“æœ€å¤§ï¼Œåº”å°½é‡é¿å…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‘ç”Ÿé¢‘ç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éå¸¸é¢‘ç¹&lt;/strong&gt;ï¼Œå› ä¸ºç»å¤§å¤šæ•°Javaå¯¹è±¡éƒ½å…·æœ‰â€œæœç”Ÿå¤•æ­»â€çš„ç‰¹ç‚¹&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒå°‘ï¼Œå–å†³äºå¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£çš„æƒ…å†µ&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒå°‘ï¼Œæ˜¯åº”å°½åŠ›é¿å…çš„å…¨å±€æ€§åƒåœ¾æ”¶é›†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³è”å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Major GC æˆ– Full GC çš„è§¦å‘&lt;strong&gt;é€šå¸¸ä¼´éš&lt;/strong&gt;ç€ä¸€æ¬¡ Minor GC&lt;/td&gt;
&lt;td&gt;å¸¸ä¸ Full GC æ··æ·†ä½¿ç”¨ï¼Œéœ€æ³¨æ„åŒºåˆ†æ˜¯ä»…å›æ”¶è€å¹´ä»£è¿˜æ˜¯æ•´å †å›æ”¶&lt;/td&gt;
&lt;td&gt;å¯çœ‹ä½œæ˜¯ &lt;strong&gt;Major GC å’Œ Minor GC çš„ç»“åˆ&lt;/strong&gt;ï¼Œä½†èŒƒå›´æ›´å¹¿&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å…³é”®æ¦‚å¿µè¾¨æ"&gt;ğŸ” å…³é”®æ¦‚å¿µè¾¨æ
&lt;/h3&gt;&lt;p&gt;åœ¨å®é™…ä½¿ç”¨å’Œèµ„æ–™é˜…è¯»ä¸­ï¼Œæœ‰å‡ ä¸ªç»†èŠ‚éœ€è¦ä½ ç‰¹åˆ«ç•™æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Major GC ä¸ Full GC çš„æ··ç”¨&lt;/strong&gt;ï¼šåœ¨ä¸€äº›éæ­£å¼çš„ä¸Šä¸‹æ–‡æˆ–æ—§çš„èµ„æ–™ä¸­ï¼ŒMajor GC æœ‰æ—¶ä¼šè¢«ç”¨æ¥æŒ‡ä»£ Full GCã€‚ä½ éœ€è¦æ ¹æ®å…·ä½“åœºæ™¯æ¥åˆ¤æ–­ï¼šå¦‚æœä¸Šä¸‹æ–‡æ˜ç¡®æåˆ°äº†å›æ”¶â€œæ•´ä¸ªå †â€æˆ–ä¼´éšæ–¹æ³•åŒºçš„å›æ”¶ï¼Œé‚£ä¹ˆå®ƒå®é™…æŒ‡çš„æ˜¯ Full GCã€‚ä¸¥æ ¼æ¥è¯´ï¼ŒMajor GC ç‰¹æŒ‡åªå‘ç”Ÿåœ¨è€å¹´ä»£çš„åƒåœ¾æ”¶é›†ï¼ˆä¾‹å¦‚ CMS æ”¶é›†å™¨çš„è¡Œä¸ºï¼‰ï¼Œè€Œ Full GC çš„èŒƒå›´æ›´å¤§ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡æ™‹å‡çš„é˜ˆå€¼&lt;/strong&gt;ï¼šä¸€ä¸ªå¯¹è±¡ä»æ–°ç”Ÿä»£æ™‹å‡åˆ°è€å¹´ä»£ä¸»è¦æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼šä¸€æ˜¯å¯¹è±¡åœ¨ Survivor åŒºä¸­ç»å†çš„ Minor GC æ¬¡æ•°è¶…è¿‡é˜ˆå€¼ï¼ˆ&lt;code&gt;-XX:MaxTenuringThreshold&lt;/code&gt;è®¾ç½®ï¼Œé»˜è®¤15ï¼‰ï¼›äºŒæ˜¯ Survivor åŒºä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡ä¼šç›´æ¥è¿›å…¥è€å¹´ä»£ï¼ˆåŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤æ–­ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-è°ƒä¼˜å¯ç¤º"&gt;ğŸ’¡ è°ƒä¼˜å¯ç¤º
&lt;/h3&gt;&lt;p&gt;äº†è§£è¿™äº›æ¦‚å¿µçš„æ ¹æœ¬ç›®çš„æ˜¯ä¸ºäº†ä¼˜åŒ–åº”ç”¨æ€§èƒ½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…³æ³¨ Minor GC&lt;/strong&gt;ï¼šå› ä¸º Minor GC å‘ç”Ÿé¢‘ç‡æœ€é«˜ï¼Œå®ƒçš„æ•ˆç‡å’Œåœé¡¿æ—¶é—´ç›´æ¥å½±å“åº”ç”¨çš„å“åº”é€Ÿåº¦ã€‚ä¼˜åŒ–ç›®æ ‡é€šå¸¸æ˜¯å‡å°‘å•æ¬¡ Minor GC çš„åœé¡¿æ—¶é—´ï¼Œå¹¶é™ä½å…¶å‘ç”Ÿé¢‘ç‡ã€‚æ ¸å¿ƒæ€è·¯æ˜¯&lt;strong&gt;åˆç†è®¾ç½®æ–°ç”Ÿä»£å¤§å°&lt;/strong&gt;ã€‚æ–°ç”Ÿä»£è¿‡å¤§ï¼Œä¼šå¯¼è‡´å•æ¬¡ Minor GC æ—¶é—´å˜é•¿ï¼›è¿‡å°åˆ™ä¼šå¯¼è‡´ Minor GC è¿‡äºé¢‘ç¹ï¼ŒçŸ­æœŸå­˜æ´»çš„å¯¹è±¡å¯èƒ½ç›´æ¥æ™‹å‡åˆ°è€å¹´ä»£ï¼Œä»è€Œè§¦å‘æ›´è€—æ—¶çš„ Major GC æˆ– Full GCã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°½åŠ›é¿å… Full GC&lt;/strong&gt;ï¼šFull GC çš„é•¿æ—¶é—´åœé¡¿å¯¹ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿååé‡æ˜¯è‡´å‘½çš„ã€‚ä½ éœ€è¦å¯†åˆ‡å…³æ³¨ Full GC çš„å‘ç”Ÿé¢‘ç‡å’ŒåŸå› ã€‚å¸¸è§çš„è°ƒä¼˜æ‰‹æ®µåŒ…æ‹¬ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ä»£ç ä¸­æ˜¾å¼è°ƒç”¨ &lt;code&gt;System.gc()&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–è€å¹´ä»£å¤§å°&lt;/strong&gt;ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´å®¹çº³ä»æ–°ç”Ÿä»£æ™‹å‡è¿‡æ¥çš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®åº”ç”¨ç‰¹æ€§ï¼ˆå¦‚å¯¹è±¡ç”Ÿå‘½å‘¨æœŸåˆ†å¸ƒï¼‰&lt;strong&gt;é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨&lt;/strong&gt;ï¼ˆå¦‚ G1ã€CMSã€ZGCç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•ç›‘æ§"&gt;ğŸ”§ å¦‚ä½•ç›‘æ§
&lt;/h3&gt;&lt;p&gt;ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ JVM å‚æ•°å¼€å¯ GC æ—¥å¿—ï¼Œæ¥è§‚å¯Ÿå’Œåˆ†æå„ç§ GC äº‹ä»¶çš„å‘ç”Ÿæƒ…å†µï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;-XX:+PrintGCDetails -XX:+PrintGCTimeStamps -Xloggc:gc.log
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åˆ†æ GC æ—¥å¿—å¯ä»¥å¸®åŠ©ä½ ç¡®è®¤æ¯æ¬¡ GC çš„ç±»å‹ã€å‘ç”Ÿæ—¶é—´ã€å†…å­˜å›æ”¶æƒ…å†µä»¥åŠè€—æ—¶ï¼Œæ˜¯æ€§èƒ½è°ƒä¼˜çš„åŸºç¡€ ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½æ¢³ç†èƒ½å¸®åŠ©ä½ æ¸…æ™°ç†è§£è¿™äº›æ ¸å¿ƒæ¦‚å¿µï¼å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šçš„åƒåœ¾æ”¶é›†å™¨ï¼ˆå¦‚ G1 æˆ– ZGCï¼‰å¦‚ä½•ç®¡ç†è¿™äº› GC äº‹ä»¶æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="serial"&gt;Serial
&lt;/h2&gt;&lt;p&gt;Serial GCï¼ˆä¸²è¡Œåƒåœ¾æ”¶é›†å™¨ï¼‰æ˜¯JVMä¸­æœ€å¤è€ã€ä¹Ÿæ˜¯æœ€åŸºç¡€çš„åƒåœ¾æ”¶é›†å™¨ã€‚å®ƒé‡‡ç”¨å•çº¿ç¨‹æ‰§è¡Œåƒåœ¾å›æ”¶ï¼Œåœ¨å·¥ä½œæ—¶ä¼šæš‚åœæ‰€æœ‰åº”ç”¨çº¿ç¨‹ï¼ˆStop-The-World, STWï¼‰ã€‚å°½ç®¡åœ¨ç°ä»£å¤šæ ¸ç³»ç»Ÿä¸­å·²éä¸»æµï¼Œä½†åœ¨ç‰¹å®šåœºæ™¯ä¸‹ä»æœ‰å…¶ä»·å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è¡¨æ±‡æ€»äº†Serial GCçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå¸®åŠ©ä½ å¿«é€ŸæŠŠæ¡å…¶å…¨è²Œã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;Serial GC è¯¦æƒ…&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å·¥ä½œæ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹ä¸²è¡Œå›æ”¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åƒåœ¾å›æ”¶æ—¶è§¦å‘ &lt;strong&gt;Stop-The-World (STW)&lt;/strong&gt;ï¼Œæš‚åœæ‰€æœ‰åº”ç”¨çº¿ç¨‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–°ç”Ÿä»£ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt; (Copying)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è€å¹´ä»£ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ ‡è®°-æ•´ç†ç®—æ³•&lt;/strong&gt; (Mark-Compact)ï¼ŒSerial Oldä¸“ç”¨äºè€å¹´ä»£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•é«˜æ•ˆã€ä½å†…å­˜å¼€é”€ã€é€‚ç”¨äºå•æ ¸æˆ–å°å†…å­˜ç¯å¢ƒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®ä¼˜åŠ¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®ç°ç®€å•ã€æ— çº¿ç¨‹äº¤äº’å¼€é”€ã€èµ„æºæ¶ˆè€—ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦å±€é™&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;STWåœé¡¿æ—¶é—´é•¿ã€æ— æ³•åˆ©ç”¨å¤šæ ¸ä¼˜åŠ¿ã€ä¸é€‚åˆå¤§å†…å­˜é«˜å¹¶å‘åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å·¥ä½œæœºåˆ¶ä¸åˆ†ä»£å›æ”¶"&gt;ğŸ”§ å·¥ä½œæœºåˆ¶ä¸åˆ†ä»£å›æ”¶
&lt;/h3&gt;&lt;p&gt;Serial GCéµå¾ªJVMçš„åˆ†ä»£åƒåœ¾å›æ”¶æ€æƒ³ï¼Œå¯¹æ–°ç”Ÿä»£å’Œè€å¹´ä»£é‡‡ç”¨ä¸åŒçš„ç­–ç•¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ–°ç”Ÿä»£å›æ”¶ä¸å¤åˆ¶ç®—æ³•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Serial GCå°†æ–°ç”Ÿä»£åˆ’åˆ†ä¸ºä¸€ä¸ªEdenåŒºå’Œä¸¤ä¸ªSurvivoråŒºï¼ˆS0å’ŒS1ï¼‰ã€‚æ–°åˆ›å»ºçš„å¯¹è±¡é€šå¸¸ä¼˜å…ˆåœ¨EdenåŒºåˆ†é…ã€‚å½“EdenåŒºç©ºé—´ä¸è¶³æ—¶ï¼Œä¼šè§¦å‘ä¸€æ¬¡Minor GCã€‚GCè¿‡ç¨‹ä¼šæš‚åœæ‰€æœ‰åº”ç”¨çº¿ç¨‹ï¼Œç„¶åä½¿ç”¨&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼šå°†EdenåŒºå’Œä¸€ä¸ªSurvivoråŒºï¼ˆä¾‹å¦‚FromåŒºï¼‰ä¸­ä»ç„¶å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªç©ºçš„SurvivoråŒºï¼ˆToåŒºï¼‰ï¼ŒåŒæ—¶å¯¹è±¡çš„å¹´é¾„åŠ 1ã€‚å¦‚æœå­˜æ´»å¯¹è±¡çš„å¹´é¾„è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º15ï¼‰ï¼Œæˆ–è€…ToåŒºç©ºé—´ä¸è¶³ï¼Œè¿™äº›å¯¹è±¡ä¼šè¢«&lt;strong&gt;æ™‹å‡&lt;/strong&gt;ï¼ˆPromoteï¼‰åˆ°è€å¹´ä»£ã€‚æœ€åï¼Œæ¸…ç©ºEdenåŒºå’Œåˆšæ‰ä½¿ç”¨çš„FromåŒºã€‚SurvivoråŒºçš„å­˜åœ¨ç»™äº†å¯¹è±¡ä¸€ä¸ªâ€œç¼“å†²â€çš„æœºä¼šï¼Œé¿å…é‚£äº›ç”Ÿå‘½å‘¨æœŸçŸ­æš‚çš„å¯¹è±¡è¿‡æ—©è¿›å…¥è€å¹´ä»£ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è€å¹´ä»£å›æ”¶ä¸æ ‡è®°-æ•´ç†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“è€å¹´ä»£ç©ºé—´ä¸è¶³æˆ–è¾¾åˆ°ç‰¹å®šæ¡ä»¶æ—¶ï¼Œä¼šè§¦å‘Full GCï¼ŒSerial GCä¼šä½¿ç”¨Serial Oldæ”¶é›†å™¨æ¥å›æ”¶è€å¹´ä»£ã€‚å®ƒé‡‡ç”¨&lt;strong&gt;æ ‡è®°-æ•´ç†ç®—æ³•&lt;/strong&gt;ï¼Œæ•´ä¸ªè¿‡ç¨‹åŒæ ·éœ€è¦STWã€‚é¦–å…ˆ&lt;strong&gt;æ ‡è®°&lt;/strong&gt;å‡ºè€å¹´ä»£ä¸­æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ã€‚ç„¶åå°†è¿™äº›å­˜æ´»å¯¹è±¡å‘å†…å­˜ç©ºé—´çš„ä¸€ç«¯&lt;strong&gt;ç§»åŠ¨&lt;/strong&gt;ï¼ˆæ•´ç†ï¼‰ï¼Œä»è€Œæ¶ˆé™¤å†…å­˜ç¢ç‰‡ã€‚æœ€åï¼Œæ¸…ç†æ‰å­˜æ´»å¯¹è±¡è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚è¿™ä¸ªè¿‡ç¨‹æœ‰æ•ˆé¿å…äº†å†…å­˜ç¢ç‰‡åŒ–ï¼Œä½†ç”±äºéœ€è¦ç§»åŠ¨å¯¹è±¡ä¸”æ˜¯å•çº¿ç¨‹æ“ä½œï¼Œåœ¨å¤§å †å†…å­˜ä¸‹åœé¡¿æ—¶é—´ä¼šè¾ƒé•¿ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤„ç†è·¨ä»£å¼•ç”¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºå­˜åœ¨è€å¹´ä»£å¯¹è±¡å¼•ç”¨æ–°ç”Ÿä»£å¯¹è±¡çš„æƒ…å†µï¼ˆè·¨ä»£å¼•ç”¨ï¼‰ï¼ŒSerial GCä½¿ç”¨&lt;strong&gt;å¡è¡¨&lt;/strong&gt;ä½œä¸ºä¸€ç§&lt;strong&gt;è®°å¿†é›†&lt;/strong&gt;æ¥é«˜æ•ˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¡è¡¨å°†è€å¹´ä»£å†…å­˜åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„å¡é¡µï¼ˆå¦‚512å­—èŠ‚ï¼‰ï¼Œå½“è€å¹´ä»£ä¸­çš„å¯¹è±¡å¼•ç”¨æ–°ç”Ÿä»£å¯¹è±¡æ—¶ï¼ŒJVMä¼šé€šè¿‡&lt;strong&gt;å†™å±éšœ&lt;/strong&gt;æŠ€æœ¯å°†å¯¹åº”å¡é¡µæ ‡è®°ä¸ºâ€œè„â€ã€‚åœ¨Minor GCæ—¶ï¼Œåƒåœ¾æ”¶é›†å™¨åªéœ€æ‰«æè¿™äº›â€œè„â€é¡µï¼Œè€Œæ— éœ€éå†æ•´ä¸ªè€å¹´ä»£ï¼Œä»è€Œæå‡äº†æ•ˆç‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¼˜ç‚¹ä¸å±€é™"&gt;âš–ï¸ ä¼˜ç‚¹ä¸å±€é™
&lt;/h3&gt;&lt;p&gt;ç†è§£Serial GCçš„ä¼˜ç¼ºç‚¹ï¼Œæ˜¯åˆ¤æ–­å…¶æ˜¯å¦é€‚ç”¨çš„å…³é”®ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä¼˜åŠ¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç®€å•é«˜æ•ˆ&lt;/strong&gt;ï¼šå•çº¿ç¨‹è®¾è®¡é¿å…äº†å¤šçº¿ç¨‹åŒæ­¥å¸¦æ¥çš„å¤æ‚æ€§å’Œå¼€é”€ï¼Œåœ¨å•æ ¸CPUæˆ–å°å†…å­˜åœºæ™¯ä¸‹ï¼Œå› å…¶ä¸“æ³¨æ€§è€Œè¡¨ç°è‰¯å¥½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½å†…å­˜å ç”¨&lt;/strong&gt;ï¼šæ— éœ€ä¸ºå¤šçº¿ç¨‹ç»´æŠ¤å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œè‡ªèº«å†…å­˜å¼€é”€éå¸¸å°ï¼Œé€‚åˆèµ„æºæåº¦å—é™çš„ç¯å¢ƒï¼Œå¦‚åµŒå…¥å¼è®¾å¤‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é¢„æµ‹æ€§&lt;/strong&gt;ï¼šè¡Œä¸ºç›¸å¯¹ç®€å•ï¼Œåœ¨ç¨³å®šçš„å°å‹åº”ç”¨ä¸­ï¼Œå…¶GCè¡Œä¸ºæ›´å®¹æ˜“é¢„æµ‹å’Œè°ƒè¯•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜æ˜¾å±€é™&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;STWåœé¡¿&lt;/strong&gt;ï¼šè¿™æ˜¯å…¶æœ€æ˜¾è‘—çš„ç¼ºç‚¹ã€‚åœ¨è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œåº”ç”¨ç¨‹åºä¼šå®Œå…¨æš‚åœï¼Œå¦‚æœå †å†…å­˜è¾ƒå¤§æˆ–å­˜æ´»å¯¹è±¡è¾ƒå¤šï¼Œåœé¡¿æ—¶é—´ä¼šå¾ˆé•¿ï¼Œå¯¹ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿå®æ—¶æ€§å½±å“å·¨å¤§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— æ³•åˆ©ç”¨å¤šæ ¸&lt;/strong&gt;ï¼šåœ¨ç°ä»£å¤šæ ¸å¤„ç†å™¨æˆä¸ºæ ‡é…çš„æƒ…å†µä¸‹ï¼ŒSerial GCçš„å•çº¿ç¨‹æ¨¡å¼æ— æ³•å……åˆ†åˆ©ç”¨ç¡¬ä»¶èµ„æºï¼Œå›æ”¶æ•ˆç‡ä¼šæˆä¸ºç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸é€‚åˆå¤§è§„æ¨¡åº”ç”¨&lt;/strong&gt;ï¼šå¯¹äºéœ€è¦é«˜ååã€ä½å»¶è¿Ÿçš„å¤§å‹åº”ç”¨æˆ–å¾®æœåŠ¡ï¼ŒSerial GCçš„é•¿æ—¶é—´åœé¡¿é€šå¸¸æ˜¯ä¸å¯æ¥å—çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯"&gt;ğŸ¯ é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;å°½ç®¡æœ‰å…¶å±€é™æ€§ï¼ŒSerial GCåœ¨ä»¥ä¸‹ç‰¹å®šåœºæ™¯ä¸­ä»æ˜¯åˆç†ç”šè‡³æœ€ä½³çš„é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºå—é™çš„åµŒå…¥å¼ç³»ç»Ÿæˆ–ç‰©è”ç½‘è®¾å¤‡&lt;/strong&gt;ï¼šå†…å­˜å’ŒCPUæ ¸å¿ƒæ•°æœ‰é™ï¼ŒSerial GCçš„ä½å¼€é”€æ˜¯ä¼˜åŠ¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€å•çš„å•çº¿ç¨‹å®¢æˆ·ç«¯åº”ç”¨æˆ–å‘½ä»¤è¡Œå·¥å…·&lt;/strong&gt;ï¼šåº”ç”¨æœ¬èº«æ˜¯å•çº¿ç¨‹çš„ï¼Œä¸”å †å†…å­˜ä¸å¤§ï¼Œå¯¹åœé¡¿ä¸æ•æ„Ÿã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼€å‘ã€æµ‹è¯•å’Œè°ƒè¯•ç¯å¢ƒ&lt;/strong&gt;ï¼šå…¶ç®€å•æ€§æœ‰åŠ©äºå¼€å‘è€…ç†è§£GCåŸºç¡€åŸç†å’Œæ’æŸ¥å†…å­˜ç›¸å…³é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é…ç½®ä¸ç›‘æ§"&gt;âš™ï¸ é…ç½®ä¸ç›‘æ§
&lt;/h3&gt;&lt;p&gt;åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¯ä»¥é€šè¿‡JVMå‚æ•°è¿›è¡Œé…ç½®å’Œç›‘æ§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯ç”¨ä¸åŸºç¡€é…ç½®&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¦æ˜¾å¼å¯ç”¨Serial GCï¼Œå¯ä»¥ä½¿ç”¨JVMå¯åŠ¨å‚æ•°ï¼š&lt;code&gt;-XX:+UseSerialGC&lt;/code&gt;ã€‚è¿˜å¯ä»¥é…åˆå…¶ä»–å‚æ•°è°ƒæ•´å †å†…å­˜å¤§å°ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-Xms64m -Xmx64m&lt;/code&gt;ï¼šè®¾ç½®å †åˆå§‹å’Œæœ€å¤§å†…å­˜ä¸º64MBã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-Xmn32m&lt;/code&gt;ï¼šè®¾ç½®æ–°ç”Ÿä»£å¤§å°ä¸º32MBã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:SurvivorRatio=8&lt;/code&gt;ï¼šè®¾ç½®EdenåŒºä¸ä¸€ä¸ªSurvivoråŒºçš„æ¯”ä¾‹ï¼ˆé»˜è®¤ä¸º8ï¼Œå³Eden:Survivor=8:1:1ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç›‘æ§GCæ—¥å¿—&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¼€å¯GCæ—¥å¿—å¯¹äºç›‘æ§å’Œè°ƒä¼˜è‡³å…³é‡è¦ã€‚å¯ä»¥æ·»åŠ ä»¥ä¸‹å‚æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-XX:+PrintGCDetails -XX:+PrintGCTimeStamps -Xloggc:gc.log&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ—¥å¿—ä¼šè®°å½•æ¯æ¬¡GCçš„ç±»å‹ã€å‘ç”Ÿæ—¶é—´ã€å†…å­˜å›æ”¶å‰åå˜åŒ–ä»¥åŠè€—æ—¶ï¼Œå¸®åŠ©ä½ åˆ†æGCè¡Œä¸ºæ˜¯å¦å¥åº·ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-12"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Serial GCä½œä¸ºJVMåƒåœ¾å›æ”¶æŠ€æœ¯çš„èµ·ç‚¹ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;ç®€å•å’Œä½å¼€é”€&lt;/strong&gt;ã€‚è™½ç„¶å®ƒå·²æ— æ³•æ»¡è¶³ç°ä»£å¤§è§„æ¨¡ã€ä½å»¶è¿Ÿåº”ç”¨çš„éœ€æ±‚ï¼Œä½†åœ¨ç‰¹å®šçš„èµ„æºæ•æ„Ÿå‹åœºæ™¯ä¸‹ï¼Œå®ƒä¾ç„¶æ˜¯ä¸€ä¸ªå®ç”¨ä¸”æœ‰æ•ˆçš„é€‰æ‹©ã€‚ç†è§£Serial GCæœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½åœ°æŠŠæ¡JVMåƒåœ¾å›æ”¶å™¨çš„æ¼”è¿›é€»è¾‘å’Œè®¾è®¡æƒè¡¡ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½ä»‹ç»èƒ½å¸®åŠ©ä½ å…¨é¢ç†è§£Serial GCã€‚å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„è°ƒä¼˜æœ‰æ›´å…·ä½“çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="parellel-gc"&gt;Parellel GC
&lt;/h2&gt;&lt;p&gt;Parallel GCï¼ˆå¹¶è¡Œåƒåœ¾æ”¶é›†å™¨ï¼‰æ˜¯JVMä¸­ä¸€æ¬¾ä»¥&lt;strong&gt;æœ€å¤§åŒ–ç³»ç»Ÿååé‡&lt;/strong&gt;ä¸ºæ ¸å¿ƒç›®æ ‡çš„åƒåœ¾æ”¶é›†å™¨ã€‚å®ƒé€šè¿‡&lt;strong&gt;å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œ&lt;/strong&gt;åƒåœ¾å›æ”¶ä»»åŠ¡æ¥å……åˆ†åˆ©ç”¨å¤šæ ¸CPUä¼˜åŠ¿ï¼Œç‰¹åˆ«é€‚åˆå¯¹ååé‡è¦æ±‚é«˜ã€å¯¹åœé¡¿æ—¶é—´ç›¸å¯¹ä¸æ•æ„Ÿçš„åº”ç”¨åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è¡¨æ±‡æ€»äº†Parallel GCçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå¸®åŠ©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“å°è±¡ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;è¯¦æƒ…&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜ååé‡&lt;/strong&gt;ï¼ˆåº”ç”¨ç¨‹åºè¿è¡Œæ—¶é—´å æ€»æ—¶é—´çš„æ¯”ä¾‹æœ€å¤§åŒ–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å·¥ä½œæ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤šçº¿ç¨‹å¹¶è¡Œå›æ”¶&lt;/strong&gt;ï¼Œä½†ä¼šå‘ç”Ÿ &lt;strong&gt;Stop-The-World (STW)&lt;/strong&gt; åœé¡¿&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–°ç”Ÿä»£ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼ˆParallel Scavengeï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è€å¹´ä»£ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ ‡è®°-æ•´ç†ç®—æ³•&lt;/strong&gt;ï¼ˆParallel Oldï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®ä¼˜åŠ¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ååé‡é«˜ã€å¤šæ ¸CPUåˆ©ç”¨ç‡é«˜ã€æ”¯æŒè‡ªé€‚åº”è°ƒä¼˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦å±€é™&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;STWåœé¡¿æ—¶é—´ç›¸å¯¹è¾ƒé•¿ï¼Œä¸é€‚åˆä½å»¶è¿Ÿåœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é»˜è®¤ç‰ˆæœ¬&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JDK 8åŠä¹‹å‰ç‰ˆæœ¬çš„é»˜è®¤åƒåœ¾æ”¶é›†å™¨ï¼ˆJDK 9åŠä»¥åé»˜è®¤æ˜¯G1ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å·¥ä½œæœºåˆ¶ä¸åˆ†ä»£å›æ”¶-1"&gt;ğŸ”§ å·¥ä½œæœºåˆ¶ä¸åˆ†ä»£å›æ”¶
&lt;/h3&gt;&lt;p&gt;Parallel GCéµå¾ªåˆ†ä»£æ”¶é›†ç†è®ºï¼Œå¯¹æ–°ç”Ÿä»£å’Œè€å¹´ä»£é‡‡ç”¨ä¸åŒçš„å¹¶è¡Œå›æ”¶ç­–ç•¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹´è½»ä»£å›æ”¶ï¼ˆMinor GCï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Parallel GCä½¿ç”¨ &lt;strong&gt;Parallel Scavenge&lt;/strong&gt; æ”¶é›†å™¨è´Ÿè´£å¹´è½»ä»£çš„å›æ”¶ã€‚å½“EdenåŒºç©ºé—´ä¸è¶³æ—¶ï¼Œä¼šè§¦å‘ä¸€æ¬¡Minor GCã€‚å…¶è¿‡ç¨‹æ˜¯ï¼šåœ¨STWåœé¡¿åï¼Œå¤šä¸ªGCçº¿ç¨‹å¹¶è¡Œåœ°å°†EdenåŒºå’ŒFrom SurvivoråŒºä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°To SurvivoråŒºã€‚å¦‚æœå¯¹è±¡å­˜æ´»å¹´é¾„è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤15æ¬¡ï¼‰ï¼Œæˆ–To SurvivoråŒºç©ºé—´ä¸è¶³ï¼Œåˆ™å¯¹è±¡ä¼šæ™‹å‡åˆ°è€å¹´ä»£ã€‚æœ€åï¼Œæ¸…ç©ºEdenåŒºå’Œå·²ä½¿ç”¨çš„From SurvivoråŒºã€‚è¯¥ç®—æ³•é«˜æ•ˆï¼Œä½†STWåœé¡¿æ—¶é—´ä¼šéšå¹´è½»ä»£å¤§å°å¢é•¿ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è€å¹´ä»£å›æ”¶ï¼ˆMajor GC / Full GCï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è€å¹´ä»£ç”± &lt;strong&gt;Parallel Old&lt;/strong&gt; æ”¶é›†å™¨è´Ÿè´£ï¼Œå®ƒé‡‡ç”¨&lt;strong&gt;æ ‡è®°-æ•´ç†ç®—æ³•&lt;/strong&gt;ã€‚å½“è€å¹´ä»£ç©ºé—´ä¸è¶³æ—¶ä¼šè§¦å‘Full GCï¼Œè¿‡ç¨‹åŒæ ·ä¼šSTWï¼šå¤šä¸ªGCçº¿ç¨‹å¹¶è¡Œåœ°æ ‡è®°å‡ºæ‰€æœ‰å­˜æ´»å¯¹è±¡ï¼Œç„¶åå°†è¿™äº›å¯¹è±¡å‘å†…å­˜ä¸€ç«¯ç§»åŠ¨ï¼ˆæ•´ç†ï¼‰ï¼Œä»è€Œå›æ”¶ç¢ç‰‡ç©ºé—´ã€‚è™½ç„¶å¹¶è¡Œå¤„ç†æå‡äº†æ•ˆç‡ï¼Œä½†ç”±äºéœ€è¦å¤„ç†æ•´ä¸ªè€å¹´ä»£å¹¶ç§»åŠ¨å¯¹è±¡ï¼ŒFull GCçš„STWåœé¡¿æ—¶é—´é€šå¸¸æ¯”Minor GCé•¿å¾—å¤šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸€ä¸ªé‡è¦çš„ç»†èŠ‚ï¼šScavengeBeforeFullGC&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨Parallel GCä¸­ï¼Œé»˜è®¤å¯ç”¨äº† &lt;code&gt;-XX:+ScavengeBeforeFullGC&lt;/code&gt;å‚æ•°ã€‚è¿™æ„å‘³ç€åœ¨è§¦å‘ä¸€æ¬¡Full GCä¹‹å‰ï¼ŒJVMä¼š&lt;strong&gt;å…ˆå°è¯•æ‰§è¡Œä¸€æ¬¡Young GC&lt;/strong&gt;ï¼Œä»¥æ¸…ç†æ‰å¹´è½»ä»£ä¸­ä¸å†ä½¿ç”¨çš„å¯¹è±¡ï¼Œä»è€Œå‡å°‘éœ€è¦æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡æ•°é‡ï¼Œæœ‰æ—¶å¯èƒ½å› æ­¤é¿å…äº†ä¸å¿…è¦çš„Full GCã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§ä¸å‚æ•°è°ƒä¼˜"&gt;âš™ï¸ æ ¸å¿ƒç‰¹æ€§ä¸å‚æ•°è°ƒä¼˜
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ååé‡ä¼˜å…ˆ&lt;/strong&gt;ï¼šParallel GCçš„æ ¸å¿ƒç›®æ ‡æ˜¯æœ€å¤§åŒ–ååé‡ï¼Œå³åº”ç”¨ç¨‹åºè¿è¡Œæ—¶é—´å æ€»ï¼ˆåº”ç”¨ç¨‹åºè¿è¡Œæ—¶é—´ + GCæ—¶é—´ï¼‰çš„æ¯”ä¾‹ã€‚å¯é€šè¿‡ &lt;code&gt;-XX:GCTimeRatio&lt;/code&gt;å‚æ•°ç›´æ¥è®¾å®šç›®æ ‡ååé‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªé€‚åº”ç­–ç•¥&lt;/strong&gt;ï¼šParallel GCæ”¯æŒå¼ºå¤§çš„è‡ªé€‚åº”è°ƒä¼˜ç­–ç•¥ï¼ˆé€šè¿‡ &lt;code&gt;-XX:+UseAdaptiveSizePolicy&lt;/code&gt;å¼€å¯ï¼Œé»˜è®¤é€šå¸¸å¯ç”¨ï¼‰ã€‚JVMä¼šæ ¹æ®è¿è¡Œæ—¶çš„ç›‘æ§æ•°æ®ï¼ˆå¦‚GCåœé¡¿æ—¶é—´ã€æ™‹å‡å¤§å°ç­‰ï¼‰ï¼Œ&lt;strong&gt;åŠ¨æ€è°ƒæ•´&lt;/strong&gt;æ–°ç”Ÿä»£å¤§å°ã€Edenä¸SurvivoråŒºçš„æ¯”ä¾‹ã€æ™‹å‡å¹´é¾„é˜ˆå€¼ç­‰å‚æ•°ï¼Œä»¥å°½å¯èƒ½æ¥è¿‘è®¾å®šçš„ååé‡æˆ–åœé¡¿æ—¶é—´ç›®æ ‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®è°ƒä¼˜å‚æ•°&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;&lt;/strong&gt;ï¼šè®¾ç½®æœŸæœ›çš„&lt;strong&gt;æœ€å¤§GCåœé¡¿æ—¶é—´&lt;/strong&gt;ï¼ˆæ¯«ç§’ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ª&amp;quot;ç›®æ ‡å€¼&amp;rdquo;ï¼ŒJVMä¼šå°½åŠ›å®ç°ä½†ä¸ä¿è¯ç»å¯¹æ»¡è¶³ã€‚è®¾ç½®è¿‡å°å¯èƒ½å¯¼è‡´é¢‘ç¹GCæˆ–å¹´è½»ä»£ç¼©å¾—å¤ªå°ï¼Œåè€Œé™ä½ååé‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;-XX:GCTimeRatio&lt;/code&gt;&lt;/strong&gt;ï¼šè®¾ç½®&lt;strong&gt;ååé‡ç›®æ ‡å€¼&lt;/strong&gt;ã€‚å…¬å¼ä¸º &lt;code&gt;åº”ç”¨è¿è¡Œæ—¶é—´ / (åº”ç”¨è¿è¡Œæ—¶é—´ + GCæ—¶é—´)&lt;/code&gt;ï¼Œé»˜è®¤å€¼99è¡¨ç¤ºç›®æ ‡ä¸ºGCæ—¶é—´ä¸è¶…è¿‡æ€»æ—¶é—´çš„1% (&lt;code&gt;1/(1+99)&lt;/code&gt;)ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;-XX:ParallelGCThreads&lt;/code&gt;&lt;/strong&gt;ï¼šæŒ‡å®š&lt;strong&gt;å¹¶è¡ŒGCçº¿ç¨‹æ•°&lt;/strong&gt;ã€‚é€šå¸¸é»˜è®¤å€¼ï¼ˆä¸CPUæ ¸å¿ƒæ•°ç›¸å…³ï¼‰å·²è¶³å¤Ÿï¼Œåœ¨CPUèµ„æºç´§å¼ æˆ–éœ€ä¸¥æ ¼æ§åˆ¶GCçº¿ç¨‹æ•°æ—¶è°ƒæ•´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;-XX:+UseParallelGC&lt;/code&gt;&lt;/strong&gt; ä¸ &lt;strong&gt;&lt;code&gt;-XX:+UseParallelOldGC&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨JDK 7u4åŠä»¥åç‰ˆæœ¬ï¼Œå¯ç”¨å…¶ä¸­ä¸€ä¸ªå³åŒæ—¶å¯ç”¨æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„å¹¶è¡Œæ”¶é›†å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯"&gt;âš–ï¸ ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜ååé‡&lt;/strong&gt;ï¼šåœ¨å¤šæ ¸æœåŠ¡å™¨ä¸Šèƒ½æå¤§æå‡æ•°æ®å¤„ç†èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ ¸ä¼˜åŒ–&lt;/strong&gt;ï¼šå¹¶è¡Œå›æ”¶èƒ½æœ‰æ•ˆé™ä½å•æ¬¡GCçš„ç»å¯¹æ—¶é—´ï¼ˆå°½ç®¡STWä¾ç„¶å­˜åœ¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªé€‚åº”è°ƒä¼˜&lt;/strong&gt;ï¼šé™ä½äº†æ‰‹åŠ¨ç²¾ç»†è°ƒä¼˜çš„é—¨æ§›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;STWåœé¡¿&lt;/strong&gt;ï¼šæ— è®ºæ˜¯Minor GCè¿˜æ˜¯Full GCéƒ½ä¼šå¯¼è‡´åº”ç”¨çº¿ç¨‹æš‚åœï¼ŒFull GCçš„åœé¡¿æ—¶é—´å¯èƒ½è¾ƒé•¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿä¸æ•æ„Ÿ&lt;/strong&gt;ï¼šä¸é€‚åˆå¯¹å“åº”æ—¶é—´æœ‰ä¸¥æ ¼è¦æ±‚çš„å®æ—¶æˆ–äº¤äº’å¼åº”ç”¨ï¼ˆå¦‚WebæœåŠ¡ã€äº¤æ˜“ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åå°&lt;strong&gt;æ‰¹å¤„ç†ä»»åŠ¡&lt;/strong&gt;ï¼ˆå¦‚æ•°æ®è®¡ç®—ã€æŠ¥è¡¨ç”Ÿæˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—å¯†é›†å‹&lt;/strong&gt;åº”ç”¨ï¼ˆå¦‚ç§‘å­¦è®¡ç®—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹&lt;strong&gt;ååé‡è¦æ±‚é«˜äºå»¶è¿Ÿè¦æ±‚&lt;/strong&gt;çš„ä¸šåŠ¡ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸å…¶ä»–æ”¶é›†å™¨çš„å¯¹æ¯”"&gt;ğŸ”„ ä¸å…¶ä»–æ”¶é›†å™¨çš„å¯¹æ¯”
&lt;/h3&gt;&lt;p&gt;äº†è§£Parallel GCä¸å…¶ä»–ä¸»æµæ”¶é›†å™¨çš„åŒºåˆ«æœ‰åŠ©äºæ›´å¥½åœ°è¿›è¡ŒæŠ€æœ¯é€‰å‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ”¶é›†å™¨&lt;/th&gt;
&lt;th&gt;è®¾è®¡ç›®æ ‡&lt;/th&gt;
&lt;th&gt;çº¿ç¨‹/å·¥ä½œæ¨¡å¼&lt;/th&gt;
&lt;th&gt;å…³é”®ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Parallel GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶è¡ŒSTW&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…³æ³¨æ•´ä½“ååé‡ï¼ŒSTWåœé¡¿æ—¶é—´ç›¸å¯¹è¾ƒé•¿&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CMS GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½å»¶è¿Ÿ&lt;/strong&gt;ï¼ˆå·²åºŸå¼ƒï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘&lt;/strong&gt;ï¼ˆéƒ¨åˆ†é˜¶æ®µï¼‰&lt;/td&gt;
&lt;td&gt;å°è¯•å‡å°‘åœé¡¿æ—¶é—´ï¼Œä½†ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œä¸”æ˜“å‘ç”Ÿ&amp;quot;Concurrent Mode Failure&amp;quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;G1 GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹³è¡¡ååé‡ä¸å»¶è¿Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶è¡Œ + å¹¶å‘ + STW&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯é¢„æµ‹çš„åœé¡¿æ¨¡å‹ï¼Œé€‚ç”¨äºå¤§å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ZGC/Shenandoah&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è¶…ä½å»¶è¿Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‡ ä¹å…¨å¹¶å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœé¡¿æ—¶é—´æçŸ­ï¼Œä¸”å‡ ä¹ä¸éšå †å¤§å°å¢é•¿ï¼Œé€‚ç”¨äºTBçº§å¤§å †å’Œæè‡´å»¶è¿Ÿè¦æ±‚çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ€»ç»“-13"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Parallel GCæ˜¯ä¸€æ¬¾éå¸¸æˆç†Ÿä¸”é«˜æ•ˆçš„&lt;strong&gt;ååé‡ä¼˜å…ˆå‹&lt;/strong&gt;åƒåœ¾æ”¶é›†å™¨ã€‚å®ƒåœ¨å¤šæ ¸ç¯å¢ƒä¸‹èƒ½æœ€å¤§åŒ–åº”ç”¨ç¨‹åºçš„ååé‡ï¼Œå°¤å…¶é€‚åˆåå°å¤„ç†ã€å¤§æ•°æ®è®¡ç®—ç­‰å¯¹å»¶è¿Ÿä¸æ•æ„Ÿä½†å¯¹æ•´ä½“å¤„ç†é€Ÿåº¦è¦æ±‚é«˜çš„åœºæ™¯ã€‚å…¶&lt;strong&gt;å¹¶è¡Œå›æ”¶&lt;/strong&gt;å’Œ&lt;strong&gt;è‡ªé€‚åº”è°ƒæ•´&lt;/strong&gt;æ˜¯å…¶æ ¸å¿ƒä¼˜åŠ¿ï¼Œä½†éœ€è¦æ¥å—å…¶å¯èƒ½å¸¦æ¥çš„&lt;strong&gt;STWåœé¡¿&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ å…¨é¢ç†è§£Parallel GCã€‚å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„å‚æ•°è°ƒä¼˜æœ‰æ›´å…·ä½“çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="serial-gc--parallel-gc"&gt;Serial GC &amp;amp; Parallel GC
&lt;/h2&gt;&lt;p&gt;Parallel GC å’Œ Serial GC çš„åŒºåˆ«è¿œä¸æ­¢äºæ˜¯å¦ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œè¿™ä»…ä»…æ˜¯å®ƒä»¬æœ€è¡¨è±¡çš„å·®å¼‚ã€‚å®ƒä»¬åœ¨å†…æ ¸è®¾è®¡ç›®æ ‡ã€æ€§èƒ½ç‰¹æ€§ä»¥åŠé€‚ç”¨åœºæ™¯ä¸Šéƒ½æœ‰ç€æ ¹æœ¬çš„ä¸åŒã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯ä»¥è®©ä½ å¿«é€ŸæŠŠæ¡å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¯¹æ¯”ç»´åº¦&lt;/th&gt;
&lt;th&gt;Serial GC (ä¸²è¡Œæ”¶é›†å™¨)&lt;/th&gt;
&lt;th&gt;Parallel GC (å¹¶è¡Œ/ååé‡æ”¶é›†å™¨)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç®€å•é«˜æ•ˆã€ä½å†…å­˜å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æœ€å¤§åŒ–ç³»ç»Ÿååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹æ¨¡å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å•çº¿ç¨‹&lt;/strong&gt;æ‰§è¡ŒGCï¼ŒSTWæ—¶åªèƒ½åˆ©ç”¨ä¸€ä¸ªCPUæ ¸å¿ƒ&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤šçº¿ç¨‹å¹¶è¡Œ&lt;/strong&gt;æ‰§è¡ŒGCï¼ŒSTWæ—¶èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸CPUèµ„æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;STWåœé¡¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœé¡¿æ—¶é—´è¾ƒé•¿ï¼Œä¸”éšå †å¤§å°å¢é•¿è€Œæ˜¾è‘—å¢åŠ &lt;/td&gt;
&lt;td&gt;åœ¨å¤šæ ¸ç¯å¢ƒä¸‹ï¼Œå…¶å¹¶è¡Œå›æ”¶æœºåˆ¶èƒ½&lt;strong&gt;ç¼©çŸ­å•æ¬¡GCçš„ç»å¯¹åœé¡¿æ—¶é—´&lt;/strong&gt;ï¼ˆç›¸æ¯”Serial GCï¼‰ï¼Œä½†åœé¡¿ä¾ç„¶å­˜åœ¨ä¸”å¯èƒ½éšå †å¢å¤§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨å•æ ¸CPUç¯å¢ƒä¸‹ç›¸å¯¹é«˜æ•ˆ&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜ååé‡&lt;/strong&gt;ï¼Œå•ä½æ—¶é—´å†…åº”ç”¨ç¨‹åºå·¥ä½œæ—¶é—´å æ¯”é«˜ï¼Œé€‚åˆåå°è¿ç®—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜ä¸èµ„æº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªèº«å†…å­˜å¼€é”€æä½ï¼Œå‡ ä¹æ— é¢å¤–çº¿ç¨‹å¼€é”€&lt;/td&gt;
&lt;td&gt;éœ€è¦ä¸ºå¤šä¸ªGCçº¿ç¨‹ç»´æŠ¤çŠ¶æ€ï¼Œæœ‰é¢å¤–å¼€é”€ï¼›èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸CPU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å †å†…å­˜æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šå¸¸é€‚ç”¨äºå †å†…å­˜ &amp;lt; 1GB çš„å°å‹åº”ç”¨&lt;/td&gt;
&lt;td&gt;æ”¯æŒä¸­ç­‰å †å†…å­˜ï¼ˆçº¦1GB ~ 10GBï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒä¼˜ç‰¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¡Œä¸ºç®€å•ï¼Œå¯è°ƒå‚æ•°å°‘&lt;/td&gt;
&lt;td&gt;æ”¯æŒ&lt;strong&gt;è‡ªé€‚åº”è°ƒä¼˜ç­–ç•¥&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;-XX:+UseAdaptiveSizePolicy&lt;/code&gt;ï¼‰ï¼Œå¯æ ¹æ®è¿è¡ŒçŠ¶å†µåŠ¨æ€è°ƒæ•´æ–°ç”Ÿä»£å¤§å°ã€æ™‹å‡é˜ˆå€¼ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯ç”¨å‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseSerialGC&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseParallelGC&lt;/code&gt;æˆ– &lt;code&gt;-XX:+UseParallelOldGC&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®¢æˆ·ç«¯æ¨¡å¼ã€åµŒå…¥å¼è®¾å¤‡ã€å•æ ¸ç¯å¢ƒæˆ–å†…å­˜å—é™çš„ç®€å•åº”ç”¨&lt;/td&gt;
&lt;td&gt;ç§‘å­¦è®¡ç®—ã€å¤§æ•°æ®æ‰¹å¤„ç†ä»»åŠ¡ç­‰å¯¹&lt;strong&gt;ååé‡&lt;/strong&gt;è¦æ±‚é«˜ã€å¯¹åœé¡¿ä¸æ•æ„Ÿçš„åå°åº”ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ·±å…¥ç†è§£å·®å¼‚"&gt;ğŸ” æ·±å…¥ç†è§£å·®å¼‚
&lt;/h3&gt;&lt;p&gt;è¡¨æ ¼å±•ç¤ºäº†æ ¸å¿ƒåŒºåˆ«ï¼Œä»¥ä¸‹å‡ ç‚¹èƒ½å¸®ä½ æ›´æ·±å…¥åœ°ç†è§£ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡å“²å­¦çš„æ ¹æœ¬ä¸åŒ&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€å…³é”®çš„å·®å¼‚ã€‚Serial GC çš„è®¾è®¡åˆè¡·æ˜¯&lt;strong&gt;ç®€å•å’Œä½å¼€é”€&lt;/strong&gt;ï¼Œå®ƒæ˜¯JVMåƒåœ¾å›æ”¶çš„â€œåŸºç¡€å½¢æ€â€ã€‚è€ŒParallel GC çš„è¯ç”Ÿæ˜¯ä¸ºäº†åœ¨å¤šæ ¸æœåŠ¡å™¨æˆä¸ºä¸»æµçš„æ—¶ä»£ï¼Œ&lt;strong&gt;æœ€å¤§é™åº¦åœ°å‹æ¦¨CPUèµ„æºï¼Œæå‡ç¨‹åºçš„æ•´ä½“è¿ç®—æ•ˆç‡&lt;/strong&gt;ï¼Œå³ååé‡ã€‚æ˜¯å¦ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œæ˜¯å®ç°è¿™ä¸€æ ¸å¿ƒç›®æ ‡çš„æ‰‹æ®µè€Œéæœ¬è´¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœé¡¿æ—¶é—´çš„è¾©è¯çœ‹å¾…&lt;/strong&gt;ï¼šè™½ç„¶Parallel GCåˆ©ç”¨å¤šçº¿ç¨‹åŠ é€Ÿäº†å•æ¬¡GCè¿‡ç¨‹ï¼Œä»è€Œç¼©çŸ­äº†å•æ¬¡STWçš„ç»å¯¹æ—¶é—´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰åƒG1ã€ZGCé‚£æ ·é‡‡ç”¨å¤æ‚çš„å¹¶å‘æŠ€æœ¯æ¥å°è¯•ä¸åº”ç”¨ç¨‹åºçº¿ç¨‹ä¸€èµ·å·¥ä½œã€‚å› æ­¤ï¼Œå®ƒä»ç„¶ä¼šäº§ç”Ÿ&lt;strong&gt;å¯æ„ŸçŸ¥çš„åœé¡¿&lt;/strong&gt;ã€‚åœ¨å †å†…å­˜éå¸¸å¤§æ—¶ï¼ŒFull GCçš„åœé¡¿æ—¶é—´å¯èƒ½ä¾ç„¶å¾ˆé•¿ã€‚å®ƒçš„ä¼˜åŠ¿åœ¨äºåœ¨ç»™å®šçš„åœé¡¿æ—¶é—´å†…ï¼Œåˆ©ç”¨å¤šæ ¸èƒ½åŠ›æ¸…ç†äº†æ›´å¤šåƒåœ¾ï¼Œä»è€Œæå‡äº†ååé‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªé€‚åº”è°ƒä¼˜&lt;/strong&gt;ï¼šParallel GC æ‹¥æœ‰ä¸€é¡¹Serial GCä¸å…·å¤‡çš„é«˜çº§èƒ½åŠ›â€”â€”è‡ªé€‚åº”è°ƒä¼˜ç­–ç•¥ï¼ˆé»˜è®¤å¼€å¯ï¼‰ã€‚JVMä¼šæ ¹æ®å®é™…çš„GCè¡¨ç°ï¼ˆå¦‚åœé¡¿æ—¶é—´ã€æ™‹å‡å¤§å°ï¼‰åŠ¨æ€è°ƒæ•´å †å†…å„ä»£çš„å¤§å°ç­‰å‚æ•°ï¼Œä»¥å°½å¯èƒ½æ¥è¿‘å¼€å‘è€…è®¾å®šçš„ååé‡æˆ–åœé¡¿æ—¶é—´ç›®æ ‡ï¼ˆå¦‚é€šè¿‡&lt;code&gt;-XX:GCTimeRatio&lt;/code&gt;å’Œ&lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;è®¾å®šï¼‰ã€‚è¿™ä½¿å¾—å®ƒåœ¨å¤æ‚ç¯å¢ƒä¸‹çš„è¡¨ç°æ¯”Serial GCæ›´æ™ºèƒ½ã€æ›´çµæ´»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©-1"&gt;ğŸ’¡ å¦‚ä½•é€‰æ‹©
&lt;/h3&gt;&lt;p&gt;é€‰æ‹©å“ªä¸ªæ”¶é›†å™¨ï¼Œæœ€ç»ˆå–å†³äºä½ çš„åº”ç”¨éœ€æ±‚å’Œè¿è¡Œç¯å¢ƒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä½ çš„åº”ç”¨æ˜¯&lt;strong&gt;ç®€å•çš„å‘½ä»¤è¡Œå·¥å…·ã€è¿è¡Œåœ¨èµ„æºå—é™çš„åµŒå…¥å¼è®¾å¤‡æˆ–å•æ ¸CPUä¸Š&lt;/strong&gt;ï¼Œæˆ–è€…ä½ å¸Œæœ›GCè¡Œä¸ºå°½å¯èƒ½ç®€å•å¯æ§ï¼Œ&lt;strong&gt;Serial GC&lt;/strong&gt;æ˜¯åˆé€‚çš„é€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä½ çš„åº”ç”¨æ˜¯&lt;strong&gt;è¿è¡Œåœ¨å¤šæ ¸æœåŠ¡å™¨ä¸Šçš„åå°è®¡ç®—ã€æ•°æ®åˆ†ææˆ–æ‰¹å¤„ç†ä»»åŠ¡&lt;/strong&gt;ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯åœ¨å°½å¯èƒ½çŸ­çš„æ—¶é—´å†…å®Œæˆå¤§é‡è¿ç®—ï¼Œè€Œå¯¹ç”¨æˆ·æ“ä½œå“åº”çš„åŠæ—¶æ€§è¦æ±‚ä¸é«˜ï¼Œé‚£ä¹ˆ&lt;strong&gt;Parallel GC&lt;/strong&gt;çš„é«˜ååé‡ç‰¹æ€§å°†å¸¦æ¥å·¨å¤§ä¼˜åŠ¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½å¯¹æ¯”èƒ½å¸®åŠ©ä½ æ›´å…¨é¢åœ°ç†è§£Serial GCå’ŒParallel GCçš„å¼‚åŒã€‚å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„é€‰æ‹©æˆ–è°ƒä¼˜æœ‰æ›´å…·ä½“çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="parnew--cms"&gt;Parnew &amp;amp; CMS
&lt;/h2&gt;&lt;p&gt;ParNew å’Œ CMS æ˜¯ Java 8 åŠä¹‹å‰ç‰ˆæœ¬ä¸­ä¸€ä¸ªéå¸¸ç»å…¸çš„åƒåœ¾æ”¶é›†å™¨ç»„åˆï¼Œå°¤å…¶åœ¨å¯¹æœåŠ¡å“åº”é€Ÿåº¦æœ‰è¦æ±‚çš„åº”ç”¨ä¸­å¾ˆå¸¸è§ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€ŸæŠŠæ¡å®ƒä»¬çš„æ ¸å¿ƒç‰¹ç‚¹å’Œåä½œå…³ç³»ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;ParNew æ”¶é›†å™¨ (æ–°ç”Ÿä»£)&lt;/th&gt;
&lt;th&gt;CMS æ”¶é›†å™¨ (è€å¹´ä»£)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼©çŸ­æ–°ç”Ÿä»£åƒåœ¾æ”¶é›†çš„åœé¡¿æ—¶é—´ (STW)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½åœé¡¿&lt;/strong&gt;ï¼Œè¿½æ±‚æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å·¥ä½œåŒºåŸŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–°ç”Ÿä»£&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹æ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤šçº¿ç¨‹å¹¶è¡Œ&lt;/strong&gt;æ”¶é›†ï¼Œä¼šå‘ç”Ÿ STW&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘&lt;/strong&gt;æ ‡è®°å’Œæ¸…é™¤ï¼ˆéƒ¨åˆ†é˜¶æ®µä¸ç”¨æˆ·çº¿ç¨‹åŒæ—¶è¿è¡Œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ”¶é›†ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ ‡è®°-æ¸…é™¤ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®ä¼˜åŠ¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šæ ¸CPUä¸‹æ–°ç”Ÿä»£å›æ”¶æ•ˆç‡é«˜ï¼›æ˜¯&lt;strong&gt;ä¸CMSé…åˆçš„å”¯ä¸€å¤šçº¿ç¨‹æ–°ç”Ÿä»£æ”¶é›†å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¹¶å‘æ”¶é›†ï¼Œå¤§éƒ¨åˆ†å·¥ä½œæ— éœ€æš‚åœåº”ç”¨çº¿ç¨‹ï¼Œåœé¡¿æ—¶é—´çŸ­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦å±€é™&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»å±äºSTWæ”¶é›†å™¨ï¼Œåœé¡¿æ—¶é—´éšå †å¤§å°å¢é•¿&lt;/td&gt;
&lt;td&gt;äº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼›å¯¹CPUèµ„æºæ•æ„Ÿï¼›å­˜åœ¨&amp;quot;å¹¶å‘æ¨¡å¼å¤±è´¥&amp;quot;é£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å·¥ä½œæœºåˆ¶è¯¦è§£"&gt;ğŸ”§ å·¥ä½œæœºåˆ¶è¯¦è§£
&lt;/h3&gt;&lt;h4 id="parnewæ–°ç”Ÿä»£çš„å¹¶è¡Œæ¸…é“å¤«"&gt;&lt;strong&gt;ParNewï¼šæ–°ç”Ÿä»£çš„å¹¶è¡Œæ¸…é“å¤«&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ParNew æœ¬è´¨ä¸Šæ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œé™¤äº†ä½¿ç”¨å¤šæ¡çº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å¤–ï¼Œå…¶ä½™è¡Œä¸ºï¼ˆå¦‚é‡‡ç”¨çš„å¤åˆ¶ç®—æ³•ã€STWæœºåˆ¶ã€å¯¹è±¡åˆ†é…è§„åˆ™ç­‰ï¼‰éƒ½ä¸ Serial æ”¶é›†å™¨ä¸€è‡´ ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;ï¼šå½“æ–°ç”Ÿä»£çš„ Eden åŒºç©ºé—´ä¸è¶³æ—¶ï¼Œä¼šè§¦å‘ä¸€æ¬¡ Minor GCã€‚ParNew ä¼šæš‚åœæ‰€æœ‰åº”ç”¨çº¿ç¨‹ï¼ˆSTWï¼‰ï¼Œç„¶åä½¿ç”¨å¤šä¸ª GC çº¿ç¨‹å¹¶è¡Œåœ°å°† Eden åŒºå’Œå…¶ä¸­ä¸€ä¸ª Survivorï¼ˆFromåŒºï¼‰ä¸­å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªç©ºçš„ Survivorï¼ˆToåŒºï¼‰ã€‚å­˜æ´»å¹´é¾„è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤15ï¼‰æˆ– To åŒºç©ºé—´ä¸è¶³çš„å¯¹è±¡ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹é…ç½®&lt;/strong&gt;ï¼šé»˜è®¤å¼€å¯çš„æ”¶é›†çº¿ç¨‹æ•°ä¸ CPU æ ¸å¿ƒæ•°ç›¸åŒã€‚ä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;-XX:ParallelGCThreads&lt;/code&gt;å‚æ•°æ¥è°ƒæ•´çº¿ç¨‹æ•°é‡ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="cmsè€å¹´ä»£çš„å¹¶å‘ä½å»¶è¿Ÿå…ˆé”‹"&gt;&lt;strong&gt;CMSï¼šè€å¹´ä»£çš„å¹¶å‘ä½å»¶è¿Ÿå…ˆé”‹&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;CMS çš„è®¾è®¡ç›®æ ‡æ˜¯ä¸ºäº†è·å–æœ€çŸ­çš„å›æ”¶åœé¡¿æ—¶é—´ï¼Œå…¶å·¥ä½œè¿‡ç¨‹æ¯” ParNew å¤æ‚ï¼Œåˆ†ä¸ºå››ä¸ªæ ¸å¿ƒé˜¶æ®µ ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;ï¼šæ ‡è®° GC Roots èƒ½&lt;strong&gt;ç›´æ¥å…³è”&lt;/strong&gt;åˆ°çš„å¯¹è±¡ã€‚æ­¤é˜¶æ®µéœ€è¦ STWï¼Œä½†é€Ÿåº¦æå¿« ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼šä»åˆå§‹æ ‡è®°çš„å¯¹è±¡å¼€å§‹ï¼Œ&lt;strong&gt;éå†æ•´ä¸ªå¯¹è±¡å›¾&lt;/strong&gt;ã€‚æ­¤é˜¶æ®µ&lt;strong&gt;ä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œ&lt;/strong&gt;ï¼Œè€—æ—¶è¾ƒé•¿ï¼Œä½†ä¸ä¼šæš‚åœåº”ç”¨ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡æ–°æ ‡è®°&lt;/strong&gt;ï¼šä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´ï¼Œå› ç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´çš„&lt;strong&gt;æ ‡è®°å˜åŠ¨&lt;/strong&gt;ã€‚æ­¤é˜¶æ®µéœ€è¦ STWï¼Œæ—¶é—´é€šå¸¸æ¯”åˆå§‹æ ‡è®°é•¿ï¼Œä½†è¿œçŸ­äºå¹¶å‘æ ‡è®° ã€‚ä¸ºäº†å‡å°‘è¯¥é˜¶æ®µçš„æ‰«æå¼€é”€ï¼Œå¯ä»¥å¯ç”¨ &lt;code&gt;-XX:+CMSScavengeBeforeRemark&lt;/code&gt;å‚æ•°ï¼Œåœ¨é‡æ–°æ ‡è®°å‰å…ˆæ‰§è¡Œä¸€æ¬¡ Minor GC ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ¸…é™¤&lt;/strong&gt;ï¼šæ¸…ç†å¹¶å›æ”¶è¢«æ ‡è®°ä¸ºå¯å›æ”¶çš„å¯¹è±¡ã€‚æ­¤é˜¶æ®µä¹Ÿæ˜¯ä¸ç”¨æˆ·çº¿ç¨‹&lt;strong&gt;å¹¶å‘æ‰§è¡Œ&lt;/strong&gt;çš„ ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¼˜ç¼ºç‚¹åˆ†æ"&gt;âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ
&lt;/h3&gt;&lt;p&gt;äº†è§£å®ƒä»¬çš„å±€é™æ€§å¯¹äºæ­£ç¡®ä½¿ç”¨å’Œè°ƒä¼˜è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ParNew çš„ä¼˜ç¼ºç‚¹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šåœ¨å¤šæ ¸CPUç¯å¢ƒä¸‹èƒ½æœ‰æ•ˆç¼©çŸ­å•æ¬¡Minor GCçš„åœé¡¿æ—¶é—´ï¼›æˆç†Ÿç¨³å®šï¼Œæ˜¯ä¸CMSæ­é…çš„ä¸äºŒä¹‹é€‰ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå®ƒä»ç„¶æ˜¯STWæ”¶é›†å™¨ï¼Œåœ¨å †å†…å­˜è¾ƒå¤§æˆ–å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜æ—¶ï¼Œåœé¡¿æ—¶é—´ä¾ç„¶å¯è§‚ï¼›å¹¶ä¸”åªè´Ÿè´£æ–°ç”Ÿä»£ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CMS çš„ä¼˜ç¼ºç‚¹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå…¶&lt;strong&gt;ä½åœé¡¿&lt;/strong&gt;ç‰¹æ€§ä½¿å…¶éå¸¸é€‚åˆWebæœåŠ¡å™¨ã€åˆ†å¸ƒå¼ç³»ç»Ÿç­‰å¯¹å“åº”é€Ÿåº¦æ•æ„Ÿçš„åº”ç”¨ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç¢ç‰‡&lt;/strong&gt;ï¼šç”±äºä½¿ç”¨æ ‡è®°-æ¸…é™¤ç®—æ³•ï¼Œä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚å¯ä»¥é€šè¿‡å‚æ•° &lt;code&gt;-XX:+UseCMSCompactAtFullCollection&lt;/code&gt;ï¼ˆé»˜è®¤å¼€å¯ï¼‰åœ¨Full GCæ—¶è¿›è¡Œç¢ç‰‡æ•´ç†ï¼Œæˆ–ä½¿ç”¨ &lt;code&gt;-XX:CMSFullGCsBeforeCompaction&lt;/code&gt;è®¾ç½®æ‰§è¡Œå¤šå°‘æ¬¡ä¸å‹ç¼©çš„Full GCåå†è¿›è¡Œä¸€æ¬¡å¸¦å‹ç¼©çš„Full GC ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹CPUèµ„æºæ•æ„Ÿ&lt;/strong&gt;ï¼šå¹¶å‘é˜¶æ®µä¼šä¸ç”¨æˆ·çº¿ç¨‹äº‰æŠ¢CPUèµ„æºï¼Œå¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºååé‡é™ä½ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&amp;ldquo;å¹¶å‘æ¨¡å¼å¤±è´¥&amp;rdquo;&lt;/strong&gt;ï¼šåœ¨å¹¶å‘å‘¨æœŸæ‰§è¡ŒæœŸé—´ï¼Œå¦‚æœè€å¹´ä»£ç©ºé—´è¢«å¿«é€Ÿå¡«æ»¡ï¼Œå¯èƒ½æ¥ä¸åŠæ”¶é›†ï¼Œä¼šè§¦å‘&amp;quot;Concurrent Mode Failure&amp;quot;ï¼Œæ­¤æ—¶JVMä¼šä¸´æ—¶å¯ç”¨Serial Oldæ”¶é›†å™¨è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå¯¼è‡´é•¿æ—¶é—´åœé¡¿ã€‚å¯é€šè¿‡ &lt;code&gt;-XX:CMSInitiatingOccupancyFraction&lt;/code&gt;å‚æ•°ï¼ˆå¦‚è®¾ç½®ä¸º70ï¼‰æå‰è§¦å‘CMS GCï¼Œä¸ºæµ®åŠ¨åƒåœ¾é¢„ç•™ç©ºé—´ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµ®åŠ¨åƒåœ¾&lt;/strong&gt;ï¼šå¹¶å‘æ¸…ç†é˜¶æ®µç”¨æˆ·çº¿ç¨‹äº§ç”Ÿçš„åƒåœ¾åªèƒ½ç•™åˆ°ä¸‹ä¸€æ¬¡GCæ‰èƒ½è¢«æ¸…ç† ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-åä½œä¸è°ƒä¼˜"&gt;ğŸ¤ åä½œä¸è°ƒä¼˜
&lt;/h3&gt;&lt;p&gt;ParNew å’Œ CMS çš„ååŒå·¥ä½œï¼Œæ—¨åœ¨é™ä½æ•´ä¸ªGCè¿‡ç¨‹ä¸­çš„åœé¡¿æ—¶é—´ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åä½œæ¨¡å¼&lt;/strong&gt;ï¼šé€šå¸¸ç”± ParNew è´Ÿè´£æ–°ç”Ÿä»£çš„å›æ”¶ï¼Œå­˜æ´»åˆ°ä¸€å®šå¹´é¾„çš„å¯¹è±¡è¢«æ™‹å‡åˆ°è€å¹´ä»£ã€‚CMS åˆ™åœ¨åå°å¹¶å‘åœ°ç®¡ç†è€å¹´ä»£ç©ºé—´ï¼Œå°½å¯èƒ½å‡å°‘Full GCçš„å‘ç”Ÿ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸºæœ¬é…ç½®å‚æ•°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# å¯ç”¨CMSï¼ˆä¼šè‡ªåŠ¨å¯ç”¨ParNewä½œä¸ºæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼‰
-XX:+UseConcMarkSweepGC
# è®¾ç½®CMSå¹¶è¡Œçº¿ç¨‹æ•°
-XX:ParallelGCThreads=4
# åœ¨CMSé‡æ–°æ ‡è®°å‰æ‰§è¡Œä¸€æ¬¡Minor GCï¼Œä»¥å‡å°‘é‡æ–°æ ‡è®°é˜¶æ®µçš„æ‰«æèŒƒå›´
-XX:+CMSScavengeBeforeRemark
# è®¾ç½®è€å¹´ä»£ç©ºé—´ä½¿ç”¨ç‡è¾¾åˆ°å¤šå°‘æ—¶è§¦å‘CMSæ”¶é›†
-XX:CMSInitiatingOccupancyFraction=70
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¼€å¯GCæ—¥å¿—ï¼ˆ&lt;code&gt;-XX:+PrintGCDetails -XX:+PrintGCDateStamps&lt;/code&gt;ï¼‰æ˜¯ç›‘æ§å’Œè°ƒä¼˜çš„åŸºç¡€ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ç°çŠ¶ä¸é€‰æ‹©"&gt;ğŸ’¡ ç°çŠ¶ä¸é€‰æ‹©
&lt;/h3&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;strong&gt;ä»JDK 9å¼€å§‹ï¼ŒCMSå·²è¢«æ ‡è®°ä¸ºåºŸå¼ƒï¼ˆDeprecatedï¼‰ï¼Œå¹¶åœ¨åç»­ç‰ˆæœ¬ä¸­è¢«ç§»é™¤&lt;/strong&gt; ã€‚å…¶æ ¹æœ¬åŸå› åœ¨äºå…¶å¤æ‚çš„ä»£ç å®ç°å’Œæ— æ³•é¿å…çš„å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œä½¿å¾—ç»´æŠ¤å’Œè¿›ä¸€æ­¥ä¼˜åŒ–å˜å¾—å›°éš¾ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç°ä»£Javaåº”ç”¨ä¸­ï¼Œ&lt;strong&gt;G1 (Garbage-First)&lt;/strong&gt; æ”¶é›†å™¨é€šå¸¸è¢«è§†ä¸ºCMSçš„ç»§ä»»è€…ï¼Œå®ƒåœ¨å»¶è¿Ÿå’Œååé‡ä¹‹é—´æä¾›äº†æ›´å¥½çš„å¹³è¡¡ï¼Œå¹¶ä¸”é€‚ç”¨äºæ›´å¤§çš„å †å†…å­˜ã€‚è€Œå¯¹äºè¿½æ±‚æè‡´ä½å»¶è¿Ÿçš„åº”ç”¨ï¼Œ&lt;strong&gt;ZGC&lt;/strong&gt; æˆ– &lt;strong&gt;Shenandoah&lt;/strong&gt; æ˜¯æ›´å‰æ²¿çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ å…¨é¢ç†è§£ ParNew å’Œ CMSã€‚å¦‚æœä½ å¯¹ä» ParNew+CMS è¿ç§»åˆ°ç°ä»£åƒåœ¾æ”¶é›†å™¨æœ‰å…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="cms"&gt;CMS
&lt;/h2&gt;&lt;p&gt;ç†è§£ CMS çš„ &lt;strong&gt;â€œå¹¶å‘â€ä¸â€œå¹¶è¡Œâ€ç»“åˆ&lt;/strong&gt; ç¡®å®æ˜¯æŒæ¡å…¶è®¾è®¡ç²¾é«“çš„å…³é”®ã€‚ç®€å•æ¥è¯´ï¼Œè¿™æŒ‡çš„æ˜¯ CMS åœ¨åƒåœ¾å›æ”¶çš„ä¸åŒé˜¶æ®µï¼Œ&lt;strong&gt;çµæ´»è¿ç”¨äº†ä¸¤ç§ä¸åŒçš„å¤šçº¿ç¨‹å·¥ä½œæ¨¡å¼&lt;/strong&gt;ï¼Œä»¥è¾¾åˆ°å…¶æ ¸å¿ƒç›®æ ‡â€”â€”æœ€å°åŒ–åº”ç”¨çº¿ç¨‹çš„åœé¡¿æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ ä¸€ç›®äº†ç„¶ï¼Œä¸‹è¡¨æ¸…æ™°åœ°å±•ç¤ºäº†CMSå„ä¸ªé˜¶æ®µæ˜¯å¦‚ä½•è¿ç”¨å¹¶å‘å’Œå¹¶è¡Œç­–ç•¥çš„ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é˜¶æ®µ&lt;/th&gt;
&lt;th&gt;å·¥ä½œæ¨¡å¼&lt;/th&gt;
&lt;th&gt;æ˜¯å¦ STW&lt;/th&gt;
&lt;th&gt;çº¿ç¨‹å…³ç³»ä¸ç›®æ ‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤šä¸ªGCçº¿ç¨‹å¹¶è¡Œå·¥ä½œ&lt;/strong&gt;ï¼Œåº”ç”¨çº¿ç¨‹æš‚åœã€‚ç›®æ ‡æ˜¯å¿«é€Ÿæ ‡è®°å®Œç›´æ¥å…³è”å¯¹è±¡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;GCçº¿ç¨‹ä¸åº”ç”¨çº¿ç¨‹å¹¶å‘æ‰§è¡Œ&lt;/strong&gt;ã€‚ç›®æ ‡æ˜¯éå†å¯¹è±¡å›¾ï¼Œæ­¤é˜¶æ®µè€—æ—¶è¾ƒé•¿ä½†ä¸æš‚åœåº”ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é‡æ–°æ ‡è®°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤šä¸ªGCçº¿ç¨‹å¹¶è¡Œå·¥ä½œ&lt;/strong&gt;ï¼Œåº”ç”¨çº¿ç¨‹æš‚åœã€‚ç›®æ ‡æ˜¯ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å˜åŠ¨çš„å¼•ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ¸…é™¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;GCçº¿ç¨‹ä¸åº”ç”¨çº¿ç¨‹å¹¶å‘æ‰§è¡Œ&lt;/strong&gt;ã€‚ç›®æ ‡æ˜¯æ¸…ç†åƒåœ¾å¯¹è±¡ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ·±å…¥ç†è§£ä¸¤ç§æ¨¡å¼"&gt;ğŸ” æ·±å…¥ç†è§£ä¸¤ç§æ¨¡å¼
&lt;/h3&gt;&lt;p&gt;è¿™ä¸ªè®¾è®¡èƒŒåçš„é€»è¾‘éå¸¸å·§å¦™ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹¶è¡Œçš„ä»·å€¼ï¼šé€Ÿæˆ˜é€Ÿå†³&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;CMS çŸ¥é“å®Œå…¨é¿å…åœé¡¿æ˜¯ä¸ç°å®çš„ï¼Œä½†å®ƒè¿½æ±‚å°†å¿…è¦çš„åœé¡¿æ—¶é—´å‹ç¼©åˆ°æè‡´ã€‚åœ¨&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;å’Œ&lt;strong&gt;é‡æ–°æ ‡è®°&lt;/strong&gt;è¿™ä¸¤ä¸ªä¸å¾—ä¸æš‚åœåº”ç”¨çº¿ç¨‹çš„é˜¶æ®µï¼Œå®ƒé‡‡ç”¨äº†&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;ç­–ç•¥ã€‚è¿™æ„å‘³ç€ JVM ä¼šå¯åŠ¨&lt;strong&gt;å¤šä¸ªåƒåœ¾æ”¶é›†çº¿ç¨‹&lt;/strong&gt;åŒæ—¶å¹²æ´»ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPUçš„ä¼˜åŠ¿ï¼Œä»¥æœ€å¿«é€Ÿåº¦å®Œæˆæ ‡è®°ä»»åŠ¡ï¼Œä»è€Œå°†è¿™ä¸¤æ¬¡åœé¡¿çš„æ—¶é—´ç¼©è‡³æœ€çŸ­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹¶å‘çš„ä»·å€¼ï¼šååŒå·¥ä½œ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è€Œæœ€è€—æ—¶çš„&lt;strong&gt;æ ‡è®°&lt;/strong&gt;å’Œ&lt;strong&gt;æ¸…é™¤&lt;/strong&gt;å·¥ä½œï¼ŒCMS åˆ™é‡‡ç”¨äº†&lt;strong&gt;å¹¶å‘&lt;/strong&gt;ç­–ç•¥ã€‚åœ¨è¿™ä¸¤ä¸ªé˜¶æ®µï¼Œ&lt;strong&gt;åƒåœ¾æ”¶é›†çº¿ç¨‹å’Œåº”ç”¨çº¿ç¨‹æ˜¯åŒæ—¶è¿è¡Œçš„&lt;/strong&gt;ã€‚ä½ çš„ç¨‹åºå¯ä»¥ç»§ç»­å“åº”ç”¨æˆ·è¯·æ±‚ã€å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œè€ŒGCåˆ™åœ¨åå°é»˜é»˜åœ°è¿½è¸ªå­˜æ´»å¯¹è±¡ã€æ¸…ç†åƒåœ¾å†…å­˜ã€‚è¿™æå¤§åœ°å‡å°‘äº†åƒåœ¾æ”¶é›†å¯¹åº”ç”¨å“åº”é€Ÿåº¦çš„å½±å“ï¼Œæ˜¯CMSå®ç°ä½å»¶è¿Ÿç›®æ ‡çš„åŸºçŸ³ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-è®¾è®¡æƒè¡¡ä¸å½±å“"&gt;âš–ï¸ è®¾è®¡æƒè¡¡ä¸å½±å“
&lt;/h3&gt;&lt;p&gt;è¿™ç§å·§å¦™çš„ç»“åˆä¹Ÿå¸¦æ¥äº†ä¸€äº›ç‰¹æœ‰çš„æƒè¡¡å’ŒæŒ‘æˆ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CPUèµ„æºç«äº‰&lt;/strong&gt;ï¼šå¹¶å‘é˜¶æ®µGCçº¿ç¨‹ä¼šä¸åº”ç”¨çº¿ç¨‹äº‰æŠ¢CPUæ—¶é—´ç‰‡ï¼Œå¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºçš„&lt;strong&gt;ååé‡æœ‰æ‰€ä¸‹é™&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµ®åŠ¨åƒåœ¾&lt;/strong&gt;ï¼šå› ä¸ºåœ¨å¹¶å‘æ¸…ç†è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œï¼Œä¼šæŒç»­äº§ç”Ÿæ–°çš„åƒåœ¾å¯¹è±¡ã€‚è¿™äº›â€œæµ®åŠ¨åƒåœ¾â€æ— æ³•åœ¨æœ¬æ¬¡æ”¶é›†ä¸­è¢«æ¸…é™¤ï¼Œåªèƒ½ç­‰å¾…ä¸‹ä¸€æ¬¡GCã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç¢ç‰‡&lt;/strong&gt;ï¼šç”±äºCMSçš„æ¸…é™¤é˜¶æ®µæ˜¯å¹¶å‘è¿›è¡Œçš„ï¼Œä¸ºäº†é¿å…ç§»åŠ¨å¯¹è±¡å¸¦æ¥çš„å¤æ‚åŒæ­¥é—®é¢˜ï¼Œå®ƒé‡‡ç”¨äº†&lt;strong&gt;æ ‡è®°-æ¸…é™¤ç®—æ³•&lt;/strong&gt;è€Œéæ ‡è®°-æ•´ç†ç®—æ³•ã€‚è¿™ä¼šå¯¼è‡´å†…å­˜ç¢ç‰‡ï¼Œå¯èƒ½åœ¨æœªæ¥è§¦å‘ä¸€æ¬¡æ›´è€—æ—¶çš„Full GCã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“ä¸æ¼”è¿›"&gt;ğŸ“š æ€»ç»“ä¸æ¼”è¿›
&lt;/h3&gt;&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼ŒCMSé€šè¿‡å°†è€—æ—¶æœ€é•¿çš„&lt;strong&gt;æ ‡è®°&lt;/strong&gt;å’Œ&lt;strong&gt;æ¸…é™¤&lt;/strong&gt;ä»»åŠ¡ä¸åº”ç”¨ç¨‹åº&lt;strong&gt;å¹¶å‘æ‰§è¡Œ&lt;/strong&gt;ï¼Œå¹¶å°†ä¸¤æ¬¡å¿…è¦çš„åœé¡¿ï¼ˆ&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;å’Œ&lt;strong&gt;é‡æ–°æ ‡è®°&lt;/strong&gt;ï¼‰è®¾è®¡æˆ&lt;strong&gt;å¹¶è¡Œå¤„ç†&lt;/strong&gt;ï¼Œå®ç°äº†åœ¨åƒåœ¾å›æ”¶æœŸé—´çš„ä½åœé¡¿ç›®æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºä¸Šè¿°çš„ä¸€äº›å›ºæœ‰ç¼ºç‚¹ï¼ˆå¦‚å†…å­˜ç¢ç‰‡ã€å¯¹CPUæ•æ„Ÿï¼‰ï¼Œ&lt;strong&gt;CMSåœ¨JDK 9ä¸­å·²è¢«æ ‡è®°ä¸ºåºŸå¼ƒï¼ˆDeprecatedï¼‰ï¼Œå¹¶åœ¨JDK 14ä¸­è¢«ç§»é™¤&lt;/strong&gt;ã€‚ å®ƒçš„è®¾è®¡æ€æƒ³è¢«æ›´å…ˆè¿›çš„åƒåœ¾æ”¶é›†å™¨å¦‚ &lt;strong&gt;G1&lt;/strong&gt; å’Œ &lt;strong&gt;ZGC&lt;/strong&gt; æ‰€ç»§æ‰¿å’Œå‘å±•ã€‚G1åŒæ ·é‡‡ç”¨äº†å¹¶è¡Œä¸å¹¶å‘ç»“åˆçš„æ€è·¯ï¼Œä½†é€šè¿‡åˆ†åŒºå’Œé¢„æµ‹æ¨¡å‹æä¾›äº†æ›´å¯é¢„æµ‹çš„åœé¡¿ï¼›è€ŒZGCå’ŒShenandoahåˆ™è‡´åŠ›äºå®ç°å‡ ä¹å…¨æµç¨‹çš„å¹¶å‘ï¼Œå°†åœé¡¿æ—¶é—´è¿›ä¸€æ­¥æ¨å‘æè‡´ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ é€å½»åœ°ç†è§£CMSçš„å·¥ä½œæœºåˆ¶ã€‚&lt;/p&gt;
&lt;h2 id="å¹¶å‘--å¹¶è¡Œ"&gt;å¹¶å‘ &amp;amp; å¹¶è¡Œ
&lt;/h2&gt;&lt;p&gt;å¹¶å‘å’Œå¹¶è¡Œæ˜¯è®¡ç®—æœºç§‘å­¦ä¸­ä¸¤ä¸ªå¯†åˆ‡ç›¸å…³ä½†æœ¬è´¨ä¸åŒçš„æ¦‚å¿µï¼Œå®ƒä»¬æè¿°äº†ä»»åŠ¡æ‰§è¡Œçš„ä¸¤ç§ä¸åŒæ–¹å¼ã€‚ä¸ºäº†å¸®ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒåŒºåˆ«ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æ±‡æ€»å®ƒä»¬çš„ä¸»è¦ç‰¹ç‚¹ï¼Œç„¶åå†æ·±å…¥èŠèŠç»†èŠ‚å’Œåº”ç”¨ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¯¹æ¯”ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹¶å‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒå®šä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªå¤„ç†å™¨&lt;strong&gt;äº¤æ›¿å¤„ç†&lt;/strong&gt;å¤šä¸ªä»»åŠ¡&lt;/td&gt;
&lt;td&gt;å¤šä¸ªå¤„ç†å™¨&lt;strong&gt;åŒæ—¶å¤„ç†&lt;/strong&gt;å¤šä¸ªä»»åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæ€æƒ³&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å®è§‚ä¸ŠåŒæ—¶å‘ç”Ÿ&lt;/strong&gt;ï¼Œå¾®è§‚ä¸Šä»»åŠ¡äº¤æ›¿æ‰§è¡Œï¼Œå…·å¤‡å¤„ç†å¤šä¸ªä»»åŠ¡çš„èƒ½åŠ›&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç‰©ç†ä¸Šçš„åŒæ—¶æ‰§è¡Œ&lt;/strong&gt;ï¼Œæ‹¥æœ‰åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡çš„èƒ½åŠ›&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¡¬ä»¶ä¾èµ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ä¾èµ–å¤šæ ¸ï¼Œå•æ ¸CPUå³å¯å®ç°ï¼ˆé€šè¿‡æ—¶é—´ç‰‡è½®è½¬ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜åº¦ä¾èµ–å¤šæ ¸CPUæˆ–å¤šå°å¤„ç†å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³æ³¨ç„¦ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…³æ³¨çš„æ˜¯&lt;strong&gt;ä»»åŠ¡çš„ç»„ç»‡ä¸è°ƒåº¦&lt;/strong&gt;ï¼Œå³å¦‚ä½•åº”å¯¹å¤šä»»åŠ¡çš„èƒ½åŠ›&lt;/td&gt;
&lt;td&gt;å…³æ³¨çš„æ˜¯&lt;strong&gt;ä»»åŠ¡çš„æ‰§è¡Œ&lt;/strong&gt;ï¼Œå³å¦‚ä½•åˆ©ç”¨å¤šæ ¸èµ„æºåŠ é€Ÿè®¡ç®—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡æ‰§è¡Œæ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»»åŠ¡åœ¨æ—¶é—´ä¸Šäº¤æ›¿æ‰§è¡Œï¼Œ&lt;strong&gt;åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªä»»åŠ¡åœ¨è¿è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»»åŠ¡å¯ä»¥åœ¨&lt;strong&gt;åŒä¸€æ—¶åˆ»è¢«ä¸åŒçš„å¤„ç†å™¨æ ¸å¿ƒåŒæ—¶æ‰§è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æé«˜ç³»ç»Ÿ&lt;strong&gt;å“åº”èƒ½åŠ›&lt;/strong&gt;å’Œ&lt;strong&gt;èµ„æºåˆ©ç”¨ç‡&lt;/strong&gt;ï¼ˆå¦‚ä¸€ä¸ªä»»åŠ¡ç­‰å¾…IOæ—¶ï¼ŒCPUå¯æ‰§è¡Œå¦ä¸€ä¸ªä»»åŠ¡ï¼‰&lt;/td&gt;
&lt;td&gt;æé«˜ç³»ç»Ÿçš„&lt;strong&gt;è®¡ç®—é€Ÿåº¦&lt;/strong&gt;å’Œ&lt;strong&gt;ååé‡&lt;/strong&gt;ï¼Œç¼©çŸ­å•ä¸ªå¤§å‹ä»»åŠ¡çš„å®Œæˆæ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹æ¯”å–»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªäººï¼ˆå•æ ¸CPUï¼‰&lt;strong&gt;äº¤æ›¿ç…§çœ‹&lt;/strong&gt;ä¸¤å£é”…åšé¥­&lt;/td&gt;
&lt;td&gt;ä¸¤ä¸ªäººï¼ˆåŒæ ¸CPUï¼‰&lt;strong&gt;åŒæ—¶å„è‡ªç‚’&lt;/strong&gt;ä¸€é“èœ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ·±å…¥ç†è§£ä¸¤è€…çš„å†…æ¶µä¸å…³ç³»"&gt;ğŸ’¡ æ·±å…¥ç†è§£ä¸¤è€…çš„å†…æ¶µä¸å…³ç³»
&lt;/h3&gt;&lt;p&gt;ç†è§£äº†åŸºæœ¬åŒºåˆ«åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å®ƒä»¬å„è‡ªçš„å†…æ¶µä»¥åŠç›¸äº’ä¹‹é—´æœ‰è¶£çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹¶å‘çš„æ ¸å¿ƒæ˜¯â€œä»»åŠ¡äº¤æ›¿â€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¹¶å‘æ˜¯ä¸ºäº†è®©ç³»ç»Ÿèƒ½å¤Ÿâ€œåŒæ—¶â€å¤„ç†å¤šä¸ªä»»åŠ¡è€Œæå‡ºçš„è§£å†³æ–¹æ¡ˆã€‚åœ¨å•æ ¸CPUæ—¶ä»£ï¼Œé€šè¿‡&lt;strong&gt;æ—¶é—´ç‰‡è½®è½¬&lt;/strong&gt;ç­‰æŠ€æœ¯ï¼ŒCPUå¿«é€Ÿåœ°åœ¨å¤šä¸ªä»»åŠ¡é—´åˆ‡æ¢ã€‚ç”±äºåˆ‡æ¢é€Ÿåº¦æå¿«ï¼Œåœ¨ç”¨æˆ·çœ‹æ¥è¿™äº›ä»»åŠ¡åƒæ˜¯åœ¨åŒæ—¶å‰è¿›ï¼Œä½†æœ¬è´¨ä¸Šï¼Œåœ¨ä»»ä½•ä¸€ä¸ªç²¾ç¡®çš„æ—¶é—´ç‚¹ä¸Šï¼Œåªæœ‰ä¸€ä¸ªä»»åŠ¡åœ¨å ç”¨CPUèµ„æºã€‚å®ƒçš„ä¸»è¦ä»·å€¼åœ¨äº&lt;strong&gt;é¿å…CPUèµ„æºå› ç­‰å¾…ï¼ˆå¦‚ç­‰å¾…ç£ç›˜I/Oã€ç½‘ç»œå“åº”ï¼‰è€Œé—²ç½®&lt;/strong&gt;ï¼Œä»è€Œæå‡ç³»ç»Ÿçš„æ•´ä½“æ•ˆç‡å’Œå“åº”é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹¶è¡Œçš„æ ¸å¿ƒæ˜¯â€œåŒæ—¶æ‰§è¡Œâ€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¹¶è¡Œåˆ™å»ºç«‹åœ¨å¤šæ ¸CPUæˆ–åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç¡¬ä»¶åŸºç¡€ä¸Šï¼Œå®ƒè¿½æ±‚çš„æ˜¯å°†ä¸€ä¸ªå¤§ä»»åŠ¡åˆ†è§£æˆå¤šä¸ªå­ä»»åŠ¡ï¼Œå¹¶åˆ†é…ç»™ä¸åŒçš„è®¡ç®—å•å…ƒ&lt;strong&gt;çœŸæ­£åŒæ—¶å¤„ç†&lt;/strong&gt;ï¼Œä»è€Œç¼©çŸ­æ•´ä½“è®¡ç®—æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œå¯¹ä¸€ä¸ªåŒ…å«å¤§é‡æ•°æ®çš„æ•°ç»„è¿›è¡Œè¿ç®—ï¼Œå¯ä»¥å°†å…¶åˆ†æˆå‡ éƒ¨åˆ†ï¼Œç”±ä¸åŒçš„CPUæ ¸å¿ƒåŒæ—¶è®¡ç®—ï¼Œæœ€åæ±‡æ€»ç»“æœã€‚å®ƒçš„ç›®æ ‡æ˜¯&lt;strong&gt;æœ€å¤§åŒ–è®¡ç®—æ•ˆç‡&lt;/strong&gt;ï¼Œå¸¸ç”¨äºç§‘å­¦è®¡ç®—ã€å¤§æ•°æ®åˆ†æç­‰è®¡ç®—å¯†é›†å‹åœºæ™¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸¤è€…çš„å…³ç³»ï¼šå¹¶è¡Œæ˜¯å¹¶å‘çš„â€œçœŸå­é›†â€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼š&lt;strong&gt;å¹¶è¡Œæ˜¯å¹¶å‘çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œä½†å¹¶å‘ä¸ä¸€å®šåŒ…å«å¹¶è¡Œ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹¶å‘è€Œä¸å¹¶è¡Œ&lt;/strong&gt;ï¼šåœ¨å•æ ¸CPUä¸Šï¼Œä½ å¯ä»¥è¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼ˆå¹¶å‘ï¼‰ï¼Œä½†è¿™äº›çº¿ç¨‹åªèƒ½äº¤æ›¿æ‰§è¡Œï¼Œæ— æ³•çœŸæ­£åšåˆ°åŒä¸€æ—¶åˆ»ä¸€èµ·è¿è¡Œï¼ˆä¸å¹¶è¡Œï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹¶å‘ä¸”å¹¶è¡Œ&lt;/strong&gt;ï¼šåœ¨å¤šæ ¸CPUä¸Šï¼Œå¤šä¸ªçº¿ç¨‹ä¸ä»…å¯ä»¥è¢«å¹¶å‘åœ°è°ƒåº¦ç®¡ç†ï¼Œè¿˜å¯ä»¥è¢«åˆ†é…åˆ°ä¸åŒçš„æ ¸å¿ƒä¸Šå¹¶è¡Œæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå¹¶è¡Œçš„å®ç°é€šå¸¸éœ€è¦å¹¶å‘çš„è°ƒåº¦ç®¡ç†ä½œä¸ºæ”¯æ’‘ï¼Œè€Œå¹¶å‘çš„èƒ½åŠ›åˆ™é€šè¿‡å¹¶è¡Œå¾—ä»¥çœŸæ­£å‘æŒ¥ç¡¬ä»¶æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å®é™…åº”ç”¨ä¸­çš„ä½“ç°"&gt;ğŸ› ï¸ å®é™…åº”ç”¨ä¸­çš„ä½“ç°
&lt;/h3&gt;&lt;p&gt;åœ¨å®é™…ç¼–ç¨‹å’Œç³»ç»Ÿè®¾è®¡ä¸­ï¼Œè¿™ä¸¤ä¸ªæ¦‚å¿µæ— å¤„ä¸åœ¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœ¨ç¼–ç¨‹æ¨¡å‹ä¸­&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº¿ç¨‹ç¼–ç¨‹&lt;/strong&gt;æ˜¯å®ç°å¹¶å‘æœ€å¸¸è§çš„æ‰‹æ®µã€‚ä¸€ä¸ªè¿›ç¨‹å†…çš„å¤šä¸ªçº¿ç¨‹å…±äº«å†…å­˜ç©ºé—´ï¼Œä½¿å¾—é€šä¿¡ä¾¿æ·ï¼Œä½†ä¹Ÿå¸¦æ¥äº†çº¿ç¨‹å®‰å…¨ã€æ­»é”ç­‰æŒ‘æˆ˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥ç¼–ç¨‹&lt;/strong&gt;ï¼ˆå¦‚ä½¿ç”¨å›è°ƒã€Promiseã€async/awaitï¼‰æ˜¯å¦ä¸€ç§å¤„ç†é«˜å¹¶å‘I/Oæ“ä½œçš„é«˜æ•ˆæ¨¡å‹ï¼Œå®ƒé¿å…äº†çº¿ç¨‹é˜»å¡ï¼Œç”¨æ›´å°‘çš„èµ„æºå¤„ç†å¤§é‡è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœ¨ç³»ç»Ÿæ¶æ„ä¸Š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼ç³»ç»Ÿ&lt;/strong&gt;æ˜¯å¹¶å‘çš„ç»ˆæä½“ç°ï¼Œå°†åºå¤§çš„ä»»åŠ¡åˆ†å¸ƒåˆ°ç½‘ç»œä¸­æˆåƒä¸Šä¸‡çš„è®¡ç®—æœºä¸Šå¹¶è¡Œå¤„ç†ï¼Œå¦‚Hadoop/MapReduceæ¡†æ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-14"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;strong&gt;å¹¶å‘æ˜¯å…³äºâ€œç»“æ„â€çš„æ¦‚å¿µï¼Œè§£å†³çš„æ˜¯å¦‚ä½•è®¾è®¡ç¨‹åºä»¥ä¾¿èƒ½å¤„ç†å¤šä¸ªä»»åŠ¡ï¼›è€Œå¹¶è¡Œæ˜¯å…³äºâ€œæ‰§è¡Œâ€çš„æ¦‚å¿µï¼Œè§£å†³çš„æ˜¯å¦‚ä½•åˆ©ç”¨å¤šæ ¸èµ„æºæ¥åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç°ä»£å¤šæ ¸å¤„ç†å™¨æˆä¸ºæ ‡é…çš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬ç¼–å†™çš„ç¨‹åºå¾€å¾€éœ€è¦åŒæ—¶è€ƒè™‘å¹¶å‘å’Œå¹¶è¡Œï¼šå…ˆé€šè¿‡å¹¶å‘è®¾è®¡ï¼ˆå¦‚å¤šçº¿ç¨‹ï¼‰è®©ç¨‹åºå…·å¤‡å¤„ç†å¤šä»»åŠ¡çš„èƒ½åŠ›ï¼Œç„¶åä¾é ç¡¬ä»¶å¹¶è¡Œæ€§æ¥çœŸæ­£æå‡æ‰§è¡Œæ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°ç†è§£è¿™ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼å¦‚æœä½ å¯¹å…·ä½“çš„ç¼–ç¨‹å®ç°æˆ–æŸä¸ªåº”ç”¨åœºæ™¯æœ‰æ›´æ·±å…¥çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="åƒåœ¾å›æ”¶ä¸­çš„å¹¶è¡Œä¸å¹¶å‘"&gt;åƒåœ¾å›æ”¶ä¸­çš„å¹¶è¡Œä¸å¹¶å‘
&lt;/h2&gt;&lt;p&gt;æ‚¨å¯¹åƒåœ¾æ”¶é›†å™¨ä¸­â€œå¹¶è¡Œâ€å’Œâ€œå¹¶å‘â€æ¦‚å¿µçš„ç†è§£åŸºæœ¬æ˜¯æ­£ç¡®çš„ï¼Œè¿™ç¡®å®æ˜¯ç†è§£ç°ä»£åƒåœ¾æ”¶é›†å™¨å·¥ä½œåŸç†çš„å…³é”®ã€‚ä¸ºäº†æ›´æ¸…æ™°åœ°å±•ç¤ºå®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«å’Œè”ç³»ï¼Œæˆ‘å‡†å¤‡äº†ä¸‹é¢è¿™ä¸ªè¡¨æ ¼ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹¶å‘&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒå®šä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‡&lt;strong&gt;å¤šæ¡åƒåœ¾æ”¶é›†å™¨çº¿ç¨‹&lt;/strong&gt;ä¹‹é—´çš„å…³ç³»ï¼Œå³è¿™äº›çº¿ç¨‹&lt;strong&gt;åŒæ—¶å·¥ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‡&lt;strong&gt;åƒåœ¾æ”¶é›†å™¨çº¿ç¨‹&lt;/strong&gt;ä¸&lt;strong&gt;ç”¨æˆ·åº”ç”¨ç¨‹åºçº¿ç¨‹&lt;/strong&gt;ä¹‹é—´çš„å…³ç³»ï¼Œå³å®ƒä»¬&lt;strong&gt;åŒæ—¶è¿è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å·¥ä½œæ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šæ¡GCçº¿ç¨‹ååŒå·¥ä½œï¼Œä½†æ­¤æ—¶&lt;strong&gt;ç”¨æˆ·çº¿ç¨‹é€šå¸¸å¤„äºç­‰å¾…çŠ¶æ€ï¼ˆSTWï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;GCçº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹&lt;strong&gt;äº¤æ›¿æˆ–åŒæ—¶æ‰§è¡Œ&lt;/strong&gt;ï¼Œç”¨æˆ·çº¿ç¨‹æ— éœ€å®Œå…¨æš‚åœ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ©ç”¨å¤šæ ¸CPUèµ„æºï¼Œ&lt;strong&gt;åŠ é€Ÿå•æ¬¡åƒåœ¾å›æ”¶è¿‡ç¨‹&lt;/strong&gt;ï¼Œæå‡å›æ”¶æ•ˆç‡&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å‡å°‘åƒåœ¾æ”¶é›†å¯¼è‡´çš„åº”ç”¨ç¨‹åºåœé¡¿æ—¶é—´&lt;/strong&gt;ï¼Œæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³æ³¨ç„¦ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…³æ³¨åƒåœ¾æ”¶é›†ä»»åŠ¡æœ¬èº«çš„&lt;strong&gt;æ‰§è¡Œæ•ˆç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…³æ³¨åƒåœ¾æ”¶é›†è¿‡ç¨‹å¯¹åº”ç”¨ç¨‹åº&lt;strong&gt;å“åº”çš„å¹²æ‰°ç¨‹åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¯”å–»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¢æ´¾å¤šåæ¸…æ´å·¥ï¼ˆå¤šçº¿ç¨‹ï¼‰ä¸€èµ·&lt;strong&gt;å¿«é€Ÿ&lt;/strong&gt;æ‰“æ‰«ä¸€ä¸ªæˆ¿é—´ï¼Œä½†æ‰“æ‰«æ—¶æˆ¿é—´æš‚åœä½¿ç”¨ï¼ˆSTWï¼‰&lt;/td&gt;
&lt;td&gt;å®‰æ’æ¸…æ´å·¥åœ¨åŠå…¬å®¤æœ‰äººå·¥ä½œæ—¶&lt;strong&gt;ç©¿æ’è¿›è¡Œ&lt;/strong&gt;ä¿æ´ï¼Œå°½é‡ä¸å½±å“å¤§å®¶å·¥ä½œï¼ˆä½åœé¡¿ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¹¶è¡Œä¸å¹¶å‘å¦‚ä½•åä½œ"&gt;ğŸ”„ å¹¶è¡Œä¸å¹¶å‘å¦‚ä½•åä½œ
&lt;/h3&gt;&lt;p&gt;åœ¨å®é™…çš„åƒåœ¾æ”¶é›†å™¨ä¸­ï¼Œ&lt;strong&gt;å¹¶è¡Œå’Œå¹¶å‘å¾€å¾€æ˜¯ååŒå·¥ä½œçš„&lt;/strong&gt;ï¼Œä»¥è¾¾åˆ°æ›´å¥½çš„æ€§èƒ½æ•ˆæœã€‚ä»¥ç»å…¸çš„CMSæ”¶é›†å™¨ä¸ºä¾‹ï¼Œå®ƒçš„å·¥ä½œæµç¨‹å°±æ¸…æ™°åœ°å±•ç¤ºäº†è¿™ç§åä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°&lt;/strong&gt;é˜¶æ®µï¼šè¿™ä¸¤ä¸ªé˜¶æ®µæ˜¯ &lt;strong&gt;â€œå¹¶è¡Œâ€&lt;/strong&gt; çš„ã€‚å®ƒä»¬éœ€è¦æš‚åœæ‰€æœ‰ç”¨æˆ·çº¿ç¨‹ï¼ˆSTWï¼‰ï¼Œä½†ä¼šå¯ç”¨å¤šä¸ªGCçº¿ç¨‹æ¥å¿«é€Ÿå®Œæˆæ ‡è®°å·¥ä½œï¼Œä»¥ç¼©çŸ­åœé¡¿æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤&lt;/strong&gt;é˜¶æ®µï¼šè¿™ä¸¤ä¸ªé˜¶æ®µæ˜¯ &lt;strong&gt;â€œå¹¶å‘â€&lt;/strong&gt; çš„ã€‚GCçº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œè™½ç„¶è¿™ä¼šå› ä¸ºçº¿ç¨‹åˆ‡æ¢å ç”¨ä¸€éƒ¨åˆ†ç³»ç»Ÿèµ„æºï¼Œå¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºååé‡ç•¥æœ‰ä¸‹é™ï¼Œä½†å¥½å¤„æ˜¯åº”ç”¨ç¨‹åºåœ¨æ­¤æœŸé—´ä¸ä¼šå®Œå…¨å¡ä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;G1æ”¶é›†å™¨ä»¥åŠæ›´å…ˆè¿›çš„ZGCç­‰ï¼Œä¹Ÿéƒ½åœ¨ä¸åŒç¨‹åº¦ä¸Šç»“åˆäº†å¹¶è¡Œå’Œå¹¶å‘æŠ€æœ¯ï¼Œç›®æ ‡éƒ½æ˜¯åœ¨ä¿è¯é«˜ååé‡çš„åŒæ—¶ï¼Œå°½å¯èƒ½é™ä½åœé¡¿æ—¶é—´å¯¹ç”¨æˆ·ä½“éªŒçš„å½±å“ã€‚&lt;/p&gt;
&lt;h3 id="-æ€»ç»“ä¸å…³ç³»è¾¨æ"&gt;ğŸ’ æ€»ç»“ä¸å…³ç³»è¾¨æ
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œæ‚¨çš„ç†è§£æ˜¯å‡†ç¡®çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;å…³ä¹&lt;strong&gt;é€Ÿåº¦&lt;/strong&gt;ï¼Œå³â€œå¦‚ä½•åˆ©ç”¨æ›´å¤šèµ„æºï¼ˆå¤šçº¿ç¨‹ï¼‰æ›´å¿«åœ°å®ŒæˆGCä»»åŠ¡â€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘&lt;/strong&gt;å…³ä¹&lt;strong&gt;åœé¡¿&lt;/strong&gt;ï¼Œå³â€œå¦‚ä½•åœ¨è¿›è¡ŒGCæ—¶ï¼Œå°½å¯èƒ½åœ°ä¸å½±å“åº”ç”¨ç¨‹åºçš„æ­£å¸¸è¿è¡Œâ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;éœ€è¦ç‰¹åˆ«ç•™æ„çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªæ¦‚å¿µå¹¶éäº’æ–¥ã€‚&lt;strong&gt;å¹¶è¡Œæè¿°çš„æ˜¯GCçº¿ç¨‹é—´çš„å…³ç³»ï¼Œè€Œå¹¶å‘æè¿°çš„æ˜¯GCçº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹é—´çš„å…³ç³»&lt;/strong&gt;ã€‚ä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨å¯ä»¥åŒæ—¶æ˜¯å¹¶è¡Œçš„å’Œå¹¶å‘çš„ï¼Œä¾‹å¦‚ï¼Œå®ƒå¯èƒ½ä½¿ç”¨å¤šä¸ªçº¿ç¨‹ï¼ˆå¹¶è¡Œï¼‰æ¥æ‰§è¡Œä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘è¿è¡Œçš„ï¼ˆå¹¶å‘ï¼‰åƒåœ¾å›æ”¶ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©æ‚¨æ›´é€å½»åœ°ç†è§£è¿™ä¸¤ä¸ªé‡è¦æ¦‚å¿µï¼å¦‚æœæ‚¨å¯¹æŸä¸ªå…·ä½“çš„åƒåœ¾æ”¶é›†å™¨ï¼ˆå¦‚G1æˆ–ZGCï¼‰æ˜¯å¦‚ä½•å®ç°å¹¶è¡Œå’Œå¹¶å‘çš„æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="g1"&gt;G1
&lt;/h2&gt;&lt;p&gt;G1ï¼ˆGarbage-Firstï¼‰åƒåœ¾æ”¶é›†å™¨æ˜¯JVMä¸­ä¸€æ¬¾é‡Œç¨‹ç¢‘å¼çš„æ”¶é›†å™¨ï¼Œå®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯åœ¨å¤§å†…å­˜ã€å¤šå¤„ç†å™¨çš„æœåŠ¡å™¨ç¯å¢ƒä¸‹ï¼Œ&lt;strong&gt;å¹³è¡¡é«˜ååé‡ä¸ä½åœé¡¿æ—¶é—´&lt;/strong&gt;ã€‚è‡ªJDK 9èµ·ï¼ŒG1å·²æˆä¸ºé»˜è®¤çš„åƒåœ¾æ”¶é›†å™¨ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯ä»¥å¸®ä½ å¿«é€ŸæŠŠæ¡G1çš„æ ¸å¿ƒè½®å»“ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;G1 (Garbage-First) åƒåœ¾æ”¶é›†å™¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´&lt;/strong&gt;ï¼ŒåŒæ—¶å…¼é¡¾é«˜ååé‡ï¼Œé€‚ç”¨äºå¤§å †å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å †å†…å­˜å¸ƒå±€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å°†å †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ &lt;strong&gt;Region&lt;/strong&gt;ï¼Œæ‰“ç ´ä¼ ç»Ÿç‰©ç†åˆ†ä»£çš„è¿ç»­å†…å­˜å¸ƒå±€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–°ç”Ÿä»£ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼ˆåœ¨Regionå†…éƒ¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è€å¹´ä»£ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•´ä½“æ¥çœ‹æ˜¯&lt;strong&gt;æ ‡è®°-æ•´ç†&lt;/strong&gt;ï¼Œå±€éƒ¨ï¼ˆRegionä¹‹é—´ï¼‰æ˜¯&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è®°å¿†é›†ï¼ˆRSetï¼‰&lt;/strong&gt;ã€&lt;strong&gt;SATBï¼ˆSnapshot-At-The-Beginningï¼‰&lt;/strong&gt;ã€&lt;strong&gt;æ”¶é›†é›†åˆï¼ˆCSetï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å·¥ä½œæ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¹¶è¡Œ + å¹¶å‘ + STW&lt;/strong&gt;ï¼Œé€šè¿‡æ··åˆå›æ”¶ï¼ˆMixed GCï¼‰å›æ”¶éƒ¨åˆ†è€å¹´ä»£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡å“²å­¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼˜å…ˆå›æ”¶åƒåœ¾æ¯”ä¾‹æœ€é«˜ï¼ˆå³â€œä»·å€¼â€æœ€å¤§ï¼‰çš„Regionï¼Œæ•…åGarbage-First&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒæœºåˆ¶è§£æ"&gt;ğŸ”§ æ ¸å¿ƒæœºåˆ¶è§£æ
&lt;/h3&gt;&lt;p&gt;G1èƒ½å®ç°å…¶è®¾è®¡ç›®æ ‡ï¼Œå¾—ç›Šäºä»¥ä¸‹å‡ é¡¹æ ¸å¿ƒæœºåˆ¶ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Regionåˆ†åŒºæ¨¡å‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;G1å°†å †å†…å­˜åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°å›ºå®šï¼ˆé€šå¸¸ä¸º1MBè‡³32MBï¼‰çš„Regionã€‚æ¯ä¸ªRegionå¯ä»¥è¢«åŠ¨æ€æŒ‡å®šä¸ºEdenã€Survivorã€Oldæˆ–ç‰¹æ®Šçš„&lt;strong&gt;HumongousåŒºåŸŸ&lt;/strong&gt;ï¼ˆç”¨äºå­˜æ”¾å¤§å°è¶…è¿‡Regionå®¹é‡50%çš„å¤§å¯¹è±¡ï¼‰ã€‚è¿™ç§åˆ†åŒºä½¿å¾—G1å¯ä»¥é¿å…æ¯æ¬¡å›æ”¶æ•´ä¸ªå †ï¼Œè€Œæ˜¯æ ¹æ®è®¾å®šçš„åœé¡¿æ—¶é—´ç›®æ ‡ï¼Œé€‰æ‹©ä¸€éƒ¨åˆ†Regionè¿›è¡Œæ”¶é›†ï¼Œä»è€Œå®ç°åœé¡¿æ—¶é—´çš„å¯æ§æ€§ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è®°å¿†é›†ï¼ˆRemembered Set, RSetï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºå¯¹è±¡å¯èƒ½è·¨Regionå¼•ç”¨ï¼Œä¸ºé¿å…æ¯æ¬¡GCæ—¶æ‰«ææ•´ä¸ªå †ï¼ŒG1ä¸ºæ¯ä¸ªRegionç»´æŠ¤äº†ä¸€ä¸ªè®°å¿†é›†ï¼ˆRSetï¼‰ã€‚RSetæœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºç²¾ç¡®è®°å½•&lt;strong&gt;æ¥è‡ªå…¶ä»–Regionçš„å¯¹å½“å‰Regionå†…å¯¹è±¡çš„å¼•ç”¨&lt;/strong&gt;ã€‚å½“è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œåªéœ€æ‰«æRSetå³å¯ç¡®å®šå½“å‰Regionå†…å­˜æ´»å¯¹è±¡çš„å¼•ç”¨å…³ç³»ï¼Œå¤§å¤§æå‡äº†æ•ˆç‡ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SATBï¼ˆSnapshot-At-The-Beginningï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µï¼ŒG1é‡‡ç”¨SATBç®—æ³•ã€‚å®ƒåœ¨æ ‡è®°å¼€å§‹æ—¶ä¸ºå­˜æ´»å¯¹è±¡å»ºç«‹ä¸€ä¸ªé€»è¾‘å¿«ç…§ã€‚åœ¨å¹¶å‘æ ‡è®°è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰æ–°çš„å¼•ç”¨å…³ç³»äº§ç”Ÿï¼ˆå³å¯¹è±¡â€œç”±æ­»å˜æ´»â€ï¼‰ï¼Œ&lt;strong&gt;å†™å±éšœï¼ˆWrite Barrierï¼‰&lt;/strong&gt; ä¼šå°†è¿™äº›æ”¹å˜è®°å½•åˆ°SATBç¼“å†²åŒºã€‚åœ¨æœ€ç»ˆçš„é‡æ–°æ ‡è®°é˜¶æ®µï¼ŒG1ä¼šå¤„ç†è¿™äº›ç¼“å†²åŒºï¼Œç¡®ä¿ä¸ä¼šé”™è¯¯åœ°å›æ”¶åœ¨å¹¶å‘æ ‡è®°è¿‡ç¨‹ä¸­æ–°äº§ç”Ÿçš„å­˜æ´»å¯¹è±¡ï¼Œä»è€Œä¿è¯äº†æ ‡è®°çš„æ­£ç¡®æ€§ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ”¶é›†é›†åˆï¼ˆCollection Set, CSetï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;CSetæ˜¯&lt;strong&gt;å•æ¬¡GCæš‚åœä¸­è¦å›æ”¶çš„Regionçš„é›†åˆ&lt;/strong&gt;ã€‚G1ä¼šæ ¹æ®æ¯ä¸ªRegionä¸­åƒåœ¾çš„å¤šå°‘ï¼ˆå³å›æ”¶ä»·å€¼ï¼‰å’Œå›æ”¶æ‰€éœ€æˆæœ¬ï¼Œåœ¨ç”¨æˆ·è®¾å®šçš„æœ€å¤§åœé¡¿æ—¶é—´ï¼ˆ&lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;ï¼‰å†…ï¼Œé€‰æ‹©å›æ”¶ä»·å€¼æœ€é«˜çš„Regionç»„æˆCSetè¿›è¡Œå›æ”¶ã€‚è¿™æ­£æ˜¯â€œGarbage-Firstâ€åå­—çš„ç”±æ¥ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-g1çš„å·¥ä½œæµç¨‹"&gt;ğŸ”„ G1çš„å·¥ä½œæµç¨‹
&lt;/h3&gt;&lt;p&gt;G1çš„åƒåœ¾å›æ”¶æ´»åŠ¨ä¸»è¦åˆ†ä¸ºå‡ ç§ç±»å‹ï¼Œå…¶æ ¸å¿ƒæ˜¯&lt;strong&gt;å¹¶å‘æ ‡è®°å‘¨æœŸ&lt;/strong&gt;å’Œéšä¹‹è€Œæ¥çš„&lt;strong&gt;æ··åˆå›æ”¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹´è½»ä»£å›æ”¶ï¼ˆYoung GCï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“EdenåŒºè¢«å æ»¡æ—¶ï¼Œä¼šè§¦å‘ä¸€æ¬¡Young GCã€‚è¿™æ˜¯ä¸€ä¸ª&lt;strong&gt;STW&lt;/strong&gt;äº‹ä»¶ï¼Œé‡‡ç”¨å¤åˆ¶ç®—æ³•å°†EdenåŒºå’ŒSurvivoråŒºä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°æ–°çš„SurvivoråŒºï¼Œå¹´é¾„è¶³å¤Ÿå¤§çš„å¯¹è±¡åˆ™ä¼šæ™‹å‡åˆ°è€å¹´ä»£Region ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°å‘¨æœŸï¼ˆConcurrent Marking Cycleï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“æ•´ä¸ªå †çš„ä½¿ç”¨ç‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼ï¼ˆé»˜è®¤45%ï¼Œé€šè¿‡&lt;code&gt;-XX:InitiatingHeapOccupancyPercent&lt;/code&gt;è®¾ç½®ï¼‰æ—¶ï¼ŒG1ä¼šå¯åŠ¨ä¸€ä¸ªå¹¶å‘æ ‡è®°å‘¨æœŸã€‚è¿™ä¸ªå‘¨æœŸå¹¶ä¸ç«‹å³è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œè€Œæ˜¯ä¸ºåç»­çš„æ··åˆå›æ”¶åšå‡†å¤‡ï¼Œç›®çš„æ˜¯æ‰¾å‡ºè€å¹´ä»£ä¸­å“ªäº›Regionçš„åƒåœ¾æœ€å¤šã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªé˜¶æ®µ ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;ï¼š&lt;strong&gt;STW&lt;/strong&gt;ï¼Œæ ‡è®°ä»GC Rootsç›´æ¥å¯è¾¾çš„å¯¹è±¡ã€‚è¿™ä¸ªé˜¶æ®µé€šå¸¸å€Ÿé“äºä¸€æ¬¡Young GCï¼Œåœé¡¿æ—¶é—´å¾ˆçŸ­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¹åŒºåŸŸæ‰«æ&lt;/strong&gt;ï¼šæ‰«æSurvivoråŒºï¼ˆæ ¹åŒºåŸŸï¼‰ä¸­å¯¹è€å¹´ä»£çš„å¼•ç”¨ã€‚æ­¤é˜¶æ®µå¿…é¡»åœ¨ä¸‹ä¸€æ¬¡Young GCå‘ç”Ÿå‰å®Œæˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼šä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œéå†æ•´ä¸ªå¯¹è±¡å›¾ï¼Œæ ‡è®°æ‰€æœ‰å­˜æ´»å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆæ ‡è®°&lt;/strong&gt;ï¼š&lt;strong&gt;STW&lt;/strong&gt;ï¼Œå¤„ç†SATBç¼“å†²åŒºä¸­çš„è®°å½•ï¼Œå®Œæˆå­˜æ´»å¯¹è±¡çš„æœ€ç»ˆæ ‡è®°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…ç†&lt;/strong&gt;ï¼š&lt;strong&gt;STW&lt;/strong&gt;ï¼Œç»Ÿè®¡å„Regionçš„å­˜æ´»å¯¹è±¡æ¯”ä¾‹ï¼ˆæ´»è·ƒåº¦ï¼‰ï¼Œå¹¶å®Œå…¨æ¸…ç©ºçš„Regionä¼šç«‹åˆ»è¢«å›æ”¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ··åˆå›æ”¶ï¼ˆMixed GCï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¹¶å‘æ ‡è®°å‘¨æœŸç»“æŸåï¼ŒG1å¹¶ä¸ä¼šç«‹å³å›æ”¶æ‰€æœ‰è¢«æ ‡è®°ä¸ºå¯å›æ”¶çš„è€å¹´ä»£Regionã€‚ç›¸åï¼Œå®ƒä¼šå¯åŠ¨ä¸€ç³»åˆ—çš„Mixed GCã€‚åœ¨Mixed GCä¸­ï¼ŒCSetä¸ä»…åŒ…å«æ‰€æœ‰çš„å¹´è½»ä»£Regionï¼Œè¿˜ä¼šæ ¹æ®å¹¶å‘æ ‡è®°å‘¨æœŸå¾—åˆ°çš„æ•°æ®ï¼Œé€‰æ‹©ä¸€éƒ¨åˆ†&lt;strong&gt;åƒåœ¾æ¯”ä¾‹é«˜ï¼ˆå›æ”¶ä»·å€¼å¤§ï¼‰çš„è€å¹´ä»£Region&lt;/strong&gt;è¿›è¡Œå›æ”¶ã€‚G1ä¼šæŒç»­è¿›è¡ŒMixed GCï¼Œç›´åˆ°å‡ ä¹å›æ”¶æ‰æ‰€æœ‰åœ¨å¹¶å‘æ ‡è®°å‘¨æœŸä¸­è¯†åˆ«å‡ºçš„åƒåœ¾Regionï¼Œæˆ–è€…å¿«è¦è§¦å‘Full GCä¸ºæ­¢ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Full GC&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“G1åœ¨è¿›è¡Œåƒåœ¾å›æ”¶ï¼ˆå¦‚å¯¹è±¡å¤åˆ¶ï¼‰æ—¶é€Ÿåº¦è·Ÿä¸ä¸Šå¯¹è±¡åˆ†é…çš„é€Ÿåº¦ï¼Œæˆ–è€…å¹¶å‘æ ‡è®°å‘¨æœŸæœªèƒ½åŠæ—¶å®Œæˆå¯¼è‡´æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—²Regionæ—¶ï¼ŒG1ä¼šé€€åŒ–ä¸ºå•çº¿ç¨‹çš„Serial Oldæ”¶é›†å™¨è¿›è¡Œ&lt;strong&gt;Full GC&lt;/strong&gt;ã€‚è¿™æ˜¯ä¸€æ¬¡&lt;strong&gt;é•¿æ—¶é—´çš„STW&lt;/strong&gt;äº‹ä»¶ï¼Œä¼šå¯¹æ•´ä¸ªå †è¿›è¡Œæ ‡è®°-æ•´ç†ï¼Œåº”å°½åŠ›é€šè¿‡è°ƒä¼˜é¿å… ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯-1"&gt;âš–ï¸ ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯é¢„æµ‹çš„åœé¡¿&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;å‚æ•°è®¾å®šç›®æ ‡åœé¡¿æ—¶é—´ï¼ŒG1ä¼šå°½åŠ›è¾¾æˆ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜ååé‡ä¸ä½å»¶è¿Ÿçš„å¹³è¡¡&lt;/strong&gt;ï¼šåœ¨æä¾›ä½åœé¡¿çš„åŒæ—¶ï¼Œä¹Ÿä¿æŒäº†ä¸é”™çš„ååé‡ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰æ•ˆå¤„ç†å¤§å †&lt;/strong&gt;ï¼šRegionæ¨¡å‹å’Œå±€éƒ¨å¤åˆ¶ç®—æ³•ä½¿å…¶èƒ½æ›´é«˜æ•ˆåœ°ç®¡ç†å¤§å†…å­˜ï¼Œå‡å°‘å†…å­˜ç¢ç‰‡ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;ï¼šç»´æŠ¤RSetå’Œå¡è¡¨éœ€è¦å ç”¨é¢å¤–çš„å†…å­˜ç©ºé—´ï¼Œé€šå¸¸çº¦ä¸ºå †å¤§å°çš„10%åˆ°20% ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Full GCé£é™©&lt;/strong&gt;ï¼šåœ¨æç«¯æƒ…å†µä¸‹ï¼ˆå¦‚å¹¶å‘æ¨¡å¼å¤±è´¥ã€æ™‹å‡å¤±è´¥ï¼‰ï¼Œä»å¯èƒ½è§¦å‘è€—æ—¶çš„Full GC ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ååé‡ç•¥ä½&lt;/strong&gt;ï¼šä¸ä¸“æ³¨äºååé‡çš„Parallel GCç›¸æ¯”ï¼ŒG1çš„ååé‡ä¼šç•¥æœ‰æŸå¤± ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å †å†…å­˜è¾ƒå¤§ï¼ˆå¦‚&lt;strong&gt;6GBä»¥ä¸Š&lt;/strong&gt;ï¼‰çš„åº”ç”¨ ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹&lt;strong&gt;å“åº”æ—¶é—´æ•æ„Ÿ&lt;/strong&gt;ï¼Œå¸Œæœ›åƒåœ¾æ”¶é›†çš„åœé¡¿æ—¶é—´å¯æ§ï¼ˆå¦‚ç›®æ ‡åœ¨å‡ ç™¾æ¯«ç§’ä»¥å†…ï¼‰çš„æœåŠ¡ç«¯åº”ç”¨ ã€‚&lt;/li&gt;
&lt;li&gt;åº”ç”¨ä¸­å¯èƒ½å­˜åœ¨&lt;strong&gt;å¤§å¯¹è±¡åˆ†é…&lt;/strong&gt; ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å…³é”®è°ƒä¼˜å‚æ•°"&gt;âš™ï¸ å…³é”®è°ƒä¼˜å‚æ•°
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;å«ä¹‰ä¸ä½œç”¨&lt;/th&gt;
&lt;th&gt;å»ºè®®&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseG1GC&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯ç”¨G1åƒåœ¾æ”¶é›†å™¨&lt;/td&gt;
&lt;td&gt;å¿…å¤‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:MaxGCPauseMillis=200&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®¾å®š&lt;strong&gt;ç›®æ ‡æœ€å¤§åœé¡¿æ—¶é—´&lt;/strong&gt;ï¼ˆæ¯«ç§’ï¼‰ã€‚G1ä¼šå°½åŠ›å®ç°ï¼Œä½†ä¸ä¿è¯ã€‚&lt;/td&gt;
&lt;td&gt;é€šå¸¸è®¾ä¸º100-200msï¼Œéœ€æ ¹æ®å®é™…æ•ˆæœè°ƒæ•´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:InitiatingHeapOccupancyPercent=45&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®è§¦å‘å¹¶å‘æ ‡è®°å‘¨æœŸçš„&lt;strong&gt;å †å ç”¨é˜ˆå€¼&lt;/strong&gt;ï¼ˆç™¾åˆ†æ¯”ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;è‹¥å¹¶å‘æ ‡è®°é¢‘ç¹è¢«è§¦å‘ï¼Œå¯é€‚å½“é™ä½æ­¤å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:G1HeapRegionSize=16m&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®æ¯ä¸ª&lt;strong&gt;Regionçš„å¤§å°&lt;/strong&gt;ã€‚å¿…é¡»æ˜¯2çš„å¹‚æ¬¡æ–¹ã€‚&lt;/td&gt;
&lt;td&gt;é€šå¸¸JVMè‡ªåŠ¨è®¡ç®—ï¼Œå¤§å¯¹è±¡å¤šçš„åº”ç”¨å¯è€ƒè™‘å¢å¤§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:G1NewSizePercent=5&lt;/code&gt; &lt;code&gt;-XX:G1MaxNewSizePercent=60&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®&lt;strong&gt;å¹´è½»ä»£å æ¯”&lt;/strong&gt;çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼ˆç›¸å¯¹äºå †çš„ç™¾åˆ†æ¯”ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;G1ä¼šæ ¹æ®åœé¡¿ç›®æ ‡åŠ¨æ€è°ƒæ•´å¹´è½»ä»£å¤§å°åœ¨æ­¤èŒƒå›´å†…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ€»ç»“-15"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;G1åƒåœ¾æ”¶é›†å™¨é€šè¿‡å…¶é©å‘½æ€§çš„&lt;strong&gt;Regionåˆ†åŒºæ¨¡å‹&lt;/strong&gt;ã€&lt;strong&gt;åŸºäºä¼˜å…ˆçº§çš„å›æ”¶ç­–ç•¥&lt;/strong&gt;ä»¥åŠ&lt;strong&gt;å¹¶å‘æ ‡è®°å‘¨æœŸ&lt;/strong&gt;ï¼ŒæˆåŠŸåœ°åœ¨å¤§å†…å­˜ç¯å¢ƒä¸‹å®ç°äº†&lt;strong&gt;å¯é¢„æµ‹çš„ä½åœé¡¿&lt;/strong&gt;ï¼ŒåŒæ—¶ä¿æŒäº†è‰¯å¥½çš„ååé‡ã€‚å®ƒæ˜¯CMSæ”¶é›†å™¨çš„ç°ä»£æ›¿ä»£è€…ï¼Œå¯¹äºå¤§å¤šæ•°éœ€è¦å¹³è¡¡ååé‡å’Œå»¶è¿Ÿçš„æœåŠ¡ç«¯åº”ç”¨æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªç¨³å¥è€Œé«˜æ•ˆçš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£G1åƒåœ¾æ”¶é›†å™¨ã€‚å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„è°ƒä¼˜æˆ–ä¸å…¶ä»–æ”¶é›†å™¨çš„å¯¹æ¯”æœ‰æ›´å…·ä½“çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="aqs"&gt;AQS
&lt;/h2&gt;&lt;p&gt;AbstractQueuedSynchronizerï¼ˆAQSï¼‰æ˜¯Javaå¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent.locks&lt;/code&gt;ï¼‰çš„æ ¸å¿ƒåŸºç¡€æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç”¨äºæ„å»ºé”å’Œå…¶ä»–åŒæ­¥å™¨ï¼ˆå¦‚Semaphoreã€CountDownLatchç­‰ï¼‰çš„åº•å±‚åŸºç¡€è®¾æ–½ã€‚JUCåŒ…ä¸­å¤§å¤šæ•°åŒæ­¥å™¨éƒ½æ˜¯åŸºäºAQSå®ç°çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹æ•´ä½“è®¤çŸ¥ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†AQSçš„æ ¸å¿ƒæ„æˆã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ ¸å¿ƒç»„ä»¶&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒæ–¹æ³•ä¸æœºåˆ¶&lt;/th&gt;
&lt;th&gt;è®¾è®¡æ¨¡å¼ä¸æ€æƒ³&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒæ­¥çŠ¶æ€ï¼ˆstateï¼‰&lt;/strong&gt;ï¼šä¸€ä¸ª&lt;code&gt;volatile int&lt;/code&gt;å˜é‡ï¼Œè¡¨ç¤ºå…±äº«èµ„æºçš„çŠ¶æ€ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ¨¡æ¿æ–¹æ³•&lt;/strong&gt;ï¼šå¦‚&lt;code&gt;acquire(int arg)&lt;/code&gt;å’Œ&lt;code&gt;release(int arg)&lt;/code&gt;ï¼Œå®šä¹‰äº†åŒæ­¥é€»è¾‘çš„éª¨æ¶ï¼Œå°è£…äº†çº¿ç¨‹æ’é˜Ÿã€é˜»å¡å”¤é†’ç­‰é€šç”¨é€»è¾‘ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ¨¡æ¿æ–¹æ³•æ¨¡å¼&lt;/strong&gt;ï¼šå­ç±»åªéœ€å®ç°ç‰¹å®šæ–¹æ³•ï¼ˆå¦‚&lt;code&gt;tryAcquire&lt;/code&gt;ï¼‰æ¥æ§åˆ¶å¯¹stateçš„è®¿é—®ï¼ŒåŒæ­¥é˜Ÿåˆ—çš„ç»´æŠ¤ç­‰å¤æ‚å·¥ä½œç”±AQSåœ¨é¡¶å±‚å®Œæˆã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CLHåŒæ­¥é˜Ÿåˆ—&lt;/strong&gt;ï¼šä¸€ä¸ªFIFOçš„åŒå‘é˜Ÿåˆ—ï¼Œç”¨äºç®¡ç†è·å–èµ„æºå¤±è´¥çš„çº¿ç¨‹ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¯é‡å†™æ–¹æ³•&lt;/strong&gt;ï¼šå¦‚&lt;code&gt;tryAcquire(int)&lt;/code&gt;ã€&lt;code&gt;tryRelease(int)&lt;/code&gt;ï¼Œéœ€è¦å­ç±»æ ¹æ®å…±äº«æ¨¡å¼ï¼ˆç‹¬å æˆ–å…±äº«ï¼‰å®ç°ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å…³æ³¨ç‚¹åˆ†ç¦»&lt;/strong&gt;ï¼šå°†é€šç”¨çš„åŒæ­¥é˜Ÿåˆ—ç®¡ç†ï¼ˆAQSè´Ÿè´£ï¼‰ä¸ç‰¹å®šçš„èµ„æºè®¿é—®ç­–ç•¥ï¼ˆå­ç±»è´Ÿè´£ï¼‰åˆ†ç¦»ï¼Œæå¤§ç®€åŒ–äº†åŒæ­¥å™¨çš„å®ç°ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ConditionObject&lt;/strong&gt;ï¼šAQSçš„å†…éƒ¨ç±»ï¼Œç”¨äºå®ç°æ¡ä»¶å˜é‡ï¼Œæ”¯æŒå¤šä¸ªç­‰å¾…é˜Ÿåˆ—ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;CASæ“ä½œ&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;compareAndSetState&lt;/code&gt;ç­‰æ–¹æ³•åŸå­æ€§åœ°æ›´æ–°stateï¼Œä¿è¯çº¿ç¨‹å®‰å…¨ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†æ·±åº¦è§£æ"&gt;ğŸ”§ æ ¸å¿ƒåŸç†æ·±åº¦è§£æ
&lt;/h3&gt;&lt;p&gt;AQSçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶é”å®šèµ„æºã€‚å¦‚æœèµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€å¥—æœºåˆ¶æ¥é˜»å¡ç­‰å¾…çš„çº¿ç¨‹ä»¥åŠåˆ†é…èµ„æºã€‚è¿™å¥—æœºåˆ¶ä¸»è¦ä¾èµ–äº&lt;strong&gt;åŒæ­¥çŠ¶æ€ï¼ˆstateï¼‰&lt;/strong&gt; å’Œ&lt;strong&gt;CLHåŒæ­¥é˜Ÿåˆ—&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŒæ­¥çŠ¶æ€ï¼ˆStateï¼‰çš„ç®¡ç†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Stateæ˜¯AQSçš„çµé­‚ï¼Œå®ƒæ˜¯ä¸€ä¸ªä½¿ç”¨&lt;code&gt;volatile&lt;/code&gt;ä¿®é¥°çš„intå˜é‡ï¼Œè¡¨ç¤ºå…±äº«èµ„æºçš„çŠ¶æ€ã€‚AQSæä¾›äº†ä¸‰ç§åŸå­æ“ä½œæ–¹æ³•ä¾†è¯»å†™stateï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;getState()&lt;/code&gt;: è·å–å½“å‰åŒæ­¥çŠ¶æ€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;setState(int newState)&lt;/code&gt;: è®¾ç½®æ–°çš„åŒæ­¥çŠ¶æ€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;compareAndSetState(int expect, int update)&lt;/code&gt;: ä½¿ç”¨CASï¼ˆCompare-And-Swapï¼‰æ“ä½œåŸå­æ€§åœ°è®¾ç½®çŠ¶æ€ï¼Œè¿™æ˜¯å®ç°æ— é”å¹¶å‘æ§åˆ¶çš„å…³é”®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒçš„åŒæ­¥å™¨å¯¹stateçš„è¯­ä¹‰è§£é‡Šä¸åŒã€‚ä¾‹å¦‚ï¼Œåœ¨&lt;code&gt;ReentrantLock&lt;/code&gt;ä¸­ï¼Œstateè¡¨ç¤ºçº¿ç¨‹é‡å…¥é”çš„æ¬¡æ•°ï¼›åœ¨&lt;code&gt;Semaphore&lt;/code&gt;ä¸­ï¼Œstateè¡¨ç¤ºå¯ç”¨çš„è®¸å¯è¯æ•°é‡ï¼›åœ¨&lt;code&gt;CountDownLatch&lt;/code&gt;ä¸­ï¼Œstateè¡¨ç¤ºå€’è®¡æ•°çš„æ•°å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;CLHåŒæ­¥é˜Ÿåˆ—çš„å·¥ä½œæœºåˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“çº¿ç¨‹å°è¯•è·å–èµ„æºå¤±è´¥æ—¶ï¼ŒAQSä¼šå°†è¯¥çº¿ç¨‹å°è£…æˆä¸€ä¸ª&lt;strong&gt;NodeèŠ‚ç‚¹&lt;/strong&gt;ï¼Œå¹¶é€šè¿‡CASæ“ä½œå°†å…¶åŠ å…¥åˆ°CLHé˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç„¶åè¯¥çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼ˆé€šè¿‡&lt;code&gt;LockSupport.park&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;CLHé˜Ÿåˆ—æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—ï¼ˆå­˜åœ¨å¤´å°¾æŒ‡é’ˆï¼‰ã€‚æ¯ä¸ªNodeèŠ‚ç‚¹ä¿å­˜ç€çº¿ç¨‹çš„å¼•ç”¨å’ŒçŠ¶æ€ï¼ˆ&lt;code&gt;waitStatus&lt;/code&gt;ï¼‰ï¼ŒçŠ¶æ€åŒ…æ‹¬&lt;code&gt;SIGNAL&lt;/code&gt;ï¼ˆåç»§èŠ‚ç‚¹éœ€è¦è¢«å”¤é†’ï¼‰ã€&lt;code&gt;CANCELLED&lt;/code&gt;ï¼ˆçº¿ç¨‹å·²å–æ¶ˆï¼‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾èµ„æºåï¼Œä¼šå”¤é†’ï¼ˆé€šè¿‡&lt;code&gt;LockSupport.unpark&lt;/code&gt;ï¼‰é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆé€šå¸¸æ˜¯å¤´èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ï¼‰ï¼Œè¢«å”¤é†’çš„çº¿ç¨‹ä¼šå†æ¬¡å°è¯•è·å–èµ„æºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸¤ç§èµ„æºå…±äº«æ¨¡å¼"&gt;ğŸ”„ ä¸¤ç§èµ„æºå…±äº«æ¨¡å¼
&lt;/h3&gt;&lt;p&gt;AQSå®šä¹‰äº†ä¸¤ç§èµ„æºå…±äº«æ–¹å¼ï¼Œè¿™æ˜¯æ‰€æœ‰åŸºäºAQSçš„åŒæ­¥å™¨çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç‹¬å æ¨¡å¼ï¼ˆExclusiveï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æŒæœ‰èµ„æºï¼Œå¦‚&lt;code&gt;ReentrantLock&lt;/code&gt;ã€‚å­ç±»éœ€è¦å®ç°&lt;code&gt;tryAcquire(int)&lt;/code&gt;å’Œ&lt;code&gt;tryRelease(int)&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç‹¬å æ¨¡å¼åˆå¯åˆ†ä¸º&lt;strong&gt;å…¬å¹³é”&lt;/strong&gt;å’Œ&lt;strong&gt;éå…¬å¹³é”&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¹³é”&lt;/strong&gt;ï¼šåœ¨&lt;code&gt;tryAcquire&lt;/code&gt;æ—¶ï¼Œä¼šå…ˆæ£€æŸ¥CLHé˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹åœ¨ç­‰å¾…ã€‚å¦‚æœæœ‰ï¼Œåˆ™å½“å‰çº¿ç¨‹ç›´æ¥å…¥é˜Ÿç­‰å¾…ï¼Œä¿è¯&amp;quot;å…ˆæ¥ååˆ°&amp;quot;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éå…¬å¹³é”&lt;/strong&gt;ï¼šåœ¨&lt;code&gt;tryAcquire&lt;/code&gt;æ—¶ï¼Œæ— è®ºé˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ç­‰å¾…çº¿ç¨‹ï¼Œéƒ½ä¼šå…ˆå°è¯•ç›´æ¥è·å–èµ„æºã€‚è¿™å¯èƒ½å¯¼è‡´&amp;quot;æ’é˜Ÿ&amp;quot;ç°è±¡ï¼Œä½†ååé‡é€šå¸¸æ›´é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…±äº«æ¨¡å¼ï¼ˆShareï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åŒä¸€æ—¶é—´å…è®¸å¤šä¸ªçº¿ç¨‹è®¿é—®èµ„æºï¼Œå¦‚&lt;code&gt;Semaphore&lt;/code&gt;ã€&lt;code&gt;CountDownLatch&lt;/code&gt;ã€‚å­ç±»éœ€è¦å®ç°&lt;code&gt;tryAcquireShared(int)&lt;/code&gt;å’Œ&lt;code&gt;tryReleaseShared(int)&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œ&lt;code&gt;Semaphore&lt;/code&gt;åœ¨åˆå§‹åŒ–æ—¶è®¾ç½®stateä¸ºè®¸å¯è¯æ•°é‡ã€‚æ¯ä¸ªçº¿ç¨‹è·å–è®¸å¯è¯æ—¶ï¼Œstateå‡å°‘ï¼›é‡Šæ”¾æ—¶ï¼Œstateå¢åŠ ã€‚å½“stateä¸º0æ—¶ï¼Œåç»­çº¿ç¨‹æ— æ³•è·å–è®¸å¯è¯ï¼Œéœ€è¦ç­‰å¾…ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-åŸºäºaqsçš„åŒæ­¥å™¨å®ä¾‹"&gt;ğŸ› ï¸ åŸºäºAQSçš„åŒæ­¥å™¨å®ä¾‹
&lt;/h3&gt;&lt;p&gt;è®¸å¤šå¸¸ç”¨çš„JUCåŒæ­¥å·¥å…·éƒ½æ˜¯åŸºäºAQSæ„å»ºçš„ï¼Œå®ƒä»¬é€šè¿‡å®ç°ç‰¹å®šçš„&lt;code&gt;tryAcquire&lt;/code&gt;å’Œ&lt;code&gt;tryRelease&lt;/code&gt;æ–¹æ³•æ¥å®šä¹‰è‡ªå·±çš„åŒæ­¥è¯­ä¹‰ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åŒæ­¥å™¨&lt;/th&gt;
&lt;th&gt;ç±»å‹&lt;/th&gt;
&lt;th&gt;AQSåŒæ­¥çŠ¶æ€ï¼ˆstateï¼‰çš„è¯­ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ReentrantLock&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç‹¬å &lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºæŒæœ‰é”çš„çº¿ç¨‹çš„é‡å…¥æ¬¡æ•°ã€‚ä¸º0æ—¶è¡¨ç¤ºé”æœªè¢«ä»»ä½•çº¿ç¨‹æŒæœ‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Semaphore&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…±äº«&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºå¯ç”¨çš„è®¸å¯è¯æ•°é‡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CountDownLatch&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…±äº«&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºéœ€è¦ç­‰å¾…çš„è®¡æ•°ã€‚å½“è®¡æ•°å‡è‡³0æ—¶ï¼Œæ‰€æœ‰ç­‰å¾…çº¿ç¨‹è¢«é‡Šæ”¾ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ReentrantReadWriteLock&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸¤è€…ç»“åˆ&lt;/td&gt;
&lt;td&gt;stateçš„é«˜16ä½è¡¨ç¤ºè¯»é”çš„æŒæœ‰æ•°ï¼ˆå…±äº«ï¼‰ï¼Œä½16ä½è¡¨ç¤ºå†™é”çš„é‡å…¥æ¬¡æ•°ï¼ˆç‹¬å ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ€»ç»“ä¸ä»·å€¼"&gt;ğŸ’¡ æ€»ç»“ä¸ä»·å€¼
&lt;/h3&gt;&lt;p&gt;AQSä½œä¸ºJavaå¹¶å‘ç¼–ç¨‹çš„åŸºçŸ³ï¼Œå…¶ä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æä¾›äº†å¼ºå¤§çš„åŸºç¡€è®¾æ–½&lt;/strong&gt;ï¼šé€šè¿‡æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†å¤æ‚çš„çº¿ç¨‹æ’é˜Ÿã€é˜»å¡/å”¤é†’ç­‰åº•å±‚æ“ä½œå°è£…èµ·æ¥ï¼Œå¤§å¤§é™ä½äº†æ„å»ºå¯é ã€é«˜æ€§èƒ½åŒæ­¥å™¨çš„é—¨æ§›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿è¯äº†é«˜æ€§èƒ½&lt;/strong&gt;ï¼šå†…éƒ¨å¤§é‡ä½¿ç”¨CASæ“ä½œç­‰æ— é”æŠ€æœ¯ï¼Œå‡å°‘äº†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼Œä½¿å¾—åŸºäºAQSæ„å»ºçš„åŒæ­¥å™¨ï¼ˆå¦‚&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰åœ¨å¤šæ•°åœºæ™¯ä¸‹æ€§èƒ½ä¼˜äºä¼ ç»Ÿçš„&lt;code&gt;synchronized&lt;/code&gt;å…³é”®å­—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æä¾›äº†ä¸°å¯Œçš„çµæ´»æ€§&lt;/strong&gt;ï¼šæ”¯æŒç‹¬å å’Œå…±äº«ä¸¤ç§æ¨¡å¼ï¼Œä»¥åŠå…¬å¹³/éå…¬å¹³ç­–ç•¥ï¼Œå¯ä»¥çµæ´»åº”å¯¹å„ç§å¤æ‚çš„åŒæ­¥éœ€æ±‚ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£AQSã€‚å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šçš„åŒæ­¥å™¨ï¼ˆå¦‚&lt;code&gt;ReentrantLock&lt;/code&gt;æˆ–&lt;code&gt;CountDownLatch&lt;/code&gt;ï¼‰æ˜¯å¦‚ä½•åŸºäºAQSå®ç°çš„æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="clh-é˜Ÿåˆ—"&gt;CLH é˜Ÿåˆ—
&lt;/h2&gt;&lt;p&gt;CLHé˜Ÿåˆ—ï¼ˆCraig, Landin, and Hagersten lock queueï¼‰æ˜¯AQSï¼ˆAbstractQueuedSynchronizerï¼‰å†…éƒ¨ç”¨äºå®ç°çº¿ç¨‹åŒæ­¥çš„æ ¸å¿ƒæ•°æ®ç»“æ„ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª&lt;strong&gt;FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰çš„åŒå‘é“¾è¡¨&lt;/strong&gt;ï¼Œè´Ÿè´£ç®¡ç†æ‰€æœ‰ç­‰å¾…è·å–é”çš„çº¿ç¨‹ã€‚å…¶æ ¸å¿ƒä½¿å‘½æ˜¯ï¼Œå½“çº¿ç¨‹æ— æ³•ç«‹å³è·å–é”æ—¶ï¼Œèƒ½å¤Ÿå…¬å¹³ã€é«˜æ•ˆåœ°è®©çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œå¹¶åœ¨é”é‡Šæ”¾æ—¶æŒ‰åºå”¤é†’ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¯¹CLHé˜Ÿåˆ—çš„è¿ä½œæœ‰ä¸ªå¿«é€Ÿçš„æ•´ä½“å°è±¡ï¼Œä¸‹è¡¨æ¦‚æ‹¬äº†å…¶æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ ¸å¿ƒæ­¥éª¤ä¸ç›®æ ‡ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ“ä½œ&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒæ–¹æ³•&lt;/th&gt;
&lt;th&gt;å…³é”®æ­¥éª¤ä¸ç›®æ ‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ’å…¥ (å…¥é˜Ÿ)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;addWaiter(Node mode)&lt;/code&gt;å’Œ &lt;code&gt;enq(final Node node)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;1. &lt;strong&gt;åˆ›å»ºèŠ‚ç‚¹&lt;/strong&gt;ï¼šå°†å½“å‰çº¿ç¨‹åŒ…è£…æˆä¸€ä¸ªNodeèŠ‚ç‚¹ã€‚ 2. &lt;strong&gt;æ¥å…¥é˜Ÿåˆ—&lt;/strong&gt;ï¼šé€šè¿‡CASæ“ä½œå°†æ–°èŠ‚ç‚¹å®‰å…¨åœ°æ·»åŠ åˆ°é˜Ÿåˆ—å°¾éƒ¨ã€‚ 3. &lt;strong&gt;åˆå§‹åŒ–é˜Ÿåˆ—&lt;/strong&gt;ï¼ˆè‹¥å¿…è¦ï¼‰ï¼šå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å…ˆåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå¤´èŠ‚ç‚¹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ é™¤ (å‡ºé˜Ÿ)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;setHead(Node node)&lt;/code&gt;å’Œ &lt;code&gt;unparkSuccessor(Node node)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;1. &lt;strong&gt;è®¾ç½®æ–°å¤´&lt;/strong&gt;ï¼šè·å–é”æˆåŠŸçš„çº¿ç¨‹å¯¹åº”çš„èŠ‚ç‚¹æˆä¸ºæ–°çš„å¤´èŠ‚ç‚¹ï¼ˆ&lt;code&gt;setHead&lt;/code&gt;ï¼‰ã€‚ 2. &lt;strong&gt;å”¤é†’ç»§ä»»è€…&lt;/strong&gt;ï¼šæ–°çš„å¤´èŠ‚ç‚¹ä¼šå”¤é†’å…¶åç»§èŠ‚ç‚¹ä¸­çš„çº¿ç¨‹ï¼ˆ&lt;code&gt;unparkSuccessor&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ’å…¥æ“ä½œè¯¦è§£"&gt;ğŸ”§ æ’å…¥æ“ä½œè¯¦è§£
&lt;/h3&gt;&lt;p&gt;å½“çº¿ç¨‹å°è¯•è·å–é”ï¼ˆåŒæ­¥çŠ¶æ€ï¼‰å¤±è´¥æ—¶ï¼Œå°±éœ€è¦å°†è‡ªå·±åŠ å…¥åˆ°CLHé˜Ÿåˆ—çš„æœ«å°¾è¿›è¡Œç­‰å¾…ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸»è¦ç”± &lt;code&gt;addWaiter&lt;/code&gt;æ–¹æ³•å®Œæˆã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åˆ›å»ºèŠ‚ç‚¹&lt;/strong&gt;ï¼šé¦–å…ˆï¼ŒAQSä¼šä¸ºå½“å‰çº¿ç¨‹åˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;code&gt;Node&lt;/code&gt;å¯¹è±¡ã€‚è¿™ä¸ªèŠ‚ç‚¹æ ‡å¿—ç€è¯¥çº¿ç¨‹æ­£åœ¨æ’é˜Ÿç­‰å¾…ã€‚æ„é€ èŠ‚ç‚¹æ—¶ä¼šæŒ‡æ˜å…¶æ¨¡å¼æ˜¯ç‹¬å ï¼ˆ&lt;code&gt;Node.EXCLUSIVE&lt;/code&gt;ï¼‰è¿˜æ˜¯å…±äº«ï¼ˆ&lt;code&gt;Node.SHARED&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å°è¯•å¿«é€Ÿå…¥é˜Ÿ&lt;/strong&gt;ï¼š&lt;code&gt;addWaiter&lt;/code&gt;æ–¹æ³•ä¼šå…ˆå°è¯•ä¸€ä¸ªå¿«é€Ÿè·¯å¾„ã€‚å®ƒæ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦å·²ç»åˆå§‹åŒ–ï¼ˆå³ &lt;code&gt;tail&lt;/code&gt;æ˜¯å¦ä¸ä¸ºnullï¼‰ã€‚å¦‚æœå·²åˆå§‹åŒ–ï¼Œå®ƒä¼šå°è¯•é€šè¿‡&lt;strong&gt;CASï¼ˆCompare-And-Swapï¼‰&lt;/strong&gt; æ“ä½œ &lt;code&gt;compareAndSetTail&lt;/code&gt;ï¼Œå°†æ–°èŠ‚ç‚¹è®¾ç½®ä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚è¿™æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œç¡®ä¿åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æˆåŠŸåœ°å°†è‡ªå·±çš„èŠ‚ç‚¹è®¾ä¸ºå°¾èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ä»£ç é€»è¾‘ç¤ºæ„
Node node = new Node(Thread.currentThread(), mode);
Node pred = tail;
if (pred != null) {
node.prev = pred;
if (compareAndSetTail(pred, node)) {
pred.next = node;
return node;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®Œæ•´å…¥é˜Ÿï¼ˆå«åˆå§‹åŒ–ï¼‰&lt;/strong&gt;ï¼šå¦‚æœå¿«é€Ÿè·¯å¾„å¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œæˆ–è€…CASæ“ä½œå› ç«äº‰å¤±è´¥ï¼‰ï¼Œåˆ™ä¼šè°ƒç”¨ &lt;code&gt;enq&lt;/code&gt;æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•é‡‡ç”¨&lt;strong&gt;è‡ªæ—‹ï¼ˆå¾ªç¯ï¼‰&lt;/strong&gt; çš„æ–¹å¼ï¼Œç›´åˆ°æˆåŠŸå…¥é˜Ÿã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹åŒ–é˜Ÿåˆ—&lt;/strong&gt;ï¼šå¦‚æœå‘ç°é˜Ÿåˆ—æ˜¯ç©ºçš„ï¼ˆ&lt;code&gt;tail == null&lt;/code&gt;ï¼‰ï¼Œå®ƒä¼šå…ˆé€šè¿‡CASæ“ä½œåˆ›å»ºä¸€ä¸ªä¸åŒ…å«çº¿ç¨‹ä¿¡æ¯çš„&lt;strong&gt;è™šæ‹ŸèŠ‚ç‚¹ï¼ˆDummy Nodeï¼‰&lt;/strong&gt; ä½œä¸ºå¤´èŠ‚ç‚¹ï¼ˆ&lt;code&gt;head&lt;/code&gt;ï¼‰ï¼Œå¹¶è®©å°¾æŒ‡é’ˆï¼ˆ&lt;code&gt;tail&lt;/code&gt;ï¼‰ä¹ŸæŒ‡å‘è¿™ä¸ªè™šæ‹ŸèŠ‚ç‚¹ã€‚è¿™ä¸ªè™šæ‹ŸèŠ‚ç‚¹èµ·åˆ°äº†å ä½å’Œæ ‡è¯†é˜Ÿåˆ—èµ·å§‹çš„ä½œç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CASè®¾ç½®å°¾èŠ‚ç‚¹&lt;/strong&gt;ï¼šåœ¨é˜Ÿåˆ—åˆå§‹åŒ–åæˆ–æœ¬èº«å·²å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œ&lt;code&gt;enq&lt;/code&gt;æ–¹æ³•ä¼šä¸æ–­åœ°å°è¯•ç”¨CASå°†æ–°èŠ‚ç‚¹è®¾ç½®ä¸ºæ–°çš„å°¾èŠ‚ç‚¹ï¼Œå¹¶å»ºç«‹å¥½ &lt;code&gt;prev&lt;/code&gt;å’Œ &lt;code&gt;next&lt;/code&gt;æŒ‡é’ˆå…³ç³»ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-åˆ é™¤æ“ä½œè¯¦è§£"&gt;ğŸš€ åˆ é™¤æ“ä½œè¯¦è§£
&lt;/h3&gt;&lt;p&gt;å½“æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾èµ„æºåï¼Œéœ€è¦å°†CLHé˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªç­‰å¾…çº¿ç¨‹å”¤é†’ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸»è¦æ¶‰åŠå‡ºé˜Ÿæ“ä½œã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è®¾ç½®æ–°çš„å¤´èŠ‚ç‚¹&lt;/strong&gt;ï¼šå½“ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ï¼ˆé€šå¸¸æ˜¯ç”±å¤´èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ‰€ä»£è¡¨çš„çº¿ç¨‹ï¼‰æˆåŠŸè·å–åˆ°é”æ—¶ï¼ŒAQSä¼šè°ƒç”¨ &lt;code&gt;setHead(Node node)&lt;/code&gt;æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å°†å½“å‰è·å–é”çš„çº¿ç¨‹å¯¹åº”çš„èŠ‚ç‚¹æå‡ä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;private void setHead(Node node) {
head = node;
node.thread = null; // å› ä¸ºè¯¥çº¿ç¨‹å·²ç»è·å–é”ï¼Œä¸å†éœ€è¦è®°å½•åœ¨æ­¤
node.prev = null;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªæ“ä½œå®é™…ä¸Šæ˜¯&lt;strong&gt;ä¸€ç§é€»è¾‘ä¸Šçš„åˆ é™¤&lt;/strong&gt;ã€‚åŸæ¥çš„å¤´èŠ‚ç‚¹ï¼ˆè™šæ‹ŸèŠ‚ç‚¹æˆ–å‰ä¸€ä¸ªå·²å¤„ç†å®Œæ¯•çš„èŠ‚ç‚¹ï¼‰ä¼šè„±ç¦»é˜Ÿåˆ—ï¼Œè€Œæ–°è®¾ç½®çš„å¤´èŠ‚ç‚¹åˆ™æˆä¸ºäº†æ–°çš„è™šæ‹ŸèŠ‚ç‚¹ï¼ˆå…¶ &lt;code&gt;thread&lt;/code&gt;å±æ€§è¢«ç½®ä¸ºnullï¼‰ã€‚è¿™ç¡®ä¿äº†é˜Ÿåˆ—æ€»æ˜¯æœ‰ä¸€ä¸ªå¤´èŠ‚ç‚¹ï¼Œè€Œè·å–é”çš„çº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å”¤é†’åç»§çº¿ç¨‹&lt;/strong&gt;ï¼šé‡Šæ”¾é”çš„çº¿ç¨‹åœ¨æˆåŠŸé‡Šæ”¾èµ„æºåï¼Œä¼šè°ƒç”¨ &lt;code&gt;unparkSuccessor(Node node)&lt;/code&gt;æ–¹æ³•æ¥å”¤é†’é˜Ÿåˆ—ä¸­ä¸‹ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„ç­‰å¾…çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯¥æ–¹æ³•é¦–å…ˆä¼šæ£€æŸ¥å½“å‰èŠ‚ç‚¹çš„ç­‰å¾…çŠ¶æ€ï¼ˆ&lt;code&gt;waitStatus&lt;/code&gt;ï¼‰ï¼Œå¦‚æœä¸ºè´Ÿå€¼ï¼ˆå¦‚ &lt;code&gt;SIGNAL&lt;/code&gt;ï¼‰ï¼Œä¼šå°è¯•å°†å…¶é‡ç½®ä¸º0ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åï¼Œå®ƒä¼šä»å°¾èŠ‚ç‚¹å¼€å§‹&lt;strong&gt;å‘å‰éå†&lt;/strong&gt;ï¼ˆ&lt;code&gt;t = tail; t != null &amp;amp;&amp;amp; t != node; t = t.prev&lt;/code&gt;ï¼‰ï¼Œå¯»æ‰¾è·ç¦»å½“å‰èŠ‚ç‚¹æœ€è¿‘çš„ä¸€ä¸ªæœªè¢«å–æ¶ˆï¼ˆ&lt;code&gt;waitStatus &amp;lt;= 0&lt;/code&gt;ï¼‰çš„åç»§èŠ‚ç‚¹ã€‚ä¹‹æ‰€ä»¥ä»åå¾€å‰éå†ï¼Œæ˜¯å› ä¸ºåœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œä»å‰å¾€åéå†å¯èƒ½å› èŠ‚ç‚¹åˆšè¢«æ·»åŠ æˆ–&lt;code&gt;next&lt;/code&gt;æŒ‡é’ˆè¿˜æœªæ­£ç¡®è®¾ç½®è€Œé‡åˆ°é—®é¢˜ï¼Œå‘å‰éå†åˆ©ç”¨å·²ç¨³å®šçš„ &lt;code&gt;prev&lt;/code&gt;æŒ‡é’ˆæ›´å¯é ã€‚&lt;/li&gt;
&lt;li&gt;æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„åç»§èŠ‚ç‚¹åï¼Œä¾¿è°ƒç”¨ &lt;code&gt;LockSupport.unpark(s.thread)&lt;/code&gt;å”¤é†’è¯¥èŠ‚ç‚¹å¯¹åº”çš„çº¿ç¨‹ã€‚è¢«å”¤é†’çš„çº¿ç¨‹ä¼šå†æ¬¡å°è¯•è·å–é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ ¸å¿ƒæœºåˆ¶ä¸è®¾è®¡ä»·å€¼"&gt;ğŸ’ æ ¸å¿ƒæœºåˆ¶ä¸è®¾è®¡ä»·å€¼
&lt;/h3&gt;&lt;p&gt;CLHé˜Ÿåˆ—çš„æ’å…¥å’Œåˆ é™¤æ“ä½œç´§å¯†å›´ç»•ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒæœºåˆ¶ï¼Œè¿™ä¹Ÿæ˜¯å…¶é«˜æ•ˆå’Œå…¬å¹³çš„åŸºçŸ³ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CASæ“ä½œä¸çº¿ç¨‹å®‰å…¨&lt;/strong&gt;ï¼šå…¥é˜Ÿå’Œå‡ºé˜Ÿè¿‡ç¨‹ä¸­çš„å…³é”®æ­¥éª¤ï¼ˆå¦‚è®¾ç½®å°¾èŠ‚ç‚¹ã€ä¿®æ”¹èŠ‚ç‚¹çŠ¶æ€ï¼‰éƒ½ä¾èµ–äºCASæ“ä½œã€‚è¿™æ˜¯ä¸€ç§ä¹è§‚é”æœºåˆ¶ï¼Œèƒ½å¤Ÿåœ¨æ— é”çš„æƒ…å†µä¸‹ä¿è¯å¹¶å‘ä¿®æ”¹çš„å®‰å…¨æ€§ï¼Œé¿å…äº†ä½¿ç”¨é‡é‡çº§åŒæ­¥å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªæ—‹é‡è¯•&lt;/strong&gt;ï¼šå½“CASæ“ä½œå¤±è´¥æ—¶ï¼Œçº¿ç¨‹å¹¶ä¸ä¼šè¢«æŒ‚èµ·ï¼Œè€Œæ˜¯ä¼šåœ¨å¾ªç¯ä¸­ä¸æ–­é‡è¯•ï¼ˆè‡ªæ—‹ï¼‰ï¼Œç›´åˆ°æˆåŠŸã€‚è¿™åœ¨å¤šæ ¸CPUç¯å¢ƒä¸‹ï¼Œå¯¹äºçŸ­æ—¶é—´çš„ç«äº‰éå¸¸é«˜æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;FIFOä¸å…¬å¹³æ€§&lt;/strong&gt;ï¼šç”±äºé˜Ÿåˆ—æ˜¯ä¸¥æ ¼æŒ‰FIFOé¡ºåºå¤„ç†çš„ï¼Œå®ƒä¿è¯äº†ç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹ä¼šæœ€å…ˆè·å¾—é”ï¼Œå®ç°äº†å…¬å¹³çš„é”è·å–ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è™šæ‹Ÿå¤´èŠ‚ç‚¹&lt;/strong&gt;ï¼šåˆå§‹åŒ–æ—¶çš„è™šæ‹Ÿå¤´èŠ‚ç‚¹ç®€åŒ–äº†è¾¹ç•Œæ¡ä»¶çš„å¤„ç†ï¼Œä½¿å¾—æ— è®ºé˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå¯¹å¤´èŠ‚ç‚¹çš„æ“ä½œéƒ½æœ‰ä¸€è‡´çš„é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼ŒCLHé˜Ÿåˆ—é€šè¿‡ç²¾å·§çš„é“¾è¡¨ç»“æ„å’Œæ— é”ç¼–ç¨‹æŠ€æœ¯ï¼ˆä¸»è¦æ˜¯CASï¼‰ï¼Œä¸ºAQSæä¾›äº†ä¸€å¥—é«˜æ•ˆã€å…¬å¹³ä¸”å¯æ‰©å±•çš„çº¿ç¨‹æ’é˜Ÿæœºåˆ¶ã€‚ç†è§£å…¶æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œæ˜¯æ·±å…¥æŒæ¡Javaå¹¶å‘åŒ…ä¸­å„ç§åŒæ­¥å·¥å…·ï¼ˆå¦‚ &lt;code&gt;ReentrantLock&lt;/code&gt;, &lt;code&gt;Semaphore&lt;/code&gt;ï¼‰å·¥ä½œåŸç†çš„å…³é”®ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ é€å½»åœ°ç†è§£CLHé˜Ÿåˆ—çš„è¿ä½œæœºåˆ¶ã€‚å¦‚æœä½ å¯¹AQSçš„å…¶ä»–æ–¹é¢æˆ–è€…ä¸ç‰¹å®šåŒæ­¥å™¨çš„ç»“åˆåº”ç”¨æœ‰è¿›ä¸€æ­¥çš„å…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="çº¿ç¨‹æ± "&gt;çº¿ç¨‹æ± 
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;å‚æ•°&lt;/th&gt;
&lt;th style="text-align: left"&gt;ä½œç”¨&lt;/th&gt;
&lt;th style="text-align: left"&gt;é…ç½®å»ºè®®&lt;/th&gt;
&lt;th style="text-align: left"&gt;å…¸å‹åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;corePoolSize&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ± é•¿æœŸä¿æŒçš„æœ€å°çº¿ç¨‹æ•°&lt;/td&gt;
&lt;td style="text-align: left"&gt;CPU å¯†é›†å‹ä»»åŠ¡è®¾ä¸º CPU æ ¸å¿ƒæ•°ï¼›I/O å¯†é›†å‹ä»»åŠ¡è®¾ä¸º2 * CPU æ ¸å¿ƒæ•°&lt;/td&gt;
&lt;td style="text-align: left"&gt;é«˜å¹¶å‘ I/O ä»»åŠ¡ï¼ˆå¦‚ Web æœåŠ¡å™¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;maximumPoolSize&lt;/td&gt;
&lt;td style="text-align: left"&gt;æœ€å¤§çº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ± å…è®¸çš„æœ€å¤§å¹¶å‘çº¿ç¨‹æ•°&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ ¹æ®ç³»ç»Ÿèµ„æºï¼ˆå†…å­˜ã€CPUï¼‰å’Œä»»åŠ¡ç±»å‹è°ƒæ•´ï¼Œé¿å…èµ„æºè€—å°½&lt;/td&gt;
&lt;td style="text-align: left"&gt;çªå‘æµé‡åœºæ™¯ï¼ˆå¦‚ç§’æ€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;keepAliveTime&lt;/td&gt;
&lt;td style="text-align: left"&gt;éæ ¸å¿ƒçº¿ç¨‹ç©ºé—²å­˜æ´»æ—¶é—´&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç»“åˆä»»åŠ¡é—´éš”è®¾ç½®ï¼ˆå¦‚ 60 ç§’ï¼‰ï¼ŒåŠæ—¶å›æ”¶ç©ºé—²çº¿ç¨‹&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä½é¢‘ä»»åŠ¡ï¼ˆå¦‚å®šæ—¶ä»»åŠ¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;unit&lt;/td&gt;
&lt;td style="text-align: left"&gt;keepAliveTimeçš„æ—¶é—´å•ä½&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¸¸ç”¨TimeUnit.SECONDSæˆ–TimeUnit.MILLISECONDS&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¸ä¸šåŠ¡éœ€æ±‚åŒ¹é…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;workQueue&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä»»åŠ¡é˜Ÿåˆ—ï¼Œå­˜æ”¾å¾…æ‰§è¡Œçš„ä»»åŠ¡&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¼˜å…ˆä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼ˆå¦‚LinkedBlockingQueueï¼‰ï¼Œé¿å…å†…å­˜æº¢å‡º&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä»»åŠ¡é‡æ³¢åŠ¨è¾ƒå¤§çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;threadFactory&lt;/td&gt;
&lt;td style="text-align: left"&gt;çº¿ç¨‹å·¥å‚ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹&lt;/td&gt;
&lt;td style="text-align: left"&gt;è‡ªå®šä¹‰çº¿ç¨‹åç§°ã€ä¼˜å…ˆçº§ç­‰ï¼Œä¾¿äºç›‘æ§å’Œè°ƒè¯•&lt;/td&gt;
&lt;td style="text-align: left"&gt;éœ€è¿½è¸ªçº¿ç¨‹æ¥æºçš„ç”Ÿäº§ç¯å¢ƒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;handler&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ‹’ç»ç­–ç•¥ï¼Œå½“é˜Ÿåˆ—æ»¡ä¸”çº¿ç¨‹æ•°è¾¾ä¸Šé™æ—¶çš„å¤„ç†æ–¹å¼&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©ç­–ç•¥ï¼ˆå¦‚ä¸¢å¼ƒã€æŠ›å‡ºå¼‚å¸¸ã€ç”±è°ƒç”¨çº¿ç¨‹æ‰§è¡Œï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;é«˜è´Ÿè½½ä¸‹çš„å®¹é”™å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;ç­–ç•¥&lt;/th&gt;
&lt;th style="text-align: left"&gt;è¡Œä¸º&lt;/th&gt;
&lt;th style="text-align: left"&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;AbortPolicyï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;æŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸&lt;/td&gt;
&lt;td style="text-align: left"&gt;éœ€å¿«é€Ÿå¤±è´¥å¹¶è®°å½•æ—¥å¿—çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;CallerRunsPolicy&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç”±æäº¤ä»»åŠ¡çš„çº¿ç¨‹ç›´æ¥æ‰§è¡Œä»»åŠ¡&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä»»åŠ¡å¯é™çº§å¤„ç†çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;DiscardPolicy&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç›´æ¥ä¸¢å¼ƒä»»åŠ¡ï¼Œä¸æŠ›å‡ºå¼‚å¸¸&lt;/td&gt;
&lt;td style="text-align: left"&gt;å¯å®¹å¿ä»»åŠ¡ä¸¢å¤±çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;DiscardOldestPolicy&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¸¢å¼ƒé˜Ÿåˆ—å¤´éƒ¨ä»»åŠ¡ï¼Œå°è¯•é‡æ–°æäº¤å½“å‰ä»»åŠ¡&lt;/td&gt;
&lt;td style="text-align: left"&gt;éœ€ä¼˜å…ˆå¤„ç†æ–°ä»»åŠ¡çš„åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="jvm-çº¿ç¨‹"&gt;JVM çº¿ç¨‹
&lt;/h2&gt;&lt;p&gt;ç°ä»£ä¸»æµå®ç°ï¼ˆå¦‚HotSpotï¼‰é‡‡ç”¨1:1æ¨¡å‹ç›´æ¥æ˜ å°„æ“ä½œç³»ç»Ÿå†…æ ¸çº¿ç¨‹ã€‚åŒºåˆ«åœ¨äºï¼š1.æŠ½è±¡å±‚æ¬¡ä¸åŒï¼ˆJVMç®¡ç†çŠ¶æ€/ä¼˜å…ˆçº§ï¼Œæ“ä½œç³»ç»Ÿå®é™…è°ƒåº¦ï¼‰ï¼›2.éƒ¨åˆ†ç‰¹æ€§ä¸å®Œå…¨å¯¹åº”ï¼ˆå¦‚ä¸­æ–­æœºåˆ¶ï¼‰ï¼›3.JVMå¯èƒ½ä¼˜åŒ–çº¿ç¨‹åˆ›å»º/é”€æ¯è¿‡ç¨‹ã€‚æœ€ç»ˆæ‰§è¡Œä»ä¾èµ–æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œä½†æä¾›è·¨å¹³å°ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;ç»´åº¦&lt;/th&gt;
&lt;th style="text-align: left"&gt;Java çº¿ç¨‹&lt;/th&gt;
&lt;th style="text-align: left"&gt;æ“ä½œç³»ç»Ÿçº¿ç¨‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;è°ƒåº¦ä¸»ä½“&lt;/td&gt;
&lt;td style="text-align: left"&gt;JVM è´Ÿè´£çº¿ç¨‹çŠ¶æ€ç®¡ç†ï¼ˆå¦‚start()/stop()ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ“ä½œç³»ç»Ÿå†…æ ¸ç›´æ¥è°ƒåº¦ï¼ˆé€šè¿‡æ—¶é—´ç‰‡è½®è½¬ã€ä¼˜å…ˆçº§ç­‰ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;èµ„æºå¼€é”€&lt;/td&gt;
&lt;td style="text-align: left"&gt;åˆ›å»º/é”€æ¯æˆæœ¬ä½ï¼ˆJVM æŠ½è±¡å°è£…ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;åˆ›å»º/é”€æ¯æˆæœ¬é«˜ï¼ˆéœ€å†…æ ¸åˆ†é… TCBã€æ ˆç©ºé—´ç­‰ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;åŒæ­¥æœºåˆ¶&lt;/td&gt;
&lt;td style="text-align: left"&gt;æä¾›synchronizedã€Lockç­‰é«˜çº§æ¥å£&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¾èµ–ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚ä¿¡å·é‡ã€äº’æ–¥é”ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;è·¨å¹³å°æ€§&lt;/td&gt;
&lt;td style="text-align: left"&gt;çº¿ç¨‹è¡Œä¸ºä¸æ“ä½œç³»ç»Ÿæ— å…³ï¼ˆJVM å±è”½å·®å¼‚ï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;è¡Œä¸ºä¾èµ–å…·ä½“å†…æ ¸å®ç°ï¼ˆå¦‚ Linux çš„è°ƒåº¦ç­–ç•¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç”± JVM ç®¡ç†ï¼ˆå¦‚ GC å›æ”¶çº¿ç¨‹æ ˆï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç”±å†…æ ¸ç®¡ç†ï¼ˆå¦‚çº¿ç¨‹é˜»å¡ã€ç»ˆæ­¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;Java çº¿ç¨‹çŠ¶æ€&lt;/th&gt;
&lt;th style="text-align: left"&gt;å¯¹åº”æ“ä½œç³»ç»Ÿçº¿ç¨‹çŠ¶æ€&lt;/th&gt;
&lt;th style="text-align: left"&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;NEW&lt;/td&gt;
&lt;td style="text-align: left"&gt;æœªåˆ›å»º&lt;/td&gt;
&lt;td style="text-align: left"&gt;Java çº¿ç¨‹å¯¹è±¡å·²å®ä¾‹åŒ–ï¼Œä½†æœªè°ƒç”¨start()ï¼Œåº•å±‚å†…æ ¸çº¿ç¨‹æœªåˆ›å»ºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;RUNNABLE&lt;/td&gt;
&lt;td style="text-align: left"&gt;å°±ç»ªï¼ˆReadyï¼‰æˆ–è¿è¡Œï¼ˆRunningï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;è¡¨ç¤º Java çº¿ç¨‹å·²å¯åŠ¨ï¼Œå¯èƒ½æ­£åœ¨ CPU ä¸Šæ‰§è¡Œï¼ˆè¿è¡Œï¼‰æˆ–ç­‰å¾…è°ƒåº¦ï¼ˆå°±ç»ªï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;BLOCKED&lt;/td&gt;
&lt;td style="text-align: left"&gt;é˜»å¡ï¼ˆBlockedï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å› ç«äº‰é”ï¼ˆå¦‚synchronizedï¼‰è¢«æŒ‚èµ·ï¼Œç­‰å¾…é”é‡Šæ”¾ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;WAITING/TIMED_WAITING&lt;/td&gt;
&lt;td style="text-align: left"&gt;é˜»å¡ï¼ˆBlockedï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;å› wait()ã€join()ã€sleep()ç­‰æ–¹æ³•ä¸»åŠ¨æŒ‚èµ·ï¼Œç­‰å¾…ç‰¹å®šæ¡ä»¶ï¼ˆå¦‚è¶…æ—¶ã€é€šçŸ¥ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;TERMINATED&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç»ˆæ­¢ï¼ˆTerminatedï¼‰&lt;/td&gt;
&lt;td style="text-align: left"&gt;çº¿ç¨‹æ‰§è¡Œç»“æŸï¼Œåº•å±‚å†…æ ¸çº¿ç¨‹å·²é”€æ¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="interrupted"&gt;Interrupted
&lt;/h2&gt;&lt;p&gt;Java çš„ &lt;code&gt;InterruptedException&lt;/code&gt;è¢«è®¾è®¡ä¸ºå—æ£€å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰ï¼Œè¿™èƒŒåä½“ç°äº† Java è¯­è¨€å¯¹å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­&lt;strong&gt;åä½œå¼ä¸­æ–­æœºåˆ¶&lt;/strong&gt;å’Œ&lt;strong&gt;ä»£ç å¥å£®æ€§&lt;/strong&gt;çš„è€ƒé‡ã€‚ä¸‹é¢çš„è¡¨æ ¼æ¸…æ™°åœ°å±•ç¤ºäº†å—æ£€å¼‚å¸¸ä¸éå—æ£€å¼‚å¸¸çš„æ ¸å¿ƒåŒºåˆ«ï¼Œè¿™æœ‰åŠ©äºç†è§£ &lt;code&gt;InterruptedException&lt;/code&gt;çš„å®šä½ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;å—æ£€å¼‚å¸¸ (Checked Exception)&lt;/th&gt;
&lt;th&gt;éå—æ£€å¼‚å¸¸ (Unchecked Exception)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡åˆè¡·&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤„ç†&lt;strong&gt;å¯é¢„è§çš„ã€å¯æ¢å¤çš„&lt;/strong&gt;å¤–éƒ¨é—®é¢˜&lt;/td&gt;
&lt;td&gt;ä»£è¡¨é€šå¸¸æ˜¯&lt;strong&gt;ç¨‹åºå‘˜çš„ç¼–ç é”™è¯¯&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤„ç†è¦æ±‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘å™¨å¼ºåˆ¶è¦æ±‚æ•è·æˆ–å£°æ˜æŠ›å‡º&lt;/td&gt;
&lt;td&gt;ä¸å¼ºåˆ¶å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–‡ä»¶æœªæ‰¾åˆ°ã€ç½‘ç»œä¸­æ–­ã€æ•°æ®åº“è¿æ¥å¤±è´¥&lt;/td&gt;
&lt;td&gt;ç©ºæŒ‡é’ˆã€æ•°ç»„è¶Šç•Œã€ç±»å‹è½¬æ¢é”™è¯¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ä¸ºä½•æ˜¯å—æ£€å¼‚å¸¸"&gt;ğŸ’¡ ä¸ºä½•æ˜¯å—æ£€å¼‚å¸¸
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;InterruptedException&lt;/code&gt;è¢«å®šä¹‰ä¸ºå—æ£€å¼‚å¸¸ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹æ ¸å¿ƒåŸå› ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¼ºåˆ¶å¤„ç†ï¼Œé¿å…å¿½ç•¥&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸­æ–­ä¿¡å·æ˜¯çº¿ç¨‹é—´ä¸€ç§é‡è¦çš„åä½œé€šä¿¡æœºåˆ¶ï¼Œç”¨äºè¯·æ±‚ç›®æ ‡çº¿ç¨‹ä¼˜é›…åœæ­¢ã€‚å¦‚æœ &lt;code&gt;InterruptedException&lt;/code&gt;æ˜¯éå—æ£€å¼‚å¸¸ï¼Œå¼€å‘è€…å¾ˆå¯èƒ½ä¼šåœ¨ç¼–å†™ä»£ç æ—¶å¿½ç•¥å®ƒï¼Œæˆ–è€…ç”¨å®½æ³›çš„ &lt;code&gt;catch (Exception e)&lt;/code&gt;å°†å…¶æ— å£°åœ°â€œåå™¬â€æ‰ã€‚è¿™ä¼šå¯¼è‡´ä¸­æ–­è¯·æ±‚è¢«å¿½ç•¥ï¼Œçº¿ç¨‹æ— æ³•æ­£ç¡®å“åº”åœæ­¢è¯·æ±‚ï¼Œå¯èƒ½é€ æˆèµ„æºæ— æ³•é‡Šæ”¾æˆ–ä»»åŠ¡æ— æ³•æ­£å¸¸ç»“æŸã€‚ç¼–è¯‘å™¨å¼ºåˆ¶ä½ å¤„ç†å®ƒï¼Œå°±æ˜¯ä¸ºäº†æé†’ä½ ï¼š&lt;strong&gt;â€œè¿™é‡Œæœ‰ä¸€ä¸ªé‡è¦çš„å¤–éƒ¨äº‹ä»¶ï¼ˆä¸­æ–­è¯·æ±‚ï¼‰å‘ç”Ÿï¼Œä½ å¿…é¡»è€ƒè™‘å¦‚ä½•åº”å¯¹â€&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ˜ç¡®çš„æ¢å¤è¯­ä¹‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹è¢«ä¸­æ–­æ˜¯ä¸€ä¸ª&lt;strong&gt;å¯é¢„æœŸçš„å¤–éƒ¨äº‹ä»¶&lt;/strong&gt;ï¼Œè€Œéç¨‹åºå†…éƒ¨çš„é€»è¾‘é”™è¯¯ã€‚å®ƒé€šå¸¸æ„å‘³ç€å¤–éƒ¨ç¯å¢ƒå¸Œæœ›å½“å‰ä»»åŠ¡èƒ½åœæ­¢ï¼Œä¾‹å¦‚ç”¨æˆ·å–æ¶ˆäº†æ“ä½œã€ç³»ç»Ÿæ­£åœ¨å…³é—­æˆ–çº¿ç¨‹æ± éœ€è¦ç»ˆæ­¢ä»»åŠ¡ã€‚è¿™å±äºä¸€ç§å¯ä»¥ä¸”åº”è¯¥è¢«ç®¡ç†çš„â€œæ­£å¸¸â€å¼‚å¸¸æƒ…å†µã€‚å°†å…¶è®¾ä¸ºå—æ£€å¼‚å¸¸ï¼Œç¬¦åˆå…¶â€œå¯æ¢å¤â€çš„ç‰¹æ€§å®šä½ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¿éšœèµ„æºæ¸…ç†ä¸çŠ¶æ€å®‰å…¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸ &lt;code&gt;Thread.stop()&lt;/code&gt;è¿™ç§è¢«åºŸå¼ƒçš„å¼ºåˆ¶ç»ˆæ­¢æ–¹å¼ä¸åŒï¼Œä¸­æ–­æœºåˆ¶æ˜¯åä½œå¼çš„ã€‚ç›®æ ‡çº¿ç¨‹æ”¶åˆ°ä¸­æ–­ä¿¡å·åï¼Œæœ‰æœºä¼šæ‰§è¡Œæ¸…ç†å·¥ä½œï¼ˆå¦‚å…³é—­æ–‡ä»¶ã€é‡Šæ”¾é”ã€å›æ»šäº‹åŠ¡ç­‰ï¼‰ï¼Œä»è€Œå®‰å…¨åœ°ç»“æŸä»»åŠ¡ã€‚å—æ£€å¼‚å¸¸çš„ç‰¹æ€§å¼ºåˆ¶å¼€å‘è€…å¿…é¡»ç¼–å†™å¤„ç†ä»£ç ï¼ˆé€šå¸¸åœ¨ &lt;code&gt;catch&lt;/code&gt;å—ä¸­ï¼‰ï¼Œè¿™ä¸ºæ‰§è¡Œè¿™äº›æ¸…ç†æ“ä½œæä¾›äº†å¤©ç„¶çš„å…¥å£ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ­£ç¡®çš„å¤„ç†æ–¹å¼"&gt;ğŸ› ï¸ æ­£ç¡®çš„å¤„ç†æ–¹å¼
&lt;/h3&gt;&lt;p&gt;å½“ä½ çš„ä»£ç æ•è·åˆ° &lt;code&gt;InterruptedException&lt;/code&gt;æ—¶ï¼Œæ­£ç¡®çš„å¤„ç†æ–¹å¼è‡³å…³é‡è¦ï¼Œæ ¸å¿ƒåŸåˆ™æ˜¯&lt;strong&gt;ä¸å¿½ç•¥ã€ä¿çŠ¶æ€&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µï¼šæ¢å¤ä¸­æ–­çŠ¶æ€å¹¶é€€å‡º&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æœ€å¸¸è§ä¸”æ¨èçš„åšæ³•æ˜¯ï¼šåœ¨ &lt;code&gt;catch&lt;/code&gt;å—ä¸­ç«‹å³å†æ¬¡è®¾ç½®ä¸­æ–­çŠ¶æ€ï¼Œç„¶åé€€å‡ºå½“å‰ä»»åŠ¡ã€‚è¿™æ˜¯å› ä¸ºå½“ &lt;code&gt;InterruptedException&lt;/code&gt;è¢«æŠ›å‡ºæ—¶ï¼Œçº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ä¼šè¢«æ¸…é™¤ï¼ˆé‡ç½®ä¸º &lt;code&gt;false&lt;/code&gt;ï¼‰ã€‚è°ƒç”¨ &lt;code&gt;Thread.currentThread().interrupt()&lt;/code&gt;å¯ä»¥é‡æ–°è®¾ç½®ä¸­æ–­çŠ¶æ€ï¼Œè¿™æ ·ä¸Šå±‚è°ƒç”¨è€…ä¹Ÿèƒ½æ„ŸçŸ¥åˆ°ä¸­æ–­å‘ç”Ÿäº† ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
// å¯èƒ½æŠ›å‡º InterruptedException çš„æ“ä½œï¼Œå¦‚ï¼š
Thread.sleep(1000);
} catch (InterruptedException e) {
// 1. æ¢å¤ä¸­æ–­çŠ¶æ€
Thread.currentThread().interrupt();
// 2. æ‰§è¡Œå¿…è¦çš„æ¸…ç†å·¥ä½œ
// 3. é€€å‡ºå½“å‰ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ return æˆ–æŠ›å‡ºå¼‚å¸¸ï¼‰
return;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éœ€è¦é¿å…çš„åšæ³•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æœ€å±é™©çš„åšæ³•æ˜¯æ•è·å¼‚å¸¸åä»€ä¹ˆéƒ½ä¸åšï¼ˆç©º &lt;code&gt;catch&lt;/code&gt;å—ï¼‰ï¼Œè¿™ç›¸å½“äºå®Œå…¨åæ²¡äº†ä¸­æ–­è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´çº¿ç¨‹æ— æ³•åœæ­¢ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›ä»¥ä¸Šè§£é‡Šèƒ½å¸®åŠ©ä½ ç†è§£ &lt;code&gt;InterruptedException&lt;/code&gt;èƒŒåçš„è®¾è®¡å“²å­¦ã€‚å¦‚æœä½ å¯¹ç‰¹å®šçš„å¤„ç†åœºæ™¯æœ‰æ›´å¤šç–‘é—®ï¼Œæˆ–è€…æƒ³äº†è§£æ›´å¤æ‚çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="threadlocal"&gt;ThreadLocal
&lt;/h2&gt;&lt;p&gt;ThreadLocal å˜é‡æœ¬èº«ï¼ˆå³ ThreadLocal å¯¹è±¡ï¼‰çš„åˆ›å»ºæ—¶æœºç”±å¼€å‘è€…æ§åˆ¶ï¼Œè€Œå®ƒå¯¹åº”çš„çº¿ç¨‹å±€éƒ¨å˜é‡å‰¯æœ¬ä»¥åŠåº•å±‚å­˜å‚¨ç»“æ„ï¼ˆThreadLocalMapï¼‰é€šå¸¸æ˜¯åœ¨çº¿ç¨‹&lt;strong&gt;åˆæ¬¡è°ƒç”¨&lt;/strong&gt; &lt;code&gt;set&lt;/code&gt;æˆ– &lt;code&gt;get&lt;/code&gt;æ–¹æ³•æ—¶è¢«åˆ›å»ºå’Œåˆå§‹åŒ–çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ›´æ¸…æ™°åœ°ç†è§£è¿™ä¸€è¿‡ç¨‹ï¼Œä¸‹å›¾å±•ç¤ºäº† ThreadLocal åœ¨åˆæ¬¡ä½¿ç”¨æ—¶çš„åˆ›å»ºæµç¨‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;flowchart TD
A[çº¿ç¨‹è°ƒç”¨&amp;lt;br&amp;gt;ThreadLocal.set() æˆ– get()] --&amp;gt; B{å½“å‰çº¿ç¨‹çš„&amp;lt;br&amp;gt;ThreadLocalMap æ˜¯å¦å­˜åœ¨ï¼Ÿ}
B -- å¦ --&amp;gt; C[åˆ›å»º ThreadLocalMap]
B -- æ˜¯ --&amp;gt; D[åœ¨Mapä¸­æŸ¥æ‰¾&amp;lt;br&amp;gt;å¯¹åº”Entry]
C --&amp;gt; E[åˆ›å»ºæ–°çš„Entry&amp;lt;br&amp;gt;ï¼ˆé”®ä¸ºThreadLocalå¯¹è±¡ï¼Œå€¼ä¸ºsetçš„å€¼æˆ–initialValueï¼‰]
E --&amp;gt; F[å°†Entryå­˜å…¥Map]
D --&amp;gt; G{æ‰¾åˆ°æœ‰æ•ˆEntryï¼Ÿ}
G -- æ˜¯ --&amp;gt; H[è·å–æˆ–æ›´æ–°å€¼]
G -- å¦ --&amp;gt; E
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å…·ä½“æ¥è¯´ï¼Œè¿™ä¸ªåˆ›å»ºè¿‡ç¨‹åŒ…å«ä»¥ä¸‹å‡ ä¸ªå…³é”®ç¯èŠ‚ï¼š&lt;/p&gt;
&lt;h3 id="-1-çº¿ç¨‹å±€éƒ¨å˜é‡å‰¯æœ¬ä¸å­˜å‚¨ç»“æ„çš„åˆ›å»º"&gt;ğŸ” 1. çº¿ç¨‹å±€éƒ¨å˜é‡å‰¯æœ¬ä¸å­˜å‚¨ç»“æ„çš„åˆ›å»º
&lt;/h3&gt;&lt;p&gt;å¦‚æµç¨‹å›¾æ‰€ç¤ºï¼Œå½“çº¿ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨ &lt;code&gt;ThreadLocal&lt;/code&gt;çš„ &lt;code&gt;set(T value)&lt;/code&gt;æˆ– &lt;code&gt;get()&lt;/code&gt;æ–¹æ³•æ—¶ï¼Œä¼šæ£€æŸ¥å½“å‰çº¿ç¨‹ï¼ˆThread å¯¹è±¡ï¼‰å†…éƒ¨çš„ &lt;code&gt;threadLocals&lt;/code&gt;æˆå‘˜å˜é‡æ˜¯å¦ä¸º &lt;code&gt;null&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœä¸º &lt;code&gt;null&lt;/code&gt;&lt;/strong&gt;ï¼šè¯´æ˜çº¿ç¨‹æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ä»»ä½• &lt;code&gt;ThreadLocal&lt;/code&gt;å˜é‡ï¼Œä¼šå…ˆä¸ºå…¶åˆ›å»ºä¸€ä¸ª &lt;code&gt;ThreadLocalMap&lt;/code&gt;ï¼ˆè¿™æ˜¯ &lt;code&gt;ThreadLocal&lt;/code&gt;çš„ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªä¸“ä¸ºçº¿ç¨‹å±€éƒ¨å˜é‡è®¾è®¡çš„ç®€æ˜“ Mapï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éšååˆ›å»ºæ¡ç›®&lt;/strong&gt;ï¼šåœ¨æ–°å»ºçš„ &lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ¡ç›®ï¼ˆEntryï¼‰ã€‚è¿™ä¸ª Entry çš„ &lt;strong&gt;Key&lt;/strong&gt; æ˜¯å½“å‰çš„ &lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹è±¡æœ¬èº«ï¼ˆçš„å¼±å¼•ç”¨ï¼‰ï¼Œè€Œ &lt;strong&gt;Value&lt;/strong&gt; åˆ™æ˜¯ä½ é€šè¿‡ &lt;code&gt;set&lt;/code&gt;æ–¹æ³•è®¾ç½®çš„å€¼ã€‚å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨ &lt;code&gt;get()&lt;/code&gt;ï¼Œåˆ™ Value æ˜¯ &lt;code&gt;initialValue()&lt;/code&gt;æ–¹æ³•è¿”å›çš„åˆå§‹å€¼ï¼ˆé»˜è®¤æ˜¯ &lt;code&gt;null&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-2-å…³é”®æ–¹æ³•ä¸åˆå§‹åŒ–æ—¶æœº"&gt;ğŸ’¡ 2. å…³é”®æ–¹æ³•ä¸åˆå§‹åŒ–æ—¶æœº
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;set(T value)&lt;/code&gt;&lt;/strong&gt;ï¼šç›´æ¥è®¾ç½®å€¼ï¼Œå¦‚æœ &lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸å­˜åœ¨åˆ™ä¼šè§¦å‘åˆ›å»ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;get()&lt;/code&gt;&lt;/strong&gt;ï¼šå¦‚æœ &lt;code&gt;ThreadLocalMap&lt;/code&gt;å°šæœªåˆ›å»ºï¼Œæˆ–è€… Map ä¸­å°šæœªå­˜åœ¨ä¸å½“å‰ &lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹è±¡å¯¹åº”çš„æœ‰æ•ˆ Entryï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ &lt;code&gt;setInitialValue()&lt;/code&gt;æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šè°ƒç”¨ &lt;code&gt;initialValue()&lt;/code&gt;æ–¹æ³•æ¥è·å–åˆå§‹å€¼ï¼Œå¹¶å®Œæˆ Map å’Œ Entry çš„åˆ›å»ºã€‚ä½ å¯ä»¥é€šè¿‡é‡å†™ &lt;code&gt;protected T initialValue()&lt;/code&gt;æ–¹æ³•æ¥æä¾›è‡ªå®šä¹‰çš„åˆå§‹å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-3-é‡è¦æ³¨æ„äº‹é¡¹"&gt;âš ï¸ 3. é‡è¦æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç®¡ç†&lt;/strong&gt;ï¼šæ¯ä¸ªçº¿ç¨‹çš„ &lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¼šä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°çº¿ç¨‹ç»“æŸã€‚å¦‚æœåœ¨çº¿ç¨‹æ± ç¯å¢ƒä¸­ï¼Œçº¿ç¨‹ä¼šè¢«å¤ç”¨è€Œä¸ä¼šç»“æŸï¼Œé‚£ä¹ˆå…¶ä¸­å­˜å‚¨çš„ &lt;code&gt;ThreadLocal&lt;/code&gt;å˜é‡å°±å¯èƒ½ä¸€ç›´å ç”¨å†…å­˜ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨å®Œæ¯•å&lt;strong&gt;åŠ¡å¿…ä¸»åŠ¨è°ƒç”¨ &lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;æ¥æ¸…ç†å½“å‰çº¿ç¨‹çš„å±€éƒ¨å˜é‡ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å˜é‡ç‹¬ç«‹æ€§&lt;/strong&gt;ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰å„è‡ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œäº’ä¸å¹²æ‰°ã€‚è¿™æ„å‘³ç€åŒä¸€ä¸ª &lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹è±¡åœ¨ä¸åŒçº¿ç¨‹ä¸­æ“ä½œçš„æ˜¯å®Œå…¨ä¸åŒçš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ å®Œå…¨ç†è§£ ThreadLocal çš„åˆ›å»ºæœºåˆ¶ã€‚å¦‚æœå¯¹ç‰¹å®šä½¿ç”¨åœºæ™¯è¿˜æœ‰ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="initvalue"&gt;initValue()
&lt;/h2&gt;&lt;p&gt;é‡å†™ &lt;code&gt;initialValue()&lt;/code&gt;æ–¹æ³•æ˜¯ä¸º ThreadLocal å˜é‡æä¾›åˆå§‹å€¼çš„å…³é”®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè¯¦ç»†çš„æŒ‡å—ï¼ŒåŒ…å«æ–¹æ³•å’Œæ³¨æ„äº‹é¡¹ã€‚&lt;/p&gt;
&lt;h3 id="-é‡å†™-initialvalue-çš„ä¸¤ç§æ–¹æ³•"&gt;ğŸ› ï¸ é‡å†™ initialValue() çš„ä¸¤ç§æ–¹æ³•
&lt;/h3&gt;&lt;p&gt;ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§ä¸»æµæ–¹å¼æ¥ä¸ºä½ çš„ ThreadLocal å˜é‡è®¾ç½®åˆå§‹å€¼ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ–¹æ³•&lt;/th&gt;
&lt;th&gt;ä»£ç ç¤ºä¾‹&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒ¿åå†…éƒ¨ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ThreadLocal&amp;lt;String&amp;gt; threadLocal = new ThreadLocal&amp;lt;String&amp;gt;() {&lt;/code&gt; &lt;code&gt;@Override&lt;/code&gt; &lt;code&gt;protected String initialValue() {&lt;/code&gt; &lt;code&gt;return &amp;quot;é»˜è®¤å€¼&amp;quot;;&lt;/code&gt; &lt;code&gt;}&lt;/code&gt; &lt;code&gt;};&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¼ ç»Ÿæ–¹å¼ï¼Œé€šè¿‡é‡å†™æ–¹æ³•è¿”å›åˆå§‹å€¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Lambdaè¡¨è¾¾å¼&lt;/strong&gt; (æ¨è)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ThreadLocal&amp;lt;String&amp;gt; threadLocal = ThreadLocal.withInitial(() -&amp;gt; &amp;quot;é»˜è®¤å€¼&amp;quot;);&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Java 8 å¼•å…¥çš„è¯­æ³•ï¼Œæ›´ç®€æ´ã€‚åº•å±‚åˆ›å»º&lt;code&gt;SuppliedThreadLocal&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å…³é”®è¦ç‚¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ å…³é”®è¦ç‚¹ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿ŸåŠ è½½&lt;/strong&gt;ï¼š&lt;code&gt;initialValue()&lt;/code&gt;æ–¹æ³•å¹¶éåœ¨åˆ›å»º &lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹è±¡æ—¶æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨çº¿ç¨‹&lt;strong&gt;é¦–æ¬¡è°ƒç”¨&lt;/strong&gt; &lt;code&gt;get()&lt;/code&gt;æ–¹æ³•ä¸”ä¹‹å‰æœªè°ƒç”¨è¿‡ &lt;code&gt;set()&lt;/code&gt;æ–¹æ³•æ—¶æ‰ä¼šè¢«è°ƒç”¨ã€‚è¿™æ˜¯ä¸€ç§å»¶è¿ŸåŠ è½½æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤è¿”å›null&lt;/strong&gt;ï¼šå¦‚æœä½ ä¸é‡å†™ &lt;code&gt;initialValue()&lt;/code&gt;æ–¹æ³•ï¼Œé»˜è®¤å®ç°ä¼šè¿”å› &lt;code&gt;null&lt;/code&gt;ã€‚å› æ­¤ï¼Œç›´æ¥è°ƒç”¨ &lt;code&gt;get()&lt;/code&gt;æ–¹æ³•å¯èƒ½ä¼šå¾—åˆ° &lt;code&gt;null&lt;/code&gt;ï¼Œåœ¨åç»­ä½¿ç”¨ä¸­å¯èƒ½å¯¼è‡´ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;set() çš„ä¼˜å…ˆçº§&lt;/strong&gt;ï¼šå¦‚æœçº¿ç¨‹å…ˆè°ƒç”¨äº† &lt;code&gt;set(T value)&lt;/code&gt;æ–¹æ³•ï¼Œé‚£ä¹ˆ &lt;code&gt;initialValue()&lt;/code&gt;æ–¹æ³•å°†ä¸ä¼šè¢«è°ƒç”¨ï¼Œ&lt;code&gt;get()&lt;/code&gt;ä¼šè¿”å›ä½ è®¾ç½®çš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…åˆ remove() ä½¿ç”¨&lt;/strong&gt;ï¼šåœ¨ä½¿ç”¨å®Œ ThreadLocal åï¼ˆå°¤å…¶æ˜¯åœ¨çº¿ç¨‹æ± ç­‰ä¼šå¤ç”¨çº¿ç¨‹çš„åœºæ™¯ä¸‹ï¼‰ï¼ŒåŠ¡å¿…è°ƒç”¨ &lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•æ¸…ç†å½“å‰çº¿ç¨‹çš„å˜é‡å‰¯æœ¬ã€‚è¿™æ ·ï¼Œå¦‚æœä¹‹åè¯¥çº¿ç¨‹å†æ¬¡è°ƒç”¨ &lt;code&gt;get()&lt;/code&gt;ï¼Œ&lt;code&gt;initialValue()&lt;/code&gt;åˆä¼šè¢«è§¦å‘ï¼Œæä¾›ä¸€ä¸ªå…¨æ–°çš„åˆå§‹å€¼ï¼ŒåŒæ—¶ä¹Ÿèƒ½æœ‰æ•ˆé¿å…å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸€ä¸ªå®Œæ•´çš„å®æˆ˜æ¡ˆä¾‹"&gt;ğŸ’¡ ä¸€ä¸ªå®Œæ•´çš„å®æˆ˜æ¡ˆä¾‹
&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿç”¨æˆ·ç™»å½•ä¸Šä¸‹æ–‡çš„å®Œæ•´ç¤ºä¾‹ï¼Œå±•ç¤ºäº† ThreadLocal çš„å…¸å‹ç”¨æ³•ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class UserContextHolder {
// ä½¿ç”¨ withInitial æ–¹æ³•é‡å†™ initialValueï¼Œåˆå§‹ä¸º &amp;#34;æœªçŸ¥ç”¨æˆ·&amp;#34;
private static final ThreadLocal&amp;lt;String&amp;gt; currentUser = ThreadLocal.withInitial(() -&amp;gt; &amp;#34;æœªçŸ¥ç”¨æˆ·&amp;#34;);
public static void setCurrentUser(String username) {
currentUser.set(username);
}
public static String getCurrentUser() {
return currentUser.get();
}
public static void clear() {
// é‡è¦ï¼šä½¿ç”¨åæ¸…ç†ï¼Œé¿å…å†…å­˜æ³„æ¼å’Œæ—§æ•°æ®å¹²æ‰°
currentUser.remove();
}
// ç¤ºä¾‹ï¼šåœ¨ä¸šåŠ¡æ–¹æ³•ä¸­ä½¿ç”¨
public void businessMethod() {
try {
// å¯ä»¥ç›´æ¥è·å–å½“å‰çº¿ç¨‹çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ— éœ€å‚æ•°ä¼ é€’
System.out.println(&amp;#34;å½“å‰æ“ä½œç”¨æˆ·: &amp;#34; + UserContextHolder.getCurrentUser());
// ... å…¶ä»–ä¸šåŠ¡é€»è¾‘
} finally {
// ç¡®ä¿åœ¨finallyå—ä¸­æ¸…ç†ï¼Œä¾‹å¦‚åœ¨Webè¯·æ±‚å¤„ç†ç»“æŸæ—¶
UserContextHolder.clear();
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¸Œæœ›è¿™ä¸ªè¯¦ç»†çš„æŒ‡å—èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ ThreadLocal çš„ &lt;code&gt;initialValue()&lt;/code&gt;æ–¹æ³•ï¼å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯æœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="fqn"&gt;FQN
&lt;/h2&gt;&lt;p&gt;åœ¨Javaä¸­ï¼Œå†…éƒ¨ç±»çš„&lt;strong&gt;å®Œå…¨é™å®šå&lt;/strong&gt; æ ¼å¼éå¸¸æ˜ç¡®ï¼Œå®ƒæ¸…æ™°åœ°åæ˜ äº†å†…éƒ¨ç±»ä¸å¤–éƒ¨ç±»ä¹‹é—´çš„ä»å±å…³ç³»ã€‚å…¶åŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;h3 id="å®Œå…¨é™å®šåçš„ç»„æˆ"&gt;å®Œå…¨é™å®šåçš„ç»„æˆ
&lt;/h3&gt;&lt;p&gt;å†…éƒ¨ç±»çš„å®Œå…¨é™å®šåï¼ˆFully Qualified Name, FQNï¼‰éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;å¤–éƒ¨ç±»çš„å®Œå…¨é™å®šå&amp;gt;$&amp;lt;å†…éƒ¨ç±»åç§°&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é‡Œæœ‰å‡ ä¸ªå…³é”®ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;&amp;lt;å¤–éƒ¨ç±»çš„å®Œå…¨é™å®šå&amp;gt;&lt;/code&gt;&lt;/strong&gt;ï¼šæŒ‡çš„æ˜¯åŒ…å«å†…éƒ¨ç±»çš„é‚£ä¸ªå¤–éƒ¨ç±»çš„å®Œæ•´åŒ…è·¯å¾„å’Œç±»åã€‚ä¾‹å¦‚ &lt;code&gt;com.example.OuterClass&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;$&lt;/code&gt;ç¬¦å·&lt;/strong&gt;ï¼šè¿™æ˜¯è¿æ¥å¤–éƒ¨ç±»åå’Œå†…éƒ¨ç±»åçš„å›ºå®šåˆ†éš”ç¬¦ï¼Œç”±Javaç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ç¡®å®šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;&amp;lt;å†…éƒ¨ç±»åç§°&amp;gt;&lt;/code&gt;&lt;/strong&gt;ï¼šå°±æ˜¯å†…éƒ¨ç±»è‡ªå·±å®šä¹‰çš„åç§°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="å†…éƒ¨ç±»å®Œå…¨é™å®šåç¤ºä¾‹"&gt;å†…éƒ¨ç±»å®Œå…¨é™å®šåç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;ä¸‹é¢çš„è¡¨æ ¼é€šè¿‡å…·ä½“ä¾‹å­å±•ç¤ºäº†ä¸åŒç±»å‹å†…éƒ¨ç±»çš„å®Œå…¨é™å®šåï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å†…éƒ¨ç±»ç±»å‹&lt;/th&gt;
&lt;th&gt;ä»£ç ç¤ºä¾‹&lt;/th&gt;
&lt;th&gt;å®Œå…¨é™å®šåç¤ºä¾‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ™®é€šæˆå‘˜å†…éƒ¨ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;class Outer { class Inner {} }&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;com.example.Outer$Inner&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€å†…éƒ¨ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;class Outer { static class StaticNested {} }&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;com.example.Outer$StaticNested&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å±€éƒ¨å†…éƒ¨ç±»&lt;/strong&gt; (å®šä¹‰åœ¨æ–¹æ³•å†…)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;void method() { class Local {} }&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;com.example.Outer$1Local&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒ¿åå†…éƒ¨ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;new Runnable() { ... }&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;com.example.Outer$1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šå±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»çš„åç§°ä¸­çš„æ•°å­—ï¼ˆå¦‚ &lt;code&gt;$1Local&lt;/code&gt;å’Œ &lt;code&gt;$1&lt;/code&gt;ï¼‰æ˜¯ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„ç¼–å·ï¼Œç”¨ä»¥åŒºåˆ†åœ¨åŒä¸€ä½œç”¨åŸŸå†…å®šä¹‰çš„å¤šä¸ªåŒç±»å†…éƒ¨ç±»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="åœ¨ä»£ç ä¸­ä½¿ç”¨å†…éƒ¨ç±»çš„å®Œå…¨é™å®šå"&gt;åœ¨ä»£ç ä¸­ä½¿ç”¨å†…éƒ¨ç±»çš„å®Œå…¨é™å®šå
&lt;/h3&gt;&lt;p&gt;äº†è§£å®Œå…¨é™å®šååœ¨å®é™…ç¼–ç¨‹ä¸­å¾ˆæœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨åå°„æ—¶ã€‚ä»¥ä¸‹æ˜¯ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é€šè¿‡å¤–éƒ¨ç±»å®ä¾‹åˆ›å»º&lt;/strong&gt;ï¼šè¿™æ˜¯æ›´å¸¸è§çš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// é¦–å…ˆåˆ›å»ºå¤–éƒ¨ç±»å®ä¾‹
com.example.OuterClass outerObject = new com.example.OuterClass();
// ç„¶åé€šè¿‡å¤–éƒ¨ç±»å®ä¾‹åˆ›å»ºå†…éƒ¨ç±»å®ä¾‹
com.example.OuterClass$InnerClass innerObject = outerObject.new InnerClass();
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é€šè¿‡åå°„åŠ è½½&lt;/strong&gt;ï¼šä½ å¯ä»¥ç›´æ¥ä½¿ç”¨å†…éƒ¨ç±»çš„å®Œå…¨é™å®šåæ¥è·å–å…¶ &lt;code&gt;Class&lt;/code&gt;å¯¹è±¡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
Class&amp;lt;?&amp;gt; innerClazz = Class.forName(&amp;#34;com.example.OuterClass$InnerClass&amp;#34;);
} catch (ClassNotFoundException e) {
e.printStackTrace();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="å†…éƒ¨ç±»å®Œå…¨é™å®šåçš„å½¢æˆé€»è¾‘"&gt;å†…éƒ¨ç±»å®Œå…¨é™å®šåçš„å½¢æˆé€»è¾‘
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£å†…éƒ¨ç±»å®Œå…¨é™å®šåçš„ç”Ÿæˆè§„åˆ™ï¼Œä¸‹å›¾æ¸…æ™°åœ°å±•ç¤ºäº†å…¶æ„æˆé€»è¾‘ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;flowchart TD
A[å†…éƒ¨ç±»å®Œå…¨é™å®šå&amp;lt;br&amp;gt;com.example.OuterClass$InnerClass] --&amp;gt; B1[å¤–éƒ¨ç±»å®Œå…¨é™å®šå&amp;lt;br&amp;gt;com.example.OuterClass]
A --&amp;gt; B2[åˆ†éš”ç¬¦&amp;lt;br&amp;gt;$]
A --&amp;gt; B3[å†…éƒ¨ç±»æœ¬å&amp;lt;br&amp;gt;InnerClass]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="é‡è¦è¯´æ˜"&gt;é‡è¦è¯´æ˜
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æºæ–‡ä»¶ä¸classæ–‡ä»¶&lt;/strong&gt;ï¼šåœ¨Javaæºä»£ç ï¼ˆ.javaæ–‡ä»¶ï¼‰ä¸­å¼•ç”¨å†…éƒ¨ç±»æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ç‚¹å·ï¼ˆ.ï¼‰ï¼Œä¾‹å¦‚ &lt;code&gt;OuterClass.InnerClass&lt;/code&gt;ã€‚ä½†ç¼–è¯‘å™¨åœ¨å¤„ç†åä¼šç”Ÿæˆå¯¹åº”çš„classæ–‡ä»¶ï¼Œå…¶æ–‡ä»¶åå’Œå†…éƒ¨ç±»åœ¨JVMä¸­çš„æ­£å¼åç§°ä½¿ç”¨çš„å°±æ˜¯**ç¾å…ƒç¬¦å·ï¼ˆï¼‰âˆ—âˆ—ã€‚â€˜OuterClass.InnerClassâ€˜æ›´åƒæ˜¯Javaè¯­æ³•æä¾›çš„ç®€å†™å½¢å¼ï¼Œè€Œâ€˜OuterClassInnerClass` æ˜¯å…¶åœ¨JVMä¸­çš„â€œçœŸåâ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆéœ€è¦å®Œå…¨é™å®šå&lt;/strong&gt;ï¼šå®Œå…¨é™å®šåçš„ä¸»è¦ä½œç”¨æ˜¯&lt;strong&gt;å”¯ä¸€æ ‡è¯†ä¸€ä¸ªç±»&lt;/strong&gt;ï¼Œé¿å…åœ¨å¤§å‹é¡¹ç›®æˆ–ä½¿ç”¨ä¸åŒåº“æ—¶ï¼Œå› ç±»åç›¸åŒï¼ˆä¾‹å¦‚å¤šä¸ª &lt;code&gt;Utils&lt;/code&gt;ç±»ï¼‰è€Œå¼•å‘å†²çªã€‚åŒ…æœºåˆ¶é€šè¿‡å‘½åç©ºé—´å®ç°äº†ç±»çš„éš”ç¦»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šå’Œç¤ºä¾‹èƒ½å¸®åŠ©ä½ å®Œå…¨ç†è§£Javaå†…éƒ¨ç±»çš„å®Œå…¨é™å®šåã€‚&lt;/p&gt;
&lt;h2 id="switch-case"&gt;switch case
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ç¼–ç¨‹ä¸­ï¼Œä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸º &lt;code&gt;switch&lt;/code&gt;è¯­å¥çš„æ¡ä»¶å¯ä»¥è®©å¤šåˆ†æ”¯é€»è¾‘å˜å¾—æ›´åŠ æ¸…æ™°å’Œç›´è§‚ã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†ä»‹ç»å…¶ç”¨æ³•ã€æ³¨æ„äº‹é¡¹å’Œåº•å±‚åŸç†ã€‚&lt;/p&gt;
&lt;h3 id="-åŸºæœ¬è¯­æ³•ä¸è¦æ±‚"&gt;ğŸ” åŸºæœ¬è¯­æ³•ä¸è¦æ±‚
&lt;/h3&gt;&lt;p&gt;åœ¨ Java ä¸­ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸º &lt;code&gt;switch&lt;/code&gt;è¯­å¥çš„æ¡ä»¶ï¼Œéœ€è¦ç¡®ä¿ä½ çš„å¼€å‘ç¯å¢ƒæ”¯æŒ &lt;strong&gt;Java 7 æˆ–æ›´é«˜ç‰ˆæœ¬&lt;/strong&gt;ã€‚è¿™æ˜¯å­—ç¬¦ä¸²æ”¯æŒ &lt;code&gt;switch&lt;/code&gt;è¯­å¥çš„èµ·å§‹ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;å…¶åŸºæœ¬è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String fruit = &amp;#34;apple&amp;#34;;
switch (fruit) {
case &amp;#34;apple&amp;#34;:
System.out.println(&amp;#34;è¿™æ˜¯ä¸€ä¸ªè‹¹æœã€‚&amp;#34;);
break;
case &amp;#34;banana&amp;#34;:
System.out.println(&amp;#34;è¿™æ˜¯ä¸€ä¸ªé¦™è•‰ã€‚&amp;#34;);
break;
case &amp;#34;orange&amp;#34;:
System.out.println(&amp;#34;è¿™æ˜¯ä¸€ä¸ªæ©™å­ã€‚&amp;#34;);
break;
default:
System.out.println(&amp;#34;æœªçŸ¥æ°´æœã€‚&amp;#34;);
break;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä½¿ç”¨æ—¶æœ‰å‡ ä¸ªå…³é”®ç‚¹éœ€è¦æ³¨æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¡¨è¾¾å¼ç±»å‹&lt;/strong&gt;ï¼š&lt;code&gt;switch&lt;/code&gt;åé¢çš„è¡¨è¾¾å¼å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼ˆ&lt;code&gt;String&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Case å€¼&lt;/strong&gt;ï¼šæ¯ä¸ª &lt;code&gt;case&lt;/code&gt;æ ‡ç­¾åé¢å¿…é¡»è·Ÿä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡æˆ–å­—é¢é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Break è¯­å¥&lt;/strong&gt;ï¼šé€šå¸¸æ¯ä¸ª &lt;code&gt;case&lt;/code&gt;åˆ†æ”¯çš„æœ«å°¾éƒ½éœ€è¦ä½¿ç”¨ &lt;code&gt;break&lt;/code&gt;è¯­å¥æ¥é˜²æ­¢â€œcaseç©¿é€â€ï¼ˆå³ç»§ç»­æ‰§è¡Œåç»­ &lt;code&gt;case&lt;/code&gt;åˆ†æ”¯çš„ä»£ç ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å…³é”®æ³¨æ„äº‹é¡¹"&gt;âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¿å… Case ç©¿é€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¿˜è®°å†™ &lt;code&gt;break&lt;/code&gt;æ˜¯å¸¸è§çš„é”™è¯¯ã€‚å¦‚æœæ•…æ„åˆ©ç”¨ç©¿é€æ•ˆåº”ï¼ˆä¾‹å¦‚å¤šä¸ª &lt;code&gt;case&lt;/code&gt;æ‰§è¡Œç›¸åŒä»£ç ï¼‰ï¼Œè¯·åŠ¡å¿…æ·»åŠ æ³¨é‡Šè¯´æ˜ï¼Œä»¥æé«˜ä»£ç å¯è¯»æ€§ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String color = &amp;#34;red&amp;#34;;
switch (color) {
case &amp;#34;red&amp;#34;:
case &amp;#34;pink&amp;#34;: // æ•…æ„ä¸å†™ breakï¼Œè®© &amp;#34;red&amp;#34; å’Œ &amp;#34;pink&amp;#34; æ‰§è¡Œç›¸åŒä»£ç 
System.out.println(&amp;#34;è¿™æ˜¯çº¢è‰²ç³»ã€‚&amp;#34;);
break;
case &amp;#34;blue&amp;#34;:
System.out.println(&amp;#34;è¿™æ˜¯è“è‰²ã€‚&amp;#34;);
break;
default:
System.out.println(&amp;#34;æœªçŸ¥é¢œè‰²ã€‚&amp;#34;);
break;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤„ç†å¤§å°å†™æ•æ„Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å­—ç¬¦ä¸²æ¯”è¾ƒåœ¨ &lt;code&gt;switch&lt;/code&gt;è¯­å¥ä¸­æ˜¯&lt;strong&gt;åŒºåˆ†å¤§å°å†™&lt;/strong&gt;çš„ã€‚å¦‚æœå¸Œæœ›å¿½ç•¥å¤§å°å†™ï¼Œå¯ä»¥å…ˆå°†å­—ç¬¦ä¸²ç»Ÿä¸€è½¬æ¢ä¸ºå°å†™ï¼ˆæˆ–å¤§å†™ï¼‰ï¼Œä½†åŠ¡å¿…ç¡®ä¿ &lt;code&gt;case&lt;/code&gt;æ ‡ç­¾çš„å€¼ä¹Ÿä½¿ç”¨ç›¸åŒçš„å¤§å°å†™å½¢å¼ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String input = &amp;#34;YES&amp;#34;;
switch (input.toLowerCase()) { // è½¬æ¢ä¸ºå°å†™
case &amp;#34;yes&amp;#34;: // case æ ‡ç­¾ä¹Ÿä½¿ç”¨å°å†™
System.out.println(&amp;#34;ç”¨æˆ·ç¡®è®¤äº†ã€‚&amp;#34;);
break;
case &amp;#34;no&amp;#34;:
System.out.println(&amp;#34;ç”¨æˆ·æ‹’ç»äº†ã€‚&amp;#34;);
break;
default:
System.out.println(&amp;#34;è¾“å…¥æ— æ•ˆã€‚&amp;#34;);
break;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å–„ç”¨ Default åˆ†æ”¯&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å³ä½¿ä½ è®¤ä¸ºå·²ç»è¦†ç›–æ‰€æœ‰æƒ…å†µï¼Œä¹Ÿå»ºè®®ä½¿ç”¨ &lt;code&gt;default&lt;/code&gt;åˆ†æ”¯æ¥å¤„ç†æ„å¤–å€¼ï¼Œè¿™èƒ½ä½¿ç¨‹åºæ›´å¥å£®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤„ç† Null å€¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;switch&lt;/code&gt;è¯­å¥çš„è¡¨è¾¾å¼ä¸èƒ½ä¸º &lt;code&gt;null&lt;/code&gt;ï¼Œå¦åˆ™ä¼šæŠ›å‡º &lt;code&gt;NullPointerException&lt;/code&gt;ã€‚å¦‚æœå˜é‡æœ‰å¯èƒ½ä¸º &lt;code&gt;null&lt;/code&gt;ï¼Œåº”å…ˆè¿›è¡Œåˆ¤æ–­ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;if (myString != null) {
switch (myString) {
// ... case åˆ†æ”¯
}
} else {
// å¤„ç† null æƒ…å†µ
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-åº•å±‚åŸç†ä¸æ€§èƒ½"&gt;ğŸ”§ åº•å±‚åŸç†ä¸æ€§èƒ½
&lt;/h3&gt;&lt;p&gt;ä» Java 7 å¼€å§‹ï¼Œç¼–è¯‘å™¨æ”¯æŒåœ¨ &lt;code&gt;switch&lt;/code&gt;è¯­å¥ä¸­ä½¿ç”¨å­—ç¬¦ä¸²ã€‚å…¶åº•å±‚æ˜¯é€šè¿‡è°ƒç”¨å­—ç¬¦ä¸²çš„ &lt;code&gt;hashCode()&lt;/code&gt;æ–¹æ³•å¾—åˆ°ä¸€ä¸ªæ•´æ•°ï¼Œç„¶ååŸºäºè¿™ä¸ªæ•´æ•°å€¼è¿›è¡Œ &lt;code&gt;switch&lt;/code&gt;åˆ¤æ–­ã€‚å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ç›¸åŒï¼ˆå³å“ˆå¸Œå†²çªï¼‰ï¼Œè¿˜ä¼šä½¿ç”¨ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•è¿›è¡Œç²¾ç¡®çš„å­—ç¬¦ä¸²æ¯”è¾ƒä»¥ç¡®ä¿å‡†ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ€§èƒ½ä¸Šï¼Œå¯¹äºåˆ†æ”¯è¾ƒå¤šçš„æƒ…å†µï¼Œä½¿ç”¨ &lt;code&gt;switch&lt;/code&gt;è¯­å¥é€šå¸¸æ¯”ä¸€è¿ä¸²çš„ &lt;code&gt;if-else-if&lt;/code&gt;è¯­å¥æ•ˆç‡æ›´é«˜ï¼Œå› ä¸º &lt;code&gt;switch&lt;/code&gt;é€šå¸¸åŸºäºå“ˆå¸Œå€¼å®ç°è·³è½¬ã€‚&lt;/p&gt;
&lt;h3 id="-æœ€ä½³å®è·µä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;ğŸ’¡ æœ€ä½³å®è·µä¸æ›¿ä»£æ–¹æ¡ˆ
&lt;/h3&gt;&lt;p&gt;è™½ç„¶å­—ç¬¦ä¸² &lt;code&gt;switch&lt;/code&gt;å¾ˆæ–¹ä¾¿ï¼Œä½†å¹¶éæ‰€æœ‰æƒ…å†µéƒ½æ˜¯æœ€ä½³é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ”¯éå¸¸å¤šæˆ–å¤æ‚&lt;/strong&gt;ï¼šå¦‚æœåˆ†æ”¯æ•°é‡æå¤§ï¼Œæˆ–è€…åŒ¹é…é€»è¾‘éå¸¸å¤æ‚ï¼Œè€ƒè™‘ä½¿ç”¨ &lt;strong&gt;Map&lt;/strong&gt; ç»“æ„å°†å­—ç¬¦ä¸²æ˜ å°„åˆ°ç›¸åº”çš„å¤„ç†é€»è¾‘ï¼ˆå¦‚ Runnable æˆ– Consumerï¼‰ï¼Œå¯èƒ½æ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦æ›´çµæ´»çš„æ¨¡å¼åŒ¹é…&lt;/strong&gt;ï¼šå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Java 14 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¯ä»¥å…³æ³¨ &lt;strong&gt;Switch è¡¨è¾¾å¼&lt;/strong&gt; å’Œ &lt;strong&gt;æ¨¡å¼åŒ¹é…&lt;/strong&gt; çš„ç‰¹æ€§ï¼Œå®ƒä»¬æä¾›äº†æ›´å¼ºå¤§å’Œç®€æ´çš„å†™æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-16"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;åœ¨ Java 7 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸º &lt;code&gt;switch&lt;/code&gt;è¯­å¥çš„æ¡ä»¶ï¼Œè¿™èƒ½è®©ä»£ç æ›´æ¸…æ™°ã€‚å…³é”®æ˜¯è¦æ³¨æ„ &lt;code&gt;break&lt;/code&gt;çš„ä½¿ç”¨ã€å¤§å°å†™æ•æ„Ÿé—®é¢˜ï¼Œå¹¶å¦¥å–„å¤„ç† &lt;code&gt;null&lt;/code&gt;å€¼å’Œæœªé¢„è§åˆ°çš„æƒ…å†µã€‚ç†è§£å…¶åŸºäºå“ˆå¸Œå€¼çš„å®ç°åŸç†æœ‰åŠ©äºä½ æ›´å¥½åœ°ä½¿ç”¨è¿™ä¸€ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°åœ¨ç¨‹åºä¸­ä½¿ç”¨å­—ç¬¦ä¸²å¼€å…³è¯­å¥ï¼å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„åº”ç”¨è¿˜æœ‰ç–‘é—®ï¼Œæ¬¢è¿ç»§ç»­äº¤æµã€‚&lt;/p&gt;
&lt;h2 id="å¤šä¸ªæ¥å£"&gt;å¤šä¸ªæ¥å£
&lt;/h2&gt;&lt;p&gt;æ˜¯çš„ï¼ŒJava å®Œå…¨å…è®¸å¤šä¸ªæ¥å£å®šä¹‰å…·æœ‰ç›¸åŒç­¾åçš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¸€ä¸ªç±»å¯ä»¥åŒæ—¶å®ç°è¿™äº›æ¥å£ã€‚è¿™ç§è®¾è®¡æ˜¯ Java å®ç°å¤šç»§æ‰¿ç‰¹æ€§çš„æ ¸å¿ƒæœºåˆ¶ã€‚å…¶å¤„ç†æ–¹å¼éå¸¸ç›´è§‚ï¼š&lt;strong&gt;å®ç°ç±»åªéœ€æä¾›ä¸€ä¸ªè¯¥æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œå³å¯åŒæ—¶æ»¡è¶³æ‰€æœ‰åŒ…å«æ­¤ç›¸åŒç­¾åæ–¹æ³•çš„æ¥å£çš„è¦æ±‚&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„è¡¨æ ¼æ¸…æ™°åœ°æ€»ç»“äº†åœ¨ä¸åŒæƒ…å†µä¸‹ï¼ŒJava ç¼–è¯‘å™¨å¦‚ä½•å¤„ç†å¤šä¸ªæ¥å£ä¸­çš„æ–¹æ³•ç­¾åå†²çªã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åœºæ™¯æè¿°&lt;/th&gt;
&lt;th&gt;ç¼–è¯‘å™¨å¤„ç†æ–¹å¼&lt;/th&gt;
&lt;th&gt;å®ç°ç±»éœ€è¦åšä»€ä¹ˆï¼Ÿ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•ç­¾åä¸è¿”å›ç±»å‹å®Œå…¨ç›¸åŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è§†ä¸ºåŒä¸€ä¸ªæ–¹æ³•ï¼ˆ&lt;code&gt;@Override&lt;/code&gt;ç­‰æ•ˆï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åªéœ€æä¾›ä¸€ä¸ªå®ç°&lt;/strong&gt;ï¼Œè¯¥å®ç°é€‚ç”¨äºæ‰€æœ‰ç›¸å…³æ¥å£ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•ç­¾åç›¸åŒä½†è¿”å›ç±»å‹ä¸åŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç¼–è¯‘é”™è¯¯&lt;/strong&gt;ã€‚è¿åäº†æ–¹æ³•é‡å†™çš„åŸºæœ¬è§„åˆ™ã€‚&lt;/td&gt;
&lt;td&gt;æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œå¿…é¡»ä¿®æ”¹æ¥å£æˆ–ç±»è®¾è®¡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¥å£æä¾›äº†å†²çªçš„&lt;code&gt;default&lt;/code&gt;æ–¹æ³•å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘å™¨ä¼šæŠ¥å‘Šå†²çªã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¿…é¡»åœ¨è¯¥å®ç°ç±»ä¸­é‡å†™è¿™ä¸ªå†²çªæ–¹æ³•&lt;/strong&gt;ï¼Œä»¥æ¶ˆé™¤æ­§ä¹‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="å…·ä½“åœºæ™¯ä¸ä»£ç ç¤ºä¾‹"&gt;å…·ä½“åœºæ™¯ä¸ä»£ç ç¤ºä¾‹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®Œç¾å…¼å®¹ï¼šç­¾åå’Œè¿”å›ç±»å‹ç›¸åŒ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯æœ€å¸¸è§ä¸”ç†æƒ³çš„æƒ…å†µã€‚ç”±äºæ–¹æ³•åœ¨å„ä¸ªæ–¹é¢éƒ½å®Œå…¨ä¸€è‡´ï¼Œç¼–è¯‘å™¨è®¤ä¸ºå®ƒä»¬å°±æ˜¯åŒä¸€ä¸ªæ–¹æ³•çº¦å®šã€‚å®ç°ç±»åªéœ€ä¸€æ¬¡å®ç°ï¼Œå³å¯å±¥è¡Œæ‰€æœ‰æ¥å£çš„å¥‘çº¦ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// å®šä¹‰ä¸¤ä¸ªæ¥å£ï¼Œå®ƒä»¬æ‹¥æœ‰å®Œå…¨ç›¸åŒçš„æ–¹æ³•
interface Animal {
void makeSound(); // æ–¹æ³•ç­¾åï¼šmakeSound()
}
interface Machine {
void makeSound(); // æ–¹æ³•ç­¾åï¼šmakeSound()
}
// Robotç±»åŒæ—¶å®ç°ä¸¤ä¸ªæ¥å£
class Robot implements Animal, Machine {
// åªéœ€è¦ä¸€ä¸ªå®ç°ï¼Œå³å¯åŒæ—¶æ»¡è¶³Animalå’ŒMachineæ¥å£çš„è¦æ±‚
@Override
public void makeSound() {
System.out.println(&amp;#34;Beep Boop!&amp;#34;);
}
}
public class Main {
public static void main(String[] args) {
Robot r = new Robot();
r.makeSound(); // è¾“å‡º: Beep Boop!
// é€šè¿‡ä¸åŒæ¥å£ç±»å‹å¼•ç”¨ï¼Œè°ƒç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ç°
Animal a = r;
a.makeSound(); // è¾“å‡º: Beep Boop!
Machine m = r;
m.makeSound(); // è¾“å‡º: Beep Boop!
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ— æ³•è°ƒå’Œï¼šç­¾åç›¸åŒä½†è¿”å›ç±»å‹ä¸åŒ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ–¹æ³•åå’Œå‚æ•°åˆ—è¡¨ç›¸åŒä½†è¿”å›ç±»å‹ä¸åŒï¼Œè¿™å°†äº§ç”Ÿç¼–è¯‘é”™è¯¯ã€‚å› ä¸ºåœ¨ Java çš„æ–¹æ³•é‡è½½è§„åˆ™ä¸­ï¼Œè¿”å›ç±»å‹ä¸åŒä¸è¶³ä»¥åŒºåˆ†ä¸¤ä¸ªæ–¹æ³•ï¼Œç¼–è¯‘å™¨æ— æ³•ç¡®å®šåº”è¯¥å®ç°å“ªä¸ªç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface Gift {
void present(); // è¿”å›ç±»å‹ä¸º void
}
interface Guest {
boolean present(); // è¿”å›ç±»å‹ä¸º boolean
}
// ç¼–è¯‘é”™è¯¯ï¼šClass &amp;#39;Presentable&amp;#39; must either be declared abstract
// or implement abstract method &amp;#39;present()&amp;#39; in &amp;#39;Guest&amp;#39;
// å®é™…ä¸Šæ˜¯å› ä¸ºä¸¤ä¸ªpresent()æ–¹æ³•å†²çªï¼Œå¯¼è‡´æ— æ³•å®ç°ã€‚
class Presentable implements Gift, Guest {
// æ— æ³•åŒæ—¶å®ç° void present() å’Œ boolean present()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java 8+ ç‰¹æ€§ï¼šå¤„ç†é»˜è®¤æ–¹æ³•å†²çª&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä» Java 8 å¼€å§‹ï¼Œæ¥å£å¯ä»¥åŒ…å«å¸¦æœ‰å…·ä½“å®ç°çš„é»˜è®¤æ–¹æ³•ï¼ˆ&lt;code&gt;default&lt;/code&gt;æ–¹æ³•ï¼‰ã€‚å¦‚æœä¸¤ä¸ªæ¥å£æä¾›äº†ç›¸åŒç­¾åçš„é»˜è®¤æ–¹æ³•ï¼Œå°±ä¼šåœ¨å®ç°ç±»ä¸­å¼•å‘å†²çªã€‚è§£å†³æ–¹æ³•æ˜¯&lt;strong&gt;å¼ºåˆ¶å®ç°ç±»é‡å†™è¯¥é»˜è®¤æ–¹æ³•&lt;/strong&gt;ã€‚åœ¨é‡å†™æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æä¾›å…¨æ–°çš„å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒç”¨æŸä¸ªç‰¹å®šæ¥å£çš„é»˜è®¤å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface Flyable {
default void activate() {
System.out.println(&amp;#34;Flying high!&amp;#34;);
}
}
interface Swimmable {
default void activate() {
System.out.println(&amp;#34;Diving deep!&amp;#34;);
}
}
// Duckç±»å¿…é¡»é‡å†™å†²çªçš„activateæ–¹æ³•
class Duck implements Flyable, Swimmable {
@Override
public void activate() {
// è§£å†³æ–¹æ¡ˆ1ï¼šé€‰æ‹©å…¶ä¸­ä¸€ä¸ªæ¥å£çš„é»˜è®¤å®ç°
Flyable.super.activate(); // æ˜ç¡®è°ƒç”¨Flyableçš„activate
// è§£å†³æ–¹æ¡ˆ2ï¼šæˆ–è€…å®Œå…¨è‡ªå·±å®ç°
System.out.println(&amp;#34;The duck is quacking and ready for action!&amp;#34;);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ ¸å¿ƒè¦ç‚¹ä¸è®¾è®¡å“²å­¦"&gt;ğŸ’¡ æ ¸å¿ƒè¦ç‚¹ä¸è®¾è®¡å“²å­¦
&lt;/h3&gt;&lt;p&gt;Java çš„è¿™ç§è®¾è®¡ä½“ç°äº†å…¶â€œå¥‘çº¦ä¼˜å…ˆâ€çš„æ€æƒ³ã€‚æ¥å£å®šä¹‰çš„æ˜¯â€œèƒ½åšä»€ä¹ˆâ€ï¼ˆè¡Œä¸ºå¥‘çº¦ï¼‰ï¼Œè€Œç±»åˆ™è´Ÿè´£â€œæ€ä¹ˆåšâ€ï¼ˆå…·ä½“å®ç°ï¼‰ã€‚å½“å¤šä¸ªæ¥å£å®šä¹‰äº†ç›¸åŒçš„è¡Œä¸ºå¥‘çº¦æ—¶ï¼Œå®ç°ç±»ç”¨ä¸€ä¸ªç»Ÿä¸€çš„è¡Œä¸ºæ¥å±¥è¡Œæ‰€æœ‰è¿™äº›å¥‘çº¦ï¼Œè¿™åœ¨é€»è¾‘ä¸Šæ˜¯å®Œå…¨åˆç†ä¸”é«˜æ•ˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šå’Œç¤ºä¾‹èƒ½å¸®åŠ©ä½ å½»åº•ç†è§£ Java ä¸­å¤šæ¥å£æ–¹æ³•ç»§æ‰¿çš„æœºåˆ¶ï¼&lt;/p&gt;
&lt;h2 id="æ„é€ æ–¹æ³•"&gt;æ„é€ æ–¹æ³•
&lt;/h2&gt;&lt;p&gt;åœ¨Javaä¸­ï¼Œå­ç±»ä¸ä¼šç»§æ‰¿çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œè¿™æ˜¯ç”±Javaçš„è¯­æ³•è§„åˆ™å’Œé¢å‘å¯¹è±¡çš„è®¾è®¡åŸåˆ™å…±åŒå†³å®šçš„ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€Ÿäº†è§£æ ¸å¿ƒåŸå› å’ŒèƒŒåçš„æœºåˆ¶ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ ¸å¿ƒè¦ç‚¹&lt;/th&gt;
&lt;th&gt;å…·ä½“è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¹æœ¬åŸå› ï¼šè¯­æ³•å†²çª&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ„é€ æ–¹æ³•å¿…é¡»ä¸ç±»åå®Œå…¨ç›¸åŒã€‚çˆ¶ç±»æ„é€ æ–¹æ³•åæ˜¯çˆ¶ç±»åï¼Œå­ç±»æ„é€ æ–¹æ³•åæ˜¯å­ç±»åï¼Œä¸¤è€…æ–¹æ³•åä¸åŒï¼Œä¸ç¬¦åˆæ–¹æ³•ç»§æ‰¿çš„â€œæ–¹æ³•åç›¸åŒâ€çš„åŸºæœ¬è¦æ±‚ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®æœºåˆ¶ï¼šè°ƒç”¨è€Œéç»§æ‰¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­ç±»è™½ä¸ç»§æ‰¿çˆ¶ç±»æ„é€ æ–¹æ³•ï¼Œä½†å¿…é¡»ï¼ˆæ˜¾å¼æˆ–éšå¼ï¼‰è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ã€‚è¿™æ˜¯ä¸ºäº†åˆå§‹åŒ–ä»çˆ¶ç±»ç»§æ‰¿ä¸‹æ¥çš„æˆå‘˜å˜é‡ï¼Œç¡®ä¿çˆ¶ç±»éƒ¨åˆ†è¢«æ­£ç¡®è®¾ç½®åå†åˆå§‹åŒ–å­ç±»ç‰¹æœ‰éƒ¨åˆ†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æ–¹å¼ï¼šsuperå…³é”®å­—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨å­ç±»çš„æ„é€ æ–¹æ³•ä¸­ï¼Œé€šè¿‡ &lt;code&gt;super(...)&lt;/code&gt;æ¥è°ƒç”¨çˆ¶ç±»æŒ‡å®šçš„æ„é€ æ–¹æ³•ã€‚è¿™æ¡è¯­å¥å¿…é¡»æ˜¯å­ç±»æ„é€ æ–¹æ³•çš„ç¬¬ä¸€æ¡è¯­å¥ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡åŸåˆ™ï¼šå°è£…ä¸å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…å­ç±»æ„å¤–è¦†ç›–æˆ–å¹²æ‰°çˆ¶ç±»çš„åˆå§‹åŒ–é€»è¾‘ï¼Œä¿è¯æ¯ä¸ªç±»éƒ½èƒ½æ§åˆ¶è‡ªå·±çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œå¢å¼ºä»£ç çš„å¥å£®æ€§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ç†è§£è°ƒç”¨çš„è¿‡ç¨‹"&gt;ğŸ’¡ ç†è§£â€œè°ƒç”¨â€çš„è¿‡ç¨‹
&lt;/h3&gt;&lt;p&gt;è™½ç„¶ä¸ç»§æ‰¿ï¼Œä½†å­ç±»å¯¹è±¡å®ä¾‹åŒ–æ—¶ï¼Œçˆ¶ç±»çš„æ„é€ æ–¹æ³•ä¸€å®šä¼šè¢«è°ƒç”¨ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯è‡ªåŠ¨çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éšå¼è°ƒç”¨&lt;/strong&gt;ï¼šå¦‚æœå­ç±»çš„æ„é€ æ–¹æ³•æ²¡æœ‰æ˜ç¡®ä½¿ç”¨ &lt;code&gt;super(...)&lt;/code&gt;è°ƒç”¨çˆ¶ç±»çš„æŸä¸ªæ„é€ æ–¹æ³•ï¼ŒJavaç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åœ¨å­ç±»æ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œæ’å…¥ &lt;code&gt;super()&lt;/code&gt;ï¼Œå³è°ƒç”¨çˆ¶ç±»çš„æ— å‚æ„é€ æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜¾å¼è°ƒç”¨&lt;/strong&gt;ï¼šå¦‚æœçˆ¶ç±»æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•ï¼Œæˆ–è€…ä½ å¸Œæœ›è°ƒç”¨çˆ¶ç±»çš„æœ‰å‚æ„é€ æ–¹æ³•ï¼Œåˆ™å¿…é¡»åœ¨å­ç±»æ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œæ˜¾å¼åœ°ä½¿ç”¨ &lt;code&gt;super(å‚æ•°)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªè°ƒç”¨è¿‡ç¨‹å½¢æˆäº†â€œ&lt;strong&gt;æ„é€ é“¾&lt;/strong&gt;â€ï¼šåˆ›å»ºå­ç±»å¯¹è±¡æ—¶ï¼Œä¼šå…ˆä»é¡¶å±‚çš„çˆ¶ç±»å¼€å§‹åˆå§‹åŒ–ï¼Œé€å±‚å‘ä¸‹ï¼Œç›´åˆ°å½“å‰å­ç±»ã€‚è¿™ç¡®ä¿äº†æ‰€æœ‰ç¥–å…ˆç±»çš„åˆå§‹åŒ–å·¥ä½œéƒ½å·²å®Œæˆï¼Œå¯¹è±¡å¤„äºä¸€ä¸ªå®Œæ•´ã€ä¸€è‡´çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h3 id="-æŠ½è±¡ç±»çš„æ„é€ æ–¹æ³•"&gt;ğŸ§© æŠ½è±¡ç±»çš„æ„é€ æ–¹æ³•
&lt;/h3&gt;&lt;p&gt;ä¸€ä¸ªå¸¸è§çš„ç–‘é—®æ˜¯ï¼šæŠ½è±¡ç±»ï¼ˆ&lt;code&gt;abstract class&lt;/code&gt;ï¼‰ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œä¸ºä»€ä¹ˆå®ƒä¹Ÿæœ‰æ„é€ æ–¹æ³•ï¼Œå¹¶ä¸”å­ç±»ä¹Ÿèƒ½è°ƒç”¨ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æŠ½è±¡ç±»çš„æ„é€ æ–¹æ³•å­˜åœ¨çš„æ„ä¹‰ï¼Œæ­£æ˜¯ä¸ºäº†åœ¨å­ç±»å®ä¾‹åŒ–æ—¶è¢«è°ƒç”¨ï¼Œä»¥å®ŒæˆæŠ½è±¡ç±»ä¸­å®šä¹‰çš„æˆå‘˜å˜é‡çš„åˆå§‹åŒ–ã€‚å®ƒçš„æ„é€ æ–¹æ³•è°ƒç”¨æœºåˆ¶ä¸æ™®é€šçˆ¶ç±»å®Œå…¨ä¸€æ ·ã€‚&lt;/p&gt;
&lt;h3 id="-æ€»ç»“-17"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œå­ç±»ä¸ç»§æ‰¿çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œæ˜¯å› ä¸º&lt;strong&gt;è¯­æ³•ä¸Šä¸å…è®¸&lt;/strong&gt;ï¼ˆåå­—å¿…é¡»ä¸ç±»ç›¸åŒï¼‰å’Œ&lt;strong&gt;è®¾è®¡ä¸Šæ›´å®‰å…¨&lt;/strong&gt;ï¼ˆå„è‡ªæ§åˆ¶åˆå§‹åŒ–ï¼‰ã€‚ä½†é€šè¿‡&lt;strong&gt;å¼ºåˆ¶è°ƒç”¨&lt;/strong&gt;çš„æœºåˆ¶ï¼Œåˆä¿è¯äº†å¯¹è±¡åˆå§‹åŒ–çš„å®Œæ•´æ€§å’Œæ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ ç†è§£è¿™ä¸ªæ¦‚å¿µã€‚å¦‚æœä½ å¯¹ &lt;code&gt;super&lt;/code&gt;å…³é”®å­—çš„å…·ä½“ç”¨æ³•æˆ–æ–¹æ³•é‡å†™æœ‰å…¶ä»–ç–‘é—®ï¼Œæˆ‘å¾ˆä¹æ„ç»§ç»­ä¸ºä½ è§£ç­”ã€‚&lt;/p&gt;
&lt;h2 id="stack"&gt;Stack
&lt;/h2&gt;&lt;p&gt;åœ¨Javaä¸­ï¼Œæ ˆï¼ˆStackï¼‰æ˜¯ä¸€ç§éå¸¸é‡è¦çš„åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰æ•°æ®ç»“æ„ã€‚ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒä¿¡æ¯ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ€»ç»“ Java ä¸­å®ç°æ ˆåŠŸèƒ½çš„ä¸»è¦æ–¹å¼åŠå…¶ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;&lt;code&gt;Stack&lt;/code&gt;ç±» (ä¼ ç»Ÿ)&lt;/th&gt;
&lt;th&gt;&lt;code&gt;Deque&lt;/code&gt;æ¥å£ (ç°ä»£æ¨è)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰€å±æ¡†æ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Java Collections Framework&lt;/td&gt;
&lt;td&gt;Java Collections Framework&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»§æ‰¿è‡ª &lt;code&gt;Vector&lt;/code&gt;(åŸºäºæ•°ç»„)&lt;/td&gt;
&lt;td&gt;å¸¸ç”¨ &lt;code&gt;ArrayDeque&lt;/code&gt;(åŸºäºæ•°ç»„) æˆ– &lt;code&gt;LinkedList&lt;/code&gt;(åŸºäºé“¾è¡¨)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯ (æ–¹æ³•åŒæ­¥)&lt;/td&gt;
&lt;td&gt;å¦ (&lt;code&gt;ArrayDeque&lt;/code&gt;, &lt;code&gt;LinkedList&lt;/code&gt;éçº¿ç¨‹å®‰å…¨)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½è¡¨ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒå·® (å› åŒæ­¥å¼€é”€)&lt;/td&gt;
&lt;td&gt;æ›´ä¼˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®˜æ–¹æ¨è&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å·²è¿‡æ—¶ï¼Œä¸æ¨èåœ¨æ–°ä»£ç ä¸­ä½¿ç”¨&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ¨è&lt;/strong&gt; ç”¨äºå®ç°æ ˆåŠŸèƒ½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;push(E)&lt;/code&gt;, &lt;code&gt;pop()&lt;/code&gt;, &lt;code&gt;peek()&lt;/code&gt;, &lt;code&gt;empty()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;push(E)&lt;/code&gt;, &lt;code&gt;pop()&lt;/code&gt;, &lt;code&gt;peek()&lt;/code&gt;, &lt;code&gt;isEmpty()&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-stackçš„æ ¸å¿ƒæ“ä½œ"&gt;ğŸ§± Stackçš„æ ¸å¿ƒæ“ä½œ
&lt;/h3&gt;&lt;p&gt;æ— è®ºä½¿ç”¨å“ªç§å®ç°ï¼Œæ ˆçš„åŸºæœ¬æ“ä½œæ˜¯ç›¸åŒçš„ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒæ–¹æ³•çš„åŠŸèƒ½ã€è¿”å›å€¼åŠæ³¨æ„äº‹é¡¹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ–¹æ³•å&lt;/th&gt;
&lt;th&gt;åŠŸèƒ½æè¿°&lt;/th&gt;
&lt;th&gt;è¿”å›å€¼&lt;/th&gt;
&lt;th&gt;æ ˆç©ºæ—¶çš„è¡Œä¸º&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;push(E item)&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å°†å…ƒç´ å‹å…¥æ ˆé¡¶&lt;/td&gt;
&lt;td&gt;å…¥æ ˆçš„å…ƒç´ &lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;pop()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç§»é™¤å¹¶è¿”å›æ ˆé¡¶å…ƒç´ &lt;/td&gt;
&lt;td&gt;è¢«ç§»é™¤çš„æ ˆé¡¶å…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æŠ›å‡º &lt;code&gt;EmptyStackException&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;peek()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥çœ‹æ ˆé¡¶å…ƒç´ ï¼ˆä¸ç§»é™¤ï¼‰&lt;/td&gt;
&lt;td&gt;æ ˆé¡¶å…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æŠ›å‡º &lt;code&gt;EmptyStackException&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;empty()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ£€æŸ¥æ ˆæ˜¯å¦ä¸ºç©º&lt;/td&gt;
&lt;td&gt;&lt;code&gt;true&lt;/code&gt;(ç©º) / &lt;code&gt;false&lt;/code&gt;(éç©º)&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ä¸ºä½•æ¨èä½¿ç”¨-deque-æ›¿ä»£-stack"&gt;ğŸ’¡ ä¸ºä½•æ¨èä½¿ç”¨ Deque æ›¿ä»£ Stack
&lt;/h3&gt;&lt;p&gt;å®˜æ–¹æ–‡æ¡£å’Œå»ºè®®éƒ½æ¨èä½¿ç”¨ &lt;code&gt;Deque&lt;/code&gt;æ¥å£æ¥æ›¿ä»£ä¼ ç»Ÿçš„ &lt;code&gt;Stack&lt;/code&gt;ç±»ï¼Œä¸»è¦åŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡æ›´ç°ä»£ã€ä¸€è‡´&lt;/strong&gt;ï¼š&lt;code&gt;Deque&lt;/code&gt;æ˜¯ Java é›†åˆæ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†æ›´å®Œæ•´å’Œä¸€è‡´çš„ LIFO æ ˆæ“ä½œæ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æ›´ä¼˜&lt;/strong&gt;ï¼š&lt;code&gt;Stack&lt;/code&gt;ç”±äºç»§æ‰¿è‡ª &lt;code&gt;Vector&lt;/code&gt;ï¼Œå…¶æ–¹æ³•æ˜¯åŒæ­¥çš„ï¼Œè¿™åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­ä¼šå¸¦æ¥ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚è€Œ &lt;code&gt;ArrayDeque&lt;/code&gt;ç­‰å®ç°æ²¡æœ‰åŒæ­¥å¼€é”€ï¼Œæ•ˆç‡æ›´é«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ä¸å½“ä½¿ç”¨&lt;/strong&gt;ï¼š&lt;code&gt;Stack&lt;/code&gt;ç»§æ‰¿è‡ª &lt;code&gt;Vector&lt;/code&gt;ï¼Œå› æ­¤æš´éœ²äº†æŒ‰ç´¢å¼•è®¿é—®ç­‰ä¸å±äºæ ˆæ“ä½œçš„æ–¹æ³•ï¼Œè¿™å¯èƒ½ç ´åæ ˆçš„ LIFO åŸåˆ™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä»£ç ç¤ºä¾‹-1"&gt;ğŸ› ï¸ ä»£ç ç¤ºä¾‹
&lt;/h3&gt;&lt;h4 id="ä½¿ç”¨ä¼ ç»Ÿçš„-stack-ç±»"&gt;ä½¿ç”¨ä¼ ç»Ÿçš„ Stack ç±»
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.Stack;
public class LegacyStackExample {
public static void main(String[] args) {
Stack&amp;lt;String&amp;gt; stack = new Stack&amp;lt;&amp;gt;();
// å…¥æ ˆ
stack.push(&amp;#34;Java&amp;#34;);
stack.push(&amp;#34;Python&amp;#34;);
stack.push(&amp;#34;C++&amp;#34;);
System.out.println(&amp;#34;æ ˆé¡¶å…ƒç´ : &amp;#34; + stack.peek()); // è¾“å‡º: C++
// å‡ºæ ˆ
String popped = stack.pop();
System.out.println(&amp;#34;å‡ºæ ˆå…ƒç´ : &amp;#34; + popped); // è¾“å‡º: C++
System.out.println(&amp;#34;æ ˆæ˜¯å¦ä¸ºç©º: &amp;#34; + stack.empty()); // è¾“å‡º: false
System.out.println(&amp;#34;æ ˆçš„å¤§å°: &amp;#34; + stack.size()); // è¾“å‡º: 2
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ¨èçš„-deque-å®ç°æ–¹å¼"&gt;æ¨èçš„ Deque å®ç°æ–¹å¼
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.ArrayDeque;
import java.util.Deque;
public class ModernStackExample {
public static void main(String[] args) {
// ä½¿ç”¨ ArrayDeque ä½œä¸ºæ ˆ
Deque&amp;lt;String&amp;gt; stack = new ArrayDeque&amp;lt;&amp;gt;();
stack.push(&amp;#34;Java&amp;#34;);
stack.push(&amp;#34;Python&amp;#34;);
stack.push(&amp;#34;C++&amp;#34;);
System.out.println(&amp;#34;æ ˆé¡¶å…ƒç´ : &amp;#34; + stack.peek()); // è¾“å‡º: C++
String popped = stack.pop();
System.out.println(&amp;#34;å‡ºæ ˆå…ƒç´ : &amp;#34; + popped); // è¾“å‡º: C++
System.out.println(&amp;#34;æ ˆæ˜¯å¦ä¸ºç©º: &amp;#34; + stack.isEmpty()); // è¾“å‡º: false
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹-1"&gt;âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºæ ˆæ“ä½œ&lt;/strong&gt;ï¼šè°ƒç”¨ç©ºæ ˆçš„ &lt;code&gt;pop()&lt;/code&gt;æˆ– &lt;code&gt;peek()&lt;/code&gt;æ–¹æ³•ä¼šæŠ›å‡º &lt;code&gt;EmptyStackException&lt;/code&gt;ï¼ˆå¯¹äº &lt;code&gt;Stack&lt;/code&gt;ç±»ï¼‰æˆ–è¿”å› &lt;code&gt;null&lt;/code&gt;ï¼ˆå¯¹äº &lt;code&gt;Deque&lt;/code&gt;çš„ &lt;code&gt;pop()&lt;/code&gt;å’Œ &lt;code&gt;peek()&lt;/code&gt;ï¼Œä½† &lt;code&gt;Deque&lt;/code&gt;çš„ &lt;code&gt;pop()&lt;/code&gt;ä»ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œé€šå¸¸ä½¿ç”¨ &lt;code&gt;poll()&lt;/code&gt;æ¥å®‰å…¨åœ°è¿”å› nullï¼‰ã€‚æ“ä½œå‰æœ€å¥½ä½¿ç”¨ &lt;code&gt;empty()&lt;/code&gt;æˆ– &lt;code&gt;isEmpty()&lt;/code&gt;è¿›è¡Œæ£€æŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;ï¼š&lt;code&gt;Stack&lt;/code&gt;æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½† &lt;code&gt;ArrayDeque&lt;/code&gt;å’Œ &lt;code&gt;LinkedList&lt;/code&gt;ä¸æ˜¯ã€‚å¦‚æœåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­éœ€è¦ä½¿ç”¨æ ˆï¼Œåº”è€ƒè™‘ä½¿ç”¨ &lt;code&gt;ConcurrentLinkedDeque&lt;/code&gt;ç­‰çº¿ç¨‹å®‰å…¨çš„å®ç°ï¼Œæˆ–é€šè¿‡å¤–éƒ¨åŒæ­¥æ§åˆ¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ ˆçš„å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸŒ æ ˆçš„å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;æ ˆåœ¨è®¡ç®—æœºç§‘å­¦å’Œç¼–ç¨‹ä¸­åº”ç”¨éå¸¸å¹¿æ³›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡½æ•°è°ƒç”¨æ ˆ&lt;/strong&gt;ï¼šå­˜å‚¨å‡½æ•°è°ƒç”¨æ—¶çš„è¿”å›åœ°å€ã€å±€éƒ¨å˜é‡ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡¨è¾¾å¼æ±‚å€¼&lt;/strong&gt;ï¼šå¦‚å°†ä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢ä¸ºåç¼€è¡¨è¾¾å¼ï¼ˆé€†æ³¢å…°è¡¨è¾¾å¼ï¼‰å¹¶è¿›è¡Œæ±‚å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‹¬å·åŒ¹é…&lt;/strong&gt;ï¼šæ£€æŸ¥ä»£ç æˆ–è¡¨è¾¾å¼ä¸­çš„æ‹¬å·æ˜¯å¦æ­£ç¡®åµŒå¥—å’Œé—­åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æº¯ç®—æ³•&lt;/strong&gt;ï¼šä¾‹å¦‚æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ã€è¿·å®«æ±‚è§£ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’¤é”€ï¼ˆUndoï¼‰åŠŸèƒ½&lt;/strong&gt;ï¼šè®¸å¤šç¼–è¾‘å™¨ä¸­çš„æ’¤é”€æ“ä½œå¯ä»¥ç”¨æ ˆæ¥ä¿å­˜å†å²çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ Java ä¸­çš„æ ˆã€‚å¦‚æœä½ å¯¹ç‰¹å®šåº”ç”¨åœºæ™¯æˆ–æ›´æ·±å…¥çš„å®ç°ç»†èŠ‚æœ‰ç–‘é—®ï¼Œæˆ‘å¾ˆä¹æ„è¿›ä¸€æ­¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="æœ¬åœ°ç±»"&gt;æœ¬åœ°ç±»
&lt;/h2&gt;&lt;p&gt;Java ä¸­çš„æœ¬åœ°ç±»ï¼ˆLocal Classï¼‰æ˜¯ä¸€ç§å®šä¹‰åœ¨ä»£ç å—ï¼ˆå¦‚æ–¹æ³•ä½“ã€æ„é€ å‡½æ•°æˆ–é™æ€åˆå§‹åŒ–å—ï¼‰å†…éƒ¨çš„ç±»ã€‚å®ƒå…è®¸ä½ å°†ç±»çš„å®šä¹‰ç´§æŒ¨ç€å…¶ä½¿ç”¨ä½ç½®ï¼Œä»è€Œæå‡ä»£ç çš„å°è£…æ€§å’Œå¯è¯»æ€§ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€ŸæŠŠæ¡å…¶æ ¸å¿ƒç‰¹å¾ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®šä¹‰ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–¹æ³•ã€æ„é€ å‡½æ•°æˆ–ä»»ä½•ä»£ç å—å†…éƒ¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¿é—®æƒé™&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åªèƒ½åœ¨å…¶å®šä¹‰çš„ä»£ç å—å†…ä½¿ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¿®é¥°ç¬¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸èƒ½ä½¿ç”¨ &lt;code&gt;public&lt;/code&gt;, &lt;code&gt;private&lt;/code&gt;, &lt;code&gt;protected&lt;/code&gt;æˆ– &lt;code&gt;static&lt;/code&gt;ä¿®é¥°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¿é—®å¤–éƒ¨å˜é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åªèƒ½è®¿é—®æ‰€åœ¨ä½œç”¨åŸŸä¸­å£°æ˜ä¸º &lt;code&gt;final&lt;/code&gt;æˆ– &lt;strong&gt;effectively final&lt;/strong&gt; çš„å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€æˆå‘˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸èƒ½å£°æ˜é™æ€æˆå‘˜ï¼ˆé™æ€å¸¸é‡ &lt;code&gt;static final&lt;/code&gt;é™¤å¤–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ä¼˜åŠ¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€»è¾‘åˆ†ç»„ã€å¢å¼ºå°è£…ã€ä»£ç æ›´è´´è¿‘ä½¿ç”¨ç‚¹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ç†è§£è¯­æ³•ä¸è§„åˆ™"&gt;ğŸ” ç†è§£è¯­æ³•ä¸è§„åˆ™
&lt;/h3&gt;&lt;p&gt;è¦æœ‰æ•ˆä½¿ç”¨æœ¬åœ°ç±»ï¼Œéœ€è¦äº†è§£å…¶å…·ä½“çš„è¯­æ³•å’Œå¿…é¡»éµå®ˆçš„è§„åˆ™ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸºæœ¬è¯­æ³•ç»“æ„&lt;/strong&gt;ï¼šæœ¬åœ°ç±»ç›´æ¥å®šä¹‰åœ¨ä»£ç å—ä¸­ã€‚ä»¥ä¸‹æ˜¯åœ¨æ–¹æ³•å†…å®šä¹‰çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class OuterClass {
public void someMethod() {
// æœ¬åœ°ç±»å®šä¹‰å¼€å§‹
class LocalClass {
private String message;
public LocalClass(String msg) {
this.message = msg;
}
public void printMessage() {
System.out.println(message);
}
}
// æœ¬åœ°ç±»å®šä¹‰ç»“æŸ
// åœ¨æ–¹æ³•å†…ä½¿ç”¨æœ¬åœ°ç±»
LocalClass local = new LocalClass(&amp;#34;Hello from local class!&amp;#34;);
local.printMessage();
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®è§„åˆ™ä¸é™åˆ¶&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨åŸŸå—é™&lt;/strong&gt;ï¼šæœ¬åœ°ç±»åªåœ¨å®šä¹‰å®ƒçš„ä»£ç å—å†…å¯è§ï¼Œä¹‹å¤–æ— æ³•è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¿é—®å¤–éƒ¨å˜é‡&lt;/strong&gt;ï¼šè¿™æ˜¯æœ¬åœ°ç±»ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ã€‚å®ƒåªèƒ½è®¿é—®å…¶æ‰€åœ¨ä½œç”¨åŸŸä¸­å£°æ˜ä¸º &lt;code&gt;final&lt;/code&gt;æˆ– &lt;strong&gt;effectively final&lt;/strong&gt;ï¼ˆå³åˆå§‹åŒ–åå€¼ä»æœªæ”¹å˜çš„å˜é‡ï¼‰çš„å±€éƒ¨å˜é‡æˆ–å‚æ•°ã€‚è¿™æ˜¯å› ä¸ºæœ¬åœ°ç±»çš„å®ä¾‹ç”Ÿå‘½å‘¨æœŸå¯èƒ½æ¯”åˆ›å»ºå®ƒçš„æ–¹æ³•æ›´é•¿ï¼ŒJava é€šè¿‡å¤åˆ¶è¿™äº›å˜é‡çš„å€¼æ¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿®é¥°ç¬¦ä¸é™æ€æˆå‘˜&lt;/strong&gt;ï¼šæœ¬åœ°ç±»æœ¬èº«ä¸èƒ½æœ‰è®¿é—®ä¿®é¥°ç¬¦ï¼ˆå¦‚ &lt;code&gt;public&lt;/code&gt;ï¼‰ï¼Œä¹Ÿä¸èƒ½å£°æ˜ä¸º &lt;code&gt;static&lt;/code&gt;ã€‚åŒæ—¶ï¼Œå®ƒå†…éƒ¨ä¸èƒ½æœ‰é™æ€æ–¹æ³•æˆ–å­—æ®µï¼ˆé™¤äº†é™æ€å¸¸é‡ &lt;code&gt;static final&lt;/code&gt;)ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æœ¬åœ°ç±»å®æˆ˜ç¤ºä¾‹"&gt;ğŸ“ æœ¬åœ°ç±»å®æˆ˜ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ›´å…·ä½“çš„ä¾‹å­çœ‹çœ‹æœ¬åœ°ç±»å¦‚ä½•å·¥ä½œã€‚è¿™ä¸ªä¾‹å­æ¨¡æ‹ŸéªŒè¯ç”µè¯å·ç æ ¼å¼ï¼Œæœ¬åœ°ç±»è´Ÿè´£å…·ä½“çš„æ ¼å¼æ ¡éªŒé€»è¾‘ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class PhoneNumberValidator {
// å¤–éƒ¨ç±»çš„é™æ€å˜é‡ï¼Œæœ¬åœ°ç±»å¯ä»¥è®¿é—®
private static final String DIGITS_REGEX = &amp;#34;[â°-9]&amp;#34;;
public void validatePhoneNumbers(String number1, String number2) {
// æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡ï¼Œæœ¬åœ°ç±»å¯ä»¥è®¿é—®ï¼ˆeffectively finalï¼‰
final int requiredLength = 10;
// å®šä¹‰æœ¬åœ°ç±»
class PhoneNumber {
private String formattedNumber;
public PhoneNumber(String rawNumber) {
// è®¿é—®å¤–éƒ¨ç±»çš„é™æ€å˜é‡ DIGITS_REGEX
// è®¿é—®å¤–éƒ¨æ–¹æ³•çš„ effectively final å±€éƒ¨å˜é‡ requiredLength
String digitsOnly = rawNumber.replaceAll(DIGITS_REGEX, &amp;#34;&amp;#34;);
if (digitsOnly.length() == requiredLength) {
this.formattedNumber = digitsOnly;
} else {
this.formattedNumber = null;
}
}
public String getFormattedNumber() {
return formattedNumber;
}
}
// ä½¿ç”¨æœ¬åœ°ç±»
PhoneNumber pn1 = new PhoneNumber(number1);
PhoneNumber pn2 = new PhoneNumber(number2);
System.out.println(&amp;#34;First number is &amp;#34; +
(pn1.getFormattedNumber() != null ? &amp;#34;valid&amp;#34; : &amp;#34;invalid&amp;#34;));
System.out.println(&amp;#34;Second number is &amp;#34; +
(pn2.getFormattedNumber() != null ? &amp;#34;valid&amp;#34; : &amp;#34;invalid&amp;#34;));
}
public static void main(String[] args) {
PhoneNumberValidator validator = new PhoneNumberValidator();
validator.validatePhoneNumbers(&amp;#34;123-456-7890&amp;#34;, &amp;#34;555-123&amp;#34;);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ¬åœ°ç±» &lt;code&gt;PhoneNumber&lt;/code&gt;å°è£…äº†ç”µè¯å·ç çš„éªŒè¯é€»è¾‘ï¼Œç›´æ¥ä½¿ç”¨äº†å¤–éƒ¨æ–¹æ³•çš„å‚æ•° (&lt;code&gt;number1&lt;/code&gt;, &lt;code&gt;number2&lt;/code&gt;)ã€å±€éƒ¨å˜é‡ (&lt;code&gt;requiredLength&lt;/code&gt;) å’Œå¤–éƒ¨ç±»çš„é™æ€å¸¸é‡ (&lt;code&gt;DIGITS_REGEX&lt;/code&gt;)ã€‚&lt;/p&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸ä¼˜ç¼ºç‚¹"&gt;ğŸ’¡ åº”ç”¨åœºæ™¯ä¸ä¼˜ç¼ºç‚¹
&lt;/h3&gt;&lt;p&gt;æœ¬åœ°ç±»å¹¶éä¸‡èƒ½å·¥å…·ï¼Œäº†è§£å…¶é€‚ç”¨åœºæ™¯å’Œå±€é™æ€§å¾ˆé‡è¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼š
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€»è¾‘åˆ†ç»„ä¸å°è£…&lt;/strong&gt;ï¼šå½“æŸä¸ªç±»åªåœ¨ä¸€ä¸ªæ–¹æ³•å†…éƒ¨æœ‰ç‰¹å®šç”¨é€”ï¼Œä¸å…·å¤‡é€šç”¨æ€§æ—¶ï¼Œä½¿ç”¨æœ¬åœ°ç±»å¯ä»¥é¿å…æ±¡æŸ“å¤–éƒ¨å‘½åç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹ä»¶ç›‘å¬ä¸å¤„ç†å™¨&lt;/strong&gt;ï¼šåœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰ç¼–ç¨‹ä¸­ï¼Œä¼ ç»Ÿä¸Šä¼šä½¿ç”¨æœ¬åœ°ç±»ï¼ˆæˆ–åŒ¿åç±»ï¼‰æ¥åˆ›å»ºç‰¹å®šäºæŸä¸ªç»„ä»¶çš„äº‹ä»¶å¤„ç†å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¾…åŠ©åŠŸèƒ½å®ç°&lt;/strong&gt;ï¼šå¦‚æœæŸä¸ªæ–¹æ³•å†…éƒ¨éœ€è¦å¤æ‚çš„è¾…åŠ©é€»è¾‘ï¼Œå°†å…¶å°è£…åœ¨ä¸€ä¸ªæœ¬åœ°ç±»ä¸­å¯ä»¥ä½¿ä¸»æ–¹æ³•æ›´æ¸…æ™°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿ä¸å±€é™&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå¢å¼ºä»£ç çš„&lt;strong&gt;å¯è¯»æ€§&lt;/strong&gt;å’Œ&lt;strong&gt;ç»´æŠ¤æ€§&lt;/strong&gt;ï¼Œå°†ç›¸å…³ä»£ç ç´§å¯†ç»„ç»‡åœ¨ä¸€èµ·ï¼›å®ç°æ›´å¥½çš„&lt;strong&gt;å°è£…&lt;/strong&gt;ï¼Œéšè—å®ç°ç»†èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š&lt;strong&gt;ä½œç”¨åŸŸéå¸¸æœ‰é™&lt;/strong&gt;ï¼Œæ— æ³•åœ¨å®šä¹‰å®ƒçš„ä»£ç å—ä¹‹å¤–é‡ç”¨ï¼›ä¸ &lt;strong&gt;Lambda è¡¨è¾¾å¼&lt;/strong&gt; ç›¸æ¯”ï¼Œè¯­æ³•å¯èƒ½ç¨æ˜¾å†—é•¿ï¼Œç‰¹åˆ«æ˜¯åœ¨å®ç°åªæœ‰ä¸€ä¸ªæ–¹æ³•çš„æ¥å£æ—¶ï¼ˆæ­¤æ—¶ Lambda è¡¨è¾¾å¼æ›´ç®€æ´ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é‡è¦æ³¨æ„äº‹é¡¹-1"&gt;âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;åœ¨å®é™…ä½¿ç”¨æœ¬åœ°ç±»æ—¶ï¼Œè¯·ç‰¹åˆ«æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å˜é‡æ•è·ä¸ Effectively Final&lt;/strong&gt;ï¼šåŠ¡å¿…ç¡®ä¿æœ¬åœ°ç±»è®¿é—®çš„å±€éƒ¨å˜é‡æ˜¯ &lt;code&gt;final&lt;/code&gt;æˆ– effectively finalã€‚å°è¯•ä¿®æ”¹æ–¹æ³•å†…çš„é final å˜é‡ç„¶ååœ¨æœ¬åœ°ç±»ä¸­ä½¿ç”¨ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸åŒ¿åç±»çš„é€‰æ‹©&lt;/strong&gt;ï¼šå¦‚æœè¿™ä¸ªç±»åªéœ€è¦&lt;strong&gt;ä¸€ä¸ªå®ä¾‹&lt;/strong&gt;ï¼Œå¹¶ä¸”å®ç°çš„æ˜¯ä¸€ä¸ª&lt;strong&gt;ç®€å•çš„æ¥å£&lt;/strong&gt;æˆ–&lt;strong&gt;æŠ½è±¡ç±»&lt;/strong&gt;ï¼Œæœ‰æ—¶ä½¿ç”¨&lt;strong&gt;åŒ¿åå†…éƒ¨ç±»&lt;/strong&gt;å¯èƒ½æ›´ç®€æ´ã€‚ä½†æœ¬åœ°ç±»çš„ä¼˜åŠ¿åœ¨äºå®ƒæœ‰åå­—ï¼Œå¯è¯»æ€§æ›´å¥½ï¼Œå¹¶ä¸”å¯ä»¥æœ‰å¤šä¸ªæ„é€ æ–¹æ³•æˆ–æ›´å¤æ‚çš„æˆå‘˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åºåˆ—åŒ–è­¦å‘Š&lt;/strong&gt;ï¼šå¼ºçƒˆä¸å»ºè®®å¯¹æœ¬åœ°ç±»ï¼ˆä»¥åŠåŒ¿åå†…éƒ¨ç±»ï¼‰è¿›è¡Œåºåˆ—åŒ–ã€‚å› ä¸º Java ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿™äº›ç±»æ—¶ä¼šç”Ÿæˆä¸€äº›åˆæˆç»“æ„ï¼ˆSynthetic Constructsï¼‰ï¼Œè¿™äº›ç»“æ„åœ¨ä¸åŒç‰ˆæœ¬çš„ Java ç¼–è¯‘å™¨ä¸­å¯èƒ½å­˜åœ¨å·®å¼‚ï¼Œä»è€Œåœ¨ååºåˆ—åŒ–æ—¶å¼•å‘å…¼å®¹æ€§é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸å…¶ä»–å†…éƒ¨ç±»çš„å¯¹æ¯”"&gt;ğŸ”„ ä¸å…¶ä»–å†…éƒ¨ç±»çš„å¯¹æ¯”
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†æ›´å…¨é¢åœ°ç†è§£æœ¬åœ°ç±»ï¼Œå¯ä»¥å°†å…¶ä¸Javaä¸­å…¶ä»–ç±»å‹çš„å†…éƒ¨ç±»è¿›è¡Œç®€å•æ¯”è¾ƒï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç±»å‹&lt;/th&gt;
&lt;th&gt;å®šä¹‰ä½ç½®&lt;/th&gt;
&lt;th&gt;ä¸»è¦ç‰¹å¾&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æˆå‘˜å†…éƒ¨ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤–éƒ¨ç±»çš„æˆå‘˜ä½ç½®ï¼Œä¸å­—æ®µã€æ–¹æ³•å¹³çº§&lt;/td&gt;
&lt;td&gt;ä¸å¤–éƒ¨ç±»å®ä¾‹å…³è”ï¼Œå¯ç›´æ¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰æˆå‘˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€åµŒå¥—ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤–éƒ¨ç±»çš„æˆå‘˜ä½ç½®ï¼Œç”¨ &lt;code&gt;static&lt;/code&gt;ä¿®é¥°&lt;/td&gt;
&lt;td&gt;ä¸ä¸å¤–éƒ¨ç±»å®ä¾‹å…³è”ï¼Œè®¿é—®å¤–éƒ¨ç±»æˆå‘˜éœ€é€šè¿‡å¯¹è±¡å¼•ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬åœ°ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–¹æ³•æˆ–ä»£ç å—å†…éƒ¨&lt;/td&gt;
&lt;td&gt;ä½œç”¨åŸŸå—é™ï¼Œå¯è®¿é—® final/effectively final å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒ¿åç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¡¨è¾¾å¼å†…éƒ¨ï¼Œæ— æ˜¾å¼ç±»å&lt;/td&gt;
&lt;td&gt;ç”¨äºä¸€æ¬¡æ€§ä½¿ç”¨ï¼Œå®ç°æ¥å£æˆ–ç»§æ‰¿ç±»ï¼Œè¯­æ³•æ›´ç´§å‡‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œæœ¬åœ°ç±»æ˜¯Javaä¸­ä¸€ç§ç”¨äºå¢å¼ºä»£ç å°è£…æ€§å’Œç»„ç»‡æ€§çš„æœ‰ç”¨å·¥å…·ï¼Œç‰¹åˆ«é€‚åˆåœ¨å•ä¸ªæ–¹æ³•æˆ–ä»£ç å—å†…ç»„ç»‡ä¸“ç”¨çš„é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ é€å½»åœ°ç†è§£Javaæœ¬åœ°ç±»ï¼å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šç»†èŠ‚è¿˜æƒ³æ·±å…¥äº†è§£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºæ‚¨æå‡ºçš„â€œä¸ºä»€ä¹ˆæœ¬åœ°ç±»æ²¡æœ‰FQNï¼ˆå…¨é™å®šåï¼‰â€è¿™ä¸ªé—®é¢˜ï¼Œå…¶æ ¸å¿ƒåŸå› åœ¨äº&lt;strong&gt;æœ¬åœ°ç±»çš„ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸä¸æ ‡å‡†çš„é¡¶çº§ç±»æœ‰æœ¬è´¨åŒºåˆ«&lt;/strong&gt;ï¼Œè¿™å†³å®šäº†å®ƒä¸éœ€è¦ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚&lt;/p&gt;
&lt;h3 id="-ç†è§£fqnä¸æœ¬åœ°ç±»çš„æœ¬è´¨"&gt;ğŸ” ç†è§£FQNä¸æœ¬åœ°ç±»çš„æœ¬è´¨
&lt;/h3&gt;&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®FQNçš„å«ä¹‰å’Œä½œç”¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;FQNï¼ˆå…¨é™å®šåï¼‰&lt;/strong&gt;ï¼šä¸€ä¸ªç±»çš„FQNç”±å…¶&lt;strong&gt;åŒ…å&lt;/strong&gt;å’Œ&lt;strong&gt;ç±»å&lt;/strong&gt;å…±åŒç»„æˆï¼ˆä¾‹å¦‚ &lt;code&gt;java.util.ArrayList&lt;/code&gt;ï¼‰ã€‚å®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯åœ¨ä¸€ä¸ªJavaç¨‹åºä¸­&lt;strong&gt;å…¨å±€æ€§åœ°ã€å”¯ä¸€åœ°æ ‡è¯†ä¸€ä¸ªç±»&lt;/strong&gt;ã€‚ç±»åŠ è½½å™¨æ­£æ˜¯é€šè¿‡FQNåœ¨ç±»è·¯å¾„ï¼ˆClasspathï¼‰ä¸Šå®šä½å¹¶åŠ è½½å¯¹åº”çš„ &lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°ç±»ï¼ˆLocal Classï¼‰&lt;/strong&gt;ï¼šæœ¬åœ°ç±»è¢«å®šä¹‰åœ¨ä¸€ä¸ªä»£ç å—å†…éƒ¨ï¼ˆå¦‚æ–¹æ³•ã€æ„é€ å‡½æ•°æˆ–é™æ€åˆå§‹åŒ–å—ä¸­ï¼‰ã€‚å®ƒçš„&lt;strong&gt;ä½œç”¨åŸŸè¢«ä¸¥æ ¼é™åˆ¶åœ¨å®šä¹‰å®ƒçš„é‚£ä¸ªä»£ç å—ä¹‹å†…&lt;/strong&gt;ï¼Œåœ¨ä»£ç å—å¤–éƒ¨æ— æ³•ç›´æ¥è®¿é—®ã€‚å®ƒçš„ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸å¤–éƒ¨ç±»çš„å®ä¾‹ä»¥åŠè¯¥ä»£ç å—çš„æ‰§è¡Œç´§å¯†ç›¸å…³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç®€å•æ¥è¯´ï¼ŒFQNæ˜¯ä¸ºé‚£äº›éœ€è¦åœ¨å…¨å±€èŒƒå›´å†…è¢«å”¯ä¸€è¯†åˆ«å’Œè®¿é—®çš„â€œå…¬æ°‘â€ï¼ˆé¡¶çº§ç±»ï¼‰è®¾è®¡çš„èº«ä»½è¯ã€‚è€Œæœ¬åœ°ç±»æ›´åƒæ˜¯ä¸€ä¸ªåœ¨ç‰¹å®šåŒºåŸŸï¼ˆæ–¹æ³•å†…éƒ¨ï¼‰ä¸´æ—¶å·¥ä½œçš„â€œå†…éƒ¨æˆå‘˜â€ï¼Œå¤–ç•Œä¸éœ€è¦ã€ä¹Ÿä¸åº”è¯¥ç›´æ¥çŸ¥é“å®ƒçš„å…¨åã€‚&lt;/p&gt;
&lt;h3 id="-ç¼–è¯‘è§†è§’åˆæˆä¸é‡å‘½å"&gt;ğŸ§± ç¼–è¯‘è§†è§’ï¼šåˆæˆä¸é‡å‘½å
&lt;/h3&gt;&lt;p&gt;ä»Javaç¼–è¯‘å™¨çš„å®ç°è§’åº¦æ¥çœ‹ï¼Œä¸ºäº†ç®¡ç†æœ¬åœ°ç±»ç‹¬ç‰¹çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯èƒ½å¯¹&lt;strong&gt;å¤–éƒ¨æœ‰æ•ˆç»ˆç»“å˜é‡ï¼ˆeffectively final variablesï¼‰&lt;/strong&gt; çš„è®¿é—®ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¼šè¿›è¡Œä¸€äº›è‡ªåŠ¨åŒ–å¤„ç†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆåˆæˆæ–¹æ³•ï¼ˆSynthetic Methodsï¼‰&lt;/strong&gt;ï¼šå¦‚æœæœ¬åœ°ç±»è®¿é—®äº†å…¶å¤–éƒ¨ä½œç”¨åŸŸçš„å±€éƒ¨å˜é‡ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šåœ¨å¤–éƒ¨ç±»ä¸­ç”Ÿæˆä¸€äº›â€œåˆæˆâ€æ–¹æ³•ï¼Œä»¥ä¾¿æœ¬åœ°ç±»å¯ä»¥å®‰å…¨åœ°è®¿é—®è¿™äº›æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åç§°æ”¹å†™ï¼ˆName Manglingï¼‰&lt;/strong&gt;ï¼šä¸ºäº†è§£å†³å¯èƒ½çš„å‘½åå†²çªï¼Œå°¤å…¶æ˜¯åœ¨å¤šä¸ªæ–¹æ³•ä¸­å®šä¹‰äº†ç›¸åŒåç§°çš„æœ¬åœ°ç±»æ—¶ï¼Œç¼–è¯‘å™¨ä¼š&lt;strong&gt;ä¸ºæœ¬åœ°ç±»ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„å†…éƒ¨åç§°&lt;/strong&gt;ã€‚è¿™ä¸ªåç§°é€šå¸¸ä¼šåŒ…å«å¤–éƒ¨ç±»åã€ä¸€ä¸ªç¾å…ƒç¬¦å· &lt;code&gt;$&lt;/code&gt;ã€ä¸€ä¸ªæ•°å­—åºå·ä»¥åŠæœ¬åœ°ç±»å£°æ˜çš„åç§°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ &lt;code&gt;OuterClass&lt;/code&gt;çš„ &lt;code&gt;aMethod&lt;/code&gt;ä¸­å®šä¹‰äº†ä¸€ä¸ªæœ¬åœ°ç±» &lt;code&gt;LocalClass&lt;/code&gt;ï¼Œç¼–è¯‘åç”Ÿæˆçš„ç±»æ–‡ä»¶å¯èƒ½ç±»ä¼¼äº &lt;code&gt;OuterClass$1LocalClass.class&lt;/code&gt;ã€‚è¿™ä¸ªåç§°æ˜¯ç¼–è¯‘å™¨å†…éƒ¨ä½¿ç”¨çš„ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªåœ¨Javaæºä»£ç å±‚é¢å¯ä»¥ä½¿ç”¨çš„ã€ç¬¦åˆè¯­è¨€è§„èŒƒçš„FQNã€‚&lt;/p&gt;
&lt;h3 id="-è®¾è®¡å“²å­¦å°è£…ä¸å®‰å…¨"&gt;ğŸ’¡ è®¾è®¡å“²å­¦ï¼šå°è£…ä¸å®‰å…¨
&lt;/h3&gt;&lt;p&gt;ä»è½¯ä»¶è®¾è®¡è§’åº¦çœ‹ï¼Œä¸ç»™æœ¬åœ°ç±»èµ‹äºˆFQNä¹Ÿç¬¦åˆ&lt;strong&gt;å°è£…&lt;/strong&gt;çš„åŸåˆ™ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éšè—å®ç°ç»†èŠ‚&lt;/strong&gt;ï¼šæœ¬åœ°ç±»é€šå¸¸ç”¨äºå®ç°æŸä¸ªæ–¹æ³•å†…éƒ¨ç‰¹å®šçš„ã€å±€éƒ¨çš„é€»è¾‘ã€‚å°†å…¶â€œéšè—â€åœ¨æ–¹æ³•å†…éƒ¨ï¼Œä¸æš´éœ²ç»™å¤–éƒ¨ä¸–ç•Œï¼Œæœ‰åŠ©äºä¿æŒä»£ç çš„æ¨¡å—åŒ–å’Œç®€æ´æ€§ï¼Œé¿å…ä¸å¿…è¦çš„è€¦åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜²æ­¢è¯¯ç”¨&lt;/strong&gt;ï¼šç”±äºæ²¡æœ‰FQNï¼Œå…¶ä»–åœ°æ–¹çš„ä»£ç æ— æ³•ç›´æ¥å¼•ç”¨æˆ–å®ä¾‹åŒ–è¿™ä¸ªæœ¬åœ°ç±»ã€‚è¿™ä»è¯­è¨€å±‚é¢å¼ºåˆ¶äº†å…¶ä½¿ç”¨èŒƒå›´ï¼Œé¿å…äº†å¼€å‘è€…åœ¨ä¸æ°å½“çš„ä¸Šä¸‹æ–‡ä¸­è¯¯ç”¨å®ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸å…¶ä»–å†…éƒ¨ç±»çš„å¯¹æ¯”-1"&gt;ğŸ”„ ä¸å…¶ä»–å†…éƒ¨ç±»çš„å¯¹æ¯”
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†æ›´æ¸…æ™°åœ°ç†è§£æœ¬åœ°ç±»çš„ç‰¹æ®Šæ€§ï¼Œå¯ä»¥å°†å…¶ä¸Javaä¸­å…¶ä»–ç±»å‹çš„å†…éƒ¨ç±»è¿›è¡Œç®€å•æ¯”è¾ƒï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å†…éƒ¨ç±»ç±»å‹&lt;/th&gt;
&lt;th&gt;æ˜¯å¦æœ‰FQN&lt;/th&gt;
&lt;th&gt;ä¸»è¦åŸå› &lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æˆå‘˜å†…éƒ¨ç±»ï¼ˆMember Inner Classï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æœ‰&lt;/strong&gt; (å¦‚ &lt;code&gt;OuterClass$InnerClass&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;å®ƒæ˜¯å¤–éƒ¨ç±»çš„æˆå‘˜ï¼Œä¸å¤–éƒ¨ç±»å®ä¾‹å…³è”ï¼Œä½†ä½œç”¨åŸŸæ˜¯æ•´ä¸ªå¤–éƒ¨ç±»ï¼Œéœ€è¦åœ¨å¤–éƒ¨ç±»èŒƒå›´å†…è¢«å”¯ä¸€æ ‡è¯†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€åµŒå¥—ç±»ï¼ˆStatic Nested Classï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æœ‰&lt;/strong&gt; (å¦‚ &lt;code&gt;OuterClass$StaticNestedClass&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;å®ƒæ˜¯é™æ€çš„ï¼Œä¸å¤–éƒ¨ç±»å®ä¾‹æ— å…³ï¼Œè¡Œä¸ºä¸Šæ›´æ¥è¿‘ä¸€ä¸ªç‹¬ç«‹çš„é¡¶çº§ç±»ï¼Œåªæ˜¯è¢«åµŒå¥—åœ¨å¦ä¸€ä¸ªç±»å†…éƒ¨ä»¥ä¾¿äºç»„ç»‡ç®¡ç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬åœ°ç±»ï¼ˆLocal Classï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½œç”¨åŸŸä»…é™äºæ–¹æ³•æˆ–ä»£ç å—å†…éƒ¨ï¼Œç”Ÿå‘½å‘¨æœŸä¸´æ—¶ï¼Œç”±ç¼–è¯‘å™¨è¿›è¡Œåç§°æ”¹å†™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒ¿åç±»ï¼ˆAnonymous Classï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿åå­—éƒ½æ²¡æœ‰ï¼Œæ›´è°ˆä¸ä¸ŠFQNã€‚å®ƒç”¨äºä¸€æ¬¡æ€§ä½¿ç”¨ï¼Œç¼–è¯‘ååç§°ç±»ä¼¼ &lt;code&gt;OuterClass$1&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œæœ¬åœ°ç±»æ²¡æœ‰FQNï¼Œæ ¹æœ¬ä¸Šæ˜¯ç”±äºå…¶&lt;strong&gt;å—é™çš„ä½œç”¨åŸŸã€ä¸´æ—¶çš„ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;ä»¥åŠJavaç¼–è¯‘å™¨ä¸ºå®ç°è¿™äº›ç‰¹æ€§è€Œè¿›è¡Œçš„&lt;strong&gt;å†…éƒ¨å¤„ç†ï¼ˆå¦‚åç§°æ”¹å†™ï¼‰&lt;/strong&gt; æ‰€å…±åŒå†³å®šçš„ã€‚è¿™å¹¶éä¸€ç§â€œç¼ºé™·â€ï¼Œè€Œæ˜¯Javaè¯­è¨€è®¾è®¡ä¸Šä¸ºäº†æ”¯æŒæ›´å¥½çš„å°è£…å’Œä»£ç ç»„ç»‡è€Œåšå‡ºçš„ä¸€ç§æƒè¡¡ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©æ‚¨ä»æ ¹æœ¬ä¸Šç†è§£è¿™ä¸ªé—®é¢˜ï¼å¦‚æœæ‚¨å¯¹Javaç±»åŠ è½½æœºåˆ¶æˆ–å…¶ä»–ç›¸å…³è¯é¢˜è¿˜æœ‰å…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¯çš„ï¼ŒJavaä¸­çš„æœ¬åœ°ç±»å®Œå…¨å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»æˆ–è€…å®ç°æ¥å£ã€‚è¿™ä¸ªç‰¹æ€§è®©æœ¬åœ°ç±»åœ¨å°è£…ç‰¹å®šé€»è¾‘æ—¶éå¸¸çµæ´»ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€Ÿäº†è§£æœ¬åœ°ç±»åœ¨ç»§æ‰¿å’Œå®ç°æ–¹é¢çš„æ ¸å¿ƒèƒ½åŠ›ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å¯ä»¥ç»§æ‰¿ä¸€ä¸ªç±»ï¼ˆä½¿ç”¨ &lt;code&gt;extends&lt;/code&gt;å…³é”®å­—ï¼‰ï¼Œä½†Javaçš„å•ç»§æ‰¿è§„åˆ™åŒæ ·é€‚ç”¨ï¼Œå› æ­¤åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æ¥å£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å¯ä»¥å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ï¼ˆä½¿ç”¨ &lt;code&gt;implements&lt;/code&gt;å…³é”®å­—ï¼‰ï¼Œä»è€Œå®ç°â€œå¤šé‡ç»§æ‰¿â€çš„æ•ˆæœã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯­æ³•ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨å®šä¹‰æœ¬åœ°ç±»æ—¶ï¼Œç±»å£°æ˜ä¸­åŒæ—¶ä½¿ç”¨ &lt;code&gt;extends&lt;/code&gt;å’Œ &lt;code&gt;implements&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½œç”¨åŸŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»§æ‰¿å’Œå®ç°çš„èƒ½åŠ›ä»…é™äºè¯¥æœ¬åœ°ç±»å†…éƒ¨ä½¿ç”¨ï¼Œå—é™äºå…¶æ‰€åœ¨çš„ä»£ç å—ï¼ˆå¦‚æ–¹æ³•ä½“ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-è¯­æ³•ä¸ä»£ç ç¤ºä¾‹"&gt;ğŸ“ è¯­æ³•ä¸ä»£ç ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;æœ¬åœ°ç±»ç»§æ‰¿æˆ–å®ç°çš„è¯­æ³•ï¼Œä¸å¸¸è§„çš„ç±»å®šä¹‰åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯ä½ç½®ç‰¹æ®Šã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨æ–¹æ³•ä¸­å®šä¹‰çš„æœ¬åœ°ç±»ç¤ºä¾‹ï¼Œå®ƒåŒæ—¶ç»§æ‰¿äº†ä¸€ä¸ªç±»å¹¶å®ç°äº†ä¸€ä¸ªæ¥å£ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ä¸€ä¸ªè¢«ç»§æ‰¿çš„åŸºç±»
class Animal {
public void eat() {
System.out.println(&amp;#34;Animal is eating.&amp;#34;);
}
}
// ä¸€ä¸ªæ¥å£
interface Runnable {
void run();
}
public class OuterClass {
public void someMethod() {
// æ–¹æ³•å†…çš„æœ¬åœ°ç±»
class Dog extends Animal implements Runnable {
@Override
public void run() {
System.out.println(&amp;#34;Dog is running.&amp;#34;);
}
}
// åœ¨æ–¹æ³•å†…ä½¿ç”¨è¿™ä¸ªæœ¬åœ°ç±»
Dog myDog = new Dog();
myDog.eat(); // ç»§æ‰¿è‡ªAnimalç±»çš„æ–¹æ³•
myDog.run(); // å®ç°è‡ªRunnableæ¥å£çš„æ–¹æ³•
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-é‡è¦è§„åˆ™ä¸é™åˆ¶"&gt;âš ï¸ é‡è¦è§„åˆ™ä¸é™åˆ¶
&lt;/h3&gt;&lt;p&gt;åœ¨ä½¿ç”¨æœ¬åœ°ç±»æ—¶ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¿é—®å±€éƒ¨å˜é‡&lt;/strong&gt;ï¼šæœ¬åœ°ç±»ï¼ˆåŒ…æ‹¬åŒ¿åç±»ï¼‰åªèƒ½è®¿é—®å…¶æ‰€åœ¨ä½œç”¨åŸŸä¸­å£°æ˜ä¸º &lt;code&gt;final&lt;/code&gt;æˆ– &lt;strong&gt;effectively final&lt;/strong&gt;ï¼ˆå³åˆå§‹åŒ–åå€¼ä»æœªæ”¹å˜çš„å˜é‡ï¼‰çš„å±€éƒ¨å˜é‡æˆ–å‚æ•°ã€‚è¿™æ˜¯å› ä¸ºæœ¬åœ°ç±»å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸå¯èƒ½æ¯”åˆ›å»ºå®ƒçš„æ–¹æ³•æ›´é•¿ï¼Œä¸ºäº†ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼ŒJavaé€šè¿‡å¤åˆ¶è¿™äº›å˜é‡çš„å€¼æ¥å®ç°è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™æ€æˆå‘˜&lt;/strong&gt;ï¼šæœ¬åœ°ç±»å†…éƒ¨ä¸èƒ½å£°æ˜é™æ€æ–¹æ³•æˆ–éå¸¸é‡çš„é™æ€å­—æ®µã€‚å”¯ä¸€çš„ä¾‹å¤–æ˜¯å¯ä»¥å£°æ˜é™æ€å¸¸é‡ï¼ˆå³ &lt;code&gt;static final&lt;/code&gt;ä¸”ä½¿ç”¨ç¼–è¯‘æ—¶å¸¸é‡å€¼åˆå§‹åŒ–çš„å­—æ®µï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£å®šä¹‰&lt;/strong&gt;ï¼šä½ ä¸èƒ½åœ¨æ–¹æ³•ä½“ç­‰ä»£ç å—å†…å®šä¹‰æ¥å£ï¼Œå› ä¸ºæ¥å£æœ¬è´¨ä¸Šæ˜¯é™æ€çš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯"&gt;ğŸ’¡ åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;æœ¬åœ°ç±»çš„è¿™ç§èƒ½åŠ›ä½¿å…¶ç‰¹åˆ«é€‚åˆåœ¨ä»¥ä¸‹åœºæ™¯ä¸­ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç­–ç•¥æ¨¡å¼çš„å…·ä½“å®ç°&lt;/strong&gt;ï¼šå½“æŸä¸ªç®—æ³•æˆ–ç­–ç•¥åªåœ¨ä¸€ä¸ªæ–¹æ³•å†…éƒ¨éœ€è¦ä½¿ç”¨ï¼Œå¹¶ä¸”éœ€è¦ç‰¹å®šçš„ç±»ç»“æ„ï¼ˆç»§æ‰¿æŸä¸ªåŸºç±»æˆ–å®ç°æŸä¸ªæ¥å£ï¼‰æ—¶ï¼Œä½¿ç”¨æœ¬åœ°ç±»å¯ä»¥å¾ˆå¥½åœ°å°è£…è¯¥å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹ä»¶ç›‘å¬å™¨&lt;/strong&gt;ï¼šåœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰ç¼–ç¨‹ä¸­ï¼Œä¼ ç»Ÿä¸Šä¼šä½¿ç”¨æœ¬åœ°ç±»ï¼ˆæˆ–åŒ¿åç±»ï¼‰æ¥åˆ›å»ºç‰¹å®šäºæŸä¸ªç»„ä»¶çš„äº‹ä»¶å¤„ç†å™¨ï¼Œè¿™äº›å¤„ç†å™¨é€šå¸¸éœ€è¦å®ç°ç‰¹å®šçš„ç›‘å¬æ¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸åŒ¿åç±»çš„ç®€å•å¯¹æ¯”"&gt;ğŸ”„ ä¸åŒ¿åç±»çš„ç®€å•å¯¹æ¯”
&lt;/h3&gt;&lt;p&gt;æœ¬åœ°ç±»å’ŒåŒ¿åç±»éƒ½å¯ä»¥ç»§æ‰¿ç±»æˆ–å®ç°æ¥å£ã€‚ä¸»è¦åŒºåˆ«åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°ç±»&lt;/strong&gt;ï¼šæœ‰æ˜ç¡®çš„ç±»åï¼Œå¯è¯»æ€§æ›´å¥½ï¼Œå¯ä»¥é‡è½½å¤šä¸ªæ„é€ æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒ¿åç±»&lt;/strong&gt;ï¼šæ²¡æœ‰ç±»åï¼Œè¯­æ³•æ›´ç´§å‡‘ï¼Œé€šå¸¸ç”¨äºåªéœ€åˆ›å»ºä¸€æ¬¡å®ä¾‹çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šå’Œç¤ºä¾‹èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨æœ¬åœ°ç±»ï¼å¦‚æœä½ è¿˜æœ‰å…¶ä»–å…³äºJavaå†…éƒ¨ç±»çš„é—®é¢˜ï¼Œæˆ‘å¾ˆä¹æ„ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;</description></item><item><title>ã€NowCoderã€‘JAVA</title><link>https://dyhes.github.io/p/nowcoderjava/</link><pubDate>Mon, 08 Sep 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/nowcoderjava/</guid><description>&lt;h2 id="try-catch-finally"&gt;try-catch-finally
&lt;/h2&gt;&lt;p&gt;ä½ æåˆ°çš„è¯´æ³• &amp;ldquo;Java ä¸­å¼‚å¸¸å¯ä»¥æœ‰å¤šä¸ª catch ä»£ç å—ï¼Œä¹Ÿå¯ä»¥åªæœ‰ä¸€ä¸ªï¼Œä½†ä¸èƒ½æ²¡æœ‰&amp;rdquo; æ˜¯&lt;strong&gt;é”™è¯¯&lt;/strong&gt;çš„ã€‚è¿™æ˜¯å› ä¸ºåœ¨ Java çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸­ï¼Œ&lt;code&gt;try&lt;/code&gt;å—åé¢ä¸å¼ºåˆ¶è¦æ±‚å¿…é¡»æœ‰ &lt;code&gt;catch&lt;/code&gt;å—ï¼Œä½†å¿…é¡»è‡³å°‘æœ‰ &lt;strong&gt;&lt;code&gt;catch&lt;/code&gt;å—&lt;/strong&gt;æˆ– &lt;strong&gt;&lt;code&gt;finally&lt;/code&gt;å—&lt;/strong&gt;ä¸­çš„ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº† &lt;code&gt;try-catch-finally&lt;/code&gt;è¯­å¥çš„å„ç§åˆæ³•ç»„åˆæ–¹å¼ï¼Œå¸®åŠ©ä½ æ›´æ¸…æ¥šåœ°ç†è§£ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç»„åˆæ–¹å¼&lt;/th&gt;
&lt;th&gt;è¯­æ³•ç»“æ„&lt;/th&gt;
&lt;th&gt;æ˜¯å¦åˆæ³•&lt;/th&gt;
&lt;th&gt;è¡Œä¸ºè¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;try - catch&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;try {...} catch (Exception e) {...}&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;æ•è·å¹¶å¤„ç†ç‰¹å®šå¼‚å¸¸ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;try - multiple catch&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;try {...} catch (E1 e) {...} catch (E2 e) {...}&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;æŒ‰é¡ºåºæ•è·å¹¶å¤„ç†å¤šç§ä¸åŒç±»å‹çš„å¼‚å¸¸ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;try - finally&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;try {...} finally {...}&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸æ•è·å¼‚å¸¸&lt;/strong&gt;ï¼Œä½†æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼Œ&lt;code&gt;finally&lt;/code&gt;ä¸­çš„ä»£ç éƒ½ä¼šæ‰§è¡Œã€‚å¼‚å¸¸ä¼šç»§ç»­å‘ä¸Šä¼ æ’­ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;try - catch - finally&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;try {...} catch (E e) {...} finally {...}&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;æ•è·å¤„ç†å¼‚å¸¸ï¼Œå¹¶ä¸”æœ€ç»ˆæ‰§è¡Œæ¸…ç†å·¥ä½œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å…³é”®è®°å¿†ç‚¹"&gt;ğŸ’¡ å…³é”®è®°å¿†ç‚¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;try&lt;/code&gt;å—å¿…é¡»å­˜åœ¨&lt;/strong&gt;ï¼šå®ƒæ˜¯å¼‚å¸¸å¤„ç†é€»è¾‘çš„èµ·ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;catch&lt;/code&gt;å’Œ &lt;code&gt;finally&lt;/code&gt;è‡³å°‘æœ‰ä¸€ä¸ª&lt;/strong&gt;ï¼š&lt;code&gt;try&lt;/code&gt;å—ä¸èƒ½å•ç‹¬å­˜åœ¨ï¼Œå®ƒåé¢å¿…é¡»è·Ÿéšè‡³å°‘ä¸€ä¸ª &lt;code&gt;catch&lt;/code&gt;å—æˆ–ä¸€ä¸ª &lt;code&gt;finally&lt;/code&gt;å—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åªæœ‰ &lt;code&gt;try-finally&lt;/code&gt;æ˜¯å…è®¸çš„&lt;/strong&gt;ï¼šè¿™ç§ç»“æ„ç”¨äº&lt;strong&gt;ç¡®ä¿èµ„æºè¢«æ¸…ç†&lt;/strong&gt;ï¼ŒåŒæ—¶è®©å¼‚å¸¸&lt;strong&gt;ç»§ç»­å‘ä¸ŠæŠ›å‡º&lt;/strong&gt;ï¼Œç”±è°ƒç”¨è€…æ¥å¤„ç†ã€‚è¿™æ˜¯ä¸€ç§å¸¸è§çš„æ¨¡å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä»£ç ç¤ºä¾‹"&gt;ğŸ› ï¸ ä»£ç ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªåªæœ‰ &lt;code&gt;try-finally&lt;/code&gt;è€Œæ²¡æœ‰ &lt;code&gt;catch&lt;/code&gt;å—çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public void readFile() throws IOException { // å£°æ˜å°†å¼‚å¸¸æŠ›ç»™è°ƒç”¨è€…å¤„ç†
FileReader reader = null;
try {
reader = new FileReader(&amp;#34;example.txt&amp;#34;);
// ... è¯»å–æ–‡ä»¶çš„æ“ä½œ
} finally { // æ— è®ºæ˜¯å¦å‘ç”ŸIOExceptionï¼Œfinallyå—éƒ½ä¼šæ‰§è¡Œ
if (reader != null) {
reader.close(); // ç¡®ä¿èµ„æºè¢«é‡Šæ”¾
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœ &lt;code&gt;try&lt;/code&gt;å—ä¸­çš„ä»£ç ï¼ˆå¦‚ &lt;code&gt;new FileReader&lt;/code&gt;æˆ–è¯»æ“ä½œï¼‰æŠ›å‡ºäº† &lt;code&gt;IOException&lt;/code&gt;ï¼Œ&lt;strong&gt;å¼‚å¸¸å¹¶ä¸ä¼šåœ¨å½“å‰æ–¹æ³•ä¸­è¢«æ•è·&lt;/strong&gt;ï¼Œè€Œæ˜¯ä¼šé¦–å…ˆæ‰§è¡Œ &lt;code&gt;finally&lt;/code&gt;å—ä¸­çš„ä»£ç æ¥å…³é—­æ–‡ä»¶æµï¼Œç„¶åå°†è¿™ä¸ª &lt;code&gt;IOException&lt;/code&gt;&lt;strong&gt;ç»§ç»­å‘ä¸ŠæŠ›å‡º&lt;/strong&gt;ç»™è°ƒç”¨æ­¤æ–¹æ³•çš„ä»£ç å»å¤„ç†ã€‚&lt;/p&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;è™½ç„¶ &lt;code&gt;try-finally&lt;/code&gt;ç»“æ„æ˜¯åˆæ³•çš„ï¼Œä½†åœ¨å®è·µä¸­éœ€è¦æ³¨æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºç®¡ç†&lt;/strong&gt;ï¼šå¯¹äºå®ç°äº† &lt;code&gt;AutoCloseable&lt;/code&gt;æ¥å£çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶æµã€æ•°æ®åº“è¿æ¥ï¼‰ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ &lt;strong&gt;try-with-resources&lt;/strong&gt; è¯­å¥ï¼Œå®ƒå¯ä»¥æ›´ç®€æ´ã€å®‰å…¨åœ°è‡ªåŠ¨å¤„ç†èµ„æºå…³é—­ï¼Œå‡å°‘ä»£ç é‡å¹¶é¿å…æ½œåœ¨é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…æ™°çš„å¼‚å¸¸ä¼ æ’­&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;try-finally&lt;/code&gt;è€Œé &lt;code&gt;try-catch-finally&lt;/code&gt;æ—¶ï¼Œæ„å‘³ç€ä½ å¸Œæœ›å½“å‰æ–¹æ³•çš„è°ƒç”¨è€…æ¥åº”å¯¹å¯èƒ½å‡ºç°çš„å¼‚å¸¸ï¼Œè¿™æœ‰åŠ©äºåœ¨ä»£ç çš„ä¸åŒå±‚çº§é—´æ¸…æ™°åœ°åˆ’åˆ†å¼‚å¸¸å¤„ç†èŒè´£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›ä»¥ä¸Šçš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Java çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h2 id="transient"&gt;transient
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;transient&lt;/code&gt;æ˜¯ Java ä¸­ä¸€ä¸ªç”¨äºä¿®é¥°æˆå‘˜å˜é‡çš„å…³é”®å­—ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯&lt;strong&gt;åœ¨å¯¹è±¡åºåˆ—åŒ–æ—¶æ ‡è®°è¯¥å˜é‡ä¸è¢«åºåˆ—åŒ–&lt;/strong&gt;ã€‚ä¸‹é¢æˆ‘æ¥è¯¦ç»†è§£é‡Šå®ƒçš„ç”¨æ³•å’Œæ³¨æ„äº‹é¡¹ã€‚&lt;/p&gt;
&lt;h3 id="-1-æ ¸å¿ƒä½œç”¨ä¸ç‰¹æ€§"&gt;ğŸ–‹ï¸ 1. æ ¸å¿ƒä½œç”¨ä¸ç‰¹æ€§
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åºåˆ—åŒ–å¿½ç•¥&lt;/strong&gt;ï¼šè¢« &lt;code&gt;transient&lt;/code&gt;ä¿®é¥°çš„æˆå‘˜å˜é‡å°†åœ¨å¯¹è±¡åºåˆ—åŒ–æ—¶è¢«æ’é™¤ã€‚åºåˆ—åŒ–åçš„å­—èŠ‚æµä¸­ä¸åŒ…å«è¯¥å­—æ®µçš„å€¼ï¼Œååºåˆ—åŒ–æ—¶ï¼Œè¿™äº›å­—æ®µä¼šè¢«åˆå§‹åŒ–ä¸ºå…¶ç±»å‹çš„é»˜è®¤å€¼ï¼ˆå¦‚ &lt;code&gt;int&lt;/code&gt;ä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œå¼•ç”¨ç±»å‹ä¸º &lt;code&gt;null&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»…é™æˆå‘˜å˜é‡&lt;/strong&gt;ï¼š&lt;code&gt;transient&lt;/code&gt;åªèƒ½ä¿®é¥°ç±»çš„æˆå‘˜å˜é‡ï¼ˆå­—æ®µï¼‰ï¼Œ&lt;strong&gt;ä¸èƒ½&lt;/strong&gt;ç”¨æ¥ä¿®é¥°æ–¹æ³•ã€ç±»æˆ–å±€éƒ¨å˜é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ &lt;code&gt;static&lt;/code&gt;çš„å…³ç³»&lt;/strong&gt;ï¼š&lt;code&gt;static&lt;/code&gt;å˜é‡å±äºç±»è€Œéå¯¹è±¡æœ¬èº«ã€‚&lt;strong&gt;åºåˆ—åŒ–é’ˆå¯¹çš„æ˜¯å¯¹è±¡å®ä¾‹çš„çŠ¶æ€&lt;/strong&gt;ï¼Œå› æ­¤&lt;strong&gt;é™æ€å˜é‡æ— è®ºæ˜¯å¦è¢« &lt;code&gt;transient&lt;/code&gt;ä¿®é¥°ï¼Œéƒ½ä¸ä¼šè¢«åºåˆ—åŒ–&lt;/strong&gt;ã€‚åºåˆ—åŒ–ä¿å­˜çš„æ˜¯å¯¹è±¡çŠ¶æ€ï¼Œé™æ€å˜é‡ä¿å­˜çš„æ˜¯ç±»çŠ¶æ€ï¼Œå› æ­¤åºåˆ—åŒ–å¹¶ä¸ä¿å­˜é™æ€å˜é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ èƒ½å¿«é€ŸæŠŠæ¡æ ¸å¿ƒä¿¡æ¯ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ€»ç»“ &lt;code&gt;transient&lt;/code&gt;å…³é”®å­—çš„ä¸»è¦ç‰¹æ€§ã€ä½¿ç”¨åœºæ™¯å’Œè¦ç‚¹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§/åœºæ™¯&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹æˆ–æ³¨æ„äº‹é¡¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åºåˆ—åŒ–è¡Œä¸º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¢«ä¿®é¥°çš„å˜é‡ä¸ä¼šè¢«åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–æ—¶è¢«è®¾ç½®ä¸ºé»˜è®¤å€¼&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int&lt;/code&gt;â†’ &lt;code&gt;0&lt;/code&gt;, &lt;code&gt;boolean&lt;/code&gt;â†’ &lt;code&gt;false&lt;/code&gt;, å¼•ç”¨ç±»å‹ â†’ &lt;code&gt;null&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨å¯¹è±¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åªèƒ½ä¿®é¥°&lt;strong&gt;æˆå‘˜å˜é‡&lt;/strong&gt;ï¼ˆå­—æ®µï¼‰&lt;/td&gt;
&lt;td&gt;ä¸èƒ½ä¿®é¥°æ–¹æ³•ã€ç±»ã€å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸ &lt;code&gt;static&lt;/code&gt;çš„å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;static&lt;/code&gt;å˜é‡æœ¬èº«å°±ä¸ä¼šè¢«åºåˆ—åŒ–ï¼Œç”¨ &lt;code&gt;transient&lt;/code&gt;ä¿®é¥°æ— æ„ä¹‰&lt;/td&gt;
&lt;td&gt;åºåˆ—åŒ–ä¿å­˜å¯¹è±¡çŠ¶æ€ï¼Œé™æ€å˜é‡ä¿å­˜ç±»çŠ¶æ€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•æ„Ÿä¿¡æ¯ä¿æŠ¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é˜²æ­¢å¯†ç ã€å¯†é’¥ç­‰æ•æ„Ÿæ•°æ®è¢«æŒä¹…åŒ–æˆ–ä¼ è¾“&lt;/td&gt;
&lt;td&gt;&lt;code&gt;private transient String password;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼˜åŒ–æ€§èƒ½/å­˜å‚¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ’é™¤ä¸éœ€è¦æŒä¹…åŒ–çš„å¤§å¯¹è±¡ã€ä¸´æ—¶æ•°æ®æˆ–ç¼“å­˜å­—æ®µ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;private transient byte[] temporaryBuffer;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–ç¯å¢ƒçš„èµ„æº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸åºåˆ—åŒ–æ— æ³•æˆ–æ— éœ€é‡å»ºçš„èµ„æºï¼Œå¦‚æ–‡ä»¶å¥æŸ„ã€çº¿ç¨‹ã€æ•°æ®åº“è¿æ¥&lt;/td&gt;
&lt;td&gt;&lt;code&gt;private transient Thread workerThread;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ´¾ç”Ÿå­—æ®µ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­—æ®µå€¼å¯ç”±å…¶ä»–å­—æ®µè®¡ç®—å¾—å‡ºï¼Œæ— éœ€åºåˆ—åŒ–ä»¥èŠ‚çœç©ºé—´&lt;/td&gt;
&lt;td&gt;é•¿æ–¹å½¢é¢ç§¯ &lt;code&gt;area&lt;/code&gt;å¯ç”± &lt;code&gt;length&lt;/code&gt;å’Œ &lt;code&gt;width&lt;/code&gt;è®¡ç®—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªå®šä¹‰åºåˆ—åŒ–é€»è¾‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡é‡å†™ &lt;code&gt;writeObject&lt;/code&gt;å’Œ &lt;code&gt;readObject&lt;/code&gt;æ–¹æ³•å¯æ§åˆ¶ &lt;code&gt;transient&lt;/code&gt;å­—æ®µçš„åºåˆ—åŒ–&lt;/td&gt;
&lt;td&gt;å¯å¯¹ &lt;code&gt;transient&lt;/code&gt;å­—æ®µè¿›è¡ŒåŠ å¯†ååºåˆ—åŒ–ï¼Œååºåˆ—åŒ–æ—¶è§£å¯†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-2-å…¸å‹ä½¿ç”¨åœºæ™¯"&gt;ğŸ› ï¸ 2. å…¸å‹ä½¿ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;transient&lt;/code&gt;å…³é”®å­—åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸­éå¸¸æœ‰ç”¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¿æŠ¤æ•æ„Ÿä¿¡æ¯&lt;/strong&gt;ï¼šå¦‚ç”¨æˆ·çš„å¯†ç ï¼ˆ&lt;code&gt;password&lt;/code&gt;ï¼‰ã€é“¶è¡Œå¡å·ç­‰æ•æ„Ÿå­—æ®µï¼Œä¸å¸Œæœ›å®ƒä»¬é€šè¿‡åºåˆ—åŒ–è¢«æŒä¹…åŒ–åˆ°ç£ç›˜æˆ–åœ¨ç½‘ç»œä¼ è¾“ä¸­æ³„éœ²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ€§èƒ½å’Œå­˜å‚¨ç©ºé—´&lt;/strong&gt;ï¼šå¯¹äºä¸€äº›ä¸éœ€è¦æŒä¹…åŒ–çš„å¤§å¯¹è±¡ã€ä¸´æ—¶å˜é‡æˆ–ç¼“å­˜æ•°æ®ï¼Œä½¿ç”¨ &lt;code&gt;transient&lt;/code&gt;å¯ä»¥å‡å°‘åºåˆ—åŒ–åçš„æ•°æ®å¤§å°ï¼Œæé«˜åºåˆ—åŒ–/ååºåˆ—åŒ–çš„æ•ˆç‡ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç†æ— æ³•åºåˆ—åŒ–æˆ–ä¾èµ–è¿è¡Œæ—¶ç¯å¢ƒçš„èµ„æº&lt;/strong&gt;ï¼šå¦‚æ–‡ä»¶å¥æŸ„ï¼ˆ&lt;code&gt;FileInputStream&lt;/code&gt;ï¼‰ã€æ•°æ®åº“è¿æ¥ã€çº¿ç¨‹ï¼ˆ&lt;code&gt;Thread&lt;/code&gt;ï¼‰å¯¹è±¡ç­‰ã€‚è¿™äº›èµ„æºçš„çŠ¶æ€æ˜¯ç‰¹å®šäºå½“å‰JVMè¿è¡Œç¯å¢ƒçš„ï¼Œåºåˆ—åŒ–å®ƒä»¬æ²¡æœ‰æ„ä¹‰ï¼Œå¹¶ä¸”åœ¨ååºåˆ—åŒ–åä¹Ÿæ— æ³•æœ‰æ•ˆé‡å»ºã€‚å°†å…¶æ ‡è®°ä¸º &lt;code&gt;transient&lt;/code&gt;å¯ä»¥é¿å…åºåˆ—åŒ–æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…åºåˆ—åŒ–å¯ç”±å…¶ä»–å­—æ®µæ¨å¯¼å‡ºçš„æ•°æ®&lt;/strong&gt;ï¼šä¾‹å¦‚ï¼Œä¸€ä¸ªé•¿æ–¹å½¢ç±»å¯èƒ½æœ‰é•¿åº¦ï¼ˆ&lt;code&gt;length&lt;/code&gt;ï¼‰ã€å®½åº¦ï¼ˆ&lt;code&gt;width&lt;/code&gt;ï¼‰å’Œé¢ç§¯ï¼ˆ&lt;code&gt;area&lt;/code&gt;ï¼‰å±æ€§ï¼Œé¢ç§¯å¯ä»¥é€šè¿‡é•¿åº¦å’Œå®½åº¦è®¡ç®—å¾—å‡ºï¼Œå› æ­¤ä¸éœ€è¦åºåˆ—åŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-3-é‡è¦æ³¨æ„äº‹é¡¹"&gt;âš ï¸ 3. é‡è¦æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ååºåˆ—åŒ–åçš„é»˜è®¤å€¼&lt;/strong&gt;ï¼šè¢« &lt;code&gt;transient&lt;/code&gt;ä¿®é¥°çš„å˜é‡åœ¨ååºåˆ—åŒ–åä¼šè¢«è®¾ç½®ä¸ºå…¶æ•°æ®ç±»å‹çš„é»˜è®¤å€¼ã€‚å¦‚æœè¿™äº›å­—æ®µåœ¨ä¸šåŠ¡é€»è¾‘ä¸­å¾ˆé‡è¦ï¼Œä½ éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆå¦‚åœ¨ &lt;code&gt;readObject&lt;/code&gt;æ–¹æ³•ä¸­æ‰‹åŠ¨åˆå§‹åŒ–æˆ–ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°ï¼‰æ¥ç¡®ä¿å®ƒä»¬è¢«æ­£ç¡®åˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå®šä¹‰åºåˆ—åŒ–&lt;/strong&gt;ï¼šå¦‚æœéœ€è¦å¯¹ &lt;code&gt;transient&lt;/code&gt;å­—æ®µè¿›è¡Œç‰¹æ®Šçš„åºåˆ—åŒ–å¤„ç†ï¼ˆä¾‹å¦‚åŠ å¯†åå†åºåˆ—åŒ–ï¼Œæˆ–å¸Œæœ›ä»¥æŸç§æ–¹å¼ä¿å­˜å’Œæ¢å¤å…¶çŠ¶æ€ï¼‰ï¼Œå¯ä»¥åœ¨å®ç°äº† &lt;code&gt;Serializable&lt;/code&gt;æ¥å£çš„ç±»ä¸­é‡å†™ &lt;code&gt;writeObject&lt;/code&gt;å’Œ &lt;code&gt;readObject&lt;/code&gt;æ–¹æ³•ï¼Œåœ¨å…¶ä¸­å®šä¹‰è‡ªå®šä¹‰çš„é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬å…¼å®¹æ€§&lt;/strong&gt;ï¼šä¿®æ”¹ç±»çš„ &lt;code&gt;transient&lt;/code&gt;å­—æ®µï¼ˆå¦‚æ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹ï¼‰å¯èƒ½ä¼šå½±å“ååºåˆ—åŒ–çš„ç‰ˆæœ¬å…¼å®¹æ€§ã€‚é€šå¸¸å»ºè®®ä½¿ç”¨ &lt;code&gt;serialVersionUID&lt;/code&gt;æ¥æ˜¾å¼å£°æ˜åºåˆ—åŒ–ç‰ˆæœ¬ï¼Œä»¥æ§åˆ¶å…¼å®¹æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-4-ä»£ç ç¤ºä¾‹"&gt;ğŸ“„ 4. ä»£ç ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº† &lt;code&gt;transient&lt;/code&gt;çš„åŸºæœ¬ç”¨æ³•ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import java.io.*;
class User implements Serializable {
private static final long serialVersionUID = 1L;
private String username;
private transient String password; // ä½¿ç”¨ transient ä¿®é¥°ï¼Œä¸å‚ä¸åºåˆ—åŒ–
public User(String username, String password) {
this.username = username;
this.password = password;
}
@Override
public String toString() {
return &amp;#34;User{&amp;#34; + &amp;#34;username=&amp;#39;&amp;#34; + username + &amp;#39;\&amp;#39;&amp;#39; + &amp;#34;, password=&amp;#39;&amp;#34; + password + &amp;#39;\&amp;#39;&amp;#39; + &amp;#39;}&amp;#39;;
}
}
public class TransientExample {
public static void main(String[] args) throws Exception {
User originalUser = new User(&amp;#34;Alice&amp;#34;, &amp;#34;secret123&amp;#34;);
// åºåˆ—åŒ–å¯¹è±¡åˆ°æ–‡ä»¶
ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&amp;#34;user.ser&amp;#34;));
oos.writeObject(originalUser);
oos.close();
// ä»æ–‡ä»¶ååºåˆ—åŒ–å¯¹è±¡
ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&amp;#34;user.ser&amp;#34;));
User deserializedUser = (User) ois.readObject();
ois.close();
System.out.println(&amp;#34;Original: &amp;#34; + originalUser);
System.out.println(&amp;#34;After Deserialization: &amp;#34; + deserializedUser);
// è¾“å‡ºå°†æ˜¾ç¤º deserializedUser çš„ password ä¸º null
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;transient&lt;/code&gt;å…³é”®å­—æ˜¯ Java åºåˆ—åŒ–æœºåˆ¶ä¸­çš„ä¸€ä¸ªé‡è¦å·¥å…·ï¼Œä¸»è¦ç”¨äºåœ¨å¯¹è±¡åºåˆ—åŒ–æ—¶&lt;strong&gt;æœ‰é€‰æ‹©åœ°æ’é™¤ä¸éœ€è¦æŒä¹…åŒ–æˆ–ä¼ è¾“çš„å­—æ®µ&lt;/strong&gt;ã€‚æ­£ç¡®ä½¿ç”¨å®ƒå¯ä»¥&lt;strong&gt;æå‡å®‰å…¨æ€§ã€ä¼˜åŒ–æ€§èƒ½å¹¶é¿å…ä¸å¿…è¦çš„åºåˆ—åŒ–é—®é¢˜&lt;/strong&gt;ã€‚ä½¿ç”¨æ—¶åªéœ€è®°ä½å®ƒ&lt;strong&gt;ä»…ç”¨äºä¿®é¥°æˆå‘˜å˜é‡&lt;/strong&gt;ï¼Œä¸”ä¸ &lt;code&gt;static&lt;/code&gt;å˜é‡æ— å…³ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ &lt;code&gt;transient&lt;/code&gt;å…³é”®å­—ã€‚&lt;/p&gt;
&lt;h2 id="åŒæ­¥å™¨"&gt;åŒæ­¥å™¨
&lt;/h2&gt;&lt;p&gt;JDK æä¾›çš„å¹¶å‘åŒæ­¥å™¨ä¸»è¦åŒ…æ‹¬ &lt;strong&gt;Semaphoreï¼ˆä¿¡å·é‡ï¼‰&lt;/strong&gt;ã€&lt;strong&gt;CyclicBarrierï¼ˆå¾ªç¯æ …æ ï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;CountDownLatchï¼ˆå€’è®¡æ—¶å™¨ï¼‰&lt;/strong&gt;ã€‚å®ƒä»¬éƒ½æ˜¯ &lt;code&gt;java.util.concurrent&lt;/code&gt;åŒ…ä¸‹çš„é‡è¦å·¥å…·ï¼Œç”¨äºåè°ƒå¤šçº¿ç¨‹é—´çš„åŒæ­¥ã€‚ä¸‹é¢æˆ‘ç”¨ä¸€ä¸ªè¡¨æ ¼å…ˆå¿«é€Ÿå¯¹æ¯”å®ƒä»¬çš„æ ¸å¿ƒç‰¹æ€§ï¼Œç„¶åå†é€ä¸€è¯¦è§£ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;Semaphore (ä¿¡å·é‡)&lt;/th&gt;
&lt;th&gt;CountDownLatch (å€’è®¡æ—¶å™¨)&lt;/th&gt;
&lt;th&gt;CyclicBarrier (å¾ªç¯æ …æ )&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ§åˆ¶&lt;strong&gt;åŒæ—¶è®¿é—®ç‰¹å®šèµ„æºçš„çº¿ç¨‹æ•°é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®©ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹&lt;strong&gt;ç­‰å¾…&lt;/strong&gt;å…¶ä»–çº¿ç¨‹å®Œæˆæ“ä½œ&lt;/td&gt;
&lt;td&gt;è®©ä¸€ç»„çº¿ç¨‹&lt;strong&gt;ç›¸äº’ç­‰å¾…&lt;/strong&gt;ï¼Œåˆ°è¾¾ä¸€ä¸ªå…¬å…±å±éšœç‚¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯é‡å¤ä½¿ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;å¦ (è®¡æ•°ä¸º0åå¤±æ•ˆ)&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæ„é€ æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;new Semaphore(int permits)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;new CountDownLatch(int count)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;new CyclicBarrier(int parties)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;acquire()&lt;/code&gt;, &lt;code&gt;release()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;await()&lt;/code&gt;, &lt;code&gt;countDown()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;await()&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäºAQS (AbstractQueuedSynchronizer)&lt;/td&gt;
&lt;td&gt;åŸºäºAQS&lt;/td&gt;
&lt;td&gt;åŸºäºReentrantLockå’ŒCondition&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¸¸è§åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“è¿æ¥æ± ï¼Œé™æµ&lt;/td&gt;
&lt;td&gt;ä¸»çº¿ç¨‹ç­‰å¾…å¤šä¸ªå­çº¿ç¨‹å®Œæˆä»»åŠ¡åå†ç»§ç»­&lt;/td&gt;
&lt;td&gt;å¤šçº¿ç¨‹è®¡ç®—æ•°æ®ï¼Œæœ€ååˆå¹¶ç»“æœ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸‹é¢æ˜¯è¿™ä¸‰ç§åŒæ­¥å™¨çš„è¯¦ç»†ä»‹ç»ã€åŸç†å’Œç”¨æ³•ã€‚&lt;/p&gt;
&lt;h3 id="-1-semaphore-ä¿¡å·é‡"&gt;ğŸ“Š 1. Semaphore (ä¿¡å·é‡)
&lt;/h3&gt;&lt;p&gt;Semaphore æ˜¯ä¸€ç§ç”¨äºæ§åˆ¶åŒæ—¶è®¿é—®ç‰¹å®šèµ„æºçš„çº¿ç¨‹æ•°é‡çš„åŒæ­¥å™¨ï¼Œå®ƒé€šè¿‡ç»´æŠ¤ä¸€ç»„**è®¸å¯è¯ï¼ˆpermitsï¼‰**æ¥å®ç°ã€‚&lt;/p&gt;
&lt;h4 id="æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§"&gt;æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼šSemaphore å†…éƒ¨æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼ˆè®¸å¯è¯æ•°é‡ï¼‰ã€‚çº¿ç¨‹æ‰§è¡Œ &lt;code&gt;acquire()&lt;/code&gt;æ–¹æ³•ä¼šå°è¯•è·å–ä¸€ä¸ªè®¸å¯è¯ï¼Œå¦‚æœè®¡æ•°å™¨å¤§äº0ï¼Œåˆ™è·å–æˆåŠŸå¹¶é€’å‡ï¼›å¦‚æœè®¡æ•°å™¨ä¸º0ï¼Œåˆ™çº¿ç¨‹é˜»å¡ï¼Œç›´åˆ°æœ‰å…¶ä»–çº¿ç¨‹é‡Šæ”¾è®¸å¯è¯ï¼ˆ&lt;code&gt;release()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;ï¼šSemaphore æ”¯æŒ&lt;strong&gt;å…¬å¹³æ¨¡å¼&lt;/strong&gt;å’Œ&lt;strong&gt;éå…¬å¹³æ¨¡å¼&lt;/strong&gt;ã€‚åœ¨å…¬å¹³æ¨¡å¼ä¸‹ï¼Œçº¿ç¨‹è·å–è®¸å¯è¯çš„é¡ºåºä¸å…¶è¯·æ±‚çš„é¡ºåºåŸºæœ¬ä¸€è‡´ï¼›éå…¬å¹³æ¨¡å¼åˆ™å…è®¸â€œæ’é˜Ÿâ€ï¼Œååé‡é€šå¸¸æ›´é«˜ï¼Œä½†å¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹é¥¥é¥¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é‡å¤ä½¿ç”¨&lt;/strong&gt;ï¼šè®¸å¯è¯å¯ä»¥è¢«é‡Šæ”¾å’Œé‡æ–°è·å–ï¼ŒSemaphore æœ¬èº«æ˜¯å¯é‡ç”¨çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¸¸ç”¨æ–¹æ³•"&gt;å¸¸ç”¨æ–¹æ³•
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;acquire()&lt;/code&gt;: è·å–ä¸€ä¸ªè®¸å¯è¯ï¼Œå¦‚æœæ— æ³•è·å–åˆ™é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;acquire(int permits)&lt;/code&gt;: è·å–æŒ‡å®šæ•°é‡çš„è®¸å¯è¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;release()&lt;/code&gt;: é‡Šæ”¾ä¸€ä¸ªè®¸å¯è¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;release(int permits)&lt;/code&gt;: é‡Šæ”¾æŒ‡å®šæ•°é‡çš„è®¸å¯è¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tryAcquire()&lt;/code&gt;: å°è¯•è·å–è®¸å¯è¯ï¼Œç«‹å³è¿”å›æˆåŠŸæˆ–å¤±è´¥ï¼Œä¸é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tryAcquire(long timeout, TimeUnit unit)&lt;/code&gt;: åœ¨æŒ‡å®šæ—¶é—´å†…å°è¯•è·å–è®¸å¯è¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;availablePermits()&lt;/code&gt;: è¿”å›å½“å‰å¯ç”¨çš„è®¸å¯è¯æ•°é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä»£ç ç¤ºä¾‹"&gt;ä»£ç ç¤ºä¾‹
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.concurrent.Semaphore;
public class SemaphoreExample {
// åˆ›å»ºä¸€ä¸ªæœ‰3ä¸ªè®¸å¯è¯çš„ä¿¡å·é‡ï¼ˆéå…¬å¹³æ¨¡å¼ï¼‰
private static final Semaphore semaphore = new Semaphore(3);
public static void main(String[] args) {
// æ¨¡æ‹Ÿ10ä¸ªçº¿ç¨‹å°è¯•è®¿é—®èµ„æº
for (int i = 0; i &amp;lt; 10; i++) {
new Thread(() -&amp;gt; {
try {
semaphore.acquire(); // è·å–è®¸å¯è¯
System.out.println(Thread.currentThread().getName() + &amp;#34; è·å–äº†è®¸å¯è¯ï¼Œå¼€å§‹æ‰§è¡Œ&amp;#34;);
Thread.sleep(2000); // æ¨¡æ‹Ÿä¸šåŠ¡æ“ä½œè€—æ—¶
} catch (InterruptedException e) {
e.printStackTrace();
} finally {
semaphore.release(); // é‡Šæ”¾è®¸å¯è¯
System.out.println(Thread.currentThread().getName() + &amp;#34; é‡Šæ”¾äº†è®¸å¯è¯&amp;#34;);
}
}, &amp;#34;Thread-&amp;#34; + i).start();
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ€å¤šåªå…è®¸3ä¸ªçº¿ç¨‹åŒæ—¶&amp;quot;æ‰§è¡Œ&amp;quot;ï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰å¾…æœ‰è®¸å¯è¯è¢«é‡Šæ”¾ã€‚&lt;/p&gt;
&lt;h4 id="ä¸»è¦åº”ç”¨åœºæ™¯"&gt;ä¸»è¦åº”ç”¨åœºæ™¯
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ± ç®¡ç†&lt;/strong&gt;ï¼šå¦‚æ•°æ®åº“è¿æ¥æ± ï¼Œé™åˆ¶åŒæ—¶ä½¿ç”¨çš„è¿æ¥æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™æµ&lt;/strong&gt;ï¼šæ§åˆ¶è®¿é—®æŸä¸ªæ¥å£æˆ–èµ„æºçš„å¹¶å‘çº¿ç¨‹æ•°ï¼Œé˜²æ­¢ç³»ç»Ÿè¿‡è½½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-2-countdownlatch-å€’è®¡æ—¶å™¨"&gt;ğŸ¯ 2. CountDownLatch (å€’è®¡æ—¶å™¨)
&lt;/h3&gt;&lt;p&gt;CountDownLatch æ˜¯ä¸€ç§å…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ“ä½œåå†ç»§ç»­æ‰§è¡Œçš„åŒæ­¥å·¥å…·ã€‚&lt;/p&gt;
&lt;h4 id="æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§-1"&gt;æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼šCountDownLatch é€šè¿‡ä¸€ä¸ªè®¡æ•°å™¨åˆå§‹åŒ–ã€‚çº¿ç¨‹è°ƒç”¨ &lt;code&gt;await()&lt;/code&gt;æ–¹æ³•ä¼šé˜»å¡ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨ &lt;code&gt;countDown()&lt;/code&gt;æ–¹æ³•ä½¿è®¡æ•°å™¨å‡è‡³0ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€æ¬¡æ€§&lt;/strong&gt;ï¼šCountDownLatch çš„è®¡æ•°å™¨ä¸èƒ½è¢«é‡ç½®ï¼Œä¸€æ—¦è®¡æ•°å½’é›¶ï¼Œæ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ä¼šè¢«é‡Šæ”¾ï¼Œåç»­å†è°ƒç”¨ &lt;code&gt;await()&lt;/code&gt;çš„çº¿ç¨‹ä¼šç«‹å³ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¸¸ç”¨æ–¹æ³•-1"&gt;å¸¸ç”¨æ–¹æ³•
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;await()&lt;/code&gt;: ä½¿å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°è®¡æ•°å™¨å‡åˆ°é›¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;await(long timeout, TimeUnit unit)&lt;/code&gt;: åœ¨æŒ‡å®šæ—¶é—´å†…ç­‰å¾…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;countDown()&lt;/code&gt;: å°†è®¡æ•°å™¨å‡1ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getCount()&lt;/code&gt;: è¿”å›å½“å‰è®¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä»£ç ç¤ºä¾‹-1"&gt;ä»£ç ç¤ºä¾‹
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.concurrent.CountDownLatch;
public class CountDownLatchExample {
public static void main(String[] args) throws InterruptedException {
// åˆå§‹åŒ–è®¡æ•°å™¨ä¸º5
CountDownLatch latch = new CountDownLatch(5);
for (int i = 0; i &amp;lt; 5; i++) {
new Thread(() -&amp;gt; {
System.out.println(Thread.currentThread().getName() + &amp;#34; å®Œæˆäº†ä»»åŠ¡&amp;#34;);
latch.countDown(); // è®¡æ•°å™¨å‡1
}, &amp;#34;Worker-&amp;#34; + i).start();
}
latch.await(); // ä¸»çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰å·¥ä½œçº¿ç¨‹å®Œæˆä»»åŠ¡ï¼ˆè®¡æ•°å™¨ä¸º0ï¼‰
System.out.println(&amp;#34;æ‰€æœ‰å·¥ä½œçº¿ç¨‹å‡å·²å®Œæˆä»»åŠ¡ï¼Œä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œ&amp;#34;);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä¸»è¦åº”ç”¨åœºæ™¯-1"&gt;ä¸»è¦åº”ç”¨åœºæ™¯
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»çº¿ç¨‹ç­‰å¾…å¤šä¸ªå­çº¿ç¨‹åˆå§‹åŒ–å®Œæˆ&lt;/strong&gt;åå†ç»§ç»­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œä»»åŠ¡æ‹†åˆ†&lt;/strong&gt;ï¼šå°†ä¸€ä¸ªå¤§ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼Œä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å°ä»»åŠ¡å®Œæˆåå†æ±‡æ€»ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-3-cyclicbarrier-å¾ªç¯æ …æ "&gt;ğŸ” 3. CyclicBarrier (å¾ªç¯æ …æ )
&lt;/h3&gt;&lt;p&gt;CyclicBarrier å…è®¸ä¸€ç»„çº¿ç¨‹ç›¸äº’ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾ä¸€ä¸ªå…¬å…±å±éšœç‚¹ï¼ˆbarrier pointï¼‰ï¼Œç„¶åè¿™äº›çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚CyclicBarrier æ˜¯å¯å¾ªç¯ä½¿ç”¨çš„ã€‚&lt;/p&gt;
&lt;h4 id="æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§-2"&gt;æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼šçº¿ç¨‹æ‰§è¡Œ &lt;code&gt;await()&lt;/code&gt;æ–¹æ³•è¡¨ç¤ºè‡ªå·±å·²åˆ°è¾¾å±éšœï¼Œç„¶åå½“å‰çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚å½“æ‰€æœ‰çº¿ç¨‹éƒ½è°ƒç”¨ &lt;code&gt;await()&lt;/code&gt;åï¼Œå±éšœå¼€æ”¾ï¼Œæ‰€æœ‰è¢«é˜»å¡çš„çº¿ç¨‹ä¼šåŒæ—¶è¢«å”¤é†’ç»§ç»­æ‰§è¡Œã€‚CyclicBarrier å¯ä»¥é€‰æ‹©ä¸€ä¸ª &lt;code&gt;Runnable&lt;/code&gt;ä»»åŠ¡ï¼Œåœ¨æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾å±éšœåï¼Œ&lt;strong&gt;åœ¨é‡Šæ”¾æ‰€æœ‰çº¿ç¨‹ä¹‹å‰&lt;/strong&gt;æ‰§è¡Œæ­¤ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é‡å¤ä½¿ç”¨&lt;/strong&gt;ï¼šä¸ CountDownLatch ä¸åŒï¼ŒCyclicBarrier çš„å±éšœåœ¨é‡Šæ”¾ç­‰å¾…çº¿ç¨‹åä¼šè‡ªåŠ¨é‡ç½®ï¼Œå¯ä¾›ä¸‹ä¸€æ¬¡ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;** BrokenBarrierException **ï¼šå¦‚æœç­‰å¾…çš„çº¿ç¨‹è¢«ä¸­æ–­ã€è¶…æ—¶ï¼Œæˆ–è€…å±éšœè¢«é‡ç½®ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹ä¼šæŠ›å‡º BrokenBarrierExceptionã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¸¸ç”¨æ–¹æ³•-2"&gt;å¸¸ç”¨æ–¹æ³•
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;await()&lt;/code&gt;: é€šçŸ¥å±éšœå½“å‰çº¿ç¨‹å·²åˆ°è¾¾ï¼Œå¹¶ç­‰å¾…å…¶ä»–çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;await(long timeout, TimeUnit unit)&lt;/code&gt;: åœ¨æŒ‡å®šæ—¶é—´å†…ç­‰å¾…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getNumberWaiting()&lt;/code&gt;: è¿”å›å½“å‰åœ¨å±éšœå¤„ç­‰å¾…çš„çº¿ç¨‹æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getParties()&lt;/code&gt;: è¿”å›è·¨è¶Šå±éšœæ‰€éœ€çš„çº¿ç¨‹æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;reset()&lt;/code&gt;: å°†å±éšœé‡ç½®ä¸ºåˆå§‹çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä»£ç ç¤ºä¾‹-2"&gt;ä»£ç ç¤ºä¾‹
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.concurrent.BrokenBarrierException;
import java.util.concurrent.CyclicBarrier;
public class CyclicBarrierExample {
public static void main(String[] args) {
// åˆ›å»ºä¸€ä¸ªå¾ªç¯æ …æ ï¼Œç­‰å¾…3ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çº¿ç¨‹åˆ°è¾¾å±éšœåæ‰§è¡Œä¸€ä¸ªRunnable
CyclicBarrier barrier = new CyclicBarrier(3, () -&amp;gt; {
System.out.println(&amp;#34;æ‰€æœ‰çº¿ç¨‹å‡å·²åˆ°è¾¾å±éšœï¼Œç»Ÿä¸€å¼€å§‹ä¸‹ä¸€æ­¥æ“ä½œ&amp;#34;);
});
for (int i = 0; i &amp;lt; 3; i++) {
new Thread(() -&amp;gt; {
try {
System.out.println(Thread.currentThread().getName() + &amp;#34; å·²åˆ°è¾¾å±éšœï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹&amp;#34;);
barrier.await(); // ç­‰å¾…å…¶ä»–çº¿ç¨‹
System.out.println(Thread.currentThread().getName() + &amp;#34; è¢«é‡Šæ”¾ï¼Œç»§ç»­æ‰§è¡Œ&amp;#34;);
} catch (InterruptedException | BrokenBarrierException e) {
e.printStackTrace();
}
}, &amp;#34;Thread-&amp;#34; + i).start();
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä¸»è¦åº”ç”¨åœºæ™¯-2"&gt;ä¸»è¦åº”ç”¨åœºæ™¯
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº¿ç¨‹è®¡ç®—æ•°æ®ï¼Œæœ€ååˆå¹¶ç»“æœ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡æ‹Ÿå¹¶å‘æµ‹è¯•&lt;/strong&gt;ï¼šè®©ä¸€ç»„çº¿ç¨‹åœ¨æŸä¸ªæ—¶åˆ»åŒæ—¶å¼€å§‹æ‰§è¡Œï¼Œæµ‹è¯•ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“ä¸å¦‚ä½•é€‰æ‹©"&gt;ğŸ’ æ€»ç»“ä¸å¦‚ä½•é€‰æ‹©
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åŒæ­¥å™¨&lt;/th&gt;
&lt;th&gt;å…³é”®åŒºåˆ«&lt;/th&gt;
&lt;th&gt;å…¸å‹åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Semaphore&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ§åˆ¶èµ„æºè®¿é—®çš„å¹¶å‘æ•°&lt;/strong&gt;ï¼Œå¼ºè°ƒâ€œå‡†å…¥â€è®¸å¯&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“è¿æ¥æ± ï¼Œæ¥å£é™æµ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CountDownLatch&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®ŒæˆæŸäº‹&lt;/strong&gt;ï¼Œä¸€æ¬¡æ€§ä½¿ç”¨&lt;/td&gt;
&lt;td&gt;ä¸»çº¿ç¨‹ç­‰å¾…å¤šä¸ªå¾®æœåŠ¡åˆå§‹åŒ–å®Œæˆåå†å¯åŠ¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CyclicBarrier&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸€ç»„çº¿ç¨‹ç›¸äº’ç­‰å¾…&lt;/strong&gt;ï¼Œåˆ°è¾¾å±éšœåå…±åŒç»§ç»­ï¼Œå¯å¾ªç¯ä½¿ç”¨&lt;/td&gt;
&lt;td&gt;å¤šçº¿ç¨‹åˆ†é˜¶æ®µè®¡ç®—ï¼Œæ‰€æœ‰çº¿ç¨‹å®Œæˆå½“å‰é˜¶æ®µåæ‰å…±åŒè¿›å…¥ä¸‹ä¸€é˜¶æ®µ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;é€‰æ‹©æ—¶ï¼Œå¯ä»¥è¿™æ ·è€ƒè™‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦&lt;strong&gt;é™åˆ¶åŒæ—¶è®¿é—®èµ„æºçš„çº¿ç¨‹æ•°é‡&lt;/strong&gt;æ—¶ï¼Œç”¨ &lt;strong&gt;Semaphore&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;éœ€è¦&lt;strong&gt;ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–ä¸€ç»„çº¿ç¨‹å®Œæˆæ“ä½œ&lt;/strong&gt;åï¼ˆå¦‚ä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰åˆå§‹åŒ–ä»»åŠ¡å®Œæˆï¼‰å†ç»§ç»­ï¼Œä¸”åªéœ€è¦ç­‰å¾…ä¸€æ¬¡æ—¶ï¼Œç”¨ &lt;strong&gt;CountDownLatch&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;éœ€è¦&lt;strong&gt;ä¸€ç»„çº¿ç¨‹ç›¸äº’ç­‰å¾…&lt;/strong&gt;ï¼Œåˆ°è¾¾ä¸€ä¸ªå…±åŒç‚¹åå†ä¸€èµ·ç»§ç»­æ‰§è¡Œï¼Œä¸”éœ€è¦å¤šæ¬¡é‡ç”¨è¿™ä¸ªåŒæ­¥ç‚¹æ—¶ï¼Œç”¨ &lt;strong&gt;CyclicBarrier&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨è¿™äº›å¼ºå¤§çš„å¹¶å‘åŒæ­¥å·¥å…·ã€‚&lt;/p&gt;
&lt;h2 id="abstract-class--interface"&gt;abstract class &amp;amp; interface
&lt;/h2&gt;&lt;p&gt;&amp;ldquo;abstract classè¡¨ç¤ºçš„æ˜¯&amp;rsquo;is-a&amp;rsquo;å…³ç³»ï¼Œinterfaceè¡¨ç¤ºçš„æ˜¯&amp;rsquo;has-a&amp;rsquo;å…³ç³»&amp;rdquo; è¿™å¥è¯æ¦‚æ‹¬äº†æŠ½è±¡ç±»å’Œæ¥å£åœ¨é¢å‘å¯¹è±¡è®¾è®¡ä¸­çš„æ ¸å¿ƒåŒºåˆ«ã€‚ä¸‹é¢æˆ‘ç”¨ä¸€ä¸ªè¡¨æ ¼å¸®ä½ å¿«é€Ÿç†è§£å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«ï¼Œç„¶åå†è¯¦ç»†è§£é‡Šï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;æŠ½è±¡ç±» (Abstract Class)&lt;/th&gt;
&lt;th&gt;æ¥å£ (Interface)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³ç³»ç±»å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;is-a&lt;/code&gt;(æ˜¯ä¸€ä¸ª)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;has-a&lt;/code&gt;(æœ‰ä¸€ä¸ªèƒ½åŠ›/ç‰¹æ€§)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®çš„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¡¨ç¤º&lt;strong&gt;åˆ†ç±»å…³ç³»&lt;/strong&gt;å’Œä»£ç å¤ç”¨&lt;/td&gt;
&lt;td&gt;å®šä¹‰&lt;strong&gt;è¡Œä¸ºå¥‘çº¦&lt;/strong&gt;å’Œèƒ½åŠ›&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿/å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•ç»§æ‰¿ (&lt;code&gt;extends&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;å¤šå®ç° (&lt;code&gt;implements&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯åŒ…å«æŠ½è±¡æ–¹æ³•å’Œå…·ä½“å®ç°æ–¹æ³•&lt;/td&gt;
&lt;td&gt;Java 8å‰æ‰€æœ‰æ–¹æ³•æŠ½è±¡ï¼ŒJava 8+ å¯åŒ…å«é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—æ®µ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯åŒ…å«æ™®é€šæˆå‘˜å˜é‡&lt;/td&gt;
&lt;td&gt;å­—æ®µé»˜è®¤éƒ½æ˜¯ &lt;code&gt;public static final&lt;/code&gt;å¸¸é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ„é€ å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯ä»¥æœ‰æ„é€ æ–¹æ³•&lt;/td&gt;
&lt;td&gt;ä¸èƒ½æœ‰æ„é€ æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ºå¯†åˆ‡ç›¸å…³çš„ä¸€ç»„ç±»æä¾›å…¬å…±åŸºç±»å’Œéƒ¨åˆ†å®ç°&lt;/td&gt;
&lt;td&gt;ä¸ºå¯èƒ½ä¸ç›¸å…³çš„ç±»å®šä¹‰å…±åŒçš„è¡Œä¸ºè§„èŒƒ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ç†è§£-is-a-å’Œ-has-a"&gt;ğŸ§© ç†è§£ &amp;ldquo;is-a&amp;rdquo; å’Œ &amp;ldquo;has-a&amp;rdquo;
&lt;/h3&gt;&lt;h4 id="heading"&gt;&lt;strong&gt;&amp;ldquo;is-a&amp;rdquo; å…³ç³» (æŠ½è±¡ç±»)&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&amp;ldquo;is-a&amp;rdquo; å…³ç³»è¡¨ç¤ºä¸€ç§&lt;strong&gt;åˆ†ç±»ä¸Šçš„ä»å±å…³ç³»&lt;/strong&gt;ï¼Œå³å­ç±»æ˜¯çˆ¶ç±»çš„ä¸€ç§å…·ä½“ç±»å‹ã€‚å®ƒå¼ºè°ƒæœ¬è´¨ä¸Šçš„ç±»åˆ«å½’å±ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŠ½è±¡ç±»&lt;/strong&gt;ç”¨äºè¡¨ç¤ºè¿™ç§å…³ç³»ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªç±»åˆ«çš„æ ¸å¿ƒç‰¹å¾å’Œè¡Œä¸ºï¼Œå­ç±»é€šè¿‡ç»§æ‰¿æ¥æ‰©å±•æˆ–ç‰¹åŒ–è¿™ä¸ªåŸºç±»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾‹å­&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Dog&lt;/code&gt;(ç‹—) &lt;strong&gt;æ˜¯ä¸€ç§&lt;/strong&gt; &lt;code&gt;Animal&lt;/code&gt;(åŠ¨ç‰©)ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Circle&lt;/code&gt;(åœ†å½¢) &lt;strong&gt;æ˜¯ä¸€ç§&lt;/strong&gt; &lt;code&gt;Shape&lt;/code&gt;(å½¢çŠ¶)ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Manager&lt;/code&gt;(ç»ç†) &lt;strong&gt;æ˜¯ä¸€ç§&lt;/strong&gt; &lt;code&gt;Employee&lt;/code&gt;(å‘˜å·¥)ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æŠ½è±¡ç±»è¡¨ç¤º &amp;#34;is-a&amp;#34; å…³ç³»
abstract class Animal {
private String name;
public Animal(String name) {
this.name = name;
}
public abstract void makeSound(); // æŠ½è±¡æ–¹æ³•
public void eat() { // å…·ä½“æ–¹æ³•
System.out.println(name + &amp;#34; is eating.&amp;#34;);
}
}
class Dog extends Animal { // Dog &amp;#34;æ˜¯ä¸€ç§&amp;#34; Animal
public Dog(String name) {
super(name);
}
@Override
public void makeSound() {
System.out.println(&amp;#34;Woof!&amp;#34;);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="heading-1"&gt;&lt;strong&gt;&amp;ldquo;has-a&amp;rdquo; å…³ç³» (æ¥å£)&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&amp;ldquo;has-a&amp;rdquo; å…³ç³»è¡¨ç¤º&lt;strong&gt;èƒ½åŠ›ã€è¡Œä¸ºæˆ–è§’è‰²&lt;/strong&gt;ï¼Œå³ä¸€ä¸ªç±»å…·å¤‡äº†æŸç§åŠŸèƒ½æˆ–ç‰¹æ€§ã€‚å®ƒä¸å…³æ³¨ç±»åˆ«å½’å±ï¼Œè€Œå…³æ³¨èƒ½å¦åšæŸäº‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£&lt;/strong&gt;ç”¨äºè¡¨ç¤ºè¿™ç§å…³ç³»ã€‚å®ƒå®šä¹‰äº†ä¸€ç»„æ–¹æ³•å¥‘çº¦ï¼Œå®ç°ç±»å¿…é¡»æä¾›è¿™äº›æ–¹æ³•çš„å…·ä½“å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾‹å­&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Dog&lt;/code&gt;(ç‹—) &lt;strong&gt;å¯ä»¥&lt;/strong&gt; &lt;code&gt;Runnable&lt;/code&gt;(å¥”è·‘)ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Circle&lt;/code&gt;(åœ†å½¢) &lt;strong&gt;å¯ä»¥&lt;/strong&gt; &lt;code&gt;Drawable&lt;/code&gt;(è¢«ç»˜åˆ¶)ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Manager&lt;/code&gt;(ç»ç†) &lt;strong&gt;å¯ä»¥&lt;/strong&gt; &lt;code&gt;Interviewer&lt;/code&gt;(è¿›è¡Œé¢è¯•)ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ¥å£è¡¨ç¤º &amp;#34;has-a&amp;#34; å…³ç³»
interface Runnable { // è¡¨ç¤ºâ€œèƒ½å¥”è·‘â€çš„èƒ½åŠ›
void run();
}
interface Swimmable { // è¡¨ç¤ºâ€œèƒ½æ¸¸æ³³â€çš„èƒ½åŠ›
void swim();
}
class Dog extends Animal implements Runnable, Swimmable { // Dog &amp;#34;æ˜¯ä¸€ç§&amp;#34; Animal, &amp;#34;å¯ä»¥&amp;#34; run, &amp;#34;å¯ä»¥&amp;#34; swim
// ... å…¶ä»–ä»£ç 
@Override
public void run() {
System.out.println(&amp;#34;Dog is running fast!&amp;#34;);
}
@Override
public void swim() {
System.out.println(&amp;#34;Dog is swimming!&amp;#34;);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å¦‚ä½•é€‰æ‹©æŠ½è±¡ç±»ä¸æ¥å£"&gt;âš–ï¸ å¦‚ä½•é€‰æ‹©æŠ½è±¡ç±»ä¸æ¥å£
&lt;/h3&gt;&lt;p&gt;é€‰æ‹©çš„å…³é”®åœ¨äºä½ æƒ³è¦è¡¨è¾¾çš„å…³ç³»æ˜¯&lt;strong&gt;æœ¬è´¨çš„ç±»åˆ«å½’å±&lt;/strong&gt;ï¼ˆ&lt;code&gt;is-a&lt;/code&gt;ï¼‰ï¼Œè¿˜æ˜¯&lt;strong&gt;é¢å¤–çš„èƒ½åŠ›æˆ–è¡Œä¸º&lt;/strong&gt;ï¼ˆ&lt;code&gt;has-a&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨æŠ½è±¡ç±»&lt;/strong&gt;ï¼šå½“å¤šä¸ªç±»å…±äº«ç›¸åŒçš„æ ¸å¿ƒç‰¹å¾å’Œè¡Œä¸ºï¼Œå¹¶ä¸”å­˜åœ¨æ˜æ˜¾çš„å±‚æ¬¡ç»“æ„æ—¶ã€‚å®ƒéå¸¸é€‚åˆç”¨äº&lt;strong&gt;ä»£ç å¤ç”¨&lt;/strong&gt;å’Œå»ºç«‹&lt;strong&gt;åˆ†ç±»æ¨¡å‹&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨æ¥å£&lt;/strong&gt;ï¼šå½“ä½ éœ€è¦å®šä¹‰ä¸€ç»„è¡Œä¸ºå¥‘çº¦ï¼Œè¿™äº›è¡Œä¸ºå¯ä»¥è¢«è®¸å¤šäº’ä¸ç›¸å…³çš„ç±»å®ç°æ—¶ã€‚å®ƒæä¾›äº†æå¤§çš„&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;å¹¶æ”¯æŒ&lt;strong&gt;å¤šæ€&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç°ä»£Javaï¼ˆ8+ï¼‰ä¸­ï¼Œæ¥å£å¯ä»¥é€šè¿‡&lt;code&gt;default&lt;/code&gt;æ–¹æ³•æä¾›é»˜è®¤å®ç°ï¼Œè¿™ä½¿å¾—æ¥å£çš„èƒ½åŠ›æ›´å¼ºï¼Œä½†åœ¨è®¾è®¡ç†å¿µä¸Šï¼Œ&lt;code&gt;is-a&lt;/code&gt;å’Œ&lt;code&gt;has-a&lt;/code&gt;çš„åŒºåˆ†ä»ç„¶æ˜¯é‡è¦çš„æ€è€ƒè§’åº¦ã€‚&lt;/p&gt;
&lt;h3 id="-æ ¸å¿ƒè®°å¿†ç‚¹"&gt;ğŸ’ æ ¸å¿ƒè®°å¿†ç‚¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨åŒºåˆ«&lt;/strong&gt;ï¼šè®°ä½ &lt;strong&gt;&amp;ldquo;æ˜¯ä¸€ä¸ª&amp;rdquo; (&lt;code&gt;is-a&lt;/code&gt;) ç”¨æŠ½è±¡ç±»&lt;/strong&gt;ï¼Œ&lt;strong&gt;&amp;ldquo;æœ‰ä¸€ä¸ªèƒ½åŠ›&amp;rdquo; (&lt;code&gt;has-a&lt;/code&gt;) ç”¨æ¥å£&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³ç³»å¼ºåº¦&lt;/strong&gt;ï¼š&lt;code&gt;is-a&lt;/code&gt;æ˜¯&lt;strong&gt;å¼ºå…³ç³»&lt;/strong&gt;ï¼Œè¡¨ç¤ºæœ¬è´¨åˆ†ç±»ï¼›&lt;code&gt;has-a&lt;/code&gt;æ˜¯&lt;strong&gt;å¼±å…³ç³»&lt;/strong&gt;ï¼Œè¡¨ç¤ºå¯é€‰èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šé‡ç‰¹æ€§&lt;/strong&gt;ï¼šä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ï¼ˆå•&lt;code&gt;is-a&lt;/code&gt;ï¼‰ï¼Œä½†å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼ˆå¤š&lt;code&gt;has-a&lt;/code&gt;ï¼‰ã€‚è¿™æ­£æ˜¯Javaé€šè¿‡å•ç»§æ‰¿å’Œå¤šå®ç°æ¥çµæ´»ç»„åˆå¯¹è±¡è¡Œä¸ºçš„æ ¸å¿ƒæœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡æ€ç»´&lt;/strong&gt;ï¼šæŠ½è±¡ç±»å¸¸ç”¨äº&lt;strong&gt;è‡ªä¸‹è€Œä¸Š&lt;/strong&gt;çš„è®¾è®¡ï¼Œå…ˆæœ‰å­ç±»å†æœ‰æŠ½è±¡ï¼›æ¥å£å¸¸ç”¨äº&lt;strong&gt;è‡ªä¸Šè€Œä¸‹&lt;/strong&gt;çš„è®¾è®¡ï¼Œå…ˆå®šä¹‰å¥‘çº¦å†å®ç°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç†è§£ &lt;code&gt;is-a&lt;/code&gt;å’Œ &lt;code&gt;has-a&lt;/code&gt;çš„åŒºåˆ«ï¼Œèƒ½å¸®åŠ©ä½ åœ¨é¢å‘å¯¹è±¡è®¾è®¡ä¸­åšå‡ºæ›´åˆç†çš„å†³ç­–ï¼Œä»è€Œæ„å»ºå‡ºæ›´æ¸…æ™°ã€æ›´çµæ´»ã€æ›´æ˜“äºç»´æŠ¤çš„ä»£ç ç»“æ„ã€‚&lt;/p&gt;
&lt;h2 id="jvm-å‚æ•°"&gt;JVM å‚æ•°
&lt;/h2&gt;&lt;p&gt;Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰çš„å‚æ•°æ˜¯ä¼˜åŒ–åº”ç”¨æ€§èƒ½å’Œç¨³å®šæ€§çš„å…³é”®ã€‚ä¸‹é¢æˆ‘å°†JVMå‚æ•°çš„ä¸»è¦ç±»å‹ã€å¸¸ç”¨å‚æ•°åŠå…¶ç”¨é€”ä¸ºä½ æ•´ç†æˆä¸€ä¸ªè¡¨æ ¼ï¼Œæ–¹ä¾¿ä½ å¿«é€Ÿäº†è§£ï¼Œç„¶åå†è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°ç±»åˆ«&lt;/th&gt;
&lt;th&gt;å…³é”®å‚æ•°ç¤ºä¾‹&lt;/th&gt;
&lt;th&gt;ä¸»è¦ç”¨é€”&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ‡å‡†å‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-version&lt;/code&gt;, &lt;code&gt;-help&lt;/code&gt;, &lt;code&gt;-server&lt;/code&gt;, &lt;code&gt;-cp&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥çœ‹ä¿¡æ¯ã€è®¾ç½®ç±»è·¯å¾„ã€é€‰æ‹©JVMè¿è¡Œæ¨¡å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éæ ‡å‡†å‚æ•°(-X)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-Xms&lt;/code&gt;, &lt;code&gt;-Xmx&lt;/code&gt;, &lt;code&gt;-Xmn&lt;/code&gt;, &lt;code&gt;-Xss&lt;/code&gt;, &lt;code&gt;-Xloggc&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é…ç½®å†…å­˜å¤§å°ã€çº¿ç¨‹æ ˆã€GCæ—¥å¿—è¾“å‡ºç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜çº§å‚æ•°(-XX)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseG1GC&lt;/code&gt;, &lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;, &lt;code&gt;-XX:MetaspaceSize&lt;/code&gt;, &lt;code&gt;-XX:+PrintGCDetails&lt;/code&gt;, &lt;code&gt;-XX:+HeapDumpOnOutOfMemoryError&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©åƒåœ¾å›æ”¶å™¨ã€è°ƒä¼˜GCè¡Œä¸ºã€é…ç½®å…ƒç©ºé—´ã€ç›‘æ§ä¸è¯Šæ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-è¯¦è§£jvmå‚æ•°"&gt;ğŸ“Š è¯¦è§£JVMå‚æ•°
&lt;/h3&gt;&lt;p&gt;JVMå‚æ•°ä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼š&lt;strong&gt;æ ‡å‡†å‚æ•°&lt;/strong&gt;ã€&lt;strong&gt;éæ ‡å‡†å‚æ•°ï¼ˆä»¥-Xå¼€å¤´ï¼‰&lt;/strong&gt; å’Œ&lt;strong&gt;é«˜çº§å‚æ•°ï¼ˆä»¥-XXå¼€å¤´ï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ‡å‡†å‚æ•° (Standard Options)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰JVMå®ç°éƒ½å¿…é¡»æ”¯æŒï¼Œç›¸å¯¹ç¨³å®šï¼Œä¸»è¦ç”¨äºæ‰§è¡Œå¸¸è§æ“ä½œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-version&lt;/code&gt;ï¼šæŸ¥çœ‹JVMç‰ˆæœ¬ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-help&lt;/code&gt;ï¼šæŸ¥çœ‹javaå‘½ä»¤çš„ä½¿ç”¨å¸®åŠ©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-server&lt;/code&gt;/&lt;code&gt;-client&lt;/code&gt;ï¼šé€‰æ‹©JVMè¿è¡Œæ¨¡å¼ã€‚&lt;code&gt;-server&lt;/code&gt;æ¨¡å¼é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œå…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œå†…å­˜ç®¡ç†æ•ˆç‡ï¼›&lt;code&gt;-client&lt;/code&gt;æ¨¡å¼é€‚ç”¨äºæ¡Œé¢åº”ç”¨æˆ–å¼€å‘æµ‹è¯•ç¯å¢ƒï¼Œå¯åŠ¨é€Ÿåº¦è¾ƒå¿«ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-cp&lt;/code&gt;/&lt;code&gt;-classpath&lt;/code&gt;ï¼šæŒ‡å®šJVMæœç´¢ç±»å’Œèµ„æºæ–‡ä»¶çš„è·¯å¾„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éæ ‡å‡†å‚æ•° (Non-Standard Options, ä»¥ -X å¼€å¤´)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™äº›æ˜¯ç‰¹å®šäºJava HotSpotè™šæ‹Ÿæœºçš„å‚æ•°ï¼Œä¸ä¿è¯æ‰€æœ‰JVMå®ç°éƒ½æ”¯æŒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç®¡ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-Xms&amp;lt;size&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®JVM&lt;strong&gt;åˆå§‹å †å†…å­˜å¤§å°&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;-Xms512m&lt;/code&gt;æˆ– &lt;code&gt;-Xms2g&lt;/code&gt;ï¼‰ã€‚ç”Ÿäº§ç¯å¢ƒå¸¸ä¸&lt;code&gt;-Xmx&lt;/code&gt;è®¾ç›¸åŒï¼Œé¿å…åŠ¨æ€è°ƒæ•´å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-Xmx&amp;lt;size&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®JVM&lt;strong&gt;æœ€å¤§å †å†…å­˜å¤§å°&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;-Xmx4g&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-Xmn&amp;lt;size&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®&lt;strong&gt;å¹´è½»ä»£å¤§å°&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;-Xmn1g&lt;/code&gt;ï¼‰ã€‚è®¾ç½®æ–°ç”Ÿä»£å†…å­˜å¤§å°ï¼ŒåŒ…æ‹¬EdenåŒºå’Œä¸¤ä¸ªSurvivoråŒºçš„æ€»å’Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-Xss&amp;lt;size&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®æ¯ä¸ªçº¿ç¨‹çš„&lt;strong&gt;æ ˆå¤§å°&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;-Xss256k&lt;/code&gt;æˆ– &lt;code&gt;-Xss1m&lt;/code&gt;ï¼‰ã€‚æ ˆè¿‡å°å¯èƒ½å¯¼è‡´&lt;code&gt;StackOverflowError&lt;/code&gt;ï¼Œè¿‡å¤§åˆ™æµªè´¹å†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GCæ—¥å¿—&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-Xloggc:&amp;lt;file&amp;gt;&lt;/code&gt;ï¼šå°†GCæ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ï¼ˆå¦‚ &lt;code&gt;-Xloggc:gc.log&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œæ¨¡å¼&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-Xint&lt;/code&gt;ï¼šä»…è§£é‡Šæ¨¡å¼æ‰§è¡Œï¼Œä¸è¿›è¡ŒJITç¼–è¯‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-Xmixed&lt;/code&gt;ï¼šæ··åˆæ¨¡å¼æ‰§è¡Œï¼ˆé»˜è®¤ï¼‰ï¼Œè§£é‡Šå™¨ä¸JITç¼–è¯‘å™¨ååŒå·¥ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é«˜çº§å‚æ•° (Advanced Options, ä»¥ -XX å¼€å¤´)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”¨äºç²¾ç¡®æ§åˆ¶JVMè¡Œä¸ºï¼Œè¿›è¡Œæ€§èƒ½è°ƒä¼˜å’Œæ•…éšœè¯Šæ–­ã€‚å¯åˆ†ä¸ºBooleanç±»å‹ï¼ˆ&lt;code&gt;+&lt;/code&gt;å¯ç”¨/&lt;code&gt;-&lt;/code&gt;ç¦ç”¨ï¼‰å’Œéœ€è®¾å€¼çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç®¡ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-XX:NewRatio=&amp;lt;n&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®&lt;strong&gt;å¹´è½»ä»£ä¸è€å¹´ä»£&lt;/strong&gt;çš„æ¯”ä¾‹ï¼ˆå¦‚ &lt;code&gt;-XX:NewRatio=2&lt;/code&gt;è¡¨ç¤ºè€å¹´ä»£:å¹´è½»ä»£=2:1ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:SurvivorRatio=&amp;lt;n&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®&lt;strong&gt;EdenåŒºä¸SurvivoråŒº&lt;/strong&gt;çš„æ¯”ä¾‹ï¼ˆå¦‚ &lt;code&gt;-XX:SurvivorRatio=8&lt;/code&gt;è¡¨ç¤º Eden:ä¸€ä¸ªSurvivor=8:1ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:MetaspaceSize=&amp;lt;size&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®&lt;strong&gt;å…ƒç©ºé—´åˆå§‹å¤§å°&lt;/strong&gt;ï¼ˆJDK 8+ï¼Œå¦‚ &lt;code&gt;-XX:MetaspaceSize=256m&lt;/code&gt;ï¼‰ã€‚å…ƒç©ºé—´å­˜æ”¾ç±»å…ƒæ•°æ®ï¼Œæ›¿ä»£äº†æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:MaxMetaspaceSize=&amp;lt;size&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®&lt;strong&gt;å…ƒç©ºé—´æœ€å¤§å¤§å°&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:MaxDirectMemorySize=&amp;lt;size&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®**ç›´æ¥å†…å­˜ï¼ˆå †å¤–å†…å­˜ï¼‰**çš„æœ€å¤§å¤§å°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åƒåœ¾å›æ”¶ï¼ˆGCï¼‰ç›¸å…³&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;GCç­–ç•¥é€‰æ‹©&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-XX:+UseSerialGC&lt;/code&gt;ï¼šå¯ç”¨ä¸²è¡Œåƒåœ¾å›æ”¶å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:+UseParallelGC&lt;/code&gt;ï¼šå¯ç”¨å¹¶è¡Œåƒåœ¾å›æ”¶å™¨ï¼ˆååé‡ä¼˜å…ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:+UseG1GC&lt;/code&gt;ï¼šå¯ç”¨G1åƒåœ¾å›æ”¶å™¨ï¼ˆJDK9åŠä»¥åç‰ˆæœ¬çš„é»˜è®¤GCï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:+UseZGC&lt;/code&gt;ï¼šå¯ç”¨ZGCï¼ˆä½å»¶è¿Ÿï¼Œé€‚ç”¨äºJDK11+ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GCè°ƒä¼˜å‚æ•°&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-XX:MaxGCPauseMillis=&amp;lt;time&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®&lt;strong&gt;æœ€å¤§GCåœé¡¿æ—¶é—´ç›®æ ‡&lt;/strong&gt;ï¼ˆæ¯«ç§’ï¼Œå¦‚200ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:ParallelGCThreads=&amp;lt;n&amp;gt;&lt;/code&gt;ï¼šè®¾ç½®&lt;strong&gt;å¹¶è¡ŒGCçº¿ç¨‹æ•°&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:InitiatingHeapOccupancyPercent=&amp;lt;percent&amp;gt;&lt;/code&gt;ï¼šG1ä¸­è§¦å‘å¹¶å‘æ ‡è®°å‘¨æœŸçš„å †å ç”¨é˜ˆå€¼ï¼ˆå¦‚45ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§/è¯Šæ–­/æ—¥å¿—&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-XX:+PrintGC&lt;/code&gt;/ &lt;code&gt;-XX:+PrintGCDetails&lt;/code&gt;ï¼šæ‰“å°GCç®€è¦/è¯¦ç»†ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:+PrintGCTimeStamps&lt;/code&gt;/ &lt;code&gt;-XX:+PrintGCDateStamps&lt;/code&gt;ï¼šåœ¨GCæ—¥å¿—ä¸­æ‰“å°æ—¶é—´æˆ³æˆ–æ—¥æœŸæˆ³ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-Xlog:gc*:file=gc.log:time,uptime,level,tags:filecount=5,filesize=10M&lt;/code&gt;ï¼šJDK9+æ¨èçš„ç»Ÿä¸€æ—¥å¿—æ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:+HeapDumpOnOutOfMemoryError&lt;/code&gt;ï¼šåœ¨å‘ç”Ÿ&lt;strong&gt;OOMé”™è¯¯æ—¶è‡ªåŠ¨ç”Ÿæˆå †è½¬å‚¨æ–‡ä»¶&lt;/strong&gt;ï¼ˆheap dumpï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:HeapDumpPath=&amp;lt;path&amp;gt;&lt;/code&gt;ï¼šæŒ‡å®šå †è½¬å‚¨æ–‡ä»¶çš„è·¯å¾„ï¼ˆå¦‚ &lt;code&gt;-XX:HeapDumpPath=./java.hprof&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:+FlightRecorder&lt;/code&gt;/ &lt;code&gt;-XX:StartFlightRecording&lt;/code&gt;ï¼šå¯ç”¨Javaé£è¡Œè®°å½•å™¨ï¼ˆJFRï¼‰è¿›è¡Œæ€§èƒ½åˆ†æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-XX:+TieredCompilation&lt;/code&gt;ï¼šå¯ç”¨&lt;strong&gt;åˆ†å±‚ç¼–è¯‘&lt;/strong&gt;ï¼Œå¯ä»¥æå‡åº”ç”¨å¯åŠ¨é€Ÿåº¦å’Œé•¿æœŸæ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:+UseCompressedOops&lt;/code&gt;ï¼šå¯ç”¨&lt;strong&gt;å‹ç¼©æŒ‡é’ˆ&lt;/strong&gt;ï¼ŒèŠ‚çœ64ä½ç³»ç»Ÿä¸‹çš„å†…å­˜å ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:+DoEscapeAnalysis&lt;/code&gt;ï¼šå¼€å¯&lt;strong&gt;é€ƒé€¸åˆ†æ&lt;/strong&gt;ï¼Œå…è®¸JITç¼–è¯‘å™¨è¿›è¡Œæ ˆä¸Šåˆ†é…ç­‰ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•è®¾ç½®jvmå‚æ•°"&gt;âš™ï¸ å¦‚ä½•è®¾ç½®JVMå‚æ•°
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å‘½ä»¤è¡Œç›´æ¥è®¾ç½®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;java -Xms2g -Xmx2g -XX:+UseG1GC -jar your_application.jar
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åº”ç”¨æœåŠ¡å™¨è„šæœ¬ä¸­è®¾ç½®&lt;/strong&gt;ï¼ˆå¦‚Tomcatçš„&lt;code&gt;catalina.sh&lt;/code&gt;æˆ–&lt;code&gt;catalina.bat&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;JAVA_OPTS=&amp;#34;-Xms2048m -Xmx2048m -XX:+UseG1GC -XX:+PrintGCDetails&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;IDEä¸­è®¾ç½®&lt;/strong&gt;ï¼ˆå¦‚IntelliJ IDEA, Eclipseï¼‰ï¼šé€šå¸¸åœ¨è¿è¡Œé…ç½®ï¼ˆRun/Debug Configurationsï¼‰çš„VM optionsé€‰é¡¹ä¸­å¡«å†™ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æŸ¥çœ‹jvmå‚æ•°"&gt;ğŸ” æŸ¥çœ‹JVMå‚æ•°
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æŸ¥çœ‹æ‰€æœ‰å‚æ•°çš„é»˜è®¤å€¼&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;java -XX:+PrintFlagsInitial -version
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æŸ¥çœ‹è¿è¡Œä¸­JVMå‚æ•°çš„æœ€ç»ˆå€¼&lt;/strong&gt;ï¼ˆåŒ…æ‹¬è¢«ä¿®æ”¹çš„ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;java -XX:+PrintFlagsFinal -version
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„Javaè¿›ç¨‹çš„å‚æ•°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;jinfo -flags &amp;lt;pid&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-è°ƒä¼˜å»ºè®®"&gt;ğŸ’¡ è°ƒä¼˜å»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŸåˆ™&lt;/strong&gt;ï¼šä¼˜å…ˆä¼˜åŒ–ä»£ç ï¼ŒJVMè°ƒä¼˜æ˜¯è¡¥å……ï¼›åŸºäºç›‘æ§æ•°æ®å†³ç­–ï¼›å…³æ³¨ååé‡ã€å»¶è¿Ÿå’Œå†…å­˜å ç”¨çš„å¹³è¡¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§ç¯å¢ƒå»ºè®®å°†&lt;code&gt;-Xms&lt;/code&gt;å’Œ&lt;code&gt;-Xmx&lt;/code&gt;è®¾ä¸º&lt;strong&gt;ç›¸åŒå€¼&lt;/strong&gt;ï¼Œé¿å…åŠ¨æ€è°ƒæ•´å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;å †å¤§å°ä¸€èˆ¬ä¸åº”è¶…è¿‡ç‰©ç†å†…å­˜çš„70%ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GCé€‰æ‹©&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹³è¡¡å‹&lt;/strong&gt;ï¼šG1 GC (JDK8+)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½å»¶è¿Ÿ&lt;/strong&gt;ï¼šZGC (JDK15+)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜åå&lt;/strong&gt;ï¼šParallel GC&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-1"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬å…¼å®¹æ€§&lt;/strong&gt;ï¼šä¸åŒJDKç‰ˆæœ¬æ”¯æŒçš„å‚æ•°å¯èƒ½ä¸åŒï¼ˆå¦‚ZGCéœ€JDK11+ï¼‰ï¼Œç§»é™¤æˆ–åºŸå¼ƒäº†éƒ¨åˆ†å‚æ•°ï¼ˆå¦‚JDK7å&lt;code&gt;-XX:PermSize&lt;/code&gt;è¢«&lt;code&gt;-XX:MetaspaceSize&lt;/code&gt;æ›¿ä»£ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹å™¨ç¯å¢ƒ&lt;/strong&gt;ï¼šåœ¨Docker/K8sä¸­ï¼Œä½¿ç”¨&lt;code&gt;-XX:+UseContainerSupport&lt;/code&gt;ï¼ˆJDK10+ï¼‰å¹¶é…åˆ&lt;code&gt;-XX:MaxRAMPercentage&lt;/code&gt;ç­‰å‚æ•°ï¼Œè®©JVMæ„ŸçŸ¥å®¹å™¨å†…å­˜é™åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;JVMè°ƒä¼˜éœ€ç»“åˆåº”ç”¨ç‰¹ç‚¹ã€ç¡¬ä»¶èµ„æºå’Œç›‘æ§æ•°æ®ã€‚å»ºè®®å…ˆç†è§£å‚æ•°å«ä¹‰ï¼Œå†é€æ­¥è°ƒæ•´éªŒè¯ã€‚&lt;/p&gt;
&lt;h2 id="stringintern"&gt;String.intern
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;String.intern()&lt;/code&gt;æ˜¯ Java ä¸­ä¸€ä¸ªç”¨äºæ“ä½œ&lt;strong&gt;å­—ç¬¦ä¸²å¸¸é‡æ± &lt;/strong&gt;çš„æ–¹æ³•ï¼Œå®ƒèƒ½å¸®åŠ©ä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œä½†åœ¨ä¸åŒ JDK ç‰ˆæœ¬ä¸­æœ‰é‡è¦è¡Œä¸ºå·®å¼‚ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ è¯¦ç»†è§£é‡Šå®ƒçš„å·¥ä½œåŸç†ã€ç‰ˆæœ¬å·®å¼‚ã€ä½¿ç”¨åœºæ™¯å’Œæ³¨æ„äº‹é¡¹ã€‚&lt;/p&gt;
&lt;h3 id="-ä¸€æ ¸å¿ƒæœºåˆ¶ä¸åŸç†"&gt;ğŸ“Š ä¸€ã€æ ¸å¿ƒæœºåˆ¶ä¸åŸç†
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;String.intern()&lt;/code&gt;æ˜¯ä¸€ä¸ª &lt;code&gt;native&lt;/code&gt;æ–¹æ³•ï¼Œå…¶æ ¸å¿ƒè¡Œä¸ºå¯ä»¥æ¦‚æ‹¬ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“è°ƒç”¨ &lt;code&gt;intern()&lt;/code&gt;æ–¹æ³•æ—¶ï¼ŒJVM ä¼šæ£€æŸ¥å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ˜¯å¦å­˜åœ¨ä¸å½“å‰å­—ç¬¦ä¸²å†…å®¹ç›¸ç­‰çš„å­—ç¬¦ä¸²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœå­˜åœ¨&lt;/strong&gt;ï¼Œåˆ™ç›´æ¥è¿”å›å¸¸é‡æ± ä¸­è¯¥å­—ç¬¦ä¸²çš„å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœä¸å­˜åœ¨&lt;/strong&gt;ï¼ŒJDK7 ä¹‹å‰ä¼šåœ¨å¸¸é‡æ± &lt;strong&gt;åˆ›å»º&lt;/strong&gt;ä¸€ä¸ªç­‰å€¼å­—ç¬¦ä¸²å¹¶è¿”å›å…¶å¼•ç”¨ï¼›JDK7 åŠä¹‹ååˆ™ä¼šå°†å½“å‰å­—ç¬¦ä¸²å¯¹è±¡çš„&lt;strong&gt;å¼•ç”¨è®°å½•&lt;/strong&gt;åˆ°å¸¸é‡æ± ï¼Œå¹¶è¿”å›æ­¤å¼•ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ„å‘³ç€ï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªå­—ç¬¦ä¸² &lt;code&gt;s&lt;/code&gt;å’Œ &lt;code&gt;t&lt;/code&gt;ï¼Œ&lt;code&gt;s.intern() == t.intern()&lt;/code&gt;å½“ä¸”ä»…å½“ &lt;code&gt;s.equals(t)&lt;/code&gt;ä¸º &lt;code&gt;true&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id="-äºŒjdk-ç‰ˆæœ¬è¡Œä¸ºå·®å¼‚è¯¦è§£"&gt;ğŸ” äºŒã€JDK ç‰ˆæœ¬è¡Œä¸ºå·®å¼‚è¯¦è§£
&lt;/h3&gt;&lt;p&gt;ç†è§£ &lt;code&gt;intern()&lt;/code&gt;çš„å…³é”®åœ¨äºæŒæ¡å…¶åœ¨ä¸åŒ JDK ç‰ˆæœ¬ä¸­çš„è¡Œä¸ºå˜åŒ–ï¼Œè¿™ä¸»è¦æºäºå­—ç¬¦ä¸²å¸¸é‡æ± ä½ç½®çš„å˜åŒ–ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;JDK6 åŠä¹‹å‰&lt;/th&gt;
&lt;th&gt;JDK7+&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¸¸é‡æ± ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ°¸ä¹…ä»£ (PermGen)&lt;/td&gt;
&lt;td&gt;å † (Heap)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;intern()&lt;/code&gt;æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‹¥æ± ä¸­æ— ï¼Œåˆ™&lt;strong&gt;å¤åˆ¶&lt;/strong&gt;å­—ç¬¦ä¸²å¯¹è±¡åˆ°å¸¸é‡æ± &lt;/td&gt;
&lt;td&gt;è‹¥æ± ä¸­æ— ï¼Œåˆ™&lt;strong&gt;è®°å½•&lt;/strong&gt;å †ä¸­å­—ç¬¦ä¸²çš„&lt;strong&gt;å¼•ç”¨&lt;/strong&gt;åˆ°å¸¸é‡æ± &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½äº§ç”Ÿå¤§é‡é‡å¤å¯¹è±¡ï¼Œæ˜“å¯¼è‡´ &lt;code&gt;PermGen OOM&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;èŠ‚çœå†…å­˜ï¼Œå¸¸é‡æ± å¤§å°å¯è°ƒï¼Œå—å †å¤§å°é™åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;JDK6 åŠä¹‹å‰ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å­—ç¬¦ä¸²å¸¸é‡æ± ä½äº&lt;strong&gt;æ°¸ä¹…ä»£&lt;/strong&gt;ã€‚æ°¸ä¹…ä»£ç©ºé—´æœ‰é™ä¸”åƒåœ¾å›æ”¶æ•ˆç‡ä½ã€‚æ‰§è¡Œ &lt;code&gt;new String(&amp;quot;abc&amp;quot;).intern()&lt;/code&gt;æ—¶ï¼Œè‹¥å¸¸é‡æ± æ²¡æœ‰ &amp;ldquo;abc&amp;rdquo;ï¼Œä¼šåœ¨æ°¸ä¹…ä»£&lt;strong&gt;åˆ›å»ºä¸€ä»½æ–°çš„å­—ç¬¦ä¸²å‰¯æœ¬&lt;/strong&gt;ã€‚è¿™å¯èƒ½å¯¼è‡´å †ä¸­çš„å­—ç¬¦ä¸²å¯¹è±¡å’Œå¸¸é‡æ± ä¸­çš„å‰¯æœ¬å¹¶å­˜ï¼Œé€ æˆå†…å­˜æµªè´¹ï¼Œç”šè‡³ &lt;code&gt;OutOfMemoryError: PermGen space&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;JDK7 åŠä¹‹åï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å­—ç¬¦ä¸²å¸¸é‡æ± è¢«ç§»è‡³&lt;strong&gt;å †å†…å­˜&lt;/strong&gt;ã€‚æ‰§è¡Œ &lt;code&gt;new String(&amp;quot;abc&amp;quot;).intern()&lt;/code&gt;æ—¶ï¼Œè‹¥å¸¸é‡æ± æ²¡æœ‰ &amp;ldquo;abc&amp;rdquo;ï¼ŒJVM ä¼šç›´æ¥å°†å †ä¸­å·²æœ‰çš„è¿™ä¸ª &amp;ldquo;abc&amp;rdquo; å­—ç¬¦ä¸²å¯¹è±¡çš„&lt;strong&gt;å¼•ç”¨&lt;/strong&gt;å­˜å…¥å¸¸é‡æ± ã€‚&lt;strong&gt;è¿™æ„å‘³ç€å¸¸é‡æ± ä¸­å­˜å‚¨çš„ä¸å†æ˜¯å‰¯æœ¬ï¼Œè€Œæ˜¯å †ä¸­å¯¹è±¡çš„å¼•ç”¨&lt;/strong&gt;ï¼Œä»è€Œé¿å…äº†é‡å¤åˆ›å»ºï¼ŒèŠ‚çœäº†å†…å­˜ã€‚&lt;/p&gt;
&lt;h3 id="-ä¸‰å…¸å‹ä½¿ç”¨åœºæ™¯"&gt;âš™ï¸ ä¸‰ã€å…¸å‹ä½¿ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;intern()&lt;/code&gt;æ–¹æ³•åœ¨ç‰¹å®šåœºæ™¯ä¸‹èƒ½æ˜¾è‘—ä¼˜åŒ–å†…å­˜å’Œæé«˜æ¯”è¾ƒæ€§èƒ½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å‡å°‘å¤§é‡é‡å¤å­—ç¬¦ä¸²çš„å†…å­˜å ç”¨&lt;/strong&gt;ï¼šå½“ç¨‹åºéœ€è¦å¤„ç†å¤§é‡å†…å®¹é‡å¤çš„å­—ç¬¦ä¸²æ—¶ï¼ˆä¾‹å¦‚ä»æ•°æ®åº“æˆ–æ–‡ä»¶å¾ªç¯è¯»å–è®°å½•ï¼Œè®¸å¤šå­—æ®µå€¼ç›¸åŒï¼‰ï¼Œä½¿ç”¨ &lt;code&gt;intern()&lt;/code&gt;å¯ä»¥ç¡®ä¿ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­åªå­˜åœ¨ä¸€ä»½ï¼Œæå¤§èŠ‚çœå†…å­˜ç©ºé—´ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ¨¡æ‹Ÿä»å¤§é‡æ•°æ®ä¸­è¯»å–é‡å¤çš„å­—ç¬¦ä¸²å€¼
String[] rawData = getMassiveDataFromDB(); // è¿”å›å¤§é‡å¯èƒ½é‡å¤çš„å­—ç¬¦ä¸²
String[] internedData = new String[rawData.length];
for (int i = 0; i &amp;lt; rawData.length; i++) {
// ä½¿ç”¨ intern() ç¡®ä¿ç›¸åŒå­—ç¬¦ä¸²åªå­˜ä¸€ä»½
internedData[i] = rawData[i].intern();
}
// æ­¤å internedData ä¸­æ‰€æœ‰å†…å®¹ç›¸åŒçš„å­—ç¬¦ä¸²éƒ½æŒ‡å‘å¸¸é‡æ± çš„åŒä¸€å¼•ç”¨
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŠ é€Ÿå­—ç¬¦ä¸²æ¯”è¾ƒ&lt;/strong&gt;ï¼šå¯¹äºå·²çŸ¥ä¼šé‡å¤å‡ºç°ä¸”éœ€è¦é¢‘ç¹æ¯”è¾ƒçš„å­—ç¬¦ä¸²ï¼ˆå¦‚æŸäº›çŠ¶æ€ç ã€ç±»å‹æ ‡è¯†ï¼‰ï¼Œå…ˆå¯¹å…¶è¿›è¡Œ &lt;code&gt;intern()&lt;/code&gt;æ“ä½œï¼Œåç»­å°±å¯ä»¥ç›´æ¥ç”¨ &lt;code&gt;==&lt;/code&gt;ï¼ˆæ¯”è¾ƒå¼•ç”¨åœ°å€ï¼‰æ¥ä»£æ›¿ &lt;code&gt;equals()&lt;/code&gt;ï¼ˆæ¯”è¾ƒå†…å®¹ï¼‰ï¼Œé€Ÿåº¦æ›´å¿«ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// å‡è®¾ status æ˜¯é¢‘ç¹å‡ºç°ä¸”éœ€è¦æ¯”è¾ƒçš„å­—ç¬¦ä¸²
String status = getStatusFromExternalSource();
String internedStatus = status.intern(); // å…¥æ± 
// åç»­æ¯”è¾ƒä½¿ç”¨ ==ï¼Œæ•ˆç‡é«˜äº equals
if (internedStatus == &amp;#34;SUCCESS&amp;#34;) { // &amp;#34;SUCCESS&amp;#34; æ˜¯å­—é¢é‡ï¼Œå·²åœ¨æ± ä¸­
// do something
} else if (internedStatus == &amp;#34;FAILURE&amp;#34;) {
// do something else
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å››æ³¨æ„äº‹é¡¹ä¸æ€§èƒ½å½±å“"&gt;âš ï¸ å››ã€æ³¨æ„äº‹é¡¹ä¸æ€§èƒ½å½±å“
&lt;/h3&gt;&lt;p&gt;è™½ç„¶ &lt;code&gt;intern()&lt;/code&gt;å¼ºå¤§ï¼Œä½†ä½¿ç”¨ä¸å½“ä¹Ÿä¼šå¸¦æ¥é—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;ï¼š&lt;code&gt;intern()&lt;/code&gt;æ–¹æ³•æœ¬èº«éœ€è¦æ‰§è¡Œå“ˆå¸ŒæŸ¥æ‰¾ç­‰æ“ä½œï¼Œåœ¨&lt;strong&gt;å­—ç¬¦ä¸²å¸¸é‡æ± éå¸¸å¤§&lt;/strong&gt;çš„æƒ…å†µä¸‹ï¼Œé¢‘ç¹è°ƒç”¨å¯èƒ½å¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸é€‚ç”¨çš„åœºæ™¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ç”Ÿæˆçš„ã€å‡ ä¹å”¯ä¸€çš„å­—ç¬¦ä¸²&lt;/strong&gt;ï¼ˆå¦‚ UUIDã€éšæœºæ•°ã€ç”¨æˆ·è¾“å…¥ï¼‰ï¼šè¿™äº›å­—ç¬¦ä¸²å†…å®¹å‡ ä¹ä¸é‡å¤ï¼Œ&lt;code&gt;intern()&lt;/code&gt;å®ƒä»¬åªä¼šæ— é™è†¨èƒ€å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œå¢åŠ æŸ¥æ‰¾å¼€é”€ï¼Œå´æ— æ³•å¸¦æ¥å†…å­˜æ”¶ç›Šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸæçŸ­çš„å­—ç¬¦ä¸²&lt;/strong&gt;ï¼šå¦‚æœå­—ç¬¦ä¸²å¾ˆå¿«å°±ä¸å†ä½¿ç”¨ï¼Œå°†å…¶ &lt;code&gt;intern()&lt;/code&gt;å¹¶æ”¾å…¥å¸¸é‡æ± å¯èƒ½ä¼šå»¶é•¿å…¶ç”Ÿå‘½å‘¨æœŸï¼Œåè€Œå¢åŠ  GC å‹åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬å…¼å®¹æ€§&lt;/strong&gt;ï¼šå¦‚å‰æ‰€è¿°ï¼ŒJDK6 å’Œ JDK7+ çš„è¡Œä¸ºä¸åŒï¼Œå¦‚æœä»£ç éœ€è¦è·¨ç‰ˆæœ¬è¿è¡Œï¼Œéœ€è°¨æ…æµ‹è¯•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒä¼˜å‚æ•°&lt;/strong&gt;ï¼šåœ¨ JDK7+ ä¸­ï¼Œå¯ä»¥é€šè¿‡ JVM å‚æ•° &lt;code&gt;-XX:StringTableSize=&lt;/code&gt;æ¥è®¾ç½®å¸¸é‡æ± ï¼ˆStringTableï¼‰çš„æ¡¶ï¼ˆBucketï¼‰æ•°é‡ã€‚å¢å¤§æ­¤å€¼æœ‰åŠ©äºå‡å°‘å“ˆå¸Œå†²çªï¼Œæå‡ &lt;code&gt;intern()&lt;/code&gt;æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-äº”å®æˆ˜ç¤ºä¾‹ä¸æ•ˆæœ"&gt;ğŸ’¡ äº”ã€å®æˆ˜ç¤ºä¾‹ä¸æ•ˆæœ
&lt;/h3&gt;&lt;p&gt;æ¥çœ‹ä¸€ä¸ªä»£ç ç¤ºä¾‹ï¼Œç›´è§‚æ„Ÿå— &lt;code&gt;intern()&lt;/code&gt;çš„æ•ˆæœï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String s1 = new String(&amp;#34;abc&amp;#34;); // åœ¨å †ä¸­åˆ›å»ºå¯¹è±¡ï¼Œå¸¸é‡æ± å·²æœ‰&amp;#34;abc&amp;#34;ï¼ˆå› å­—é¢é‡ï¼‰
String s2 = &amp;#34;abc&amp;#34;; // ç›´æ¥ä½¿ç”¨å¸¸é‡æ± ä¸­çš„å¼•ç”¨
String s3 = new String(&amp;#34;abc&amp;#34;); // åˆåœ¨å †ä¸­åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡
String s4 = s3.intern(); // å°†s3çš„å¼•ç”¨ï¼ˆJDK7+ï¼‰æˆ–å¸¸é‡æ± å‰¯æœ¬çš„å¼•ç”¨ï¼ˆJDK6-ï¼‰è¿”å›
System.out.println(s1 == s2); // false, s1æ˜¯å †ä¸­æ–°å¯¹è±¡ï¼Œs2æ˜¯å¸¸é‡æ± å¼•ç”¨
System.out.println(s2 == s4); // true, intern()åéƒ½æŒ‡å‘å¸¸é‡æ± åŒä¸€å¼•ç”¨
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å†…å­˜èŠ‚çœæ•ˆæœ&lt;/strong&gt;ï¼šä¸€ä¸ªæç«¯ä½†èƒ½è¯´æ˜é—®é¢˜çš„æµ‹è¯•æ˜¯ï¼Œåˆ›å»ºå¤§é‡å†…å®¹ç›¸åŒçš„å­—ç¬¦ä¸²å¯¹è±¡ã€‚ä¸ä½¿ç”¨ &lt;code&gt;intern()&lt;/code&gt;ä¼šäº§ç”Ÿæµ·é‡å¯¹è±¡ï¼›è€Œä½¿ç”¨ &lt;code&gt;intern()&lt;/code&gt;åï¼Œå†…å­˜ä¸­é€šå¸¸åªå­˜åœ¨ä¸€ä»½è¯¥å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå†…å­˜å ç”¨å·®å¼‚å·¨å¤§ã€‚&lt;/p&gt;
&lt;h3 id="-å…­æœ€ä½³å®è·µå»ºè®®"&gt;ğŸ“ å…­ã€æœ€ä½³å®è·µå»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æƒè¡¡ä½¿ç”¨&lt;/strong&gt;ï¼šä¸è¦ç›²ç›®ä½¿ç”¨ &lt;code&gt;intern()&lt;/code&gt;ã€‚æ˜ç¡®å…¶é€‚ç”¨äº&lt;strong&gt;æœ‰é™ã€é¢„çŸ¥ã€é‡å¤åº¦é«˜&lt;/strong&gt;çš„å­—ç¬¦ä¸²é›†åˆï¼ˆå¦‚æšä¸¾å€¼ã€é…ç½®é”®ã€å›ºå®šçŠ¶æ€ç ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆç”¨äºèŠ‚çœå†…å­˜&lt;/strong&gt;ï¼šå…¶ä¸»è¦ä»·å€¼åœ¨äºå¤„ç†&lt;strong&gt;å¤§é‡é‡å¤æ•°æ®&lt;/strong&gt;æ—¶èŠ‚çœå†…å­˜ï¼Œè€Œéå•çº¯ä¸ºäº†ç”¨ &lt;code&gt;==&lt;/code&gt;æ¯”è¾ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§ä¸è°ƒä¼˜&lt;/strong&gt;ï¼šåœ¨é«˜æ€§èƒ½åº”ç”¨ä¸­ï¼Œå¦‚æœç¡®å®éœ€è¦å¤§é‡ä½¿ç”¨ &lt;code&gt;intern()&lt;/code&gt;ï¼Œè®°å¾—ä½¿ç”¨ &lt;code&gt;-XX:StringTableSize&lt;/code&gt;è°ƒæ•´æ± å¤§å°ï¼Œå¹¶å¯é€šè¿‡ &lt;code&gt;-XX:+PrintStringTableStatistics&lt;/code&gt;åœ¨ JVM é€€å‡ºæ—¶æ‰“å°ç»Ÿè®¡ä¿¡æ¯æ¥ç›‘æ§æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›ä»¥ä¸Šè¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ å…¨é¢ç†è§£ &lt;code&gt;String.intern()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h2 id="java-æ•°ç»„"&gt;java æ•°ç»„
&lt;/h2&gt;&lt;p&gt;Java ä¸­çš„æ•°ç»„æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ï¼Œå®ƒç¡®å®ç»§æ‰¿è‡ª &lt;code&gt;Object&lt;/code&gt;ç±»ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªè¡¨æ ¼å¿«é€Ÿäº†è§£æ•°ç»„ä½œä¸ºå¯¹è±¡çš„æ ¸å¿ƒç‰¹å¾å’Œç‰¹æ®Šä¹‹å¤„ï¼Œç„¶åå†è¿›è¡Œè¯¦ç»†è§£é‡Šã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;å…·ä½“è¡¨ç°&lt;/th&gt;
&lt;th&gt;è¯´æ˜æˆ–ç¤ºä¾‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰æ•°ç»„ç±»å‹éšå¼ç»§æ‰¿ &lt;code&gt;java.lang.Object&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] intArray = new int[5]; System.out.println(intArray instanceof Object); // è¾“å‡º true&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½œä¸ºObjectå¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°ç»„å¯èµ‹å€¼ç»™ &lt;code&gt;Object&lt;/code&gt;ç±»å‹å˜é‡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Object obj = new String[]{&amp;quot;Hello&amp;quot;, &amp;quot;World&amp;quot;};&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒç”¨Objectæ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯è°ƒç”¨ &lt;code&gt;Object&lt;/code&gt;ç±»çš„æ–¹æ³•ï¼Œå¦‚ &lt;code&gt;toString()&lt;/code&gt;, &lt;code&gt;hashCode()&lt;/code&gt;, &lt;code&gt;clone()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] original = {1, 2, 3}; int[] cloned = original.clone();&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‹¥æœ‰å¯¹è±¡ç‰¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èµ‹å€¼ç»™å¼•ç”¨å˜é‡ã€ä½œä¸ºå‚æ•°ä¼ é€’ã€å­˜å‚¨åœ¨é›†åˆä¸­&lt;/td&gt;
&lt;td&gt;&lt;code&gt;List&amp;lt;Object&amp;gt; list = new ArrayList&amp;lt;&amp;gt;(); list.add(new int[]{1, 2, 3}); // æ·»åŠ ä¸€ä¸ªintæ•°ç»„&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‰¹æ®Šæ€§ï¼šåˆ›å»ºè¯­æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ &lt;code&gt;new&lt;/code&gt;å…³é”®å­—åˆ›å»ºï¼Œæœ‰ç‰¹æ®Šè¯­æ³•&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] arr = new int[10]; // å¸¸è§„è¯­æ³•``int[] arr2 = {1, 2, 3}; // ç®€åŒ–åˆå§‹åŒ–è¯­æ³•&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‰¹æ®Šæ€§ï¼šç±»å‹ç³»ç»Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°ç»„ç±»å‹æ˜¯&lt;strong&gt;åå˜&lt;/strong&gt;çš„&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Object[] objArray = new String[10]; // åˆæ³•``objArray[0] = &amp;quot;Hello&amp;quot;; // åˆæ³•``// objArray[1] = new Integer(10); // è¿è¡Œæ—¶æŠ›å‡º ArrayStoreException&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‰¹æ®Šæ€§ï¼šç±»å&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°ç»„ç±»çš„åç§°ç”±å…ƒç´ ç±»å‹å’Œç»´åº¦å†³å®š&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] intArray = new int[10]; System.out.println(intArray.getClass().getName()); // è¾“å‡º [I&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;equalsæ–¹æ³•è¡Œä¸º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥ç»§æ‰¿è‡ª &lt;code&gt;Object&lt;/code&gt;ï¼Œæ¯”è¾ƒçš„æ˜¯&lt;strong&gt;å¼•ç”¨&lt;/strong&gt;è€Œé&lt;strong&gt;å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] arr1 = {1, 2, 3}; int[] arr2 = {1, 2, 3}; System.out.println(arr1.equals(arr2)); // è¾“å‡º false&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨å †ä¸­åˆ†é…ï¼ŒåŒ…å«å¯¹è±¡å¤´ã€é•¿åº¦å­—æ®µã€å…ƒç´ å­˜å‚¨åŒº&lt;/td&gt;
&lt;td&gt;æ•°ç»„é•¿åº¦é€šè¿‡ &lt;code&gt;length&lt;/code&gt;&lt;strong&gt;å­—æ®µ&lt;/strong&gt;ï¼ˆéæ–¹æ³•ï¼‰è·å–ï¼Œå¦‚ &lt;code&gt;arr.length&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ•°ç»„ç»§æ‰¿-object-çš„ä½“ç°ä¸ç»†èŠ‚"&gt;ğŸ” æ•°ç»„ç»§æ‰¿ Object çš„ä½“ç°ä¸ç»†èŠ‚
&lt;/h3&gt;&lt;p&gt;è™½ç„¶æ•°ç»„çš„åˆ›å»ºè¯­æ³•ï¼ˆå¦‚ &lt;code&gt;int[] arr = {1, 2, 3};&lt;/code&gt;ï¼‰çœ‹èµ·æ¥ä¸æ™®é€šå¯¹è±¡ä¸åŒï¼Œä½†å…¶åº•å±‚å®ç°å®Œå…¨éµå¾ª Java å¯¹è±¡çš„å†…å­˜æ¨¡å‹å’Œè§„åˆ™ï¼Œåœ¨å †å†…å­˜ä¸­åˆ†é…ç©ºé—´ã€‚æ­£å› ä¸ºæ•°ç»„æ˜¯å¯¹è±¡ï¼Œç»§æ‰¿è‡ª &lt;code&gt;Object&lt;/code&gt;ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«èµ‹å€¼ç»™ &lt;code&gt;Object&lt;/code&gt;ç±»å‹çš„å¼•ç”¨ï¼Œè¿™ä¹Ÿæ˜¯Javaä¸­å¤šæ€çš„ä¸€ç§ä½“ç°ã€‚ä½ å¯ä»¥å°†ä»»ä½•æ•°ç»„ï¼ˆæ— è®ºæ˜¯åŸºæœ¬ç±»å‹æ•°ç»„è¿˜æ˜¯å¼•ç”¨ç±»å‹æ•°ç»„ï¼‰èµ‹ç»™ä¸€ä¸ª &lt;code&gt;Object&lt;/code&gt;ç±»å‹çš„å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ•°ç»„ç»§æ‰¿äº† &lt;code&gt;Object&lt;/code&gt;ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œä½†ä¹Ÿå› æ­¤éœ€è¦æ³¨æ„ä¸€äº›æ–¹æ³•çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œæ•°ç»„ç›´æ¥ä½¿ç”¨ä» &lt;code&gt;Object&lt;/code&gt;ç»§æ‰¿æ¥çš„ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•æ¯”è¾ƒçš„æ˜¯å¼•ç”¨åœ°å€è€Œä¸æ˜¯æ•°ç»„å†…å®¹ã€‚è¦æ¯”è¾ƒä¸¤ä¸ªæ•°ç»„çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ï¼Œåº”ä½¿ç”¨ &lt;code&gt;Arrays.equals()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id="-æ•°ç»„çš„ç‰¹æ®Šæ€§"&gt;âš ï¸ æ•°ç»„çš„ç‰¹æ®Šæ€§
&lt;/h3&gt;&lt;p&gt;å°½ç®¡æ•°ç»„æ˜¯å¯¹è±¡ï¼Œä½†å®ƒæœ‰ä¸€äº›ç‹¬ç‰¹ä¹‹å¤„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åå˜æ€§&lt;/strong&gt;ï¼šå¦‚æœç±» &lt;code&gt;A&lt;/code&gt;æ˜¯ç±» &lt;code&gt;B&lt;/code&gt;çš„çˆ¶ç±»ï¼Œé‚£ä¹ˆ &lt;code&gt;A[]&lt;/code&gt;ä¹Ÿæ˜¯ &lt;code&gt;B[]&lt;/code&gt;çš„çˆ¶ç±»ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥å°† &lt;code&gt;String[]&lt;/code&gt;èµ‹å€¼ç»™ &lt;code&gt;Object[]&lt;/code&gt;ã€‚ç„¶è€Œï¼Œè¿™å¯èƒ½ä¼šåœ¨è¿è¡Œæ—¶å¯¼è‡´ &lt;code&gt;ArrayStoreException&lt;/code&gt;ï¼Œå¦‚æœä½ è¯•å›¾å°†ä¸å…¼å®¹ç±»å‹çš„å…ƒç´ å­˜å…¥æ•°ç»„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›ºå®šé•¿åº¦ä¸åŠŸèƒ½é™åˆ¶&lt;/strong&gt;ï¼šæ•°ç»„ä¸€æ—¦åˆ›å»ºï¼Œå…¶é•¿åº¦å°±å›ºå®šäº†ã€‚å®ƒæ²¡æœ‰åƒ &lt;code&gt;ArrayList&lt;/code&gt;é‚£æ ·çš„ &lt;code&gt;add()&lt;/code&gt;æˆ– &lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•ï¼Œå› æ­¤åœ¨éœ€è¦åŠ¨æ€å¢é•¿æˆ–ç¼©å‡æ—¶ï¼Œæ•°ç»„ä¸å¦‚é›†åˆæ¡†æ¶çµæ´»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•æ£€æŸ¥æ•°ç»„ç±»å‹"&gt;ğŸ’¡ å¦‚ä½•æ£€æŸ¥æ•°ç»„ç±»å‹
&lt;/h3&gt;&lt;p&gt;ç”±äºæ•°ç»„å¯ä»¥ä½œä¸º &lt;code&gt;Object&lt;/code&gt;å¤„ç†ï¼Œåœ¨ä½¿ç”¨å¤šæ€æ—¶ï¼Œæœ‰æ—¶éœ€è¦æ£€æŸ¥ä¸€ä¸ª &lt;code&gt;Object&lt;/code&gt;å¼•ç”¨æ˜¯å¦å®é™…æŒ‡å‘ä¸€ä¸ªæ•°ç»„ï¼Œä»¥åŠæ˜¯ä»€ä¹ˆç±»å‹çš„æ•°ç»„ã€‚å¯ä»¥ä½¿ç”¨ &lt;code&gt;Class&lt;/code&gt;ç±»çš„ &lt;code&gt;isArray()&lt;/code&gt;æ–¹æ³•å’Œ &lt;code&gt;getComponentType()&lt;/code&gt;æ–¹æ³•æ¥å®ç°ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public static void printArrayInfo(Object array) {
if (array.getClass().isArray()) {
System.out.println(&amp;#34;Array type: &amp;#34; + array.getClass().getComponentType()); // è·å–æ•°ç»„ç»„ä»¶ç±»å‹
System.out.println(&amp;#34;Array length: &amp;#34; + java.lang.reflect.Array.getLength(array));
} else {
System.out.println(&amp;#34;Not an array&amp;#34;);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Java ä¸­çš„æ•°ç»„æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ï¼Œå®ƒä»¬éšå¼ç»§æ‰¿è‡ª &lt;code&gt;Object&lt;/code&gt;ç±»ã€‚è¿™ä½¿å¾—æ•°ç»„å¯ä»¥äº«å—å¯¹è±¡çš„ä¸€åˆ‡åŸºæœ¬ç‰¹æ€§ï¼Œå¦‚å¯è¢«èµ‹å€¼ç»™ &lt;code&gt;Object&lt;/code&gt;å¼•ç”¨ã€å¯ä½œä¸ºå‚æ•°ä¼ é€’ã€å¯è°ƒç”¨ &lt;code&gt;Object&lt;/code&gt;çš„æ–¹æ³•ç­‰ã€‚ä½†åŒæ—¶ï¼Œæ•°ç»„ä¹Ÿæ‹¥æœ‰å…¶ç‰¹æ®Šæ€§ï¼Œå¦‚åå˜çš„ç±»å‹ç³»ç»Ÿã€å›ºå®šçš„é•¿åº¦ã€ç‹¬ç‰¹çš„åˆ›å»ºè¯­æ³•å’Œç±»åè¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;ç†è§£æ•°ç»„çš„å¯¹è±¡æœ¬è´¨åŠå…¶ä¸ &lt;code&gt;Object&lt;/code&gt;ç±»çš„ç»§æ‰¿å…³ç³»ï¼Œæœ‰åŠ©äºä½ æ›´å¥½åœ°ç†è§£ Java çš„ç±»å‹ç³»ç»Ÿï¼Œå¹¶åœ¨å®é™…ç¼–ç¨‹ä¸­åšå‡ºæ›´åˆé€‚çš„é€‰æ‹©ï¼ˆæ¯”å¦‚ä½•æ—¶ä½¿ç”¨æ•°ç»„ï¼Œä½•æ—¶ä½¿ç”¨é›†åˆï¼‰ã€‚&lt;/p&gt;
&lt;h2 id="hashmap-éå†ä¿®æ”¹"&gt;HashMap éå†ä¿®æ”¹
&lt;/h2&gt;&lt;p&gt;Java çš„ &lt;code&gt;HashMap&lt;/code&gt;åœ¨éå†è¿‡ç¨‹ä¸­ç›´æ¥ä¿®æ”¹å…¶ç»“æ„ï¼ˆä¾‹å¦‚æ·»åŠ ã€åˆ é™¤å…ƒç´ ï¼‰ä¼šæŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;å¼‚å¸¸ï¼Œè¿™ä¸»è¦æ˜¯ç”±äºå…¶å†…éƒ¨è®¾è®¡çš„ &lt;strong&gt;fail-fastï¼ˆå¿«é€Ÿå¤±è´¥ï¼‰æœºåˆ¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id="-æ ¹æœ¬åŸå› fail-fast-æœºåˆ¶"&gt;âš ï¸ æ ¹æœ¬åŸå› ï¼šfail-fast æœºåˆ¶
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;HashMap&lt;/code&gt;ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»ã€‚å®ƒçš„è¿­ä»£å™¨å®ç°äº† fail-fast æœºåˆ¶ï¼Œæ—¨åœ¨å°½å¯èƒ½æ—©åœ°å‘ç°å¹¶å‘ä¿®æ”¹è¿™ç±»æ½œåœ¨é—®é¢˜ï¼Œä»è€Œé¿å…æ•°æ®ä¸ä¸€è‡´ç­‰æ›´éš¾ä»¥è°ƒè¯•çš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ ¸å¿ƒå·¥ä½œåŸç†å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HashMap&lt;/code&gt;å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª &lt;code&gt;modCount&lt;/code&gt;ï¼ˆä¿®æ”¹æ¬¡æ•°è®¡æ•°å™¨ï¼‰å˜é‡ã€‚ä»»ä½•ä¼šæ”¹å˜é›†åˆç»“æ„çš„æ“ä½œï¼ˆå¦‚ &lt;code&gt;put&lt;/code&gt;, &lt;code&gt;remove&lt;/code&gt;, &lt;code&gt;clear&lt;/code&gt;ï¼‰éƒ½ä¼šä½¿ &lt;code&gt;modCount&lt;/code&gt;å¢åŠ ã€‚&lt;/li&gt;
&lt;li&gt;å½“ä½ è·å–ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆæ— è®ºæ˜¯ç›´æ¥é€šè¿‡ &lt;code&gt;iterator()&lt;/code&gt;æ–¹æ³•ï¼Œè¿˜æ˜¯éšå¼åœ°é€šè¿‡å¢å¼º for å¾ªç¯ï¼‰æ—¶ï¼Œè¿­ä»£å™¨ä¼šè®°å½•ä¸‹å½“å‰ &lt;code&gt;HashMap&lt;/code&gt;çš„ &lt;code&gt;modCount&lt;/code&gt;å€¼ï¼Œå­˜ä¸º &lt;code&gt;expectedModCount&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨è¿­ä»£å™¨éå†çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆä¾‹å¦‚è°ƒç”¨ &lt;code&gt;next()&lt;/code&gt;æ–¹æ³•æ—¶ï¼‰ï¼Œå®ƒéƒ½ä¼šæ£€æŸ¥ &lt;code&gt;modCount == expectedModCount&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€æ—¦å‘ç°ä¸¤è€…ä¸ç›¸ç­‰&lt;/strong&gt;ï¼Œå°±æ„å‘³ç€ &lt;code&gt;HashMap&lt;/code&gt;çš„ç»“æ„åœ¨è¿­ä»£å¼€å§‹åè¢«å¤–éƒ¨æ–¹æ³•ä¿®æ”¹äº†ï¼ˆæ—¢ä¸æ˜¯é€šè¿‡è¿­ä»£å™¨è‡ªèº«çš„ &lt;code&gt;remove&lt;/code&gt;æ–¹æ³•ï¼‰ï¼Œè¿­ä»£å™¨ä¾¿ä¼šç«‹å³æŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ï¼Œè€Œä¸æ˜¯ç­‰åˆ°éå†ç»“æŸï¼Œä»è€Œé¿å…äº†å¯èƒ½å‘ç”Ÿçš„ä¸å¯é¢„çŸ¥çš„è¡Œä¸ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é”™è¯¯ç¤ºä¾‹"&gt;ğŸ” é”™è¯¯ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯åœ¨éå†æ—¶ç›´æ¥åˆ é™¤å…ƒç´ ä¼šå¼•å‘å¼‚å¸¸çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;HashMap&amp;lt;String, Integer&amp;gt; map = new HashMap&amp;lt;&amp;gt;();
map.put(&amp;#34;A&amp;#34;, 1);
map.put(&amp;#34;B&amp;#34;, 2);
map.put(&amp;#34;C&amp;#34;, 3);
// å¢å¼º for å¾ªç¯åº•å±‚ä¹Ÿæ˜¯ä½¿ç”¨è¿­ä»£å™¨
for (String key : map.keySet()) {
if (&amp;#34;B&amp;#34;.equals(key)) {
map.remove(key); // è¿™é‡Œä¼šæŠ›å‡º ConcurrentModificationException
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å®‰å…¨çš„ä¿®æ”¹æ–¹å¼"&gt;âœ… å®‰å…¨çš„ä¿®æ”¹æ–¹å¼
&lt;/h3&gt;&lt;p&gt;è‹¥éœ€åœ¨éå†æ—¶ä¿®æ”¹ &lt;code&gt;HashMap&lt;/code&gt;ï¼ˆç‰¹åˆ«æ˜¯åˆ é™¤å…ƒç´ ï¼‰ï¼Œåº”ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨è¿­ä»£å™¨è‡ªèº«çš„ &lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯&lt;strong&gt;æ ‡å‡†ä¸”æ¨è&lt;/strong&gt;çš„åšæ³•ã€‚è¿­ä»£å™¨çš„ &lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•ä¼šåœ¨åˆ é™¤å½“å‰å…ƒç´ åï¼ŒåŒæ­¥æ›´æ–°å…¶å†…éƒ¨çš„ &lt;code&gt;expectedModCount&lt;/code&gt;ï¼Œä»è€Œé¿å…æŠ›å‡ºå¼‚å¸¸ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Iterator&amp;lt;Map.Entry&amp;lt;String, Integer&amp;gt;&amp;gt; iterator = map.entrySet().iterator();
while (iterator.hasNext()) {
Map.Entry&amp;lt;String, Integer&amp;gt; entry = iterator.next();
if (&amp;#34;B&amp;#34;.equals(entry.getKey())) {
iterator.remove(); // å®‰å…¨åˆ é™¤
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java 8+ çš„ &lt;code&gt;removeIf()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹å¼ä»£ç æ›´ç®€æ´ï¼Œé€‚ç”¨äºåŸºäºæ¡ä»¶çš„æ‰¹é‡åˆ é™¤ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;map.keySet().removeIf(key -&amp;gt; &amp;#34;B&amp;#34;.equals(key));
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éå†å‰åˆ›å»ºå‰¯æœ¬&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥å…ˆåˆ›å»ºä¸€ä»½é›†åˆå‰¯æœ¬ï¼Œç„¶åéå†å‰¯æœ¬ï¼Œä¿®æ”¹åŸé›†åˆã€‚è¿™ç§æ–¹å¼ç®€å•ä½†å¯èƒ½å¸¦æ¥å†…å­˜å’Œæ€§èƒ½å¼€é”€ï¼Œéœ€æ ¹æ®æ•°æ®é‡æƒè¡¡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;for (String key : new ArrayList&amp;lt;&amp;gt;(map.keySet())) {
if (&amp;#34;B&amp;#34;.equals(key)) {
map.remove(key); // æ“ä½œåŸmapï¼Œä½†éå†çš„æ˜¯å‰¯æœ¬ï¼Œæ‰€ä»¥å®‰å…¨
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ³¨æ„äº‹é¡¹"&gt;ğŸ§µ å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;å³ä½¿åœ¨å•çº¿ç¨‹ä¸­é¿å…äº†ç»“æ„æ€§ä¿®æ”¹çš„é™·é˜±ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹åŒæ—¶éå†å’Œä¿®æ”¹ &lt;code&gt;HashMap&lt;/code&gt;ä¾ç„¶ä¼šå¯¼è‡´é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶çš„è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨å¹¶å‘é›†åˆç±»&lt;/strong&gt;ï¼šè¿™æ˜¯é¦–é€‰æ–¹æ¡ˆã€‚ä¾‹å¦‚ä½¿ç”¨ &lt;code&gt;ConcurrentHashMap&lt;/code&gt;ã€‚å®ƒçš„è¿­ä»£å™¨è®¾è®¡ä¸º &lt;strong&gt;weakly consistent&lt;/strong&gt;ï¼ˆå¼±ä¸€è‡´æ€§ï¼‰ï¼Œå…è®¸åœ¨è¿­ä»£è¿‡ç¨‹ä¸­å®‰å…¨åœ°ä¿®æ”¹é›†åˆï¼ˆå°½ç®¡è¿­ä»£å™¨ä¸ä¸€å®šèƒ½åæ˜ æœ€æ–°çš„ä¿®æ”¹ï¼‰ï¼Œä¸ä¼šæŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤–éƒ¨åŠ é”&lt;/strong&gt;ï¼šåœ¨ä½¿ç”¨ &lt;code&gt;Collections.synchronizedMap&lt;/code&gt;æˆ–æ™®é€š &lt;code&gt;HashMap&lt;/code&gt;æ—¶ï¼Œ&lt;strong&gt;å¿…é¡»æ‰‹åŠ¨åŒæ­¥&lt;/strong&gt;ï¼ˆä½¿ç”¨ &lt;code&gt;synchronized&lt;/code&gt;å—æˆ–æ˜¾å¼é”ï¼‰æ¥ä¿æŠ¤æ•´ä¸ªéå†å’Œä¿®æ”¹æ“ä½œï¼Œä½†è¿™ä¼šå¯¹æ€§èƒ½æœ‰è¾ƒå¤§å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ ¸å¿ƒè¦ç‚¹"&gt;ğŸ’ æ ¸å¿ƒè¦ç‚¹
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œåœ¨éå† &lt;code&gt;HashMap&lt;/code&gt;æ—¶ï¼Œ&lt;strong&gt;ä¸è¦ç›´æ¥ä½¿ç”¨ &lt;code&gt;HashMap&lt;/code&gt;æœ¬èº«çš„ &lt;code&gt;put&lt;/code&gt;ã€&lt;code&gt;remove&lt;/code&gt;ç­‰æ–¹æ³•è¿›è¡Œç»“æ„æ€§ä¿®æ”¹&lt;/strong&gt;ã€‚è€Œåº”ä½¿ç”¨&lt;strong&gt;è¿­ä»£å™¨è‡ªèº«çš„ &lt;code&gt;remove&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ï¼Œæˆ–è€ƒè™‘ä½¿ç”¨ &lt;strong&gt;&lt;code&gt;ConcurrentHashMap&lt;/code&gt;&lt;/strong&gt; æ¥å¤„ç†å¹¶å‘åœºæ™¯ã€‚&lt;/p&gt;
&lt;h2 id="fast-fail--enumeration"&gt;fast-fail &amp;amp; Enumeration
&lt;/h2&gt;&lt;p&gt;HashMap çš„ &lt;code&gt;fail-fast&lt;/code&gt;è¿­ä»£å™¨å’Œ Hashtable çš„ &lt;code&gt;Enumeration&lt;/code&gt;è¿­ä»£å™¨åœ¨è®¾è®¡å’Œè¡Œä¸ºä¸Šæœ‰æ˜¾è‘—åŒºåˆ«ï¼Œè¿™ä¸»è¦æºäºå®ƒä»¬å„è‡ªé›†åˆç±»çš„çº¿ç¨‹å®‰å…¨ç‰¹æ€§ã€‚ä¸‹é¢æˆ‘æ¥ä¸ºä½ è¯¦ç»†å¯¹æ¯”å®ƒä»¬çš„æ ¸å¿ƒç‰¹æ€§ã€å·¥ä½œåŸç†å’Œä½¿ç”¨åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ èƒ½å¿«é€ŸæŠŠæ¡å…¨è²Œï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ±‡æ€»å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;HashMap çš„ Iterator (fail-fast)&lt;/th&gt;
&lt;th&gt;Hashtable çš„ Enumeration&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡æ—¶ä»£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Java 1.2 å¼•å…¥ï¼ˆè¾ƒæ–°ï¼‰&lt;/td&gt;
&lt;td&gt;Java 1.0 å¼•å…¥ï¼ˆè¾ƒæ—§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤±è´¥è¡Œä¸º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¿«é€Ÿå¤±è´¥ (fail-fast)&lt;/strong&gt;ï¼šæ£€æµ‹åˆ°å¹¶å‘ä¿®æ”¹ç«‹å³æŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;éå¿«é€Ÿå¤±è´¥&lt;/strong&gt;ï¼šå³ä½¿è¿­ä»£è¿‡ç¨‹ä¸­ç»“æ„è¢«ä¿®æ”¹ï¼Œä¹Ÿå¯èƒ½ç»§ç»­è¿­ä»£ï¼ˆä½†ç»“æœä¸ç¡®å®šï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ä¿è¯è¿­ä»£è¿‡ç¨‹ä¸­çš„çº¿ç¨‹å®‰å…¨&lt;/td&gt;
&lt;td&gt;è¿­ä»£æœ¬èº«éçº¿ç¨‹å®‰å…¨ï¼Œä½†å›  Hashtable æ–¹æ³•åŒæ­¥ï¼Œä¸€å®šç¨‹åº¦å‡å°‘é—®é¢˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç§»é™¤æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ”¯æŒ&lt;/strong&gt; é€šè¿‡ &lt;code&gt;Iterator.remove()&lt;/code&gt;å®‰å…¨åœ°ç§»é™¤å½“å‰å…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸æ”¯æŒ&lt;/strong&gt; æ²¡æœ‰å®šä¹‰ç§»é™¤å…ƒç´ çš„æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç°ä»£åº”ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ¨èä½¿ç”¨&lt;/strong&gt;ï¼ŒåŠŸèƒ½æ›´ä¸°å¯Œï¼Œä¸é›†åˆæ¡†æ¶é›†æˆæ›´ä½³&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åŸºæœ¬è¢«æ·˜æ±°&lt;/strong&gt;ï¼Œå¸¸è§äºé—ç•™ä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œåŸç†æ·±åº¦è§£æ"&gt;ğŸ” å·¥ä½œåŸç†æ·±åº¦è§£æ
&lt;/h3&gt;&lt;h4 id="hashmap-çš„-fail-fast-è¿­ä»£å™¨"&gt;&lt;strong&gt;HashMap çš„ Fail-Fast è¿­ä»£å™¨&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Fail-fast æœºåˆ¶æ˜¯ä¸€ç§&lt;strong&gt;é”™è¯¯æ£€æµ‹æœºåˆ¶&lt;/strong&gt;ï¼Œæ—¨åœ¨å°½æ—©æš´éœ²å¹¶å‘ä¿®æ”¹é—®é¢˜ï¼Œè€Œä¸æ˜¯ä»»ç”±ç¨‹åºåœ¨ä¸ç¡®å®šçŠ¶æ€ä¸‹è¿è¡Œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;HashMap å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª &lt;code&gt;modCount&lt;/code&gt;ï¼ˆä¿®æ”¹è®¡æ•°å™¨ï¼‰å­—æ®µã€‚ä»»ä½•ä¼šæ”¹å˜é›†åˆç»“æ„çš„æ“ä½œï¼ˆå¦‚ &lt;code&gt;put&lt;/code&gt;, &lt;code&gt;remove&lt;/code&gt;, &lt;code&gt;clear&lt;/code&gt;ï¼‰éƒ½ä¼šä½¿ &lt;code&gt;modCount&lt;/code&gt;å¢åŠ ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ è°ƒç”¨ &lt;code&gt;hashMap.iterator()&lt;/code&gt;è·å–è¿­ä»£å™¨æ—¶ï¼Œè¿­ä»£å™¨ä¼šè®°å½•ä¸‹å½“å‰çš„ &lt;code&gt;modCount&lt;/code&gt;å€¼ï¼ˆ&lt;code&gt;expectedModCount&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¯æ¬¡è¿­ä»£æ“ä½œï¼ˆå¦‚ &lt;code&gt;next()&lt;/code&gt;ï¼‰æ—¶ï¼Œè¿­ä»£å™¨éƒ½ä¼šæ£€æŸ¥ &lt;code&gt;modCount == expectedModCount&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸€æ—¦å‘ç°ä¸¤è€…ä¸ç›¸ç­‰&lt;/strong&gt;ï¼Œå°±æ„å‘³ç€ HashMap åœ¨è¿­ä»£è¿‡ç¨‹ä¸­è¢«å…¶ä»–çº¿ç¨‹æˆ–æœ¬çº¿ç¨‹çš„å…¶ä»–æ“ä½œä¿®æ”¹äº†ç»“æ„ï¼Œè¿­ä»£å™¨ä¾¿ä¼šç«‹å³æŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡å“²å­¦&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å¿«é€Ÿå¤±è´¥æ˜¯ä¸ºäº†é¿å…å› å¹¶å‘ä¿®æ”¹è€Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´æˆ–éš¾ä»¥è¿½è¸ªçš„é”™è¯¯ã€‚å®ƒå‡è®¾**â€œå°½æ—©æš´éœ²é”™è¯¯æ€»æ¯”ä»¥ååœ¨ä¸ç¡®å®šçš„åœ°æ–¹å´©æºƒè¦å¥½â€**ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æ­¤æœºåˆ¶æ— æ³•ä¿è¯ç»å¯¹çš„çº¿ç¨‹å®‰å…¨ï¼Œå®ƒæ›´å¤šåœ°æ˜¯ä¸€ç§â€œå°½åŠ›è€Œä¸ºâ€çš„æ£€æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¿­ä»£å™¨è‡ªèº«çš„ &lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•ç§»é™¤å…ƒç´ æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºè¯¥æ–¹æ³•ä¼šåœ¨æ“ä½œåæ›´æ–° &lt;code&gt;expectedModCount&lt;/code&gt;ï¼Œä½¿å…¶ä¸ &lt;code&gt;modCount&lt;/code&gt;ä¿æŒä¸€è‡´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="hashtable-çš„-enumeration-è¿­ä»£å™¨"&gt;&lt;strong&gt;Hashtable çš„ Enumeration è¿­ä»£å™¨&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Enumeration æ˜¯ Java æ—©æœŸçš„è¿­ä»£æ¥å£ï¼Œè®¾è®¡ç›¸å¯¹ç®€å•ï¼Œä¸å…·å¤‡ fail-fast ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;Hashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„æ‰€æœ‰å…¬å…±æ–¹æ³•ï¼ˆåŒ…æ‹¬ &lt;code&gt;elements()&lt;/code&gt;å’Œ &lt;code&gt;keys()&lt;/code&gt;è¿™äº›è¿”å› Enumeration çš„æ–¹æ³•ï¼‰éƒ½æ˜¯ &lt;code&gt;synchronized&lt;/code&gt;çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œ&lt;strong&gt;Enumeration æœ¬èº«å¹¶ä¸æ„ŸçŸ¥æˆ–è·Ÿè¸ª Hashtable çš„ç»“æ„æ€§ä¿®æ”¹&lt;/strong&gt;ã€‚å®ƒåªæ˜¯åœ¨åˆ›å»ºæ—¶åŸºäºå½“æ—¶çš„é›†åˆçŠ¶æ€è¿›è¡Œéå†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº† Hashtableï¼ˆä¾‹å¦‚ç§»é™¤ä¸€ä¸ªå°šæœªè¢«è¿­ä»£åˆ°çš„å…ƒç´ ï¼‰ï¼ŒEnumeration &lt;strong&gt;ä¸ä¼š&lt;/strong&gt;æŠ›å‡ºå¼‚å¸¸ï¼Œä½†åç»­è¿­ä»£è¡Œä¸ºçš„ç»“æœå°†æ˜¯ä¸å¯é¢„æµ‹çš„ï¼ˆå¯èƒ½è·³è¿‡å…ƒç´ ã€è¿”å› &lt;code&gt;null&lt;/code&gt;æˆ–å‡ºç°å…¶ä»–å¼‚å¸¸ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡å“²å­¦&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨ Hashtable è®¾è®¡çš„å¹´ä»£ï¼Œå¹¶å‘æ¨¡å‹å’Œé”™è¯¯å¤„ç†ç†å¿µä¸ç°åœ¨ä¸åŒã€‚å…¶çº¿ç¨‹å®‰å…¨é€šè¿‡æ–¹æ³•åŒæ­¥æ¥ä¿è¯ï¼Œä½†è¿­ä»£å™¨çš„è¡Œä¸ºæ›´â€œè„†å¼±â€ï¼Œä¾èµ–äºå¤–éƒ¨åŒæ­¥æ¥é¿å…é—®é¢˜ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¹¶å‘ä¿®æ”¹çš„å¯¹æ¯”"&gt;âš ï¸ å¹¶å‘ä¿®æ”¹çš„å¯¹æ¯”
&lt;/h3&gt;&lt;p&gt;å‡è®¾æˆ‘ä»¬åœ¨è¿­ä»£è¿‡ç¨‹ä¸­è¿›è¡Œç»“æ„æ€§ä¿®æ”¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;HashMap (Fail-Fast)&lt;/strong&gt;:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;HashMap&amp;lt;String, Integer&amp;gt; map = new HashMap&amp;lt;&amp;gt;();
map.put(&amp;#34;A&amp;#34;, 1);
map.put(&amp;#34;B&amp;#34;, 2);
Iterator&amp;lt;String&amp;gt; it = map.keySet().iterator();
while (it.hasNext()) {
String key = it.next();
if (&amp;#34;A&amp;#34;.equals(key)) {
map.remove(key); // ç›´æ¥ä½¿ç”¨mapçš„removeæ–¹æ³•ï¼Œä¼šæŠ›å‡ºConcurrentModificationException
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Hashtable (Non-Fail-Fast)&lt;/strong&gt;:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Hashtable&amp;lt;String, Integer&amp;gt; table = new Hashtable&amp;lt;&amp;gt;();
table.put(&amp;#34;A&amp;#34;, 1);
table.put(&amp;#34;B&amp;#34;, 2);
Enumeration&amp;lt;String&amp;gt; keys = table.keys();
while (keys.hasMoreElements()) {
String key = keys.nextElement();
if (&amp;#34;A&amp;#34;.equals(key)) {
table.remove(key); // å¯èƒ½ä¸ä¼šç«‹å³æŠ›å‡ºå¼‚å¸¸ï¼Œä½†åç»­è¡Œä¸ºæœªå®šä¹‰ï¼Œéå¸¸å±é™©
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©ä¸æœ€ä½³å®è·µ"&gt;ğŸ¯ å¦‚ä½•é€‰æ‹©ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é»˜è®¤ä½¿ç”¨ HashMap å’Œ Iterator&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨&lt;strong&gt;å•çº¿ç¨‹ç¯å¢ƒ&lt;/strong&gt;æˆ–&lt;strong&gt;å·²åšå¤–éƒ¨åŒæ­¥çš„å¤šçº¿ç¨‹ç¯å¢ƒ&lt;/strong&gt;ä¸­ï¼Œä¼˜å…ˆé€‰æ‹© &lt;code&gt;HashMap&lt;/code&gt;åŠå…¶ &lt;code&gt;Iterator&lt;/code&gt;ã€‚å®ƒçš„æ€§èƒ½æ›´å¥½ï¼ŒåŠŸèƒ½æ›´ç°ä»£ï¼Œå¹¶ä¸” fail-fast æœºåˆ¶èƒ½å¸®ä½ å¿«é€Ÿå‘ç°ç¼–ç é”™è¯¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éœ€è¦çº¿ç¨‹å®‰å…¨æ—¶ä½¿ç”¨ ConcurrentHashMap&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å¦‚æœåœ¨&lt;strong&gt;å¤šçº¿ç¨‹ç¯å¢ƒ&lt;/strong&gt;ä¸­éœ€è¦é¢‘ç¹çš„è¿­ä»£æ“ä½œï¼Œ&lt;strong&gt;ç»å¯¹ä¸è¦&lt;/strong&gt;ä½¿ç”¨ Hashtable çš„ Enumerationã€‚å®ƒçš„è¡Œä¸ºä¸å¯é ã€‚&lt;/p&gt;
&lt;p&gt;ç°ä»£ Java å¼€å‘ä¸­ï¼Œåº”é¦–é€‰ &lt;code&gt;ConcurrentHashMap&lt;/code&gt;ã€‚å®ƒçš„è¿­ä»£å™¨æ˜¯ &lt;strong&gt;weakly consistent&lt;/strong&gt;ï¼ˆå¼±ä¸€è‡´æ€§ï¼‰çš„ï¼Œå…è®¸åœ¨è¿­ä»£è¿‡ç¨‹ä¸­å®‰å…¨åœ°ä¿®æ”¹é›†åˆï¼Œä¸ä¼šæŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ï¼Œå¹¶èƒ½ä¿è¯éå†å·²å­˜åœ¨çš„å…ƒç´ ï¼ˆå°½ç®¡ä¸ä¸€å®šèƒ½åæ˜ è¿­ä»£åçš„æ‰€æœ‰ä¿®æ”¹ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤„ç†é—ç•™ä»£ç &lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å¦‚æœå¿…é¡»ç»´æŠ¤ä½¿ç”¨ Hashtable å’Œ Enumeration çš„é—ç•™ç³»ç»Ÿï¼ŒåŠ¡å¿…æ¸…æ¥šå…¶é£é™©ã€‚è¿­ä»£ Hashtable æ—¶ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹ï¼Œåº”åœ¨å¤–éƒ¨è¿›è¡ŒåŒæ­¥ï¼ˆä¾‹å¦‚ synchronized å—ï¼‰ï¼Œä½†è¦æ³¨æ„æ­»é”é£é™©ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ ¸å¿ƒæ€»ç»“"&gt;ğŸ’ æ ¸å¿ƒæ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç†è§£ &lt;code&gt;fail-fast&lt;/code&gt;å’Œ &lt;code&gt;Enumeration&lt;/code&gt;çš„åŒºåˆ«ï¼Œå…³é”®åœ¨äºç†è§£å®ƒä»¬èƒŒåä¸åŒçš„&lt;strong&gt;è®¾è®¡å“²å­¦å’Œæ—¶ä»£èƒŒæ™¯&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Fail-Fast (HashMap.Iterator)&lt;/strong&gt;ï¼šä¸€ç§ç§¯æçš„&lt;strong&gt;é”™è¯¯é¢„é˜²æœºåˆ¶&lt;/strong&gt;ï¼Œæ—¨åœ¨å¿«é€Ÿæš´éœ²é—®é¢˜ï¼Œé€‚åˆç°ä»£å¼€å‘ä¸­å¯¹å¥å£®æ€§å’Œå¯é¢„æµ‹æ€§çš„è¦æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Non-Fail-Fast (Hashtable.Enumeration)&lt;/strong&gt;ï¼šä¸€ç§ç›¸å¯¹è¢«åŠ¨å’Œç®€å•çš„éå†æ–¹å¼ï¼Œå…¶è¡Œä¸ºåœ¨å¤šçº¿ç¨‹ä¸‹æ›´ä¸å¯æ§ï¼Œæ˜¯æ—©æœŸ Java ç‰ˆæœ¬çš„äº§ç‰©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼Œåœ¨æ–°çš„å¼€å‘ä¸­ï¼Œä½ å‡ ä¹æ€»æ˜¯ä¼šä½¿ç”¨ &lt;code&gt;HashMap&lt;/code&gt;åŠå…¶ &lt;code&gt;Iterator&lt;/code&gt;ï¼Œå¹¶åœ¨éœ€è¦å¹¶å‘æ—¶é€‰æ‹© &lt;code&gt;ConcurrentHashMap&lt;/code&gt;ã€‚&lt;code&gt;Hashtable&lt;/code&gt;å’Œ &lt;code&gt;Enumeration&lt;/code&gt;æ›´å¤šæ˜¯ä½œä¸ºå†å²å­˜åœ¨ï¼Œéœ€è¦äº†è§£ä½†ä¸å¿…åœ¨æ–°é¡¹ç›®ä¸­ä¸»åŠ¨ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id="åŒ¿åå†…éƒ¨ç±»"&gt;åŒ¿åå†…éƒ¨ç±»
&lt;/h2&gt;&lt;p&gt;Java ä¸­çš„åŒ¿åå†…éƒ¨ç±»æ˜¯ä¸€ç§&lt;strong&gt;æ²¡æœ‰æ˜¾å¼åç§°&lt;/strong&gt;çš„å†…éƒ¨ç±»ï¼Œå®ƒå…è®¸ä½ åœ¨å®šä¹‰çš„åŒæ—¶ç›´æ¥åˆ›å»ºå®ä¾‹ï¼Œå¸¸ç”¨äºå®ç°æ¥å£æˆ–ç»§æ‰¿ç±»ï¼Œç‰¹åˆ«é€‚åˆé‚£äº›&lt;strong&gt;åªéœ€ä¸€æ¬¡æ€§ä½¿ç”¨&lt;/strong&gt;çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªæ±‡æ€»äº†å…¶æ ¸å¿ƒç‰¹æ€§çš„è¡¨æ ¼ï¼Œå¸®ä½ å¿«é€ŸæŠŠæ¡å…¨å±€ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒ¿åæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ²¡æœ‰æ˜¾å¼çš„ç±»åï¼Œç›´æ¥é€šè¿‡ &lt;code&gt;new&lt;/code&gt;å…³é”®å­—åˆ›å»ºå®ä¾‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°ä¸ç»§æ‰¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿…é¡»å®ç°ä¸€ä¸ªæ¥å£çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œæˆ–ç»§æ‰¿ä¸€ä¸ªç±»ï¼ˆå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–å…·ä½“ç±»ï¼‰å¹¶å¯èƒ½é‡å†™å…¶æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸€æ¬¡æ€§ä½¿ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šå¸¸ç”¨äºå®šä¹‰å³ç”¨ï¼Œæ— æ³•åœ¨å…¶ä»–åœ°æ–¹é‡å¤å®ä¾‹åŒ–æˆ–å¼•ç”¨å…¶ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¿é—®å¤–éƒ¨å˜é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜ï¼ˆåŒ…æ‹¬ç§æœ‰æˆå‘˜ï¼‰ã€‚è®¿é—®çš„å±€éƒ¨å˜é‡å¿…é¡»æ˜¾å¼å£°æ˜ä¸º &lt;code&gt;final&lt;/code&gt;æˆ–å®é™…ä¸Šæ˜¯ finalï¼ˆeffectively finalï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–è¯‘åæ–‡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘åä¼šç”Ÿæˆåä¸º &lt;code&gt;å¤–éƒ¨ç±»å$æ•°å­—.class&lt;/code&gt;çš„ç‹¬ç«‹å­—èŠ‚ç æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ— æ˜¾å¼æ„é€ å‡½æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸èƒ½å®šä¹‰è‡ªå·±çš„æ„é€ å‡½æ•°ï¼ˆå› ä¸ºæ— ç±»åï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸èƒ½å®šä¹‰é™æ€æˆå‘˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸èƒ½åŒ…å«é™æ€æ–¹æ³•ã€é™æ€å˜é‡æˆ–é™æ€åˆå§‹åŒ–å—ï¼ˆé™æ€å¸¸é‡ &lt;code&gt;static final&lt;/code&gt;é™¤å¤–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-è¯­æ³•å½¢å¼"&gt;ğŸ“ è¯­æ³•å½¢å¼
&lt;/h3&gt;&lt;p&gt;åŒ¿åå†…éƒ¨ç±»çš„åŸºæœ¬è¯­æ³•å›´ç»• &lt;code&gt;new&lt;/code&gt;å…³é”®å­—å±•å¼€ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®ç°æ¥å£&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;æ¥å£å å¯¹è±¡å = new æ¥å£å() {
// å®ç°æ¥å£çš„æŠ½è±¡æ–¹æ³•æˆ–æ·»åŠ å…¶ä»–æˆå‘˜
@Override
public void æ–¹æ³•å() {
// æ–¹æ³•å®ç°
}
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç»§æ‰¿ç±»&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;çˆ¶ç±»å å¯¹è±¡å = new çˆ¶ç±»å(æ„é€ å‚æ•°) { // å³ä½¿æ˜¯æ— å‚æ„é€ ï¼Œæ‹¬å·ä¹Ÿä¸èƒ½çœç•¥
// é‡å†™çˆ¶ç±»æ–¹æ³•æˆ–æ·»åŠ å…¶ä»–æˆå‘˜
@Override
public void æ–¹æ³•å() {
// æ–¹æ³•å®ç°
}
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä¸»è¦ç”¨é€”"&gt;ğŸ¯ ä¸»è¦ç”¨é€”
&lt;/h3&gt;&lt;p&gt;åŒ¿åå†…éƒ¨ç±»å¸¸ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;äº‹ä»¶ç›‘å¬å™¨&lt;/strong&gt;ï¼šåœ¨ GUI ç¼–ç¨‹ï¼ˆå¦‚ Swingã€JavaFXï¼‰ä¸­ä¸ºç»„ä»¶å¿«é€Ÿæ·»åŠ äº‹ä»¶å¤„ç†ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;JButton button = new JButton(&amp;#34;Click Me&amp;#34;);
button.addActionListener(new ActionListener() { // ActionListeneræ˜¯ä¸€ä¸ªæ¥å£
@Override
public void actionPerformed(ActionEvent e) {
System.out.println(&amp;#34;Button clicked!&amp;#34;);
}
});
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;çº¿ç¨‹åˆ›å»º&lt;/strong&gt;ï¼šå®ç° &lt;code&gt;Runnable&lt;/code&gt;æ¥å£æ¥å®šä¹‰çº¿ç¨‹ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Thread thread = new Thread(new Runnable() {
@Override
public void run() {
System.out.println(&amp;#34;Thread is running&amp;#34;);
}
});
thread.start();
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¯”è¾ƒå™¨&lt;/strong&gt;ï¼šä¸ºé›†åˆæ’åºæ—¶è‡ªå®šä¹‰æ¯”è¾ƒé€»è¾‘ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; names = Arrays.asList(&amp;#34;Alice&amp;#34;, &amp;#34;Bob&amp;#34;, &amp;#34;Charlie&amp;#34;);
Collections.sort(names, new Comparator&amp;lt;String&amp;gt;() {
@Override
public int compare(String s1, String s2) {
return s1.compareTo(s2);
}
});
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å›è°ƒæœºåˆ¶&lt;/strong&gt;ï¼šç”¨äºå®šä¹‰å¼‚æ­¥æ“ä½œå®Œæˆåçš„å›è°ƒé€»è¾‘ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é‡è¦é™åˆ¶"&gt;âš ï¸ é‡è¦é™åˆ¶
&lt;/h3&gt;&lt;p&gt;ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»æ—¶éœ€è¦æ³¨æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åªèƒ½å®ç°ä¸€ä¸ªæ¥å£æˆ–ç»§æ‰¿ä¸€ä¸ªç±»&lt;/strong&gt;ï¼šä¸èƒ½åŒæ—¶å®ç°å¤šä¸ªæ¥å£æˆ–ç»§æ‰¿å¤šä¸ªç±»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— æ³•å®šä¹‰æ„é€ å‡½æ•°&lt;/strong&gt;ï¼šå› ä¸ºå®ƒæ²¡æœ‰åå­—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™æ€æˆå‘˜é™åˆ¶&lt;/strong&gt;ï¼šä¸èƒ½å®šä¹‰é™æ€æ–¹æ³•ã€é™æ€å˜é‡æˆ–é™æ€åˆå§‹åŒ–å—ï¼ˆé™æ€å¸¸é‡ &lt;code&gt;static final&lt;/code&gt;é™¤å¤–ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±€éƒ¨å˜é‡è®¿é—®&lt;/strong&gt;ï¼šåŒ¿åå†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜ï¼ˆåŒ…æ‹¬ç§æœ‰æˆå‘˜ï¼‰ã€‚è®¿é—®çš„å±€éƒ¨å˜é‡å¿…é¡»æ˜¾å¼å£°æ˜ä¸º &lt;code&gt;final&lt;/code&gt;æˆ–å®é™…ä¸Šæ˜¯ finalï¼ˆeffectively finalï¼Œå³åˆå§‹åŒ–åæœªå†èµ‹å€¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯è¯»æ€§&lt;/strong&gt;ï¼šå¦‚æœåŒ¿åå†…éƒ¨ç±»ä¸­çš„é€»è¾‘è¿‡äºå¤æ‚ï¼Œå¯èƒ½ä¼šé™ä½ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¸-lambda-è¡¨è¾¾å¼çš„å…³ç³»"&gt;ğŸ” ä¸ Lambda è¡¨è¾¾å¼çš„å…³ç³»
&lt;/h3&gt;&lt;p&gt;åœ¨ Java 8 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœåŒ¿åå†…éƒ¨ç±»&lt;strong&gt;å®ç°çš„æ˜¯å‡½æ•°å¼æ¥å£&lt;/strong&gt;ï¼ˆå³åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼‰ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨ &lt;strong&gt;Lambda è¡¨è¾¾å¼&lt;/strong&gt;æ¥ç®€åŒ–ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä¹‹å‰åˆ›å»ºçº¿ç¨‹çš„åŒ¿åå†…éƒ¨ç±»ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Runnable runnable = new Runnable() {
@Override
public void run() {
System.out.println(&amp;#34;Thread is running&amp;#34;);
}
};
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç”¨ Lambda è¡¨è¾¾å¼é‡å†™ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Runnable runnable = () -&amp;gt; System.out.println(&amp;#34;Thread is running&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Lambda è¡¨è¾¾å¼å¹¶éåœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½èƒ½æ›¿ä»£åŒ¿åå†…éƒ¨ç±»&lt;/strong&gt;ï¼Œä¾‹å¦‚å½“éœ€è¦ç»§æ‰¿ä¸€ä¸ªç±»ï¼ˆè€Œéå®ç°æ¥å£ï¼‰ã€éœ€è¦é‡å†™å¤šä¸ªæ–¹æ³•ï¼Œæˆ–æ“ä½œçš„æ¥å£ä¸æ˜¯å‡½æ•°å¼æ¥å£ï¼ˆæœ‰å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼‰æ—¶ï¼Œä»éœ€ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ã€‚&lt;/p&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’¡ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;åŒ¿åå†…éƒ¨ç±»é€‚åˆåœ¨éœ€è¦&lt;strong&gt;å¿«é€Ÿå®ç°æŸä¸ªæ¥å£æˆ–ç»§æ‰¿æŸä¸ªç±»ï¼Œä¸”è¿™ä¸ªå®ç°åªéœ€ä½¿ç”¨ä¸€æ¬¡&lt;/strong&gt;çš„åœºæ™¯ã€‚å®ƒèƒ½å‡å°‘ä»£ç é‡ï¼Œé¿å…åˆ›å»ºå•ç‹¬çš„ç±»æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå¯¹äºå¤æ‚çš„é€»è¾‘ï¼Œæˆ–è€…éœ€è¦é‡å¤ä½¿ç”¨çš„å®ç°ï¼Œå®šä¹‰ä¸€ä¸ªç‹¬ç«‹çš„å…·åç±»é€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚åœ¨ Java 8+ çš„ç¯å¢ƒä¸­ï¼Œå¯¹äºå‡½æ•°å¼æ¥å£ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ Lambda è¡¨è¾¾å¼ä¼šä½¿ä»£ç æ›´ç®€æ´ã€‚&lt;/p&gt;
&lt;h2 id="ä»£ç "&gt;ä»£ç 
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;printNum&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printNum&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;printNum&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;ç¼–è¯‘é”™è¯¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŒ¿åå†…éƒ¨ç±»å¯ä»¥è®¿é—®çˆ¶ç±»ç§æœ‰å˜é‡ï¼Œä½†å› ä¸ºmainæ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œä¸èƒ½åœ¨é™æ€æ–¹æ³•ä¸­ä½¿ç”¨thisè°ƒç”¨ä¸Šä¸‹æ–‡&lt;/p&gt;
&lt;h2 id="java-èŒƒå‹"&gt;Java èŒƒå‹
&lt;/h2&gt;&lt;p&gt;Java æ³›å‹ä¸­çš„ &lt;strong&gt;ä¸å˜æ€§ (Invariance)&lt;/strong&gt; å’Œ &lt;strong&gt;åå˜ (Covariance)&lt;/strong&gt; æ˜¯ç†è§£å…¶ç±»å‹ç³»ç»Ÿçš„å…³é”®æ¦‚å¿µã€‚å®ƒä»¬å†³å®šäº†å…·æœ‰ç»§æ‰¿å…³ç³»çš„ç±»å‹ï¼Œå…¶æ³›å‹å®¹å™¨ä¹‹é—´æ˜¯å¦ä¹Ÿå­˜åœ¨æŸç§ç»§æ‰¿å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒåŒºåˆ«ï¼Œè¯·çœ‹ä¸‹è¡¨ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;ä¸å˜æ€§ (Invariance)&lt;/th&gt;
&lt;th&gt;åå˜ (Covariance)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒå…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å³ä½¿ &lt;code&gt;Dog&lt;/code&gt;â‰¦ &lt;code&gt;Animal&lt;/code&gt;ï¼Œ&lt;code&gt;List&amp;lt;Dog&amp;gt;&lt;/code&gt;ä¸ &lt;code&gt;List&amp;lt;Animal&amp;gt;&lt;/code&gt;&lt;strong&gt;æ— ä»»ä½•ç»§æ‰¿å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœ &lt;code&gt;Dog&lt;/code&gt;â‰¦ &lt;code&gt;Animal&lt;/code&gt;ï¼Œé‚£ä¹ˆ &lt;code&gt;List&amp;lt;Dog&amp;gt;&lt;/code&gt;â‰¦ &lt;code&gt;List&amp;lt;Animal&amp;gt;&lt;/code&gt;ï¼ˆæˆ– &lt;code&gt;Generic&amp;lt;Dog&amp;gt;&lt;/code&gt;â‰¦ &lt;code&gt;Generic&amp;lt;Animal&amp;gt;&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Javaæ³›å‹é»˜è®¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;æ˜¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°ç»„é»˜è®¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ å¦&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;æ˜¯&lt;/strong&gt; (ä½†è¿™æ˜¯Javaæ•°ç»„çš„ä¸€ä¸ªè®¾è®¡ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;List&amp;lt;Animal&amp;gt; animals = new ArrayList&amp;lt;Dog&amp;gt;();&lt;/code&gt;&lt;strong&gt;ç¼–è¯‘é”™è¯¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;List&amp;lt;? extends Animal&amp;gt; animals = new ArrayList&amp;lt;Dog&amp;gt;();&lt;/code&gt;&lt;strong&gt;ç¼–è¯‘é€šè¿‡&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»å–å…ƒç´ &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;å®‰å…¨&lt;/strong&gt; (å¯è§†ä¸ºä¸Šç•Œç±»å‹ï¼Œå¦‚ &lt;code&gt;Animal&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ·»åŠ å…ƒç´ &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;âŒ &lt;strong&gt;ä¸å®‰å…¨&lt;/strong&gt; (ç¼–è¯‘é”™è¯¯ã€‚ç¼–è¯‘å™¨æ— æ³•ç¡®å®šå®é™…ç±»å‹ï¼Œé˜²æ­¢æ±¡æŸ“é›†åˆ)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ç›®çš„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¿è¯ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨&lt;/strong&gt;ï¼Œé¿å…è¿è¡Œæ—¶å‡ºç° &lt;code&gt;ClassCastException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æé«˜APIçµæ´»æ€§&lt;/strong&gt;ï¼Œå…è®¸æ–¹æ³•æ¥å—æ›´å¹¿æ³›çš„å‚æ•°ç±»å‹ï¼ŒåŒæ—¶ä¿è¯&lt;strong&gt;å®‰å…¨çš„è¯»å–&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ·±å…¥è§£æä¸‰ç§å‹å˜"&gt;ğŸ“Š æ·±å…¥è§£æä¸‰ç§å‹å˜
&lt;/h3&gt;&lt;h4 id="1-ä¸å˜æ€§-invariance"&gt;1. ä¸å˜æ€§ (Invariance)
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯ &lt;strong&gt;Java æ³›å‹çš„é»˜è®¤è¡Œä¸º&lt;/strong&gt;ã€‚å®ƒæ„å‘³ç€å³ä½¿ç±»å‹å‚æ•°ä¹‹é—´å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œæ³›å‹ç±»å‹æœ¬èº«ä¹Ÿæ²¡æœ‰ç»§æ‰¿å…³ç³»ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç ç¤ºä¾‹&lt;/strong&gt;:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; stringList = new ArrayList&amp;lt;&amp;gt;();
List&amp;lt;Object&amp;gt; objectList = stringList; // ç¼–è¯‘é”™è¯¯ï¼šç±»å‹ä¸å…¼å®¹
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;ï¼šè¿™æ˜¯ä¸ºäº†&lt;strong&gt;ä¿è¯ç±»å‹å®‰å…¨&lt;/strong&gt;ã€‚å¦‚æœä¸Šè¿°èµ‹å€¼è¢«å…è®¸ï¼ˆå³å‡è®¾æ³›å‹æ˜¯åå˜çš„ï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ &lt;code&gt;objectList&lt;/code&gt;å¾€åŸæœ¬åªåŒ…å« &lt;code&gt;String&lt;/code&gt;çš„ &lt;code&gt;stringList&lt;/code&gt;é‡Œæ·»åŠ ä¸€ä¸ª &lt;code&gt;Integer&lt;/code&gt;ï¼Œä»è€Œåœ¨åç»­è¯»å–æ—¶å¼•å‘è¿è¡Œæ—¶ &lt;code&gt;ClassCastException&lt;/code&gt;ã€‚é€šè¿‡ä¸å˜æ€§ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µå°±é˜»æ­¢äº†è¿™ç§å±é™©æ“ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-åå˜-covariance"&gt;2. åå˜ (Covariance)
&lt;/h4&gt;&lt;p&gt;åå˜è¡¨ç¤ºæ³›å‹ç±»å‹çš„ç»§æ‰¿å…³ç³»ä¸ç±»å‹å‚æ•°çš„ç»§æ‰¿å…³ç³»&lt;strong&gt;ä¸€è‡´&lt;/strong&gt;ã€‚åœ¨ Java ä¸­ï¼Œéœ€è¦é€šè¿‡&lt;strong&gt;ä¸Šç•Œé€šé…ç¬¦ &lt;code&gt;&amp;lt;? extends T&amp;gt;&lt;/code&gt;&lt;/strong&gt; æ¥å®ç°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç ç¤ºä¾‹&lt;/strong&gt;:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;Integer&amp;gt; integerList = Arrays.asList(1, 2, 3);
List&amp;lt;? extends Number&amp;gt; numberList = integerList; // åå˜ï¼Œç¼–è¯‘æˆåŠŸ
Number firstNumber = numberList.get(0); // âœ… å®‰å…¨åœ°è¯»å–ï¼Œå…è®¸
// numberList.add(42); // âŒ ç¼–è¯‘é”™è¯¯ï¼Œä¸å…è®¸æ·»åŠ 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€… (Producer)&lt;/strong&gt;: ä¸»è¦ç”¨æ¥&lt;strong&gt;å®‰å…¨åœ°ä»æ³›å‹ç»“æ„ä¸­è¯»å–æ•°æ®&lt;/strong&gt;ã€‚ä½ çŸ¥é“å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ è‡³å°‘æ˜¯ &lt;code&gt;T&lt;/code&gt;ç±»å‹ï¼ˆæˆ–å…¶å­ç±»ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&amp;ldquo;åªè¯»&amp;quot;é™åˆ¶&lt;/strong&gt;: ä½ ä¸èƒ½å‘ä¸€ä¸ªå£°æ˜ä¸º &lt;code&gt;&amp;lt;? extends T&amp;gt;&lt;/code&gt;çš„é›†åˆæ·»åŠ ä»»ä½•å…ƒç´ ï¼ˆ&lt;code&gt;null&lt;/code&gt;é™¤å¤–ï¼‰ã€‚å› ä¸ºç¼–è¯‘å™¨æ— æ³•ç¡®å®šå®é™…çš„å…·ä½“ç±»å‹æ˜¯ä»€ä¹ˆï¼Œæ·»åŠ æ“ä½œæ˜¯ç±»å‹ä¸å®‰å…¨çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-é€†å˜-contravariance"&gt;3. é€†å˜ (Contravariance)
&lt;/h4&gt;&lt;p&gt;è™½ç„¶ä½ ä¸»è¦é—®çš„æ˜¯åå˜ï¼Œä½†ç†è§£é€†å˜èƒ½è®©ä½ å¯¹å‹å˜æœ‰æ›´å®Œæ•´çš„è®¤è¯†ã€‚é€†å˜è¡¨ç¤ºæ³›å‹ç±»å‹çš„ç»§æ‰¿å…³ç³»ä¸ç±»å‹å‚æ•°çš„ç»§æ‰¿å…³ç³»&lt;strong&gt;ç›¸å&lt;/strong&gt;ã€‚åœ¨ Java ä¸­ï¼Œé€šè¿‡&lt;strong&gt;ä¸‹ç•Œé€šé…ç¬¦ &lt;code&gt;&amp;lt;? super T&amp;gt;&lt;/code&gt;&lt;/strong&gt; æ¥å®ç°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç ç¤ºä¾‹&lt;/strong&gt;:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;Object&amp;gt; objectList = new ArrayList&amp;lt;&amp;gt;();
List&amp;lt;? super Integer&amp;gt; integerList = objectList; // é€†å˜ï¼Œç¼–è¯‘æˆåŠŸ
integerList.add(42); // âœ… å®‰å…¨åœ°æ·»åŠ IntegeråŠå…¶å­ç±»ï¼Œå…è®¸
// Integer value = integerList.get(0); // âŒ ç¼–è¯‘é”™è¯¯ï¼Œè¯»å–ä¸å®‰å…¨
Object firstElement = integerList.get(0); // è¯»å–æ—¶åªèƒ½è§†ä¸ºObject
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€… (Consumer)&lt;/strong&gt;: ä¸»è¦ç”¨æ¥&lt;strong&gt;å®‰å…¨åœ°å‘æ³›å‹ç»“æ„ä¸­å†™å…¥æ•°æ®&lt;/strong&gt;ã€‚ä½ çŸ¥é“è¿™ä¸ªç»“æ„å¯ä»¥å®‰å…¨åœ°æ¥å— &lt;code&gt;T&lt;/code&gt;ç±»å‹ï¼ˆåŠå…¶å­ç±»ï¼‰çš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&amp;ldquo;åªå†™&amp;quot;å€¾å‘&lt;/strong&gt;: ä½ å¯ä»¥æ·»åŠ å…ƒç´ ï¼Œä½†ä»å…¶ä¸­è¯»å–æ—¶ï¼Œåªèƒ½æ‹¿åˆ° &lt;code&gt;Object&lt;/code&gt;ç±»å‹çš„å¯¹è±¡ï¼Œå› ä¸ºç¼–è¯‘å™¨æ— æ³•ç¡®å®šå…·ä½“çš„çˆ¶ç±»å‹æ˜¯ä»€ä¹ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©pecs-åŸåˆ™"&gt;ğŸ¯ å¦‚ä½•é€‰æ‹©ï¼šPECS åŸåˆ™
&lt;/h3&gt;&lt;p&gt;Effective Java æå‡ºçš„ &lt;strong&gt;PECS (Producer-Extends, Consumer-Super)&lt;/strong&gt; åŸåˆ™æ˜¯å†³å®šä½¿ç”¨ &lt;code&gt;extends&lt;/code&gt;è¿˜æ˜¯ &lt;code&gt;super&lt;/code&gt;çš„é»„é‡‘æ³•åˆ™ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Producer (ç”Ÿäº§è€…) Extends&lt;/strong&gt;: å¦‚æœä½ çš„æ³›å‹ç»“æ„æ˜¯&lt;strong&gt;æ•°æ®çš„ç”Ÿäº§è€…&lt;/strong&gt;ï¼ˆå³ä¸»è¦ä»ä¸­&lt;strong&gt;è¯»å–&lt;/strong&gt;æ•°æ®ï¼‰ï¼Œä½¿ç”¨ &lt;code&gt;&amp;lt;? extends T&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ­¤æ–¹æ³•ä»æºåˆ—è¡¨ï¼ˆç”Ÿäº§è€…ï¼‰ä¸­è¯»å–å…ƒç´ 
public void processAnimals(List&amp;lt;? extends Animal&amp;gt; animals) {
for (Animal a : animals) { // å®‰å…¨è¯»å–
System.out.println(a.makeSound());
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Consumer (æ¶ˆè´¹è€…) Super&lt;/strong&gt;: å¦‚æœä½ çš„æ³›å‹ç»“æ„æ˜¯&lt;strong&gt;æ•°æ®çš„æ¶ˆè´¹è€…&lt;/strong&gt;ï¼ˆå³ä¸»è¦å‘å…¶ä¸­&lt;strong&gt;å†™å…¥&lt;/strong&gt;æ•°æ®ï¼‰ï¼Œä½¿ç”¨ &lt;code&gt;&amp;lt;? super T&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ­¤æ–¹æ³•å‘ç›®æ ‡åˆ—è¡¨ï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­å†™å…¥å…ƒç´ 
public void addCats(List&amp;lt;? super Cat&amp;gt; cats) {
cats.add(new Cat()); // å®‰å…¨å†™å…¥
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°ç»„çš„åå˜ä¸€ä¸ªå†å²æ•™è®­"&gt;âš ï¸ æ•°ç»„çš„åå˜ï¼šä¸€ä¸ªå†å²æ•™è®­
&lt;/h3&gt;&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ&lt;strong&gt;Java çš„æ•°ç»„æ˜¯åå˜çš„&lt;/strong&gt;ï¼Œä½†è¿™è¢«è§†ä¸ºä¸€ä¸ªå†å²æ€§çš„è®¾è®¡ç¼ºé™·ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Integer[] intArray = {1, 2, 3};
Number[] numberArray = intArray; // âœ… ç¼–è¯‘é€šè¿‡ï¼Œæ•°ç»„æ˜¯åå˜çš„
// numberArray[0] = 3.14; // âŒ è¿è¡Œæ—¶æŠ›å‡º ArrayStoreException
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ•°ç»„çš„åå˜ä¼šåœ¨è¿è¡Œæ—¶æ‰æŠ›å‡º &lt;code&gt;ArrayStoreException&lt;/code&gt;ï¼Œè€Œæ³›å‹é€šè¿‡&lt;strong&gt;ä¸å˜æ€§&lt;/strong&gt;å’Œ&lt;strong&gt;é€šé…ç¬¦&lt;/strong&gt;åœ¨&lt;strong&gt;ç¼–è¯‘æœŸ&lt;/strong&gt;å°±æ•è·äº†ç»å¤§å¤šæ•°ç±»å‹é”™è¯¯ï¼Œæ›´åŠ å®‰å…¨ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤ä¸å˜ï¼Œå®‰å…¨ç¬¬ä¸€&lt;/strong&gt;ï¼šJava æ³›å‹é»˜è®¤æ˜¯&lt;strong&gt;ä¸å˜&lt;/strong&gt;çš„ï¼Œè¿™æ˜¯ä¸ºäº†åœ¨ç¼–è¯‘æœŸå°±ç¡®ä¿ç±»å‹å®‰å…¨ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åå˜è¯»ï¼Œé€†å˜å†™&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;&amp;lt;? extends T&amp;gt;&lt;/code&gt;å®ç°&lt;strong&gt;åå˜&lt;/strong&gt;ï¼Œå…è®¸&lt;strong&gt;å®‰å…¨è¯»å–&lt;/strong&gt;ï¼Œä½†æ— æ³•å†™å…¥ã€‚ä½¿ç”¨ &lt;code&gt;&amp;lt;? super T&amp;gt;&lt;/code&gt;å®ç°&lt;strong&gt;é€†å˜&lt;/strong&gt;ï¼Œå…è®¸&lt;strong&gt;å®‰å…¨å†™å…¥&lt;/strong&gt;ï¼Œä½†è¯»å–å—é™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¢è®° PECS&lt;/strong&gt;ï¼šç¼–å†™é€šç”¨ API æˆ–æ–¹æ³•æ—¶ï¼Œéµå¾ª &lt;strong&gt;PECS (Producer-Extends, Consumer-Super)&lt;/strong&gt; åŸåˆ™ï¼Œèƒ½è®©ä½ çš„ä»£ç æ—¢çµæ´»åˆç±»å‹å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç†è§£è¿™äº›æ¦‚å¿µèƒ½è®©ä½ æ›´æ·±åˆ»åœ°æŠŠæ¡ Java ç±»å‹ç³»ç»Ÿï¼Œå†™å‡ºæ›´å¥å£®ã€æ›´çµæ´»çš„æ³›å‹ä»£ç ã€‚&lt;/p&gt;
&lt;h2 id="è¿ç®—ç¬¦"&gt;è¿ç®—ç¬¦
&lt;/h2&gt;&lt;p&gt;Java ä¸­çš„è¿ç®—ç¬¦åœ¨å¤„ç†ä¸åŒæ•°æ®ç±»å‹æ—¶ï¼Œé€šå¸¸ä¼šä¼´éšç€éšå¼ç±»å‹è½¬æ¢ï¼ˆè‡ªåŠ¨ç±»å‹æå‡ï¼‰ã€‚äº†è§£è¿™äº›è§„åˆ™å¯¹äºç¼–å†™æ­£ç¡®ã€é«˜æ•ˆçš„ä»£ç è‡³å…³é‡è¦ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ ç³»ç»Ÿæ¢³ç† Java å„ç§è¿ç®—ç¬¦æ”¯æŒçš„ç±»å‹åŠç›¸å…³çš„éšå¼è½¬æ¢è§„åˆ™ã€‚&lt;/p&gt;
&lt;h3 id="-å…ˆäº†è§£ç±»å‹æå‡å±‚çº§"&gt;ğŸ“Š å…ˆäº†è§£ç±»å‹æå‡å±‚çº§
&lt;/h3&gt;&lt;p&gt;åœ¨æ·±å…¥è¿ç®—ç¬¦ä¹‹å‰ï¼Œæœ€å…³é”®çš„æ˜¯è®°ä½ Java åŸºæœ¬æ•°æ®ç±»å‹çš„&lt;strong&gt;è‡ªåŠ¨æå‡æ–¹å‘&lt;/strong&gt;ï¼ˆä»ä½åˆ°é«˜ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;byte`â†’ `short`â†’ `int`â†’ `long`â†’ `float`â†’ `double
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;char&lt;/code&gt;â¡ï¸ &lt;code&gt;int&lt;/code&gt;(å‚ä¸è¿ç®—æ—¶)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è®°å¿†è¦ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;byte&lt;/code&gt;ã€&lt;code&gt;short&lt;/code&gt;ã€&lt;code&gt;char&lt;/code&gt;è¿™ä¸‰ç§å°äº &lt;code&gt;int&lt;/code&gt;çš„ç±»å‹ï¼Œ&lt;strong&gt;ä¸€æ—¦å‚ä¸è¿ç®—ï¼Œé¦–å…ˆä¼šè‡ªåŠ¨æå‡ä¸º &lt;code&gt;int&lt;/code&gt;&lt;/strong&gt; ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè¿ç®—ä¸­åŒ…å«æ›´é«˜ç­‰çº§çš„ç±»å‹ï¼Œç»“æœä¼šå‘ç­‰çº§æœ€é«˜çš„ç±»å‹æå‡ã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;int&lt;/code&gt;å’Œ &lt;code&gt;double&lt;/code&gt;è¿ç®—ï¼Œç»“æœä¼šæ˜¯ &lt;code&gt;double&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å„ç±»è¿ç®—ç¬¦çš„ç±»å‹æ”¯æŒä¸è½¬æ¢"&gt;ğŸ§® å„ç±»è¿ç®—ç¬¦çš„ç±»å‹æ”¯æŒä¸è½¬æ¢
&lt;/h3&gt;&lt;h4 id="1-ç®—æœ¯è¿ç®—ç¬¦------"&gt;1. ç®—æœ¯è¿ç®—ç¬¦ (&lt;code&gt;+&lt;/code&gt;, &lt;code&gt;-&lt;/code&gt;, &lt;code&gt;*&lt;/code&gt;, &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;%&lt;/code&gt;)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒç±»å‹&lt;/strong&gt;ï¼šä¸»è¦ä½œç”¨äºæ•°å€¼ç±»å‹ï¼ˆ&lt;code&gt;byte&lt;/code&gt;, &lt;code&gt;short&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;, &lt;code&gt;long&lt;/code&gt;, &lt;code&gt;float&lt;/code&gt;, &lt;code&gt;double&lt;/code&gt;, &lt;code&gt;char&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éšå¼è½¬æ¢è§„åˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è¿ç®—å‰ï¼Œæ‰€æœ‰æ“ä½œæ•°ä¼š&lt;strong&gt;è‡ªåŠ¨æå‡åˆ°è¡¨è¾¾å¼ä¸­æœ€é«˜ç­‰çº§çš„ç±»å‹&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç‰¹ä¾‹&lt;/strong&gt;ï¼š&lt;code&gt;byte&lt;/code&gt;, &lt;code&gt;short&lt;/code&gt;, &lt;code&gt;char&lt;/code&gt;ä¼šå…ˆæå‡ä¸º &lt;code&gt;int&lt;/code&gt;ï¼Œå³ä½¿å®ƒä»¬æ˜¯ç›¸åŒçš„ç±»å‹ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;byte a = 10;
byte b = 20;
// byte result = a + b; // ç¼–è¯‘é”™è¯¯ï¼å› ä¸º a + b çš„ç»“æœå·²ç»æ˜¯ int ç±»å‹
byte result = (byte) (a + b); // å¿…é¡»å¼ºåˆ¶è½¬æ¢
int intResult = a + b; // æ­£ç¡®ï¼Œç»“æœä¸º int
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é™¤æ³•æ³¨æ„&lt;/strong&gt;ï¼šä¸¤ä¸ªæ•´æ•°ç›¸é™¤ (&lt;code&gt;/&lt;/code&gt;)ï¼Œç»“æœä»ä¸ºæ•´æ•°ï¼Œå°æ•°éƒ¨åˆ†ä¼šè¢«&lt;strong&gt;æˆªæ–­&lt;/strong&gt;ï¼ˆå‘é›¶å–æ•´ï¼‰ã€‚è‹¥éœ€å°æ•°ç»“æœï¼Œéœ€æœ‰æµ®ç‚¹æ•°å‚ä¸ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;System.out.println(5 / 2); // è¾“å‡º 2
System.out.println(5.0 / 2); // è¾“å‡º 2.5
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å­—ç¬¦ä¸²è¿æ¥ &lt;code&gt;+&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ &lt;code&gt;+&lt;/code&gt;çš„ä¸€ä¸ªæ“ä½œæ•°æ˜¯ &lt;code&gt;String&lt;/code&gt;æ—¶ï¼Œå®ƒä¼šå˜ä¸ºå­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°ä¼šè¢«éšå¼è½¬æ¢ä¸º &lt;code&gt;String&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;System.out.println(&amp;#34;The answer is: &amp;#34; + 42); // &amp;#34;The answer is: 42&amp;#34;
System.out.println(1 + 2 + &amp;#34;3&amp;#34;); // å…ˆè®¡ç®— 1+2=3, ç„¶å &amp;#34;3&amp;#34; + &amp;#34;3&amp;#34; -&amp;gt; &amp;#34;33&amp;#34;
System.out.println(&amp;#34;1&amp;#34; + 2 + 3); // &amp;#34;1&amp;#34; + &amp;#34;2&amp;#34; -&amp;gt; &amp;#34;12&amp;#34;, å† + &amp;#34;3&amp;#34; -&amp;gt; &amp;#34;123&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-èµ‹å€¼è¿ç®—ç¬¦-------------"&gt;2. èµ‹å€¼è¿ç®—ç¬¦ (&lt;code&gt;=&lt;/code&gt;, &lt;code&gt;+=&lt;/code&gt;, &lt;code&gt;-=&lt;/code&gt;, &lt;code&gt;*=&lt;/code&gt;, &lt;code&gt;/=&lt;/code&gt;, &lt;code&gt;%=&lt;/code&gt;, &lt;code&gt;&amp;amp;=&lt;/code&gt;, &lt;code&gt;|=&lt;/code&gt;, &lt;code&gt;^=&lt;/code&gt;, &lt;code&gt;&amp;lt;&amp;lt;=&lt;/code&gt;, &lt;code&gt;&amp;gt;&amp;gt;=&lt;/code&gt;, &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;=&lt;/code&gt;)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒç±»å‹&lt;/strong&gt;ï¼šæ‰€æœ‰åŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ç±»å‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éšå¼è½¬æ¢è§„åˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç®€å•èµ‹å€¼ &lt;code&gt;=&lt;/code&gt;è¦æ±‚å³å€¼ç±»å‹å¯è‡ªåŠ¨è½¬æ¢ä¸ºå·¦å€¼ç±»å‹ï¼Œæˆ–ä½¿ç”¨å¼ºåˆ¶è½¬æ¢ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤åˆèµ‹å€¼è¿ç®—ç¬¦ï¼ˆå¦‚ &lt;code&gt;+=&lt;/code&gt;ï¼‰ä¼šè‡ªåŠ¨å®Œæˆå¼ºåˆ¶è½¬æ¢&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int x = 10;
x += 5.5; // ç­‰ä»·äº x = (int) (x + 5.5); x å˜ä¸º 15
// x = x + 5.5; // ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸º x + 5.5 æ˜¯ double ç±»å‹
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-è‡ªå¢è‡ªå‡è¿ç®—ç¬¦----"&gt;3. è‡ªå¢/è‡ªå‡è¿ç®—ç¬¦ (&lt;code&gt;++&lt;/code&gt;, &lt;code&gt;--&lt;/code&gt;)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒç±»å‹&lt;/strong&gt;ï¼šæ‰€æœ‰æ•°å€¼ç±»å‹å’ŒåŒ…è£…ç±»å‹ï¼ˆå¾—ç›Šäºè‡ªåŠ¨æ‹†ç®±ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éšå¼è½¬æ¢è§„åˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å½“æ“ä½œæ•°æ˜¯ &lt;code&gt;byte&lt;/code&gt;, &lt;code&gt;short&lt;/code&gt;, &lt;code&gt;char&lt;/code&gt;æ—¶ï¼Œ&lt;strong&gt;å€¼ä¼šæ”¹å˜ï¼Œä½†ç±»å‹ä¿æŒä¸å˜&lt;/strong&gt;ï¼ˆè¿™ä¸å…¶å®ƒç®—æœ¯è¿ç®—ä¸åŒï¼‰ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;byte count = 127;
count++; // count ç°åœ¨æ˜¯ -128ï¼ˆç”±äºæº¢å‡ºï¼‰ï¼Œä½†ç±»å‹ä»æ˜¯ byte
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="4-æ¯”è¾ƒè¿ç®—ç¬¦------"&gt;4. æ¯”è¾ƒè¿ç®—ç¬¦ (&lt;code&gt;==&lt;/code&gt;, &lt;code&gt;!=&lt;/code&gt;, &lt;code&gt;&amp;gt;&lt;/code&gt;, &lt;code&gt;&amp;lt;&lt;/code&gt;, &lt;code&gt;&amp;gt;=&lt;/code&gt;, &lt;code&gt;&amp;lt;=&lt;/code&gt;)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒç±»å‹&lt;/strong&gt;ï¼šæ•°å€¼ç±»å‹ã€&lt;code&gt;char&lt;/code&gt;ï¼ˆæ¯”è¾ƒ Unicode å€¼ï¼‰ã€&lt;code&gt;boolean&lt;/code&gt;ï¼ˆä»… &lt;code&gt;==&lt;/code&gt;å’Œ &lt;code&gt;!=&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éšå¼è½¬æ¢è§„åˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ¯”è¾ƒå‰ï¼Œæ“ä½œæ•°ä¼šéµå¾ªç±»å‹æå‡è§„åˆ™è½¬æ¢ä¸ºç›¸åŒç±»å‹åå†æ¯”è¾ƒ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int i = 10;
double d = 10.0;
System.out.println(i == d); // true, int i è¢«æå‡ä¸º double åæ¯”è¾ƒ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç‰¹åˆ«æ³¨æ„ &lt;code&gt;==&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºåŸºæœ¬ç±»å‹ï¼Œæ¯”è¾ƒçš„æ˜¯&lt;strong&gt;å€¼&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºå¯¹è±¡å¼•ç”¨ç±»å‹ï¼Œæ¯”è¾ƒçš„æ˜¯&lt;strong&gt;å†…å­˜åœ°å€&lt;/strong&gt;ï¼ˆæ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚è¦æ¯”è¾ƒå¯¹è±¡å†…å®¹ï¼Œéœ€ä½¿ç”¨ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="5-é€»è¾‘è¿ç®—ç¬¦------"&gt;5. é€»è¾‘è¿ç®—ç¬¦ (&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;, &lt;code&gt;||&lt;/code&gt;, &lt;code&gt;!&lt;/code&gt;, &lt;code&gt;&amp;amp;&lt;/code&gt;, &lt;code&gt;|&lt;/code&gt;, &lt;code&gt;^&lt;/code&gt;)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒç±»å‹&lt;/strong&gt;ï¼š&lt;strong&gt;ä»…é€‚ç”¨äº &lt;code&gt;boolean&lt;/code&gt;ç±»å‹&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éšå¼è½¬æ¢è§„åˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ“ä½œæ•°å¿…é¡»æ˜¯ &lt;code&gt;boolean&lt;/code&gt;æˆ–äº§ç”Ÿ &lt;code&gt;boolean&lt;/code&gt;çš„è¡¨è¾¾å¼ï¼ˆå¦‚æ¯”è¾ƒè¿ç®—ï¼‰ã€‚&lt;strong&gt;ä¸å­˜åœ¨ä»å…¶å®ƒç±»å‹åˆ° &lt;code&gt;boolean&lt;/code&gt;çš„éšå¼è½¬æ¢&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;çŸ­è·¯è¡Œä¸º&lt;/strong&gt;ï¼š&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;å’Œ &lt;code&gt;||&lt;/code&gt;æ˜¯çŸ­è·¯è¿ç®—ç¬¦ã€‚å¦‚æœæ ¹æ®å·¦æ“ä½œæ•°å°±èƒ½ç¡®å®šç»“æœï¼Œå³æ“ä½œæ•°å°†ä¸ä¼šè¢«è®¡ç®— ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;if (false &amp;amp;&amp;amp; (someExpensiveMethod())) {} // someExpensiveMethod() ä¸ä¼šè¢«è°ƒç”¨
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="6-ä½è¿ç®—ç¬¦-------"&gt;6. ä½è¿ç®—ç¬¦ (&lt;code&gt;&amp;amp;&lt;/code&gt;, &lt;code&gt;|&lt;/code&gt;, &lt;code&gt;^&lt;/code&gt;, &lt;code&gt;~&lt;/code&gt;, &lt;code&gt;&amp;lt;&amp;lt;&lt;/code&gt;, &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;, &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒç±»å‹&lt;/strong&gt;ï¼šæ•´å‹ï¼ˆ&lt;code&gt;byte&lt;/code&gt;, &lt;code&gt;short&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;, &lt;code&gt;long&lt;/code&gt;, &lt;code&gt;char&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éšå¼è½¬æ¢è§„åˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ‰€æœ‰æ“ä½œæ•°åœ¨è¿ç®—å‰éƒ½ä¼šæå‡ä¸º &lt;code&gt;int&lt;/code&gt;æˆ–æ›´é«˜ç±»å‹&lt;/strong&gt;ï¼ˆå¦‚åŒ…å« &lt;code&gt;long&lt;/code&gt;ï¼‰ã€‚è¿ç®—ç»“æœä¹Ÿæ˜¯æå‡åçš„ç±»å‹ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;byte flags = 0b00001100;
byte mask = 0b00000011;
// byte result = flags &amp;amp; mask; // ç¼–è¯‘é”™è¯¯ï¼ flags &amp;amp; mask çš„ç»“æœæ˜¯ int
byte result = (byte) (flags &amp;amp; mask); // å¿…é¡»å¼ºåˆ¶è½¬æ¢
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;~&lt;/code&gt;ï¼ˆæŒ‰ä½å–åï¼‰æ˜¯ä¸€å…ƒè¿ç®—ç¬¦ï¼ŒåŒæ ·éµå¾ªæå‡è§„åˆ™ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="7-æ¡ä»¶è¿ç®—ç¬¦ä¸‰ç›®è¿ç®—ç¬¦--"&gt;7. æ¡ä»¶è¿ç®—ç¬¦ï¼ˆä¸‰ç›®è¿ç®—ç¬¦ &lt;code&gt;? :&lt;/code&gt;ï¼‰
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒç±»å‹&lt;/strong&gt;ï¼šè¡¨è¾¾å¼2å’Œè¡¨è¾¾å¼3çš„ç±»å‹å¿…é¡»å…¼å®¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éšå¼è½¬æ¢è§„åˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç¼–è¯‘å™¨ä¼šç¡®å®šè¡¨è¾¾å¼2å’Œè¡¨è¾¾å¼3çš„&lt;strong&gt;å…±åŒç±»å‹&lt;/strong&gt;ã€‚å¦‚æœç±»å‹ä¸åŒï¼Œä¼šéµå¾ªè‡ªåŠ¨æå‡è§„åˆ™å°†å…¶ç»Ÿä¸€åˆ°æ›´é«˜çš„ç±»å‹ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int a = 10;
double b = 20.5;
double result = (a &amp;gt; 5) ? a : b; // å¦‚æœ a&amp;gt;5 ä¸ºçœŸï¼Œè¿”å› a (int)ï¼Œä½†ä¼šè‡ªåŠ¨æå‡ä¸º double åèµ‹å€¼
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é‡è¦æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è­¦æƒ•ç²¾åº¦ä¸¢å¤±&lt;/strong&gt;ï¼šå¼ºåˆ¶ç±»å‹è½¬æ¢å’Œæ•´æ•°é™¤æ³•éƒ½å¯èƒ½ä¸¢å¤±ç²¾åº¦ã€‚åœ¨è¿›è¡Œè½¬æ¢æ—¶ï¼ŒåŠ¡å¿…æ¸…æ¥šå¯èƒ½å¸¦æ¥çš„åæœ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„è¿ç®—ç¬¦ä¼˜å…ˆçº§&lt;/strong&gt;ï¼šä¸ç¡®å®šæ—¶ï¼Œå°±ä½¿ç”¨æ‹¬å· &lt;code&gt;()&lt;/code&gt;æ¥æ˜ç¡®è¿ç®—é¡ºåºã€‚æ‹¬å·æ‹¥æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŒºåˆ† &lt;code&gt;&amp;amp;&lt;/code&gt;ã€&lt;code&gt;|&lt;/code&gt;å’Œ &lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;ã€&lt;code&gt;||&lt;/code&gt;&lt;/strong&gt;ï¼šå•å­—ç¬¦çš„æ˜¯&lt;strong&gt;ä½è¿ç®—ç¬¦&lt;/strong&gt;æˆ–&lt;strong&gt;éçŸ­è·¯é€»è¾‘è¿ç®—ç¬¦&lt;/strong&gt;ï¼ŒåŒå­—ç¬¦çš„æ˜¯&lt;strong&gt;çŸ­è·¯é€»è¾‘è¿ç®—ç¬¦&lt;/strong&gt;ã€‚å®ƒä»¬çš„ç”¨é€”å’Œæ“ä½œæ•°ç±»å‹å®Œå…¨ä¸åŒ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŒ…è£…ç±»çš„è‡ªåŠ¨æ‹†ç®±/è£…ç®±&lt;/strong&gt;ï¼šåœ¨ä½¿ç”¨åŒ…è£…ç±»ï¼ˆå¦‚ &lt;code&gt;Integer&lt;/code&gt;, &lt;code&gt;Double&lt;/code&gt;ï¼‰æ—¶ï¼Œè¿ç®—ä¼šå…ˆè‡ªåŠ¨æ‹†ç®±ä¸ºåŸºæœ¬ç±»å‹ï¼Œè¿ç®—åå†æ ¹æ®æƒ…å†µè£…ç®±ã€‚éœ€æ³¨æ„ &lt;code&gt;null&lt;/code&gt;å€¼å¯èƒ½å¼•å‘ &lt;code&gt;NullPointerException&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Integer num1 = null;
// int value = num1 + 1; // è¿è¡Œæ—¶æŠ›å‡º NullPointerException
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„æ¢³ç†èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Java è¿ç®—ç¬¦çš„ç±»å‹è½¬æ¢æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h2 id="çº¿ç¨‹æ¨¡å‹"&gt;çº¿ç¨‹æ¨¡å‹
&lt;/h2&gt;&lt;p&gt;ç†è§£æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„å®ç°æ–¹å¼ï¼Œèƒ½å¸®ä½ æ›´æ·±å…¥åœ°æŠŠæ¡å¤šçº¿ç¨‹ç¼–ç¨‹çš„æœ¬è´¨ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ æ¢³ç†ä¸»è¦çš„çº¿ç¨‹å®ç°æ–¹å¼åŠå…¶ç‰¹ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„å®ç°ä¸»è¦æœ‰ä¸‰ç§æ¨¡å‹ï¼šç”¨æˆ·çº§çº¿ç¨‹ (ULT)ã€å†…æ ¸çº§çº¿ç¨‹ (KLT)ï¼Œä»¥åŠç»“åˆä¸¤è€…ç‰¹ç‚¹çš„&lt;strong&gt;æ··åˆæ¨¡å‹&lt;/strong&gt;ã€‚å®ƒä»¬æ ¸å¿ƒçš„åŒºåˆ«åœ¨äº&lt;strong&gt;çº¿ç¨‹çš„ç®¡ç†è€…æ˜¯è°&lt;/strong&gt;ä»¥åŠ&lt;strong&gt;æ“ä½œç³»ç»Ÿå†…æ ¸æ˜¯å¦æ„ŸçŸ¥çº¿ç¨‹çš„å­˜åœ¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿå»ºç«‹ä¸€ä¸ªå…¨å±€å°è±¡ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ¥å¯¹æ¯”å®ƒä»¬çš„æ ¸å¿ƒç‰¹å¾ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;ç”¨æˆ·çº§çº¿ç¨‹ (ULT)&lt;/th&gt;
&lt;th&gt;å†…æ ¸çº§çº¿ç¨‹ (KLT)&lt;/th&gt;
&lt;th&gt;æ··åˆæ¨¡å‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°ä¸ç®¡ç†è€…&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹åº“ï¼ˆå¦‚è¿è¡Œæ—¶ç³»ç»Ÿï¼‰&lt;/td&gt;
&lt;td&gt;æ“ä½œç³»ç»Ÿå†…æ ¸&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹å…±åŒåä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…æ ¸æ„ŸçŸ¥åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ å†…æ ¸ä¸å¯è§ï¼Œä»…æ„ŸçŸ¥åˆ°è¿›ç¨‹&lt;/td&gt;
&lt;td&gt;âœ… å†…æ ¸å¯è§ï¼Œå¹¶ç›´æ¥ç®¡ç†&lt;/td&gt;
&lt;td&gt;å†…æ ¸æ„ŸçŸ¥å†…æ ¸çº¿ç¨‹ï¼Œç”¨æˆ·çº¿ç¨‹å¯¹å†…æ ¸é€æ˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹åˆ‡æ¢å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å¾ˆå°ï¼Œæ— éœ€æ¨¡å¼åˆ‡æ¢&lt;/td&gt;
&lt;td&gt;âŒ è¾ƒå¤§ï¼Œéœ€åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€é—´åˆ‡æ¢&lt;/td&gt;
&lt;td&gt;å–å†³äºå®ç°ï¼Œé€šå¸¸ä»‹äºä¸¤è€…ä¹‹é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é˜»å¡æ“ä½œçš„å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸€ä¸ªçº¿ç¨‹é˜»å¡ç³»ç»Ÿè°ƒç”¨ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹é˜»å¡&lt;/td&gt;
&lt;td&gt;âœ… ä¸€ä¸ªçº¿ç¨‹é˜»å¡ï¼ŒåŒä¸€è¿›ç¨‹å†…çš„å…¶å®ƒçº¿ç¨‹é€šå¸¸å¯ç»§ç»­è¿è¡Œ&lt;/td&gt;
&lt;td&gt;âœ… è®¾è®¡è‰¯å¥½æ—¶å¯é¿å…æ•´ä¸ªè¿›ç¨‹é˜»å¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šå¤„ç†å™¨å¹¶è¡Œæ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ å›°éš¾ï¼Œè¿›ç¨‹çš„å¤šä¸ªçº¿ç¨‹æ— æ³•åŒæ—¶åœ¨å¤šä¸ªCPUæ ¸å¿ƒè¿è¡Œ&lt;/td&gt;
&lt;td&gt;âœ… è‰¯å¥½ï¼ŒåŒä¸€è¿›ç¨‹çš„å¤šä¸ªçº¿ç¨‹å¯è¢«è°ƒåº¦åˆ°ä¸åŒCPUæ ¸å¿ƒå¹¶è¡Œæ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;âœ… è‰¯å¥½ï¼Œå¤šä¸ªç”¨æˆ·çº¿ç¨‹å¯é€šè¿‡å¤šä¸ªå†…æ ¸çº¿ç¨‹åœ¨ä¸åŒCPUä¸Šè¿è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§/å¯æ§æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… é«˜ï¼Œåº”ç”¨ç¨‹åºå¯è‡ªå®šä¹‰è°ƒåº¦ç®—æ³•&lt;/td&gt;
&lt;td&gt;âŒ ä½ï¼Œç”±å†…æ ¸ç»Ÿä¸€è°ƒåº¦&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰ï¼Œéƒ¨åˆ†å¯æ§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹ä»£è¡¨æˆ–åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ—©æœŸçº¿ç¨‹åº“ã€æŸäº›è¯­è¨€åç¨‹ï¼ˆå¦‚æ—§ç‰ˆJavaç»¿è‰²çº¿ç¨‹ï¼‰&lt;/td&gt;
&lt;td&gt;ç°ä»£ä¸»æµOSï¼ˆWindows, Linux, macOSï¼‰çš„çº¿ç¨‹å®ç°&lt;/td&gt;
&lt;td&gt;Java HotSpot VM (Linuxç‰ˆ)ã€Solarisçº¿ç¨‹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰ç§å®ç°æ–¹å¼è¯¦è§£"&gt;ğŸ” ä¸‰ç§å®ç°æ–¹å¼è¯¦è§£
&lt;/h3&gt;&lt;h4 id="1-ç”¨æˆ·çº§çº¿ç¨‹-user-level-threads-ult"&gt;1. ç”¨æˆ·çº§çº¿ç¨‹ (User-Level Threads, ULT)
&lt;/h4&gt;&lt;p&gt;ç”¨æˆ·çº§çº¿ç¨‹&lt;strong&gt;å®Œå…¨åœ¨ç”¨æˆ·ç©ºé—´&lt;/strong&gt;é€šè¿‡&lt;strong&gt;çº¿ç¨‹åº“&lt;/strong&gt;ï¼ˆå¦‚è¿è¡Œæ—¶ç³»ç»Ÿï¼‰å®ç°å’Œç®¡ç†ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸å¹¶ä¸çŸ¥é“è¿™äº›çº¿ç¨‹çš„å­˜åœ¨ã€‚å†…æ ¸çœ‹åˆ°çš„ä»ç„¶åªæ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œå³**â€œå¤šçº¿ç¨‹æ¨¡å¼â€å¯¹å†…æ ¸æ˜¯é€æ˜çš„**ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åº”ç”¨ç¨‹åºé€šè¿‡çº¿ç¨‹åº“ä¸­çš„å‡½æ•°ï¼ˆå¦‚åˆ›å»ºã€é”€æ¯ã€åŒæ­¥ï¼‰æ¥ç®¡ç†æ‰€æœ‰çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹åº“è´Ÿè´£çº¿ç¨‹çš„è°ƒåº¦å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¿™äº›æ“ä½œéƒ½åœ¨&lt;strong&gt;ç”¨æˆ·æ€&lt;/strong&gt;å®Œæˆï¼Œ&lt;strong&gt;æ— éœ€é™·å…¥å†…æ ¸&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰ç”¨æˆ·çº§çº¿ç¨‹éƒ½æ˜ å°„åˆ°åŒä¸€ä¸ªå†…æ ¸è°ƒåº¦å®ä½“ï¼ˆé€šå¸¸æ˜¯å•ä¸ªå†…æ ¸çº§çº¿ç¨‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æé«˜æ•ˆçš„çº¿ç¨‹æ“ä½œ&lt;/strong&gt;ï¼šçº¿ç¨‹åˆ‡æ¢ã€åˆ›å»ºã€é”€æ¯æ— éœ€å†…æ ¸ä»‹å…¥ï¼Œå¼€é”€éå¸¸å°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå®šä¹‰è°ƒåº¦ç®—æ³•&lt;/strong&gt;ï¼šæ¯ä¸ªè¿›ç¨‹å¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚ä½¿ç”¨ä¸åŒçš„çº¿ç¨‹è°ƒåº¦ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ“ä½œç³»ç»Ÿæ— å…³&lt;/strong&gt;ï¼šåªè¦å®ç°äº†å¯¹åº”çš„çº¿ç¨‹åº“ï¼Œå³ä½¿æ“ä½œç³»ç»Ÿæœ¬èº«ä¸æ”¯æŒçº¿ç¨‹ï¼Œä¹Ÿèƒ½æä¾›å¤šçº¿ç¨‹èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;â€œä¸€æŸä¿±æŸâ€çš„é˜»å¡é—®é¢˜&lt;/strong&gt;ï¼šç”±äºå†…æ ¸ä¸çŸ¥é“ç”¨æˆ·çº¿ç¨‹çš„å­˜åœ¨ï¼Œ&lt;strong&gt;ä»»ä½•ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹å‘èµ·é˜»å¡å¼ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚I/Oæ“ä½œï¼‰å¯¼è‡´è‡ªèº«é˜»å¡æ—¶ï¼Œå†…æ ¸ä¼šé˜»å¡æ•´ä¸ªè¿›ç¨‹&lt;/strong&gt;ï¼Œä»è€Œé˜»å¡äº†è¯¥è¿›ç¨‹ä¸‹çš„æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹ï¼Œå³ä½¿å…¶å®ƒç”¨æˆ·çº¿ç¨‹å°±ç»ªä¹Ÿæ— æ³•è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš¾ä»¥åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨&lt;/strong&gt;ï¼šå†…æ ¸å§‹ç»ˆåªæŠŠä¸€ä¸ªCPUæ—¶é—´ç‰‡åˆ†é…ç»™è¿™ä¸ªè¿›ç¨‹ï¼ˆå³é‚£ä¸ªå”¯ä¸€çš„å†…æ ¸è°ƒåº¦å®ä½“ï¼‰ï¼Œå› æ­¤&lt;strong&gt;ä¸€ä¸ªè¿›ç¨‹çš„å¤šä¸ªç”¨æˆ·çº¿ç¨‹æ— æ³•çœŸæ­£åœ¨å¤šä¸ªCPUæ ¸å¿ƒä¸Šå¹¶è¡Œæ‰§è¡Œ&lt;/strong&gt;ï¼Œåªèƒ½å¹¶å‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-å†…æ ¸çº§çº¿ç¨‹-kernel-level-threads-klt"&gt;2. å†…æ ¸çº§çº¿ç¨‹ (Kernel-Level Threads, KLT)
&lt;/h4&gt;&lt;p&gt;å†…æ ¸çº§çº¿ç¨‹ç”±&lt;strong&gt;æ“ä½œç³»ç»Ÿå†…æ ¸ç›´æ¥ç®¡ç†&lt;/strong&gt;ã€‚çº¿ç¨‹çš„åˆ›å»ºã€é”€æ¯ã€è°ƒåº¦å’Œåˆ‡æ¢éƒ½ç”±å†…æ ¸è´Ÿè´£ã€‚åº”ç”¨ç¨‹åºé€šè¿‡&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;æ¥è¯·æ±‚å†…æ ¸å®Œæˆè¿™äº›æ“ä½œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å†…æ ¸ä¸ºæ¯ä¸ªçº¿ç¨‹ç»´æŠ¤ä¸€ä¸ª&lt;strong&gt;çº¿ç¨‹æ§åˆ¶å—ï¼ˆTCBï¼‰&lt;/strong&gt;ï¼Œç”¨æ¥è®°å½•çº¿ç¨‹çš„çŠ¶æ€ã€ä¸Šä¸‹æ–‡ç­‰ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹è°ƒåº¦ç”±å†…æ ¸çš„çº¿ç¨‹è°ƒåº¦å™¨å®Œæˆï¼Œæ˜¯ç³»ç»Ÿå…¨å±€è¡Œä¸ºã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹åˆ‡æ¢éœ€è¦ä»ç”¨æˆ·æ€é™·å…¥å†…æ ¸æ€ï¼Œç”±å†…æ ¸å®Œæˆä¸Šä¸‹æ–‡åˆ‡æ¢åå†è¿”å›ç”¨æˆ·æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ›´å¥½çš„å¹¶å‘æ€§&lt;/strong&gt;ï¼šå½“ä¸€ä¸ªçº¿ç¨‹é˜»å¡æ—¶ï¼ˆä¾‹å¦‚ç­‰å¾…I/Oï¼‰ï¼Œå†…æ ¸å¯ä»¥è°ƒåº¦åŒä¸€è¿›ç¨‹å†…çš„å…¶å®ƒå°±ç»ªçº¿ç¨‹è¿è¡Œï¼Œä¹Ÿå¯ä»¥è°ƒåº¦å…¶å®ƒè¿›ç¨‹çš„çº¿ç¨‹ï¼Œä¸ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸæ­£æ”¯æŒå¤šæ ¸å¹¶è¡Œ&lt;/strong&gt;ï¼šå†…æ ¸å¯ä»¥å°†ä¸€ä¸ªè¿›ç¨‹çš„å¤šä¸ªçº¿ç¨‹&lt;strong&gt;çœŸæ­£åŒæ—¶è°ƒåº¦åˆ°å¤šä¸ªCPUæ ¸å¿ƒä¸Šæ‰§è¡Œ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ“ä½œå¼€é”€è¾ƒå¤§&lt;/strong&gt;ï¼šæ¯æ¬¡çº¿ç¨‹æ“ä½œï¼ˆå¦‚åˆ›å»ºã€åˆ‡æ¢ï¼‰éƒ½éœ€è¦&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;ï¼Œå¯¼è‡´åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¹‹é—´åˆ‡æ¢ï¼Œå¼€é”€æ¯”ç”¨æˆ·çº§çº¿ç¨‹å¤§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»æ€§è¾ƒä½&lt;/strong&gt;ï¼šçº¿ç¨‹è°ƒåº¦ç”±å†…æ ¸å…¨å±€æ§åˆ¶ï¼Œåº”ç”¨ç¨‹åºæ— æ³•é’ˆå¯¹ç‰¹å®šéœ€æ±‚å®šåˆ¶è°ƒåº¦ç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-æ··åˆæ¨¡å‹-hybrid-model"&gt;3. æ··åˆæ¨¡å‹ (Hybrid Model)
&lt;/h4&gt;&lt;p&gt;ä¸ºäº†ç»“åˆç”¨æˆ·çº§çº¿ç¨‹çš„è½»é‡å’Œå†…æ ¸çº§çº¿ç¨‹çš„å¹¶å‘ä¼˜ç‚¹ï¼Œæå‡ºäº†æ··åˆæ¨¡å‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹&lt;strong&gt;å¹¶å­˜&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åº”ç”¨ç¨‹åºå¯ä»¥åˆ›å»ºå¤§é‡è½»é‡çš„ç”¨æˆ·çº§çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;è¿™äº›ç”¨æˆ·çº§çº¿ç¨‹è¢«&lt;strong&gt;å¤šè·¯å¤ç”¨&lt;/strong&gt;åˆ°æ•°é‡è¾ƒå°‘çš„å†…æ ¸çº§çº¿ç¨‹ï¼ˆé€šå¸¸ç§°ä¸º&lt;strong&gt;è½»é‡çº§è¿›ç¨‹ - LWP&lt;/strong&gt;ï¼‰ä¸Šã€‚&lt;/li&gt;
&lt;li&gt;å†…æ ¸åªçœ‹åˆ°å¹¶è°ƒåº¦è¿™äº›LWPï¼Œè€Œç”¨æˆ·çº§çº¿ç¨‹çš„è°ƒåº¦åˆ™ç”±çº¿ç¨‹åº“åœ¨ç”¨æˆ·ç©ºé—´å®Œæˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å–é•¿è¡¥çŸ­&lt;/strong&gt;ï¼šæ—¢èƒ½æ”¯æŒå¤§é‡ç”¨æˆ·çº§çº¿ç¨‹ï¼ˆè½»é‡ï¼‰ï¼Œåˆèƒ½é€šè¿‡å¤šä¸ªLWPé¿å…æ•´ä¸ªè¿›ç¨‹å› å•ä¸ªçº¿ç¨‹é˜»å¡è€Œé˜»å¡ï¼Œå¹¶èƒ½åˆ©ç”¨å¤šæ ¸å¹¶è¡Œï¼ˆå¤šä¸ªLWPå¯åœ¨ä¸åŒæ ¸å¿ƒè¿è¡Œï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»é…ç½®&lt;/strong&gt;ï¼šå¯ä»¥æ ¹æ®æœºå™¨CPUæ ¸å¿ƒæ•°å’Œåº”ç”¨ç‰¹ç‚¹ï¼ˆè®¡ç®—å¯†é›†å‹/I/Oå¯†é›†å‹ï¼‰è°ƒæ•´LWPçš„æ•°é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ç°å¤æ‚&lt;/strong&gt;ï¼šéœ€è¦çº¿ç¨‹åº“å’Œå†…æ ¸ååŒå·¥ä½œï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¦‚ä½•ç†è§£æ˜ å°„å…³ç³»å¤šå¯¹ä¸€ä¸€å¯¹ä¸€å¤šå¯¹å¤š"&gt;ğŸ§  å¦‚ä½•ç†è§£â€œæ˜ å°„å…³ç³»â€ï¼šå¤šå¯¹ä¸€ã€ä¸€å¯¹ä¸€ã€å¤šå¯¹å¤š
&lt;/h3&gt;&lt;p&gt;çº¿ç¨‹å®ç°æ¨¡å‹å¸¸é€šè¿‡ç”¨æˆ·çº¿ç¨‹ä¸å†…æ ¸çº¿ç¨‹çš„æ˜ å°„å…³ç³»æ¥æè¿°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šå¯¹ä¸€ (Many-to-One)&lt;/strong&gt;ï¼šå¤šä¸ªç”¨æˆ·çº¿ç¨‹æ˜ å°„åˆ°ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ã€‚è¿™&lt;strong&gt;å°±æ˜¯çº¯ç”¨æˆ·çº§çº¿ç¨‹æ¨¡å‹&lt;/strong&gt;ã€‚å®ƒè½»é‡ï¼Œä½†ä¼šé‡åˆ°é˜»å¡å’Œæ— æ³•å¤šæ ¸å¹¶è¡Œçš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€å¯¹ä¸€ (One-to-One)&lt;/strong&gt;ï¼šä¸€ä¸ªç”¨æˆ·çº¿ç¨‹æ˜ å°„åˆ°ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ã€‚è¿™&lt;strong&gt;å°±æ˜¯çº¯å†…æ ¸çº§çº¿ç¨‹æ¨¡å‹&lt;/strong&gt;ã€‚å®ƒé¿å…äº†é˜»å¡é—®é¢˜ï¼Œæ”¯æŒå¤šæ ¸å¹¶è¡Œï¼Œä½†çº¿ç¨‹æ“ä½œå¼€é”€å¤§ï¼Œä¸”åˆ›å»ºçº¿ç¨‹æ•°é‡å—å†…æ ¸é™åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šå¯¹å¤š (Many-to-Many)&lt;/strong&gt;ï¼šå¤šä¸ªç”¨æˆ·çº¿ç¨‹æ˜ å°„åˆ°å¤šä¸ªï¼ˆæ•°é‡å¯ç›¸ç­‰æˆ–æ›´å°‘ï¼‰å†…æ ¸çº¿ç¨‹ã€‚è¿™&lt;strong&gt;å°±æ˜¯æ··åˆæ¨¡å‹&lt;/strong&gt;ã€‚å®ƒå…¼å…·äº†ä¸¤è€…çš„ä¼˜ç‚¹ï¼Œæ—¢è½»é‡ï¼Œå¹¶å‘æ€§åˆå¥½ï¼Œæ˜¯ç°ä»£ç³»ç»Ÿè¿½æ±‚çš„æ–¹å‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç°ä»£æ“ä½œç³»ç»Ÿä¸­çš„å®è·µ"&gt;ğŸ’¡ ç°ä»£æ“ä½œç³»ç»Ÿä¸­çš„å®è·µ
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»æµæ“ä½œç³»ç»Ÿ&lt;/strong&gt;ï¼šç°ä»£é€šç”¨æ“ä½œç³»ç»Ÿå¦‚ &lt;strong&gt;Windows&lt;/strong&gt;ã€&lt;strong&gt;Linux&lt;/strong&gt; å’Œ &lt;strong&gt;macOS&lt;/strong&gt;ï¼Œå…¶&lt;strong&gt;åŸç”Ÿçš„çº¿ç¨‹å®ç°æ™®éé‡‡ç”¨ä¸€å¯¹ä¸€æ¨¡å‹ï¼ˆå†…æ ¸çº§çº¿ç¨‹ï¼‰&lt;/strong&gt;ã€‚ä½ é€šè¿‡ &lt;code&gt;pthread_create&lt;/code&gt;(POSIX) æˆ– &lt;code&gt;CreateThread&lt;/code&gt;(Windows) åˆ›å»ºçš„çº¿ç¨‹ï¼Œå°±æ˜¯å†…æ ¸çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–ç¨‹è¯­è¨€çš„è¿è¡Œæ—¶&lt;/strong&gt;ï¼šè®¸å¤šè¯­è¨€çš„è™šæ‹Ÿæœºæˆ–è¿è¡Œæ—¶ç¯å¢ƒï¼ˆå¦‚ &lt;strong&gt;Java Virtual Machine (JVM)&lt;/strong&gt;ã€&lt;strong&gt;Go runtime&lt;/strong&gt;ï¼‰ä¼šé‡‡ç”¨&lt;strong&gt;æ··åˆæ¨¡å‹çš„æ€æƒ³&lt;/strong&gt;ã€‚å®ƒä»¬åœ¨ç”¨æˆ·ç©ºé—´ç®¡ç†ç€è‡ªå·±æ›´è½»é‡çš„â€œçº¿ç¨‹â€ï¼ˆåœ¨Goä¸­å«Goroutineï¼Œåœ¨Javaä¸­ï¼ŒJVMçº¿ç¨‹æ¨¡å‹åœ¨ä¸åŒå¹³å°æœ‰å·®å¼‚ï¼Œä¾‹å¦‚åœ¨Linuxä¸ŠHotSpot VMä½¿ç”¨äº†ä¸€å¯¹ä¸€æ¨¡å‹ï¼Œä½†å…¶æ–°çš„çº¤ç¨‹é¡¹ç›®Loomæ—¨åœ¨å¼•å…¥æ›´è½»é‡çš„ç”¨æˆ·çº¿ç¨‹ï¼‰ï¼Œå¹¶å°†å…¶è°ƒåº¦åˆ°æ•°é‡æœ‰é™çš„å†…æ ¸çº¿ç¨‹ï¼ˆçº¿ç¨‹æ± ï¼‰ä¸Šæ‰§è¡Œã€‚è¿™ä½¿å¾—å®ƒä»¬å¯ä»¥æ”¯æŒæé«˜æ•°é‡çš„å¹¶å‘ä»»åŠ¡ï¼Œè€Œä¸è¿‡åˆ†æ¶ˆè€—å†…æ ¸èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›ä»¥ä¸Šè§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°ç†è§£æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„ä¸åŒå®ç°æ–¹å¼åŠå…¶èƒŒåçš„æƒè¡¡ã€‚&lt;/p&gt;
&lt;h2 id="å®ä¾‹åŒ–é¡ºåº"&gt;å®ä¾‹åŒ–é¡ºåº
&lt;/h2&gt;&lt;p&gt;ã€‚ç†è§£ Java ä¸­æ„é€ å‡½æ•°å’Œå˜é‡çš„åˆå§‹åŒ–é¡ºåºå¯¹ç¼–å†™å¯é ä»£ç å¾ˆé‡è¦ã€‚å®ƒéµå¾ªä¸€ä¸ªå›ºå®šçš„å±‚çº§é¡ºåºï¼š&lt;strong&gt;ä»é™æ€åˆ°å®ä¾‹ï¼Œä»çˆ¶ç±»åˆ°å­ç±»&lt;/strong&gt;ã€‚ä¸‹é¢è¿™å¼ æ—¶åºå›¾å¯ä»¥å¸®ä½ ç›´è§‚åœ°æŠŠæ¡å¯¹è±¡åˆ›å»ºå’Œåˆå§‹åŒ–çš„å®Œæ•´æµç¨‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;sequenceDiagram
participant JVM
participant ChildClass
participant ParentClass
participant StaticBlocks
Note over JVM: ç¬¬ä¸€æ¬¡åŠ è½½ç±»æ—¶ï¼ˆä¸€æ¬¡æ€§çš„ï¼‰
JVM-&amp;gt;&amp;gt;StaticBlocks: æ‰§è¡Œçˆ¶ç±»é™æ€å˜é‡/é™æ€å—
JVM-&amp;gt;&amp;gt;StaticBlocks: æ‰§è¡Œå­ç±»é™æ€å˜é‡/é™æ€å—
Note over JVM: æ¯æ¬¡ new ChildClass() æ—¶
JVM-&amp;gt;&amp;gt;ParentClass: åˆ†é…å†…å­˜ç©ºé—´ï¼ˆå †ï¼‰
JVM-&amp;gt;&amp;gt;ParentClass: åˆå§‹åŒ–çˆ¶ç±»å®ä¾‹å˜é‡/æ‰§è¡Œå®ä¾‹å—
JVM-&amp;gt;&amp;gt;ParentClass: æ‰§è¡Œçˆ¶ç±»æ„é€ å‡½æ•°ä½“
JVM-&amp;gt;&amp;gt;ChildClass: åˆå§‹åŒ–å­ç±»å®ä¾‹å˜é‡/æ‰§è¡Œå®ä¾‹å—
JVM-&amp;gt;&amp;gt;ChildClass: æ‰§è¡Œå­ç±»æ„é€ å‡½æ•°ä½“
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸Šå›¾å±•ç¤ºäº†å¯¹è±¡åˆ›å»ºçš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼Œå…¶æ ¸å¿ƒçš„åˆå§‹åŒ–é¡ºåºå¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çˆ¶ç±»é™æ€æˆå‘˜åˆå§‹åŒ–&lt;/strong&gt;ï¼ˆä»…é¦–æ¬¡åŠ è½½æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰
&lt;ul&gt;
&lt;li&gt;çˆ¶ç±»é™æ€å˜é‡èµ‹é»˜è®¤å€¼ï¼ˆ0, false, nullç­‰ï¼‰&lt;/li&gt;
&lt;li&gt;çˆ¶ç±»é™æ€å˜é‡æ˜¾å¼èµ‹å€¼åŠé™æ€åˆå§‹åŒ–å—ï¼ˆæŒ‰ä»£ç ä¹¦å†™é¡ºåºæ‰§è¡Œï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­ç±»é™æ€æˆå‘˜åˆå§‹åŒ–&lt;/strong&gt;ï¼ˆä»…é¦–æ¬¡åŠ è½½æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰
&lt;ul&gt;
&lt;li&gt;å­ç±»é™æ€å˜é‡èµ‹é»˜è®¤å€¼&lt;/li&gt;
&lt;li&gt;å­ç±»é™æ€å˜é‡æ˜¾å¼èµ‹å€¼åŠé™æ€åˆå§‹åŒ–å—ï¼ˆæŒ‰ä»£ç ä¹¦å†™é¡ºåºæ‰§è¡Œï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çˆ¶ç±»å®ä¾‹æˆå‘˜åˆå§‹åŒ–&lt;/strong&gt;ï¼ˆæ¯æ¬¡å®ä¾‹åŒ–æ—¶æ‰§è¡Œï¼‰
&lt;ul&gt;
&lt;li&gt;çˆ¶ç±»å®ä¾‹å˜é‡èµ‹é»˜è®¤å€¼&lt;/li&gt;
&lt;li&gt;çˆ¶ç±»å®ä¾‹å˜é‡æ˜¾å¼èµ‹å€¼åŠå®ä¾‹åˆå§‹åŒ–å—ï¼ˆæŒ‰ä»£ç ä¹¦å†™é¡ºåºæ‰§è¡Œï¼‰&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œçˆ¶ç±»æ„é€ å‡½æ•°ä½“&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­ç±»å®ä¾‹æˆå‘˜åˆå§‹åŒ–&lt;/strong&gt;ï¼ˆæ¯æ¬¡å®ä¾‹åŒ–æ—¶æ‰§è¡Œï¼‰
&lt;ul&gt;
&lt;li&gt;å­ç±»å®ä¾‹å˜é‡èµ‹é»˜è®¤å€¼&lt;/li&gt;
&lt;li&gt;å­ç±»å®ä¾‹å˜é‡æ˜¾å¼èµ‹å€¼åŠå®ä¾‹åˆå§‹åŒ–å—ï¼ˆæŒ‰ä»£ç ä¹¦å†™é¡ºåºæ‰§è¡Œï¼‰&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œå­ç±»æ„é€ å‡½æ•°ä½“&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-ä»£ç ç¤ºä¾‹-1"&gt;ğŸ” ä»£ç ç¤ºä¾‹
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;class Parent {
// é™æ€å˜é‡
static String staticFieldParent = staticMethodParent(&amp;#34;çˆ¶ç±»é™æ€å˜é‡&amp;#34;);
// é™æ€åˆå§‹åŒ–å—
static {
System.out.println(&amp;#34;çˆ¶ç±»é™æ€åˆå§‹åŒ–å—&amp;#34;);
}
// å®ä¾‹å˜é‡
String instanceFieldParent = instanceMethodParent(&amp;#34;çˆ¶ç±»å®ä¾‹å˜é‡&amp;#34;);
// å®ä¾‹åˆå§‹åŒ–å—
{
System.out.println(&amp;#34;çˆ¶ç±»å®ä¾‹åˆå§‹åŒ–å—&amp;#34;);
}
// çˆ¶ç±»æ„é€ å‡½æ•°
public Parent() {
System.out.println(&amp;#34;çˆ¶ç±»æ„é€ å‡½æ•°&amp;#34;);
}
// é™æ€æ–¹æ³•
static String staticMethodParent(String msg) {
System.out.println(msg);
return msg;
}
// å®ä¾‹æ–¹æ³•
String instanceMethodParent(String msg) {
System.out.println(msg);
return msg;
}
}
class Child extends Parent {
// é™æ€å˜é‡
static String staticFieldChild = staticMethodChild(&amp;#34;å­ç±»é™æ€å˜é‡&amp;#34;);
// é™æ€åˆå§‹åŒ–å—
static {
System.out.println(&amp;#34;å­ç±»é™æ€åˆå§‹åŒ–å—&amp;#34;);
}
// å®ä¾‹å˜é‡
String instanceFieldChild = instanceMethodChild(&amp;#34;å­ç±»å®ä¾‹å˜é‡&amp;#34;);
// å®ä¾‹åˆå§‹åŒ–å—
{
System.out.println(&amp;#34;å­ç±»å®ä¾‹åˆå§‹åŒ–å—&amp;#34;);
}
// å­ç±»æ„é€ å‡½æ•°
public Child() {
System.out.println(&amp;#34;å­ç±»æ„é€ å‡½æ•°&amp;#34;);
}
// é™æ€æ–¹æ³•
static String staticMethodChild(String msg) {
System.out.println(msg);
return msg;
}
// å®ä¾‹æ–¹æ³•
String instanceMethodChild(String msg) {
System.out.println(msg);
return msg;
}
}
public class Main {
public static void main(String[] args) {
System.out.println(&amp;#34;ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–å­ç±»:&amp;#34;);
new Child();
System.out.println(&amp;#34;\nç¬¬äºŒæ¬¡å®ä¾‹åŒ–å­ç±»:&amp;#34;);
new Child();
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¾“å‡ºç»“æœ&lt;/strong&gt;:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–å­ç±»:
çˆ¶ç±»é™æ€å˜é‡
çˆ¶ç±»é™æ€åˆå§‹åŒ–å—
å­ç±»é™æ€å˜é‡
å­ç±»é™æ€åˆå§‹åŒ–å—
çˆ¶ç±»å®ä¾‹å˜é‡
çˆ¶ç±»å®ä¾‹åˆå§‹åŒ–å—
çˆ¶ç±»æ„é€ å‡½æ•°
å­ç±»å®ä¾‹å˜é‡
å­ç±»å®ä¾‹åˆå§‹åŒ–å—
å­ç±»æ„é€ å‡½æ•°
ç¬¬äºŒæ¬¡å®ä¾‹åŒ–å­ç±»:
çˆ¶ç±»å®ä¾‹å˜é‡
çˆ¶ç±»å®ä¾‹åˆå§‹åŒ–å—
çˆ¶ç±»æ„é€ å‡½æ•°
å­ç±»å®ä¾‹å˜é‡
å­ç±»å®ä¾‹åˆå§‹åŒ–å—
å­ç±»æ„é€ å‡½æ•°
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é™æ€éƒ¨åˆ†&lt;/strong&gt;ï¼ˆå˜é‡å’Œåˆå§‹åŒ–å—ï¼‰åªåœ¨&lt;strong&gt;ç±»ç¬¬ä¸€æ¬¡åŠ è½½æ—¶æ‰§è¡Œä¸€æ¬¡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶ï¼Œ&lt;strong&gt;å®ä¾‹éƒ¨åˆ†&lt;/strong&gt;ï¼ˆå˜é‡ã€åˆå§‹åŒ–å—å’Œæ„é€ å‡½æ•°ï¼‰éƒ½ä¼šæ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;é¡ºåºä¸¥æ ¼éµå¾ªï¼š&lt;strong&gt;çˆ¶ç±»é™æ€ â†’ å­ç±»é™æ€ â†’ çˆ¶ç±»å®ä¾‹ â†’ çˆ¶ç±»æ„é€  â†’ å­ç±»å®ä¾‹ â†’ å­ç±»æ„é€ &lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å…³é”®è§„åˆ™ä¸æ³¨æ„äº‹é¡¹"&gt;ğŸ’¡ å…³é”®è§„åˆ™ä¸æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é™æ€ä¼˜å…ˆï¼Œçˆ¶ç±»ä¼˜å…ˆ&lt;/strong&gt;ï¼šé™æ€æˆå‘˜åˆå§‹åŒ–ä¼˜å…ˆäºå®ä¾‹æˆå‘˜ï¼Œçˆ¶ç±»æˆå‘˜åˆå§‹åŒ–ä¼˜å…ˆäºå­ç±»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºæ‰§è¡Œ&lt;/strong&gt;ï¼šåŒä¸€çº§åˆ«çš„åˆå§‹åŒ–ï¼ˆå¦‚ä¸¤ä¸ªé™æ€åˆå§‹åŒ–å—æˆ–ä¸¤ä¸ªå®ä¾‹å˜é‡ï¼‰ä¸¥æ ¼æŒ‰ç…§åœ¨ä»£ç ä¸­çš„&lt;strong&gt;å®šä¹‰é¡ºåº&lt;/strong&gt;æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤æ„é€ å‡½æ•°&lt;/strong&gt;ï¼šå¦‚æœä¸€ä¸ªç±»æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æä¾›ä¸€ä¸ªæ— å‚çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚å¦‚æœå®šä¹‰äº†å¸¦å‚æ„é€ å‡½æ•°ï¼Œæœ€å¥½ä¹Ÿæ˜¾å¼å®šä¹‰æ— å‚æ„é€ å‡½æ•°ï¼Œä»¥å…å­ç±»æˆ–åå°„è°ƒç”¨æ—¶å‡ºé”™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°&lt;/strong&gt;ï¼šå­ç±»æ„é€ å‡½æ•°çš„ç¬¬ä¸€è¡Œå¿…é¡»é€šè¿‡ &lt;code&gt;super(...)&lt;/code&gt;æ˜¾å¼è°ƒç”¨çˆ¶ç±»çš„æŸä¸ªæ„é€ å‡½æ•°ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šå°è¯•éšå¼è°ƒç”¨çˆ¶ç±»çš„æ— å‚æ„é€ å‡½æ•° &lt;code&gt;super()&lt;/code&gt;ã€‚å¦‚æœçˆ¶ç±»æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é€’å½’è°ƒç”¨&lt;/strong&gt;ï¼šåœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ &lt;code&gt;this(...)&lt;/code&gt;è°ƒç”¨åŒç±»å…¶ä»–æ„é€ å‡½æ•°æ—¶ï¼Œè¦é¿å…å½¢æˆé€’å½’è°ƒç”¨é“¾ï¼Œå¯¼è‡´æ ˆæº¢å‡ºã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¸¸è§è¯¯åŒº"&gt;âš ï¸ å¸¸è§è¯¯åŒº
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å˜é‡åˆå§‹åŒ–ä¸æ„é€ å‡½æ•°&lt;/strong&gt;ï¼šæ‰€æœ‰å®ä¾‹å˜é‡ï¼ˆåŒ…æ‹¬æ˜¾å¼èµ‹å€¼å’Œå®ä¾‹å—ï¼‰çš„åˆå§‹åŒ–éƒ½åœ¨æ„é€ å‡½æ•°ä½“æ‰§è¡Œ&lt;strong&gt;ä¹‹å‰&lt;/strong&gt;å®Œæˆã€‚æ„é€ å‡½æ•°ä¸­çš„èµ‹å€¼æ˜¯â€œå†æ¬¡èµ‹å€¼â€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— å‚æ„é€ å‡½æ•°çš„ä¸¢å¤±&lt;/strong&gt;ï¼šå¦‚æœä½ ä¸ºä¸€ä¸ªç±»å®šä¹‰äº†å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨å°±ä¸å†æä¾›é»˜è®¤çš„æ— å‚æ„é€ å‡½æ•°ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ–å¤±è´¥ï¼ˆå¦‚æœå­ç±»æ²¡æœ‰æ˜¾å¼è°ƒç”¨çˆ¶ç±»çš„æœ‰å‚æ„é€ å‡½æ•°ï¼‰æˆ–åå°„åˆ›å»ºå®ä¾‹å¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šå’Œç¤ºä¾‹èƒ½å¸®åŠ©ä½ å½»åº•ç†è§£ Java çš„åˆå§‹åŒ–é¡ºåºã€‚&lt;/p&gt;
&lt;h2 id="arraysaslist"&gt;Arrays.asList
&lt;/h2&gt;&lt;p&gt;Arrays.asList() æ˜¯ Java ä¸­ä¸€ä¸ªéå¸¸æ–¹ä¾¿ä½†å®¹æ˜“è¸©å‘çš„å·¥å…·æ–¹æ³•ï¼Œç”¨äºå°†æ•°ç»„è½¬æ¢ä¸º List é›†åˆã€‚ä¸ºäº†å¸®ä½ å¿«é€ŸæŠŠæ¡å®ƒçš„æ ¸å¿ƒç‰¹æ€§ã€ä½¿ç”¨åœºæ™¯å’Œéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œæˆ‘ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æ±‡æ€»ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;Arrays.asList() çš„è¡Œä¸º&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›çš„ List ç±»å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;java.util.Arrays.ArrayList&lt;/code&gt;(ä¸€ä¸ªå›ºå®šå¤§å°çš„å†…éƒ¨ç±»ï¼Œ&lt;strong&gt;ä¸æ˜¯&lt;/strong&gt; &lt;code&gt;java.util.ArrayList&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤§å°æ˜¯å¦å¯å˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ &lt;strong&gt;å›ºå®šå¤§å°&lt;/strong&gt;ï¼Œä¸å¯æ·»åŠ  (&lt;code&gt;add&lt;/code&gt;) æˆ–åˆ é™¤ (&lt;code&gt;remove&lt;/code&gt;) å…ƒç´ ï¼Œå¦åˆ™æŠ›å‡º &lt;code&gt;UnsupportedOperationException&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒç´ æ˜¯å¦å¯ä¿®æ”¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;å¯ä»¥ä¿®æ”¹&lt;/strong&gt; (é€šè¿‡ &lt;code&gt;set&lt;/code&gt;æ–¹æ³•)ï¼Œä¿®æ”¹ä¼šç›´æ¥å½±å“åŸå§‹æ•°ç»„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸åŸå§‹æ•°ç»„çš„å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;åŒå‘ç»‘å®š&lt;/strong&gt;ï¼šå¯¹åˆ—è¡¨å…ƒç´ çš„ä¿®æ”¹ä¼šåæ˜ åˆ°åŸå§‹æ•°ç»„ä¸Šï¼Œå¯¹åŸå§‹æ•°ç»„çš„ä¿®æ”¹ä¹Ÿä¼šåæ˜ åˆ°åˆ—è¡¨ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ”¯æŒçš„æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;å¯¹è±¡æ•°ç»„&lt;/strong&gt; (å¦‚ &lt;code&gt;String[]&lt;/code&gt;, &lt;code&gt;Integer[]&lt;/code&gt;) âŒ &lt;strong&gt;åŸºæœ¬ç±»å‹æ•°ç»„&lt;/strong&gt; (å¦‚ &lt;code&gt;int[]&lt;/code&gt;, &lt;code&gt;double[]&lt;/code&gt;)ï¼Œä¼šè¢«è§†ä¸ºå•ä¸ªå…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;ä½&lt;/strong&gt;ï¼Œè¿”å›çš„åˆ—è¡¨ç›´æ¥åŒ…è£…åŸå§‹æ•°ç»„ï¼Œä¸å¤åˆ¶å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹å®ƒçš„å…·ä½“ä½¿ç”¨å’Œæ³¨æ„äº‹é¡¹ã€‚&lt;/p&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§ä¸å¸¸è§ç”¨æ³•"&gt;ğŸ“Œ æ ¸å¿ƒç‰¹æ€§ä¸å¸¸è§ç”¨æ³•
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ–¹æ³•ç­¾å&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public static &amp;lt;T&amp;gt; List&amp;lt;T&amp;gt; asList(T... a)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;1. åŸºç¡€ä½¿ç”¨ï¼šè½¬æ¢å¯¹è±¡æ•°ç»„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äº&lt;code&gt;String[]&lt;/code&gt;, &lt;code&gt;Integer[]&lt;/code&gt;è¿™ç±»&lt;strong&gt;å¯¹è±¡æ•°ç»„&lt;/strong&gt;ï¼Œ&lt;code&gt;Arrays.asList()&lt;/code&gt;ä¼šå°†å…¶å…ƒç´ è½¬æ¢ä¸ºåˆ—è¡¨å…ƒç´ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] strArray = {&amp;#34;Apple&amp;#34;, &amp;#34;Banana&amp;#34;, &amp;#34;Cherry&amp;#34;};
List&amp;lt;String&amp;gt; strList = Arrays.asList(strArray);
System.out.println(strList); // è¾“å‡º: [Apple, Banana, Cherry]
// ä¹Ÿå¯ä»¥ç›´æ¥ä¼ å…¥å…ƒç´ 
List&amp;lt;String&amp;gt; list = Arrays.asList(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;);
System.out.println(list); // è¾“å‡º: [A, B, C]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;2. ä¿®æ”¹å…ƒç´ ï¼ˆå…è®¸ä¸”ä¼šå½±å“åŸå§‹æ•°ç»„ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;set&lt;/code&gt;æ–¹æ³•ä¿®æ”¹åˆ—è¡¨ä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸”è¿™ä¸ªä¿®æ”¹ä¼š&lt;strong&gt;ç›´æ¥åæ˜ åˆ°åŸå§‹çš„æ•°ç»„&lt;/strong&gt;ä¸Šã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] arr = {&amp;#34;Apple&amp;#34;, &amp;#34;Banana&amp;#34;};
List&amp;lt;String&amp;gt; list = Arrays.asList(arr);
// ä¿®æ”¹åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
list.set(0, &amp;#34;Orange&amp;#34;);
System.out.println(list); // è¾“å‡º: [Orange, Banana]
System.out.println(arr[0]); // è¾“å‡º: Orange (åŸå§‹æ•°ç»„ä¹Ÿè¢«ä¿®æ”¹äº†)
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-é‡è¦æ³¨æ„äº‹é¡¹ä¸å‘"&gt;âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹ä¸â€œå‘â€
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;1. åˆ—è¡¨å¤§å°å›ºå®šï¼Œä¸å¯å¢åˆ &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Arrays.asList()&lt;/code&gt;è¿”å›çš„åˆ—è¡¨åŸºäºåŸå§‹æ•°ç»„ï¼Œå› æ­¤å¤§å°æ˜¯&lt;strong&gt;å›ºå®š&lt;/strong&gt;çš„ã€‚ä»»ä½•å°è¯•æ·»åŠ æˆ–åˆ é™¤å…ƒç´ çš„æ“ä½œéƒ½ä¼šå¯¼è‡´ &lt;code&gt;UnsupportedOperationException&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; list = Arrays.asList(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;);
// list.add(&amp;#34;C&amp;#34;); // âŒ æŠ›å‡º UnsupportedOperationException
// list.remove(0); // âŒ æŠ›å‡º UnsupportedOperationException
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ğŸ’¡ è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šå¦‚æœéœ€è¦å¯å˜åˆ—è¡¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;code&gt;ArrayList&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; mutableList = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;));
mutableList.add(&amp;#34;C&amp;#34;); // âœ… ç°åœ¨å¯ä»¥æ­£å¸¸æ·»åŠ äº†
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;2. åŸºæœ¬ç±»å‹æ•°ç»„çš„é™·é˜±&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä¼ å…¥ä¸€ä¸ªåŸºæœ¬ç±»å‹ï¼ˆå¦‚ &lt;code&gt;int[]&lt;/code&gt;, &lt;code&gt;double[]&lt;/code&gt;ï¼‰çš„æ•°ç»„ï¼Œæ•´ä¸ªæ•°ç»„ä¼šè¢«è§†ä¸º&lt;strong&gt;å•ä¸ªå¯¹è±¡&lt;/strong&gt;ä½œä¸ºåˆ—è¡¨çš„ä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸æ˜¯å°†æ•°ç»„ä¸­çš„æ¯ä¸ªåŸºæœ¬ç±»å‹å€¼è½¬æ¢ä¸ºåˆ—è¡¨å…ƒç´ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int[] intArray = {1, 2, 3};
List&amp;lt;int[]&amp;gt; list = Arrays.asList(intArray); // æ³¨æ„ï¼šè¿™é‡Œæ˜¯ List&amp;lt;int[]&amp;gt;ï¼Œè€Œä¸æ˜¯ List&amp;lt;Integer&amp;gt;
System.out.println(list.size()); // è¾“å‡º: 1 (åˆ—è¡¨é‡Œåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå°±æ˜¯æ•´ä¸ªintArrayæ•°ç»„)
System.out.println(Arrays.toString(list.get(0))); // è¾“å‡º: [1, 2, 3]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ğŸ’¡ è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šä½¿ç”¨&lt;strong&gt;åŒ…è£…ç±»å‹æ•°ç»„&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Integer[] integerArray = {1, 2, 3};
List&amp;lt;Integer&amp;gt; list = Arrays.asList(integerArray); // âœ… æ­£ç¡®ï¼šList&amp;lt;Integer&amp;gt;
System.out.println(list.size()); // è¾“å‡º: 3
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…åœ¨ Java 8 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œä½¿ç”¨ Stream API è½¬æ¢ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int[] intArray = {1, 2, 3};
List&amp;lt;Integer&amp;gt; list = Arrays.stream(intArray).boxed().collect(Collectors.toList());
System.out.println(list); // è¾“å‡º: [1, 2, 3]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;3. è¿”å›çš„åˆ—è¡¨ç”±åŸå§‹æ•°ç»„æ”¯æŒ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ„å‘³ç€å¯¹åˆ—è¡¨å…ƒç´ çš„ä¿®æ”¹ä¼šå½±å“åŸå§‹æ•°ç»„ï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æœ‰æ—¶å¯èƒ½ä¸æ˜¯ä½ é¢„æœŸçš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] arr = {&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;};
List&amp;lt;String&amp;gt; list = Arrays.asList(arr);
arr[0] = &amp;#34;Z&amp;#34;; // ä¿®æ”¹åŸå§‹æ•°ç»„
System.out.println(list); // è¾“å‡º: [Z, B, C] (åˆ—è¡¨ä¹Ÿè·Ÿç€å˜äº†)
list.set(1, &amp;#34;Y&amp;#34;); // ä¿®æ”¹åˆ—è¡¨
System.out.println(Arrays.toString(arr)); // è¾“å‡º: [Z, Y, C] (åŸå§‹æ•°ç»„ä¹Ÿè·Ÿç€å˜äº†)
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-ä¸»è¦åº”ç”¨åœºæ™¯"&gt;ğŸ¯ ä¸»è¦åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¿«é€Ÿåˆ›å»ºå›ºå®šå¤§å°çš„åˆ—è¡¨&lt;/strong&gt;ï¼šé€‚ç”¨äºåˆå§‹åŒ–ä¸€äº›å¸¸é‡æˆ–æµ‹è¯•æ•°æ®ï¼Œå¹¶ä¸”åç»­ä¸éœ€è¦æ”¹å˜åˆ—è¡¨å¤§å°ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; names = Arrays.asList(&amp;#34;Alice&amp;#34;, &amp;#34;Bob&amp;#34;, &amp;#34;Charlie&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœŸæœ›æ¥æ”¶ List çš„ API&lt;/strong&gt;ï¼šå½“æŸä¸ªæ–¹æ³•æ¥æ”¶ &lt;code&gt;List&lt;/code&gt;ç±»å‹å‚æ•°ï¼Œè€Œä½ æ‰‹å¤´æ˜¯æ•°ç»„æ—¶ï¼Œå¯ä»¥å¿«é€Ÿè½¬æ¢ï¼ˆç¡®ä¿åç»­ä¸ä¼šè¯•å›¾ä¿®æ”¹å¤§å°ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®ç°æ•°ç»„å’Œé›†åˆçš„è”åˆè§†å›¾&lt;/strong&gt;ï¼šåˆ©ç”¨å…¶ä¸åŸå§‹æ•°ç»„çš„â€œåŒå‘ç»‘å®šâ€ç‰¹æ€§ï¼Œæœ‰æ—¶å¯ä»¥æ–¹ä¾¿æ“ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“ä¸æœ€ä½³å®è·µ"&gt;ğŸ“– æ€»ç»“ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Arrays.asList()&lt;/code&gt;æ˜¯ä¸€ä¸ªä¾¿æ·çš„æ¡¥æ¢ï¼Œç”¨äºæ•°ç»„åˆ°åˆ—è¡¨çš„è½¬æ¢ï¼Œä½†å…¶&lt;strong&gt;å›ºå®šå¤§å°&lt;/strong&gt;å’Œ&lt;strong&gt;åŒå‘ç»‘å®š&lt;/strong&gt;çš„ç‰¹æ€§éœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ä½ éœ€è¦ä¸€ä¸ª&lt;strong&gt;åªè¯»ã€ä¸æ”¹å˜å¤§å°&lt;/strong&gt;çš„åˆ—è¡¨è§†å›¾æ—¶ï¼Œç›´æ¥ä½¿ç”¨ &lt;code&gt;Arrays.asList()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å½“ä½ éœ€è¦ä¸€å€‹&lt;strong&gt;å¯å¢åˆ å…ƒç´ &lt;/strong&gt;çš„åˆ—è¡¨æ—¶ï¼Œä½¿ç”¨ &lt;code&gt;new ArrayList&amp;lt;&amp;gt;(Arrays.asList(...))&lt;/code&gt;åŒ…è£…ä¸€ä¸‹ã€‚&lt;/li&gt;
&lt;li&gt;å¤„ç†&lt;strong&gt;åŸºæœ¬ç±»å‹æ•°ç»„&lt;/strong&gt;æ—¶ï¼Œè®°å¾—ä½¿ç”¨&lt;strong&gt;åŒ…è£…ç±»å‹æ•°ç»„&lt;/strong&gt;æˆ– &lt;strong&gt;Stream API&lt;/strong&gt; æ¥é¿å…é™·é˜±ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ Java 9+ ä¸­ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ &lt;code&gt;List.of(...)&lt;/code&gt;æ¥åˆ›å»º&lt;strong&gt;ä¸å¯å˜åˆ—è¡¨&lt;/strong&gt;ï¼Œå®ƒä¸åŸå§‹æ•°ç»„æ²¡æœ‰ç»‘å®šå…³ç³»ï¼Œä½†åŒæ ·ä¸èƒ½ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ &lt;code&gt;Arrays.asList()&lt;/code&gt;ï¼&lt;/p&gt;
&lt;h2 id="sleep--wait"&gt;sleep &amp;amp; wait
&lt;/h2&gt;&lt;p&gt;äº†è§£ &lt;code&gt;sleep()&lt;/code&gt;å’Œ &lt;code&gt;wait()&lt;/code&gt;çš„åŒºåˆ«å¯¹ç¼–å†™æ­£ç¡®çš„å¤šçº¿ç¨‹ç¨‹åºè‡³å…³é‡è¦ã€‚è™½ç„¶å®ƒä»¬éƒ½èƒ½æš‚åœçº¿ç¨‹ï¼Œä½†è®¾è®¡å’Œç”¨é€”æˆªç„¶ä¸åŒã€‚ä¸ºäº†å¸®ä½ å¿«é€Ÿå»ºç«‹ä¸€ä¸ªå…¨å±€å°è±¡ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ¥å¯¹æ¯”å®ƒä»¬çš„æ ¸å¿ƒç‰¹æ€§ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;code&gt;Thread.sleep()&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;Object.wait()&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰€å±ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Thread&lt;/code&gt;ç±»çš„&lt;strong&gt;é™æ€æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Object&lt;/code&gt;ç±»çš„&lt;strong&gt;å®ä¾‹æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”é‡Šæ”¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ &lt;strong&gt;ä¸ä¼šé‡Šæ”¾&lt;/strong&gt;ä»»ä½•æŒæœ‰çš„é”&lt;/td&gt;
&lt;td&gt;âœ… &lt;strong&gt;ç«‹å³é‡Šæ”¾&lt;/strong&gt;å…¶æŒæœ‰çš„é”ï¼Œå…è®¸å…¶ä»–çº¿ç¨‹ç«äº‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å”¤é†’æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â° &lt;strong&gt;è¶…æ—¶è‡ªåŠ¨å”¤é†’&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ğŸ”” éœ€å…¶ä»–çº¿ç¨‹è°ƒç”¨ &lt;strong&gt;&lt;code&gt;notify()&lt;/code&gt;/&lt;code&gt;notifyAll()&lt;/code&gt;&lt;/strong&gt; æˆ–è¶…æ—¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒç”¨è¦æ±‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯åœ¨&lt;strong&gt;ä»»ä½•åœ°æ–¹&lt;/strong&gt;è°ƒç”¨&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¿…é¡»åœ¨ &lt;code&gt;synchronized&lt;/code&gt;åŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•ä¸­&lt;/strong&gt;è°ƒç”¨ï¼Œå¦åˆ™æŠ› &lt;code&gt;IllegalMonitorStateException&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹çŠ¶æ€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿›å…¥ &lt;code&gt;TIMED_WAITING&lt;/code&gt;(æœ‰æ—¶é™ç­‰å¾…)&lt;/td&gt;
&lt;td&gt;è¿›å…¥ &lt;code&gt;WAITING&lt;/code&gt;(æ— å‚, æ— é™ç­‰å¾…) æˆ– &lt;code&gt;TIMED_WAITING&lt;/code&gt;(å¸¦è¶…æ—¶å‚æ•°)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ç”¨é€”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®©å½“å‰çº¿ç¨‹&lt;strong&gt;æš‚åœæ‰§è¡Œ&lt;/strong&gt;ä¸€æ®µæ—¶é—´ï¼Œä¸çº¿ç¨‹é—´åä½œæ— å…³&lt;/td&gt;
&lt;td&gt;ç”¨äº&lt;strong&gt;çº¿ç¨‹é—´åä½œ&lt;/strong&gt;ï¼Œè®©çº¿ç¨‹ç­‰å¾…æŸä¸ªæ¡ä»¶æˆç«‹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«è¯¦è§£"&gt;ğŸ” æ ¸å¿ƒåŒºåˆ«è¯¦è§£
&lt;/h3&gt;&lt;h4 id="1-æ‰€å±ç±»ä¸åŸºæœ¬ä½œç”¨"&gt;1. æ‰€å±ç±»ä¸åŸºæœ¬ä½œç”¨
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Thread.sleep()&lt;/code&gt;&lt;/strong&gt; æ˜¯ &lt;code&gt;Thread&lt;/code&gt;ç±»çš„é™æ€æ–¹æ³•ã€‚å®ƒçš„ä½œç”¨æ˜¯è®©&lt;strong&gt;å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹&lt;/strong&gt;æš‚åœï¼ˆä¼‘çœ ï¼‰æŒ‡å®šçš„æ—¶é—´ï¼Œ&lt;strong&gt;ä¸æ¶‰åŠçº¿ç¨‹é—´çš„é€šä¿¡æˆ–é”çš„åè°ƒ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Object.wait()&lt;/code&gt;&lt;/strong&gt; æ˜¯ &lt;code&gt;Object&lt;/code&gt;ç±»çš„å®ä¾‹æ–¹æ³•ã€‚å®ƒç”¨äº&lt;strong&gt;çº¿ç¨‹é—´é€šä¿¡&lt;/strong&gt;ï¼Œé€šå¸¸ä¸ &lt;code&gt;notify()&lt;/code&gt;/&lt;code&gt;notifyAll()&lt;/code&gt;é…å¯¹ä½¿ç”¨ï¼Œè®©ä¸€ä¸ªçº¿ç¨‹ä¸»åŠ¨ç­‰å¾…æŸä¸ªæ¡ä»¶æˆç†Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-å¯¹é”çš„å½±å“æœ€å…³é”®çš„åŒºåˆ«"&gt;2. å¯¹é”çš„å½±å“ï¼ˆæœ€å…³é”®çš„åŒºåˆ«ï¼‰
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Thread.sleep()&lt;/code&gt;&lt;/strong&gt; åœ¨ä¼‘çœ æ—¶ï¼Œ&lt;strong&gt;ä¸ä¼šé‡Šæ”¾&lt;/strong&gt;å®ƒå½“å‰æŒæœ‰çš„ä»»ä½•é”ï¼ˆå¦‚ &lt;code&gt;synchronized&lt;/code&gt;æŒæœ‰çš„å¯¹è±¡ç›‘è§†å™¨é”ï¼‰ã€‚è¿™æ„å‘³ç€å…¶ä»–éœ€è¦è¯¥é”çš„çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œæ— æ³•æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Object.wait()&lt;/code&gt;&lt;/strong&gt; åœ¨è°ƒç”¨æ—¶ï¼Œ&lt;strong&gt;ä¼šç«‹å³é‡Šæ”¾&lt;/strong&gt;å®ƒå½“å‰æŒæœ‰çš„é”ï¼ˆå³è°ƒç”¨è¯¥æ–¹æ³•çš„ &lt;code&gt;synchronized&lt;/code&gt;å¯¹è±¡é”ï¼‰ã€‚è¿™æ­£æ˜¯å®ƒèƒ½å®ç°çº¿ç¨‹é—´åä½œçš„åŸºç¡€â€”â€”é‡Šæ”¾é”ä»¥ä¾¿å…¶ä»–çº¿ç¨‹å¯ä»¥è¿›å…¥åŒæ­¥å—ä¿®æ”¹æ¡ä»¶ï¼Œå¹¶è°ƒç”¨ &lt;code&gt;notify()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-å”¤é†’æœºåˆ¶"&gt;3. å”¤é†’æœºåˆ¶
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Thread.sleep()&lt;/code&gt;&lt;/strong&gt; åœ¨æŒ‡å®šçš„æ—¶é—´è¿‡åï¼Œçº¿ç¨‹ä¼š&lt;strong&gt;è‡ªåŠ¨è‹é†’&lt;/strong&gt;å¹¶å°è¯•ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Object.wait()&lt;/code&gt;&lt;/strong&gt; é€šå¸¸éœ€è¦&lt;strong&gt;å…¶ä»–çº¿ç¨‹&lt;/strong&gt;ä¸»åŠ¨è°ƒç”¨&lt;strong&gt;åŒä¸€ä¸ªå¯¹è±¡&lt;/strong&gt;çš„ &lt;code&gt;notify()&lt;/code&gt;æˆ– &lt;code&gt;notifyAll()&lt;/code&gt;æ–¹æ³•æ¥å”¤é†’å®ƒã€‚å®ƒä¹Ÿå¯ä»¥è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼ˆ&lt;code&gt;wait(long timeout)&lt;/code&gt;ï¼‰ï¼Œé¿å…æ— é™æœŸç­‰å¾…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="4-è°ƒç”¨è¦æ±‚ä¸å¼‚å¸¸"&gt;4. è°ƒç”¨è¦æ±‚ä¸å¼‚å¸¸
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Thread.sleep()&lt;/code&gt;&lt;/strong&gt; å¯ä»¥åœ¨ä»»ä½•ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ï¼Œæ²¡æœ‰ç‰¹æ®Šè¦æ±‚ã€‚å®ƒéœ€è¦å¤„ç† &lt;code&gt;InterruptedException&lt;/code&gt;ï¼Œè¡¨ç¤ºä¼‘çœ è¿‡ç¨‹å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Object.wait()&lt;/code&gt;&lt;/strong&gt; &lt;strong&gt;å¿…é¡»&lt;/strong&gt;åœ¨ &lt;code&gt;synchronized&lt;/code&gt;ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•ä¸­è°ƒç”¨ï¼Œå¦åˆ™è¿è¡Œæ—¶ä¼šæŠ›å‡º &lt;code&gt;IllegalMonitorStateException&lt;/code&gt;ã€‚åŒæ ·ï¼Œå®ƒä¹Ÿä¼šæŠ›å‡º &lt;code&gt;InterruptedException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="5-çº¿ç¨‹çŠ¶æ€"&gt;5. çº¿ç¨‹çŠ¶æ€
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è°ƒç”¨ &lt;code&gt;sleep()&lt;/code&gt;åï¼Œçº¿ç¨‹è¿›å…¥ &lt;strong&gt;&lt;code&gt;TIMED_WAITING&lt;/code&gt;&lt;/strong&gt; ï¼ˆæœ‰æ—¶é™ç­‰å¾…ï¼‰çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒç”¨æ— å‚çš„ &lt;code&gt;wait()&lt;/code&gt;åï¼Œçº¿ç¨‹è¿›å…¥ &lt;strong&gt;&lt;code&gt;WAITING&lt;/code&gt;&lt;/strong&gt; ï¼ˆæ— é™ç­‰å¾…ï¼‰çŠ¶æ€ï¼›è°ƒç”¨å¸¦è¶…æ—¶å‚æ•°çš„ &lt;code&gt;wait(long timeout)&lt;/code&gt;åï¼Œçº¿ç¨‹è¿›å…¥ &lt;strong&gt;&lt;code&gt;TIMED_WAITING&lt;/code&gt;&lt;/strong&gt; çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-2"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è™šå‡å”¤é†’ (Spurious Wakeup)&lt;/strong&gt;ï¼š&lt;code&gt;wait()&lt;/code&gt;æ–¹æ³•å¯èƒ½å­˜åœ¨è™šå‡å”¤é†’ï¼Œå³çº¿ç¨‹åœ¨æ²¡æœ‰æ”¶åˆ° &lt;code&gt;notify&lt;/code&gt;çš„æƒ…å†µä¸‹è¢«å”¤é†’ã€‚å› æ­¤ï¼Œ&lt;strong&gt;&lt;code&gt;wait()&lt;/code&gt;çš„è°ƒç”¨åº”è¯¥å§‹ç»ˆæ”¾åœ¨å¾ªç¯ä¸­&lt;/strong&gt;ï¼Œä¸æ–­æ£€æŸ¥ç­‰å¾…çš„æ¡ä»¶æ˜¯å¦çœŸæ­£æ»¡è¶³ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;synchronized (lock) {
while (!condition) { // ç”¨ while è€Œä¸æ˜¯ if æ¥æ£€æŸ¥æ¡ä»¶
lock.wait();
}
// æ¡ä»¶æ»¡è¶³ï¼Œç»§ç»­æ‰§è¡Œ
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;InterruptedException&lt;/code&gt;å¤„ç†&lt;/strong&gt;ï¼šä¸¤è€…éƒ½ä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ï¼Œè¡¨ç¤ºç­‰å¾…/ä¼‘çœ è¢«ä¸­æ–­ã€‚æ•è·ååº”æ ¹æ®å®é™…æƒ…å†µå†³å®šæ˜¯æ¢å¤ä¸­æ–­çŠ¶æ€è¿˜æ˜¯ç›´æ¥å¤„ç†ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
Thread.sleep(1000);
} catch (InterruptedException e) {
Thread.currentThread().interrupt(); // æ¢å¤ä¸­æ–­çŠ¶æ€æ˜¯è‰¯å¥½å®è·µ
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ€§èƒ½ä¸è®¾è®¡&lt;/strong&gt;ï¼šåœ¨å¤æ‚çš„çº¿ç¨‹åä½œåœºæ™¯ä¸­ï¼Œä» Java 5 å¼€å§‹ï¼Œ&lt;strong&gt;&lt;code&gt;java.util.concurrent&lt;/code&gt;&lt;/strong&gt; åŒ…ä¸‹çš„å·¥å…·ï¼ˆå¦‚ &lt;code&gt;Condition&lt;/code&gt;ã€&lt;code&gt;CountDownLatch&lt;/code&gt;ã€&lt;code&gt;CyclicBarrier&lt;/code&gt;ã€&lt;code&gt;Semaphore&lt;/code&gt;ï¼‰é€šå¸¸æä¾›äº†æ¯” &lt;code&gt;wait()/notify()&lt;/code&gt;æ›´å¼ºå¤§ã€æ›´æ˜“ç”¨ã€æ›´å®‰å…¨çš„çº¿ç¨‹åŒæ­¥æœºåˆ¶ï¼Œæ˜¯ç°ä»£å¹¶å‘ç¼–ç¨‹çš„é¦–é€‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©sleep-è¿˜æ˜¯-wait"&gt;ğŸ¯ å¦‚ä½•é€‰æ‹©ï¼šsleep è¿˜æ˜¯ waitï¼Ÿ
&lt;/h3&gt;&lt;p&gt;é€‰æ‹©å–å†³äºä½ çš„ç›®çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å½“ä½ éœ€è¦è®©å½“å‰çº¿ç¨‹ç®€å•åœ°æš‚åœæ‰§è¡Œä¸€æ®µæ—¶é—´&lt;/strong&gt;ï¼ˆä¾‹å¦‚ï¼Œæ¨¡æ‹Ÿè€—æ—¶æ“ä½œã€å®šæ—¶ä»»åŠ¡ã€æ§åˆ¶å¾ªç¯é¢‘ç‡ï¼‰ï¼Œå¹¶ä¸”&lt;strong&gt;ä¸éœ€è¦ä¸å…¶ä»–çº¿ç¨‹åè°ƒ&lt;/strong&gt;æ—¶ï¼Œä½¿ç”¨ &lt;code&gt;Thread.sleep()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å½“ä½ éœ€è¦è®©å½“å‰çº¿ç¨‹ç­‰å¾…æŸä¸ªæ¡ä»¶æˆç«‹&lt;/strong&gt;ï¼ˆä¾‹å¦‚ï¼Œç­‰å¾…ä»»åŠ¡å®Œæˆã€ç­‰å¾…èµ„æºå°±ç»ªï¼‰ï¼Œå¹¶ä¸”è¿™ä¸ªæ¡ä»¶éœ€è¦&lt;strong&gt;ç”±å…¶ä»–çº¿ç¨‹æ¥æ”¹å˜å’Œé€šçŸ¥&lt;/strong&gt;æ—¶ï¼Œä½¿ç”¨ &lt;code&gt;Object.wait()&lt;/code&gt;å’Œ &lt;code&gt;notify()&lt;/code&gt;/&lt;code&gt;notifyAll()&lt;/code&gt;ã€‚è¿™æ˜¯å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…ã€ç­‰å¾…-é€šçŸ¥ç­‰æ¨¡å¼çš„åŸºçŸ³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ å½»åº•ç†è§£ &lt;code&gt;sleep()&lt;/code&gt;å’Œ &lt;code&gt;wait()&lt;/code&gt;çš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;h2 id="web-inf"&gt;WEB-INF
&lt;/h2&gt;&lt;p&gt;WEB-INF ç›®å½•æ˜¯ Java Web åº”ç”¨ç¨‹åºä¸­ä¸€ä¸ªéå¸¸å…³é”®ä¸”ç‰¹æ®Šçš„&lt;strong&gt;å®‰å…¨ç›®å½•&lt;/strong&gt;ï¼Œä¸»è¦ç”¨äºå­˜æ”¾å„ç§é…ç½®æ–‡ä»¶å’Œæ ¸å¿ƒèµ„æºã€‚å®ƒçš„æ ¸å¿ƒç‰¹ç‚¹æ˜¯ï¼š&lt;strong&gt;å®¢æˆ·ç«¯æ— æ³•é€šè¿‡æµè§ˆå™¨ç›´æ¥è®¿é—®&lt;/strong&gt;ï¼Œåªæœ‰æœåŠ¡å™¨ç«¯ä»£ç å¯ä»¥è¯»å–ï¼Œè¿™æœ‰æ•ˆä¿æŠ¤äº†æ•æ„Ÿä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªè¡¨æ ¼ï¼Œå¸®ä½ å¿«é€Ÿäº†è§£ WEB-INF ç›®å½•çš„ä¸»è¦ç»“æ„å’Œå†…å®¹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç›®å½•/æ–‡ä»¶&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;th&gt;æ˜¯å¦å¯ç›´æ¥é€šè¿‡ URL è®¿é—®&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;/WEB-INF/web.xml&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Web åº”ç”¨ç¨‹åºçš„&lt;strong&gt;éƒ¨ç½²æè¿°æ–‡ä»¶&lt;/strong&gt;ï¼Œç”¨äºé…ç½® Servletã€è¿‡æ»¤å™¨ã€ç›‘å¬å™¨ã€æ¬¢è¿é¡µé¢ç­‰ã€‚&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;/WEB-INF/classes/&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜æ”¾é¡¹ç›®ç¼–è¯‘åçš„ &lt;strong&gt;Java ç±»æ–‡ä»¶&lt;/strong&gt; (.class)ï¼Œå¦‚ Servletã€å·¥å…·ç±»ç­‰ã€‚é€šå¸¸æŒ‰åŒ…ç»“æ„ç»„ç»‡ã€‚&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;/WEB-INF/lib/&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜æ”¾é¡¹ç›®ä¾èµ–çš„&lt;strong&gt;ç¬¬ä¸‰æ–¹ JAR åŒ…&lt;/strong&gt;ï¼Œå¦‚æ•°æ®åº“é©±åŠ¨ã€å·¥å…·åº“ç­‰ã€‚&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;/WEB-INF/src/&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯é€‰ç›®å½•ï¼Œå¸¸ç”¨äºå­˜æ”¾&lt;strong&gt;Java æºä»£ç &lt;/strong&gt; (.java)ã€‚&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;/WEB-INF/tags/&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜æ”¾&lt;strong&gt;è‡ªå®šä¹‰ JSP æ ‡ç­¾åº“&lt;/strong&gt;çš„æ ‡ç­¾æ–‡ä»¶ã€‚&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;/WEB-INF/jsp/&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¸¸ç”¨äºå­˜æ”¾ä¸å¸Œæœ›è¢«ç›´æ¥è®¿é—®çš„ &lt;strong&gt;JSP é¡µé¢&lt;/strong&gt;ï¼Œéœ€é€šè¿‡ Servlet è½¬å‘è®¿é—®ä»¥æé«˜å®‰å…¨æ€§ã€‚&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;/WEB-INF/database.properties&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯å­˜æ”¾&lt;strong&gt;æ•°æ®åº“è¿æ¥é…ç½®&lt;/strong&gt;ç­‰æ•æ„Ÿä¿¡æ¯çš„å±æ€§æ–‡ä»¶ã€‚&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;/META-INF/&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šå¸¸å­˜åœ¨äº WAR åŒ…ä¸­ï¼Œç”¨äºå­˜æ”¾&lt;strong&gt;å…ƒæ•°æ®ä¿¡æ¯&lt;/strong&gt;ï¼Œå¦‚ MANIFEST.MF æ–‡ä»¶ã€‚&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å®‰å…¨è®¾è®¡ä¸è®¿é—®é¡»çŸ¥"&gt;ğŸ”’ å®‰å…¨è®¾è®¡ä¸è®¿é—®é¡»çŸ¥
&lt;/h3&gt;&lt;p&gt;WEB-INF ç›®å½•çš„&lt;strong&gt;æ ¸å¿ƒè®¾è®¡ç›®æ ‡å°±æ˜¯å®‰å…¨&lt;/strong&gt;ã€‚æ‰€æœ‰æ”¾åœ¨æ­¤ç›®å½•ä¸‹çš„èµ„æºéƒ½å—åˆ°ä¿æŠ¤ï¼Œè¿™æ„å‘³ç€ä½ æ— æ³•é€šè¿‡åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ &lt;code&gt;http://yourdomain.com/yourapp/WEB-INF/web.xml&lt;/code&gt;è¿™æ ·çš„æ–¹å¼æ¥ç›´æ¥è®¿é—®æˆ–ä¸‹è½½å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå‰ç«¯é¡µé¢éœ€è¦ç”¨åˆ° WEB-INF ç›®å½•ä¸‹çš„æŸäº›èµ„æºï¼ˆæ¯”å¦‚å›¾ç‰‡ã€é…ç½®æ–‡ä»¶ç­‰ï¼‰ï¼Œ&lt;strong&gt;å¿…é¡»é€šè¿‡æœåŠ¡å™¨ç«¯ç¨‹åºï¼ˆå¦‚ Servletã€Spring MVC æ§åˆ¶å™¨ï¼‰è¿›è¡Œè¯»å–å’Œè½¬å‘&lt;/strong&gt;ï¼Œæˆ–è€…è€ƒè™‘å°†éœ€è¦å…¬å¼€è®¿é—®çš„èµ„æº&lt;strong&gt;æ”¾ç½®åœ¨å…¶ä»–å…¬å…±ç›®å½•&lt;/strong&gt;ä¸­ï¼ˆå¦‚ WebContent æ ¹ç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶å¤¹ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="-å¦‚ä½•ç¼–ç¨‹è®¿é—®-web-inf-ä¸­çš„èµ„æº"&gt;ğŸ› ï¸ å¦‚ä½•ç¼–ç¨‹è®¿é—® WEB-INF ä¸­çš„èµ„æº
&lt;/h3&gt;&lt;p&gt;æ—¢ç„¶ä¸èƒ½ç›´æ¥é€šè¿‡ URL è®¿é—®ï¼Œå¦‚æœä½ çš„æœåŠ¡å™¨ç«¯ä»£ç éœ€è¦è¯»å– WEB-INF ä¸­çš„èµ„æºï¼ˆä¾‹å¦‚ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼‰ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;ServletContext.getResourceAsStream()&lt;/code&gt;æ–¹æ³•æ¥å®ç°ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// åœ¨ Servlet æˆ– Controller ä¸­ç¤ºä¾‹
String configPath = &amp;#34;/WEB-INF/database.properties&amp;#34;;
InputStream inputStream = getServletContext().getResourceAsStream(configPath);
// ç„¶åå°±å¯ä»¥ä½¿ç”¨ InputStream æ¥è¯»å–é…ç½®æ–‡ä»¶çš„å†…å®¹äº†
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-é‡è¦æé†’"&gt;ğŸ’ é‡è¦æé†’
&lt;/h3&gt;&lt;p&gt;WEB-INF ç›®å½•å¯¹äºç»„ç»‡ä¸€ä¸ªæ¸…æ™°ã€å®‰å…¨ã€æ˜“äºç»´æŠ¤çš„ Java Web åº”ç”¨è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯·å°†&lt;strong&gt;æ‰€æœ‰æ•æ„Ÿçš„é…ç½®æ–‡ä»¶&lt;/strong&gt;ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼‰ã€&lt;strong&gt;ç¼–è¯‘åçš„ç±»æ–‡ä»¶&lt;/strong&gt;ã€&lt;strong&gt;ä¾èµ–çš„åº“æ–‡ä»¶&lt;/strong&gt;æ”¾å…¥ WEB-INF ç›®å½•ä¸‹ã€‚&lt;/li&gt;
&lt;li&gt;ä»»ä½•ä½ &lt;strong&gt;ä¸å¸Œæœ›ç”¨æˆ·ç›´æ¥é€šè¿‡ URL è®¿é—®åˆ°çš„èµ„æº&lt;/strong&gt;ï¼ˆæ¯”å¦‚ä¸€äº›ç”¨ä½œæ¨¡æ¿çš„ JSP é¡µé¢ï¼‰ï¼Œéƒ½åº”æ”¾åœ¨ WEB-INF ç›®å½•ä¸‹ï¼Œå¹¶é€šè¿‡ Servlet è½¬å‘çš„æ–¹å¼è¿›è¡Œè®¿é—®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ WEB-INF ç›®å½•ã€‚&lt;/p&gt;
&lt;h2 id="boostrap-classloader"&gt;Boostrap ClassLoader
&lt;/h2&gt;&lt;p&gt;Bootstrap ClassLoaderï¼ˆå¯åŠ¨ç±»åŠ è½½å™¨ï¼‰æ˜¯ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰ç±»åŠ è½½å™¨å±‚æ¬¡ç»“æ„ä¸­æœ€é¡¶å±‚çš„ç±»åŠ è½½å™¨ï¼Œå®ƒç¡®å®ç”± JVM çš„&lt;strong&gt;æœ¬åœ°ä»£ç ï¼ˆå¦‚ C/C++ï¼‰å®ç°&lt;/strong&gt;ï¼Œè´Ÿè´£åŠ è½½ Java çš„æ ¸å¿ƒç±»åº“ï¼ˆå¦‚ &lt;code&gt;rt.jar&lt;/code&gt;ï¼‰ï¼Œå¹¶ä¸”å…¶æœ¬èº«&lt;strong&gt;å°±æ˜¯ JVM è™šæ‹Ÿæœºçš„ä¸€éƒ¨åˆ†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ èƒ½æ›´æ¸…æ™°åœ°ç†è§£ï¼Œæˆ‘ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æ€»ç»“å®ƒçš„æ ¸å¿ƒç‰¹æ€§ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;th&gt;å¤‡æ³¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”± &lt;strong&gt;JVM æœ¬åœ°ä»£ç ï¼ˆC/C++ï¼‰&lt;/strong&gt; å®ç°ï¼Œå¹¶é Java ç±»&lt;/td&gt;
&lt;td&gt;å› æ­¤&lt;strong&gt;æ— æ³•åœ¨ Java ä»£ç ä¸­ç›´æ¥è·å–å…¶å¼•ç”¨&lt;/strong&gt;ï¼Œå…¶çˆ¶åŠ è½½å™¨è¡¨ç°ä¸º &lt;code&gt;null&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ è½½ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è´Ÿè´£åŠ è½½ &lt;strong&gt;Java æ ¸å¿ƒç±»åº“&lt;/strong&gt;ï¼Œå¦‚ &lt;code&gt;$JAVA_HOME/lib&lt;/code&gt;ç›®å½•ä¸‹çš„ &lt;code&gt;rt.jar&lt;/code&gt;ã€&lt;code&gt;charsets.jar&lt;/code&gt;ã€&lt;code&gt;jce.jar&lt;/code&gt;ç­‰ï¼Œè¿™äº›åº“åŒ…å«äº† &lt;code&gt;java.lang.*&lt;/code&gt;ã€&lt;code&gt;java.util.*&lt;/code&gt;ç­‰åŸºç¡€ç±»ã€‚&lt;/td&gt;
&lt;td&gt;ç¡®ä¿ JVM è¿è¡Œæ‰€éœ€çš„æœ€åŸºç¡€ç±»ç”±æœ€é«˜ä¼˜å…ˆçº§çš„åŠ è½½å™¨åŠ è½½ï¼Œä¿éšœæ ¸å¿ƒåº“çš„å®‰å…¨æ€§å’Œå”¯ä¸€æ€§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ è½½è·¯å¾„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é»˜è®¤è·¯å¾„ä¸º &lt;code&gt;$JAVA_HOME/lib&lt;/code&gt;ã€‚å¯é€šè¿‡ JVM å¯åŠ¨å‚æ•° &lt;strong&gt;&lt;code&gt;-Xbootclasspath&lt;/code&gt;&lt;/strong&gt; æ¥æŒ‡å®šé¢å¤–çš„è·¯å¾„æˆ–è¦†ç›–é»˜è®¤è·¯å¾„ï¼ˆä½†éœ€è°¨æ…ä½¿ç”¨ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åœ¨ Java ä¸­çš„è¡¨ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ Java ä»£ç ä¸­ï¼Œå°è¯•è·å– &lt;code&gt;Bootstrap ClassLoader&lt;/code&gt;ä¼šå¾—åˆ° &lt;code&gt;null&lt;/code&gt;ï¼ˆä¾‹å¦‚ &lt;code&gt;String.class.getClassLoader()&lt;/code&gt;ä¼šè¿”å› &lt;code&gt;null&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;è¿™æ˜¯å› ä¸ºå®ƒä¸æ˜¯ Java ç±»ï¼ŒJava å±‚æ— æ³•ç›´æ¥è®¿é—®ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èŒè´£ä¸é‡è¦æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½œä¸º&lt;strong&gt;æ‰€æœ‰å…¶ä»–ç±»åŠ è½½å™¨çš„ç»ˆæçˆ¶åŠ è½½å™¨&lt;/strong&gt;ï¼Œæ˜¯&lt;strong&gt;åŒäº²å§”æ´¾æ¨¡å‹&lt;/strong&gt;çš„åŸºçŸ³ã€‚ä»»ä½•ç±»çš„åŠ è½½è¯·æ±‚æœ€ç»ˆéƒ½ä¼šå§”æ´¾ç»™å®ƒå°è¯•åŠ è½½ï¼Œè¿™é˜²æ­¢äº†æ ¸å¿ƒ API è¢«ç¯¡æ”¹ã€‚&lt;/td&gt;
&lt;td&gt;ä¿è¯äº† Java ç¨‹åºè¿è¡Œçš„åŸºç¡€å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å±‚çº§åœ°ä½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½äºç±»åŠ è½½å™¨å±‚æ¬¡ç»“æ„çš„&lt;strong&gt;æœ€é¡¶ç«¯&lt;/strong&gt;ã€‚&lt;code&gt;ExtClassLoader&lt;/code&gt;ï¼ˆæ‰©å±•ç±»åŠ è½½å™¨ï¼‰çš„çˆ¶åŠ è½½å™¨åœ¨é€»è¾‘ä¸Šæ˜¯ &lt;code&gt;Bootstrap ClassLoader&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-è¡¥å……è¯´æ˜"&gt;ğŸ’¡ è¡¥å……è¯´æ˜
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;â€œè™šæ‹Ÿæœºçš„ä¸€éƒ¨åˆ†â€çš„å«ä¹‰&lt;/strong&gt;ï¼šè¿™æ„å‘³ç€ &lt;code&gt;Bootstrap ClassLoader&lt;/code&gt;çš„ä»£ç é€»è¾‘&lt;strong&gt;ç´§å¯†é›†æˆåœ¨ JVM çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå¦‚ &lt;code&gt;jvm.dll&lt;/code&gt;æˆ– &lt;code&gt;libjvm.so&lt;/code&gt;ï¼‰ä¸­&lt;/strong&gt;ï¼Œéš JVM çš„å¯åŠ¨è€Œä¸€åŒåˆå§‹åŒ–ã€‚å®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸ JVM è¿›ç¨‹å®Œå…¨ç»‘å®šï¼Œä¸åŒäºå…¶ä»–ç”± Java ç¼–å†™çš„ç±»åŠ è½½å™¨ï¼ˆå¦‚ &lt;code&gt;AppClassLoader&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸åŒäº²å§”æ´¾æ¨¡å‹çš„å…³ç³»&lt;/strong&gt;ï¼š&lt;code&gt;Bootstrap ClassLoader&lt;/code&gt;æ˜¯&lt;strong&gt;åŒäº²å§”æ´¾æ¨¡å‹ï¼ˆParents Delegation Modelï¼‰çš„é¡¶å±‚ç»ˆç‚¹&lt;/strong&gt;ã€‚å½“ä¸€ä¸ªç±»éœ€è¦è¢«åŠ è½½æ—¶ï¼Œå­åŠ è½½å™¨ä¼šå…ˆå°†è¯·æ±‚å§”æ´¾ç»™çˆ¶åŠ è½½å™¨ï¼Œæœ€ç»ˆè¿™ä¸ªè¯·æ±‚ä¼šåˆ°è¾¾ &lt;code&gt;Bootstrap ClassLoader&lt;/code&gt;ã€‚å¦‚æœå®ƒæ— æ³•åŠ è½½ï¼ˆä¾‹å¦‚ï¼Œè¦åŠ è½½çš„ç±»ä¸æ˜¯æ ¸å¿ƒ Java ç±»ï¼‰ï¼Œæ‰ä¼šå‘ä¸‹å§”æ´¾ç»™å­åŠ è½½å™¨å°è¯•åŠ è½½ã€‚è¿™ç§æœºåˆ¶&lt;strong&gt;ç¡®ä¿äº†æ ¸å¿ƒ Java ç±»åº“çš„å®‰å…¨æ€§&lt;/strong&gt;ï¼Œå› ä¸ºç”¨æˆ·è‡ªå®šä¹‰çš„ç±»æ— æ³•å†’å……æ ¸å¿ƒç±»ï¼ˆå¦‚è‡ªå®šä¹‰çš„ &lt;code&gt;java.lang.String&lt;/code&gt;ä¸ä¼šè¢«åŠ è½½ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›ä»¥ä¸Šè§£é‡Šèƒ½å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£ Bootstrap ç±»åŠ è½½å™¨ã€‚&lt;/p&gt;
&lt;h2 id="classloader-ç»„åˆçˆ¶ç±»"&gt;ClassLoader ç»„åˆçˆ¶ç±»
&lt;/h2&gt;&lt;p&gt;Java çš„ &lt;code&gt;ClassLoader&lt;/code&gt;é‡‡ç”¨&lt;strong&gt;ç»„åˆï¼ˆCompositionï¼‰&lt;/strong&gt;ï¼ˆé€šè¿‡æŒæœ‰çˆ¶ç±»åŠ è½½å™¨çš„å¼•ç”¨ï¼‰è€Œé&lt;strong&gt;ç»§æ‰¿ï¼ˆInheritanceï¼‰&lt;/strong&gt; æ¥å®ç°ä¸çˆ¶ç±»åŠ è½½å™¨çš„åä½œï¼Œæ˜¯ç»è¿‡æ·±æ€ç†Ÿè™‘çš„ä¼˜ç§€è®¾è®¡ã€‚è¿™ä¸»è¦æ˜¯ä¸ºäº†æ»¡è¶³&lt;strong&gt;åŒäº²å§”æ´¾æ¨¡å‹ï¼ˆParent Delegation Modelï¼‰&lt;/strong&gt; çš„çµæ´»æ€§å’Œå®‰å…¨æ€§çš„è¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€Ÿäº†è§£ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«ï¼Œè¯·çœ‹ä¸‹è¡¨ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç»„åˆ (Composition)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç»§æ‰¿ (Inheritance)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³ç³»æ€§è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;has-a&lt;/strong&gt; (æœ‰ä¸€ä¸ª)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;is-a&lt;/strong&gt; (æ˜¯ä¸€ä¸ª)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è€¦åˆåº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½è€¦åˆ&lt;/strong&gt;ï¼Œé€šè¿‡æ¥å£æˆ–å¼•ç”¨åä½œ&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜è€¦åˆ&lt;/strong&gt;ï¼Œå­ç±»ä¸çˆ¶ç±»ç´§å¯†ç»‘å®š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜&lt;/strong&gt;ï¼Œå¯åœ¨è¿è¡Œæ—¶åŠ¨æ€è®¾ç½®æˆ–æ›´æ¢çˆ¶åŠ è½½å™¨&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½&lt;/strong&gt;ï¼Œç¼–è¯‘æ—¶ç¡®å®šï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶æ”¹å˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å°è£…æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¥½&lt;/strong&gt;ï¼Œä¸æš´éœ²çˆ¶åŠ è½½å™¨çš„å®ç°ç»†èŠ‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å·®&lt;/strong&gt;ï¼Œç ´åå°è£…ï¼Œå­ç±»å¯è®¿é—®çˆ¶ç±»å—ä¿æŠ¤æˆå‘˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å±‚æ¬¡ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯æ„å»º&lt;strong&gt;çµæ´»ã€åŠ¨æ€&lt;/strong&gt;çš„å§”æ‰˜é“¾&lt;/td&gt;
&lt;td&gt;å½¢æˆ&lt;strong&gt;å›ºå®šã€é™æ€&lt;/strong&gt;çš„ç±»å±‚æ¬¡ç»“æ„&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å¦‚ä½•ç†è§£è¿™ç§ç»„åˆå…³ç³»"&gt;ğŸ”„ å¦‚ä½•ç†è§£è¿™ç§ç»„åˆå…³ç³»
&lt;/h3&gt;&lt;p&gt;åœ¨ &lt;code&gt;ClassLoader&lt;/code&gt;çš„æŠ½è±¡ç±»ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª &lt;code&gt;parent&lt;/code&gt;å­—æ®µæ¥æŒæœ‰å…¶çˆ¶ç±»åŠ è½½å™¨çš„&lt;strong&gt;å¼•ç”¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public abstract class ClassLoader {
// ç»„åˆå…³ç³»ï¼šé€šè¿‡æŒæœ‰çˆ¶ç±»åŠ è½½å™¨çš„å¼•ç”¨æ¥å®ç°åä½œ
private final ClassLoader parent;
// æ„é€ æ–¹æ³•ï¼Œå…è®¸åœ¨åˆ›å»ºClassLoaderæ—¶æŒ‡å®šå…¶çˆ¶åŠ è½½å™¨
protected ClassLoader(ClassLoader parent) {
this.parent = parent;
}
// åŒäº²å§”æ´¾æœºåˆ¶çš„æ ¸å¿ƒå®ç°
protected Class&amp;lt;?&amp;gt; loadClass(String name, boolean resolve) throws ClassNotFoundException {
// ... é¦–å…ˆæ£€æŸ¥ç±»æ˜¯å¦å·²åŠ è½½
if (parent != null) {
// å…³é”®ï¼šå°†åŠ è½½è¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»åŠ è½½å™¨ï¼ˆé€šè¿‡parentå¼•ç”¨è°ƒç”¨å…¶loadClassæ–¹æ³•ï¼‰
return parent.loadClass(name, false);
} else {
// å¦‚æœæ²¡æœ‰çˆ¶åŠ è½½å™¨ï¼Œåˆ™å§”æ‰˜ç»™å¯åŠ¨ç±»åŠ è½½å™¨
return findBootstrapClassOrNull(name);
}
// ... å¦‚æœçˆ¶åŠ è½½å™¨éƒ½æ— æ³•åŠ è½½ï¼Œå†è°ƒç”¨è‡ªèº«çš„findClassæ–¹æ³•
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-ä¸ºä»€ä¹ˆç»„åˆä¼˜äºç»§æ‰¿"&gt;ğŸ§  ä¸ºä»€ä¹ˆç»„åˆä¼˜äºç»§æ‰¿
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®ç°çœŸæ­£çš„â€œå§”æ‰˜â€è€Œéâ€œç»§æ‰¿â€å…³ç³»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒäº²å§”æ´¾æœºåˆ¶&lt;/strong&gt;è¦æ±‚çš„æ˜¯&lt;strong&gt;å°†ä»»åŠ¡å§”æ‰˜å‡ºå»&lt;/strong&gt;ï¼Œè€Œä¸æ˜¯ç»§æ‰¿çˆ¶ç±»çš„åŠ è½½è¡Œä¸ºã€‚ä¸€ä¸ª &lt;code&gt;ClassLoader&lt;/code&gt;&lt;strong&gt;æœ‰ä¸€ä¸ª&lt;/strong&gt;çˆ¶ç±»åŠ è½½å™¨ï¼ˆhas-aï¼‰å¹¶å§”æ‰˜å®ƒå·¥ä½œï¼Œè€Œä¸æ˜¯&lt;strong&gt;æ˜¯ä¸€ä¸ª&lt;/strong&gt;çˆ¶ç±»åŠ è½½å™¨ï¼ˆis-aï¼‰å¹¶ç›´æ¥å¤ç”¨å…¶æ–¹æ³•ã€‚ç»„åˆèƒ½æ›´å‡†ç¡®åœ°è¡¨è¾¾è¿™ç§å…³ç³»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿æŒå°è£…æ€§ï¼Œé™ä½è€¦åˆåº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç»§æ‰¿ä¼šç ´åå°è£…æ€§ï¼Œå› ä¸ºå­ç±»å¯ä»¥è®¿é—®çˆ¶ç±»çš„å—ä¿æŠ¤ï¼ˆprotectedï¼‰æˆå‘˜å’Œæ–¹æ³•ã€‚è¿™æ„å‘³ç€å­ç±»å¯ä»¥ä¾èµ–äºçˆ¶ç±»çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œä¸€æ—¦çˆ¶ç±»å‘ç”Ÿå˜åŒ–ï¼Œå­ç±»å¾ˆå¯èƒ½éœ€è¦éšä¹‹ä¿®æ”¹ï¼Œå½¢æˆ&lt;strong&gt;ç´§è€¦åˆ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç»„åˆåˆ™åªé€šè¿‡çˆ¶ç±»åŠ è½½å™¨å…¬å¼€çš„ &lt;code&gt;loadClass&lt;/code&gt;ç­‰æ–¹æ³•è¿›è¡Œäº¤äº’ï¼Œ&lt;strong&gt;éšè—äº†çˆ¶åŠ è½½å™¨çš„å†…éƒ¨å®ç°&lt;/strong&gt;ï¼Œé™ä½äº†è€¦åˆåº¦ï¼Œç¬¦åˆé¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æä¾›æå¤§çš„çµæ´»æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é‡‡ç”¨ç»„åˆï¼Œ&lt;strong&gt;çˆ¶åŠ è½½å™¨å¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡æ„é€ æ–¹æ³•åŠ¨æ€æ³¨å…¥&lt;/strong&gt;ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥çµæ´»åœ°ç»„è£…ç±»åŠ è½½å™¨çš„å§”æ‰˜é“¾ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è½»æ¾åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œå¹¶å°†å…¶çˆ¶åŠ è½½å™¨è®¾ç½®ä¸º &lt;code&gt;URLClassLoader&lt;/code&gt;ã€&lt;code&gt;AppClassLoader&lt;/code&gt;æˆ–å…¶ä»–ä»»ä½• &lt;code&gt;ClassLoader&lt;/code&gt;å®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœé‡‡ç”¨ç»§æ‰¿ï¼Œçˆ¶åŠ è½½å™¨åœ¨ç¼–è¯‘æ—¶å°±å¿…é¡»ç¡®å®šï¼ˆé€šè¿‡ &lt;code&gt;extends&lt;/code&gt;å…³é”®å­—ï¼‰ï¼Œ&lt;strong&gt;æ— æ³•åœ¨è¿è¡Œæ—¶åŠ¨æ€æ”¹å˜&lt;/strong&gt;å…¶å§”æ‰˜å…³ç³»ï¼Œè¿™å°†ä½¿åŒäº²å§”æ´¾æ¨¡å‹å˜å¾—æå…¶åƒµåŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å¤æ‚çš„ç±»å±‚æ¬¡ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœé€šè¿‡ç»§æ‰¿æ¥å®ç°ï¼Œä¸ºäº†ç»„åˆä¸åŒåŠ è½½å™¨çš„åŠŸèƒ½ï¼Œå¯èƒ½ä¼šå¯¼è‡´&lt;strong&gt;å¤šé‡ç»§æ‰¿&lt;/strong&gt;æˆ–&lt;strong&gt;è¿‡æ·±çš„ç»§æ‰¿å±‚æ¬¡&lt;/strong&gt;ï¼Œä½¿ä»£ç ç»“æ„å˜å¾—å¤æ‚éš¾ä»¥ç»´æŠ¤ã€‚Javaæœ¬èº«ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œè¿™æ›´é™åˆ¶äº†ç»§æ‰¿çš„å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ç»„åˆæ–¹å¼åˆ™éå¸¸è½»é‡å’Œæ¸…æ™°ã€‚æ¯ä¸ª &lt;code&gt;ClassLoader&lt;/code&gt;åªéœ€å…³æ³¨è‡ªå·±çš„åŠ è½½é€»è¾‘å’Œçˆ¶åŠ è½½å™¨å¼•ç”¨ï¼Œå¯ä»¥é€šè¿‡ç»„åˆä¸åŒçš„åŠ è½½å™¨æ¥å®ç°å¤æ‚åŠŸèƒ½ï¼Œè€Œæ— éœ€æ„å»ºå¤æ‚çš„ç»§æ‰¿æ ‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’¡ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œ&lt;code&gt;ClassLoader&lt;/code&gt;é‡‡ç”¨ç»„åˆè€Œéç»§æ‰¿æ¥å¤ç”¨çˆ¶ç±»åŠ è½½å™¨çš„åŠŸèƒ½ï¼Œæ˜¯ä¸€ä¸ªåŸºäº&lt;strong&gt;ä½è€¦åˆã€é«˜çµæ´»æ€§ã€å¼ºå°è£…æ€§&lt;/strong&gt;çš„æ·±æ€ç†Ÿè™‘çš„è®¾è®¡å†³ç­–ã€‚è¿™ä½¿å¾—&lt;strong&gt;åŒäº²å§”æ´¾æ¨¡å‹&lt;/strong&gt;èƒ½å¤Ÿä¼˜é›…ä¸”æœ‰æ•ˆåœ°å·¥ä½œï¼Œç¡®ä¿äº†Javaç±»åŠ è½½çš„å®‰å…¨æ€§ã€ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ç»§æ‰¿åœ¨æŸäº›â€œæ˜¯ä¸€ä¸ªâ€çš„æ˜ç¡®åœºæ™¯ä¸‹ä¾ç„¶æœ‰ç”¨ï¼Œä½†åœ¨åƒç±»åŠ è½½å™¨è¿™ç§éœ€è¦&lt;strong&gt;åŠ¨æ€å§”æ‰˜å’Œåä½œ&lt;/strong&gt;çš„åœºæ™¯ä¸­ï¼Œ&lt;strong&gt;ç»„åˆæ— ç–‘æ˜¯æ›´ä¼˜è¶Šçš„é€‰æ‹©&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id="hashcode-å’Œ-equals"&gt;hashCode() å’Œ equals()
&lt;/h2&gt;&lt;p&gt;ã€‚ä½ æå‡ºçš„è¿™ä¸¤ä¸ªè¯´æ³•ï¼Œåæ˜ äº†å¯¹ Java ä¸­ &lt;code&gt;hashCode()&lt;/code&gt;å’Œ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•å…³ç³»çš„å¸¸è§ç–‘é—®ã€‚ç®€å•æ¥è¯´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ä¸€å¥è¯æ˜¯æ­£ç¡®çš„&lt;/strong&gt;ï¼šå¦‚æœ &lt;code&gt;c1.hashCode() != c2.hashCode()&lt;/code&gt;ï¼Œé‚£ä¹ˆ &lt;code&gt;c1.equals(c2)&lt;/code&gt;ä¸€å®šè¿”å› &lt;code&gt;false&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬äºŒå¥è¯çš„è¡¨è¿°ä¸å¤Ÿå‡†ç¡®&lt;/strong&gt;ï¼šæ›´å‡†ç¡®çš„è¯´æ³•æ˜¯ï¼Œå¦‚æœ &lt;code&gt;c1.hashCode() == c2.hashCode()&lt;/code&gt;ï¼Œ&lt;code&gt;c1.equals(c2)&lt;/code&gt;&lt;strong&gt;å¯èƒ½&lt;/strong&gt;è¿”å› &lt;code&gt;true&lt;/code&gt;ï¼Œä½†ä¹Ÿ&lt;strong&gt;å¯èƒ½&lt;/strong&gt;è¿”å› &lt;code&gt;false&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ èƒ½å¿«é€Ÿç†è§£å®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘å‡†å¤‡äº†ä¸€ä¸ªè¡¨æ ¼ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;code&gt;hashCode()&lt;/code&gt;æ¯”è¾ƒç»“æœ&lt;/th&gt;
&lt;th&gt;&lt;code&gt;equals()&lt;/code&gt;&lt;strong&gt;å¯èƒ½&lt;/strong&gt;çš„ç»“æœ&lt;/th&gt;
&lt;th&gt;&lt;code&gt;equals()&lt;/code&gt;&lt;strong&gt;ä¸€å®š&lt;/strong&gt;çš„ç»“æœ&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸åŒ&lt;/strong&gt; (&lt;code&gt;c1 != c2&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;åªæœ‰ &lt;code&gt;false&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;false&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å“ˆå¸Œå€¼ä¸åŒï¼Œå¯¹è±¡å¿…å®šä¸ç›¸ç­‰&lt;/strong&gt; (è¿™æ˜¯Javaè§„èŒƒå¼ºåˆ¶è¦æ±‚çš„å¥‘çº¦)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›¸åŒ&lt;/strong&gt; (&lt;code&gt;c1 == c2&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;true&lt;/code&gt;æˆ– &lt;code&gt;false&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— å¿…ç„¶ç»“æœ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å“ˆå¸Œå€¼ç›¸åŒï¼Œå¯¹è±¡å¯èƒ½ç›¸ç­‰ä¹Ÿå¯èƒ½ä¸ç›¸ç­‰&lt;/strong&gt; (å“ˆå¸Œå†²çªï¼Œæ˜¯å…è®¸å­˜åœ¨çš„ç°è±¡)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹å…¶ä¸­çš„åŸç†å’Œç»†èŠ‚ã€‚&lt;/p&gt;
&lt;h3 id="-å¿…é¡»éµå®ˆçš„å“ˆå¸Œå¥‘çº¦"&gt;âš–ï¸ å¿…é¡»éµå®ˆçš„â€œå“ˆå¸Œå¥‘çº¦â€
&lt;/h3&gt;&lt;p&gt;Java è§„å®šï¼Œå½“é‡å†™ &lt;code&gt;equals()&lt;/code&gt;å’Œ &lt;code&gt;hashCode()&lt;/code&gt;æ–¹æ³•æ—¶ï¼Œå¿…é¡»éµå®ˆä¸€æ¡æ ¸å¿ƒå¥‘çº¦ï¼š&lt;strong&gt;å¦‚æœä¸¤ä¸ªå¯¹è±¡é€šè¿‡ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•æ¯”è¾ƒç›¸ç­‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„ &lt;code&gt;hashCode()&lt;/code&gt;è¿”å›å€¼å¿…é¡»ç›¸åŒ&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ¡è§„åˆ™æ˜¯ä¿è¯æ‰€æœ‰åŸºäºå“ˆå¸Œè¡¨çš„é›†åˆç±»ï¼ˆå¦‚ &lt;code&gt;HashMap&lt;/code&gt;, &lt;code&gt;HashSet&lt;/code&gt;, &lt;code&gt;Hashtable&lt;/code&gt;ï¼‰èƒ½æ­£å¸¸å·¥ä½œçš„åŸºçŸ³ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ä¸€å¥è¯ä¸ºä½•æ­£ç¡®&lt;/strong&gt;ï¼šç¬¬ä¸€å¥è¯å®é™…ä¸Šæ˜¯è¿™æ¡æ ¸å¿ƒå¥‘çº¦çš„&lt;strong&gt;é€†å¦å‘½é¢˜&lt;/strong&gt;ã€‚é€»è¾‘ä¸Šï¼Œå¦‚æœ A åˆ™ B æˆç«‹ï¼Œé‚£ä¹ˆé B åˆ™é A ä¹Ÿå¿…ç„¶æˆç«‹ã€‚æ˜ å°„è¿‡æ¥å°±æ˜¯ï¼šå¦‚æœ &lt;code&gt;equals()&lt;/code&gt;ç›¸ç­‰åˆ™ &lt;code&gt;hashCode()&lt;/code&gt;å¿…é¡»ç›¸ç­‰ï¼Œé‚£ä¹ˆå½“ &lt;code&gt;hashCode()&lt;/code&gt;ä¸ç›¸ç­‰æ—¶ï¼Œ&lt;code&gt;equals()&lt;/code&gt;&lt;strong&gt;ä¸€å®šä¸èƒ½ç›¸ç­‰&lt;/strong&gt;ã€‚å› æ­¤ï¼Œå¦‚æœ &lt;code&gt;c1.hashCode() != c2.hashCode()&lt;/code&gt;ï¼Œé‚£ä¹ˆ &lt;code&gt;c1.equals(c2)&lt;/code&gt;å¿…å®šä¸º &lt;code&gt;false&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿åå¥‘çº¦çš„åæœ&lt;/strong&gt;ï¼šå¦‚æœåªé‡å†™äº† &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•è€Œæ²¡æœ‰åŒæ—¶é‡å†™ &lt;code&gt;hashCode()&lt;/code&gt;æ–¹æ³•ï¼Œå°±å¯èƒ½è¿åè¿™æ¡å¥‘çº¦ã€‚ä¾‹å¦‚ï¼Œä¸¤ä¸ªå¯¹è±¡ &lt;code&gt;equals()&lt;/code&gt;ä¸º &lt;code&gt;true&lt;/code&gt;ï¼Œä½† &lt;code&gt;hashCode()&lt;/code&gt;ä¸åŒã€‚è¿™ä¼šå¯¼è‡´å®ƒä»¬åœ¨å­˜å…¥ &lt;code&gt;HashSet&lt;/code&gt;æ—¶è¢«å½“ä½œä¸åŒçš„å¯¹è±¡å­˜å‚¨ï¼Œä»è€Œä½¿ &lt;code&gt;Set&lt;/code&gt;å¤±å»äº†å»é‡çš„èƒ½åŠ›ï¼›æˆ–è€…åœ¨ä½œä¸º &lt;code&gt;HashMap&lt;/code&gt;çš„é”®æ—¶ï¼Œæ— æ³•ç”¨å¦ä¸€ä¸ªç›¸ç­‰çš„é”®æ£€ç´¢åˆ°ä¹‹å‰å­˜å…¥çš„å€¼ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å“ˆå¸Œå†²çªhashcodeç›¸åŒå´å¯èƒ½ä¸ç›¸ç­‰"&gt;ğŸ” å“ˆå¸Œå†²çªï¼šhashCodeç›¸åŒå´å¯èƒ½ä¸ç›¸ç­‰
&lt;/h3&gt;&lt;p&gt;å“ˆå¸Œç®—æ³•çš„ä»»åŠ¡æ˜¯å°†ä¸€ä¸ªä»»æ„å¤§å°çš„æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šå¤§å°çš„æ•´æ•°ï¼ˆå“ˆå¸Œå€¼ï¼‰ã€‚ç”±äºæ•´æ•°èŒƒå›´æ˜¯æœ‰é™çš„ï¼Œè€Œä¸åŒçš„å¯¹è±¡æ•°æ®æ˜¯è¿‘ä¹æ— é™çš„ï¼Œ&lt;strong&gt;ä¸åŒçš„å¯¹è±¡å®Œå…¨æœ‰å¯èƒ½è®¡ç®—å‡ºç›¸åŒçš„å“ˆå¸Œå€¼&lt;/strong&gt;ï¼Œè¿™ç§ç°è±¡ç§°ä¸º&lt;strong&gt;å“ˆå¸Œå†²çªï¼ˆHash Collisionï¼‰&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå½“ &lt;code&gt;c1.hashCode() == c2.hashCode()&lt;/code&gt;æ—¶ï¼Œ&lt;code&gt;c1.equals(c2)&lt;/code&gt;çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®ƒå¯èƒ½è¿”å› &lt;code&gt;true&lt;/code&gt;ï¼ˆè¯´æ˜ä¸¤ä¸ªå¯¹è±¡ç¡®å®ç›¸ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¹Ÿå¯èƒ½è¿”å› &lt;code&gt;false&lt;/code&gt;ï¼ˆè¯´æ˜ä¸¤ä¸ªå¯¹è±¡è™½ç„¶å“ˆå¸Œå€¼ç›¸åŒï¼Œä½†å®é™…ä¸Šæ˜¯ä¸åŒçš„å¯¹è±¡ï¼Œå‘ç”Ÿäº†å“ˆå¸Œå†²çªï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ˜¯ Java ä¸­çš„ &lt;code&gt;String&lt;/code&gt;ç±»ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String s1 = &amp;#34;é€šè¯&amp;#34;;
String s2 = &amp;#34;é‡åœ°&amp;#34;;
System.out.println(s1.hashCode()); // è¾“å‡º 1179395
System.out.println(s2.hashCode()); // è¾“å‡º 1179395
System.out.println(s1.equals(s2)); // è¾“å‡º false
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å¯¹å“ˆå¸Œé›†åˆçš„å½±å“"&gt;âš™ï¸ å¯¹å“ˆå¸Œé›†åˆçš„å½±å“
&lt;/h3&gt;&lt;p&gt;ä»¥ &lt;code&gt;HashMap&lt;/code&gt;ä¸ºä¾‹ï¼Œå…¶æŸ¥æ‰¾å’Œå­˜å‚¨å¯¹è±¡çš„è¿‡ç¨‹ç›´è§‚ä½“ç°äº†è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯å¦‚ä½•ååŒå·¥ä½œçš„ ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—å“ˆå¸Œå€¼&lt;/strong&gt;ï¼šå½“è¦å­˜å…¥æˆ–æŸ¥æ‰¾ä¸€ä¸ªé”®ï¼ˆkeyï¼‰æ—¶ï¼Œé¦–å…ˆä¼šè°ƒç”¨å®ƒçš„ &lt;code&gt;hashCode()&lt;/code&gt;æ–¹æ³•è®¡ç®—å“ˆå¸Œå€¼ï¼Œä»è€Œç¡®å®šå®ƒåœ¨å†…éƒ¨æ•°ç»„ï¼ˆé€šå¸¸ç§°ä¸ºâ€œæ¡¶â€ï¼‰ä¸­çš„ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç†å†²çª&lt;/strong&gt;ï¼šå¦‚æœè¯¥ä½ç½®å·²ç»æœ‰å…¶ä»–å…ƒç´ ï¼ˆå³å‘ç”Ÿäº†å“ˆå¸Œå†²çªï¼‰ï¼Œåˆ™ä¼šè°ƒç”¨ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•ä¾æ¬¡ä¸è¯¥ä½ç½®ä¸Šçš„æ‰€æœ‰å…ƒç´ è¿›è¡Œæ¯”è¾ƒã€‚
&lt;ul&gt;
&lt;li&gt;å¦‚æœå‘ç°ä¸æŸä¸ªç°æœ‰å…ƒç´  &lt;code&gt;equals()&lt;/code&gt;ä¸º &lt;code&gt;true&lt;/code&gt;ï¼Œåˆ™è®¤ä¸ºæ˜¯åŒä¸€ä¸ªé”®ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸æ‰€æœ‰ç°æœ‰å…ƒç´  &lt;code&gt;equals()&lt;/code&gt;éƒ½ä¸º &lt;code&gt;false&lt;/code&gt;ï¼Œåˆ™è®¤ä¸ºæ˜¯ä¸åŒçš„é”®ï¼Œä¼šæ”¾åœ¨è¿™ä¸ªæ¡¶å†…çš„é“¾è¡¨æˆ–çº¢é»‘æ ‘ä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œ&lt;code&gt;hashCode()&lt;/code&gt;ç”¨äº&lt;strong&gt;å¿«é€Ÿå®šä½ã€åˆæ­¥ç­›é€‰&lt;/strong&gt;ï¼Œè€Œ &lt;code&gt;equals()&lt;/code&gt;ç”¨äºåœ¨å†²çªå‘ç”Ÿåè¿›è¡Œ&lt;strong&gt;ç²¾ç¡®æ¯”è¾ƒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id="-æ€»ç»“ä¸æœ€ä½³å®è·µ-1"&gt;ğŸ’¡ æ€»ç»“ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç‰¢è®°å¥‘çº¦&lt;/strong&gt;ï¼š&lt;strong&gt;å¦‚æœ &lt;code&gt;equals()&lt;/code&gt;ç›¸ç­‰ï¼Œåˆ™ &lt;code&gt;hashCode()&lt;/code&gt;å¿…é¡»ç›¸ç­‰&lt;/strong&gt;ã€‚åä¹‹ä¸ä¸€å®šæˆç«‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å§‹ç»ˆåŒæ—¶é‡å†™&lt;/strong&gt;ï¼šå½“ä½ é‡å†™ä¸€ä¸ªç±»çš„ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•æ—¶ï¼Œ&lt;strong&gt;å¿…é¡»åŒæ—¶é‡å†™ &lt;code&gt;hashCode()&lt;/code&gt;&lt;/strong&gt; æ–¹æ³•ï¼Œä»¥ç¡®ä¿å¥‘çº¦æˆç«‹ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨ç›¸åŒå­—æ®µ&lt;/strong&gt;ï¼š&lt;code&gt;hashCode()&lt;/code&gt;å’Œ &lt;code&gt;equals()&lt;/code&gt;åº”åŸºäº&lt;strong&gt;ç›¸åŒçš„æ ¸å¿ƒå­—æ®µé›†&lt;/strong&gt;æ¥è®¡ç®—å’Œæ¯”è¾ƒã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ &lt;code&gt;equals()&lt;/code&gt;æ–¹æ³•åªæ¯”è¾ƒäº† &lt;code&gt;id&lt;/code&gt;å­—æ®µï¼Œé‚£ä¹ˆ &lt;code&gt;hashCode()&lt;/code&gt;ä¹Ÿåº”è¯¥åªè®¡ç®— &lt;code&gt;id&lt;/code&gt;å­—æ®µçš„å“ˆå¸Œå€¼ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å€ŸåŠ©å·¥å…·æ–¹æ³•&lt;/strong&gt;ï¼šå¯ä»¥ä½¿ç”¨ &lt;code&gt;Objects.hash(Object... values)&lt;/code&gt;æ–¹æ³•æ¥æ–¹ä¾¿åœ°ç”ŸæˆåŸºäºå¤šä¸ªå­—æ®µçš„å“ˆå¸Œå€¼ï¼Œå®ƒå¾ˆå¥½åœ°å¤„ç†äº† &lt;code&gt;null&lt;/code&gt;å€¼çš„æƒ…å†µ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å¯å˜å­—æ®µ&lt;/strong&gt;ï¼šæœ€å¥½ä½¿ç”¨ä¸å¯å˜å­—æ®µï¼ˆå¦‚ &lt;code&gt;final&lt;/code&gt;å­—æ®µï¼‰æ¥è®¡ç®—å“ˆå¸Œç ï¼Œå¦åˆ™å¯¹è±¡çŠ¶æ€æ”¹å˜åï¼Œå“ˆå¸Œç ä¹Ÿå¯èƒ½æ”¹å˜ï¼Œä»è€Œå¯¼è‡´åœ¨é›†åˆä¸­æ‰¾ä¸åˆ°è¯¥å¯¹è±¡ç­‰ä¸å¯é¢„çŸ¥çš„è¡Œä¸ºã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç†è§£ &lt;code&gt;hashCode()&lt;/code&gt;å’Œ &lt;code&gt;equals()&lt;/code&gt;çš„å…³ç³»ï¼Œæ˜¯ç¼–å†™æ­£ç¡®ã€é«˜æ•ˆ Java ç¨‹åºçš„å…³é”®ä¹‹ä¸€ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨å“ˆå¸Œé›†åˆæ—¶ã€‚&lt;/p&gt;
&lt;h2 id="jdk-åŠ¨æ€ä»£ç†"&gt;JDK åŠ¨æ€ä»£ç†
&lt;/h2&gt;&lt;p&gt;JDK åŠ¨æ€ä»£ç†çš„å®ç°é«˜åº¦ä¾èµ–äº Java çš„ &lt;strong&gt;æ¥å£æœºåˆ¶&lt;/strong&gt; å’Œ &lt;strong&gt;å•ç»§æ‰¿&lt;/strong&gt; çš„ç±»ä½“ç³»ã€‚ä¸‹é¢è¿™å¼ è¡¨æ ¼æ±‡æ€»äº†å…¶æ ¸å¿ƒæœºåˆ¶å’ŒåŸå› ï¼Œå¸®åŠ©ä½ å¿«é€Ÿç†è§£ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;å…·ä½“è¯´æ˜&lt;/th&gt;
&lt;th&gt;åœ¨ JDK åŠ¨æ€ä»£ç†ä¸­çš„ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šå®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£&lt;/td&gt;
&lt;td&gt;ä»£ç†ç±»å¯ä»¥åŒæ—¶å®ç°ç›®æ ‡ç±»çš„æ‰€æœ‰æ¥å£ï¼Œå¹¶èƒ½ç»§æ‰¿ &lt;code&gt;Proxy&lt;/code&gt;ç±»ï¼Œä»è€Œå…·å¤‡åŒé‡â€œèº«ä»½â€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•ç­¾åå¥‘çº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¥å£å®šä¹‰äº†æ¸…æ™°çš„æ–¹æ³•ç­¾åï¼ˆæ–¹æ³•åã€å‚æ•°ã€è¿”å›ç±»å‹ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸ºåŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»æä¾›äº†è¦å®ç°çš„&lt;strong&gt;æ–¹æ³•æ¨¡æ¿&lt;/strong&gt;ï¼Œç¡®ä¿äº†ä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡åœ¨æ–¹æ³•è°ƒç”¨å½¢å¼ä¸Šçš„ä¸€è‡´æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»å‹å¤šæ€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®¢æˆ·ç«¯ä»£ç å¯ä»¥ä¾èµ–äºæ¥å£ç±»å‹ï¼Œè€Œéå…·ä½“å®ç°ç±»&lt;/td&gt;
&lt;td&gt;ä»£ç†å¯¹è±¡å¯ä»¥&lt;strong&gt;å‘ä¸Šè½¬å‹&lt;/strong&gt;ä¸ºæ¥å£ç±»å‹ï¼Œä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä»¥ç»Ÿä¸€çš„æ–¹å¼ä¸ä»£ç†å¯¹è±¡æˆ–çœŸå®ç›®æ ‡å¯¹è±¡äº¤äº’ï¼Œå®ç°äº†å¯¹å®¢æˆ·ç«¯ç¨‹åºçš„é€æ˜æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å•ç»§æ‰¿é™åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Java ç±»åªèƒ½ç›´æ¥ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Proxy&lt;/code&gt;ç±»æœ¬èº«å·²æ˜¯ä»£ç†ç±»çš„çˆ¶ç±»ï¼Œå› æ­¤ä»£ç†ç±»&lt;strong&gt;æ— æ³•å†ç»§æ‰¿&lt;/strong&gt;å…¶ä»–ç±»ï¼ˆåŒ…æ‹¬ä½ çš„ç›®æ ‡ç±»ï¼‰ã€‚å®ç°æ¥å£æ˜¯å”¯ä¸€é€‰æ‹©ï¼Œè¿™é¿å…äº†ä¸å•ç»§æ‰¿æœºåˆ¶çš„å†²çª&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¿…é¡»å®ç°æ¥å£çš„åŸå› "&gt;ğŸ§© å¿…é¡»å®ç°æ¥å£çš„åŸå› 
&lt;/h3&gt;&lt;p&gt;JDK åŠ¨æ€ä»£ç†è¦æ±‚ç›®æ ‡ç±»å¿…é¡»å®ç°è‡³å°‘ä¸€ä¸ªæ¥å£ï¼Œä¸»è¦åŸºäºä»¥ä¸‹æ ¸å¿ƒåŸå› ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Java å•ç»§æ‰¿æœºåˆ¶çš„é™åˆ¶&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€æ ¹æœ¬çš„åŸå› ã€‚JDK åŠ¨æ€ä»£ç†æŠ€æœ¯ç”Ÿæˆçš„ä»£ç†ç±»åœ¨å­—èŠ‚ç å±‚é¢å·²ç»&lt;strong&gt;éšå¼åœ°ç»§æ‰¿äº† &lt;code&gt;java.lang.reflect.Proxy&lt;/code&gt;ç±»&lt;/strong&gt;ã€‚ç”±äº Java æ˜¯å•ç»§æ‰¿çš„ï¼Œä»£ç†ç±»&lt;strong&gt;ä¸èƒ½å†æ˜¾å¼åœ°å»ç»§æ‰¿ä½ çš„ç›®æ ‡ç±»&lt;/strong&gt;ã€‚å› æ­¤ï¼Œå®ƒåªèƒ½é€šè¿‡&lt;strong&gt;å®ç°ç›®æ ‡æ¥å£&lt;/strong&gt;çš„æ–¹å¼æ¥å®ç°ä»£ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆä»£ç†ç±»çš„éœ€è¦&lt;/strong&gt;ï¼š&lt;code&gt;Proxy.newProxyInstance()&lt;/code&gt;æ–¹æ³•éœ€è¦æ˜ç¡®çŸ¥é“ä½ è¦ä»£ç†å“ªäº›æ–¹æ³•ã€‚æ¥å£æä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ–¹æ³•å¥‘çº¦ï¼ˆæ–¹æ³•ç­¾ååˆ—è¡¨ï¼‰ï¼ŒJDK åŠ¨æ€ä»£ç†æœºåˆ¶æ­£æ˜¯åŸºäºè¿™äº›æ¥å£ä¿¡æ¯æ¥&lt;strong&gt;åŠ¨æ€ç”Ÿæˆå®ç°äº†è¯¥æ¥å£çš„ä»£ç†ç±»&lt;/strong&gt;ã€‚å¦‚æœç›®æ ‡ç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œä»£ç†æœºåˆ¶å°±æ— æ³•ç¡®å®šåº”è¯¥ä»£ç†å“ªäº›å…¬å…±æ–¹æ³•ï¼Œä»è€Œæ— æ³•å·¥ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘æ¥å£ç¼–ç¨‹çš„é¼“åŠ±&lt;/strong&gt;ï¼šè¿™ä¸ªé™åˆ¶ä¹Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Š&lt;strong&gt;é¼“åŠ±äº†æ›´å¥½çš„ç¼–ç¨‹å®è·µ&lt;/strong&gt;â€”â€”é¢å‘æ¥å£ç¼–ç¨‹ï¼ˆè€Œéé¢å‘å®ç°ç¼–ç¨‹ï¼‰ã€‚è¿™æœ‰åŠ©äºå®ç°æ¾è€¦åˆå’Œæ›´é«˜çš„ä»£ç æŠ½è±¡å±‚æ¬¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-é‡è¦æé†’-1"&gt;âš–ï¸ é‡è¦æé†’
&lt;/h3&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJDK åŠ¨æ€ä»£ç†&lt;strong&gt;åªèƒ½ä»£ç†æ¥å£ä¸­å£°æ˜çš„æ–¹æ³•&lt;/strong&gt;ã€‚å¦‚æœç›®æ ‡ç±»ä¸­æœ‰éæ¥å£å®šä¹‰çš„æ–¹æ³•ï¼ˆåŒ…æ‹¬æ¥è‡ª &lt;code&gt;Object&lt;/code&gt;ç±»çš„æ–¹æ³•å¦‚ &lt;code&gt;toString&lt;/code&gt;ã€&lt;code&gt;hashCode&lt;/code&gt;ç­‰ï¼Œæˆ–åœ¨ç±»ä¸­è‡ªå®šä¹‰ä½†æœªåœ¨æ¥å£ä¸­å£°æ˜çš„æ–¹æ³•ï¼‰ï¼Œ&lt;strong&gt;è¿™äº›æ–¹æ³•ä¸Šçš„è°ƒç”¨ä¸ä¼šè¢«ä»£ç†æ‹¦æˆª&lt;/strong&gt;ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡ä¸Šçš„è¯¥æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id="-å¦‚ä½•ç»•è¿‡æ¥å£é™åˆ¶"&gt;ğŸ”§ å¦‚ä½•ç»•è¿‡æ¥å£é™åˆ¶ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;å¦‚æœä½ çš„ç›®æ ‡ç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œä½†åˆéœ€è¦ä¸ºå…¶åˆ›å»ºä»£ç†ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹æ›¿ä»£æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CGLIB åŠ¨æ€ä»£ç†&lt;/strong&gt;ï¼šè¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç¬¬ä¸‰æ–¹å­—èŠ‚ç ç”Ÿæˆåº“ã€‚å®ƒé€šè¿‡&lt;strong&gt;åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»&lt;/strong&gt;æ¥å®ç°ä»£ç†ã€‚ç”±äºæ˜¯ç»§æ‰¿ï¼Œå®ƒè‡ªç„¶èƒ½ä»£ç†æ‰€æœ‰&lt;strong&gt;é final&lt;/strong&gt; çš„å…¬å…±å’Œæ–¹æ³•ã€‚è®¸å¤šæ¡†æ¶ï¼ˆå¦‚ Spring AOPï¼‰åœ¨ç›®æ ‡ç±»æ— æ¥å£æ—¶å°±é»˜è®¤ä½¿ç”¨ CGLIBã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¯¹æ¯”-jdk-ä¸-cglib-åŠ¨æ€ä»£ç†"&gt;ğŸ“Š å¯¹æ¯” JDK ä¸ CGLIB åŠ¨æ€ä»£ç†
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;JDK åŠ¨æ€ä»£ç†&lt;/th&gt;
&lt;th&gt;CGLIB åŠ¨æ€ä»£ç†&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäºæ¥å£å®ç°&lt;/td&gt;
&lt;td&gt;åŸºäºç»§æ‰¿ï¼ˆå­ç±»åŒ–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›®æ ‡è¦æ±‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿…é¡»å®ç°è‡³å°‘ä¸€ä¸ªæ¥å£&lt;/td&gt;
&lt;td&gt;ç±»ä¸èƒ½æ˜¯ &lt;code&gt;final&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•é™åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åªèƒ½ä»£ç†æ¥å£æ–¹æ³•&lt;/td&gt;
&lt;td&gt;æ— æ³•ä»£ç† &lt;code&gt;final&lt;/code&gt;æˆ– &lt;code&gt;private&lt;/code&gt;æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆä»£ç†ç±»è¾ƒå¿«ï¼Œä½†æ–¹æ³•è°ƒç”¨ï¼ˆåå°„ï¼‰ç¨æ…¢&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆä»£ç†ç±»è¾ƒæ…¢ï¼Œä½†æ–¹æ³•è°ƒç”¨ï¼ˆé€šå¸¸ï¼‰æ›´å¿«&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¸Œæœ›ä»¥ä¸Šè§£é‡Šèƒ½å¸®åŠ©ä½ é€å½»ç†è§£ JDK åŠ¨æ€ä»£ç†ä¸æ¥å£çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;h2 id="jdk-åŠ¨æ€ä»£ç†é™åˆ¶æ¥æº"&gt;JDK åŠ¨æ€ä»£ç†é™åˆ¶æ¥æº
&lt;/h2&gt;&lt;p&gt;JDK åŠ¨æ€ä»£ç†çš„å®ç°é«˜åº¦ä¾èµ–äº Java çš„ &lt;strong&gt;æ¥å£æœºåˆ¶&lt;/strong&gt; å’Œ &lt;strong&gt;å•ç»§æ‰¿&lt;/strong&gt; çš„ç±»ä½“ç³»ã€‚ä¸‹é¢è¿™å¼ è¡¨æ ¼æ±‡æ€»äº†å…¶æ ¸å¿ƒæœºåˆ¶å’ŒåŸå› ï¼Œå¸®åŠ©ä½ å¿«é€Ÿç†è§£ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;å…·ä½“è¯´æ˜&lt;/th&gt;
&lt;th&gt;åœ¨ JDK åŠ¨æ€ä»£ç†ä¸­çš„ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šå®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£&lt;/td&gt;
&lt;td&gt;ä»£ç†ç±»å¯ä»¥åŒæ—¶å®ç°ç›®æ ‡ç±»çš„æ‰€æœ‰æ¥å£ï¼Œå¹¶èƒ½ç»§æ‰¿ &lt;code&gt;Proxy&lt;/code&gt;ç±»ï¼Œä»è€Œå…·å¤‡åŒé‡â€œèº«ä»½â€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•ç­¾åå¥‘çº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¥å£å®šä¹‰äº†æ¸…æ™°çš„æ–¹æ³•ç­¾åï¼ˆæ–¹æ³•åã€å‚æ•°ã€è¿”å›ç±»å‹ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸ºåŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»æä¾›äº†è¦å®ç°çš„&lt;strong&gt;æ–¹æ³•æ¨¡æ¿&lt;/strong&gt;ï¼Œç¡®ä¿äº†ä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡åœ¨æ–¹æ³•è°ƒç”¨å½¢å¼ä¸Šçš„ä¸€è‡´æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»å‹å¤šæ€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®¢æˆ·ç«¯ä»£ç å¯ä»¥ä¾èµ–äºæ¥å£ç±»å‹ï¼Œè€Œéå…·ä½“å®ç°ç±»&lt;/td&gt;
&lt;td&gt;ä»£ç†å¯¹è±¡å¯ä»¥&lt;strong&gt;å‘ä¸Šè½¬å‹&lt;/strong&gt;ä¸ºæ¥å£ç±»å‹ï¼Œä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä»¥ç»Ÿä¸€çš„æ–¹å¼ä¸ä»£ç†å¯¹è±¡æˆ–çœŸå®ç›®æ ‡å¯¹è±¡äº¤äº’ï¼Œå®ç°äº†å¯¹å®¢æˆ·ç«¯ç¨‹åºçš„é€æ˜æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å•ç»§æ‰¿é™åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Java ç±»åªèƒ½ç›´æ¥ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Proxy&lt;/code&gt;ç±»æœ¬èº«å·²æ˜¯ä»£ç†ç±»çš„çˆ¶ç±»ï¼Œå› æ­¤ä»£ç†ç±»&lt;strong&gt;æ— æ³•å†ç»§æ‰¿&lt;/strong&gt;å…¶ä»–ç±»ï¼ˆåŒ…æ‹¬ä½ çš„ç›®æ ‡ç±»ï¼‰ã€‚å®ç°æ¥å£æ˜¯å”¯ä¸€é€‰æ‹©ï¼Œè¿™é¿å…äº†ä¸å•ç»§æ‰¿æœºåˆ¶çš„å†²çª&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¿…é¡»å®ç°æ¥å£çš„åŸå› -1"&gt;ğŸ§© å¿…é¡»å®ç°æ¥å£çš„åŸå› 
&lt;/h3&gt;&lt;p&gt;JDK åŠ¨æ€ä»£ç†è¦æ±‚ç›®æ ‡ç±»å¿…é¡»å®ç°è‡³å°‘ä¸€ä¸ªæ¥å£ï¼Œä¸»è¦åŸºäºä»¥ä¸‹æ ¸å¿ƒåŸå› ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Java å•ç»§æ‰¿æœºåˆ¶çš„é™åˆ¶&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€æ ¹æœ¬çš„åŸå› ã€‚JDK åŠ¨æ€ä»£ç†æŠ€æœ¯ç”Ÿæˆçš„ä»£ç†ç±»åœ¨å­—èŠ‚ç å±‚é¢å·²ç»&lt;strong&gt;éšå¼åœ°ç»§æ‰¿äº† &lt;code&gt;java.lang.reflect.Proxy&lt;/code&gt;ç±»&lt;/strong&gt;ã€‚ç”±äº Java æ˜¯å•ç»§æ‰¿çš„ï¼Œä»£ç†ç±»&lt;strong&gt;ä¸èƒ½å†æ˜¾å¼åœ°å»ç»§æ‰¿ä½ çš„ç›®æ ‡ç±»&lt;/strong&gt;ã€‚å› æ­¤ï¼Œå®ƒåªèƒ½é€šè¿‡&lt;strong&gt;å®ç°ç›®æ ‡æ¥å£&lt;/strong&gt;çš„æ–¹å¼æ¥å®ç°ä»£ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆä»£ç†ç±»çš„éœ€è¦&lt;/strong&gt;ï¼š&lt;code&gt;Proxy.newProxyInstance()&lt;/code&gt;æ–¹æ³•éœ€è¦æ˜ç¡®çŸ¥é“ä½ è¦ä»£ç†å“ªäº›æ–¹æ³•ã€‚æ¥å£æä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ–¹æ³•å¥‘çº¦ï¼ˆæ–¹æ³•ç­¾ååˆ—è¡¨ï¼‰ï¼ŒJDK åŠ¨æ€ä»£ç†æœºåˆ¶æ­£æ˜¯åŸºäºè¿™äº›æ¥å£ä¿¡æ¯æ¥&lt;strong&gt;åŠ¨æ€ç”Ÿæˆå®ç°äº†è¯¥æ¥å£çš„ä»£ç†ç±»&lt;/strong&gt;ã€‚å¦‚æœç›®æ ‡ç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œä»£ç†æœºåˆ¶å°±æ— æ³•ç¡®å®šåº”è¯¥ä»£ç†å“ªäº›å…¬å…±æ–¹æ³•ï¼Œä»è€Œæ— æ³•å·¥ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘æ¥å£ç¼–ç¨‹çš„é¼“åŠ±&lt;/strong&gt;ï¼šè¿™ä¸ªé™åˆ¶ä¹Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Š&lt;strong&gt;é¼“åŠ±äº†æ›´å¥½çš„ç¼–ç¨‹å®è·µ&lt;/strong&gt;â€”â€”é¢å‘æ¥å£ç¼–ç¨‹ï¼ˆè€Œéé¢å‘å®ç°ç¼–ç¨‹ï¼‰ã€‚è¿™æœ‰åŠ©äºå®ç°æ¾è€¦åˆå’Œæ›´é«˜çš„ä»£ç æŠ½è±¡å±‚æ¬¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-é‡è¦æé†’-2"&gt;âš–ï¸ é‡è¦æé†’
&lt;/h3&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJDK åŠ¨æ€ä»£ç†&lt;strong&gt;åªèƒ½ä»£ç†æ¥å£ä¸­å£°æ˜çš„æ–¹æ³•&lt;/strong&gt;ã€‚å¦‚æœç›®æ ‡ç±»ä¸­æœ‰éæ¥å£å®šä¹‰çš„æ–¹æ³•ï¼ˆåŒ…æ‹¬æ¥è‡ª &lt;code&gt;Object&lt;/code&gt;ç±»çš„æ–¹æ³•å¦‚ &lt;code&gt;toString&lt;/code&gt;ã€&lt;code&gt;hashCode&lt;/code&gt;ç­‰ï¼Œæˆ–åœ¨ç±»ä¸­è‡ªå®šä¹‰ä½†æœªåœ¨æ¥å£ä¸­å£°æ˜çš„æ–¹æ³•ï¼‰ï¼Œ&lt;strong&gt;è¿™äº›æ–¹æ³•ä¸Šçš„è°ƒç”¨ä¸ä¼šè¢«ä»£ç†æ‹¦æˆª&lt;/strong&gt;ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡ä¸Šçš„è¯¥æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id="-å¦‚ä½•ç»•è¿‡æ¥å£é™åˆ¶-1"&gt;ğŸ”§ å¦‚ä½•ç»•è¿‡æ¥å£é™åˆ¶ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;å¦‚æœä½ çš„ç›®æ ‡ç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œä½†åˆéœ€è¦ä¸ºå…¶åˆ›å»ºä»£ç†ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹æ›¿ä»£æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CGLIB åŠ¨æ€ä»£ç†&lt;/strong&gt;ï¼šè¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç¬¬ä¸‰æ–¹å­—èŠ‚ç ç”Ÿæˆåº“ã€‚å®ƒé€šè¿‡&lt;strong&gt;åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»&lt;/strong&gt;æ¥å®ç°ä»£ç†ã€‚ç”±äºæ˜¯ç»§æ‰¿ï¼Œå®ƒè‡ªç„¶èƒ½ä»£ç†æ‰€æœ‰&lt;strong&gt;é final&lt;/strong&gt; çš„å…¬å…±å’Œæ–¹æ³•ã€‚è®¸å¤šæ¡†æ¶ï¼ˆå¦‚ Spring AOPï¼‰åœ¨ç›®æ ‡ç±»æ— æ¥å£æ—¶å°±é»˜è®¤ä½¿ç”¨ CGLIBã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¯¹æ¯”-jdk-ä¸-cglib-åŠ¨æ€ä»£ç†-1"&gt;ğŸ“Š å¯¹æ¯” JDK ä¸ CGLIB åŠ¨æ€ä»£ç†
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;JDK åŠ¨æ€ä»£ç†&lt;/th&gt;
&lt;th&gt;CGLIB åŠ¨æ€ä»£ç†&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäºæ¥å£å®ç°&lt;/td&gt;
&lt;td&gt;åŸºäºç»§æ‰¿ï¼ˆå­ç±»åŒ–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›®æ ‡è¦æ±‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿…é¡»å®ç°è‡³å°‘ä¸€ä¸ªæ¥å£&lt;/td&gt;
&lt;td&gt;ç±»ä¸èƒ½æ˜¯ &lt;code&gt;final&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•é™åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åªèƒ½ä»£ç†æ¥å£æ–¹æ³•&lt;/td&gt;
&lt;td&gt;æ— æ³•ä»£ç† &lt;code&gt;final&lt;/code&gt;æˆ– &lt;code&gt;private&lt;/code&gt;æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆä»£ç†ç±»è¾ƒå¿«ï¼Œä½†æ–¹æ³•è°ƒç”¨ï¼ˆåå°„ï¼‰ç¨æ…¢&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆä»£ç†ç±»è¾ƒæ…¢ï¼Œä½†æ–¹æ³•è°ƒç”¨ï¼ˆé€šå¸¸ï¼‰æ›´å¿«&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¸Œæœ›ä»¥ä¸Šè§£é‡Šèƒ½å¸®åŠ©ä½ é€å½»ç†è§£ JDK åŠ¨æ€ä»£ç†ä¸æ¥å£çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;h2 id="å•ç»§æ‰¿"&gt;å•ç»§æ‰¿
&lt;/h2&gt;&lt;p&gt;Java åœ¨å­—èŠ‚ç å±‚é¢ç»´æŒå•ç»§æ‰¿é™åˆ¶ï¼Œä¸»è¦æ˜¯ä¸ºäº† &lt;strong&gt;ä¿æŒè¯­è¨€è®¾è®¡çš„ä¸€è‡´æ€§ã€ç¡®ä¿è™šæ‹Ÿæœºçš„ç®€å•é«˜æ•ˆï¼Œä»¥åŠé¿å…å¤šç»§æ‰¿å¸¦æ¥çš„å¤æ‚æ€§é—®é¢˜&lt;/strong&gt;ã€‚ä¸‹é¢æˆ‘å°†ä»å‡ ä¸ªå…³é”®è§’åº¦ä¸ºä½ è§£é‡ŠåŸå› ï¼Œå¹¶ç”¨ä¸€ä¸ªè¡¨æ ¼å¸®ä½ å¿«é€Ÿäº†è§£ä¸»è¦è€ƒè™‘å› ç´ ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç»´åº¦&lt;/th&gt;
&lt;th&gt;å•ç»§æ‰¿ (Java çš„é€‰æ‹©)&lt;/th&gt;
&lt;th&gt;å‡æƒ³çš„å¤šç»§æ‰¿ (Java æœªé€‰æ‹©)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—èŠ‚ç éªŒè¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€åŒ–éªŒè¯è¿‡ç¨‹ï¼Œç±»å…³ç³»æ¸…æ™°ï¼Œå®¹æ˜“ç¡®ä¿ç±»å‹å®‰å…¨&lt;/td&gt;
&lt;td&gt;éªŒè¯é€»è¾‘ä¼šå˜å¾—å¼‚å¸¸å¤æ‚ï¼Œéœ€è¦å¤„ç†å¤šä¸ªçˆ¶ç±»çš„å†²çªå’Œæ­§ä¹‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•è°ƒç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;invokevirtual&lt;/code&gt;ç­‰æŒ‡ä»¤å¯ä»¥å¿«é€Ÿè§£æç›®æ ‡æ–¹æ³•ï¼Œæ€§èƒ½ predictable&lt;/td&gt;
&lt;td&gt;æ–¹æ³•åˆ†æ´¾ï¼ˆMethod Dispatchï¼‰è§„åˆ™å¤æ‚ï¼Œæ€§èƒ½å¯èƒ½å—å½±å“ï¼Œä¸”å®¹æ˜“äº§ç”Ÿæ­§ä¹‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å¸ƒå±€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹è±¡å†…å­˜å¸ƒå±€ç¨³å®šï¼Œå­—æ®µåç§»é‡å›ºå®šï¼Œæ˜“äºä¼˜åŒ–&lt;/td&gt;
&lt;td&gt;éœ€è¦å¤„ç†å¤šä¸ªçˆ¶ç±»å¯èƒ½é‡å çš„å­—æ®µå¸ƒå±€ï¼Œå¢åŠ å†…å­˜ç®¡ç†å’Œè®¿é—®å¤æ‚åº¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯­è¨€è®¾è®¡å“²å­¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºè°ƒ&lt;strong&gt;ç®€å•æ€§&lt;/strong&gt;å’Œ&lt;strong&gt;æ¸…æ™°æ€§&lt;/strong&gt;ï¼Œé¿å…è±å½¢é—®é¢˜ç­‰&lt;/td&gt;
&lt;td&gt;å…è®¸æ›´å¤§çš„çµæ´»æ€§ï¼Œä½†ä»£ä»·æ˜¯æ›´é«˜çš„å¤æ‚æ€§å’Œæ½œåœ¨çš„ç¼ºé™·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡&lt;strong&gt;æ¥å£&lt;/strong&gt;ï¼ˆ&lt;code&gt;implements&lt;/code&gt;ï¼‰å®ç°å¤šç»§æ‰¿çš„è¡Œä¸ºï¼Œé¿å…ä¸Šè¿°é—®é¢˜&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ·±å…¥ç†è§£å­—èŠ‚ç å±‚é¢çš„å•ç»§æ‰¿"&gt;ğŸ§  æ·±å…¥ç†è§£å­—èŠ‚ç å±‚é¢çš„å•ç»§æ‰¿
&lt;/h3&gt;&lt;p&gt;Java çš„å­—èŠ‚ç ï¼ˆBytecodeï¼‰æ˜¯ JVM çš„æŒ‡ä»¤é›†ï¼Œå®ƒå¿…é¡»å¿ å®åœ°åæ˜  Java è¯­è¨€æœ¬èº«çš„è§„èŒƒã€‚Java è¯­è¨€è§„å®šç±»åªèƒ½å•ç»§æ‰¿ï¼Œè¿™ä¸€é™åˆ¶ä¹Ÿå¿…ç„¶ä½“ç°åœ¨å­—èŠ‚ç å±‚é¢ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ç»“æ„ä¸­çš„ç›´æ¥ä½“ç°&lt;/strong&gt;ï¼šåœ¨ç¼–è¯‘åçš„ &lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ä¸­ï¼Œç±»çš„ç»§æ‰¿ä¿¡æ¯é€šè¿‡ &lt;code&gt;super_class&lt;/code&gt;é¡¹æ¥è¡¨ç¤ºã€‚è¿™ä¸ªé¡¹æ˜¯ä¸€ä¸ªæŒ‡å‘å¸¸é‡æ± çš„ç´¢å¼•ï¼Œ&lt;strong&gt;æ˜ç¡®æŒ‡å‘ä¸”åªèƒ½æŒ‡å‘ä¸€ä¸ªçˆ¶ç±»&lt;/strong&gt;ï¼ˆé™¤äº† &lt;code&gt;java.lang.Object&lt;/code&gt;ï¼Œå®ƒæ˜¯æ‰€æœ‰ç±»çš„æ ¹ï¼Œå…¶ &lt;code&gt;super_class&lt;/code&gt;ä¸º 0ï¼‰ã€‚è¿™ç§ç»“æ„ä»äºŒè¿›åˆ¶æ ¼å¼ä¸Šå°±å¼ºåˆ¶è§„å®šäº†å•ç»§æ‰¿ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;JVM æ–¹æ³•è°ƒç”¨çš„åŸºçŸ³ï¼š&lt;code&gt;invokevirtual&lt;/code&gt;&lt;/strong&gt;ï¼šJVM é€šè¿‡ &lt;code&gt;invokevirtual&lt;/code&gt;æŒ‡ä»¤å®ç°è™šæ–¹æ³•åˆ†æ´¾ï¼ˆVirtual Method Dispatchï¼‰ï¼Œè¿™æ˜¯å¤šæ€æ€§çš„åŸºç¡€ã€‚è¯¥æŒ‡ä»¤çš„å·¥ä½œåŸç†æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é¦–å…ˆè·å–å¯¹è±¡çš„å®é™…ç±»å‹ï¼ˆåœ¨è¿è¡Œæ—¶ç¡®å®šï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç„¶åä»è¿™ä¸ªå®é™…ç±»å‹å¼€å§‹ï¼Œæ²¿ç€&lt;strong&gt;å•ä¸€è·¯å¾„&lt;/strong&gt;çš„ç»§æ‰¿é“¾å‘ä¸ŠæŸ¥æ‰¾è¦æ‰§è¡Œçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å•ç»§æ‰¿ç¡®ä¿äº†è¿™æ¡ç»§æ‰¿é“¾æ˜¯çº¿æ€§çš„ã€æ— æ­§ä¹‰çš„&lt;/strong&gt;ã€‚å¦‚æœå…è®¸å¤šç»§æ‰¿ï¼Œç»§æ‰¿ç½‘ä¼šå˜æˆå¤æ‚çš„å›¾ç»“æ„ï¼Œ&lt;code&gt;invokevirtual&lt;/code&gt;æŒ‡ä»¤å°†æ— æ³•é«˜æ•ˆä¸”æ˜ç¡®åœ°ç¡®å®šæ–¹æ³•æ‰€å±çš„ç±»ï¼Œä»è€Œéœ€è¦éå¸¸å¤æ‚çš„ç®—æ³•æ¥è§£å†³å†²çªï¼Œè¿™ä¼šæ˜¾è‘—å¢åŠ  JVM çš„å¤æ‚æ€§å’Œæ€§èƒ½å¼€é”€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯¹è±¡å†…å­˜å¸ƒå±€çš„ç¨³å®šæ€§&lt;/strong&gt;ï¼šåœ¨ JVM ä¸­ï¼Œä¸€ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€ï¼ˆåŒ…æ‹¬å®ä¾‹å­—æ®µçš„åç§»é‡ï¼‰åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç”±å…¶ç±»ç»§æ‰¿å…³ç³»å†³å®šçš„ã€‚å•ç»§æ‰¿æ„å‘³ç€æ¯ä¸ªç±»éƒ½æœ‰ä¸€æ¡æ¸…æ™°çš„ç»§æ‰¿é“¾ï¼ˆä¾‹å¦‚ &lt;code&gt;Object -&amp;gt; A -&amp;gt; B&lt;/code&gt;ï¼‰ï¼ŒJVM å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¡ç®—å’Œä¼˜åŒ–æ¯ä¸ªå­—æ®µåœ¨å†…å­˜ä¸­çš„ä½ç½®ã€‚å¤šç»§æ‰¿ä¼šå¯¼è‡´å¤šä¸ªçˆ¶ç±»çš„å­—æ®µå¯èƒ½éœ€è¦åˆå¹¶åˆ°å­ç±»ä¸­ï¼Œææ˜“äº§ç”Ÿ&lt;strong&gt;å­—æ®µå†²çª&lt;/strong&gt;å’Œ&lt;strong&gt;å¸ƒå±€æ­§ä¹‰&lt;/strong&gt;ï¼Œä½¿å¾—å†…å­˜ç®¡ç†å˜å¾—å¤æ‚ï¼Œå¹¶å¯èƒ½ç ´åä¼˜åŒ–çš„å¯èƒ½æ€§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å­—èŠ‚ç éªŒè¯å™¨çš„éœ€è¦&lt;/strong&gt;ï¼šJVM åœ¨åŠ è½½ç±»æ—¶ä¼šæ‰§è¡Œä¸¥æ ¼çš„å­—èŠ‚ç éªŒè¯ï¼Œä»¥ç¡®ä¿ä»£ç ä¸ä¼šç ´å JVM çš„å®‰å…¨æ€§ã€‚å•ç»§æ‰¿æå¤§åœ°ç®€åŒ–äº†éªŒè¯è¿‡ç¨‹ï¼Œä¾‹å¦‚åœ¨æ£€æŸ¥ç±»å‹è½¬æ¢ï¼ˆ&lt;code&gt;checkcast&lt;/code&gt;ï¼‰å’Œæ–¹æ³•è¦†ç›–ï¼ˆ&lt;code&gt;override&lt;/code&gt;ï¼‰æ—¶ï¼ŒéªŒè¯å™¨å¯ä»¥æ²¿ç€æ¸…æ™°çš„å•é“¾å‘ä¸Šæ£€æŸ¥ã€‚å¤šç»§æ‰¿ä¼šä½¿è¿™äº›æ£€æŸ¥å˜å¾—æå…¶å¤æ‚ï¼Œéš¾ä»¥ä¿è¯å¯é æ€§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•ç»•è¿‡å•ç»§æ‰¿é™åˆ¶"&gt;ğŸ”„ å¦‚ä½•ç»•è¿‡å•ç»§æ‰¿é™åˆ¶
&lt;/h3&gt;&lt;p&gt;Java é€šè¿‡æ¥å£ï¼ˆ&lt;code&gt;interface&lt;/code&gt;ï¼‰æ¥å¼¥è¡¥å•ç»§æ‰¿åœ¨åŠŸèƒ½å¤ç”¨ä¸Šçš„ä¸è¶³ã€‚ä¸€ä¸ªç±»è™½ç„¶åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†å¯ä»¥&lt;strong&gt;å®ç°å¤šä¸ªæ¥å£&lt;/strong&gt;ï¼ˆ&lt;code&gt;implements&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£ä¸å¤šç»§æ‰¿çš„åŒºåˆ«&lt;/strong&gt;ï¼šæ¥å£é€šå¸¸åªå®šä¹‰æ–¹æ³•å¥‘çº¦ï¼ˆJava 8 åå¯ä»¥æœ‰é»˜è®¤å®ç°ï¼‰ï¼Œè€Œä¸å®šä¹‰å®ä¾‹çŠ¶æ€ï¼ˆå­—æ®µï¼‰ã€‚è¿™é¿å…äº†å¤šç»§æ‰¿ä¸­æœ€æ£˜æ‰‹çš„&lt;strong&gt;çŠ¶æ€ç»§æ‰¿å†²çª&lt;/strong&gt;é—®é¢˜ï¼ˆå³ä¸¤ä¸ªçˆ¶ç±»æœ‰åŒåå­—æ®µè¯¥æ€ä¹ˆåŠï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£æ˜¯â€œè¡Œä¸ºâ€çš„å¤šç»§æ‰¿&lt;/strong&gt;ï¼šä½ å¯ä»¥å°†ä¸€ä¸ªç±»è§†ä¸ºâ€œæ˜¯â€å…¶çˆ¶ç±»çš„ä¸€ç§ï¼ˆ&lt;code&gt;is-a&lt;/code&gt;ï¼‰ï¼ŒåŒæ—¶â€œå…·æœ‰â€å¤šä¸ªæ¥å£æ‰€å®šä¹‰çš„èƒ½åŠ›ï¼ˆ&lt;code&gt;has-ability-to&lt;/code&gt;ï¼‰ï¼Œæ¯”å¦‚ &lt;code&gt;CanFly&lt;/code&gt;, &lt;code&gt;CanSwim&lt;/code&gt;ã€‚è¿™é€šå¸¸æ˜¯ä¸€ç§æ›´æ¸…æ™°ã€æ›´å®‰å…¨çš„è®¾è®¡æ¨¡å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;âš–ï¸ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;å­—èŠ‚ç å±‚é¢çš„å•ç»§æ‰¿é™åˆ¶ä¸æ˜¯ä¸€ç§æŠ€æœ¯ä¸Šçš„æ— èƒ½ï¼Œè€Œæ˜¯ä¸€é¡¹&lt;strong&gt;æ·±æ€ç†Ÿè™‘çš„è®¾è®¡å†³ç­–&lt;/strong&gt;ã€‚å®ƒç‰ºç‰²äº†æå°‘æ•°æƒ…å†µä¸‹éœ€è¦â€œå¤šç»§æ‰¿â€çš„çµæ´»æ€§ï¼Œæ¢æ¥äº†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;JVM å®ç°çš„ç®€å•æ€§ä¸é«˜æ•ˆæ€§&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¨‹åºè¿è¡Œçš„ç¨³å®šæ€§å’Œå¯é¢„æµ‹æ€§&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­—èŠ‚ç éªŒè¯çš„å®‰å…¨æ€§&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯­è¨€æœ¬èº«çš„æ¸…æ™°å’Œæ˜“äºç†è§£&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¥å£ï¼ˆ&lt;code&gt;interface&lt;/code&gt;ï¼‰çš„å­˜åœ¨æä¾›äº†å¦ä¸€ç§æ›´å®‰å…¨ã€æ›´çµæ´»çš„æœºåˆ¶æ¥å®ç°å¤šé‡è¡Œä¸ºç»§æ‰¿ï¼Œä»è€Œåœ¨å®è·µä¸­å¾ˆå¥½åœ°å¼¥è¡¥äº†å•ç»§æ‰¿çš„å±€é™æ€§ã€‚&lt;/p&gt;
&lt;h2 id="getclass"&gt;getClass
&lt;/h2&gt;&lt;p&gt;ä½ æä¾›çš„è¿™æ®µä»£ç åˆ†æå®Œå…¨æ­£ç¡®ã€‚ğŸ‘ å®ƒå‡†ç¡®åœ°æŒ‡å‡ºäº† Java ä¸­ &lt;code&gt;super.getClass()&lt;/code&gt;çš„çœŸå®è¡Œä¸ºã€‚&lt;/p&gt;
&lt;h3 id="-æ ¸å¿ƒæœºåˆ¶getclassæ˜¯-finalæ–¹æ³•"&gt;âš ï¸ æ ¸å¿ƒæœºåˆ¶ï¼š&lt;code&gt;getClass()&lt;/code&gt;æ˜¯ &lt;code&gt;final&lt;/code&gt;æ–¹æ³•
&lt;/h3&gt;&lt;p&gt;Java ä¸­ &lt;code&gt;Object&lt;/code&gt;ç±»çš„ &lt;code&gt;getClass()&lt;/code&gt;æ–¹æ³•è¢«å£°æ˜ä¸º &lt;strong&gt;&lt;code&gt;final&lt;/code&gt;&lt;/strong&gt;ï¼Œè¿™æ„å‘³ç€ä»»ä½•å­ç±»éƒ½æ— æ³•é‡å†™ï¼ˆOverrideï¼‰è¿™ä¸ªæ–¹æ³•ã€‚å› æ­¤ï¼Œæ— è®ºä½ åœ¨å­ç±»ä¸­ä½¿ç”¨ &lt;code&gt;this.getClass()&lt;/code&gt;è¿˜æ˜¯ &lt;code&gt;super.getClass()&lt;/code&gt;ï¼Œ&lt;strong&gt;å®é™…æ‰§è¡Œçš„éƒ½æ˜¯ &lt;code&gt;Object&lt;/code&gt;ç±»ä¸­é‚£ä¸ªå”¯ä¸€çš„ã€ä¸å¯æ”¹å˜çš„ &lt;code&gt;getClass()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯è¿”å›&lt;strong&gt;å½“å‰å¯¹è±¡è¿è¡Œæ—¶å®ä¾‹&lt;/strong&gt;çš„ Class å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæŒ‡å‘çš„æ˜¯ä½ å®é™…ç”¨ &lt;code&gt;new&lt;/code&gt;åˆ›å»ºå‡ºæ¥çš„é‚£ä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œè€Œä¸æ˜¯å…¶çˆ¶ç±»çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;h3 id="-ä¸€ä¸ªä¾‹å­"&gt;ğŸ§ª ä¸€ä¸ªä¾‹å­
&lt;/h3&gt;&lt;p&gt;å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹ç»§æ‰¿å…³ç³»ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.Date;
public class Test extends Date { // Test ç»§æ‰¿è‡ª Date
public void test() {
System.out.println(&amp;#34;super.getClass(): &amp;#34; + super.getClass().getName());
System.out.println(&amp;#34;this.getClass(): &amp;#34; + this.getClass().getName());
System.out.println(&amp;#34;Actual superclass: &amp;#34; + this.getClass().getSuperclass().getName());
}
public static void main(String[] args) {
new Test().test();
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¾“å‡ºç»“æœå°†ä¼šæ˜¯ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;super.getClass(): Test
this.getClass(): Test
Actual superclass: java.util.Date
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªç»“æœæ¸…æ™°åœ°éªŒè¯äº†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;super.getClass()&lt;/code&gt;å’Œ &lt;code&gt;this.getClass()&lt;/code&gt;è¿”å›çš„éƒ½æ˜¯å½“å‰å®ä¾‹çš„è¿è¡Œæ—¶ç±» &lt;code&gt;Test&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¦è·å–çœŸæ­£çš„çˆ¶ç±»ä¿¡æ¯ï¼Œéœ€ä½¿ç”¨ &lt;code&gt;getClass().getSuperclass()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å…³é”®åŒºåˆ«ä¸€è§ˆè¡¨"&gt;ğŸ“Š å…³é”®åŒºåˆ«ä¸€è§ˆè¡¨
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è°ƒç”¨æ–¹å¼&lt;/th&gt;
&lt;th&gt;è¿”å›å¯¹è±¡&lt;/th&gt;
&lt;th&gt;åŸå› &lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;super.getClass()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å½“å‰å®ä¾‹çš„ Class å¯¹è±¡ (&lt;code&gt;Test&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;getClass()&lt;/code&gt;æ˜¯ &lt;code&gt;final&lt;/code&gt;æ–¹æ³•ï¼Œ&lt;code&gt;super&lt;/code&gt;å…³é”®å­—ä»…è¡¨ç¤ºä»çˆ¶ç±»ç»§æ‰¿çš„æ–¹æ³•ï¼Œä½†æ–¹æ³•è¡Œä¸ºç”± &lt;code&gt;Object&lt;/code&gt;å›ºå®š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;this.getClass()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å½“å‰å®ä¾‹çš„ Class å¯¹è±¡ (&lt;code&gt;Test&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;ç›´æ¥è°ƒç”¨å¯¹è±¡æœ¬èº«çš„ &lt;code&gt;getClass()&lt;/code&gt;æ–¹æ³•ï¼ŒåŒæ ·æŒ‡å‘è¿è¡Œæ—¶å®ä¾‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;getClass().getSuperclass()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;çˆ¶ç±»&lt;/strong&gt;çš„ Class å¯¹è±¡ (&lt;code&gt;Date&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;getSuperclass()&lt;/code&gt;æ–¹æ³•çš„è®¾è®¡ç›®çš„å°±æ˜¯è¿”å›ç›´æ¥çˆ¶ç±»çš„ Class å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¦‚ä½•æ­£ç¡®è·å–çˆ¶ç±»ä¿¡æ¯"&gt;ğŸ’¡ å¦‚ä½•æ­£ç¡®è·å–çˆ¶ç±»ä¿¡æ¯
&lt;/h3&gt;&lt;p&gt;æ­£å¦‚ä½ åœ¨æœ€åæåˆ°çš„ï¼Œå¦‚æœä½ æƒ³è·å¾—çˆ¶ç±»çš„ Class å¯¹è±¡æˆ–å…¶åç§°ï¼Œåº”è¯¥ä½¿ç”¨ &lt;code&gt;getClass().getSuperclass()&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;getClass().getSuperclass().getName()&lt;/code&gt;ï¼šè·å–çˆ¶ç±»çš„&lt;strong&gt;å…¨é™å®šå&lt;/strong&gt;ï¼ˆåŒ…å«åŒ…åï¼‰ï¼Œä¾‹å¦‚ &lt;code&gt;java.util.Date&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getClass().getSuperclass().getSimpleName()&lt;/code&gt;ï¼šè·å–çˆ¶ç±»çš„&lt;strong&gt;ç®€å•åç§°&lt;/strong&gt;ï¼ˆä¸åŒ…å«åŒ…åï¼‰ï¼Œä¾‹å¦‚ &lt;code&gt;Date&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ¤” æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ä½ çš„ç†è§£éå¸¸åˆ°ä½ã€‚&lt;code&gt;super.method()&lt;/code&gt;çš„è¯­æ³•é€šå¸¸ç”¨äºè°ƒç”¨åœ¨çˆ¶ç±»ä¸­å®šä¹‰ã€ä½†å¯èƒ½å·²è¢«å­ç±»é‡å†™çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œå¯¹äº &lt;code&gt;getClass()&lt;/code&gt;è¿™ä¸ªç‰¹æ®Šçš„ &lt;code&gt;final&lt;/code&gt;æ–¹æ³•ï¼Œç”±äºå®ƒ&lt;strong&gt;æ— æ³•è¢«é‡å†™&lt;/strong&gt;ï¼Œæ‰€ä»¥ &lt;code&gt;super.getClass()&lt;/code&gt;å¹¶ä¸ä¼šè¡¨ç°å‡ºä»»ä½•ä¸åŒäº &lt;code&gt;this.getClass()&lt;/code&gt;çš„è¡Œä¸ºï¼Œå®ƒä»¬éƒ½æ¯«æ— ä¾‹å¤–åœ°è¿”å›å½“å‰è¿è¡Œæ—¶å®ä¾‹çš„ Class å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;è¦è·å–çˆ¶ç±»çš„å…ƒä¿¡æ¯ï¼Œè¯·å§‹ç»ˆä¾èµ– &lt;code&gt;getSuperclass()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h2 id="é›†åˆæ‹·è´"&gt;é›†åˆæ‹·è´
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œ&lt;strong&gt;Collection çš„å¤åˆ¶æ“ä½œï¼ˆåŒ…æ‹¬åˆ›å»ºå­ Collectionï¼‰é€šå¸¸éƒ½æ˜¯æµ…æ‹·è´ï¼ˆShallow Copyï¼‰&lt;/strong&gt;ã€‚ç†è§£è¿™ä¸€ç‚¹å¯¹é¿å…æ„å¤–çš„æ•°æ®ä¿®æ”¹è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;h3 id="-æµ…æ‹·è´ä¸æ·±æ‹·è´çš„æ ¸å¿ƒåŒºåˆ«"&gt;ğŸ“Œ æµ…æ‹·è´ä¸æ·±æ‹·è´çš„æ ¸å¿ƒåŒºåˆ«
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æµ…æ‹·è´ (Shallow Copy)&lt;/strong&gt;ï¼šåªå¤åˆ¶é›†åˆçš„&lt;strong&gt;ç»“æ„&lt;/strong&gt;ï¼ˆå³å®¹å™¨æœ¬èº«ï¼‰ï¼Œè€Œä¸å¤åˆ¶é›†åˆä¸­çš„&lt;strong&gt;å…ƒç´ å¯¹è±¡&lt;/strong&gt;ã€‚æ–°é›†åˆå’ŒåŸé›†åˆä¸­çš„å…ƒç´ å¼•ç”¨æŒ‡å‘&lt;strong&gt;ç›¸åŒçš„å¯¹è±¡å®ä¾‹&lt;/strong&gt;ã€‚å› æ­¤ï¼Œå¦‚æœä¿®æ”¹äº†æŸä¸ªå…ƒç´ å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œæ”¹å˜äº†å¯¹è±¡å±æ€§çš„å€¼ï¼‰ï¼Œè¿™ä¸ªä¿®æ”¹ä¼šåœ¨ä¸¤ä¸ªé›†åˆä¸­åŒæ—¶å¯è§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ·±æ‹·è´ (Deep Copy)&lt;/strong&gt;ï¼šä¸ä»…å¤åˆ¶é›†åˆçš„ç»“æ„ï¼Œè¿˜ä¼šé€’å½’åœ°å¤åˆ¶é›†åˆä¸­çš„æ‰€æœ‰&lt;strong&gt;å…ƒç´ å¯¹è±¡&lt;/strong&gt;ã€‚æ–°é›†åˆå’ŒåŸé›†åˆåŒ…å«çš„æ˜¯å…ƒç´ å¯¹è±¡çš„&lt;strong&gt;ç‹¬ç«‹å‰¯æœ¬&lt;/strong&gt;ã€‚ä¿®æ”¹ä¸€ä¸ªé›†åˆä¸­çš„å…ƒç´ å¯¹è±¡ï¼Œä¸ä¼šå½±å“å¦ä¸€ä¸ªé›†åˆä¸­çš„å¯¹åº”å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†æ›´ç›´è§‚åœ°å¯¹æ¯”ä¸¤è€…çš„åŒºåˆ«ï¼Œè¯·çœ‹ä¸‹è¡¨ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;æµ…æ‹·è´ (Shallow Copy)&lt;/th&gt;
&lt;th&gt;æ·±æ‹·è´ (Deep Copy)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤åˆ¶å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…å¤åˆ¶é›†åˆç»“æ„ï¼Œå…ƒç´ å¼•ç”¨æŒ‡å‘åŒä¸€å¯¹è±¡&lt;/td&gt;
&lt;td&gt;å¤åˆ¶é›†åˆç»“æ„åŠæ‰€æœ‰å…ƒç´ å¯¹è±¡ï¼Œåˆ›å»ºå®Œå…¨ç‹¬ç«‹çš„å¯¹è±¡å‰¯æœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜ç¤ºæ„å›¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;é›†åˆA&lt;/code&gt;-&amp;gt; [obj1, obj2, obj3] &amp;lt;- &lt;code&gt;é›†åˆB&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;é›†åˆA&lt;/code&gt;-&amp;gt; [obj1, obj2, obj3]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;é›†åˆB&lt;/code&gt;-&amp;gt; [copyOf-obj1, copyOf-obj2, copyOf-obj3]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒç´ ä¿®æ”¹å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¿®æ”¹å…ƒç´ å¯¹è±¡ï¼ˆå¦‚å±æ€§å€¼ï¼‰ä¼šå½±å“æ‰€æœ‰åŒ…å«è¯¥å¼•ç”¨çš„é›†åˆ&lt;/td&gt;
&lt;td&gt;ä¿®æ”¹å…ƒç´ å¯¹è±¡ä¸ä¼šå½±å“å…¶ä»–é›†åˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ï¼Œä»…å¤åˆ¶å¼•ç”¨&lt;/td&gt;
&lt;td&gt;è¾ƒä½ï¼Œéœ€åˆ›å»ºæ–°å¯¹è±¡å¹¶å¯èƒ½é€’å½’å¤åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¸¸è§å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ„é€ å‡½æ•° &lt;code&gt;new ArrayList&amp;lt;&amp;gt;(oldList)&lt;/code&gt;, &lt;code&gt;addAll()&lt;/code&gt;, ç­‰&lt;/td&gt;
&lt;td&gt;åºåˆ—åŒ–ã€æ‰‹åŠ¨é€å…ƒç´ å¤åˆ¶ã€ç¬¬ä¸‰æ–¹åº“å·¥å…·å‡½æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-ä¸ºä½•é»˜è®¤æ˜¯æµ…æ‹·è´"&gt;ğŸ¤” ä¸ºä½•é»˜è®¤æ˜¯æµ…æ‹·è´ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;Java é›†åˆæ¡†æ¶çš„è®¾è®¡é€‰æ‹©æµ…æ‹·è´ä½œä¸ºé»˜è®¤è¡Œä¸ºï¼Œä¸»è¦å‡ºäºä»¥ä¸‹è€ƒè™‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;ï¼šå¤åˆ¶å¼•ç”¨æ¯”é€’å½’å¤åˆ¶æ•´ä¸ªå¯¹è±¡å›¾è¦å¿«å¾—å¤šï¼Œå¼€é”€å°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€šç”¨æ€§&lt;/strong&gt;ï¼šJava æ— æ³•é¢„çŸ¥æ¯ä¸ªå¯¹è±¡è¯¥å¦‚ä½•è¢«æ­£ç¡®å¤åˆ¶ï¼ˆä¾‹å¦‚ï¼Œæ˜¯é€šè¿‡æ„é€ å‡½æ•°ã€&lt;code&gt;clone()&lt;/code&gt;è¿˜æ˜¯å…¶ä»–æ–¹æ³•ï¼‰ã€‚æµ…æ‹·è´æ˜¯ä¸€ç§é€šç”¨ä¸”å®‰å…¨çš„æœ€å°åŒ–æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜ç¡®æ€§&lt;/strong&gt;ï¼šå¼ºåˆ¶å¼€å‘è€…æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚ï¼Œæ˜¾å¼åœ°å†³å®šæ˜¯å¦éœ€è¦ä»¥åŠå¦‚ä½•å®ç°æ·±æ‹·è´ï¼Œé¿å…äº†ä¸å¿…è¦çš„æ·±åº¦å¤åˆ¶å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¸¸è§çš„é›†åˆå¤åˆ¶æ–¹æ³•ä¸æ‹·è´ç±»å‹"&gt;ğŸ” å¸¸è§çš„é›†åˆå¤åˆ¶æ–¹æ³•ä¸æ‹·è´ç±»å‹
&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹åˆ—ä¸¾äº† Java ä¸­å¸¸ç”¨çš„é›†åˆå¤åˆ¶æ–¹æ³•ï¼Œå®ƒä»¬é€šå¸¸éƒ½å±äº&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨æ„é€ å‡½æ•°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; newList = new ArrayList&amp;lt;&amp;gt;(oldList);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;addAll()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; newList = new ArrayList&amp;lt;&amp;gt;();
newList.addAll(oldList);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ Java 8 Stream API&lt;/strong&gt;ï¼ˆ&lt;code&gt;Collectors.toList()&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; newList = oldList.stream().collect(Collectors.toList());
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹å¼ä¹Ÿæ˜¯&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;Collections.copy()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; newList = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(new String[oldList.size()]));
Collections.copy(newList, oldList);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªæ–¹æ³•åŒæ ·æ‰§è¡Œ&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;ï¼Œä¸”è¦æ±‚ç›®æ ‡é›†åˆçš„ size è‡³å°‘ç­‰äºæºé›†åˆã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ï¼ˆéƒ¨åˆ†é›†åˆç±»å¦‚ &lt;code&gt;ArrayList&lt;/code&gt;, &lt;code&gt;HashMap&lt;/code&gt;æ”¯æŒï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; newList = (List&amp;lt;String&amp;gt;) oldList.clone();
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é›†åˆçš„ &lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•é€šå¸¸ä¹Ÿå®ç°ä¸º&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æµ…æ‹·è´çš„é£é™©ç¤ºä¾‹"&gt;âš ï¸ æµ…æ‹·è´çš„é£é™©ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;å½“é›†åˆä¸­åŒ…å«&lt;strong&gt;å¯å˜å¯¹è±¡&lt;/strong&gt;æ—¶ï¼Œæµ…æ‹·è´çš„é£é™©å°¤ä¸ºæ˜æ˜¾ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.*;
class Person {
public String name;
public Person(String name) { this.name = name; }
}
public class ShallowCopyExample {
public static void main(String[] args) {
List&amp;lt;Person&amp;gt; original = new ArrayList&amp;lt;&amp;gt;();
original.add(new Person(&amp;#34;Alice&amp;#34;));
original.add(new Person(&amp;#34;Bob&amp;#34;));
// æµ…æ‹·è´
List&amp;lt;Person&amp;gt; shallowCopy = new ArrayList&amp;lt;&amp;gt;(original);
// ä¿®æ”¹æµ…æ‹·è´åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ª Person å¯¹è±¡çš„ name
shallowCopy.get(0).name = &amp;#34;Carol&amp;#34;;
// æ£€æŸ¥åŸé›†åˆä¸­çš„å¯¹è±¡ - ä¹Ÿè¢«ä¿®æ”¹äº†ï¼
System.out.println(original.get(0).name); // è¾“å‡º &amp;#34;Carol&amp;#34;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å¦‚ä½•å®ç°æ·±æ‹·è´"&gt;ğŸ›  å¦‚ä½•å®ç°æ·±æ‹·è´ï¼Ÿ
&lt;/h3&gt;&lt;p&gt;å¦‚æœéœ€è¦å®Œå…¨ç‹¬ç«‹çš„é›†åˆå‰¯æœ¬ï¼Œä½ éœ€è¦è¿›è¡Œ&lt;strong&gt;æ·±æ‹·è´&lt;/strong&gt;ã€‚å®ç°èµ·æ¥ç¨å¤æ‚ï¼Œå¸¸è§æ–¹æ³•æœ‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ‰‹åŠ¨å¤åˆ¶&lt;/strong&gt;ï¼šéå†é›†åˆï¼Œä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºæ–°å‰¯æœ¬ï¼ˆä¾‹å¦‚é€šè¿‡æ‹·è´æ„é€ å‡½æ•°ã€&lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•æˆ–å·¥å‚æ–¹æ³•ï¼‰ï¼Œç„¶åæ·»åŠ åˆ°æ–°é›†åˆã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;Person&amp;gt; deepCopy = new ArrayList&amp;lt;&amp;gt;();
for (Person p : original) {
deepCopy.add(new Person(p.name)); // å‡è®¾ Person æœ‰æ‹·è´æ„é€ å‡½æ•°æˆ–ç±»ä¼¼æœºåˆ¶
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åºåˆ—åŒ–ä¸ååºåˆ—åŒ–&lt;/strong&gt;ï¼šå…ˆå°†å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—èŠ‚æµï¼Œå†ååºåˆ—åŒ–å›æ–°å¯¹è±¡ã€‚è¿™è¦æ±‚æ‰€æœ‰æ¶‰åŠçš„å¯¹è±¡éƒ½å®ç° &lt;code&gt;java.io.Serializable&lt;/code&gt;æ¥å£ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import java.io.*;
public static &amp;lt;T&amp;gt; List&amp;lt;T&amp;gt; deepCopy(List&amp;lt;T&amp;gt; src) throws IOException, ClassNotFoundException {
ByteArrayOutputStream byteOut = new ByteArrayOutputStream();
ObjectOutputStream out = new ObjectOutputStream(byteOut);
out.writeObject(src);
ByteArrayInputStream byteIn = new ByteArrayInputStream(byteOut.toByteArray());
ObjectInputStream in = new ObjectInputStream(byteIn);
return (List&amp;lt;T&amp;gt;) in.readObject();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“&lt;/strong&gt;ï¼šåƒ Apache Commons Lang æä¾›äº† &lt;code&gt;SerializationUtils.clone(object)&lt;/code&gt;ç­‰å·¥å…·æ–¹æ³•ï¼Œå¯ä»¥ç®€åŒ–æ·±æ‹·è´è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ€»ç»“ä¸å»ºè®®"&gt;ğŸ’¡ æ€»ç»“ä¸å»ºè®®
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Java Collection çš„å¤åˆ¶æ“ä½œï¼ˆå¦‚é€šè¿‡æ„é€ å‡½æ•°ã€&lt;code&gt;addAll()&lt;/code&gt;ã€&lt;code&gt;Collections.copy()&lt;/code&gt;æˆ– Stream APIï¼‰&lt;strong&gt;é»˜è®¤éƒ½æ˜¯æµ…æ‹·è´&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æµ…æ‹·è´æ—¶ï¼Œå¦‚æœé›†åˆåŒ…å«&lt;strong&gt;å¯å˜å¯¹è±¡&lt;/strong&gt;ï¼Œä¿®æ”¹å…ƒç´ å¯¹è±¡ä¼šå½±å“åˆ°æ‰€æœ‰å…±äº«è¯¥å¯¹è±¡çš„é›†åˆã€‚&lt;/li&gt;
&lt;li&gt;è‹¥éœ€è¦å®Œå…¨ç‹¬ç«‹çš„å‰¯æœ¬ï¼Œé¿å…å…ƒç´ ä¿®æ”¹çš„ç›¸äº’å¹²æ‰°ï¼Œä½ å¿…é¡»&lt;strong&gt;æ‰‹åŠ¨å®ç°æ·±æ‹·è´&lt;/strong&gt;ï¼Œå¸¸ç”¨æ–¹å¼åŒ…æ‹¬éå†å…ƒç´ åˆ›å»ºæ–°å¯¹è±¡ã€åºåˆ—åŒ–/ååºåˆ—åŒ–æˆ–ä½¿ç”¨å¯é çš„ç¬¬ä¸‰æ–¹å·¥å…·åº“ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨é€‰æ‹©æ‹·è´æ–¹å¼æ—¶ï¼Œè¯·æ ¹æ®ä½ çš„&lt;strong&gt;ä¸šåŠ¡éœ€æ±‚&lt;/strong&gt;ï¼ˆæ˜¯å¦éœ€è¦å®Œå…¨çš„æ•°æ®ç‹¬ç«‹æ€§ï¼‰å’Œ&lt;strong&gt;æ€§èƒ½è€ƒé‡&lt;/strong&gt;æ¥åšå‡ºå†³å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="è§†å›¾"&gt;è§†å›¾
&lt;/h2&gt;&lt;p&gt;Java ä¸­åˆ›å»ºå­é›†åˆï¼ˆä¾‹å¦‚é€šè¿‡ &lt;code&gt;subList&lt;/code&gt;ã€&lt;code&gt;subSet&lt;/code&gt;ã€&lt;code&gt;headSet&lt;/code&gt;ã€&lt;code&gt;tailSet&lt;/code&gt;ç­‰æ–¹æ³•ï¼‰æ—¶ï¼Œå…¶å†…éƒ¨æœºåˆ¶å’Œåç»­å¯¹åŸé›†åˆçš„ä¿®æ”¹æ˜¯å¦ä¼šåŒæ­¥åˆ°å­é›†åˆï¼Œæ˜¯ä¸€ä¸ªéœ€è¦ä»”ç»†åŒºåˆ†çš„æƒ…å†µã€‚è¿™å–å†³äºä½ ä½¿ç”¨çš„å…·ä½“é›†åˆç±»å‹å’Œåˆ›å»ºæ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å¸®ä½ å¿«é€Ÿç†è§£ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ€»ç»“ä¸»è¦æƒ…å†µï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§/æ“ä½œ&lt;/th&gt;
&lt;th&gt;åŸºäºè§†å›¾çš„å­é›†åˆ (å¦‚ &lt;code&gt;List.subList&lt;/code&gt;)&lt;/th&gt;
&lt;th&gt;é€šè¿‡å¤åˆ¶æ„é€ å‡½æ•°åˆ›å»ºçš„æ–°é›†åˆ (å¦‚ &lt;code&gt;new ArrayList&amp;lt;&amp;gt;(oldList)&lt;/code&gt;)&lt;/th&gt;
&lt;th&gt;é€šè¿‡ &lt;code&gt;Collections.unmodifiable&lt;/code&gt;åˆ›å»ºçš„ä¸å¯å˜è§†å›¾&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚æ•°æ®å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸åŸé›†åˆå…±äº«æ•°æ®&lt;/strong&gt;ï¼ˆå¯ç†è§£ä¸ºâ€œçª—å£â€æˆ–â€œè§†å›¾â€ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç‹¬ç«‹çš„æ•°æ®å‰¯æœ¬&lt;/strong&gt;ï¼ˆä½†å…ƒç´ å¯¹è±¡å¼•ç”¨æ˜¯å…±äº«çš„ï¼Œå³&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸åŸé›†åˆå…±äº«æ•°æ®&lt;/strong&gt;ï¼ˆåŒ…è£…å™¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ’å…¥æ–°å…ƒç´ çš„åŒæ­¥æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¼šç›¸äº’å½±å“&lt;/strong&gt;ã€‚åœ¨åŸé›†åˆçš„&lt;strong&gt;å­é›†èŒƒå›´å†…&lt;/strong&gt;è¿›è¡Œç»“æ„æ€§ä¿®æ”¹ï¼ˆå¦‚æ’å…¥ã€åˆ é™¤ï¼‰ä¼šå¯¼è‡´å­é›†åˆçš„éå†æ“ä½œæŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å®Œå…¨ç‹¬ç«‹&lt;/strong&gt;ã€‚å¯¹åŸé›†åˆçš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šå½±å“æ–°é›†åˆï¼Œåä¹‹äº¦ç„¶ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¼šåæ˜ å˜åŒ–&lt;/strong&gt;ï¼ˆå› ä¸ºæ•°æ®æ˜¯å…±äº«çš„ï¼‰ï¼Œä½†&lt;strong&gt;ä¸èƒ½&lt;/strong&gt;é€šè¿‡è¯¥è§†å›¾ä¿®æ”¹å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¿®æ”¹å·²æœ‰å…ƒç´ çš„åŒæ­¥æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¼šç›¸äº’å½±å“&lt;/strong&gt;ï¼ˆå› ä¸ºå…±äº«ç›¸åŒçš„å¯¹è±¡å¼•ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¼šç›¸äº’å½±å“&lt;/strong&gt;ï¼ˆå› ä¸ºå…±äº«ç›¸åŒçš„å¯¹è±¡å¼•ç”¨ï¼Œ&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;çš„ç‰¹æ€§ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¼šç›¸äº’å½±å“&lt;/strong&gt;ï¼ˆå› ä¸ºå…±äº«ç›¸åŒçš„å¯¹è±¡å¼•ç”¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»“æ„æ€§ä¿®æ”¹çš„å…¼å®¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›¸äº’çš„ç»“æ„æ€§ä¿®æ”¹ï¼ˆå¦‚åœ¨åŸåˆ—è¡¨ä¸­é—´æ’å…¥å…ƒç´ ï¼‰å¯èƒ½å¯¼è‡´å­é›†åˆè¡Œä¸ºæœªå®šä¹‰æˆ–æŠ›å‡ºå¼‚å¸¸ã€‚&lt;/td&gt;
&lt;td&gt;å®‰å…¨ï¼Œæ— ä»»ä½•å½±å“ã€‚&lt;/td&gt;
&lt;td&gt;æ— æ³•é€šè¿‡ä¸å¯å˜è§†å›¾è¿›è¡Œç»“æ„æ€§ä¿®æ”¹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ğŸ“’ &lt;strong&gt;é‡è¦æ¦‚å¿µï¼šç»“æ„æ€§ä¿®æ”¹ (Structural Modification)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æŒ‡é‚£äº›æ”¹å˜äº†é›†åˆâ€œç»“æ„â€çš„æ“ä½œï¼Œä¾‹å¦‚æ·»åŠ ã€åˆ é™¤å…ƒç´ ï¼Œæˆ–è€…æ˜¾å¼æ”¹å˜é›†åˆçš„å¤§å°ï¼ˆ&lt;code&gt;resize&lt;/code&gt;ï¼‰ã€‚ä»…ä»…æ˜¯ä¿®æ”¹é›†åˆä¸­å·²æœ‰å…ƒç´ å¯¹è±¡å†…éƒ¨çš„å­—æ®µå€¼ï¼ˆä¾‹å¦‚ &lt;code&gt;person.setName(&amp;quot;new&amp;quot;)&lt;/code&gt;ï¼‰&lt;strong&gt;ä¸å±äº&lt;/strong&gt;ç»“æ„æ€§ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è¯¦è§£ä¸åŒæƒ…å†µ"&gt;ğŸ” è¯¦è§£ä¸åŒæƒ…å†µ
&lt;/h3&gt;&lt;h4 id="1-åŸºäºè§†å›¾çš„å­é›†åˆ-ä¾‹å¦‚-listsublist"&gt;1. åŸºäºâ€œè§†å›¾â€çš„å­é›†åˆ (ä¾‹å¦‚ &lt;code&gt;List.subList&lt;/code&gt;)
&lt;/h4&gt;&lt;p&gt;å½“ä½ è°ƒç”¨ &lt;code&gt;List&lt;/code&gt;çš„ &lt;code&gt;subList(fromIndex, toIndex)&lt;/code&gt;æ–¹æ³•æ—¶ï¼Œå®ƒè¿”å›çš„æ˜¯åŸåˆ—è¡¨çš„ä¸€ä¸ª&lt;strong&gt;è§†å›¾&lt;/strong&gt;ï¼ˆViewï¼‰ï¼Œ&lt;strong&gt;è€Œéä¸€ä¸ªç‹¬ç«‹çš„å‰¯æœ¬&lt;/strong&gt;ã€‚è¿™ä¸ªè§†å›¾ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»´æŠ¤çš„æ˜¯èŒƒå›´å¼•ç”¨&lt;/strong&gt;ï¼šå®ƒå†…éƒ¨é€šå¸¸ä¼šæŒæœ‰å¯¹åŸé›†åˆçš„å¼•ç”¨ï¼Œå¹¶è®°å½•èµ·å§‹å’Œç»“æŸçš„åç§»é‡ï¼ˆä¾‹å¦‚ &lt;code&gt;fromIndex&lt;/code&gt;å’Œ &lt;code&gt;toIndex&lt;/code&gt;ï¼‰ï¼Œè€Œä¸æ˜¯ç»´æŠ¤ä¸¤ä¸ªç‹¬ç«‹çš„è¿­ä»£å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥æ€§&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯¹åŸé›†åˆçš„ç»“æ„æ€§ä¿®æ”¹æ˜¯å±é™©çš„&lt;/strong&gt;ï¼šå¦‚æœä½ é€šè¿‡ &lt;code&gt;subList&lt;/code&gt;è·å–äº†ä¸€ä¸ªå­åˆ—è¡¨åï¼Œåˆ&lt;strong&gt;ç›´æ¥å¯¹åŸ &lt;code&gt;List&lt;/code&gt;&lt;/strong&gt; è¿›è¡Œäº†ç»“æ„æ€§ä¿®æ”¹ï¼ˆä¾‹å¦‚æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼‰ï¼Œé‚£ä¹ˆ&lt;strong&gt;åç»­ä»»ä½•å¯¹å­åˆ—è¡¨çš„è®¿é—®æ“ä½œ&lt;/strong&gt;ï¼ˆå¦‚éå†ã€è·å–å¤§å°ç­‰ï¼‰éƒ½å¾ˆå¯èƒ½æŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ã€‚è¿™æ˜¯å› ä¸ºå­åˆ—è¡¨æ£€æµ‹åˆ°åŸåˆ—è¡¨çš„ç»“æ„å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œå…¶åŸæœ‰çš„åç§»é‡å¯èƒ½ä¸å†å‡†ç¡®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹å…ƒç´ å†…å®¹çš„ä¿®æ”¹æ˜¯åŒæ­¥çš„&lt;/strong&gt;ï¼šé€šè¿‡å­åˆ—è¡¨ &lt;code&gt;set&lt;/code&gt;æ–¹æ³•ä¿®æ”¹æŸä¸ªä½ç½®çš„å…ƒç´ ï¼Œæˆ–è€…ç›´æ¥ä¿®æ”¹å­åˆ—è¡¨/åŸåˆ—è¡¨ä¸­æŸä¸ªå…ƒç´ å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼ˆä¾‹å¦‚ä¿®æ”¹ä¸€ä¸ª &lt;code&gt;Person&lt;/code&gt;å¯¹è±¡çš„ &lt;code&gt;name&lt;/code&gt;å­—æ®µï¼‰ï¼Œè¿™ä¸ªæ”¹åŠ¨åœ¨å¦ä¸€æ–¹æ˜¯ç«‹å³å¯è§çš„ï¼Œå› ä¸ºå®ƒä»¬å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2-é€šè¿‡å¤åˆ¶æ„é€ å‡½æ•°æˆ–æ–¹æ³•åˆ›å»ºçš„æ–°é›†åˆ"&gt;2. é€šè¿‡å¤åˆ¶æ„é€ å‡½æ•°æˆ–æ–¹æ³•åˆ›å»ºçš„æ–°é›†åˆ
&lt;/h4&gt;&lt;p&gt;å½“ä½ ä½¿ç”¨ &lt;code&gt;new ArrayList&amp;lt;&amp;gt;(existingList)&lt;/code&gt;ã€&lt;code&gt;new HashSet&amp;lt;&amp;gt;(existingSet)&lt;/code&gt;æˆ–è€… &lt;code&gt;addAll()&lt;/code&gt;ç­‰æ–¹æ³•æ—¶ï¼Œä½ åˆ›å»ºçš„æ˜¯åŸé›†åˆçš„ä¸€ä¸ª&lt;strong&gt;å…¨æ–°ç‹¬ç«‹çš„å‰¯æœ¬&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»´æŠ¤çš„æ˜¯ç‹¬ç«‹æ•°æ®&lt;/strong&gt;ï¼šæ–°é›†åˆæ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…éƒ¨æ•°ç»„æˆ–é“¾è¡¨ç»“æ„ï¼Œå¹¶å°†åŸé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ å¼•ç”¨&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;åˆ°æ–°ç»“æ„ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥æ€§&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ’å…¥æ–°å…ƒç´ ä¸åŒæ­¥&lt;/strong&gt;ï¼šæ­¤åï¼Œå‘&lt;strong&gt;åŸé›†åˆ&lt;/strong&gt;ä¸­æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼Œ&lt;strong&gt;ä¸ä¼šå½±å“&lt;/strong&gt;æ–°åˆ›å»ºçš„é›†åˆã€‚å‘&lt;strong&gt;æ–°é›†åˆ&lt;/strong&gt;ä¸­æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼Œä¹Ÿ&lt;strong&gt;ä¸ä¼šå½±å“&lt;/strong&gt;åŸé›†åˆã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå®Œå…¨ç‹¬ç«‹çš„å®¹å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿®æ”¹å·²æœ‰å…ƒç´ å¯¹è±¡çš„å†…å®¹æ˜¯åŒæ­¥çš„&lt;/strong&gt;ï¼šå¦‚æœæ–°è€é›†åˆä¸­åŒ…å«çš„æŸä¸ª&lt;strong&gt;å…ƒç´ å¯¹è±¡æœ¬èº«è¢«ä¿®æ”¹&lt;/strong&gt;äº†ï¼ˆä¾‹å¦‚ï¼Œä½ ä¿®æ”¹äº†æŸä¸ª &lt;code&gt;Person&lt;/code&gt;å¯¹è±¡çš„ &lt;code&gt;name&lt;/code&gt;å±æ€§ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªä¿®æ”¹åœ¨å¦ä¸€ä¸ªé›†åˆä¸­ä¹Ÿèƒ½çœ‹åˆ°ï¼Œå› ä¸ºå®ƒä»¬æŒæœ‰çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚è¿™å°±æ˜¯&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;çš„ç‰¹ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="3-ä¸å¯ä¿®æ”¹çš„è§†å›¾-ä¾‹å¦‚-collectionsunmodifiablelist"&gt;3. ä¸å¯ä¿®æ”¹çš„è§†å›¾ (ä¾‹å¦‚ &lt;code&gt;Collections.unmodifiableList&lt;/code&gt;)
&lt;/h4&gt;&lt;p&gt;é€šè¿‡ &lt;code&gt;Collections.unmodifiableList()&lt;/code&gt;ç­‰æ–¹æ³•åŒ…è£…åŸé›†åˆåï¼Œä¼šè¿”å›ä¸€ä¸ª&lt;strong&gt;ä¸å¯ä¿®æ”¹çš„è§†å›¾&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»´æŠ¤çš„æ˜¯å¯¹åŸé›†åˆçš„å¼•ç”¨&lt;/strong&gt;ï¼šå®ƒå†…éƒ¨æŒæœ‰å¯¹åŸé›†åˆçš„å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥æ€§&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä½ &lt;strong&gt;ä¸èƒ½&lt;/strong&gt;é€šè¿‡è¿™ä¸ªè§†å›¾è¿›è¡Œä»»ä½•ä¿®æ”¹æ“ä½œï¼ˆæ’å…¥ã€åˆ é™¤ç­‰ï¼‰ï¼Œå°è¯•æ“ä½œä¼šæŠ›å‡º &lt;code&gt;UnsupportedOperationException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä½†æ˜¯ï¼Œ&lt;strong&gt;åŸé›†åˆå‘ç”Ÿçš„ä»»ä½•å˜åŒ–&lt;/strong&gt;ï¼ˆç»“æ„å˜åŒ–æˆ–å…ƒç´ å†…å®¹å˜åŒ–ï¼‰&lt;strong&gt;éƒ½ä¼šåœ¨è¿™ä¸ªè§†å›¾ä¸­åæ˜ å‡ºæ¥&lt;/strong&gt;ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªâ€œçª—å£â€ã€‚&lt;/li&gt;
&lt;li&gt;åŒæ ·ï¼Œå¦‚æœåŸé›†åˆä¸­çš„å…ƒç´ å¯¹è±¡è¢«ä¿®æ”¹äº†å†…å®¹ï¼Œåœ¨è¿™ä¸ªè§†å›¾ä¸­ä¹Ÿèƒ½çœ‹åˆ°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ€»ç»“ä¸å»ºè®®"&gt;ğŸ’¡ æ ¸å¿ƒæ€»ç»“ä¸å»ºè®®
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦å®Œå…¨ç‹¬ç«‹ï¼Ÿç”¨å¤åˆ¶&lt;/strong&gt;ï¼šå¦‚æœä½ å¸Œæœ›å­é›†åˆå’ŒåŸé›†åˆåç»­çš„ä¿®æ”¹äº’ä¸å¹²æ‰°ï¼Œè¯·ä½¿ç”¨&lt;strong&gt;å¤åˆ¶æ„é€ å‡½æ•°&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;new ArrayList&amp;lt;&amp;gt;(oldList)&lt;/code&gt;ï¼‰æˆ– &lt;code&gt;addAll()&lt;/code&gt;æ–¹æ³•æ˜¾å¼åˆ›å»ºä¸€ä¸ªæ–°é›†åˆã€‚è®°ä½è¿™åªæ˜¯æµ…æ‹·è´ï¼Œå¦‚æœå…ƒç´ å¯¹è±¡æœ¬èº«å¯å˜ï¼Œä¿®æ”¹å®ƒä»¬çš„å†…å®¹ä»ä¼šç›¸äº’å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦èŠ‚çœå†…å­˜ä¸”æ“ä½œå¯æ§ï¼Ÿç”¨è§†å›¾&lt;/strong&gt;ï¼šå¦‚æœä½ åªæ˜¯éœ€è¦ä¸€ä¸ªâ€œçª—å£â€æ¥æ“ä½œåŸé›†åˆçš„æŸä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”èƒ½&lt;strong&gt;ä¿è¯&lt;/strong&gt;åœ¨å­è§†å›¾å­˜æ´»æœŸé—´&lt;strong&gt;ä¸å¯¹åŸé›†åˆè¿›è¡Œç»“æ„æ€§ä¿®æ”¹&lt;/strong&gt;ï¼Œé‚£ä¹ˆ &lt;code&gt;subList&lt;/code&gt;ç­‰è§†å›¾æ–¹æ³•æ˜¯é«˜æ•ˆçš„é€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦åªè¯»è§†å›¾ï¼Ÿç”¨ä¸å¯ä¿®æ”¹åŒ…è£…å™¨&lt;/strong&gt;ï¼šå¦‚æœä½ æƒ³è®©å…¶ä»–éƒ¨åˆ†ä»£ç åªèƒ½è¯»å–è€Œä¸èƒ½ä¿®æ”¹é›†åˆå†…å®¹ï¼ˆä½†ä»èƒ½æ¥æ”¶åŸé›†åˆçš„æ›´æ–°ï¼‰ï¼Œä½¿ç”¨ &lt;code&gt;Collections.unmodifiableXXX&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è­¦æƒ•å¹¶å‘ä¿®æ”¹å¼‚å¸¸&lt;/strong&gt;ï¼šå¯¹äº &lt;code&gt;subList&lt;/code&gt;ç­‰è§†å›¾ï¼Œæœ€éœ€è¦è­¦æƒ•çš„å°±æ˜¯åœ¨æŒæœ‰å­è§†å›¾æ—¶ç›´æ¥ä¿®æ”¹åŸé›†åˆç»“æ„ï¼Œè¿™å‡ ä¹å¿…ç„¶å¯¼è‡´ &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ·±æ‹·è´è§£å†³ä¸€åˆ‡ï¼ˆä½†æœ‰ä»£ä»·ï¼‰&lt;/strong&gt;ï¼šå¦‚æœä½ éœ€è¦è¿å…ƒç´ å¯¹è±¡çš„çŠ¶æ€éƒ½å®Œå…¨ç‹¬ç«‹ï¼Œå°±éœ€è¦è¿›è¡Œ&lt;strong&gt;æ·±æ‹·è´&lt;/strong&gt;ã€‚è¿™é€šå¸¸éœ€è¦é€šè¿‡åºåˆ—åŒ–/ååºåˆ—åŒ–ï¼Œæˆ–æ‰‹åŠ¨éå†é›†åˆä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºæ–°å‰¯æœ¬ï¼ˆå¦‚è°ƒç”¨ &lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•æˆ–æ‹·è´æ„é€ å‡½æ•°ï¼‰æ¥å®ç°ã€‚ è¿™ä¼šå¸¦æ¥æ›´å¤§çš„æ€§èƒ½å’Œå¤æ‚åº¦å¼€é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Java é›†åˆçš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;h2 id="å³ç§»"&gt;å³ç§»
&lt;/h2&gt;&lt;p&gt;ã€‚åœ¨Javaä¸­ï¼Œ&lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;å’Œ &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;éƒ½æ˜¯å³ç§»ä½è¿ç®—ç¬¦ï¼Œä½†å®ƒä»¬åœ¨å¤„ç†æœ€é«˜ä½ï¼ˆç¬¦å·ä½ï¼‰çš„æ–¹å¼ä¸Šæœ‰ç€æ ¹æœ¬æ€§çš„ä¸åŒï¼Œè¿™ç›´æ¥å½±å“äº†ç§»ä½åçš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„è¡¨æ ¼æ¸…æ™°åœ°å±•ç¤ºäº†ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§å¯¹æ¯”&lt;/th&gt;
&lt;th&gt;&lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;(å¸¦ç¬¦å·å³ç§»)&lt;/th&gt;
&lt;th&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;(æ— ç¬¦å·å³ç§»)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒåŒºåˆ«&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ä½è¡¥&lt;strong&gt;ç¬¦å·ä½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ä½&lt;strong&gt;å§‹ç»ˆè¡¥0&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¬¦å·ä½å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¿ç•™åŸæ•°çš„æ­£è´Ÿæ€§&lt;/td&gt;
&lt;td&gt;å¿½ç•¥ç¬¦å·ä½ï¼Œç§»ä½åç»“æœ&lt;strong&gt;æ’ä¸ºéè´Ÿæ•°&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ­£æ•°ç§»ä½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;æ•ˆæœç›¸åŒï¼Œé«˜ä½è¡¥0ï¼Œç›¸å½“äºé™¤ä»¥2çš„næ¬¡æ–¹&lt;/td&gt;
&lt;td&gt;ä¸ &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;æ•ˆæœç›¸åŒï¼Œé«˜ä½è¡¥0ï¼Œç›¸å½“äºé™¤ä»¥2çš„næ¬¡æ–¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è´Ÿæ•°ç§»ä½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ä½è¡¥1ï¼Œç»“æœä»ä¸º&lt;strong&gt;è´Ÿæ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ä½è¡¥0ï¼Œç»“æœå˜ä¸º&lt;strong&gt;æ­£æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°å­¦æ„ä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹äºŒè¿›åˆ¶æ•°è¿›è¡Œ&lt;strong&gt;ç®—æœ¯å³ç§»&lt;/strong&gt;ï¼Œä¿æŒæ•°å€¼çš„ç¬¦å·&lt;/td&gt;
&lt;td&gt;å¯¹äºŒè¿›åˆ¶æ•°è¿›è¡Œ&lt;strong&gt;é€»è¾‘å³ç§»&lt;/strong&gt;ï¼Œä»…çœ‹ä½œæ¯”ç‰¹åºåˆ—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¸¸è§åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°å€¼çš„å¿«é€Ÿé™¤ä»¥2çš„å¹‚æ¬¡ï¼Œä¸”éœ€è¦ä¿æŒæ­£è´Ÿå·&lt;/td&gt;
&lt;td&gt;å¤„ç†ä½æ©ç ã€å“ˆå¸Œè®¡ç®—ã€æ— ç¬¦å·æ•°æ®è§£æç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="å…·ä½“ç¤ºä¾‹è¯´æ˜"&gt;å…·ä½“ç¤ºä¾‹è¯´æ˜
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£ï¼Œæˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå…·ä½“çš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ­£æ•°ç¤ºä¾‹ï¼ˆä»¥ 15 ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;äºŒè¿›åˆ¶è¡¨ç¤ºï¼š&lt;code&gt;00000000 00000000 00000000 00001111&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;15 &amp;gt;&amp;gt; 2&lt;/code&gt;ï¼šå‘å³ç§»åŠ¨2ä½ï¼Œ&lt;strong&gt;é«˜ä½è¡¥0&lt;/strong&gt;ï¼Œå¾—åˆ° &lt;code&gt;00000000 00000000 00000000 00000011&lt;/code&gt;ï¼Œå³åè¿›åˆ¶ &lt;strong&gt;3&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;15 &amp;gt;&amp;gt;&amp;gt; 2&lt;/code&gt;ï¼šå‘å³ç§»åŠ¨2ä½ï¼Œ&lt;strong&gt;é«˜ä½è¡¥0&lt;/strong&gt;ï¼Œå¾—åˆ° &lt;code&gt;00000000 00000000 00000000 00000011&lt;/code&gt;ï¼Œå³åè¿›åˆ¶ &lt;strong&gt;3&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºæ­£æ•°ï¼Œä¸¤è€…ç»“æœå®Œå…¨ç›¸åŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿæ•°ç¤ºä¾‹ï¼ˆä»¥ -15 ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨Javaä¸­ï¼Œè´Ÿæ•°ä»¥å…¶&lt;strong&gt;äºŒè¿›åˆ¶è¡¥ç &lt;/strong&gt;å½¢å¼å­˜å‚¨ã€‚-15çš„è¡¥ç ä¸º &lt;code&gt;11111111 11111111 11111111 11110001&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-15 &amp;gt;&amp;gt; 2&lt;/code&gt;ï¼šå‘å³ç§»åŠ¨2ä½ï¼Œ&lt;strong&gt;é«˜ä½è¡¥1&lt;/strong&gt;ï¼ˆä¿æŒè´Ÿæ•°ç¬¦å·ï¼‰ï¼Œå¾—åˆ° &lt;code&gt;11111111 11111111 11111111 11111100&lt;/code&gt;ï¼Œè¿™ä¸ªè¡¥ç å¯¹åº”çš„åŸç æ˜¯ &lt;code&gt;10000000 00000000 00000000 00000100&lt;/code&gt;ï¼Œå³åè¿›åˆ¶ &lt;strong&gt;-4&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-15 &amp;gt;&amp;gt;&amp;gt; 2&lt;/code&gt;ï¼šå‘å³ç§»åŠ¨2ä½ï¼Œ&lt;strong&gt;é«˜ä½è¡¥0&lt;/strong&gt;ï¼Œå¾—åˆ° &lt;code&gt;00111111 11111111 11111111 11111100&lt;/code&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ­£æ•°ï¼Œå³åè¿›åˆ¶ &lt;strong&gt;1073741820&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="å¤åˆèµ‹å€¼è¿ç®—ç¬¦"&gt;å¤åˆèµ‹å€¼è¿ç®—ç¬¦
&lt;/h3&gt;&lt;p&gt;ä¸ &lt;code&gt;+=&lt;/code&gt;ç±»ä¼¼ï¼Œ&lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;å’Œ &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;ä¹Ÿæœ‰å¯¹åº”çš„å¤åˆèµ‹å€¼è¿ç®—ç¬¦ï¼š&lt;code&gt;&amp;gt;&amp;gt;=&lt;/code&gt;å’Œ &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;=&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;a &amp;gt;&amp;gt;= 2;&lt;/code&gt;ç­‰ä»·äº &lt;code&gt;a = a &amp;gt;&amp;gt; 2;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;a &amp;gt;&amp;gt;&amp;gt;= 2;&lt;/code&gt;ç­‰ä»·äº &lt;code&gt;a = a &amp;gt;&amp;gt;&amp;gt; 2;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›å¤åˆæ“ä½œä¼š&lt;strong&gt;ç›´æ¥æ”¹å˜å˜é‡ &lt;code&gt;a&lt;/code&gt;è‡ªèº«çš„å€¼&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id="ä½¿ç”¨å»ºè®®ä¸æ³¨æ„äº‹é¡¹"&gt;ä½¿ç”¨å»ºè®®ä¸æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ˜ç¡®éœ€æ±‚&lt;/strong&gt;ï¼šåœ¨é€‰æ‹©ä½¿ç”¨ &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;è¿˜æ˜¯ &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;æ—¶ï¼Œé¦–å…ˆè¦æ˜ç¡®ä½ çš„ç›®çš„æ˜¯è¿›è¡Œ&lt;strong&gt;ç®—æœ¯æ“ä½œ&lt;/strong&gt;ï¼ˆå…³å¿ƒæ•°å€¼å¤§å°å’Œæ­£è´Ÿï¼‰è¿˜æ˜¯&lt;strong&gt;ä½æ“ä½œ&lt;/strong&gt;ï¼ˆåªå…³å¿ƒæ¯”ç‰¹ä½æ¨¡å¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç±»å‹&lt;/strong&gt;ï¼šç§»ä½è¿ç®—ç¬¦é€šå¸¸åªç”¨äºå¤„ç†æ•´æ•°ç±»å‹ï¼ˆå¦‚ &lt;code&gt;int&lt;/code&gt;, &lt;code&gt;long&lt;/code&gt;ï¼‰çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç§»ä½ä½æ•°&lt;/strong&gt;ï¼šç§»ä½çš„ä½æ•°ä¸åº”è¶…è¿‡æˆ–ç­‰äºæ•°æ®ç±»å‹çš„ä½æ•°ï¼ˆä¾‹å¦‚ï¼Œå¯¹32ä½çš„&lt;code&gt;int&lt;/code&gt;ç±»å‹ï¼Œç§»ä½ä½æ•°åº”å°äº32ï¼‰ï¼Œå¦åˆ™ç»“æœå¯èƒ½æ˜¯æœªå®šä¹‰çš„æˆ–ä¸é¢„æœŸä¸ç¬¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„å¯¹æ¯”èƒ½å¸®åŠ©ä½ å½»åº•ç†è§£ &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;å’Œ &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;çš„åŒºåˆ«ã€‚å¦‚æœä½ æœ‰ä»»ä½•å…·ä½“çš„åº”ç”¨åœºæ™¯æˆ–ç–‘é—®ï¼Œæˆ‘å¾ˆä¹æ„ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="arraysaslist-1"&gt;Arrays.asList
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;Arrays.asList()&lt;/code&gt;æ˜¯ Java ä¸­ä¸€ä¸ªéå¸¸å¸¸ç”¨ä½†ä¹Ÿå®¹æ˜“è®©äººå›°æƒ‘çš„æ–¹æ³•ï¼Œå®ƒç”¨äºå°†æ•°ç»„è½¬æ¢ä¸ºä¸€ä¸ª List é›†åˆã€‚ä¸ºäº†å¸®åŠ©ä½ å¿«é€ŸæŠŠæ¡å…¶æ ¸å¿ƒç‰¹æ€§å’Œæ³¨æ„äº‹é¡¹ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æ€»ç»“ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;th&gt;éœ€ç‰¹åˆ«æ³¨æ„&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›çš„ List ç±»å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;java.util.Arrays.ArrayList&lt;/code&gt;(ä¸€ä¸ªå›ºå®šå¤§å°çš„é™æ€å†…éƒ¨ç±»ï¼Œ&lt;strong&gt;é&lt;/strong&gt; &lt;code&gt;java.util.ArrayList&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸å¯ç›´æ¥æ·»åŠ æˆ–åˆ é™¤å…ƒç´ &lt;/strong&gt;ï¼Œå¦åˆ™æŠ› &lt;code&gt;**UnsupportedOperationException**&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸åŸå§‹æ•°ç»„çš„å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å…±äº«åº•å±‚æ•°æ®&lt;/strong&gt; (è¿”å›çš„ List æ˜¯åŸæ•°ç»„çš„ä¸€ä¸ªâ€œè§†å›¾â€)&lt;/td&gt;
&lt;td&gt;ä¿®æ”¹ List çš„å…ƒç´ æˆ–æ•°ç»„çš„å…ƒç´ ï¼Œå¦ä¸€æ–¹&lt;strong&gt;ç«‹å³å¯è§&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯¹åŸºæœ¬æ•°æ®ç±»å‹æ•°ç»„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼šå°†&lt;strong&gt;æ•´ä¸ªåŸºæœ¬ç±»å‹æ•°ç»„&lt;/strong&gt;è§†ä¸ºä¸€ä¸ªå¯¹è±¡ä½œä¸º List çš„&lt;strong&gt;å”¯ä¸€å…ƒç´ &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åº”ä½¿ç”¨&lt;strong&gt;åŒ…è£…ç±»å‹æ•°ç»„&lt;/strong&gt; (å¦‚ &lt;code&gt;Integer[]&lt;/code&gt;ä»£æ›¿ &lt;code&gt;int[]&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¸¸ç”¨æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒ &lt;code&gt;get(index)&lt;/code&gt;, &lt;code&gt;set(index, element)&lt;/code&gt;, &lt;code&gt;contains()&lt;/code&gt;, &lt;code&gt;size()&lt;/code&gt;ç­‰&lt;strong&gt;éç»“æ„æ€§ä¿®æ”¹&lt;/strong&gt;æ“ä½œ&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è½¬æ¢ä¸ºçœŸæ­£å¯å˜ List&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€ä½¿ç”¨ &lt;code&gt;new ArrayList&amp;lt;&amp;gt;(Arrays.asList(array))&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†äº†è§£è¿™äº›ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§ä¸æ³¨æ„äº‹é¡¹"&gt;ğŸ”„ æ ¸å¿ƒç‰¹æ€§ä¸æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å›ºå®šå¤§å°ï¼ˆFixed-Sizeï¼‰&lt;/strong&gt;ï¼š&lt;code&gt;Arrays.asList()&lt;/code&gt;è¿”å›çš„ List åŒ…è£…äº†åŸå§‹çš„æ•°ç»„ï¼Œå› æ­¤å…¶&lt;strong&gt;é•¿åº¦æ˜¯å›ºå®šçš„&lt;/strong&gt;ã€‚ä»»ä½•è¯•å›¾&lt;strong&gt;æ”¹å˜åˆ—è¡¨é•¿åº¦&lt;/strong&gt;çš„æ“ä½œï¼ˆä¾‹å¦‚ &lt;code&gt;add()&lt;/code&gt;, &lt;code&gt;remove()&lt;/code&gt;, &lt;code&gt;clear()&lt;/code&gt;ï¼‰éƒ½ä¼šå¯¼è‡´ &lt;code&gt;UnsupportedOperationException&lt;/code&gt;å¼‚å¸¸ ã€‚ä½ åªèƒ½ä¿®æ”¹å·²æœ‰ä½ç½®çš„å…ƒç´ æˆ–è¯»å–ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; list = Arrays.asList(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;);
list.set(1, &amp;#34;X&amp;#34;); // OKï¼Œå°† &amp;#34;B&amp;#34; æ”¹ä¸º &amp;#34;X&amp;#34;ã€‚åŸæ•°ç»„å¯¹åº”ä½ç½®ä¹Ÿä¼šå˜ã€‚
// list.add(&amp;#34;D&amp;#34;); // æŠ›å‡º UnsupportedOperationException
// list.remove(0); // æŠ›å‡º UnsupportedOperationException
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸åŸæ•°ç»„çš„æ•°æ®ç»‘å®š&lt;/strong&gt;ï¼šè¿”å›çš„ List ä»…ä»…æ˜¯åŸæ•°ç»„çš„ä¸€ä¸ªâ€œè§†å›¾â€ï¼ˆViewï¼‰ï¼Œå®ƒä»¬&lt;strong&gt;å…±äº«åŒä¸€å—å†…å­˜åŒºåŸŸ&lt;/strong&gt;ã€‚è¿™æ„å‘³ç€ä½ å¯¹ List ä¸­æŸä¸ªå…ƒç´ çš„ä¿®æ”¹ï¼ˆé€šè¿‡ &lt;code&gt;set&lt;/code&gt;æ–¹æ³•ï¼‰ä¼šç›´æ¥å½±å“åŸæ•°ç»„ï¼›åä¹‹ï¼Œä¿®æ”¹åŸæ•°ç»„ï¼ŒList ä¸­çš„å¯¹åº”å…ƒç´ ä¹Ÿä¼šæ”¹å˜ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] arr = {&amp;#34;Apple&amp;#34;, &amp;#34;Banana&amp;#34;};
List&amp;lt;String&amp;gt; list = Arrays.asList(arr);
list.set(0, &amp;#34;Orange&amp;#34;); // ä¿®æ”¹åˆ—è¡¨
System.out.println(arr[0]); // è¾“å‡º &amp;#34;Orange&amp;#34;ï¼ŒåŸæ•°ç»„è¢«ä¿®æ”¹
arr[1] = &amp;#34;Grape&amp;#34;; // ä¿®æ”¹åŸæ•°ç»„
System.out.println(list.get(1)); // è¾“å‡º &amp;#34;Grape&amp;#34;ï¼Œåˆ—è¡¨ä¹Ÿéšä¹‹æ”¹å˜
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯¹åŸºæœ¬æ•°æ®ç±»å‹æ•°ç»„çš„â€œé™·é˜±â€&lt;/strong&gt;ï¼šè¿™ä¸ªæ–¹æ³•å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚ &lt;code&gt;int[]&lt;/code&gt;, &lt;code&gt;double[]&lt;/code&gt;ï¼‰çš„æ•°ç»„ä¼šè¡¨ç°å‡ºâ€œå¼‚å¸¸â€è¡Œä¸ºã€‚ç”±äºæ³›å‹ &lt;code&gt;T&lt;/code&gt;ä¸èƒ½æ˜¯åŸºæœ¬ç±»å‹ï¼Œ&lt;code&gt;Arrays.asList()&lt;/code&gt;ä¼šæŠŠæ•´ä¸ªåŸºæœ¬ç±»å‹æ•°ç»„å½“ä½œä¸€ä¸ª &lt;code&gt;Object&lt;/code&gt;å¯¹è±¡ï¼Œä½œä¸º List çš„&lt;strong&gt;å”¯ä¸€å…ƒç´ &lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int[] intArray = {1, 2, 3};
List&amp;lt;int[]&amp;gt; intList = Arrays.asList(intArray); // æ³¨æ„ï¼šList&amp;lt;int[]&amp;gt; è€Œä¸æ˜¯ List&amp;lt;Integer&amp;gt;
System.out.println(intList.size()); // è¾“å‡º 1ï¼Œå› ä¸ºæ•´ä¸ªæ•°ç»„è¢«è§†ä¸ºä¸€ä¸ªå…ƒç´ 
System.out.println(Arrays.toString(intList.get(0))); // è¾“å‡º [1, 2, 3]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ³•&lt;/strong&gt;ï¼šä½¿ç”¨&lt;strong&gt;åŒ…è£…ç±»å‹&lt;/strong&gt;ï¼ˆWrapper Classï¼‰çš„æ•°ç»„ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Integer[] integerArray = {1, 2, 3};
List&amp;lt;Integer&amp;gt; integerList = Arrays.asList(integerArray); // æ­£ç¡®ï¼šList&amp;lt;Integer&amp;gt;
System.out.println(integerList.size()); // è¾“å‡º 3
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•æ­£ç¡®ä½¿ç”¨ä¸è½¬æ¢"&gt;ğŸ›  å¦‚ä½•æ­£ç¡®ä½¿ç”¨ä¸è½¬æ¢
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åˆ›å»ºçœŸæ­£çš„å¯å˜ ArrayList&lt;/strong&gt;ï¼šå¦‚æœä½ éœ€è¦ä¸€ä¸ªå¯ä»¥åŠ¨æ€æ·»åŠ æˆ–åˆ é™¤å…ƒç´ çš„ Listï¼Œå¯ä»¥å°† &lt;code&gt;Arrays.asList()&lt;/code&gt;çš„è¿”å›å€¼ä½œä¸ºæ„é€ å‚æ•°ä¼ é€’ç»™ &lt;code&gt;java.util.ArrayList&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] arr = {&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;};
// åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ã€å¯å˜çš„ ArrayListï¼Œä¸åŸæ•°ç»„è„±é’©
List&amp;lt;String&amp;gt; mutableList = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(arr));
mutableList.add(&amp;#34;D&amp;#34;); // OK
mutableList.remove(&amp;#34;A&amp;#34;); // OK
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java 8+ Stream API è½¬æ¢&lt;/strong&gt;ï¼ˆå°¤å…¶é€‚ç”¨äºåŸºæœ¬ç±»å‹æ•°ç»„ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int[] intArray = {1, 2, 3};
// å°† int[] è½¬æ¢ä¸º List&amp;lt;Integer&amp;gt;
List&amp;lt;Integer&amp;gt; list = Arrays.stream(intArray)
.boxed() // å°† IntStream ä¸­çš„å…ƒç´ è£…ç®±ä¸º Integer
.collect(Collectors.toList());
list.add(4); // OK
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æ€»ç»“"&gt;ğŸ’¡ é€‚ç”¨åœºæ™¯ä¸æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Arrays.asList()&lt;/code&gt;æœ€é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åªè¯»æ“ä½œ&lt;/strong&gt;ï¼šå½“ä½ éœ€è¦å¿«é€Ÿè·å–ä¸€ä¸ªåˆ—è¡¨è§†å›¾æ¥è¿›è¡Œéå†ã€æŸ¥è¯¢ç­‰æ“ä½œï¼Œå¹¶ä¸”ä¸æ‰“ç®—ä¿®æ”¹åˆ—è¡¨å¤§å°æ—¶ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;API æ¡¥æ¥&lt;/strong&gt;ï¼šæŸäº›æ–¹æ³•æ¥å— List å‚æ•°ï¼Œä½†ä½ æ‰‹å¤´åªæœ‰æ•°ç»„ï¼Œå¯ä»¥å¿«é€Ÿè½¬æ¢åä¼ å…¥ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«é€Ÿåˆå§‹åŒ–&lt;/strong&gt;ï¼šæ–¹ä¾¿åœ°åˆå§‹åŒ–ä¸€ä¸ªå…ƒç´ å›ºå®šçš„åˆ—è¡¨ç”¨äºæµ‹è¯•æˆ–é…ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;é‡è¦æé†’&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥éœ€&lt;strong&gt;ä¿®æ”¹åˆ—è¡¨å†…å®¹ï¼ˆå…ƒç´ å€¼ï¼‰&lt;/strong&gt; ä¸”å¸Œæœ›&lt;strong&gt;å½±å“åŸæ•°ç»„&lt;/strong&gt;ï¼Œå¯ä½¿ç”¨ &lt;code&gt;set()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥éœ€&lt;strong&gt;æ”¹å˜åˆ—è¡¨ç»“æ„ï¼ˆå¢åˆ å…ƒç´ ï¼‰&lt;/strong&gt;ï¼ŒåŠ¡å¿…åˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;code&gt;ArrayList&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¤„ç†&lt;strong&gt;åŸºæœ¬ç±»å‹æ•°ç»„&lt;/strong&gt;æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨&lt;strong&gt;åŒ…è£…ç±»å‹æ•°ç»„&lt;/strong&gt;æˆ– &lt;strong&gt;Stream API&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ &lt;code&gt;Arrays.asList()&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id="æ•°ç»„"&gt;æ•°ç»„
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­åˆ›å»ºæ™®é€šæ•°ç»„ï¼ˆå³éé›†åˆï¼‰æœ‰å¤šç§æ–¹å¼ï¼Œä¸»è¦åˆ†ä¸ºä¸€ç»´æ•°ç»„å’Œå¤šç»´æ•°ç»„ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†æ ¸å¿ƒçš„åˆ›å»ºæ–¹æ³•ï¼Œæ–¹ä¾¿ä½ å¿«é€Ÿäº†è§£ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åˆ›å»ºæ–¹æ³•&lt;/th&gt;
&lt;th&gt;è¯­æ³•ç¤ºä¾‹&lt;/th&gt;
&lt;th&gt;ç‰¹ç‚¹è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ¨æ€åˆå§‹åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] arr = new int[5];&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å…ˆæŒ‡å®šæ•°ç»„é•¿åº¦ï¼Œå…ƒç´ ä¸ºé»˜è®¤å€¼ï¼ˆå¦‚intä¸º0ï¼Œå¯¹è±¡ä¸ºnullï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€åˆå§‹åŒ–ï¼ˆå®Œæ•´ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] arr = new int[]{1, 2, 3};&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºåŒæ—¶èµ‹å€¼ï¼Œæ•°ç»„é•¿åº¦ç”±å…ƒç´ ä¸ªæ•°å†³å®š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€åˆå§‹åŒ–ï¼ˆç²¾ç®€ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] arr = {1, 2, 3};&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æœ€ç®€æ´çš„å†™æ³•ï¼Œå£°æ˜ä¸èµ‹å€¼å¿…é¡»åœ¨åŒä¸€è¯­å¥å®Œæˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†æ­¥å£°æ˜ä¸åˆ›å»º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[] arr;``arr = new int[5];&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å£°æ˜å’Œåˆ›å»ºå¯åˆ†ä¸¤æ­¥è¿›è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äºŒç»´æ•°ç»„ï¼ˆè§„åˆ™ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[][] arr = new int[3][2];&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»º3è¡Œ2åˆ—çš„äºŒç»´æ•°ç»„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äºŒç»´æ•°ç»„ï¼ˆä¸è§„åˆ™ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int[][] arr = new int[2][];``arr[0] = new int[3];&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å„è¡Œé•¿åº¦å¯ä»¥ä¸åŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ•°ç»„çš„åˆå§‹å€¼ä¸å…³é”®ç»†èŠ‚"&gt;ğŸ”§ æ•°ç»„çš„åˆå§‹å€¼ä¸å…³é”®ç»†èŠ‚
&lt;/h3&gt;&lt;p&gt;ç†è§£æ•°ç»„çš„åˆ›å»ºåï¼Œè¿˜æœ‰ä¸€äº›å…³é”®çš„ç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œå®ƒä»¬ç›´æ¥å½±å“ç€ä½ å¦‚ä½•ä½¿ç”¨æ•°ç»„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤å€¼è§„åˆ™&lt;/strong&gt;ï¼šä½¿ç”¨åŠ¨æ€åˆå§‹åŒ–æ—¶ï¼Œæ•°ç»„å…ƒç´ ä¼šè¢«è‡ªåŠ¨èµ‹äºˆé»˜è®¤å€¼ã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;int&lt;/code&gt;ä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œ&lt;code&gt;double&lt;/code&gt;ä¸º &lt;code&gt;0.0&lt;/code&gt;ï¼Œ&lt;code&gt;boolean&lt;/code&gt;ä¸º &lt;code&gt;false&lt;/code&gt;ï¼Œè€Œå¼•ç”¨ç±»å‹ï¼ˆå¦‚ &lt;code&gt;String&lt;/code&gt;ï¼‰åˆ™ä¸º &lt;code&gt;null&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿åº¦å›ºå®šæ€§&lt;/strong&gt;ï¼šä¸€æ—¦æ•°ç»„è¢«åˆ›å»ºï¼Œå…¶é•¿åº¦å°±å›ºå®šä¸å˜ã€‚è¿™æ˜¯æ•°ç»„ä¸ &lt;code&gt;ArrayList&lt;/code&gt;ç­‰é›†åˆçš„ä¸»è¦åŒºåˆ«ä¹‹ä¸€ã€‚å¦‚æœéœ€è¦æ”¹å˜â€œæ•°ç»„â€å¤§å°ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸‹æ ‡ä»é›¶å¼€å§‹&lt;/strong&gt;ï¼šæ•°ç»„ä¸‹æ ‡ï¼ˆç´¢å¼•ï¼‰ä» &lt;code&gt;0&lt;/code&gt;å¼€å§‹ï¼Œæœ‰æ•ˆèŒƒå›´æ˜¯ &lt;code&gt;[0, array.length - 1]&lt;/code&gt;ã€‚è®¿é—®è¶…å‡ºæ­¤èŒƒå›´çš„å…ƒç´ ä¼šæŠ›å‡º &lt;code&gt;ArrayIndexOutOfBoundsException&lt;/code&gt;å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-é€‰æ‹©å»ºè®®ä¸æœ€ä½³å®è·µ"&gt;ğŸ’¡ é€‰æ‹©å»ºè®®ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;p&gt;åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œå¦‚ä½•é€‰æ‹©åˆ›å»ºæ–¹å¼å‘¢ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ˜ç¡®å…ƒç´ æ—¶&lt;/strong&gt;ï¼šå¦‚æœä¸€å¼€å§‹å°±çŸ¥é“æ‰€æœ‰è¦å­˜æ”¾çš„å…ƒç´ ï¼Œä½¿ç”¨&lt;strong&gt;é™æ€åˆå§‹åŒ–&lt;/strong&gt;ï¼ˆç‰¹åˆ«æ˜¯ç²¾ç®€å†™æ³•ï¼‰æœ€ç›´æ¥æ˜äº†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªçŸ¥å…ƒç´ æ—¶&lt;/strong&gt;ï¼šå¦‚æœæ•°ç»„é•¿åº¦å·²çŸ¥ï¼Œä½†å…·ä½“å…ƒç´ å€¼éœ€è¦åç»­è®¡ç®—æˆ–è¾“å…¥ï¼Œåˆ™ä½¿ç”¨&lt;strong&gt;åŠ¨æ€åˆå§‹åŒ–&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°å¿ƒåŸºæœ¬ç±»å‹æ•°ç»„çš„â€œé™·é˜±â€&lt;/strong&gt;ï¼šè¦æ³¨æ„ï¼Œç±»ä¼¼ &lt;code&gt;int[]&lt;/code&gt;æ˜¯åŸºæœ¬ç±»å‹æ•°ç»„ï¼Œè€Œç±»ä¼¼ &lt;code&gt;Integer[]&lt;/code&gt;æ˜¯å¼•ç”¨ç±»å‹æ•°ç»„ã€‚åœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸‹ï¼ˆä¾‹å¦‚ä½œä¸ºæŸäº›æ–¹æ³•çš„å‚æ•°æ—¶ï¼‰ä¸¤è€…è¡¨ç°ä¸åŒï¼Œä½†å°±åˆ›å»ºæ–¹å¼è€Œè¨€ï¼Œè¯­æ³•æ˜¯ç›¸åŒçš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°ç†è§£å¹¶åœ¨ Java ä¸­åˆ›å»ºæ‰€éœ€çš„æ•°ç»„ï¼å¦‚æœä½ å¯¹ç‰¹å®šåœºæ™¯ä¸‹çš„æ•°ç»„ç”¨æ³•æœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘å¾ˆä¹æ„ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="æ•°ç»„--arraylist"&gt;æ•°ç»„ &amp;amp; ArrayList
&lt;/h2&gt;&lt;p&gt;æ•°ç»„å’Œ &lt;code&gt;ArrayList&lt;/code&gt;æ˜¯ Java ä¸­å­˜å‚¨ä¸€ç»„æ•°æ®çš„ä¸¤ç§æ ¸å¿ƒæ–¹å¼ï¼Œå®ƒä»¬åœ¨ä½¿ç”¨åœºæ™¯å’Œæ€§èƒ½ä¸Šå„æœ‰ä¾§é‡ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯ä»¥å¸®ä½ å¿«é€ŸæŠŠæ¡å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§å¯¹æ¯”&lt;/th&gt;
&lt;th&gt;æ•°ç»„ (Array)&lt;/th&gt;
&lt;th&gt;ArrayList&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤§å°/çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å›ºå®šé•¿åº¦ï¼Œåˆ›å»ºåæ— æ³•æ”¹å˜&lt;/td&gt;
&lt;td&gt;åŠ¨æ€æ‰©å®¹ï¼Œå®¹é‡å¯è‡ªåŠ¨å¢é•¿ï¼ˆé€šå¸¸ä¸ºåŸå®¹é‡çš„1.5å€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ”¯æŒçš„æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚ &lt;code&gt;int&lt;/code&gt;, &lt;code&gt;char&lt;/code&gt;) å’Œå¯¹è±¡ç±»å‹&lt;/td&gt;
&lt;td&gt;ä»…æ”¯æŒå¯¹è±¡ç±»å‹ï¼ŒåŸºæœ¬ç±»å‹éœ€è£…ç®±/æ‹†ç®±ï¼ˆå¦‚ &lt;code&gt;Integer&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜ç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿ç»­å†…å­˜å—ï¼Œæ— é¢å¤–å¼€é”€&lt;/td&gt;
&lt;td&gt;éœ€é¢å¤–ç©ºé—´å­˜å‚¨å®¹é‡ç­‰ä¿¡æ¯ï¼ŒåŠ¨æ€æ‰©å®¹ä¼šå¸¦æ¥ä¸´æ—¶å¼€é”€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šç»´æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸç”Ÿæ”¯æŒï¼ˆå¦‚ &lt;code&gt;int[][]&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€åµŒå¥—å®ç°ï¼ˆå¦‚ &lt;code&gt;ArrayList&amp;lt;ArrayList&amp;lt;Integer&amp;gt;&amp;gt;&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ç‰¹ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è®¿é—®å’Œä¿®æ”¹æå¿«&lt;/strong&gt; (O(1))ï¼Œæ— æ–¹æ³•è°ƒç”¨å¼€é”€&lt;/td&gt;
&lt;td&gt;è®¿é—®ä¹Ÿå¾ˆå¿« (O(1))ï¼Œä½†å› å°è£…æœ‰å°‘è®¸å¼€é”€ï¼›å¢åˆ å…ƒç´ å¯èƒ½å¯¼è‡´æ•°æ®ç§»åŠ¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠŸèƒ½ä¸æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºç¡€ï¼Œæ“ä½œéœ€æ‰‹åŠ¨å®ç°ï¼ˆå¦‚å¤åˆ¶æ•°ç»„æ¥æ‰©å®¹ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸°å¯Œï¼Œæä¾› &lt;code&gt;add()&lt;/code&gt;, &lt;code&gt;remove()&lt;/code&gt;, &lt;code&gt;contains()&lt;/code&gt;ç­‰ä¾¿æ·æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©"&gt;ğŸ’¡ å¦‚ä½•é€‰æ‹©
&lt;/h3&gt;&lt;p&gt;é€‰æ‹©çš„å…³é”®åœ¨äºæ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚è¿›è¡Œæƒè¡¡ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜å…ˆé€‰æ‹©æ•°ç»„çš„æƒ…å†µï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®é‡å›ºå®šä¸”å·²çŸ¥&lt;/strong&gt;ï¼šä¾‹å¦‚ï¼Œå­˜å‚¨ä¸€å‘¨çš„ä¸ƒå¤©ã€ä¸€ä¸ªæ£‹ç›˜çš„æ ¼å­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿½æ±‚æè‡´æ€§èƒ½&lt;/strong&gt;ï¼šåœ¨æ€§èƒ½è‡³å…³é‡è¦çš„åœºæ™¯ï¼Œå¦‚ç§‘å­¦è®¡ç®—ã€æ¸¸æˆå¼•æ“ã€å›¾åƒå¤„ç†ä¸­çš„åƒç´ çŸ©é˜µï¼Œä½¿ç”¨åŸºæœ¬ç±»å‹æ•°ç»„å¯ä»¥é¿å…è£…ç®±å¼€é”€ï¼Œè·å¾—æœ€é«˜æ•ˆç‡ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦ä½¿ç”¨å¤šç»´ç»“æ„&lt;/strong&gt;ï¼šå¦‚è¡¨ç¤ºçŸ©é˜µã€è¡¨æ ¼ç­‰ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸åº•å±‚APIäº¤äº’&lt;/strong&gt;ï¼šè®¸å¤šJavaæ ‡å‡†åº“æˆ–ç¬¬ä¸‰æ–¹åº“çš„æ–¹æ³•è¦æ±‚ä¼ å…¥æ•°ç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜å…ˆé€‰æ‹© &lt;code&gt;ArrayList&lt;/code&gt;çš„æƒ…å†µï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®é‡åŠ¨æ€å˜åŒ–&lt;/strong&gt;ï¼šä¾‹å¦‚ï¼Œå­˜å‚¨ç”¨æˆ·è¾“å…¥ã€ä»æ•°æ®åº“æŸ¥è¯¢è¿”å›çš„ç»“æœé›†ã€ç¤¾äº¤åª’ä½“çš„åŠ¨æ€æ¶ˆæ¯æµ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦é¢‘ç¹å¢åˆ å…ƒç´ &lt;/strong&gt;ï¼šå¹¶ä¸”ä½ç½®ä¸ç¡®å®šï¼Œ&lt;code&gt;ArrayList&lt;/code&gt;æä¾›çš„ &lt;code&gt;add()&lt;/code&gt;å’Œ &lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•éå¸¸æ–¹ä¾¿ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦ä¸°å¯Œçš„é›†åˆæ“ä½œ&lt;/strong&gt;ï¼šå¦‚æ£€æŸ¥åŒ…å«ï¼ˆ&lt;code&gt;contains&lt;/code&gt;ï¼‰ã€è·å–å­åˆ—è¡¨ç­‰ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœ‹é‡ç±»å‹å®‰å…¨ä¸ä»£ç ç®€æ´&lt;/strong&gt;ï¼šæ³›å‹èƒ½åœ¨ç¼–è¯‘æœŸå°±é¿å…ç±»å‹é”™è¯¯ï¼Œä¸°å¯Œçš„APIè®©ä»£ç æ›´æ˜“è¯»å†™å’Œç»´æŠ¤ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“ä¸æœ€ä½³å®è·µ-2"&gt;ğŸ’ æ€»ç»“ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°ç»„æ˜¯â€œè¿åŠ¨å‘˜â€&lt;/strong&gt;ï¼šè½»é‡ã€ä¸“æ³¨ã€é€Ÿåº¦æè‡´ï¼Œé€‚åˆå¤„ç†å›ºå®šã€å·²çŸ¥ä¸”å¯¹æ€§èƒ½æ•æ„Ÿçš„æ•°æ® ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ArrayList&lt;/code&gt;æ˜¯â€œç‘å£«å†›åˆ€â€&lt;/strong&gt;ï¼šåŠŸèƒ½ä¸°å¯Œã€çµæ´»é€šç”¨ï¼Œé€‚åˆå¤„ç†åŠ¨æ€å˜åŒ–ã€éœ€è¦å¤æ‚æ“ä½œçš„æ•°æ®é›†åˆ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸€ä¸ªå¸¸è§çš„æ€§èƒ½ä¼˜åŒ–å®è·µæ˜¯ï¼Œå¦‚æœèƒ½å¤Ÿé¢„ä¼° &lt;code&gt;ArrayList&lt;/code&gt;çš„å¤§è‡´å®¹é‡ï¼Œæœ€å¥½åœ¨åˆ›å»ºæ—¶ä½¿ç”¨å¸¦åˆå§‹å®¹é‡çš„æ„é€ å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;new ArrayList&amp;lt;&amp;gt;(1000)&lt;/code&gt;ï¼‰æˆ–è°ƒç”¨ &lt;code&gt;ensureCapacity()&lt;/code&gt;æ–¹æ³•é¢„å…ˆåˆ†é…è¶³å¤Ÿç©ºé—´ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆå‡å°‘æ‰©å®¹æ¬¡æ•°ï¼Œæå‡æ€§èƒ½ ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„å¯¹æ¯”èƒ½å¸®åŠ©ä½ åœ¨ç¼–ç¨‹æ—¶åšå‡ºæœ€åˆé€‚çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h2 id="ç›¸äº’è½¬åŒ–"&gt;ç›¸äº’è½¬åŒ–
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œæ•°ç»„å’Œ &lt;code&gt;List&lt;/code&gt;çš„ç›¸äº’è½¬æ¢æ˜¯å¸¸è§æ“ä½œã€‚è™½ç„¶å®ƒä»¬éƒ½æ˜¯å­˜å‚¨æ•°æ®çš„å®¹å™¨ï¼Œä½†æ•°ç»„å¤§å°å›ºå®šï¼Œè€Œ &lt;code&gt;List&lt;/code&gt;å¯ä»¥åŠ¨æ€å¢é•¿ã€‚ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒæ–¹æ³•ï¼Œæˆ‘å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ±‡æ€»ä¸»è¦è½¬æ¢æ–¹å¼åŠå…¶ç‰¹ç‚¹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è½¬æ¢æ–¹å‘&lt;/th&gt;
&lt;th&gt;æ–¹æ³•&lt;/th&gt;
&lt;th&gt;å…³é”®ç‰¹ç‚¹/æ³¨æ„äº‹é¡¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°ç»„ â†’ List&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Arrays.asList(array)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿”å›ä¸€ä¸ª&lt;strong&gt;å›ºå®šå¤§å°&lt;/strong&gt;çš„ List &lt;strong&gt;è§†å›¾&lt;/strong&gt;ï¼Œä¸åŸæ•°ç»„æ•°æ®å…±äº«ã€‚ä¸æ”¯æŒå¢åˆ æ“ä½œ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;new ArrayList&amp;lt;&amp;gt;(Arrays.asList(array))&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºä¸€ä¸ª&lt;strong&gt;çœŸæ­£å¯å˜&lt;/strong&gt;çš„ &lt;code&gt;ArrayList&lt;/code&gt;ï¼Œä¸åŸæ•°ç»„è„±é’© ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Collections.addAll(list, array)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°†æ•°ç»„å…ƒç´ æ·»åŠ åˆ°&lt;strong&gt;å·²å­˜åœ¨&lt;/strong&gt;çš„å¯å˜ List ä¸­ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Arrays.stream(array).collect(Collectors.toList())&lt;/code&gt;(Java 8+)&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ Stream APIï¼Œçµæ´»ä¸”å¯è¯»æ€§å¥½ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;List â†’ æ•°ç»„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list.toArray()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿”å› &lt;code&gt;Object[]&lt;/code&gt;ç±»å‹æ•°ç»„ï¼Œé€šå¸¸&lt;strong&gt;ä¸å¸¸ç”¨&lt;/strong&gt; ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list.toArray(new T[0])&lt;/code&gt;(æ¨è)&lt;/td&gt;
&lt;td&gt;ä¼ å…¥ä¸€ä¸ªç±»å‹åŒ¹é…çš„ç©ºæ•°ç»„ï¼ŒJVM é€šå¸¸ä¼šä¼˜åŒ–å¹¶ç›´æ¥åˆ›å»ºæ–°æ•°ç»„ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list.toArray(new T[list.size()])&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¼ å…¥ä¸€ä¸ªå¤§å°åŒ¹é…çš„æ•°ç»„ï¼Œæ€§èƒ½å¯èƒ½ç¨å¥½ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list.stream().toArray(T[]::new)&lt;/code&gt;(Java 8+)&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ Stream APIï¼Œä»£ç ç®€æ´ ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ•°ç»„è½¬æ¢ä¸º-list"&gt;ğŸ”§ æ•°ç»„è½¬æ¢ä¸º List
&lt;/h3&gt;&lt;h4 id="ä½¿ç”¨-arraysaslist"&gt;ä½¿ç”¨ &lt;code&gt;Arrays.asList()&lt;/code&gt;
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯æœ€å¿«æ·çš„æ–¹æ³•ï¼Œä½†è¿”å›çš„ List æ˜¯å›ºå®šå¤§å°çš„ï¼Œå°è¯•æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ä¼šæŠ›å‡º &lt;code&gt;UnsupportedOperationException&lt;/code&gt;ã€‚å®ƒæ›´åƒæ˜¯åŸæ•°ç»„çš„ä¸€ä¸ªâ€œè§†å›¾â€ï¼Œä¿®æ”¹ List ä¸­çš„å…ƒç´ ä¼šç›´æ¥å½±å“åŸæ•°ç»„ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] array = {&amp;#34;Apple&amp;#34;, &amp;#34;Banana&amp;#34;, &amp;#34;Cherry&amp;#34;};
List&amp;lt;String&amp;gt; list = Arrays.asList(array);
list.set(0, &amp;#34;Orange&amp;#34;); // å¯ä»¥ä¿®æ”¹å…ƒç´ ï¼ŒåŸæ•°ç»„array[0]ä¹Ÿä¼šå˜ä¸º&amp;#34;Orange&amp;#34;
// list.add(&amp;#34;Grape&amp;#34;); // é”™è¯¯ï¼æŠ›å‡º UnsupportedOperationException
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="åˆ›å»ºçœŸæ­£çš„å¯å˜-list"&gt;åˆ›å»ºçœŸæ­£çš„å¯å˜ List
&lt;/h4&gt;&lt;p&gt;å¦‚æœä½ éœ€è¦ä¸€ä¸ªå¯ä»¥å¢åˆ å…ƒç´ çš„ Listï¼Œå¯ä»¥å°†å…¶åŒ…è£…åœ¨ä¸€ä¸ªæ–°çš„ &lt;code&gt;ArrayList&lt;/code&gt;ä¸­ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] array = {&amp;#34;Apple&amp;#34;, &amp;#34;Banana&amp;#34;, &amp;#34;Cherry&amp;#34;};
List&amp;lt;String&amp;gt; mutableList = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(array));
mutableList.add(&amp;#34;Grape&amp;#34;); // ç°åœ¨å¯ä»¥æ­£å¸¸æ·»åŠ äº†
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å…¶ä»–æ–¹æ³•"&gt;å…¶ä»–æ–¹æ³•
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;Collections.addAll()&lt;/code&gt;&lt;/strong&gt;ï¼šé€‚ç”¨äºå·²æœ‰ä¸€ä¸ªå¯å˜ List å¹¶å‘å…¶ä¸­æ·»åŠ æ•°ç»„å…ƒç´ çš„æƒ…å†µ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨ Stream API (Java 8+)&lt;/strong&gt;ï¼šæä¾›äº†ç°ä»£å‡½æ•°å¼ç¼–ç¨‹çš„é£æ ¼ï¼Œéå¸¸çµæ´» ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-list-è½¬æ¢ä¸ºæ•°ç»„"&gt;ğŸ“¦ List è½¬æ¢ä¸ºæ•°ç»„
&lt;/h3&gt;&lt;h4 id="ä½¿ç”¨-toarrayt-aæ–¹æ³•"&gt;ä½¿ç”¨ &lt;code&gt;toArray(T[] a)&lt;/code&gt;æ–¹æ³•
&lt;/h4&gt;&lt;p&gt;è¿™æ˜¯æœ€å¸¸ç”¨å’Œæ¨èçš„æ–¹å¼ã€‚å…³é”®åœ¨äºä¼ å…¥ä¸€ä¸ªç±»å‹æ­£ç¡®çš„æ•°ç»„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¨èä¼ å…¥ç©ºæ•°ç»„&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;list.toArray(new T[0])&lt;/code&gt;æ˜¯ç°ä»£ JDK ä¸­æ¨èçš„åšæ³•ï¼Œæ€§èƒ½å¾ˆå¥½ä¸”ä»£ç ç®€æ´ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; list = Arrays.asList(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;);
String[] array = list.toArray(new String[0]);
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼ å…¥ç¡®å®šå¤§å°çš„æ•°ç»„&lt;/strong&gt;ï¼šä½ ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªå¤§å°åŒ¹é…çš„æ•°ç»„ï¼Œè¿™æ—¶ &lt;code&gt;toArray&lt;/code&gt;ä¼šä½¿ç”¨è¿™ä¸ªæ•°ç»„è€Œæ— éœ€æ–°å»º ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;String[] array = list.toArray(new String[list.size()]);
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä½¿ç”¨-stream-api-java-8"&gt;ä½¿ç”¨ Stream API (Java 8+)
&lt;/h4&gt;&lt;p&gt;åŒæ ·å¯ä»¥é€šè¿‡ Stream å®Œæˆè½¬æ¢ ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; list = Arrays.asList(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;);
String[] array = list.stream().toArray(String[]::new);
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-ç‰¹åˆ«æ³¨æ„åŸºæœ¬æ•°æ®ç±»å‹æ•°ç»„"&gt;âš ï¸ ç‰¹åˆ«æ³¨æ„ï¼šåŸºæœ¬æ•°æ®ç±»å‹æ•°ç»„
&lt;/h3&gt;&lt;p&gt;å¯¹äº &lt;code&gt;int[]&lt;/code&gt;, &lt;code&gt;double[]&lt;/code&gt;ç­‰åŸºæœ¬ç±»å‹æ•°ç»„ï¼Œ&lt;strong&gt;ä¸èƒ½ç›´æ¥ä½¿ç”¨ &lt;code&gt;Arrays.asList()&lt;/code&gt;&lt;/strong&gt;ï¼Œå› ä¸ºå®ƒä¼šå°†æ•´ä¸ªåŸºæœ¬ç±»å‹æ•°ç»„è§†ä¸ºä¸€ä¸ªå¯¹è±¡å…ƒç´ ï¼Œè€Œä¸æ˜¯å°†å…¶æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºåˆ—è¡¨é¡¹ ã€‚ä½ éœ€è¦ä½¿ç”¨ Stream API è¿›è¡Œè½¬æ¢ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int[] intArray = {1, 2, 3};
// é”™è¯¯åšæ³•ï¼šList&amp;lt;int[]&amp;gt; wrongList = Arrays.asList(intArray); // è¿™é‡ŒListé‡Œåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå°±æ˜¯æ•´ä¸ªintArrayå¯¹è±¡
// æ­£ç¡®åšæ³•ï¼šä½¿ç”¨Stream
List&amp;lt;Integer&amp;gt; correctList = Arrays.stream(intArray).boxed().collect(Collectors.toList());
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-æ€»ç»“ä¸é€‰æ‹©å»ºè®®"&gt;ğŸ’ æ€»ç»“ä¸é€‰æ‹©å»ºè®®
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦åªè¯»è§†å›¾&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;Arrays.asList()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦å¯å˜åˆ—è¡¨&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;new ArrayList&amp;lt;&amp;gt;(Arrays.asList(array))&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿½æ±‚ä»£ç ç®€æ´ç°ä»£ (Java 8+)&lt;/strong&gt;ï¼šä½¿ç”¨ Stream APIã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;List è½¬æ•°ç»„&lt;/strong&gt;ï¼šä¼˜å…ˆä½¿ç”¨ &lt;code&gt;list.toArray(new T[0])&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„æŒ‡å—èƒ½å¸®åŠ©ä½ åœ¨ç¼–ç¨‹æ—¶è½»æ¾å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼&lt;/p&gt;
&lt;h2 id="ygc"&gt;YGC
&lt;/h2&gt;&lt;p&gt;å½“åœ¨ Minor GC è¿‡ç¨‹ä¸­ï¼Œå­˜æ´»çš„å¯¹è±¡å¤ªå¤šä»¥è‡³äº To Survivor åŒºæ”¾ä¸ä¸‹æ—¶ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼š&lt;strong&gt;ç›´æ¥æ™‹å‡åˆ°è€å¹´ä»£&lt;/strong&gt;ã€‚è¿™æ˜¯ JVM ä¸€ç§é‡è¦çš„&lt;strong&gt;å†…å­˜åˆ†é…æ‹…ä¿æœºåˆ¶&lt;/strong&gt;ï¼Œç›®çš„æ˜¯ç¡®ä¿åƒåœ¾å›æ”¶è¿‡ç¨‹èƒ½å¤Ÿé¡ºåˆ©å®Œæˆï¼Œé¿å…å†…å­˜åˆ†é…å¤±è´¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ¦‚æ‹¬äº†è¿™ä¸€è¿‡ç¨‹çš„æ ¸å¿ƒç¯èŠ‚å’Œå…³é”®ç‚¹ï¼Œå¸®åŠ©ä½ å¿«é€ŸæŠŠæ¡ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ ¸å¿ƒç¯èŠ‚&lt;/th&gt;
&lt;th&gt;å…³é”®ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Eden åŒºç©ºé—´ä¸è¶³è§¦å‘ Minor GCï¼›å­˜æ´»å¯¹è±¡æ€»ä½“ç§¯ &amp;gt; To Survivor åŒºå®¹é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JVM çš„åº”å¯¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯åŠ¨&lt;strong&gt;å†…å­˜åˆ†é…æ‹…ä¿æœºåˆ¶&lt;/strong&gt;ï¼Œè®© To Survivor åŒºæ— æ³•å®¹çº³çš„å‰©ä½™å­˜æ´»å¯¹è±¡&lt;strong&gt;ç›´æ¥è¿›å…¥è€å¹´ä»£&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡æ„å›¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç¡®ä¿GCå®‰å…¨&lt;/strong&gt;ï¼šä¼˜å…ˆä¿è¯ç¨‹åºä¸å› å†…å­˜åˆ†é…å¤±è´¥è€Œå´©æºƒï¼›&lt;strong&gt;ä¼˜åŒ–æ€§èƒ½&lt;/strong&gt;ï¼šé¿å…å¤§å¯¹è±¡åœ¨ Survivor åŒºä¹‹é—´åå¤å¤åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ½œåœ¨å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½&lt;strong&gt;åŠ é€Ÿè€å¹´ä»£å¡«æ»¡&lt;/strong&gt;ï¼Œå¢åŠ  Major GC / Full GC é£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›¸å…³å‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:PretenureSizeThreshold&lt;/code&gt;ï¼ˆå¤§å¯¹è±¡ç›´æ¥å…¥è€å¹´ä»£ï¼‰ï¼›&lt;code&gt;-XX:MaxTenuringThreshold&lt;/code&gt;ï¼ˆæ™‹å‡å¹´é¾„é˜ˆå€¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-è¯¦ç»†è¿‡ç¨‹ä¸è®¾è®¡è€ƒé‡"&gt;ğŸ” è¯¦ç»†è¿‡ç¨‹ä¸è®¾è®¡è€ƒé‡
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¸¸è§„çš„ Minor GC æµç¨‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå½“ &lt;strong&gt;Eden åŒºç©ºé—´ä¸è¶³&lt;/strong&gt;æ—¶ï¼Œä¼šè§¦å‘ä¸€æ¬¡ Minor GCã€‚JVM ä¼šæš‚åœç”¨æˆ·çº¿ç¨‹ï¼ˆStop-The-Worldï¼‰ï¼Œç„¶åè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ‡è®°&lt;/strong&gt;ï¼šä» GC Roots å¼€å§‹ï¼Œæ ‡è®°å‡º Eden åŒºå’Œ &lt;strong&gt;From Survivor åŒº&lt;/strong&gt;ä¸­æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤åˆ¶&lt;/strong&gt;ï¼šå°†æ ‡è®°å‡ºçš„æ‰€æœ‰å­˜æ´»å¯¹è±¡ï¼Œ&lt;strong&gt;å¤åˆ¶åˆ° To Survivor åŒº&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…ç†&lt;/strong&gt;ï¼šæ¸…ç©º Eden åŒºå’Œåˆšæ‰çš„ From Survivor åŒºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§’è‰²äº’æ¢&lt;/strong&gt;ï¼šåœ¨è¿™æ¬¡ GC å®Œæˆåï¼ŒåŸæ¥çš„ To Survivor åŒºå˜æˆä¸‹ä¸€æ¬¡ GC çš„ From Survivor åŒºï¼Œè€ŒåŸæ¥çš„ From Survivor åŒºåˆ™å˜ä¸ºæ–°çš„ To Survivor åŒºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å½“ To Survivor åŒºç©ºé—´ä¸è¶³æ—¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ¬æ¬¡ Minor GC åå­˜æ´»çš„å¯¹è±¡æ€»ä½“ç§¯è¶…è¿‡äº† &lt;strong&gt;To Survivor åŒºçš„æ€»å®¹é‡&lt;/strong&gt;ï¼ŒJVM ä¸ä¼šè®©è¿™æ¬¡ GC å¤±è´¥ï¼Œè€Œæ˜¯ä¼šå¯åŠ¨ä¸€ä¸ªâ€œåå¤‡è®¡åˆ’â€â€”â€”&lt;strong&gt;å†…å­˜åˆ†é…æ‹…ä¿æœºåˆ¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;JVM ä¼šæ£€æŸ¥&lt;strong&gt;è€å¹´ä»£çš„å‰©ä½™ç©ºé—´&lt;/strong&gt;ã€‚å¦‚æœè€å¹´ä»£å‰©ä½™ç©ºé—´&lt;strong&gt;è¶³å¤Ÿå®¹çº³&lt;/strong&gt;è¿™äº›è¶…å‡ºçš„å­˜æ´»å¯¹è±¡ï¼Œé‚£ä¹ˆå®ƒä»¬å°±ä¼šè¢«&lt;strong&gt;ç›´æ¥å¤åˆ¶åˆ°è€å¹´ä»£&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¹‹åï¼Œé‚£äº›èƒ½å¤Ÿè¢« To Survivor åŒºå®¹çº³çš„å­˜æ´»å¯¹è±¡ä¼šæ­£å¸¸è¿›å…¥ To Survivor åŒºï¼Œå¹¶ä¸”å®ƒä»¬çš„å¹´é¾„è®¡æ•°å™¨ä¼šå¢åŠ 1å²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¡®ä¿å®‰å…¨&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€æ ¸å¿ƒçš„åŸå› ã€‚GC çš„é¦–è¦ç›®æ ‡æ˜¯ä¿è¯åº”ç”¨ç¨‹åºèƒ½æ­£å¸¸è¿è¡Œä¸‹å»ã€‚å¦‚æœå› ä¸º Survivor åŒºæ»¡äº†å°±ä¸å¤„ç†ï¼Œä¼šå¯¼è‡´å†…å­˜åˆ†é…å¤±è´¥ï¼Œç¨‹åºå¯èƒ½å´©æºƒã€‚ç›´æ¥æ™‹å‡åˆ°ç©ºé—´æ›´å¤§çš„è€å¹´ä»£æ˜¯ä¸€ç§å¯é çš„ä¿éšœæªæ–½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼šSurvivor åŒºæœ¬èº«ä¸å¤§ï¼ˆé»˜è®¤åªå æ–°ç”Ÿä»£çš„10%ï¼‰ï¼Œè®©ä¸€äº›è¾ƒå¤§çš„å­˜æ´»å¯¹è±¡åœ¨å…¶ä¸­æ¥å›å¤åˆ¶ï¼ˆæ¯æ¬¡ Minor GC éƒ½è¦å¤åˆ¶ä¸€æ¬¡ï¼‰çš„æˆæœ¬å¾ˆé«˜ã€‚è®©å®ƒä»¬å°½æ—©è¿›å…¥è€å¹´ä»£ï¼Œå¯ä»¥é¿å…è¿™ç§æ— è°“çš„å¤åˆ¶å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ½œåœ¨å½±å“ä¸è°ƒä¼˜æç¤º"&gt;âš ï¸ æ½œåœ¨å½±å“ä¸è°ƒä¼˜æç¤º
&lt;/h3&gt;&lt;p&gt;è™½ç„¶è¿™ä¸ªæœºåˆ¶ä¿è¯äº†ç¨‹åºçš„å®‰å…¨æ€§ï¼Œä½†ä¹Ÿå¯èƒ½å¸¦æ¥ä¸€äº›&lt;strong&gt;å‰¯ä½œç”¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è€å¹´ä»£å‹åŠ›å¢å¤§&lt;/strong&gt;ï¼šé¢‘ç¹å‘ç”Ÿè¿™ç§æƒ…å†µä¼šå¯¼è‡´å¤§é‡æœ¬è¯¥ç•™åœ¨æ–°ç”Ÿä»£çš„çŸ­æœŸå­˜æ´»å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼ŒåŠ é€Ÿè€å¹´ä»£çš„å¡«æ»¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢åŠ  Full GC é£é™©&lt;/strong&gt;ï¼šè€å¹´ä»£è¢«æ›´å¿«å¡«æ»¡åï¼Œä¼šæ›´å®¹æ˜“è§¦å‘ &lt;strong&gt;Major GC / Full GC&lt;/strong&gt;ã€‚è€Œ Full GC çš„é€Ÿåº¦æ¯” Minor GC æ…¢å¾—å¤šï¼Œä¼šå¯¼è‡´åº”ç”¨åœé¡¿æ—¶é—´æ˜¾è‘—åŠ é•¿ï¼Œä¸¥é‡å½±å“æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†ç¼“è§£è¿™ç§æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹&lt;strong&gt;è°ƒä¼˜æ€è·¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è°ƒæ•´ Survivor åŒºå¤§å°&lt;/strong&gt;ï¼šé€šè¿‡ JVM å‚æ•° &lt;code&gt;-XX:SurvivorRatio&lt;/code&gt;è°ƒæ•´ Eden å’Œ Survivor çš„æ¯”ä¾‹ï¼Œé€‚å½“å¢å¤§ Survivor åŒºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³æ³¨å¯¹è±¡ç»“æ„&lt;/strong&gt;ï¼šæ£€æŸ¥ä»£ç ï¼Œé¿å…åˆ›å»ºè¿‡å¤šâ€œæœç”Ÿå¤•æ­»â€çš„å¤§å¯¹è±¡ï¼Œå‡å°‘å•æ¬¡ Minor GC çš„å­˜æ´»å¯¹è±¡æ€»é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£ JVM çš„å†…å­˜ç®¡ç†æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h2 id="t-"&gt;T &amp;hellip;
&lt;/h2&gt;&lt;p&gt;åœ¨Javaæ³›å‹ä¸­ï¼Œ&lt;code&gt;T...&lt;/code&gt;ï¼ˆå¯å˜å‚æ•°ï¼‰å’Œ &lt;code&gt;T[]&lt;/code&gt;ï¼ˆæ³›å‹æ•°ç»„ï¼‰è™½ç„¶éƒ½è¡¨ç¤ºä¸€ä¸ª&lt;code&gt;T&lt;/code&gt;ç±»å‹çš„æ•°ç»„ï¼Œä½†åœ¨è¯­æ³•ã€ä½¿ç”¨åœºæ™¯å’Œåº•å±‚å¤„ç†ä¸Šå­˜åœ¨å…³é”®åŒºåˆ«ã€‚ä¸ºäº†è®©ä½ èƒ½å¿«é€ŸæŠŠæ¡æ ¸å¿ƒå·®å¼‚ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒä»¬çš„ä¸»è¦ç‰¹ç‚¹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§å¯¹æ¯”&lt;/th&gt;
&lt;th&gt;&lt;code&gt;T...&lt;/code&gt;(å¯å˜å‚æ•°)&lt;/th&gt;
&lt;th&gt;&lt;code&gt;T[]&lt;/code&gt;(æ³›å‹æ•°ç»„)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯­æ³•æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–¹æ³•å‚æ•°åˆ—è¡¨çš„&lt;strong&gt;è¯­æ³•ç³–&lt;/strong&gt;ï¼Œç®€åŒ–è°ƒç”¨&lt;/td&gt;
&lt;td&gt;æ˜ç¡®çš„&lt;strong&gt;æ•°ç»„ç±»å‹&lt;/strong&gt;å£°æ˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒç”¨æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯æ¥å—&lt;strong&gt;ç¦»æ•£å‚æ•°&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;method(a, b, c)&lt;/code&gt;ï¼‰æˆ–&lt;strong&gt;æ•°ç»„&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;method(arr)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å¿…é¡»ä¼ å…¥ä¸€ä¸ª&lt;strong&gt;å®Œæ•´çš„æ•°ç»„å¯¹è±¡&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;method(arr)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿…é¡»æ˜¯æ–¹æ³•çš„&lt;strong&gt;æœ€åä¸€ä¸ªå‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯å‡ºç°åœ¨å‚æ•°åˆ—è¡¨çš„&lt;strong&gt;ä»»æ„ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°ç»„åˆ›å»º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”±ç¼–è¯‘å™¨&lt;strong&gt;éšå¼ç”Ÿæˆæ•°ç»„&lt;/strong&gt;æ¥åŒ…è£…ç¦»æ•£å‚æ•°&lt;/td&gt;
&lt;td&gt;éœ€è¦ç¨‹åºå‘˜&lt;strong&gt;æ˜¾å¼åˆ›å»ºå¹¶ä¼ å…¥&lt;/strong&gt;æ•°ç»„å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜&lt;/strong&gt;ï¼Œè°ƒç”¨æ–¹å¼éå¸¸çµæ´»&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç›¸å¯¹å›ºå®š&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«è¯¦è§£-1"&gt;ğŸ’¡ æ ¸å¿ƒåŒºåˆ«è¯¦è§£
&lt;/h3&gt;&lt;h4 id="è¯­æ³•ä¸è°ƒç”¨"&gt;è¯­æ³•ä¸è°ƒç”¨
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;T...&lt;/code&gt;æ˜¯Javaæä¾›çš„å¯å˜å‚æ•°è¯­æ³•ç³–ï¼ˆVarargsï¼‰ã€‚å®ƒå…è®¸ä½ åœ¨è°ƒç”¨æ–¹æ³•æ—¶ä¼ å…¥ä»»æ„æ•°é‡ï¼ˆåŒ…æ‹¬0ä¸ªï¼‰çš„&lt;code&gt;T&lt;/code&gt;ç±»å‹å‚æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†è¿™äº›å‚æ•°å°è£…åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚è¿™ä½¿å¾—è°ƒç”¨ä»£ç éå¸¸ç®€æ´ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public &amp;lt;T&amp;gt; void processWithVarargs(T... items) {
// ç¼–è¯‘å™¨å°†itemsä½œä¸ºT[]å¤„ç†
for (T item : items) {
System.out.println(item);
}
}
// è°ƒç”¨æ–¹å¼çµæ´»ï¼šå¯ä»¥ä¼ å…¥å¤šä¸ªç¦»æ•£å‚æ•°
processWithVarargs(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;);
// ä¹Ÿå¯ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªæ•°ç»„
String[] arr = {&amp;#34;X&amp;#34;, &amp;#34;Y&amp;#34;, &amp;#34;Z&amp;#34;};
processWithVarargs(arr);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è€Œ &lt;code&gt;T[]&lt;/code&gt;å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ³›å‹æ•°ç»„å‚æ•°ï¼Œè¦æ±‚ä½ åœ¨è°ƒç”¨æ—¶å¿…é¡»å…ˆæ„é€ å¥½ä¸€ä¸ªæ•°ç»„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public &amp;lt;T&amp;gt; void processWithArray(T[] items) {
for (T item : items) {
System.out.println(item);
}
}
// è°ƒç”¨æ—¶å¿…é¡»ä¼ å…¥ä¸€ä¸ªæ•°ç»„å¯¹è±¡
String[] arr = {&amp;#34;X&amp;#34;, &amp;#34;Y&amp;#34;, &amp;#34;Z&amp;#34;};
processWithArray(arr);
// processWithArray(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;); // è¿™æ ·å†™ä¼šç¼–è¯‘é”™è¯¯
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ–¹æ³•ç­¾åä¸é‡è½½"&gt;æ–¹æ³•ç­¾åä¸é‡è½½
&lt;/h4&gt;&lt;p&gt;ç”±äº &lt;code&gt;T...&lt;/code&gt;åœ¨ç¼–è¯‘åæœ¬è´¨ä¸Šä¹Ÿæ˜¯ &lt;code&gt;T[]&lt;/code&gt;ï¼Œæ‰€ä»¥åœ¨æ–¹æ³•é‡è½½æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œå®ƒä»¬å¯èƒ½é€ æˆç­¾åå†²çªï¼Œå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚&lt;/p&gt;
&lt;h4 id="æ•°ç»„çš„åˆ›å»ºä¸é™åˆ¶"&gt;æ•°ç»„çš„åˆ›å»ºä¸é™åˆ¶
&lt;/h4&gt;&lt;p&gt;åœ¨Javaä¸­ï¼Œä½ ä¸èƒ½ç›´æ¥é€šè¿‡ &lt;code&gt;new T[]&lt;/code&gt;çš„æ–¹å¼æ¥å®ä¾‹åŒ–ä¸€ä¸ªæ³›å‹æ•°ç»„ï¼Œè¿™æ˜¯å› ä¸ºæ³›å‹åœ¨è¿è¡Œæ—¶ä¼šå‘ç”Ÿ&lt;strong&gt;ç±»å‹æ“¦é™¤&lt;/strong&gt;ï¼Œç¼–è¯‘å™¨æ— æ³•ç¡®å®š&lt;code&gt;T&lt;/code&gt;çš„å…·ä½“ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;T...&lt;/code&gt;å‚æ•°åœ¨é‡åˆ°ç¦»æ•£å‚æ•°æ—¶ï¼Œç”±ç¼–è¯‘å™¨è´Ÿè´£åˆ›å»ºæ•°ç»„ï¼Œå®ƒèƒ½å¤Ÿå®‰å…¨åœ°å®Œæˆè¿™ä¸ªæ“ä½œã€‚ä½†å¦‚æœä½ æƒ³åœ¨æ–¹æ³•å†…éƒ¨è‡ªå·±åˆ›å»ºä¸€ä¸ª &lt;code&gt;T[]&lt;/code&gt;ï¼Œé€šå¸¸ä¼šé‡åˆ°é—®é¢˜ã€‚ä¸€ä¸ªå¸¸è§çš„å˜é€šæ–¹æ³•æ˜¯ä½¿ç”¨ &lt;code&gt;Object&lt;/code&gt;æ•°ç»„å†è¿›è¡Œè½¬æ¢ï¼Œä½†è¿™ä¼šå¸¦æ¥** unchecked cast **è­¦å‘Šã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public &amp;lt;T&amp;gt; T[] createArray(T... elements) {
// ç¼–è¯‘å™¨å¯ä»¥å®‰å…¨åœ°åˆ›å»ºå­˜æ”¾elementsçš„æ•°ç»„
T[] array = elements; // æˆ–è€…ç›´æ¥è¿”å› elements
return array;
}
public &amp;lt;T&amp;gt; T[] createArrayManually(int size) {
// ä»¥ä¸‹å†™æ³•æ˜¯é”™è¯¯çš„ï¼Œæ— æ³•ç¼–è¯‘
// T[] arr = new T[size];
// ä¸€ç§å˜é€šæ–¹æ¡ˆï¼ˆä½†ä¼šæœ‰è­¦å‘Šï¼‰
T[] arr = (T[]) new Object[size];
return arr; // å¯èƒ½äº§ç”Ÿ ClassCastException
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å¦‚ä½•é€‰æ‹©-1"&gt;ğŸ’ å¦‚ä½•é€‰æ‹©
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;å½“ä½ å¸Œæœ›æ–¹æ³•èƒ½æ¥å—&lt;strong&gt;ä»»æ„æ•°é‡&lt;/strong&gt;çš„å‚æ•°ï¼Œè®©è°ƒç”¨æ›´åŠ æ–¹ä¾¿ç›´è§‚æ—¶ï¼Œä¼˜å…ˆé€‰æ‹© &lt;strong&gt;&lt;code&gt;T...&lt;/code&gt;&lt;/strong&gt;ã€‚å®ƒéå¸¸é€‚åˆç”¨äºå·¥å…·æ–¹æ³•ã€æ—¥å¿—è®°å½•ã€åˆå§‹åŒ–ç­‰åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;å½“ä½ çš„æ–¹æ³•æ“ä½œçš„å¯¹è±¡æœ¬èº«å°±æ˜¯ä¸€ä¸ª&lt;strong&gt;å·²çŸ¥çš„æ•°ç»„&lt;/strong&gt;ï¼Œæˆ–è€…å‚æ•°ä½ç½®æœ‰ç‰¹æ®Šè¦æ±‚æ—¶ï¼Œåº”ä½¿ç”¨ &lt;strong&gt;&lt;code&gt;T[]&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å½“ä½ éœ€è¦åœ¨æ–¹æ³•å†…éƒ¨&lt;strong&gt;åˆ›å»ºæ–°çš„æ³›å‹æ•°ç»„&lt;/strong&gt;æ—¶ï¼Œéœ€è¦ç‰¹åˆ«å°å¿ƒå¤„ç†ç±»å‹å®‰å…¨é—®é¢˜å’Œå¯èƒ½çš„è­¦å‘Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°ç†è§£ä¸¤è€…çš„åŒºåˆ«ã€‚å¦‚æœä½ æœ‰å…·ä½“çš„åº”ç”¨åœºæ™¯ï¼Œæˆ‘å¯ä»¥æä¾›æ›´æ·±å…¥çš„åˆ†æã€‚&lt;/p&gt;
&lt;h2 id="linkedhashset"&gt;LinkedHashSet
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;LinkedHashSet&lt;/code&gt;æ˜¯ Java é›†åˆæ¡†æ¶ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç±»ï¼Œå®ƒåœ¨ä¿ç•™ &lt;code&gt;HashSet&lt;/code&gt;å…ƒç´ å”¯ä¸€æ€§çš„åŸºç¡€ä¸Šï¼Œé¢å¤–ç»´æŠ¤äº†å…ƒç´ çš„æ’å…¥é¡ºåºã€‚ä¸‹é¢è¿™å¼ è¡¨æ ¼å¯ä»¥è®©ä½ å¿«é€ŸæŠ“ä½å®ƒçš„æ ¸å¿ƒç‰¹å¾ï¼Œå¹¶äº†è§£å®ƒä¸å…¶ä»–å¸¸ç”¨ &lt;code&gt;Set&lt;/code&gt;å®ç°çš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;LinkedHashSet&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;HashSet&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;TreeSet&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å“ˆå¸Œè¡¨ + &lt;strong&gt;åŒå‘é“¾è¡¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å“ˆå¸Œè¡¨&lt;/td&gt;
&lt;td&gt;çº¢é»‘æ ‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒç´ é¡ºåº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ’å…¥é¡ºåº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— ä¿è¯&lt;/td&gt;
&lt;td&gt;è‡ªç„¶æ’åºæˆ–è‡ªå®šä¹‰æ’åº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸºæœ¬æ“ä½œæ€§èƒ½ (add, remove, contains)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;O(1)&lt;/td&gt;
&lt;td&gt;O(1)&lt;/td&gt;
&lt;td&gt;O(log n)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿­ä»£æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ›´ä¼˜&lt;/strong&gt; (ä»…éå†é“¾è¡¨)&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒä½ (éœ€è·³è¿‡å“ˆå¸Œè¡¨ç©ºæ¡¶)&lt;/td&gt;
&lt;td&gt;O(n)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ (éœ€ç»´æŠ¤é“¾è¡¨)&lt;/td&gt;
&lt;td&gt;è¾ƒä½&lt;/td&gt;
&lt;td&gt;å–å†³äºæ ‘ç»“æ„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éçº¿ç¨‹å®‰å…¨&lt;/td&gt;
&lt;td&gt;éçº¿ç¨‹å®‰å…¨&lt;/td&gt;
&lt;td&gt;éçº¿ç¨‹å®‰å…¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†"&gt;ğŸ”§ æ ¸å¿ƒåŸç†
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;LinkedHashSet&lt;/code&gt;ç»§æ‰¿è‡ª &lt;code&gt;HashSet&lt;/code&gt;ï¼Œå…¶æ ¸å¿ƒé­”åŠ›åœ¨äºåº•å±‚ä½¿ç”¨äº† &lt;code&gt;LinkedHashMap&lt;/code&gt;æ¥å­˜å‚¨å…ƒç´  ã€‚ä½ å¯ä»¥è¿™æ ·ç†è§£å®ƒçš„å·¥ä½œåŸç†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œè¡¨è´Ÿè´£æ•ˆç‡&lt;/strong&gt;ï¼šå’Œ &lt;code&gt;HashSet&lt;/code&gt;ä¸€æ ·ï¼Œå®ƒé€šè¿‡å“ˆå¸Œç®—æ³•å†³å®šå…ƒç´ çš„å­˜å‚¨ä½ç½®ï¼Œè¿™ä½¿å¾— &lt;code&gt;add&lt;/code&gt;, &lt;code&gt;remove&lt;/code&gt;, &lt;code&gt;contains&lt;/code&gt;ç­‰æ“ä½œèƒ½åœ¨å¸¸æ•°æ—¶é—´å†…å®Œæˆ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒå‘é“¾è¡¨è´Ÿè´£é¡ºåº&lt;/strong&gt;ï¼šä¸ºäº†ç»´æŠ¤é¡ºåºï¼Œæ¯ä¸ªå…ƒç´ èŠ‚ç‚¹ï¼ˆåœ¨ &lt;code&gt;LinkedHashMap&lt;/code&gt;çš„ &lt;code&gt;Entry&lt;/code&gt;ä¸­ï¼‰éƒ½é¢å¤–ä¿å­˜äº†ä¸¤ä¸ªå¼•ç”¨ï¼š&lt;code&gt;before&lt;/code&gt;å’Œ &lt;code&gt;after&lt;/code&gt;ã€‚è¿™äº›å¼•ç”¨å°†æ‰€æœ‰å…ƒç´ è¿æ¥æˆä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚æ¯å½“æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ æ—¶ï¼Œé™¤äº†å°†å…¶æ”¾å…¥å“ˆå¸Œæ¡¶ï¼Œè¿˜ä¼šå°†å…¶&lt;strong&gt;é“¾æ¥åˆ°é“¾è¡¨çš„å°¾éƒ¨&lt;/strong&gt;ï¼›åˆ é™¤å…ƒç´ æ—¶ï¼Œä¹Ÿä¼šä»é“¾è¡¨ä¸­è§£é™¤é“¾æ¥ã€‚å› æ­¤ï¼Œè¿­ä»£å™¨éå†æ—¶ï¼Œåªéœ€é¡ºç€è¿™æ¡é“¾è¡¨å³å¯ï¼Œè¿™å°±ä¿è¯äº†é¡ºåºä¸æ’å…¥é¡ºåºä¸€è‡´ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¦‚ä½•ä½¿ç”¨"&gt;ğŸ› ï¸ å¦‚ä½•ä½¿ç”¨
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;LinkedHashSet&lt;/code&gt;çš„ç”¨æ³•éå¸¸ç®€å•ï¼Œä¸ &lt;code&gt;HashSet&lt;/code&gt;åŸºæœ¬ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. åˆ›å»ºå®ä¾‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©ä¸åŒçš„æ„é€ æ–¹æ³• ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// 1. é»˜è®¤æ„é€ ï¼šåˆå§‹å®¹é‡16ï¼Œè´Ÿè½½å› å­0.75
LinkedHashSet&amp;lt;String&amp;gt; set1 = new LinkedHashSet&amp;lt;&amp;gt;();
// 2. æŒ‡å®šåˆå§‹å®¹é‡ï¼ˆé¿å…é¢‘ç¹æ‰©å®¹ï¼‰
LinkedHashSet&amp;lt;String&amp;gt; set2 = new LinkedHashSet&amp;lt;&amp;gt;(20);
// 3. æŒ‡å®šåˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­ï¼ˆç”¨äºæ€§èƒ½è°ƒä¼˜ï¼‰
LinkedHashSet&amp;lt;String&amp;gt; set3 = new LinkedHashSet&amp;lt;&amp;gt;(20, 0.75f);
// 4. ä»å…¶ä»–é›†åˆåˆ›å»ºï¼Œå¹¶ä¿ç•™è¯¥é›†åˆè¿­ä»£å™¨çš„é¡ºåº
List&amp;lt;String&amp;gt; list = Arrays.asList(&amp;#34;Apple&amp;#34;, &amp;#34;Banana&amp;#34;, &amp;#34;Apple&amp;#34;);
LinkedHashSet&amp;lt;String&amp;gt; set4 = new LinkedHashSet&amp;lt;&amp;gt;(list); // ç»“æœä¸º [Apple, Banana]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;2. åŸºæœ¬æ“ä½œ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¸¸ç”¨æ–¹æ³•åŒ…æ‹¬ &lt;code&gt;add&lt;/code&gt;, &lt;code&gt;remove&lt;/code&gt;, &lt;code&gt;contains&lt;/code&gt;, &lt;code&gt;size&lt;/code&gt;, &lt;code&gt;isEmpty&lt;/code&gt;ç­‰ï¼Œä¸å¤§å¤šæ•°é›†åˆç±»æ— å¼‚ ã€‚ä¸€ä¸ªå…³é”®ç‚¹æ˜¯ï¼Œå½“å°è¯•æ·»åŠ ä¸€ä¸ªå·²å­˜åœ¨çš„å…ƒç´ æ—¶ï¼Œæ“ä½œä¼šå¤±è´¥ï¼Œä¸”&lt;strong&gt;ä¸ä¼šæ”¹å˜åŸæœ‰çš„é¡ºåº&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. éå†å…ƒç´ &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºæœ‰åºï¼Œéå†ç»“æœæ˜¯å¯ä»¥é¢„æµ‹çš„ ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;LinkedHashSet&amp;lt;String&amp;gt; set = new LinkedHashSet&amp;lt;&amp;gt;();
set.add(&amp;#34;Java&amp;#34;);
set.add(&amp;#34;Python&amp;#34;);
set.add(&amp;#34;C++&amp;#34;);
// ä½¿ç”¨å¢å¼ºforå¾ªç¯ï¼ˆæ¨èï¼‰
for (String lang : set) {
System.out.println(lang); // è¾“å‡ºé¡ºåºæ’ä¸ºï¼šJava, Python, C++
}
// ä½¿ç”¨è¿­ä»£å™¨
Iterator&amp;lt;String&amp;gt; it = set.iterator();
while (it.hasNext()) {
System.out.println(it.next());
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ’¡ å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦ä¿ç•™é¡ºåºçš„å»é‡&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€å…¸å‹çš„åœºæ™¯ã€‚ä¾‹å¦‚ï¼Œè®°å½•ç”¨æˆ·çš„æµè§ˆå†å²ï¼Œéœ€è¦å»é‡ä¸”æŒ‰æµè§ˆæ—¶é—´é¡ºåºå±•ç¤º ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ç³»ç»Ÿï¼ˆLRU CacheåŸºç¡€ï¼‰&lt;/strong&gt;ï¼šè™½ç„¶ &lt;code&gt;LinkedHashSet&lt;/code&gt;æœ¬èº«ä¸ç›´æ¥å®ç° LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç­–ç•¥ï¼Œä½†å…¶åº•å±‚å®ç° &lt;code&gt;LinkedHashMap&lt;/code&gt;å¯ä»¥é€šè¿‡é‡å†™ &lt;code&gt;removeEldestEntry&lt;/code&gt;æ–¹æ³•è½»æ¾å®ç°ä¸€ä¸ªå›ºå®šå¤§å°çš„ LRU ç¼“å­˜ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—æˆ–äº‹ä»¶å¤„ç†&lt;/strong&gt;ï¼šéœ€è¦æŒ‰æ—¶é—´é¡ºåºå¤„ç†ä¸€ç³»åˆ—æ—¥å¿—æˆ–äº‹ä»¶ï¼ŒåŒæ—¶é¿å…é‡å¤å¤„ç† ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-3"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;ï¼šè™½ç„¶åŸºæœ¬æ“ä½œæ˜¯ O(1)ï¼Œä½†ç”±äºéœ€è¦ç»´æŠ¤é“¾è¡¨ï¼Œå¸¸æ•°æ—¶é—´ä¼šæ¯” &lt;code&gt;HashSet&lt;/code&gt;ç¨å¤§ä¸€äº›ã€‚åœ¨ä¸éœ€è¦é¡ºåºçš„åœºæ™¯ä¸‹ï¼Œ&lt;code&gt;HashSet&lt;/code&gt;æ˜¯æ›´é«˜æ•ˆçš„é€‰æ‹© ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éçº¿ç¨‹å®‰å…¨&lt;/strong&gt;ï¼š&lt;code&gt;LinkedHashSet&lt;/code&gt;ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœéœ€è¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œåº”ä½¿ç”¨ &lt;code&gt;Collections.synchronizedSet&lt;/code&gt;æ–¹æ³•è¿›è¡ŒåŒ…è£… ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Set&amp;lt;String&amp;gt; syncSet = Collections.synchronizedSet(new LinkedHashSet&amp;lt;&amp;gt;());
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Fail-Fast è¿­ä»£å™¨&lt;/strong&gt;ï¼šå®ƒçš„è¿­ä»£å™¨æ˜¯â€œå¿«é€Ÿå¤±è´¥â€çš„ã€‚å¦‚æœåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œé›†åˆè¢«é™¤äº†è¿­ä»£å™¨è‡ªèº« &lt;code&gt;remove&lt;/code&gt;æ–¹æ³•ä¹‹å¤–çš„ä»»ä½•æ–¹å¼ä¿®æ”¹ï¼Œä¼šç«‹å³æŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;å¼‚å¸¸ã€‚è¿™ä¸»è¦ç”¨äºæ£€æµ‹å¹¶å‘ä¿®æ”¹çš„ bug ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ å…¨é¢ç†è§£ &lt;code&gt;LinkedHashSet&lt;/code&gt;ã€‚å¦‚æœä½ å¯¹å®ƒåœ¨ç‰¹å®šåœºæ™¯ä¸‹çš„åº”ç”¨æœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="spi-æœºåˆ¶"&gt;SPI æœºåˆ¶
&lt;/h2&gt;&lt;p&gt;Java çš„ SPIï¼ˆService Provider Interfaceï¼‰æœºåˆ¶æ˜¯ä¸€ç§å†…ç½®çš„æœåŠ¡å‘ç°æœºåˆ¶ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€ä¸ºæŸä¸ªæ¥å£å¯»æ‰¾å®ç°ç±»ï¼Œä»è€Œå®ç°è§£è€¦å’Œå¯æ‰©å±•çš„æ¶æ„ ã€‚è¿™ç§æœºåˆ¶çš„æ ¸å¿ƒæ€æƒ³æ˜¯&lt;strong&gt;å°†æ¥å£çš„å®šä¹‰ä¸å…·ä½“å®ç°åˆ†ç¦»&lt;/strong&gt;ï¼Œå°†è£…é…çš„æ§åˆ¶æƒäº¤ç”±ç¨‹åºå¤–éƒ¨ï¼Œç‰¹åˆ«é€‚ç”¨äºæ¨¡å—åŒ–è®¾è®¡å’Œæ¡†æ¶æ‰©å±• ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªå¿«é€Ÿå¯¹æ¯” SPI æ ¸å¿ƒè¦ç´ çš„è¡¨æ ¼ï¼Œå¸®åŠ©ä½ ç›´è§‚ç†è§£å…¶ç»„æˆï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ ¸å¿ƒè§’è‰²&lt;/th&gt;
&lt;th&gt;èŒè´£è¯´æ˜&lt;/th&gt;
&lt;th&gt;ä¸¾ä¾‹è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœåŠ¡æ¥å£ (Service Interface)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®šä¹‰æ ‡å‡†çš„æœåŠ¡è§„èŒƒï¼Œç”±æ¡†æ¶æˆ–æ ¸å¿ƒåº“åˆ¶å®šã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;java.sql.Driver&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœåŠ¡æä¾›è€… (Service Provider)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®ç°æœåŠ¡æ¥å£çš„å…·ä½“ç±»ï¼Œé€šå¸¸ç”±ç¬¬ä¸‰æ–¹æä¾›ã€‚&lt;/td&gt;
&lt;td&gt;MySQL çš„ &lt;code&gt;com.mysql.cj.jdbc.Driver&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é…ç½®æ–‡ä»¶ (Configuration File)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ &lt;code&gt;META-INF/services/&lt;/code&gt;ç›®å½•ä¸‹ï¼Œä»¥æ¥å£å…¨é™å®šåå‘½åçš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºå®ç°ç±»çš„å…¨é™å®šåã€‚&lt;/td&gt;
&lt;td&gt;æ–‡ä»¶ &lt;code&gt;java.sql.Driver&lt;/code&gt;ä¸­åŒ…å« &lt;code&gt;com.mysql.cj.jdbc.Driver&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœåŠ¡åŠ è½½å™¨ (ServiceLoader)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JDK æ ¸å¿ƒç±»ï¼Œç”¨äºåŠ¨æ€åŠ è½½ã€å®ä¾‹åŒ–é…ç½®æ–‡ä»¶ä¸­å£°æ˜çš„æ‰€æœ‰å®ç°ç±»ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ServiceLoader&amp;lt;Driver&amp;gt; loader = ServiceLoader.load(Driver.class);&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å·¥ä½œæœºåˆ¶ä¸å®ç°æ­¥éª¤"&gt;ğŸ”§ å·¥ä½œæœºåˆ¶ä¸å®ç°æ­¥éª¤
&lt;/h3&gt;&lt;p&gt;è¦ä½¿ç”¨ Java åŸç”Ÿçš„ SPI æœºåˆ¶ï¼Œéœ€è¦éµå¾ªä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰æœåŠ¡æ¥å£&lt;/strong&gt;ï¼šé¦–å…ˆéœ€è¦åˆ¶å®šä¸€ä¸ªæ ‡å‡†çš„æ¥å£ã€‚ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªæ”¯ä»˜æ¥å£ &lt;code&gt;Payment&lt;/code&gt;ï¼Œå…¶ä¸­åŒ…å« &lt;code&gt;pay&lt;/code&gt;æ–¹æ³• ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æä¾›å…·ä½“å®ç°&lt;/strong&gt;ï¼šç”±ä¸åŒçš„æœåŠ¡æä¾›è€…å®ç°è¯¥æ¥å£ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åˆ†åˆ«åˆ›å»º &lt;code&gt;AlipayPayment&lt;/code&gt;å’Œ &lt;code&gt;WeChatPayPayment&lt;/code&gt;ç±»æ¥å®ç° &lt;code&gt;Payment&lt;/code&gt;æ¥å£ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ›å»ºé…ç½®æ–‡ä»¶&lt;/strong&gt;ï¼šè¿™æ˜¯å®ç° SPI çš„å…³é”®ä¸€æ­¥ã€‚åœ¨&lt;strong&gt;å®ç°æ–¹çš„ JAR åŒ…&lt;/strong&gt;ä¸­ï¼Œå¿…é¡»åœ¨ &lt;code&gt;META-INF/services/&lt;/code&gt;ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œ&lt;strong&gt;æ–‡ä»¶åå¿…é¡»æ˜¯æ¥å£çš„å…¨é™å®šå&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;com.example.Payment&lt;/code&gt;ï¼‰ï¼Œæ–‡ä»¶å†…å®¹åˆ™æ˜¯å®ç°ç±»çš„å…¨é™å®šåï¼Œæ¯è¡Œä¸€ä¸ªã€‚å¦‚æœæœ‰å¤šä¸ªå®ç°ï¼Œåˆ™åˆ†è¡Œå¡«å†™ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ è½½ä¸æœåŠ¡å‘ç°&lt;/strong&gt;ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œé€šè¿‡ &lt;code&gt;java.util.ServiceLoader&lt;/code&gt;ç±»æ¥åŠ è½½è¿™äº›æœåŠ¡å®ç°ã€‚å®ƒä¼šæ‰«æ classpath ä¸‹æ‰€æœ‰ JAR åŒ…ä¸­çš„ &lt;code&gt;META-INF/services&lt;/code&gt;ç›®å½•ï¼Œæ‰¾åˆ°å¯¹åº”çš„é…ç½®æ–‡ä»¶å¹¶åŠ è½½å…¶ä¸­å£°æ˜çš„å®ç°ç±» ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†serviceloader-ä¸ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨"&gt;ğŸ’¡ æ ¸å¿ƒåŸç†ï¼šServiceLoader ä¸ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ServiceLoader&lt;/code&gt;æ˜¯ SPI æœºåˆ¶çš„æ ¸å¿ƒç±»ï¼Œå…¶å·¥ä½œæµç¨‹ä½“ç°äº†&lt;strong&gt;æ‡’åŠ è½½&lt;/strong&gt;çš„ç‰¹ç‚¹ ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“è°ƒç”¨ &lt;code&gt;ServiceLoader.load(service)&lt;/code&gt;æ—¶ï¼Œå¹¶ä¸ä¼šç«‹å³å®ä¾‹åŒ–æ‰€æœ‰å®ç°ç±»ï¼Œè€Œåªæ˜¯åˆå§‹åŒ–ä¸€ä¸ªæŸ¥æ‰¾è¿­ä»£å™¨ã€‚&lt;/li&gt;
&lt;li&gt;åªæœ‰å½“ä½¿ç”¨ &lt;code&gt;iterator()&lt;/code&gt;è¿›è¡Œéå†æ—¶ï¼Œæ‰ä¼šçœŸæ­£è§£æé…ç½®æ–‡ä»¶ï¼Œå¹¶é€šè¿‡åå°„æœºåˆ¶å®ä¾‹åŒ–å®ç°ç±»ã€‚&lt;/li&gt;
&lt;li&gt;å®ä¾‹åŒ–åçš„å¯¹è±¡ä¼šè¢«ç¼“å­˜èµ·æ¥ï¼Œä¸‹æ¬¡éå†æ—¶ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å– ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸€ä¸ªå…³é”®ç‚¹ï¼š&lt;code&gt;ServiceLoader&lt;/code&gt;æœ¬èº«ç”± &lt;strong&gt;Bootstrap ClassLoader&lt;/strong&gt;ï¼ˆå¯åŠ¨ç±»åŠ è½½å™¨ï¼‰åŠ è½½ï¼Œè€Œç”¨æˆ·æä¾›çš„å®ç°ç±»é€šå¸¸ä½äº classpath ä¸‹ï¼Œç”± &lt;strong&gt;AppClassLoader&lt;/strong&gt;ï¼ˆåº”ç”¨ç±»åŠ è½½å™¨ï¼‰åŠ è½½ã€‚ä¸ºäº†æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œä½¿å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½çš„ç±»èƒ½å¤Ÿâ€œçœ‹è§â€åº”ç”¨ç±»åŠ è½½å™¨åŠ è½½çš„ç±»ï¼ŒJDK ä½¿ç”¨äº†&lt;strong&gt;çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ (Thread Context ClassLoader)&lt;/strong&gt;ã€‚&lt;code&gt;ServiceLoader&lt;/code&gt;åœ¨ &lt;code&gt;load()&lt;/code&gt;æ–¹æ³•ä¸­ä¼šè·å–å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆé»˜è®¤ä¸º &lt;code&gt;AppClassLoader&lt;/code&gt;ï¼‰æ¥åŠ è½½å®ç°ç±»ï¼Œä»è€Œè§£å†³äº†è¿™ä¸ªç±»åŠ è½½å™¨éš”ç¦»é—®é¢˜ ã€‚&lt;/p&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯-1"&gt;ğŸŒ å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;SPI æœºåˆ¶åœ¨ Java ç”Ÿæ€ä¸­è¢«å¹¿æ³›åº”ç”¨ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ç»å…¸ä¾‹å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;JDBC æ•°æ®åº“é©±åŠ¨&lt;/strong&gt;ï¼šè¿™æ˜¯æœ€å…¸å‹çš„ä¾‹å­ã€‚åœ¨ JDBC 4.0 ä¹‹åï¼Œæˆ‘ä»¬ä¸å†éœ€è¦æ‰‹åŠ¨ä½¿ç”¨ &lt;code&gt;Class.forName(&amp;quot;com.mysql.jdbc.Driver&amp;quot;)&lt;/code&gt;æ¥æ³¨å†Œé©±åŠ¨ã€‚å› ä¸º &lt;code&gt;DriverManager&lt;/code&gt;åœ¨åˆå§‹åŒ–æ—¶ä¼šé€šè¿‡ SPI æœºåˆ¶è‡ªåŠ¨æ‰«æå¹¶åŠ è½½æ‰€æœ‰åœ¨ &lt;code&gt;META-INF/services/java.sql.Driver&lt;/code&gt;æ–‡ä»¶ä¸­æ³¨å†Œçš„æ•°æ®åº“é©±åŠ¨å®ç° ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—é—¨é¢æ¡†æ¶&lt;/strong&gt;ï¼šå¦‚ SLF4Jï¼Œå®ƒä½œä¸ºæ—¥å¿—é—¨é¢ï¼Œé€šè¿‡ SPI æœºåˆ¶åœ¨è¿è¡Œæ—¶ç»‘å®šå…·ä½“çš„æ—¥å¿—å®ç°ï¼ˆå¦‚ Logbackã€Log4j2ï¼‰ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºå¯ä»¥çµæ´»åˆ‡æ¢åº•å±‚æ—¥å¿—åº“ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Spring Framework&lt;/strong&gt;ï¼šSpring åœ¨å…¶å¾ˆå¤šæ¨¡å—ä¸­ä½¿ç”¨äº† SPI æ€æƒ³ã€‚ç‰¹åˆ«æ˜¯ Spring Boot çš„è‡ªåŠ¨é…ç½®ï¼Œå®ƒå€Ÿé‰´å¹¶å¢å¼ºäº† SPIï¼Œä½¿ç”¨ &lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶æ¥å£°æ˜å¤§é‡è‡ªåŠ¨é…ç½®ç±»ï¼Œä»è€Œå®ç°äº†â€œçº¦å®šä¼˜äºé…ç½®â€çš„ç†å¿µ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dubbo æ¡†æ¶&lt;/strong&gt;ï¼šDubbo å¤§é‡ä½¿ç”¨ SPI ä½œä¸ºå…¶æ‰©å±•ç‚¹æœºåˆ¶ï¼Œå¹¶å¯¹ JDK åŸç”Ÿçš„ SPI è¿›è¡Œäº†å¢å¼ºï¼Œæ”¯æŒæŒ‰éœ€åŠ è½½ã€è‡ªé€‚åº”æ‰©å±•ç­‰æ›´é«˜çº§çš„åŠŸèƒ½ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ä¼˜ç¼ºç‚¹åˆ†æ"&gt;âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ
&lt;/h3&gt;&lt;p&gt;ä»»ä½•æŠ€æœ¯éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯ï¼Œäº†è§£ SPI çš„ä¼˜ç¼ºç‚¹æœ‰åŠ©äºä½ åšå‡ºæ­£ç¡®çš„è®¾è®¡å†³ç­–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦&lt;/strong&gt;ï¼šå®ç°äº†æ¥å£å’Œå…·ä½“å®ç°çš„å®Œå…¨åˆ†ç¦»ï¼Œé™ä½äº†æ¨¡å—é—´çš„è€¦åˆåº¦ï¼Œç¬¦åˆé¢å‘æ¥å£ç¼–ç¨‹çš„åŸåˆ™ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯æ‰©å±•æ€§&lt;/strong&gt;ï¼šæ·»åŠ æ–°çš„å®ç°æ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç ï¼Œåªéœ€å¼•å…¥æ–°çš„ JAR åŒ…å³å¯ï¼Œéå¸¸æ–¹ä¾¿è¿›è¡ŒåŠŸèƒ½æ‰©å±•å’Œæ’ä»¶åŒ–å¼€å‘ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¨é‡åŠ è½½&lt;/strong&gt;ï¼š&lt;code&gt;ServiceLoader&lt;/code&gt;ä¼šå®ä¾‹åŒ–é…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰çš„å®ç°ç±»ï¼Œå³ä½¿ä½ åªéœ€è¦å…¶ä¸­ä¸€ä¸ªï¼Œè¿™å¯èƒ½é€ æˆèµ„æºæµªè´¹ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆç‡ä¸é«˜&lt;/strong&gt;ï¼šè·å–æŸä¸ªå…·ä½“å®ç°çš„æ–¹å¼ä¸å¤Ÿçµæ´»ï¼Œåªèƒ½é€šè¿‡è¿­ä»£å™¨éå†ï¼Œæ— æ³•æ ¹æ®å‚æ•°æŒ‰éœ€è·å– ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨é—®é¢˜&lt;/strong&gt;ï¼š&lt;code&gt;ServiceLoader&lt;/code&gt;ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦è‡ªè¡Œå¤„ç†åŒæ­¥é—®é¢˜ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¥å£®æ€§ä¸è¶³&lt;/strong&gt;ï¼šå¦‚æœæŸä¸ªå®ç°ç±»åŠ è½½æˆ–å®ä¾‹åŒ–å¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºç¼ºå°‘ä¾èµ–ï¼‰ï¼Œä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸ä¼šä¼˜é›…åœ°è·³è¿‡ï¼Œå¯èƒ½å¯¼è‡´æ•´ä¸ªæœåŠ¡åŠ è½½ä¸­æ–­ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™ä»½è¯¦ç»†çš„ä»‹ç»èƒ½å¸®åŠ©ä½ å…¨é¢ç†è§£ Java çš„ SPI æœºåˆ¶ã€‚å¦‚æœä½ å¯¹æŸä¸ªå…·ä½“åº”ç”¨åœºæ™¯æˆ–å®ç°ç»†èŠ‚æœ‰è¿›ä¸€æ­¥çš„ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="åŒäº²å§”æ´¾"&gt;åŒäº²å§”æ´¾
&lt;/h2&gt;&lt;p&gt;SPIï¼ˆService Provider Interfaceï¼‰æœºåˆ¶æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œæ˜¯ä¸ºäº†è§£å†³Javaç±»åŠ è½½ä½“ç³»ä¸­ä¸€ä¸ªç‰¹å®šçš„å›°å¢ƒï¼š&lt;strong&gt;å½“é«˜å±‚æ ¸å¿ƒåº“éœ€è¦è°ƒç”¨ä½å±‚ç”¨æˆ·å®ç°çš„ä»£ç æ—¶ï¼Œä¸¥æ ¼çš„åŒäº²å§”æ´¾æ¨¡å‹ä¼šå½¢æˆåŠ è½½å£å’&lt;/strong&gt;ã€‚è¿™æœ¬è´¨ä¸Šæ˜¯ä¸€æ¬¡é¢å‘ç°å®çš„çµæ´»å˜é€šã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡æ ¸å¿ƒï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªè¡¨æ ¼å¯¹æ¯”è¿™ä¸¤ç§æœºåˆ¶çš„åŠ è½½é€»è¾‘ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æœºåˆ¶&lt;/th&gt;
&lt;th&gt;åŠ è½½å‘èµ·è€…&lt;/th&gt;
&lt;th&gt;ç±»åŠ è½½å™¨æµè½¬æ–¹å‘&lt;/th&gt;
&lt;th&gt;å…¸å‹åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ‡å‡†åŒäº²å§”æ´¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­ç±»åŠ è½½å™¨ï¼ˆå¦‚åº”ç”¨ç±»åŠ è½½å™¨ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è‡ªä¸‹è€Œä¸Š&lt;/strong&gt;ï¼Œå†è‡ªä¸Šè€Œä¸‹ï¼šå­ â†’ çˆ¶ â†’ &amp;hellip; â†’ å¯åŠ¨åŠ è½½å™¨ â†’ &amp;hellip; â†’ å­&lt;/td&gt;
&lt;td&gt;åŠ è½½æ™®é€šåº”ç”¨ç¨‹åºç±»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;SPIæœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çˆ¶ç±»åŠ è½½å™¨ï¼ˆå¦‚å¯åŠ¨ç±»åŠ è½½å™¨ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è‡ªä¸Šè€Œä¸‹&lt;/strong&gt;ï¼šçˆ¶åŠ è½½å™¨ç›´æ¥ä½¿ç”¨å­åŠ è½½å™¨ï¼ˆçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼‰åŠ è½½&lt;/td&gt;
&lt;td&gt;åŠ è½½JDBCé©±åŠ¨ç­‰SPIå®ç°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†æ‹†è§£è¿™èƒŒåçš„â€œä¸ºä»€ä¹ˆâ€ã€‚&lt;/p&gt;
&lt;h3 id="-åŒäº²å§”æ´¾çš„å±€é™ä¸spiçš„éœ€æ±‚"&gt;ğŸ” åŒäº²å§”æ´¾çš„å±€é™ä¸SPIçš„éœ€æ±‚
&lt;/h3&gt;&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬æ¥ç†è§£é—®é¢˜çš„æ ¹æºã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŒäº²å§”æ´¾æ¨¡å‹çš„æ ¸å¿ƒåŸåˆ™ä¸ç¼ºé™·&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åŒäº²å§”æ´¾æ¨¡å‹è¦æ±‚ï¼Œå½“ä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼Œå®ƒé¦–å…ˆä¼šå°†è¿™ä¸ªè¯·æ±‚&lt;strong&gt;å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨&lt;/strong&gt;å»å®Œæˆã€‚åªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆæ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±åŠ è½½ã€‚è¿™ä¿è¯äº†åƒ &lt;code&gt;java.lang.*&lt;/code&gt;è¿™æ ·çš„æ ¸å¿ƒç±»åº“åªä¼šè¢«å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ï¼Œä»è€Œé˜²æ­¢æ ¸å¿ƒAPIè¢«ç¯¡æ”¹ï¼Œç¡®ä¿äº†å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä½†å…¶æ ¸å¿ƒç¼ºé™·æ˜¯&lt;strong&gt;åŠ è½½è·¯å¾„çš„å•å‘æ€§&lt;/strong&gt;ï¼šçˆ¶åŠ è½½å™¨åŠ è½½çš„ç±»æ— æ³•ç›´æ¥è®¿é—®æˆ–ä½¿ç”¨å­åŠ è½½å™¨åŠ è½½çš„ç±»ã€‚å› ä¸ºæ ¹æ®ç±»åŠ è½½å™¨çš„&lt;strong&gt;å¯è§æ€§åŸåˆ™&lt;/strong&gt;ï¼Œçˆ¶åŠ è½½å™¨çœ‹ä¸åˆ°å­åŠ è½½å™¨åŠ è½½çš„ç±»ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SPIæœºåˆ¶çš„å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»¥æœ€ç»å…¸çš„JDBCä¸ºä¾‹ï¼Œå…¶æ ¸å¿ƒæ¥å£ï¼ˆå¦‚ &lt;code&gt;java.sql.Driver&lt;/code&gt;ï¼‰å®šä¹‰åœ¨Javaæ ‡å‡†åº“ &lt;code&gt;rt.jar&lt;/code&gt;ä¸­ï¼Œç”±&lt;strong&gt;å¯åŠ¨ç±»åŠ è½½å™¨&lt;/strong&gt;åŠ è½½ã€‚è€Œå„æ•°æ®åº“å‚å•†çš„å®ç°ï¼ˆå¦‚MySQLçš„ &lt;code&gt;com.mysql.cj.jdbc.Driver&lt;/code&gt;ï¼‰åˆ™ä½äºåº”ç”¨ç¨‹åºçš„classpathä¸‹ï¼Œåº”ç”±&lt;strong&gt;åº”ç”¨ç±»åŠ è½½å™¨&lt;/strong&gt;åŠ è½½ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜æ¥äº†ï¼šåœ¨ &lt;code&gt;DriverManager&lt;/code&gt;ï¼ˆç”±å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ï¼‰åˆå§‹åŒ–æ—¶ï¼Œéœ€è¦å»åŠ è½½å¹¶å®ä¾‹åŒ–è¿™äº›ç¬¬ä¸‰æ–¹é©±åŠ¨å®ç°ã€‚æŒ‰ç…§ä¸¥æ ¼çš„åŒäº²å§”æ´¾ï¼Œå¯åŠ¨ç±»åŠ è½½å™¨ä¸å¯èƒ½â€œçœ‹è§â€æˆ–åŠ è½½åˆ°ä½äºclasspathä¸‹çš„å®ç°ç±»ï¼Œè¿™å°±å¯¼è‡´äº†&lt;strong&gt;æ¥å£æ‰¾ä¸åˆ°å®ç°çš„å›°å¢ƒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-spiçš„è§£å†³æ–¹æ¡ˆçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨"&gt;ğŸ’¡ SPIçš„è§£å†³æ–¹æ¡ˆï¼šçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†è§£å†³ä¸Šè¿°çŸ›ç›¾ï¼ŒSPIæœºåˆ¶å¼•å…¥äº†&lt;strong&gt;çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆThread Context ClassLoaderï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªå…³è”çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ã€‚å¦‚æœæ²¡æœ‰æ˜¾å¼è®¾ç½®ï¼Œå®ƒä¼šä»çˆ¶çº¿ç¨‹ç»§æ‰¿ï¼Œé€šå¸¸åœ¨åº”ç”¨ç¨‹åºä¸­é»˜è®¤å°±æ˜¯&lt;strong&gt;åº”ç”¨ç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SPIå¦‚ä½•åˆ©ç”¨å®ƒï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å…³é”®ä»£ç åœ¨ &lt;code&gt;java.util.ServiceLoader.load(Class)&lt;/code&gt;æ–¹æ³•ä¸­ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public static &amp;lt;S&amp;gt; ServiceLoader&amp;lt;S&amp;gt; load(Class&amp;lt;S&amp;gt; service) {
// è·å–å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Œé€šå¸¸æ˜¯AppClassLoader
ClassLoader cl = Thread.currentThread().getContextClassLoader();
return ServiceLoader.load(service, cl);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å½“å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½çš„ &lt;code&gt;DriverManager&lt;/code&gt;ä½¿ç”¨ &lt;code&gt;ServiceLoader&lt;/code&gt;æ¥åŠ è½½é©±åŠ¨æ—¶ï¼Œ&lt;code&gt;ServiceLoader&lt;/code&gt;å¹¶æ²¡æœ‰å°è¯•è®©å¯åŠ¨ç±»åŠ è½½å™¨å»åŠ è½½é©±åŠ¨å®ç°ç±»ï¼ˆè¿™æ³¨å®šä¼šå¤±è´¥ï¼‰ï¼Œè€Œæ˜¯&lt;strong&gt;å·§å¦™åœ°åˆ‡æ¢äº†ç±»åŠ è½½å™¨&lt;/strong&gt;ã€‚å®ƒè·å–å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆå³åº”ç”¨ç±»åŠ è½½å™¨ï¼‰ï¼Œç„¶åç”¨è¿™ä¸ªâ€œå­â€åŠ è½½å™¨å»åŠ è½½ &lt;code&gt;META-INF/services&lt;/code&gt;é…ç½®æ–‡ä»¶ä¸­å£°æ˜çš„å®ç°ç±»ã€‚è¿™æ ·å°±æˆåŠŸåœ°ç»•è¿‡äº†åŒäº²å§”æ´¾çš„å±‚çº§é™åˆ¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¦‚ä½•ç†è§£è¿™ç§ç ´å"&gt;âš–ï¸ å¦‚ä½•ç†è§£è¿™ç§â€œç ´åâ€
&lt;/h3&gt;&lt;p&gt;è¿™ç§è®¾è®¡å¸¸è¢«æè¿°ä¸ºâ€œæ‰“ç ´â€æˆ–â€œç ´åâ€äº†åŒäº²å§”æ´¾æ¨¡å‹ï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯ &lt;strong&gt;â€œç»•è¿‡â€æˆ–â€œå˜é€šâ€&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ƒæ‰“ç ´äº†ä¸¥æ ¼çš„å±‚çº§å§”æ‰˜é¡ºåº&lt;/strong&gt;ï¼šå®ƒå®ç°äº†&lt;strong&gt;çˆ¶åŠ è½½å™¨ä¸»åŠ¨å§”æ‰˜å­åŠ è½½å™¨å»åŠ è½½ç±»&lt;/strong&gt;çš„é€»è¾‘ï¼Œè¿™ä¸è‡ªä¸‹è€Œä¸Šçš„æ ‡å‡†åŒäº²å§”æ´¾æ–¹å‘ç›¸åã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ƒæ˜¯å¯¹æ¨¡å‹çš„å¿…è¦è¡¥å……&lt;/strong&gt;ï¼šè¿™ç§â€œç ´åâ€å¹¶éå¦å®šåŒäº²å§”æ´¾çš„ä»·å€¼ï¼Œè€Œæ˜¯ä¸ºäº†è§£å†³å…¶åœ¨ç‰¹å®šåœºæ™¯ï¼ˆåŸºç¡€åº“éœ€è¦å›è°ƒç”¨æˆ·ä»£ç ï¼‰ä¸‹çš„ä¸é€‚ç”¨æ€§ï¼Œæ˜¯ä¸€ç§åŠ¡å®çš„ä¼˜åŒ–ã€‚Javaå›¢é˜Ÿé€šè¿‡å¼•å…¥çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨è¿™ä¸€çµæ´»çš„è®¾è®¡ï¼Œåœ¨ä¿æŒç»å¤§éƒ¨åˆ†åœºæ™¯ä¸‹åŒäº²å§”æ´¾ä¼˜åŠ¿çš„åŒæ—¶ï¼Œä¸ºæ‰©å±•æ€§å¼€è¾Ÿäº†é“è·¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼ŒSPIæœºåˆ¶æ‰“ç ´åŒäº²å§”æ´¾ï¼Œæ˜¯å› ä¸º&lt;strong&gt;ä¸æ‰“ç ´å°±æ— æ³•å·¥ä½œ&lt;/strong&gt;ã€‚åŒäº²å§”æ´¾æ¨¡å‹å›ºæœ‰çš„â€œçˆ¶çº§çœ‹ä¸åˆ°å­çº§â€çš„å¯è§æ€§åŸåˆ™ï¼Œä¸SPIâ€œé«˜å±‚æ¥å£éœ€è°ƒç”¨ä½å±‚å®ç°â€çš„å¤©ç„¶éœ€æ±‚äº§ç”Ÿäº†ä¸å¯è°ƒå’Œçš„çŸ›ç›¾ã€‚é€šè¿‡å¼•å…¥çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ŒSPIæœºåˆ¶å®ç°äº†ä¸€æ¬¡å·§å¦™çš„â€œå‘ä¸‹å§”æ´¾â€ï¼Œç¡®ä¿äº†Javaç”Ÿæ€ä¸­é‡è¦æ‰©å±•æœºåˆ¶çš„é¡ºåˆ©è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ é€å½»ç†è§£è¿™ä¸ªé—®é¢˜ï¼å¦‚æœä½ å¯¹ç±»åŠ è½½å™¨çš„å…¶ä»–ç»†èŠ‚æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="ä¾‹å­"&gt;ä¾‹å­
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Java SPI å¤šå®ç°å®é™…ä¾‹å­ï¼Œæ¼”ç¤ºå¦‚ä½•å®šä¹‰æ¥å£ã€æä¾›å¤šä¸ªå®ç°ç±»ï¼Œå¹¶é€šè¿‡é…ç½®æ–‡ä»¶æ³¨å†Œå®ƒä»¬ã€‚&lt;/p&gt;
&lt;h3 id="1-å®šä¹‰æœåŠ¡æ¥å£"&gt;1. å®šä¹‰æœåŠ¡æ¥å£
&lt;/h3&gt;&lt;p&gt;é¦–å…ˆå®šä¹‰ä¸€ä¸ªç®€å•çš„æ”¯ä»˜æ¥å£ &lt;code&gt;PaymentService&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// PaymentService.java - æœåŠ¡æ¥å£
public interface PaymentService {
void processPayment(double amount);
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="2-æä¾›å¤šä¸ªå®ç°ç±»"&gt;2. æä¾›å¤šä¸ªå®ç°ç±»
&lt;/h3&gt;&lt;p&gt;ä¸ºæ”¯ä»˜æ¥å£åˆ›å»ºä¸¤ä¸ªä¸åŒçš„å®ç°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ”¯ä»˜å®å®ç°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// AlipayPaymentService.java - æ”¯ä»˜å®å®ç°
public class AlipayPaymentService implements PaymentService {
@Override
public void processPayment(double amount) {
System.out.println(&amp;#34;ä½¿ç”¨æ”¯ä»˜å®æ”¯ä»˜: &amp;#34; + amount + &amp;#34;å…ƒ&amp;#34;);
// å…·ä½“çš„æ”¯ä»˜å®æ”¯ä»˜é€»è¾‘
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å¾®ä¿¡æ”¯ä»˜å®ç°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// WechatPaymentService.java - å¾®ä¿¡æ”¯ä»˜å®ç°
public class WechatPaymentService implements PaymentService {
@Override
public void processPayment(double amount) {
System.out.println(&amp;#34;ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜: &amp;#34; + amount + &amp;#34;å…ƒ&amp;#34;);
// å…·ä½“çš„å¾®ä¿¡æ”¯ä»˜é€»è¾‘
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="3-åˆ›å»ºspié…ç½®æ–‡ä»¶"&gt;3. åˆ›å»ºSPIé…ç½®æ–‡ä»¶
&lt;/h3&gt;&lt;p&gt;åœ¨é¡¹ç›®çš„èµ„æºç›®å½• &lt;code&gt;resources/META-INF/services/&lt;/code&gt;ä¸‹åˆ›å»ºæ–‡ä»¶ï¼Œ&lt;strong&gt;æ–‡ä»¶åå¿…é¡»ä¸ºæ¥å£çš„å…¨é™å®šå&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶è·¯å¾„ï¼š&lt;/strong&gt; &lt;code&gt;resources/META-INF/services/com.example.PaymentService&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶å†…å®¹ï¼š&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;com.example.impl.AlipayPaymentService
com.example.impl.WechatPaymentService
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="4-ä½¿ç”¨serviceloaderåŠ è½½æ‰€æœ‰å®ç°"&gt;4. ä½¿ç”¨ServiceLoaderåŠ è½½æ‰€æœ‰å®ç°
&lt;/h3&gt;&lt;p&gt;åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œé€šè¿‡ &lt;code&gt;ServiceLoader&lt;/code&gt;åŠ¨æ€åŠ è½½å¹¶è°ƒç”¨æ‰€æœ‰æ”¯ä»˜å®ç°ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.ServiceLoader;
public class PaymentApplication {
public static void main(String[] args) {
// åŠ è½½æ‰€æœ‰PaymentServiceå®ç°
ServiceLoader&amp;lt;PaymentService&amp;gt; services = ServiceLoader.load(PaymentService.class);
// éå†å¹¶è°ƒç”¨æ¯ä¸ªå®ç°
for (PaymentService service : services) {
service.processPayment(100.0);
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¿è¡Œç»“æœï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ä½¿ç”¨æ”¯ä»˜å®æ”¯ä»˜: 100.0å…ƒ
ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜: 100.0å…ƒ
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="å…³é”®ç‚¹è¯´æ˜"&gt;å…³é”®ç‚¹è¯´æ˜
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶ä½ç½®å¿…é¡»ç²¾ç¡®&lt;/strong&gt;ï¼šSPIé…ç½®æ–‡ä»¶å¿…é¡»ä½äº &lt;code&gt;META-INF/services/&lt;/code&gt;ç›®å½•ä¸‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶åå¿…é¡»åŒ¹é…&lt;/strong&gt;ï¼šæ–‡ä»¶åå¿…é¡»æ˜¯æ¥å£çš„å®Œæ•´åŒ…å+ç±»åã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šå®ç°åˆ†è¡Œåˆ—å‡º&lt;/strong&gt;ï¼šæ¯ä¸ªå®ç°ç±»çš„å…¨é™å®šåå•ç‹¬å ä¸€è¡Œï¼ŒServiceLoaderä¼šåŠ è½½æ‰€æœ‰åˆ—å‡ºçš„å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªä¾‹å­å±•ç¤ºäº†SPIæœºåˆ¶çš„æ ¸å¿ƒä»·å€¼ï¼š&lt;strong&gt;æ— éœ€ä¿®æ”¹ä»»ä½•ä»£ç å³å¯æ‰©å±•ç³»ç»ŸåŠŸèƒ½&lt;/strong&gt;ã€‚å¦‚æœè¦æ·»åŠ æ–°çš„æ”¯ä»˜æ–¹å¼ï¼ˆå¦‚é“¶è”æ”¯ä»˜ï¼‰ï¼Œåªéœ€æ–°å¢ä¸€ä¸ªå®ç°ç±»å¹¶åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œå³å¯ã€‚&lt;/p&gt;
&lt;h2 id="æ•°ç»„å¤åˆ¶"&gt;æ•°ç»„å¤åˆ¶
&lt;/h2&gt;&lt;p&gt;äº†è§£ Java ä¸­æ•°ç»„å¤åˆ¶æ–¹æ³•çš„æ€§èƒ½å·®å¼‚ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬åœ¨ç¼–ç¨‹æ—¶åšå‡ºæ›´åˆé€‚çš„é€‰æ‹©ã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†è§£é‡Šè¿™å››ç§å¸¸è§æ–¹æ³•çš„æ€§èƒ½æ’åºï¼ˆ&lt;strong&gt;System.arraycopy &amp;gt; Arrays.copyOf &amp;gt; clone &amp;gt; forå¾ªç¯&lt;/strong&gt;ï¼‰ï¼Œå¹¶è¯´æ˜åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ›´ç›´è§‚åœ°å±•ç¤ºå®ƒä»¬çš„ä¸»è¦åŒºåˆ«ï¼Œæˆ‘å‡†å¤‡äº†ä¸€ä¸ªå¯¹æ¯”è¡¨æ ¼ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;System.arraycopy&lt;/th&gt;
&lt;th&gt;Arrays.copyOf&lt;/th&gt;
&lt;th&gt;clone()&lt;/th&gt;
&lt;th&gt;forå¾ªç¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Nativeæ–¹æ³•&lt;/strong&gt;ï¼ŒJVM åº•å±‚å†…å­˜å—å¤åˆ¶&lt;/td&gt;
&lt;td&gt;å†…éƒ¨è°ƒç”¨ &lt;code&gt;System.arraycopy&lt;/code&gt;ï¼Œä½†åŒ…å«é¢å¤–é€»è¾‘&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Nativeæ–¹æ³•&lt;/strong&gt;ï¼Œä½†éœ€è¦ JNI è½¬æ¢&lt;/td&gt;
&lt;td&gt;Java å¾ªç¯ï¼Œé€ä¸ªèµ‹å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½çº§åˆ«&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æœ€é«˜&lt;/strong&gt; (å¤§æ•°ç»„ä¼˜åŠ¿æ˜æ˜¾)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è¾ƒé«˜&lt;/strong&gt; (ä½†ç•¥ä½äº &lt;code&gt;System.arraycopy&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸­ç­‰&lt;/strong&gt; (å°æ•°ç»„å°šå¯ï¼Œå¤§æ•°ç»„ä¸å¦‚å‰ä¸¤è€…)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æœ€ä½&lt;/strong&gt; (å°¤å…¶åœ¨å¤§æ•°ç»„æ—¶)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜&lt;/strong&gt;ï¼Œå¯æŒ‡å®šæº/ç›®æ ‡ä½ç½®ã€å¤åˆ¶é•¿åº¦&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸­&lt;/strong&gt;ï¼Œä¸»è¦ç”¨äºæ‰©å±•æˆ–æˆªæ–­æ•°ç»„&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½&lt;/strong&gt;ï¼Œåªèƒ½å®Œæ•´å¤åˆ¶æ•°ç»„&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æé«˜&lt;/strong&gt;ï¼Œå¯åœ¨å¾ªç¯å†…è¿›è¡Œè‡ªå®šä¹‰æ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç ç®€æ´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨åˆ›å»ºç›®æ ‡æ•°ç»„ï¼Œå‚æ•°è¾ƒå¤š&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜&lt;/strong&gt;ï¼Œä¸€è¡Œä»£ç å®Œæˆåˆ›å»ºå’Œå¤åˆ¶&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜&lt;/strong&gt;ï¼Œä¸€è¡Œä»£ç  &lt;code&gt;array.clone()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½&lt;/strong&gt;ï¼Œéœ€æ‰‹åŠ¨ç¼–å†™å¾ªç¯ä½“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤§å‹æ•°ç»„&lt;/strong&gt;æˆ–å¯¹&lt;strong&gt;æ€§èƒ½æè‡´è¦æ±‚&lt;/strong&gt;çš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;éœ€è¦&lt;strong&gt;åˆ›å»ºæ–°æ•°ç»„&lt;/strong&gt;å¹¶å¤åˆ¶å†…å®¹ï¼Œæˆ–è°ƒæ•´æ•°ç»„å¤§å°&lt;/td&gt;
&lt;td&gt;å¿«é€Ÿå®ç°&lt;strong&gt;ä¸€ç»´æ•°ç»„&lt;/strong&gt;çš„&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å°å‹æ•°ç»„&lt;/strong&gt;ï¼Œæˆ–å¤åˆ¶è¿‡ç¨‹ä¸­éœ€&lt;strong&gt;è‡ªå®šä¹‰æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ğŸ§  &lt;strong&gt;ç†è§£æ€§èƒ½å·®å¼‚çš„åŸå› &lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;System.arraycopy&lt;/code&gt;ä¸ºä½•æœ€å¿«&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å®ƒæ˜¯ç”¨ &lt;code&gt;native&lt;/code&gt;å…³é”®å­—å£°æ˜çš„&lt;strong&gt;æœ¬åœ°æ–¹æ³•&lt;/strong&gt;ï¼Œå…¶å®ç°æ˜¯ç”¨ C/C++ ç¼–å†™çš„ï¼Œç›´æ¥æ“ä½œå†…å­˜ï¼Œç±»ä¼¼äºç›´æ¥æ‹·è´å†…å­˜å—ã€‚è¿™ç§åº•å±‚æ“ä½œçœå»äº†å¤§é‡çš„æ•°ç»„å¯»å€è®¿é—®ç­‰æ—¶é—´ï¼Œå› æ­¤æ•ˆç‡æœ€é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Arrays.copyOf&lt;/code&gt;ä¸ºä½•æ¬¡ä¹‹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æŸ¥çœ‹å…¶æºç ä¼šå‘ç°ï¼Œå®ƒå†…éƒ¨å®é™…ä¸Šè°ƒç”¨äº† &lt;code&gt;System.arraycopy&lt;/code&gt;ã€‚ä½†åœ¨è°ƒç”¨ä¹‹å‰ï¼Œå®ƒéœ€è¦&lt;strong&gt;å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„&lt;/strong&gt;ï¼Œå¹¶ä¸”å¯èƒ½åŒ…å«ä¸€äº›é¢å¤–çš„é€»è¾‘ï¼ˆå¦‚è®¡ç®—éœ€è¦å¤åˆ¶çš„é•¿åº¦ &lt;code&gt;Math.min(original.length, newLength)&lt;/code&gt;ï¼‰ï¼Œè¿™äº›é¢å¤–çš„å¼€é”€ä½¿å…¶æ•ˆç‡ç•¥ä½äºç›´æ¥è°ƒç”¨ &lt;code&gt;System.arraycopy&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•ä¸ºä½•å±…ä¸­&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;clone()&lt;/code&gt;ä¹Ÿæ˜¯ä¸€ä¸ª &lt;code&gt;native&lt;/code&gt;æ–¹æ³•ã€‚ä½†å®ƒéœ€è¦ JNI (Java Native Interface) è½¬æ¢ï¼Œè¿™å¯èƒ½å¸¦æ¥ä¸€å®šçš„å¼€é”€ã€‚åŒæ—¶ï¼Œå¯¹äºæ•°ç»„è€Œè¨€ï¼Œ&lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•ä¼šåˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªå…¨æ–°çš„æ•°ç»„å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„å¼€é”€é€šå¸¸æ¯”çº¯ç²¹çš„å†…å­˜æ‹·è´ï¼ˆå¦‚ &lt;code&gt;System.arraycopy&lt;/code&gt;ï¼‰è¦å¤§ä¸€äº›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;for&lt;/code&gt;å¾ªç¯ä¸ºä½•æœ€æ…¢&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;for&lt;/code&gt;å¾ªç¯æ˜¯çº¯ç²¹çš„ Java å±‚é¢æ“ä½œï¼Œéœ€è¦&lt;strong&gt;é€ä¸ªå…ƒç´ &lt;/strong&gt;è¿›è¡Œèµ‹å€¼ã€‚&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡å¾ªç¯è¿­ä»£éƒ½éœ€è¦è¿›è¡Œ&lt;strong&gt;ä¸‹æ ‡æ£€æŸ¥&lt;/strong&gt;ï¼ˆç¡®ä¿ä¸è¶Šç•Œï¼‰å’Œ&lt;strong&gt;ä¸€æ¬¡é¢å¤–çš„è®°å½•ä¸‹æ ‡å€¼çš„åŠ æ³•è¿ç®—&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç°ä»£ JVM ä¼šå¯¹å¾ªç¯è¿›è¡Œä¸€å®šçš„ä¼˜åŒ–ï¼Œä½†å³ä¾¿å¦‚æ­¤ï¼Œå…¶å¼€é”€ä»ç„¶è¿œå¤§äºåº•å±‚çš„å†…å­˜æ‰¹é‡å¤åˆ¶æ“ä½œã€‚æ•°ç»„è¶Šå¤§ï¼Œè¿™ç§æ€§èƒ½å·®è·å°±è¶Šæ˜æ˜¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ğŸ“Š &lt;strong&gt;æ€§èƒ½å·®å¼‚çš„å®é™…æ„ä¹‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ€§èƒ½å·®å¼‚åœ¨&lt;strong&gt;æ“ä½œå¤§é‡æ•°æ®ï¼ˆä¾‹å¦‚æ•°ç»„é•¿åº¦è¶…è¿‡å‡ åƒæˆ–ä¸Šä¸‡ï¼‰æ—¶æ‰ä¼šæ¯”è¾ƒæ˜æ˜¾&lt;/strong&gt;ã€‚å¯¹äºå¾ˆå°çš„æ•°ç»„ï¼ˆä¾‹å¦‚åªæœ‰å‡ ä¸ªæˆ–å‡ åä¸ªå…ƒç´ ï¼‰ï¼Œå‡ ç§æ–¹æ³•ä¹‹é—´çš„å·®å¼‚å¯èƒ½å¾®ä¹å…¶å¾®ï¼Œæ­¤æ—¶&lt;strong&gt;ä»£ç çš„å¯è¯»æ€§å’Œç®€æ´æ€§å¯èƒ½æ¯”æè‡´çš„æ€§èƒ½æ›´é‡è¦&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºç»å¤§å¤šæ•°æƒ…å†µï¼Œ&lt;strong&gt;&lt;code&gt;System.arraycopy&lt;/code&gt;æ˜¯å¤„ç†å¤§å‹æ•°ç»„å¤åˆ¶çš„é¦–é€‰æ–¹æ³•ï¼Œè€Œ &lt;code&gt;Arrays.copyOf&lt;/code&gt;åˆ™åœ¨éœ€è¦åˆ›å»ºæ–°æ•°ç»„å¹¶å¤åˆ¶å†…å®¹æˆ–è°ƒæ•´æ•°ç»„å¤§å°æ—¶æä¾›äº†æ›´ç®€æ´çš„è¯­æ³•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;é€‰æ‹©å»ºè®®&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿½æ±‚æè‡´æ€§èƒ½ã€æ“ä½œå¤§æ•°ç»„æˆ–éœ€è¦éƒ¨åˆ†å¤åˆ¶&lt;/strong&gt;ï¼šä¼˜å…ˆé€‰ç”¨ &lt;code&gt;System.arraycopy&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼ˆå°¤å…¶æ˜¯éœ€è¦è°ƒæ•´å¤§å°ï¼‰å¹¶å¸Œæœ›ä»£ç ç®€æ´&lt;/strong&gt;ï¼š&lt;code&gt;Arrays.copyOf&lt;/code&gt;å’Œ &lt;code&gt;Arrays.copyOfRange&lt;/code&gt;å¾ˆæ–¹ä¾¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«é€Ÿå¤åˆ¶ä¸€ç»´æ•°ç»„&lt;/strong&gt;ï¼š&lt;code&gt;clone()&lt;/code&gt;å†™æ³•ç®€å•ï¼Œæ€§èƒ½å°šå¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤åˆ¶å°æ•°ç»„æˆ–éœ€è¦åœ¨å¤åˆ¶è¿‡ç¨‹ä¸­è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼ˆå¦‚æ¡ä»¶è¿‡æ»¤ã€æ•°æ®è½¬æ¢ï¼‰&lt;/strong&gt;ï¼š&lt;code&gt;for&lt;/code&gt;å¾ªç¯æ›´çµæ´»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£è¿™äº›æ•°ç»„å¤åˆ¶æ–¹æ³•èƒŒåçš„åŸç†å’Œé€‚ç”¨åœºæ™¯ã€‚&lt;/p&gt;
&lt;h2 id="jni"&gt;JNI
&lt;/h2&gt;&lt;p&gt;ä½ è§‚å¯Ÿåˆ°çš„è¿™ä¸€ç‚¹éå¸¸å…³é”®ï¼Œå®ƒç›´æ¥è§¦åŠäº† Java ä¸­ä¸¤ä¸ªé‡è¦ &lt;code&gt;native&lt;/code&gt;æ–¹æ³•åœ¨æ€§èƒ½è¡¨ç°ä¸Šå­˜åœ¨å·®å¼‚çš„æ ¸å¿ƒåŸå› ã€‚ç®€å•æ¥è¯´ï¼Œ&lt;code&gt;System.arraycopy&lt;/code&gt;æ˜¯ JVM é«˜åº¦ä¼˜åŒ–çš„â€œç‰¹æƒâ€æ“ä½œï¼Œè€Œ &lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•åˆ™éµå¾ªäº†æ ‡å‡†çš„ JNI è°ƒç”¨æµç¨‹ï¼Œè¿™å¯¼è‡´äº†æ€§èƒ½ä¸Šçš„å·®è·ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯ä»¥è®©ä½ æ›´ç›´è§‚åœ°æŠŠæ¡å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¯¹æ¯”ç»´åº¦&lt;/th&gt;
&lt;th&gt;&lt;code&gt;System.arraycopy&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;Object.clone()&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;JVM å†…éƒ¨ intrinsic&lt;/strong&gt;ï¼Œå¯èƒ½ç»•è¿‡æ ‡å‡†JNI&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ ‡å‡† JNI è°ƒç”¨&lt;/strong&gt;ï¼Œéœ€è¦å®Œæ•´æ¥å£è½¬æ¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼˜åŒ–çº§åˆ«&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æé«˜ï¼Œå¯èƒ½ç¼–è¯‘ä¸ºç‰¹å®šCPUæŒ‡ä»¤&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒä½ï¼Œèµ°æ ‡å‡†æœ¬åœ°æ–¹æ³•è°ƒç”¨æµç¨‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†…å­˜è¾¹ç•Œæ£€æŸ¥ã€æ•°æ®æ¬è¿&lt;/td&gt;
&lt;td&gt;JNI è½¬æ¢ã€å¯¹è±¡åˆ›å»ºä¸åˆå§‹åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®çš„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çº¯ç²¹çš„&lt;strong&gt;å†…å­˜å—å¤åˆ¶&lt;/strong&gt;ï¼ŒåŠŸèƒ½å•ä¸€&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å®Œæ•´å¯¹è±¡å¤åˆ¶&lt;/strong&gt;ï¼Œæ¶‰åŠå¯¹è±¡åˆ›å»ºã€åˆå§‹åŒ–ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å®šä½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¥è¿‘ç¡¬ä»¶æé™çš„&lt;strong&gt;ç³»ç»Ÿçº§å·¥å…·&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¢å‘å¯¹è±¡çš„&lt;strong&gt;é€šç”¨å¯¹è±¡å¤åˆ¶æ¥å£&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-æ·±å…¥è§£ææ€§èƒ½å·®å¼‚çš„æ ¹æº"&gt;ğŸ’¡ æ·±å…¥è§£ææ€§èƒ½å·®å¼‚çš„æ ¹æº
&lt;/h3&gt;&lt;h4 id="systemarraycopyçš„é«˜æ•ˆä¹‹æº"&gt;&lt;code&gt;System.arraycopy&lt;/code&gt;çš„é«˜æ•ˆä¹‹æº
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;System.arraycopy&lt;/code&gt;çš„é«˜æ€§èƒ½ä¸»è¦å¾—ç›Šäºå®ƒè¢«å®ç°ä¸º &lt;strong&gt;JVM intrinsic&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ„å‘³ç€ï¼Œå½“ JVMï¼ˆç‰¹åˆ«æ˜¯ JIT ç¼–è¯‘å™¨ï¼‰é‡åˆ° &lt;code&gt;System.arraycopy&lt;/code&gt;è°ƒç”¨æ—¶ï¼Œå¹¶ä¸ä¼šå»æ‰§è¡Œé‚£ä¸ªæ ‡å‡†çš„ã€ç›¸å¯¹ç¼“æ…¢çš„ JNI æœ¬åœ°æ–¹æ³•ã€‚ç›¸åï¼Œå®ƒä¼š&lt;strong&gt;ç›´æ¥å°†å…¶æ›¿æ¢ä¸ºä¸€ç³»åˆ—é«˜åº¦ä¼˜åŒ–çš„æ±‡ç¼–æŒ‡ä»¤&lt;/strong&gt;ã€‚è¿™äº›æŒ‡ä»¤å°±åƒæ˜¯ CPU çš„â€œä¸“é•¿â€ï¼Œèƒ½å¤Ÿä»¥æ¥è¿‘ç¡¬ä»¶æé™çš„é€Ÿåº¦å®Œæˆå¤§å—å†…å­˜çš„å¤åˆ¶ ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå®ƒçš„èŒè´£éå¸¸å•ä¸€ï¼šå°†ä¸€æ®µè¿ç»­çš„å†…å­˜æ•°æ®ä»ä½ç½® A é«˜æ•ˆåœ°æ¬è¿åˆ°ä½ç½® Bã€‚è¿™ç§çº¯ç²¹æ€§ä½¿å¾— JVM å¯ä»¥å¯¹å…¶è¿›è¡Œæè‡´çš„ä¼˜åŒ– ã€‚&lt;/p&gt;
&lt;h4 id="cloneæ–¹æ³•çš„é¢å¤–è´Ÿæ‹…"&gt;&lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•çš„é¢å¤–è´Ÿæ‹…
&lt;/h4&gt;&lt;p&gt;ç›¸æ¯”ä¹‹ä¸‹ï¼Œ&lt;code&gt;Object.clone()&lt;/code&gt;æ–¹æ³•æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ JNI æ–¹æ³•ã€‚å®ƒçš„è°ƒç”¨éœ€è¦ç»å†å®Œæ•´çš„ JNI æµç¨‹ï¼ŒåŒ…æ‹¬ä» Java ç¯å¢ƒåˆ°æœ¬åœ°ç¯å¢ƒçš„åˆ‡æ¢ã€å‚æ•°ä¼ é€’ç­‰ï¼Œè¿™äº›éƒ½ä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ ã€‚&lt;/p&gt;
&lt;p&gt;æ›´é‡è¦çš„æ˜¯ï¼Œ&lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•çš„åŠŸèƒ½æ¯” &lt;code&gt;System.arraycopy&lt;/code&gt;å¤æ‚å¾—å¤šã€‚å®ƒéœ€è¦å®Œæˆä¸€ä¸ªå®Œæ•´å¯¹è±¡çš„â€œå…‹éš†â€ï¼Œè¿™è‡³å°‘åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ›å»ºæ–°å¯¹è±¡&lt;/strong&gt;ï¼šä¸ºè¢«å…‹éš†çš„å¯¹è±¡åˆ†é…æ–°çš„å†…å­˜ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€å­—æ®µå¤åˆ¶&lt;/strong&gt;ï¼šå°†åŸå¯¹è±¡çš„æ¯ä¸ªå­—æ®µçš„å€¼å¤åˆ¶åˆ°æ–°å¯¹è±¡ä¸­ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯¹äºæ•°ç»„è€Œè¨€ï¼Œè™½ç„¶åº•å±‚ä¹Ÿæ˜¯å†…å­˜å¤åˆ¶ï¼Œä½† &lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•éœ€è¦å¤„ç†å¯¹è±¡åˆ›å»ºçš„é€»è¾‘ä»¥åŠå¯èƒ½çš„æ£€æŸ¥ï¼Œè¿™ä½¿å…¶å¤©ç„¶å°±æ¯”çº¯ç²¹çš„å†…å­˜å¤åˆ¶æ“ä½œ &lt;code&gt;System.arraycopy&lt;/code&gt;æ›´é‡ ã€‚&lt;/p&gt;
&lt;h3 id="-å¦‚ä½•é€‰æ‹©ä¸å®è·µ"&gt;ğŸ”§ å¦‚ä½•é€‰æ‹©ä¸å®è·µ
&lt;/h3&gt;&lt;p&gt;ç†è§£è¿™äº›åŒºåˆ«åï¼Œæˆ‘ä»¬åœ¨ç¼–ç¨‹æ—¶å°±å¯ä»¥åšå‡ºæ›´æ˜æ™ºçš„é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°ç»„å¤åˆ¶ï¼Œä¼˜å…ˆä½¿ç”¨ &lt;code&gt;System.arraycopy&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ä½ åœ¨è¿›è¡Œæ•°ç»„å¤åˆ¶ï¼ˆå°¤å…¶æ˜¯å¤§æ•°æ®é‡ï¼‰æ—¶ï¼Œåº”é¦–é€‰ &lt;code&gt;System.arraycopy&lt;/code&gt;ï¼Œå› ä¸ºå®ƒä¸ºè¿™ä¸€ç‰¹å®šä»»åŠ¡æä¾›äº†æœ€ä¼˜æ€§èƒ½ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å…‹éš†ï¼Œç†è§£ &lt;code&gt;clone()&lt;/code&gt;çš„è¯­ä¹‰&lt;/strong&gt;ï¼šå½“éœ€è¦å¤åˆ¶æ•´ä¸ªå¯¹è±¡æ—¶ï¼Œä½¿ç”¨ &lt;code&gt;clone()&lt;/code&gt;ã€‚ä½†è¦ç‰¹åˆ«æ³¨æ„ï¼Œé»˜è®¤çš„ &lt;code&gt;clone()&lt;/code&gt;å®ç°æ˜¯&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;ã€‚å¦‚æœå¯¹è±¡å†…éƒ¨åŒ…å«å¯å˜å¼•ç”¨ç±»å‹ï¼Œä½ éœ€è¦é‡å†™ &lt;code&gt;clone()&lt;/code&gt;æ–¹æ³•æ¥å®ç°æ·±æ‹·è´ï¼Œä»¥ç¡®ä¿å…‹éš†å¯¹è±¡çš„å®Œå…¨ç‹¬ç«‹æ€§ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æ•æ„Ÿåœºæ™¯çš„åŸºå‡†æµ‹è¯•&lt;/strong&gt;ï¼šåœ¨æç«¯æ€§èƒ½è¦æ±‚çš„åœºæ™¯ä¸‹ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯é€šè¿‡å®é™…çš„åŸºå‡†æµ‹è¯•ï¼ˆå¦‚ä½¿ç”¨ JMHï¼‰æ¥éªŒè¯ä¸¤ç§æ–¹å¼åœ¨ç‰¹å®šç¯å¢ƒå’Œæ•°æ®è§„æ¨¡ä¸‹çš„å…·ä½“è¡¨ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£è¿™ä¸¤ä¸ªæ–¹æ³•èƒŒåçš„åŸç†ã€‚å¦‚æœä½ å¯¹æµ…æ‹·è´ä¸æ·±æ‹·è´çš„å…·ä½“å®ç°ï¼Œæˆ–è€…å…¶ä»– Java åº•å±‚æœºåˆ¶æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚&lt;/p&gt;
&lt;h2 id="jvm-intrinsic"&gt;JVM Intrinsic
&lt;/h2&gt;&lt;p&gt;åœ¨Javaå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç¼–å†™çš„ä»£ç ä¼šç”±Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰è½¬æ¢æˆæœºå™¨æŒ‡ä»¤æ¥æ‰§è¡Œã€‚ä¸ºäº†è®©ä¸€äº›å…³é”®æ“ä½œè·‘å¾—æ›´å¿«ï¼ŒJVMä½¿ç”¨äº†ä¸€ç§å«åš &lt;strong&gt;Intrinsic&lt;/strong&gt; çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œæˆ–è€…å«&lt;strong&gt;å†…ç½®æ–¹æ³•&lt;/strong&gt;ã€‚ç®€å•ç†è§£ï¼Œå®ƒå°±æ˜¯JVMè¯†åˆ«å‡ºä¸€äº›ç‰¹å®šæ–¹æ³•è°ƒç”¨åï¼Œâ€œå·å·â€ç”¨æ›´é«˜æ•ˆçš„åº•å±‚æŒ‡ä»¤ï¼ˆæ¯”å¦‚CPUçš„SIMDæŒ‡ä»¤ï¼‰æ¥æ›¿æ¢æ‰åŸæ¥çš„æ–¹æ³•å®ç°ï¼Œä»è€Œå¤§å¹…æå‡æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†JVM Intrinsicçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå¸®ä½ å¿«é€ŸæŠŠæ¡å…¨å±€ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§ç»´åº¦&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”±JVMåœ¨è¿è¡Œæ—¶æˆ–ç¼–è¯‘æ—¶è¿›è¡Œç‰¹æ®Šå¤„ç†çš„æ–¹æ³•ï¼Œè°ƒç”¨ä¼šè¢«æ›¿æ¢ä¸ºé«˜åº¦ä¼˜åŒ–çš„å®ç°ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æ‰‹æ®µ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ›¿æ¢ä¸ºç‰¹å®šçš„CPUæŒ‡ä»¤ï¼ˆå¦‚SIMDæŒ‡ä»¤ã€&lt;code&gt;popcnt&lt;/code&gt;ï¼‰ã€ç›´æ¥è®¿é—®ç¡¬ä»¶å¯„å­˜å™¨æˆ–ä¼˜åŒ–çš„æœ¬åœ°ä»£ç æ¡©ï¼ˆStubï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®æ³¨è§£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@HotSpotIntrinsicCandidate&lt;/code&gt;(Java 9+)ï¼Œç”¨äºæ ‡è®°å¯èƒ½è¢«ä¼˜åŒ–çš„æ–¹æ³•ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½æå‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¾è‘—ï¼Œé€šå¸¸æœ‰æ•°å€ç”šè‡³æ•°åå€çš„æå‡ï¼ˆä¾‹å¦‚ï¼Œ&lt;code&gt;String.indexOf&lt;/code&gt;åˆ©ç”¨SIMDæŒ‡ä»¤å¯æå‡50å€ä»¥ä¸Šï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦åº”ç”¨ç±»/æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;java.lang.String&lt;/code&gt;(&lt;code&gt;indexOf&lt;/code&gt;, &lt;code&gt;equals&lt;/code&gt;), &lt;code&gt;java.util.Arrays&lt;/code&gt;(&lt;code&gt;equals&lt;/code&gt;, &lt;code&gt;copyOf&lt;/code&gt;), &lt;code&gt;java.lang.Math&lt;/code&gt;(å„ç§æ•°å­¦è¿ç®—), &lt;code&gt;sun.misc.Unsafe&lt;/code&gt;(CASæ“ä½œ) ç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–ç‰¹å®šCPUæ¶æ„å’ŒJVMå®ç°ï¼›è¦†ç›–èŒƒå›´æœ‰é™ï¼ˆä¸»è¦ä¸ºæ ¸å¿ƒJDKç±»åº“ï¼‰ï¼›å¼€å‘è€…é€šå¸¸æ— æ³•è‡ªå®šä¹‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-intrinsic-å¦‚ä½•å·¥ä½œ"&gt;ğŸ’¡ Intrinsic å¦‚ä½•å·¥ä½œ
&lt;/h3&gt;&lt;p&gt;Intrinsic çš„æ ¸å¿ƒåœ¨äºï¼ŒJVMï¼ˆç‰¹åˆ«æ˜¯å…¶å³æ—¶ç¼–è¯‘å™¨JITï¼‰åœ¨ç¼–è¯‘Javaå­—èŠ‚ç ä¸ºæœ¬åœ°æœºå™¨ç æ—¶ï¼Œèƒ½è¯†åˆ«å‡ºç‰¹å®šçš„æ–¹æ³•è°ƒç”¨ï¼Œå¹¶ç”¨æœ€ä¼˜çš„å®ç°æ›¿æ¢å®ƒã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¯†åˆ«ä¸æ ‡è®°&lt;/strong&gt;ï¼šåœ¨Java 9åŠä¹‹åç‰ˆæœ¬ï¼ŒJDKå¼€å‘è€…ä½¿ç”¨ &lt;code&gt;@HotSpotIntrinsicCandidate&lt;/code&gt;æ³¨è§£æ¥æ ‡è®°é‚£äº›å¯èƒ½æœ‰é«˜æ•ˆåº•å±‚å®ç°çš„æ–¹æ³•ã€‚è¿™ç›¸å½“äºå‘Šè¯‰JVMï¼šâ€œè¿™ä¸ªæ–¹æ³•æœ‰ä¼˜åŒ–æ½œåŠ›ï¼Œé‡åˆ°æ—¶è¯·ä¼˜å…ˆè€ƒè™‘ä½ çš„é«˜æ•ˆç‰ˆæœ¬ã€‚â€ åœ¨JVMå†…éƒ¨çš„ç¬¦å·è¡¨ï¼ˆå¦‚ &lt;code&gt;vmSymbols.hpp&lt;/code&gt;æ–‡ä»¶ï¼‰ä¸­ï¼Œç»´æŠ¤ç€ä¸€ä¸ªåˆ—è¡¨ï¼Œå°†Javaæ–¹æ³•ä¸æ–¹æ³•ç­¾åæ˜ å°„åˆ°å…¶å¯¹åº”çš„intrinsicå®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æ—¶æ›¿æ¢&lt;/strong&gt;ï¼šå½“JITç¼–è¯‘å™¨ï¼ˆå¦‚C1æˆ–C2ï¼‰å¼€å§‹å·¥ä½œï¼Œå‡†å¤‡å°†çƒ­ç‚¹ä»£ç ç¼–è¯‘æˆæœ¬åœ°ä»£ç æ—¶ï¼Œå¦‚æœé‡åˆ°ä¸€ä¸ªè¢«æ ‡è®°ä¸ºintrinsicçš„æ–¹æ³•è°ƒç”¨ï¼Œå®ƒä¼šè¿›è¡Œå…³é”®åˆ¤æ–­ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ˜¯intrinsicæ–¹æ³•&lt;/strong&gt;ï¼šJITç¼–è¯‘å™¨ä¸ä¼šå»å†…è”è¯¥æ–¹æ³•æ™®é€šçš„Javaå­—èŠ‚ç å®ç°ï¼Œè€Œæ˜¯ç›´æ¥ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥intrinsicæ“ä½œçš„ç‰¹æ®ŠèŠ‚ç‚¹ï¼ˆIRèŠ‚ç‚¹ï¼‰æ’å…¥åˆ°ç¼–è¯‘ä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰ä¸­ã€‚åç»­ä¼˜åŒ–é˜¶æ®µï¼Œè¿™ä¸ªç‰¹æ®ŠèŠ‚ç‚¹ä¼šç›´æ¥è½¬æ¢ä¸ºé«˜æ•ˆçš„CPUæŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ˜¯intrinsicæ–¹æ³•&lt;/strong&gt;ï¼šåˆ™èµ°å¸¸è§„çš„å†…è”è·¯å¾„ï¼Œå°†ç›®æ ‡æ–¹æ³•çš„å­—èŠ‚ç å±•å¼€å¹¶é›†æˆåˆ°è°ƒç”¨è€…çš„ç¼–è¯‘ä¸Šä¸‹æ–‡ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ•ˆå®ç°è½åœ°&lt;/strong&gt;ï¼šè¿™ä¸ªç‰¹æ®ŠèŠ‚ç‚¹æœ€ç»ˆä¼šæ ¹æ®å½“å‰CPUæ”¯æŒçš„æŒ‡ä»¤é›†ï¼Œç”Ÿæˆé«˜åº¦ä¼˜åŒ–çš„æœºå™¨æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œåœ¨æ”¯æŒSSE4.2æŒ‡ä»¤é›†çš„x86-64 CPUä¸Šï¼Œ&lt;code&gt;StringLatin1.indexOf&lt;/code&gt;æ–¹æ³•çš„è°ƒç”¨ä¼šè¢«æ›¿æ¢ä¸ºä½¿ç”¨ &lt;code&gt;PCMPESTRI&lt;/code&gt;æŒ‡ä»¤çš„ä»£ç ï¼Œè¿™æ¡æŒ‡ä»¤èƒ½ä¸€æ¬¡æ€§åœ¨16ä¸ªå­—èŠ‚ä¸­å¹¶è¡Œæœç´¢å­ä¸²ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨ä¸æ€§èƒ½æ”¶ç›Š"&gt;ğŸ”§ å…¸å‹åº”ç”¨ä¸æ€§èƒ½æ”¶ç›Š
&lt;/h3&gt;&lt;p&gt;Intrinsic æŠ€æœ¯åœ¨è®¸å¤šå¸¸è§æ“ä½œä¸­å‘æŒ¥ç€å·¨å¤§ä½œç”¨ï¼Œä»¥ä¸‹æ˜¯å‡ ä¸ªå…¸å‹ä¾‹å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—ç¬¦ä¸²å’Œæ•°ç»„æ“ä½œ&lt;/strong&gt;ï¼šåƒ &lt;code&gt;String.indexOf&lt;/code&gt;, &lt;code&gt;String.equals&lt;/code&gt;, &lt;code&gt;Arrays.equals&lt;/code&gt;, &lt;code&gt;System.arraycopy&lt;/code&gt;ç­‰æ–¹æ³•ï¼Œé€šè¿‡åˆ©ç”¨SIMDæŒ‡ä»¤ï¼ˆå¦‚SSEã€AVXï¼‰ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æ¯”è¾ƒæˆ–å¤åˆ¶å¤šä¸ªæ•°æ®ï¼ˆå¦‚16å­—èŠ‚ã€32å­—èŠ‚ï¼‰ï¼Œè€Œä¸æ˜¯é€ä¸ªå¤„ç†ï¼Œæ€§èƒ½æå‡éå¸¸æ˜¾è‘—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°å­¦è¿ç®—&lt;/strong&gt;ï¼š&lt;code&gt;Math.sqrt&lt;/code&gt;, &lt;code&gt;Math.log&lt;/code&gt;ç­‰æ–¹æ³•å¯èƒ½è¢«ç›´æ¥æ›¿æ¢ä¸ºå¯¹åº”çš„CPUæµ®ç‚¹æŒ‡ä»¤ï¼ˆå¦‚ &lt;code&gt;FSQRT&lt;/code&gt;ï¼‰ã€‚&lt;code&gt;Integer.bitCount&lt;/code&gt;ï¼ˆç»Ÿè®¡æ•´æ•°äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°ï¼‰çš„Javaå®ç°å·²ç»å¾ˆå¿«ï¼Œä½†intrinsicä¼˜åŒ–ä¼šç›´æ¥ä½¿ç”¨x86çš„ &lt;code&gt;POPCNT&lt;/code&gt;æŒ‡ä»¤ï¼Œä¸€æ¡æŒ‡ä»¤å®Œæˆæ“ä½œï¼Œé€Ÿåº¦æå¿«ã€‚&lt;code&gt;Math.addExact&lt;/code&gt;ï¼ˆå¸¦æº¢å‡ºæ£€æŸ¥çš„åŠ æ³•ï¼‰åˆ™ä¼šåˆ©ç”¨CPUåŠ æ³•æŒ‡ä»¤åå¯¹çŠ¶æ€å¯„å­˜å™¨ä¸­æº¢å‡ºæ ‡å¿—ä½çš„è‡ªåŠ¨è®¾ç½®æ¥é«˜æ•ˆæ£€æµ‹æº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ“ä½œ&lt;/strong&gt;ï¼š&lt;code&gt;Unsafe&lt;/code&gt;ç±»ï¼ˆä»¥åŠåŸºäºå®ƒæ„å»ºçš„ &lt;code&gt;AtomicInteger&lt;/code&gt;ç­‰ï¼‰ä¸­çš„ &lt;code&gt;compareAndSwap&lt;/code&gt;(CAS) æ–¹æ³•ï¼Œä¼šè¢«æ›¿æ¢ä¸ºx86æ¶æ„ä¸‹çš„ &lt;code&gt;LOCK CMPXCHG&lt;/code&gt;æŒ‡ä»¤ï¼Œå®ç°ç¡¬ä»¶çº§åˆ«çš„åŸå­æ“ä½œã€‚&lt;code&gt;Thread.onSpinWait&lt;/code&gt;æ–¹æ³•å¯èƒ½ä¼šè¢«æ›¿æ¢ä¸ºx86çš„ &lt;code&gt;PAUSE&lt;/code&gt;æŒ‡ä»¤ï¼Œä¼˜åŒ–è‡ªæ—‹ç­‰å¾…å¾ªç¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å¦‚ä½•è§‚å¯Ÿä¸åˆ©ç”¨-intrinsic"&gt;ğŸ“Š å¦‚ä½•è§‚å¯Ÿä¸åˆ©ç”¨ Intrinsic
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥çœ‹Intrinsicä¼˜åŒ–&lt;/strong&gt;ï¼šä½ å¯ä»¥é€šè¿‡æ·»åŠ JVMå‚æ•°æ¥è§‚å¯ŸJITç¼–è¯‘å™¨çš„è¡Œä¸ºï¼ŒåŒ…æ‹¬intrinsicæ›¿æ¢ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ &lt;code&gt;-XX:+UnlockDiagnosticVMOptions -XX:+PrintCompilation -XX:+PrintInlining&lt;/code&gt;å¯ä»¥æ‰“å°æ–¹æ³•ç¼–è¯‘å’Œå†…è”ä¿¡æ¯ï¼Œå¦‚æœçœ‹åˆ°ç±»ä¼¼ &lt;code&gt;intrinsic&lt;/code&gt;çš„æç¤ºï¼Œè¯´æ˜å‘ç”Ÿäº†intrinsicä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼šè¦å……åˆ†åˆ©ç”¨intrinsicä¼˜åŒ–ï¼Œæœ€æœ‰æ•ˆçš„æ–¹æ³•æ˜¯ï¼š&lt;strong&gt;å°½é‡ä½¿ç”¨JDKæ ‡å‡†åº“æä¾›çš„API&lt;/strong&gt;ã€‚å› ä¸ºJDKä¸­çš„æ ¸å¿ƒç±»æ–¹æ³•æ˜¯intrinsicä¼˜åŒ–çš„ä¸»è¦ç›®æ ‡ã€‚é¿å…è‡ªå·±é‡æ–°é€ è½®å­å»å®ç°ç±»ä¼¼åŠŸèƒ½ï¼Œä½ çš„æ‰‹å†™ä»£ç é€šå¸¸æ— æ³•äº«å—åˆ°è¿™ç§åº•å±‚ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-4"&gt;âš ï¸ æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;å°½ç®¡Intrinsicå¾ˆå¼ºå¤§ï¼Œä½†ä¹Ÿæœ‰å…¶å±€é™æ€§å’Œéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹³å°ä¾èµ–æ€§&lt;/strong&gt;ï¼šä¸€ä¸ªæ–¹æ³•èƒ½å¦è¢«intrinsicä¼˜åŒ–ï¼Œä»¥åŠä¼˜åŒ–åçš„å…·ä½“å®ç°ï¼Œé«˜åº¦ä¾èµ–äºåº•å±‚çš„CPUæ¶æ„ï¼ˆx86 vs ARMï¼‰å’ŒJVMçš„å…·ä½“å®ç°ï¼ˆHotSpot vs OpenJ9ï¼‰åŠç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼ŒæŸäº›ä¼˜åŒ–å¯èƒ½åªåœ¨x86æ¶æ„çš„HotSpot JVMä¸Šå­˜åœ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— æ³•è‡ªå®šä¹‰&lt;/strong&gt;ï¼šç›®å‰ï¼Œæ™®é€šå¼€å‘è€…æ— æ³•ä¸ºè‡ªå·±ç¼–å†™çš„ä¸šåŠ¡æ–¹æ³•æ·»åŠ  &lt;code&gt;@HotSpotIntrinsicCandidate&lt;/code&gt;æ³¨è§£å¹¶ä½¿å…¶äº«å—intrinsicä¼˜åŒ–ã€‚è¿™ä¸»è¦æ˜¯JVMä¸ºJDKæ ¸å¿ƒç±»åº“ä¿ç•™çš„ä¼˜åŒ–æ‰‹æ®µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯­ä¹‰ä¸€è‡´æ€§&lt;/strong&gt;ï¼šJVMä¿è¯intrinsicä¼˜åŒ–åçš„å®ç°ä¸åŸå§‹çš„Javaä»£ç å®ç°å…·æœ‰å®Œå…¨ç›¸åŒçš„è¯­ä¹‰ï¼Œç¡®ä¿ç¨‹åºè¡Œä¸ºçš„æ­£ç¡®æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£JVM Intrinsicè¿™ä¸€é‡è¦çš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ã€‚&lt;/p&gt;</description></item><item><title>ã€Templeã€‘Java &amp; C</title><link>https://dyhes.github.io/p/templejava-c/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/templejava-c/</guid><description>&lt;h2 id="java-foreach"&gt;Java foreach
&lt;/h2&gt;&lt;p&gt;Java ä¸­çš„ &lt;code&gt;foreach&lt;/code&gt;å¾ªç¯ï¼ˆå¢å¼ºå‹ &lt;code&gt;for&lt;/code&gt;å¾ªç¯ï¼‰æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œå…¶åº•å±‚å®ç°ä¾èµ–äºç¼–è¯‘å™¨çš„ä»£ç è½¬æ¢ã€‚è‡ªå®šä¹‰ç±»è‹¥éœ€æ”¯æŒ &lt;code&gt;foreach&lt;/code&gt;å¾ªç¯ï¼Œéœ€å®ç° &lt;code&gt;Iterable&lt;/code&gt;æ¥å£ã€‚ä»¥ä¸‹ä»å®ç°åŸç†å’Œè‡ªå®šä¹‰ç±»å®ç°æ–¹æ³•ä¸¤æ–¹é¢è¯¦ç»†è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€foreachçš„å®ç°åŸç†"&gt;âš™ï¸ ä¸€ã€&lt;code&gt;foreach&lt;/code&gt;çš„å®ç°åŸç†
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;foreach&lt;/code&gt;çš„åº•å±‚å®ç°æ ¹æ®éå†å¯¹è±¡çš„ç±»å‹ï¼ˆæ•°ç»„æˆ–é›†åˆï¼‰åˆ†ä¸ºä¸¤ç§æ¨¡å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éå†æ•°ç»„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘å™¨å°† &lt;code&gt;foreach&lt;/code&gt;è½¬æ¢ä¸ºä¼ ç»Ÿ &lt;code&gt;for&lt;/code&gt;å¾ªç¯ï¼Œé€šè¿‡ç´¢å¼•ç›´æ¥è®¿é—®æ•°ç»„å…ƒç´ ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æºä»£ç &lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;int[] nums = {1, 2, 3};
for (int num : nums) {
System.out.println(num);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ç¼–è¯‘åç­‰ä»·äº&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;for (int i = 0; i &amp;lt; nums.length; i++) {
int num = nums[i];
System.out.println(num);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šæ— è¿­ä»£å™¨å‚ä¸ï¼Œç›´æ¥æ“ä½œæ•°ç»„ä¸‹æ ‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éå†é›†åˆ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¦æ±‚é›†åˆå®ç° &lt;code&gt;Iterable&lt;/code&gt;æ¥å£ã€‚ç¼–è¯‘å™¨å°† &lt;code&gt;foreach&lt;/code&gt;è½¬æ¢ä¸ºè¿­ä»£å™¨ï¼ˆ&lt;code&gt;Iterator&lt;/code&gt;ï¼‰æ¨¡å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æºä»£ç &lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; list = Arrays.asList(&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;);
for (String s : list) {
System.out.println(s);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ç¼–è¯‘åç­‰ä»·äº&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Iterator&amp;lt;String&amp;gt; iter = list.iterator();
while (iter.hasNext()) {
String s = iter.next();
System.out.println(s);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šä¾èµ– &lt;code&gt;Iterator&lt;/code&gt;çš„ &lt;code&gt;hasNext()&lt;/code&gt;å’Œ &lt;code&gt;next()&lt;/code&gt;æ–¹æ³•éå†å…ƒç´ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="-å…³é”®é™åˆ¶"&gt;âš ï¸ å…³é”®é™åˆ¶ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¦æ­¢ä¿®æ”¹é›†åˆç»“æ„&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;foreach&lt;/code&gt;ä¸­å¢åˆ é›†åˆå…ƒç´ ä¼šæŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ï¼ˆå› è¿­ä»£å™¨æ£€æµ‹åˆ° &lt;code&gt;modCount&lt;/code&gt;å˜åŒ–ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ— æ³•è·å–ç´¢å¼•&lt;/strong&gt;ï¼šéœ€æ”¹ç”¨ä¼ ç»Ÿ &lt;code&gt;for&lt;/code&gt;å¾ªç¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ•ˆç‡å¯¹æ¯”&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;foreach&lt;/code&gt;æ•ˆç‡&lt;/th&gt;
&lt;th&gt;ä¼ ç»Ÿ &lt;code&gt;for&lt;/code&gt;å¾ªç¯æ•ˆç‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ•°ç»„éå†&lt;/td&gt;
&lt;td&gt;æ¥è¿‘ä¼ ç»Ÿå¾ªç¯&lt;/td&gt;
&lt;td&gt;æ›´ä¼˜ï¼ˆç›´æ¥ä¸‹æ ‡è®¿é—®ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ArrayList&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¥è¿‘ä¼ ç»Ÿå¾ªç¯&lt;/td&gt;
&lt;td&gt;æ›´ä¼˜ï¼ˆ&lt;code&gt;get(index)&lt;/code&gt;å¿«ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LinkedList&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ˜¾è‘—æ›´ä¼˜&lt;/strong&gt;ï¼ˆè¿­ä»£å™¨ï¼‰&lt;/td&gt;
&lt;td&gt;æå·®ï¼ˆéå†è€—æ—¶ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-äºŒè‡ªå®šä¹‰ç±»å®ç°-foreachçš„æ–¹æ³•"&gt;ğŸ› ï¸ äºŒã€è‡ªå®šä¹‰ç±»å®ç° &lt;code&gt;foreach&lt;/code&gt;çš„æ–¹æ³•
&lt;/h3&gt;&lt;p&gt;è‹¥è¦è®©è‡ªå®šä¹‰ç±»æ”¯æŒ &lt;code&gt;foreach&lt;/code&gt;å¾ªç¯ï¼Œéœ€å®ç° &lt;code&gt;Iterable&amp;lt;T&amp;gt;&lt;/code&gt;æ¥å£å¹¶é‡å†™ &lt;code&gt;iterator()&lt;/code&gt;æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªè‡ªå®šä¹‰çš„ &lt;code&gt;Iterator&lt;/code&gt;å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h4 id="-å®ç°æ­¥éª¤"&gt;âœ… å®ç°æ­¥éª¤ï¼š
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®ç° &lt;code&gt;Iterable&lt;/code&gt;æ¥å£&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ç±»éœ€å£°æ˜å®ç° &lt;code&gt;Iterable&amp;lt;T&amp;gt;&lt;/code&gt;ï¼ˆ&lt;code&gt;T&lt;/code&gt;ä¸ºå…ƒç´ ç±»å‹ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é‡å†™ &lt;code&gt;iterator()&lt;/code&gt;æ–¹æ³•&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;è¿”å›ä¸€ä¸ªå®ç°äº† &lt;code&gt;Iterator&amp;lt;T&amp;gt;&lt;/code&gt;çš„å†…éƒ¨ç±»å¯¹è±¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è‡ªå®šä¹‰è¿­ä»£å™¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨è¿­ä»£å™¨å†…éƒ¨ç±»ä¸­å®ç° &lt;code&gt;hasNext()&lt;/code&gt;å’Œ &lt;code&gt;next()&lt;/code&gt;æ–¹æ³•ï¼Œå®šä¹‰éå†é€»è¾‘ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="-ä»£ç ç¤ºä¾‹"&gt;ğŸ“ ä»£ç ç¤ºä¾‹ï¼š
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;import java.util.Iterator;
import java.util.NoSuchElementException;
public class CustomContainer&amp;lt;T&amp;gt; implements Iterable&amp;lt;T&amp;gt; {
private T[] elements;
private int size;
public CustomContainer(T[] data) {
this.elements = data;
this.size = data.length;
}
@Override
public Iterator&amp;lt;T&amp;gt; iterator() {
return new CustomIterator();
}
// è‡ªå®šä¹‰è¿­ä»£å™¨
private class CustomIterator implements Iterator&amp;lt;T&amp;gt; {
private int currentIndex = 0;
@Override
public boolean hasNext() {
return currentIndex &amp;lt; size; // æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ 
}
@Override
public T next() {
if (!hasNext()) {
throw new NoSuchElementException();
}
return elements[currentIndex++]; // è¿”å›å½“å‰å…ƒç´ å¹¶åç§»æŒ‡é’ˆ
}
}
public static void main(String[] args) {
String[] items = {&amp;#34;Apple&amp;#34;, &amp;#34;Banana&amp;#34;, &amp;#34;Cherry&amp;#34;};
CustomContainer&amp;lt;String&amp;gt; container = new CustomContainer&amp;lt;&amp;gt;(items);
// æ”¯æŒforeachéå†
for (String item : container) {
System.out.println(item);
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ æ³¨æ„äº‹é¡¹ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿­ä»£å™¨ä¸æ•°æ®åˆ†ç¦»&lt;/strong&gt;ï¼šè¿­ä»£å™¨ä¸ç›´æ¥æŒæœ‰åŸé›†åˆæ•°æ®ï¼Œè€Œæ˜¯é€šè¿‡æŒ‡é’ˆè®¿é—®ï¼Œé¿å…æ•°æ®æš´éœ²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¯æŒæ³›å‹&lt;/strong&gt;ï¼šä½¿ç”¨æ³›å‹ï¼ˆå¦‚ &lt;code&gt;&amp;lt;T&amp;gt;&lt;/code&gt;ï¼‰å¢å¼ºç±»å‹å®‰å…¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ç»“æ„æ€§ä¿®æ”¹&lt;/strong&gt;ï¼šè‡ªå®šä¹‰è¿­ä»£å™¨è‹¥éœ€æ”¯æŒåˆ é™¤æ“ä½œï¼Œéœ€é¢å¤–å®ç° &lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•ï¼ˆéå¼ºåˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;foreach&lt;/code&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;ï¼šç¼–è¯‘å™¨æ ¹æ®å¯¹è±¡ç±»å‹ï¼ˆæ•°ç»„/é›†åˆï¼‰è½¬æ¢ä¸ºç´¢å¼•å¾ªç¯æˆ–è¿­ä»£å™¨æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå®šä¹‰ç±»æ”¯æŒ&lt;/strong&gt;ï¼šå®ç° &lt;code&gt;Iterable&lt;/code&gt;+ è‡ªå®šä¹‰ &lt;code&gt;Iterator&lt;/code&gt;ï¼Œé€šè¿‡ &lt;code&gt;hasNext()&lt;/code&gt;å’Œ &lt;code&gt;next()&lt;/code&gt;æ§åˆ¶éå†é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šç®€åŒ–åªè¯»éå†ä»£ç ï¼Œé¿å…åœ¨éœ€ä¿®æ”¹é›†åˆæˆ–è·å–ç´¢å¼•æ—¶ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="c-foreach"&gt;C++ foreach
&lt;/h2&gt;&lt;p&gt;åœ¨C++ä¸­ï¼Œå®ç°ç±»ä¼¼ &lt;code&gt;foreach&lt;/code&gt;çš„éå†åŠŸèƒ½ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;strong&gt;C++11å¼•å…¥çš„range-based forå¾ªç¯&lt;/strong&gt; å’Œ &lt;strong&gt;STLç®—æ³• &lt;code&gt;std::for_each&lt;/code&gt;&lt;/strong&gt;ã€‚ä»¥ä¸‹åˆ†åˆ«è¯´æ˜å®ç°åŸç†å’Œè‡ªå®šä¹‰ç±»æ”¯æŒæ–¹æ³•ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€range-based-forå¾ªç¯c11"&gt;âš™ï¸ ä¸€ã€Range-Based Forå¾ªç¯ï¼ˆC++11+ï¼‰
&lt;/h3&gt;&lt;h4 id="è¯­æ³•ä¸åŸç†"&gt;&lt;strong&gt;è¯­æ³•ä¸åŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;for (auto&amp;amp; element : container) {
// å¤„ç† element
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šç¼–è¯‘å™¨å°†å…¶è½¬æ¢ä¸ºåŸºäºè¿­ä»£å™¨çš„ä¼ ç»Ÿå¾ªç¯ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;auto begin = container.begin();
auto end = container.end();
for (; begin != end; ++begin) {
auto&amp;amp; element = *begin;
// å¤„ç† element
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é€‚ç”¨å¯¹è±¡&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…ç½®æ•°ç»„ï¼ˆå¦‚ &lt;code&gt;int arr[10]&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;STLå®¹å™¨ï¼ˆå¦‚ &lt;code&gt;vector&lt;/code&gt;ã€&lt;code&gt;list&lt;/code&gt;ã€&lt;code&gt;map&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰ç±»ï¼ˆéœ€å®ç° &lt;code&gt;begin()&lt;/code&gt;å’Œ &lt;code&gt;end()&lt;/code&gt;æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è‡ªå®šä¹‰ç±»æ”¯æŒ"&gt;&lt;strong&gt;è‡ªå®šä¹‰ç±»æ”¯æŒ&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;è‹¥è¦è®©è‡ªå®šä¹‰ç±»æ”¯æŒ range-based forï¼Œéœ€æä¾› &lt;code&gt;begin()&lt;/code&gt;å’Œ &lt;code&gt;end()&lt;/code&gt;æ–¹æ³•ï¼Œè¿”å›è¿­ä»£å™¨ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class MyContainer {
public:
int* data;
size_t size;
// å¿…é¡»æä¾› begin() å’Œ end()
int* begin() { return data; }
int* end() { return data + size; }
};
// ä½¿ç”¨ç¤ºä¾‹
MyContainer c = { /* åˆå§‹åŒ– */ };
for (int&amp;amp; val : c) {
cout &amp;lt;&amp;lt; val &amp;lt;&amp;lt; endl;
}
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;å…³é”®&lt;/strong&gt;ï¼šè¿­ä»£å™¨ç±»å‹éœ€æ”¯æŒ &lt;code&gt;operator*&lt;/code&gt;ï¼ˆè§£å¼•ç”¨ï¼‰ã€&lt;code&gt;operator++&lt;/code&gt;ï¼ˆè‡ªå¢ï¼‰å’Œ &lt;code&gt;operator!=&lt;/code&gt;ï¼ˆä¸ç­‰æ¯”è¾ƒï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-äºŒstlç®—æ³•-stdfor_each"&gt;ğŸ”§ äºŒã€STLç®—æ³• &lt;code&gt;std::for_each&lt;/code&gt;
&lt;/h3&gt;&lt;h4 id="å‡½æ•°åŸå‹ä¸åŸç†"&gt;&lt;strong&gt;å‡½æ•°åŸå‹ä¸åŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;#include &amp;lt;algorithm&amp;gt;
std::for_each(begin_iter, end_iter, func);
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šéå† &lt;code&gt;[begin_iter, end_iter)&lt;/code&gt;åŒºé—´ï¼Œå¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨ &lt;code&gt;func&lt;/code&gt;ï¼ˆå‡½æ•°/å‡½æ•°å¯¹è±¡/Lambdaï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒå®ç°&lt;/strong&gt;ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;template &amp;lt;typename Iter, typename Func&amp;gt;
Func for_each(Iter begin, Iter end, Func f) {
while (begin != end) {
f(*begin); // åº”ç”¨å‡½æ•°å¯¹è±¡
++begin;
}
return f;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è‡ªå®šä¹‰å¤„ç†é€»è¾‘"&gt;&lt;strong&gt;è‡ªå®šä¹‰å¤„ç†é€»è¾‘&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æ”¯æŒä¸‰ç§è°ƒç”¨æ–¹å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ™®é€šå‡½æ•°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;void print(int x) { cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &amp;#34; &amp;#34;; }
std::for_each(vec.begin(), vec.end(), print);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å‡½æ•°å¯¹è±¡ï¼ˆä»¿å‡½æ•°ï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;struct Printer {
void operator()(int x) { cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &amp;#34; &amp;#34;; }
};
std::for_each(vec.begin(), vec.end(), Printer());
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Lambdaè¡¨è¾¾å¼&lt;/strong&gt;ï¼ˆæ¨èï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;std::for_each(vec.begin(), vec.end(), [](int x) {
cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &amp;#34; &amp;#34;;
});
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ Lambda å¯æ•è·å¤–éƒ¨å˜é‡ï¼ˆå¦‚ &lt;code&gt;[&amp;amp;]&lt;/code&gt;æ•è·å¼•ç”¨ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="ä¿®æ”¹å®¹å™¨å…ƒç´ "&gt;&lt;strong&gt;ä¿®æ”¹å®¹å™¨å…ƒç´ &lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;é€šè¿‡å¼•ç”¨å‚æ•°ä¿®æ”¹å…ƒç´ ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;std::for_each(vec.begin(), vec.end(), [](int&amp;amp; x) {
x *= 2; // ä¿®æ”¹å…ƒç´ 
});
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-ä¸‰ä¸¤ç§æ–¹å¼å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯"&gt;ğŸ”„ ä¸‰ã€ä¸¤ç§æ–¹å¼å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Range-Based For&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;std::for_each&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯­æ³•ç®€æ´åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­ï¸â­ï¸â­ï¸ï¼ˆæ›´ç›´è§‚ï¼‰&lt;/td&gt;
&lt;td&gt;â­ï¸â­ï¸ï¼ˆéœ€æ˜¾å¼è¿­ä»£å™¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ”¯æŒè‡ªå®šä¹‰ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆéœ€å®ç° &lt;code&gt;begin()/end()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆä¾èµ–è¿­ä»£å™¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤æ‚æ“ä½œæ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨å†™å¾ªç¯ä½“&lt;/td&gt;
&lt;td&gt;â­ï¸â­ï¸â­ï¸ï¼ˆç›´æ¥ä¼ å…¥å‡½æ•°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶è¡ŒåŒ–æ½œåŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆå¯ä¸ &lt;code&gt;std::execution&lt;/code&gt;ç»“åˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;C++ç‰ˆæœ¬è¦æ±‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;C++11+&lt;/td&gt;
&lt;td&gt;C++98+&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å››å®é™…åº”ç”¨ç¤ºä¾‹"&gt;ğŸ› ï¸ å››ã€å®é™…åº”ç”¨ç¤ºä¾‹
&lt;/h3&gt;&lt;h4 id="åœºæ™¯1éå†è‡ªå®šä¹‰å®¹å™¨"&gt;&lt;strong&gt;åœºæ™¯1ï¼šéå†è‡ªå®šä¹‰å®¹å™¨&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;class MyData {
std::vector&amp;lt;int&amp;gt; data;
public:
auto begin() { return data.begin(); }
auto end() { return data.end(); }
};
MyData container;
for (auto&amp;amp; x : container) { // ç›´æ¥éå†
cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl;
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="åœºæ™¯2ä½¿ç”¨lambdaç»Ÿè®¡å…ƒç´ "&gt;&lt;strong&gt;åœºæ™¯2ï¼šä½¿ç”¨Lambdaç»Ÿè®¡å…ƒç´ &lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;std::vector&amp;lt;int&amp;gt; nums = {1, 2, 3, 4};
int sum = 0;
std::for_each(nums.begin(), nums.end(), [&amp;amp;sum](int x) {
sum += x; // æ•è·å¤–éƒ¨å˜é‡ç´¯åŠ 
});
cout &amp;lt;&amp;lt; &amp;#34;Sum: &amp;#34; &amp;lt;&amp;lt; sum; // è¾“å‡º 10
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Range-Based For&lt;/strong&gt;ï¼šé¦–é€‰æ–¹æ¡ˆï¼Œè¯­æ³•ç®€æ´ï¼Œé€‚åˆå¤§å¤šæ•°éå†åœºæ™¯ï¼ˆéœ€C++11+ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;std::for_each&lt;/code&gt;&lt;/strong&gt;ï¼šçµæ´»æ€§å¼ºï¼Œæ”¯æŒå¤æ‚æ“ä½œï¼ˆå¦‚ä¿®æ”¹å…ƒç´ ã€çŠ¶æ€æ•è·ï¼‰ï¼Œå…¼å®¹æ—§æ ‡å‡†ï¼ˆC++98+ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå®šä¹‰ç±»æ”¯æŒ&lt;/strong&gt;ï¼šå®ç° &lt;code&gt;begin()&lt;/code&gt;/&lt;code&gt;end()&lt;/code&gt;æˆ–æä¾›è¿­ä»£å™¨å³å¯å…¼å®¹ä¸¤ç§æ–¹å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="c-virtual"&gt;c++ virtual
&lt;/h2&gt;&lt;p&gt;C++ ä¸­çš„è™šå‡½æ•°ï¼ˆ&lt;code&gt;virtual&lt;/code&gt;functionï¼‰æ˜¯&lt;strong&gt;å®ç°è¿è¡Œæ—¶å¤šæ€ï¼ˆåŠ¨æ€ç»‘å®šï¼‰çš„æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;ï¼Œå…¶ä½œç”¨ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€æ ¸å¿ƒä½œç”¨"&gt;âš™ï¸ &lt;strong&gt;ä¸€ã€æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®ç°è¿è¡Œæ—¶å¤šæ€ï¼ˆåŠ¨æ€ç»‘å®šï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šé€šè¿‡åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œå®é™…æ‰§è¡Œçš„æ˜¯&lt;strong&gt;å¯¹è±¡å®é™…ç±»å‹&lt;/strong&gt;ï¼ˆæ´¾ç”Ÿç±»ï¼‰çš„é‡å†™ç‰ˆæœ¬ï¼Œè€ŒéæŒ‡é’ˆ/å¼•ç”¨çš„é™æ€ç±»å‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Animal {
public:
virtual void speak() { cout &amp;lt;&amp;lt; &amp;#34;Animal sound&amp;#34; &amp;lt;&amp;lt; endl; } // è™šå‡½æ•°
};
class Cat : public Animal {
public:
void speak() override { cout &amp;lt;&amp;lt; &amp;#34;Meow&amp;#34; &amp;lt;&amp;lt; endl; } // é‡å†™è™šå‡½æ•°
};
// è°ƒç”¨
Animal* obj = new Cat();
obj-&amp;gt;speak(); // è¾“å‡º &amp;#34;Meow&amp;#34;ï¼ˆåŠ¨æ€ç»‘å®šåˆ°Cat::speakï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®šä¹‰æ¥å£è§„èŒƒä¸æŠ½è±¡ç±»&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çº¯è™šå‡½æ•°&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;virtual void func() = 0;&lt;/code&gt;å£°æ˜çº¯è™šå‡½æ•°ï¼Œä½¿ç±»æˆä¸º&lt;strong&gt;æŠ½è±¡ç±»&lt;/strong&gt;ï¼ˆæ— æ³•å®ä¾‹åŒ–ï¼‰ï¼Œå¼ºåˆ¶æ´¾ç”Ÿç±»å®ç°æ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè®¾è®¡æ¨¡å¼ï¼ˆå¦‚å·¥å‚æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ï¼‰ä¸­çš„é€šç”¨æ¥å£å®šä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æå‡ä»£ç å¯æ‰©å±•æ€§ä¸å¯ç»´æŠ¤æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–°å¢æ´¾ç”Ÿç±»æ— éœ€ä¿®æ”¹åŸºç±»&lt;/strong&gt;ï¼šåªéœ€é‡å†™è™šå‡½æ•°ï¼Œå³å¯é€šè¿‡åŸºç±»æŒ‡é’ˆç»Ÿä¸€è°ƒç”¨æ–°åŠŸèƒ½ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ï¼ˆOCPï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦åˆ&lt;/strong&gt;ï¼šåŸºç±»ä»£ç ä¸ä¾èµ–æ´¾ç”Ÿç±»ç»†èŠ‚ï¼Œé™ä½æ¨¡å—é—´ä¾èµ–æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-äºŒå…³é”®ç‰¹æ€§ä¸åŸç†"&gt;âš¡ï¸ &lt;strong&gt;äºŒã€å…³é”®ç‰¹æ€§ä¸åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è™šå‡½æ•°è¡¨ï¼ˆvtableï¼‰æœºåˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;vtable&lt;/strong&gt;ï¼šæ¯ä¸ªå«è™šå‡½æ•°çš„ç±»æœ‰ä¸€ä¸ªè™šå‡½æ•°è¡¨ï¼Œå­˜å‚¨è¯¥ç±»æ‰€æœ‰è™šå‡½æ•°çš„åœ°å€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;vptr&lt;/strong&gt;ï¼šæ¯ä¸ªå¯¹è±¡å†…å«ä¸€ä¸ªæŒ‡å‘ vtable çš„æŒ‡é’ˆï¼ˆvptrï¼‰ï¼Œè°ƒç”¨è™šå‡½æ•°æ—¶é€šè¿‡ vptr æŸ¥è¡¨è·³è½¬ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŠ¨æ€ç»‘å®šæµç¨‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[åŸºç±»æŒ‡é’ˆè°ƒç”¨è™šå‡½æ•°] --&amp;gt; B[é€šè¿‡vptræ‰¾åˆ°vtable]
B --&amp;gt; C[æ ¹æ®åç§»é‡å®šä½å‡½æ•°åœ°å€]
C --&amp;gt; D[æ‰§è¡Œå®é™…ç±»å‹çš„å‡½æ•°]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è™šææ„å‡½æ•°çš„å¿…è¦æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šè‹¥åŸºç±»ææ„å‡½æ•°éè™šï¼Œé€šè¿‡åŸºç±»æŒ‡é’ˆåˆ é™¤æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œ&lt;strong&gt;ä»…è°ƒç”¨åŸºç±»ææ„å‡½æ•°&lt;/strong&gt;ï¼Œå¯¼è‡´æ´¾ç”Ÿç±»èµ„æºæ³„æ¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Base {
public:
virtual ~Base() {} // è™šææ„å‡½æ•°
};
class Derived : public Base { /* ... */ };
Base* obj = new Derived();
delete obj; // æ­£ç¡®è°ƒç”¨Derivedå’ŒBaseçš„ææ„å‡½æ•°
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åå˜è¿”å›ç±»å‹ï¼ˆC++ç‰¹ä¾‹ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è§„åˆ™&lt;/strong&gt;ï¼šæ´¾ç”Ÿç±»é‡å†™è™šå‡½æ•°æ—¶ï¼Œè¿”å›å€¼å¯ä»¥æ˜¯åŸºç±»è¿”å›ç±»å‹çš„&lt;strong&gt;æ´¾ç”Ÿç±»æŒ‡é’ˆ/å¼•ç”¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Base { virtual Base* clone(); };
class Derived : public Base {
Derived* clone() override; // åˆæ³•åå˜
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰ä½¿ç”¨æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ä¸‰ã€ä½¿ç”¨æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—´æ¥è°ƒç”¨&lt;/strong&gt;ï¼šè™šå‡½æ•°éœ€æŸ¥è¡¨è·³è½¬ï¼Œæ¯”æ™®é€šå‡½æ•°å¤šä¸€æ¬¡å¯»å€ï¼ˆç°ä»£ CPU å·²ä¼˜åŒ–ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;ï¼šæ¯ä¸ªå¯¹è±¡å¢åŠ ä¸€ä¸ª vptr æŒ‡é’ˆï¼Œæ¯ä¸ªç±»éœ€å­˜å‚¨ vtableã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•é™åˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ„é€ å‡½æ•°ä¸èƒ½ä¸ºè™šå‡½æ•°&lt;/strong&gt;ï¼šå¯¹è±¡æ„é€ æ—¶ vptr æœªåˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é»˜è®¤å‚æ•°é™æ€ç»‘å®š&lt;/strong&gt;ï¼šè™šå‡½æ•°çš„é»˜è®¤å‚æ•°å€¼åœ¨ç¼–è¯‘æ—¶æ ¹æ®&lt;strong&gt;æŒ‡é’ˆç±»å‹&lt;/strong&gt;ç¡®å®šï¼Œè€Œéå®é™…å¯¹è±¡ç±»å‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Base { virtual void foo(int x = 10); };
class Derived : public Base { void foo(int x = 20) override; };
Base* obj = new Derived();
obj-&amp;gt;foo(); // å®é™…è°ƒç”¨ Derived::foo(10) è€Œé foo(20)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;C++11 å¢å¼ºå…³é”®å­—&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;override&lt;/code&gt;&lt;/strong&gt;ï¼šæ˜¾å¼æ ‡è®°é‡å†™ï¼Œè‹¥ç­¾åä¸åŒ¹é…åˆ™ç¼–è¯‘æŠ¥é”™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;final&lt;/code&gt;&lt;/strong&gt;ï¼šç¦æ­¢æ´¾ç”Ÿç±»é‡å†™è™šå‡½æ•°æˆ–ç¦æ­¢ç±»è¢«ç»§æ‰¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å››æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;å››ã€æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šè™šå‡½æ•°æ˜¯ C++ å®ç°&lt;strong&gt;è¿è¡Œæ—¶å¤šæ€&lt;/strong&gt;çš„åŸºçŸ³ï¼Œé€šè¿‡åŠ¨æ€ç»‘å®šæ”¯æŒ&lt;strong&gt;ç»Ÿä¸€æ¥å£ã€å¤šç§è¡Œä¸º&lt;/strong&gt;çš„è®¾è®¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åŸºç±»ææ„å‡½æ•°&lt;strong&gt;å¿…é¡»å£°æ˜ä¸ºè™šå‡½æ•°&lt;/strong&gt;ï¼ˆè‹¥å¯èƒ½è¢«ç»§æ‰¿ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¥å£ç±»ä½¿ç”¨&lt;strong&gt;çº¯è™šå‡½æ•°&lt;/strong&gt;å¼ºåˆ¶å®ç°è§„èŒƒã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨ &lt;strong&gt;&lt;code&gt;override&lt;/code&gt;å’Œ &lt;code&gt;final&lt;/code&gt;&lt;/strong&gt; å¢å¼ºä»£ç å®‰å…¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="c-virtual--java-abstract"&gt;c++ virtual &amp;amp; Java abstract
&lt;/h2&gt;&lt;p&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯C++ &lt;code&gt;virtual&lt;/code&gt;ä¸ Java &lt;code&gt;abstract&lt;/code&gt;çš„å¯¹æ¯”åˆ†æï¼Œæ¶µç›–æ ¸å¿ƒå·®å¼‚ã€å®ç°æœºåˆ¶åŠè®¾è®¡å“²å­¦ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-1-æ ¸å¿ƒæ¦‚å¿µä¸è¯­æ³•"&gt;ğŸ” &lt;strong&gt;1. æ ¸å¿ƒæ¦‚å¿µä¸è¯­æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;C++ &lt;code&gt;virtual&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Java &lt;code&gt;abstract&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®šä¹‰æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¾å¼å£°æ˜ï¼š&lt;code&gt;virtual void func();&lt;/code&gt;ï¼ˆè™šå‡½æ•°ï¼‰æˆ– &lt;code&gt;virtual void func() = 0;&lt;/code&gt;ï¼ˆçº¯è™šå‡½æ•°ï¼‰&lt;/td&gt;
&lt;td&gt;éšå¼/æ˜¾å¼ï¼šæ™®é€šæ–¹æ³•é»˜è®¤æ”¯æŒå¤šæ€ï¼›æŠ½è±¡æ–¹æ³•éœ€ &lt;code&gt;abstract void func();&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é»˜è®¤è¡Œä¸º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éè™šå‡½æ•°é™æ€ç»‘å®šï¼ˆæ ¹æ®æŒ‡é’ˆç±»å‹ï¼‰ï¼Œè™šå‡½æ•°åŠ¨æ€ç»‘å®šï¼ˆæ ¹æ®å¯¹è±¡ç±»å‹ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ‰€æœ‰æ™®é€šæ–¹æ³•é»˜è®¤åŠ¨æ€ç»‘å®š&lt;/strong&gt;ï¼ˆæ ¹æ®å¯¹è±¡ç±»å‹ï¼‰ï¼Œç±»ä¼¼C++è™šå‡½æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŠ½è±¡æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çº¯è™šå‡½æ•°ï¼ˆ&lt;code&gt;=0&lt;/code&gt;ï¼‰å¼ºåˆ¶å­ç±»å®ç°ï¼Œå«çº¯è™šå‡½æ•°çš„ç±»ä¸ºæŠ½è±¡ç±»&lt;/td&gt;
&lt;td&gt;æŠ½è±¡æ–¹æ³•ï¼ˆ&lt;code&gt;abstract&lt;/code&gt;ï¼‰å¼ºåˆ¶å­ç±»å®ç°ï¼Œå«æŠ½è±¡æ–¹æ³•çš„ç±»ä¸ºæŠ½è±¡ç±»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»å®ä¾‹åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å«çº¯è™šå‡½æ•°çš„ç±»ä¸å¯å®ä¾‹åŒ–ï¼›æ™®é€šè™šå‡½æ•°ç±»å¯å®ä¾‹åŒ–&lt;/td&gt;
&lt;td&gt;æŠ½è±¡ç±»ä¸å¯å®ä¾‹åŒ–ï¼ˆæ— è®ºæ˜¯å¦å«æŠ½è±¡æ–¹æ³•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-2-å¤šæ€å®ç°æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;2. å¤šæ€å®ç°æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;C++ è™šå‡½æ•°è¡¨ï¼ˆvtableï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ¯ä¸ªå«è™šå‡½æ•°çš„ç±»æœ‰ç‹¬ç«‹çš„è™šå‡½æ•°è¡¨ï¼Œå¯¹è±¡é€šè¿‡è™šæŒ‡é’ˆï¼ˆvptrï¼‰è®¿é—®è¯¥è¡¨ï¼Œå®ç°åŠ¨æ€ç»‘å®šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Base {
public:
virtual void show() { cout &amp;lt;&amp;lt; &amp;#34;Base&amp;#34;; } // è™šå‡½æ•°
};
class Derived : public Base {
public:
void show() override { cout &amp;lt;&amp;lt; &amp;#34;Derived&amp;#34;; } // é‡å†™
};
Base* obj = new Derived();
obj-&amp;gt;show(); // è¾“å‡º &amp;#34;Derived&amp;#34;ï¼ˆåŠ¨æ€ç»‘å®šï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java æ–¹æ³•è¡¨&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;JVM ä¸ºæ¯ä¸ªç±»ç»´æŠ¤æ–¹æ³•è¡¨ï¼Œæ‰€æœ‰æ–¹æ³•è°ƒç”¨é»˜è®¤åŠ¨æ€ç»‘å®šï¼ˆç±»ä¼¼C++è™šå‡½æ•°ï¼‰ï¼Œæ— éœ€æ˜¾å¼å£°æ˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¦æ­¢é‡å†™&lt;/strong&gt;ï¼šç”¨ &lt;code&gt;final&lt;/code&gt;ä¿®é¥°æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;public final void func()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-3-æŠ½è±¡ç±»ä¸æ¥å£è®¾è®¡"&gt;ğŸ§© &lt;strong&gt;3. æŠ½è±¡ç±»ä¸æ¥å£è®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;C++&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Java&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŠ½è±¡ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å«çº¯è™šå‡½æ•°çš„ç±»ç§°ä¸ºæŠ½è±¡ç±»ï¼Œå¯åŒ…å«æ•°æ®æˆå‘˜å’Œéè™šæ–¹æ³•ã€‚&lt;/td&gt;
&lt;td&gt;ç”¨ &lt;code&gt;abstract class&lt;/code&gt;å®šä¹‰ï¼Œå¯å«å­—æ®µã€å…·ä½“æ–¹æ³•å’ŒæŠ½è±¡æ–¹æ³•ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¥å£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— åŸç”Ÿæ¥å£ï¼Œç”¨&lt;strong&gt;çº¯è™šç±»&lt;/strong&gt;ï¼ˆå…¨çº¯è™šå‡½æ•°ï¼‰æ¨¡æ‹Ÿæ¥å£ã€‚&lt;/td&gt;
&lt;td&gt;åŸç”Ÿ &lt;code&gt;interface&lt;/code&gt;ï¼Œæ”¯æŒå¤šç»§æ‰¿ï¼ˆå¦‚ &lt;code&gt;class A implements B, C&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šé‡ç»§æ‰¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒç±»å¤šé‡ç»§æ‰¿ï¼ˆå¯èƒ½è±å½¢é—®é¢˜ï¼‰ï¼Œè™šåŸºç±»è§£å†³äºŒä¹‰æ€§ã€‚&lt;/td&gt;
&lt;td&gt;ç±»å•ç»§æ‰¿ï¼Œæ¥å£å¤šç»§æ‰¿è§„é¿å¤æ‚æ€§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-4-å…³é”®æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;4. å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ææ„å‡½æ•°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;C++ï¼š&lt;strong&gt;åŸºç±»ææ„å‡½æ•°å¿…é¡»ä¸ºè™šå‡½æ•°&lt;/strong&gt;ï¼Œå¦åˆ™å­ç±»å¯¹è±¡é€šè¿‡åŸºç±»æŒ‡é’ˆåˆ é™¤æ—¶èµ„æºæ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;Javaï¼šæ— ææ„å‡½æ•°ï¼Œä¾èµ–åƒåœ¾å›æ”¶ï¼ˆGCï¼‰ï¼›&lt;code&gt;finalize()&lt;/code&gt;æ–¹æ³•å·²å¼ƒç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„é€ /ææ„ä¸­è°ƒç”¨è™šå‡½æ•°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;C++ï¼šæ„é€ å‡½æ•°å†…è°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œå¯¹è±¡æœªå®Œå…¨æ„é€ ï¼ŒåŠ¨æ€ç»‘å®šå¤±æ•ˆï¼ˆé™æ€ç»‘å®šåˆ°å½“å‰ç±»ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Javaï¼šæ„é€ æ–¹æ³•ä¸­è°ƒç”¨è™šå‡½æ•°å¯æ­£å¸¸åŠ¨æ€ç»‘å®šï¼ˆä½†å¯èƒ½è®¿é—®æœªåˆå§‹åŒ–å­—æ®µï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“è®¾è®¡å“²å­¦å·®å¼‚"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šè®¾è®¡å“²å­¦å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;C++&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é›¶å¼€é”€æŠ½è±¡&lt;/strong&gt;ï¼šè™šå‡½æ•°è¡¨å¸¦æ¥é¢å¤–å¼€é”€ï¼ˆvptrå†…å­˜+é—´æ¥è°ƒç”¨ï¼‰ï¼Œéè™šå‡½æ•°é«˜æ•ˆé™æ€ç»‘å®šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜¾å¼æ§åˆ¶&lt;/strong&gt;ï¼šå¼€å‘è€…éœ€ä¸»åŠ¨å£°æ˜è™šå‡½æ•°ï¼Œç²¾ç»†ç®¡ç†æ€§èƒ½ä¸å¤šæ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Java&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼€å‘æ•ˆç‡ä¼˜å…ˆ&lt;/strong&gt;ï¼šé»˜è®¤åŠ¨æ€ç»‘å®šç®€åŒ–ä»£ç ï¼Œç‰ºç‰²éƒ¨åˆ†æ€§èƒ½ï¼ˆJVMä¼˜åŒ–å¯ç¼“è§£ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£é©±åŠ¨&lt;/strong&gt;ï¼šé€šè¿‡æ¥å£å®ç°å¤šæ€ä¸è§£è€¦ï¼Œå¼¥è¡¥å•ç»§æ‰¿é™åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;é€‰æ‹©å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€é«˜æ€§èƒ½ã€ç²¾ç»†æ§åˆ¶å†…å­˜/è°ƒç”¨ â†’ &lt;strong&gt;C++è™šå‡½æ•°&lt;/strong&gt;ï¼ˆæ˜¾å¼å£°æ˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¿«é€Ÿå¼€å‘ã€é«˜å¯æ‰©å±•æ€§ â†’ &lt;strong&gt;JavaæŠ½è±¡ç±»/æ¥å£&lt;/strong&gt;ï¼ˆé»˜è®¤åŠ¨æ€ç»‘å®š + æ¥å£å¤šç»§æ‰¿ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="volitile"&gt;volitile
&lt;/h2&gt;&lt;p&gt;C++ å’Œ Java ä¸­çš„ &lt;code&gt;volatile&lt;/code&gt;å…³é”®å­—è™½ç„¶åç§°ç›¸åŒï¼Œä½†å…¶è®¾è®¡ç›®æ ‡ã€è¯­ä¹‰ä¿éšœå’Œåº”ç”¨åœºæ™¯å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯äºŒè€…çš„æ ¸å¿ƒå¼‚åŒç‚¹æ€»ç»“åŠè¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå·®å¼‚å¯¹æ¯”è¡¨"&gt;ğŸ“Š &lt;strong&gt;æ ¸å¿ƒå·®å¼‚å¯¹æ¯”è¡¨&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;C++ &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Java &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒç›®çš„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¦æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œç¡®ä¿å†…å­˜è®¿é—®ç›´æ¥æ€§&lt;/td&gt;
&lt;td&gt;æä¾›è½»é‡çº§çº¿ç¨‹åŒæ­¥ï¼Œè§£å†³å¯è§æ€§ä¸æœ‰åºæ€§é—®é¢˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯è§æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…å¼ºåˆ¶ä»å†…å­˜è¯»å–æœ€æ–°å€¼ï¼ˆæ— å¤šçº¿ç¨‹åŒæ­¥ä¿è¯ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… å¼ºåˆ¶åˆ·æ–°ä¸»å†…å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç«‹å³å¯è§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸ç¦æ­¢æŒ‡ä»¤é‡æ’&lt;/td&gt;
&lt;td&gt;âœ… é€šè¿‡å†…å­˜å±éšœç¦æ­¢æŒ‡ä»¤é‡æ’åº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸ä¿è¯ï¼ˆå¤åˆæ“ä½œéåŸå­ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ å•æ¬¡è¯»å†™åŸå­ï¼Œå¤åˆæ“ä½œï¼ˆå¦‚ &lt;code&gt;i++&lt;/code&gt;ï¼‰éåŸå­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¡¬ä»¶å¯„å­˜å™¨ã€ä¸­æ–­å¤„ç†ã€åµŒå…¥å¼ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;å¤šçº¿ç¨‹çŠ¶æ€æ ‡å¿—ã€åŒé‡æ£€æŸ¥é”ç­‰åŒæ­¥åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å±éšœ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ éœ€æ‰‹åŠ¨æ’å…¥ï¼ˆå¦‚ &lt;code&gt;asm volatile&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… è‡ªåŠ¨æ’å…¥ï¼ˆLoadLoad/LoadStore/StoreStore/StoreLoadï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šçº¿ç¨‹åŒæ­¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— æ³•æ›¿ä»£é”æˆ–åŸå­æ“ä½œ&lt;/td&gt;
&lt;td&gt;âœ… å¯å»ºç«‹ happens-before å…³ç³»ï¼Œå®ç°éƒ¨åˆ†åŒæ­¥&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€æ ¸å¿ƒè¯­ä¹‰å·®å¼‚"&gt;ğŸ§  &lt;strong&gt;ä¸€ã€æ ¸å¿ƒè¯­ä¹‰å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;C++ &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;ï¼šä»…ä½œä¸ºç¼–è¯‘å™¨ä¼˜åŒ–ç¦ä»¤ï¼Œç¡®ä¿æ¯æ¬¡è®¿é—®å˜é‡æ—¶éƒ½ä»å†…å­˜åœ°å€è¯»å–æœ€æ–°å€¼ï¼Œè€Œéä½¿ç”¨å¯„å­˜å™¨ç¼“å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸çº¦æŸ CPU æŒ‡ä»¤é‡æ’æˆ–ç¼“å­˜ä¸€è‡´æ€§ï¼Œ&lt;strong&gt;æ— æ³•è§£å†³å¤šçº¿ç¨‹å¯è§æ€§åŠæœ‰åºæ€§é—®é¢˜&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚ï¼šå¤šçº¿ç¨‹å…±äº«å˜é‡æ—¶ï¼Œå³ä½¿ä½¿ç”¨ &lt;code&gt;volatile&lt;/code&gt;ï¼Œçº¿ç¨‹ A çš„ä¿®æ”¹ä»å¯èƒ½å›  CPU ç¼“å­˜æœªåŒæ­¥è€Œå¯¹çº¿ç¨‹ B ä¸å¯è§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Java &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;ï¼šæ˜¯ Java å†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰å®šä¹‰çš„åŒæ­¥æœºåˆ¶ï¼Œæä¾›ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯è§æ€§&lt;/strong&gt;ï¼šå†™æ“ä½œç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼Œè¯»æ“ä½œå¼ºåˆ¶ä»ä¸»å†…å­˜åŠ è½½æœ€æ–°å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;ï¼šé€šè¿‡å†…å­˜å±éšœç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼Œç¡®ä¿æ“ä½œé¡ºåºç¬¦åˆç¨‹åºé€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢å¤–ä¿éšœ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å»ºç«‹ &lt;strong&gt;happens-before å…³ç³»&lt;/strong&gt;ï¼ˆå¦‚å†™æ“ä½œå…ˆäºåç»­è¯»æ“ä½œï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-äºŒå®ç°æœºåˆ¶å¯¹æ¯”"&gt;âš™ï¸ &lt;strong&gt;äºŒã€å®ç°æœºåˆ¶å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;C++&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¼–è¯‘å™¨ç”Ÿæˆç›´æ¥å†…å­˜è®¿é—®æŒ‡ä»¤ï¼ˆå¦‚ &lt;code&gt;mov&lt;/code&gt;è€Œéå¯„å­˜å™¨ç¼“å­˜ï¼‰ï¼Œ&lt;strong&gt;æ— è‡ªåŠ¨å†…å­˜å±éšœ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;éœ€æ‰‹åŠ¨æ’å…¥å±éšœï¼ˆå¦‚ &lt;code&gt;asm volatile(&amp;quot;&amp;quot; ::: &amp;quot;memory&amp;quot;)&lt;/code&gt;ï¼‰æˆ–ä¾èµ–å¹³å°ç‰¹å®šæŒ‡ä»¤ï¼ˆå¦‚ &lt;code&gt;_mm_sfence&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;JVM è‡ªåŠ¨æ’å…¥å†…å­˜å±éšœï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å±éšœç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;volatile å†™&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;StoreStore + StoreLoad&lt;/td&gt;
&lt;td&gt;ç¡®ä¿å†™å‰æ“ä½œå®Œæˆï¼Œå†™åæ“ä½œä¸é‡æ’è‡³å†™å‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;volatile è¯»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;LoadLoad + LoadStore&lt;/td&gt;
&lt;td&gt;ç¡®ä¿è¯»åæ“ä½œä¸é‡æ’è‡³è¯»å‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åº•å±‚ä¾èµ– CPU ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼ˆå¦‚ MESIï¼‰ï¼Œé€šè¿‡ &lt;code&gt;lock&lt;/code&gt;æŒ‡ä»¤å¼ºåˆ¶ç¼“å­˜å¤±æ•ˆã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ› ï¸ &lt;strong&gt;ä¸‰ã€å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;C++ é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¡¬ä»¶å¯„å­˜å™¨è®¿é—®&lt;/strong&gt;ï¼šç¡®ä¿è¯»å–å®æ—¶å˜åŒ–çš„ç¡¬ä»¶çŠ¶æ€ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;volatile uint32_t* reg = (volatile uint32_t*)0x40000000;
while (*reg &amp;amp; 0x01) { /* ç­‰å¾…ç¡¬ä»¶ä¿¡å· */ } // å¿…é¡»ç”¨ volatile
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸­æ–­å¤„ç†&lt;/strong&gt;ï¼šå…±äº«å˜é‡åœ¨ ISRï¼ˆä¸­æ–­æœåŠ¡ç¨‹åºï¼‰ä¸ä¸»ç¨‹åºé—´åŒæ­¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¦ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–&lt;/strong&gt;ï¼šå¦‚ç©ºå¾ªç¯å»¶è¿Ÿï¼ˆé¿å…è¢«åˆ é™¤ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;çŠ¶æ€æ ‡å¿—ä½&lt;/strong&gt;ï¼šè½»é‡çº§æ§åˆ¶çº¿ç¨‹å¯åœã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;private volatile boolean running = true;
public void stop() { running = false; } // ç«‹å³å¯è§
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŒé‡æ£€æŸ¥é”ï¼ˆDCLï¼‰&lt;/strong&gt;ï¼šé˜²æ­¢æŒ‡ä»¤é‡æ’å¯¼è‡´æœªåˆå§‹åŒ–å¯¹è±¡è¢«è¯»å–ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;private volatile static Singleton instance;
public static Singleton getInstance() {
if (instance == null) {
synchronized (Singleton.class) {
if (instance == null) {
instance = new Singleton(); // volatile ç¦æ­¢é‡æ’åº
}
}
}
return instance;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å››å¸¸è§è¯¯åŒºä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;âš ï¸ &lt;strong&gt;å››ã€å¸¸è§è¯¯åŒºä¸æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;C++ å¤šçº¿ç¨‹åŒæ­¥è¯¯åŒº&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;volatile&lt;/code&gt;&lt;strong&gt;ä¸èƒ½æ›¿ä»£é”æˆ–åŸå­æ“ä½œ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å¦‚ &lt;code&gt;volatile int counter++&lt;/code&gt;ä»å­˜åœ¨ç«æ€æ¡ä»¶ï¼Œéœ€ç”¨ &lt;code&gt;std::atomic&amp;lt;int&amp;gt;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;C++11 å¼•å…¥çš„ &lt;code&gt;std::atomic&lt;/code&gt;æä¾›åŸå­æ€§ä¸å†…å­˜åºæ§åˆ¶ï¼ˆå¦‚ &lt;code&gt;memory_order_relaxed&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Java åŸå­æ€§å±€é™&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;volatile&lt;/code&gt;æ— æ³•ä¿è¯å¤åˆæ“ä½œï¼ˆå¦‚ &lt;code&gt;i++&lt;/code&gt;ï¼‰åŸå­æ€§ï¼Œéœ€ç»“åˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;synchronized&lt;/code&gt;å—&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AtomicInteger&lt;/code&gt;ç­‰åŸå­ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;C++ &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;ï¼šä¸“æ³¨ç¡¬ä»¶äº¤äº’ä¸ç¼–è¯‘å™¨ä¼˜åŒ–æ§åˆ¶ï¼Œ&lt;strong&gt;éçº¿ç¨‹åŒæ­¥å·¥å…·&lt;/strong&gt;ã€‚åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­éœ€æ­é… &lt;code&gt;std::atomic&lt;/code&gt;æˆ–é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Java &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;ï¼šä¸“ä¸ºå¤šçº¿ç¨‹è®¾è®¡ï¼Œè§£å†³å¯è§æ€§ä¸æœ‰åºæ€§ï¼Œæ˜¯è½»é‡çº§åŒæ­¥æ–¹æ¡ˆï¼ˆä½†éä¸‡èƒ½ï¼‰ã€‚é€‚åˆçŠ¶æ€æ ‡å¿—ç­‰ç®€å•åŒæ­¥ï¼Œå¤æ‚æ“ä½œä»éœ€é”æˆ–åŸå­ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åµŒå…¥å¼/ç¡¬ä»¶å¼€å‘ â†’ &lt;strong&gt;C++ &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Java å¤šçº¿ç¨‹çŠ¶æ€åŒæ­¥ â†’ &lt;strong&gt;Java &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å¤åˆæ“ä½œåŸå­æ€§ â†’ &lt;strong&gt;&lt;code&gt;synchronized&lt;/code&gt;/&lt;code&gt;Atomic&lt;/code&gt;ç±»&lt;/strong&gt;ï¼ˆJavaï¼‰æˆ– &lt;strong&gt;&lt;code&gt;std::atomic&lt;/code&gt;&lt;/strong&gt;ï¼ˆC++ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="explicit"&gt;explicit
&lt;/h2&gt;&lt;p&gt;åœ¨C++ä¸­ï¼Œ&lt;code&gt;explicit&lt;/code&gt;å…³é”®å­—çš„æ ¸å¿ƒä½œç”¨æ˜¯&lt;strong&gt;ç¦æ­¢ç¼–è¯‘å™¨è¿›è¡Œéšå¼ç±»å‹è½¬æ¢&lt;/strong&gt;ï¼Œå¼ºåˆ¶è¦æ±‚ç±»å‹è½¬æ¢å¿…é¡»é€šè¿‡æ˜¾å¼æ–¹å¼å®Œæˆã€‚è¿™ä¸€ç‰¹æ€§ä¸»è¦ç”¨äºæ„é€ å‡½æ•°å’Œè½¬æ¢è¿ç®—ç¬¦ï¼ˆC++11èµ·ï¼‰ï¼Œä»¥æé«˜ä»£ç çš„å®‰å…¨æ€§å’Œå¯è¯»æ€§ã€‚ä»¥ä¸‹æ˜¯å…¶å…·ä½“ç”¨é€”å’Œç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€ç¦æ­¢æ„é€ å‡½æ•°çš„éšå¼è½¬æ¢"&gt;ğŸ”§ &lt;strong&gt;ä¸€ã€ç¦æ­¢æ„é€ å‡½æ•°çš„éšå¼è½¬æ¢&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é—®é¢˜èƒŒæ™¯"&gt;&lt;strong&gt;é—®é¢˜èƒŒæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å•å‚æ•°æ„é€ å‡½æ•°ï¼ˆæˆ–æ‰€æœ‰å‚æ•°æœ‰é»˜è®¤å€¼çš„å¤šå‚æ„é€ å‡½æ•°ï¼‰é»˜è®¤æ”¯æŒéšå¼è½¬æ¢ï¼Œå¯èƒ½å¯¼è‡´æ„æ–™ä¹‹å¤–çš„è¡Œä¸ºï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Widget {
public:
Widget(int size) { /* æ„é€ å®ç° */ } // éšå¼è½¬æ¢æ„é€ å‡½æ•°
};
void doSomething(Widget w) {}
int main() {
doSomething(10); // åˆæ³•ï¼ç¼–è¯‘å™¨éšå¼å°†intè½¬æ¢ä¸ºWidgetå¯¹è±¡
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ­¤å¤„&lt;code&gt;doSomething(10)&lt;/code&gt;è§¦å‘äº†&lt;code&gt;Widget(int)&lt;/code&gt;çš„éšå¼è°ƒç”¨ï¼Œå¯èƒ½å¼•å‘é€»è¾‘é”™è¯¯ï¼ˆä¾‹å¦‚å‚æ•°ç±»å‹ä¸åŒ¹é…ä½†æœªæŠ¥é”™ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id="è§£å†³æ–¹æ¡ˆ"&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆï¼š&lt;code&gt;explicit&lt;/code&gt;æ„é€ å‡½æ•°&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;class Widget {
public:
explicit Widget(int size) { /* æ„é€ å®ç° */ } // é˜»æ­¢éšå¼è½¬æ¢
};
void doSomething(Widget w) {}
int main() {
// doSomething(10); // é”™è¯¯ï¼šç¦æ­¢éšå¼è½¬æ¢
doSomething(Widget(10)); // æ­£ç¡®ï¼šæ˜¾å¼æ„é€ 
doSomething(static_cast&amp;lt;Widget&amp;gt;(10)); // æ­£ç¡®ï¼šæ˜¾å¼ç±»å‹è½¬æ¢
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆæœ&lt;/strong&gt;ï¼šå¼ºåˆ¶å¼€å‘è€…é€šè¿‡ç›´æ¥è°ƒç”¨æ„é€ å‡½æ•°æˆ–ç±»å‹è½¬æ¢æ¥åˆ›å»ºå¯¹è±¡ï¼Œé¿å…éšå¼è½¬æ¢çš„æ­§ä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-äºŒç¦æ­¢è½¬æ¢è¿ç®—ç¬¦çš„éšå¼è½¬æ¢c11èµ·"&gt;âš™ï¸ &lt;strong&gt;äºŒã€ç¦æ­¢è½¬æ¢è¿ç®—ç¬¦çš„éšå¼è½¬æ¢ï¼ˆC++11èµ·ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é—®é¢˜èƒŒæ™¯-1"&gt;&lt;strong&gt;é—®é¢˜èƒŒæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ç±»å®šä¹‰çš„ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼ˆå¦‚&lt;code&gt;operator bool()&lt;/code&gt;ï¼‰é»˜è®¤å…è®¸éšå¼è½¬æ¢ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Boolean {
public:
operator bool() const { return true; } // éšå¼è½¬æ¢ä¸ºbool
};
Boolean b;
if (b) { ... } // åˆæ³•
bool x = b; // åˆæ³•ï¼šéšå¼è½¬æ¢ï¼ˆå¯èƒ½éé¢„æœŸï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="è§£å†³æ–¹æ¡ˆ-1"&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆï¼š&lt;code&gt;explicit&lt;/code&gt;è½¬æ¢è¿ç®—ç¬¦&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;class Boolean {
public:
explicit operator bool() const { return true; } // æ˜¾å¼è½¬æ¢
};
Boolean b;
if (b) { ... } // åˆæ³•ï¼šæ¡ä»¶è¯­å¥ä¸­å…è®¸æ˜¾å¼è½¬æ¢
// bool x = b; // é”™è¯¯ï¼šç¦æ­¢éšå¼è½¬æ¢
bool y = static_cast&amp;lt;bool&amp;gt;(b); // æ­£ç¡®ï¼šæ˜¾å¼è½¬æ¢
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆæœ&lt;/strong&gt;ï¼šä»…åœ¨æ˜¾å¼è°ƒç”¨ï¼ˆå¦‚&lt;code&gt;if(b)&lt;/code&gt;æˆ–&lt;code&gt;static_cast&lt;/code&gt;ï¼‰æ—¶è§¦å‘è½¬æ¢ï¼Œé¿å…æ— æ„è¯†ç±»å‹è½¬æ¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ"&gt;ğŸ§© &lt;strong&gt;ä¸‰ã€é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¿…é¡»ä½¿ç”¨&lt;code&gt;explicit&lt;/code&gt;çš„åœºæ™¯&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;èµ„æºç®¡ç†ç±»&lt;/strong&gt;ï¼ˆå¦‚æ™ºèƒ½æŒ‡é’ˆã€è‡ªå®šä¹‰å­—ç¬¦ä¸²ï¼‰ï¼šé˜²æ­¢è¯¯ç”¨æ„é€ å‡½æ•°å¯¼è‡´èµ„æºæ³„æ¼ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;std::shared_ptr&amp;lt;int&amp;gt; p = new int; // é”™è¯¯ï¼šexplicitç¦æ­¢éšå¼è½¬æ¢
std::shared_ptr&amp;lt;int&amp;gt; p(new int); // æ­£ç¡®ï¼šæ˜¾å¼æ„é€ 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®¹å™¨ç±»&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;std::vector&lt;/code&gt;ï¼‰ï¼šé¿å…&lt;code&gt;vector&amp;lt;int&amp;gt; v = 5;&lt;/code&gt;è¢«è¯¯è§£ä¸ºåˆ›å»ºå«5ä¸ªå…ƒç´ çš„å®¹å™¨ï¼ˆå®é™…æ„å›¾å¯èƒ½æ˜¯åˆ›å»ºå«å•ä¸ªå…ƒç´ 5çš„å®¹å™¨ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¨èä½¿ç”¨&lt;code&gt;explicit&lt;/code&gt;çš„åœºæ™¯&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰å•å‚æ•°æ„é€ å‡½æ•°&lt;/strong&gt;ï¼ˆå«é»˜è®¤å‚æ•°çš„å¤šå‚æ„é€ ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹è½¬æ¢æ„é€ å‡½æ•°&lt;/strong&gt;ï¼ˆå¦‚è‡ªå®šä¹‰æ•°å€¼ç±»å‹åŒ…è£…ç±»ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ— éœ€ä½¿ç”¨çš„æƒ…å†µ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤šå‚æ•°æ„é€ å‡½æ•°ï¼ˆæ— é»˜è®¤å‚æ•°ï¼‰æ— æ³•éšå¼è½¬æ¢ï¼Œæ— éœ€æ ‡è®°ã€‚&lt;/li&gt;
&lt;li&gt;å¤åˆ¶/ç§»åŠ¨æ„é€ å‡½æ•°ä¸å—&lt;code&gt;explicit&lt;/code&gt;å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å››"&gt;âš¡ï¸ &lt;strong&gt;å››ã€&lt;code&gt;explicit&lt;/code&gt;ä¸ä»£ç å®‰å…¨æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¿å…éšå¼è½¬æ¢çš„é™·é˜±&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå‡½æ•°&lt;code&gt;void log(const std::string&amp;amp; s);&lt;/code&gt;è‹¥æ¥å—éšå¼è½¬æ¢ï¼Œ&lt;code&gt;log(&amp;quot;hello&amp;quot;)&lt;/code&gt;å¯èƒ½å› &lt;code&gt;const char*&lt;/code&gt;åˆ°&lt;code&gt;std::string&lt;/code&gt;çš„éšå¼è½¬æ¢å¯¼è‡´æ€§èƒ½æŸè€—æˆ–æ­§ä¹‰ï¼ˆå°½ç®¡C++17åå…è®¸ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¢å¼ºå¯è¯»æ€§&lt;/strong&gt;ï¼šæ˜¾å¼è½¬æ¢æ˜ç¡®è¡¨è¾¾äº†å¼€å‘è€…çš„æ„å›¾ï¼Œå‡å°‘ä»£ç ç»´æŠ¤æˆæœ¬ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼š&lt;code&gt;explicit&lt;/code&gt;é€šè¿‡å¼ºåˆ¶æ˜¾å¼ç±»å‹è½¬æ¢ï¼Œæ¶ˆé™¤éšå¼è½¬æ¢çš„ä¸å¯æ§é£é™©ï¼Œæå‡ä»£ç å¥å£®æ€§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åŸåˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;å¯¹å•å‚æ•°æ„é€ å‡½æ•°å’Œè½¬æ¢è¿ç®—ç¬¦ä¼˜å…ˆæ·»åŠ &lt;code&gt;explicit&lt;/code&gt;&lt;/strong&gt;ï¼ˆé™¤éæœ‰å……åˆ†ç†ç”±å…è®¸éšå¼è½¬æ¢ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;âœ… &lt;strong&gt;èµ„æºç±»ã€å®¹å™¨ç±»ã€æ¥å£å°è£…ç±»å¿…é¡»ä½¿ç”¨&lt;code&gt;explicit&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆç†è¿ç”¨&lt;code&gt;explicit&lt;/code&gt;æ˜¯C++é«˜è´¨é‡ä»£ç çš„é‡è¦æ ‡å¿—ï¼Œèƒ½æ˜¾è‘—å‡å°‘å› ç±»å‹è‡ªåŠ¨è½¬æ¢å¼•å‘çš„æ½œåœ¨Bugã€‚&lt;/p&gt;
&lt;h2 id="é‡è½½"&gt;é‡è½½[]
&lt;/h2&gt;&lt;p&gt;åœ¨ C++ ä¸­ï¼Œé‡è½½ä¸‹æ ‡è¿ç®—ç¬¦ &lt;code&gt;[]&lt;/code&gt;å…è®¸è‡ªå®šä¹‰ç±»å®ç°ç±»ä¼¼æ•°ç»„çš„è®¿é—®è¡Œä¸ºï¼Œéœ€éµå¾ªç‰¹å®šè¯­æ³•è§„åˆ™å¹¶æä¾›å¼‚å¸¸å®‰å…¨æœºåˆ¶ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†å®ç°æŒ‡å—å’Œæœ€ä½³å®è·µï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€æ ¸å¿ƒè¯­æ³•ä¸å®ç°æ–¹å¼"&gt;ğŸ”§ &lt;strong&gt;ä¸€ã€æ ¸å¿ƒè¯­æ³•ä¸å®ç°æ–¹å¼&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸‹æ ‡è¿ç®—ç¬¦ &lt;code&gt;[]&lt;/code&gt;&lt;strong&gt;å¿…é¡»ä½œä¸ºç±»çš„æˆå‘˜å‡½æ•°é‡è½½&lt;/strong&gt;ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class MyArray {
public:
// é const ç‰ˆæœ¬ï¼ˆæ”¯æŒè¯»å†™ï¼‰
T&amp;amp; operator[](int index) {
// è¿”å›å…ƒç´ çš„å¼•ç”¨
}
// const ç‰ˆæœ¬ï¼ˆåªè¯»ï¼‰
const T&amp;amp; operator[](int index) const {
// è¿”å›å¸¸é‡å¼•ç”¨
}
};
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿”å›ç±»å‹&lt;/strong&gt;ï¼šé€šå¸¸ä¸º &lt;code&gt;T&amp;amp;&lt;/code&gt;ï¼ˆå¼•ç”¨ï¼‰ï¼Œæ”¯æŒèµ‹å€¼æ“ä½œï¼ˆå¦‚ &lt;code&gt;obj[i] = 10;&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;ï¼šä¸€ä¸ªæ•´æ•°ç±»å‹ç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;int&lt;/code&gt;ã€&lt;code&gt;size_t&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Const é‡è½½&lt;/strong&gt;ï¼šå¿…é¡»æä¾› const ç‰ˆæœ¬ï¼Œä»¥æ”¯æŒå¸¸é‡å¯¹è±¡çš„è®¿é—®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-äºŒå®Œæ•´å®ç°æ­¥éª¤ä»¥åŠ¨æ€æ•°ç»„ç±»ä¸ºä¾‹"&gt;âš™ï¸ &lt;strong&gt;äºŒã€å®Œæ•´å®ç°æ­¥éª¤ï¼ˆä»¥åŠ¨æ€æ•°ç»„ç±»ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="1-ç±»å®šä¹‰ä¸æˆå‘˜å˜é‡"&gt;1. &lt;strong&gt;ç±»å®šä¹‰ä¸æˆå‘˜å˜é‡&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;#include &amp;lt;iostream&amp;gt;
#include &amp;lt;stdexcept&amp;gt; // ç”¨äºå¼‚å¸¸å¤„ç†
template &amp;lt;typename T&amp;gt;
class Array {
private:
T* data; // æŒ‡å‘å †å†…å­˜çš„æŒ‡é’ˆ
size_t size; // æ•°ç»„é•¿åº¦
public:
Array(size_t n) : size(n), data(new T[n]) {}
~Array() { delete[] data; }
// é‡è½½ä¸‹æ ‡è¿ç®—ç¬¦ï¼ˆé const ç‰ˆæœ¬ï¼‰
T&amp;amp; operator[](size_t index) {
if (index &amp;gt;= size)
throw std::out_of_range(&amp;#34;Index out of range&amp;#34;);
return data[index];
}
// é‡è½½ä¸‹æ ‡è¿ç®—ç¬¦ï¼ˆconst ç‰ˆæœ¬ï¼‰
const T&amp;amp; operator[](size_t index) const {
if (index &amp;gt;= size)
throw std::out_of_range(&amp;#34;Index out of range&amp;#34;);
return data[index];
}
size_t length() const { return size; }
};
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="2-ä½¿ç”¨ç¤ºä¾‹"&gt;2. &lt;strong&gt;ä½¿ç”¨ç¤ºä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;int main() {
Array&amp;lt;int&amp;gt; arr(3);
arr[0] = 10; // å†™æ“ä½œï¼ˆè°ƒç”¨é const ç‰ˆæœ¬ï¼‰
std::cout &amp;lt;&amp;lt; arr[0]; // è¯»æ“ä½œï¼ˆè°ƒç”¨é const ç‰ˆæœ¬ï¼‰
const Array&amp;lt;int&amp;gt;&amp;amp; constArr = arr;
std::cout &amp;lt;&amp;lt; constArr[0]; // åªè¯»ï¼ˆè°ƒç”¨ const ç‰ˆæœ¬ï¼‰
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-ä¸‰å…³é”®æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ä¸‰ã€å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¿…é¡»æ£€æŸ¥ç´¢å¼•è¶Šç•Œï¼Œé¿å…å†…å­˜éæ³•è®¿é—®ï¼ˆå¦‚ä½¿ç”¨ &lt;code&gt;throw std::out_of_range&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ä¸­çš„ &lt;code&gt;if (index &amp;gt;= size)&lt;/code&gt;æ˜¯å¿…è¦çš„å®‰å…¨æªæ–½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ·±æ‹·è´é—®é¢˜&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è‹¥ç±»æ¶‰åŠåŠ¨æ€å†…å­˜ï¼Œéœ€æ‰‹åŠ¨å®ç°æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼ˆé¿å…æµ…æ‹·è´å¯¼è‡´é‡å¤é‡Šæ”¾ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ‹·è´æ„é€ å‡½æ•°ï¼ˆæ·±æ‹·è´ï¼‰
Array(const Array&amp;amp; other) : size(other.size), data(new T[other.size]) {
std::copy(other.data, other.data + size, data);
}
// èµ‹å€¼è¿ç®—ç¬¦
Array&amp;amp; operator=(const Array&amp;amp; other) {
if (this != &amp;amp;other) {
delete[] data;
size = other.size;
data = new T[size];
std::copy(other.data, other.data + size, data);
}
return *this;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¿”å›å¼•ç”¨çš„å¿…è¦æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è¿”å›å¼•ç”¨ï¼ˆè€Œéå€¼ï¼‰ç¡®ä¿æ“ä½œå¯ä¿®æ”¹å…ƒç´ ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;arr[0] = 42; // åˆæ³•ï¼Œå› ä¸ºè¿”å› T&amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Const æ­£ç¡®æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;const å¯¹è±¡åªèƒ½è°ƒç”¨ const æˆå‘˜å‡½æ•°ï¼Œå› æ­¤å¿…é¡»æä¾› const ç‰ˆæœ¬çš„ &lt;code&gt;operator[]&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å››é«˜çº§åº”ç”¨åœºæ™¯"&gt;ğŸ’¡ &lt;strong&gt;å››ã€é«˜çº§åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="1-å¤šç»´æ•°ç»„æ”¯æŒ"&gt;1. &lt;strong&gt;å¤šç»´æ•°ç»„æ”¯æŒ&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;class Matrix {
private:
Array&amp;lt;Array&amp;lt;int&amp;gt;&amp;gt; rows;
public:
Matrix(size_t r, size_t c) : rows(r, Array&amp;lt;int&amp;gt;(c)) {}
// é‡è½½ä¸¤å±‚ []
Array&amp;lt;int&amp;gt;&amp;amp; operator[](size_t row) {
return rows[row];
}
};
// ä½¿ç”¨
Matrix mat(3, 3);
mat[1][2] = 99; // è®¿é—®ç¬¬äºŒè¡Œç¬¬ä¸‰åˆ—
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="2-å…³è”å®¹å™¨å¦‚æ¨¡æ‹Ÿ-map"&gt;2. &lt;strong&gt;å…³è”å®¹å™¨ï¼ˆå¦‚æ¨¡æ‹Ÿ mapï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;class StringMap {
private:
std::unordered_map&amp;lt;std::string, int&amp;gt; map;
public:
int&amp;amp; operator[](const std::string&amp;amp; key) {
return map[key];
}
};
// ä½¿ç”¨
StringMap dict;
dict[&amp;#34;apple&amp;#34;] = 100;
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-äº”å¸¸è§é”™è¯¯ä¸è§„é¿"&gt;ğŸ› ï¸ &lt;strong&gt;äº”ã€å¸¸è§é”™è¯¯ä¸è§„é¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœªå®ç°æ·±æ‹·è´&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é”™è¯¯ï¼šé»˜è®¤æ‹·è´æ„é€ å‡½æ•°æµ…æ‹·è´æŒ‡é’ˆï¼Œå¯¼è‡´é‡å¤é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼šæ˜¾å¼å®ç°æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿½ç•¥ const ç‰ˆæœ¬&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é”™è¯¯ï¼š&lt;code&gt;const Array a; a[0]&lt;/code&gt;ç¼–è¯‘å¤±è´¥ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼šæ·»åŠ  &lt;code&gt;const T&amp;amp; operator[] const&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿”å›ä¸´æ—¶å¯¹è±¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é”™è¯¯ï¼š&lt;code&gt;T operator[]&lt;/code&gt;è¿”å›å‰¯æœ¬ï¼Œæ— æ³•èµ‹å€¼ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ï¼šè¿”å›å¼•ç”¨ &lt;code&gt;T&amp;amp;&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒè¯­æ³•&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;T&amp;amp; operator[](int index); // è¯»å†™ç‰ˆæœ¬
const T&amp;amp; operator[](int index) const; // åªè¯»ç‰ˆæœ¬
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¼ºåˆ¶è¦æ±‚&lt;/strong&gt;ï¼šæˆå‘˜å‡½æ•°ã€ç´¢å¼•è¶Šç•Œæ£€æŸ¥ã€æ·±æ‹·è´æ”¯æŒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;size_t&lt;/code&gt;é¿å…è´Ÿç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºå®¹å™¨ç±»åŒæ—¶æä¾› const å’Œé const ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;æ¶‰åŠåŠ¨æ€å†…å­˜æ—¶å®ç°æ‹·è´æ§åˆ¶ï¼ˆæ‹·è´æ„é€ ã€èµ‹å€¼ã€ææ„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡åˆç†é‡è½½ &lt;code&gt;[]&lt;/code&gt;ï¼Œå¯è®©è‡ªå®šä¹‰ç±»å‹æ‹¥æœ‰ä¸å†…ç½®æ•°ç»„ä¸€è‡´çš„è®¿é—®è¯­ä¹‰ï¼Œæå‡ä»£ç å¯è¯»æ€§å’Œå®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¤šç»´è®¿é—®"&gt;å¤šç»´è®¿é—®
&lt;/h2&gt;&lt;p&gt;åœ¨ C++ ä¸­ï¼Œ&lt;strong&gt;æ— æ³•ç›´æ¥é‡è½½ &lt;code&gt;[][]&lt;/code&gt;ä½œä¸ºå•ä¸ªè¿ç®—ç¬¦&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;int&amp;amp; operator[][](int x, int y)&lt;/code&gt;ï¼‰ã€‚ä½†å¯é€šè¿‡ä»¥ä¸‹æ–¹æ¡ˆå®ç°å¤šç»´è®¿é—®ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-1-é“¾å¼"&gt;âš™ï¸ &lt;strong&gt;1. é“¾å¼ &lt;code&gt;operator[]&lt;/code&gt;é‡è½½ï¼ˆä¼ ç»Ÿæ–¹æ¡ˆï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šè®© &lt;code&gt;operator[]&lt;/code&gt;è¿”å›ä¸€ä¸ªæ”¯æŒä¸‹ä¸€çº§ &lt;code&gt;operator[]&lt;/code&gt;çš„å¯¹è±¡ï¼ˆå¦‚ä»£ç†ç±»æˆ–ä½ç»´æ•°ç»„ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Matrix {
std::vector&amp;lt;std::vector&amp;lt;int&amp;gt;&amp;gt; data;
public:
std::vector&amp;lt;int&amp;gt;&amp;amp; operator[](int row) {
return data[row]; // è¿”å›è¡Œå‘é‡ï¼ˆæ”¯æŒè¿›ä¸€æ­¥ç´¢å¼•ï¼‰
}
};
Matrix m;
m[1][2] = 42; // é“¾å¼è°ƒç”¨ï¼šm[1] è¿”å› vector&amp;lt;int&amp;gt;ï¼Œå†è°ƒç”¨å…¶ operator[](2)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šè¯­æ³•ç›´è§‚ï¼Œå…¼å®¹æ€§é«˜ï¼ˆC++98 èµ·æ”¯æŒï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå¯èƒ½äº§ç”Ÿä¸´æ—¶å¯¹è±¡ï¼Œå½±å“æ€§èƒ½ï¼›éœ€å¤šå±‚åµŒå¥—å®ç°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-2-é‡è½½"&gt;ğŸ”„ &lt;strong&gt;2. é‡è½½ &lt;code&gt;operator()&lt;/code&gt;ï¼ˆæ›¿ä»£æ–¹æ¡ˆï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šä½¿ç”¨å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦æ¥å—å¤šä¸ªå‚æ•°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Matrix {
int data[10][10];
public:
int&amp;amp; operator()(int row, int col) {
return data[row][col];
}
};
Matrix m;
m(1, 2) = 42; // ç›´æ¥ä¼ é€’è¡Œåˆ—ç´¢å¼•
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šé¿å…ä¸´æ—¶å¯¹è±¡ï¼Œæ€§èƒ½æ›´ä¼˜ï¼›æ”¯æŒä»»æ„ç»´åº¦å‚æ•°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šè¯­æ³•ä¸åŸç”Ÿæ•°ç»„ä¸ä¸€è‡´ï¼ˆä½¿ç”¨ &lt;code&gt;()&lt;/code&gt;è€Œé &lt;code&gt;[]&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-3-c23-å¤šç»´ä¸‹æ ‡è¿ç®—ç¬¦æ–°ç‰¹æ€§"&gt;ğŸš€ &lt;strong&gt;3. C++23 å¤šç»´ä¸‹æ ‡è¿ç®—ç¬¦ï¼ˆæ–°ç‰¹æ€§ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šç›´æ¥é‡è½½ &lt;code&gt;operator[]&lt;/code&gt;æ¥å—å¤šä¸ªå‚æ•°ï¼ˆéœ€ç¼–è¯‘å™¨æ”¯æŒ C++23ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Matrix {
int data[10][10];
public:
int&amp;amp; operator[](int row, int col) { // ç›´æ¥æ¥å—ä¸¤ä¸ªå‚æ•°
return data[row][col];
}
};
Matrix m;
m[1, 2] = 42; // é€—å·åˆ†éš”çš„å¤šç»´ç´¢å¼•
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šè¯­æ³•æœ€ç®€æ´ï¼ˆ&lt;code&gt;arr[x,y]&lt;/code&gt;ï¼‰ï¼Œæ— ä¸´æ—¶å¯¹è±¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é™åˆ¶&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»… C++23 åŠä»¥ä¸Šæ”¯æŒï¼ˆGCC 13+ã€Clang 16+ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸç”Ÿæ•°ç»„ä¸æ”¯æŒ&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;int arr[5][5]; arr[1,2]&lt;/code&gt;éæ³•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-1"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¾¹ç•Œæ£€æŸ¥&lt;/strong&gt;ï¼šæ‰€æœ‰æ–¹æ¡ˆéƒ½åº”æ·»åŠ ç´¢å¼•è¶Šç•Œæ£€æŸ¥ï¼ˆå¦‚ &lt;code&gt;assert&lt;/code&gt;æˆ–æŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¸¸é‡ç‰ˆæœ¬&lt;/strong&gt;ï¼šä¸ºæ”¯æŒå¸¸é‡å¯¹è±¡ï¼Œéœ€æä¾› &lt;code&gt;const&lt;/code&gt;é‡è½½ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;const int&amp;amp; operator[](int row, int col) const; // C++23 å¤šç»´ç‰ˆæœ¬
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼šé¿å…è¿”å›ä¸´æ—¶å¯¹è±¡ï¼Œä¼˜å…ˆè¿”å›å¼•ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—§æ ‡å‡†&lt;/strong&gt;ï¼šç”¨é“¾å¼ &lt;code&gt;operator[]&lt;/code&gt;æˆ– &lt;code&gt;operator()&lt;/code&gt;æ¨¡æ‹Ÿå¤šç»´è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;C++23+&lt;/strong&gt;ï¼šä¼˜å…ˆä½¿ç”¨å¤šç»´ &lt;code&gt;operator[]&lt;/code&gt;ï¼ˆè¯­æ³•æ›´è‡ªç„¶ï¼Œæ€§èƒ½æ›´ä¼˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸç”Ÿæ•°ç»„&lt;/strong&gt;ï¼šå§‹ç»ˆä¸æ”¯æŒé€—å·åˆ†éš”çš„å¤šç»´è¯­æ³•ï¼ˆå¦‚ &lt;code&gt;arr[1,2]&lt;/code&gt;ï¼‰ï¼Œéœ€ç”¨ &lt;code&gt;arr[1][2]&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…å¼€å‘ä¸­ï¼Œè‹¥éœ€å…¼å®¹æ—§ç¼–è¯‘å™¨ï¼Œæ¨èé“¾å¼ &lt;code&gt;operator[]&lt;/code&gt;ï¼›è‹¥æ”¯æŒ C++23ï¼Œç›´æ¥ä½¿ç”¨å¤šç»´ä¸‹æ ‡è¿ç®—ç¬¦æ›´ç®€æ´é«˜æ•ˆ ğŸ”¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ç§æœ‰æ„é€ å™¨"&gt;ç§æœ‰æ„é€ å™¨
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œå½“åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰çš„æ„é€ å™¨è¢«å£°æ˜ä¸º &lt;strong&gt;&lt;code&gt;private&lt;/code&gt;&lt;/strong&gt; æ—¶ï¼Œä¼šå¼•å‘ä¸€ç³»åˆ—å…³é”®é™åˆ¶ï¼Œä¸»è¦å½±å“å­ç±»çš„ç»§æ‰¿å’Œå®ä¾‹åŒ–èƒ½åŠ›ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åæœåŠåŸç†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-1-å­ç±»æ— æ³•ç»§æ‰¿åŸºç±»"&gt;âš ï¸ &lt;strong&gt;1. å­ç±»æ— æ³•ç»§æ‰¿åŸºç±»&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¹æœ¬åŸå› &lt;/strong&gt;ï¼šJava è¦æ±‚å­ç±»çš„æ„é€ å™¨å¿…é¡»è°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼ˆé€šè¿‡ &lt;code&gt;super()&lt;/code&gt;æ˜¾å¼æˆ–éšå¼è°ƒç”¨ï¼‰ã€‚è‹¥çˆ¶ç±»æ„é€ å™¨ä¸º &lt;code&gt;private&lt;/code&gt;ï¼Œåˆ™å­ç±»æ„é€ å™¨æ— æ³•è®¿é—®çˆ¶ç±»æ„é€ å™¨ï¼Œå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Parent {
private Parent() {} // ç§æœ‰æ„é€ å™¨
}
class Child extends Parent {
public Child() { // ç¼–è¯‘é”™è¯¯ï¼šæ— æ³•è®¿é—® Parent()
super(); // éšå¼è°ƒç”¨å¤±è´¥
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;é”™è¯¯ä¿¡æ¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Parent() has private access in Parent&lt;/code&gt;ï¼ˆçˆ¶ç±»æ„é€ å™¨å—ç§æœ‰æƒé™é™åˆ¶ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-2-åŸºç±»è‡ªèº«æ— æ³•è¢«å¤–éƒ¨å®ä¾‹åŒ–"&gt;ğŸ”’ &lt;strong&gt;2. åŸºç±»è‡ªèº«æ— æ³•è¢«å¤–éƒ¨å®ä¾‹åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šç§æœ‰æ„é€ å™¨ç¦æ­¢å¤–éƒ¨é€šè¿‡ &lt;code&gt;new&lt;/code&gt;åˆ›å»ºå®ä¾‹ï¼Œé€šå¸¸ç”¨äºå®ç°&lt;strong&gt;å•ä¾‹æ¨¡å¼&lt;/strong&gt;æˆ–&lt;strong&gt;å·¥å…·ç±»&lt;/strong&gt;ï¼ˆä»…åŒ…å«é™æ€æ–¹æ³•ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å•ä¾‹æ¨¡å¼ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class Singleton {
private static Singleton instance;
private Singleton() {} // ç§æœ‰æ„é€ å™¨
public static Singleton getInstance() {
if (instance == null) {
instance = new Singleton(); // ä»…å†…éƒ¨å¯è°ƒç”¨æ„é€ å™¨
}
return instance;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å·¥å…·ç±»ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public final class MathUtils {
private MathUtils() {
throw new AssertionError(&amp;#34;ä¸å¯å®ä¾‹åŒ–ï¼&amp;#34;); // é˜²æ­¢åå°„åˆ›å»ºå®ä¾‹
}
public static int add(int a, int b) { return a + b; }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-3-è®¾è®¡æ„å›¾é™åˆ¶æ‰©å±•æ€§"&gt;âš–ï¸ &lt;strong&gt;3. è®¾è®¡æ„å›¾ï¼šé™åˆ¶æ‰©å±•æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¼ºåˆ¶ä¸å¯ç»§æ‰¿&lt;/strong&gt;ï¼šç§æœ‰æ„é€ å™¨æ˜¯ä¸€ç§è®¾è®¡é€‰æ‹©ï¼Œç”¨äºæ˜ç¡®è¡¨ç¤ºè¯¥ç±»&lt;strong&gt;ä¸åº”è¢«ç»§æ‰¿&lt;/strong&gt;ï¼ˆå¦‚å·¥å…·ç±»æˆ–å•ä¾‹ç±»ï¼‰ï¼Œä»è€Œé¿å…å­ç±»ç ´ååŸºç±»çš„å°è£…æ€§æˆ–åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è‹¥éœ€å…è®¸ç»§æ‰¿ï¼Œå¯å°†æ„é€ å™¨æ”¹ä¸º &lt;strong&gt;&lt;code&gt;protected&lt;/code&gt;&lt;/strong&gt;ï¼ˆå­ç±»å¯è®¿é—®ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Parent {
protected Parent() {} // å­ç±»å¯é€šè¿‡ super() è°ƒç”¨
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è‹¥éœ€å®Œå…¨ç¦æ­¢ç»§æ‰¿ï¼Œå¯åŒæ—¶ç”¨ &lt;strong&gt;&lt;code&gt;final&lt;/code&gt;ä¿®é¥°ç±»&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;public final class UtilityClass&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-4-ç‰¹æ®Šåœºæ™¯åŸºç±»å†…éƒ¨åµŒå¥—å­ç±»"&gt;ğŸ”„ &lt;strong&gt;4. ç‰¹æ®Šåœºæ™¯ï¼šåŸºç±»å†…éƒ¨åµŒå¥—å­ç±»&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åŸºç±»çš„ç§æœ‰æ„é€ å™¨&lt;strong&gt;ä»…å…è®¸åŸºç±»è‡ªèº«å†…éƒ¨è®¿é—®&lt;/strong&gt;ï¼Œå› æ­¤å¯åœ¨åŸºç±»å†…éƒ¨å®šä¹‰é™æ€åµŒå¥—å­ç±»ï¼ˆåµŒå¥—ç±»å¯è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰æˆå‘˜ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Parent {
private Parent() {}
// é™æ€åµŒå¥—å­ç±»ï¼ˆå¯è®¿é—®ç§æœ‰æ„é€ å™¨ï¼‰
public static class Child extends Parent {
public Child() {
// åˆæ³•ï¼šåµŒå¥—ç±»å¯è°ƒç”¨å¤–éƒ¨ç±»ç§æœ‰æ„é€ å™¨
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ç§æœ‰æ„é€ å™¨çš„å½±å“ä¸åº”å¯¹"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šç§æœ‰æ„é€ å™¨çš„å½±å“ä¸åº”å¯¹&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åæœ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­ç±»æ— æ³•ç»§æ‰¿&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘é”™è¯¯ï¼ˆæ— æ³•è°ƒç”¨ &lt;code&gt;super()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æ”¹ç”¨ &lt;code&gt;protected&lt;/code&gt;æ„é€ å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸºç±»ä¸å¯å¤–éƒ¨å®ä¾‹åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºåˆ¶é€šè¿‡é™æ€å·¥å‚æ–¹æ³•ï¼ˆå¦‚å•ä¾‹æ¨¡å¼ï¼‰æˆ–å·¥å…·ç±»ä½¿ç”¨&lt;/td&gt;
&lt;td&gt;æä¾›é™æ€è®¿é—®æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;getInstance()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡çµæ´»æ€§å—é™&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜ç¡®ç¦æ­¢æ‰©å±•ï¼Œç»´æŠ¤å°è£…æ€§&lt;/td&gt;
&lt;td&gt;ç»“åˆ &lt;code&gt;final&lt;/code&gt;ä¿®é¥°ç±»å¢å¼ºé™åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åµŒå¥—å­ç±»ä¾‹å¤–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºç±»å†…éƒ¨å¯å®šä¹‰ç»§æ‰¿è‡ªèº«çš„åµŒå¥—å­ç±»&lt;/td&gt;
&lt;td&gt;åˆ©ç”¨é™æ€å†…éƒ¨ç±»å®ç°æœ‰é™ç»§æ‰¿&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš™ï¸ &lt;strong&gt;è®¾è®¡å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å·¥å…·ç±»æˆ–å•ä¾‹ç±» â†’ &lt;strong&gt;ç§æœ‰æ„é€ å™¨ + &lt;code&gt;final&lt;/code&gt;ç±»&lt;/strong&gt;ï¼ˆåŒé‡ä¿é™©ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éœ€ç»§æ‰¿çš„åŸºç±» â†’ &lt;strong&gt;é¿å…ç§æœ‰æ„é€ å™¨&lt;/strong&gt;ï¼Œæ”¹ç”¨ &lt;code&gt;protected&lt;/code&gt;æˆ– &lt;code&gt;public&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è°¨æ…ä½¿ç”¨åµŒå¥—å­ç±» â†’ ä»…åœ¨åŸºç±»å†…éƒ¨é€»è¾‘éœ€è¦æ—¶ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€šè¿‡åˆç†åº”ç”¨ç§æœ‰æ„é€ å™¨ï¼Œå¯åœ¨ä¿éšœå°è£…æ€§ä¸å®‰å…¨æ€§çš„åŒæ—¶ï¼Œæ˜ç¡®ä¼ è¾¾ç±»çš„è®¾è®¡æ„å›¾ã€‚&lt;/p&gt;
&lt;h2 id="try-return"&gt;Try return
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œ&lt;strong&gt;å³ä½¿ &lt;code&gt;try&lt;/code&gt;å—ä¸­åŒ…å« &lt;code&gt;return&lt;/code&gt;è¯­å¥ï¼Œ&lt;code&gt;finally&lt;/code&gt;å—ä¹Ÿä¸€å®šä¼šæ‰§è¡Œ&lt;/strong&gt;ã€‚è¿™æ˜¯ç”± Java çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ä¿è¯çš„ï¼Œç›®çš„æ˜¯ç¡®ä¿å…³é”®é€»è¾‘ï¼ˆå¦‚èµ„æºé‡Šæ”¾ï¼‰åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½èƒ½å®Œæˆã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ‰§è¡Œæœºåˆ¶"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒæ‰§è¡Œæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;return&lt;/code&gt;ä¸ &lt;code&gt;finally&lt;/code&gt;çš„æ‰§è¡Œé¡ºåº&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å½“ &lt;code&gt;try&lt;/code&gt;å—é‡åˆ° &lt;code&gt;return&lt;/code&gt;è¯­å¥æ—¶ï¼Œ&lt;strong&gt;è¿”å›å€¼ä¼šè¢«æš‚å­˜&lt;/strong&gt;ï¼Œä½†ä¸ä¼šç«‹å³è¿”å›ç»™è°ƒç”¨æ–¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;JVM ä¼šå…ˆæ‰§è¡Œ &lt;code&gt;finally&lt;/code&gt;å—ä¸­çš„ä»£ç &lt;/strong&gt;ï¼Œå†è¿”å›ä¹‹å‰æš‚å­˜çš„å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¤ºä¾‹ä»£ç ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public static int test() {
try {
return 1; // è¿”å›å€¼ 1 è¢«æš‚å­˜
} finally {
System.out.println(&amp;#34;Finally executed&amp;#34;); // å…ˆæ‰§è¡Œæ­¤å¥
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¾“å‡º&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Finally executed
1
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;finally&lt;/code&gt;å—ä¸­çš„ &lt;code&gt;return&lt;/code&gt;ä¼šè¦†ç›–åŸå€¼&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è‹¥ &lt;code&gt;finally&lt;/code&gt;å—ä¸­ä¹ŸåŒ…å« &lt;code&gt;return&lt;/code&gt;ï¼Œåˆ™å®ƒä¼š&lt;strong&gt;è¦†ç›– &lt;code&gt;try&lt;/code&gt;æˆ– &lt;code&gt;catch&lt;/code&gt;ä¸­çš„è¿”å›å€¼&lt;/strong&gt;ï¼Œå¯èƒ½å¯¼è‡´é€»è¾‘é”™è¯¯ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public static int test() {
try {
return 1;
} finally {
return 2; // è¦†ç›– try çš„è¿”å›å€¼
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;è¾“å‡º&lt;/strong&gt;ï¼š&lt;code&gt;2&lt;/code&gt;ï¼ˆè€Œé &lt;code&gt;1&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ä¸æ¨èæ­¤å†™æ³•&lt;/strong&gt;ï¼šæ˜“å¼•å‘æ··æ·†å’Œè°ƒè¯•å›°éš¾ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-finally"&gt;âš ï¸ &lt;strong&gt;&lt;code&gt;finally&lt;/code&gt;ä¸æ‰§è¡Œçš„æç«¯æƒ…å†µ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å°½ç®¡ &lt;code&gt;finally&lt;/code&gt;çš„å¯é æ€§å¾ˆé«˜ï¼Œä½†ä»¥ä¸‹åœºæ™¯ä¼šè·³è¿‡å…¶æ‰§è¡Œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;System.exit()&lt;/code&gt;ç»ˆæ­¢ JVM&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
System.exit(0); // ç«‹å³ç»ˆæ­¢ç¨‹åº
} finally {
System.out.println(&amp;#34;Skipped&amp;#34;); // ä¸ä¼šæ‰§è¡Œ
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;JVM å´©æºƒ&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;OutOfMemoryError&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;ä¸¥é‡é”™è¯¯å¯¼è‡´è¿›ç¨‹é€€å‡ºæ—¶ï¼Œ&lt;code&gt;finally&lt;/code&gt;æ— æ³•æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ— é™å¾ªç¯æˆ–çº¿ç¨‹é˜»å¡&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
while (true); // æ­»å¾ªç¯é˜»å¡
} finally {
System.out.println(&amp;#34;Never reached&amp;#34;); // æ— æ³•æ‰§è¡Œ
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®ˆæŠ¤çº¿ç¨‹è¢«å¼ºåˆ¶ç»ˆæ­¢&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶ï¼Œå®ˆæŠ¤çº¿ç¨‹çš„ &lt;code&gt;finally&lt;/code&gt;å¯èƒ½æœªæ‰§è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡æ„å›¾ä¸æœ€ä½³å®è·µ"&gt;ğŸ§  &lt;strong&gt;è®¾è®¡æ„å›¾ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒç›®çš„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;finally&lt;/code&gt;ç”¨äº&lt;strong&gt;å¼ºåˆ¶æ¸…ç†èµ„æº&lt;/strong&gt;ï¼ˆå¦‚å…³é—­æ–‡ä»¶ã€é‡Šæ”¾è¿æ¥ï¼‰ï¼Œé¿å…å› å¼‚å¸¸æˆ– &lt;code&gt;return&lt;/code&gt;å¯¼è‡´æ³„æ¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆï¼ˆJava 7+ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¼˜å…ˆä½¿ç”¨ &lt;strong&gt;&lt;code&gt;try-with-resources&lt;/code&gt;&lt;/strong&gt; è‡ªåŠ¨ç®¡ç†èµ„æºï¼Œå‡å°‘æ‰‹åŠ¨ç¼–å†™ &lt;code&gt;finally&lt;/code&gt;çš„éœ€æ±‚ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try (FileReader fr = new FileReader(&amp;#34;file.txt&amp;#34;)) {
// è‡ªåŠ¨å…³é—­èµ„æº
} catch (IOException e) {
e.printStackTrace();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®å»ºè®®&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âŒ &lt;strong&gt;é¿å…åœ¨ &lt;code&gt;finally&lt;/code&gt;ä¸­ä½¿ç”¨ &lt;code&gt;return&lt;/code&gt;&lt;/strong&gt;ï¼šé˜²æ­¢è¦†ç›–åŸè¿”å›å€¼ã€‚&lt;/li&gt;
&lt;li&gt;âŒ &lt;strong&gt;é¿å…åœ¨ &lt;code&gt;finally&lt;/code&gt;ä¸­æŠ›å¼‚å¸¸&lt;/strong&gt;ï¼šå¯èƒ½æ©ç›–ä¸»é€»è¾‘çš„å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;ä¿æŒ &lt;code&gt;finally&lt;/code&gt;ä»£ç ç®€æ´&lt;/strong&gt;ï¼šä»…åŒ…å«å¿…è¦çš„æ¸…ç†é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;finally&lt;/code&gt;æ˜¯å¦æ‰§è¡Œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;try&lt;/code&gt;ä¸­æœ‰ &lt;code&gt;return&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ˜¯&lt;/td&gt;
&lt;td&gt;åœ¨ &lt;code&gt;return&lt;/code&gt;å‰æ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;try&lt;/code&gt;ä¸­æŠ›å‡ºå¼‚å¸¸&lt;/td&gt;
&lt;td&gt;âœ… æ˜¯&lt;/td&gt;
&lt;td&gt;åœ¨å¼‚å¸¸ä¼ æ’­å‰æ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;System.exit()&lt;/code&gt;æˆ– JVM å´©æºƒ&lt;/td&gt;
&lt;td&gt;âŒ å¦&lt;/td&gt;
&lt;td&gt;è¿›ç¨‹ç›´æ¥ç»ˆæ­¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ­»å¾ªç¯/çº¿ç¨‹é˜»å¡&lt;/td&gt;
&lt;td&gt;âŒ å¦&lt;/td&gt;
&lt;td&gt;ä»£ç æ— æ³•æ‰§è¡Œåˆ° &lt;code&gt;finally&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼šä¾èµ– &lt;code&gt;finally&lt;/code&gt;åšèµ„æºæ¸…ç†ï¼Œä½†ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;try-with-resources&lt;/code&gt;ï¼›é¿å…åœ¨ &lt;code&gt;finally&lt;/code&gt;ä¸­å†™å¤æ‚é€»è¾‘æˆ– &lt;code&gt;return&lt;/code&gt;è¯­å¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="c-template-vs-java-generics"&gt;C++ template vs. Java generics
&lt;/h2&gt;&lt;p&gt;C++ æ¨¡æ¿ï¼ˆTemplatesï¼‰å’Œ Java æ³›å‹ï¼ˆGenericsï¼‰è™½ç„¶éƒ½æ—¨åœ¨å®ç°ä»£ç å¤ç”¨å’Œç±»å‹å®‰å…¨ï¼Œä½†å®ƒä»¬åœ¨è®¾è®¡å“²å­¦ã€å®ç°æœºåˆ¶ã€åŠŸèƒ½èŒƒå›´å’Œè¿è¡Œæ—¶è¡Œä¸ºä¸Šå­˜åœ¨æœ¬è´¨åŒºåˆ«ã€‚ä»¥ä¸‹æ˜¯ä¸¤è€…çš„æ ¸å¿ƒå·®å¼‚å¯¹æ¯”åŠè¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸€å®ç°æœºåˆ¶çš„æœ¬è´¨åŒºåˆ«"&gt;âš™ï¸ &lt;strong&gt;ä¸€ã€å®ç°æœºåˆ¶çš„æœ¬è´¨åŒºåˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;C++ æ¨¡æ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Java æ³›å‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘æ—¶ä»£ç ç”Ÿæˆï¼ˆCode Generationï¼‰&lt;/td&gt;
&lt;td&gt;ç±»å‹æ“¦é™¤ï¼ˆType Erasureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ä¾‹åŒ–æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸ºæ¯ä¸ªå…·ä½“ç±»å‹ç”Ÿæˆç‹¬ç«‹çš„æœºå™¨ä»£ç &lt;/td&gt;
&lt;td&gt;ç¼–è¯‘åæ³›å‹ä¿¡æ¯è¢«æ“¦é™¤ï¼Œæ›¿æ¢ä¸º &lt;code&gt;Object&lt;/code&gt;æˆ–è¾¹ç•Œç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿è¡Œæ—¶è¡Œä¸º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»å‹ä¿¡æ¯ä¿ç•™ï¼Œæ”¯æŒè¿è¡Œæ—¶ç±»å‹æ“ä½œ&lt;/td&gt;
&lt;td&gt;ç±»å‹ä¿¡æ¯ä¸å¯ç”¨ï¼ˆé™¤æœ‰é™åå°„å¤–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;vector&amp;lt;int&amp;gt;&lt;/code&gt;å’Œ &lt;code&gt;vector&amp;lt;string&amp;gt;&lt;/code&gt;ç”Ÿæˆä¸åŒä»£ç &lt;/td&gt;
&lt;td&gt;&lt;code&gt;List&amp;lt;String&amp;gt;&lt;/code&gt;å’Œ &lt;code&gt;List&amp;lt;Integer&amp;gt;&lt;/code&gt;ç¼–è¯‘åå‡ä¸º &lt;code&gt;List&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-äºŒç±»å‹å‚æ•°æ”¯æŒçš„åŒºåˆ«"&gt;ğŸ§© &lt;strong&gt;äºŒã€ç±»å‹å‚æ•°æ”¯æŒçš„åŒºåˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;C++ æ¨¡æ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Java æ³›å‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸºæœ¬ç±»å‹æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒï¼ˆå¦‚ &lt;code&gt;int&lt;/code&gt;, &lt;code&gt;double&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒï¼ˆéœ€é€šè¿‡åŒ…è£…ç±»å¦‚ &lt;code&gt;Integer&lt;/code&gt;+ è‡ªåŠ¨è£…ç®±ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éç±»å‹å‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒï¼ˆå¦‚æ•´å‹å¸¸é‡ï¼š&lt;code&gt;template&amp;lt;int N&amp;gt;&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»å‹è¾¹ç•Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— åŸç”Ÿæ”¯æŒï¼ˆéœ€ç»“åˆ SFINAE/Conceptsï¼‰&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒï¼ˆå¦‚ &lt;code&gt;&amp;lt;T extends Number&amp;gt;&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€šé…ç¬¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— &lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒï¼ˆå¦‚ &lt;code&gt;? extends Number&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰é«˜çº§åŠŸèƒ½ä¸çµæ´»æ€§å¯¹æ¯”"&gt;âš¡ï¸ &lt;strong&gt;ä¸‰ã€é«˜çº§åŠŸèƒ½ä¸çµæ´»æ€§å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¨¡æ¿ç‰¹åŒ–ï¼ˆC++ç‹¬æœ‰ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¨ç‰¹åŒ–&lt;/strong&gt;ï¼šä¸ºç‰¹å®šç±»å‹å®šåˆ¶å®ç°ï¼ˆå¦‚ &lt;code&gt;template&amp;lt;&amp;gt; class Vector&amp;lt;bool&amp;gt;&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åç‰¹åŒ–&lt;/strong&gt;ï¼šä¸ºéƒ¨åˆ†ç±»å‹å‚æ•°å®šåˆ¶å®ç°ï¼ˆå¦‚ &lt;code&gt;template&amp;lt;class T&amp;gt; class Vector&amp;lt;T*&amp;gt;&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Java æ— æ­¤åŠŸèƒ½ï¼Œæ‰€æœ‰æ³›å‹ç±»å‹å…±äº«åŒä¸€å®ç°&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…ƒç¼–ç¨‹èƒ½åŠ›&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;C++ æ”¯æŒ&lt;strong&gt;ç¼–è¯‘æ—¶è®¡ç®—&lt;/strong&gt;ï¼ˆå¦‚æ¨¡æ¿é€’å½’ã€&lt;code&gt;constexpr&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;template&amp;lt;int N&amp;gt; struct Factorial {
static const int value = N * Factorial&amp;lt;N-1&amp;gt;::value;
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Java æ³›å‹&lt;strong&gt;æ— æ³•å‚ä¸ç¼–è¯‘æ—¶è®¡ç®—&lt;/strong&gt;ï¼Œä»…æä¾›ç±»å‹å®‰å…¨å®¹å™¨&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç±»å‹æ¨å¯¼&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;C++ï¼šæ”¯æŒ&lt;strong&gt;è‡ªåŠ¨æ¨å¯¼&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;auto p = std::make_pair(1, &amp;quot;hello&amp;quot;);&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;Javaï¼šéœ€æ˜¾å¼æŒ‡å®šæˆ–ä¾èµ–ä¸Šä¸‹æ–‡æ¨æ–­ï¼ˆå¦‚ &lt;code&gt;List&amp;lt;String&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å››æ€§èƒ½ä¸ç¼–è¯‘å½±å“"&gt;âš–ï¸ &lt;strong&gt;å››ã€æ€§èƒ½ä¸ç¼–è¯‘å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;C++ æ¨¡æ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Java æ³›å‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–è¯‘æ—¶é—´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒæ…¢ï¼ˆå¤šæ¬¡å®ä¾‹åŒ–å¯¼è‡´ä»£ç è†¨èƒ€ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒå¿«ï¼ˆå•ä¸€å­—èŠ‚ç  + ç±»å‹æ“¦é™¤ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿è¡Œæ—¶æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ›´ä¼˜ï¼ˆå†…è”ä¼˜åŒ–ã€æ— ç±»å‹è½¬æ¢ï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ æœ‰å¼€é”€ï¼ˆç±»å‹æ£€æŸ¥ã€è‡ªåŠ¨è£…ç®±ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯èƒ½è†¨èƒ€ï¼ˆæ¯ä¸ªç±»å‹ç”Ÿæˆç‹¬ç«‹ä»£ç ï¼‰&lt;/td&gt;
&lt;td&gt;æ›´ç´§å‡‘ï¼ˆç±»å‹æ“¦é™¤å¤ç”¨åŒä¸€å­—èŠ‚ç ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-äº”å…¸å‹é—®é¢˜ä¸é™åˆ¶"&gt;ğŸ› ï¸ &lt;strong&gt;äº”ã€å…¸å‹é—®é¢˜ä¸é™åˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Java æ³›å‹çš„ç±»å‹æ“¦é™¤é—®é¢˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶ç±»å‹ä¸å¯çŸ¥&lt;/strong&gt;ï¼šæ— æ³•åˆ›å»ºæ³›å‹æ•°ç»„ï¼ˆ&lt;code&gt;new T[]&lt;/code&gt;éæ³•ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡è½½é™åˆ¶&lt;/strong&gt;ï¼š&lt;code&gt;void f(List&amp;lt;String&amp;gt;)&lt;/code&gt;å’Œ &lt;code&gt;void f(List&amp;lt;Integer&amp;gt;)&lt;/code&gt;ç¼–è¯‘å†²çªï¼ˆæ“¦é™¤åç­¾åç›¸åŒï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;C++ æ¨¡æ¿çš„ç¼–è¯‘å¤æ‚æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯ä¿¡æ¯æ™¦æ¶©&lt;/strong&gt;ï¼šæ¨¡æ¿å®ä¾‹åŒ–å¤±è´¥æ—¶æç¤ºä¿¡æ¯å†—é•¿ï¼ˆå¦‚ SFINAE é”™è¯¯ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨ç¼–è¯‘å•å…ƒé—®é¢˜&lt;/strong&gt;ï¼šæ¨¡æ¿å®šä¹‰éœ€æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œæ˜“å¯¼è‡´é‡å¤å®ä¾‹åŒ–&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…­æ€»ç»“æ ¸å¿ƒå·®å¼‚å…¨æ™¯å¯¹æ¯”"&gt;ğŸ’ &lt;strong&gt;å…­ã€æ€»ç»“ï¼šæ ¸å¿ƒå·®å¼‚å…¨æ™¯å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;C++ æ¨¡æ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Java æ³›å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¹æœ¬åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é›¶å¼€é”€æŠ½è±¡ + å…ƒç¼–ç¨‹&lt;/td&gt;
&lt;td&gt;ç±»å‹å®‰å…¨ + å‘åå…¼å®¹&lt;/td&gt;
&lt;td&gt;è¯­è¨€è®¾è®¡å“²å­¦å·®å¼‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ³›å‹èƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ›´å¼ºå¤§ï¼ˆç‰¹åŒ–ã€éç±»å‹å‚æ•°ï¼‰&lt;/td&gt;
&lt;td&gt;æ›´å®‰å…¨ï¼ˆè¾¹ç•Œæ£€æŸ¥ã€é€šé…ç¬¦ï¼‰&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘æœºåˆ¶å·®å¼‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜æ€§èƒ½è®¡ç®—ã€ç³»ç»Ÿçº§å¼€å‘&lt;/td&gt;
&lt;td&gt;ä¼ä¸šåº”ç”¨ã€è·¨å¹³å°å¼€å‘&lt;/td&gt;
&lt;td&gt;æ€§èƒ½ä¸çµæ´»æ€§æƒè¡¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€æè‡´æ€§èƒ½/å…ƒç¼–ç¨‹ â†’ &lt;strong&gt;C++ æ¨¡æ¿&lt;/strong&gt;ï¼ˆå¦‚æ•°å€¼è®¡ç®—ã€æ¸¸æˆå¼•æ“ï¼‰&lt;/li&gt;
&lt;li&gt;éœ€è·¨å¹³å°/å¿«é€Ÿå¼€å‘ â†’ &lt;strong&gt;Java æ³›å‹&lt;/strong&gt;ï¼ˆå¦‚ Web æœåŠ¡ã€Android åº”ç”¨ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€šè¿‡ç†è§£è¿™äº›å·®å¼‚ï¼Œå¼€å‘è€…å¯æ›´é«˜æ•ˆåœ°åˆ©ç”¨ä¸¤ç§è¯­è¨€çš„ä¼˜åŠ¿ï¼Œé¿å…å› æœºåˆ¶æ··æ·†å¯¼è‡´çš„é™·é˜±ã€‚ä¸¤è€…è™½åŠŸèƒ½ç›¸ä¼¼ï¼Œä½†å†…åœ¨é€»è¾‘è¿¥å¼‚ï¼Œåæ˜ äº†ç¼–è¯‘å‹è¯­è¨€ä¸è™šæ‹Ÿæœºè¯­è¨€åœ¨æ³›å‹è®¾è®¡ä¸Šçš„æ ¹æœ¬åˆ†é‡ ã€‚&lt;/p&gt;
&lt;h2 id="åå°„--class"&gt;åå°„ &amp;amp; .class
&lt;/h2&gt;&lt;p&gt;Java åå°„å’Œ &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡å¯†åˆ‡ç›¸å…³ï¼Œä½†&lt;strong&gt;å¹¶éå®Œå…¨ç­‰åŒ&lt;/strong&gt;ã€‚å®ƒä»¬çš„å…³ç³»å¯ä»¥æ€»ç»“ä¸ºï¼š&lt;strong&gt;&lt;code&gt;.class&lt;/code&gt;å¯¹è±¡æ˜¯åå°„çš„èµ·ç‚¹å’Œæ ¸å¿ƒè½½ä½“ï¼Œè€Œåå°„æ˜¯é€šè¿‡æ“ä½œ &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡å®ç°åŠ¨æ€ç¼–ç¨‹çš„å®Œæ•´æœºåˆ¶&lt;/strong&gt;ã€‚å…·ä½“åŒºåˆ«å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-1"&gt;ğŸ” &lt;strong&gt;1. &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡ï¼šç±»çš„å…ƒæ•°æ®è½½ä½“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æ¯ä¸ª Java ç±»åœ¨ JVM åŠ è½½æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ &lt;strong&gt;&lt;code&gt;Class&lt;/code&gt;å¯¹è±¡&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;String.class&lt;/code&gt;ï¼‰ã€‚è¯¥å¯¹è±¡å­˜å‚¨ç±»çš„ç»“æ„ä¿¡æ¯ï¼ˆå­—æ®µã€æ–¹æ³•ã€æ„é€ å™¨ç­‰å…ƒæ•°æ®ï¼‰ï¼Œä½äº JVM æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·å–æ–¹å¼&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ç±»å.class&lt;/code&gt;ï¼ˆç¼–è¯‘æ—¶å·²çŸ¥ç±»å‹ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;å¯¹è±¡.getClass()&lt;/code&gt;ï¼ˆè¿è¡Œæ—¶è·å–å®ä¾‹çš„ç±»å‹ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Class.forName(&amp;quot;å…¨ç±»å&amp;quot;)&lt;/code&gt;ï¼ˆåŠ¨æ€åŠ è½½ç±»ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æä¾›ç±»çš„é™æ€æè¿°ï¼Œæ˜¯åå°„æ“ä½œçš„&lt;strong&gt;æ•°æ®åŸºç¡€&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Class&amp;lt;?&amp;gt; clazz = String.class; // è·å–Stringç±»çš„Classå¯¹è±¡
System.out.println(clazz.getName()); // è¾“å‡º&amp;#34;java.lang.String&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-2-åå°„reflectionåŠ¨æ€æ“ä½œæœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;2. åå°„ï¼ˆReflectionï¼‰ï¼šåŠ¨æ€æ“ä½œæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åå°„æ˜¯ä¸€å¥— API&lt;/strong&gt;ï¼ˆä½äº &lt;code&gt;java.lang.reflect&lt;/code&gt;åŒ…ï¼‰ï¼Œå…è®¸ç¨‹åºåœ¨&lt;strong&gt;è¿è¡Œæ—¶&lt;/strong&gt;åŠ¨æ€è®¿é—®å’Œæ“ä½œç±»ä¿¡æ¯ï¼ˆå¦‚åˆ›å»ºå¯¹è±¡ã€è°ƒç”¨æ–¹æ³•ã€ä¿®æ”¹å­—æ®µå€¼ï¼‰ï¼Œå³ä½¿ç¼–è¯‘æ—¶æœªçŸ¥å…·ä½“ç±»åã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ›å»ºå¯¹è±¡&lt;/strong&gt;ï¼š&lt;code&gt;clazz.newInstance()&lt;/code&gt;æˆ–é€šè¿‡æ„é€ å™¨ &lt;code&gt;Constructor.newInstance()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒç”¨æ–¹æ³•&lt;/strong&gt;ï¼š&lt;code&gt;Method.invoke(obj, args)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¿é—®å­—æ®µ&lt;/strong&gt;ï¼š&lt;code&gt;Field.get(obj)&lt;/code&gt;/ &lt;code&gt;Field.set(obj, value)&lt;/code&gt;ï¼ˆå¯çªç ´ç§æœ‰é™åˆ¶ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æç±»ç»“æ„&lt;/strong&gt;ï¼šè·å–çˆ¶ç±»ã€æ¥å£ã€æ³¨è§£ç­‰ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Class&amp;lt;?&amp;gt; clazz = Class.forName(&amp;#34;java.util.ArrayList&amp;#34;); // åŠ¨æ€åŠ è½½ç±»
Object list = clazz.newInstance(); // åˆ›å»ºå®ä¾‹
Method addMethod = clazz.getMethod(&amp;#34;add&amp;#34;, Object.class); // è·å–addæ–¹æ³•
addMethod.invoke(list, &amp;#34;Hello&amp;#34;); // åŠ¨æ€è°ƒç”¨æ–¹æ³•
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-3-ä¸¤è€…å…³ç³»ä¾èµ–ä¸åä½œ"&gt;ğŸ”— &lt;strong&gt;3. ä¸¤è€…å…³ç³»ï¼šä¾èµ–ä¸åä½œ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;.class&lt;/code&gt;å¯¹è±¡æ˜¯åå°„çš„å…¥å£&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;åå°„æ“ä½œå¿…é¡»&lt;strong&gt;å…ˆè·å–ç›®æ ‡ç±»çš„ &lt;code&gt;Class&lt;/code&gt;å¯¹è±¡&lt;/strong&gt;ï¼Œæ‰èƒ½è¿›ä¸€æ­¥è°ƒç”¨åå°„ APIï¼ˆå¦‚ &lt;code&gt;getMethod()&lt;/code&gt;ã€&lt;code&gt;getField()&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åå°„æ‰©å±•äº† &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡çš„èƒ½åŠ›&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.class&lt;/code&gt;å¯¹è±¡ä»…å­˜å‚¨é™æ€å…ƒæ•°æ®ï¼Œè€Œåå°„ API åˆ©ç”¨è¿™äº›å…ƒæ•°æ®&lt;strong&gt;åŠ¨æ€æ‰§è¡Œæ“ä½œ&lt;/strong&gt;ï¼ˆå¦‚è°ƒç”¨æ–¹æ³•ã€ä¿®æ”¹å­—æ®µï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.class&lt;/code&gt;å¯¹è±¡çŸ¥é“ç±»æœ‰å“ªäº›æ–¹æ³•ï¼ˆ&lt;code&gt;getDeclaredMethods()&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;åå°„ API èƒ½å®é™…è°ƒç”¨è¿™äº›æ–¹æ³•ï¼ˆ&lt;code&gt;Method.invoke()&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-4-å…³é”®åŒºåˆ«æ€»ç»“"&gt;ğŸ§© &lt;strong&gt;4. å…³é”®åŒºåˆ«æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;.class&lt;/code&gt;å¯¹è±¡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åå°„ï¼ˆReflectionï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»çš„å…ƒæ•°æ®ï¼ˆæè¿°ç±»ç»“æ„ï¼‰&lt;/td&gt;
&lt;td&gt;åŠ¨æ€æ“ä½œç±»çš„ API æœºåˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨ç±»ä¿¡æ¯ï¼ˆå¦‚å­—æ®µã€æ–¹æ³•åˆ—è¡¨ï¼‰&lt;/td&gt;
&lt;td&gt;åŠ¨æ€åˆ›å»ºå¯¹è±¡ã€è°ƒç”¨æ–¹æ³•ã€ä¿®æ”¹å­—æ®µç­‰æ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è·å–ç±»åã€çˆ¶ç±»ã€æ¥å£ç­‰é™æ€ä¿¡æ¯&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ—¶åŠ è½½æœªçŸ¥ç±»ã€æ¡†æ¶å¼€å‘ï¼ˆå¦‚ Spring ä¾èµ–æ³¨å…¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åå°„çš„åŸºç¡€å’Œèµ·ç‚¹&lt;/td&gt;
&lt;td&gt;ä¾èµ– &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡æ‰§è¡ŒåŠ¨æ€æ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;String.class.getName()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Method.invoke(obj, args)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç»“è®º"&gt;ğŸ’ &lt;strong&gt;ç»“è®º&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;.class&lt;/code&gt;å¯¹è±¡&lt;/strong&gt;æ˜¯ JVM ä¸ºæ¯ä¸ªç±»ç”Ÿæˆçš„&lt;strong&gt;å…ƒæ•°æ®å¯¹è±¡&lt;/strong&gt;ï¼Œæ˜¯ç±»ç»“æ„çš„é™æ€æè¿°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åå°„&lt;/strong&gt;æ˜¯åˆ©ç”¨ &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡ï¼Œåœ¨&lt;strong&gt;è¿è¡Œæ—¶åŠ¨æ€æ“ä½œç±»&lt;/strong&gt;çš„å®Œæ•´æœºåˆ¶ï¼ˆAPI é›†åˆï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…³ç³»ç±»æ¯”&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ”§ &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡åƒâ€œè®¾è®¡è“å›¾â€ï¼ˆé™æ€ä¿¡æ¯ï¼‰ï¼Œè€Œåå°„æ˜¯â€œæ–½å·¥é˜Ÿâ€ï¼ˆåŠ¨æ€æ“ä½œï¼‰ã€‚è“å›¾æ˜¯æ–½å·¥çš„åŸºç¡€ï¼Œæ–½å·¥é˜Ÿåˆ©ç”¨è“å›¾å®Œæˆå®é™…å»ºé€ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼Œä¸¤è€…ç´§å¯†å…³è”ä½†è§’è‰²ä¸åŒï¼š&lt;strong&gt;æ²¡æœ‰ &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡åˆ™æ— æ³•åå°„ï¼Œä½†ä»…æœ‰ &lt;code&gt;.class&lt;/code&gt;å¯¹è±¡ä¸è§¦å‘åå°„æ“ä½œ&lt;/strong&gt;ã€‚ç†è§£è¿™ä¸€åŒºåˆ«æ˜¯æŒæ¡ Java åŠ¨æ€ç¼–ç¨‹çš„å…³é”® ğŸ”‘ã€‚&lt;/p&gt;
&lt;h2 id="java-treemap"&gt;Java TreeMap
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯Javaä¸­&lt;code&gt;TreeMap&lt;/code&gt;ã€&lt;code&gt;HashMap&lt;/code&gt;å’Œ&lt;code&gt;LinkedHashMap&lt;/code&gt;çš„æ ¸å¿ƒå¯¹æ¯”ï¼Œä»æ•°æ®ç»“æ„ã€æ’åºç‰¹æ€§ã€æ€§èƒ½ã€å†…å­˜å¼€é”€åŠé€‚ç”¨åœºæ™¯ç­‰ç»´åº¦å±•å¼€åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-1-æ•°æ®ç»“æ„ä¸å­˜å‚¨æœºåˆ¶"&gt;ğŸ”‘ &lt;strong&gt;1. æ•°æ®ç»“æ„ä¸å­˜å‚¨æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;HashMap&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åº•å±‚ç»“æ„&lt;/strong&gt;ï¼šå“ˆå¸Œè¡¨ï¼ˆæ•°ç»„ + é“¾è¡¨/çº¢é»‘æ ‘ï¼‰ï¼Œé€šè¿‡&lt;code&gt;hashCode()&lt;/code&gt;è®¡ç®—æ¡¶ä½ç½®ï¼Œå†²çªæ—¶é“¾è¡¨æ³•è§£å†³ï¼ˆé“¾è¡¨é•¿åº¦â‰¥8æ—¶è½¬çº¢é»‘æ ‘ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— åºæ€§&lt;/strong&gt;ï¼šå…ƒç´ å­˜å‚¨ä½ç½®ç”±å“ˆå¸Œå‡½æ•°å†³å®šï¼Œè¿­ä»£é¡ºåºä¸å¯é¢„æµ‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åº•å±‚ç»“æ„&lt;/strong&gt;ï¼šç»§æ‰¿&lt;code&gt;HashMap&lt;/code&gt;ï¼Œé¢å¤–ç»´æŠ¤&lt;strong&gt;åŒå‘é“¾è¡¨&lt;/strong&gt;è®°å½•æ’å…¥é¡ºåºæˆ–è®¿é—®é¡ºåºï¼ˆLRUæ¨¡å¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;ï¼šè¿­ä»£é¡ºåº = æ’å…¥é¡ºåºï¼ˆé»˜è®¤ï¼‰æˆ–è®¿é—®é¡ºåºï¼ˆæ„é€ å‚æ•°&lt;code&gt;accessOrder=true&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;TreeMap&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åº•å±‚ç»“æ„&lt;/strong&gt;ï¼šçº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼‰ï¼ŒåŠ¨æ€ç»´æŠ¤é”®çš„æ’åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;ï¼šæŒ‰é”®çš„è‡ªç„¶é¡ºåºï¼ˆå¦‚å­—å…¸åºã€æ•°å€¼å¤§å°ï¼‰æˆ–è‡ªå®šä¹‰&lt;code&gt;Comparator&lt;/code&gt;æ’åºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-2-æ’åºç‰¹æ€§ä¸è¿­ä»£é¡ºåº"&gt;ğŸ”„ &lt;strong&gt;2. æ’åºç‰¹æ€§ä¸è¿­ä»£é¡ºåº&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;HashMap&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;TreeMap&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é¡ºåºä¿è¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— åº&lt;/td&gt;
&lt;td&gt;âœ… æ’å…¥é¡ºåº/è®¿é—®é¡ºåº&lt;/td&gt;
&lt;td&gt;âœ… æŒ‰é”®æ’åº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;LRUæ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆè®¿é—®é¡ºåºæ¨¡å¼ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆ&lt;code&gt;subMap()&lt;/code&gt;, &lt;code&gt;tailMap()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// TreeMapæŒ‰é”®æ’åº
TreeMap&amp;lt;String, Integer&amp;gt; treeMap = new TreeMap&amp;lt;&amp;gt;();
treeMap.put(&amp;#34;Orange&amp;#34;, 2); treeMap.put(&amp;#34;Apple&amp;#34;, 1);
System.out.println(treeMap); // è¾“å‡ºï¼š{Apple=1, Orange=2}ï¼ˆå­—å…¸åºï¼‰
// LinkedHashMapä¿ç•™æ’å…¥é¡ºåº
LinkedHashMap&amp;lt;String, Integer&amp;gt; linkedMap = new LinkedHashMap&amp;lt;&amp;gt;();
linkedMap.put(&amp;#34;Orange&amp;#34;, 2); linkedMap.put(&amp;#34;Apple&amp;#34;, 1);
System.out.println(linkedMap); // è¾“å‡ºï¼š{Orange=2, Apple=1}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-3-æ€§èƒ½ä¸æ—¶é—´å¤æ‚åº¦"&gt;âš¡ &lt;strong&gt;3. æ€§èƒ½ä¸æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;HashMap&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;TreeMap&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ’å…¥/åˆ é™¤/æŸ¥æ‰¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;O(1)ï¼ˆå¹³å‡ï¼‰&lt;/td&gt;
&lt;td&gt;O(1)ï¼ˆå¹³å‡ï¼‰&lt;/td&gt;
&lt;td&gt;O(log n)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éå†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;O(n)ï¼ˆé¡ºåºéšæœºï¼‰&lt;/td&gt;
&lt;td&gt;O(n)ï¼ˆé¡ºåºå›ºå®šï¼‰&lt;/td&gt;
&lt;td&gt;O(n)ï¼ˆæœ‰åºï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ€åæƒ…å†µ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;O(n)ï¼ˆå“ˆå¸Œå†²çªï¼‰&lt;/td&gt;
&lt;td&gt;O(n)&lt;/td&gt;
&lt;td&gt;O(log n)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®å·®å¼‚&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HashMap&lt;/code&gt;å’Œ&lt;code&gt;LinkedHashMap&lt;/code&gt;å¹³å‡æ€§èƒ½æ¥è¿‘ï¼Œä½†&lt;code&gt;LinkedHashMap&lt;/code&gt;å› ç»´æŠ¤é“¾è¡¨æœ‰&lt;strong&gt;è½»å¾®é¢å¤–å¼€é”€&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TreeMap&lt;/code&gt;æ“ä½œéœ€å¹³è¡¡çº¢é»‘æ ‘ï¼Œæ€§èƒ½ä½äºå“ˆå¸Œè¡¨å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-4-å†…å­˜å¼€é”€"&gt;ğŸ’¾ &lt;strong&gt;4. å†…å­˜å¼€é”€&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;HashMap&lt;/code&gt;&lt;/strong&gt;ï¼šå†…å­˜å ç”¨æœ€ä½ï¼ˆä»…å“ˆå¸Œè¡¨ç»“æ„ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/strong&gt;ï¼šé¢å¤–å­˜å‚¨åŒå‘é“¾è¡¨æŒ‡é’ˆï¼Œå†…å­˜å¼€é”€ä¸­ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;TreeMap&lt;/code&gt;&lt;/strong&gt;ï¼šæ¯ä¸ªèŠ‚ç‚¹éœ€ç»´æŠ¤çˆ¶/å­æŒ‡é’ˆå’Œé¢œè‰²æ ‡è®°ï¼Œå†…å­˜å ç”¨æœ€é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-5-ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ"&gt;ğŸ¯ &lt;strong&gt;5. ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;HashMap&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜é¢‘è¯»å†™ã€æ— éœ€é¡ºåºï¼ˆå¦‚ç¼“å­˜ã€è®¡æ•°å™¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šé”®éœ€æ­£ç¡®å®ç°&lt;code&gt;hashCode()&lt;/code&gt;å’Œ&lt;code&gt;equals()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ä¿ç•™æ’å…¥é¡ºåºï¼ˆå¦‚è¡¨å•å­—æ®µåºåˆ—åŒ–ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;LRUç¼“å­˜&lt;/strong&gt;ï¼ˆè¦†ç›–&lt;code&gt;removeEldestEntry()&lt;/code&gt;æ·˜æ±°æ—§æ¡ç›®ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Map&amp;lt;K, V&amp;gt; lruCache = new LinkedHashMap&amp;lt;&amp;gt;(16, 0.75f, true) {
protected boolean removeEldestEntry(Entry&amp;lt;K, V&amp;gt; eldest) {
return size() &amp;gt; MAX_SIZE;
}
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;TreeMap&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æŒ‰é”®æ’åºï¼ˆå¦‚æ—¥å¿—æŒ‰æ—¥æœŸæ’åºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;èŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚è·å–æŸæ—¶é—´æ®µå†…çš„æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šé”®éœ€å®ç°&lt;code&gt;Comparable&lt;/code&gt;æˆ–æä¾›&lt;code&gt;Comparator&lt;/code&gt;ï¼Œ&lt;strong&gt;ç¦æ­¢&lt;code&gt;null&lt;/code&gt;é”®&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-6-å…¶ä»–å…³é”®å·®å¼‚"&gt;âš ï¸ &lt;strong&gt;6. å…¶ä»–å…³é”®å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;HashMap&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;TreeMap&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…è®¸&lt;code&gt;null&lt;/code&gt;é”®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆ1ä¸ªï¼‰&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆ1ä¸ªï¼‰&lt;/td&gt;
&lt;td&gt;âŒï¼ˆæŠ›å‡º&lt;code&gt;NullPointerException&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šçº¿ç¨‹æ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ConcurrentHashMap&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Collections.synchronizedMap()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ConcurrentSkipListMap&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“é€‰æ‹©å»ºè®®"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šé€‰æ‹©å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;éœ€æ±‚&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èå®ç°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç†ç”±&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;é«˜é¢‘è¯»å†™ï¼Œæ— éœ€é¡ºåº&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HashMap&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ€§èƒ½æœ€ä¼˜ï¼Œå†…å­˜å ç”¨ä½ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¿ç•™æ’å…¥é¡ºåº/LRUç¼“å­˜&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é“¾è¡¨ç»´æŠ¤é¡ºåºï¼Œè®¿é—®æ¨¡å¼æ”¯æŒLRUã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æŒ‰é”®æ’åº/èŒƒå›´æŸ¥è¯¢&lt;/td&gt;
&lt;td&gt;&lt;code&gt;TreeMap&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çº¢é»‘æ ‘ä¿è¯æœ‰åºæ€§ï¼Œæ”¯æŒé«˜æ•ˆèŒƒå›´æ“ä½œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤é€‰æ‹©&lt;code&gt;HashMap&lt;/code&gt;ï¼ˆé™¤éé¡ºåºæˆ–æ’åºå¿…è¦ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤šçº¿ç¨‹ç¯å¢ƒç”¨&lt;code&gt;ConcurrentHashMap&lt;/code&gt;æ›¿ä»£&lt;code&gt;HashMap&lt;/code&gt;/&lt;code&gt;LinkedHashMap&lt;/code&gt;ï¼Œç”¨&lt;code&gt;ConcurrentSkipListMap&lt;/code&gt;æ›¿ä»£&lt;code&gt;TreeMap&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Javaã€‘Module</title><link>https://dyhes.github.io/p/javamodule/</link><pubDate>Tue, 05 Aug 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javamodule/</guid><description>&lt;h2 id="module"&gt;Module
&lt;/h2&gt;&lt;p&gt;Javaæ¨¡å—ç³»ç»Ÿï¼ˆJava Platform Module System, JPMSï¼‰ï¼Œåˆç§°Project Jigsawï¼Œæ˜¯Java 9å¼•å…¥çš„æ ¸å¿ƒç‰¹æ€§ï¼Œæ—¨åœ¨è§£å†³ä¼ ç»ŸJavaå¼€å‘ä¸­çš„ä¾èµ–ç®¡ç†æ··ä¹±ã€å°è£…æ€§ä¸è¶³åŠéƒ¨ç½²è‡ƒè‚¿ç­‰é—®é¢˜ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæ¦‚å¿µã€æŠ€æœ¯æœºåˆ¶ã€å·¥å…·é“¾åŠå®è·µåœºæ™¯å±•å¼€è¯¦ç»†è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="ä¸€æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒæ¦‚å¿µ"&gt;&lt;strong&gt;ä¸€ã€æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒæ¦‚å¿µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¨¡å—ï¼ˆModuleï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šæ¨¡å—æ˜¯ä»£ç å’Œæ•°æ®çš„å‘½åé›†åˆï¼ŒåŒ…å«ä¸€ç»„ç›¸å…³çš„åŒ…ã€èµ„æºåŠæ¨¡å—æè¿°æ–‡ä»¶ï¼ˆ&lt;code&gt;module-info.java&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±‚çº§ç»“æ„&lt;/strong&gt;ï¼š&lt;code&gt;JAR &amp;gt; Module &amp;gt; Package &amp;gt; Class/Interface&lt;/code&gt;ï¼Œå®ç°æ›´ç»†ç²’åº¦çš„ä»£ç ç»„ç»‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼ºå°è£…æ€§&lt;/strong&gt;ï¼šåªæœ‰æ˜¾å¼å£°æ˜å¯¼å‡ºçš„åŒ…ï¼ˆ&lt;code&gt;exports&lt;/code&gt;ï¼‰æ‰èƒ½è¢«å¤–éƒ¨è®¿é—®ï¼Œå³ä½¿ç±»ä¸º&lt;code&gt;public&lt;/code&gt;ï¼Œæœªå¯¼å‡ºçš„åŒ…å¯¹å…¶ä»–æ¨¡å—ä¸å¯è§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¨¡å—æè¿°ç¬¦ï¼ˆ&lt;code&gt;module-info.java&lt;/code&gt;ï¼‰&lt;/strong&gt;
ä½äºæ¨¡å—æ ¹ç›®å½•ï¼Œå£°æ˜æ¨¡å—å…ƒæ•°æ®ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;module com.example.app {
requires java.sql; // ä¾èµ–å…¶ä»–æ¨¡å—
exports com.example.api; // å…¬å¼€æŒ‡å®šåŒ…
provides Service with ServiceImpl; // æœåŠ¡æä¾›
uses Service; // æœåŠ¡æ¶ˆè´¹
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;requires&lt;/code&gt;ï¼šå£°æ˜ä¾èµ–çš„æ¨¡å—ï¼ˆå¦‚&lt;code&gt;java.base&lt;/code&gt;æ˜¯éšå¼ä¾èµ–çš„åŸºç¡€æ¨¡å—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;exports&lt;/code&gt;ï¼šæ§åˆ¶åŒ…çš„å¯è§æ€§ï¼Œæœªå¯¼å‡ºçš„åŒ…å†…éƒ¨ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡æœºåˆ¶ï¼šé€šè¿‡&lt;code&gt;provides...with&lt;/code&gt;å’Œ&lt;code&gt;uses&lt;/code&gt;å®ç°è§£è€¦çš„æœåŠ¡å‘ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="äºŒjdkè‡ªèº«çš„æ¨¡å—åŒ–"&gt;&lt;strong&gt;äºŒã€JDKè‡ªèº«çš„æ¨¡å—åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Java 9å°†JDKæ‹†åˆ†ä¸ºçº¦&lt;strong&gt;94ä¸ªæ ¸å¿ƒæ¨¡å—&lt;/strong&gt;ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å—å&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½æè¿°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;java.base&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ¸å¿ƒåŒ…ï¼ˆå¦‚&lt;code&gt;java.lang&lt;/code&gt;ã€&lt;code&gt;java.util&lt;/code&gt;ï¼‰ï¼Œæ‰€æœ‰æ¨¡å—çš„éšå¼ä¾èµ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;java.sql&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;JDBCæ•°æ®åº“è¿æ¥API&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;java.desktop&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;AWT/Swingå›¾å½¢ç•Œé¢åº“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;jdk.compiler&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Javaç¼–è¯‘å™¨å®ç°ï¼ˆ&lt;code&gt;javac&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šæŒ‰éœ€åŠ è½½æ¨¡å—ï¼Œå‡å°‘è¿è¡Œæ—¶èµ„æºå ç”¨ï¼ˆå¦‚é€šè¿‡&lt;code&gt;jlink&lt;/code&gt;ç”Ÿæˆæœ€å°åŒ–JREï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="ä¸‰æ¨¡å—åŒ–æ ¸å¿ƒæœºåˆ¶"&gt;&lt;strong&gt;ä¸‰ã€æ¨¡å—åŒ–æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–è§£æä¸æ¨¡å—å›¾&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¨¡å—è·¯å¾„ï¼ˆ&lt;code&gt;--module-path&lt;/code&gt;ï¼‰æ›¿ä»£ç±»è·¯å¾„ï¼ŒJVMåŸºäº&lt;code&gt;module-info.java&lt;/code&gt;æ„å»º&lt;strong&gt;æœ‰å‘æ¨¡å—å›¾&lt;/strong&gt;ï¼Œç¡®ä¿ä¾èµ–å…³ç³»æ— ç¯ä¸”å®Œæ•´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¾ªç¯ä¾èµ–&lt;/strong&gt;ï¼šæ¨¡å—é—´ç¦æ­¢ç›´æ¥å¾ªç¯ä¾èµ–ï¼Œéœ€é€šè¿‡æ¥å£æˆ–æœåŠ¡æœºåˆ¶è§£è€¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¼å®¹æ€§è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨æ¨¡å—&lt;/strong&gt;ï¼šä¼ ç»ŸJARç½®äºæ¨¡å—è·¯å¾„æ—¶ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºæ¨¡å—ï¼ˆå¯¼å‡ºæ‰€æœ‰åŒ…ï¼Œä¾èµ–æ‰€æœ‰æ¨¡å—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªå‘½åæ¨¡å—&lt;/strong&gt;ï¼šç±»è·¯å¾„ä¸­çš„JARå½’å…¥æœªå‘½åæ¨¡å—ï¼Œæ”¯æŒæ—§ä»£ç é€æ­¥è¿ç§»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="å››å·¥å…·é“¾ä¸å¼€å‘æµç¨‹"&gt;&lt;strong&gt;å››ã€å·¥å…·é“¾ä¸å¼€å‘æµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®å·¥å…·&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;jdeps&lt;/code&gt;&lt;/strong&gt;ï¼šåˆ†æJARçš„æ¨¡å—ä¾èµ–ï¼ŒæŒ‡å¯¼è¿ç§»ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;jlink&lt;/code&gt;&lt;/strong&gt;ï¼šåˆ›å»ºå®šåˆ¶åŒ–JREé•œåƒï¼Œä»…åŒ…å«æŒ‡å®šæ¨¡å—ï¼ˆä¾‹ï¼š&lt;code&gt;jlink --add-modules java.base --output minimal-jre&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;jmod&lt;/code&gt;&lt;/strong&gt;ï¼šæ‰“åŒ…æ¨¡å—ä¸ºJMODæ ¼å¼ï¼ˆæ”¯æŒæœ¬åœ°ä»£ç ç­‰èµ„æºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¼–è¯‘ä¸è¿è¡Œ&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# ç¼–è¯‘æ¨¡å—
javac -d out --module-source-path src -m com.example.app
# è¿è¡Œæ¨¡å—
java --module-path out -m com.example.app/com.example.Main
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="äº”å®é™…åº”ç”¨åœºæ™¯ä¸æŒ‘æˆ˜"&gt;&lt;strong&gt;äº”ã€å®é™…åº”ç”¨åœºæ™¯ä¸æŒ‘æˆ˜&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹ç”¨ä¾‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¾®æœåŠ¡ä¸äº‘éƒ¨ç½²&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;jlink&lt;/code&gt;ç”Ÿæˆè½»é‡çº§é•œåƒï¼ˆä»300MB JDKç¼©å‡è‡³30MBï¼‰ï¼Œä¼˜åŒ–å®¹å™¨åŒ–éƒ¨ç½²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§å‹ç³»ç»Ÿè§£è€¦&lt;/strong&gt;ï¼šæ˜ç¡®æ¨¡å—è¾¹ç•Œï¼Œé¿å…ç±»è·¯å¾„å†²çªï¼ˆå¦‚ä¸åŒåº“çš„åŒåç±»é—®é¢˜ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç§»æŒ‘æˆ˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¡†æ¶å…¼å®¹æ€§&lt;/strong&gt;ï¼šSpring 5+éƒ¨åˆ†æ”¯æŒæ¨¡å—åŒ–ï¼Œä½†éœ€å¤„ç†è‡ªåŠ¨æ¨¡å—çš„éšå¼ä¾èµ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡å—ç²’åº¦&lt;/strong&gt;ï¼šè¿‡åº¦æ‹†åˆ†å¢åŠ ç®¡ç†æˆæœ¬ï¼Œå»ºè®®æŒ‰åŠŸèƒ½é«˜å†…èšåŸåˆ™è®¾è®¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="å…­ä¸osgiçš„å¯¹æ¯”"&gt;&lt;strong&gt;å…­ã€ä¸OSGiçš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;JPMS&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;OSGi&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®šä½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯­è¨€çº§æ¨¡å—åŒ–ï¼ˆJDKé›†æˆï¼‰&lt;/td&gt;
&lt;td&gt;åŠ¨æ€æ¨¡å—æ¡†æ¶ï¼ˆç¬¬ä¸‰æ–¹å®ç°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çƒ­éƒ¨ç½²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;æ”¯æŒåŠ¨æ€åŠ è½½/å¸è½½æ¨¡å—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–è§£æ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯åŠ¨æ—¶é™æ€éªŒè¯&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ—¶åŠ¨æ€è§£æ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;JPMSé€‚åˆåŸºç¡€æ¶æ„å°è£…ä¸éƒ¨ç½²ä¼˜åŒ–ï¼ŒOSGié€‚ç”¨äºéœ€è¿è¡Œæ—¶åŠ¨æ€ç®¡ç†çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Javaæ¨¡å—ç³»ç»Ÿé€šè¿‡&lt;strong&gt;å¼ºå°è£…&lt;/strong&gt;ã€&lt;strong&gt;æ˜¾å¼ä¾èµ–&lt;/strong&gt;å’Œ&lt;strong&gt;æœåŠ¡æœºåˆ¶&lt;/strong&gt;ï¼Œæ˜¾è‘—æå‡äº†ä»£ç å®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§å’Œéƒ¨ç½²æ•ˆç‡ã€‚å°½ç®¡è¿ç§»è¿‡ç¨‹éœ€åº”å¯¹ç”Ÿæ€å…¼å®¹æ€§æŒ‘æˆ˜ï¼ˆå¦‚Springçš„æ¸è¿›æ”¯æŒï¼‰ï¼Œä½†å…¶åœ¨äº‘åŸç”Ÿä¸åµŒå…¥å¼é¢†åŸŸçš„ä»·å€¼æ—¥ç›Šå‡¸æ˜¾ã€‚å¼€å‘è€…å¯é€šè¿‡&lt;code&gt;module-info.java&lt;/code&gt;å®šä¹‰æ¨¡å—ã€ç»“åˆ&lt;code&gt;jlink&lt;/code&gt;å®šåˆ¶è¿è¡Œæ—¶ï¼Œé€æ­¥é‡æ„é¡¹ç›®ä»¥å‘æŒ¥æ¨¡å—åŒ–ä¼˜åŠ¿ã€‚&lt;/p&gt;</description></item><item><title>ã€Javaã€‘Exception</title><link>https://dyhes.github.io/p/javaexception/</link><pubDate>Sat, 05 Jul 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javaexception/</guid><description>&lt;h2 id="exception"&gt;Exception
&lt;/h2&gt;&lt;p&gt;Java å¼‚å¸¸ä½“ç³»æ˜¯ Java ç¨‹åºé”™è¯¯å¤„ç†çš„æ ¸å¿ƒæœºåˆ¶ï¼Œé€šè¿‡åˆ†å±‚ç»“æ„å’Œæ ‡å‡†åŒ–å¤„ç†æ–¹å¼ï¼Œç¡®ä¿ç¨‹åºåœ¨é‡åˆ°é”™è¯¯æ—¶èƒ½ä¼˜é›…é™çº§æˆ–æ¢å¤ã€‚ä»¥ä¸‹ä»ä½“ç³»ç»“æ„ã€å¤„ç†æœºåˆ¶ã€æœ€ä½³å®è·µç­‰ç»´åº¦å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚å¸¸ä½“ç³»ç»“æ„ç»§æ‰¿æ ‘"&gt;âš™ï¸ &lt;strong&gt;å¼‚å¸¸ä½“ç³»ç»“æ„ï¼ˆç»§æ‰¿æ ‘ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Java å¼‚å¸¸ä½“ç³»åŸºäº &lt;code&gt;Throwable&lt;/code&gt; ç±»ï¼Œåˆ†ä¸ºä¸¤å¤§åˆ†æ”¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Error&lt;/code&gt;ï¼ˆé”™è¯¯ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šJVM æˆ–ç³»ç»Ÿèµ„æºè€—å°½å¯¼è‡´çš„ä¸¥é‡é—®é¢˜ï¼Œç¨‹åºæ— æ³•æ¢å¤ã€‚&lt;/li&gt;
&lt;li&gt;å¸¸è§ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;OutOfMemoryError&lt;/code&gt;ï¼šå †å†…å­˜è€—å°½&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;StackOverflowError&lt;/code&gt;ï¼šé€’å½’è¿‡æ·±å¯¼è‡´æ ˆæº¢å‡º&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NoClassDefFoundError&lt;/code&gt;ï¼šç±»å®šä¹‰ä¸¢å¤±ï¼ˆç¼–è¯‘å­˜åœ¨ï¼Œè¿è¡Œæ—¶ç¼ºå¤±ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Exception&lt;/code&gt;ï¼ˆå¼‚å¸¸ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šç¼–è¯‘å™¨å¼ºåˆ¶å¤„ç†ï¼ˆä¸å¤„ç†åˆ™ç¼–è¯‘å¤±è´¥ï¼‰ï¼Œé€šå¸¸ç”±å¤–éƒ¨å› ç´ å¼•å‘ï¼ˆå¦‚æ–‡ä»¶ç¼ºå¤±ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¸¸è§ç±»å‹ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¼‚å¸¸ç±»å‹&lt;/th&gt;
&lt;th&gt;è§¦å‘åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;IOException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ–‡ä»¶è¯»å†™/ç½‘ç»œé€šä¿¡å¤±è´¥&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;SQLException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“æ“ä½œé”™è¯¯&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ClassNotFoundException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åå°„åŠ è½½ä¸å­˜åœ¨çš„ç±»&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆUnchecked Exceptionï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šç¼–è¯‘å™¨ä¸å¼ºåˆ¶å¤„ç†ï¼Œç”±ä»£ç é€»è¾‘é”™è¯¯å¼•å‘ï¼ˆå¦‚ç©ºæŒ‡é’ˆã€è¶Šç•Œï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¸¸è§ç±»å‹ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¼‚å¸¸ç±»å‹&lt;/th&gt;
&lt;th&gt;è§¦å‘åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;NullPointerException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è°ƒç”¨ &lt;code&gt;null&lt;/code&gt; å¯¹è±¡çš„æ–¹æ³•/å±æ€§&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ArrayIndexOutOfBoundsException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ•°ç»„ç´¢å¼•è¶Šç•Œ&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ClassCastException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç±»å‹å¼ºåˆ¶è½¬æ¢å¤±è´¥&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚å¸¸å¤„ç†æœºåˆ¶"&gt;ğŸ› ï¸ &lt;strong&gt;å¼‚å¸¸å¤„ç†æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Java æä¾›å››ç§å…³é”®å­—å¤„ç†å¼‚å¸¸ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;try-catch-finally&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;try&lt;/code&gt;&lt;/strong&gt;ï¼šåŒ…è£¹å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç å—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;catch&lt;/code&gt;&lt;/strong&gt;ï¼šæ•è·æŒ‡å®šç±»å‹å¼‚å¸¸å¹¶å¤„ç†ï¼ˆæ”¯æŒå¤š &lt;code&gt;catch&lt;/code&gt; å—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;finally&lt;/code&gt;&lt;/strong&gt;ï¼šæ— è®ºæ˜¯å¦å¼‚å¸¸ï¼Œå‡æ‰§è¡Œï¼ˆå¸¸ç”¨äºé‡Šæ”¾èµ„æºï¼‰&lt;a class="link" href="@ref" &gt;1,4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
FileInputStream file = new FileInputStream(&amp;#34;test.txt&amp;#34;); // å¯èƒ½æŠ›å‡º FileNotFoundException
} catch (FileNotFoundException e) {
System.out.println(&amp;#34;æ–‡ä»¶æœªæ‰¾åˆ°: &amp;#34; + e.getMessage());
} finally {
System.out.println(&amp;#34;èµ„æºæ¸…ç†å®Œæˆ&amp;#34;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;throw&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ä»£ç ä¸­
ä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸å¯¹è±¡
ï¼ˆå¦‚å‚æ•°æ ¡éªŒå¤±è´¥æ—¶ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;if (age &amp;lt; 0) {
throw new IllegalArgumentException(&amp;#34;å¹´é¾„ä¸èƒ½ä¸ºè´Ÿæ•°&amp;#34;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;throws&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨æ–¹æ³•ç­¾åä¸­
å£°æ˜å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸
ï¼Œå¼ºåˆ¶è°ƒç”¨æ–¹å¤„ç†ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public void readFile() throws IOException {
// å¯èƒ½æŠ›å‡º IOException çš„ä»£ç 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;try-with-resources&lt;/code&gt;ï¼ˆJava 7+ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨å…³é—­èµ„æº
ï¼ˆå¦‚æµã€è¿æ¥ï¼‰ï¼Œé¿å…&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; finally
```
å—å†—ä½™ä»£ç ï¼š
```
try (FileInputStream fis = new FileInputStream(&amp;#34;file.txt&amp;#34;)) {
// ä½¿ç”¨èµ„æº
} catch (IOException e) {
e.printStackTrace();
}
```
------
### ğŸ§© **è‡ªå®šä¹‰å¼‚å¸¸**
é€šè¿‡ç»§æ‰¿ `Exception` æˆ– `RuntimeException` åˆ›å»ºä¸šåŠ¡ç›¸å…³å¼‚å¸¸ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// è‡ªå®šä¹‰å—æ£€å¼‚å¸¸ï¼ˆéœ€å¤„ç†ï¼‰
public class InsufficientBalanceException extends Exception {
public InsufficientBalanceException(String message) {
super(message);
}
}&lt;/p&gt;
&lt;p&gt;// è‡ªå®šä¹‰éå—æ£€å¼‚å¸¸ï¼ˆå¯é€‰å¤„ç†ï¼‰
public class InvalidInputException extends RuntimeException {
public InvalidInputException(String message) {
super(message);
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**ä½¿ç”¨åœºæ™¯**ï¼š
- ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼ˆå¦‚ä½™é¢ä¸è¶³ã€æ— æ•ˆå‚æ•°ï¼‰ã€‚
- éœ€ä¸å†…ç½®å¼‚å¸¸åŒºåˆ†ï¼Œæå‡ä»£ç å¯è¯»æ€§[2,4,7](@ref)ã€‚
------
### ğŸ† **å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ**
1. **åŒºåˆ†å¼‚å¸¸ç±»å‹**
- **å¯æ¢å¤é”™è¯¯** â†’ ä½¿ç”¨**å—æ£€å¼‚å¸¸**ï¼ˆå¦‚æ–‡ä»¶é‡è¯•ï¼‰ã€‚
- **é€»è¾‘é”™è¯¯** â†’ ä½¿ç”¨**éå—æ£€å¼‚å¸¸**ï¼ˆå¦‚å‚æ•°æ ¡éªŒï¼‰[1,4](@ref)ã€‚
2. **èµ„æºç®¡ç†**
- **ä¼˜å…ˆ `try-with-resources`** æ›¿ä»£æ‰‹åŠ¨ `finally` å…³é—­[4,8](@ref)ã€‚
3. **é¿å…å¸¸è§åæ¨¡å¼**
- âŒ ä¸åœ¨ `finally` ä¸­ä½¿ç”¨ `return`ï¼ˆè¦†ç›–åŸå§‹è¿”å›å€¼ï¼‰[4](@ref)ã€‚
- âŒ é¿å…ç©º `catch` å—ï¼ˆéšè—é”™è¯¯ï¼‰ã€‚
- âŒ å‹¿ç”¨ `Exception` æ•è·æ‰€æœ‰å¼‚å¸¸ï¼ˆä¸§å¤±é’ˆå¯¹æ€§ï¼‰[4,5](@ref)ã€‚
4. **æ—¥å¿—ä¸æ ¹å› **
- è®°å½•å®Œæ•´å †æ ˆï¼ˆ`e.printStackTrace()`ï¼‰åŠæ ¹å› ï¼ˆ`e.getCause()`ï¼‰[1,4](@ref)ã€‚
5. **æ€§èƒ½ä¼˜åŒ–**
- å‡å°‘ `try` å—ä»£ç é‡ï¼ˆé¿å…ä¸å¿…è¦çš„æ€§èƒ½æŸè€—ï¼‰ã€‚
- å¼‚å¸¸å®ä¾‹æ„é€ æˆæœ¬é«˜ï¼Œé¿å…æ»¥ç”¨[4](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“**
Java å¼‚å¸¸ä½“ç³»é€šè¿‡åˆ†å±‚åˆ†ç±»ï¼ˆ`Error`/`Exception`ï¼‰å’Œæ ‡å‡†åŒ–å¤„ç†æœºåˆ¶ï¼ˆ`try-catch`/`throw`/`throws`ï¼‰ï¼Œç»“åˆè‡ªå®šä¹‰å¼‚å¸¸ä¸æœ€ä½³å®è·µï¼ˆå¦‚èµ„æºè‡ªåŠ¨å…³é—­ã€ç²¾å‡†æ•è·ï¼‰ï¼Œæ˜¾è‘—æå‡ç¨‹åºçš„å¥å£®æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚æ·±å…¥ç†è§£å…¶è®¾è®¡å“²å­¦ï¼ˆå¦‚å—æ£€ vs. éå—æ£€å¼‚å¸¸ï¼‰ï¼Œæ˜¯å†™å‡ºé«˜è´¨é‡ Java ä»£ç çš„å…³é”®[1,3,4](@ref)ã€‚
## ç¼–è¯‘æ—¶å¼‚å¸¸
IOExceptionã€SQLException ç­‰å¼‚å¸¸è¢«è®¾è®¡ä¸º**ç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰**ï¼Œç¡®å®æ˜¯ Java è¯­è¨€çš„ä¸€ç§ç‹¬ç‰¹è®¾è®¡å“²å­¦ã€‚å°½ç®¡è¿™äº›å¼‚å¸¸çš„å®é™…è§¦å‘å‘ç”Ÿåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œä½†ç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µå°±å¼ºåˆ¶è¦æ±‚å¼€å‘è€…å¤„ç†å®ƒä»¬ã€‚è¿™ç§è®¾è®¡èƒŒåçš„é€»è¾‘å’Œå®é™…æ„ä¹‰å¦‚ä¸‹ï¼š
------
### â±ï¸ **ç¼–è¯‘æ—¶å¼‚å¸¸çš„æœ¬è´¨ï¼šè¿è¡Œæ—¶è§¦å‘ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥**
1. **åç§°çš„è¯¯å¯¼æ€§**
&amp;#34;ç¼–è¯‘æ—¶å¼‚å¸¸&amp;#34;å¹¶éæŒ‡å¼‚å¸¸åœ¨ç¼–è¯‘æ—¶å‘ç”Ÿï¼Œè€Œæ˜¯æŒ‡**ç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µä¼šæ£€æŸ¥è¿™äº›å¼‚å¸¸æ˜¯å¦è¢«æ­£ç¡®å¤„ç†**ã€‚çœŸæ­£çš„å¼‚å¸¸è§¦å‘ä»éœ€åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰ä¼šå‡ºç°[1,3,9](@ref)ã€‚
- ä¾‹å¦‚ï¼Œ`FileNotFoundException` åªæœ‰åœ¨æ‰§è¡Œ `new FileReader(&amp;#34;missing.txt&amp;#34;)` æ—¶æ‰ä¼šè§¦å‘ï¼Œä½†ç¼–è¯‘å™¨è¦æ±‚å¼€å‘è€…æå‰å¤„ç†è¿™ç§å¯èƒ½æ€§ã€‚
2. **è®¾è®¡ç›®çš„ï¼šå¼ºåˆ¶é”™è¯¯é¢„æ¡ˆ**
Java é€šè¿‡å¼ºåˆ¶å¤„ç†è¿™ç±»å¼‚å¸¸ï¼Œç¡®ä¿å¼€å‘è€…**æå‰è€ƒè™‘å¤–éƒ¨ä¾èµ–çš„å¤±è´¥åœºæ™¯**â€‹ï¼ˆå¦‚æ–‡ä»¶ä¸¢å¤±ã€ç½‘ç»œä¸­æ–­ã€æ•°æ®åº“è¿æ¥å¤±è´¥ï¼‰ï¼Œé¿å…è¿è¡Œæ—¶å› æœªå¤„ç†å¼‚å¸¸å¯¼è‡´ç¨‹åºå´©æºƒ[3,5,9](@ref)ã€‚
------
### ğŸ“ **ä¸ºä½•å¼ºåˆ¶å¤„ç†å¤–éƒ¨ä¾èµ–å¼‚å¸¸ï¼Ÿ**
1. **å¯é¢„è§æ€§ä¸å¯æ¢å¤æ€§**
- **å¯é¢„è§æ€§**ï¼šæ–‡ä»¶ä¸å­˜åœ¨ã€ç½‘ç»œä¸­æ–­ç­‰æ˜¯**å¤–éƒ¨ç¯å¢ƒå¼•å‘çš„å¸¸è§é—®é¢˜**ï¼Œéç¨‹åºé€»è¾‘é”™è¯¯ã€‚å¼€å‘è€…åº”é¢„è§åˆ°è¿™äº›åœºæ™¯å¹¶è®¾è®¡å¤‡é€‰æ–¹æ¡ˆï¼ˆå¦‚é‡è¯•ã€æç¤ºç”¨æˆ·ã€åˆ‡æ¢å¤‡ç”¨èµ„æºï¼‰[3,9](@ref)ã€‚
- **å¯æ¢å¤æ€§**ï¼šè¿™ç±»å¼‚å¸¸é€šå¸¸å¯é€šè¿‡å¹²é¢„æ¢å¤ï¼ˆå¦‚é‡æ–°ä¸Šä¼ æ–‡ä»¶ï¼‰ï¼Œè€Œè¿è¡Œæ—¶å¼‚å¸¸ï¼ˆå¦‚ç©ºæŒ‡é’ˆï¼‰å¾€å¾€åæ˜ ä»£ç ç¼ºé™·ï¼Œéš¾ä»¥ç«‹å³æ¢å¤[3,8](@ref)ã€‚
2. **API å¥‘çº¦çš„æ˜ç¡®æ€§**
æ–¹æ³•ç­¾åä¸­çš„ `throws` å…³é”®å­—æ˜¯ä¸€ç§**æ˜¾å¼å¥‘çº¦**ï¼Œæ˜ç¡®å‘ŠçŸ¥è°ƒç”¨è€…ï¼šâ€œæœ¬æ–¹æ³•å¯èƒ½å› å¤–éƒ¨é—®é¢˜å¤±è´¥ï¼Œè¯·åšå¥½åº”å¯¹å‡†å¤‡â€[5,9](@ref)ã€‚ä¾‹å¦‚ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;public void readConfig() throws IOException {
// è¯»å–é…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶å¯èƒ½ä¸å­˜åœ¨
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;è°ƒç”¨æ–¹å¿…é¡»é€‰æ‹©ï¼šæ•è·å¤„ç†æˆ–ç»§ç»­å‘ä¸ŠæŠ›å‡ºã€‚è¿™ç§è®¾è®¡å¢å¼ºäº†ä»£ç çš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
3. **ä¸è¿è¡Œæ—¶å¼‚å¸¸çš„åŒºåˆ«**
| **ç‰¹æ€§** | **ç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆCheckedï¼‰** | **è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆUncheckedï¼‰** |
| ------------ | ------------------------------- | ------------------------------------------------------------ |
| **è§¦å‘åŸå› ** | å¤–éƒ¨ç¯å¢ƒé—®é¢˜ï¼ˆæ–‡ä»¶ã€ç½‘ç»œç­‰ï¼‰ | ç¨‹åºé€»è¾‘é”™è¯¯ï¼ˆç©ºæŒ‡é’ˆã€è¶Šç•Œç­‰ï¼‰ |
| **å¤„ç†è¦æ±‚** | å¼ºåˆ¶å¤„ç†ï¼ˆtry-catch æˆ– throwsï¼‰ | éå¼ºåˆ¶ï¼Œå¯é€šè¿‡ä»£ç é€»è¾‘é¿å… |
| **å…¸å‹ä»£è¡¨** | `IOException`, `SQLException` | `NullPointerException`, `IllegalArgumentException`[2,5](@ref) |
------
### âš–ï¸ **äº‰è®®ä¸æƒè¡¡**
å°½ç®¡å¼ºåˆ¶å¤„ç†èƒ½æå‡å¥å£®æ€§ï¼Œä½†ä¹Ÿå¼•å‘äº†ä¸€äº›äº‰è®®ï¼š
1. **ä»£ç å†—ä½™é—®é¢˜**
å±‚å±‚å£°æ˜ `throws` æˆ–åœ¨æ¯ä¸ªè°ƒç”¨å¤„å†™ `try-catch` å¯èƒ½å¯¼è‡´ä»£ç è‡ƒè‚¿ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåº•å±‚æ–‡ä»¶æ“ä½œå¯èƒ½è¿«ä½¿æ‰€æœ‰ä¸Šå±‚æ–¹æ³•æ·»åŠ  `throws IOException`[9](@ref)ã€‚
â€‹**è§£å†³æ–¹æ¡ˆ**â€‹ï¼šå°†å—æ£€å¼‚å¸¸åŒ…è£…æˆéå—æ£€å¼‚å¸¸ï¼ˆå¦‚ `RuntimeException`ï¼‰ï¼Œä½†éœ€ä¿ç•™åŸå§‹å¼‚å¸¸é“¾ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;try {
readFile();
} catch (IOException e) {
throw new RuntimeException(&amp;ldquo;æ–‡ä»¶æ“ä½œå¤±è´¥&amp;rdquo;, e); // åŒ…è£…ä¸ºè¿è¡Œæ—¶å¼‚å¸¸
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;2. **è¯­è¨€è®¾è®¡çš„å·®å¼‚**
- **Java çš„ä¿å®ˆç­–ç•¥**ï¼šå¼ºè°ƒâ€œäº‹å‰é˜²å¾¡â€ï¼Œç¡®ä¿æ‰€æœ‰å¤–éƒ¨é£é™©è¢«æ˜¾å¼å¤„ç†ã€‚
- **å…¶ä»–è¯­è¨€çš„é€‰æ‹©**ï¼šå¦‚ C#ã€Python ä¸å¼ºåˆ¶å¤„ç†ç±»ä¼¼å¼‚å¸¸ï¼Œæ›´æ³¨é‡å¼€å‘æ•ˆç‡ï¼Œä½†å¯èƒ½æ©ç›–æ½œåœ¨é”™è¯¯[3,9](@ref)ã€‚
------
### ğŸ› ï¸ **å®è·µå»ºè®®**
1. **åˆç†é€‰æ‹©å¼‚å¸¸ç±»å‹**
- å¤–éƒ¨ä¾èµ–å¤±è´¥ â†’ ä½¿ç”¨ **å—æ£€å¼‚å¸¸**ï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ–­å¼€ï¼‰ã€‚
- å‚æ•°æ ¡éªŒå¤±è´¥ â†’ ä½¿ç”¨ **éå—æ£€å¼‚å¸¸**ï¼ˆå¦‚ `IllegalArgumentException`ï¼‰[5,9](@ref)ã€‚
2. **é¿å…ç©º catch å—**
å³ä½¿æ•è·å¼‚å¸¸ï¼Œä¹Ÿéœ€è®°å½•æ—¥å¿—æˆ–æä¾›é™çº§é€»è¾‘ï¼Œè€Œéå¿½ç•¥ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;try {
saveToDatabase(data);
} catch (SQLException e) {
log.error(&amp;ldquo;æ•°æ®åº“å†™å…¥å¤±è´¥ï¼Œå¯ç”¨æœ¬åœ°ç¼“å­˜&amp;rdquo;, e); // è®°å½•å¹¶å¯ç”¨å¤‡ç”¨æ–¹æ¡ˆ
cache.saveLocally(data);
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;3. **åˆ©ç”¨ try-with-resources ç®€åŒ–**
è‡ªåŠ¨å…³é—­èµ„æºï¼ˆå¦‚æ–‡ä»¶æµã€æ•°æ®åº“è¿æ¥ï¼‰ï¼Œé¿å… `finally` å—çš„å†—ä½™ä»£ç [1,2](@ref)ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;try (Connection conn = DriverManager.getConnection(url)) {
// è‡ªåŠ¨å…³é—­ connï¼Œæ— éœ€æ‰‹åŠ¨å†™ finally
} catch (SQLException e) {
// å¤„ç†å¼‚å¸¸
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ’ **æ€»ç»“**
IOExceptionã€SQLException ç­‰è¢«è®¾è®¡ä¸ºç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œæ ¸å¿ƒç›®çš„æ˜¯**é€šè¿‡ç¼–è¯‘å™¨å¼ºåˆ¶åŠ›ï¼Œç¡®ä¿å¼€å‘è€…å¯¹å¤–éƒ¨ç¯å¢ƒé£é™©æå‰é¢„æ¡ˆ**ã€‚å°½ç®¡å®é™…å¼‚å¸¸åœ¨è¿è¡Œæ—¶è§¦å‘ï¼Œä½†ç¼–è¯‘é˜¶æ®µçš„æ£€æŸ¥æœºåˆ¶è¿«ä½¿ä»£ç å…·å¤‡æ›´å¼ºçš„å®¹é”™èƒ½åŠ›ï¼Œä½“ç°äº† Java â€œé˜²å¾¡æ€§ç¼–ç¨‹â€çš„è®¾è®¡å“²å­¦ã€‚æƒè¡¡ä»£ç å†—ä½™ä¸å¥å£®æ€§æ—¶ï¼Œå¯é€šè¿‡åŒ…è£…å¼‚å¸¸ã€åˆç†åˆ†ç±»å¼‚å¸¸ç±»å‹æ¥ä¼˜åŒ–[3,5,9](@ref)ã€‚
æ˜¯çš„ï¼Œ**ç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰å¦‚æœæ²¡æœ‰åœ¨ä»£ç ä¸­æ˜¾å¼å¤„ç†ï¼Œç¼–è¯‘å™¨ä¼šæ‹’ç»ç¼–è¯‘ï¼Œå¯¼è‡´ç¨‹åºæ— æ³•é€šè¿‡ç¼–è¯‘é˜¶æ®µ**ã€‚è¿™æ˜¯ Java å¼‚å¸¸å¤„ç†æœºåˆ¶çš„æ ¸å¿ƒè®¾è®¡ä¹‹ä¸€ï¼Œç›®çš„æ˜¯å¼ºåˆ¶å¼€å‘è€…åº”å¯¹å¤–éƒ¨ç¯å¢ƒå¯èƒ½å¼•å‘çš„é£é™©ï¼ˆå¦‚æ–‡ä»¶ä¸å­˜åœ¨ã€ç½‘ç»œä¸­æ–­ç­‰ï¼‰ã€‚
ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š
### âš™ï¸ **ç¼–è¯‘å™¨æ‹’ç»ç¼–è¯‘çš„åŸå› **
1. **å¼ºåˆ¶é”™è¯¯é¢„æ¡ˆ**
ç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆå¦‚ `IOException`ã€`SQLException`ï¼‰é€šå¸¸ç”±**å¤–éƒ¨ä¾èµ–çš„ä¸ç¡®å®šæ€§**å¼•å‘ï¼ˆä¾‹å¦‚æ–‡ä»¶ä¸¢å¤±ã€æ•°æ®åº“è¿æ¥å¤±è´¥ï¼‰ã€‚Java ç¼–è¯‘å™¨è¦æ±‚å¼€å‘è€…å¿…é¡»é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¹‹ä¸€å¤„ç†è¿™ç±»å¼‚å¸¸[1,3,5](@ref)ï¼š
- **`try-catch` æ•è·**ï¼šåœ¨æ–¹æ³•å†…éƒ¨ç›´æ¥å¤„ç†å¼‚å¸¸ã€‚
- **`throws` å£°æ˜**ï¼šåœ¨æ–¹æ³•ç­¾åä¸­å£°æ˜å¼‚å¸¸ï¼Œå°†å¤„ç†è´£ä»»äº¤ç»™è°ƒç”¨è€…ã€‚
è‹¥æœªé‡‡ç”¨ä»»ä¸€æ–¹å¼ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™å¹¶ä¸­æ–­ç¼–è¯‘è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// æœªå¤„ç†ç¼–è¯‘æ—¶å¼‚å¸¸ â†’ ç¼–è¯‘å¤±è´¥
public void readFile() {
FileReader file = new FileReader(&amp;ldquo;test.txt&amp;rdquo;); // âŒ æœªå¤„ç† IOException
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ” **ç¼–è¯‘æ—¶å¼‚å¸¸ä¸è¿è¡Œæ—¶å¼‚å¸¸çš„åŒºåˆ«**
| **ç‰¹æ€§** | **ç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰** | **è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆUnchecked Exceptionï¼‰** |
| -------------- | ------------------------------------------------------- | -------------------------------------------------------- |
| **å¤„ç†å¼ºåˆ¶åŠ›** | å¿…é¡»æ˜¾å¼å¤„ç†ï¼ˆå¦åˆ™ç¼–è¯‘å¤±è´¥ï¼‰ | éå¼ºåˆ¶ï¼ˆå¯å¤„ç†ä¹Ÿå¯å¿½ç•¥ï¼‰ |
| **å¸¸è§ç±»å‹** | `IOException`ã€`SQLException`ã€`ClassNotFoundException` | `NullPointerException`ã€`ArrayIndexOutOfBoundsException` |
| **è®¾è®¡ç›®çš„** | å¼ºåˆ¶åº”å¯¹å¤–éƒ¨ç¯å¢ƒé£é™©ï¼ˆå¦‚æ–‡ä»¶/ç½‘ç»œé—®é¢˜ï¼‰ | æç¤ºä»£ç é€»è¾‘é”™è¯¯ï¼ˆå¦‚ç©ºæŒ‡é’ˆã€è¶Šç•Œè®¿é—®ï¼‰ |
**ç¤ºä¾‹å¯¹æ¯”**ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// ç¼–è¯‘æ—¶å¼‚å¸¸ï¼šå¿…é¡»å¤„ç†
public void loadConfig() throws FileNotFoundException {
FileReader file = new FileReader(&amp;ldquo;config.txt&amp;rdquo;); // âœ… é€šè¿‡ throws å£°æ˜
}&lt;/p&gt;
&lt;p&gt;// è¿è¡Œæ—¶å¼‚å¸¸ï¼šæ— éœ€å¼ºåˆ¶å¤„ç†
public void calculate() {
int result = 10 / 0; // â— æŠ›å‡º ArithmeticExceptionï¼Œä½†ç¼–è¯‘å™¨ä¸æ£€æŸ¥
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ› ï¸ **å¦‚ä½•æ­£ç¡®å¤„ç†ç¼–è¯‘æ—¶å¼‚å¸¸**
1. **`try-catch` æ•è·å¤„ç†**
åœ¨æ–¹æ³•å†…éƒ¨ç›´æ¥å¤„ç†å¼‚å¸¸é€»è¾‘ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;public void readFile() {
try {
FileReader file = new FileReader(&amp;ldquo;test.txt&amp;rdquo;);
} catch (FileNotFoundException e) {
System.out.println(&amp;ldquo;æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå¯ç”¨é»˜è®¤é…ç½®&amp;rdquo;);
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;2. **`throws` å£°æ˜ä¼ é€’**
å°†å¼‚å¸¸æŠ›ç»™è°ƒç”¨è€…å¤„ç†ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;public void readFile() throws IOException {
FileReader file = new FileReader(&amp;ldquo;test.txt&amp;rdquo;);
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**æ³¨æ„**ï¼šè°ƒç”¨æ­¤æ–¹æ³•çš„ä¸Šå±‚ä»£ç ä»éœ€å¤„ç†è¯¥å¼‚å¸¸ï¼ˆç»§ç»­ `try-catch` æˆ– `throws`ï¼‰[3,6,8](@ref)ã€‚
3. **è‡ªåŠ¨èµ„æºç®¡ç†ï¼ˆJava 7+ï¼‰**
ä½¿ç”¨ `try-with-resources` ç®€åŒ–èµ„æºå…³é—­ï¼ŒåŒæ—¶éšå¼å¤„ç†å¼‚å¸¸ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;try (FileReader file = new FileReader(&amp;ldquo;test.txt&amp;rdquo;)) {
// è‡ªåŠ¨å…³é—­èµ„æºï¼Œæ— éœ€ finally
} catch (IOException e) {
e.printStackTrace();
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ’ **æ€»ç»“**
- âœ… **ç¼–è¯‘æ—¶å¼‚å¸¸å¿…é¡»å¤„ç†**ï¼šå¦åˆ™ç¼–è¯‘å™¨ç›´æ¥æŠ¥é”™ï¼Œç¨‹åºæ— æ³•è¿è¡Œã€‚
- âš ï¸ **è¿è¡Œæ—¶å¼‚å¸¸æ— éœ€å¼ºåˆ¶å¤„ç†**ï¼šç”±å¼€å‘è€…è‡ªè¡Œå†³å®šæ˜¯å¦æ•è·ï¼ˆå¦‚é€šè¿‡åˆ¤ç©ºé¿å… `NullPointerException`ï¼‰ã€‚
- **è®¾è®¡å“²å­¦**ï¼šJava é€šè¿‡å¼ºåˆ¶å¤„ç†ç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œç¡®ä¿ç¨‹åºå¯¹å¤–éƒ¨é£é™©ï¼ˆå¦‚ I/Oã€æ•°æ®åº“é—®é¢˜ï¼‰å…·å¤‡é˜²å¾¡èƒ½åŠ›ï¼Œä»è€Œæå‡å¥å£®æ€§[3,5,7](@ref)ã€‚
&amp;gt; è‹¥å¿½ç•¥ç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œé”™è¯¯å°†åœ¨ç¼–è¯‘é˜¶æ®µè¢«æ‹¦æˆªï¼Œè€Œéè¿è¡Œæ—¶å´©æºƒï¼Œè¿™æ­£æ˜¯ Java â€œæ—©å¤±è´¥ã€æ—©ä¿®å¤â€åŸåˆ™çš„ä½“ç°ã€‚
## å­—èŠ‚æµ
Javaå­—èŠ‚æµä½“ç³»æ˜¯Java I/Oåº“çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€è§†é¢‘ã€å‹ç¼©æ–‡ä»¶ç­‰ï¼‰æˆ–åŸºäºå­—èŠ‚çš„æ–‡æœ¬æ•°æ®ã€‚å…¶è®¾è®¡åŸºäºæŠ½è±¡åŸºç±»`InputStream`å’Œ`OutputStream`ï¼Œé€šè¿‡å­ç±»å®ç°ä¸åŒåœºæ™¯ä¸‹çš„åŠŸèƒ½æ‰©å±•ã€‚ä»¥ä¸‹ä»ç»§æ‰¿å…³ç³»ã€æ ¸å¿ƒç±»åŠŸèƒ½åŠè®¾è®¡æ¨¡å¼ç­‰ç»´åº¦ç³»ç»Ÿè§£æï¼š
------
### âš™ï¸ **å­—èŠ‚æµä½“ç³»æ¦‚è¿°**
#### **åŸºç±»ä¸è®¾è®¡åŸåˆ™**
- **`InputStream`**ï¼šæ‰€æœ‰å­—èŠ‚è¾“å…¥æµçš„æŠ½è±¡åŸºç±»ï¼Œå®šä¹‰è¯»å–æ•°æ®çš„é€šç”¨æ–¹æ³•ï¼ˆå¦‚`read()`ï¼‰[3,6](@ref)ã€‚
- **`OutputStream`**ï¼šæ‰€æœ‰å­—èŠ‚è¾“å‡ºæµçš„æŠ½è±¡åŸºç±»ï¼Œå®šä¹‰å†™å…¥æ•°æ®çš„é€šç”¨æ–¹æ³•ï¼ˆå¦‚`write()`ï¼‰[3,6](@ref)ã€‚
- **è®¾è®¡æ¨¡å¼**ï¼šé‡‡ç”¨**è£…é¥°å™¨æ¨¡å¼**ï¼Œé€šè¿‡`FilterInputStream`å’Œ`FilterOutputStream`ä¸ºæµåŠ¨æ€æ·»åŠ åŠŸèƒ½ï¼ˆå¦‚ç¼“å†²ã€æ•°æ®ç±»å‹å¤„ç†ï¼‰[6](@ref)ã€‚
#### **å­—èŠ‚æµä¸å­—ç¬¦æµçš„åŒºåˆ«**
| **ç‰¹æ€§** | å­—èŠ‚æµï¼ˆ`InputStream`/`OutputStream`ï¼‰ | å­—ç¬¦æµï¼ˆ`Reader`/`Writer`ï¼‰ |
| -------- | ----------------------------------------- | ------------------------------ |
| æ•°æ®å•ä½ | å­—èŠ‚ï¼ˆ8bitï¼‰ | å­—ç¬¦ï¼ˆ16bit Unicodeï¼‰ |
| é€‚ç”¨åœºæ™¯ | å›¾ç‰‡ã€è§†é¢‘ã€äºŒè¿›åˆ¶æ–‡ä»¶ | æ–‡æœ¬æ–‡ä»¶ï¼ˆè‡ªåŠ¨å¤„ç†ç¼–ç ï¼‰ |
| å…¸å‹å­ç±» | `FileInputStream`, `BufferedOutputStream` | `FileReader`, `BufferedWriter` |
------
### ğŸ” **è¾“å…¥æµï¼ˆ`InputStream`ï¼‰ç»§æ‰¿ä½“ç³»**
#### **æ ¸å¿ƒå­ç±»åŠåŠŸèƒ½**
- **`FileInputStream`**
- **åŠŸèƒ½**ï¼šä»æ–‡ä»¶è¯»å–å­—èŠ‚æ•°æ®ï¼Œé€‚ç”¨äºæœ¬åœ°æ–‡ä»¶æ“ä½œ[1,4](@ref)ã€‚
- **æ„é€ æ–¹æ³•**ï¼š`FileInputStream(File file)` æˆ– `FileInputStream(String path)`ã€‚
- ç¤ºä¾‹ï¼š
```
try (InputStream is = new FileInputStream(&amp;#34;data.bin&amp;#34;)) {
int byteData;
while ((byteData = is.read()) != -1) { /* å¤„ç†å­—èŠ‚ */ }
}
```
- **`ByteArrayInputStream`**
- **åŠŸèƒ½**ï¼šä»å†…å­˜ä¸­çš„å­—èŠ‚æ•°ç»„è¯»å–æ•°æ®ï¼Œæ— éœ€å…³é—­[1,6](@ref)ã€‚
- **ä½¿ç”¨åœºæ™¯**ï¼šæµ‹è¯•æˆ–å†…å­˜æ•°æ®è½¬æ¢ã€‚
- **`SequenceInputStream`**
- **åŠŸèƒ½**ï¼šä¸²è”å¤šä¸ªè¾“å…¥æµï¼ˆå¦‚åˆå¹¶å¤šä¸ªæ–‡ä»¶ï¼‰[1,3](@ref)ã€‚
- **æ„é€ æ–¹æ³•**ï¼š`SequenceInputStream(InputStream s1, InputStream s2)`ã€‚
- **`ObjectInputStream`**
- **åŠŸèƒ½**ï¼šååºåˆ—åŒ–å¯¹è±¡ï¼ˆéœ€é…åˆ`Serializable`æ¥å£ï¼‰[1,6](@ref)ã€‚
#### **è¿‡æ»¤æµï¼ˆåŠŸèƒ½å¢å¼ºç±»ï¼‰**
- **`BufferedInputStream`**
- **åŠŸèƒ½**ï¼šæ·»åŠ ç¼“å†²åŒºï¼ˆé»˜è®¤8KBï¼‰ï¼Œå‡å°‘ç£ç›˜I/Oæ¬¡æ•°ï¼Œæå‡è¯»å–æ•ˆç‡[1,4](@ref)ã€‚
- **ç»§æ‰¿é“¾**ï¼š`FilterInputStream â†’ BufferedInputStream`[6](@ref)ã€‚
- **`DataInputStream`**
- **åŠŸèƒ½**ï¼šè¯»å–åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚`readInt()`, `readDouble()`ï¼‰[3,6](@ref)ã€‚
- å…¸å‹ç”¨æ³•ï¼š
```
try (DataInputStream dis = new DataInputStream(new FileInputStream(&amp;#34;data.bin&amp;#34;))) {
int num = dis.readInt();
}
```
- **`PushbackInputStream`**
- **åŠŸèƒ½**ï¼šæ”¯æŒâ€œå›é€€â€å·²è¯»å–çš„å­—èŠ‚ï¼ˆ`unread()`æ–¹æ³•ï¼‰[6](@ref)ã€‚
------
### ğŸ“¤ **è¾“å‡ºæµï¼ˆ`OutputStream`ï¼‰ç»§æ‰¿ä½“ç³»**
#### **æ ¸å¿ƒå­ç±»åŠåŠŸèƒ½**
- **`FileOutputStream`**
- **åŠŸèƒ½**ï¼šå‘æ–‡ä»¶å†™å…¥å­—èŠ‚ï¼Œæ”¯æŒè¿½åŠ æ¨¡å¼ï¼ˆ`append=true`ï¼‰[4,6](@ref)ã€‚
- **æ³¨æ„**ï¼šæ–‡ä»¶ä¸å­˜åœ¨æ—¶è‡ªåŠ¨åˆ›å»ºï¼Œå­˜åœ¨æ—¶é»˜è®¤è¦†ç›–ï¼ˆé™¤é`append=true`ï¼‰ã€‚
- **`ByteArrayOutputStream`**
- **åŠŸèƒ½**ï¼šå°†æ•°æ®å†™å…¥å†…å­˜å­—èŠ‚æ•°ç»„ï¼Œå¯é€šè¿‡`toByteArray()`è·å–æ•°æ®[6](@ref)ã€‚
- **`ObjectOutputStream`**
- **åŠŸèƒ½**ï¼šåºåˆ—åŒ–å¯¹è±¡åˆ°å­—èŠ‚æµ[1,6](@ref)ã€‚
#### **è¿‡æ»¤æµï¼ˆåŠŸèƒ½å¢å¼ºç±»ï¼‰**
- **`BufferedOutputStream`**
- **åŠŸèƒ½**ï¼šæ·»åŠ ç¼“å†²åŒºï¼Œæ‰¹é‡å†™å…¥æ•°æ®ï¼ˆéœ€æ‰‹åŠ¨`flush()`æˆ–ç¼“å†²åŒºæ»¡æ—¶è‡ªåŠ¨å†™å…¥ï¼‰[3,4](@ref)ã€‚
- **`DataOutputStream`**
- **åŠŸèƒ½**ï¼šå†™å…¥åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚`writeInt()`, `writeUTF()`ï¼‰[3,6](@ref)ã€‚
- **`PrintStream`**
- **åŠŸèƒ½**ï¼šæ ¼å¼åŒ–è¾“å‡ºï¼ˆå¦‚`System.out`ï¼‰[6](@ref)ã€‚
------
### ğŸ§© **ç±»å…³ç³»ä¸è®¾è®¡æ¨¡å¼**
#### **ç»§æ‰¿å…³ç³»æ ‘**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;graph TD
%% è¾“å…¥æµä½“ç³»
A[InputStream] &amp;ndash;&amp;gt; B(FileInputStream)
A &amp;ndash;&amp;gt; C(ByteArrayInputStream)
A &amp;ndash;&amp;gt; D(FilterInputStream)
D &amp;ndash;&amp;gt; E(BufferedInputStream)
D &amp;ndash;&amp;gt; F(DataInputStream)
D &amp;ndash;&amp;gt; G(PushbackInputStream)
A &amp;ndash;&amp;gt; H(ObjectInputStream)
A &amp;ndash;&amp;gt; I(PipedInputStream)
A &amp;ndash;&amp;gt; J(SequenceInputStream)&lt;/p&gt;
&lt;p&gt;%% è¾“å‡ºæµä½“ç³»
K[OutputStream] &amp;ndash;&amp;gt; L(FileOutputStream)
K &amp;ndash;&amp;gt; M(ByteArrayOutputStream)
K &amp;ndash;&amp;gt; N(FilterOutputStream)
N &amp;ndash;&amp;gt; O(BufferedOutputStream)
N &amp;ndash;&amp;gt; P(DataOutputStream)
N &amp;ndash;&amp;gt; Q(PrintStream)
K &amp;ndash;&amp;gt; R(ObjectOutputStream)
K &amp;ndash;&amp;gt; S(PipedOutputStream)&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **è£…é¥°å™¨æ¨¡å¼çš„åº”ç”¨**
- æ ¸å¿ƒæ€æƒ³ï¼šé€šè¿‡åµŒå¥—æµå åŠ åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// ç»„åˆç¼“å†²æµ+æ–‡ä»¶æµ+æ•°æ®ç±»å‹å¤„ç†
DataInputStream dis = new DataInputStream(
new BufferedInputStream(
new FileInputStream(&amp;ldquo;data.bin&amp;rdquo;)
)
);&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **ä¼˜åŠ¿**ï¼šçµæ´»æ‰©å±•åŠŸèƒ½ï¼Œé¿å…ç±»çˆ†ç‚¸é—®é¢˜[6](@ref)ã€‚
------
### âš ï¸ **æœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜**
1. **èµ„æºç®¡ç†**
- å¿…é¡»å…³é—­æµï¼šä½¿ç”¨
```
try-with-resources
```
ï¼ˆJava 7+ï¼‰è‡ªåŠ¨å…³é—­ï¼Œé˜²æ­¢èµ„æºæ³„æ¼
2,4ï¼š
```
try (OutputStream os = new FileOutputStream(&amp;#34;out.bin&amp;#34;)) {
os.write(data);
} // è‡ªåŠ¨è°ƒç”¨close()
```
2. **æ€§èƒ½ä¼˜åŒ–**
- **ç¼“å†²æµä¼˜å…ˆ**ï¼šå¤„ç†å¤§æ–‡ä»¶æ—¶ï¼Œ`BufferedInputStream`/`BufferedOutputStream`æ¯”åŸºç¡€æµå¿«60%ä»¥ä¸Š[1,4](@ref)ã€‚
- **ç¼“å†²åŒºå¤§å°**ï¼šå»ºè®®4KBâ€“8KBï¼ˆé»˜è®¤å€¼é€šå¸¸è¶³å¤Ÿï¼‰[1](@ref)ã€‚
3. **å…¸å‹é—®é¢˜**
- **ä¹±ç é—®é¢˜**ï¼šå­—èŠ‚æµç›´æ¥è¯»å–æ–‡æœ¬æ—¶ï¼Œå› ç¼–ç ä¸åŒ¹é…å¯èƒ½ä¹±ç  â†’ æ”¹ç”¨å­—ç¬¦æµï¼ˆå¦‚`InputStreamReader`ï¼‰[2](@ref)ã€‚
- **åºåˆ—åŒ–é™åˆ¶**ï¼š`ObjectInputStream`ä»…æ”¯æŒ`Serializable`æ¥å£çš„å¯¹è±¡ï¼Œä¸”éœ€åºåˆ—åŒ–ç‰ˆæœ¬IDä¸€è‡´[1,6](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“**
Javaå­—èŠ‚æµä½“ç³»ä»¥`InputStream`å’Œ`OutputStream`ä¸ºæ ¹åŸºï¼Œé€šè¿‡**èŠ‚ç‚¹æµ**ï¼ˆå¦‚`FileInputStream`ï¼‰ç›´æ¥æ“ä½œæ•°æ®æºï¼Œ**è¿‡æ»¤æµ**ï¼ˆå¦‚`BufferedInputStream`ï¼‰åŠ¨æ€å¢å¼ºåŠŸèƒ½ï¼Œå½¢æˆçµæ´»é«˜æ•ˆçš„I/Oå¤„ç†é“¾ã€‚å…³é”®ç‚¹åŒ…æ‹¬ï¼š
1. **ç»§æ‰¿å…³ç³»**ï¼šæ˜ç¡®èŠ‚ç‚¹æµä¸è¿‡æ»¤æµçš„å±‚æ¬¡[6](@ref)ï¼›
2. **è£…é¥°å™¨æ¨¡å¼**ï¼šé€šè¿‡åµŒå¥—ç»„åˆæ‰©å±•åŠŸèƒ½ï¼›
3. **èµ„æºä¸æ€§èƒ½**ï¼šä¼˜å…ˆä½¿ç”¨`try-with-resources`å’Œç¼“å†²æµ[2,4](@ref)ã€‚
æŒæ¡è¯¥ä½“ç³»ï¼Œå¯é«˜æ•ˆå¤„ç†ä»æ–‡ä»¶è¯»å†™åˆ°ç½‘ç»œä¼ è¾“çš„å„ç±»äºŒè¿›åˆ¶åœºæ™¯ã€‚
## å­—ç¬¦æµ
Javaå­—ç¬¦æµä½“ç³»æ˜¯å¤„ç†æ–‡æœ¬æ•°æ®çš„æ ¸å¿ƒæœºåˆ¶ï¼Œé€šè¿‡**å­—ç¬¦ç¼–ç è½¬æ¢**å’Œ**ç¼“å†²åŒºä¼˜åŒ–**ï¼Œé«˜æ•ˆè§£å†³æ–‡æœ¬è¯»å†™é—®é¢˜ã€‚ä»¥ä¸‹ä»**ç»§æ‰¿å…³ç³»ã€æ ¸å¿ƒç±»åŠŸèƒ½ã€è®¾è®¡æ€æƒ³åŠå®è·µåº”ç”¨**å››ä¸ªç»´åº¦å…¨é¢è§£æï¼š
------
### âš™ï¸ **å­—ç¬¦æµä½“ç³»æ¦‚è¿°**
#### **ä¸å­—èŠ‚æµçš„æœ¬è´¨åŒºåˆ«**
- **å¤„ç†å•ä½**ï¼šå­—ç¬¦æµä»¥Unicodeå­—ç¬¦ï¼ˆ16ä½ï¼‰ä¸ºå•ä½ï¼Œå­—èŠ‚æµä»¥å­—èŠ‚ï¼ˆ8ä½ï¼‰ä¸ºå•ä½[1,3](@ref)ã€‚
- **ç¼–ç å¤„ç†**ï¼šå­—ç¬¦æµè‡ªåŠ¨å¤„ç†ç¼–ç ï¼ˆå¦‚UTF-8ã€GBKï¼‰ï¼Œé¿å…æ–‡æœ¬ä¹±ç ï¼›å­—èŠ‚æµéœ€æ‰‹åŠ¨ç¼–è§£ç [3,6](@ref)ã€‚
- **é€‚ç”¨åœºæ™¯**ï¼šå­—ç¬¦æµä¸“ç”¨äºæ–‡æœ¬æ–‡ä»¶ï¼ˆ`.txt`ã€`.csv`ï¼‰ï¼Œå­—èŠ‚æµé€‚ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå›¾ç‰‡ã€è§†é¢‘ï¼‰[1,4](@ref)ã€‚
#### **åŸºç±»ä¸è®¾è®¡æ€æƒ³**
- **`Reader`**ï¼šæ‰€æœ‰å­—ç¬¦è¾“å…¥æµçš„æŠ½è±¡åŸºç±»ï¼Œå®šä¹‰`read()`ã€`close()`ç­‰æ–¹æ³•[6,7](@ref)ã€‚
- **`Writer`**ï¼šæ‰€æœ‰å­—ç¬¦è¾“å‡ºæµçš„æŠ½è±¡åŸºç±»ï¼Œå®šä¹‰`write()`ã€`flush()`ç­‰æ–¹æ³•[6,7](@ref)ã€‚
- **è£…é¥°å™¨æ¨¡å¼**ï¼šé€šè¿‡åµŒå¥—ç»„åˆï¼ˆå¦‚`BufferedWriter`åŒ…è£…`FileWriter`ï¼‰åŠ¨æ€æ‰©å±•åŠŸèƒ½ï¼Œé¿å…ç±»çˆ†ç‚¸[4,6](@ref)ã€‚
------
### ğŸ“¥ **å­—ç¬¦è¾“å…¥æµï¼ˆReaderï¼‰ç»§æ‰¿ä½“ç³»**
#### **æ ¸å¿ƒå­ç±»åŠåŠŸèƒ½**
| **ç±»å** | **åŠŸèƒ½** | **ç»§æ‰¿è·¯å¾„** |
| ----------------- | ------------------------------------------------------- | ---------------------------------- |
| `FileReader` | ç›´æ¥ä»æ–‡ä»¶è¯»å–å­—ç¬¦æ•°æ®ï¼Œéœ€æ˜¾å¼æŒ‡å®šæ–‡ä»¶è·¯å¾„æˆ–`File`å¯¹è±¡ | `InputStreamReader` â†’ `FileReader` |
| `CharArrayReader` | ä»å†…å­˜ä¸­çš„å­—ç¬¦æ•°ç»„è¯»å–æ•°æ®ï¼Œæ— éœ€å…³é—­ï¼ˆæ— ç³»ç»Ÿèµ„æºå ç”¨ï¼‰ | ç›´æ¥ç»§æ‰¿`Reader` |
| `StringReader` | å°†å­—ç¬¦ä¸²ä½œä¸ºæ•°æ®æºè¯»å–ï¼Œé€‚ç”¨äºå­—ç¬¦ä¸²è§£æåœºæ™¯ | ç›´æ¥ç»§æ‰¿`Reader` |
| `PipedReader` | ä¸`PipedWriter`é…åˆï¼Œå®ç°çº¿ç¨‹é—´å­—ç¬¦æ•°æ®ä¼ è¾“ï¼ˆç®¡é“é€šä¿¡ï¼‰ | ç›´æ¥ç»§æ‰¿`Reader` |
#### **åŠŸèƒ½å¢å¼ºç±»**
- **`BufferedReader`**
- æ·»åŠ ç¼“å†²åŒºï¼ˆé»˜è®¤8KBï¼‰ï¼Œå‡å°‘ç£ç›˜I/Oæ¬¡æ•°ï¼Œæå‡è¯»å–æ•ˆç‡[3,6](@ref)ã€‚
- æ‰©å±•æ–¹æ³•ï¼š`readLine()` ä¸€æ¬¡è¯»å–ä¸€è¡Œæ–‡æœ¬ï¼Œè‡ªåŠ¨å‰¥ç¦»æ¢è¡Œç¬¦[3,4](@ref)ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;try (BufferedReader br = new BufferedReader(new FileReader(&amp;ldquo;log.txt&amp;rdquo;))) {
String line;
while ((line = br.readLine()) != null) { /* é€è¡Œå¤„ç† */ }
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **`InputStreamReader`**
- **å­—èŠ‚è½¬å­—ç¬¦çš„æ¡¥æ¢**ï¼šå°†å­—èŠ‚è¾“å…¥æµï¼ˆå¦‚`FileInputStream`ï¼‰æŒ‰æŒ‡å®šç¼–ç è½¬æ¢ä¸ºå­—ç¬¦æµ[3,6](@ref)ã€‚
- å­ç±»`FileReader`æ˜¯å…¶é’ˆå¯¹æ–‡ä»¶çš„ç‰¹åŒ–å®ç°ï¼ˆé»˜è®¤ä½¿ç”¨ç³»ç»Ÿç¼–ç ï¼‰[6](@ref)ã€‚
- **`PushbackReader`**
- æ”¯æŒå›é€€å­—ç¬¦ï¼ˆ`unread()`ï¼‰ï¼Œç”¨äºè¯­æ³•è§£æå™¨æˆ–å¤æ‚æ–‡æœ¬å¤„ç†[6](@ref)ã€‚
------
### ğŸ“¤ **å­—ç¬¦è¾“å‡ºæµï¼ˆWriterï¼‰ç»§æ‰¿ä½“ç³»**
#### **æ ¸å¿ƒå­ç±»åŠåŠŸèƒ½**
| **ç±»å** | **åŠŸèƒ½** | **ç»§æ‰¿è·¯å¾„** |
| ----------------- | --------------------------------------------------- | ----------------------------------- |
| `FileWriter` | å‘æ–‡ä»¶å†™å…¥å­—ç¬¦æ•°æ®ï¼Œæ”¯æŒè¿½åŠ æ¨¡å¼ï¼ˆ`append=true`ï¼‰ | `OutputStreamWriter` â†’ `FileWriter` |
| `CharArrayWriter` | å°†æ•°æ®å†™å…¥å†…å­˜å­—ç¬¦æ•°ç»„ï¼Œé€šè¿‡`toCharArray()`è·å–æ•°æ® | ç›´æ¥ç»§æ‰¿`Writer` |
| `StringWriter` | å°†æ•°æ®å†™å…¥`StringBuffer`ï¼Œæœ€ç»ˆç”Ÿæˆå­—ç¬¦ä¸² | ç›´æ¥ç»§æ‰¿`Writer` |
| `PipedWriter` | ä¸`PipedReader`é…åˆï¼Œå®ç°çº¿ç¨‹é—´å­—ç¬¦æ•°æ®ä¼ è¾“ | ç›´æ¥ç»§æ‰¿`Writer` |
#### **åŠŸèƒ½å¢å¼ºç±»**
- **`BufferedWriter`**
- æ·»åŠ ç¼“å†²åŒºï¼Œæ‰¹é‡å†™å…¥å­—ç¬¦ï¼Œå‡å°‘I/Oæ¬¡æ•°[3,6](@ref)ã€‚
- æ‰©å±•æ–¹æ³•ï¼š`newLine()` è¾“å‡ºè·¨å¹³å°æ¢è¡Œç¬¦ï¼ˆWindowsä¸º`\r\n`ï¼ŒLinuxä¸º`\n`ï¼‰[3](@ref)ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;try (BufferedWriter bw = new BufferedWriter(new FileWriter(&amp;ldquo;output.txt&amp;rdquo;))) {
bw.write(&amp;ldquo;Hello&amp;rdquo;);
bw.newLine(); // è‡ªåŠ¨é€‚é…æ“ä½œç³»ç»Ÿæ¢è¡Œç¬¦
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **`OutputStreamWriter`**
- **å­—ç¬¦è½¬å­—èŠ‚çš„æ¡¥æ¢**ï¼šå°†å­—ç¬¦æµæŒ‰æŒ‡å®šç¼–ç è½¬æ¢ä¸ºå­—èŠ‚è¾“å‡ºæµï¼ˆå¦‚`FileOutputStream`ï¼‰[6](@ref)ã€‚
- å­ç±»`FileWriter`æ˜¯å…¶é’ˆå¯¹æ–‡ä»¶çš„é»˜è®¤å®ç°[6](@ref)ã€‚
- **`PrintWriter`**
- æä¾›æ ¼å¼åŒ–è¾“å‡ºï¼š`print()`ã€`printf()`ï¼Œæ”¯æŒä»»æ„ç±»å‹æ•°æ®ï¼ˆè‡ªåŠ¨è°ƒç”¨`toString()`ï¼‰[6](@ref)ã€‚
- é»˜è®¤å¯ç”¨è‡ªåŠ¨åˆ·æ–°ï¼ˆ`autoFlush=true`ï¼‰ï¼Œå†™å…¥åç«‹å³è¾“å‡º[6](@ref)ã€‚
------
### ğŸ”„ **è½¬æ¢æµï¼šå­—èŠ‚ä¸å­—ç¬¦çš„æ¡¥æ¢**
- **
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;InputStreamReader&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**ï¼šè§£ç å­—èŠ‚æµ â†’ å­—ç¬¦æµï¼ˆéœ€æŒ‡å®šç¼–ç ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// æ˜¾å¼æŒ‡å®šUTF-8ç¼–ç è¯»å–æ–‡æœ¬
try (Reader reader = new InputStreamReader(
new FileInputStream(&amp;ldquo;data.txt&amp;rdquo;), StandardCharsets.UTF_8)) { &amp;hellip; }&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;OutputStreamWriter&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**ï¼šç¼–ç å­—ç¬¦æµ â†’ å­—èŠ‚æµ
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// æ˜¾å¼æŒ‡å®šGBKç¼–ç å†™å…¥æ–‡æœ¬
try (Writer writer = new OutputStreamWriter(
new FileOutputStream(&amp;ldquo;data.txt&amp;rdquo;), &amp;ldquo;GBK&amp;rdquo;)) { &amp;hellip; }&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;gt; **å…³é”®ä½œç”¨**ï¼šè§£å†³è·¨å¹³å°ä¹±ç é—®é¢˜ï¼Œç¡®ä¿æ–‡æœ¬è¯»å†™ç¼–ç ä¸€è‡´[3,6](@ref)ã€‚
------
### âš¡ **æ€§èƒ½ä¼˜åŒ–ï¼šç¼“å†²æœºåˆ¶**
- **åŸç†**ï¼šå‡å°‘ç£ç›˜I/Oæ¬¡æ•°ï¼Œæ‰¹é‡è¯»å†™æ•°æ®ï¼ˆå¦‚`BufferedReader`è¯»å–æ–‡æœ¬æ—¶ï¼Œä¸€æ¬¡åŠ è½½8KBåˆ°å†…å­˜ï¼‰[3,4](@ref)ã€‚
- **æ€§èƒ½å¯¹æ¯”**ï¼šå¤„ç†100MBæ–‡æœ¬æ–‡ä»¶æ—¶ï¼Œç¼“å†²æµæ¯”åŸºç¡€å­—ç¬¦æµå¿«50å€ä»¥ä¸Š[4](@ref)ã€‚
- æœ€ä½³å®è·µï¼šå§‹ç»ˆç”¨ç¼“å†²æµåŒ…è£…åŸºç¡€æµï¼ˆå¦‚
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;FileReader&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ï¼‰ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// æ­£ç¡®ç”¨æ³•ï¼šBufferedWriteråŒ…è£…FileWriter
try (BufferedWriter bw = new BufferedWriter(new FileWriter(&amp;ldquo;log.txt&amp;rdquo;))) { &amp;hellip; }&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ’ **æ€»ç»“ï¼šå­—ç¬¦æµä½“ç³»è®¾è®¡æ€æƒ³**
1. **åˆ†å±‚æŠ½è±¡**ï¼š
- åŸºç±»`Reader`/`Writer`å®šä¹‰é€šç”¨æ¥å£ã€‚
- èŠ‚ç‚¹æµï¼ˆå¦‚`FileReader`ï¼‰ç›´æ¥æ“ä½œæ•°æ®æºã€‚
- å¤„ç†æµï¼ˆå¦‚`BufferedReader`ï¼‰é€šè¿‡è£…é¥°å™¨æ¨¡å¼æ‰©å±•åŠŸèƒ½[4,6](@ref)ã€‚
2. **ç¼–ç é€æ˜æ€§**ï¼š
è‡ªåŠ¨å¤„ç†å­—ç¬¦ç¼–ç ï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå­—èŠ‚è½¬æ¢ç»†èŠ‚[3,6](@ref)ã€‚
3. **èµ„æºç®¡ç†**ï¼š
ä½¿ç”¨`try-with-resources`ç¡®ä¿æµå…³é—­ï¼ˆå¦‚`FileWriter`éœ€æ˜¾å¼é‡Šæ”¾æ–‡ä»¶å¥æŸ„ï¼‰[3,5](@ref)ã€‚
4. **åº”ç”¨åœºæ™¯ä¼˜å…ˆçº§**ï¼š
- æ–‡æœ¬å¤„ç† â†’ å­—ç¬¦æµï¼ˆ`Reader`/`Writer`ï¼‰ã€‚
- éæ–‡æœ¬æ–‡ä»¶ â†’ å­—èŠ‚æµï¼ˆ`InputStream`/`OutputStream`ï¼‰ã€‚
- é«˜æ€§èƒ½éœ€æ±‚ â†’ ç¼“å†²æµ + æ˜ç¡®ç¼–ç [1,4,6](@ref)ã€‚
## Unicode
Unicodeï¼ˆç»Ÿä¸€ç ã€ä¸‡å›½ç ï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦é¢†åŸŸçš„**å…¨çƒç»Ÿä¸€å­—ç¬¦ç¼–ç æ ‡å‡†**ï¼Œæ—¨åœ¨ä¸ºä¸–ç•Œä¸Šæ‰€æœ‰è¯­è¨€çš„å­—ç¬¦æä¾›å”¯ä¸€æ•°å­—æ ‡è¯†ï¼Œè§£å†³ä¼ ç»Ÿç¼–ç æ–¹æ¡ˆï¼ˆå¦‚ASCIIã€GBKï¼‰åœ¨å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„å…¼å®¹æ€§é—®é¢˜ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€æŠ€æœ¯å®ç°ã€åº”ç”¨åœºæ™¯åŠå‘å±•å†ç¨‹è¿›è¡Œå…¨é¢è§£æï¼š
------
### âš™ï¸ **Unicodeçš„æ ¸å¿ƒåŸç†**
1. **è®¾è®¡ç›®æ ‡**
- **å”¯ä¸€æ€§**ï¼šä¸ºæ¯ç§è¯­è¨€ã€ç¬¦å·ï¼ˆåŒ…æ‹¬è¡¨æƒ…ç¬¦å·ï¼‰åˆ†é…å”¯ä¸€çš„**ç ä½**ï¼ˆCode Pointï¼‰ï¼Œæ ¼å¼ä¸º`U+[4-6ä½åå…­è¿›åˆ¶æ•°]`ï¼Œä¾‹å¦‚ï¼š`A` â†’ `U+0041`ï¼Œ`ğŸ˜Š` â†’ `U+1F60A`[1,6](@ref)ã€‚
- **å…¼å®¹æ€§**ï¼šå®Œå…¨å…¼å®¹ASCIIç ï¼ˆ`U+0000`è‡³`U+007F`ä¸ASCIIä¸€ä¸€å¯¹åº”ï¼‰ï¼Œç¡®ä¿å†å²æ•°æ®æ— ç¼è¿ç§»[3,5](@ref)ã€‚
- **æ‰©å±•æ€§**ï¼šæ”¯æŒ**1,112,064ä¸ªç ä½**ï¼Œæˆªè‡³2025å¹´å·²å®šä¹‰çº¦15ä¸‡ä¸ªå­—ç¬¦ï¼Œè¦†ç›–å…¨çƒä¸»è¦è¯­è¨€åŠç¬¦å·[1,5](@ref)ã€‚
2. **å¹³é¢ç»“æ„ï¼ˆPlanesï¼‰**
Unicodeç©ºé—´åˆ†ä¸º17ä¸ªå¹³é¢ï¼ˆ0-16ï¼‰ï¼Œæ¯ä¸ªå¹³é¢åŒ…å«65,536ä¸ªç ä½ï¼š
| **å¹³é¢ç±»å‹** | **ç ä½èŒƒå›´** | **ä¸»è¦å†…å®¹** |
| ------------------------------------------------------------ | ------------------- | ----------------------------------------- |
| **åŸºæœ¬å¤šè¯­è¨€å¹³é¢ï¼ˆBMPï¼‰** | `U+0000 - U+FFFF` | æ‹‰ä¸å­—æ¯ã€æ±‰å­—ã€æ—¥æ–‡å‡åã€å¸¸è§ç¬¦å· |
| **è¡¥å……å¤šè¯­è¨€å¹³é¢ï¼ˆSMPï¼‰** | `U+10000 - U+1FFFF` | å†å²æ–‡å­—ï¼ˆå¦‚æ¥”å½¢æ–‡å­—ï¼‰ã€è¡¨æƒ…ç¬¦å·ï¼ˆEmojiï¼‰ |
| **å…¶ä»–å¹³é¢** | `U+20000+` | é¢„ç•™ç©ºé—´ã€ç‰¹æ®Šç¬¦å·ï¼ˆå¦‚ç”²éª¨æ–‡ï¼‰ |
| **æ³¨**ï¼šBMPè¦†ç›–äº†99%çš„å¸¸ç”¨å­—ç¬¦ï¼Œæ±‰å­—ä¸»è¦åˆ†å¸ƒåœ¨`U+4E00-U+9FFF`ï¼ˆCJKç»Ÿä¸€è¡¨æ„æ–‡å­—åŒºï¼‰[1,5](@ref)ã€‚ | | |
------
### ğŸ› ï¸ **æŠ€æœ¯å®ç°ï¼šç¼–ç æ–¹æ¡ˆ**
Unicodeæœ¬èº«å®šä¹‰å­—ç¬¦ä¸ç ä½çš„æ˜ å°„å…³ç³»ï¼Œå®é™…å­˜å‚¨éœ€é€šè¿‡**è½¬æ¢æ ¼å¼ï¼ˆUTFï¼‰** å®ç°ã€‚ä¸»æµæ–¹æ¡ˆåŒ…æ‹¬ï¼š
| **ç¼–ç æ–¹æ¡ˆ** | **æœ€å°å•ä½** | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** |
| ------------ | ------------ | ------------------------------------------------------------ | ------------------------- |
| **UTF-8** | 1å­—èŠ‚ | å˜é•¿ï¼ˆ1-4å­—èŠ‚ï¼‰ï¼Œå…¼å®¹ASCIIï¼Œç©ºé—´æ•ˆç‡é«˜ï¼Œæ— å­—èŠ‚åºé—®é¢˜ | ç½‘é¡µï¼ˆå æ¯”94%ï¼‰ã€æ–‡ä»¶å­˜å‚¨ |
| **UTF-16** | 2å­—èŠ‚ | å˜é•¿ï¼ˆ2æˆ–4å­—èŠ‚ï¼‰ï¼ŒBMPå­—ç¬¦ç”¨2å­—èŠ‚ï¼Œè¾…åŠ©å¹³é¢ç”¨4å­—èŠ‚ï¼ˆä»£ç†å¯¹æœºåˆ¶ï¼‰ | Java/C#å†…å­˜å¤„ç†ã€æ“ä½œç³»ç»Ÿ |
| **UTF-32** | 4å­—èŠ‚ | å®šé•¿ç¼–ç ï¼Œå¤„ç†ç®€å•ä½†ç©ºé—´æµªè´¹ä¸¥é‡ | ç‰¹å®šè¯­è¨€åˆ†æéœ€æ±‚ |
#### **å…³é”®æŠ€æœ¯ç»†èŠ‚**
- **UTF-8ç¼–ç è§„åˆ™**ï¼š
- 1å­—èŠ‚ï¼š`0xxxxxxx`ï¼ˆå…¼å®¹ASCIIï¼‰
- 2å­—èŠ‚ï¼š`110xxxxx 10xxxxxx`
- 3å­—èŠ‚ï¼š`1110xxxx 10xxxxxx 10xxxxxx`ï¼ˆå¦‚æ±‰å­—â€œä¸­â€ â†’ `E4 B8 AD`ï¼‰
- 4å­—èŠ‚ï¼š`11110xxx 10xxxxxx 10xxxxxx 10xxxxxx`ï¼ˆå¦‚Emoji `ğŸ˜Š` â†’ `F0 9F 98 8A`ï¼‰[1,5](@ref)ã€‚
- **UTF-16ä»£ç†å¯¹ï¼ˆSurrogate Pairsï¼‰**ï¼š
è¾…åŠ©å¹³é¢å­—ç¬¦ï¼ˆå¦‚`U+1F600`ï¼‰é€šè¿‡ä¸¤ä¸ª16ä½ç å…ƒè¡¨ç¤ºï¼š
- é«˜ä½ä»£ç†ï¼š`0xD800â€“0xDBFF`
- ä½ä½ä»£ç†ï¼š`0xDC00â€“0xDFFF`
ä¾‹å¦‚ï¼š`U+1F600` â†’ `D83D DE00`[1,2](@ref)ã€‚
- **å­—èŠ‚åºæ ‡è®°ï¼ˆBOMï¼‰**ï¼š
ç”¨äºæ ‡è¯†UTF-16/UTF-32çš„å­—èŠ‚åºï¼ˆå¤§ç«¯BEæˆ–å°ç«¯LEï¼‰ï¼Œä¾‹å¦‚UTF-8çš„BOMä¸º`EF BB BF`ï¼ŒUTF-16BEçš„BOMä¸º`FE FF`[1,6](@ref)ã€‚
------
### ğŸ“ˆ **å‘å±•å†ç¨‹ä¸ç‰ˆæœ¬æ¼”è¿›**
- **èµ·æº**ï¼š1990å¹´ç”±Unicodeè”ç›Ÿï¼ˆéè¥åˆ©ç»„ç»‡ï¼Œæˆå‘˜åŒ…æ‹¬å¾®è½¯ã€è‹¹æœç­‰ï¼‰å‘èµ·ï¼Œæ—¨åœ¨å–ä»£åŒºåŸŸæ€§ç¼–ç ï¼ˆå¦‚ISO 8859-1ï¼‰[4](@ref)ã€‚
- é‡Œç¨‹ç¢‘ç‰ˆæœ¬ï¼š
- 1994å¹´ï¼šUnicode 1.0å‘å¸ƒï¼Œè¦†ç›–7,000å­—ç¬¦[1](@ref)ã€‚
- 2005å¹´ï¼š4.1.0ç‰ˆæœ¬æ”¯æŒè—æ–‡ã€ç¼…ç”¸æ–‡ç­‰[1](@ref)ã€‚
- **2024å¹´**ï¼šUnicode 16.0å‘å¸ƒï¼Œæ–°å¢20ä¸ªEmojiåŠå†å²ç¬¦å·[1,4](@ref)ã€‚
------
### ğŸŒ **åº”ç”¨åœºæ™¯ä¸ä¼˜åŠ¿**
1. **å¤šè¯­è¨€æ”¯æŒ**
- **æ“ä½œç³»ç»Ÿ**ï¼šWindows/macOS/Linuxå†…æ ¸å‡é‡‡ç”¨UTF-16æˆ–UTF-8ï¼Œå®ç°å…¨çƒè¯­è¨€æ— ç¼æ˜¾ç¤º[8](@ref)ã€‚
- ç¼–ç¨‹è¯­è¨€ï¼šPython 3é»˜è®¤ä½¿ç”¨Unicodeå­—ç¬¦ä¸²ï¼ˆ
```
str
```
ç±»å‹ï¼‰ï¼Œå¯ç›´æ¥å¤„ç†å¤šè¯­è¨€æ–‡æœ¬ï¼š
```
print(&amp;#34;ä½ å¥½ï¼ŒWorld! ğŸ˜Š&amp;#34;) # æ··åˆä¸­è‹±æ–‡å’Œè¡¨æƒ…[6](@ref)
```
2. **æ•°æ®å­˜å‚¨ä¸ä¼ è¾“**
- **æ•°æ®åº“**ï¼šMySQLçš„`utf8mb4`å­—ç¬¦é›†æ”¯æŒå®Œæ•´Unicodeï¼ˆåŒ…æ‹¬Emojiï¼‰[5,8](@ref)ã€‚
- **ç½‘ç»œåè®®**ï¼šHTTPå¤´éƒ¨å¼ºåˆ¶ä½¿ç”¨UTF-8ï¼Œç¡®ä¿è·¨å¹³å°æ–‡æœ¬æ­£ç¡®è§£æ[5,9](@ref)ã€‚
3. **å›½é™…åŒ–è½¯ä»¶å¼€å‘**
- **Webå¼€å‘**ï¼šHTMLé€šè¿‡`&amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;`å£°æ˜ç¼–ç ï¼Œé¿å…ä¹±ç [6,8](@ref)ã€‚
- **å®‰å…¨é˜²æŠ¤**ï¼šUnicodeè§„èŒƒåŒ–å¯é˜»æ­¢åŒå½¢æ–‡å­—æ”»å‡»ï¼ˆå¦‚ç”¨è¥¿é‡Œå°”å­—æ¯â€œĞ°â€å†’å……æ‹‰ä¸å­—æ¯â€œaâ€ï¼‰[5](@ref)ã€‚
------
### âš ï¸ **å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ**
1. **ä¹±ç é—®é¢˜**
- **åŸå› **ï¼šç¼–ç ä¸ä¸€è‡´ï¼ˆå¦‚æ–‡ä»¶ç”¨GBKä¿å­˜ä½†ç”¨UTF-8è¯»å–ï¼‰[6](@ref)ã€‚
- è§£å†³ï¼šç»Ÿä¸€ä½¿ç”¨UTF-8ï¼Œå¹¶åœ¨è¯»å†™æ—¶æ˜¾å¼å£°æ˜ç¼–ç ï¼š
```
with open(&amp;#34;data.txt&amp;#34;, &amp;#34;w&amp;#34;, encoding=&amp;#34;utf-8&amp;#34;) as f:
f.write(&amp;#34;å¤šè¯­è¨€æ–‡æœ¬æµ‹è¯•&amp;#34;)
```
2. **å­˜å‚¨æ•ˆç‡**
- **äº‰è®®**ï¼šUTF-8å¯¹è‹±æ–‡é«˜æ•ˆï¼ˆ1å­—èŠ‚ï¼‰ï¼Œä½†æ±‰å­—éœ€3å­—èŠ‚ï¼ˆGBKä»…éœ€2å­—èŠ‚ï¼‰[3](@ref)ã€‚
- **æƒè¡¡**ï¼šUTF-8çš„å…¼å®¹æ€§å’Œæ— å›½ç•Œä¼˜åŠ¿è¿œè¶…ç©ºé—´å¼€é”€ï¼Œä¸”å­˜å‚¨æˆæœ¬æŒç»­é™ä½[5,8](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“**
Unicodeé€šè¿‡**å”¯ä¸€ç ä½æ˜ å°„** + **çµæ´»ç¼–ç æ–¹æ¡ˆ**ï¼ˆå°¤å…¶æ˜¯UTF-8ï¼‰ï¼Œç»ˆç»“äº†å­—ç¬¦ç¼–ç çš„â€œå·´åˆ«å¡”å›°å¢ƒâ€ï¼Œæˆä¸ºå…¨çƒåŒ–æ•°å­—ä¸–ç•Œçš„æ–‡æœ¬åŸºçŸ³ï¼š
- **æŠ€æœ¯ä»·å€¼**ï¼šè¦†ç›–å…¨çƒå­—ç¬¦ï¼Œæ”¯æŒæŒç»­æ‰©å±•ã€‚
- **å®è·µå‡†åˆ™**ï¼šä¼˜å…ˆé‡‡ç”¨UTF-8ç¼–ç ï¼Œé¿å…ä¹±ç é£é™©ã€‚
- **æœªæ¥å±•æœ›**ï¼šéšç€Unicodeç‰ˆæœ¬è¿­ä»£ï¼Œæ›´å¤šå†å²æ–‡å­—ã€ç¬¦å·åŠæ–°å…´è¡¨æƒ…å°†è¢«çº³å…¥ï¼Œè¿›ä¸€æ­¥æ¨åŠ¨æ–‡åŒ–æ•°å­—åŒ–ä¿å­˜ä¸äº¤æµã€‚
&amp;gt; æ­£å¦‚Unicodeè”ç›Ÿæ‰€è¿°ï¼šâ€œä¸ºæ¯ç§è¯­è¨€æä¾›å¹³ç­‰æ•°å­—è¡¨è¾¾æƒâ€[4](@ref)ã€‚æŒæ¡Unicodeæœºåˆ¶ï¼Œæ˜¯æ„å»ºçœŸæ­£å›½é™…åŒ–åº”ç”¨çš„å¿…ç»ä¹‹è·¯ã€‚
## Java é»˜è®¤ç¼–ç 
Javaçš„ç¼–ç å¤„ç†åˆ†ä¸ºå†…éƒ¨å­—ç¬¦ä¸²è¡¨ç¤ºå’ŒI/Oé»˜è®¤ç¼–ç ä¸¤ä¸ªå±‚é¢ï¼ŒäºŒè€…ä¸åŒï¼š
### ğŸ“Œ **Javaå†…éƒ¨å­—ç¬¦ä¸²çš„ç¼–ç ï¼ˆå†…å­˜å±‚é¢ï¼‰**
Javaçš„`String`ç±»åœ¨å†…å­˜ä¸­ä½¿ç”¨**UTF-16ç¼–ç **å­˜å‚¨å­—ç¬¦ã€‚æ¯ä¸ªå­—ç¬¦å ç”¨2å­—èŠ‚ï¼ˆ16ä½ï¼‰ï¼Œå¯¹äºè¶…å‡ºåŸºæœ¬å¤šè¯­è¨€å¹³é¢ï¼ˆBMPï¼‰çš„å­—ç¬¦ï¼ˆå¦‚éƒ¨åˆ†Emojiï¼‰ï¼Œä¼šé€šè¿‡**ä»£ç†å¯¹ï¼ˆSurrogate Pairï¼‰** å ç”¨4å­—èŠ‚è¡¨ç¤º[3,4,5,9](@ref)ã€‚
ä¾‹å¦‚ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;String text = &amp;ldquo;ä½ å¥½&amp;rdquo;; // å†…å­˜ä¸­ä»¥UTF-16ç¼–ç å­˜å‚¨
char ch = text.charAt(0); // ç›´æ¥æ“ä½œUTF-16ä»£ç å•å…ƒ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### âš™ï¸ **JVMé»˜è®¤ç¼–ç ï¼ˆI/Oæ“ä½œå±‚é¢ï¼‰**
Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰åœ¨å¤„ç†æ–‡ä»¶ã€ç½‘ç»œä¼ è¾“ç­‰I/Oæ“ä½œæ—¶ï¼Œé»˜è®¤ç¼–ç **ä¸æ˜¯UTF-16ï¼Œè€Œæ˜¯å–å†³äºæ“ä½œç³»ç»Ÿç¯å¢ƒ**ï¼š
- **Windowsç³»ç»Ÿ**ï¼šé€šå¸¸ä¸º`GBK`æˆ–`UTF-8`ï¼ˆè¾ƒæ–°ç‰ˆæœ¬ï¼‰ã€‚
- **Linux/macOSç³»ç»Ÿ**ï¼šé€šå¸¸ä¸º`UTF-8`ï¼ˆé€šè¿‡`locale`å‘½ä»¤å¯æŸ¥çœ‹ï¼‰[2,6,7](@ref)ã€‚
å¯é€šè¿‡ä»£ç æ£€æŸ¥å½“å‰JVMé»˜è®¤ç¼–ç ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System.out.println(&amp;ldquo;Default Charset: &amp;quot; + Charset.defaultCharset().name()); // è¾“å‡ºå¦‚UTF-8&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### â³ **å†å²èƒŒæ™¯ä¸è®¾è®¡é€‰æ‹©**
- **UTF-16çš„é‡‡ç”¨**ï¼šJavaè¯ç”Ÿäº1995å¹´ï¼Œæ—©æœŸUnicodeæ ‡å‡†ä»¥16ä½ç¼–ç ä¸ºä¸»ï¼ˆä»…BMPå­—ç¬¦ï¼‰ï¼ŒUTF-16èƒ½é«˜æ•ˆå¤„ç†å½“æ—¶çš„å¤šè¯­è¨€éœ€æ±‚ï¼Œä¸”ä¸Windowsç³»ç»Ÿå…¼å®¹ï¼ˆWindowså†…éƒ¨ä¹Ÿä½¿ç”¨UTF-16ï¼‰[5,9](@ref)ã€‚
- **UTF-8çš„æ™®åŠ**ï¼šUTF-8å› å…¼å®¹ASCIIã€èŠ‚çœå­˜å‚¨ç©ºé—´ï¼ˆè‹±æ–‡1å­—èŠ‚ï¼‰ï¼Œæˆä¸ºç½‘ç»œä¼ è¾“å’Œæ–‡ä»¶å­˜å‚¨çš„ä¸»æµã€‚ä½†Javaå› å†å²åŸå› ä¿æŒå†…éƒ¨UTF-16è®¾è®¡[5,11](@ref)ã€‚
------
### âš ï¸ **ç¼–ç ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜**
è‹¥æœªæ˜¾å¼æŒ‡å®šç¼–ç ï¼Œå¯èƒ½å¼•å‘ä¹±ç ï¼š
- **æ–‡ä»¶è¯»å†™**ï¼šä½¿ç”¨`FileReader`/`FileWriter`ä¼šé‡‡ç”¨JVMé»˜è®¤ç¼–ç ï¼ˆå¦‚GBKï¼‰ï¼Œè‹¥æ–‡ä»¶å®é™…ä¸ºUTF-8åˆ™ä¹±ç [6,7](@ref)ã€‚
- å­—èŠ‚ä¸å­—ç¬¦ä¸²è½¬æ¢ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;byte[] bytes = str.getBytes(); // ä½¿ç”¨JVMé»˜è®¤ç¼–ç ï¼ŒéUTF-16ï¼
String s = new String(bytes); // åŒç†ï¼Œä¾èµ–é»˜è®¤ç¼–ç &lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ› ï¸ **æœ€ä½³å®è·µï¼šæ˜¾å¼æŒ‡å®šç¼–ç **
é¿å…ä¾èµ–é»˜è®¤ç¼–ç ï¼Œå§‹ç»ˆåœ¨I/Oæ“ä½œä¸­æ˜ç¡®å£°æ˜ç¼–ç ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// è¯»å–æ–‡ä»¶ï¼ˆæŒ‡å®šUTF-8ï¼‰
BufferedReader reader = new BufferedReader(
new InputStreamReader(new FileInputStream(&amp;ldquo;file.txt&amp;rdquo;), StandardCharsets.UTF_8)
);&lt;/p&gt;
&lt;p&gt;// å­—ç¬¦ä¸²ä¸å­—èŠ‚è½¬æ¢
byte[] utf8Bytes = &amp;ldquo;ä½ å¥½&amp;rdquo;.getBytes(StandardCharsets.UTF_8); // ä¸»åŠ¨ä½¿ç”¨UTF-8
String text = new String(utf8Bytes, StandardCharsets.UTF_8);&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### ç¼–ç æ–¹æ¡ˆå¯¹æ¯”è¡¨
| **åœºæ™¯** | **æ¨èç¼–ç ** | **åŸå› ** |
| ----------------- | ------------ | ---------------------------------------------------- |
| å†…å­˜å­—ç¬¦ä¸²æ“ä½œ | UTF-16 | Javaå†…éƒ¨å›ºå®šä½¿ç”¨ï¼Œä¸å¯æ›´æ”¹ |
| æ–‡ä»¶å­˜å‚¨/ç½‘ç»œä¼ è¾“ | UTF-8 | å…¼å®¹æ€§å¼ºã€ç©ºé—´æ•ˆç‡é«˜ï¼Œè·¨å¹³å°ä¸€è‡´æ€§æ›´å¥½[3,6,10](@ref) |
------
### ğŸ’ **æ€»ç»“**
- **å†…å­˜å±‚é¢**ï¼šJavaå­—ç¬¦ä¸²å›ºå®šä½¿ç”¨**UTF-16**ã€‚
- **I/Oå±‚é¢**ï¼šJVMé»˜è®¤ç¼–ç **ç”±æ“ä½œç³»ç»Ÿå†³å®š**ï¼ˆé€šå¸¸ä¸ºUTF-8ï¼‰ï¼Œä½†**å¿…é¡»æ˜¾å¼æŒ‡å®š**ä»¥é¿å…ä¹±ç ã€‚
- å…³é”®åŸåˆ™ï¼š
&amp;gt; ğŸ“¢ æ°¸è¿œä¸è¦ä¿¡ä»»é»˜è®¤ç¼–ç ï¼åœ¨`InputStreamReader`ã€`getBytes()`ã€`new String()`ç­‰æ“ä½œä¸­å¼ºåˆ¶å£°æ˜å­—ç¬¦é›†ï¼ˆå¦‚`StandardCharsets.UTF_8`ï¼‰[7,8,10](@ref)ã€‚
## NIO
Java NIOï¼ˆNew I/O æˆ– Non-blocking I/Oï¼‰æ˜¯ Java 1.4 å¼•å…¥çš„é«˜æ€§èƒ½ I/O æ¡†æ¶ï¼Œé€šè¿‡éé˜»å¡ã€å¤šè·¯å¤ç”¨å’Œé›¶æ‹·è´ç­‰æœºåˆ¶ï¼Œæ˜¾è‘—æå‡é«˜å¹¶å‘åœºæ™¯ä¸‹çš„å¤„ç†æ•ˆç‡ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒç»„ä»¶ã€å·¥ä½œåŸç†ã€çº¿ç¨‹æ¨¡å‹åˆ°åº”ç”¨åœºæ™¯çš„ç³»ç»Ÿè§£æï¼š
------
### âš™ï¸ **NIO æ ¸å¿ƒç»„ä»¶**
#### **Channelï¼ˆé€šé“ï¼‰**
- **åŒå‘é€šä¿¡**ï¼šæ”¯æŒè¯»å†™åŒå‘æ“ä½œï¼ˆä¼ ç»Ÿ I/O çš„æµæ˜¯å•å‘çš„ï¼‰[1,3](@ref)ã€‚
- ç±»å‹ï¼š
- `FileChannel`ï¼šæ–‡ä»¶è¯»å†™ï¼ˆæ”¯æŒå†…å­˜æ˜ å°„ï¼‰
- `SocketChannel`/`ServerSocketChannel`ï¼šTCP ç½‘ç»œé€šä¿¡
- `DatagramChannel`ï¼šUDP ç½‘ç»œé€šä¿¡
#### **Bufferï¼ˆç¼“å†²åŒºï¼‰**
- **æ•°æ®ä¸­è½¬ç«™**ï¼šæ‰€æœ‰æ•°æ®é€šè¿‡ Buffer ä¸ Channel äº¤äº’ï¼Œæœ¬è´¨æ˜¯å†…å­˜å—ï¼ˆåº•å±‚ä¸ºæ•°ç»„ï¼‰[2,5](@ref)ã€‚
- æ ¸å¿ƒå±æ€§ï¼š
- `capacity`ï¼ˆå®¹é‡ï¼‰ã€`position`ï¼ˆå½“å‰ä½ç½®ï¼‰ã€`limit`ï¼ˆè¯»å†™è¾¹ç•Œï¼‰
- æ“ä½œæµç¨‹ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ByteBuffer buffer = ByteBuffer.allocate(1024); // åˆ†é…ç¼“å†²åŒº
buffer.put(data); // å†™å…¥æ•°æ®
buffer.flip(); // åˆ‡æ¢è¯»æ¨¡å¼ï¼ˆposition=0, limit=å†™å…¥ä½ç½®ï¼‰
while (buffer.hasRemaining()) {
System.out.print((char) buffer.get()); // è¯»å–æ•°æ®
}
buffer.clear(); // æ¸…ç©ºç¼“å†²åŒºï¼ˆå¤ä½positionå’Œlimitï¼‰&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **Selectorï¼ˆé€‰æ‹©å™¨ï¼‰**
- **å¤šè·¯å¤ç”¨æ ¸å¿ƒ**ï¼šå•çº¿ç¨‹ç›‘å¬å¤šä¸ª Channel çš„ I/O äº‹ä»¶ï¼ˆå¦‚è¿æ¥ã€è¯»ã€å†™ï¼‰ï¼Œé¿å…çº¿ç¨‹é˜»å¡[2,3](@ref)ã€‚
- äº‹ä»¶ç±»å‹ï¼š
| äº‹ä»¶ | è¯´æ˜ |
| ------------------------ | ---------------- |
| `SelectionKey.OP_ACCEPT` | æœåŠ¡ç«¯æ¥å—æ–°è¿æ¥ |
| `SelectionKey.OP_READ` | æ•°æ®å¯è¯» |
| `SelectionKey.OP_WRITE` | æ•°æ®å¯å†™ |
------
### ğŸ”„ **NIO å·¥ä½œåŸç†ä¸ä¼˜åŠ¿**
#### **éé˜»å¡æ¨¡å‹**
- **ä¼ ç»Ÿ BIO**ï¼šçº¿ç¨‹é˜»å¡ç­‰å¾… I/O å®Œæˆï¼ˆä¾‹å¦‚ `read()` æ— æ•°æ®æ—¶çº¿ç¨‹æŒ‚èµ·ï¼‰ã€‚
- **NIO**ï¼šè°ƒç”¨ `read()` æ— æ•°æ®æ—¶ç«‹å³è¿”å›ï¼Œçº¿ç¨‹å¯å¤„ç†å…¶ä»–ä»»åŠ¡[5,6](@ref)ã€‚
#### **å¤šè·¯å¤ç”¨æœºåˆ¶**
- Selector è½®è¯¢ï¼šé€šè¿‡
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;select()&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;é˜»å¡ç›´åˆ°è‡³å°‘ä¸€ä¸ª Channel å°±ç»ªï¼Œå†å¤„ç†äº‹ä»¶
2,6ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Selector selector = Selector.open();
channel.configureBlocking(false); // é€šé“è®¾ä¸ºéé˜»å¡
channel.register(selector, SelectionKey.OP_READ); // æ³¨å†Œäº‹ä»¶
while (true) {
int readyChannels = selector.select(); // é˜»å¡ç­‰å¾…å°±ç»ªäº‹ä»¶
Set&lt;SelectionKey&gt; keys = selector.selectedKeys();
for (SelectionKey key : keys) {
if (key.isReadable()) { // å¤„ç†è¯»äº‹ä»¶
SocketChannel ch = (SocketChannel) key.channel();
ByteBuffer buf = ByteBuffer.allocate(128);
ch.read(buf);
}
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **é›¶æ‹·è´æŠ€æœ¯**
- **
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;mmap&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ï¼ˆå†…å­˜æ˜ å°„æ–‡ä»¶ï¼‰**ï¼šå°†æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ï¼Œç›´æ¥æ“ä½œå†…å­˜é¿å…ç”¨æˆ·æ€-å†…æ ¸æ€æ‹·è´
3ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;FileChannel channel = FileChannel.open(Paths.get(&amp;ldquo;data.txt&amp;rdquo;));
MappedByteBuffer buffer = channel.map(FileChannel.MapMode.READ_WRITE, 0, channel.size());
buffer.put(&amp;ldquo;New Data&amp;rdquo;.getBytes()); // ç›´æ¥ä¿®æ”¹å†…å­˜ï¼Œæ— éœ€write()&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;sendfile&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**ï¼šæ–‡ä»¶ç›´ä¼ ç½‘ç»œï¼ˆå¦‚å¤§æ–‡ä»¶ä¸‹è½½ï¼‰
3ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;FileChannel srcChannel = new FileInputStream(&amp;ldquo;data.log&amp;rdquo;).getChannel();
SocketChannel destChannel = SocketChannel.open();
srcChannel.transferTo(0, srcChannel.size(), destChannel); // é›¶æ‹·è´ä¼ è¾“&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ§© **çº¿ç¨‹æ¨¡å‹ä¸è®¾è®¡æ¨¡å¼**
#### **Reactor æ¨¡å¼**
NIO é€šå¸¸ç»“åˆ Reactor æ¨¡å¼å®ç°é«˜å¹¶å‘ï¼š
- **å• Reactor å•çº¿ç¨‹**ï¼šSelector å¤„ç†æ‰€æœ‰ I/O å’Œä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚ Redisï¼‰ã€‚
- **å• Reactor å¤šçº¿ç¨‹**ï¼šSelector å¤„ç† I/Oï¼Œçº¿ç¨‹æ± å¤„ç†ä¸šåŠ¡ï¼ˆå¦‚ Kafkaï¼‰[3](@ref)ã€‚
- **ä¸»ä» Reactor å¤šçº¿ç¨‹**ï¼šMain Reactor å¤„ç†è¿æ¥ï¼ŒSub Reactor å¤„ç† I/Oï¼ˆå¦‚ Nettyï¼‰[3](@ref)ã€‚
#### **å †å¤–å†…å­˜ä¼˜åŒ–**
- **`DirectByteBuffer`**ï¼šé€šè¿‡ `ByteBuffer.allocateDirect()` åˆ†é…å †å¤–å†…å­˜ï¼Œå‡å°‘ GC å‹åŠ›ï¼Œæå‡ I/O æ•ˆç‡[3,5](@ref)ã€‚
------
### âš¡ **NIO vs. BIO å…³é”®å¯¹æ¯”**
| **ç‰¹æ€§** | **NIO** | **BIO** |
| --------------- | ------------------------------------ | -------------------------- |
| **é˜»å¡/éé˜»å¡** | éé˜»å¡ï¼ˆ`configureBlocking(false)`ï¼‰ | é˜»å¡ |
| **çº¿ç¨‹æ¨¡å‹** | å•çº¿ç¨‹ç®¡ç†å¤šè¿æ¥ï¼ˆSelectorï¼‰ | æ¯è¿æ¥ä¸€çº¿ç¨‹ |
| **æ•°æ®å•ä½** | å—ï¼ˆBufferï¼‰ | æµï¼ˆStreamï¼‰ |
| **é€‚ç”¨åœºæ™¯** | é«˜å¹¶å‘ï¼ˆå¦‚èŠå¤©æœåŠ¡å™¨ã€RPCæ¡†æ¶ï¼‰ | ä½å¹¶å‘ï¼ˆä¼ ç»Ÿ HTTP æœåŠ¡å™¨ï¼‰ |
| **é›¶æ‹·è´æ”¯æŒ** | æ”¯æŒï¼ˆ`mmap`ã€`transferTo`ï¼‰ | ä¸æ”¯æŒ |
------
### ğŸ› ï¸ **åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹**
#### **é«˜å¹¶å‘ç½‘ç»œé€šä¿¡**
- **èŠå¤©æœåŠ¡å™¨**ï¼šå•çº¿ç¨‹ç®¡ç†æ•°åƒè¿æ¥ï¼Œä½å»¶è¿Ÿå“åº”[6](@ref)ã€‚
- **RPCæ¡†æ¶**ï¼šNetty åŸºäº NIO å®ç°å¼‚æ­¥ç½‘ç»œé€šä¿¡ã€‚
#### **é«˜æ€§èƒ½æ–‡ä»¶æ“ä½œ**
- **æ—¥å¿—ç³»ç»Ÿ**ï¼šKafka ä½¿ç”¨ `mmap` åŠ é€Ÿæ—¥å¿—æ–‡ä»¶è¯»å†™[3](@ref)ã€‚
- **å¤§æ–‡ä»¶ä¼ è¾“**ï¼š`transferTo()` å®ç°é›¶æ‹·è´æ–‡ä»¶ä¸‹è½½ã€‚
#### **ä»£ç ç¤ºä¾‹ï¼šNIO æœåŠ¡ç«¯**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;public class NioServer {
public static void main(String[] args) throws IOException {
Selector selector = Selector.open();
ServerSocketChannel server = ServerSocketChannel.open();
server.bind(new InetSocketAddress(8080));
server.configureBlocking(false);
server.register(selector, SelectionKey.OP_ACCEPT); // æ³¨å†Œè¿æ¥äº‹ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; while (true) {
selector.select(); // é˜»å¡ç­‰å¾…äº‹ä»¶
Set&amp;lt;SelectionKey&amp;gt; keys = selector.selectedKeys();
for (SelectionKey key : keys) {
if (key.isAcceptable()) { // å¤„ç†æ–°è¿æ¥
SocketChannel client = server.accept();
client.configureBlocking(false);
client.register(selector, SelectionKey.OP_READ);
} else if (key.isReadable()) { // å¤„ç†è¯»æ•°æ®
SocketChannel client = (SocketChannel) key.channel();
ByteBuffer buffer = ByteBuffer.allocate(128);
client.read(buffer);
buffer.flip();
System.out.println(new String(buffer.array()));
}
keys.remove(key);
}
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### âš ï¸ **æ³¨æ„äº‹é¡¹**
1. **ç¼–ç¨‹å¤æ‚åº¦**ï¼šéœ€æ‰‹åŠ¨ç®¡ç† Buffer çŠ¶æ€ï¼ˆ`flip()`/`clear()`ï¼‰åŠäº‹ä»¶å¾ªç¯ï¼Œæ˜“å‡ºé”™[6](@ref)ã€‚
2. **ç©ºè½®è¯¢é—®é¢˜**ï¼šLinux ä¸‹ `select()` å¯èƒ½æ— äº‹ä»¶æ—¶å”¤é†’ï¼ˆNetty é€šè¿‡é‡æ„ Selector è§£å†³ï¼‰ã€‚
3. **å †å¤–å†…å­˜æ³„æ¼**ï¼š`DirectByteBuffer` éœ€é€šè¿‡ `Cleaner` é‡Šæ”¾ï¼Œå¦åˆ™å¯¼è‡´å†…å­˜æº¢å‡º[3](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“**
Java NIO ä»¥ **Channel-Buffer-Selector ä¸‰è§’æ¨¡å‹**ä¸ºæ ¸å¿ƒï¼Œé€šè¿‡**éé˜»å¡å¤šè·¯å¤ç”¨**æ˜¾è‘—æå‡å¹¶å‘èƒ½åŠ›ï¼Œç»“åˆ**é›¶æ‹·è´**æŠ€æœ¯ä¼˜åŒ– I/O æ€§èƒ½ï¼Œæˆä¸ºé«˜åååœºæ™¯ï¼ˆå¦‚ Nettyã€Kafkaã€RocketMQï¼‰çš„åŸºçŸ³ã€‚å°½ç®¡ç¼–ç¨‹æ¨¡å‹å¤æ‚ï¼Œå…¶æ€§èƒ½ä¼˜åŠ¿åœ¨äº‘åŸç”Ÿä¸å¾®æœåŠ¡æ¶æ„ä¸­ä¸å¯æ›¿ä»£ã€‚å®è·µä¸­å»ºè®®ç›´æ¥ä½¿ç”¨ Netty ç­‰å°è£…æ¡†æ¶ï¼Œé¿å…åº•å±‚ NIO çš„å¤æ‚æ€§ã€‚
## Selector
Java NIO ä¸­çš„ `Selector` åº•å±‚å®ç°å–å†³äº**æ“ä½œç³»ç»Ÿ**å’Œ **JDK ç‰ˆæœ¬**ï¼Œå…·ä½“å¦‚ä¸‹ï¼š
------
### ğŸ–¥ï¸ **ä¸åŒæ“ä½œç³»ç»Ÿçš„åº•å±‚å®ç°**
| **æ“ä½œç³»ç»Ÿ** | **Selector åº•å±‚æœºåˆ¶** | **ç‰¹ç‚¹** | **éªŒè¯æ–¹å¼** |
| ------------- | ------------------------ | ------------------------------------------------------------ | ------------------------------------------------ |
| **Linux** | `epoll`ï¼ˆå†…æ ¸ â‰¥ 2.6.17ï¼‰ | é«˜æ€§èƒ½äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œæ”¯æŒæµ·é‡è¿æ¥ï¼ˆO(1) æ—¶é—´å¤æ‚åº¦ï¼‰ï¼Œé›¶æ‹·è´ä¼˜åŒ– | è¾“å‡º `sun.nio.ch.EPollSelectorImpl`[1,5](@ref) |
| **Windows** | `select` æˆ– `WSAPoll` | æ€§èƒ½è¾ƒå·®ï¼ŒFD æ•°é‡å—é™ï¼ˆé»˜è®¤ 1024ï¼‰ï¼Œå…¨é‡æ‰«æï¼ˆO(n) æ—¶é—´å¤æ‚åº¦ï¼‰ | è¾“å‡º `sun.nio.ch.WindowsSelectorImpl`[1,3](@ref) |
| **macOS/BSD** | `kqueue` | äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œæ€§èƒ½ä»‹äº `select` å’Œ `epoll` ä¹‹é—´ | è¾“å‡º `sun.nio.ch.KQueueSelectorImpl`[1,3](@ref) |
#### éªŒè¯ä»£ç ç¤ºä¾‹ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;public class SelectorCheck {
public static void main(String[] args) throws Exception {
Selector selector = Selector.open();
System.out.println(selector.getClass().getName());
}
}
// Linux è¾“å‡ºç¤ºä¾‹: sun.nio.ch.EPollSelectorImpl&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### âš™ï¸ **æ ¸å¿ƒæœºåˆ¶å¯¹æ¯”**
| **æœºåˆ¶** | **æ€§èƒ½ç¼ºé™·** | **è§£å†³æ–¹æ¡ˆ** |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------ |
| **select** | - FD æ•°é‡é™åˆ¶ï¼ˆ1024ï¼‰ - å…¨é‡æ‰«ææ‰€æœ‰ FDï¼ˆO(n)ï¼‰ - é¢‘ç¹å†…æ ¸/ç”¨æˆ·æ€æ‹·è´ | å·²è¢« Linux å¼ƒç”¨ï¼Œä»…ç”¨äºæ—§ç‰ˆ Windows[4,5](@ref) |
| **poll** | æ—  FD æ•°é‡é™åˆ¶ï¼ˆé“¾è¡¨å­˜å‚¨ï¼‰ï¼Œä½†ä»éœ€å…¨é‡æ‰«æï¼ˆO(n)ï¼‰ | JDK åœ¨ Linux 2.4 å†…æ ¸å‰ä½¿ç”¨ï¼Œç°å·²æ·˜æ±°[3,4](@ref) |
| **epoll** | âœ… **äº‹ä»¶é©±åŠ¨**ï¼šä»…å¤„ç†æ´»è·ƒ FDï¼ˆO(1)ï¼‰ âœ… **é›¶æ‹·è´**ï¼š`mmap` å…±äº«å†…å­˜ âœ… æ”¯æŒç™¾ä¸‡çº§è¿æ¥ | Linux é¦–é€‰ï¼ŒJava é»˜è®¤å¯ç”¨[1,5](@ref) |
#### **epoll ä¼˜åŠ¿è¯¦è§£**ï¼š
1.
äº‹ä»¶æ³¨å†Œï¼š
- é€šè¿‡ `epoll_ctl` ä¸€æ¬¡æ€§æ³¨å†Œ FDï¼Œé¿å…æ¯æ¬¡è°ƒç”¨é‡å¤æ‹·è´ï¼ˆ`select`/`poll` éœ€æ¯æ¬¡ä¼ é€’å…¨é‡ FDï¼‰[4,5](@ref)ã€‚
2.
å°±ç»ªåˆ—è¡¨ï¼š
- å†…æ ¸ç»´æŠ¤**å°±ç»ª FD é“¾è¡¨**ï¼Œ`epoll_wait` ç›´æ¥è¿”å›æ´»è·ƒäº‹ä»¶ï¼Œæ— éœ€éå†å…¨éƒ¨ FD[4](@ref)ã€‚
3.
è§¦å‘æ¨¡å¼ï¼š
- **æ°´å¹³è§¦å‘ï¼ˆLTï¼‰**ï¼šé»˜è®¤æ¨¡å¼ï¼Œäº‹ä»¶æœªå¤„ç†ä¼šé‡å¤é€šçŸ¥ï¼ˆå…¼å®¹ Java NIO é»˜è®¤è¡Œä¸ºï¼‰[5](@ref)ã€‚
- **è¾¹ç¼˜è§¦å‘ï¼ˆETï¼‰**ï¼šçŠ¶æ€å˜åŒ–æ—¶ä»…é€šçŸ¥ä¸€æ¬¡ï¼Œéœ€éé˜»å¡ IO ä¸€æ¬¡è¯»å®Œæ•°æ®ï¼ˆNetty ä¼˜åŒ–ä½¿ç”¨ï¼‰[5](@ref)ã€‚
------
### ğŸ”„ **JDK ç‰ˆæœ¬æ¼”è¿›**
- **JDK 1.4~1.5**ï¼š
åº•å±‚ä½¿ç”¨ `select`/`poll`ï¼Œæ€§èƒ½å—é™ï¼Œé«˜å¹¶å‘åœºæ™¯æ˜“ç“¶é¢ˆ[4](@ref)ã€‚
- **JDK 1.5 update10+ï¼ˆLinuxï¼‰**ï¼š
é»˜è®¤åˆ‡æ¢åˆ° `epoll`ï¼ˆéœ€å†…æ ¸ â‰¥ 2.6.17ï¼‰[4,5](@ref)ã€‚
- **JDK 7+**ï¼š
å…¨é¢ä¼˜åŒ– `epoll` å®ç°ï¼Œä¿®å¤ç©ºè½®è¯¢ Bugï¼ˆæ—©æœŸç‰ˆæœ¬ `select` å¯èƒ½å¯¼è‡´ CPU 100%ï¼‰[5](@ref)ã€‚
------
### ğŸ› ï¸ **å¼€å‘å»ºè®®**
1.
æ˜¾å¼æŒ‡å®šéé˜»å¡æ¨¡å¼ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;channel.configureBlocking(false); // å¿…é¡»è®¾ç½®ï¼Œå¦åˆ™æ³¨å†Œå¤±è´¥&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;2.
åˆç†å¤„ç†å°±ç»ªäº‹ä»¶ï¼š
- åœ¨ `isReadable()` äº‹ä»¶ä¸­å¾ªç¯è¯»å–æ•°æ®ï¼Œé¿å… ET æ¨¡å¼æ•°æ®ä¸¢å¤±[5](@ref)ã€‚
- åŠæ—¶ç§»é™¤å·²å¤„ç†çš„
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt; SelectionKey
```
ï¼ˆé˜²æ­¢é‡å¤è§¦å‘ï¼‰ï¼š
```
Iterator&amp;lt;SelectionKey&amp;gt; it = selectedKeys.iterator();
while (it.hasNext()) {
SelectionKey key = it.next();
// å¤„ç†äº‹ä»¶
it.remove(); // å¿…é¡»ç§»é™¤[6,7](@ref)
}
```
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start="3"&gt;
&lt;li&gt;ç›‘æ§ FD æ³„æ¼ï¼š
&lt;ul&gt;
&lt;li&gt;Linux å‘½ä»¤ &lt;code&gt;lsof -p &amp;lt;pid&amp;gt; | wc -l&lt;/code&gt; æ£€æŸ¥è¿›ç¨‹ FD æ•°é‡&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Linux ç¯å¢ƒ&lt;/strong&gt;ï¼šSelector åº•å±‚ä¸º &lt;code&gt;epoll&lt;/code&gt;ï¼Œ&lt;strong&gt;é«˜æ€§èƒ½é¦–é€‰&lt;/strong&gt;ï¼Œæ”¯æŒç™¾ä¸‡çº§å¹¶å‘&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Windows ç¯å¢ƒ&lt;/strong&gt;ï¼šæ€§èƒ½ç“¶é¢ˆæ˜æ˜¾ï¼ˆ&lt;code&gt;select&lt;/code&gt;/&lt;code&gt;WSAPoll&lt;/code&gt;ï¼‰ï¼Œ&lt;strong&gt;ä¸å»ºè®®ç”¨äºé«˜å¹¶å‘åœºæ™¯&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼š
ä¼˜å…ˆä½¿ç”¨ â€‹&lt;strong&gt;Netty æ¡†æ¶&lt;/strong&gt;â€‹ï¼ˆå°è£… &lt;code&gt;epoll&lt;/code&gt; ET æ¨¡å¼ + çº¿ç¨‹æ± ä¼˜åŒ–ï¼‰ï¼Œé¿å…ç›´æ¥æ“ä½œå¤æ‚ NIO API&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;Selector.open()&lt;/code&gt; å¯è‡ªåŠ¨é€‚é…æ“ä½œç³»ç»Ÿæœ€ä¼˜å®ç°ï¼Œä½†&lt;strong&gt;ç†è§£åº•å±‚æœºåˆ¶&lt;/strong&gt;æ˜¯ä¼˜åŒ–é«˜å¹¶å‘ç³»ç»Ÿçš„å…³é”® ğŸ”‘ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="kqueue"&gt;kqueue
&lt;/h2&gt;&lt;p&gt;kqueue æ˜¯ BSD ç³»ç»Ÿï¼ˆå¦‚ FreeBSDã€macOSï¼‰ä¸­é«˜æ•ˆçš„äº‹ä»¶é©±åŠ¨ I/O å¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œé€šè¿‡å†…æ ¸çº§äº‹ä»¶é˜Ÿåˆ—ç®¡ç†ï¼Œæ˜¾è‘—æå‡é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€æ¶æ„è®¾è®¡ã€ä½¿ç”¨æ–¹å¼ã€ä¸åŒç±»æŠ€æœ¯å¯¹æ¯”åŠå®è·µåº”ç”¨å±•å¼€è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸è®¾è®¡æ€æƒ³"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸è®¾è®¡æ€æƒ³&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="äº‹ä»¶é©±åŠ¨æ¨¡å‹"&gt;&lt;strong&gt;äº‹ä»¶é©±åŠ¨æ¨¡å‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— è½®è¯¢æœºåˆ¶&lt;/strong&gt;ï¼šä¸ä¼ ç»Ÿ &lt;code&gt;select&lt;/code&gt;/&lt;code&gt;poll&lt;/code&gt; çš„å…¨é‡æ‰«æä¸åŒï¼Œkqueue é‡‡ç”¨äº‹ä»¶å›è°ƒæœºåˆ¶ï¼Œä»…å½“æ³¨å†Œçš„äº‹ä»¶ï¼ˆå¦‚å¥—æ¥å­—å¯è¯»ã€æ–‡ä»¶ä¿®æ”¹ï¼‰å‘ç”Ÿæ—¶ï¼Œå†…æ ¸ä¸»åŠ¨é€šçŸ¥åº”ç”¨ï¼Œé¿å… CPU ç©ºè½¬&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å†…æ ¸äº‹ä»¶é˜Ÿåˆ—ï¼šå†…æ ¸ç»´æŠ¤ä¸€ä¸ª
kqueue å®ä¾‹
ï¼ŒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…´è¶£åˆ—è¡¨ï¼ˆInterest Listï¼‰&lt;/strong&gt;ï¼šå­˜å‚¨åº”ç”¨æ³¨å†Œçš„ç›‘å¬äº‹ä»¶ï¼ˆå¦‚æ–‡ä»¶æè¿°ç¬¦ã€ä¿¡å·ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°±ç»ªé˜Ÿåˆ—ï¼ˆReady Listï¼‰&lt;/strong&gt;ï¼šå­˜æ”¾å·²è§¦å‘çš„äº‹ä»¶ï¼Œé€šè¿‡ &lt;code&gt;kevent()&lt;/code&gt; æ‰¹é‡è¿”å›ç»™åº”ç”¨&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…³é”®æ•°æ®ç»“æ„"&gt;&lt;strong&gt;å…³é”®æ•°æ®ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;struct kevent
&lt;/code&gt;&lt;/pre&gt;**ï¼šäº‹ä»¶æè¿°å•å…ƒï¼Œå®šä¹‰ç›‘æ§ç›®æ ‡ä¸æ¡ä»¶ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;struct kevent {
uintptr_t ident; // äº‹ä»¶æ ‡è¯†ï¼ˆå¦‚æ–‡ä»¶æè¿°ç¬¦ã€è¿›ç¨‹IDï¼‰
int16_t filter; // äº‹ä»¶ç±»å‹ï¼ˆå¦‚ EVFILT_READã€EVFILT_WRITEï¼‰
uint16_t flags; // æ“ä½œæ ‡å¿—ï¼ˆEV_ADDã€EV_DELETEï¼‰
intptr_t data; // äº‹ä»¶æ•°æ®ï¼ˆå¦‚å¯è¯»å­—èŠ‚æ•°ï¼‰
void *udata; // ç”¨æˆ·è‡ªå®šä¹‰æ•°æ®ï¼ˆä¼ é€’ä¸Šä¸‹æ–‡ï¼‰
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;knote&lt;/code&gt;&lt;/strong&gt;ï¼šå†…æ ¸å±‚å¯¹åº” &lt;code&gt;kevent&lt;/code&gt; çš„ç»“æ„ï¼Œè´Ÿè´£è¿æ¥äº‹ä»¶æºï¼ˆå¦‚ socketï¼‰ä¸ kqueueï¼Œé€šè¿‡è¿‡æ»¤å™¨ï¼ˆFilterï¼‰åˆ¤æ–­äº‹ä»¶æ˜¯å¦å°±ç»ª&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è¿‡æ»¤å™¨filteræœºåˆ¶"&gt;&lt;strong&gt;è¿‡æ»¤å™¨ï¼ˆFilterï¼‰æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æ¯ä¸ªäº‹ä»¶ç±»å‹å¯¹åº”ä¸€ä¸ªè¿‡æ»¤å™¨ï¼ŒåŒ…å«ä¸‰éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;attach()&lt;/code&gt;&lt;/strong&gt;ï¼šå°† knote ç»‘å®šåˆ°äº‹ä»¶æºï¼ˆå¦‚æ³¨å†Œ socket è¯»äº‹ä»¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;detach()&lt;/code&gt;&lt;/strong&gt;ï¼šè§£é™¤ç»‘å®šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;filter()&lt;/code&gt;&lt;/strong&gt;ï¼šäº‹ä»¶è§¦å‘æ—¶æ£€æŸ¥æ¡ä»¶ï¼ˆå¦‚ç¼“å†²åŒºæ•°æ®é‡ â‰¥ é˜ˆå€¼ï¼‰ï¼Œå†³å®šæ˜¯å¦åŠ å…¥å°±ç»ªé˜Ÿåˆ—&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹ä¸-api-è§£æ"&gt;ğŸ§  &lt;strong&gt;å·¥ä½œæµç¨‹ä¸ API è§£æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç³»ç»Ÿè°ƒç”¨"&gt;&lt;strong&gt;æ ¸å¿ƒç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;API&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;kqueue()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»º kqueue å®ä¾‹ï¼Œè¿”å›æ–‡ä»¶æè¿°ç¬¦&lt;/td&gt;
&lt;td&gt;æ— å‚æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;kevent()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ³¨å†Œäº‹ä»¶ + è·å–å°±ç»ªäº‹ä»¶&lt;/td&gt;
&lt;td&gt;&lt;code&gt;changelist&lt;/code&gt;ï¼šæ³¨å†Œ/ä¿®æ”¹çš„äº‹ä»¶åˆ—è¡¨ &lt;code&gt;eventlist&lt;/code&gt;ï¼šè¾“å‡ºå°±ç»ªäº‹ä»¶&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="å…¸å‹ä½¿ç”¨æµç¨‹"&gt;&lt;strong&gt;å…¸å‹ä½¿ç”¨æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;#include &amp;lt;sys/event.h&amp;gt;
int main() {
// 1. åˆ›å»º kqueue
int kq = kqueue();
// 2. æ³¨å†Œäº‹ä»¶ï¼ˆç›‘å¬æ ‡å‡†è¾“å…¥å¯è¯»ï¼‰
struct kevent changelist[1];
EV_SET(&amp;amp;changelist[0], STDIN_FILENO, EVFILT_READ, EV_ADD, 0, 0, NULL);
// 3. ç­‰å¾…äº‹ä»¶è§¦å‘
struct kevent events[1];
int nev = kevent(kq, changelist, 1, events, 1, NULL); // é˜»å¡ç­‰å¾…
// 4. å¤„ç†äº‹ä»¶
if (events[0].filter == EVFILT_READ) {
char buf[1024];
read(STDIN_FILENO, buf, sizeof(buf));
}
close(kq);
}
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®æ“ä½œ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;EV_SET&lt;/code&gt; å®åˆå§‹åŒ–äº‹ä»¶ï¼ˆè®¾ç½®æ–‡ä»¶æè¿°ç¬¦ã€äº‹ä»¶ç±»å‹ã€æ“ä½œæ ‡å¿—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;kevent()&lt;/code&gt; åŒæ—¶æ”¯æŒæ³¨å†Œäº‹ä»¶ï¼ˆ&lt;code&gt;changelist&lt;/code&gt;ï¼‰å’Œè·å–äº‹ä»¶ï¼ˆ&lt;code&gt;eventlist&lt;/code&gt;ï¼‰ï¼Œå•æ¬¡è°ƒç”¨å¯å®Œæˆæ‰¹é‡æ›´æ–°&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä¼˜åŠ¿ä¸ç‰¹æ€§"&gt;âš¡ &lt;strong&gt;æ ¸å¿ƒä¼˜åŠ¿ä¸ç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é«˜æ€§èƒ½è®¾è®¡"&gt;&lt;strong&gt;é«˜æ€§èƒ½è®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;O(1) äº‹ä»¶æ£€æµ‹&lt;/strong&gt;ï¼šå°±ç»ªäº‹ä»¶ç›´æ¥åŠ å…¥å†…æ ¸é˜Ÿåˆ—ï¼Œåº”ç”¨æ— éœ€éå†æ‰€æœ‰æè¿°ç¬¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›¶æ‹·è´é€šçŸ¥&lt;/strong&gt;ï¼šé€šè¿‡å…±äº«å†…å­˜ï¼ˆ&lt;code&gt;mmap&lt;/code&gt;ï¼‰ä¼ é€’äº‹ä»¶æ•°æ®ï¼Œå‡å°‘å†…æ ¸-ç”¨æˆ·æ€æ‹·è´&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤šäº‹ä»¶ç±»å‹æ”¯æŒ"&gt;&lt;strong&gt;å¤šäº‹ä»¶ç±»å‹æ”¯æŒ&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;kqueue ä¸ä»…å¤„ç†ç½‘ç»œ I/Oï¼Œè¿˜æ”¯æŒï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;äº‹ä»¶ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¿‡æ»¤å™¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¿¡å·é€šçŸ¥&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EVFILT_SIGNAL&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç›‘æ§ &lt;code&gt;SIGINT&lt;/code&gt;ã€&lt;code&gt;SIGTERM&lt;/code&gt; ç­‰ä¿¡å·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¿›ç¨‹çŠ¶æ€å˜æ›´&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EVFILT_PROC&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·Ÿè¸ªå­è¿›ç¨‹é€€å‡ºï¼ˆ&lt;code&gt;NOTE_EXIT&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ–‡ä»¶ç³»ç»Ÿä¿®æ”¹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EVFILT_VNODE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç›‘å¬æ–‡ä»¶åˆ›å»ºã€åˆ é™¤ã€å±æ€§å˜æ›´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å®šæ—¶å™¨&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EVFILT_TIMER&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çº³ç§’çº§ç²¾åº¦çš„å®šæ—¶ä»»åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šæ— éœ€ Linux çš„ &lt;code&gt;signalfd&lt;/code&gt;/&lt;code&gt;timerfd&lt;/code&gt; ç­‰è¡¥ä¸æœºåˆ¶ï¼ŒåŸç”Ÿç»Ÿä¸€ç®¡ç†å„ç±»äº‹ä»¶&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id="åŠ¨æ€äº‹ä»¶ç®¡ç†"&gt;&lt;strong&gt;åŠ¨æ€äº‹ä»¶ç®¡ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å•æ¬¡ &lt;code&gt;kevent()&lt;/code&gt; è°ƒç”¨å¯åŒæ—¶å®Œæˆäº‹ä»¶æ³¨å†Œã€åˆ é™¤ã€ä¿®æ”¹ï¼Œé¿å… &lt;code&gt;epoll_ctl()&lt;/code&gt; å¤šæ¬¡è°ƒç”¨çš„å¼€é”€&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸-epoll-çš„å¯¹æ¯”"&gt;ğŸ”„ &lt;strong&gt;ä¸ epoll çš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;kqueue&lt;/strong&gt; (BSD/macOS)&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;epoll&lt;/strong&gt; (Linux)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹ä»¶èŒƒå›´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒæ–‡ä»¶ã€ä¿¡å·ã€è¿›ç¨‹ã€å®šæ—¶å™¨ç­‰éæ–‡ä»¶äº‹ä»¶&lt;/td&gt;
&lt;td&gt;ä»…æ”¯æŒæ–‡ä»¶æè¿°ç¬¦äº‹ä»¶ï¼ˆéœ€ &lt;code&gt;signalfd&lt;/code&gt; ç­‰æ‰©å±•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;API å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•ä¸€ &lt;code&gt;kevent()&lt;/code&gt; æ¥å£ï¼Œé€»è¾‘ç®€æ´&lt;/td&gt;
&lt;td&gt;éœ€ &lt;code&gt;epoll_create&lt;/code&gt; + &lt;code&gt;epoll_ctl&lt;/code&gt; + &lt;code&gt;epoll_wait&lt;/code&gt; ä¸‰æ­¥éª¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰¹é‡æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å•æ¬¡è°ƒç”¨å¯æ³¨å†Œ/è·å–å¤šä¸ªäº‹ä»¶&lt;/td&gt;
&lt;td&gt;âŒ æ¯æ¬¡ &lt;code&gt;epoll_ctl()&lt;/code&gt; ä»…æ“ä½œä¸€ä¸ªæè¿°ç¬¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç£ç›˜æ–‡ä»¶æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… é€šè¿‡ &lt;code&gt;EVFILT_AIO&lt;/code&gt; å…³è”å¼‚æ­¥ I/O&lt;/td&gt;
&lt;td&gt;âŒ ä»…æ”¯æŒå°±ç»ªé€šçŸ¥ï¼Œä¸é€‚ç”¨é˜»å¡å‹ç£ç›˜ I/O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹³å°å…¼å®¹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;BSD/macOS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€§èƒ½ç»“è®º&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°è§„æ¨¡å¹¶å‘ï¼šepoll ä¸ kqueue æ€§èƒ½æ¥è¿‘ã€‚&lt;/li&gt;
&lt;li&gt;å¤§è§„æ¨¡å¹¶å‘ + æ··åˆäº‹ä»¶ï¼škqueue å› ç»Ÿä¸€äº‹ä»¶æ¨¡å‹å’Œæ‰¹é‡æ“ä½œæ›´å…·ä¼˜åŠ¿&lt;a class="link" href="@ref" &gt;8,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ"&gt;ğŸ› ï¸ &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…¸å‹ä½¿ç”¨åœºæ™¯"&gt;&lt;strong&gt;å…¸å‹ä½¿ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘ç½‘ç»œæœåŠ¡å™¨&lt;/strong&gt;ï¼šNginxï¼ˆBSD ç‰ˆï¼‰ã€Redisï¼ˆmacOS ç‰ˆï¼‰ä½¿ç”¨ kqueue å¤„ç†ä¸‡çº§è¿æ¥&lt;a class="link" href="@ref" &gt;3,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶ç›‘æ§ç³»ç»Ÿ&lt;/strong&gt;ï¼šç›‘å¬æ–‡ä»¶å˜åŒ–ï¼ˆå¦‚æ—¥å¿—è½®è½¬ï¼‰ã€è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨äº‹ä»¶ç±»å‹åè°ƒ&lt;/strong&gt;ï¼šç»Ÿä¸€å¤„ç†ç½‘ç»œ I/O + ä¿¡å· + å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å®è·µæ³¨æ„äº‹é¡¹"&gt;&lt;strong&gt;å®è·µæ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;éé˜»å¡ I/O å¿…é¡»ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;fcntl(fd, F_SETFL, O_NONBLOCK); // é¿å… read/write é˜»å¡äº‹ä»¶å¾ªç¯[5](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;èµ„æºæ³„æ¼é¢„é˜²ï¼š
&lt;ul&gt;
&lt;li&gt;å…³é—­ kqueue æè¿°ç¬¦æ—¶è‡ªåŠ¨é‡Šæ”¾å…³è”äº‹ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ˜¾å¼åˆ é™¤äº‹ä»¶ï¼š&lt;code&gt;EV_SET(..., EV_DELETE, ...)&lt;/code&gt;&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹ä»¶é£æš´åº”å¯¹&lt;/strong&gt;ï¼š
è®¾ç½® &lt;code&gt;EV_ENABLE&lt;/code&gt;/&lt;code&gt;EV_DISABLE&lt;/code&gt; ä¸´æ—¶å±è”½äº‹ä»¶ï¼Œé¿å…é«˜é¢‘äº‹ä»¶å‹å®åº”ç”¨&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;kqueue å‡­å€Ÿå…¶&lt;strong&gt;äº‹ä»¶é©±åŠ¨æ¶æ„&lt;/strong&gt;ã€&lt;strong&gt;å¤šç±»å‹äº‹ä»¶æ”¯æŒ&lt;/strong&gt;å’Œ&lt;strong&gt;æ‰¹é‡æ“ä½œæ¥å£&lt;/strong&gt;ï¼Œæˆä¸º BSD ç”Ÿæ€ä¸­é«˜æ€§èƒ½ I/O çš„åŸºçŸ³ã€‚å°½ç®¡å…¶å¹³å°é™åˆ¶åœ¨ Linux æ™®åŠçš„ä»Šå¤©ç•¥æ˜¾å±€é™ï¼Œä½†åœ¨ macOS æœåŠ¡å™¨ã€FreeBSD ç½‘ç»œè®¾å¤‡åŠæ··åˆäº‹ä»¶å¤„ç†åœºæ™¯ä¸­ï¼Œkqueue ä»æ˜¯ä¸å¯æ›¿ä»£çš„åº•å±‚å¼•æ“ã€‚å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œç†è§£å…¶è®¾è®¡å“²å­¦ï¼ˆ&lt;strong&gt;äº‹ä»¶ç»Ÿä¸€æŠ½è±¡&lt;/strong&gt; + &lt;strong&gt;å†…æ ¸ä¸»åŠ¨é€šçŸ¥&lt;/strong&gt;ï¼‰æ¯”è®°å¿† API æ›´é‡è¦â€”â€”è¿™æ­£æ˜¯æ„å»ºäº¿çº§å¹¶å‘ç³»ç»Ÿçš„æ ¸å¿ƒæ€ç»´&lt;a class="link" href="@ref" &gt;1,6,9&lt;/a&gt;ã€‚&lt;/p&gt;</description></item><item><title>ã€Javaã€‘æ³¨è§£</title><link>https://dyhes.github.io/p/java%E6%B3%A8%E8%A7%A3/</link><pubDate>Fri, 04 Jul 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/java%E6%B3%A8%E8%A7%A3/</guid><description>&lt;h2 id="æ³¨è§£"&gt;æ³¨è§£
&lt;/h2&gt;&lt;p&gt;Java æ³¨è§£ï¼ˆAnnotationï¼‰æ˜¯ Java 5 å¼•å…¥çš„ä¸€ç§&lt;strong&gt;å…ƒæ•°æ®æœºåˆ¶&lt;/strong&gt;ï¼Œç”¨äºä¸ºä»£ç æ·»åŠ è¯´æ˜ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯è¢«ç¼–è¯‘å™¨ã€å·¥å…·æˆ–è¿è¡Œæ—¶ç¯å¢ƒè¯»å–å’Œå¤„ç†ï¼Œä»è€Œå¢å¼ºä»£ç çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ä¸‹é¢ä»æ ¸å¿ƒæ¦‚å¿µåˆ°é«˜çº§åº”ç”¨è¿›è¡Œç³»ç»Ÿä»‹ç»ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="æ³¨è§£åŸºç¡€æ¦‚å¿µ"&gt;æ³¨è§£åŸºç¡€æ¦‚å¿µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨ä¸ä½œç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…ƒæ•°æ®&lt;/strong&gt;ï¼šæ³¨è§£æ˜¯é™„åŠ åœ¨ç±»ã€æ–¹æ³•ã€å­—æ®µç­‰ç¨‹åºå…ƒç´ ä¸Šçš„æ•°æ®ï¼Œæœ¬èº«ä¸å½±å“ç¨‹åºé€»è¾‘ï¼Œä½†æä¾›é¢å¤–ä¿¡æ¯&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒç”¨é€”ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æ£€æŸ¥&lt;/strong&gt;ï¼šå¦‚ &lt;code&gt;@Override&lt;/code&gt; ç¡®ä¿æ–¹æ³•æ­£ç¡®é‡å†™çˆ¶ç±»æ–¹æ³•&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç ç”Ÿæˆ&lt;/strong&gt;ï¼šå·¥å…·ï¼ˆå¦‚ Lombokï¼‰æ ¹æ®æ³¨è§£è‡ªåŠ¨ç”Ÿæˆä»£ç ï¼ˆå¦‚ getter/setterï¼‰&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶å¤„ç†&lt;/strong&gt;ï¼šæ¡†æ¶ï¼ˆå¦‚ Springï¼‰é€šè¿‡åå°„è¯»å–æ³¨è§£å®ç°ä¾èµ–æ³¨å…¥ç­‰åŠ¨æ€è¡Œä¸º&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡æ¡£ç”Ÿæˆ&lt;/strong&gt;ï¼šJavadoc è§£ææ³¨è§£ç”Ÿæˆ API æ–‡æ¡£&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºæœ¬è¯­æ³•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»¥ @ å¼€å¤´ï¼Œåæ¥æ³¨è§£åï¼Œå¯åŒ…å«å‚æ•°ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Override // æ— å‚æ•°æ³¨è§£
@Deprecated(since=&amp;#34;1.8&amp;#34;) // å¸¦å‚æ•°æ³¨è§£
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="java-å†…ç½®æ³¨è§£"&gt;Java å†…ç½®æ³¨è§£
&lt;/h3&gt;&lt;p&gt;Java æä¾›ä»¥ä¸‹å¸¸ç”¨å†…ç½®æ³¨è§£ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ³¨è§£&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@Override&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ‡è®°æ–¹æ³•é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œç¼–è¯‘å™¨éªŒè¯ç­¾åæ­£ç¡®æ€§&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@Override public void run() {...}&lt;/code&gt;&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@Deprecated&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ‡è®°å…ƒç´ ï¼ˆç±»/æ–¹æ³•ï¼‰å·²è¿‡æ—¶ï¼Œç¼–è¯‘å™¨è­¦å‘Šä½¿ç”¨è€…&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@Deprecated public void oldMethod()&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@SuppressWarnings&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŠ‘åˆ¶ç¼–è¯‘å™¨è­¦å‘Šï¼ˆå¦‚æœªæ£€æŸ¥è½¬æ¢ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@SuppressWarnings(&amp;quot;unchecked&amp;quot;)&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@FunctionalInterface&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ‡è®°æ¥å£ä¸ºå‡½æ•°å¼æ¥å£ï¼ˆä»…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@FunctionalInterface interface Calc { int compute(); }&lt;/code&gt;&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="å…ƒæ³¨è§£meta-annotations"&gt;å…ƒæ³¨è§£ï¼ˆMeta-Annotationsï¼‰
&lt;/h3&gt;&lt;p&gt;å…ƒæ³¨è§£ç”¨äº&lt;strong&gt;å®šä¹‰æ³¨è§£çš„è¡Œä¸º&lt;/strong&gt;ï¼Œéœ€ç»“åˆ &lt;code&gt;java.lang.annotation&lt;/code&gt; åŒ…ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Target&lt;/code&gt;&lt;/strong&gt;
æŒ‡å®šæ³¨è§£å¯åº”ç”¨çš„å…ƒç´ ç±»å‹ï¼ˆé€šè¿‡ &lt;code&gt;ElementType&lt;/code&gt; æšä¸¾ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Target({ElementType.METHOD, ElementType.TYPE}) // ä½œç”¨äºæ–¹æ³•æˆ–ç±»
public @interface MyAnnotation {}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å¸¸ç”¨ç±»å‹ï¼š&lt;code&gt;TYPE&lt;/code&gt;ï¼ˆç±»ï¼‰ã€&lt;code&gt;METHOD&lt;/code&gt;ï¼ˆæ–¹æ³•ï¼‰ã€&lt;code&gt;FIELD&lt;/code&gt;ï¼ˆå­—æ®µï¼‰ç­‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Retention&lt;/code&gt;&lt;/strong&gt;
æ§åˆ¶æ³¨è§£ç”Ÿå‘½å‘¨æœŸï¼ˆé€šè¿‡ &lt;code&gt;RetentionPolicy&lt;/code&gt; æšä¸¾ï¼‰ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;SOURCE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä»…å­˜æºç ï¼ˆç¼–è¯‘åä¸¢å¼ƒï¼Œå¦‚ &lt;code&gt;@Override&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CLASS&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å­˜äºå­—èŠ‚ç ï¼ˆé»˜è®¤ï¼Œè¿è¡Œæ—¶ä¸å¯è®¿é—®ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;RUNTIME&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ—¶ä¿ç•™ï¼ˆå¯é€šè¿‡åå°„è¯»å–ï¼‰&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Documented&lt;/code&gt;&lt;/strong&gt;
æ³¨è§£ä¿¡æ¯åŒ…å«åœ¨ Javadoc ä¸­&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Inherited&lt;/code&gt;&lt;/strong&gt;
å­ç±»è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„æ³¨è§£ï¼ˆä»…ä½œç”¨äºç±»ï¼‰&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="è‡ªå®šä¹‰æ³¨è§£"&gt;è‡ªå®šä¹‰æ³¨è§£
&lt;/h3&gt;&lt;p&gt;é€šè¿‡ &lt;code&gt;@interface&lt;/code&gt; å®šä¹‰è‡ªå®šä¹‰æ³¨è§£ï¼Œæ”¯æŒæ·»åŠ å…ƒç´ å’Œé»˜è®¤å€¼ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Timer {
String name() default &amp;#34;defaultTimer&amp;#34;; // å…ƒç´ å¯è®¾é»˜è®¤å€¼
int timeout() default 30;
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…ƒç´ é™åˆ¶&lt;/strong&gt;ï¼šä»…æ”¯æŒåŸºæœ¬ç±»å‹ã€&lt;code&gt;String&lt;/code&gt;ã€æšä¸¾ã€æ³¨è§£åŠæ•°ç»„&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public class Task {
@Timer(name = &amp;#34;taskTimer&amp;#34;, timeout = 60)
public void execute() {...}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="æ³¨è§£å¤„ç†æœºåˆ¶"&gt;æ³¨è§£å¤„ç†æœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æ—¶å¤„ç†&lt;/strong&gt;
æ³¨è§£å¤„ç†å™¨ï¼ˆAnnotation Processorï¼‰ï¼šç»§æ‰¿ AbstractProcessorï¼Œåœ¨ç¼–è¯‘æ—¶æ‰«ææ³¨è§£å¹¶ç”Ÿæˆä»£ç æˆ–é…ç½®æ–‡ä»¶
&lt;pre tabindex="0"&gt;&lt;code&gt;@SupportedAnnotationTypes(&amp;#34;com.example.Timer&amp;#34;)
public class TimerProcessor extends AbstractProcessor {
@Override
public boolean process(...) {
// å¤„ç†æ³¨è§£é€»è¾‘
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶å¤„ç†&lt;/strong&gt;
é€šè¿‡&lt;strong&gt;åå°„&lt;/strong&gt;è¯»å– &lt;code&gt;RUNTIME&lt;/code&gt; ä¿ç•™çš„æ³¨è§£ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Method method = Task.class.getMethod(&amp;#34;execute&amp;#34;);
if (method.isAnnotationPresent(Timer.class)) {
Timer timer = method.getAnnotation(Timer.class);
System.out.println(&amp;#34;Timeout: &amp;#34; + timer.timeout());
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="åº”ç”¨åœºæ™¯"&gt;åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¡†æ¶é…ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Spring çš„ &lt;code&gt;@Autowired&lt;/code&gt;ï¼ˆä¾èµ–æ³¨å…¥ï¼‰ã€&lt;code&gt;@Service&lt;/code&gt;ï¼ˆå£°æ˜ Beanï¼‰&lt;a class="link" href="@ref" &gt;8,9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®æ ¡éªŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Hibernate çš„ &lt;code&gt;@NotNull&lt;/code&gt;ï¼ˆå­—æ®µéç©ºæ ¡éªŒï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;AOP ç¼–ç¨‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»“åˆ Spring AOP å®ç°æ—¥å¿—è®°å½•ã€æ€§èƒ½ç›‘æ§ï¼ˆå¦‚ &lt;code&gt;@Log&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æµ‹è¯•æ¡†æ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JUnit çš„ &lt;code&gt;@Test&lt;/code&gt;ï¼ˆæ ‡è®°æµ‹è¯•æ–¹æ³•ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹"&gt;æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…è¿‡åº¦ä½¿ç”¨&lt;/strong&gt;ï¼šå¤§é‡æ³¨è§£é™ä½ä»£ç å¯è¯»æ€§&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è€ƒé‡&lt;/strong&gt;ï¼šåå°„è¯»å–è¿è¡Œæ—¶æ³¨è§£å¯èƒ½å¼•å…¥å¼€é”€&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜ç¡®ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;ï¼šæ ¹æ®åœºæ™¯é€‰æ‹© &lt;code&gt;SOURCE&lt;/code&gt;/&lt;code&gt;CLASS&lt;/code&gt;/&lt;code&gt;RUNTIME&lt;/code&gt;ï¼Œé¿å…ä¸å¿…è¦çš„è¿è¡Œæ—¶ä¿ç•™&lt;a class="link" href="@ref" &gt;2,9&lt;/a&gt;ã€‚
é€šè¿‡æŒæ¡æ³¨è§£çš„æ ¸å¿ƒæœºåˆ¶å’Œçµæ´»åº”ç”¨ï¼Œå¼€å‘è€…èƒ½æ˜¾è‘—æå‡ä»£ç çš„ç®€æ´æ€§å’Œæ¡†æ¶é›†æˆæ•ˆç‡ã€‚å®é™…å¼€å‘ä¸­å¯ç»“åˆ Springã€Lombok ç­‰æ¡†æ¶æ·±å…¥å®è·µæ³¨è§£çš„é«˜çº§åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="å…ƒæ³¨è§£"&gt;å…ƒæ³¨è§£
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ Java ä¸­æ‰€æœ‰å…ƒæ³¨è§£çš„è¯¦ç»†ä»‹ç»ï¼Œç»“åˆå…¶æ ¸å¿ƒåŠŸèƒ½ã€å‚æ•°é€‰é¡¹ã€ä½¿ç”¨åœºæ™¯åŠä»£ç ç¤ºä¾‹è¿›è¡Œç³»ç»Ÿè¯´æ˜ã€‚å…ƒæ³¨è§£ï¼ˆMeta-Annotationï¼‰æ˜¯ç”¨äºä¿®é¥°å…¶ä»–æ³¨è§£çš„æ³¨è§£ï¼Œæ§åˆ¶æ³¨è§£çš„è¡Œä¸ºå’Œç‰¹æ€§ã€‚Java æä¾› 5 ç§æ ¸å¿ƒå…ƒæ³¨è§£ï¼ˆJava 5 å®šä¹‰ 4 ç§ï¼ŒJava 8 æ–°å¢ 1 ç§ï¼‰ï¼Œå¦æœ‰ä¸€ä¸ªè¾…åŠ©æ€§å…ƒæ³¨è§£ &lt;code&gt;@Native&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå…ƒæ³¨è§£"&gt;ğŸ“Œ &lt;strong&gt;æ ¸å¿ƒå…ƒæ³¨è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="target"&gt;&lt;strong&gt;&lt;code&gt;@Target&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šå®šä¹‰æ³¨è§£å¯åº”ç”¨çš„ç¨‹åºå…ƒç´ èŒƒå›´&lt;a class="link" href="@ref" &gt;1,3,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;ï¼š&lt;code&gt;ElementType&lt;/code&gt; æšä¸¾æ•°ç»„ï¼Œå¸¸ç”¨å€¼åŒ…æ‹¬ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å–å€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨ç›®æ ‡&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;TYPE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç±»ã€æ¥å£ã€æšä¸¾ã€æ³¨è§£ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;FIELD&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å­—æ®µï¼ˆå«æšä¸¾å¸¸é‡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;METHOD&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;PARAMETER&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ–¹æ³•å‚æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CONSTRUCTOR&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ„é€ å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LOCAL_VARIABLE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ANNOTATION_TYPE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å…¶ä»–æ³¨è§£ï¼ˆå…ƒæ³¨è§£è‡ªèº«ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;PACKAGE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŒ…å£°æ˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;TYPE_PARAMETER&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ³›å‹ç±»å‹å‚æ•°ï¼ˆJava 8+ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;TYPE_USE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç±»å‹ä½¿ç”¨è¯­å¥ï¼ˆå¦‚æ³›å‹ã€ç±»å‹è½¬æ¢ï¼ŒJava 8+ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Target({ElementType.METHOD, ElementType.TYPE})
public @interface Loggable { // ä»…ç”¨äºç±»å’Œæ–¹æ³•
String category() default &amp;#34;INFO&amp;#34;;
} [6,7](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4 id="retention"&gt;&lt;strong&gt;&lt;code&gt;@Retention&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šæŒ‡å®šæ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸï¼ˆä¿ç•™ç­–ç•¥ï¼‰&lt;a class="link" href="@ref" &gt;1,4,12&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;ï¼š&lt;code&gt;RetentionPolicy&lt;/code&gt; æšä¸¾ï¼Œå¯é€‰å€¼ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;SOURCE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä»…å­˜äºæºç ï¼ˆç¼–è¯‘æ—¶ä¸¢å¼ƒï¼‰ï¼Œå¦‚ &lt;code&gt;@Override&lt;/code&gt;ã€&lt;code&gt;@SuppressWarnings&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CLASS&lt;/code&gt;ï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
&lt;td&gt;ä¿ç•™è‡³å­—èŠ‚ç ï¼ˆè¿è¡Œæ—¶ä¸å¯è®¿é—®ï¼‰ï¼Œé€‚ç”¨äºç¼–è¯‘æ—¶å¤„ç†ï¼ˆå¦‚ Lombokï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;RUNTIME&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ—¶ä¿ç•™ï¼ˆå¯é€šè¿‡åå°„è¯»å–ï¼‰ï¼Œå¦‚ Spring çš„ &lt;code&gt;@Autowired&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Retention(RetentionPolicy.RUNTIME)
public @interface RuntimeConfig { // è¿è¡Œæ—¶å¯é€šè¿‡åå°„è·å–
String value();
} [4,12](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4 id="documented"&gt;&lt;strong&gt;&lt;code&gt;@Documented&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šæ ‡è®°æ³¨è§£æ˜¯å¦åŒ…å«åœ¨ Javadoc ç”Ÿæˆçš„ API æ–‡æ¡£ä¸­&lt;a class="link" href="@ref" &gt;1,3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;ï¼šæ— å‚æ•°ï¼Œä»…ä½œä¸ºæ ‡è®°ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Documented
@Retention(RetentionPolicy.RUNTIME)
public @interface ApiNote { // ç”Ÿæˆ Javadoc æ—¶ä¼šæ˜¾ç¤ºæ­¤æ³¨è§£
String description();
} [3,8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4 id="inherited"&gt;&lt;strong&gt;&lt;code&gt;@Inherited&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šå­ç±»è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„æ³¨è§£ï¼ˆä»…å¯¹ç±»æ³¨è§£ç”Ÿæ•ˆï¼‰&lt;a class="link" href="@ref" &gt;1,2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™åˆ¶&lt;/strong&gt;ï¼šä¸é€‚ç”¨äºæ–¹æ³•ã€å­—æ®µç­‰å…¶ä»–å…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Inherited
@Retention(RetentionPolicy.RUNTIME)
public @interface InheritedConfig {}
@InheritedConfig
class Parent {}
class Child extends Parent {} // Child è‡ªåŠ¨ç»§æ‰¿ @InheritedConfig[1,8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4 id="repeatable"&gt;&lt;strong&gt;&lt;code&gt;@Repeatable&lt;/code&gt;ï¼ˆJava 8+ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šå…è®¸åŒä¸€æ³¨è§£åœ¨å•ä¸ªå…ƒç´ ä¸Šé‡å¤ä½¿ç”¨&lt;a class="link" href="@ref" &gt;1,2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¦æ±‚&lt;/strong&gt;ï¼šéœ€å®šä¹‰å®¹å™¨æ³¨è§£å­˜å‚¨é‡å¤æ³¨è§£ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Repeatable(Roles.class)
public @interface Role {
String value();
}
public @interface Roles {
Role[] value(); // å®¹å™¨æ³¨è§£
}
@Role(&amp;#34;admin&amp;#34;)
@Role(&amp;#34;user&amp;#34;)
public class User {} // æ— éœ€æ˜¾å¼ä½¿ç”¨å®¹å™¨[1,4](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è¾…åŠ©å…ƒæ³¨è§£"&gt;âš™ï¸ &lt;strong&gt;è¾…åŠ©å…ƒæ³¨è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="native"&gt;&lt;strong&gt;&lt;code&gt;@Native&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šæ ‡è®°å­—æ®µå¯èƒ½è¢«æœ¬åœ°ä»£ç ï¼ˆå¦‚ JNIï¼‰å¼•ç”¨ï¼Œé€šå¸¸ç”±ä»£ç ç”Ÿæˆå·¥å…·ä½¿ç”¨&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public class NativeExample {
@Native public static final int MAX_SIZE = 1024;
} [2](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…ƒæ³¨è§£åŠŸèƒ½å¯¹æ¯”æ€»ç»“"&gt;ğŸ§© &lt;strong&gt;å…ƒæ³¨è§£åŠŸèƒ½å¯¹æ¯”æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å…ƒæ³¨è§£&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…³é”®å‚æ•°/ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@Target&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é™å®šæ³¨è§£ä½œç”¨èŒƒå›´&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ElementType&lt;/code&gt; æšä¸¾æ•°ç»„&lt;/td&gt;
&lt;td&gt;é˜²æ­¢æ³¨è§£è¯¯ç”¨ï¼ˆå¦‚ä»…é™æ–¹æ³•ä½¿ç”¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@Retention&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ§åˆ¶æ³¨è§£ç”Ÿå‘½å‘¨æœŸ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SOURCE&lt;/code&gt;/&lt;code&gt;CLASS&lt;/code&gt;/&lt;code&gt;RUNTIME&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘æ£€æŸ¥ï¼ˆSOURCEï¼‰ã€æ¡†æ¶é…ç½®ï¼ˆRUNTIMEï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@Documented&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŒ…å«æ³¨è§£è‡³ Javadoc&lt;/td&gt;
&lt;td&gt;æ— å‚æ•°ï¼ˆæ ‡è®°å‹ï¼‰&lt;/td&gt;
&lt;td&gt;API æ–‡æ¡£å¢å¼º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@Inherited&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å­ç±»ç»§æ‰¿çˆ¶ç±»æ³¨è§£&lt;/td&gt;
&lt;td&gt;ä»…å¯¹ç±»ç”Ÿæ•ˆ&lt;/td&gt;
&lt;td&gt;æ¡†æ¶åŸºç±»é…ç½®ï¼ˆå¦‚ Spring çš„ &lt;code&gt;@Component&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@Repeatable&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒåŒä¸€æ³¨è§£é‡å¤ä½¿ç”¨&lt;/td&gt;
&lt;td&gt;éœ€å®šä¹‰å®¹å™¨æ³¨è§£&lt;/td&gt;
&lt;td&gt;å¤šè§’è‰²æƒé™å£°æ˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@Native&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ‡è®°å­—æ®µå¯è¢«æœ¬åœ°ä»£ç å¼•ç”¨&lt;/td&gt;
&lt;td&gt;æ— å‚æ•°ï¼ˆæ ‡è®°å‹ï¼‰&lt;/td&gt;
&lt;td&gt;JNI å¼€å‘æˆ–ä»£ç ç”Ÿæˆå·¥å…·&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æœ€ä½³å®è·µå»ºè®®"&gt;ğŸ’¡ &lt;strong&gt;æœ€ä½³å®è·µå»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç²¾å‡†é™å®šä½œç”¨åŸŸï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;@Target&lt;/code&gt; æ˜ç¡®æ³¨è§£é€‚ç”¨èŒƒå›´ï¼Œé¿å…æ»¥ç”¨ï¼ˆå¦‚ä»…é™æ–¹æ³•ä½¿ç”¨çš„æ³¨è§£ä¸åº”æ”¯æŒç±»ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æŒ‰éœ€é€‰æ‹©ç”Ÿå‘½å‘¨æœŸï¼š
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆç”¨ &lt;code&gt;SOURCE&lt;/code&gt; æˆ– &lt;code&gt;CLASS&lt;/code&gt; å‡å°‘è¿è¡Œæ—¶å¼€é”€ï¼›ä»…éœ€åå°„æ—¶é€‰ &lt;code&gt;RUNTIME&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4,12&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è°¨æ…ä½¿ç”¨ &lt;code&gt;@Inherited&lt;/code&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä»…å½“éœ€è¦å­ç±»è‡ªåŠ¨ç»§æ‰¿æ³¨è§£æ—¶ä½¿ç”¨ï¼ˆå¦‚æ¡†æ¶åŸºç±»æ ‡è¯†ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ´»ç”¨ &lt;code&gt;@Repeatable&lt;/code&gt; ç®€åŒ–ä»£ç ï¼š
&lt;ul&gt;
&lt;li&gt;æ›¿ä»£ä¼ ç»Ÿå®¹å™¨æ³¨è§£æ¨¡å¼ï¼Œæå‡ä»£ç å¯è¯»æ€§ï¼ˆJava 8+ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;é€šè¿‡åˆç†ç»„åˆå…ƒæ³¨è§£ï¼Œå¯è®¾è®¡å‡ºçµæ´»ä¸”å¼ºçº¦æŸçš„è‡ªå®šä¹‰æ³¨è§£ï¼Œæ˜¾è‘—æå‡æ¡†æ¶é›†æˆæ•ˆç‡ï¼ˆå¦‚ Spring çš„ &lt;code&gt;@Bean&lt;/code&gt;ï¼‰æˆ–ä»£ç æ£€æŸ¥èƒ½åŠ›ï¼ˆå¦‚ Lombokï¼‰ã€‚æ›´å¤šå®æˆ˜æ¡ˆä¾‹å¯å‚è€ƒ &lt;a class="link" href="https://www.jb51.net/article/273029.htm" target="_blank" rel="noopener"
&gt;Java å…ƒæ³¨è§£åŸç†è¯¦è§£&lt;/a&gt;&lt;a class="link" href="@ref" &gt;2&lt;/a&gt; æˆ– &lt;a class="link" href="https://www.oryoy.com/news/java-zhong-ru-he-gao-xiao-li-yong-target-shi-xian-dai-ma-you-hua-yu-zhong-gou-a15046509.html" target="_blank" rel="noopener"
&gt;@Target ä¼˜åŒ–æŒ‡å—&lt;/a&gt;&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="interface"&gt;@interface
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œ&lt;code&gt;@interface&lt;/code&gt; &lt;strong&gt;ä¸æ˜¯å…ƒæ³¨è§£&lt;/strong&gt;ï¼Œè€Œæ˜¯&lt;strong&gt;ç”¨äºå®šä¹‰è‡ªå®šä¹‰æ³¨è§£çš„å…³é”®å­—&lt;/strong&gt;ã€‚å…ƒæ³¨è§£ï¼ˆMeta-Annotationï¼‰æ˜¯æŒ‡ç”¨äº&lt;strong&gt;ä¿®é¥°å…¶ä»–æ³¨è§£çš„æ³¨è§£&lt;/strong&gt;ï¼Œè€Œ &lt;code&gt;@interface&lt;/code&gt; æ˜¯å£°æ˜æ–°æ³¨è§£ç±»å‹çš„è¯­æ³•ç»“æ„ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-interface-çš„ä½œç”¨ä¸å®šä½"&gt;ğŸ“Œ &lt;code&gt;@interface&lt;/code&gt; çš„ä½œç”¨ä¸å®šä½
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰è‡ªå®šä¹‰æ³¨è§£&lt;/strong&gt;
&lt;code&gt;@interface&lt;/code&gt; ç”¨äºå£°æ˜ä¸€ä¸ªæ–°çš„æ³¨è§£ç±»å‹ï¼ˆå¦‚ &lt;code&gt;@Override&lt;/code&gt;ã€&lt;code&gt;@Autowired&lt;/code&gt;ï¼‰ï¼Œå…¶æœ¬è´¨æ˜¯ä¸€ä¸ªç»§æ‰¿ &lt;code&gt;java.lang.annotation.Annotation&lt;/code&gt; çš„ç‰¹æ®Šæ¥å£&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚
ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public @interface MyAnnotation {
String value() default &amp;#34;default&amp;#34;; // æ³¨è§£å±æ€§
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨è§£å±æ€§çš„é™åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å±æ€§è¿”å›å€¼ç±»å‹åªèƒ½æ˜¯ï¼šåŸºæœ¬ç±»å‹ã€&lt;code&gt;String&lt;/code&gt;ã€&lt;code&gt;Class&lt;/code&gt;ã€æšä¸¾ã€æ³¨è§£æˆ–å®ƒä»¬çš„æ•°ç»„&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯é€šè¿‡ &lt;code&gt;default&lt;/code&gt; è®¾ç½®é»˜è®¤å€¼ï¼ˆå¦‚ &lt;code&gt;int timeout() default 30;&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…ƒæ³¨è§£meta-annotationçš„æ ¸å¿ƒè§’è‰²"&gt;ğŸ§© å…ƒæ³¨è§£ï¼ˆMeta-Annotationï¼‰çš„æ ¸å¿ƒè§’è‰²
&lt;/h3&gt;&lt;p&gt;å…ƒæ³¨è§£æ˜¯ä¿®é¥°å…¶ä»–æ³¨è§£çš„æ³¨è§£ï¼Œç”¨äº&lt;strong&gt;æ§åˆ¶æ³¨è§£çš„è¡Œä¸º&lt;/strong&gt;ã€‚Java æä¾›ä»¥ä¸‹ 5 ç§å…ƒæ³¨è§£ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Target&lt;/code&gt;&lt;/strong&gt;
æŒ‡å®šæ³¨è§£å¯ä½œç”¨çš„ç¨‹åºå…ƒç´ ï¼ˆå¦‚ç±»ã€æ–¹æ³•ã€å­—æ®µï¼‰ï¼Œé€šè¿‡ &lt;code&gt;ElementType&lt;/code&gt; æšä¸¾æŒ‡å®šèŒƒå›´&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚
ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Target({ElementType.METHOD, ElementType.TYPE}) // ä»…ä½œç”¨äºæ–¹æ³•æˆ–ç±»
public @interface Loggable {}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Retention&lt;/code&gt;&lt;/strong&gt;
å®šä¹‰æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸï¼Œé€šè¿‡ &lt;code&gt;RetentionPolicy&lt;/code&gt; æŒ‡å®šï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SOURCE&lt;/code&gt;ï¼šä»…å­˜æºç ï¼ˆç¼–è¯‘åä¸¢å¼ƒï¼Œå¦‚ &lt;code&gt;@Override&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CLASS&lt;/code&gt;ï¼šä¿ç•™è‡³å­—èŠ‚ç ï¼ˆé»˜è®¤ï¼Œè¿è¡Œæ—¶ä¸å¯è®¿é—®ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RUNTIME&lt;/code&gt;ï¼šè¿è¡Œæ—¶ä¿ç•™ï¼ˆå¯é€šè¿‡åå°„è¯»å–ï¼Œå¦‚ Spring çš„ &lt;code&gt;@Autowired&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Documented&lt;/code&gt;&lt;/strong&gt;
æ ‡è®°æ³¨è§£æ˜¯å¦è¢«åŒ…å«åœ¨ Javadoc ç”Ÿæˆçš„æ–‡æ¡£ä¸­&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Inherited&lt;/code&gt;&lt;/strong&gt;
æ ‡è®°æ³¨è§£æ˜¯å¦å¯è¢«å­ç±»ç»§æ‰¿ï¼ˆä»…å¯¹ç±»æ³¨è§£æœ‰æ•ˆï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;@Repeatable&lt;/code&gt;ï¼ˆJava 8+ï¼‰&lt;/strong&gt;
å…è®¸åŒä¸€æ³¨è§£åœ¨å•ä¸ªå…ƒç´ ä¸Šé‡å¤ä½¿ç”¨ï¼ˆéœ€å®šä¹‰å®¹å™¨æ³¨è§£ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚
ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Repeatable(Roles.class)
public @interface Role {
String value();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-interface-ä¸å…ƒæ³¨è§£çš„å…³ç³»"&gt;âš–ï¸ &lt;code&gt;@interface&lt;/code&gt; ä¸å…ƒæ³¨è§£çš„å…³ç³»
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–å…³ç³»&lt;/strong&gt;ï¼š
è‡ªå®šä¹‰æ³¨è§£ï¼ˆé€šè¿‡ &lt;code&gt;@interface&lt;/code&gt; å®šä¹‰ï¼‰éœ€&lt;strong&gt;é€šè¿‡å…ƒæ³¨è§£é…ç½®å…¶è¡Œä¸º&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface Timer { // è‡ªå®šä¹‰æ³¨è§£
int timeout() default 30;
}
&lt;/code&gt;&lt;/pre&gt;æ­¤å¤„ &lt;code&gt;@Target&lt;/code&gt; å’Œ &lt;code&gt;@Retention&lt;/code&gt; æ˜¯å…ƒæ³¨è§£ï¼Œç”¨äºä¿®é¥° &lt;code&gt;@Timer&lt;/code&gt; çš„ä½œç”¨èŒƒå›´å’Œç”Ÿå‘½å‘¨æœŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨å·®å¼‚&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;@interface&lt;/code&gt; æ˜¯&lt;strong&gt;å®šä¹‰æ³¨è§£çš„è¯­æ³•&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…ƒæ³¨è§£æ˜¯&lt;strong&gt;ä¿®é¥°æ³¨è§£çš„å·¥å…·&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;@Retention&lt;/code&gt; æ§åˆ¶æ³¨è§£çš„ä¿ç•™ç­–ç•¥ï¼‰&lt;a class="link" href="@ref" &gt;2,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§æ··æ·†ç‚¹è§£æ"&gt;ğŸ” å¸¸è§æ··æ·†ç‚¹è§£æ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¯¯è§£æ¥æº&lt;/strong&gt;
éƒ¨åˆ†èµ„æ–™å¯èƒ½å°† &lt;code&gt;@interface&lt;/code&gt; æè¿°ä¸ºâ€œå…ƒæ³¨è§£â€ï¼Œè¿™æ˜¯ä¸å‡†ç¡®çš„ã€‚æ··æ·†å¯èƒ½æºäºï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;@interface&lt;/code&gt; ç”¨äºå®šä¹‰æ³¨è§£ï¼Œè€Œå…ƒæ³¨è§£ç”¨äºä¿®é¥°æ³¨è§£ï¼Œä¸¤è€…åœ¨æ³¨è§£ä½“ç³»ä¸­å±‚çº§ä¸åŒ&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®é™…åº”ç”¨ä¸­çš„åŒºåˆ†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå®šä¹‰æ³¨è§£&lt;/strong&gt;ï¼šéœ€ç”¨ &lt;code&gt;@interface&lt;/code&gt; å£°æ˜ + å…ƒæ³¨è§£é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ƒæ³¨è§£&lt;/strong&gt;ï¼šJDK å†…ç½®çš„ 5 ç§æ³¨è§£ï¼ˆå¦‚ &lt;code&gt;@Retention&lt;/code&gt;ï¼‰ï¼Œä¸å¯ç”¨ &lt;code&gt;@interface&lt;/code&gt; é‡æ–°å®šä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¦‚å¿µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§’è‰²&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@interface&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®šä¹‰è‡ªå®šä¹‰æ³¨è§£çš„å…³é”®å­—&lt;/td&gt;
&lt;td&gt;&lt;code&gt;public @interface MyAnno {}&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒæ³¨è§£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¿®é¥°è‡ªå®šä¹‰æ³¨è§£çš„æ³¨è§£&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@Target&lt;/code&gt;, &lt;code&gt;@Retention&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç®€å•æ¥è¯´&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ğŸ‘‰ ç”¨ &lt;code&gt;@interface&lt;/code&gt; â€‹&lt;strong&gt;åˆ›å»º&lt;/strong&gt;æ³¨è§£ï¼Œç”¨å…ƒæ³¨è§£ï¼ˆå¦‚ &lt;code&gt;@Retention&lt;/code&gt;ï¼‰â€‹&lt;strong&gt;å®šåˆ¶&lt;/strong&gt;æ³¨è§£çš„è¡Œä¸ºã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è‹¥éœ€æ·±å…¥å®è·µï¼Œå¯å‚è€ƒ &lt;a class="link" href="https://blog.csdn.net/zqwblog/article/details/6228936" target="_blank" rel="noopener"
&gt;Java å…ƒæ³¨è§£è¯¦è§£&lt;/a&gt; æˆ– &lt;a class="link" href="https://blog.csdn.net/cheng_14/article/details/106562868" target="_blank" rel="noopener"
&gt;è‡ªå®šä¹‰æ³¨è§£å®æˆ˜æŒ‡å—&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åœ¨ Java ä¸­ï¼Œ&lt;code&gt;@interface&lt;/code&gt; ç”¨äºå®šä¹‰è‡ªå®šä¹‰æ³¨è§£ï¼Œå…¶å†…éƒ¨å­—æ®µçš„å£°æ˜æ–¹å¼ä¸æ™®é€šç±»æˆ–æ¥å£ä¸åŒï¼Œä¸”&lt;strong&gt;ä¸èƒ½å®šä¹‰æ™®é€šæ–¹æ³•&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-interface-å†…éƒ¨å­—æ®µçš„å®šä¹‰è§„åˆ™"&gt;âš™ï¸ &lt;code&gt;@interface&lt;/code&gt; å†…éƒ¨å­—æ®µçš„å®šä¹‰è§„åˆ™
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å­—æ®µå£°æ˜å½¢å¼&lt;/strong&gt;
åœ¨ &lt;code&gt;@interface&lt;/code&gt; ä¸­ï¼Œå­—æ®µé€šè¿‡&lt;strong&gt;ç±»ä¼¼æ–¹æ³•å£°æ˜&lt;/strong&gt;çš„å½¢å¼å®šä¹‰ï¼Œå®é™…æ˜¯æ³¨è§£çš„å±æ€§ï¼ˆAttributeï¼‰ã€‚è¯­æ³•å¦‚ä¸‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public @interface MyAnnotation {
String name(); // æ— é»˜è®¤å€¼çš„å±æ€§ï¼ˆä½¿ç”¨æ—¶å¿…é¡»èµ‹å€¼ï¼‰
int age() default 18; // æœ‰é»˜è®¤å€¼çš„å±æ€§ï¼ˆä½¿ç”¨æ—¶å¯é€‰ï¼‰
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å±æ€§ç±»å‹é™åˆ¶&lt;/strong&gt;ï¼šä»…æ”¯æŒ &lt;code&gt;åŸºæœ¬ç±»å‹&lt;/code&gt;ï¼ˆ&lt;code&gt;int&lt;/code&gt;, &lt;code&gt;boolean&lt;/code&gt; ç­‰ï¼‰ã€&lt;code&gt;String&lt;/code&gt;ã€&lt;code&gt;Class&lt;/code&gt;ã€&lt;code&gt;æšä¸¾&lt;/code&gt;ã€&lt;code&gt;æ³¨è§£&lt;/code&gt; æˆ–å®ƒä»¬çš„&lt;strong&gt;æ•°ç»„&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;String[]&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤å€¼&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;default&lt;/code&gt; å…³é”®å­—æŒ‡å®šï¼ˆå¦‚ &lt;code&gt;default 18&lt;/code&gt;ï¼‰ï¼ŒæœªæŒ‡å®šé»˜è®¤å€¼çš„å±æ€§åœ¨ä½¿ç”¨æ—¶å¿…é¡»æ˜¾å¼èµ‹å€¼&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹æ®Šå±æ€§ &lt;code&gt;value&lt;/code&gt;&lt;/strong&gt;
è‹¥æ³¨è§£ä»…æœ‰ä¸€ä¸ªå±æ€§ä¸”å‘½åä¸º &lt;code&gt;value&lt;/code&gt;ï¼Œä½¿ç”¨æ—¶å¯ç›´æ¥èµ‹å€¼è€Œæ— éœ€é”®å€¼å¯¹æ ¼å¼ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public @interface Info {
String value(); // ç‰¹æ®Šå±æ€§ value
}
@Info(&amp;#34;é»˜è®¤å€¼&amp;#34;) // ç­‰ä»·äº @Info(value = &amp;#34;é»˜è®¤å€¼&amp;#34;)
public class MyClass {}
&lt;/code&gt;&lt;/pre&gt;&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-èƒ½å¦å®šä¹‰æ™®é€šæ–¹æ³•"&gt;âŒ &lt;strong&gt;èƒ½å¦å®šä¹‰æ™®é€šæ–¹æ³•ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ä¸å¯ä»¥&lt;/strong&gt;ã€‚&lt;code&gt;@interface&lt;/code&gt; ä¸­åªèƒ½å£°æ˜å±æ€§ï¼ˆå³ä¸Šè¿°â€œç±»ä¼¼æ–¹æ³•â€çš„ç»“æ„ï¼‰ï¼Œ&lt;strong&gt;ä¸èƒ½åŒ…å«æ–¹æ³•ä½“ã€æ„é€ æ–¹æ³•æˆ–æ™®é€šæˆå‘˜æ–¹æ³•&lt;/strong&gt;ã€‚ä¾‹å¦‚ä»¥ä¸‹ä»£ç éæ³•ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public @interface InvalidAnnotation {
void print(); // ç¼–è¯‘é”™è¯¯ï¼šæ³¨è§£å±æ€§ä¸èƒ½æ˜¯ void ç±»å‹
String format() { return &amp;#34;&amp;#34;; } // ç¼–è¯‘é”™è¯¯ï¼šä¸èƒ½æœ‰æ–¹æ³•ä½“
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a class="link" href="@ref" &gt;5,6,9&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-interface-çš„æœ¬è´¨ç‰¹æ®Šçš„æ¥å£"&gt;ğŸ§¬ &lt;code&gt;@interface&lt;/code&gt; çš„æœ¬è´¨ï¼šç‰¹æ®Šçš„æ¥å£
&lt;/h3&gt;&lt;p&gt;ä»è®¾è®¡å±‚é¢çœ‹ï¼Œ&lt;code&gt;@interface&lt;/code&gt; æ˜¯ä¸€ç§&lt;strong&gt;ç»§æ‰¿ &lt;code&gt;java.lang.annotation.Annotation&lt;/code&gt; çš„ç‰¹æ®Šæ¥å£&lt;/strong&gt;ï¼Œä½†æœ‰ä»¥ä¸‹å…³é”®å·®å¼‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨ç»§æ‰¿æœºåˆ¶&lt;/strong&gt;
æ‰€æœ‰è‡ªå®šä¹‰æ³¨è§£åœ¨ç¼–è¯‘åè‡ªåŠ¨ç»§æ‰¿ &lt;code&gt;Annotation&lt;/code&gt; æ¥å£ï¼Œå¼€å‘è€…æ— éœ€æ˜¾å¼å£°æ˜&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ™®é€šæ¥å£çš„åŒºåˆ«&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;æ™®é€šæ¥å£ (&lt;code&gt;interface&lt;/code&gt;)&lt;/th&gt;
&lt;th&gt;æ³¨è§£ (&lt;code&gt;@interface&lt;/code&gt;)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æˆå‘˜ç±»å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŠ½è±¡æ–¹æ³•ã€å¸¸é‡&lt;/td&gt;
&lt;td&gt;å±æ€§ï¼ˆæ— å‚æ•°â€œæ–¹æ³•â€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•ä½“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— ï¼ˆJava 8 åæ”¯æŒ &lt;code&gt;default&lt;/code&gt; æ–¹æ³•ï¼‰&lt;/td&gt;
&lt;td&gt;ç»å¯¹ç¦æ­¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯å¤šç»§æ‰¿æ¥å£&lt;/td&gt;
&lt;td&gt;ä¸èƒ½ç»§æ‰¿ç±»æˆ–å…¶ä»–æ³¨è§£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒæ•°æ®åŠŸèƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;é€šè¿‡åå°„è¯»å–è¿è¡Œæ—¶ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ç±»çš„åŒºåˆ«&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸èƒ½å®ä¾‹åŒ–&lt;/strong&gt;ï¼šæ³¨è§£æ— æ³•é€šè¿‡ &lt;code&gt;new&lt;/code&gt; åˆ›å»ºå¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— çŠ¶æ€è¡Œä¸º&lt;/strong&gt;ï¼šæ³¨è§£ä»…å­˜å‚¨é™æ€é…ç½®ä¿¡æ¯ï¼Œä¸å«ä¸šåŠ¡é€»è¾‘&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨ç¤ºä¾‹å®šä¹‰ä¸å¤„ç†æ³¨è§£"&gt;ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹ï¼šå®šä¹‰ä¸å¤„ç†æ³¨è§£
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰æ³¨è§£&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Timer {
String taskName() default &amp;#34;defaultTask&amp;#34;;
int timeout() default 30; // å•ä½ï¼šç§’
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨æ³¨è§£&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public class TaskService {
@Timer(taskName = &amp;#34;dataProcess&amp;#34;, timeout = 60)
public void processData() { /* ... */ }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€šè¿‡åå°„è¯»å–æ³¨è§£&lt;/strong&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Method method = TaskService.class.getMethod(&amp;#34;processData&amp;#34;);
if (method.isAnnotationPresent(Timer.class)) {
Timer timer = method.getAnnotation(Timer.class);
System.out.println(&amp;#34;Task: &amp;#34; + timer.taskName() + &amp;#34;, Timeout: &amp;#34; + timer.timeout());
}
&lt;/code&gt;&lt;/pre&gt;&lt;a class="link" href="@ref" &gt;1,5,9&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;âœ… æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—æ®µå®šä¹‰&lt;/strong&gt;ï¼šä»¥â€œæ— å‚æ–¹æ³•â€å½¢å¼å£°æ˜å±æ€§ï¼Œæ”¯æŒé»˜è®¤å€¼ï¼Œç±»å‹å—é™&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•ç¦æ­¢&lt;/strong&gt;ï¼š&lt;strong&gt;ä¸èƒ½åŒ…å«ä»»ä½•æ™®é€šæ–¹æ³•&lt;/strong&gt;æˆ–æ„é€ æ–¹æ³•&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;ï¼šæ˜¯ç‰¹æ®Šçš„æ¥å£ï¼ˆéšå¼ç»§æ‰¿ &lt;code&gt;Annotation&lt;/code&gt;ï¼‰ï¼Œ&lt;strong&gt;ä¸æ˜¯ç±»&lt;/strong&gt;ï¼ŒåŠŸèƒ½èšç„¦äºæä¾›å…ƒæ•°æ®è€Œéè¡Œä¸º&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚
é€šè¿‡åˆç†è®¾è®¡æ³¨è§£å±æ€§ï¼Œå¯é«˜æ•ˆå®ç°é…ç½®åŒ–ç¼–ç¨‹ï¼ˆå¦‚ Spring æ¡†æ¶çš„ &lt;code&gt;@Autowired&lt;/code&gt;ï¼‰ï¼Œä½†éœ€ä¸¥æ ¼éµå¾ªå…¶è¯­æ³•çº¦æŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="retentionpolicy"&gt;RetentionPolicy
&lt;/h2&gt;&lt;p&gt;RetentionPolicy æ˜¯ Java ä¸­ç”¨äºå®šä¹‰æ³¨è§£ï¼ˆAnnotationï¼‰ç”Ÿå‘½å‘¨æœŸçš„å…³é”®æšä¸¾ç±»å‹ï¼Œé€šè¿‡ &lt;code&gt;@Retention&lt;/code&gt; å…ƒæ³¨è§£æŒ‡å®šã€‚ä»¥ä¸‹æ˜¯ä¸‰ç§ç­–ç•¥çš„è¯¦ç»†å¯¹æ¯”ï¼Œç»“åˆå…¶æ ¸å¿ƒç‰¹æ€§ã€ä½¿ç”¨åœºæ™¯åŠæŠ€æœ¯å®ç°å·®å¼‚ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-retentionpolicysource"&gt;ğŸ“Œ &lt;strong&gt;&lt;code&gt;RetentionPolicy.SOURCE&lt;/code&gt;ï¼ˆæºç çº§ä¿ç•™ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;ï¼š
æ³¨è§£ä»…ä¿ç•™åœ¨æºä»£ç ä¸­ï¼Œç¼–è¯‘æ—¶è¢«ç¼–è¯‘å™¨ä¸¢å¼ƒï¼Œâ€‹&lt;strong&gt;ä¸ä¼šå†™å…¥å­—èŠ‚ç æ–‡ä»¶&lt;/strong&gt;â€‹&lt;a class="link" href="@ref" &gt;1,6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸»è¦ç”¨é€”ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æœŸæ£€æŸ¥&lt;/strong&gt;ï¼šå¦‚ &lt;code&gt;@Override&lt;/code&gt; éªŒè¯æ–¹æ³•é‡å†™æ­£ç¡®æ€§ï¼Œé”™è¯¯æ—¶è§¦å‘ç¼–è¯‘å¤±è´¥&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç ç”Ÿæˆ&lt;/strong&gt;ï¼šåˆ©ç”¨æ³¨è§£å¤„ç†å™¨ï¼ˆAnnotation Processorï¼‰åœ¨ç¼–è¯‘æ—¶åŠ¨æ€ç”Ÿæˆä»£ç ï¼Œå¦‚ Lombok çš„ &lt;code&gt;@Data&lt;/code&gt; è‡ªåŠ¨ç”Ÿæˆ getter/setter&lt;a class="link" href="@ref" &gt;1,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯å®ç°&lt;/strong&gt;ï¼š
é€šè¿‡ &lt;code&gt;javax.annotation.processing&lt;/code&gt; åŒ…ä¸­çš„å¤„ç†å™¨ï¼ˆå¦‚ &lt;code&gt;AbstractProcessor&lt;/code&gt;ï¼‰å¤„ç†æ³¨è§£ï¼Œç”Ÿæˆæ–°ä»£ç æˆ–æ—¥å¿—&lt;a class="link" href="@ref" &gt;1,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;Lombok çš„æ³¨è§£ï¼ˆ&lt;code&gt;@Getter&lt;/code&gt;, &lt;code&gt;@Setter&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æŠ‘åˆ¶ç¼–è¯‘å™¨è­¦å‘Šï¼ˆ&lt;code&gt;@SuppressWarnings&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-retentionpolicyclass"&gt;ğŸ“¦ &lt;strong&gt;&lt;code&gt;RetentionPolicy.CLASS&lt;/code&gt;ï¼ˆå­—èŠ‚ç çº§ä¿ç•™ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;ï¼š
æ³¨è§£è¢«ç¼–è¯‘åˆ° &lt;code&gt;.class&lt;/code&gt; æ–‡ä»¶ä¸­ï¼Œä½†&lt;strong&gt;ä¸ä¼šè¢«åŠ è½½åˆ° JVM è¿è¡Œæ—¶&lt;/strong&gt;ï¼Œåå°„æ— æ³•è¯»å–&lt;a class="link" href="@ref" &gt;4,9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸»è¦ç”¨é€”ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—èŠ‚ç å¤„ç†&lt;/strong&gt;ï¼šåœ¨ç±»åŠ è½½é˜¶æ®µï¼ˆåŠ è½½ã€é“¾æ¥ï¼‰ç”±å­—èŠ‚ç å·¥å…·ï¼ˆå¦‚ ASMï¼‰è¯»å–å¹¶å¤„ç†ï¼Œç”¨äºä»£ç ä¼˜åŒ–æˆ–å¢å¼º&lt;a class="link" href="@ref" &gt;4,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…è¿è¡Œæ—¶å¼€é”€&lt;/strong&gt;ï¼šé€‚åˆæ— éœ€è¿è¡Œæ—¶è®¿é—®ä½†éœ€ä¿ç•™ä¸­é—´ä¿¡æ¯çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯å®ç°&lt;/strong&gt;ï¼š
é€šè¿‡å­—èŠ‚ç åˆ†æå·¥å…·ï¼ˆå¦‚ ASMï¼‰è§£æ &lt;code&gt;.class&lt;/code&gt; æ–‡ä»¶ä¸­çš„æ³¨è§£å±æ€§è¡¨ï¼ˆå¦‚ &lt;code&gt;RuntimeInvisibleAnnotations&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚
ç¤ºä¾‹ï¼šä½¿ç”¨ ASM è¯»å– &lt;code&gt;@Meta(name=&amp;quot;obj&amp;quot;)&lt;/code&gt;ï¼ˆ&lt;code&gt;CLASS&lt;/code&gt; ç­–ç•¥ï¼‰æ—¶ï¼Œæ³¨è§£ä¿¡æ¯åœ¨å­—èŠ‚ç ä¸­å¯è§ä½†è¿è¡Œæ—¶ä¸å¯è®¿é—®&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;AOP æ¡†æ¶çš„ç¼–è¯‘æ—¶ä»£ç†ç”Ÿæˆ&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;éƒ¨åˆ†ä»£ç åˆ†æå·¥å…·çš„ç¦»çº¿å¤„ç†&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-retentionpolicyruntime"&gt;âš¡ &lt;strong&gt;&lt;code&gt;RetentionPolicy.RUNTIME&lt;/code&gt;ï¼ˆè¿è¡Œæ—¶ä¿ç•™ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;ï¼š
æ³¨è§£ä¿ç•™åœ¨æºç ã€å­—èŠ‚ç åŠè¿è¡Œæ—¶ç¯å¢ƒä¸­ï¼Œâ€‹&lt;strong&gt;å¯é€šè¿‡åå°„åŠ¨æ€è¯»å–&lt;/strong&gt;â€‹&lt;a class="link" href="@ref" &gt;2,5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸»è¦ç”¨é€”&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶åŠ¨æ€å¤„ç†&lt;/strong&gt;ï¼šæ¡†æ¶é€šè¿‡åå°„è·å–æ³¨è§£é…ç½®ï¼Œå®ç°ä¾èµ–æ³¨å…¥ã€è·¯ç”±æ˜ å°„ç­‰åŠŸèƒ½&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æ ¡éªŒä¸AOP&lt;/strong&gt;ï¼šå¦‚ Spring çš„ &lt;code&gt;@Autowired&lt;/code&gt;ã€JPA çš„ &lt;code&gt;@Entity&lt;/code&gt;&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯å®ç°&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åå°„ APIï¼š&lt;code&gt;AnnotatedElement&lt;/code&gt; æ¥å£çš„ &lt;code&gt;getAnnotation()&lt;/code&gt; ç­‰æ–¹æ³•&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åŠ¨æ€ä»£ç†ï¼šJDK åœ¨åå°„æ—¶ç”Ÿæˆä»£ç†ç±»ï¼ˆå¦‚ &lt;code&gt;AnnotationInvocationHandler&lt;/code&gt;ï¼‰ï¼Œå°†æ³¨è§£å±æ€§æ˜ å°„ä¸ºé”®å€¼å¯¹&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Spring çš„ç»„ä»¶æ‰«æï¼ˆ&lt;code&gt;@Component&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;JUnit æµ‹è¯•æ–¹æ³•æ ‡è®°ï¼ˆ&lt;code&gt;@Test&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰ç­–ç•¥æ ¸å¿ƒå¯¹æ¯”æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;ä¸‰ç­–ç•¥æ ¸å¿ƒå¯¹æ¯”æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;SOURCE&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;CLASS&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;RUNTIME&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æºç é˜¶æ®µ&lt;/td&gt;
&lt;td&gt;å­—èŠ‚ç é˜¶æ®µ&lt;/td&gt;
&lt;td&gt;æºç  + å­—èŠ‚ç  + è¿è¡Œæ—¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯è®¿é—®æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…ç¼–è¯‘å™¨&lt;/td&gt;
&lt;td&gt;å­—èŠ‚ç å·¥å…·&lt;/td&gt;
&lt;td&gt;åå°„æœºåˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ç”¨é€”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘æ£€æŸ¥ã€ä»£ç ç”Ÿæˆ&lt;/td&gt;
&lt;td&gt;å­—èŠ‚ç å¢å¼ºã€ç¦»çº¿åˆ†æ&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ—¶åŠ¨æ€é…ç½®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— è¿è¡Œæ—¶å¼€é”€&lt;/td&gt;
&lt;td&gt;æ— è¿è¡Œæ—¶å¼€é”€&lt;/td&gt;
&lt;td&gt;åå°„å¯èƒ½å¼•å…¥æ€§èƒ½æŸè€—&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åº”ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Lombokã€&lt;code&gt;@Override&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ASM å­—èŠ‚ç æ“ä½œ&lt;/td&gt;
&lt;td&gt;Springã€JUnit&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å®è·µé€‰æ‹©å»ºè®®"&gt;âš–ï¸ &lt;strong&gt;å®è·µé€‰æ‹©å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆ &lt;code&gt;RUNTIME&lt;/code&gt;&lt;/strong&gt;ï¼š
éœ€è¦è¿è¡Œæ—¶åŠ¨æ€è¯»å–æ³¨è§£æ—¶å¿…é€‰ï¼ˆå¦‚æ¡†æ¶å¼€å‘ï¼‰&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æœŸéœ€æ±‚é€‰ &lt;code&gt;SOURCE&lt;/code&gt;&lt;/strong&gt;ï¼š
ä»…éœ€ç”Ÿæˆä»£ç æˆ–é™æ€æ£€æŸ¥æ—¶ä½¿ç”¨ï¼ˆå¦‚ Lombokï¼‰&lt;a class="link" href="@ref" &gt;1,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;CLASS&lt;/code&gt; çš„ç‰¹å®šåœºæ™¯&lt;/strong&gt;ï¼š
éœ€ä¿ç•™å­—èŠ‚ç ä¿¡æ¯ä½†æ— éœ€è¿è¡Œæ—¶åå°„æ—¶é€‰ç”¨ï¼ˆå¦‚ç¼–è¯‘æ—¶ AOP ç»‡å…¥ï¼‰&lt;a class="link" href="@ref" &gt;4,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è€ƒé‡&lt;/strong&gt;ï¼š
é«˜é¢‘è°ƒç”¨çš„æ³¨è§£é¿å… &lt;code&gt;RUNTIME&lt;/code&gt;ï¼Œå‡å°‘åå°„å¼€é”€&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ¡ˆä¾‹è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lombok çš„ &lt;code&gt;@Data&lt;/code&gt; ä½¿ç”¨ &lt;code&gt;SOURCE&lt;/code&gt;ï¼Œç¼–è¯‘åç”Ÿæˆä»£ç å¹¶ä¸¢å¼ƒæ³¨è§£&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Spring çš„ &lt;code&gt;@Service&lt;/code&gt; ä½¿ç”¨ &lt;code&gt;RUNTIME&lt;/code&gt;ï¼Œè¿è¡Œæ—¶æ‰«æ Bean å¹¶æ³¨å…¥å®¹å™¨&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å­—èŠ‚ç åŠ å¯†å·¥å…·å¯èƒ½ç”¨ &lt;code&gt;CLASS&lt;/code&gt; ä¿ç•™æ³¨è§£ä¾›ç±»åŠ è½½é˜¶æ®µè§£å¯†&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚
é€šè¿‡ç²¾å‡†åŒ¹é…éœ€æ±‚ä¸ç”Ÿå‘½å‘¨æœŸç­–ç•¥ï¼Œå¯æ˜¾è‘—æå‡ä»£ç æ•ˆç‡ä¸å¯ç»´æŠ¤æ€§ã€‚æ›´å¤šæŠ€æœ¯ç»†èŠ‚å¯å‚è€ƒï¼š&lt;a class="link" href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/RetentionPolicy.html" target="_blank" rel="noopener"
&gt;Java RetentionPolicy å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ³¨è§£å¤„ç†å™¨"&gt;æ³¨è§£å¤„ç†å™¨
&lt;/h2&gt;&lt;p&gt;æ³¨è§£å¤„ç†å™¨ï¼ˆAnnotation Processorï¼‰æ˜¯ Java ç¼–è¯‘æœŸçš„æ ¸å¿ƒå·¥å…·ï¼Œç”¨äºåœ¨ç¼–è¯‘é˜¶æ®µæ‰«æå’Œå¤„ç†æºç ä¸­çš„æ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆä»£ç ã€èµ„æºæ–‡ä»¶æˆ–æ‰§è¡Œç¼–è¯‘æ—¶æ ¡éªŒã€‚ä»¥ä¸‹æ˜¯å…¶è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨è§£å¤„ç†å™¨çš„æ ¸å¿ƒåŸç†"&gt;ğŸ” æ³¨è§£å¤„ç†å™¨çš„æ ¸å¿ƒåŸç†
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç†æ—¶æœºä¸éš”ç¦»æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æœŸè¿è¡Œ&lt;/strong&gt;ï¼šæ³¨è§£å¤„ç†å™¨åœ¨ &lt;code&gt;javac&lt;/code&gt; ç¼–è¯‘æ—¶è§¦å‘ï¼Œæ—©äºç±»åŠ è½½å’Œè¿è¡Œæ—¶ï¼Œ&lt;strong&gt;æ— è¿è¡Œæ—¶æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‹¬ç«‹è¿›ç¨‹&lt;/strong&gt;ï¼šè¿è¡Œåœ¨ç‹¬ç«‹çš„ JVM è¿›ç¨‹ä¸­ï¼Œä¸å¹²æ‰°ç›®æ ‡ç¨‹åºé€»è¾‘&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½®æ¬¡å¤„ç†æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šè½®å¤„ç†&lt;/strong&gt;ï¼šç¼–è¯‘å™¨æŒ‰è½®æ¬¡è°ƒç”¨å¤„ç†å™¨ï¼Œè‹¥æŸè½®ç”Ÿæˆæ–°æºç ï¼ˆå¦‚ &lt;code&gt;.java&lt;/code&gt; æ–‡ä»¶ï¼‰ï¼Œä¼šè§¦å‘æ–°ä¸€è½®å¤„ç†ï¼Œç›´è‡³æ— æ–°æ–‡ä»¶ç”Ÿæˆ&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¯å¢ƒå¯¹è±¡&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;RoundEnvironment&lt;/code&gt; è·å–å½“å‰è½®æ¬¡è¢«æ³¨è§£çš„å…ƒç´ ï¼ˆç±»ã€æ–¹æ³•ç­‰ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç»„ä»¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Processor&lt;/code&gt; æ¥å£&lt;/strong&gt;ï¼šå®šä¹‰å¤„ç†å™¨çš„åŸºæœ¬è¡Œä¸ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;AbstractProcessor&lt;/code&gt;&lt;/strong&gt;ï¼šå¸¸ç”¨åŸºç±»ï¼Œç®€åŒ–å¼€å‘&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥å…·ç±»&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Filer&lt;/code&gt;ï¼šç”Ÿæˆæ–°æ–‡ä»¶ï¼ˆæºç /èµ„æºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Messager&lt;/code&gt;ï¼šæŠ¥å‘Šç¼–è¯‘é”™è¯¯æˆ–è­¦å‘Šã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Elements&lt;/code&gt; &amp;amp; &lt;code&gt;Types&lt;/code&gt;ï¼šæ“ä½œç¨‹åºå…ƒç´ å’Œç±»å‹ç³»ç»Ÿ&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¼€å‘è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨"&gt;âš™ï¸ å¼€å‘è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨
&lt;/h3&gt;&lt;h4 id="æ­¥éª¤-1å®šä¹‰æ³¨è§£"&gt;æ­¥éª¤ 1ï¼šå®šä¹‰æ³¨è§£
&lt;/h4&gt;&lt;p&gt;æ³¨è§£éœ€è®¾ç½®ä¸º &lt;code&gt;SOURCE&lt;/code&gt; æˆ– &lt;code&gt;CLASS&lt;/code&gt; çº§åˆ«ï¼Œç¡®ä¿ç¼–è¯‘æœŸå¯è§ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@Retention(RetentionPolicy.SOURCE)
@Target(ElementType.METHOD)
public @interface LogExecutionTime {
String value() default &amp;#34;&amp;#34;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š&lt;code&gt;@Target&lt;/code&gt; æŒ‡å®šæ³¨è§£ä½œç”¨ç›®æ ‡ï¼ˆå¦‚æ–¹æ³•ã€ç±»ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id="æ­¥éª¤-2å®ç°å¤„ç†å™¨é€»è¾‘"&gt;æ­¥éª¤ 2ï¼šå®ç°å¤„ç†å™¨é€»è¾‘
&lt;/h4&gt;&lt;p&gt;ç»§æ‰¿ &lt;code&gt;AbstractProcessor&lt;/code&gt;ï¼Œé‡å†™ &lt;code&gt;process()&lt;/code&gt; æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;@SupportedAnnotationTypes(&amp;#34;com.example.LogExecutionTime&amp;#34;)
@SupportedSourceVersion(SourceVersion.RELEASE_11)
public class LogProcessor extends AbstractProcessor {
private Filer filer;
private Messager messager;
@Override
public void init(ProcessingEnvironment env) {
filer = env.getFiler(); // åˆå§‹åŒ–æ–‡ä»¶ç”Ÿæˆå·¥å…·
messager = env.getMessager(); // æ—¥å¿—æŠ¥å‘Šå·¥å…·
}
@Override
public boolean process(Set&amp;lt;? extends TypeElement&amp;gt; annotations, RoundEnvironment env) {
for (Element elem : env.getElementsAnnotatedWith(LogExecutionTime.class)) {
if (elem.getKind() == ElementKind.METHOD) {
generateWrapperClass((ExecutableElement) elem); // ç”Ÿæˆä»£ç 
}
}
return true; // æ ‡è®°æ³¨è§£å·²å¤„ç†
}
private void generateWrapperClass(ExecutableElement method) throws IOException {
// ä½¿ç”¨ Filer åˆ›å»ºæ–°æºæ–‡ä»¶[1,4](@ref)
JavaFileObject file = filer.createSourceFile(method.getEnclosingElement() + &amp;#34;_Log&amp;#34;);
try (Writer writer = file.openWriter()) {
writer.write(&amp;#34;// è‡ªåŠ¨ç”Ÿæˆçš„æ—¥å¿—ä»£ç ...&amp;#34;);
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ­¥éª¤-3æ³¨å†Œå¤„ç†å™¨"&gt;æ­¥éª¤ 3ï¼šæ³¨å†Œå¤„ç†å™¨
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰‹åŠ¨æ³¨å†Œ&lt;/strong&gt;ï¼šåˆ›å»º &lt;code&gt;META-INF/services/javax.annotation.processing.Processor&lt;/code&gt; æ–‡ä»¶ï¼Œå†™å…¥å¤„ç†å™¨å…¨é™å®šå&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;AutoService ç®€åŒ–ï¼šç”¨ Google AutoService è‡ªåŠ¨ç”Ÿæˆæ³¨å†Œæ–‡ä»¶ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@AutoService(Processor.class)
public class LogProcessor extends AbstractProcessor { ... }
&lt;/code&gt;&lt;/pre&gt;Maven ä¾èµ–ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;com.google.auto.service&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;auto-service&amp;lt;/artifactId&amp;gt;
&amp;lt;version&amp;gt;1.0.1&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ’¡ å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä»£è¡¨å·¥å…·&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç ç”Ÿæˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨ç”Ÿæˆ Getter/Setterã€Builder æ¨¡å¼&lt;/td&gt;
&lt;td&gt;Lombok&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–è¯‘æ—¶æ ¡éªŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ£€æŸ¥æ³¨è§£ä½¿ç”¨åˆæ³•æ€§ï¼ˆå¦‚éç©ºå­—æ®µï¼‰&lt;/td&gt;
&lt;td&gt;Hibernate Validator&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªåŠ¨åŒ–é…ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆ SPIï¼ˆService Provider Interfaceï¼‰æ–‡ä»¶&lt;/td&gt;
&lt;td&gt;Google AutoService&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆé«˜æ•ˆæ˜ å°„ä»£ç æ›¿ä»£åå°„&lt;/td&gt;
&lt;td&gt;MapStruct&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ç¤ºä¾‹lombok-çš„å®ç°åŸç†"&gt;ç¤ºä¾‹ï¼šLombok çš„å®ç°åŸç†
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·æ³¨è§£ï¼š&lt;code&gt;@Data&lt;/code&gt; æ ‡è®°ç±»ã€‚&lt;/li&gt;
&lt;li&gt;å¤„ç†å™¨é€»è¾‘ï¼šæ‰«æè¢«æ³¨è§£çš„ç±»ï¼Œç”Ÿæˆ &lt;code&gt;getXxx()&lt;/code&gt;/&lt;code&gt;setXxx()&lt;/code&gt; ç­‰æ–¹æ³•çš„å­—èŠ‚ç ï¼Œ&lt;strong&gt;ç›´æ¥ä¿®æ”¹ .class æ–‡ä»¶&lt;/strong&gt;ï¼Œé¿å…æºç è†¨èƒ€&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨è§£å¤„ç†å™¨-vs-è¿è¡Œæ—¶åå°„"&gt;ğŸš€ æ³¨è§£å¤„ç†å™¨ vs. è¿è¡Œæ—¶åå°„
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ³¨è§£å¤„ç†å™¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¿è¡Œæ—¶åå°„&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤„ç†æ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘æœŸ&lt;/td&gt;
&lt;td&gt;è¿è¡ŒæœŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­ï¸ æ— è¿è¡Œæ—¶æŸè€—&lt;/td&gt;
&lt;td&gt;âš ï¸ åå°„è°ƒç”¨æ…¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”™è¯¯åé¦ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­ï¸ ç¼–è¯‘æ—¶æŠ¥é”™ï¼ˆæ—©å‘ç°ï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ è¿è¡Œæ—¶æŠ¥é”™ï¼ˆéš¾è°ƒè¯•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç ç”Ÿæˆèƒ½åŠ›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å¯ç”Ÿæˆæ–°æºç /å­—èŠ‚ç &lt;/td&gt;
&lt;td&gt;âŒ ä»…è¯»å–æ³¨è§£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åº”ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Lombok, Dagger, AutoValue&lt;/td&gt;
&lt;td&gt;Spring DI, JPA å®ä½“æ ¡éªŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’ &lt;strong&gt;æ ¸å¿ƒä¼˜åŠ¿&lt;/strong&gt;ï¼šç¼–è¯‘æ—¶å¤„ç†é¿å…è¿è¡Œæ—¶å¼€é”€ï¼Œé€‚åˆé«˜é¢‘è°ƒç”¨çš„åŸºç¡€ç»„ä»¶ï¼ˆå¦‚ ORM å­—æ®µæ˜ å°„ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨åŸŸåŒ¹é…&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥éœ€è¿è¡Œæ—¶è¯»å–æ³¨è§£ï¼ˆå¦‚ Spring çš„ &lt;code&gt;@Autowired&lt;/code&gt;ï¼‰ï¼Œä¿ç•™ç­–ç•¥éœ€ä¸º &lt;code&gt;RUNTIME&lt;/code&gt;ï¼›è‹¥ä»…ç¼–è¯‘æœŸå¤„ç†ï¼Œç”¨ &lt;code&gt;SOURCE&lt;/code&gt; æˆ– &lt;code&gt;CLASS&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é‡å¤ç”Ÿæˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ &lt;code&gt;process()&lt;/code&gt; ä¸­æ£€æŸ¥ç›®æ ‡æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨ï¼Œé˜²æ­¢å¤šæ¬¡ç”Ÿæˆå†²çª&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–éš”ç¦»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨è§£å¤„ç†å™¨åº”è®¾ä¸º provided ä¾èµ–ï¼Œé¿å…æ‰“åŒ…åˆ°è¿è¡Œæ—¶ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
&amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šè½®å¤„ç†ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨æœ€åä¸€è½®å¤„ç†ç”Ÿæˆæ±‡æ€»æ–‡ä»¶ï¼ˆå¦‚é…ç½®æ–‡ä»¶ï¼‰ï¼Œé¿å…ä¸­é—´è½®æ¬¡ç”Ÿæˆæœªå®Œæˆä»£ç &lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æ³¨è§£å¤„ç†å™¨æ˜¯ Java å…ƒç¼–ç¨‹çš„æ ¸å¿ƒå·¥å…·ï¼Œé€šè¿‡ç¼–è¯‘æ—¶ä»£ç ç”Ÿæˆå’Œæ ¡éªŒï¼Œ&lt;strong&gt;æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡&lt;/strong&gt;ï¼ˆå¦‚å‡å°‘ 50% æ ·æ¿ä»£ç ï¼‰ï¼Œå¹¶ä¿éšœè¿è¡Œæ—¶æ€§èƒ½ã€‚å…¶æ ¸å¿ƒåœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç²¾å‡†åŒ¹é…åœºæ™¯&lt;/strong&gt;ï¼šä»£ç ç”Ÿæˆé€‰ &lt;code&gt;SOURCE&lt;/code&gt;ï¼Œæ ¡éªŒé€‰ &lt;code&gt;CLASS&lt;/code&gt;ï¼ŒåŠ¨æ€æ³¨å…¥é€‰ &lt;code&gt;RUNTIME&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ©ç”¨å·¥å…·é“¾&lt;/strong&gt;ï¼šAutoService ç®€åŒ–æ³¨å†Œï¼ŒJavaPoetï¼ˆéæ ‡å‡†åº“ï¼‰æå‡ä»£ç ç”Ÿæˆå¯è¯»æ€§&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§„é¿åå°„ç“¶é¢ˆ&lt;/strong&gt;ï¼šç”¨ç¼–è¯‘æ—¶ç”Ÿæˆæ›¿ä»£è¿è¡Œæ—¶ä»£ç†ï¼ˆå¦‚ MapStruct vs. BeanUtilsï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“š &lt;strong&gt;æ‰©å±•å­¦ä¹ &lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/processing/Processor.html" target="_blank" rel="noopener"
&gt;Java æ³¨è§£å¤„ç†å™¨å®˜æ–¹æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¼€æºé¡¹ç›®å‚è€ƒï¼šLombok æºç ã€Google Auto&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="processor--abstractprocessor"&gt;Processor &amp;amp; AbstractProcessor
&lt;/h2&gt;&lt;p&gt;Processor æ¥å£å’Œ AbstractProcessor æ˜¯ Java æ³¨è§£å¤„ç†æœºåˆ¶ä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼ŒäºŒè€…æ—¢æœ‰ç´§å¯†è”ç³»ï¼Œåˆåœ¨åŠŸèƒ½å±‚çº§å’Œå®é™…ä½¿ç”¨ä¸Šå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯å…¶åŒºåˆ«ä¸è”ç³»çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒè”ç³»"&gt;ğŸ”— &lt;strong&gt;æ ¸å¿ƒè”ç³»&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç»§æ‰¿å…³ç³»&lt;/strong&gt;
&lt;code&gt;AbstractProcessor&lt;/code&gt; æ˜¯ &lt;code&gt;Processor&lt;/code&gt; æ¥å£çš„&lt;strong&gt;é»˜è®¤æŠ½è±¡å®ç°ç±»&lt;/strong&gt;ï¼Œç®€åŒ–äº†è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨çš„å¼€å‘ã€‚å¼€å‘è€…é€šå¸¸ç»§æ‰¿ &lt;code&gt;AbstractProcessor&lt;/code&gt;ï¼Œè€Œéç›´æ¥å®ç° &lt;code&gt;Processor&lt;/code&gt; æ¥å£&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…±åŒç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;
ä¸¤è€…å‡åœ¨ç¼–è¯‘æœŸç”± &lt;code&gt;javac&lt;/code&gt; è°ƒç”¨ï¼Œéµå¾ªå¤šè½®æ¬¡ï¼ˆRoundï¼‰å¤„ç†æ¨¡å‹ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯è½®æ‰«ææºç ä¸­çš„æ³¨è§£ï¼Œè°ƒç”¨å¤„ç†å™¨çš„ &lt;code&gt;process()&lt;/code&gt; æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ç”Ÿæˆæ–°æ–‡ä»¶ï¼ˆå¦‚ &lt;code&gt;.java&lt;/code&gt; æ–‡ä»¶ï¼‰ï¼Œåˆ™è§¦å‘æ–°ä¸€è½®å¤„ç†&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–å·¥å…·ç±»&lt;/strong&gt;
å‡é€šè¿‡ &lt;code&gt;ProcessingEnvironment&lt;/code&gt; è·å–å…³é”®å·¥å…·ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Filer&lt;/code&gt;ï¼šç”Ÿæˆæ–°æ–‡ä»¶ï¼ˆå¦‚è‡ªåŠ¨åˆ›å»ºçš„æºç ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Messager&lt;/code&gt;ï¼šæŠ¥å‘Šç¼–è¯‘é”™è¯¯/è­¦å‘Šã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Elements&lt;/code&gt;/&lt;code&gt;Types&lt;/code&gt;ï¼šæ“ä½œç¨‹åºå…ƒç´ å’Œç±»å‹ç³»ç»Ÿ&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«"&gt;âš–ï¸ &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŠŸèƒ½å®Œå¤‡æ€§"&gt;&lt;strong&gt;åŠŸèƒ½å®Œå¤‡æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;èƒ½åŠ›&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Processor æ¥å£&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AbstractProcessor&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…å®šä¹‰æŠ½è±¡æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;process()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æä¾›é»˜è®¤å®ç°ï¼Œç®€åŒ–å¼€å‘ï¼ˆå¦‚æ³¨è§£è§£æé€»è¾‘ï¼‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ³¨è§£æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨å®ç°æ‰€æœ‰æ–¹æ³•&lt;/td&gt;
&lt;td&gt;é€šè¿‡æ³¨è§£ï¼ˆå¦‚ &lt;code&gt;@SupportedAnnotationTypes&lt;/code&gt;ï¼‰å£°æ˜æ”¯æŒèŒƒå›´&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‰ˆæœ¬å…¼å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨è¦†ç›– &lt;code&gt;getSupportedSourceVersion()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é»˜è®¤æ”¯æŒ &lt;code&gt;RELEASE_6&lt;/code&gt;ï¼Œå¯é€šè¿‡æ³¨è§£æˆ–é‡å†™æ›´æ–°&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="å…³é”®æ–¹æ³•å®ç°å¯¹æ¯”"&gt;&lt;strong&gt;å…³é”®æ–¹æ³•å®ç°å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;getSupportedAnnotationTypes()
&lt;/code&gt;&lt;/pre&gt;**
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Processor&lt;/code&gt;ï¼šå¿…é¡»å®Œå…¨æ‰‹åŠ¨å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AbstractProcessor&lt;/code&gt;ï¼šè‡ªåŠ¨ä» &lt;code&gt;@SupportedAnnotationTypes&lt;/code&gt; æ³¨è§£è¯»å–å€¼ï¼Œæ”¯æŒé€šé…ç¬¦ï¼ˆå¦‚ &lt;code&gt;&amp;quot;*&amp;quot;&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;process()
&lt;/code&gt;&lt;/pre&gt;**
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Processor&lt;/code&gt;ï¼šå¼ºåˆ¶è¦æ±‚å®ç°æ ¸å¿ƒå¤„ç†é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AbstractProcessor&lt;/code&gt;ï¼šä»éœ€å¼€å‘è€…é‡å†™ï¼Œä½†ç¯å¢ƒå·¥å…·ï¼ˆå¦‚ &lt;code&gt;RoundEnvironment&lt;/code&gt;ï¼‰å·²é›†æˆ&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è®¾è®¡ç›®çš„"&gt;&lt;strong&gt;è®¾è®¡ç›®çš„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Processor&lt;/code&gt; æ¥å£&lt;/strong&gt;
å®šä¹‰æ³¨è§£å¤„ç†å™¨çš„&lt;strong&gt;æ ‡å‡†è¡Œä¸ºå¥‘çº¦&lt;/strong&gt;ï¼Œç¡®ä¿æ‰€æœ‰å¤„ç†å™¨å…·å¤‡ä¸€è‡´çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆå¦‚åˆå§‹åŒ–ã€å¤šè½®å¤„ç†ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;AbstractProcessor
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æä¾›
å¼€ç®±å³ç”¨çš„åŸºç¡€å®ç°**ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨è§£æ &lt;code&gt;@SupportedSourceVersion&lt;/code&gt; æ³¨è§£ã€‚&lt;/li&gt;
&lt;li&gt;å†…ç½®ç©ºæ–¹æ³•é˜²æ­¢ &lt;code&gt;NullPointerException&lt;/code&gt;&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨åœºæ™¯ä¸é€‰æ‹©å»ºè®®"&gt;ğŸ› ï¸ &lt;strong&gt;ä½¿ç”¨åœºæ™¯ä¸é€‰æ‹©å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä½•æ—¶ç”¨"&gt;&lt;strong&gt;ä½•æ—¶ç”¨ &lt;code&gt;AbstractProcessor&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»å¤§å¤šæ•°æƒ…å†µ&lt;/strong&gt;ï¼šå¦‚ Lombokã€AutoService ç­‰å·¥å…·ï¼Œé€šè¿‡ç»§æ‰¿å®ƒå¿«é€Ÿå®ç°æ³¨è§£å¤„ç†é€»è¾‘&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€å‡å°‘æ ·æ¿ä»£ç &lt;/strong&gt;ï¼šé¿å…æ‰‹åŠ¨è§£ææ³¨è§£æ”¯æŒèŒƒå›´æˆ–ç‰ˆæœ¬å…¼å®¹æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ä»£ç ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; @AutoService(Processor.class) // Google AutoService è‡ªåŠ¨æ³¨å†Œ
@SupportedAnnotationTypes(&amp;#34;com.example.*&amp;#34;) // å£°æ˜æ”¯æŒæ³¨è§£
public class MyProcessor extends AbstractProcessor {
@Override
public boolean process(Set&amp;lt;? extends TypeElement&amp;gt; annotations, RoundEnvironment env) {
// å¤„ç†æ³¨è§£å¹¶ç”Ÿæˆä»£ç 
return true;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä½•æ—¶ç›´æ¥å®ç°"&gt;&lt;strong&gt;ä½•æ—¶ç›´æ¥å®ç° &lt;code&gt;Processor&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦å®Œå…¨è‡ªå®šä¹‰è¡Œä¸º&lt;/strong&gt;ï¼šä¾‹å¦‚ç»•è¿‡é»˜è®¤æ³¨è§£è§£ææœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº•å±‚æ¡†æ¶å¼€å‘&lt;/strong&gt;ï¼šå¦‚å®šåˆ¶åŒ–ç¼–è¯‘å·¥å…·é“¾ï¼ˆç½•è§éœ€æ±‚ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Processor æ¥å£&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AbstractProcessor&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§’è‰²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºç¡€æ¥å£ï¼Œå®šä¹‰è¡Œä¸ºè§„èŒƒ&lt;/td&gt;
&lt;td&gt;é»˜è®¤å®ç°ï¼Œæä¾›å·¥å…·å’Œç®€åŒ–é€»è¾‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½¿ç”¨éš¾åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆéœ€å®ç°æ‰€æœ‰æ–¹æ³•ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆç»§æ‰¿+é‡å†™æ ¸å¿ƒæ–¹æ³•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç‰¹æ®Šå®šåˆ¶éœ€æ±‚&lt;/td&gt;
&lt;td&gt;90% çš„æ³¨è§£å¤„ç†å™¨å¼€å‘ï¼ˆå¦‚ Lombokï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;ä¸€å¥è¯æ¦‚æ‹¬&lt;/strong&gt;ï¼š
&lt;code&gt;Processor&lt;/code&gt; æ˜¯â€œå®ªæ³•â€ï¼Œè§„å®šæ³¨è§£å¤„ç†å™¨åº”åšä»€ä¹ˆï¼›
&lt;code&gt;AbstractProcessor&lt;/code&gt; æ˜¯â€œæ³•å¾‹è‰æ¡ˆâ€ï¼Œæä¾›äº†å¯ç›´æ¥è½åœ°çš„å®ç°æ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚
å¼€å‘è€…åº”ä¼˜å…ˆé€‰æ‹© &lt;strong&gt;AbstractProcessor&lt;/strong&gt;ï¼Œä»…åœ¨æç«¯å®šåˆ¶åŒ–åœºæ™¯ä¸‹è€ƒè™‘ç›´æ¥å®ç°æ¥å£ã€‚äºŒè€…çš„åä½œå¥ å®šäº† Java ç¼–è¯‘æœŸä»£ç ç”Ÿæˆï¼ˆå¦‚å‡å°‘åå°„ï¼‰ã€è‡ªåŠ¨åŒ–æ ¡éªŒç­‰æŠ€æœ¯çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="supportedannotationtypes"&gt;@SupportedAnnotationTypes
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;@SupportedAnnotationTypes&lt;/code&gt; æ˜¯ Java æ³¨è§£å¤„ç†å™¨ï¼ˆAnnotation Processorï¼‰ä¸­çš„æ ¸å¿ƒæ³¨è§£ä¹‹ä¸€ï¼Œç”¨äºå£°æ˜å¤„ç†å™¨æ”¯æŒçš„æ³¨è§£ç±»å‹ã€‚å®ƒåœ¨ç¼–è¯‘é˜¶æ®µç”± &lt;code&gt;javac&lt;/code&gt; è°ƒç”¨ï¼Œç¡®ä¿å¤„ç†å™¨ä»…å¤„ç†æŒ‡å®šçš„æ³¨è§£ï¼Œä»è€Œæå‡æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚ä»¥ä¸‹æ˜¯å…¶è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä½œç”¨ä¸å®šä½"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒä½œç”¨ä¸å®šä½&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å£°æ˜æ”¯æŒèŒƒå›´&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ˜ç¡®æ ‡æ³¨å½“å‰æ³¨è§£å¤„ç†å™¨èƒ½å¤„ç†çš„&lt;strong&gt;æ³¨è§£ç±»å‹å…¨é™å®šå&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;&amp;quot;com.example.LogExecutionTime&amp;quot;&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…å¤„ç†å™¨æ— æ•ˆæ‰«ææ— å…³æ³¨è§£ï¼Œå‡å°‘ç¼–è¯‘æ—¶èµ„æºæ¶ˆè€—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ &lt;code&gt;AbstractProcessor&lt;/code&gt; çš„åä½œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;AbstractProcessor.getSupportedAnnotationTypes()&lt;/code&gt; æ–¹æ³•é»˜è®¤ä¼šè¯»å–è¯¥æ³¨è§£çš„ &lt;code&gt;value&lt;/code&gt; å€¼ä½œä¸ºæ”¯æŒèŒƒå›´&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¼€å‘è€…æ— éœ€æ‰‹åŠ¨é‡å†™ &lt;code&gt;getSupportedAnnotationTypes()&lt;/code&gt;ï¼Œç®€åŒ–ä»£ç &lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¯­æ³•ä¸ä½¿ç”¨æ–¹å¼"&gt;ğŸ“ &lt;strong&gt;è¯­æ³•ä¸ä½¿ç”¨æ–¹å¼&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ³¨è§£å®šä¹‰"&gt;&lt;strong&gt;æ³¨è§£å®šä¹‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;@Documented
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
public @interface SupportedAnnotationTypes {
String[] value(); // è¿”å›æ”¯æŒçš„æ³¨è§£å…¨é™å®šåæ•°ç»„
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ç›®æ ‡&lt;/strong&gt;ï¼šä»…èƒ½ç”¨äºæ³¨è§£å¤„ç†å™¨ç±»ï¼ˆ&lt;code&gt;ElementType.TYPE&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿ç•™ç­–ç•¥&lt;/strong&gt;ï¼šè¿è¡Œæ—¶ä¿ç•™ï¼ˆ&lt;code&gt;RUNTIME&lt;/code&gt;ï¼‰ï¼Œä¾›ç¼–è¯‘å™¨è¯»å–&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä½¿ç”¨ç¤ºä¾‹"&gt;&lt;strong&gt;ä½¿ç”¨ç¤ºä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;@SupportedAnnotationTypes({&amp;#34;com.example.Log&amp;#34;, &amp;#34;com.example.Validate&amp;#34;})
public class MyProcessor extends AbstractProcessor {
@Override
public boolean process(Set&amp;lt;? extends TypeElement&amp;gt; annotations, RoundEnvironment env) {
// å¤„ç†é€»è¾‘
return true;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ³¨è§£æ”¯æŒ&lt;/strong&gt;ï¼šç”¨æ•°ç»„å½¢å¼å£°æ˜å¤šä¸ªæ³¨è§£ç±»å‹&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€šé…ç¬¦&lt;/strong&gt;ï¼šæ”¯æŒ &lt;code&gt;*&lt;/code&gt; åŒ¹é…åŒ…è·¯å¾„ï¼ˆå¦‚ &lt;code&gt;&amp;quot;com.example.*&amp;quot;&lt;/code&gt;ï¼‰ï¼Œä½†éœ€è°¨æ…é¿å…è¿‡åº¦åŒ¹é…&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œåŸç†"&gt;âš™ï¸ &lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç¼–è¯‘æœŸæ‰«æ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;javac&lt;/code&gt; åœ¨ç¼–è¯‘æ—¶è¯†åˆ«æ‰€æœ‰æ³¨è§£å¤„ç†å™¨ï¼Œå¹¶æ£€æŸ¥å…¶ &lt;code&gt;@SupportedAnnotationTypes&lt;/code&gt; å®šä¹‰çš„æ³¨è§£ç±»å‹&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å¤šè½®æ¬¡å¤„ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥å¤„ç†å™¨ç”Ÿæˆæ–°æºæ–‡ä»¶ï¼ˆå¦‚ &lt;code&gt;.java&lt;/code&gt;ï¼‰ï¼Œä¼šè§¦å‘æ–°ä¸€è½®å¤„ç†ï¼Œä½†ä»…æ‰«æä¸å£°æ˜åŒ¹é…çš„æ³¨è§£&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ-1"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸é‡å†™æ–¹æ³•å†²çª&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥åŒæ—¶ä½¿ç”¨æ³¨è§£å¹¶é‡å†™ &lt;code&gt;getSupportedAnnotationTypes()&lt;/code&gt;ï¼Œ&lt;strong&gt;ä»¥é‡å†™æ–¹æ³•ä¸ºå‡†&lt;/strong&gt;ã€‚å»ºè®®äºŒé€‰ä¸€ä»¥é¿å…æ··æ·†&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹å†²çªï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;@SupportedAnnotationTypes(&amp;#34;com.example.A&amp;#34;) // è¢«å¿½ç•¥
public class MyProcessor extends AbstractProcessor {
@Override
public Set&amp;lt;String&amp;gt; getSupportedAnnotationTypes() {
return Set.of(&amp;#34;com.example.B&amp;#34;); // å®é™…ç”Ÿæ•ˆ
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€šé…ç¬¦çš„å±€é™æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šé…ç¬¦ &lt;code&gt;*&lt;/code&gt; ä»…åŒ¹é…å½“å‰åŒ…ä¸‹æ³¨è§£ï¼Œä¸æ”¯æŒé€’å½’å­åŒ…ï¼ˆå¦‚ &lt;code&gt;&amp;quot;com.example.*&amp;quot;&lt;/code&gt; ä¸åŒ…å« &lt;code&gt;com.example.sub.*&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨å†Œæ–¹å¼å¯¹æ¯”&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ³¨å†Œæ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@SupportedAnnotationTypes&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å£°æ˜ç®€æ´ï¼Œå‡å°‘æ ·æ¿ä»£ç &lt;/td&gt;
&lt;td&gt;é€šé…ç¬¦åŠŸèƒ½æœ‰é™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é‡å†™ &lt;code&gt;getSupportedAnnotationTypes()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€é€»è¾‘çµæ´»ï¼ˆå¦‚æ¡ä»¶è¿‡æ»¤ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨ç»´æŠ¤æ³¨è§£åˆ—è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åº”ç”¨åœºæ™¯"&gt;ğŸ› ï¸ &lt;strong&gt;å®é™…åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ Lombok çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; @Getter
```
å¤„ç†å™¨å£°æ˜ï¼š
```
@SupportedAnnotationTypes(&amp;#34;lombok.Getter&amp;#34;)
public class GetterProcessor extends AbstractProcessor { ... }
```
ä»…å¤„ç†å«
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt; @Getter
```
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çš„ç±»ï¼Œé«˜æ•ˆç”Ÿæˆ getter æ–¹æ³•
4
ã€‚
2. &lt;strong&gt;ç¼–è¯‘æ—¶æ ¡éªŒ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ ¡éªŒæ³¨è§£ï¼ˆå¦‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; @NotNull
```
ï¼‰çš„å¤„ç†å™¨ï¼š
```
@SupportedAnnotationTypes(&amp;#34;org.example.NotNull&amp;#34;)
public class NotNullProcessor extends AbstractProcessor { ... }
```
æ£€æŸ¥å­—æ®µèµ‹å€¼æ˜¯å¦éç©ºï¼Œé”™è¯¯æ—¶é€šè¿‡
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt; Messager
```
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŠ¥é”™
3,6
ã€‚
3. &lt;strong&gt;æ¡†æ¶æ‰©å±•&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spring Boot ä¸­è‡ªå®šä¹‰é…ç½®æ³¨è§£çš„å¤„ç†å™¨ï¼Œæ ¹æ®æ³¨è§£ç”Ÿæˆé…ç½®æ–‡ä»¶æˆ–åˆå§‹åŒ–ä»£ç &lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;@SupportedAnnotationTypes&lt;/code&gt; æ˜¯æ³¨è§£å¤„ç†å™¨çš„**â€œç›®æ ‡è¿‡æ»¤å™¨â€**ï¼Œé€šè¿‡å£°æ˜å¼é…ç½®æ˜ç¡®å¤„ç†èŒƒå›´ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç²¾å‡†åŒ¹é…&lt;/strong&gt;ï¼šé¿å…æ— æ•ˆæ‰«æï¼Œæå‡ç¼–è¯‘æ•ˆç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç ç®€åŒ–&lt;/strong&gt;ï¼šæ›¿ä»£æ‰‹åŠ¨é‡å†™ &lt;code&gt;getSupportedAnnotationTypes()&lt;/code&gt;ï¼Œé™ä½å†—ä½™&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åä½œè§„èŒƒ&lt;/strong&gt;ï¼šä¸ &lt;code&gt;AbstractProcessor&lt;/code&gt; æ·±åº¦é›†æˆï¼Œæ˜¯ Java ç¼–è¯‘æ—¶å…ƒç¼–ç¨‹çš„åŸºçŸ³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šå¤æ‚åœºæ™¯ï¼ˆå¦‚åŠ¨æ€æ³¨è§£æ”¯æŒï¼‰ä»éœ€é‡å†™ &lt;code&gt;getSupportedAnnotationTypes()&lt;/code&gt;ï¼Œæ­¤æ—¶åº”å¿½ç•¥è¯¥æ³¨è§£&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚åˆç†é€‰æ‹©å£°æ˜æ–¹å¼ï¼Œå¯æ˜¾è‘—æå‡å¤„ç†å™¨æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="è¿è¡Œæ—¶æ³¨è§£"&gt;è¿è¡Œæ—¶æ³¨è§£
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œè¿è¡Œæ—¶æ ¹æ®æ³¨è§£ç­›é€‰å…ƒç´ ï¼ˆå¦‚ç±»ã€æ–¹æ³•æˆ–å­—æ®µï¼‰ä¸»è¦é€šè¿‡ &lt;strong&gt;åå°„æœºåˆ¶ï¼ˆReflectionï¼‰&lt;/strong&gt; å®ç°ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æ­¥éª¤å’Œç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç­›é€‰çš„æ ¸å¿ƒæ­¥éª¤"&gt;âš™ï¸ &lt;strong&gt;ç­›é€‰çš„æ ¸å¿ƒæ­¥éª¤&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¡®ä¿æ³¨è§£ä¿ç•™åˆ°è¿è¡Œæ—¶&lt;/strong&gt;
æ³¨è§£éœ€é€šè¿‡ &lt;code&gt;@Retention(RetentionPolicy.RUNTIME)&lt;/code&gt; æ ‡è®°ï¼Œå¦åˆ™ JVM ä¼šåœ¨åŠ è½½ç±»æ—¶ä¸¢å¼ƒæ³¨è§£ä¿¡æ¯&lt;a class="link" href="@ref" &gt;2,4,5&lt;/a&gt;ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD) // å¯æŒ‡å®šä½œç”¨ç›®æ ‡ï¼ˆç±»ã€æ–¹æ³•ã€å­—æ®µç­‰ï¼‰
public @interface MyAnnotation {
String value() default &amp;#34;&amp;#34;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·å–ç›®æ ‡å…ƒç´ å¹¶æ£€æŸ¥æ³¨è§£&lt;/strong&gt;
ä½¿ç”¨åå°„ API è·å–ç±»ã€æ–¹æ³•æˆ–å­—æ®µçš„å…ƒæ•°æ®ï¼Œå¹¶é€šè¿‡ä»¥ä¸‹æ–¹æ³•ç­›é€‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;isAnnotationPresent(Class)&lt;/code&gt;: æ£€æŸ¥å…ƒç´ æ˜¯å¦è¢«æŒ‡å®šæ³¨è§£æ ‡è®°&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getAnnotation(Class)&lt;/code&gt;: è·å–æ³¨è§£å®ä¾‹ï¼Œè¿›ä¸€æ­¥è¯»å–å±æ€§å€¼&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œç­›é€‰é€»è¾‘&lt;/strong&gt;
æ ¹æ®æ³¨è§£ä¿¡æ¯åŠ¨æ€è°ƒæ•´ç¨‹åºè¡Œä¸ºï¼ˆå¦‚è°ƒç”¨æ–¹æ³•ã€æ³¨å…¥ä¾èµ–ç­‰ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…·ä½“åœºæ™¯ä¸ä»£ç ç¤ºä¾‹"&gt;ğŸ§© &lt;strong&gt;å…·ä½“åœºæ™¯ä¸ä»£ç ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åœºæ™¯-1ç­›é€‰è¢«æ³¨è§£æ ‡è®°çš„æ–¹æ³•"&gt;&lt;strong&gt;åœºæ™¯ 1ï¼šç­›é€‰è¢«æ³¨è§£æ ‡è®°çš„æ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// å®šä¹‰è¿è¡Œæ—¶æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface LogExecutionTime {}
// ç›®æ ‡ç±»
public class TaskService {
@LogExecutionTime
public void runTask() {
System.out.println(&amp;#34;Task running...&amp;#34;);
}
}
// è¿è¡Œæ—¶ç­›é€‰å¹¶æ‰§è¡Œ
public class AnnotationScanner {
public static void main(String[] args) throws Exception {
Class&amp;lt;?&amp;gt; clazz = TaskService.class;
for (Method method : clazz.getMethods()) {
if (method.isAnnotationPresent(LogExecutionTime.class)) {
// æ‰§è¡Œå¸¦æ³¨è§£çš„æ–¹æ³•
method.invoke(clazz.getDeclaredConstructor().newInstance());
}
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;getMethods()&lt;/code&gt; éå†æ‰€æœ‰æ–¹æ³•ï¼Œç”¨ &lt;code&gt;isAnnotationPresent&lt;/code&gt; æ£€æŸ¥æ³¨è§£&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åœºæ™¯-2æ ¹æ®æ³¨è§£å±æ€§å€¼ç­›é€‰"&gt;&lt;strong&gt;åœºæ™¯ 2ï¼šæ ¹æ®æ³¨è§£å±æ€§å€¼ç­›é€‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
public @interface Route {
String path(); // å®šä¹‰è·¯å¾„å±æ€§
}
// ä½¿ç”¨æ³¨è§£
@Route(path = &amp;#34;/user&amp;#34;)
public class UserController {}
// æ‰«æå¹¶æ³¨å†Œè·¯ç”±
public class RouterRegistry {
public static void registerControllers() {
Reflections reflections = new Reflections(&amp;#34;com.example&amp;#34;); // åŒ…æ‰«æå·¥å…·
Set&amp;lt;Class&amp;lt;?&amp;gt;&amp;gt; controllers = reflections.getTypesAnnotatedWith(Route.class);
for (Class&amp;lt;?&amp;gt; clazz : controllers) {
Route route = clazz.getAnnotation(Route.class);
System.out.println(&amp;#34;æ³¨å†Œè·¯ç”±: &amp;#34; + route.path() + &amp;#34; -&amp;gt; &amp;#34; + clazz.getName());
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šç»“åˆç±»æ‰«æå·¥å…·ï¼ˆå¦‚ &lt;code&gt;Reflections&lt;/code&gt;ï¼‰ç­›é€‰å¸¦æ³¨è§£çš„ç±»ï¼Œå¹¶è¯»å–æ³¨è§£å±æ€§&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŒ–æŠ€å·§"&gt;âš¡ï¸ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–æŠ€å·§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘åå°„è°ƒç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç¼“å­˜æ‰«æç»“æœï¼ˆå¦‚å°†æ³¨è§£ç±»åˆ—è¡¨å­˜å…¥é™æ€å˜é‡ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…åœ¨å¾ªç¯ä¸­é‡å¤è°ƒç”¨ &lt;code&gt;getAnnotation()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼©å°æ‰«æèŒƒå›´&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æŒ‡å®šåŒ…è·¯å¾„ï¼ˆå¦‚ &lt;code&gt;Reflections(&amp;quot;com.example.controllers&amp;quot;)&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æŒ‰éœ€åŠ è½½ç±»ï¼ˆé¿å…æ‰«ææ•´ä¸ª classpathï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨å·¥å…·åº“&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Spring çš„ &lt;code&gt;AnnotationUtils&lt;/code&gt;&lt;/strong&gt;ï¼šæ”¯æŒå¤„ç†ç»§æ‰¿æ³¨è§£ï¼ˆ&lt;code&gt;@Inherited&lt;/code&gt;ï¼‰å’Œæ¡¥æ¥æ–¹æ³•&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Reflections åº“&lt;/strong&gt;ï¼šå¿«é€Ÿæ‰«æç±»è·¯å¾„å¹¶è¿‡æ»¤æ³¨è§£&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜ä¸è§£å†³"&gt;âš ï¸ &lt;strong&gt;å¸¸è§é—®é¢˜ä¸è§£å†³&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ³¨è§£æœªç”Ÿæ•ˆï¼Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥ &lt;code&gt;@Retention&lt;/code&gt; æ˜¯å¦ä¸º &lt;code&gt;RUNTIME&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®è®¤ &lt;code&gt;@Target&lt;/code&gt; æ˜¯å¦åŒ…å«ç›®æ ‡å…ƒç´ ç±»å‹ï¼ˆå¦‚æ–¹æ³•æ³¨è§£è¯¯ç”¨äºç±»ï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆï¼Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ›¿æ¢åå°„ä¸ºç¼–è¯‘æ—¶æ³¨è§£å¤„ç†ï¼ˆå¦‚ Lombokï¼‰ï¼Œé¿å…è¿è¡Œæ—¶å¼€é”€&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨è§£ç»§æ‰¿å¤±æ•ˆï¼Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤ä¸ç»§æ‰¿çˆ¶ç±»æ³¨è§£ï¼Œéœ€æ˜¾å¼æ ‡è®° &lt;code&gt;@Inherited&lt;/code&gt;ï¼ˆä»…å¯¹ç±»æœ‰æ•ˆï¼Œæ–¹æ³•æ— æ•ˆï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è¿è¡Œæ—¶æ³¨è§£ç­›é€‰çš„æ ¸å¿ƒæ˜¯ &lt;strong&gt;åå°„ + å…ƒæ•°æ®ä¿ç•™ç­–ç•¥&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ³¨è§£éœ€ç”¨ &lt;code&gt;@Retention(RetentionPolicy.RUNTIME)&lt;/code&gt; ä¿ç•™è‡³è¿è¡Œæ—¶ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡åå°„ API éå†å…ƒç´ å¹¶æ£€æŸ¥æ³¨è§£å­˜åœ¨æ€§ï¼ˆ&lt;code&gt;isAnnotationPresent()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç»“åˆæ‰«æå·¥å…·ï¼ˆå¦‚ Reflectionsï¼‰å’Œæ³¨è§£å±æ€§å®ç°åŠ¨æ€é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šåŠ¨æ€è·¯ç”±æ³¨å†Œï¼ˆSpring MVCï¼‰ã€AOP åˆ‡é¢ï¼ˆå¦‚ &lt;code&gt;@Transactional&lt;/code&gt;ï¼‰ã€è‡ªå®šä¹‰æ ¡éªŒï¼ˆå¦‚ &lt;code&gt;@NotNull&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,6,7&lt;/a&gt;ã€‚
â€‹&lt;strong&gt;é¿å‘æç¤º&lt;/strong&gt;â€‹ï¼šé¢‘ç¹è°ƒç”¨åå°„æ—¶éœ€ä¼˜åŒ–æ€§èƒ½ï¼Œå¤æ‚åœºæ™¯ä¼˜å…ˆè€ƒè™‘ç¼–è¯‘æ—¶å¤„ç†ï¼ˆå¦‚æ³¨è§£å¤„ç†å™¨ç”Ÿæˆä»£ç ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="reflections"&gt;Reflections
&lt;/h2&gt;&lt;p&gt;Reflections æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ Java å…ƒæ•°æ®æ‰«æä¸æŸ¥è¯¢åº“ï¼Œå®ƒé€šè¿‡ç®€åŒ–åå°„æ“ä½œå’Œç±»è·¯å¾„æ‰«æï¼Œå¸®åŠ©å¼€å‘è€…åœ¨è¿è¡Œæ—¶åŠ¨æ€å‘ç°ç±»ã€æ–¹æ³•ã€å­—æ®µã€æ³¨è§£ç­‰å…ƒæ•°æ®ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŠŸèƒ½ã€ä½¿ç”¨æ–¹å¼ã€åº”ç”¨åœºæ™¯åŠä¼˜åŒ–æŠ€å·§å±•å¼€è¯¦ç»†ä»‹ç»ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸å®šä½-167"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½ä¸å®šä½&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…ƒæ•°æ®ç´¢å¼•ä¸æ‰«æ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ‰«æç±»è·¯å¾„&lt;/strong&gt;ï¼šè‡ªåŠ¨æ‰«ææŒ‡å®šåŒ…æˆ–æ•´ä¸ªé¡¹ç›®çš„ &lt;code&gt;.class&lt;/code&gt; æ–‡ä»¶ï¼Œæ„å»ºå…ƒæ•°æ®ç´¢å¼•è¡¨ï¼ˆå¦‚ç±»åã€æ³¨è§£ã€æ–¹æ³•ç­¾åç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨æ¨¡å—æ”¯æŒ&lt;/strong&gt;ï¼šæ”¯æŒå¤šæ¨¡å—é¡¹ç›®ï¼Œå¯åŒæ—¶æ‰«æå¤šä¸ªå­æ¨¡å—çš„å…ƒæ•°æ®ï¼ˆä¾‹å¦‚å¾®æœåŠ¡æ¶æ„ä¸­çš„ç»Ÿä¸€æ³¨è§£å¤„ç†ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸°å¯Œçš„æŸ¥è¯¢åŠŸèƒ½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç±»å‹æŸ¥è¯¢ï¼š
&lt;ul&gt;
&lt;li&gt;æŸ¥æ‰¾å­ç±»ï¼š&lt;code&gt;getSubTypesOf(SomeInterface.class)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æŸ¥æ‰¾æ³¨è§£æ ‡è®°çš„ç±»ï¼š&lt;code&gt;getTypesAnnotatedWith(MyAnnotation.class)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ–¹æ³•ä¸å­—æ®µæŸ¥è¯¢ï¼š
&lt;ul&gt;
&lt;li&gt;æ³¨è§£æ–¹æ³•ï¼š&lt;code&gt;getMethodsAnnotatedWith(Path.class)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç‰¹å®šå­—æ®µï¼š&lt;code&gt;getFieldsAnnotatedWith(Id.class)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;èµ„æºæ–‡ä»¶æŸ¥è¯¢ï¼š
&lt;ul&gt;
&lt;li&gt;åŒ¹é…é…ç½®æ–‡ä»¶ï¼š&lt;code&gt;getResources(Pattern.compile(&amp;quot;.*\\.properties&amp;quot;))&lt;/code&gt; &lt;a class="link" href="@ref" &gt;3,5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»çš„æ‰«æå™¨é…ç½®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å†…ç½®å¤šç§æ‰«æå™¨ï¼ˆScannersï¼‰ï¼ŒæŒ‰éœ€å¯ç”¨ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;TypeAnnotationsScanner&lt;/code&gt;ï¼šæ‰«æç±»æ³¨è§£&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MethodParameterScanner&lt;/code&gt;ï¼šè§£ææ–¹æ³•å‚æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ResourcesScanner&lt;/code&gt;ï¼šå®šä½èµ„æºæ–‡ä»¶&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹é…ç½®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Reflections reflections = new Reflections(new ConfigurationBuilder()
.setUrls(ClasspathHelper.forPackage(&amp;#34;com.example&amp;#34;))
.addScanners(new TypeAnnotationsScanner(), new FieldAnnotationsScanner())
.filterInputsBy(new FilterBuilder().includePackage(&amp;#34;com.example&amp;#34;)));
``` [6,8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨æ–¹å¼ä¸ä»£ç ç¤ºä¾‹"&gt;ğŸ› ï¸ &lt;strong&gt;ä½¿ç”¨æ–¹å¼ä¸ä»£ç ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¾èµ–å¼•å…¥&lt;/p&gt;
&lt;p&gt;Maven é…ç½®ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.reflections&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;reflections&amp;lt;/artifactId&amp;gt;
&amp;lt;version&amp;gt;0.10.2&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
``` [2,4,8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;ol start="2"&gt;
&lt;li&gt;åŸºç¡€æ“ä½œç¤ºä¾‹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ‰«æå¸¦æ³¨è§£çš„ç±»ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Reflections reflections = new Reflections(&amp;#34;com.example&amp;#34;);
Set&amp;lt;Class&amp;lt;?&amp;gt;&amp;gt; controllers = reflections.getTypesAnnotatedWith(RestController.class);
controllers.forEach(clazz -&amp;gt; System.out.println(&amp;#34;æ§åˆ¶å™¨: &amp;#34; + clazz.getName()));
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;æŸ¥æ‰¾æ¥å£å®ç°ç±»ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Set&amp;lt;Class&amp;lt;? extends Plugin&amp;gt;&amp;gt; plugins = reflections.getSubTypesOf(Plugin.class);
plugins.forEach(plugin -&amp;gt; registerPlugin(plugin.newInstance()));
``` [4,5,8](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é«˜çº§æŸ¥è¯¢&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¤åˆæ¡ä»¶æŸ¥è¯¢ï¼ˆå¦‚æŸ¥æ‰¾å…¬æœ‰ getter æ–¹æ³•ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Set&amp;lt;Method&amp;gt; getters = reflections.getMethodsMatchParams(
withModifier(Modifier.PUBLIC),
withPrefix(&amp;#34;get&amp;#34;),
withParametersCount(0)
);
``` [3,5](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯-157"&gt;ğŸš€ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt; &lt;a class="link" href="@ref" &gt;1,5,7&lt;/a&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¡†æ¶å¼€å‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–æ³¨å…¥&lt;/strong&gt;ï¼šè‡ªåŠ¨å‘ç° &lt;code&gt;@Service&lt;/code&gt; æˆ– &lt;code&gt;@Component&lt;/code&gt; æ³¨è§£çš„ç±»å¹¶æ³¨å…¥å®¹å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’ä»¶ç³»ç»Ÿ&lt;/strong&gt;ï¼šåŠ¨æ€åŠ è½½å®ç°ç‰¹å®šæ¥å£çš„æ’ä»¶ç±»ï¼ˆå¦‚ &lt;code&gt;getSubTypesOf(Plugin.class)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨è§£é©±åŠ¨é€»è¾‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¯ç”±æ³¨å†Œ&lt;/strong&gt;ï¼šæ‰«æå¸¦ &lt;code&gt;@Route(&amp;quot;/path&amp;quot;)&lt;/code&gt; æ³¨è§£çš„æ§åˆ¶å™¨ï¼Œç”Ÿæˆè·¯ç”±è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AOP åˆ‡é¢&lt;/strong&gt;ï¼šå®šä½ &lt;code&gt;@Transactional&lt;/code&gt; æ³¨è§£çš„æ–¹æ³•ï¼ŒåŠ¨æ€ä»£ç†äº‹åŠ¡ç®¡ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨åŒ–æµ‹è¯•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ”¶é›†æ‰€æœ‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; @Test
```
æ³¨è§£çš„æ–¹æ³•ï¼Œè‡ªå®šä¹‰æµ‹è¯•è¿è¡Œå™¨ï¼š
```
Set&amp;lt;Method&amp;gt; tests = reflections.getMethodsAnnotatedWith(Test.class);
tests.forEach(method -&amp;gt; runTest(method));
```
4. **èµ„æºç®¡ç†**
- æ‰¹é‡åŠ è½½é…ç½®æ–‡ä»¶æˆ–æ¨¡æ¿ï¼ˆå¦‚ `.properties` æˆ– `.html` æ–‡ä»¶ï¼‰ã€‚
------
### âš ï¸ **æ€§èƒ½ä¼˜åŒ–ä¸æ³¨æ„äº‹é¡¹** [1,5,6](@ref)
1. **æ€§èƒ½ç“¶é¢ˆ**
- **é—®é¢˜**ï¼šå…¨é‡æ‰«æå¤§å‹é¡¹ç›®å¯èƒ½å¯¼è‡´å¯åŠ¨å»¶è¿Ÿï¼ˆå°¤å…¶é¦–æ¬¡æ‰«æï¼‰ã€‚
- ä¼˜åŒ–æ–¹æ¡ˆï¼š
- ç¼©å°æ‰«æèŒƒå›´ï¼šç²¾ç¡®æŒ‡å®šåŒ…è·¯å¾„ï¼ˆå¦‚ `new Reflections(&amp;#34;com.example.core&amp;#34;)`ï¼‰ã€‚
- å¯ç”¨ç¼“å­˜ï¼šå°†æ‰«æç»“æœåºåˆ—åŒ–ä¸º JSON/XMLï¼Œåç»­ç›´æ¥åŠ è½½é¿å…é‡å¤æ‰«æã€‚
- å¢é‡æ›´æ–°ï¼šä»…æ‰«æå˜æ›´éƒ¨åˆ†ï¼ˆéœ€ç»“åˆæ„å»ºå·¥å…·ï¼‰ã€‚
2. **å¸¸è§é—®é¢˜**
- **æ‰«æå¤±æ•ˆ**ï¼šåŒ…è·¯å¾„é”™è¯¯ï¼ˆå¦‚è¯¯å†™ `com.exmaple` â†’ `com.example`ï¼‰[4](@ref)ã€‚
- **æ¨¡å—åŒ–å…¼å®¹æ€§**ï¼šJava 9+ æ¨¡å—ç³»ç»Ÿéœ€å¼€æ”¾åŒ…ï¼ˆ`opens` æŒ‡ä»¤ï¼‰æˆ–é…ç½®æ¨¡å—è·¯å¾„ã€‚
- **å®‰å…¨é£é™©**ï¼šé¿å…æ‰«æä¸å¯ä¿¡ä»£ç ï¼ˆåå°„å¯èƒ½æ‰§è¡Œæ¶æ„é€»è¾‘ï¼‰ã€‚
------
### ğŸ” **Reflections vs åŸç”Ÿåå°„ API**
| **ç»´åº¦** | **Reflections** | **åŸç”Ÿåå°„ API** |
| -------------- | ----------------------------------------------- | ------------------------------------ |
| **ä½¿ç”¨å¤æ‚åº¦** | é«˜é˜¶å°è£…ï¼Œé“¾å¼è°ƒç”¨ï¼ˆå¦‚ `withModifier().and()`ï¼‰ | éœ€æ‰‹åŠ¨å¾ªç¯+æ¡ä»¶åˆ¤æ–­ |
| **åŠŸèƒ½èŒƒå›´** | æ”¯æŒç±»ã€æ–¹æ³•ã€å­—æ®µã€èµ„æºæ–‡ä»¶ç­‰å…¨æ–¹ä½æŸ¥è¯¢ | ä»…æ”¯æŒå•ä¸€ç±»æˆ–å¯¹è±¡çš„å…ƒæ•°æ®è®¿é—® |
| **æ€§èƒ½** | å¯åŠ¨æ—¶å¼€é”€å¤§ï¼Œè¿è¡Œæ—¶æŸ¥è¯¢å¿«ï¼ˆä¾èµ–é¢„ç´¢å¼•ï¼‰ | æ¯æ¬¡è°ƒç”¨å³æ—¶è§£æï¼Œè¿è¡Œæ—¶å¼€é”€å¤§ |
| **é€‚ç”¨åœºæ™¯** | æ¡†æ¶å¼€å‘ã€æ‰¹é‡å…ƒæ•°æ®å¤„ç† | ç®€å•åŠ¨æ€è°ƒç”¨ï¼ˆå¦‚ `method.invoke()`ï¼‰ |
&amp;gt; ğŸ’¡ **è®¾è®¡å»ºè®®**ï¼šä¸­å°å‹é¡¹ç›®æˆ–éœ€åŠ¨æ€å‘ç°çš„åœºæ™¯ï¼ˆå¦‚æ’ä»¶åŒ–ï¼‰ä¼˜å…ˆç”¨ Reflectionsï¼›é«˜æ€§èƒ½å…³é”®è·¯å¾„é¿å…åå°„ï¼Œæ”¹ç”¨ç¼–è¯‘æ—¶æ³¨è§£å¤„ç†ï¼ˆå¦‚ Lombokï¼‰[3,7](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“**
Reflections é€šè¿‡**é¢„ç´¢å¼•+é“¾å¼æŸ¥è¯¢ API**ï¼Œå°† Java åå°„ä»â€œæ‰‹å·¥éå†â€å‡çº§ä¸ºâ€œå£°æ˜å¼æ£€ç´¢â€ï¼Œå¤§å¹…æå‡å¼€å‘æ•ˆç‡ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š
- **ç®€åŒ–å…ƒæ•°æ®å‘ç°**ï¼šé€‚ç”¨äºä¾èµ–æ³¨å…¥ã€è·¯ç”±æ³¨å†Œç­‰åŠ¨æ€åœºæ™¯[5,7](@ref)ã€‚
- **è·¨æ¨¡å—æ”¯æŒ**ï¼šåŠ©åŠ›å¾®æœåŠ¡ç­‰åˆ†å¸ƒå¼æ¶æ„çš„å…ƒæ•°æ®æ•´åˆ[1](@ref)ã€‚
- **çµæ´»æ€§ä¸é£é™©å¹¶å­˜**ï¼šéœ€æƒè¡¡å¯åŠ¨æ€§èƒ½ä¸è¿è¡Œæ—¶ä¾¿åˆ©æ€§ï¼Œåˆç†æ§åˆ¶æ‰«æèŒƒå›´[6](@ref)ã€‚
**å®è·µèµ„æº**ï¼š
- [å®˜æ–¹ GitHub ç¤ºä¾‹](https://github.com/ronmamo/reflections/tree/master/src/test/java/org/reflections)
- [Spring é›†æˆæ–¹æ¡ˆ](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-java)
## è¿è¡Œæ—¶æ³¨è§£è§£æ
åœ¨ Java ä¸­ï¼Œè‡ªå®šä¹‰æ³¨è§£æ˜¯ä¸€ç§å¼ºå¤§çš„å…ƒæ•°æ®ç¼–ç¨‹æœºåˆ¶ï¼Œå¯å¢å¼ºä»£ç çš„å¯è¯»æ€§ã€å‡å°‘é‡å¤é€»è¾‘å¹¶æ”¯æŒæ¡†æ¶æ‰©å±•ã€‚ä»¥ä¸‹æ˜¯å®ç°è‡ªå®šä¹‰æ³¨è§£çš„æ ¸å¿ƒæ­¥éª¤å’ŒæŠ€æœ¯è¦ç‚¹ï¼Œç»“åˆæœ€ä½³å®è·µå’Œå¸¸è§åœºæ™¯ï¼š
------
### ğŸ› ï¸ **å®šä¹‰è‡ªå®šä¹‰æ³¨è§£**
#### **åŸºæœ¬è¯­æ³•**
ä½¿ç”¨ `@interface` å…³é”®å­—å®šä¹‰æ³¨è§£ï¼Œå¹¶é€šè¿‡å…ƒæ³¨è§£ï¼ˆå¦‚ `@Target`ã€`@Retention`ï¼‰é…ç½®å…¶ä½œç”¨èŒƒå›´å’Œç”Ÿå‘½å‘¨æœŸï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;import java.lang.annotation.*;&lt;/p&gt;
&lt;p&gt;@Target(ElementType.METHOD) // æ³¨è§£ä½œç”¨äºæ–¹æ³•
@Retention(RetentionPolicy.RUNTIME) // è¿è¡Œæ—¶ä¿ç•™ï¼ˆå¯é€šè¿‡åå°„è·å–ï¼‰
public @interface LogExecution {
String value() default &amp;ldquo;&amp;rdquo;; // æ³¨è§£å‚æ•°ï¼Œå¯è®¾ç½®é»˜è®¤å€¼
int timeout() default 5000; // å¤šå‚æ•°ç¤ºä¾‹
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **å…ƒæ³¨è§£è¯¦è§£**
- **
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;@Target&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**ï¼šæŒ‡å®šæ³¨è§£çš„åº”ç”¨ç›®æ ‡ï¼ˆæ–¹æ³•ã€ç±»ã€å­—æ®µç­‰ï¼‰ï¼Œå¸¸ç”¨å€¼ï¼š
- `ElementType.METHOD`ï¼šæ–¹æ³•çº§åˆ«
- `ElementType.TYPE`ï¼šç±»/æ¥å£çº§åˆ«
- `ElementType.FIELD`ï¼šå­—æ®µçº§åˆ«
- **
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;@Retention&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**ï¼šå®šä¹‰æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸï¼š
- `RetentionPolicy.SOURCE`ï¼šä»…æºç é˜¶æ®µï¼ˆå¦‚ Lombokï¼‰
- `RetentionPolicy.CLASS`ï¼šç¼–è¯‘åˆ°å­—èŠ‚ç ï¼ˆé»˜è®¤ï¼‰
- `RetentionPolicy.RUNTIME`ï¼šè¿è¡Œæ—¶å¯ç”¨ï¼ˆéœ€åå°„å¤„ç†ï¼‰[1,3](@ref)
- **`@Documented`**ï¼šæ˜¯å¦åŒ…å«åœ¨ Javadoc ä¸­
- **`@Inherited`**ï¼šæ˜¯å¦è¢«å­ç±»ç»§æ‰¿ï¼ˆä»…å¯¹ç±»æ³¨è§£æœ‰æ•ˆï¼‰[3](@ref)
------
### âš™ï¸ **å¤„ç†è‡ªå®šä¹‰æ³¨è§£**
#### **åå°„æ–¹å¼ï¼ˆåŸºç¡€ï¼‰**
åœ¨è¿è¡Œæ—¶é€šè¿‡åå°„è§£ææ³¨è§£ä¿¡æ¯ï¼Œé€‚ç”¨äºç®€å•åœºæ™¯ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;public class AnnotationProcessor {
public static void process(Object obj) {
for (Method method : obj.getClass().getDeclaredMethods()) {
if (method.isAnnotationPresent(LogExecution.class)) {
LogExecution annotation = method.getAnnotation(LogExecution.class);
System.out.println(&amp;ldquo;Method: &amp;quot; + method.getName() + &amp;ldquo;, Timeout: &amp;quot; + annotation.timeout());
}
}
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**é€‚ç”¨åœºæ™¯**ï¼šå•æ¬¡åˆå§‹åŒ–æ£€æŸ¥ã€ç®€å•é…ç½®è¯»å–[2,7](@ref)ã€‚
#### **AOP æ–¹å¼ï¼ˆæ¨èï¼‰**
ç»“åˆ Spring AOP å®ç°æ— ä¾µå…¥å¼é€»è¾‘å¢å¼ºï¼ˆå¦‚æ—¥å¿—ã€æƒé™æ§åˆ¶ï¼‰ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;@Aspect
@Component
public class LogAspect {
// æ‹¦æˆªå¸¦ @LogExecution æ³¨è§£çš„æ–¹æ³•
@Around(&amp;quot;@annotation(LogExecution)&amp;rdquo;)
public Object logExecutionTime(ProceedingJoinPoint joinPoint) throws Throwable {
long start = System.currentTimeMillis();
Object result = joinPoint.proceed(); // æ‰§è¡ŒåŸæ–¹æ³•
long duration = System.currentTimeMillis() - start;
System.out.println(&amp;ldquo;Method executed in: &amp;quot; + duration + &amp;ldquo;ms&amp;rdquo;);
return result;
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**å…³é”®é…ç½®**ï¼šåœ¨ Spring Boot ä¸­å¯ç”¨ AOP æ”¯æŒï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;@SpringBootApplication
@EnableAspectJAutoProxy // å¯ç”¨ AspectJ è‡ªåŠ¨ä»£ç†
public class Application { &amp;hellip; }&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[1,5](@ref)
------
### ğŸ¯ **å¸¸è§åº”ç”¨åœºæ™¯**
1. **æ—¥å¿—ä¸ç›‘æ§**
æ ‡è®°æ–¹æ³•å¹¶è‡ªåŠ¨è®°å½•æ‰§è¡Œæ—¶é—´æˆ–å‚æ•°ï¼ˆå¦‚ `@LogExecution`ï¼‰[4,8](@ref)ã€‚
2. **æƒé™æ§åˆ¶**
å®šä¹‰ `@RequiresRole(&amp;#34;ADMIN&amp;#34;)`ï¼Œé€šè¿‡ AOP åœ¨æ–¹æ³•æ‰§è¡Œå‰æ ¡éªŒç”¨æˆ·æƒé™[7,8](@ref)ã€‚
3. **æ•°æ®æ ¡éªŒ**
ç»“åˆ Hibernate Validator å®ç°è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£ï¼ˆå¦‚ `@ValidEmail`ï¼‰[6,8](@ref)ã€‚
4. **è‡ªåŠ¨å¡«å……å­—æ®µ**
æ ‡è®°å®ä½“ç±»å­—æ®µï¼Œåœ¨ä¿å­˜å‰è‡ªåŠ¨ç”Ÿæˆ ID æˆ–è®¾ç½®é»˜è®¤å€¼ï¼ˆå¦‚ `@AutoGenerateId`ï¼‰[5](@ref)ã€‚
5. **API æ–‡æ¡£ç”Ÿæˆ**
ä¸º Swagger æ‰©å±•è‡ªå®šä¹‰æ³¨è§£ï¼Œå¢å¼º API æè¿°ä¿¡æ¯[4](@ref)ã€‚
------
### âš ï¸ **æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ**
1.
æ€§èƒ½ä¼˜åŒ–
- é¿å…é¢‘ç¹åå°„ï¼šç¼“å­˜æ³¨è§£è§£æç»“æœï¼ˆå¦‚ä½¿ç”¨ `ConcurrentHashMap`ï¼‰ã€‚
- AOP åˆ‡ç‚¹ç²’åº¦ï¼šå°½é‡ç²¾ç¡®é™å®šæ‹¦æˆªèŒƒå›´ï¼ˆå¦‚ `@annotation(XXX)` ä¼˜äº `execution(*.*(..))`ï¼‰[7](@ref)ã€‚
2.
æ³¨è§£è®¾è®¡åŸåˆ™
- å•ä¸€èŒè´£ï¼šæ¯ä¸ªæ³¨è§£è§£å†³ä¸€ä¸ªé—®é¢˜ã€‚
- æ˜ç¡®é»˜è®¤å€¼ï¼šä¸ºå¯é€‰å‚æ•°æä¾›åˆç†çš„é»˜è®¤å€¼ï¼ˆå¦‚ `default &amp;#34;&amp;#34;`ï¼‰ã€‚
- å‘½åè§„èŒƒï¼šä½¿ç”¨åŠ¨è¯æˆ–åè¯çŸ­è¯­ï¼ˆå¦‚ `@Cacheable`ï¼‰[7](@ref)ã€‚
3.
é¿å…æ»¥ç”¨
- ä¼˜å…ˆä½¿ç”¨æ¡†æ¶å†…ç½®æ³¨è§£ï¼ˆå¦‚ Spring çš„ `@Transactional`ï¼‰ã€‚
- ä»…åœ¨éœ€è¦è§£è€¦é‡å¤é€»è¾‘æˆ–æ‰©å±•æ¡†æ¶æ—¶å¼•å…¥è‡ªå®šä¹‰æ³¨è§£[7](@ref)ã€‚
------
### ğŸ’¡ **å®æˆ˜ç¤ºä¾‹ï¼šå®ç°æƒé™æ§åˆ¶æ³¨è§£**
1. **å®šä¹‰æ³¨è§£**ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface RequiresRole {
String[] roles() default {&amp;ldquo;USER&amp;rdquo;};
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1. **AOP å¤„ç†å™¨**ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;@Aspect
@Component
public class SecurityAspect {
@Before(&amp;quot;@annotation(RequiresRole)&amp;rdquo;)
public void checkRole(JoinPoint joinPoint) {
RequiresRole annotation = ((MethodSignature) joinPoint.getSignature())
.getMethod().getAnnotation(RequiresRole.class);
String[] requiredRoles = annotation.roles();
// ä»ä¼šè¯ä¸­è·å–å½“å‰ç”¨æˆ·è§’è‰²å¹¶æ ¡éªŒ
if (!hasRequiredRole(currentUser, requiredRoles)) {
throw new AccessDeniedException(&amp;ldquo;Permission denied&amp;rdquo;);
}
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1. **ä½¿ç”¨æ³¨è§£**ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;@RestController
public class AdminController {
@RequiresRole(roles = {&amp;ldquo;ADMIN&amp;rdquo;})
@DeleteMapping(&amp;quot;/user/{id}&amp;rdquo;)
public void deleteUser(@PathVariable String id) { &amp;hellip; }
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[4,7](@ref)
------
### ğŸ“Œ **æ€»ç»“**
- **æ ¸å¿ƒæ­¥éª¤**ï¼šå®šä¹‰æ³¨è§£ â†’ é€‰æ‹©å¤„ç†æ–¹å¼ï¼ˆåå°„/AOPï¼‰â†’ åº”ç”¨æ³¨è§£ â†’ å®ç°åŠŸèƒ½é€»è¾‘ã€‚
- **é€‚ç”¨åœºæ™¯**ï¼šæ—¥å¿—ã€æƒé™ã€æ ¡éªŒã€è‡ªåŠ¨åŒ–é…ç½®ç­‰éœ€è§£è€¦é‡å¤ä»£ç çš„åœºæ™¯ã€‚
- **é¿å‘æŒ‡å—**ï¼šæ§åˆ¶æ³¨è§£ç²’åº¦ã€ä¼˜å…ˆé€‰æ‹©è¿è¡Œæ—¶æ³¨è§£ï¼ˆ`RUNTIME`ï¼‰ã€é¿å…è¿‡åº¦ä¾èµ–åå°„æ€§èƒ½ã€‚
é€šè¿‡åˆç†è®¾è®¡è‡ªå®šä¹‰æ³¨è§£ï¼Œå¯æ˜¾è‘—æå‡ä»£ç å¯ç»´æŠ¤æ€§å’Œæ¡†æ¶æ‰©å±•æ€§ã€‚å®é™…å¼€å‘ä¸­ï¼Œå»ºè®®ç»“åˆ Spring AOP å’Œåå°„æœºåˆ¶çµæ´»å®ç°éœ€æ±‚[1,3,7](@ref)ã€‚
## .class æ–‡ä»¶ &amp;amp; å¯¹è±¡
åœ¨Javaä¸­ï¼Œ**.classæ–‡ä»¶**å’Œ**Classå¯¹è±¡**åˆ†åˆ«ä»£è¡¨ç±»åœ¨ç£ç›˜å­˜å‚¨å’Œè¿è¡Œæ—¶å†…å­˜ä¸­çš„ä¸¤ç§å½¢æ€ï¼ŒäºŒè€…å…³ç³»ç´§å¯†ä½†è§’è‰²ä¸åŒã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒè¦ç‚¹è§£æï¼š
------
### ğŸ” æœ¬è´¨ä¸å®šä½
1. **`.class`æ–‡ä»¶**
- **é™æ€å­˜å‚¨**ï¼šæ˜¯Javaç¼–è¯‘å™¨ï¼ˆ`javac`ï¼‰å°†æºä»£ç ï¼ˆ`.java`æ–‡ä»¶ï¼‰ç¼–è¯‘åç”Ÿæˆçš„**äºŒè¿›åˆ¶æ–‡ä»¶**ï¼Œå­˜å‚¨åœ¨ç£ç›˜ä¸Š[6,7](@ref)ã€‚
- **å†…å®¹ç»“æ„**ï¼šéµå¾ªä¸¥æ ¼çš„æ ¼å¼ï¼ˆå¦‚é­”æ•° `0xCAFEBABE`ã€ç‰ˆæœ¬å·ã€å¸¸é‡æ± ã€å­—æ®µè¡¨ã€æ–¹æ³•è¡¨ç­‰ï¼‰ï¼Œæè¿°ç±»çš„æˆå‘˜å˜é‡ã€æ–¹æ³•ç­¾åã€ç»§æ‰¿å…³ç³»ç­‰å…ƒæ•°æ®ï¼Œä½†ä¸åŒ…å«è¿è¡Œæ—¶çš„å†…å­˜å¸ƒå±€ä¿¡æ¯[6,8](@ref)ã€‚
2. **Classå¯¹è±¡**
- **åŠ¨æ€è¿è¡Œæ—¶å¯¹è±¡**ï¼šæ˜¯JVMåœ¨**ç±»åŠ è½½é˜¶æ®µ**ï¼ˆé€šè¿‡ç±»åŠ è½½å™¨ï¼‰è§£æ`.class`æ–‡ä»¶åï¼Œåœ¨å †å†…å­˜ä¸­åˆ›å»ºçš„`java.lang.Class`ç±»çš„å®ä¾‹[1,2](@ref)ã€‚
- **åŠŸèƒ½**ï¼šä½œä¸ºç±»çš„è¿è¡Œæ—¶ç±»å‹è¡¨ç¤ºï¼ˆRTTIï¼‰ï¼Œå­˜å‚¨ç±»çš„å…ƒä¿¡æ¯ï¼ˆå¦‚æ„é€ æ–¹æ³•ã€å­—æ®µã€æ–¹æ³•ç­‰ï¼‰ï¼Œæ”¯æŒåå°„æ“ä½œï¼ˆå¦‚è·å–æ–¹æ³•ã€åˆ›å»ºå®ä¾‹ï¼‰[3,10](@ref)ã€‚
------
### ğŸ”„ å…³ç³»ï¼šä»æ–‡ä»¶åˆ°å¯¹è±¡çš„è½¬åŒ–è¿‡ç¨‹
1. **ç±»åŠ è½½è§¦å‘**
- å½“JVMé¦–æ¬¡ä½¿ç”¨ä¸€ä¸ªç±»ï¼ˆå¦‚`new`åˆ›å»ºå¯¹è±¡ã€è°ƒç”¨é™æ€æ–¹æ³•ï¼‰æ—¶ï¼Œç±»åŠ è½½å™¨ï¼ˆå¦‚`ClassLoader`ï¼‰æ ¹æ®å…¨é™å®šåæŸ¥æ‰¾å¹¶åŠ è½½`.class`æ–‡ä»¶[10,11](@ref)ã€‚
- è‹¥æœªåŠ è½½ï¼Œåˆ™é€šè¿‡`defineClass()`æ–¹æ³•è§£æ`.class`æ–‡ä»¶ï¼Œç”Ÿæˆå¯¹åº”çš„Classå¯¹è±¡[2,8](@ref)ã€‚
2. **å†…å­˜åˆ†é…ä¸åˆå§‹åŒ–**
- Classå¯¹è±¡åœ¨å †ä¸­åˆ›å»ºï¼ŒåŒ…å«æŒ‡å‘æ–¹æ³•åŒºç±»å…ƒæ•°æ®çš„æŒ‡é’ˆï¼ˆKlass Wordï¼‰[1,3](@ref)ã€‚
- ç±»åˆå§‹åŒ–é˜¶æ®µæ‰§è¡Œé™æ€ä»£ç å—ï¼ˆ`static{}`ï¼‰å’Œé™æ€å˜é‡èµ‹å€¼[10,11](@ref)ã€‚
3. **å®ä¾‹åŒ–ä¾èµ–**
- åˆ›å»ºç±»çš„å®ä¾‹å¯¹è±¡æ—¶ï¼ŒJVMä¾æ®Classå¯¹è±¡ä¸­çš„ä¿¡æ¯åˆ†é…å†…å­˜ã€åˆå§‹åŒ–å­—æ®µï¼Œå¹¶è°ƒç”¨æ„é€ æ–¹æ³•[10,11](@ref)ã€‚
- **å…³ç³»é“¾**ï¼š`.class`æ–‡ä»¶ â†’ Classå¯¹è±¡ â†’ å®ä¾‹å¯¹è±¡ï¼ˆå¦‚`new MyClass()`ï¼‰[1,3](@ref)ã€‚
------
### ğŸ“Š æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”
| **ç»´åº¦** | **`.class`æ–‡ä»¶** | **Classå¯¹è±¡** |
| ------------ | -------------------------------- | ----------------------------------- |
| **å­˜åœ¨å½¢å¼** | ç£ç›˜äºŒè¿›åˆ¶æ–‡ä»¶ | å †å†…å­˜ä¸­çš„`java.lang.Class`å®ä¾‹ |
| **ç”Ÿå‘½å‘¨æœŸ** | æŒä¹…å­˜å‚¨ï¼ˆç¼–è¯‘åå³å­˜åœ¨ï¼‰ | è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºï¼ˆç±»åŠ è½½æ—¶ç”Ÿæˆï¼‰ |
| **å†…å®¹** | ç±»ç»“æ„å…ƒæ•°æ®ï¼ˆå­—æ®µã€æ–¹æ³•ç­¾åç­‰ï¼‰ | è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼ˆæ”¯æŒåå°„æ“ä½œï¼‰ |
| **ç”Ÿæˆæ–¹å¼** | ç”±`javac`ç¼–è¯‘ç”Ÿæˆ | ç”±JVMç±»åŠ è½½å™¨è§£æ`.class`æ–‡ä»¶ååˆ›å»º |
| **å”¯ä¸€æ€§** | æ¯ä¸ªç±»å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ | æ¯ä¸ªç±»åœ¨JVMä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªClasså¯¹è±¡ |
------
### ğŸ’ æ€»ç»“ï¼šåä½œä¸ä¾èµ–
- **å•å‘ä¾èµ–**ï¼šClasså¯¹è±¡æ˜¯`.class`æ–‡ä»¶åœ¨JVMä¸­çš„è¿è¡Œæ—¶æ˜ å°„ï¼Œæ²¡æœ‰`.class`æ–‡ä»¶åˆ™æ— æ³•ç”ŸæˆClasså¯¹è±¡[2,8](@ref)ã€‚
- åŠŸèƒ½äº’è¡¥ï¼š
- `.class`æ–‡ä»¶æä¾›**é™æ€ç±»å®šä¹‰**ï¼Œç¡®ä¿è·¨å¹³å°ä¸€è‡´æ€§ï¼ˆâ€œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€ï¼‰[6,7](@ref)ã€‚
- Classå¯¹è±¡æä¾›**åŠ¨æ€è¿è¡Œæ—¶èƒ½åŠ›**ï¼Œæ”¯æ’‘åå°„ã€å®ä¾‹åˆ›å»ºã€å¤šæ€ç­‰ç‰¹æ€§[1,10](@ref)ã€‚
- **å®ä¾‹åŒ–æ¡¥æ¢**ï¼šé€šè¿‡`newInstance()`æˆ–æ„é€ æ–¹æ³•ï¼ŒClasså¯¹è±¡å°†ç±»æè¿°è½¬åŒ–ä¸ºå¯æ“ä½œçš„å†…å­˜å®ä¾‹[2,9](@ref)ã€‚
&amp;gt; ğŸ’ **ç®€å•æ¥è¯´**ï¼š`.class`æ–‡ä»¶æ˜¯ç±»çš„â€œè®¾è®¡å›¾çº¸â€ï¼ŒClasså¯¹è±¡æ˜¯JVMæŒ‰å›¾çº¸æ–½å·¥åç”Ÿæˆçš„â€œå·¥å‚æ¨¡å‹â€ï¼Œè€Œå®ä¾‹å¯¹è±¡åˆ™æ˜¯å·¥å‚ç”Ÿäº§çš„å…·ä½“â€œäº§å“â€ã€‚
## ClassPath &amp;amp; Qualified Name
ç±»è·¯å¾„ï¼ˆClasspathï¼‰å’Œç±»çš„å®Œå…¨é™å®šåï¼ˆFully Qualified Nameï¼‰æ˜¯Javaä¸­ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œåˆ†åˆ«ç”¨äº**å®šä½ç±»æ–‡ä»¶**å’Œ**å”¯ä¸€æ ‡è¯†ç±»**ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š
------
### ğŸ“ **ç±»è·¯å¾„ï¼ˆClasspathï¼‰**
#### **å®šä¹‰ä¸ä½œç”¨**
- **æœ¬è´¨**ï¼šClasspath æ˜¯ JVM ç”¨äºæŸ¥æ‰¾ç±»æ–‡ä»¶ï¼ˆ`.class`ï¼‰å’Œèµ„æºæ–‡ä»¶ï¼ˆå¦‚é…ç½®æ–‡ä»¶ã€JARåŒ…ï¼‰çš„è·¯å¾„é›†åˆ[1,2,4](@ref)ã€‚
- ä½œç”¨ï¼š
- æŒ‡å¯¼ JVM åœ¨ç¼–è¯‘æˆ–è¿è¡Œæ—¶åŠ è½½ç”¨æˆ·ç¨‹åºä¾èµ–çš„ç±»å’Œåº“ã€‚
- ç®¡ç†é¡¹ç›®å†…éƒ¨ç±»ä¸ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚é€šè¿‡ `lib/*.jar` å¼•å…¥å¤–éƒ¨ä¾èµ–ï¼‰[3,11](@ref)ã€‚
#### **é…ç½®æ–¹å¼**
| **æ–¹æ³•** | **ç¤ºä¾‹** | **é€‚ç”¨åœºæ™¯** |
| ------------------- | ------------------------------------------------------------ | --------------------------------------- |
| **ç¯å¢ƒå˜é‡** | Windows: `set CLASSPATH=.;C:\lib\*.jar` Linux: `export CLASSPATH=.:/lib/*.jar` | å…¨å±€é…ç½®ï¼Œå½±å“æ‰€æœ‰Javaç¨‹åº |
| **å‘½ä»¤è¡Œå‚æ•°** | `java -cp .;lib/*.jar MyClass` `javac -classpath .;lib/*.jar MyClass.java` | ä¸´æ—¶æŒ‡å®šï¼Œä¼˜å…ˆçº§é«˜äºç¯å¢ƒå˜é‡[2,4](@ref) |
| **IDEé…ç½®** | Eclipse: `Build Path &amp;gt; Libraries` IntelliJ: `Project Structure &amp;gt; Modules` | å¼€å‘é˜¶æ®µä¾èµ–ç®¡ç† |
| **MANIFEST.MFæ–‡ä»¶** | `Class-Path: lib/some-library.jar` | å¯æ‰§è¡ŒJARåŒ…çš„ä¾èµ–å£°æ˜[3](@ref) |
&amp;gt; **é»˜è®¤è¡Œä¸º**ï¼š
&amp;gt;
&amp;gt; - JDK 5.0+ è‡ªåŠ¨åŒ…å«**å½“å‰ç›®å½•ï¼ˆ`.`ï¼‰** å’Œ **`JDK_HOME/lib`** ä¸‹çš„JARæ–‡ä»¶ï¼ˆå¦‚ `rt.jar`ï¼‰[1,2](@ref)ã€‚
&amp;gt; - è‹¥æœªæ˜¾å¼é…ç½®ï¼ŒClasspath é»˜è®¤ä¸ºå½“å‰ç›®å½•ï¼ˆ`.`ï¼‰[4](@ref)ã€‚
#### **ç±»åŠ è½½é¡ºåºä¸å†²çª**
- æœç´¢é¡ºåºï¼šJVM æŒ‰ Classpath ä¸­è·¯å¾„çš„
å£°æ˜é¡ºåº
æŸ¥æ‰¾ç±»æ–‡ä»¶ï¼Œæ‰¾åˆ°å³åœæ­¢ï¼Œåç»­åŒåç±»è¢«å¿½ç•¥
9,11
ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;java -cp lib/A.jar:lib/B.jar Main # ä¼˜å…ˆåŠ è½½ A.jar ä¸­çš„ç±»&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- å†²çªè§£å†³ï¼š
- å¤šä¸ªJARåŒ…å«åŒåç±»æ—¶ï¼Œä¾èµ–è·¯å¾„é¡ºåºã€‚
- ä½¿ç”¨æ„å»ºå·¥å…·ï¼ˆå¦‚ Maven/Gradleï¼‰ç®¡ç†ä¾èµ–ç‰ˆæœ¬ï¼Œæˆ–é€šè¿‡ `&amp;lt;exclusions&amp;gt;` æ’é™¤å†²çªåŒ…[3,9](@ref)ã€‚
#### **ç±»åŠ è½½å™¨ä¸Classpathçš„å…³ç³»**
- åŒäº²å§”æ´¾æ¨¡å‹ï¼š
1. **Bootstrap ClassLoader**ï¼šåŠ è½½ `JRE_HOME/lib` æ ¸å¿ƒç±»ï¼ˆå¦‚ `rt.jar`ï¼‰ã€‚
2. **Extension ClassLoader**ï¼šåŠ è½½ `JRE_HOME/lib/ext` æ‰©å±•ç±»ã€‚
3. **Application ClassLoader**ï¼šåŠ è½½ Classpath ä¸­çš„ç”¨æˆ·ç±»[10,11](@ref)ã€‚
- è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼š
- Tomcat ä¸ºæ¯ä¸ª Web åº”ç”¨åˆ›å»ºç‹¬ç«‹çš„ `WebAppClassLoader`ï¼Œéš”ç¦»ä¸åŒåº”ç”¨çš„ Classpathï¼Œé¿å…å†²çª[5,10](@ref)ã€‚
------
### ğŸ”¤ **ç±»çš„å®Œå…¨é™å®šåï¼ˆFully Qualified Nameï¼‰**
#### **å®šä¹‰ä¸ç»“æ„**
- **æ ¼å¼**ï¼š`åŒ…å.ç±»å`ï¼ˆå¦‚ `java.lang.String`ï¼‰ï¼ŒåŒ…åä»¥ç‚¹å·åˆ†éš”å±‚çº§[7,8](@ref)ã€‚
- ä½œç”¨ï¼š
- **å”¯ä¸€æ ‡è¯†ç±»**ï¼šé¿å…ä¸åŒåŒ…ä¸‹åŒåç±»çš„å†²çªï¼ˆå¦‚ `com.util.Date` ä¸ `java.util.Date`ï¼‰ã€‚
- **ç²¾å‡†å®šä½ç±»**ï¼šåœ¨æºç ä¸­é€šè¿‡ `import` å¼•å…¥ï¼Œæˆ–åœ¨åå°„ä¸­é€šè¿‡ `Class.forName()` åŠ è½½[7,8](@ref)ã€‚
#### **Classæ–‡ä»¶ä¸­çš„è¡¨ç¤º**
- **è·¯å¾„è½¬æ¢**ï¼šæºç ä¸­çš„ `java.lang.Object` â†’ Classæ–‡ä»¶ä¸­çš„ `java/lang/Object.class`ï¼ˆç‚¹å·æ›¿æ¢ä¸ºæ–œæ ï¼‰[7](@ref)ã€‚
- æè¿°ç¬¦å¼•ç”¨ï¼š
- å­—æ®µç±»å‹ï¼š`Ljava/lang/Object;`ï¼ˆ`L` + å…¨é™å®šå + `;`ï¼‰ã€‚
- æ–¹æ³•ç­¾åï¼š`(ILjava/lang/String;)V`ï¼ˆå‚æ•°ç±»å‹ + è¿”å›å€¼ç±»å‹ï¼‰[7](@ref)ã€‚
------
### âš™ï¸ **Classpath ä¸å®Œå…¨é™å®šåçš„ååŒå·¥ä½œ**
1.
ç±»åŠ è½½æµç¨‹ï¼š
- JVM å°†å®Œå…¨é™å®šåè½¬æ¢ä¸ºæ–‡ä»¶è·¯å¾„ï¼ˆå¦‚ `com/example/MyClass.class`ï¼‰ã€‚
- æŒ‰ Classpath é¡ºåºæ‰«æç›®å½•æˆ–JARåŒ…ï¼Œå®šä½è¯¥è·¯å¾„çš„å­—èŠ‚ç æ–‡ä»¶[10,11](@ref)ã€‚
2.
èµ„æºåŠ è½½ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// ä»Classpathæ ¹ç›®å½•åŠ è½½èµ„æº
InputStream is = getClass().getResourceAsStream(&amp;quot;/config.properties&amp;quot;);&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;3.
åŠ¨æ€åŠ è½½åœºæ™¯ï¼š
- **çƒ­éƒ¨ç½²**ï¼šè‡ªå®šä¹‰ç±»åŠ è½½å™¨ç›‘å¬Classpathå˜åŒ–ï¼Œé‡æ–°åŠ è½½ä¿®æ”¹åçš„ç±»[10](@ref)ã€‚
------
### âš ï¸ **å¸¸è§é—®é¢˜ä¸æœ€ä½³å®è·µ**
| **é—®é¢˜** | **åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
| ------------------------ | ------------------------------ | --------------------------------------- |
| `ClassNotFoundException` | ClasspathæœªåŒ…å«ç›®æ ‡ç±» | æ£€æŸ¥è·¯å¾„æ˜¯å¦é—æ¼æˆ–æ‹¼å†™é”™è¯¯ |
| `NoClassDefFoundError` | ç¼–è¯‘æ—¶å­˜åœ¨ç±»ï¼Œä½†è¿è¡Œæ—¶ç¼ºå¤±ä¾èµ– | ç¡®ä¿æ‰€æœ‰ä¾èµ–JARåœ¨Classpathä¸­[3,9](@ref) |
| ç±»å†²çª | å¤šä¸ªJARåŒ…å«åŒåç±» | è°ƒæ•´Classpathé¡ºåºæˆ–æ’é™¤å†²çªä¾èµ– |
**æœ€ä½³å®è·µ**ï¼š
1. **é¿å…å…¨å±€CLASSPATH**ï¼šä¼˜å…ˆç”¨ `-cp` å‘½ä»¤è¡Œå‚æ•°ï¼Œé˜²æ­¢ç¯å¢ƒå˜é‡æ±¡æŸ“[4,11](@ref)ã€‚
2. **ä½¿ç”¨æ„å»ºå·¥å…·**ï¼šMaven/Gradle è‡ªåŠ¨ç®¡ç†ä¾èµ–å’ŒClasspath[3](@ref)ã€‚
3. èµ„æºè·¯å¾„è§„èŒƒï¼š
- é…ç½®æ–‡ä»¶æ”¾ `src/main/resources`ï¼Œç¼–è¯‘åå¹¶å…¥Classpathæ ¹ç›®å½•ã€‚
------
### ğŸ’ **æ€»ç»“**
- **Classpath**ï¼šJVMçš„â€œå¯¼èˆªåœ°å›¾â€ï¼Œå†³å®šç±»æ–‡ä»¶çš„æœç´¢èŒƒå›´ä¸é¡ºåºã€‚
- **å®Œå…¨é™å®šå**ï¼šç±»çš„â€œèº«ä»½è¯å·â€ï¼Œç¡®ä¿å…¨å±€å”¯ä¸€æ€§å¹¶æŒ‡å¯¼è·¯å¾„è½¬æ¢ã€‚
ä¸¤è€…ååŒæ„å»ºäº†Javaç±»åŠ è½½çš„æ ¸å¿ƒæœºåˆ¶ï¼šâ€‹**å®Œå…¨é™å®šåå®šä½ç±»èº«ä»½ â†’ Classpathå¯¼èˆªç±»ä½ç½® â†’ ç±»åŠ è½½å™¨åŠ è½½å­—èŠ‚ç **ã€‚æ·±å…¥ç†è§£å…¶åŸç†ï¼Œå¯æœ‰æ•ˆè§£å†³ä¾èµ–å†²çªã€èµ„æºåŠ è½½ç­‰å¼€å‘é—®é¢˜[1,7,10](@ref)ã€‚
## è·¯å¾„æ‰«æ
åœ¨JVMä¸­å®ç°è·¯å¾„æ‰«æï¼ˆå³åŠ¨æ€å‘ç°ç±»ã€èµ„æºæˆ–æ³¨è§£ï¼‰ä¸»è¦ä¾èµ–ç±»åŠ è½½æœºåˆ¶ã€åå°„APIåŠç¬¬ä¸‰æ–¹åº“ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒå®ç°æ–¹å¼åŠåŸç†ï¼š
------
### âš™ï¸ **åŸºäºåŸç”ŸAPIçš„æ‰«æï¼ˆClassLoader + åå°„ï¼‰**
#### **ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰çš„æ ¸å¿ƒä½œç”¨**
- **ç±»åŠ è½½å±‚æ¬¡**ï¼š
JVMé€šè¿‡å¤šçº§ç±»åŠ è½½å™¨ï¼ˆBootstrapâ†’Extensionâ†’Applicationâ†’Customï¼‰æŒ‰åŒäº²å§”æ´¾æ¨¡å‹åŠ è½½ç±»[2,3](@ref)ã€‚
- **Bootstrap**ï¼šåŠ è½½`JRE/lib`æ ¸å¿ƒç±»ï¼ˆå¦‚`java.*`ï¼‰ã€‚
- **Application**ï¼šåŠ è½½`classpath`ä¸­çš„ç”¨æˆ·ç±»ã€‚
- **Custom**ï¼šç”¨æˆ·è‡ªå®šä¹‰åŠ è½½å™¨ï¼ˆå¦‚æ‰«æç‰¹å®šç›®å½•ï¼‰[3](@ref)ã€‚
- **èµ„æºå®šä½æµç¨‹**ï¼š
è°ƒç”¨`ClassLoader.getResources(String path)`å¯è·å–ç±»è·¯å¾„ä¸‹èµ„æºçš„URLæšä¸¾ã€‚ä¾‹å¦‚æ‰«æåŒ…å†…æ‰€æœ‰ç±»ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Enumeration&lt;URL&gt; resources = classLoader.getResources(&amp;ldquo;com/example&amp;rdquo;);
while (resources.hasMoreElements()) {
URL url = resources.nextElement();
File dir = new File(url.getFile()); // è½¬æ¢ä¸ºæ–‡ä»¶è·¯å¾„
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;æ­¤æ–¹æ³•å°†åŒ…åè½¬ä¸ºè·¯å¾„æ ¼å¼ï¼ˆ`.`â†’`/`ï¼‰ï¼Œéå†ç±»è·¯å¾„åŒ¹é…çš„ç›®å½•æˆ–JARæ–‡ä»¶[6](@ref)ã€‚
#### **åå°„å®ç°ç±»åè§£æ**
è·å–èµ„æºè·¯å¾„åï¼Œéœ€è§£æå…¶ä¸­çš„`.class`æ–‡ä»¶ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;File[] files = dir.listFiles();
for (File file : files) {
if (file.getName().endsWith(&amp;quot;.class&amp;quot;)) {
String className = packageName + &amp;lsquo;.&amp;rsquo; + file.getName().replace(&amp;quot;.class&amp;quot;, &amp;ldquo;&amp;rdquo;);
Class&lt;?&gt; clazz = Class.forName(className); // åŠ è½½ç±»
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;**æ³¨æ„äº‹é¡¹**ï¼š
- éœ€å¤„ç†åµŒå¥—ç›®å½•ï¼ˆé€’å½’æ‰«æï¼‰[6](@ref)ã€‚
- ç›´æ¥åŠ è½½ç±»å¯èƒ½è§¦å‘é™æ€åˆå§‹åŒ–ï¼Œè‹¥ä»…éœ€å…ƒæ•°æ®å¯æ”¹ç”¨`ClassLoader.loadClass()`ï¼ˆä¸åˆå§‹åŒ–ï¼‰[6](@ref)ã€‚
------
### ğŸ“¦ **JARæ–‡ä»¶å†…çš„æ‰«æ**
å¯¹JARä¸­çš„ç±»æ‰«æéœ€ç‰¹æ®Šå¤„ç†ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;JarFile jarFile = new JarFile(&amp;ldquo;path/to/lib.jar&amp;rdquo;);
Enumeration&lt;JarEntry&gt; entries = jarFile.entries();
while (entries.hasMoreElements()) {
JarEntry entry = entries.nextElement();
if (entry.getName().startsWith(&amp;ldquo;com/example/&amp;rdquo;) &amp;amp;&amp;amp; entry.getName().endsWith(&amp;quot;.class&amp;quot;)) {
String className = entry.getName().replace(&amp;quot;/&amp;quot;, &amp;ldquo;.&amp;rdquo;).replace(&amp;quot;.class&amp;quot;, &amp;ldquo;&amp;rdquo;);
// è¿›ä¸€æ­¥åŠ è½½æˆ–è®°å½•ç±»å
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;æ­¤æ–¹æ³•ç›´æ¥éå†JARæ¡ç›®ï¼Œé¿å…è§£å‹æ–‡ä»¶[6](@ref)ã€‚
------
### âš¡ï¸ **ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ä¼˜åŒ–æ‰«æ**
åŸç”ŸAPIè¾ƒç¹çï¼Œæ¨èç¬¬ä¸‰æ–¹åº“ï¼š
#### **Reflectionsåº“**
- **é¢„å»ºç´¢å¼•**ï¼šæ‰«æç±»è·¯å¾„å¹¶ç¼“å­˜ç±»/æ³¨è§£å…ƒæ•°æ®ï¼Œåç»­æŸ¥è¯¢æå¿«[6](@ref)ã€‚
- ç¤ºä¾‹ä»£ç ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Reflections reflections = new Reflections(&amp;ldquo;com.example&amp;rdquo;, new SubTypesScanner());
Set&amp;lt;Class&lt;?&gt;&amp;gt; classes = reflections.getSubTypesOf(Object.class); // è·å–æ‰€æœ‰ç±»
Set&amp;lt;Class&lt;?&gt;&amp;gt; controllers = reflections.getTypesAnnotatedWith(RestController.class); // å¸¦æ³¨è§£çš„ç±»&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **ClassGraphåº“**
- **ä¼˜åŠ¿**ï¼šæ”¯æŒæ¨¡å—åŒ–ç³»ç»Ÿï¼ˆJPMSï¼‰ï¼Œæ‰«æé€Ÿåº¦æ›´å¿«ï¼ŒAPIæ›´ç®€æ´[6](@ref)ã€‚
- ç¤ºä¾‹ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;try (ScanResult scan = new ClassGraph().acceptPackages(&amp;ldquo;com.example&amp;rdquo;).scan()) {
List&lt;ClassInfo&gt; classes = scan.getAllClasses(); // æ‰€æœ‰ç±»ä¿¡æ¯
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### âš ï¸ **å…³é”®é—®é¢˜ä¸ä¼˜åŒ–ç­–ç•¥**
1. **æ€§èƒ½ç“¶é¢ˆ**
- **é¦–æ¬¡æ‰«ææ…¢**ï¼šå…¨é‡éå†ç±»è·¯å¾„ï¼ˆå°¤å…¶å¤§å‹é¡¹ç›®ï¼‰ã€‚
- ä¼˜åŒ–æ–¹æ¡ˆï¼š
- ä½¿ç”¨Reflectionsçš„ç¼“å­˜æœºåˆ¶[6](@ref)ã€‚
- é™å®šæ‰«æèŒƒå›´ï¼ˆå¦‚ç²¾ç¡®åŒ…è·¯å¾„ï¼‰[6](@ref)ã€‚
2. **å®‰å…¨ä¸å…¼å®¹æ€§**
- **æ¨¡å—åŒ–é™åˆ¶**ï¼šJava 9+éœ€åœ¨`module-info`ä¸­å¼€æ”¾åŒ…ï¼ˆ`opens package`ï¼‰[6](@ref)ã€‚
- **ç±»åˆå§‹åŒ–é£é™©**ï¼šé¿å…æ‰«ææœŸè§¦å‘é™æ€ä»£ç å—ï¼ˆç”¨`ClassLoader.loadClass()`æ›¿ä»£`Class.forName()`ï¼‰[6](@ref)ã€‚
3. **éƒ¨ç½²ç¯å¢ƒå·®å¼‚**
- IDEä¸­`classpath`åŒ…å«æºç ç›®å½•ï¼Œè€Œç”Ÿäº§ç¯å¢ƒåªæœ‰ç¼–è¯‘åçš„JARï¼Œéœ€æµ‹è¯•å¤šç¯å¢ƒå…¼å®¹æ€§[6](@ref)ã€‚
------
### ğŸ” **æŠ€æœ¯é€‰å‹å¯¹æ¯”**
| **æ–¹æ³•** | **é€‚ç”¨åœºæ™¯** | **æ€§èƒ½** | **å¤æ‚åº¦** |
| -------------------------- | ---------------------- | ---------------- | ---------- |
| **åŸç”ŸClassLoader** | ç®€å•éœ€æ±‚ã€æ— ç¬¬ä¸‰æ–¹ä¾èµ– | ä½ï¼ˆéœ€æ‰‹åŠ¨éå†ï¼‰ | é«˜ |
| **Reflections/ClassGraph** | æ¡†æ¶å¼€å‘ã€é¢‘ç¹æ‰«æ | é«˜ï¼ˆç´¢å¼•ç¼“å­˜ï¼‰ | ä½ |
| **JARç›´æ¥è§£æ** | æ‰«æå¤–éƒ¨ä¾èµ–åº“ | ä¸­ | ä¸­ |
&amp;gt; ğŸ’¡ **å»ºè®®**ï¼š
&amp;gt;
&amp;gt; - å°å‹å·¥å…· â†’ åŸç”ŸAPIï¼ˆè½»é‡ï¼‰[6](@ref)ã€‚
&amp;gt; - ä¼ä¸šçº§æ¡†æ¶ â†’ Reflections/ClassGraphï¼ˆé«˜æ•ˆç¨³å®šï¼‰[6](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“**
JVMè·¯å¾„æ‰«æçš„æœ¬è´¨æ˜¯**åˆ©ç”¨ç±»åŠ è½½å™¨å®šä½èµ„æº+åå°„è§£æå…ƒæ•°æ®**ã€‚ä¼˜åŒ–æ–¹å‘åŒ…æ‹¬ï¼š
1. é€šè¿‡**åŒäº²å§”æ´¾æ¨¡å‹**æ§åˆ¶åŠ è½½èŒƒå›´[2,3](@ref)ï¼›
2. ç»“åˆ**ç¼“å­˜æœºåˆ¶**ï¼ˆå¦‚Reflectionsï¼‰å‡å°‘IOå¼€é”€[6](@ref)ï¼›
3. é€‚é…**æ¨¡å—åŒ–ä¸å®‰å…¨ç­–ç•¥**é¿å…è¿è¡Œæ—¶å¼‚å¸¸ã€‚
æ·±å…¥ç†è§£ç±»åŠ è½½æµç¨‹ï¼Œèƒ½é«˜æ•ˆå®ç°æ’ä»¶åŒ–ã€æ³¨è§£é©±åŠ¨ç­‰åŠ¨æ€æ¶æ„[3,6](@ref)ã€‚
## TypeElement
`TypeElement` æ˜¯ Java ç¼–è¯‘å™¨ APIï¼ˆ`javax.lang.model.element` åŒ…ï¼‰ä¸­çš„æ ¸å¿ƒæ¥å£ï¼Œç”¨äºè¡¨ç¤º Java ç¨‹åºä¸­çš„**ç±»ã€æ¥å£ã€æšä¸¾æˆ–æ³¨è§£ç±»å‹**ç­‰é¡¶å±‚ç»“æ„å…ƒç´ ã€‚å®ƒåœ¨ç¼–è¯‘æœŸæ³¨è§£å¤„ç†å™¨ï¼ˆAnnotation Processorï¼‰ä¸­æ‰®æ¼”é‡è¦è§’è‰²ï¼Œç”¨äºè·å–å’Œå¤„ç†ç±»å‹çº§åˆ«çš„å…ƒæ•°æ®ã€‚ä»¥ä¸‹ä»å®šä¹‰ã€åŠŸèƒ½ã€åº”ç”¨åœºæ™¯åŠç¤ºä¾‹å±•å¼€è¯¦è§£ï¼š
------
### ğŸ·ï¸ **å®šä¹‰ä¸æ ¸å¿ƒç‰¹å¾**
1. **æœ¬è´¨**
`TypeElement` æ˜¯ `Element` æ¥å£çš„å­ç±»ï¼Œä»£è¡¨ Java æºç ä¸­çš„**ç±»å‹å£°æ˜**â€‹ï¼ˆType Declarationï¼‰ï¼ŒåŒ…æ‹¬ï¼š
- ç±»ï¼ˆ`class`ï¼‰
- æ¥å£ï¼ˆ`interface`ï¼‰
- æšä¸¾ï¼ˆ`enum`ï¼‰
- æ³¨è§£ç±»å‹ï¼ˆ`@interface`ï¼‰[3,6,8](@ref)ã€‚
2. **ç¼–è¯‘æœŸå¯è§æ€§**
- ä»…åœ¨ç¼–è¯‘é˜¶æ®µï¼ˆé€šè¿‡æ³¨è§£å¤„ç†å™¨ï¼‰å¯è®¿é—®ï¼Œ**ä¸åŒ…å«è¿è¡Œæ—¶ä¿¡æ¯**ã€‚
- ä¸ `TypeMirror`ï¼ˆç±»å‹é•œåƒï¼‰å…³è”ï¼š`TypeElement#asType()` è¿”å›è¯¥ç±»å‹çš„ `TypeMirror`ï¼Œç”¨äºè·å–æ³›å‹ã€çˆ¶ç±»ç­‰æ·±å±‚ç±»å‹ä¿¡æ¯[3,8](@ref)ã€‚
------
### ğŸ“š **åœ¨å…ƒç´ ä½“ç³»ï¼ˆElement Hierarchyï¼‰ä¸­çš„ä½ç½®**
Java ç¼–è¯‘å™¨å°†æºç ç»“æ„åŒ–ä¸º `Element` æ ‘ï¼Œ`TypeElement` æ˜¯å…¶ä¸­å…³é”®èŠ‚ç‚¹ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;graph TD
Element &amp;ndash;&amp;gt; PackageElement[åŒ…å…ƒç´ ]
Element &amp;ndash;&amp;gt; TypeElement[ç±»å‹å…ƒç´ ]
Element &amp;ndash;&amp;gt; VariableElement[å˜é‡å…ƒç´ ]
Element &amp;ndash;&amp;gt; ExecutableElement[å¯æ‰§è¡Œå…ƒç´ ]
TypeElement &amp;ndash;&amp;gt; ç±»/æ¥å£/æšä¸¾/æ³¨è§£&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- çˆ¶å­å…³ç³»ï¼š
- çˆ¶çº§ï¼š`PackageElement`ï¼ˆåŒ…ï¼‰
- å­çº§ï¼š`VariableElement`ï¼ˆå­—æ®µï¼‰ã€`ExecutableElement`ï¼ˆæ–¹æ³•/æ„é€ å™¨ï¼‰[3,8](@ref)ã€‚
------
### âš™ï¸ **æ ¸å¿ƒåŠŸèƒ½ä¸æ–¹æ³•**
`TypeElement` æä¾›çš„æ–¹æ³•ç”¨äºæå–ç±»å‹å…ƒæ•°æ®ï¼š
1. **è·å–æ ‡è¯†ä¿¡æ¯**
- `getSimpleName()`ï¼šç®€å•åç§°ï¼ˆå¦‚ `&amp;#34;String&amp;#34;`ï¼‰ã€‚
- `getQualifiedName()`ï¼šå…¨é™å®šåï¼ˆå¦‚ `&amp;#34;java.lang.String&amp;#34;`ï¼‰[3,8](@ref)ã€‚
2. **ç»“æ„åˆ†æ**
- `getEnclosedElements()`ï¼šè¿”å›è¯¥ç±»å‹çš„æ‰€æœ‰å­å…ƒç´ ï¼ˆå­—æ®µã€æ–¹æ³•ç­‰ï¼‰ã€‚
- `getTypeParameters()`ï¼šè·å–æ³›å‹å‚æ•°ï¼ˆå¦‚ `List&amp;lt;T&amp;gt;` ä¸­çš„ `T`ï¼‰[3,8](@ref)ã€‚
3. **ä¿®é¥°ç¬¦ä¸æ³¨è§£**
- `getModifiers()`ï¼šè¿”å› `public`ã€`abstract` ç­‰ä¿®é¥°ç¬¦ã€‚
- `getAnnotationMirrors()`ï¼šè·å–ç±»å‹ä¸Šçš„æ³¨è§£ï¼ˆå¦‚ `@Deprecated`ï¼‰[7,8](@ref)ã€‚
------
### ğŸ” **åº”ç”¨åœºæ™¯**
#### **æ³¨è§£å¤„ç†å™¨ï¼ˆAnnotation Processorï¼‰**
- **ä»£ç ç”Ÿæˆ**ï¼šæ‰«æè¢«æ³¨è§£çš„ç±»ï¼Œç”Ÿæˆæ–°ä»£ç ï¼ˆå¦‚ Lombok ç”Ÿæˆ Getterï¼‰ã€‚
- **ç¼–è¯‘æ—¶æ ¡éªŒ**ï¼šæ£€æŸ¥æ³¨è§£ä½¿ç”¨æ˜¯å¦åˆæ³•ï¼ˆå¦‚ `@NonNull` å­—æ®µæ˜¯å¦è¢«åˆå§‹åŒ–ï¼‰[3,7](@ref)ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// ç¤ºä¾‹ï¼šè·å–è¢«ç‰¹å®šæ³¨è§£æ ‡è®°çš„ TypeElement
Set&amp;lt;? extends Element&amp;gt; elements = roundEnv.getElementsAnnotatedWith(MyAnnotation.class);
for (Element e : elements) {
if (e.getKind() == ElementKind.CLASS) { // åˆ¤æ–­æ˜¯å¦ä¸ºç±»
TypeElement typeElement = (TypeElement) e;
// å¤„ç†ç±»ä¿¡æ¯&amp;hellip;
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **æ¡†æ¶é›†æˆ**
- **è·¯ç”±æ¡†æ¶**ï¼šæ‰«æå¸¦ `@Controller` æ³¨è§£çš„ç±»ï¼Œæ³¨å†Œè·¯ç”±è¡¨ã€‚
- **DI å®¹å™¨**ï¼šè¯†åˆ« `@Component` ç±»ï¼Œç”Ÿæˆä¾èµ–æ³¨å…¥ä»£ç [1,7](@ref)ã€‚
#### **å…ƒç¼–ç¨‹ï¼ˆMetaprogrammingï¼‰**
- åŠ¨æ€ç”Ÿæˆç±»ç»“æ„ï¼ˆå¦‚ä½¿ç”¨ JavaPoet åŸºäº `TypeElement` ä¿¡æ¯åˆ›å»ºæ–°ç±»ï¼‰[8](@ref)ã€‚
------
### ğŸ†š **ä¸å…¶ä»–å…ƒç´ çš„åŒºåˆ«**
| **å…ƒç´ ç±»å‹** | **ä»£è¡¨å†…å®¹** | **ç¤ºä¾‹** |
| ------------------- | ---------------------- | -------------------------- |
| `TypeElement` | ç±»/æ¥å£/æšä¸¾/æ³¨è§£ | `public class User {}` |
| `VariableElement` | å­—æ®µ/æšä¸¾å¸¸é‡/å±€éƒ¨å˜é‡ | `private String name;` |
| `ExecutableElement` | æ–¹æ³•/æ„é€ å™¨ | `public void save() {...}` |
| `PackageElement` | åŒ…å£°æ˜ | `package com.example;` |
&amp;gt; ğŸ’¡ **å…³é”®åŒºåˆ«**ï¼š
&amp;gt;
&amp;gt; - `TypeElement` æè¿°**ç±»å‹æœ¬èº«**ï¼Œè€Œ `VariableElement`/`ExecutableElement` æè¿°å…¶æˆå‘˜ã€‚
&amp;gt; - `TypeMirror` å…³æ³¨**ç±»å‹ç­¾å**ï¼ˆå¦‚ `List&amp;lt;String&amp;gt;`ï¼‰ï¼Œ`TypeElement` å…³æ³¨**å£°æ˜ç»“æ„**[3,8](@ref)ã€‚
------
### âš ï¸ **ä½¿ç”¨æ³¨æ„äº‹é¡¹**
1. **ç¼–è¯‘æœŸå±€é™æ€§**
`TypeElement` æ— æ³•è·å–è¿è¡Œæ—¶ä¿¡æ¯ï¼ˆå¦‚çˆ¶ç±»å®ä¾‹ï¼‰ï¼Œéœ€é€šè¿‡ `TypeMirror` è§£ææ³›å‹ç­‰ç±»å‹ç»†èŠ‚[8](@ref)ã€‚
2. **ç±»å‹åˆ¤æ–­**
ä½¿ç”¨ `ElementKind` åŒºåˆ†å…·ä½“ç±»å‹ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;if (typeElement.getKind() == ElementKind.INTERFACE) {
// å¤„ç†æ¥å£
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;3. **åµŒå¥—ç±»å¤„ç†**
åµŒå¥—ç±»ï¼ˆå¦‚ `Outer.Inner`ï¼‰è§†ä¸ºå¤–å±‚ `TypeElement` çš„å­å…ƒç´ ï¼Œéœ€é€’å½’è§£æ[8](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“**
`TypeElement` æ˜¯ Java ç¼–è¯‘æ—¶ç±»å‹æ¨¡å‹çš„**æ ¸å¿ƒæŠ½è±¡**ï¼Œä¸ºæ³¨è§£å¤„ç†å™¨æä¾›ç±»å‹å£°æ˜çº§åˆ«çš„å…ƒæ•°æ®è®¿é—®èƒ½åŠ›ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š
- **ç»“æ„åŒ–æºç è§£æ**ï¼šå°† Java ç±»å‹æ˜ å°„ä¸ºå¯ç¼–ç¨‹å¯¹è±¡ã€‚
- **è‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆ**ï¼šæ”¯æ’‘ Lombokã€Dagger ç­‰æ¡†æ¶çš„ç¼–è¯‘æ—¶ä»£ç ç”Ÿæˆã€‚
- **é™æ€æ ¡éªŒåŸºç¡€**ï¼šç¡®ä¿æ³¨è§£ä½¿ç”¨çš„æ­£ç¡®æ€§ï¼Œæå‡ä»£ç å¥å£®æ€§ã€‚
&amp;gt; ğŸ“š **æ·±å…¥å­¦ä¹ **ï¼š
&amp;gt;
&amp;gt; - å®˜æ–¹æ–‡æ¡£ï¼š[`javax.lang.model.element.TypeElement`](https://docs.oracle.com/javase/8/docs/api/javax/lang/model/element/TypeElement.html)
&amp;gt; - å®è·µç¤ºä¾‹ï¼š[æ³¨è§£å¤„ç†å™¨å¼€å‘æŒ‡å—](https://blog.csdn.net/aa642531/article/details/80219214)[3,8](@ref)ã€‚
## javac
javacï¼ˆJava Compilerï¼‰æ˜¯Javaå¼€å‘å·¥å…·åŒ…ï¼ˆJDKï¼‰ä¸­çš„æ ¸å¿ƒç¼–è¯‘å™¨ï¼Œè´Ÿè´£å°†Javaæºä»£ç ï¼ˆ`.java`æ–‡ä»¶ï¼‰ç¼–è¯‘æˆJVMå¯æ‰§è¡Œçš„å­—èŠ‚ç æ–‡ä»¶ï¼ˆ`.class`æ–‡ä»¶ï¼‰ã€‚å…¶è®¾è®¡ä½“ç°äº†Javaâ€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œâ€çš„è·¨å¹³å°ç†å¿µã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŠŸèƒ½ã€ç¼–è¯‘æµç¨‹ã€å…³é”®é€‰é¡¹åŠå®é™…åº”ç”¨å±•å¼€è¯¦ç»†ä»‹ç»ï¼š
------
### âš™ï¸ **æ ¸å¿ƒåŠŸèƒ½ä¸ä½œç”¨**
1. **æºä»£ç ç¼–è¯‘**
- å°†Javaæºæ–‡ä»¶ï¼ˆ`.java`ï¼‰è½¬æ¢ä¸ºå¹³å°æ— å…³çš„å­—èŠ‚ç æ–‡ä»¶ï¼ˆ`.class`ï¼‰ï¼Œä¾›JVMæ‰§è¡Œ[2,3,5](@ref)ã€‚
- æ”¯æŒå¤šæ–‡ä»¶ç¼–è¯‘ï¼ˆå¦‚`javac Main.java Helper.java`ï¼‰æˆ–é€šè¿‡æ–‡ä»¶åˆ—è¡¨æ‰¹é‡ç¼–è¯‘ï¼ˆ`javac @sourcefiles`ï¼‰[1,11](@ref)ã€‚
2. **è¯­æ³•ä¸è¯­ä¹‰æ£€æŸ¥**
- **ç¼–è¯‘æ—¶é”™è¯¯æ£€æµ‹**ï¼šæ£€æŸ¥è¯­æ³•é”™è¯¯ï¼ˆå¦‚ç¼ºå°‘åˆ†å·ã€æ‹¬å·ä¸åŒ¹é…ï¼‰ã€ç±»å‹ä¸åŒ¹é…ã€æœªå£°æ˜å˜é‡ç­‰ï¼Œå¹¶è¾“å‡ºè¯¦ç»†é”™è¯¯ä½ç½®[5,10](@ref)ã€‚
- **è¯­ä¹‰åˆ†æ**ï¼šéªŒè¯å˜é‡ä½œç”¨åŸŸã€æ–¹æ³•é‡è½½/é‡å†™çš„åˆæ³•æ€§ï¼Œç¡®ä¿ä»£ç ç¬¦åˆJavaè¯­è¨€è§„èŒƒ[6,8](@ref)ã€‚
3. **å¤šç‰ˆæœ¬å…¼å®¹æ€§**
- é€šè¿‡`-source`å’Œ`-target`é€‰é¡¹æŒ‡å®šæºç ç‰ˆæœ¬å’Œå­—èŠ‚ç ç›®æ ‡ç‰ˆæœ¬ï¼ˆå¦‚`javac -source 8 -target 8 App.java`ï¼‰ï¼Œç¡®ä¿å‘åå…¼å®¹[3,9,10](@ref)ã€‚
4. **æ³¨è§£å¤„ç†**
- æ”¯æŒç¼–è¯‘æ—¶æ³¨è§£å¤„ç†ï¼ˆAnnotation Processingï¼‰ï¼Œå¦‚Lomboké€šè¿‡æ³¨è§£ç”Ÿæˆä»£ç ï¼Œé¿å…è¿è¡Œæ—¶åå°„å¼€é”€[6,9](@ref)ã€‚
5. **è°ƒè¯•ä¿¡æ¯ç”Ÿæˆ**
- é€šè¿‡
```
-g
```
é€‰é¡¹æ§åˆ¶è°ƒè¯•ä¿¡æ¯ç”Ÿæˆï¼š
- `-g:lines`ï¼šç”Ÿæˆè¡Œå·ä¿¡æ¯ï¼ˆæ”¯æŒæ–­ç‚¹è°ƒè¯•ï¼‰ã€‚
- `-g:vars`ï¼šç”Ÿæˆå±€éƒ¨å˜é‡ä¿¡æ¯ï¼ˆè°ƒè¯•æ—¶æŸ¥çœ‹å˜é‡å€¼ï¼‰ã€‚
- `-g:source`ï¼šå…³è”æºæ–‡ä»¶ï¼ˆæ”¯æŒè·¨æ–‡ä»¶æºç æŸ¥çœ‹ï¼‰[9,10](@ref)ã€‚
------
### ğŸ”„ **ç¼–è¯‘æµç¨‹è¯¦è§£**
javacçš„ç¼–è¯‘è¿‡ç¨‹åˆ†ä¸ºä¸ƒä¸ªé˜¶æ®µï¼Œå±äºç¼–è¯‘åŸç†ä¸­çš„â€œå‰ç«¯ç¼–è¯‘â€ï¼ˆä¸æ¶‰åŠç¡¬ä»¶ç›¸å…³çš„ä»£ç ä¼˜åŒ–ï¼‰[6,8](@ref)ï¼š
| **é˜¶æ®µ** | **ä½œç”¨** | **å…³é”®ç»„ä»¶** |
| -------------- | ------------------------------------------------------------ | ---------------------------- |
| **è¯æ³•åˆ†æ** | å°†æºä»£ç æ‹†åˆ†ä¸ºTokenï¼ˆå¦‚å…³é”®å­—ã€æ ‡è¯†ç¬¦ï¼‰ | `Scanner`ç±» |
| **è¯­æ³•åˆ†æ** | æ„å»ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œæè¿°ä»£ç ç»“æ„ | é€’å½’ä¸‹é™è§£æå™¨ |
| **ç¬¦å·è¡¨å¡«å……** | è§£æç±»/æ–¹æ³•/å˜é‡å®šä¹‰ï¼Œå¡«å……ç¬¦å·è¡¨ï¼ˆSymbol Tableï¼‰ | `Enter`å’Œ`MemberEnter`ç±» |
| **æ³¨è§£å¤„ç†** | è°ƒç”¨æ³¨è§£å¤„ç†å™¨ï¼ˆå¦‚Lombokï¼‰ï¼Œç”Ÿæˆæ–°ä»£ç æˆ–ä¿®æ”¹AST | `JavacProcessingEnvironment` |
| **è¯­ä¹‰åˆ†æ** | ç±»å‹æ£€æŸ¥ã€å¸¸é‡æŠ˜å ï¼ˆå¦‚`int a = 1+2`ä¼˜åŒ–ä¸º`3`ï¼‰ã€æ–¹æ³•åˆæ³•æ€§éªŒè¯ | `Check`å’Œ`Resolve`ç±» |
| **æ•°æ®æµåˆ†æ** | æ£€æŸ¥å˜é‡åˆå§‹åŒ–ã€è¿”å›å€¼ã€ä¸å¯è¾¾ä»£ç ç­‰é€»è¾‘é”™è¯¯ | `Flow`ç±» |
| **è§£ç³–ä¸ç”Ÿæˆ** | å»é™¤è¯­æ³•ç³–ï¼ˆå¦‚`for-each`è½¬ä¸ºè¿­ä»£å™¨ï¼‰ã€ç”Ÿæˆå­—èŠ‚ç æŒ‡ä»¤ | `Desugar`å’Œ`ClassWriter` |
&amp;gt; ğŸ’¡ **ç¤ºä¾‹**ï¼š`String s = &amp;#34;a&amp;#34; + 1;`åœ¨è§£ç³–é˜¶æ®µä¼˜åŒ–ä¸º`String s = &amp;#34;a1&amp;#34;;`[6](@ref)ã€‚
------
### âš¡ **å¸¸ç”¨å‘½ä»¤é€‰é¡¹ä¸ç¤ºä¾‹**
#### **æ ¸å¿ƒé€‰é¡¹é€ŸæŸ¥**
| **é€‰é¡¹** | **ä½œç”¨** | **ç¤ºä¾‹** |
| ------------------ | ---------------------------------------- | ---------------------------------- |
| `-d &amp;lt;ç›®å½•&amp;gt;` | æŒ‡å®š.classæ–‡ä»¶è¾“å‡ºç›®å½• | `javac -d bin src/Main.java` |
| `-cp &amp;lt;è·¯å¾„&amp;gt;` | è®¾ç½®ç±»è·¯å¾„ï¼ˆæŸ¥æ‰¾ä¾èµ–ç±»ï¼‰ | `javac -cp lib/*.jar App.java` |
| `-encoding &amp;lt;ç¼–ç &amp;gt;` | æŒ‡å®šæºæ–‡ä»¶ç¼–ç ï¼ˆå¦‚UTF-8ï¼‰ | `javac -encoding UTF-8 Hello.java` |
| `-nowarn` | ç¦ç”¨è­¦å‘Šä¿¡æ¯ | `javac -nowarn Demo.java` |
| `-verbose` | è¾“å‡ºç¼–è¯‘è¯¦ç»†è¿‡ç¨‹ï¼ˆåŠ è½½çš„ç±»ã€ç¼–è¯‘çš„æ–‡ä»¶ï¼‰ | `javac -verbose Test.java` |
#### **å…¸å‹åœºæ™¯ç¤ºä¾‹**
1. **ç¼–è¯‘å¤šæ–‡ä»¶å¹¶æŒ‡å®šè¾“å‡ºç›®å½•**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;javac -d ./out Main.java Helper.java # è¾“å‡ºåˆ°outç›®å½•&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;2. **è·¨ç‰ˆæœ¬ç¼–è¯‘ï¼ˆJava 8å…¼å®¹ï¼‰**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;javac -source 8 -target 8 -d bin OldSystemApp.java # ç¡®ä¿åœ¨æ—§JVMè¿è¡Œ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;3. **æ³¨è§£å¤„ç†å™¨é›†æˆ**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;javac -processor CustomProcessor -procpath ./processor.jar User.java # è‡ªå®šä¹‰æ³¨è§£å¤„ç†&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### âš–ï¸ **javacä¸javaå‘½ä»¤çš„å…³ç³»**
| **ç»´åº¦** | **javac** | **java** |
| ------------ | ----------------------------- | ---------------------------------- |
| **åŠŸèƒ½** | ç¼–è¯‘æºä»£ç  â†’ ç”Ÿæˆ`.class`æ–‡ä»¶ | åŠ è½½`.class`æ–‡ä»¶ â†’ å¯åŠ¨JVMæ‰§è¡Œç¨‹åº |
| **è¾“å…¥** | `.java`æºæ–‡ä»¶ | ä¸»ç±»åï¼ˆä¸å«æ‰©å±•åï¼‰æˆ–JARåŒ… |
| **è¾“å‡º** | `.class`å­—èŠ‚ç æ–‡ä»¶ | ç¨‹åºè¿è¡Œç»“æœï¼ˆæ§åˆ¶å°è¾“å‡º/æ–‡ä»¶ç­‰ï¼‰ |
| **ä¾èµ–** | éœ€JDKï¼ˆå¼€å‘ç¯å¢ƒï¼‰ | åªéœ€JREï¼ˆè¿è¡Œç¯å¢ƒï¼‰ |
| **å…¸å‹å‘½ä»¤** | `javac -d bin Hello.java` | `java -cp bin Hello` |
&amp;gt; ğŸ“Œ **å…³é”®ç‚¹**ï¼šjavacæ˜¯**ç¼–è¯‘æ—¶å·¥å…·**ï¼Œjavaæ˜¯**è¿è¡Œæ—¶å·¥å…·**ï¼Œä¸¤è€…åä½œå®ŒæˆJavaç¨‹åºçš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ[3,4,8](@ref)ã€‚
------
### ğŸ› ï¸ **å®é™…åº”ç”¨æŠ€å·§ä¸é—®é¢˜å¤„ç†**
1. **ç¼–ç é—®é¢˜å¤„ç†**
- Windowsä¸‹UTF-8æºæ–‡ä»¶ç¼–è¯‘æŠ¥é”™æ—¶ï¼Œéœ€æ˜¾å¼æŒ‡å®šç¼–ç ï¼š
```
javac -encoding UTF-8 HelloWorld.java # é¿å…&amp;#34;éæ³•å­—ç¬¦&amp;#34;é”™è¯¯[3,10](@ref)
```
2. **éšå¼ç¼–è¯‘æ§åˆ¶**
- é»˜è®¤è‡ªåŠ¨ç¼–è¯‘ä¾èµ–ç±»ï¼ˆå¦‚A.javaå¼•ç”¨B.javaåˆ™ç¼–è¯‘Bï¼‰ï¼Œå¯é€šè¿‡`-implicit:none`ç¦ç”¨[9](@ref)ã€‚
3. **è°ƒè¯•ä¿¡æ¯ä¼˜åŒ–**
- ç”Ÿäº§ç¯å¢ƒå¯å…³é—­è°ƒè¯•ä¿¡æ¯å‡å°ä½“ç§¯ï¼š`javac -g:none Service.java`[9](@ref)ã€‚
4. **å¤§å‹é¡¹ç›®ç¼–è¯‘**
- ä½¿ç”¨æ–‡ä»¶åˆ—è¡¨é¿å…å‘½ä»¤è¡Œè¿‡é•¿ï¼š
```
echo Main.java Helper.java &amp;gt; sources.txt
javac @sources.txt # ä»æ–‡ä»¶è¯»å–æºæ–‡ä»¶åˆ—è¡¨[1,11](@ref)
```
------
### ğŸ’ **æ€»ç»“**
javacä½œä¸ºJavaç”Ÿæ€çš„åŸºçŸ³ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š
- **è·¨å¹³å°æ€§**ï¼šç”ŸæˆJVMç»Ÿä¸€çš„å­—èŠ‚ç ï¼Œå®ç°â€œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€[2,5](@ref)ã€‚
- **é™æ€å®‰å…¨ä¿éšœ**ï¼šç¼–è¯‘æ—¶ä¸¥æ ¼æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯[5](@ref)ã€‚
- **å·¥å…·é“¾é›†æˆ**ï¼šä¸IDEï¼ˆå¦‚IntelliJï¼‰ã€æ„å»ºå·¥å…·ï¼ˆå¦‚Mavenï¼‰æ— ç¼åä½œï¼Œæå‡å¼€å‘æ•ˆç‡[5,9](@ref)ã€‚
&amp;gt; âš ï¸ **æ³¨æ„**ï¼šjavacä»…å®Œæˆå‰ç«¯ç¼–è¯‘ï¼ŒJITï¼ˆå³æ—¶ç¼–è¯‘ï¼‰ç­‰è¿è¡Œæ—¶ä¼˜åŒ–ç”±JVMè´Ÿè´£ï¼Œä¸¤è€…å…±åŒå½±å“ç¨‹åºæ€§èƒ½ã€‚æ·±å…¥ç†è§£javacæœºåˆ¶ï¼Œæœ‰åŠ©äºç¼–å†™é«˜æ•ˆã€å¥å£®çš„Javaä»£ç ï¼Œå¹¶æœ‰æ•ˆæ’æŸ¥ç¼–è¯‘æœŸé—®é¢˜ã€‚
## JaråŒ…
JARï¼ˆJava ARchiveï¼‰åŒ…æ˜¯Javaå¹³å°çš„æ ¸å¿ƒæ‰“åŒ…æ ¼å¼ï¼Œç”¨äºå°†å¤šä¸ªç±»æ–‡ä»¶ã€èµ„æºåŠå…ƒæ•°æ®æ•´åˆä¸ºå•ä¸ªå‹ç¼©æ–‡ä»¶ï¼ˆåŸºäºZIPæ ¼å¼ï¼‰ï¼Œç®€åŒ–åˆ†å‘ã€éƒ¨ç½²å’Œä¾èµ–ç®¡ç†ã€‚ä»¥ä¸‹ä»ç»“æ„ã€åŠŸèƒ½åˆ°åº”ç”¨åœºæ™¯å…¨é¢è§£æï¼š
------
### ğŸ“¦ **JARåŒ…çš„æ ¸å¿ƒç»“æ„ä¸ç»„æˆ**
1. **ç±»æ–‡ä»¶ï¼ˆ`.class`ï¼‰**
Javaæºç ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ï¼Œæ˜¯JARåŒ…çš„ä¸»ä½“å†…å®¹ã€‚æ¯ä¸ªç±»å¯¹åº”ä¸€ä¸ª`.class`æ–‡ä»¶ï¼ŒæŒ‰åŒ…è·¯å¾„å±‚çº§ç»„ç»‡ï¼ˆå¦‚`com/example/Main.class`ï¼‰[1,2](@ref)ã€‚
2. **èµ„æºæ–‡ä»¶**
é…ç½®æ–‡ä»¶ï¼ˆ`.properties`/`.xml`ï¼‰ã€å›¾ç‰‡ã€éŸ³é¢‘ç­‰éä»£ç èµ„æºï¼Œé€šå¸¸å­˜æ”¾åœ¨`resources/`ç›®å½•ä¸‹ï¼Œç¨‹åºé€šè¿‡`ClassLoader.getResourceAsStream()`è¯»å–[4,8](@ref)ã€‚
3. **å…ƒæ•°æ®ï¼ˆ`META-INF/`ï¼‰**
- **
```
MANIFEST.MF
```
**ï¼šæ ¸å¿ƒæ¸…å•æ–‡ä»¶ï¼Œå®šä¹‰JARå±æ€§ï¼š
- `Main-Class`ï¼šå¯æ‰§è¡ŒJARçš„å…¥å£ç±»ï¼ˆå¦‚`Main-Class: com.example.Main`ï¼‰[1,2](@ref)ã€‚
- `Class-Path`ï¼šä¾èµ–çš„å…¶ä»–JARè·¯å¾„ï¼ˆå¦‚`lib/dependency.jar`ï¼‰[4](@ref)ã€‚
- ç‰ˆæœ¬ã€ç­¾åä¿¡æ¯ç­‰[7](@ref)ã€‚
- ç­¾åæ–‡ä»¶ï¼ˆ`.SF`/`.DSA`ï¼‰ï¼šç”¨äºéªŒè¯JARå®Œæ•´æ€§[8](@ref)ã€‚
4. **ä¾èµ–åº“ï¼ˆ`lib/`ï¼‰**
ç¬¬ä¸‰æ–¹JARå¯åµŒå¥—åœ¨`lib/`ç›®å½•ï¼Œé€šè¿‡`MANIFEST.MF`çš„`Class-Path`å¼•ç”¨[6,8](@ref)ã€‚
------
### âš™ï¸ **JARåŒ…çš„ç±»å‹ä¸ç”¨é€”**
| **ç±»å‹** | **ç‰¹ç‚¹** | **åº”ç”¨åœºæ™¯** |
| --------------------- | ------------------------------------------------------------ | ----------------------------------------- |
| **å¯æ‰§è¡ŒJAR** | å«`Main-Class`ï¼Œé€šè¿‡`java -jar`ç›´æ¥è¿è¡Œ | ç‹¬ç«‹åº”ç”¨ã€å‘½ä»¤è¡Œå·¥å…·[2](@ref) |
| **åº“JAR** | æ— ä¸»ç±»ï¼Œæä¾›APIä¾›å…¶ä»–é¡¹ç›®è°ƒç”¨ | å¼€æºåº“ï¼ˆå¦‚Gsonã€Apache Commonsï¼‰[1](@ref) |
| **èµ„æºJAR** | ä»…å«é…ç½®æ–‡ä»¶ã€æ¨¡æ¿ç­‰èµ„æº | å¤šè¯­è¨€æ”¯æŒã€æ¨¡æ¿å¼•æ“[9](@ref) |
| **Webåº”ç”¨JARï¼ˆWARï¼‰** | ç‰¹æ®ŠJARæ ¼å¼ï¼Œå«`WEB-INF/classes`ã€`WEB-INF/lib`å’ŒWebé…ç½®æ–‡ä»¶ | Servletå®¹å™¨éƒ¨ç½²ï¼ˆå¦‚Tomcatï¼‰[11](@ref) |
&amp;gt; ğŸ’¡ **WAR vs JAR**ï¼š
&amp;gt;
&amp;gt; - WARæ˜¯Webä¸“å±æ ¼å¼ï¼ŒåŒ…å«`web.xml`ã€JSPå’Œé™æ€èµ„æº[11](@ref)ã€‚
&amp;gt; - JARæ›´é€šç”¨ï¼Œé€‚ç”¨äºéWebåœºæ™¯[1](@ref)ã€‚
------
### ğŸ› ï¸ **åˆ›å»ºJARåŒ…çš„å¸¸ç”¨æ–¹æ³•**
1. **å‘½ä»¤è¡Œå·¥å…·ï¼ˆJDK `jar`å‘½ä»¤ï¼‰**
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id="åŸºç¡€æ‰“åŒ…æ— æ¸…å•"&gt;åŸºç¡€æ‰“åŒ…ï¼ˆæ— æ¸…å•ï¼‰
&lt;/h1&gt;&lt;p&gt;jar cvf app.jar -C classes/ .&lt;/p&gt;
&lt;h1 id="å«è‡ªå®šä¹‰æ¸…å•"&gt;å«è‡ªå®šä¹‰æ¸…å•
&lt;/h1&gt;&lt;p&gt;jar cfm app.jar MANIFEST.MF -C classes/ . &lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- `c`ï¼šåˆ›å»ºï¼Œ`v`ï¼šè¾“å‡ºè¯¦æƒ…ï¼Œ`f`ï¼šæŒ‡å®šæ–‡ä»¶åï¼Œ`m`ï¼šæŒ‡å®šæ¸…å•æ–‡ä»¶ã€‚
2. **æ„å»ºå·¥å…·è‡ªåŠ¨åŒ–**
- Mavenï¼šé…ç½®
```
maven-shade-plugin
```
æ‰“åŒ…ä¾èµ–ï¼š
```
&amp;lt;plugin&amp;gt;
&amp;lt;artifactId&amp;gt;maven-shade-plugin&amp;lt;/artifactId&amp;gt;
&amp;lt;configuration&amp;gt;
&amp;lt;transformers&amp;gt;
&amp;lt;transformer implementation=&amp;#34;...ManifestResourceTransformer&amp;#34;&amp;gt;
&amp;lt;mainClass&amp;gt;com.example.Main&amp;lt;/mainClass&amp;gt;
&amp;lt;/transractor&amp;gt;
&amp;lt;/transformers&amp;gt;
&amp;lt;/configuration&amp;gt;
&amp;lt;/plugin&amp;gt;
```
```
mvn clean package
```
ç”Ÿæˆå¯æ‰§è¡ŒJAR
8
ã€‚
- Gradleï¼šé€šè¿‡
```
shadowJar
```
æ’ä»¶æ‰“åŒ…ï¼š
```
plugins { id &amp;#39;com.github.johnrengelman.shadow&amp;#39; }
shadowJar { manifest { attributes &amp;#39;Main-Class&amp;#39;: &amp;#39;com.example.Main&amp;#39; } }
```
```
gradle shadowJar
```
ç”Ÿæˆå«ä¾èµ–çš„Fat JAR
8
ã€‚
3. **IDEç”Ÿæˆï¼ˆIntelliJ/Eclipseï¼‰**
- IntelliJï¼š`File â†’ Project Structure â†’ Artifacts â†’ JAR`[4](@ref)ã€‚
- Eclipseï¼šå³é”®é¡¹ç›® â†’ `Export â†’ Runnable JAR`[6](@ref)ã€‚
------
### âš¡ï¸ **JARåŒ…çš„æ ¸å¿ƒä¼˜åŠ¿**
1. **ç®€åŒ–éƒ¨ç½²**
å•æ–‡ä»¶åŒ…å«æ‰€æœ‰ä»£ç å’Œèµ„æºï¼Œé¿å…æ–‡ä»¶æ•£è½[1,10](@ref)ã€‚
2. **ä¾èµ–ç®¡ç†**
é€šè¿‡`Class-Path`æˆ–Fat JARæ•´åˆç¬¬ä¸‰æ–¹åº“ï¼Œé¿å…ç¯å¢ƒå·®å¼‚[8,10](@ref)ã€‚
3. **è·¨å¹³å°æ€§**
ä¸Javaè¯­è¨€ä¸€è‡´ï¼Œæ”¯æŒWindows/Linux/macOS[3,7](@ref)ã€‚
4. **å®‰å…¨æ€§**
æ”¯æŒæ•°å­—ç­¾åï¼Œé˜²æ­¢ç¯¡æ”¹ï¼ˆ`jarsigner`å‘½ä»¤ï¼‰[2,7](@ref)ã€‚
------
### âš ï¸ **å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–**
1. **ä¾èµ–å†²çª**
- **Maven**ï¼š`&amp;lt;exclusions&amp;gt;`æ’é™¤å†²çªåŒ…[8](@ref)ã€‚
- **Gradle**ï¼š`resolutionStrategy.force`å¼ºåˆ¶ç‰ˆæœ¬[8](@ref)ã€‚
2. **èµ„æºåŠ è½½å¤±è´¥**
ç¡®ä¿èµ„æºè·¯å¾„æ­£ç¡®ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// æ­£ç¡®æ–¹å¼ï¼šä»ç±»è·¯å¾„æ ¹ç›®å½•è¯»å–
InputStream input = getClass().getResourceAsStream(&amp;quot;/config.properties&amp;quot;); &lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;3. **å‡å°ä½“ç§¯**
- ä½¿ç”¨`ProGuard`æ··æ·†åˆ é™¤æœªä½¿ç”¨ä»£ç ï¼ˆMaven/Gradleæ’ä»¶æ”¯æŒï¼‰[8](@ref)ã€‚
- æ¨¡å—åŒ–æ‹†åˆ†ï¼ˆå¦‚å¾®æœåŠ¡ç‹¬ç«‹JARï¼‰[7,10](@ref)ã€‚
4. **çƒ­æ›´æ–°æ”¯æŒ**
ç»“åˆ`Java Agent`æˆ–OSGiæ¡†æ¶å®ç°åŠ¨æ€åŠ è½½[7](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“**
JARåŒ…æ˜¯Javaç”Ÿæ€çš„åŸºçŸ³ï¼š
- **å¼€å‘ä¾§**ï¼šé€šè¿‡æ ‡å‡†å°è£…å®ç°ä»£ç å¤ç”¨ï¼ˆåº“JARï¼‰å’Œç‹¬ç«‹éƒ¨ç½²ï¼ˆå¯æ‰§è¡ŒJARï¼‰ã€‚
- **è¿ç»´ä¾§**ï¼šå•æ–‡ä»¶åˆ†å‘ã€ä¾èµ–éš”ç¦»ã€è·¨å¹³å°è¿è¡Œã€‚
- **è¿›é˜¶åœºæ™¯**ï¼šç»“åˆæ¨¡å—åŒ–ï¼ˆJPMSï¼‰ã€å®¹å™¨åŒ–ï¼ˆDockerï¼‰æ„å»ºç°ä»£äº‘åŸç”Ÿåº”ç”¨[7,10](@ref)ã€‚
&amp;gt; é™„ï¼š**å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥**
&amp;gt;
&amp;gt; - åˆ—å‡ºå†…å®¹ï¼š`jar tf app.jar`
&amp;gt; - è§£å‹ï¼š`jar xf app.jar`
&amp;gt; - è¿è¡Œï¼š`java -jar app.jar`[2,4](@ref)ã€‚
## Jar åŒ…è§£æ
ClassLoaderè§£æJARåŒ…çš„è¿‡ç¨‹æ¶‰åŠJavaç±»åŠ è½½æœºåˆ¶çš„æ ¸å¿ƒåŸç†ï¼Œå…¶å®ç°ä¾èµ–äº**åŒäº²å§”æ´¾æ¨¡å‹**ã€**ç±»è·¯å¾„æ‰«æ**åŠ**å­—èŠ‚ç å¤„ç†**ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š
------
### âš™ï¸ **JARåŒ…ç»“æ„ä¸å®šä½**
- **JARæ–‡ä»¶æœ¬è´¨**ï¼šJARï¼ˆJava ARchiveï¼‰æ˜¯åŸºäºZIPæ ¼å¼çš„å‹ç¼©æ–‡ä»¶ï¼ŒåŒ…å«`.class`æ–‡ä»¶ã€èµ„æºï¼ˆå¦‚å›¾ç‰‡/é…ç½®æ–‡ä»¶ï¼‰åŠå…ƒæ•°æ®ï¼ˆå¦‚`META-INF/MANIFEST.MF`ï¼‰[1,3](@ref)ã€‚
- ç±»è·¯å¾„ï¼ˆClasspathï¼‰ï¼š
ClassLoaderé€šè¿‡ç±»è·¯å¾„å®šä½JARåŒ…ã€‚ç±»è·¯å¾„å¯æŒ‡å®šä¸ºï¼š
- ç›®å½•ï¼ˆå«æŒ‰åŒ…ç»“æ„ç»„ç»‡çš„`.class`æ–‡ä»¶ï¼‰
- JARæ–‡ä»¶è·¯å¾„ï¼ˆå¦‚`lib/myapp.jar`ï¼‰
- é€šé…ç¬¦ï¼ˆå¦‚`lib/*.jar`åŠ è½½æ‰€æœ‰JARï¼‰[3,7](@ref)ã€‚
------
### ğŸ”„ **ç±»åŠ è½½æµç¨‹ï¼ˆåŒäº²å§”æ´¾æ¨¡å‹ï¼‰**
ClassLoaderåŠ è½½JARä¸­çš„ç±»æ—¶ï¼Œä¸¥æ ¼éµå¾ª**åŒäº²å§”æ´¾æœºåˆ¶**ï¼š
1. **å§”æ´¾çˆ¶åŠ è½½å™¨**ï¼š
å­ClassLoaderï¼ˆå¦‚`AppClassLoader`ï¼‰æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚åï¼Œä¼˜å…ˆå§”æ´¾çˆ¶åŠ è½½å™¨ï¼ˆå¦‚`ExtClassLoader`ï¼‰å¤„ç†[4,7](@ref)ã€‚
2.
çˆ¶åŠ è½½å™¨é€çº§å°è¯•ï¼š
- `BootstrapClassLoader`ï¼šåŠ è½½JREæ ¸å¿ƒç±»ï¼ˆ`rt.jar`ç­‰ï¼‰ã€‚
- `ExtClassLoader`ï¼šåŠ è½½`jre/lib/ext`ç›®å½•çš„æ‰©å±•ç±»ã€‚
- è‹¥çˆ¶åŠ è½½å™¨æˆåŠŸåŠ è½½ï¼Œç›´æ¥è¿”å›`Class`å¯¹è±¡[6,8](@ref)ã€‚
3. **è‡ªèº«åŠ è½½**ï¼š
è‹¥çˆ¶åŠ è½½å™¨å‡å¤±è´¥ï¼Œå­ClassLoaderè°ƒç”¨`findClass()`æ–¹æ³•ï¼Œä»è‡ªèº«ç±»è·¯å¾„ï¼ˆå«JARï¼‰ä¸­æŸ¥æ‰¾å¹¶åŠ è½½ç±»[7,8](@ref)ã€‚
&amp;gt; **æµç¨‹å›¾è§£**ï¼š
&amp;gt;
&amp;gt; ```
&amp;gt; ç”¨æˆ·è¯·æ±‚åŠ è½½ç±» â†’ AppClassLoader â†’ ExtClassLoader â†’ BootstrapClassLoader
&amp;gt; â†‘ (å¤±è´¥) â†“ (å¤±è´¥)
&amp;gt; â† è¿”å›Class â† æˆåŠŸåŠ è½½ â† è‡ªèº«åŠ è½½ï¼ˆfindClassï¼‰
&amp;gt; ```
------
### ğŸ§© **URLClassLoaderè§£æJARçš„ç»†èŠ‚**
`URLClassLoader`æ˜¯åŠ è½½JARçš„æ ¸å¿ƒå®ç°ç±»ï¼Œå…¶å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š
1. **JARè·¯å¾„æ˜ å°„**ï¼š
å°†JARæ–‡ä»¶è½¬æ¢ä¸º`URL`å¯¹è±¡ï¼ˆå¦‚`file:/path/to.jar`ï¼‰ï¼ŒåŠ å…¥ç±»åŠ è½½å™¨çš„æœç´¢è·¯å¾„[2,5](@ref)ã€‚
2.
ç±»æŸ¥æ‰¾ä¸åŠ è½½ï¼š
- è°ƒç”¨`findClass(String className)`ï¼Œæ ¹æ®ç±»åï¼ˆå¦‚`com.example.MyClass`ï¼‰è½¬æ¢ä¸ºJARå†…è·¯å¾„ï¼ˆ`com/example/MyClass.class`ï¼‰ã€‚
- ä»JARä¸­è¯»å–è¯¥`.class`æ–‡ä»¶çš„å­—èŠ‚æµã€‚
3.
å­—èŠ‚ç å¤„ç†ï¼š
- **éªŒè¯**ï¼šæ£€æŸ¥å­—èŠ‚ç ç¬¦åˆJVMè§„èŒƒï¼ˆå¦‚é­”æ•°`0xCAFEBABE`ï¼‰ã€‚
- **å®šä¹‰ç±»**ï¼šè°ƒç”¨`defineClass(byte[] b, int off, int len)`ï¼Œå°†å­—èŠ‚ç è½¬æ¢ä¸ºJVMå†…éƒ¨çš„`Class`å¯¹è±¡[4,7](@ref)ã€‚
4. **èµ„æºåŠ è½½**ï¼š
é€šè¿‡`getResourceAsStream()`åŠ è½½JARå†…éç±»èµ„æºï¼ˆå¦‚é…ç½®æ–‡ä»¶ï¼‰[1,5](@ref)ã€‚
------
### âš ï¸ **ç±»åŠ è½½é¡ºåºä¸å†²çªè§£å†³**
- ç±»è·¯å¾„é¡ºåºå†³å®šä¼˜å…ˆçº§ï¼š
è‹¥å¤šä¸ªJARåŒ…å«åŒåç±»ï¼ˆå¦‚
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;com.utils.StringUtil&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ï¼‰ï¼ŒClassLoaderåŠ è½½
ç¬¬ä¸€ä¸ªåœ¨ç±»è·¯å¾„ä¸­æ‰¾åˆ°çš„ç±»
ï¼Œåç»­åŒåç±»è¢«å¿½ç•¥
3
ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id="ç¤ºä¾‹libjarä¸­çš„ç±»ä¼˜å…ˆäºlibjaråŠ è½½"&gt;ç¤ºä¾‹ï¼šlibjarä¸­çš„ç±»ä¼˜å…ˆäºlibjaråŠ è½½
&lt;/h1&gt;&lt;p&gt;java -cp lib1.jar:lib2.jar Main&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **è‡ªå®šä¹‰ClassLoaderéš”ç¦»å†²çª**ï¼š
é€šè¿‡ç‹¬ç«‹`URLClassLoader`å®ä¾‹åŠ è½½ä¸åŒJARï¼Œå®ç°ç±»ç©ºé—´éš”ç¦»ï¼ˆå¦‚Tomcatä¸ºæ¯ä¸ªWebåº”ç”¨åˆ›å»ºç‹¬ç«‹ClassLoaderï¼‰[5,7](@ref)ã€‚
------
### ğŸ› ï¸ **è‡ªå®šä¹‰ClassLoaderçš„é«˜çº§åœºæ™¯**
1. **çƒ­éƒ¨ç½²**ï¼š
é‡å†™`findClass()`ï¼Œç›‘æ§JARæ–‡ä»¶ä¿®æ”¹å¹¶é‡æ–°åŠ è½½ç±»[4,5](@ref)ã€‚
2. **åŠ å¯†ç±»åŠ è½½**ï¼š
è¯»å–åŠ å¯†çš„JARå­—èŠ‚ç ï¼Œè§£å¯†åè°ƒç”¨`defineClass()`[4](@ref)ã€‚
3.
Webå®¹å™¨ç±»åŠ è½½ï¼š
å¦‚Tomcatçš„
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WebAppClassLoader&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-ï¼š" data-lang="ï¼š"&gt;- ä¼˜å…ˆåŠ è½½`WEB-INF/classes`ä¸­çš„ç±»ã€‚
- æ¬¡ä¼˜åŠ è½½`WEB-INF/lib/*.jar`ã€‚
- çˆ¶åŠ è½½å™¨ä»…è´Ÿè´£Servlet APIç­‰å…±äº«åº“[5](@ref)ã€‚
------
### ğŸ’ **æ€»ç»“ä¸æœ€ä½³å®è·µ**
- **è§£ææœ¬è´¨**ï¼šClassLoaderé€šè¿‡**åŒäº²å§”æ´¾**ç¡®ä¿æ ¸å¿ƒç±»å®‰å…¨ï¼Œé€šè¿‡**URLClassLoader**å®šä½å¹¶è½¬æ¢JARä¸­çš„å­—èŠ‚ç ä¸ºå¯æ‰§è¡Œç±»ã€‚
- é¿å‘æŒ‡å—ï¼š
- **é¿å…ç±»å†²çª**ï¼šè§„èŒƒåŒ…åæˆ–ä½¿ç”¨æ¨¡å—åŒ–ï¼ˆJPMSï¼‰[3](@ref)ã€‚
- **èµ„æºæ³„éœ²**ï¼šåŠ¨æ€åŠ è½½çš„`URLClassLoader`éœ€æ‰‹åŠ¨`close()`ï¼ˆJava 7+ï¼‰[2](@ref)ã€‚
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå‡å°‘å…¨é‡æ‰«æï¼Œç¼“å­˜å¸¸ç”¨ç±»ã€‚
&amp;gt; é€šè¿‡æ·±å…¥ç†è§£ClassLoaderæœºåˆ¶ï¼Œå¯çµæ´»åº”ç”¨äºæ’ä»¶ç³»ç»Ÿï¼ˆå¦‚OSGiï¼‰ã€äº‘åŸç”Ÿæ¶æ„ç­‰åœºæ™¯ï¼Œå®ç°é«˜æ‰©å±•æ€§è®¾è®¡[5,7](@ref)ã€‚
## class å®šä½
JVMåœ¨åŠ è½½ç±»æ—¶å®šä½.classæ–‡ä»¶æ‰€å±çš„å…·ä½“JARåŒ…ï¼Œæ˜¯é€šè¿‡**ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰** ç»“åˆ**åŒäº²å§”æ´¾æ¨¡å‹**å’Œ**ç±»è·¯å¾„ï¼ˆClasspathï¼‰** æœºåˆ¶å®ç°çš„ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†åŸç†ï¼š
------
### âš™ï¸ æ ¸å¿ƒæœºåˆ¶ï¼šç±»ååˆ°è·¯å¾„çš„æ˜ å°„
1. **å…¨é™å®šåè½¬æ¢**
JVMå°†ç±»çš„å…¨é™å®šåï¼ˆå¦‚`com.example.MyClass`ï¼‰è½¬æ¢ä¸ºæ–‡ä»¶ç³»ç»Ÿè·¯å¾„æ ¼å¼ï¼ˆ`com/example/MyClass.class`ï¼‰[5,6](@ref)ã€‚
- **ç¤ºä¾‹**ï¼šç±»`java.lang.String` â†’ è·¯å¾„`java/lang/String.class`ã€‚
2. **ç±»è·¯å¾„ï¼ˆClasspathï¼‰å®šä¹‰æœç´¢èŒƒå›´**
- Classpathæ˜¯JVMæœç´¢ç±»æ–‡ä»¶çš„ç›®å½•æˆ–JARåˆ—è¡¨ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼æŒ‡å®šï¼š
- å‘½ä»¤è¡Œå‚æ•°ï¼š`-classpath`æˆ–`-cp`ï¼ˆå¦‚`java -cp lib/*.jar Main`ï¼‰[6](@ref)ã€‚
- ç¯å¢ƒå˜é‡`CLASSPATH`ï¼ˆè¾ƒå°‘ç”¨ï¼Œæ˜“è¢«è¦†ç›–ï¼‰ã€‚
- é»˜è®¤å½“å‰ç›®å½•ï¼ˆ`.`ï¼‰[6](@ref)ã€‚
------
### ğŸ” ç±»åŠ è½½å™¨çš„æœç´¢æµç¨‹ï¼ˆåŒäº²å§”æ´¾æ¨¡å‹ï¼‰
JVMé€šè¿‡ä¸‰çº§ç±»åŠ è½½å™¨é€çº§æœç´¢ï¼Œç¡®ä¿æ ¸å¿ƒç±»ä¼˜å…ˆåŠ è½½ï¼š
1. **å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰**
- åŠ è½½`JAVA_HOME/lib/rt.jar`ç­‰æ ¸å¿ƒåº“ï¼ˆå¦‚`java.lang.*`ï¼‰[2,8](@ref)ã€‚
- **æœç´¢è·¯å¾„**ï¼šä»…é™JREæ ¸å¿ƒJARã€‚
2. **æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰**
- åŠ è½½`JAVA_HOME/lib/ext/*.jar`ä¸­çš„æ‰©å±•ç±»ï¼ˆå¦‚`javax.*`ï¼‰[6,8](@ref)ã€‚
- **æœç´¢è·¯å¾„**ï¼šç”±`-Djava.ext.dirs`æŒ‡å®šã€‚
3. **åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰**
- åŠ è½½Classpathä¸­ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠç¬¬ä¸‰æ–¹JARï¼ˆå¦‚é¡¹ç›®`lib/`ç›®å½•ï¼‰[5,6](@ref)ã€‚
- å·¥ä½œæµç¨‹ï¼š
- éå†Classpathæ¯ä¸ªæ¡ç›®ï¼ˆç›®å½•æˆ–JARï¼‰ã€‚
- åœ¨ç›®å½•ä¸­æŒ‰åŒ…è·¯å¾„æŸ¥æ‰¾`.class`æ–‡ä»¶ï¼ˆå¦‚`com/example/MyClass.class`ï¼‰ã€‚
- åœ¨JARä¸­æŒ‰ç›¸åŒè·¯å¾„å®šä½å†…éƒ¨æ¡ç›®ï¼ˆå¦‚JARå†…çš„`com/example/MyClass.class`ï¼‰[9](@ref)ã€‚
------
### âš¡ï¸ JARåŒ…å†…éƒ¨çš„å®šä½åŸç†
JARæœ¬è´¨æ˜¯ZIPæ ¼å¼å‹ç¼©æ–‡ä»¶ï¼Œç±»åŠ è½½å™¨å°†å…¶è§†ä¸ºè™šæ‹Ÿç›®å½•ç»“æ„ï¼š
1.
JARæ¡ç›®æ‰«æ
- ç±»åŠ è½½å™¨è§£æJARæ—¶ï¼Œéå†å…¶å†…éƒ¨æ¡ç›®ï¼ˆ`JarEntry`ï¼‰ï¼ŒåŒ¹é…è·¯å¾„æ ¼å¼ï¼ˆå¦‚`com/example/MyClass.class`ï¼‰[9](@ref)ã€‚
2.
ç¼“å­˜ä¼˜åŒ–
- é¦–æ¬¡åŠ è½½åï¼Œç±»ä¿¡æ¯åŠæ¥æºJARè·¯å¾„ä¼šè¢«ç¼“å­˜ï¼Œåç»­ç›´æ¥ä»å†…å­˜è¯»å–ï¼Œé¿å…é‡å¤æ‰«æ[3,8](@ref)ã€‚
------
### âš ï¸ å…³é”®ç»†èŠ‚ä¸å†²çªè§£å†³
1. **ç±»è·¯å¾„ä¼˜å…ˆçº§**
- è‹¥å¤šä¸ªJARåŒ…å«åŒåç±»ï¼ˆå¦‚`log4j-core-2.0.jar`å’Œ`log4j-core-1.0.jar`å‡æœ‰`org.apache.log4j.Core.class`ï¼‰ï¼ŒJVMæŒ‰Classpathå£°æ˜é¡ºåºåŠ è½½**ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹**ï¼Œåç»­å¿½ç•¥[6](@ref)ã€‚
- **ç¤ºä¾‹**ï¼š`-cp lib/A.jar:lib/B.jar` â†’ ä¼˜å…ˆåŠ è½½`A.jar`ä¸­çš„ç±»ã€‚
2. **éªŒè¯ç±»æ¥æºçš„æ–¹æ³•**
- **åå°„API**ï¼šé€šè¿‡`ClassLoader.getResource()`è·å–ç±»æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚`jar:file:/app/lib/utils.jar!/com/util/StringUtils.class`ï¼‰[1](@ref)ã€‚
- å‘½ä»¤è¡Œå·¥å…·ï¼š
- `jps`æŸ¥çœ‹Javaè¿›ç¨‹ID â†’ `jinfo &amp;lt;pid&amp;gt;`è¾“å‡ºç±»è·¯å¾„[1](@ref)ã€‚
- `jar tf app.jar`åˆ—å‡ºJARå†…å®¹[6](@ref)ã€‚
------
### ğŸ’ æ€»ç»“
JVMå®šä½ç±»æ‰€å±JARçš„æ ¸å¿ƒæ­¥éª¤ï¼š
1. **è·¯å¾„æ˜ å°„**ï¼šå°†å…¨é™å®šåè½¬æ¢ä¸ºæ–‡ä»¶è·¯å¾„ï¼ˆ`åŒ…å/ç±»å.class`ï¼‰ã€‚
2. **å±‚çº§æœç´¢**ï¼šæŒ‰åŒäº²å§”æ´¾æ¨¡å‹ï¼Œä»æ ¸å¿ƒåº“â†’æ‰©å±•åº“â†’Classpathé¡ºåºæ‰«æã€‚
3. **JARè§£æ**ï¼šå°†JARè§†ä¸ºè™šæ‹Ÿç›®å½•ï¼ŒåŒ¹é…å†…éƒ¨æ¡ç›®è·¯å¾„ã€‚
4. **ç¼“å­˜ä¸å†²çªå¤„ç†**ï¼šä¼˜å…ˆåŠ è½½Classpathä¸­é å‰çš„JARï¼Œé¿å…é‡å¤åŠ è½½ã€‚
**æ’æŸ¥å»ºè®®**ï¼š
- ç±»å†²çªæ—¶è°ƒæ•´JARé¡ºåºæˆ–æ’é™¤å†—ä½™ä¾èµ–ï¼ˆMaven/Gradleçš„`&amp;lt;exclusions&amp;gt;`ï¼‰[6](@ref)ã€‚
- ä½¿ç”¨`-verbose:class`å‚æ•°è·Ÿè¸ªç±»åŠ è½½è¿‡ç¨‹[8](@ref)ã€‚
## JaråŒ…ç»“æ„
JARåŒ…æœ¬è´¨æ˜¯åŸºäºZIPæ ¼å¼çš„å‹ç¼©æ–‡ä»¶ï¼Œä½†JVMé€šè¿‡**å¤šå±‚ä¼˜åŒ–æœºåˆ¶**å®ç°äº†å¯¹å…¶ä¸­`.class`æ–‡ä»¶æˆ–`JarEntry`çš„é«˜æ•ˆè§£æã€‚å…¶æ ¸å¿ƒåŸç†å¯æ‹†è§£å¦‚ä¸‹ï¼š
------
### âš™ï¸ JARç»“æ„ä¸å¿«é€Ÿå®šä½æœºåˆ¶
1. **ZIPç›®å½•ç´¢å¼•åŠ é€Ÿ**
JARä½œä¸ºZIPæ ¼å¼çš„æ‰©å±•ï¼Œå…¶æ–‡ä»¶æœ«å°¾å›ºå®šå­˜å‚¨**ä¸­å¤®ç›®å½•è®°å½•**â€‹ï¼ˆCentral Directoryï¼‰ï¼Œè®°å½•äº†æ¯ä¸ªæ–‡ä»¶çš„è·¯å¾„ã€åç§»é‡å’Œå‹ç¼©ä¿¡æ¯ã€‚JVMï¼ˆé€šè¿‡`java.util.jar.JarFile`ï¼‰ä¼šé¦–å…ˆè¯»å–æ­¤ç›®å½•ï¼Œæ„å»º**å†…å­˜ç´¢å¼•è¡¨**â€‹ï¼ˆå¦‚HashMapï¼‰ï¼Œå°†ç±»åï¼ˆå¦‚`com/example/MyClass.class`ï¼‰æ˜ å°„åˆ°æ–‡ä»¶ä½ç½®ã€‚åç»­æŸ¥æ‰¾ç±»æ—¶ç›´æ¥é€šè¿‡ç´¢å¼•å®šä½ï¼Œæ— éœ€éå†æ•´ä¸ªJARæ–‡ä»¶[1,3](@ref)ã€‚
2. **JARä¸“å±ä¼˜åŒ–**
- **æ¸…å•æ–‡ä»¶ç¼“å­˜**ï¼š`META-INF/MANIFEST.MF`åœ¨é¦–æ¬¡åŠ è½½æ—¶å³è¢«è§£æå¹¶ç¼“å­˜ï¼Œé¿å…é‡å¤è¯»å–[1](@ref)ã€‚
- **ç±»åè·¯å¾„æ˜ å°„**ï¼šç±»åŠ è½½å™¨å°†å…¨é™å®šåï¼ˆå¦‚`com.example.MyClass`ï¼‰è½¬æ¢ä¸ºJARå†…éƒ¨è·¯å¾„ï¼ˆ`com/example/MyClass.class`ï¼‰ï¼Œç›´æ¥åŒ¹é…ç´¢å¼•æ¡ç›®[3,5](@ref)ã€‚
------
### ğŸš€ JVMç±»åŠ è½½ä¸JARè§£æçš„ååŒæµç¨‹
1. **æŒ‰éœ€åŠ è½½ï¼ˆLazy Loadingï¼‰**
JVMä¸ä¼šåœ¨å¯åŠ¨æ—¶åŠ è½½æ‰€æœ‰ç±»ï¼Œè€Œæ˜¯**é¦–æ¬¡ä½¿ç”¨æ—¶**â€‹ï¼ˆå¦‚`new MyClass()`ï¼‰è§¦å‘åŠ è½½ã€‚ç±»åŠ è½½å™¨ï¼ˆå¦‚`URLClassLoader`ï¼‰ä»…ä»JARä¸­æå–ç›®æ ‡ç±»çš„å­—èŠ‚ç ï¼Œæ— å…³æ–‡ä»¶ä¸è¢«è§£å‹æˆ–è¯»å–[3,5](@ref)ã€‚
2. **å­—èŠ‚ç ç›´æ¥è¯»å–**
é€šè¿‡`JarEntry.getInputStream()`è·å–`.class`æ–‡ä»¶çš„å­—èŠ‚æµåï¼ŒJVMç›´æ¥é€å…¥**ç±»åŠ è½½å­ç³»ç»Ÿ**ï¼Œè¿›è¡ŒéªŒè¯ã€å‡†å¤‡ã€è§£æç­‰é˜¶æ®µï¼Œæ— éœ€è§£å‹åˆ°ç£ç›˜[2,9](@ref)ã€‚æ­¤è¿‡ç¨‹ä¾èµ–`ZipFile`ç±»çš„æœ¬åœ°æ–¹æ³•ï¼ˆNative Methodï¼‰ï¼Œç›´æ¥æ“ä½œå‹ç¼©æ–‡ä»¶å†…å®¹ï¼Œå‡å°‘IOå¼€é”€[3](@ref)ã€‚
3. **èµ„æºæ–‡ä»¶çš„æ‡’åŠ è½½**
éç±»èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€é…ç½®æ–‡ä»¶ï¼‰é€šè¿‡`ClassLoader.getResourceAsStream()`è¯»å–ï¼ŒåŒæ ·åˆ©ç”¨JARç´¢å¼•å¿«é€Ÿå®šä½ï¼Œä»…å½“è°ƒç”¨æ—¶æ‰è§£å‹æ•°æ®åˆ°å†…å­˜[1,7](@ref)ã€‚
------
### âš¡ï¸ æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯
1. **å†…å­˜æ˜ å°„æ–‡ä»¶ï¼ˆMemory-Mapped Filesï¼‰**
å¯¹äºé¢‘ç¹è®¿é—®çš„JARï¼ŒJVMå¯èƒ½é€šè¿‡`java.nio`å°†æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ï¼ˆ`MappedByteBuffer`ï¼‰ï¼Œåç»­è¯»å–ç›´æ¥æ“ä½œå†…å­˜ï¼Œé¿å…ç£ç›˜IO[3,7](@ref)ã€‚
2. **ç¼“å­˜æœºåˆ¶**
- **å·²åŠ è½½ç±»ç¼“å­˜**ï¼šåŠ è½½è¿‡çš„ç±»å­˜å…¥`ClassLoader`çš„ç¼“å­˜ï¼ˆå¦‚`ClassLoader#classes`ï¼‰ï¼Œé‡å¤è¯·æ±‚ç›´æ¥è¿”å›å†…å­˜ä¸­çš„`Class`å¯¹è±¡[5,9](@ref)ã€‚
- **JARæ–‡ä»¶å¥æŸ„ç¼“å­˜**ï¼š`JarFile`å®ä¾‹ä¼šç¼“å­˜æ‰“å¼€çš„JARæ–‡ä»¶å¥æŸ„ï¼Œé¿å…é‡å¤æ‰“å¼€åŒä¸€æ–‡ä»¶[3](@ref)ã€‚
3. **å¹¶å‘æ§åˆ¶**
ç±»åŠ è½½è¿‡ç¨‹é€šè¿‡**åŒæ­¥é”**â€‹ï¼ˆå¦‚`ClassLoader#getClassLoadingLock`ï¼‰ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œé¿å…é‡å¤åŠ è½½[5,9](@ref)ã€‚
------
### âš ï¸ æ€§èƒ½ç“¶é¢ˆä¸è§„é¿ç­–ç•¥
å°½ç®¡æœ‰ä¸Šè¿°ä¼˜åŒ–ï¼Œä»¥ä¸‹åœºæ™¯ä»å¯èƒ½å½±å“è§£æé€Ÿåº¦ï¼š
1. **å·¨å‹JARæ–‡ä»¶**
ç´¢å¼•è¡¨è¿‡å¤§å¯¼è‡´å†…å­˜å ç”¨é«˜ï¼Œé¦–æ¬¡åŠ è½½å»¶è¿Ÿã€‚
â€‹**ä¼˜åŒ–æ–¹æ¡ˆ**â€‹ï¼šæ‹†åˆ†ä¸ºå¤šä¸ªJARï¼Œæˆ–ä½¿ç”¨æ¨¡å—åŒ–ï¼ˆJPMSï¼‰æŒ‰éœ€åŠ è½½[3,7](@ref)ã€‚
2. **ç¢ç‰‡åŒ–æ¡ç›®**
å¤§é‡å°æ–‡ä»¶ï¼ˆå¦‚åƒä¸ª`.class`ï¼‰å¢åŠ ç´¢å¼•æ„å»ºæ—¶é—´ã€‚
â€‹**ä¼˜åŒ–æ–¹æ¡ˆ**â€‹ï¼šåˆå¹¶ä¸ºå°‘é‡å¤§æ–‡ä»¶ï¼ˆå¦‚ä½¿ç”¨ProGuardæ··æ·†åˆå¹¶ï¼‰[3](@ref)ã€‚
3. **è¿œç¨‹JARåŠ è½½**
ç½‘ç»œå­˜å‚¨ï¼ˆå¦‚NFSï¼‰çš„JARæ–‡ä»¶å—ç½‘ç»œå»¶è¿Ÿå½±å“ã€‚
â€‹**ä¼˜åŒ–æ–¹æ¡ˆ**â€‹ï¼šé¢„çƒ­ç¼“å­˜æˆ–ä¸‹è½½åˆ°æœ¬åœ°ç£ç›˜[1](@ref)ã€‚
------
### ğŸ” åŸç”ŸAPIä¸å·¥å…·ç¤ºä¾‹
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// æ‰‹åŠ¨è§£æJARæ¡ç›®ç¤ºä¾‹
try (JarFile jarFile = new JarFile(&amp;ldquo;app.jar&amp;rdquo;)) {
JarEntry entry = jarFile.getJarEntry(&amp;ldquo;com/example/MyClass.class&amp;rdquo;);
try (InputStream is = jarFile.getInputStream(entry)) {
byte[] bytes = is.readAllBytes(); // ç›´æ¥è·å–å­—èŠ‚ç 
}
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;æ­¤ä»£ç å±•ç¤º`JarFile`å¦‚ä½•é€šè¿‡ç´¢å¼•å¿«é€Ÿå®šä½æ¡ç›®å¹¶è¯»å–å­—èŠ‚æµ[2,9](@ref)ã€‚
------
### ğŸ’ æ€»ç»“
JVMé€šè¿‡ **ZIPä¸­å¤®ç›®å½•ç´¢å¼• â†’ ç±»åè·¯å¾„æ˜ å°„ â†’ æŒ‰éœ€æ‡’åŠ è½½ â†’ å†…å­˜ç›´æ¥æ“ä½œ** å››æ­¥ååŒï¼Œå®ç°JARå†…èµ„æºçš„å¿«é€Ÿè§£æã€‚ä¼˜åŒ–æ ¸å¿ƒåœ¨äºï¼š
1. **ç©ºé—´æ¢æ—¶é—´**ï¼šå†…å­˜ç´¢å¼•é¿å…å…¨é‡æ‰«æï¼›
2. **å‡å°‘IO**ï¼šå­—èŠ‚æµç›´è¯»ã€å†…å­˜æ˜ å°„ï¼›
3. **æŒ‰éœ€åŠ è½½**ï¼šé¿å…æ— ç”¨è§£å‹ã€‚
&amp;gt; **é™„ï¼šJARè§£ææ•ˆç‡å¯¹æ¯”**
&amp;gt;
&amp;gt; | **æ–¹æ³•** | ç´¢å¼•æŸ¥æ‰¾ | å…¨é‡æ‰«æ |
&amp;gt; | ---------------- | -------- | -------- |
&amp;gt; | **é¦–æ¬¡åŠ è½½å»¶è¿Ÿ** | ä¸­ | é«˜ |
&amp;gt; | **ç±»æŸ¥æ‰¾é€Ÿåº¦** | O(1) | O(n) |
&amp;gt; | **å†…å­˜å¼€é”€** | ç´¢å¼•è¡¨ | æ—  |
ç”Ÿäº§ç¯å¢ƒä¸­åº”é¿å…å•JARè¿‡å¤§ï¼Œåˆç†æ‹†åˆ†æ¨¡å—ï¼Œå¹¶åˆ©ç”¨JVMå†…ç½®ä¼˜åŒ–é™ä½å»¶è¿Ÿã€‚
## provided ä¾èµ–
åœ¨ Maven ä¾èµ–ç®¡ç†ä¸­ï¼Œ**`provided`** æ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¾èµ–èŒƒå›´ï¼ˆScopeï¼‰ï¼Œç”¨äºå£°æ˜æŸäº›ä¾èµ–åœ¨ç‰¹å®šé˜¶æ®µç”±å¤–éƒ¨ç¯å¢ƒæä¾›ï¼Œè€Œéç”±é¡¹ç›®è‡ªèº«æ‰“åŒ…æºå¸¦ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒç‰¹æ€§å’Œåº”ç”¨åœºæ™¯çš„è¯¦ç»†è§£æï¼š
------
### âš™ï¸ **`provided` ä¾èµ–çš„æ ¸å¿ƒå®šä¹‰**
1. **ç”Ÿå‘½å‘¨æœŸé˜¶æ®µå¯ç”¨æ€§**
- **ç¼–è¯‘ä¸æµ‹è¯•é˜¶æ®µå¯ç”¨**ï¼š`provided` ä¾èµ–åœ¨é¡¹ç›®çš„**ç¼–è¯‘æœŸ**å’Œ**æµ‹è¯•æœŸ**ä¼šè¢«åŠ å…¥ç±»è·¯å¾„ï¼ˆClasspathï¼‰ï¼Œå› æ­¤ä»£ç ä¸­å¯æ­£å¸¸å¼•ç”¨å…¶ API[1,2,6,9](@ref)ã€‚
- **è¿è¡Œé˜¶æ®µä¸åŒ…å«**ï¼šåœ¨é¡¹ç›®æ‰“åŒ…ï¼ˆå¦‚ç”Ÿæˆ WAR/JAR æ–‡ä»¶ï¼‰æ—¶ï¼Œè¿™äº›ä¾èµ–**ä¸ä¼šè¢«æ‰“å…¥æœ€ç»ˆäº§ç‰©**ä¸­ã€‚è¿™æ˜¯å› ä¸ºè¿è¡Œæ—¶ç¯å¢ƒï¼ˆå¦‚åº”ç”¨æœåŠ¡å™¨ã€JDK ç­‰ï¼‰å·²é»˜è®¤æä¾›è¯¥ä¾èµ–[1,3,6,10](@ref)ã€‚
2. **ä¾èµ–ä¼ é€’æ€§**
`provided` ä¾èµ–**ä¸å…·å¤‡ä¼ é€’æ€§**ã€‚è‹¥æ¨¡å— A ä¾èµ–æ¨¡å— Bï¼ˆScope=`provided`ï¼‰ï¼Œè€Œæ¨¡å— B ä¾èµ–æ¨¡å— Cï¼Œåˆ™æ¨¡å— C â€‹**ä¸ä¼šè‡ªåŠ¨ä¼ é€’åˆ°æ¨¡å— A**â€‹ çš„ä¾èµ–ä¸­[9](@ref)ã€‚
------
### ğŸ¯ **å…¸å‹åº”ç”¨åœºæ™¯**
1. **å®¹å™¨æä¾›çš„ API**
- **Servlet/JSP API**ï¼šå¼€å‘ Web åº”ç”¨æ—¶éœ€å¼•å…¥ `javax.servlet-api`ï¼Œä½†éƒ¨ç½²åˆ° Tomcat/Jetty ç­‰å®¹å™¨åï¼Œå®¹å™¨è‡ªèº«å·²æä¾›è¯¥ JAR åŒ…ã€‚è‹¥é‡å¤æ‰“åŒ…ä¼šå¯¼è‡´ç±»å†²çªï¼ˆå¦‚ `LinkageError`ï¼‰[6,10](@ref)ã€‚
&lt;/code&gt;&lt;/pre&gt; &lt;dependency&gt;
&lt;groupId&gt;javax.servlet&lt;/groupId&gt;
&lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
&lt;version&gt;4.0.1&lt;/version&gt;
&lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
```
2. **ç¼–è¯‘æ—¶å·¥å…·åº“**
- **Lombok**ï¼šåœ¨ç¼–è¯‘æœŸé€šè¿‡æ³¨è§£ç”Ÿæˆä»£ç ï¼ˆå¦‚ Getter/Setterï¼‰ï¼Œä½†è¿è¡Œæ—¶æ— éœ€æºå¸¦å…¶ JAR åŒ…[1](@ref)ã€‚
```
&lt;dependency&gt;
&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
&lt;artifactId&gt;lombok&lt;/artifactId&gt;
&lt;version&gt;1.18.24&lt;/version&gt;
&lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
```
3. **Java EE æ ‡å‡†åº“**
- å¦‚ JAX-RSã€JPA ç­‰ APIï¼Œé€šå¸¸ç”±åº”ç”¨æœåŠ¡å™¨ï¼ˆå¦‚ WildFlyã€WebLogicï¼‰æä¾›å®ç°[2,9](@ref)ã€‚
&lt;hr&gt;
&lt;h3 id="-ä¸"&gt;âš–ï¸ &lt;strong&gt;ä¸ &lt;code&gt;compile&lt;/code&gt; ä¾èµ–çš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;provided&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;compile&lt;/code&gt;ï¼ˆé»˜è®¤ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–è¯‘é˜¶æ®µå¯ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æµ‹è¯•é˜¶æ®µå¯ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿è¡Œé˜¶æ®µå¯ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒï¼ˆç”±å¤–éƒ¨ç¯å¢ƒæä¾›ï¼‰&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆæ‰“åŒ…åˆ°äº§ç‰©ä¸­ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ˜¯å¦æ‰“å…¥æœ€ç»ˆåŒ…&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–ä¼ é€’æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…³é”®åŒºåˆ«&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;compile&lt;/code&gt; ä¾èµ–åœ¨&lt;strong&gt;æ‰€æœ‰é˜¶æ®µ&lt;/strong&gt;å‡æœ‰æ•ˆä¸”ä¼šæ‰“åŒ…åˆ°æœ€ç»ˆäº§ç‰©ï¼Œé€‚ç”¨äºé¡¹ç›®æ ¸å¿ƒåº“ï¼ˆå¦‚ Spring Coreã€æ•°æ®åº“è¿æ¥æ± ï¼‰&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;provided&lt;/code&gt; ä¾èµ–åœ¨&lt;strong&gt;è¿è¡Œæ—¶éœ€ç”±ç¯å¢ƒä¿éšœå¯ç”¨&lt;/strong&gt;ï¼Œå¦åˆ™ä¼šå¼•å‘ &lt;code&gt;ClassNotFoundException&lt;/code&gt;&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¯å¢ƒä¸€è‡´æ€§é£é™©&lt;/strong&gt;
è‹¥ç”Ÿäº§ç¯å¢ƒæœªæä¾›å£°æ˜ä¸º &lt;code&gt;provided&lt;/code&gt; çš„ä¾èµ–ï¼ˆå¦‚å®¹å™¨ç‰ˆæœ¬ä¸åŒ¹é…ï¼‰ï¼Œä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯&lt;a class="link" href="@ref" &gt;2,9&lt;/a&gt;ã€‚
â€‹&lt;strong&gt;å»ºè®®&lt;/strong&gt;â€‹ï¼šåœ¨æ–‡æ¡£ä¸­æ˜ç¡®æ ‡æ³¨æ‰€éœ€çš„ç¯å¢ƒä¾èµ–ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…æ»¥ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»…å¯¹&lt;strong&gt;ç¡®ç”±å¤–éƒ¨ç¯å¢ƒæä¾›&lt;/strong&gt;çš„ä¾èµ–ä½¿ç”¨ &lt;code&gt;provided&lt;/code&gt;ï¼Œå¦åˆ™ä¼šå¯¼è‡´è¿è¡Œæ—¶ç±»ç¼ºå¤±&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;éå®¹å™¨ç¯å¢ƒï¼ˆå¦‚ç‹¬ç«‹ Java åº”ç”¨ï¼‰ä¸­æ…ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ &lt;code&gt;optional&lt;/code&gt; çš„åŒºåˆ«&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;optional&lt;/code&gt; è¡¨ç¤ºä¾èµ–æ˜¯&lt;strong&gt;å¯é€‰çš„&lt;/strong&gt;ï¼ˆå¦‚å¤šæ•°æ®åº“é©±åŠ¨ï¼‰ï¼Œä¸ä¼ é€’ä¹Ÿä¸å¼ºåˆ¶æ‰“åŒ…ï¼Œä½†&lt;strong&gt;ä¸å½±å“è¿è¡Œæ—¶åŠŸèƒ½&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;provided&lt;/code&gt; æ˜¯&lt;strong&gt;å¿…éœ€çš„&lt;/strong&gt;ï¼Œä»…è¿è¡Œæ—¶ç”±å¤–éƒ¨æä¾›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;provided&lt;/code&gt; ä¾èµ–æ˜¯ Maven ä¸­è§£å†³ &lt;strong&gt;â€œç¯å¢ƒå·²æä¾›ã€é¡¹ç›®ä¸æ‰“åŒ…â€&lt;/strong&gt; åœºæ™¯çš„æ ¸å¿ƒæœºåˆ¶ï¼Œé€šè¿‡&lt;strong&gt;ç²¾å‡†æ§åˆ¶ä¾èµ–çš„ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;ï¼Œé¿å…äº†ç±»å†²çªå¹¶ä¼˜åŒ–äº†æ„å»ºäº§ç‰©å¤§å°ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å†—ä½™&lt;/strong&gt;ï¼šé˜²æ­¢ä¸å®¹å™¨/JDK æä¾›çš„ JAR åŒ…é‡å¤æ‰“åŒ…&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³å†²çª&lt;/strong&gt;ï¼šæ¶ˆé™¤å› ç›¸åŒç±»è¢«å¤šæ¬¡åŠ è½½å¯¼è‡´çš„ &lt;code&gt;LinkageError&lt;/code&gt;&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡åŒ–éƒ¨ç½²&lt;/strong&gt;ï¼šå‡å°‘æ„å»ºäº§ç‰©ä½“ç§¯ï¼Œæå‡åˆ†å‘æ•ˆç‡ã€‚
&lt;strong&gt;ä½¿ç”¨å‡†åˆ™&lt;/strong&gt;ï¼šæ˜ç¡®ä¾èµ–æ¥æºï¼Œç¡®ä¿ç”Ÿäº§ç¯å¢ƒä¸å¼€å‘/æµ‹è¯•ç¯å¢ƒçš„ä¸€è‡´æ€§ï¼ŒåŒæ—¶å¯¹éå®¹å™¨æä¾›çš„ä¾èµ–æ…ç”¨æ­¤èŒƒå›´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="maven-ä¾èµ–èŒƒå›´"&gt;Maven ä¾èµ–èŒƒå›´
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ Maven ä¾èµ–èŒƒå›´ï¼ˆDependency Scopeï¼‰çš„å…¨é¢è§£æï¼Œç»“åˆå…¶å®šä¹‰ã€é€‚ç”¨åœºæ™¯åŠå®é™…å½±å“ï¼Œå¸®åŠ©å¼€å‘è€…ç²¾å‡†ç®¡ç†é¡¹ç›®ä¾èµ–ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä¾èµ–èŒƒå›´è¯¦è§£"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒä¾èµ–èŒƒå›´è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;compile&lt;/code&gt;ï¼ˆé»˜è®¤èŒƒå›´ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä¾èµ–åœ¨&lt;strong&gt;ç¼–è¯‘ã€æµ‹è¯•ã€è¿è¡Œæ—¶&lt;/strong&gt;å‡æœ‰æ•ˆï¼Œé»˜è®¤èŒƒå›´&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;åŒ…å«åœ¨ç¼–è¯‘ç±»è·¯å¾„ã€æµ‹è¯•ç±»è·¯å¾„ã€è¿è¡Œæ—¶ç±»è·¯å¾„ã€‚&lt;/li&gt;
&lt;li&gt;ä¼š&lt;strong&gt;æ‰“åŒ…åˆ°æœ€ç»ˆæ„å»ºäº§ç‰©&lt;/strong&gt;ï¼ˆJAR/WARï¼‰ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;å…·æœ‰&lt;strong&gt;ä¼ é€’æ€§&lt;/strong&gt;ï¼ˆä¾èµ–ä¼šä¼ é€’ç»™å…¶ä»–æ¨¡å—ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šé¡¹ç›®æ ¸å¿ƒåº“ï¼ˆå¦‚ Spring Coreã€Apache Commonsï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;provided&lt;/code&gt;ï¼ˆå·²æä¾›èŒƒå›´ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä¾èµ–åœ¨&lt;strong&gt;ç¼–è¯‘å’Œæµ‹è¯•æ—¶&lt;/strong&gt;éœ€è¦ï¼Œä½†&lt;strong&gt;è¿è¡Œæ—¶ç”±ç¯å¢ƒæä¾›&lt;/strong&gt;ï¼ˆå¦‚å®¹å™¨æˆ–JDKï¼‰&lt;a class="link" href="@ref" &gt;1,4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;ç¼–è¯‘/æµ‹è¯•ç±»è·¯å¾„æœ‰æ•ˆï¼Œ&lt;strong&gt;è¿è¡Œæ—¶ç±»è·¯å¾„æ— æ•ˆ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ‰“åŒ…&lt;/strong&gt;åˆ°æœ€ç»ˆæ„å»ºäº§ç‰©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ä¼ é€’æ€§&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;Servlet APIï¼ˆTomcat ç­‰å®¹å™¨å·²æä¾›ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Lombokï¼ˆä»…ç¼–è¯‘æœŸç”Ÿæ•ˆï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;runtime&lt;/code&gt;ï¼ˆè¿è¡Œæ—¶èŒƒå›´ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä¾èµ–åœ¨&lt;strong&gt;è¿è¡Œæ—¶å’Œæµ‹è¯•æ—¶&lt;/strong&gt;éœ€è¦ï¼Œä½†&lt;strong&gt;ç¼–è¯‘æ—¶ä¸éœ€è¦&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;ç¼–è¯‘ç±»è·¯å¾„æ— æ•ˆï¼Œ&lt;strong&gt;æµ‹è¯•/è¿è¡Œæ—¶ç±»è·¯å¾„æœ‰æ•ˆ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¼š&lt;strong&gt;æ‰“åŒ…&lt;/strong&gt;åˆ°æœ€ç»ˆæ„å»ºäº§ç‰©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éƒ¨åˆ†ä¼ é€’æ€§&lt;/strong&gt;ï¼ˆä¼ é€’è§„åˆ™è§ä¸‹æ–‡è¡¨æ ¼ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šJDBC é©±åŠ¨ï¼ˆå¦‚ &lt;code&gt;mysql-connector-java&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;test&lt;/code&gt;ï¼ˆæµ‹è¯•èŒƒå›´ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä¾èµ–&lt;strong&gt;ä»…åœ¨æµ‹è¯•é˜¶æ®µ&lt;/strong&gt;ï¼ˆç¼–è¯‘æµ‹è¯•ä»£ç ã€è¿è¡Œæµ‹è¯•ï¼‰æœ‰æ•ˆ&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸»ä»£ç ç¼–è¯‘å’Œè¿è¡Œæ—¶æ— æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ‰“åŒ…&lt;/strong&gt;åˆ°æœ€ç»ˆæ„å»ºäº§ç‰©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ä¼ é€’æ€§&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šå•å…ƒæµ‹è¯•æ¡†æ¶ï¼ˆå¦‚ JUnitã€Mockitoï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;system&lt;/code&gt;ï¼ˆç³»ç»ŸèŒƒå›´ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šç±»ä¼¼ &lt;code&gt;provided&lt;/code&gt;ï¼Œä½†éœ€é€šè¿‡ &lt;strong&gt;&lt;code&gt;systemPath&lt;/code&gt; æ˜¾å¼æŒ‡å®šæœ¬åœ°è·¯å¾„&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;3,5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;ç¼–è¯‘/æµ‹è¯•ç±»è·¯å¾„æœ‰æ•ˆï¼Œè¿è¡Œæ—¶æ— æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ‰“åŒ…&lt;/strong&gt;ä¸”&lt;strong&gt;æ— ä¼ é€’æ€§&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ¨èä½¿ç”¨&lt;/strong&gt;ï¼ˆç ´åæ„å»ºå¯ç§»æ¤æ€§ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;com.oracle&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;ojdbc6&amp;lt;/artifactId&amp;gt;
&amp;lt;scope&amp;gt;system&amp;lt;/scope&amp;gt;
&amp;lt;systemPath&amp;gt;${project.basedir}/lib/ojdbc6.jar&amp;lt;/systemPath&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;import&lt;/code&gt;ï¼ˆå¯¼å…¥èŒƒå›´ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä»…ç”¨äº &lt;code&gt;&amp;lt;dependencyManagement&amp;gt;&lt;/code&gt;ï¼Œ&lt;strong&gt;å¯¼å…¥å…¶ä»– POM çš„ä¾èµ–ç®¡ç†é…ç½®&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸å®é™…å¼•å…¥ä¾èµ–ï¼Œä»…ç®¡ç†ç‰ˆæœ¬å’ŒèŒƒå›´ã€‚&lt;/li&gt;
&lt;li&gt;é€‚ç”¨äº &lt;strong&gt;BOMï¼ˆBill of Materialsï¼‰æ–‡ä»¶&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼šç»Ÿä¸€ç®¡ç† Spring Boot æˆ– Spring Cloud çš„ä¾èµ–ç‰ˆæœ¬&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¾èµ–èŒƒå›´çš„å½±å“ä¸ä¼ é€’æ€§è§„åˆ™"&gt;ğŸ”— &lt;strong&gt;ä¾èµ–èŒƒå›´çš„å½±å“ä¸ä¼ é€’æ€§è§„åˆ™&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¾èµ–ä¼ é€’è§„åˆ™è¡¨"&gt;&lt;strong&gt;ä¾èµ–ä¼ é€’è§„åˆ™è¡¨&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç¬¬ä¸€ç›´æ¥ä¾èµ–èŒƒå›´&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¬¬äºŒç›´æ¥ä¾èµ–èŒƒå›´&lt;/strong&gt; â†’ ä¼ é€’ç»“æœ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;compile&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;compile&lt;/code&gt; â†’ &lt;code&gt;compile&lt;/code&gt; Â· &lt;code&gt;test&lt;/code&gt; â†’ âŒ Â· &lt;code&gt;runtime&lt;/code&gt; â†’ &lt;code&gt;runtime&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;provided&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä»»ä½•èŒƒå›´ â†’ âŒï¼ˆæ— ä¼ é€’ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;runtime&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;compile&lt;/code&gt; â†’ &lt;code&gt;runtime&lt;/code&gt; Â· &lt;code&gt;runtime&lt;/code&gt; â†’ &lt;code&gt;runtime&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;test&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä»»ä½•èŒƒå›´ â†’ âŒï¼ˆæ— ä¼ é€’ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ³¨&lt;/strong&gt;ï¼š&lt;code&gt;provided&lt;/code&gt; å’Œ &lt;code&gt;test&lt;/code&gt; ä¾èµ–æ°¸è¿œä¸ä¼šä¼ é€’&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é¿å…æ»¥ç”¨ provided
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿ç”Ÿäº§ç¯å¢ƒ&lt;strong&gt;ä¸€å®šæä¾›&lt;/strong&gt;è¯¥ä¾èµ–ï¼ˆå¦‚ Tomcat çš„ Servlet APIï¼‰ï¼Œå¦åˆ™å¼•å‘ &lt;code&gt;ClassNotFoundException&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨æ ‡å‡†ä»“åº“ä¾èµ–
&lt;ul&gt;
&lt;li&gt;é¿å… &lt;code&gt;system&lt;/code&gt; èŒƒå›´ï¼Œæ”¹ç”¨ &lt;code&gt;mvn install&lt;/code&gt; å°†æœ¬åœ°åº“å®‰è£…åˆ°ä»“åº“&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¾èµ–å†²çªè§£å†³
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¯å¾„æœ€è¿‘åŸåˆ™&lt;/strong&gt;ï¼šä¾èµ–è·¯å¾„çŸ­çš„ç‰ˆæœ¬ä¼˜å…ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€å…ˆå£°æ˜åŸåˆ™&lt;/strong&gt;ï¼šPOM ä¸­å…ˆå£°æ˜çš„ä¾èµ–ä¼˜å…ˆ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æµ‹è¯•ä¾èµ–éš”ç¦»
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰æµ‹è¯•åº“ï¼ˆå¦‚ JUnitï¼‰å¿…é¡»ç”¨ &lt;code&gt;test&lt;/code&gt; èŒƒå›´ï¼Œé˜²æ­¢æ±¡æŸ“ç”Ÿäº§åŒ…&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤šæ¨¡å—é¡¹ç›®ç®¡ç†
&lt;ul&gt;
&lt;li&gt;çˆ¶ POM ä½¿ç”¨ &lt;code&gt;&amp;lt;dependencyManagement&amp;gt;&lt;/code&gt; + &lt;code&gt;import&lt;/code&gt; èŒƒå›´ç»Ÿä¸€ç‰ˆæœ¬&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¾èµ–èŒƒå›´é€ŸæŸ¥è¡¨"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šä¾èµ–èŒƒå›´é€ŸæŸ¥è¡¨&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;èŒƒå›´&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼–è¯‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æµ‹è¯•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¿è¡Œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ‰“åŒ…&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼ é€’æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹ç”¨ä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;compile&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;Spring Core, Commons Lang&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;provided&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;Servlet API, Lombok&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;runtime&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âš ï¸Â¹&lt;/td&gt;
&lt;td&gt;JDBC é©±åŠ¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;test&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;JUnit, Mockito&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;system&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;æœ¬åœ°ç³»ç»Ÿåº“ï¼ˆä¸æ¨èï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;import&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;ç®¡ç† BOM ä¾èµ–ç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;Â¹ &lt;code&gt;runtime&lt;/code&gt; ä¼ é€’æ€§ï¼šå½“ç¬¬ä¸€ä¾èµ–ä¸º &lt;code&gt;compile&lt;/code&gt; æ—¶ï¼Œä¼ é€’ç»“æœä¸º &lt;code&gt;runtime&lt;/code&gt;ï¼›å¦åˆ™ä¸ç¬¬ä¸€ä¾èµ–èŒƒå›´ç›¸åŒ&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚
åˆç†é€‰æ‹©ä¾èµ–èŒƒå›´å¯æ˜¾è‘—ä¼˜åŒ–æ„å»ºæ•ˆç‡ã€å‡å°‘åŒ…ä½“ç§¯ï¼Œå¹¶è§„é¿ç¯å¢ƒå†²çªé—®é¢˜ã€‚å»ºè®®ç»“åˆ Maven å‘½ä»¤ &lt;code&gt;mvn dependency:tree -Dscope=compile&lt;/code&gt; åˆ†æå®é™…ä¾èµ–æ ‘&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="bom--pom"&gt;BOM &amp;amp; POM
&lt;/h2&gt;&lt;p&gt;åœ¨Javaç”Ÿæ€ä¸­ï¼Œ&lt;strong&gt;BOM&lt;/strong&gt;ï¼ˆBill of Materialsï¼Œç‰©æ–™æ¸…å•ï¼‰å’Œ&lt;strong&gt;POM&lt;/strong&gt;ï¼ˆProject Object Modelï¼Œé¡¹ç›®å¯¹è±¡æ¨¡å‹ï¼‰æ˜¯Mavenä¾èµ–ç®¡ç†å’Œé¡¹ç›®æ„å»ºçš„æ ¸å¿ƒæ¦‚å¿µï¼ŒäºŒè€…ååŒå·¥ä½œä½†èŒè´£ä¸åŒã€‚ä»¥ä¸‹è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-bomç»Ÿä¸€ä¾èµ–ç‰ˆæœ¬çš„å…¼å®¹æ€§æ¸…å•"&gt;âš™ï¸ &lt;strong&gt;BOMï¼šç»Ÿä¸€ä¾èµ–ç‰ˆæœ¬çš„â€œå…¼å®¹æ€§æ¸…å•â€&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å®šä¹‰ä¸ä½œç”¨"&gt;&lt;strong&gt;å®šä¹‰ä¸ä½œç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;ï¼šè§£å†³å¤šæ¨¡å—é¡¹ç›®ä¸­&lt;strong&gt;ä¾èµ–ç‰ˆæœ¬å†²çª&lt;/strong&gt;é—®é¢˜ï¼Œç¡®ä¿ä¸€ç»„å…³è”åº“ï¼ˆå¦‚Springå…¨å®¶æ¡¶ã€Nettyæ¨¡å—ï¼‰çš„ç‰ˆæœ¬å…¼å®¹æ€§&lt;a class="link" href="@ref" &gt;1,4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;ï¼šBOMæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„POMæ–‡ä»¶ï¼Œåœ¨&lt;code&gt;&amp;lt;dependencyManagement&amp;gt;&lt;/code&gt;ä¸­å®šä¹‰&lt;strong&gt;å®¶æ—å¼ä¾èµ–&lt;/strong&gt;ï¼ˆå¦‚Jettyã€Nettyçš„æ‰€æœ‰å­æ¨¡å—ï¼‰çš„æ¨èç‰ˆæœ¬ï¼Œä½†ä¸ç›´æ¥å¼•å…¥ä¾èµ–&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä½¿ç”¨åœºæ™¯"&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤§å‹æ¡†æ¶é›†æˆ&lt;/strong&gt;ï¼šä¾‹å¦‚Spring Bootçš„&lt;code&gt;spring-boot-dependencies&lt;/code&gt;ï¼Œç®¡ç†Springç”Ÿæ€åŠç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚Jacksonã€Logbackï¼‰çš„å…¼å®¹ç‰ˆæœ¬&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼ä¸šçº§å¤šæ¨¡å—é¡¹ç›®&lt;/strong&gt;ï¼šç»Ÿä¸€å†…éƒ¨è‡ªç ”åº“çš„ç‰ˆæœ¬ï¼Œé¿å…å„æ¨¡å—éšæ„æŒ‡å®šç‰ˆæœ¬å¯¼è‡´å†²çª&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å·¥ä½œåŸç†"&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;!-- åœ¨çˆ¶POMä¸­å¼•å…¥BOM --&amp;gt;
&amp;lt;dependencyManagement&amp;gt;
&amp;lt;dependencies&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-boot-dependencies&amp;lt;/artifactId&amp;gt;
&amp;lt;version&amp;gt;3.0.0&amp;lt;/version&amp;gt;
&amp;lt;type&amp;gt;pom&amp;lt;/type&amp;gt;
&amp;lt;scope&amp;gt;import&amp;lt;/scope&amp;gt; &amp;lt;!-- å…³é”®ï¼šscope=import --&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&amp;lt;/dependencyManagement&amp;gt;
&amp;lt;!-- å­æ¨¡å—ç›´æ¥ä½¿ç”¨ä¾èµ–ï¼ˆæ— éœ€ç‰ˆæœ¬å·ï¼‰ --&amp;gt;
&amp;lt;dependencies&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-boot-starter-web&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;scope=import&lt;/code&gt;&lt;/strong&gt;ï¼šå°†BOMä¸­çš„ç‰ˆæœ¬å®šä¹‰åˆå¹¶åˆ°å½“å‰POMçš„&lt;code&gt;&amp;lt;dependencyManagement&amp;gt;&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¼˜åŠ¿"&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ç‰ˆæœ¬å†²çª&lt;/strong&gt;ï¼šå¼ºåˆ¶æ‰€æœ‰æ¨¡å—ä½¿ç”¨BOMå®šä¹‰çš„ç‰ˆæœ¬ï¼Œæ¶ˆé™¤â€œä¾èµ–åœ°ç‹±â€&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–é…ç½®&lt;/strong&gt;ï¼šå­æ¨¡å—å£°æ˜ä¾èµ–æ—¶æ— éœ€æŒ‡å®šç‰ˆæœ¬&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ä¸­å‡çº§&lt;/strong&gt;ï¼šä¿®æ”¹BOMç‰ˆæœ¬å³å¯å…¨å±€å‡çº§ä¾èµ–&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-pomé¡¹ç›®æ„å»ºçš„å…ƒæ•°æ®è“å›¾"&gt;ğŸ“¦ &lt;strong&gt;POMï¼šé¡¹ç›®æ„å»ºçš„â€œå…ƒæ•°æ®è“å›¾â€&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å®šä¹‰ä¸ä½œç”¨-1"&gt;&lt;strong&gt;å®šä¹‰ä¸ä½œç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;ï¼šæè¿°é¡¹ç›®çš„&lt;strong&gt;ç»“æ„ã€ä¾èµ–ã€æ„å»ºè§„åˆ™&lt;/strong&gt;ï¼Œæ˜¯Mavenæ„å»ºè¿‡ç¨‹çš„å”¯ä¸€ä¾æ®&lt;a class="link" href="@ref" &gt;3,8,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†æ–‡ä»¶&lt;/strong&gt;ï¼šé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„&lt;code&gt;pom.xml&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…³é”®å…ƒç´ "&gt;&lt;strong&gt;å…³é”®å…ƒç´ &lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å…ƒç´ &lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;groupId&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç»„ç»‡æ ‡è¯†ï¼ˆåå‘åŸŸåï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;groupId&amp;gt;com.example&amp;lt;/groupId&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;artifactId&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é¡¹ç›®å”¯ä¸€æ ‡è¯†&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;artifactId&amp;gt;my-app&amp;lt;/artifactId&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;version&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é¡¹ç›®ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;version&amp;gt;1.0-SNAPSHOT&amp;lt;/version&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;packaging&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰“åŒ…ç±»å‹ï¼ˆjar/war/pomï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;packaging&amp;gt;jar&amp;lt;/packaging&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;dependencies&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å£°æ˜é¡¹ç›®ä¾èµ–&lt;/td&gt;
&lt;td&gt;è§ä¸‹æ–¹ç¤ºä¾‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;dependencyManagement&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç®¡ç†ä¾èµ–ç‰ˆæœ¬ï¼ˆä¾›å­æ¨¡å—ç»§æ‰¿ï¼‰&lt;/td&gt;
&lt;td&gt;å®šä¹‰BOMæˆ–ç»Ÿä¸€ç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;build&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é…ç½®æ„å»ºæ’ä»¶ï¼ˆç¼–è¯‘ã€æ‰“åŒ…ç­‰ï¼‰&lt;/td&gt;
&lt;td&gt;æŒ‡å®šJDKç‰ˆæœ¬ã€èµ„æºç›®å½•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;properties&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®šä¹‰å…¨å±€å˜é‡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;java.version&amp;gt;11&amp;lt;/java.version&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æ ¸å¿ƒåŠŸèƒ½"&gt;&lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ä¾èµ–ç®¡ç†ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;dependencies&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;
&amp;lt;version&amp;gt;4.12&amp;lt;/version&amp;gt;
&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt; &amp;lt;!-- ä½œç”¨åŸŸæ§åˆ¶ --&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;æ„å»ºç”Ÿå‘½å‘¨æœŸæ§åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;clean&lt;/strong&gt;ï¼šåˆ é™¤&lt;code&gt;target&lt;/code&gt;ç›®å½•&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;compile&lt;/strong&gt;ï¼šç¼–è¯‘ä¸»ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;test&lt;/strong&gt;ï¼šè¿è¡Œå•å…ƒæµ‹è¯•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;package&lt;/strong&gt;ï¼šç”ŸæˆJAR/WARåŒ…&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤šæ¨¡å—èšåˆï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;!-- çˆ¶æ¨¡å—ï¼ˆpackaging=pomï¼‰ --&amp;gt;
&amp;lt;modules&amp;gt;
&amp;lt;module&amp;gt;module-a&amp;lt;/module&amp;gt;
&amp;lt;module&amp;gt;module-b&amp;lt;/module&amp;gt;
&amp;lt;/modules&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-bomä¸pomçš„å…³ç³»ä¸å¯¹æ¯”"&gt;ğŸ”„ &lt;strong&gt;BOMä¸POMçš„å…³ç³»ä¸å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;BOM&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;POM&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç‰¹æ®ŠPOMï¼ˆä»…å«&lt;code&gt;&amp;lt;dependencyManagement&amp;gt;&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æ ‡å‡†é¡¹ç›®é…ç½®æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»è¦ä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»Ÿä¸€ç®¡ç†&lt;strong&gt;ä¾èµ–ç‰ˆæœ¬&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®šä¹‰&lt;strong&gt;é¡¹ç›®ç»“æ„ã€ä¾èµ–ã€æ„å»ºè§„åˆ™&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è§£å†³å®¶æ—å¼ä¾èµ–å…¼å®¹æ€§é—®é¢˜&lt;/td&gt;
&lt;td&gt;ä»»ä½•Mavené¡¹ç›®çš„åŸºç¡€é…ç½®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ˜¯å¦å¼•å…¥ä¾èµ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒï¼ˆä»…å®šä¹‰ç‰ˆæœ¬ï¼‰&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆé€šè¿‡&lt;code&gt;&amp;lt;dependencies&amp;gt;&lt;/code&gt;å¼•å…¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®æ ‡è¯†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;scope&amp;gt;import&amp;lt;/scope&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;lt;packaging&amp;gt;jar/war/pom&amp;lt;/packaging&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ååŒå·¥ä½œç¤ºä¾‹"&gt;&lt;strong&gt;ååŒå·¥ä½œç¤ºä¾‹&lt;/strong&gt;ï¼š
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çˆ¶POM&lt;/strong&gt;ï¼šå¼•å…¥BOMå¹¶ç®¡ç†å…¬å…±é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­æ¨¡å—POM&lt;/strong&gt;ï¼šç»§æ‰¿çˆ¶POMï¼Œç›´æ¥ä½¿ç”¨BOMä¸­çš„ä¾èµ–ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„å»ºæµç¨‹&lt;/strong&gt;ï¼šMavenè¯»å–POM â†’ è§£æBOMç‰ˆæœ¬ â†’ ä¸‹è½½ä¾èµ– â†’ æ‰§è¡Œæ„å»º&lt;a class="link" href="@ref" &gt;1,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¸¸è§é—®é¢˜ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;å¸¸è§é—®é¢˜ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;BOMçš„è¯¯ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é”™è¯¯ï¼šå°†BOMæ”¾åœ¨&lt;code&gt;&amp;lt;dependencies&amp;gt;&lt;/code&gt;è€Œé&lt;code&gt;&amp;lt;dependencyManagement&amp;gt;&lt;/code&gt;ä¸­ï¼Œå¯¼è‡´ç›´æ¥å¼•å…¥æ— ç”¨ä¾èµ–ã€‚&lt;/li&gt;
&lt;li&gt;æ­£ç¡®ï¼šä»…ç”¨&lt;code&gt;&amp;lt;scope&amp;gt;import&lt;/code&gt;å¯¼å…¥ç‰ˆæœ¬å®šä¹‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;POMè‡ƒè‚¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦æ–¹æ¡ˆ&lt;/strong&gt;ï¼šå°†æ’ä»¶é…ç½®ã€å±æ€§å®šä¹‰æ‹†åˆ†åˆ°çˆ¶POMï¼Œå­æ¨¡å—ä»…å£°æ˜ä¸šåŠ¡ä¾èµ–&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬å†²çªä¼˜å…ˆçº§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Mavenè§„åˆ™ï¼š&lt;strong&gt;å°±è¿‘åŸåˆ™&lt;/strong&gt;ï¼ˆä¾èµ–æ ‘ä¸­è·¯å¾„æœ€çŸ­çš„ç‰ˆæœ¬ç”Ÿæ•ˆï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åº”å¯¹ï¼šç”¨&lt;code&gt;mvn dependency:tree&lt;/code&gt;åˆ†æä¾èµ–æ ‘ï¼Œé€šè¿‡&lt;code&gt;&amp;lt;exclusions&amp;gt;&lt;/code&gt;æ’é™¤å†²çªç‰ˆæœ¬&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;BOM&lt;/strong&gt;ï¼šæ˜¯â€œ&lt;strong&gt;ç‰ˆæœ¬å…¼å®¹æ€§åˆçº¦&lt;/strong&gt;â€ï¼Œé€šè¿‡é›†ä¸­ç®¡ç†å®¶æ—å¼ä¾èµ–çš„ç‰ˆæœ¬ï¼Œç¡®ä¿æ¨¡å—é—´åä½œæ— å†²çª&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;POM&lt;/strong&gt;ï¼šæ˜¯â€œ&lt;strong&gt;é¡¹ç›®æ„å»ºè¯´æ˜ä¹¦&lt;/strong&gt;â€ï¼Œå®šä¹‰ä»ç¼–ç åˆ°éƒ¨ç½²çš„å…¨ç”Ÿå‘½å‘¨æœŸè§„åˆ™&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;ã€‚
&lt;strong&gt;äºŒè€…å…³ç³»&lt;/strong&gt;ï¼šBOMæ˜¯POMçš„é«˜çº§åº”ç”¨ï¼Œé€šè¿‡&lt;code&gt;&amp;lt;dependencyManagement&amp;gt;&lt;/code&gt; + &lt;code&gt;import&lt;/code&gt;ä½œç”¨åŸŸå®ç°ç‰ˆæœ¬ä»²è£ï¼Œæœ€ç»ˆç”±POMé©±åŠ¨æ„å»ºæ‰§è¡Œã€‚æŒæ¡ä¸¤è€…åŒºåˆ«ä¸è”åŠ¨ï¼Œæ˜¯é«˜æ•ˆç®¡ç†Javaé¡¹ç›®çš„å…³é”®èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Javaã€‘JVM</title><link>https://dyhes.github.io/p/javajvm/</link><pubDate>Sat, 21 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javajvm/</guid><description>&lt;h2 id="jvm"&gt;JVM
&lt;/h2&gt;&lt;p&gt;JVMï¼ˆJava Virtual Machineï¼ŒJavaè™šæ‹Ÿæœºï¼‰æ˜¯Javaç¨‹åºè¿è¡Œçš„æ ¸å¿ƒç¯å¢ƒï¼Œè´Ÿè´£æ‰§è¡Œå­—èŠ‚ç ã€ç®¡ç†å†…å­˜ã€ä¼˜åŒ–æ€§èƒ½ï¼Œå¹¶å®ç°Javaâ€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œâ€çš„è·¨å¹³å°ç‰¹æ€§ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒæœºåˆ¶ä¸æ¶æ„çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-jvmçš„å®šä¹‰ä¸æ ¸å¿ƒä½œç”¨"&gt;ğŸ” JVMçš„å®šä¹‰ä¸æ ¸å¿ƒä½œç”¨
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;
JVMæ˜¯ä¸€ä¸ª&lt;strong&gt;æŠ½è±¡åŒ–çš„è®¡ç®—æœº&lt;/strong&gt;ï¼Œé€šè¿‡è½¯ä»¶æ¨¡æ‹Ÿç¡¬ä»¶æ¶æ„ï¼ˆå¦‚å¤„ç†å™¨ã€å †æ ˆã€å¯„å­˜å™¨ï¼‰å’ŒæŒ‡ä»¤ç³»ç»Ÿï¼Œå±è”½åº•å±‚æ“ä½œç³»ç»Ÿå·®å¼‚ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒåŠŸèƒ½
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¨å¹³å°æ‰§è¡Œ&lt;/strong&gt;ï¼šå°†Javaæºä»£ç ç¼–è¯‘ä¸ºå¹³å°æ— å…³çš„å­—èŠ‚ç ï¼ˆ&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ï¼‰ï¼Œç”±JVMåœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šè§£é‡Šæˆ–ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨æŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç®¡ç†&lt;/strong&gt;ï¼šè‡ªåŠ¨åˆ†é…å†…å­˜ï¼ˆå †ã€æ ˆç­‰ï¼‰å¹¶å›æ”¶åƒåœ¾å¯¹è±¡ï¼ˆGCæœºåˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œä¼˜åŒ–&lt;/strong&gt;ï¼šé€šè¿‡è§£é‡Šå™¨ä¸JITç¼–è¯‘å™¨ç»“åˆï¼ŒåŠ¨æ€ä¼˜åŒ–çƒ­ç‚¹ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-jvmæ ¸å¿ƒæ¶æ„"&gt;ğŸ§© JVMæ ¸å¿ƒæ¶æ„
&lt;/h3&gt;&lt;p&gt;JVMç”±ä»¥ä¸‹å››å¤§æ¨¡å—ååŒå·¥ä½œï¼š&lt;/p&gt;
&lt;h4 id="ç±»åŠ è½½å­ç³»ç»Ÿclass-loader"&gt;&lt;strong&gt;ç±»åŠ è½½å­ç³»ç»Ÿï¼ˆClass Loaderï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;ï¼šåŠ è½½å­—èŠ‚ç ï¼ˆ&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ï¼‰åˆ°å†…å­˜ï¼Œç”Ÿæˆ&lt;code&gt;Class&lt;/code&gt;å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;åŠ è½½å™¨å±‚çº§ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯åŠ¨ç±»åŠ è½½å™¨&lt;/strong&gt;ï¼šåŠ è½½æ ¸å¿ƒç±»åº“ï¼ˆå¦‚&lt;code&gt;java.lang.*&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•ç±»åŠ è½½å™¨&lt;/strong&gt;ï¼šåŠ è½½æ‰©å±•ç›®å½•çš„ç±»ï¼ˆ&lt;code&gt;javax.*&lt;/code&gt;ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨ç±»åŠ è½½å™¨&lt;/strong&gt;ï¼šåŠ è½½ç”¨æˆ·è‡ªå®šä¹‰ç±»ï¼ˆClassPathè·¯å¾„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒäº²å§”æ´¾æ¨¡å‹&lt;/strong&gt;ï¼šé¿å…é‡å¤åŠ è½½ï¼Œç¡®ä¿ç±»å®‰å…¨ï¼ˆå­åŠ è½½å™¨å§”æ‰˜çˆ¶åŠ è½½å™¨ä¼˜å…ˆå¤„ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è¿è¡Œæ—¶æ•°æ®åŒºruntime-data-area"&gt;&lt;strong&gt;è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆRuntime Data Areaï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;JVMå†…å­˜åˆ’åˆ†ä¸ºä»¥ä¸‹åŒºåŸŸï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åŒºåŸŸ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;çº¿ç¨‹å…³ç³»&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¼‚å¸¸åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å †ï¼ˆHeapï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…±äº«&lt;/td&gt;
&lt;td&gt;å­˜å‚¨å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ï¼ŒGCä¸»åŒºåŸŸ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;OutOfMemoryError: Java heap space&lt;/code&gt;ï¼ˆå¯¹è±¡è¿‡å¤š/å†…å­˜æ³„æ¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…±äº«&lt;/td&gt;
&lt;td&gt;å­˜å‚¨ç±»å…ƒä¿¡æ¯ã€å¸¸é‡æ± ã€é™æ€å˜é‡ï¼ˆJDK8+ç§°å…ƒç©ºé—´/Metaspaceï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;OutOfMemoryError: Metaspace&lt;/code&gt;ï¼ˆç±»åŠ è½½è¿‡å¤šï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è™šæ‹Ÿæœºæ ˆï¼ˆJVM Stackï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç§æœ‰&lt;/td&gt;
&lt;td&gt;å­˜å‚¨æ–¹æ³•è°ƒç”¨çš„æ ˆå¸§ï¼ˆå±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ç­‰ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;StackOverflowError&lt;/code&gt;ï¼ˆé€’å½’è¿‡æ·±ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Stackï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç§æœ‰&lt;/td&gt;
&lt;td&gt;æ”¯æŒæœ¬åœ°æ–¹æ³•ï¼ˆå¦‚JNIè°ƒç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;åŒè™šæ‹Ÿæœºæ ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¨‹åºè®¡æ•°å™¨ï¼ˆPC Registerï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç§æœ‰&lt;/td&gt;
&lt;td&gt;è®°å½•å½“å‰çº¿ç¨‹æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤åœ°å€&lt;/td&gt;
&lt;td&gt;å”¯ä¸€æ— å†…å­˜æº¢å‡ºåŒºåŸŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šJDK8å¼€å§‹ï¼Œæ–¹æ³•åŒºç”±æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰æ”¹ä¸ºå…ƒç©ºé—´ï¼ˆMetaspaceï¼‰ï¼Œç›´æ¥ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œé¿å…å †å†…å­˜æº¢å‡ºé£é™©ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id="æ‰§è¡Œå¼•æ“execution-engine"&gt;&lt;strong&gt;æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£é‡Šå™¨&lt;/strong&gt;ï¼šé€è¡Œè§£é‡Šå­—èŠ‚ç ï¼Œå¯åŠ¨å¿«ä½†æ‰§è¡Œæ•ˆç‡ä½ã€‚&lt;/li&gt;
&lt;li&gt;å³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çƒ­ç‚¹æ¢æµ‹&lt;/strong&gt;ï¼šé€šè¿‡æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨å’Œå¾ªç¯å›è¾¹è®¡æ•°å™¨è¯†åˆ«é«˜é¢‘ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å±‚ç¼–è¯‘&lt;/strong&gt;ï¼šç»“åˆC1ï¼ˆè½»é‡ä¼˜åŒ–ï¼Œå¯åŠ¨å¿«ï¼‰å’ŒC2ï¼ˆæ·±åº¦ä¼˜åŒ–ï¼Œæ€§èƒ½é«˜ï¼‰ç¼–è¯‘å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰&lt;/strong&gt;ï¼šè‡ªåŠ¨å›æ”¶å †å†…å­˜ä¸­çš„æ— æ•ˆå¯¹è±¡ï¼ˆè¯¦â»…ç¬¬å››éƒ¨åˆ†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æœ¬åœ°æ¥å£ä¸æœ¬åœ°åº“jni--native-libraries"&gt;&lt;strong&gt;æœ¬åœ°æ¥å£ä¸æœ¬åœ°åº“ï¼ˆJNI &amp;amp; Native Librariesï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;JNI&lt;/strong&gt;ï¼šæä¾›Javaè°ƒç”¨æœ¬åœ°æ–¹æ³•ï¼ˆå¦‚C/C++ï¼‰çš„æ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°åº“&lt;/strong&gt;ï¼šåŒ…å«æ“ä½œç³»ç»Ÿçº§åˆ«çš„åº“æ–‡ä»¶ï¼ˆå¦‚&lt;code&gt;.dll&lt;/code&gt;ã€&lt;code&gt;.so&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å­˜ç®¡ç†ä¸åƒåœ¾å›æ”¶gc"&gt;â™»ï¸ å†…å­˜ç®¡ç†ä¸åƒåœ¾å›æ”¶ï¼ˆGCï¼‰
&lt;/h3&gt;&lt;h4 id="å †å†…å­˜åˆ†ä»£æ¨¡å‹"&gt;&lt;strong&gt;å †å†…å­˜åˆ†ä»£æ¨¡å‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;EdenåŒºï¼šæ–°å¯¹è±¡åˆ†é…åŒºï¼Œæ»¡æ—¶è§¦å‘ &lt;strong&gt;Minor GC&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;SurvivoråŒºï¼ˆS0/S1ï¼‰ï¼šå­˜æ”¾EdenåŒºGCåå­˜æ´»çš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è€å¹´ä»£ï¼ˆOld Generationï¼‰&lt;/strong&gt;ï¼šé•¿æœŸå­˜æ´»çš„å¯¹è±¡ï¼ˆSurvivoråŒºå¤šæ¬¡GCåä»å­˜æ´»ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰&lt;/strong&gt;ï¼šç±»å…ƒæ•°æ®å­˜å‚¨ï¼ˆJDK8+ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åƒåœ¾å›æ”¶ç®—æ³•ä¸å›æ”¶å™¨"&gt;&lt;strong&gt;åƒåœ¾å›æ”¶ç®—æ³•ä¸å›æ”¶å™¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ç®—æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;å¤åˆ¶ç®—æ³•ï¼ˆæ–°ç”Ÿä»£ï¼‰ï¼šå°†å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°SurvivoråŒºï¼Œæ¸…ç©ºEdenã€‚&lt;/li&gt;
&lt;li&gt;æ ‡è®°-æ¸…é™¤/æ•´ç†ï¼ˆè€å¹´ä»£ï¼‰ï¼šæ ‡è®°æ— æ•ˆå¯¹è±¡åæ¸…é™¤æˆ–æ•´ç†å†…å­˜ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸»æµå›æ”¶å™¨ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Serial GC&lt;/strong&gt;ï¼šå•çº¿ç¨‹ï¼Œé€‚åˆå®¢æˆ·ç«¯åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Parallel GC&lt;/strong&gt;ï¼šå¤šçº¿ç¨‹å¹¶è¡Œå›æ”¶ï¼Œååé‡ä¼˜å…ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CMS&lt;/strong&gt;ï¼šå¹¶å‘æ ‡è®°æ¸…é™¤ï¼Œå‡å°‘åœé¡¿æ—¶é—´ï¼ˆå·²æ·˜æ±°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;G1&lt;/strong&gt;ï¼šåˆ†åŒºå›æ”¶ï¼Œå¹³è¡¡ååä¸å»¶è¿Ÿï¼ˆJDK9+é»˜è®¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ZGC/Shenandoah&lt;/strong&gt;ï¼šè¶…ä½å»¶è¿Ÿï¼ˆåœé¡¿&amp;lt;10msï¼‰ï¼Œé€‚åˆäº‘åŸç”Ÿåœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-jvmè¿è¡Œæœºåˆ¶ä¸è·¨å¹³å°åŸç†"&gt;âš™ï¸ JVMè¿è¡Œæœºåˆ¶ä¸è·¨å¹³å°åŸç†
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ‰§è¡Œæµç¨‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[Javaæºç  .java] --&amp;gt; B[javacç¼–è¯‘]
B --&amp;gt; C[å­—èŠ‚ç  .class]
C --&amp;gt; D[JVMåŠ è½½]
D --&amp;gt; E[è§£é‡Šå™¨/JITæ‰§è¡Œ]
E --&amp;gt; F[æ“ä½œç³»ç»Ÿæ‰§è¡Œ]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å­—èŠ‚ç ç”±JVMåŠ è½½åï¼Œé€šè¿‡&lt;strong&gt;è§£é‡Šå™¨é€è¡Œæ‰§è¡Œ&lt;/strong&gt;æˆ–&lt;strong&gt;JITç¼–è¯‘ä¸ºæœºå™¨ç &lt;/strong&gt;æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è·¨å¹³å°å®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸åŒå¹³å°çš„JVMï¼ˆå¦‚Windows/Linuxç‰ˆHotSpotï¼‰å°†&lt;strong&gt;ç»Ÿä¸€å­—èŠ‚ç ç¿»è¯‘ä¸ºæœ¬åœ°æŒ‡ä»¤&lt;/strong&gt;ï¼Œæ— éœ€ä¿®æ”¹æºç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµjvmå®ç°ä¸è°ƒä¼˜"&gt;ğŸš€ ä¸»æµJVMå®ç°ä¸è°ƒä¼˜
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ä¸»æµå®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HotSpot&lt;/strong&gt;ï¼šOracle JDKé»˜è®¤ï¼Œæ€§èƒ½ä¼˜è¶Šï¼ˆå¦‚åˆ†å±‚ç¼–è¯‘ã€å¤šGCå™¨æ”¯æŒï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;OpenJ9&lt;/strong&gt;ï¼šIBMå¼€æºï¼Œä½å†…å­˜å ç”¨ï¼ˆé€‚åˆå®¹å™¨ç¯å¢ƒï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GraalVM&lt;/strong&gt;ï¼šæ”¯æŒå¤šè¯­è¨€ï¼ˆJS/Pythonï¼‰ï¼Œé«˜æ€§èƒ½ç¼–è¯‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è°ƒä¼˜å…³é”®å‚æ•°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å †å†…å­˜&lt;/strong&gt;ï¼š&lt;code&gt;-Xms&lt;/code&gt;ï¼ˆåˆå§‹å †ï¼‰ã€&lt;code&gt;-Xmx&lt;/code&gt;ï¼ˆæœ€å¤§å †ï¼‰ã€&lt;code&gt;-Xmn&lt;/code&gt;ï¼ˆæ–°ç”Ÿä»£å¤§å°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ƒç©ºé—´&lt;/strong&gt;ï¼š&lt;code&gt;-XX:MetaspaceSize&lt;/code&gt;ã€&lt;code&gt;-XX:MaxMetaspaceSize&lt;/code&gt;ï¼ˆJDK8+ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GCé€‰æ‹©&lt;/strong&gt;ï¼š&lt;code&gt;-XX:+UseG1GC&lt;/code&gt;ï¼ˆå¯ç”¨G1å›æ”¶å™¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;JVMæ˜¯Javaç”Ÿæ€çš„åŸºçŸ³ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è·¨å¹³å°æ€§&lt;/strong&gt;ï¼šé€šè¿‡å­—èŠ‚ç ä¸å¹³å°ä¸“å±JVMè§£è€¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ€§èƒ½&lt;/strong&gt;ï¼šJITçƒ­ç‚¹ç¼–è¯‘+GCè‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œå…¼é¡¾å¯åŠ¨é€Ÿåº¦ä¸è¿è¡Œæ—¶æ•ˆç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ä¼˜åŒ–&lt;/strong&gt;ï¼šåŸºäºè¿è¡Œæ—¶æ•°æ®è‡ªé€‚åº”è°ƒæ•´ç¼–è¯‘ç­–ç•¥ä¸å†…å­˜åˆ†é…ã€‚
ç†è§£JVMæ¶æ„ä¸è°ƒä¼˜æœºåˆ¶ï¼Œæ˜¯è§£å†³OOMã€GCåœé¡¿ã€æ€§èƒ½ç“¶é¢ˆç­‰é—®é¢˜çš„å…³é”®ï¼Œå°¤å…¶å¯¹é«˜å¹¶å‘ã€ä½å»¶è¿Ÿåœºæ™¯ï¼ˆå¦‚å¾®æœåŠ¡ã€å¤§æ•°æ®ï¼‰è‡³å…³é‡è¦ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="hotspot"&gt;HotSpot
&lt;/h2&gt;&lt;p&gt;JVM HotSpotï¼ˆæˆ–ç§° HotSpot JVMï¼‰æ˜¯ Oracle å®˜æ–¹å¼€å‘çš„&lt;strong&gt;é«˜æ€§èƒ½ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰å®ç°&lt;/strong&gt;ï¼Œä¹Ÿæ˜¯ç›®å‰ Java ç”Ÿæ€ä¸­æœ€ä¸»æµçš„ JVMã€‚å…¶åç§°æºäºå…¶æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼š&lt;strong&gt;åŠ¨æ€è¯†åˆ«å¹¶ä¼˜åŒ–ç¨‹åºä¸­çš„â€œçƒ­ç‚¹ä»£ç â€ï¼ˆHot Spot Codeï¼‰&lt;/strong&gt;ï¼Œä»¥æ˜¾è‘—æå‡ Java åº”ç”¨çš„æ‰§è¡Œæ•ˆç‡ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç›®æ ‡çƒ­ç‚¹ä»£ç ä¼˜åŒ–"&gt;ğŸ”¥ æ ¸å¿ƒç›®æ ‡ï¼šçƒ­ç‚¹ä»£ç ä¼˜åŒ–
&lt;/h3&gt;&lt;p&gt;HotSpot çš„æ ¸å¿ƒä½¿å‘½æ˜¯é€šè¿‡ &lt;strong&gt;JITï¼ˆJust-In-Timeï¼‰å³æ—¶ç¼–è¯‘æŠ€æœ¯&lt;/strong&gt;ï¼Œå°†é¢‘ç¹æ‰§è¡Œçš„å­—èŠ‚ç ï¼ˆçƒ­ç‚¹ä»£ç ï¼‰åŠ¨æ€ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ç ï¼Œé¿å…é‡å¤è§£é‡Šæ‰§è¡Œçš„å¼€é”€ã€‚è¿™ç§ç­–ç•¥è§£å†³äº†ä¼ ç»Ÿè§£é‡Šæ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çƒ­ç‚¹æ¢æµ‹ï¼šé€šè¿‡ä¸¤ç±»è®¡æ•°å™¨ç»Ÿè®¡ä»£ç æ‰§è¡Œé¢‘ç‡ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨&lt;/strong&gt;ï¼šç»Ÿè®¡æ–¹æ³•è¢«è°ƒç”¨çš„æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›è¾¹è®¡æ•°å™¨&lt;/strong&gt;ï¼šç»Ÿè®¡å¾ªç¯ä½“æ‰§è¡Œçš„æ¬¡æ•°ï¼ˆå¦‚ &lt;code&gt;for&lt;/code&gt;/&lt;code&gt;while&lt;/code&gt; å¾ªç¯ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘ç¼–è¯‘&lt;/strong&gt;ï¼šå½“è®¡æ•°å™¨è¶…è¿‡é˜ˆå€¼æ—¶ï¼ŒJIT ç¼–è¯‘å™¨å°†å¯¹åº”ä»£ç ç¼–è¯‘ä¸ºä¼˜åŒ–çš„æœ¬åœ°æœºå™¨ç ï¼Œå¹¶ç¼“å­˜è‡³ &lt;strong&gt;Code Cache&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šä»…å¯¹é«˜é¢‘ä»£ç ç¼–è¯‘ï¼Œé¿å…å…¨å±€ç¼–è¯‘çš„å¯åŠ¨å»¶è¿Ÿï¼Œå¹³è¡¡å¯åŠ¨é€Ÿåº¦ä¸è¿è¡Œæ—¶æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç»„ä»¶åˆ†å±‚ç¼–è¯‘ä¸ç¼–è¯‘å™¨åä½œ"&gt;âš™ï¸ æ ¸å¿ƒç»„ä»¶ï¼šåˆ†å±‚ç¼–è¯‘ä¸ç¼–è¯‘å™¨åä½œ
&lt;/h3&gt;&lt;p&gt;HotSpot é‡‡ç”¨åˆ†å±‚ç¼–è¯‘ç­–ç•¥ï¼Œç»“åˆä¸¤ç§å³æ—¶ç¼–è¯‘å™¨å®ç°æ€§èƒ½ä¸æ•ˆç‡çš„å¹³è¡¡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;C1 ç¼–è¯‘å™¨ï¼ˆClient Compilerï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;è½»é‡çº§ä¼˜åŒ–ï¼Œå¯åŠ¨é€Ÿåº¦å¿«ï¼Œå ç”¨èµ„æºå°‘ã€‚&lt;/li&gt;
&lt;li&gt;é€‚ç”¨äºæ¡Œé¢åº”ç”¨æˆ–å¯¹å¯åŠ¨é€Ÿåº¦æ•æ„Ÿçš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;C2 ç¼–è¯‘å™¨ï¼ˆServer Compilerï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;æ·±åº¦ä¼˜åŒ–ï¼ˆå¦‚å†…è”ã€é€ƒé€¸åˆ†æï¼‰ï¼Œç”Ÿæˆé«˜æ•ˆæœ¬åœ°ç ã€‚&lt;/li&gt;
&lt;li&gt;é€‚ç”¨äºæœåŠ¡å™¨ç«¯é•¿æœŸè¿è¡Œçš„åº”ç”¨ï¼Œè¿½æ±‚å³°å€¼æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ†å±‚ç¼–è¯‘ï¼ˆTiered Compilationï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤æ¨¡å¼&lt;/strong&gt;ï¼šå…ˆç”±è§£é‡Šå™¨æ‰§è¡Œï¼Œå†é€æ­¥å‡çº§è‡³ C1/C2 ç¼–è¯‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–è·¯å¾„&lt;/strong&gt;ï¼š
&lt;code&gt;è§£é‡Šæ‰§è¡Œ â†’ C1 è½»é‡ç¼–è¯‘ â†’ C2 æ·±åº¦ç¼–è¯‘&lt;/code&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç¼–è¯‘å™¨ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŒ–å¼ºåº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;C1 (Client)&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;æ¡Œé¢åº”ç”¨ã€å¿«é€Ÿå¯åŠ¨&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘å¿«ï¼Œå†…å­˜å ç”¨å°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;C2 (Server)&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;æœåŠ¡å™¨ç«¯åº”ç”¨&lt;/td&gt;
&lt;td&gt;æ·±åº¦ä¼˜åŒ–ï¼Œæ‰§è¡Œæ•ˆç‡é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æŠ€æœ¯jit-ä¼˜åŒ–æ‰‹æ®µ"&gt;ğŸ› ï¸ å…³é”®æŠ€æœ¯ï¼šJIT ä¼˜åŒ–æ‰‹æ®µ
&lt;/h3&gt;&lt;p&gt;HotSpot å¯¹çƒ­ç‚¹ä»£ç åº”ç”¨å¤šç§ç¼–è¯‘ä¼˜åŒ–æŠ€æœ¯ï¼Œæ˜¾è‘—æå‡æ€§èƒ½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ–¹æ³•å†…è”ï¼ˆInliningï¼‰
â  å°†å°æ–¹æ³•è°ƒç”¨æ›¿æ¢ä¸ºæ–¹æ³•ä½“ä»£ç ï¼Œå‡å°‘&lt;strong&gt;å‡½æ•°è°ƒç”¨å¼€é”€&lt;/strong&gt;ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;// ä¼˜åŒ–å‰
int result = add(a, b);
// ä¼˜åŒ–åï¼ˆå†…è”å±•å¼€ï¼‰
int result = a + b;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰
â  åˆ¤æ–­å¯¹è±¡ä½œç”¨åŸŸï¼Œè§¦å‘ä»¥ä¸‹ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ‡é‡æ›¿æ¢&lt;/strong&gt;ï¼šå°†å¯¹è±¡æ‹†è§£ä¸ºåŸºæœ¬ç±»å‹å˜é‡ï¼Œé¿å…å †åˆ†é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ˆä¸Šåˆ†é…&lt;/strong&gt;ï¼šå°†æœªé€ƒé€¸å¯¹è±¡åˆ†é…åœ¨æ ˆä¸Šï¼Œè‡ªåŠ¨å›æ”¶ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”æ¶ˆé™¤&lt;/strong&gt;ï¼šç§»é™¤çº¿ç¨‹å®‰å…¨ä½†æ— ç«äº‰çš„åŒæ­¥é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤&lt;/strong&gt;
â  å¤ç”¨é‡å¤è®¡ç®—çš„ç»“æœï¼Œå‡å°‘å†—ä½™æ“ä½œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å­˜ç®¡ç†ä¸åƒåœ¾å›æ”¶"&gt;â™»ï¸ å†…å­˜ç®¡ç†ä¸åƒåœ¾å›æ”¶
&lt;/h3&gt;&lt;p&gt;HotSpot æä¾›å¤šç§åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰ï¼Œé€‚åº”ä¸åŒåœºæ™¯éœ€æ±‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹´è½»ä»£æ”¶é›†å™¨&lt;/strong&gt;ï¼šSerialã€Parallel Scavengeï¼ˆååä¼˜å…ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è€å¹´ä»£æ”¶é›†å™¨&lt;/strong&gt;ï¼šCMSï¼ˆä½å»¶è¿Ÿï¼‰ã€G1ï¼ˆå¹³è¡¡ååä¸å»¶è¿Ÿï¼‰ã€ZGCï¼ˆè¶…ä½å»¶è¿Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªé€‚åº”ç­–ç•¥&lt;/strong&gt;ï¼šæ ¹æ®è¿è¡Œæ—¶æ•°æ®åŠ¨æ€è°ƒæ•´å †å¤§å°ä¸GCç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸æ€§èƒ½ä»·å€¼"&gt;âš¡ï¸ åº”ç”¨åœºæ™¯ä¸æ€§èƒ½ä»·å€¼
&lt;/h3&gt;&lt;p&gt;HotSpot çš„è®¾è®¡ä½¿å…¶åœ¨ä»¥ä¸‹åœºæ™¯è¡¨ç°å“è¶Šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡å™¨ç«¯åº”ç”¨&lt;/strong&gt;ï¼šé«˜å¹¶å‘æœåŠ¡ï¼ˆå¦‚ç”µå•†ã€é‡‘èç³»ç»Ÿï¼‰é€šè¿‡ C2 ç¼–è¯‘å®ç°æè‡´æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§æ•°æ®å¤„ç†&lt;/strong&gt;ï¼šSparkã€Hadoop ä¾èµ–å…¶é«˜æ•ˆå†…å­˜ç®¡ç†å¤„ç†æµ·é‡æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¾®æœåŠ¡æ¶æ„&lt;/strong&gt;ï¼šå¿«é€Ÿå¯åŠ¨ä¸ä½å†…å­˜å ç”¨ï¼ˆC1 ä¼˜åŒ–ï¼‰é€‚åˆå®¹å™¨åŒ–éƒ¨ç½²ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;JVM HotSpot çš„æœ¬è´¨æ˜¯ä¸€ä¸ªé€šè¿‡åŠ¨æ€çƒ­ç‚¹æ¢æµ‹ + JITåˆ†å±‚ç¼–è¯‘ + å†…å­˜ç®¡ç†ä¼˜åŒ–å®ç°é«˜æ€§èƒ½çš„Javaè™šæ‹Ÿæœº&lt;/strong&gt;ã€‚å…¶æ ¸å¿ƒåˆ›æ–°åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ™ºèƒ½åŒ–çƒ­ç‚¹è¯†åˆ«&lt;/strong&gt;ï¼šä»…ä¼˜åŒ–é«˜é¢‘ä»£ç ï¼Œé¿å…æ— æ•ˆç¼–è¯‘å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘ä¸è§£é‡Šæ··åˆæ¨¡å¼&lt;/strong&gt;ï¼šå¹³è¡¡å¯åŠ¨é€Ÿåº¦ï¼ˆè§£é‡Šå™¨ï¼‰ä¸æ‰§è¡Œæ•ˆç‡ï¼ˆç¼–è¯‘å™¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªé€‚åº”è¿è¡Œæ—¶ä¼˜åŒ–&lt;/strong&gt;ï¼šæ ¹æ®ç¨‹åºè¡Œä¸ºåŠ¨æ€è°ƒæ•´ç¼–è¯‘ç­–ç•¥ä¸å†…å­˜ç®¡ç†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;æ® Oracle å®˜æ–¹æµ‹è¯•ï¼ŒHotSpot å¯¹çƒ­ç‚¹ä»£ç çš„ä¼˜åŒ–å¯ä½¿æ€§èƒ½æ¥è¿‘ C/C++ ç¨‹åºï¼Œæˆä¸º Java é«˜æ€§èƒ½çš„åŸºçŸ³ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="åŒäº²å§”æ´¾æœºåˆ¶"&gt;åŒäº²å§”æ´¾æœºåˆ¶
&lt;/h2&gt;&lt;p&gt;åŒäº²å§”æ´¾æ¨¡å‹ï¼ˆParents Delegation Modelï¼‰æ˜¯ Java ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰çš„æ ¸å¿ƒå·¥ä½œæœºåˆ¶ï¼Œç”¨äºç¡®ä¿ç±»çš„å®‰å…¨åŠ è½½å’Œå”¯ä¸€æ€§ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š&lt;strong&gt;å½“ç±»åŠ è½½å™¨æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚æ—¶ï¼Œä¸ä¼šç«‹å³å°è¯•åŠ è½½ï¼Œè€Œæ˜¯å…ˆå°†è¯·æ±‚é€çº§å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å¤„ç†ï¼›åªæœ‰çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®ŒæˆåŠ è½½æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±åŠ è½½&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæµç¨‹è‡ªä¸‹è€Œä¸Šçš„å§”æ´¾ä¸è‡ªä¸Šè€Œä¸‹çš„åŠ è½½"&gt;ğŸ”„ &lt;strong&gt;æ ¸å¿ƒæµç¨‹ï¼šè‡ªä¸‹è€Œä¸Šçš„å§”æ´¾ä¸è‡ªä¸Šè€Œä¸‹çš„åŠ è½½&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å§”æ´¾é˜¶æ®µï¼ˆè‡ªä¸‹è€Œä¸Šï¼‰&lt;/strong&gt;
å½“å­ç±»åŠ è½½å™¨ï¼ˆå¦‚åº”ç”¨ç±»åŠ è½½å™¨ï¼‰æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥è¯¥ç±»æ˜¯å¦å·²è¢«åŠ è½½ï¼ˆç¼“å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æœªåŠ è½½ï¼Œå°†è¯·æ±‚&lt;strong&gt;å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨&lt;/strong&gt;ï¼ˆå¦‚æ‰©å±•ç±»åŠ è½½å™¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;çˆ¶ç±»åŠ è½½å™¨é‡å¤æ­¤è¿‡ç¨‹ï¼Œç»§ç»­å‘ä¸Šå§”æ´¾ï¼Œç›´åˆ°&lt;strong&gt;å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ è½½é˜¶æ®µï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯åŠ¨ç±»åŠ è½½å™¨&lt;/strong&gt;å°è¯•åŠ è½½ï¼ˆå¦‚æ ¸å¿ƒç±»åº“ &lt;code&gt;java.lang.*&lt;/code&gt;ï¼‰â†’ æˆåŠŸåˆ™è¿”å›ç»“æœã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å¤±è´¥ï¼ˆä¾‹å¦‚éæ ¸å¿ƒç±»ï¼‰ï¼Œè¯·æ±‚å›é€€åˆ°å­åŠ è½½å™¨ï¼š
&lt;ul&gt;
&lt;li&gt;æ‰©å±•ç±»åŠ è½½å™¨å°è¯•åŠ è½½ï¼ˆå¦‚ &lt;code&gt;javax.*&lt;/code&gt;ï¼‰â†’ æˆåŠŸåˆ™è¿”å›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥å¤±è´¥ï¼Œåº”ç”¨ç±»åŠ è½½å™¨å°è¯•åŠ è½½ï¼ˆç”¨æˆ·ç±»è·¯å¾„ &lt;code&gt;classpath&lt;/code&gt; ä¸‹çš„ç±»ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æ‰€æœ‰åŠ è½½å™¨å‡å¤±è´¥ï¼ŒæŠ›å‡º &lt;code&gt;ClassNotFoundException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph TB
A[åº”ç”¨ç±»åŠ è½½å™¨æ”¶åˆ°è¯·æ±‚] --&amp;gt; B{æ˜¯å¦å·²åŠ è½½ï¼Ÿ}
B -- æ˜¯ --&amp;gt; C[è¿”å›å·²åŠ è½½çš„ç±»]
B -- å¦ --&amp;gt; D[å§”æ´¾ç»™æ‰©å±•ç±»åŠ è½½å™¨]
D --&amp;gt; E{æ˜¯å¦å·²åŠ è½½ï¼Ÿ}
E -- æ˜¯ --&amp;gt; C
E -- å¦ --&amp;gt; F[å§”æ´¾ç»™å¯åŠ¨ç±»åŠ è½½å™¨]
F --&amp;gt; G{æ˜¯å¦åŠ è½½æˆåŠŸï¼Ÿ}
G -- æ˜¯ --&amp;gt; C
G -- å¦ --&amp;gt; H[æ‰©å±•ç±»åŠ è½½å™¨å°è¯•åŠ è½½]
H --&amp;gt; I{æ˜¯å¦åŠ è½½æˆåŠŸï¼Ÿ}
I -- æ˜¯ --&amp;gt; C
I -- å¦ --&amp;gt; J[åº”ç”¨ç±»åŠ è½½å™¨å°è¯•åŠ è½½]
J --&amp;gt; K{æ˜¯å¦åŠ è½½æˆåŠŸï¼Ÿ}
K -- æ˜¯ --&amp;gt; C
K -- å¦ --&amp;gt; L[æŠ›å‡º ClassNotFoundException]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-ç±»åŠ è½½å™¨çš„å±‚æ¬¡ç»“æ„"&gt;ğŸ§© &lt;strong&gt;ç±»åŠ è½½å™¨çš„å±‚æ¬¡ç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Java ç±»åŠ è½½å™¨æŒ‰å±‚çº§ç»„ç»‡ï¼Œå½¢æˆæ ‘çŠ¶ç»“æ„ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»åŠ è½½å™¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠ è½½å†…å®¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;çˆ¶åŠ è½½å™¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯åŠ¨ç±»åŠ è½½å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JVM æ ¸å¿ƒç±»åº“ï¼ˆ&lt;code&gt;rt.jar&lt;/code&gt;ã€&lt;code&gt;java.*&lt;/code&gt; ç­‰ï¼‰&lt;/td&gt;
&lt;td&gt;C++ å®ç°ï¼ŒJVM å†…ç½®&lt;/td&gt;
&lt;td&gt;æ— ï¼ˆé¡¶å±‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰©å±•ç±»åŠ è½½å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;JAVA_HOME/lib/ext&lt;/code&gt; ç›®å½•ä¸‹çš„æ‰©å±•ç±»åº“&lt;/td&gt;
&lt;td&gt;Javaï¼ˆ&lt;code&gt;sun.misc.Launcher$ExtClassLoader&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å¯åŠ¨ç±»åŠ è½½å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº”ç”¨ç±»åŠ è½½å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·ç±»è·¯å¾„ï¼ˆ&lt;code&gt;classpath&lt;/code&gt;ï¼‰ä¸‹çš„ç±»&lt;/td&gt;
&lt;td&gt;Javaï¼ˆ&lt;code&gt;sun.misc.Launcher$AppClassLoader&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æ‰©å±•ç±»åŠ è½½å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è‡ªå®šä¹‰ç±»åŠ è½½å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·æŒ‡å®šè·¯å¾„ï¼ˆå¦‚ç½‘ç»œã€åŠ å¯†æ–‡ä»¶ç­‰ï¼‰&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·ç»§æ‰¿ &lt;code&gt;ClassLoader&lt;/code&gt; å®ç°&lt;/td&gt;
&lt;td&gt;åº”ç”¨ç±»åŠ è½½å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šå¯åŠ¨ç±»åŠ è½½å™¨åœ¨ Java ä¸­é€šå¸¸è¡¨ç¤ºä¸º &lt;code&gt;null&lt;/code&gt;ï¼ˆå› å…¶ç”± C++ å®ç°ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä»·å€¼ä¸ºä½•éœ€è¦åŒäº²å§”æ´¾"&gt;ğŸ›¡ï¸ &lt;strong&gt;æ ¸å¿ƒä»·å€¼ï¼šä¸ºä½•éœ€è¦åŒäº²å§”æ´¾ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¿å…ç±»é‡å¤åŠ è½½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çˆ¶åŠ è½½å™¨ä¼˜å…ˆåŠ è½½ç¡®ä¿&lt;strong&gt;åŒä¸€ç±»åœ¨å…¨ JVM ä¸­ä»…åŠ è½½ä¸€æ¬¡&lt;/strong&gt;ã€‚ä¾‹å¦‚ &lt;code&gt;java.lang.Object&lt;/code&gt; ä»…ç”±å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ï¼Œé¿å…å¤šä»½å®ä¾‹å¯¼è‡´ç±»å‹æ··ä¹±ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¿æŠ¤æ ¸å¿ƒç±»åº“å®‰å…¨&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é˜²æ­¢ç”¨æˆ·è‡ªå®šä¹‰ç±»ç¯¡æ”¹æ ¸å¿ƒ APIï¼ˆå¦‚ä¼ªé€  &lt;code&gt;java.lang.String&lt;/code&gt;ï¼‰ã€‚æ ¸å¿ƒç±»ç”±å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ï¼Œè‡ªå®šä¹‰çš„åŒåç±»&lt;strong&gt;ä¸ä¼šè¢«åŠ è½½&lt;/strong&gt;ï¼ˆçˆ¶åŠ è½½å™¨å·²æˆåŠŸåŠ è½½ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¤ºä¾‹ï¼šç”¨æˆ·å®šä¹‰ &lt;code&gt;java.lang.String&lt;/code&gt; å¹¶æ·»åŠ æ¶æ„ä»£ç  â†’ å› åŒäº²å§”æ´¾æœºåˆ¶ï¼Œå®é™…åŠ è½½çš„ä»æ˜¯ JVM æ ¸å¿ƒ &lt;code&gt;String&lt;/code&gt; ç±»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¿è¯ç±»åŠ è½½çš„æœ‰åºæ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å±‚çº§åŒ–çš„å§”æ´¾æœºåˆ¶ä½¿ç±»åŠ è½½è´£ä»»æ¸…æ™°ï¼Œç¬¦åˆâ€œé«˜å†…èšä½è€¦åˆâ€è®¾è®¡åŸåˆ™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰“ç ´åŒäº²å§”æ´¾çš„åœºæ™¯"&gt;âš ï¸ &lt;strong&gt;æ‰“ç ´åŒäº²å§”æ´¾çš„åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æŸäº›åœºæ™¯éœ€ç»•è¿‡é»˜è®¤æœºåˆ¶ï¼Œç”±å­åŠ è½½å™¨ç›´æ¥åŠ è½½ç±»ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;SPIï¼ˆService Provider Interfaceï¼‰
&lt;ul&gt;
&lt;li&gt;æ ¸å¿ƒç±»ï¼ˆå¦‚ &lt;code&gt;java.sql.DriverManager&lt;/code&gt;ï¼‰éœ€è°ƒç”¨ç”¨æˆ·å®ç°çš„é©±åŠ¨ç±»ï¼ˆå¦‚ &lt;code&gt;com.mysql.jdbc.Driver&lt;/code&gt;ï¼‰ã€‚é€šè¿‡&lt;strong&gt;çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆContext ClassLoaderï¼‰&lt;/strong&gt; ç”±å­åŠ è½½å™¨åŠ è½½ç”¨æˆ·ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;çƒ­éƒ¨ç½²ä¸æ¨¡å—åŒ–
&lt;ul&gt;
&lt;li&gt;Tomcat ä¸ºæ¯ä¸ª Web åº”ç”¨æä¾›ç‹¬ç«‹ç±»åŠ è½½å™¨ï¼Œå®ç°ç±»éš”ç¦»ä¸çƒ­æ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;OSGi æ¡†æ¶
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€æ¨¡å—åŒ–ç³»ç»Ÿä¸­ï¼Œç±»åŠ è½½å™¨æŒ‰éœ€åä½œï¼Œæ”¯æŒæ¨¡å—çº§å¸è½½å’Œæ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨&lt;/strong&gt;ï¼šåŒäº²å§”æ´¾æ˜¯â€œ&lt;strong&gt;ä¼˜å…ˆçˆ¶åŠ è½½ï¼Œå¤±è´¥å†è‡ªåŠ è½½&lt;/strong&gt;â€çš„ç±»åŠ è½½è´£ä»»é“¾æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;ï¼šâœ… ç¡®ä¿ç±»å”¯ä¸€æ€§ã€âœ… å®ˆæŠ¤æ ¸å¿ƒç±»å®‰å…¨ã€âœ… ä¼˜åŒ–åŠ è½½æ•ˆç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰“ç ´åœºæ™¯&lt;/strong&gt;ï¼šSPIã€çƒ­éƒ¨ç½²ç­‰éœ€åŠ¨æ€åŠ è½½çš„åœºæ™¯éœ€è‡ªå®šä¹‰æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;ä¸€å¥è¯ç†è§£&lt;/strong&gt;ï¼šå¦‚åŒå…¬å¸å®¡æ‰¹æµç¨‹â€”â€”å‘˜å·¥æäº¤ç”³è¯·â†’ç»ç†â†’æ€»ç»ç†ï¼Œæ€»ç»ç†èƒ½æ‰¹åˆ™æ‰¹ï¼Œå¦åˆ™é€€å›ç»™ç»ç†å¤„ç†ï¼Œç»ç†ä¸è¡Œå†é€€å›å‘˜å·¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ç±»åŠ è½½æœºåˆ¶"&gt;ç±»åŠ è½½æœºåˆ¶
&lt;/h2&gt;&lt;p&gt;Java ç±»åŠ è½½æœºåˆ¶æ˜¯ JVM çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œè´Ÿè´£å°†ç±»çš„å­—èŠ‚ç ï¼ˆ&lt;code&gt;.class&lt;/code&gt; æ–‡ä»¶ï¼‰åŠ¨æ€åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„æ•°æ®ç»“æ„ã€‚å…¶è®¾è®¡ä¿è¯äº†å®‰å…¨æ€§ã€çµæ´»æ€§å’Œé«˜æ•ˆæ€§ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç±»åŠ è½½çš„æ ¸å¿ƒè¿‡ç¨‹"&gt;ğŸ§  &lt;strong&gt;ç±»åŠ è½½çš„æ ¸å¿ƒè¿‡ç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç±»åŠ è½½åˆ†ä¸º &lt;strong&gt;åŠ è½½ï¼ˆLoadingï¼‰&lt;/strong&gt;ã€&lt;strong&gt;é“¾æ¥ï¼ˆLinkingï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;åˆå§‹åŒ–ï¼ˆInitializationï¼‰&lt;/strong&gt; ä¸‰ä¸ªé˜¶æ®µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ è½½ï¼ˆLoadingï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡&lt;/strong&gt;ï¼šé€šè¿‡ç±»åŠ è½½å™¨ï¼ˆ&lt;code&gt;ClassLoader&lt;/code&gt;ï¼‰æŸ¥æ‰¾å­—èŠ‚ç æ–‡ä»¶ï¼ˆæœ¬åœ°æ–‡ä»¶ã€ç½‘ç»œèµ„æºç­‰ï¼‰ï¼Œè¯»å–äºŒè¿›åˆ¶æ•°æ®åˆ°å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;å…³é”®åŠ¨ä½œï¼š
&lt;ul&gt;
&lt;li&gt;ç”Ÿæˆç±»çš„ &lt;code&gt;java.lang.Class&lt;/code&gt; å¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºä¸­è¯¥ç±»çš„è®¿é—®å…¥å£ã€‚&lt;/li&gt;
&lt;li&gt;å°†å­—èŠ‚ç è§£æä¸º JVM å†…éƒ¨æ•°æ®ç»“æ„ï¼ˆå¦‚æ–¹æ³•åŒºçš„ç±»å…ƒä¿¡æ¯ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ—¶æœº&lt;/strong&gt;ï¼šé¦–æ¬¡ä¸»åŠ¨ä½¿ç”¨ç±»æ—¶ï¼ˆå¦‚ &lt;code&gt;new&lt;/code&gt;ã€è®¿é—®é™æ€æˆå‘˜ã€åå°„ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é“¾æ¥ï¼ˆLinkingï¼‰&lt;/strong&gt;
é“¾æ¥è¿›ä¸€æ­¥åˆ†ä¸ºä¸‰æ­¥ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éªŒè¯ï¼ˆVerificationï¼‰&lt;/strong&gt;
æ£€æŸ¥å­—èŠ‚ç çš„åˆæ³•æ€§ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ ¼å¼ï¼ˆé­”æ•° &lt;code&gt;CAFEBABE&lt;/code&gt;ï¼‰ã€å…ƒæ•°æ®ï¼ˆç»§æ‰¿å…³ç³»ï¼‰ã€å­—èŠ‚ç æŒ‡ä»¤ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡†å¤‡ï¼ˆPreparationï¼‰&lt;/strong&gt;
ä¸º&lt;strong&gt;é™æ€å˜é‡&lt;/strong&gt;åˆ†é…å†…å­˜å¹¶è®¾ç½®&lt;strong&gt;é»˜è®¤åˆå§‹å€¼&lt;/strong&gt;â€‹ï¼ˆå¦‚ &lt;code&gt;int&lt;/code&gt; ä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œå¼•ç”¨ç±»å‹ä¸º &lt;code&gt;null&lt;/code&gt;ï¼‰ï¼Œä½†&lt;strong&gt;ä¸æ‰§è¡Œèµ‹å€¼è¯­å¥&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£æï¼ˆResolutionï¼‰&lt;/strong&gt;
å°†ç¬¦å·å¼•ç”¨ï¼ˆå¦‚ç±»å &lt;code&gt;java.lang.Object&lt;/code&gt;ï¼‰æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼ˆå†…å­˜åœ°å€æŒ‡é’ˆï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹åŒ–ï¼ˆInitializationï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œç±»æ„é€ å™¨ &lt;code&gt;&amp;lt;clinit&amp;gt;()&lt;/code&gt; æ–¹æ³•ï¼ˆç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆï¼‰ï¼ŒåŒ…å«é™æ€å˜é‡èµ‹å€¼å’Œé™æ€ä»£ç å—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;ï¼šä¸»åŠ¨ä½¿ç”¨ç±»ï¼ˆå¦‚åˆ›å»ºå®ä¾‹ã€è°ƒç”¨é™æ€æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;ï¼šJVM ä¿è¯ &lt;code&gt;&amp;lt;clinit&amp;gt;()&lt;/code&gt; ä»…æ‰§è¡Œä¸€æ¬¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç±»åŠ è½½å™¨ä½“ç³»ä¸åŒäº²å§”æ´¾æ¨¡å‹"&gt;ğŸ”— &lt;strong&gt;ç±»åŠ è½½å™¨ä½“ç³»ä¸åŒäº²å§”æ´¾æ¨¡å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç±»åŠ è½½å™¨å±‚çº§"&gt;&lt;strong&gt;ç±»åŠ è½½å™¨å±‚çº§&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Java é‡‡ç”¨åˆ†å±‚ç±»åŠ è½½å™¨ï¼Œå½¢æˆæ ‘çŠ¶ç»“æ„ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»åŠ è½½å™¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠ è½½è·¯å¾„&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç°è¯­è¨€&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;çˆ¶åŠ è½½å™¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Bootstrap ClassLoader&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;JAVA_HOME/lib&lt;/code&gt;ï¼ˆå¦‚ &lt;code&gt;rt.jar&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;C++&lt;/td&gt;
&lt;td&gt;æ— ï¼ˆé¡¶å±‚åŠ è½½å™¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Extension ClassLoader&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;JAVA_HOME/lib/ext&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Java&lt;/td&gt;
&lt;td&gt;Bootstrap&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Application ClassLoader&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·ç±»è·¯å¾„ï¼ˆ&lt;code&gt;CLASSPATH&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;Java&lt;/td&gt;
&lt;td&gt;Extension&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Custom ClassLoader&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è‡ªå®šä¹‰è·¯å¾„ï¼ˆå¦‚ç½‘ç»œã€æ•°æ®åº“ï¼‰&lt;/td&gt;
&lt;td&gt;Java&lt;/td&gt;
&lt;td&gt;Applicationï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="åŒäº²å§”æ´¾æ¨¡å‹parent-delegation-model"&gt;&lt;strong&gt;åŒäº²å§”æ´¾æ¨¡å‹ï¼ˆParent Delegation Modelï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;ï¼š
&lt;ol&gt;
&lt;li&gt;å­ç±»åŠ è½½å™¨æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼Œ&lt;strong&gt;å…ˆå§”æ‰˜çˆ¶åŠ è½½å™¨å¤„ç†&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;çˆ¶åŠ è½½å™¨é€’å½’å‘ä¸Šå§”æ´¾ï¼Œç›´è‡³ &lt;code&gt;Bootstrap ClassLoader&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥çˆ¶åŠ è½½å™¨æ— æ³•å®Œæˆï¼ˆä¸åœ¨å…¶åŠ è½½èŒƒå›´ï¼‰ï¼Œå­åŠ è½½å™¨æ‰å°è¯•åŠ è½½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[å­ç±»åŠ è½½å™¨] --&amp;gt; B[å§”æ‰˜çˆ¶ç±»åŠ è½½å™¨]
B --&amp;gt; C[Bootstrap]
C -- æˆåŠŸ --&amp;gt; D[è¿”å›Classå¯¹è±¡]
C -- å¤±è´¥ --&amp;gt; E[Extensionå°è¯•]
E -- å¤±è´¥ --&amp;gt; F[Applicationå°è¯•]
F -- å¤±è´¥ --&amp;gt; G[è‡ªå®šä¹‰åŠ è½½å™¨]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ä¼˜åŠ¿&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;é¿å…é‡å¤åŠ è½½&lt;/strong&gt;ï¼šç¡®ä¿ç±»å…¨å±€å”¯ä¸€æ€§ï¼ˆå¦‚æ ¸å¿ƒç±» &lt;code&gt;java.lang.String&lt;/code&gt; ä»…ç”± &lt;code&gt;Bootstrap&lt;/code&gt; åŠ è½½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;ï¼šé˜²æ­¢ç”¨æˆ·ä¼ªé€ æ ¸å¿ƒç±»ï¼ˆå¦‚è‡ªå®šä¹‰ &lt;code&gt;java.lang.Object&lt;/code&gt; è¢«æ‹’ç»ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;ï¼šä¿è¯æ ¸å¿ƒç±»åº“è¡Œä¸ºç¨³å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ‰“ç ´åŒäº²å§”æ´¾çš„åœºæ™¯"&gt;&lt;strong&gt;æ‰“ç ´åŒäº²å§”æ´¾çš„åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;SPI æœºåˆ¶&lt;/strong&gt;ï¼ˆå¦‚ JDBCï¼‰ï¼š
æ¥å£ç”± &lt;code&gt;Bootstrap&lt;/code&gt; åŠ è½½ï¼Œä½†å®ç°ç±»éœ€ç”±åº”ç”¨åŠ è½½å™¨åŠ è½½ã€‚é€šè¿‡ â€‹&lt;strong&gt;çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆ&lt;code&gt;ThreadContextClassLoader&lt;/code&gt;ï¼‰â€‹&lt;/strong&gt;â€‹ åå‘å§”æ´¾å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çƒ­éƒ¨ç½²/æ¨¡å—åŒ–&lt;/strong&gt;ï¼ˆå¦‚ Tomcatã€OSGiï¼‰ï¼š
æ¯ä¸ª Web åº”ç”¨ä½¿ç”¨ç‹¬ç«‹ç±»åŠ è½½å™¨ï¼Œä¼˜å…ˆåŠ è½½è‡ªèº«ç±»åº“è€Œéå§”æ‰˜çˆ¶åŠ è½½å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç±»å¸è½½ä¸ç”Ÿå‘½å‘¨æœŸç®¡ç†"&gt;âš™ï¸ &lt;strong&gt;ç±»å¸è½½ä¸ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç±»å¸è½½æ¡ä»¶"&gt;&lt;strong&gt;ç±»å¸è½½æ¡ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ç±»å¸è½½æ˜¯ JVM çš„ä¼˜åŒ–è¡Œä¸ºï¼Œéœ€åŒæ—¶æ»¡è¶³ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¯¥ç±»&lt;strong&gt;æ‰€æœ‰å®ä¾‹å·²è¢« GC å›æ”¶&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åŠ è½½è¯¥ç±»çš„ &lt;strong&gt;&lt;code&gt;ClassLoader&lt;/code&gt; å·²è¢« GC å›æ”¶&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯¥ç±»çš„ &lt;strong&gt;&lt;code&gt;Class&lt;/code&gt; å¯¹è±¡æ— ä»»ä½•å¼•ç”¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼š&lt;code&gt;Bootstrap ClassLoader&lt;/code&gt; åŠ è½½çš„æ ¸å¿ƒç±»&lt;strong&gt;æ°¸ä¸è¢«å¸è½½&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id="çƒ­æ›´æ–°å®ç°åŸç†"&gt;&lt;strong&gt;çƒ­æ›´æ–°å®ç°åŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— æ³•åŸåœ°æ›´æ–°&lt;/strong&gt;ï¼šåŒä¸€ &lt;code&gt;ClassLoader&lt;/code&gt; é‡å¤åŠ è½½åŒä¸€ç±»ä¼šæŠ›å‡º &lt;code&gt;LinkageError&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šåˆ›å»ºæ–°çš„ &lt;code&gt;ClassLoader&lt;/code&gt; åŠ è½½ä¿®æ”¹åçš„ç±»ï¼ˆå¦‚ JSP é‡ç¼–è¯‘ï¼‰ï¼Œæ—§ç±»éšåŸåŠ è½½å™¨å›æ”¶è€Œå¸è½½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸è‡ªå®šä¹‰ç±»åŠ è½½å™¨"&gt;ğŸ› ï¸ &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸è‡ªå®šä¹‰ç±»åŠ è½½å™¨&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„ç”¨é€”"&gt;&lt;strong&gt;è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„ç”¨é€”&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éæ ‡å‡†æ¥æºåŠ è½½&lt;/strong&gt;ï¼šä»æ•°æ®åº“ã€ç½‘ç»œæˆ–åŠ å¯†æ–‡ä»¶ä¸­åŠ è½½ç±»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»æ€§&lt;/strong&gt;ï¼šå®ç°æ¨¡å—åŒ–æˆ–åº”ç”¨éš”ç¦»ï¼ˆå¦‚ Tomcat éš”ç¦» WebAppï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çƒ­éƒ¨ç½²&lt;/strong&gt;ï¼šåŠ¨æ€æ›´æ–°ä»£ç ï¼ˆå¼€å‘å·¥å…·å¸¸ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å®ç°æ­¥éª¤"&gt;&lt;strong&gt;å®ç°æ­¥éª¤&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ä»…éœ€é‡å†™ &lt;code&gt;findClass()&lt;/code&gt; æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CustomClassLoader&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;extends&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ClassLoader&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;classPath&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;protected&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;findClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ClassNotFoundException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;byte&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;classData&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;loadClassData&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ä»è‡ªå®šä¹‰è·¯å¾„è¯»å–å­—èŠ‚ç &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;defineClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;classData&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;classData&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;byte&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;loadClassData&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;className&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å®ç°å­—èŠ‚ç åŠ è½½é€»è¾‘ï¼ˆå¦‚è¯»å–æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæµç¨‹&lt;/strong&gt;ï¼šåŠ è½½ â†’ é“¾æ¥ï¼ˆéªŒè¯ã€å‡†å¤‡ã€è§£æï¼‰ â†’ åˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»åŠ è½½å™¨&lt;/strong&gt;ï¼šåˆ†å±‚å§”æ´¾ä¿éšœå®‰å…¨ä¸å”¯ä¸€æ€§ï¼ŒSPI/çƒ­éƒ¨ç½²ç­‰åœºæ™¯éœ€æ‰“ç ´è¯¥æ¨¡å‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å¸è½½&lt;/strong&gt;ï¼šä¾èµ– GC å›æ”¶ç±»åŠ è½½å™¨åŠå®ä¾‹ï¼Œæ ¸å¿ƒç±»æ°¸é©»å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®è·µä»·å€¼&lt;/strong&gt;ï¼šç†è§£æœºåˆ¶å¯ä¼˜åŒ–æ¡†æ¶è®¾è®¡ï¼ˆå¦‚æ¨¡å—åŒ–ã€çƒ­æ›´æ–°ï¼‰ï¼Œé¿å…ç±»å†²çªä¸å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ” &lt;strong&gt;æ·±å…¥å»ºè®®&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;-verbose:class&lt;/code&gt; å‚æ•°è§‚å¯Ÿç±»åŠ è½½è¡Œä¸ºï¼Œæˆ–ç»“åˆ &lt;code&gt;jmap&lt;/code&gt;ã€&lt;code&gt;VisualVM&lt;/code&gt; åˆ†æç±»åŠ è½½å™¨å†…å­˜çŠ¶æ€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="class--instance"&gt;Class &amp;amp; Instance
&lt;/h2&gt;&lt;p&gt;åœ¨Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸­ï¼Œ&lt;strong&gt;å †ä¸­çš„Classå¯¹è±¡ï¼ˆç±»å¯¹è±¡ï¼‰ä¸ç±»å®ä¾‹ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰&lt;/strong&gt; æ˜¯ä¸¤ç§ä¸åŒå±‚çº§çš„å®ä½“ï¼Œå®ƒä»¬é€šè¿‡ç‰¹å®šçš„å¼•ç”¨å…³ç³»ååŒå®ç°é¢å‘å¯¹è±¡çš„æ ¸å¿ƒæœºåˆ¶ã€‚ä»¥ä¸‹æ˜¯äºŒè€…å…³ç³»çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå…³ç³»ç±»å¯¹è±¡æ˜¯ç±»å®ä¾‹çš„æ¨¡æ¿å…¥å£"&gt;ğŸ§© &lt;strong&gt;æ ¸å¿ƒå…³ç³»ï¼šç±»å¯¹è±¡æ˜¯ç±»å®ä¾‹çš„â€œæ¨¡æ¿å…¥å£â€&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç±»å¯¹è±¡ï¼ˆClass Objectï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®&lt;/strong&gt;ï¼šä½äº&lt;strong&gt;Javaå †&lt;/strong&gt;ä¸­ï¼ˆä¸æ™®é€šå¯¹è±¡ç›¸åŒï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆæ—¶æœº&lt;/strong&gt;ï¼šç±»é¦–æ¬¡è¢«åŠ è½½æ—¶ï¼Œç”±ç±»åŠ è½½å™¨åœ¨å †ä¸­åˆ›å»º&lt;strong&gt;å”¯ä¸€çš„Classå¯¹è±¡&lt;/strong&gt;ï¼ˆåŒä¸€ç±»åŠ è½½å™¨ä¸‹ä»…ä¸€ä¸ªï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä½œç”¨ï¼š
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨ç±»çš„&lt;strong&gt;å…ƒæ•°æ®ä¿¡æ¯&lt;/strong&gt;ï¼ˆå¦‚ç±»åã€æ–¹æ³•ã€å­—æ®µã€çˆ¶ç±»ã€æ¥å£ç­‰ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä½œä¸ºç¨‹åºè®¿é—®ç±»å…ƒæ•°æ®çš„&lt;strong&gt;å…¥å£&lt;/strong&gt;ï¼ˆé€šè¿‡åå°„APIå¦‚&lt;code&gt;getClass()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å®ä¾‹ï¼ˆObject Instanceï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®&lt;/strong&gt;ï¼šå¯¹è±¡å®ä¾‹å­˜å‚¨åœ¨&lt;strong&gt;Javaå †&lt;/strong&gt;ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆæ—¶æœº&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;new&lt;/code&gt;ã€åå°„ã€å…‹éš†ç­‰æ–¹å¼å®ä¾‹åŒ–ï¼Œæ¯ä¸ªå®ä¾‹åœ¨å †ä¸­å ç”¨ç‹¬ç«‹å†…å­˜ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;å†…å®¹ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹è±¡å¤´ï¼ˆå«æŒ‡å‘Classå¯¹è±¡çš„æŒ‡é’ˆï¼‰ï¼›
&lt;ul&gt;
&lt;li&gt;å®ä¾‹æ•°æ®ï¼ˆéé™æ€æˆå‘˜å˜é‡çš„å€¼ï¼‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯¹é½å¡«å……ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¼•ç”¨å…³ç³»åŒå‘ç»‘å®šä¸è®¿é—®è·¯å¾„"&gt;ğŸ”— &lt;strong&gt;å¼•ç”¨å…³ç³»ï¼šåŒå‘ç»‘å®šä¸è®¿é—®è·¯å¾„&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç±»å®ä¾‹ â†’ Classå¯¹è±¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªå¯¹è±¡å®ä¾‹çš„&lt;strong&gt;å¯¹è±¡å¤´&lt;/strong&gt;ä¸­ä¿å­˜ä¸€ä¸ª&lt;strong&gt;Klass Pointer&lt;/strong&gt;ï¼ŒæŒ‡å‘æ–¹æ³•åŒºä¸­ç±»çš„å…ƒæ•°æ®ï¼ˆ&lt;code&gt;instanceKlass&lt;/code&gt;ï¼‰ï¼Œè€Œå…ƒæ•°æ®å†…éƒ¨åˆæŒæœ‰æŒ‡å‘å †ä¸­Classå¯¹è±¡çš„å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Person p = new Person();
Class&amp;lt;?&amp;gt; clazz = p.getClass(); // é€šè¿‡å®ä¾‹è·å–Classå¯¹è±¡
&lt;/code&gt;&lt;/pre&gt;æ­¤è¿‡ç¨‹é€šè¿‡å¯¹è±¡å¤´ä¸­çš„æŒ‡é’ˆé“¾å®Œæˆï¼ˆ
&lt;pre tabindex="0"&gt;&lt;code&gt;p â†’ instanceKlass â†’ Classå¯¹è±¡
&lt;/code&gt;&lt;/pre&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Classå¯¹è±¡ â†’ ç±»å…ƒæ•°æ®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Classå¯¹è±¡å†…éƒ¨é€šè¿‡æŒ‡é’ˆå…³è”åˆ°æ–¹æ³•åŒºï¼ˆæˆ–å…ƒç©ºé—´ï¼‰çš„&lt;strong&gt;ç±»å…ƒæ•°æ®ï¼ˆ&lt;code&gt;instanceKlass&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼Œåè€…å­˜å‚¨å­—èŠ‚ç ã€æ–¹æ³•è¡¨ç­‰é™æ€ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šClasså¯¹è±¡æ˜¯&lt;strong&gt;å…ƒæ•°æ®çš„è®¿é—®ä»£ç†&lt;/strong&gt;ï¼Œè€Œéç›´æ¥å­˜å‚¨å…ƒæ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»åŠ è½½å™¨çš„ä½œç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç±»åŠ è½½å™¨åœ¨å †ä¸­åˆ›å»ºClasså¯¹è±¡ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªé›†åˆå­˜å‚¨å…¶åŠ è½½çš„æ‰€æœ‰ç±»çš„Classå¯¹è±¡å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;Classå¯¹è±¡å¯é€šè¿‡&lt;code&gt;getClassLoader()&lt;/code&gt;åå‘è·å–å…¶ç±»åŠ è½½å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿå‘½å‘¨æœŸä¸ä¾èµ–"&gt;âš™ï¸ &lt;strong&gt;ç”Ÿå‘½å‘¨æœŸä¸ä¾èµ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–å…³ç³»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç±»å®ä¾‹çš„åˆ›å»º&lt;strong&gt;ä¾èµ–Classå¯¹è±¡çš„å­˜åœ¨&lt;/strong&gt;ï¼šè‹¥ç±»æœªåŠ è½½ï¼ˆå³æ— Classå¯¹è±¡ï¼‰ï¼Œåˆ™æ— æ³•å®ä¾‹åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;Classå¯¹è±¡çš„ç”Ÿæˆ&lt;strong&gt;ä¾èµ–ç±»åŠ è½½è¿‡ç¨‹&lt;/strong&gt;ï¼šåŠ è½½&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ â†’ åœ¨æ–¹æ³•åŒºç”Ÿæˆå…ƒæ•°æ® â†’ åœ¨å †ä¸­åˆ›å»ºClasså¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æ”¶æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Classå¯¹è±¡å›æ”¶&lt;/strong&gt;ï¼šå½“Classå¯¹è±¡&lt;strong&gt;ä¸å¯è¾¾&lt;/strong&gt;ï¼ˆæ— ç±»å®ä¾‹ã€æ— ç±»åŠ è½½å™¨å¼•ç”¨ï¼‰æ—¶ï¼ŒFull GCä¼šå›æ”¶å®ƒï¼Œå¹¶å¸è½½æ–¹æ³•åŒºä¸­çš„ç±»å…ƒæ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å®ä¾‹å›æ”¶&lt;/strong&gt;ï¼šç”±GCæ ¹æ®å¯è¾¾æ€§åˆ†æç‹¬ç«‹å›æ”¶ï¼Œä¸Classå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ— å…³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç»“æ„å¯¹æ¯”ä¸åä½œ"&gt;ğŸ“Š &lt;strong&gt;ç»“æ„å¯¹æ¯”ä¸åä½œ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Classå¯¹è±¡ï¼ˆç±»å¯¹è±¡ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç±»å®ä¾‹ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Javaå †&lt;/td&gt;
&lt;td&gt;Javaå †&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯ä¸ªç±»å”¯ä¸€ï¼ˆåŒä¸€ç±»åŠ è½½å™¨ï¼‰&lt;/td&gt;
&lt;td&gt;å¯å­˜åœ¨å¤šä¸ªï¼ˆé€šè¿‡&lt;code&gt;new&lt;/code&gt;åˆ›å»ºï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‡å‘ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆã€åå°„å…¥å£&lt;/td&gt;
&lt;td&gt;å¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®ã€å¯¹é½å¡«å……&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿæˆæ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»é¦–æ¬¡åŠ è½½æ—¶&lt;/td&gt;
&lt;td&gt;æ˜¾å¼å®ä¾‹åŒ–æ—¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠŸèƒ½è§’è‰²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»çš„è¿è¡Œæ—¶è¡¨ç¤ºï¼ˆæ¨¡æ¿å…¥å£ï¼‰&lt;/td&gt;
&lt;td&gt;ç±»çš„å…·ä½“å®ä½“ï¼ˆæ•°æ®è½½ä½“ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å…³ç³»ç¤ºæ„å›¾"&gt;ğŸ”„ &lt;strong&gt;å…³ç³»ç¤ºæ„å›¾&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[ç±»åŠ è½½å™¨] --&amp;gt; B[åœ¨å †ä¸­åˆ›å»ºClasså¯¹è±¡]
B --&amp;gt; C[å…³è”æ–¹æ³•åŒºçš„ç±»å…ƒæ•°æ®]
D[ç±»å®ä¾‹ new] --&amp;gt; E[å¯¹è±¡å¤´æŒ‡å‘ç±»å…ƒæ•°æ®]
E --&amp;gt; C
C --&amp;gt; B
A --&amp;gt; F[ç»´æŠ¤Classå¯¹è±¡é›†åˆ]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Classå¯¹è±¡æ˜¯â€œç±»çš„è¿è¡Œæ—¶é•œåƒâ€&lt;/strong&gt;ï¼š
ä½äºå †ä¸­ï¼Œä½œä¸ºç¨‹åºè®¿é—®ç±»å…ƒæ•°æ®çš„&lt;strong&gt;å”¯ä¸€å…¥å£&lt;/strong&gt;ï¼Œé€šè¿‡åå°„æœºåˆ¶æä¾›åŠ¨æ€æ“ä½œç±»ç»“æ„çš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å®ä¾‹æ˜¯â€œç±»çš„æ•°æ®å®ä½“â€&lt;/strong&gt;ï¼š
å­˜å‚¨å®é™…çŠ¶æ€ï¼Œé€šè¿‡å¯¹è±¡å¤´ä¸­çš„&lt;strong&gt;Klass Pointer&lt;/strong&gt;ä¸Classå¯¹è±¡åŠç±»å…ƒæ•°æ®ç»‘å®šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äºŒè€…åä½œå®ç°å¤šæ€ä¸åå°„&lt;/strong&gt;ï¼š
ç±»å®ä¾‹é€šè¿‡æŒ‡é’ˆé“¾å…³è”åˆ°Classå¯¹è±¡ï¼Œå†é€šè¿‡Classå¯¹è±¡è®¿é—®æ–¹æ³•åŒºçš„å…ƒæ•°æ®ï¼Œæ”¯æ’‘&lt;strong&gt;åŠ¨æ€æ–¹æ³•ç»‘å®šã€å­—æ®µè®¿é—®ç­‰æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šè‹¥Classå¯¹è±¡è¢«å›æ”¶ï¼Œå…¶å…³è”çš„ç±»å…ƒæ•°æ®ä¼šè¢«å¸è½½ï¼Œè¯¥ç±»å°†æ— æ³•å†å®ä¾‹åŒ–æ–°å¯¹è±¡æˆ–è®¿é—®é™æ€æˆå‘˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="heap"&gt;Heap
&lt;/h2&gt;&lt;p&gt;JVM ä¸­çš„ Heapï¼ˆå †ï¼‰æ˜¯ Java å†…å­˜ç®¡ç†çš„æ ¸å¿ƒåŒºåŸŸï¼Œç”¨äºå­˜å‚¨å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯åƒåœ¾å›æ”¶ï¼ˆGCï¼‰çš„ä¸»è¦å·¥ä½œåŒºåŸŸã€‚å…¶è®¾è®¡ç›´æ¥å½±å“ç¨‹åºæ€§èƒ½å’Œç¨³å®šæ€§ã€‚ä»¥ä¸‹ä»ç»“æ„ã€å·¥ä½œæœºåˆ¶ã€ä¼˜åŒ–ç­–ç•¥ç­‰ç»´åº¦å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-heap-çš„æ ¸å¿ƒç»“æ„ä¸åˆ†ä»£æ¨¡å‹"&gt;ğŸ§± &lt;strong&gt;Heap çš„æ ¸å¿ƒç»“æ„ä¸åˆ†ä»£æ¨¡å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Heap åœ¨é€»è¾‘ä¸Šåˆ†ä¸º &lt;strong&gt;æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;è€å¹´ä»£ï¼ˆOld Generationï¼‰&lt;/strong&gt;ï¼ŒJDK 8 ä¹‹å‰è¿˜åŒ…å«æ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼‰ï¼Œä¹‹åè¢«å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰æ›¿ä»£ï¼ˆå…ƒç©ºé—´ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œä¸å±äº Heapï¼‰ã€‚&lt;/p&gt;
&lt;h4 id="æ–°ç”Ÿä»£young-generation"&gt;&lt;strong&gt;æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Eden åŒº&lt;/strong&gt;ï¼šæ–°å¯¹è±¡åˆ†é…çš„åŒºåŸŸï¼ˆçº¦ 80% çš„æ–°å¯¹è±¡åœ¨æ­¤åˆ›å»ºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Survivor åŒº&lt;/strong&gt;ï¼šåŒ…å«ä¸¤ä¸ªå¯¹ç­‰åŒºåŸŸï¼ˆFrom å’Œ Toï¼‰ï¼Œç”¨äºå­˜æ”¾ Minor GC åå­˜æ´»çš„å¯¹è±¡ã€‚é»˜è®¤æ¯”ä¾‹ &lt;strong&gt;Eden : From : To = 8:1:1&lt;/strong&gt;ï¼ˆé€šè¿‡ &lt;code&gt;-XX:SurvivorRatio&lt;/code&gt; è°ƒæ•´ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GC æœºåˆ¶&lt;/strong&gt;ï¼šæ–°ç”Ÿä»£é‡‡ç”¨ &lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼ˆCopyingï¼‰ï¼ŒMinor GC æ—¶å­˜æ´»å¯¹è±¡åœ¨ Eden å’Œ Survivor é—´å¤åˆ¶ï¼Œå¹´é¾„è®¡æ•°å™¨å¢åŠ ï¼Œè¾¾åˆ°é˜ˆå€¼ï¼ˆé»˜è®¤ 15ï¼‰åæ™‹å‡è€å¹´ä»£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è€å¹´ä»£old-generation"&gt;&lt;strong&gt;è€å¹´ä»£ï¼ˆOld Generationï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å­˜æ”¾é•¿æœŸå­˜æ´»å¯¹è±¡ï¼ˆå¦‚ç¼“å­˜ã€å…¨å±€é…ç½®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GC æœºåˆ¶&lt;/strong&gt;ï¼šé‡‡ç”¨ &lt;strong&gt;æ ‡è®°-æ¸…é™¤&lt;/strong&gt; æˆ– &lt;strong&gt;æ ‡è®°-æ•´ç†&lt;/strong&gt; ç®—æ³•ï¼ˆå¦‚ CMSã€G1ï¼‰ã€‚å½“ç©ºé—´ä¸è¶³æ—¶è§¦å‘ Major GCï¼ˆå¸¸ä¼´éš Full GCï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ°¸ä¹…ä»£-vs-å…ƒç©ºé—´"&gt;&lt;strong&gt;æ°¸ä¹…ä»£ vs å…ƒç©ºé—´&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;æ°¸ä¹…ä»£ï¼ˆâ‰¤JDK7ï¼‰&lt;/th&gt;
&lt;th&gt;å…ƒç©ºé—´ï¼ˆâ‰¥JDK8ï¼‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Heap å†…éƒ¨åˆ†é…&lt;/td&gt;
&lt;td&gt;æœ¬åœ°å†…å­˜ï¼ˆNative Memoryï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»å…ƒä¿¡æ¯ã€å¸¸é‡æ± ã€é™æ€å˜é‡&lt;/td&gt;
&lt;td&gt;ç±»å…ƒä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OOM é£é™©&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜“å› ç±»åŠ è½½è¿‡å¤šè§¦å‘ OOM&lt;/td&gt;
&lt;td&gt;ä»…å—æœ¬åœ°å†…å­˜é™åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:PermSize&lt;/code&gt;/&lt;code&gt;MaxPermSize&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:MetaspaceSize&lt;/code&gt;/&lt;code&gt;MaxMetaspaceSize&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-heap-çš„å·¥ä½œæœºåˆ¶ä¸å†…å­˜åˆ†é…"&gt;âš™ï¸ &lt;strong&gt;Heap çš„å·¥ä½œæœºåˆ¶ä¸å†…å­˜åˆ†é…&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å¯¹è±¡åˆ†é…æµç¨‹"&gt;&lt;strong&gt;å¯¹è±¡åˆ†é…æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[æ–°å¯¹è±¡åˆ›å»º] --&amp;gt; B{èƒ½å¦æ”¾å…¥ TLABï¼Ÿ}
B -- æ˜¯ --&amp;gt; C[åœ¨ TLAB åˆ†é…]
B -- å¦ --&amp;gt; D{èƒ½å¦æ”¾å…¥ Eden åŒºï¼Ÿ}
D -- æ˜¯ --&amp;gt; E[åœ¨ Eden åˆ†é…]
D -- å¦ --&amp;gt; F[è§¦å‘ Minor GC]
F --&amp;gt; G{Survivor èƒ½å¦å®¹çº³ï¼Ÿ}
G -- æ˜¯ --&amp;gt; H[å­˜æ´»å¯¹è±¡ç§»å…¥ Survivor]
G -- å¦ --&amp;gt; I{è€å¹´ä»£èƒ½å¦å®¹çº³ï¼Ÿ}
I -- æ˜¯ --&amp;gt; J[å¯¹è±¡æ™‹å‡è€å¹´ä»£]
I -- å¦ --&amp;gt; K[è§¦å‘ Full GC]
K --&amp;gt; L{ç©ºé—´ä»ä¸è¶³ï¼Ÿ} --&amp;gt; M[OOM]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;TLABï¼ˆçº¿ç¨‹ç§æœ‰åˆ†é…ç¼“å†²åŒºï¼‰&lt;/strong&gt;ï¼šæ¯ä¸ªçº¿ç¨‹åœ¨ Eden åŒºç‹¬å ä¸€å°å—å†…å­˜ï¼Œé¿å…å¤šçº¿ç¨‹ç«äº‰ï¼ˆé»˜è®¤å¼€å¯ï¼Œé€šè¿‡ &lt;code&gt;-XX:+UseTLAB&lt;/code&gt; æ§åˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;-XX:PretenureSizeThreshold&lt;/code&gt; è®¾ç½®é˜ˆå€¼ï¼ˆå¦‚ 4MBï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="gc-ç±»å‹ä¸è§¦å‘æ¡ä»¶"&gt;&lt;strong&gt;GC ç±»å‹ä¸è§¦å‘æ¡ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;GC ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;ä½œç”¨èŒƒå›´&lt;/th&gt;
&lt;th&gt;è§¦å‘æ¡ä»¶&lt;/th&gt;
&lt;th&gt;ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Minor GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–°ç”Ÿä»£ï¼ˆEden + Survivorï¼‰&lt;/td&gt;
&lt;td&gt;Eden åŒºæ»¡&lt;/td&gt;
&lt;td&gt;é¢‘ç‡é«˜ã€é€Ÿåº¦å¿«ã€STW çŸ­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Major GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£ç©ºé—´ä¸è¶³&lt;/td&gt;
&lt;td&gt;é€Ÿåº¦æ…¢ï¼ˆMinor GC çš„ 10 å€ä»¥ä¸Šï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Full GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•´ä¸ª Heap + æ–¹æ³•åŒº&lt;/td&gt;
&lt;td&gt;1. &lt;code&gt;System.gc()&lt;/code&gt; å»ºè®®&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;è€å¹´ä»£/æ–¹æ³•åŒºä¸è¶³&lt;/li&gt;
&lt;li&gt;ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ | STW æ—¶é—´é•¿ï¼Œä¸¥é‡å½±å“æ€§èƒ½ |&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼šè‹¥ &lt;code&gt;-Xmx&lt;/code&gt; è®¾ç½®è¿‡å°ï¼Œé¢‘ç¹ Full GC ä¼šå¯¼è‡´åº”ç”¨å¡é¡¿ï¼ˆå¦‚ç½‘é¡µè¯·æ±‚è¶…æ—¶ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-heap-çš„å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–ç­–ç•¥"&gt;âš ï¸ &lt;strong&gt;Heap çš„å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="oomoutofmemoryerror"&gt;&lt;strong&gt;OOMï¼ˆOutOfMemoryErrorï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸå› ï¼š
&lt;ul&gt;
&lt;li&gt;å†…å­˜æ³„æ¼ï¼ˆå¦‚é™æ€é›†åˆæŒæœ‰å¯¹è±¡å¼•ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å †ç©ºé—´ä¸è¶³ï¼ˆ&lt;code&gt;-Xmx&lt;/code&gt; è¿‡å°æˆ–ä¸šåŠ¡è´Ÿè½½çªå¢ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®šä½å·¥å…·ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;jmap -dump:format=b,file=heap.bin &amp;lt;pid&amp;gt;&lt;/code&gt; ç”Ÿæˆå †è½¬å‚¨æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;MATï¼ˆMemory Analyzer Toolï¼‰åˆ†ææ³„æ¼å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å‚æ•°è°ƒä¼˜ï¼š
&lt;ul&gt;
&lt;li&gt;è®¾ç½® &lt;code&gt;-Xms = -Xmx&lt;/code&gt;ï¼ˆé¿å…å †åŠ¨æ€æ‰©å®¹çš„å¼€é”€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ–°ç”Ÿä»£å¤§å°ï¼š&lt;code&gt;-Xmn&lt;/code&gt; è®¾ä¸ºå †çš„ 1/3~1/4ï¼ˆå¦‚ &lt;code&gt;-Xmn1g&lt;/code&gt;ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;æ™‹å‡é˜ˆå€¼ï¼š&lt;code&gt;-XX:MaxTenuringThreshold=10&lt;/code&gt;ï¼ˆé™ä½å¯¹è±¡åœ¨ Survivor çš„å¤åˆ¶æ¬¡æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;GC é€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜åååœºæ™¯&lt;/strong&gt;ï¼šParallel GCï¼ˆé»˜è®¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½å»¶è¿Ÿåœºæ™¯&lt;/strong&gt;ï¼šG1 / ZGCï¼ˆSTW â‰¤ 10msï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»£ç å±‚é¢ï¼š
&lt;ul&gt;
&lt;li&gt;é¿å…åˆ›å»ºå¤§å¯¹è±¡ï¼ˆå¦‚ä¸€æ¬¡æ€§åŠ è½½å¤§æ–‡ä»¶åˆ°å†…å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¯¹è±¡æ± å¤ç”¨å¯¹è±¡ï¼ˆå¦‚ Apache Commons Poolï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®å‚æ•°ä¸ç›‘æ§å·¥å…·"&gt;ğŸ“Š &lt;strong&gt;å…³é”®å‚æ•°ä¸ç›‘æ§å·¥å…·&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å¸¸ç”¨-jvm-å‚æ•°"&gt;&lt;strong&gt;å¸¸ç”¨ JVM å‚æ•°&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;ä½œç”¨&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-Xms&lt;/code&gt; / &lt;code&gt;-Xmx&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆå§‹/æœ€å¤§å †å¤§å°&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-Xms4g -Xmx4g&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:NewRatio&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£ä¸æ–°ç”Ÿä»£æ¯”ä¾‹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:NewRatio=2&lt;/code&gt;ï¼ˆè€å¹´ä»£:æ–°ç”Ÿä»£=2:1ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:+PrintGCDetails&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰“å° GC æ—¥å¿—&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:+HeapDumpOnOutOfMemoryError&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OOM æ—¶è‡ªåŠ¨ç”Ÿæˆå †è½¬å‚¨æ–‡ä»¶&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ç›‘æ§å·¥å…·"&gt;&lt;strong&gt;ç›‘æ§å·¥å…·&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;JDK å†…ç½®ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;jvisualvm&lt;/code&gt;ï¼šå¯è§†åŒ–æŸ¥çœ‹ Heap ä½¿ç”¨åŠ GC æ´»åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;jstat -gc &amp;lt;pid&amp;gt;&lt;/code&gt;ï¼šå®æ—¶ç›‘æ§å„åˆ†ä»£å†…å­˜å ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰æ–¹å·¥å…·ï¼š
&lt;ul&gt;
&lt;li&gt;Eclipse MATï¼šåˆ†æå †è½¬å‚¨æ–‡ä»¶å®šä½å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;GCEasyï¼šåœ¨çº¿åˆ†æ GC æ—¥å¿—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Heap æ˜¯ JVM å¯¹è±¡å­˜å‚¨çš„æ ¸å¿ƒåŒºåŸŸï¼Œé€šè¿‡&lt;strong&gt;åˆ†ä»£æ¨¡å‹&lt;/strong&gt;å’Œ&lt;strong&gt;åƒåœ¾å›æ”¶æœºåˆ¶&lt;/strong&gt;å¹³è¡¡å†…å­˜åˆ†é…æ•ˆç‡ä¸å›æ”¶æ€§èƒ½ã€‚ä¼˜åŒ–éœ€ç»“åˆï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆç†åˆ†ä»£æ¯”ä¾‹&lt;/strong&gt;ï¼ˆé¿å… Survivor æº¢å‡ºæˆ–è€å¹´ä»£è¿‡æ—©æ»¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GC å™¨é€‰å‹&lt;/strong&gt;ï¼ˆå¦‚ G1 å…¼é¡¾ååä¸å»¶è¿Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°è°ƒä¼˜&lt;/strong&gt;ï¼ˆå›ºå®šå †å¤§å°ã€è°ƒæ•´æ™‹å‡é˜ˆå€¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç è§„èŒƒ&lt;/strong&gt;ï¼ˆå‡å°‘å¤§å¯¹è±¡ã€åŠæ—¶é‡Šæ”¾å¼•ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;jstat -gcutil&lt;/code&gt; å®šæœŸç›‘æ§ï¼Œå½“è€å¹´ä»£ä½¿ç”¨ç‡æŒç»­ &amp;gt;70% æ—¶éœ€æ‰©å®¹æˆ–ä¼˜åŒ–å¯¹è±¡ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="survivor-fromto"&gt;Survivor From/To
&lt;/h2&gt;&lt;p&gt;åœ¨JVMçš„åƒåœ¾å›æ”¶æœºåˆ¶ä¸­ï¼ŒSurvivoråŒºåˆ†ä¸º&lt;code&gt;From Survivor&lt;/code&gt;å’Œ&lt;code&gt;To Survivor&lt;/code&gt;ä¸¤ä¸ªåŒºåŸŸï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äº&lt;strong&gt;è§’è‰²åŠŸèƒ½ã€å¯¹è±¡å­˜å‚¨çŠ¶æ€åŠåœ¨GCè¿‡ç¨‹ä¸­çš„ä½œç”¨&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è§’è‰²ä¸åŠŸèƒ½å·®å¼‚"&gt;ğŸ”„ &lt;strong&gt;è§’è‰²ä¸åŠŸèƒ½å·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;From Survivor&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;To Survivor&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å½“å‰è§’è‰²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å­˜æ”¾ä¸Šä¸€æ¬¡GCåå­˜æ´»çš„å¹´è½»ä»£å¯¹è±¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å½“å‰GCä¸­ç”¨äºæ¥æ”¶æ–°å­˜æ´»å¯¹è±¡çš„ç©ºé—²åŒº&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çŠ¶æ€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éç©ºé—²ï¼ˆå­˜æœ‰å¯¹è±¡ï¼‰&lt;/td&gt;
&lt;td&gt;ç©ºé—²ï¼ˆç­‰å¾…æ¥æ”¶å¯¹è±¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;GCè¿‡ç¨‹ä¸­çš„ä½œç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½œä¸ºæœ¬æ¬¡GCçš„â€œæ¥æºâ€åŒºåŸŸ&lt;/td&gt;
&lt;td&gt;ä½œä¸ºæœ¬æ¬¡GCçš„â€œç›®æ ‡â€åŒºåŸŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;From&lt;/code&gt;å’Œ&lt;code&gt;To&lt;/code&gt;æœ¬è´¨æ˜¯&lt;strong&gt;ä¸¤å—ç›¸åŒå¤§å°çš„å†…å­˜åŒºåŸŸ&lt;/strong&gt;ï¼ˆé»˜è®¤å„å SurvivoråŒº10%ï¼Œä¸EdenåŒºæ¯”ä¾‹ä¸º8:1:1ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ƒä»¬çš„è§’è‰²åœ¨æ¯æ¬¡Minor GCå&lt;strong&gt;äº’æ¢&lt;/strong&gt;ï¼šåŸ&lt;code&gt;To&lt;/code&gt;å˜ä¸ºä¸‹ä¸€è½®çš„&lt;code&gt;From&lt;/code&gt;ï¼ŒåŸ&lt;code&gt;From&lt;/code&gt;æ¸…ç©ºåå˜ä¸ºä¸‹ä¸€è½®çš„&lt;code&gt;To&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å­˜ç»“æ„ä¸åˆ†é…æœºåˆ¶"&gt;ğŸ§© &lt;strong&gt;å†…å­˜ç»“æ„ä¸åˆ†é…æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†å¯¹ç§°æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸¤è€…å†…å­˜å¤§å°å®Œå…¨ä¸€è‡´ï¼Œé€šè¿‡JVMå‚æ•°&lt;code&gt;-XX:SurvivorRatio&lt;/code&gt;è°ƒèŠ‚ä¸EdenåŒºçš„æ¯”ä¾‹ï¼ˆä¾‹å¦‚&lt;code&gt;-XX:SurvivorRatio=8&lt;/code&gt;è¡¨ç¤ºEden:From:To=8:1:1ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æœªæ˜¾å¼è®¾ç½®æ¯”ä¾‹ï¼ŒJVMè‡ªåŠ¨æŒ‰8:1:1åˆ†é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å­˜å‚¨é€»è¾‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;FromåŒº&lt;/strong&gt;ï¼šå­˜å‚¨&lt;strong&gt;ä¸Šæ¬¡GCåå­˜æ´»ä¸”æœªæ™‹å‡è€å¹´ä»£çš„å¯¹è±¡&lt;/strong&gt;ï¼ˆå¹´é¾„è®¡æ•°å™¨+1ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ToåŒº&lt;/strong&gt;ï¼šåˆå§‹ä¸ºç©ºï¼Œä»…å½“Minor GCå‘ç”Ÿæ—¶æ¥æ”¶ä»Edenå’ŒFromåŒºå¤åˆ¶æ¥çš„å­˜æ´»å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åƒåœ¾å›æ”¶æµç¨‹ä»¥å¤åˆ¶ç®—æ³•ä¸ºä¾‹"&gt;âš™ï¸ &lt;strong&gt;åƒåœ¾å›æ”¶æµç¨‹ï¼ˆä»¥å¤åˆ¶ç®—æ³•ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[Minor GCè§¦å‘] --&amp;gt; B[æ¸…ç©ºToåŒº]
B --&amp;gt; C[æ‰«æEdenå’ŒFromåŒº]
C --&amp;gt; D{å¯¹è±¡å­˜æ´»ï¼Ÿ}
D -- æ˜¯ --&amp;gt; E[å¤åˆ¶åˆ°ToåŒºï¼Œå¹´é¾„+1]
D -- å¦ --&amp;gt; F[ç›´æ¥å›æ”¶]
E --&amp;gt; G{å¹´é¾„â‰¥é˜ˆå€¼ï¼Ÿ}
G -- æ˜¯ --&amp;gt; H[æ™‹å‡åˆ°è€å¹´ä»£]
G -- å¦ --&amp;gt; I[ä¿ç•™åœ¨ToåŒº]
H &amp;amp; I --&amp;gt; J[æ¸…ç©ºEdenå’ŒFromåŒº]
J --&amp;gt; K[äº¤æ¢From/Toè§’è‰²]
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æµç¨‹è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Minor GCæ—¶ï¼Œå­˜æ´»å¯¹è±¡ä»&lt;strong&gt;Edenå’ŒFromåŒº&lt;/strong&gt;å¤åˆ¶åˆ°&lt;strong&gt;ToåŒº&lt;/strong&gt;ï¼ŒåŒæ—¶å¹´é¾„å¢åŠ ã€‚&lt;/li&gt;
&lt;li&gt;å¤åˆ¶å®Œæˆåï¼Œæ¸…ç©ºEdenå’ŒåŸFromåŒºï¼Œå¹¶å°†åŸToåŒºæ ‡è®°ä¸ºä¸‹ä¸€è½®çš„FromåŒºã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å¯¹è±¡å¹´é¾„è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤15ï¼‰ï¼Œåˆ™æ™‹å‡åˆ°è€å¹´ä»£ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å¯¹è±¡å¹´é¾„è®¡ç®—ä¸æ™‹å‡æœºåˆ¶"&gt;â³ &lt;strong&gt;å¯¹è±¡å¹´é¾„è®¡ç®—ä¸æ™‹å‡æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹´é¾„è®¡æ•°å™¨&lt;/strong&gt;ï¼š
å¯¹è±¡æ¯æ¬¡ä»FromåŒºå¤åˆ¶åˆ°ToåŒºï¼Œå¹´é¾„+1ï¼ˆæ— è®ºæ˜¯å¦è·¨åŒºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™‹å‡æ¡ä»¶&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å¹´é¾„ â‰¥ &lt;code&gt;-XX:MaxTenuringThreshold&lt;/code&gt;ï¼ˆé»˜è®¤15ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;SurvivoråŒºç©ºé—´ä¸è¶³æ—¶ï¼ŒJVMåŠ¨æ€è°ƒæ•´å¹´é¾„é˜ˆå€¼ï¼ˆå¦‚æŸå¹´é¾„å¯¹è±¡æ€»å¤§å° &amp;gt; SurvivoråŒº50%ï¼Œåˆ™â‰¥è¯¥å¹´é¾„çš„å¯¹è±¡ç›´æ¥æ™‹å‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½åŠ¨æ€æ€§&lt;/strong&gt;ï¼š&lt;code&gt;From&lt;/code&gt;å’Œ&lt;code&gt;To&lt;/code&gt;æ˜¯é€»è¾‘è§’è‰²ï¼Œ&lt;strong&gt;æ¯æ¬¡GCåäº’æ¢&lt;/strong&gt;ï¼Œç‰©ç†å†…å­˜ç»“æ„ä¸å˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤åˆ¶ç®—æ³•æ ¸å¿ƒ&lt;/strong&gt;ï¼šé€šè¿‡â€œä»Fromå¤åˆ¶åˆ°Toâ€å®ç°åƒåœ¾å›æ”¶ï¼Œé¿å…å†…å­˜ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒä¼˜å…³æ³¨ç‚¹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åˆç†è®¾ç½®&lt;code&gt;-XX:SurvivorRatio&lt;/code&gt;é¿å…ToåŒºæº¢å‡ºï¼ˆå¦‚æ¯”ä¾‹è¿‡å°å¯¼è‡´é¢‘ç¹æ™‹å‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç›‘æ§å¯¹è±¡å¹´é¾„åˆ†å¸ƒï¼Œé¿å…è¿‡æ—©æ™‹å‡ï¼ˆå¹´è½»ä»£å¯¹è±¡åº”å……åˆ†ç»å†Minor GCè¿‡æ»¤ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;å¼‚å¸¸åœºæ™¯&lt;/strong&gt;ï¼šè‹¥Minor GCåToåŒºç©ºé—´ä¸è¶³ï¼Œå­˜æ´»å¯¹è±¡ä¼š&lt;strong&gt;ç›´æ¥æ™‹å‡è€å¹´ä»£&lt;/strong&gt;ï¼Œå¯èƒ½å¼•å‘è€å¹´ä»£è¿‡æ—©å æ»¡å’ŒFull GCã€‚æ­¤æ—¶éœ€è°ƒæ•´Survivoræ¯”ä¾‹æˆ–å¢å¤§å †å†…å­˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¯è¾¾æ€§åˆ†æ"&gt;å¯è¾¾æ€§åˆ†æ
&lt;/h2&gt;&lt;p&gt;å¯è¾¾æ€§åˆ†æï¼ˆReachability Analysisï¼‰æ˜¯JVMåƒåœ¾å›æ”¶ï¼ˆGCï¼‰ä¸­åˆ¤å®šå¯¹è±¡å­˜æ´»çš„æ ¸å¿ƒç®—æ³•ï¼Œå®ƒé€šè¿‡éå†å¯¹è±¡å¼•ç”¨å…³ç³»å›¾ï¼Œè¯†åˆ«å¹¶å›æ”¶ä¸å¯è¾¾å¯¹è±¡ã€‚ä»¥ä¸‹ä»åŸç†ã€æµç¨‹ã€ä¼˜åŒ–åŠæ³¨æ„äº‹é¡¹å››æ–¹é¢è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¯è¾¾æ€§åˆ†æåŸç†ä¸æ ¸å¿ƒæ¦‚å¿µ"&gt;ğŸ” &lt;strong&gt;å¯è¾¾æ€§åˆ†æåŸç†ä¸æ ¸å¿ƒæ¦‚å¿µ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºæœ¬æ€è·¯"&gt;&lt;strong&gt;åŸºæœ¬æ€è·¯&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ä»ä¸€ç»„ç§°ä¸º &lt;strong&gt;GC Roots&lt;/strong&gt; çš„æ ¹å¯¹è±¡å‡ºå‘ï¼Œå‘ä¸‹æœç´¢æ‰€æœ‰é€šè¿‡å¼•ç”¨é“¾ï¼ˆReference Chainï¼‰å¯è¾¾çš„å¯¹è±¡ã€‚è‹¥æŸä¸ªå¯¹è±¡æ— æ³•é€šè¿‡ä»»ä½•å¼•ç”¨é“¾ä¸GC Rootsç›¸è¿ï¼Œåˆ™åˆ¤å®šä¸ºä¸å¯è¾¾ï¼ˆå³â€œæ­»äº¡â€ï¼‰ï¼Œå¯è¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;h4 id="ä¸ºä»€ä¹ˆéœ€è¦å¯è¾¾æ€§åˆ†æ"&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆéœ€è¦å¯è¾¾æ€§åˆ†æï¼Ÿ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜&lt;/strong&gt;ï¼šå¼•ç”¨è®¡æ•°æ³•æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨ï¼ˆå¦‚å¯¹è±¡Aå¼•ç”¨Bï¼ŒBå¼•ç”¨Aï¼Œä½†äºŒè€…å‡æ— å¤–éƒ¨å¼•ç”¨ï¼‰ï¼Œè€Œå¯è¾¾æ€§åˆ†æä»GC Rootså‡ºå‘ï¼Œä¸å—å¯¹è±¡é—´ç›¸äº’å¼•ç”¨çš„å¹²æ‰°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡†ç¡®æ€§é«˜&lt;/strong&gt;ï¼šä»…ä¾èµ–å¼•ç”¨é“¾çš„è¿é€šæ€§ï¼Œé¿å…è¯¯åˆ¤æˆ–æ¼åˆ¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-gc-rootsçš„ç±»å‹"&gt;ğŸ§± &lt;strong&gt;GC Rootsçš„ç±»å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;GC Rootsæ˜¯å¯è¾¾æ€§åˆ†æçš„èµ·ç‚¹ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å¯¹è±¡ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è™šæ‹Ÿæœºæ ˆä¸­çš„å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡ã€æ–¹æ³•å‚æ•°ï¼ˆå¦‚ &lt;code&gt;User user = new User()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•åŒºé™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»çš„é™æ€å˜é‡ï¼ˆå¦‚ &lt;code&gt;private static User admin;&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•åŒºå¸¸é‡å¼•ç”¨çš„å¯¹è±¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²å¸¸é‡æ± ã€&lt;code&gt;final static&lt;/code&gt; å¸¸é‡ï¼ˆå¦‚ &lt;code&gt;public static final String NAME&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ¬åœ°æ–¹æ³•æ ˆä¸­çš„å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JNIï¼ˆJava Native Interfaceï¼‰å¼•ç”¨çš„å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JVMå†…éƒ¨å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºæœ¬æ•°æ®ç±»å‹Classå¯¹è±¡ã€å¼‚å¸¸å¯¹è±¡ã€ç³»ç»Ÿç±»åŠ è½½å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¢«åŒæ­¥é”æŒæœ‰çš„å¯¹è±¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;synchronized&lt;/code&gt; é”æŒæœ‰çš„å¯¹è±¡ï¼ˆå¦‚ &lt;code&gt;synchronized(lockObj)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ´»åŠ¨çº¿ç¨‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¯¹è±¡æœ¬èº«&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šGC Rootsæ˜¯&lt;strong&gt;å¤šæºå¤´çš„&lt;/strong&gt;ï¼ˆéå•ä¸€å¯¹è±¡ï¼‰ï¼Œè¦†ç›–ç¨‹åºè¿è¡Œæ—¶çš„å…³é”®å¼•ç”¨é”šç‚¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å¯è¾¾æ€§åˆ†ææµç¨‹"&gt;âš™ï¸ &lt;strong&gt;å¯è¾¾æ€§åˆ†ææµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ‡è®°é˜¶æ®µmarking"&gt;&lt;strong&gt;æ ‡è®°é˜¶æ®µï¼ˆMarkingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ­¥éª¤ï¼š
&lt;ol&gt;
&lt;li&gt;ä»æ‰€æœ‰GC Rootså¼€å§‹ï¼Œé€’å½’éå†å¼•ç”¨é“¾ï¼ˆæ·±åº¦ä¼˜å…ˆDFSæˆ–å¹¿åº¦ä¼˜å…ˆBFSï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹è®¿é—®åˆ°çš„å¯¹è±¡æ ‡è®°ä¸ºâ€œæ´»è·ƒâ€ï¼ˆå¦‚å¯¹è±¡å¤´è®¾ç½®æ ‡å¿—ä½ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§è¦æ±‚&lt;/strong&gt;ï¼šåˆ†æéœ€åœ¨&lt;strong&gt;STWï¼ˆStop-The-Worldï¼‰&lt;/strong&gt; çŠ¶æ€ä¸‹è¿›è¡Œï¼Œå†»ç»“åº”ç”¨çº¿ç¨‹ï¼Œç¡®ä¿å¼•ç”¨å…³ç³»å¿«ç…§ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¸…é™¤é˜¶æ®µsweeping"&gt;&lt;strong&gt;æ¸…é™¤é˜¶æ®µï¼ˆSweepingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;éå†å †ä¸­æ‰€æœ‰å¯¹è±¡ï¼Œå›æ”¶æœªè¢«æ ‡è®°çš„å¯¹è±¡å†…å­˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®—æ³•ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ‡è®°-æ¸…é™¤&lt;/strong&gt;ï¼šç›´æ¥å›æ”¶ï¼Œä½†äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ‡è®°-æ•´ç†&lt;/strong&gt;ï¼šç§»åŠ¨å­˜æ´»å¯¹è±¡æ¶ˆé™¤ç¢ç‰‡ï¼ˆè€å¹´ä»£å¸¸ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¯¹è±¡å¤æ´»æœºåˆ¶finalize"&gt;&lt;strong&gt;å¯¹è±¡â€œå¤æ´»â€æœºåˆ¶ï¼ˆfinalizeï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;è‹¥å¯¹è±¡é¦–æ¬¡æ ‡è®°ä¸ºä¸å¯è¾¾ï¼Œä¸”é‡å†™äº† &lt;code&gt;finalize()&lt;/code&gt; æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹è±¡è¢«æ”¾å…¥ &lt;strong&gt;F-Queue&lt;/strong&gt; é˜Ÿåˆ—ï¼Œç”±ä½ä¼˜å…ˆçº§çº¿ç¨‹æ‰§è¡Œ &lt;code&gt;finalize()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥åœ¨ &lt;code&gt;finalize()&lt;/code&gt; ä¸­é‡æ–°å»ºç«‹å¼•ç”¨é“¾ï¼ˆå¦‚ &lt;code&gt;this.obj = other&lt;/code&gt;ï¼‰ï¼Œå¯¹è±¡è¢«ç§»å‡ºå›æ”¶é›†åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼š&lt;code&gt;finalize()&lt;/code&gt; ä»…è°ƒç”¨ä¸€æ¬¡ï¼Œä¸”æ‰§è¡Œæ—¶æœºä¸ç¡®å®šï¼Œå®˜æ–¹å·²ä¸æ¨èä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph TB
A[GC Roots] --&amp;gt; B[æ ‡è®°ç›´æ¥å¯è¾¾å¯¹è±¡]
B --&amp;gt; C[éå†å¼•ç”¨é“¾æ ‡è®°æ‰€æœ‰å¯è¾¾å¯¹è±¡]
C --&amp;gt; D{å¯¹è±¡æ˜¯å¦è¦†ç›– finalizeï¼Ÿ}
D -- æ˜¯ --&amp;gt; E[åŠ å…¥ F-Queue]
D -- å¦ --&amp;gt; F[ç›´æ¥å›æ”¶]
E --&amp;gt; G[æ‰§è¡Œ finalize]
G --&amp;gt; H{æ˜¯å¦é‡æ–°å»ºç«‹å¼•ç”¨ï¼Ÿ}
H -- æ˜¯ --&amp;gt; I[ç§»å‡ºå›æ”¶é›†åˆ]
H -- å¦ --&amp;gt; F
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–å¹¶å‘æ ‡è®°ä¸ä¸‰è‰²æ ‡è®°æ³•"&gt;ğŸš€ &lt;strong&gt;ä¼˜åŒ–ï¼šå¹¶å‘æ ‡è®°ä¸ä¸‰è‰²æ ‡è®°æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸ºå‡å°‘STWæ—¶é—´ï¼Œç°ä»£GCï¼ˆå¦‚G1ã€CMSï¼‰é‡‡ç”¨&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼Œæ ¸å¿ƒæ˜¯ &lt;strong&gt;ä¸‰è‰²æ ‡è®°æ³•&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é¢œè‰²&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;çŠ¶æ€&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¤„ç†é€»è¾‘&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç™½è‰²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœªè®¿é—®&lt;/td&gt;
&lt;td&gt;é»˜è®¤çŠ¶æ€ï¼Œåˆ†æç»“æŸä»ä¸ºç™½è‰²åˆ™å›æ”¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç°è‰²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å·²è®¿é—®ä½†å¼•ç”¨æœªå¤„ç†å®Œ&lt;/td&gt;
&lt;td&gt;éœ€è¿›ä¸€æ­¥æ‰«æå…¶å¼•ç”¨å­—æ®µã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é»‘è‰²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å·²è®¿é—®ä¸”æ‰€æœ‰å¼•ç”¨å¤„ç†å®Œæˆ&lt;/td&gt;
&lt;td&gt;å­˜æ´»å¯¹è±¡ï¼Œä¸ä¼šè¢«å›æ”¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°æµç¨‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹æ ‡è®°ï¼ˆSTWï¼‰&lt;/strong&gt;ï¼šæ ‡è®°GC Rootsç›´æ¥å¯è¾¾å¯¹è±¡ï¼ˆç°è‰²ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼šåº”ç”¨çº¿ç¨‹ä¸GCçº¿ç¨‹å¹¶è¡Œï¼Œç°è‰²å¯¹è±¡é€æ­¥å˜é»‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆæ ‡è®°ï¼ˆSTWï¼‰&lt;/strong&gt;ï¼šå¤„ç†å¹¶å‘æœŸé—´å¼•ç”¨å˜åŒ–ï¼ˆå¦‚æ–°äº§ç”Ÿçš„ç°è‰²å¯¹è±¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…é™¤&lt;/strong&gt;ï¼šå›æ”¶ç™½è‰²å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;å¹¶å‘é—®é¢˜&lt;/strong&gt;ï¼šè‹¥åº”ç”¨çº¿ç¨‹ä¿®æ”¹å¼•ç”¨ï¼ˆå¦‚é»‘è‰²å¯¹è±¡å¼•ç”¨ç™½è‰²å¯¹è±¡ï¼‰ï¼Œéœ€&lt;strong&gt;å†™å±éšœï¼ˆWrite Barrierï¼‰&lt;/strong&gt; è®°å½•å¼•ç”¨å˜åŒ–ï¼Œé¿å…è¯¯å›æ”¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸å±€é™æ€§"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸å±€é™æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;STWä¸å¯é¿å…ï¼š
&lt;ul&gt;
&lt;li&gt;åˆå§‹æ ‡è®°å’Œæœ€ç»ˆæ ‡è®°éœ€æš‚åœåº”ç”¨çº¿ç¨‹ï¼Œé«˜é¢‘GCå¯èƒ½å½±å“å®æ—¶æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;ï¼šé€‰æ‹©ä½å»¶è¿Ÿæ”¶é›†å™¨ï¼ˆå¦‚ZGCã€Shenandoahï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å†…å­˜ç¢ç‰‡é—®é¢˜ï¼š
&lt;ul&gt;
&lt;li&gt;æ ‡è®°-æ¸…é™¤ç®—æ³•äº§ç”Ÿç¢ç‰‡ï¼Œå¯èƒ½è§¦å‘Full GCã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šè€å¹´ä»£æ”¹ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯¹è±¡å¼•ç”¨å¤æ‚åº¦ï¼š
&lt;ul&gt;
&lt;li&gt;å¼•ç”¨é“¾è¿‡é•¿æˆ–å¾ªç¯å¼•ç”¨è¿‡å¤šä¼šå»¶é•¿åˆ†ææ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šé¿å…è¿‡åº¦åµŒå¥—è®¾è®¡ï¼ŒåŠæ—¶è§£è€¦æ— å…³è”å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;finalize() çš„é£é™©ï¼š
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œå»¶è¿Ÿå¯èƒ½å¯¼è‡´èµ„æºæœªåŠæ—¶é‡Šæ”¾ï¼›é”™è¯¯é€»è¾‘å¯èƒ½å¼•å‘OOMã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;try-with-resources&lt;/code&gt; æˆ– &lt;code&gt;Cleaner&lt;/code&gt; æœºåˆ¶ï¼ˆJava 9+ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å¯è¾¾æ€§åˆ†ææ˜¯JVM GCçš„åŸºçŸ³ï¼Œé€šè¿‡&lt;strong&gt;GC Rootså¼•ç”¨é“¾éå†&lt;/strong&gt;ç²¾å‡†è¯†åˆ«å­˜æ´»å¯¹è±¡ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿æ˜¯&lt;strong&gt;è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜&lt;/strong&gt;ã€‚ç°ä»£JVMé€šè¿‡ä¸‰è‰²æ ‡è®°æ³•å®ç°å¹¶å‘ä¼˜åŒ–ï¼Œä½†STWå’Œç¢ç‰‡é—®é¢˜ä»éœ€ç»“åˆåˆ†ä»£å›æ”¶ã€ä½å»¶è¿Ÿæ”¶é›†å™¨åŠä»£ç è§„èŒƒå…±åŒè§£å†³ã€‚å¼€å‘è€…éœ€é¿å…æ»¥ç”¨ &lt;code&gt;finalize()&lt;/code&gt;ï¼Œå¹¶å‡å°‘æ·±å±‚å¼•ç”¨é“¾ä»¥æå‡GCæ•ˆç‡ã€‚&lt;/p&gt;
&lt;h2 id="gc"&gt;GC
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å…³äº &lt;strong&gt;JVM åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æœºåˆ¶&lt;/strong&gt;çš„è¯¦ç»†ä»‹ç»ï¼Œæ¶µç›–æ ¸å¿ƒåŸç†ã€ç®—æ³•ã€æ”¶é›†å™¨åˆ†ç±»åŠè°ƒä¼˜ç­–ç•¥ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-gc-æ ¸å¿ƒåŸç†ä¸ç›®æ ‡"&gt;ğŸ§  &lt;strong&gt;GC æ ¸å¿ƒåŸç†ä¸ç›®æ ‡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;
GC è‡ªåŠ¨ç®¡ç†å †å†…å­˜ï¼Œå›æ”¶â€œåƒåœ¾å¯¹è±¡â€ï¼ˆæ— å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ï¼‰ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼ˆOOMï¼‰å’Œæ‰‹åŠ¨ç®¡ç†è´Ÿæ‹…ã€‚&lt;/li&gt;
&lt;li&gt;å…³é”®é˜¶æ®µ
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ‡è®°ï¼ˆMarkingï¼‰&lt;/strong&gt;ï¼šä» GC Rootsï¼ˆè™šæ‹Ÿæœºæ ˆå¼•ç”¨ã€é™æ€å˜é‡ç­‰ï¼‰éå†å¯¹è±¡å›¾ï¼Œæ ‡è®°æ‰€æœ‰å¯è¾¾å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…é™¤ï¼ˆSweepingï¼‰&lt;/strong&gt;ï¼šå›æ”¶æœªæ ‡è®°çš„å¯¹è±¡å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‹ç¼©ï¼ˆCompactingï¼‰&lt;/strong&gt;ï¼šç§»åŠ¨å­˜æ´»å¯¹è±¡æ¶ˆé™¤å†…å­˜ç¢ç‰‡ï¼ˆå¯é€‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†ä»£å›æ”¶æ¨¡å‹"&gt;ğŸ”„ &lt;strong&gt;åˆ†ä»£å›æ”¶æ¨¡å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;JVM å †å†…å­˜åˆ†ä¸º&lt;strong&gt;æ–°ç”Ÿä»£&lt;/strong&gt;ï¼ˆYoung Generationï¼‰å’Œ&lt;strong&gt;è€å¹´ä»£&lt;/strong&gt;ï¼ˆOld Generationï¼‰ï¼Œé’ˆå¯¹ä¸åŒç”Ÿå‘½å‘¨æœŸå¯¹è±¡ä¼˜åŒ–å›æ”¶æ•ˆç‡ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åŒºåŸŸ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¯¹è±¡ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;GC ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å›æ”¶ç®—æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–°ç”Ÿä»£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿå‘½å‘¨æœŸçŸ­ï¼ˆ80% å¯¹è±¡çŸ­æœŸæ¶ˆäº¡ï¼‰&lt;/td&gt;
&lt;td&gt;Minor GC (Young GC)&lt;/td&gt;
&lt;td&gt;å¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰&lt;/td&gt;
&lt;td&gt;Eden åŒºæ»¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è€å¹´ä»£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é•¿æœŸå­˜æ´»å¯¹è±¡&lt;/td&gt;
&lt;td&gt;Major GC / Full GC&lt;/td&gt;
&lt;td&gt;æ ‡è®°-æ¸…é™¤/æ ‡è®°-æ•´ç†&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£ç©ºé—´ä¸è¶³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒç©ºé—´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»å…ƒä¿¡æ¯ã€å¸¸é‡ï¼ˆJDK8+ï¼‰&lt;/td&gt;
&lt;td&gt;Full GC&lt;/td&gt;
&lt;td&gt;â€”&lt;/td&gt;
&lt;td&gt;å…ƒç©ºé—´ä¸è¶³&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æ–°ç”Ÿä»£ç»“æ„"&gt;&lt;strong&gt;æ–°ç”Ÿä»£ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Eden åŒº&lt;/strong&gt;ï¼šæ–°å¯¹è±¡åˆ†é…åŒºï¼ˆå  80%ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Survivor åŒº
ï¼ˆS0/S1ï¼‰ï¼šå­˜æ”¾ Minor GC åå­˜æ´»å¯¹è±¡ï¼Œé‡‡ç”¨å¤åˆ¶ç®—æ³•äº¤æ›¿ä½¿ç”¨ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ™‹å‡æœºåˆ¶&lt;/strong&gt;ï¼šå¯¹è±¡å¹´é¾„ï¼ˆç»å† GC æ¬¡æ•°ï¼‰è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤ 15ï¼‰åˆ™ç§»å…¥è€å¹´ä»£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="full-gc-è§¦å‘æ¡ä»¶"&gt;&lt;strong&gt;Full GC è§¦å‘æ¡ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è€å¹´ä»£æˆ–å…ƒç©ºé—´ä¸è¶³ã€‚&lt;/li&gt;
&lt;li&gt;æ˜¾å¼è°ƒç”¨ &lt;code&gt;System.gc()&lt;/code&gt;ï¼ˆä¸æ¨èï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ï¼ˆMinor GC åå­˜æ´»å¯¹è±¡è¿‡å¤šï¼Œè€å¹´ä»£æ— æ³•å®¹çº³ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»æµåƒåœ¾æ”¶é›†å™¨"&gt;âš™ï¸ &lt;strong&gt;ä¸»æµåƒåœ¾æ”¶é›†å™¨&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ ¹æ®ååé‡ã€å»¶è¿Ÿéœ€æ±‚é€‰æ‹©ä¸åŒæ”¶é›†å™¨ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ”¶é›†å™¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç®—æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°å¯ç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Serial GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹&lt;/td&gt;
&lt;td&gt;æ–°ç”Ÿä»£å¤åˆ¶ + è€å¹´ä»£æ ‡è®°æ•´ç†&lt;/td&gt;
&lt;td&gt;å°å†…å­˜åº”ç”¨ï¼ˆ&amp;lt;2Gï¼‰æˆ–å•æ ¸ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseSerialGC&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Parallel GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ååä¼˜å…ˆï¼ˆå¤šçº¿ç¨‹ï¼‰&lt;/td&gt;
&lt;td&gt;æ–°ç”Ÿä»£å¤åˆ¶ + è€å¹´ä»£æ ‡è®°æ•´ç†&lt;/td&gt;
&lt;td&gt;æ‰¹å¤„ç†ä»»åŠ¡ï¼ˆé«˜ååéœ€æ±‚ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseParallelGC&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CMS&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½å»¶è¿Ÿï¼ˆå¹¶å‘ï¼‰&lt;/td&gt;
&lt;td&gt;æ ‡è®°-æ¸…é™¤&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£ä½åœé¡¿ï¼ˆJDK9 å‰é€‚ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseConcMarkSweepGC&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;G1 GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†åŒºå¹¶å‘&lt;/td&gt;
&lt;td&gt;æ ‡è®°-æ•´ç† + åˆ†åŒºå¤åˆ¶&lt;/td&gt;
&lt;td&gt;å¤§å †å†…å­˜ã€å¯é¢„æµ‹åœé¡¿ï¼ˆJDK9+ é»˜è®¤ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseG1GC&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ZGC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¶…ä½å»¶è¿Ÿï¼ˆå¹¶å‘ï¼‰&lt;/td&gt;
&lt;td&gt;ç€è‰²æŒ‡é’ˆ + è¯»å±éšœ&lt;/td&gt;
&lt;td&gt;TB çº§å †ã€åœé¡¿ &amp;lt;10ms&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseZGC&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æ”¶é›†å™¨ç‰¹æ€§å¯¹æ¯”"&gt;&lt;strong&gt;æ”¶é›†å™¨ç‰¹æ€§å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;ï¼šParallel GC &amp;gt; G1 &amp;gt; ZGCã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿ&lt;/strong&gt;ï¼šZGC â‰ˆ Shenandoah &amp;lt; G1 &amp;lt; CMSã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç¢ç‰‡&lt;/strong&gt;ï¼šCMS æ˜“ç¢ç‰‡åŒ–ï¼ŒG1/ZGC æ— ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-gc-ç®—æ³•è¯¦è§£"&gt;ğŸ§® &lt;strong&gt;GC ç®—æ³•è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;æ ‡è®°-æ¸…é™¤ï¼ˆMark-Sweepï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æµç¨‹&lt;/strong&gt;ï¼šæ ‡è®°å­˜æ´»å¯¹è±¡ â†’ æ¸…é™¤æœªæ ‡è®°å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå†…å­˜ç¢ç‰‡åŒ–ï¼ˆè€å¹´ä»£ CMS ä½¿ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æµç¨‹&lt;/strong&gt;ï¼šå°†å­˜æ´»å¯¹è±¡ä» Eden/S0 å¤åˆ¶åˆ° S1ï¼Œæ¸…ç©ºåŸåŒºåŸŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæµªè´¹ 50% ç©ºé—´ï¼ˆæ–°ç”Ÿä»£é€‚ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ ‡è®°-æ•´ç†ï¼ˆMark-Compactï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æµç¨‹&lt;/strong&gt;ï¼šæ ‡è®°å­˜æ´»å¯¹è±¡ â†’ å‘ä¸€ç«¯ç§»åŠ¨ â†’ æ¸…ç†è¾¹ç•Œå¤–å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šæ— ç¢ç‰‡ï¼ˆSerial Oldã€G1 è€å¹´ä»£ä½¿ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ†ä»£æ”¶é›†ï¼ˆGenerationalï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;ï¼šæ–°ç”Ÿä»£ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£ç”¨æ ‡è®°-æ¸…é™¤/æ•´ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph TB
A[å¯¹è±¡åˆ†é…åœ¨ Eden] --&amp;gt; B{Eden æ»¡ï¼Ÿ}
B -- æ˜¯ --&amp;gt; C[Minor GC]
C --&amp;gt; D[å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ° S0/S1]
D --&amp;gt; E{å¹´é¾„ â‰¥ 15ï¼Ÿ}
E -- æ˜¯ --&amp;gt; F[æ™‹å‡è€å¹´ä»£]
E -- å¦ --&amp;gt; G[ä¿ç•™ Survivor]
H[è€å¹´ä»£æ»¡] --&amp;gt; I[Major GC/Full GC]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-ç›‘æ§ä¸è°ƒä¼˜ç­–ç•¥"&gt;ğŸ› ï¸ &lt;strong&gt;ç›‘æ§ä¸è°ƒä¼˜ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å…³é”®ç›‘æ§å·¥å…·&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;jstat&lt;/code&gt;&lt;/strong&gt;ï¼šå®æ—¶æŸ¥çœ‹ GC æ¬¡æ•°ã€è€—æ—¶ï¼ˆ&lt;code&gt;jstat -gc &amp;lt;pid&amp;gt;&lt;/code&gt;ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;jmap&lt;/code&gt;&lt;/strong&gt;ï¼šç”Ÿæˆå †è½¬å‚¨æ–‡ä»¶ï¼ˆ&lt;code&gt;jmap -dump:format=b,file=heap.bin &amp;lt;pid&amp;gt;&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;VisualVM&lt;/strong&gt;ï¼šå¯è§†åŒ–åˆ†æå †å†…å­˜ã€çº¿ç¨‹ã€GC æ´»åŠ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;è°ƒä¼˜å‚æ•°ç¤ºä¾‹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å †å¤§å°ï¼š&lt;code&gt;-Xms4g -Xmx4g&lt;/code&gt;ï¼ˆé¿å…åŠ¨æ€æ‰©å®¹ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;æ–°ç”Ÿä»£æ¯”ä¾‹ï¼š&lt;code&gt;-Xmn1g&lt;/code&gt;ï¼ˆå †çš„ 1/4~1/3ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;G1 æœ€å¤§åœé¡¿ï¼š&lt;code&gt;-XX:MaxGCPauseMillis=200&lt;/code&gt;ï¼ˆè®¾å®š 200ms ç›®æ ‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;å¸¸è§é—®é¢˜ä¼˜åŒ–
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¢‘ç¹ Minor GC&lt;/strong&gt;ï¼šæ‰©å¤§æ–°ç”Ÿä»£ï¼ˆ&lt;code&gt;-Xmn&lt;/code&gt;ï¼‰ï¼Œå‡å°‘çŸ­å‘½å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;Full GC é¢‘ç¹ï¼š
&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥è€å¹´ä»£æ³„æ¼ï¼ˆMAT åˆ†æå †è½¬å‚¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¢å¤§å †æˆ–é™ä½å¯¹è±¡æ™‹å‡é€Ÿåº¦ï¼ˆ&lt;code&gt;-XX:MaxTenuringThreshold=10&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ƒç©ºé—´ OOM&lt;/strong&gt;ï¼šè°ƒæ•´ &lt;code&gt;-XX:MetaspaceSize=256m&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;JVM GC é€šè¿‡&lt;strong&gt;åˆ†ä»£æ¨¡å‹&lt;/strong&gt;å’Œ&lt;strong&gt;å¤šæ ·åŒ–æ”¶é›†å™¨&lt;/strong&gt;å¹³è¡¡å†…å­˜æ•ˆç‡ä¸ç¨‹åºæ€§èƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–°ç”Ÿä»£&lt;/strong&gt;é«˜é¢‘ Minor GC ç”¨&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼Œè¿½æ±‚é€Ÿåº¦ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è€å¹´ä»£&lt;/strong&gt;ä½é¢‘ Major GC ç”¨&lt;strong&gt;æ ‡è®°-æ¸…é™¤/æ•´ç†&lt;/strong&gt;ï¼Œå‡å°‘ç¢ç‰‡ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¶é›†å™¨é€‰æ‹©&lt;/strong&gt;éœ€æƒè¡¡ååé‡ï¼ˆParallel GCï¼‰ã€å»¶è¿Ÿï¼ˆG1/ZGCï¼‰å’Œå †å¤§å°ã€‚
ä¼˜åŒ–æ ¸å¿ƒåœ¨äº&lt;strong&gt;ç›‘æ§ GC æ—¥å¿—&lt;/strong&gt;ï¼Œç»“åˆä¸šåŠ¡åœºæ™¯è°ƒæ•´åˆ†ä»£æ¯”ä¾‹ã€æ™‹å‡é˜ˆå€¼åŠæ”¶é›†å™¨å‚æ•°ï¼Œé¿å… Full GC å¯¼è‡´çš„ç§’çº§åœé¡¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="minor-gc-major-gc--full-gc"&gt;Minor GC, Major GC &amp;amp; Full GC
&lt;/h2&gt;&lt;p&gt;Minor GCã€Major GC å’Œ Full GC æ˜¯ Java åƒåœ¾å›æ”¶ï¼ˆGCï¼‰ä¸­çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä¸‰è€…ä¸»è¦åœ¨ &lt;strong&gt;ä½œç”¨èŒƒå›´ã€è§¦å‘æ¡ä»¶ã€æ‰§è¡Œé¢‘ç‡å’Œæ€§èƒ½å½±å“&lt;/strong&gt; ä¸Šå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«æ€»ç»“"&gt;ğŸ”„ &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨èŒƒå›´&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ‰§è¡Œé¢‘ç‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è€—æ—¶/å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Minor GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ–°ç”Ÿä»£&lt;/strong&gt;ï¼ˆEden + Survivorï¼‰&lt;/td&gt;
&lt;td&gt;Eden åŒºæ»¡&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é«˜&lt;/strong&gt;ï¼ˆç§’/åˆ†é’Ÿçº§ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;çŸ­&lt;/strong&gt;ï¼ˆ10ms~100msï¼‰&lt;/td&gt;
&lt;td&gt;åªå›æ”¶æ–°ç”Ÿä»£ï¼Œå¤åˆ¶å­˜æ´»å¯¹è±¡åˆ° Survivor æˆ–è€å¹´ä»£ï¼ŒSTW æ—¶é—´çŸ­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Major GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;è€å¹´ä»£&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ˆé€šå¸¸ä¼´éš Minor GCï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½&lt;/strong&gt;ï¼ˆå°æ—¶çº§ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é•¿&lt;/strong&gt;ï¼ˆMinor GC çš„ 10 å€+ï¼‰&lt;/td&gt;
&lt;td&gt;ä»…æ¸…ç†è€å¹´ä»£ï¼Œä½†éƒ¨åˆ†è¯­å¢ƒä¸­ä¸ Full GC æ··ç”¨ï¼›æ˜“å†…å­˜ç¢ç‰‡åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Full GC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ•´ä¸ªå † + å…ƒç©ºé—´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£/å…ƒç©ºé—´ä¸è¶³ã€&lt;code&gt;System.gc()&lt;/code&gt;ã€ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ã€CMS/G1 ç‰¹å®šå¤±è´¥åœºæ™¯&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æä½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æé•¿&lt;/strong&gt;ï¼ˆ1s~10s+ï¼‰&lt;/td&gt;
&lt;td&gt;å…¨å±€å›æ”¶ï¼ŒSTW æ—¶é—´é•¿ï¼Œä¸¥é‡å½±å“æœåŠ¡å¯ç”¨æ€§ï¼›éœ€ä¼˜åŒ–é¿å…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…³é”®è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Major GC çš„æ­§ä¹‰&lt;/strong&gt;ï¼šéƒ¨åˆ†èµ„æ–™å°† Major GC ç­‰åŒäº Full GCï¼Œä½†ä¸¥æ ¼æ¥è¯´ï¼ŒMajor GC ä»…é’ˆå¯¹è€å¹´ä»£ï¼ŒFull GC æ¶µç›–æ•´ä¸ªå †+å…ƒç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;STWï¼ˆStop-The-Worldï¼‰&lt;/strong&gt;ï¼šæ‰€æœ‰ GC å‡ä¼šæš‚åœåº”ç”¨çº¿ç¨‹ï¼Œä½† Full GC çš„åœé¡¿æ—¶é—´æœ€é•¿ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡è¶…æ—¶æˆ–ç†”æ–­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹ä¸è§¦å‘æœºåˆ¶è¯¦è§£"&gt;âš™ï¸ &lt;strong&gt;å·¥ä½œæµç¨‹ä¸è§¦å‘æœºåˆ¶è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="minor-gc-æµç¨‹"&gt;&lt;strong&gt;Minor GC æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph TB
A[Eden åŒºæ»¡] --&amp;gt; B[è§¦å‘ Minor GC]
B --&amp;gt; C[æ ‡è®° Eden + Survivor å­˜æ´»å¯¹è±¡]
C --&amp;gt; D[å¤åˆ¶å­˜æ´»å¯¹è±¡åˆ°ç©ºé—² Survivor åŒº]
D --&amp;gt; E{å¯¹è±¡å¹´é¾„ â‰¥ 15?}
E -- æ˜¯ --&amp;gt; F[æ™‹å‡åˆ°è€å¹´ä»£]
E -- å¦ --&amp;gt; G[ä¿ç•™åœ¨ Survivor]
F &amp;amp; G --&amp;gt; H[æ¸…ç©º Eden + åŸ Survivor]
H --&amp;gt; I[äº¤æ¢ Survivor è§’è‰²]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘ç‚¹&lt;/strong&gt;ï¼šä»…å½“ &lt;strong&gt;Eden åŒºæ»¡&lt;/strong&gt;æ—¶è§¦å‘ï¼ˆSurvivor æ»¡ä¸ä¼šè§¦å‘ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™‹å‡æœºåˆ¶&lt;/strong&gt;ï¼šå¯¹è±¡æ¯å­˜æ´»ä¸€æ¬¡ Minor GC å¹´é¾„+1ï¼Œâ‰¥é˜ˆå€¼ï¼ˆé»˜è®¤15ï¼‰åˆ™è¿›å…¥è€å¹´ä»£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="full-gc-è§¦å‘æ¡ä»¶-1"&gt;&lt;strong&gt;Full GC è§¦å‘æ¡ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è€å¹´ä»£ä¸è¶³&lt;/strong&gt;ï¼šMinor GC åå­˜æ´»å¯¹è±¡è¿‡å¤šï¼Œè€å¹´ä»£æ— æ³•å®¹çº³ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ƒç©ºé—´ä¸è¶³&lt;/strong&gt;ï¼šåŠ è½½è¿‡å¤šç±»æˆ–åŠ¨æ€ç”Ÿæˆç±»ï¼ˆå¦‚åå°„ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜¾å¼è°ƒç”¨&lt;/strong&gt;ï¼š&lt;code&gt;System.gc()&lt;/code&gt; å»ºè®®æ‰§è¡Œï¼ˆå®é™…ç”± JVM å†³å®šï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;GC å¤±è´¥ï¼š
&lt;ul&gt;
&lt;li&gt;CMS çš„ &lt;strong&gt;Concurrent Mode Failure&lt;/strong&gt;ï¼ˆå¹¶å‘å›æ”¶æœŸé—´è€å¹´ä»£ä¸è¶³ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;G1 çš„ &lt;strong&gt;To-space æº¢å‡º&lt;/strong&gt;ï¼ˆæ— è¿ç»­ç©ºé—´å­˜æ”¾å­˜æ´»å¯¹è±¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½å½±å“ä¸ä¼˜åŒ–ç­–ç•¥"&gt;âš ï¸ &lt;strong&gt;æ€§èƒ½å½±å“ä¸ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="minor-gc-ä¼˜åŒ–"&gt;&lt;strong&gt;Minor GC ä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¢å¤§ Eden åŒº&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;-Xmn&lt;/code&gt; è°ƒæ•´æ–°ç”Ÿä»£å¤§å°ï¼Œå‡å°‘è§¦å‘é¢‘ç‡ï¼ˆéœ€å¹³è¡¡ Full GC é£é™©ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘çŸ­å‘½å¯¹è±¡&lt;/strong&gt;ï¼šé¿å…å¾ªç¯å†…é¢‘ç¹åˆ›å»ºä¸´æ—¶å¯¹è±¡ï¼ˆå¦‚ &lt;code&gt;new String()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é¿å…-full-gc"&gt;&lt;strong&gt;é¿å… Full GC&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åˆç†é…ç½®å †å†…å­˜ï¼š
&lt;ul&gt;
&lt;li&gt;è®¾ç½® &lt;code&gt;-Xms = -Xmx&lt;/code&gt; é¿å…å †åŠ¨æ€æ‰©å®¹ã€‚&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£å¤§å°éœ€å®¹çº³ &lt;strong&gt;å¹´è½»ä»£æ‰€æœ‰å­˜æ´»å¯¹è±¡&lt;/strong&gt;ï¼ˆé˜²æ­¢ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€‰æ‹©ä½å»¶è¿Ÿæ”¶é›†å™¨ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;G1&lt;/strong&gt;ï¼šåˆ†åŒºå›æ”¶ï¼Œå¯æ§åœé¡¿ï¼ˆ&lt;code&gt;-XX:MaxGCPauseMillis=200&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ZGC&lt;/strong&gt;ï¼šTB çº§å †ï¼Œåœé¡¿ &amp;lt;10msï¼ˆJDK 11+ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æ§å…ƒç©ºé—´ï¼š
&lt;ul&gt;
&lt;li&gt;è°ƒæ•´ &lt;code&gt;-XX:MetaspaceSize=256m&lt;/code&gt; é˜²æ­¢æº¢å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¦ç”¨æ˜¾å¼ GCï¼š
&lt;ul&gt;
&lt;li&gt;æ·»åŠ  &lt;code&gt;-XX:+DisableExplicitGC&lt;/code&gt; å¿½ç•¥ &lt;code&gt;System.gc()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Minor GC&lt;/strong&gt;ï¼šé«˜é¢‘ã€å¿«é€Ÿï¼Œ&lt;strong&gt;æ–°ç”Ÿä»£ä¸“å±å›æ”¶&lt;/strong&gt;ï¼Œä¼˜åŒ–æ ¸å¿ƒæ˜¯å‡å°‘å¯¹è±¡æ™‹å‡é€Ÿåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Major GC&lt;/strong&gt;ï¼šä½é¢‘ã€æ…¢é€Ÿï¼Œ&lt;strong&gt;ä»…æ¸…ç†è€å¹´ä»£&lt;/strong&gt;ï¼Œéœ€æ³¨æ„å†…å­˜ç¢ç‰‡é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Full GC&lt;/strong&gt;ï¼šå…¨å±€å›æ”¶ï¼Œ&lt;strong&gt;æ€§èƒ½æ€æ‰‹&lt;/strong&gt;ï¼Œè§¦å‘éœ€ç´§æ€¥æ’æŸ¥å†…å­˜æ³„æ¼æˆ–é…ç½®ä¸åˆç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;å®æˆ˜å»ºè®®&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;jstat -gcutil &amp;lt;pid&amp;gt;&lt;/code&gt; ç›‘æ§å„åŒºåŸŸä½¿ç”¨ç‡ï¼Œè‹¥ &lt;strong&gt;è€å¹´ä»£ &amp;gt;70%&lt;/strong&gt; æˆ– &lt;strong&gt;Full GC é¢‘ç‡ &amp;gt;1æ¬¡/å°æ—¶&lt;/strong&gt;ï¼Œéœ€ç«‹å³ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="cms"&gt;CMS
&lt;/h2&gt;&lt;p&gt;CMSï¼ˆConcurrent Mark Sweepï¼‰åƒåœ¾å›æ”¶å™¨æ˜¯ Java è™šæ‹Ÿæœºä¸­ä¸€æ¬¾ä»¥&lt;strong&gt;ä½åœé¡¿æ—¶é—´&lt;/strong&gt;ä¸ºç›®æ ‡çš„è€å¹´ä»£å¹¶å‘æ”¶é›†å™¨ï¼Œé€‚ç”¨äºå¯¹å“åº”æ—¶é—´æ•æ„Ÿçš„æœåŠ¡ç«¯åº”ç”¨ï¼ˆå¦‚ Web æœåŠ¡ï¼‰ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒåŸç†ã€å·¥ä½œæµç¨‹ã€ä¼˜ç¼ºç‚¹åŠè°ƒä¼˜ç­–ç•¥çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒè®¾è®¡ç›®æ ‡"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒè®¾è®¡ç›®æ ‡&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½å»¶è¿Ÿä¼˜å…ˆ&lt;/strong&gt;ï¼šé€šè¿‡å¹¶å‘æ‰§è¡Œåƒåœ¾å›æ”¶çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹ï¼Œæœ€å¤§é™åº¦å‡å°‘ STWï¼ˆStop-The-Worldï¼‰æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè€å¹´ä»£å›æ”¶ï¼Œéœ€é…åˆæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼ˆå¦‚ ParNewï¼‰ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®—æ³•åŸºç¡€&lt;/strong&gt;ï¼šæ ‡è®°-æ¸…é™¤ï¼ˆMark-Sweepï¼‰ï¼Œéç§»åŠ¨å¼å›æ”¶ï¼Œé¿å…å‹ç¼©å¸¦æ¥çš„é•¿æ—¶é—´åœé¡¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹å››é˜¶æ®µ"&gt;âš™ï¸ &lt;strong&gt;å·¥ä½œæµç¨‹ï¼ˆå››é˜¶æ®µï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;CMS å›æ”¶åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼Œä»… &lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt; å’Œ &lt;strong&gt;é‡æ–°æ ‡è®°&lt;/strong&gt; éœ€ STWï¼Œå…¶ä½™é˜¶æ®µå¹¶å‘æ‰§è¡Œï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é˜¶æ®µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ˜¯å¦ STW&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œå†…å®¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è€—æ—¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;æ ‡è®° GC Roots &lt;strong&gt;ç›´æ¥å¼•ç”¨&lt;/strong&gt;çš„å¯¹è±¡ï¼ˆå¦‚é™æ€å˜é‡ã€å±€éƒ¨å˜é‡ï¼‰&lt;/td&gt;
&lt;td&gt;æçŸ­ï¼ˆæ¯«ç§’çº§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;éå†å¯¹è±¡å›¾ï¼Œæ ‡è®°æ‰€æœ‰&lt;strong&gt;å¯è¾¾å¯¹è±¡&lt;/strong&gt;ï¼ˆä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘ï¼‰&lt;/td&gt;
&lt;td&gt;æœ€é•¿ï¼ˆå  90% æ—¶é—´ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é‡æ–°æ ‡è®°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·çº¿ç¨‹è¿è¡Œå¯¼è‡´çš„&lt;strong&gt;å¼•ç”¨å˜åŒ–&lt;/strong&gt;ï¼ˆå¦‚æ–°å¢å¯¹è±¡æˆ–å¼•ç”¨ä¸¢å¤±ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒçŸ­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ¸…é™¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;åˆ é™¤æ ‡è®°çš„åƒåœ¾å¯¹è±¡ï¼ˆä¸å‹ç¼©å†…å­˜ï¼‰ï¼Œé‡Šæ”¾ç©ºé—´&lt;/td&gt;
&lt;td&gt;è¾ƒé•¿&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[åˆå§‹æ ‡è®° STW] --&amp;gt; B[å¹¶å‘æ ‡è®°]
B --&amp;gt; C[é‡æ–°æ ‡è®° STW]
C --&amp;gt; D[å¹¶å‘æ¸…é™¤]
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¹¶å‘æ ‡è®°å’Œæ¸…é™¤é˜¶æ®µè™½ä¸æš‚åœåº”ç”¨ï¼Œä½†ä¼šå ç”¨ CPU èµ„æºï¼Œå¯¼è‡´åº”ç”¨ååé‡ä¸‹é™ã€‚&lt;/li&gt;
&lt;li&gt;é‡æ–°æ ‡è®°é˜¶æ®µé€šè¿‡&lt;strong&gt;å¢é‡æ›´æ–°&lt;/strong&gt;æˆ–&lt;strong&gt;åŸå§‹å¿«ç…§ï¼ˆSATBï¼‰&lt;/strong&gt; è§£å†³â€œè„æ ‡è®°â€é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç¼ºé™·ä¸æŒ‘æˆ˜"&gt;âš ï¸ &lt;strong&gt;æ ¸å¿ƒç¼ºé™·ä¸æŒ‘æˆ˜&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="cpu-èµ„æºæ•æ„Ÿ"&gt;&lt;strong&gt;CPU èµ„æºæ•æ„Ÿ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å¹¶å‘é˜¶æ®µå ç”¨çº¿ç¨‹æ•°ï¼šé»˜è®¤ &lt;code&gt;(CPU æ ¸å¿ƒæ•° + 3) / 4&lt;/code&gt;ï¼Œä¾‹å¦‚ 4 æ ¸ CPU ä¼šå ç”¨ 1 ä¸ªæ ¸å¿ƒèµ„æºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å½±å“&lt;/strong&gt;ï¼šé«˜å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½æ‹–æ…¢åº”ç”¨æ€§èƒ½ï¼Œé™ä½ååé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æµ®åŠ¨åƒåœ¾floating-garbage"&gt;&lt;strong&gt;æµ®åŠ¨åƒåœ¾ï¼ˆFloating Garbageï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æˆå› &lt;/strong&gt;ï¼šå¹¶å‘æ¸…é™¤é˜¶æ®µç”¨æˆ·çº¿ç¨‹æŒç»­è¿è¡Œï¼Œäº§ç”Ÿæ–°åƒåœ¾å¯¹è±¡æ— æ³•è¢«æœ¬æ¬¡å›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©&lt;/strong&gt;ï¼šè‹¥æµ®åŠ¨åƒåœ¾è¿‡å¤šå¯¼è‡´è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œä¼šè§¦å‘ &lt;strong&gt;Concurrent Mode Failure&lt;/strong&gt;ï¼Œé€€åŒ–ä¸º Serial Old æ”¶é›†å™¨ï¼ˆå…¨å † STWï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å†…å­˜ç¢ç‰‡"&gt;&lt;strong&gt;å†…å­˜ç¢ç‰‡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¹æº&lt;/strong&gt;ï¼šæ ‡è®°-æ¸…é™¤ç®—æ³•ä¸æ•´ç†å†…å­˜ï¼Œäº§ç”Ÿå¤§é‡ä¸è¿ç»­ç©ºé—´ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åæœ&lt;/strong&gt;ï¼šå¤§å¯¹è±¡åˆ†é…å¤±è´¥ï¼Œè¢«è¿«è§¦å‘ Full GCï¼ˆå‹ç¼©å†…å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¼“è§£æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;å¼€å¯ç¢ç‰‡æ•´ç†ï¼š&lt;code&gt;-XX:+UseCMSCompactAtFullCollection&lt;/code&gt;ï¼ˆFull GC åå‹ç¼©å†…å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è®¾ç½®å‹ç¼©é¢‘ç‡ï¼š&lt;code&gt;-XX:CMSFullGCsBeforeCompaction=N&lt;/code&gt;ï¼ˆæ¯ N æ¬¡ Full GC å‹ç¼©ä¸€æ¬¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è°ƒä¼˜ç­–ç•¥ä¸å‚æ•°é…ç½®"&gt;ğŸ› ï¸ &lt;strong&gt;è°ƒä¼˜ç­–ç•¥ä¸å‚æ•°é…ç½®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é¿å…-concurrent-mode-failure"&gt;&lt;strong&gt;é¿å… Concurrent Mode Failure&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é¢„ç•™ç©ºé—´ï¼šè°ƒæ•´è€å¹´ä»£è§¦å‘å›æ”¶é˜ˆå€¼ï¼Œé¿å…è¿‡æ—©è€—å°½ç©ºé—´ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-XX:CMSInitiatingOccupancyFraction=75 # è€å¹´ä»£å ç”¨ 75% æ—¶å¯åŠ¨ CMS
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§æ™‹å‡é€Ÿç‡&lt;/strong&gt;ï¼šç¡®ä¿è€å¹´ä»£ç©ºé—´ &amp;gt; å¹´è½»ä»£å­˜æ´»å¯¹è±¡æ€»é‡ï¼Œé˜²æ­¢ Minor GC åå¯¹è±¡æ™‹å‡å¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å‡å°‘ç¢ç‰‡å½±å“"&gt;&lt;strong&gt;å‡å°‘ç¢ç‰‡å½±å“&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºåˆ¶æ•´ç†&lt;/strong&gt;ï¼šåœ¨ä½å³°æœŸä¸»åŠ¨è§¦å‘ Full GC å‹ç¼©å†…å­˜ï¼ˆè°¨æ…ä½¿ç”¨ &lt;code&gt;System.gc()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§å¯¹è±¡åˆ†ç¦»&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;-XX:PretenureSizeThreshold&lt;/code&gt; å°†å¤§å¯¹è±¡ç›´æ¥åˆ†é…è‡³è€å¹´ä»£ï¼Œå‡å°‘ç¢ç‰‡äº§ç”Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="èµ„æºä¼˜åŒ–"&gt;&lt;strong&gt;èµ„æºä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ•°è°ƒæ•´ï¼šæ‰‹åŠ¨è®¾ç½®å¹¶å‘çº¿ç¨‹æ•°ï¼Œé¿å…è¿‡åº¦äº‰æŠ¢ CPUï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-XX:ConcGCThreads=2 # é™åˆ¶å¹¶å‘çº¿ç¨‹æ•°
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ç¦ç”¨æ— å…³åŠŸèƒ½ï¼šå…³é—­ç±»å¸è½½ä»¥å‡å°‘å¼€é”€ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;-XX:-CMSClassUnloadingEnabled # JDK8 å…ƒç©ºé—´é»˜è®¤ä¸å¸è½½ç±»
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;â³ &lt;strong&gt;é€‚ç”¨åœºæ™¯ä¸æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;é€‚ç”¨åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹å»¶è¿Ÿæ•æ„Ÿï¼ˆåœé¡¿æ—¶é—´ &amp;lt; 200msï¼‰çš„ Web æœåŠ¡ã€äº¤äº’å¼åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿ï¼Œç¢ç‰‡åŒ–å¯æ§çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸é€‚ç”¨åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜ååéœ€æ±‚ï¼ˆå¦‚æ‰¹å¤„ç†ï¼‰ï¼Œä¼˜å…ˆé€‰ Parallel Oldã€‚&lt;/li&gt;
&lt;li&gt;å † &amp;gt; 4GB æˆ–éœ€ä½å»¶è¿Ÿä¿éšœï¼ˆ&amp;lt; 10msï¼‰ï¼Œæ”¹ç”¨ G1 æˆ– ZGCã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†å²åœ°ä½&lt;/strong&gt;ï¼šJDK 9 åå®˜æ–¹æ¨è G1ï¼ŒJDK 14 ä¸­ CMS è¢«ç§»é™¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;CMS é€šè¿‡&lt;strong&gt;å¹¶å‘æ ‡è®°æ¸…é™¤&lt;/strong&gt;æ˜¾è‘—é™ä½è€å¹´ä»£å›æ”¶åœé¡¿ï¼Œä½†å…¶&lt;strong&gt;CPU å ç”¨ã€æµ®åŠ¨åƒåœ¾å’Œå†…å­˜ç¢ç‰‡&lt;/strong&gt;é—®é¢˜ä¹Ÿå¸¦æ¥è°ƒä¼˜å¤æ‚åº¦ã€‚åˆç†é…ç½®è§¦å‘é˜ˆå€¼ï¼ˆ&lt;code&gt;CMSInitiatingOccupancyFraction&lt;/code&gt;ï¼‰å’Œç¢ç‰‡æ•´ç†ç­–ç•¥ï¼Œå¯ç¼“è§£æ ¸å¿ƒç¼ºé™·ã€‚å¯¹äºæ–°é¡¹ç›®ï¼Œå»ºè®®ä¼˜å…ˆé€‰æ‹© G1/ZGC ç­‰ç°ä»£æ”¶é›†å™¨ï¼›å¯¹äº JDK 8 çš„å­˜é‡ç³»ç»Ÿï¼ŒCMS ä»æ˜¯å¹³è¡¡å»¶è¿Ÿä¸ååé‡çš„æœ‰æ•ˆé€‰æ‹©ã€‚&lt;/p&gt;
&lt;h2 id="g1"&gt;G1
&lt;/h2&gt;&lt;p&gt;G1ï¼ˆGarbage-Firstï¼‰åƒåœ¾æ”¶é›†å™¨æ˜¯Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸­é¢å‘å¤§å †å†…å­˜å’Œä½å»¶è¿Ÿåœºæ™¯è®¾è®¡çš„é©å‘½æ€§åƒåœ¾å›æ”¶å™¨ï¼Œè‡ªJDK 7u4å¼•å…¥ï¼Œå¹¶åœ¨JDK 9åå–ä»£CMSæˆä¸ºé»˜è®¤æ”¶é›†å™¨ã€‚ä»¥ä¸‹ä»è®¾è®¡ç›®æ ‡ã€æ ¸å¿ƒåŸç†ã€å·¥ä½œæµç¨‹ã€è°ƒä¼˜ç­–ç•¥åŠé€‚ç”¨åœºæ™¯å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡ç›®æ ‡ä¸æ ¸å¿ƒä¼˜åŠ¿"&gt;ğŸ”§ &lt;strong&gt;è®¾è®¡ç›®æ ‡ä¸æ ¸å¿ƒä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½å»¶è¿Ÿå¯æ§åœé¡¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;ï¼ˆé»˜è®¤200msï¼‰è®¾å®šç›®æ ‡åœé¡¿æ—¶é—´ï¼ŒG1åŠ¨æ€è°ƒæ•´å›æ”¶ç­–ç•¥ï¼Œä¼˜å…ˆå¤„ç†é«˜æ”¶ç›ŠRegionã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯å®æ—¶æ¨¡å‹&lt;/strong&gt;ï¼šåœ¨æŒ‡å®šæ—¶é—´ç‰‡å†…ï¼ˆå¦‚200msï¼‰å®Œæˆåƒåœ¾å›æ”¶ï¼Œé¿å…é•¿æ—¶STWï¼ˆStop-The-Worldï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§å †å†…å­˜å‹å¥½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒTBçº§å †å†…å­˜ï¼Œé€šè¿‡åˆ†åŒºï¼ˆRegionï¼‰æœºåˆ¶é¿å…å…¨å †æ‰«æï¼Œæ˜¾è‘—æå‡è¶…å¤§å †çš„å›æ”¶æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç¢ç‰‡æ§åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•´ä½“åŸºäº&lt;strong&gt;æ ‡è®°-æ•´ç†&lt;/strong&gt;ç®—æ³•ï¼Œå±€éƒ¨é‡‡ç”¨&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼Œæ¶ˆé™¤å†…å­˜ç¢ç‰‡ï¼Œé¿å…Full GCè§¦å‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘ä¸å¹¶è¡Œèƒ½åŠ›&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼šä¸ç”¨æˆ·çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œæ ‡è®°é˜¶æ®µï¼ˆå‡å°‘STWï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œå›æ”¶&lt;/strong&gt;ï¼šå¤šçº¿ç¨‹å¤„ç†Young/Mixed GCï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPUã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¶æ„regionåˆ†åŒºä¸è§’è‰²"&gt;ğŸ§± &lt;strong&gt;æ ¸å¿ƒæ¶æ„ï¼šRegionåˆ†åŒºä¸è§’è‰²&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;G1å°†å †åˆ’åˆ†ä¸º&lt;strong&gt;ç­‰å¤§å°Region&lt;/strong&gt;ï¼ˆé»˜è®¤2048ä¸ªï¼Œæ¯ä¸ª1MBâ€“32MBï¼‰ï¼ŒåŠ¨æ€åˆ†é…ä¸ºå››ç±»è§’è‰²ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Regionç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Eden&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–°å¯¹è±¡åˆ†é…åŒºåŸŸ&lt;/td&gt;
&lt;td&gt;å¹´è½»ä»£ç»„æˆéƒ¨åˆ†ï¼ŒGCæ—¶å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°Survivorã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Survivor&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨å¹´è½»ä»£å­˜æ´»å¯¹è±¡&lt;/td&gt;
&lt;td&gt;å¯¹è±¡å¹´é¾„è¾¾é˜ˆå€¼ï¼ˆé»˜è®¤15ï¼‰æ™‹å‡è‡³OldåŒºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Old&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨é•¿æœŸå­˜æ´»å¯¹è±¡&lt;/td&gt;
&lt;td&gt;é€šè¿‡Mixed GCéƒ¨åˆ†å›æ”¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Humongous&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨&lt;strong&gt;å·¨å‹å¯¹è±¡&lt;/strong&gt;ï¼ˆâ‰¥Region 50%ï¼‰&lt;/td&gt;
&lt;td&gt;ç›´æ¥åˆ†é…åœ¨OldåŒºï¼Œé¿å…å¹´è½»ä»£é¢‘ç¹æ™‹å‡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…³é”®æŠ€æœ¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®°å¿†é›†ï¼ˆRSetï¼‰&lt;/strong&gt;ï¼šæ¯ä¸ªRegionç»´æŠ¤è·¨Regionå¼•ç”¨è®°å½•ï¼Œé¿å…å…¨å †æ‰«æã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™å±éšœï¼ˆWrite Barrierï¼‰&lt;/strong&gt;ï¼šå®æ—¶æ›´æ–°RSetï¼Œè®°å½•å¼•ç”¨å˜åŒ–ï¼ˆå¦‚è€å¹´ä»£å¼•ç”¨æ–°ç”Ÿä»£ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹ä¸‰é˜¶æ®µå›æ”¶æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;å·¥ä½œæµç¨‹ï¼šä¸‰é˜¶æ®µå›æ”¶æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="young-gcå¹´è½»ä»£å›æ”¶"&gt;&lt;strong&gt;Young GCï¼ˆå¹´è½»ä»£å›æ”¶ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;ï¼šEdenåŒºRegionè€—å°½ã€‚&lt;/li&gt;
&lt;li&gt;è¿‡ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;STWæš‚åœï¼Œå¤åˆ¶Eden/Survivorå­˜æ´»å¯¹è±¡è‡³æ–°Survivoræˆ–OldåŒºã€‚&lt;/li&gt;
&lt;li&gt;æ›´æ–°RSetï¼Œå¤„ç†è·¨ä»£å¼•ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šé«˜é¢‘ã€çŸ­åœé¡¿ï¼ˆé€šå¸¸10-50msï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¹¶å‘æ ‡è®°concurrent-marking"&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;ï¼šè€å¹´ä»£å ç”¨è¾¾é˜ˆå€¼ï¼ˆ&lt;code&gt;-XX:InitiatingHeapOccupancyPercent=45&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†é˜¶æ®µï¼š
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹æ ‡è®°ï¼ˆSTWï¼‰&lt;/strong&gt;ï¼šæ ‡è®°GC Rootsç›´æ¥å¼•ç”¨å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¹åŒºåŸŸæ‰«æ&lt;/strong&gt;ï¼šæ‰«æSurvivoråˆ°Oldçš„å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼šä¸ç”¨æˆ·çº¿ç¨‹å¹¶è¡Œæ ‡è®°å¯è¾¾å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆæ ‡è®°ï¼ˆSTWï¼‰&lt;/strong&gt;ï¼šSATBç®—æ³•ä¿®æ­£å¹¶å‘æœŸå¼•ç”¨å˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…ç†&lt;/strong&gt;ï¼šç»Ÿè®¡Regionå­˜æ´»ç‡ï¼Œæ’åºå›æ”¶ä»·å€¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="mixed-gcæ··åˆå›æ”¶"&gt;&lt;strong&gt;Mixed GCï¼ˆæ··åˆå›æ”¶ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;ï¼šå¹¶å‘æ ‡è®°å®Œæˆåã€‚&lt;/li&gt;
&lt;li&gt;è¿‡ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;å›æ”¶&lt;strong&gt;æ‰€æœ‰å¹´è½»ä»£&lt;/strong&gt; + &lt;strong&gt;éƒ¨åˆ†è€å¹´ä»£&lt;/strong&gt;ï¼ˆæŒ‰ä¼˜å…ˆçº§é€‰æ‹©é«˜åƒåœ¾å æ¯”Regionï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;è½¬ç§»å­˜æ´»å¯¹è±¡ï¼Œå‹ç¼©ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›®æ ‡&lt;/strong&gt;ï¼šåœ¨&lt;code&gt;MaxGCPauseMillis&lt;/code&gt;å†…æœ€å¤§åŒ–å›æ”¶æ•ˆç‡ï¼ˆå¦‚200mså›æ”¶20ä¸ªRegionï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[Young GCï¼šEdenæ»¡] --&amp;gt; B[å¹¶å‘æ ‡è®°ï¼šè€å¹´ä»£å 45%]
B --&amp;gt; C[Mixed GCï¼šå¹´è½»ä»£+é«˜ä»·å€¼è€å¹´ä»£]
C --&amp;gt; D{æ˜¯å¦æ»¡è¶³å†…å­˜éœ€æ±‚ï¼Ÿ}
D -- æ˜¯ --&amp;gt; A
D -- å¦ --&amp;gt; E[Full GC]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-full-gcè§¦å‘ä¸è°ƒä¼˜ç­–ç•¥"&gt;âš ï¸ &lt;strong&gt;Full GCè§¦å‘ä¸è°ƒä¼˜ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="full-gcåœºæ™¯éœ€é¿å…"&gt;&lt;strong&gt;Full GCåœºæ™¯&lt;/strong&gt;ï¼ˆéœ€é¿å…ï¼‰
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ä¸è¶³&lt;/strong&gt;ï¼šå¤åˆ¶å¯¹è±¡æ—¶æ— ç©ºRegionå¯ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¨å‹å¯¹è±¡åˆ†é…å¤±è´¥&lt;/strong&gt;ï¼šè¿ç»­Humongous Regionä¸è¶³ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœé¡¿ç›®æ ‡è¿‡ä¸¥&lt;/strong&gt;ï¼š&lt;code&gt;MaxGCPauseMillis&lt;/code&gt;è®¾ç½®è¿‡å°ï¼Œå›æ”¶é€Ÿåº¦è·Ÿä¸ä¸Šåˆ†é…é€Ÿåº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…³é”®è°ƒä¼˜å‚æ•°"&gt;&lt;strong&gt;å…³é”®è°ƒä¼˜å‚æ•°&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èå€¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseG1GC&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯ç”¨G1æ”¶é›†å™¨&lt;/td&gt;
&lt;td&gt;å¿…é€‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:MaxGCPauseMillis=200&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç›®æ ‡åœé¡¿æ—¶é—´&lt;/td&gt;
&lt;td&gt;æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ï¼ˆ50-300msï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:InitiatingHeapOccupancyPercent=45&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è§¦å‘å¹¶å‘æ ‡è®°çš„è€å¹´ä»£é˜ˆå€¼&lt;/td&gt;
&lt;td&gt;ç›‘æ§è°ƒæ•´ï¼ˆ40-50%ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:G1HeapRegionSize=4m&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Regionå¤§å°ï¼ˆ2çš„å¹‚ï¼‰&lt;/td&gt;
&lt;td&gt;é»˜è®¤å †å¤§å°/2048&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:ConcGCThreads=4&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¹¶å‘æ ‡è®°çº¿ç¨‹æ•°&lt;/td&gt;
&lt;td&gt;CPUæ ¸æ•°çš„1/4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;è°ƒä¼˜å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å›ºå®šå¹´è½»ä»£&lt;/strong&gt;ï¼šç¦ç”¨&lt;code&gt;-Xmn&lt;/code&gt;ï¼Œè®©G1åŠ¨æ€è°ƒæ•´Eden/Survivoræ¯”ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§RSetå¼€é”€&lt;/strong&gt;ï¼šè¿‡å¤§RSetï¼ˆ&amp;gt;10%å †ï¼‰éœ€å‡å°‘å¼•ç”¨å¯†åº¦æˆ–å¢å¤§Regionã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¨å‹å¯¹è±¡ä¼˜åŒ–&lt;/strong&gt;ï¼šæ‹†åˆ†å¤§å¯¹è±¡æˆ–å¢å¤§Regionï¼Œå‡å°‘Humongousåˆ†é…å‹åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æ¨ªå‘å¯¹æ¯”"&gt;ğŸ“Š &lt;strong&gt;é€‚ç”¨åœºæ™¯ä¸æ¨ªå‘å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å †å†…å­˜ â‰¥6GBï¼Œä¸”æ´»è·ƒæ•°æ® &amp;gt;50%ã€‚&lt;/li&gt;
&lt;li&gt;è¦æ±‚åœé¡¿ &amp;lt;500msï¼ˆå¦‚å®æ—¶äº¤æ˜“ã€WebæœåŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;CMSå› ç¢ç‰‡å¯¼è‡´Full GCé¢‘ç¹çš„ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ”¶é›†å™¨å¯¹æ¯”"&gt;&lt;strong&gt;æ”¶é›†å™¨å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ”¶é›†å™¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;åœé¡¿æ—¶é—´&lt;/th&gt;
&lt;th&gt;å†…å­˜ç¢ç‰‡&lt;/th&gt;
&lt;th&gt;é€‚ç”¨å †å¤§å°&lt;/th&gt;
&lt;th&gt;ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;G1&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯æ§ï¼ˆäºšç§’çº§ï¼‰&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;6GBâ€“TBçº§&lt;/td&gt;
&lt;td&gt;å¹³è¡¡ååä¸å»¶è¿Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CMS&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ä½†ä¸ç¨³å®š&lt;/td&gt;
&lt;td&gt;ä¸¥é‡&lt;/td&gt;
&lt;td&gt;&amp;lt;4GB&lt;/td&gt;
&lt;td&gt;è€å¹´ä»£ä½å»¶è¿Ÿï¼Œå·²æ·˜æ±°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Parallel&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;&amp;lt;8GB&lt;/td&gt;
&lt;td&gt;ååä¼˜å…ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ZGC&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æä½ï¼ˆäºšæ¯«ç§’ï¼‰&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;TBçº§&lt;/td&gt;
&lt;td&gt;æè‡´å»¶è¿Ÿï¼ŒJDK11+&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-11"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;G1é€šè¿‡&lt;strong&gt;Regionåˆ†åŒº+ä¼˜å…ˆçº§å›æ”¶+å¹¶å‘æ ‡è®°&lt;/strong&gt;ä¸‰å¤§é©æ–°ï¼Œå®ç°å¤§å †å†…å­˜ä¸‹çš„ä½å»¶è¿Ÿå›æ”¶ï¼Œæˆä¸ºJDK9åé»˜è®¤æ”¶é›†å™¨ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´æ•´åˆ&lt;/strong&gt;ï¼šå¤åˆ¶ç®—æ³•æ¶ˆé™¤ç¢ç‰‡ï¼Œé¿å…Full GCï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯æ§åœé¡¿&lt;/strong&gt;ï¼šä»·å€¼æ¨¡å‹ä¼˜å…ˆå›æ”¶é«˜æ”¶ç›ŠRegionï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€é€‚åº”&lt;/strong&gt;ï¼šæ ¹æ®å †ä½¿ç”¨è‡ªåŠ¨è°ƒæ•´åˆ†ä»£æ¯”ä¾‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;ï¼šG1å†…å­˜å ç”¨é«˜äºCMSï¼ˆçº¦10%ï¼‰ï¼Œå°å †åœºæ™¯ï¼ˆ&amp;lt;4GBï¼‰å¯èƒ½ä¸å ä¼˜ã€‚ç”Ÿäº§ç¯å¢ƒéœ€ç»“åˆGCæ—¥å¿—ï¼ˆ&lt;code&gt;-Xlog:gc&lt;/code&gt;ï¼‰åŠJVisualVMç›‘æ§ï¼Œé’ˆå¯¹æ€§è°ƒä¼˜&lt;code&gt;MaxGCPauseMillis&lt;/code&gt;ä¸IHOPé˜ˆå€¼ï¼Œæ–¹èƒ½å‘æŒ¥å…¶æœ€å¤§æ•ˆèƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¼•ç”¨ç±»å‹"&gt;å¼•ç”¨ç±»å‹
&lt;/h2&gt;&lt;p&gt;Java ä¸­çš„å¼•ç”¨ç±»å‹å†³å®šäº†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œåƒåœ¾å›æ”¶ï¼ˆGCï¼‰è¡Œä¸ºï¼Œåˆç†ä½¿ç”¨å¯ä¼˜åŒ–å†…å­˜ç®¡ç†å¹¶é¿å…å†…å­˜æ³„æ¼ã€‚Java æä¾›äº†å››ç§å¼•ç”¨ç±»å‹ï¼ŒæŒ‰å¼ºåº¦ä»é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;ã€&lt;strong&gt;è½¯å¼•ç”¨&lt;/strong&gt;ã€&lt;strong&gt;å¼±å¼•ç”¨&lt;/strong&gt;ã€&lt;strong&gt;è™šå¼•ç”¨&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¼ºå¼•ç”¨strong-reference"&gt;ğŸ”§ &lt;strong&gt;å¼ºå¼•ç”¨ï¼ˆStrong Referenceï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤å¼•ç”¨ç±»å‹ï¼ˆå¦‚ &lt;code&gt;Object obj = new Object();&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åªè¦å¼ºå¼•ç”¨å­˜åœ¨ï¼Œå¯¹è±¡&lt;strong&gt;ä¸ä¼šè¢« GC å›æ”¶&lt;/strong&gt;ï¼Œå³ä½¿å†…å­˜ä¸è¶³æ—¶ JVM ä¼šæŠ›å‡º &lt;code&gt;OutOfMemoryError&lt;/code&gt; è€Œéå›æ”¶å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;è¿‡åº¦ä½¿ç”¨æ˜“å¯¼è‡´å†…å­˜æ³„æ¼ï¼ˆå¦‚é™æ€é›†åˆé•¿æœŸæŒæœ‰æ— ç”¨å¯¹è±¡ï¼‰ã€‚
&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒä¸šåŠ¡å¯¹è±¡ï¼ˆå¦‚ Spring å•ä¾‹ Beanï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éœ€é•¿æœŸå­˜æ´»çš„å…³é”®æ•°æ®ã€‚
&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Object obj = new Object(); // å¼ºå¼•ç”¨
obj = null; // æ‰‹åŠ¨æ–­å¼€å¼•ç”¨ï¼Œå¯¹è±¡å¯è¢«å›æ”¶
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-è½¯å¼•ç”¨soft-reference"&gt;ğŸ§½ &lt;strong&gt;è½¯å¼•ç”¨ï¼ˆSoft Referenceï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;SoftReference&lt;/code&gt; ç±»å®ç°ï¼ˆå¦‚ &lt;code&gt;SoftReference&amp;lt;byte[]&amp;gt; softRef = new SoftReference&amp;lt;&amp;gt;(new byte[1024]);&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ä¸è¶³æ—¶æ‰ä¼šè¢«å›æ”¶&lt;/strong&gt;ï¼Œé€‚åˆç¼“å­˜åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”å¼±å¼•ç”¨æ›´â€œå¼ºâ€ï¼ŒGC ä¼šä¼˜å…ˆä¿ç•™è½¯å¼•ç”¨å¯¹è±¡ã€‚
&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;å›¾ç‰‡ç¼“å­˜ï¼ˆå¦‚ Android çš„ &lt;code&gt;LruCache&lt;/code&gt; å†…éƒ¨ä½¿ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸´æ—¶å¤§å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚æ–‡ä»¶è¯»å–ç¼“å­˜ï¼‰ã€‚
&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SoftReference&amp;lt;Bitmap&amp;gt; cache = new SoftReference&amp;lt;&amp;gt;(loadBitmap());
Bitmap image = cache.get();
if (image == null) { // å†…å­˜ä¸è¶³æ—¶ç¼“å­˜è¢«å›æ”¶
image = reloadBitmap(); // é‡æ–°åŠ è½½
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å¼±å¼•ç”¨weak-reference"&gt;âš¡ &lt;strong&gt;å¼±å¼•ç”¨ï¼ˆWeak Referenceï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;WeakReference&lt;/code&gt; ç±»å®ç°ï¼ˆå¦‚ &lt;code&gt;WeakReference&amp;lt;Object&amp;gt; weakRef = new WeakReference&amp;lt;&amp;gt;(new Object());&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸‹æ¬¡ GC å‘ç”Ÿæ—¶å¿…å®šå›æ”¶&lt;/strong&gt;ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ã€‚&lt;/li&gt;
&lt;li&gt;ä¸é˜»æ­¢å›æ”¶ï¼Œé€‚åˆä¸´æ—¶æ•°æ®ã€‚
&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WeakHashMap&lt;/code&gt;ï¼ˆé”®ä¸ºå¼±å¼•ç”¨ï¼Œè‡ªåŠ¨æ¸…ç†æ— å¼•ç”¨çš„æ¡ç›®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ThreadLocal&lt;/code&gt; ä¸­çš„ &lt;code&gt;Entry&lt;/code&gt;ï¼ˆé˜²æ­¢çº¿ç¨‹æ± å¤ç”¨å¯¼è‡´å†…å­˜æ³„æ¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç›‘å¬å™¨åˆ—è¡¨ï¼ˆé¿å…æœªæ³¨é”€çš„ç›‘å¬å™¨æŒæœ‰å¯¹è±¡ï¼‰ã€‚
&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;WeakHashMap&amp;lt;Key, Resource&amp;gt; cache = new WeakHashMap&amp;lt;&amp;gt;();
Key key = new Key();
cache.put(key, new Resource());
key = null; // æ— å¼ºå¼•ç”¨åï¼Œä¸‹æ¬¡ GC è‡ªåŠ¨æ¸…ç†ç¼“å­˜æ¡ç›®
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-è™šå¼•ç”¨phantom-reference"&gt;ğŸ‘» &lt;strong&gt;è™šå¼•ç”¨ï¼ˆPhantom Referenceï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;PhantomReference&lt;/code&gt; + &lt;code&gt;ReferenceQueue&lt;/code&gt; å®ç°ï¼ˆå¦‚ &lt;code&gt;new PhantomReference&amp;lt;&amp;gt;(obj, queue)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— æ³•é€šè¿‡ &lt;code&gt;get()&lt;/code&gt; è·å–å¯¹è±¡&lt;/strong&gt;ï¼Œä»…ç”¨äºè·Ÿè¸ªå¯¹è±¡å›æ”¶æ—¶æœºã€‚&lt;/li&gt;
&lt;li&gt;å¯¹è±¡è¢«å›æ”¶æ—¶ï¼Œè™šå¼•ç”¨åŠ å…¥é˜Ÿåˆ—ï¼Œè§¦å‘åç»­æ¸…ç†æ“ä½œã€‚
&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;ç®¡ç†å †å¤–å†…å­˜ï¼ˆå¦‚ NIO çš„ &lt;code&gt;DirectByteBuffer&lt;/code&gt;ï¼Œé€šè¿‡ &lt;code&gt;Cleaner&lt;/code&gt; æœºåˆ¶é‡Šæ”¾ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;èµ„æºç²¾ç¡®é‡Šæ”¾ï¼ˆå¦‚æ•°æ®åº“è¿æ¥å›æ”¶åå…³é—­ç‰©ç†è¿æ¥ï¼‰ã€‚
&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ReferenceQueue&amp;lt;Object&amp;gt; queue = new ReferenceQueue&amp;lt;&amp;gt;();
PhantomReference&amp;lt;Object&amp;gt; phantomRef = new PhantomReference&amp;lt;&amp;gt;(new Object(), queue);
// ç›‘æ§é˜Ÿåˆ—çš„çº¿ç¨‹
new Thread(() -&amp;gt; {
try {
Reference&amp;lt;?&amp;gt; ref = queue.remove();
cleanUp(); // æ‰§è¡Œèµ„æºæ¸…ç†
} catch (InterruptedException e) { ... }
}).start();
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å¼•ç”¨é˜Ÿåˆ—referencequeue"&gt;ğŸ”„ &lt;strong&gt;å¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é…åˆè½¯/å¼±/è™šå¼•ç”¨ä½¿ç”¨ï¼Œ&lt;strong&gt;ç›‘å¬å¯¹è±¡å›æ”¶äº‹ä»¶&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å½“å¼•ç”¨å¯¹è±¡è¢«å›æ”¶æ—¶ï¼Œå¼•ç”¨æœ¬èº«åŠ å…¥é˜Ÿåˆ—ï¼Œå¯è§¦å‘å›è°ƒé€»è¾‘ã€‚
&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;è‡ªåŠ¨æ¸…ç†å…³è”èµ„æºï¼ˆå¦‚è™šå¼•ç”¨æ¡ˆä¾‹ä¸­çš„ &lt;code&gt;cleanUp()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç»Ÿè®¡å¯¹è±¡å›æ”¶é¢‘ç‡æˆ–è°ƒè¯•å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å››ç§å¼•ç”¨å¯¹æ¯”æ€»ç»“"&gt;ğŸ“Š &lt;strong&gt;å››ç§å¼•ç”¨å¯¹æ¯”æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¼•ç”¨ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å›æ”¶æ—¶æœº&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ˜¯å¦é˜»æ­¢å›æ”¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ˜¯å¦å¯è·å–å¯¹è±¡&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ°¸ä¸å›æ”¶ï¼ˆé™¤éæ— å¼•ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;td&gt;æ ¸å¿ƒä¸šåŠ¡å¯¹è±¡&lt;/td&gt;
&lt;td&gt;æ˜¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è½¯å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†…å­˜ä¸è¶³æ—¶å›æ”¶&lt;/td&gt;
&lt;td&gt;å¦ï¼ˆå†…å­˜ä¸è¶³æ—¶ï¼‰&lt;/td&gt;
&lt;td&gt;å†…å­˜æ•æ„Ÿç¼“å­˜ï¼ˆå¦‚å›¾ç‰‡ï¼‰&lt;/td&gt;
&lt;td&gt;æ˜¯ï¼ˆå¯èƒ½ä¸º &lt;code&gt;null&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼±å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸‹æ¬¡ GC å¿…å®šå›æ”¶&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;ä¸´æ—¶ç¼“å­˜ï¼ˆå¦‚ &lt;code&gt;WeakHashMap&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æ˜¯ï¼ˆå¯èƒ½ä¸º &lt;code&gt;null&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è™šå¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éšæ—¶å›æ”¶ï¼ˆä»…è·Ÿè¸ªå›æ”¶æ—¶æœºï¼‰&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;èµ„æºæ¸…ç†è·Ÿè¸ª&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨å»ºè®®"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;ï¼šé»˜è®¤é€‰æ‹©ï¼Œç¡®ä¿å¯¹è±¡å­˜æ´»ï¼Œä½†éœ€åŠæ—¶é‡Šæ”¾æ— ç”¨å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯å¼•ç”¨&lt;/strong&gt;ï¼šç¼“å­˜å¯é‡å»ºçš„å¤§å¯¹è±¡ï¼ˆå¦‚å›¾ç‰‡ï¼‰ï¼Œå…è®¸å†…å­˜ä¸è¶³æ—¶è‡ªåŠ¨é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±å¼•ç”¨&lt;/strong&gt;ï¼šå­˜å‚¨éå¿…éœ€çš„å…ƒæ•°æ®ï¼ˆå¦‚ç›‘å¬å™¨ï¼‰ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è™šå¼•ç”¨&lt;/strong&gt;ï¼šç²¾ç»†æ§åˆ¶èµ„æºå›æ”¶ï¼ˆå¦‚å †å¤–å†…å­˜ï¼‰ï¼Œéœ€é…åˆå¼•ç”¨é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…æ»¥ç”¨&lt;/strong&gt;ï¼šå¼±/è½¯å¼•ç”¨å¢åŠ  GC å¤æ‚åº¦ï¼Œè¿‡åº¦ä½¿ç”¨å¯èƒ½å½±å“æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-12"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Java çš„å››ç§å¼•ç”¨ç±»å‹æä¾›äº†çµæ´»çš„å†…å­˜ç®¡ç†æœºåˆ¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;ä¿éšœæ ¸å¿ƒå¯¹è±¡å­˜æ´»ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯å¼•ç”¨&lt;/strong&gt;å¹³è¡¡ç¼“å­˜ä¸å†…å­˜å‹åŠ›ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±å¼•ç”¨&lt;/strong&gt;é¿å…ä¸´æ—¶æ•°æ®æ³„æ¼ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è™šå¼•ç”¨&lt;/strong&gt;å®ç°èµ„æºå›æ”¶è·Ÿè¸ªã€‚
åˆç†é€‰æ‹©å¼•ç”¨ç±»å‹ï¼Œç»“åˆ &lt;code&gt;ReferenceQueue&lt;/code&gt; ç›‘å¬å›æ”¶äº‹ä»¶ï¼Œå¯æ˜¾è‘—æå‡ç¨‹åºå¥å£®æ€§å’Œå†…å­˜æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="å»ºç«‹å¼•ç”¨"&gt;å»ºç«‹å¼•ç”¨
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œå››ç§å¼•ç”¨ç±»å‹ï¼ˆå¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨ï¼‰çš„åˆ›å»ºæ–¹å¼åŠå…¶æ ¸å¿ƒç‰¹ç‚¹å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¼•ç”¨ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒç±»&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åˆ›å»ºæ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä»£ç ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— ï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
&lt;td&gt;ç›´æ¥é€šè¿‡ &lt;code&gt;new&lt;/code&gt; åˆ›å»ºå¯¹è±¡å¹¶èµ‹å€¼ç»™å˜é‡ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Object obj = new Object();&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯¹è±¡ä¸ä¼šè¢« GC å›æ”¶ï¼Œé™¤éæ‰‹åŠ¨ç½®ç©º (&lt;code&gt;obj = null&lt;/code&gt;)ã€‚éœ€é¿å…å†…å­˜æ³„æ¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è½¯å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SoftReference&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ &lt;code&gt;SoftReference&lt;/code&gt; åŒ…è£¹å¯¹è±¡ï¼Œå¹¶&lt;strong&gt;è§£é™¤åŸå§‹å¼ºå¼•ç”¨&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Object obj = new Object();&lt;/code&gt; &lt;code&gt;SoftReference&amp;lt;Object&amp;gt; softRef = new SoftReference&amp;lt;&amp;gt;(obj);&lt;/code&gt; &lt;code&gt;obj = null;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å†…å­˜ä¸è¶³æ—¶ GC ä¼šå›æ”¶è½¯å¼•ç”¨å¯¹è±¡ã€‚å¸¸ç”¨äºç¼“å­˜ï¼ˆå¦‚å›¾ç‰‡ã€ä¸´æ—¶æ•°æ®ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼±å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WeakReference&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ &lt;code&gt;WeakReference&lt;/code&gt; åŒ…è£¹å¯¹è±¡ï¼Œå¹¶&lt;strong&gt;è§£é™¤åŸå§‹å¼ºå¼•ç”¨&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Object obj = new Object();&lt;/code&gt; &lt;code&gt;WeakReference&amp;lt;Object&amp;gt; weakRef = new WeakReference&amp;lt;&amp;gt;(obj);&lt;/code&gt; &lt;code&gt;obj = null;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸‹æ¬¡ GC å¿…ç„¶å›æ”¶&lt;/strong&gt;ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ã€‚é€‚ç”¨åœºæ™¯ï¼š&lt;code&gt;WeakHashMap&lt;/code&gt;ã€ç›‘å¬å™¨æ¸…ç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è™šå¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PhantomReference&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ &lt;code&gt;PhantomReference&lt;/code&gt;åŒ…è£¹å¯¹è±¡ï¼Œ&lt;strong&gt;å¿…é¡»ç»‘å®š &lt;code&gt;ReferenceQueue&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ReferenceQueue&amp;lt;Object&amp;gt; queue = new ReferenceQueue&amp;lt;&amp;gt;();&lt;/code&gt; &lt;code&gt;PhantomReference&amp;lt;Object&amp;gt; phantomRef = new PhantomReference&amp;lt;&amp;gt;(new Object(), queue);&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ— æ³•é€šè¿‡ &lt;code&gt;get()&lt;/code&gt; è·å–å¯¹è±¡&lt;/strong&gt;ã€‚ä»…ç”¨äºè·Ÿè¸ªå¯¹è±¡å›æ”¶æ—¶æœºï¼ˆå¦‚èµ„æºæ¸…ç†ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="è¯¦ç»†è¯´æ˜åŠæ³¨æ„äº‹é¡¹"&gt;è¯¦ç»†è¯´æ˜åŠæ³¨æ„äº‹é¡¹ï¼š
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç›´æ¥é€šè¿‡èµ‹å€¼è¯­å¥åˆ›å»ºï¼Œæ˜¯é»˜è®¤çš„å¼•ç”¨ç±»å‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å›æ”¶æ¡ä»¶&lt;/strong&gt;ï¼šæ˜¾å¼ç½®ç©º (&lt;code&gt;obj = null&lt;/code&gt;) æˆ–è¶…å‡ºä½œç”¨åŸŸã€‚&lt;/li&gt;
&lt;li&gt;æ»¥ç”¨å¼ºå¼•ç”¨ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼ˆå¦‚é™æ€é›†åˆé•¿æœŸæŒæœ‰æ— ç”¨å¯¹è±¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯å¼•ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºåéœ€&lt;strong&gt;è§£é™¤åŸå§‹å¼ºå¼•ç”¨&lt;/strong&gt; (&lt;code&gt;obj = null&lt;/code&gt;)ï¼Œå¦åˆ™å¯¹è±¡ä»è¢«å¼ºå¼•ç”¨ä¿æŠ¤ï¼Œæ— æ³•è¢«å›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;é€‚åˆç¼“å­˜åœºæ™¯ï¼šå†…å­˜å……è¶³æ—¶ä¿ç•™å¯¹è±¡ï¼Œå†…å­˜ä¸è¶³æ—¶è‡ªåŠ¨é‡Šæ”¾ï¼ˆå¦‚ &lt;code&gt;LruCache&lt;/code&gt; åº•å±‚å®ç°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯é€šè¿‡ &lt;code&gt;softRef.get()&lt;/code&gt; è·å–å¯¹è±¡ï¼ˆè‹¥æœªè¢«å›æ”¶ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±å¼•ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŒæ ·éœ€&lt;strong&gt;è§£é™¤åŸå§‹å¼ºå¼•ç”¨&lt;/strong&gt;ï¼Œå¦åˆ™å¼±å¼•ç”¨æ— æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å›æ”¶æ—¶æœº&lt;/strong&gt;ï¼šä¸‹æ¬¡ GC å‘ç”Ÿæ—¶å¿…ç„¶å›æ”¶ï¼ˆæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹åº”ç”¨ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;WeakHashMap&lt;/code&gt;ï¼šé”®ä¸ºå¼±å¼•ç”¨ï¼Œè‡ªåŠ¨æ¸…ç†æ— å¼•ç”¨çš„æ¡ç›®ã€‚&lt;/li&gt;
&lt;li&gt;ç›‘å¬å™¨åˆ—è¡¨ï¼šé¿å…æœªæ³¨é”€çš„ç›‘å¬å™¨å¯¼è‡´å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è™šå¼•ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¿…é¡»ç»‘å®š &lt;code&gt;ReferenceQueue&lt;/code&gt;&lt;/strong&gt;ï¼Œå¦åˆ™æ— æ³•è·Ÿè¸ªå¯¹è±¡å›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;phantomRef.get()&lt;/code&gt; æ’è¿”å› &lt;code&gt;null&lt;/code&gt;ï¼Œ&lt;strong&gt;æ— æ³•è·å–å¯¹è±¡å®ä¾‹&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒç”¨é€”ï¼š
&lt;ul&gt;
&lt;li&gt;ç›‘æ§å¯¹è±¡å›æ”¶äº‹ä»¶ï¼ˆé€šè¿‡è½®è¯¢ &lt;code&gt;ReferenceQueue&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç²¾å‡†é‡Šæ”¾èµ„æºï¼ˆå¦‚ &lt;code&gt;DirectByteBuffer&lt;/code&gt; çš„å †å¤–å†…å­˜æ¸…ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="æ€»ç»“"&gt;æ€»ç»“ï¼š
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;ï¼šé»˜è®¤æ–¹å¼ï¼Œéœ€æ‰‹åŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯/å¼±å¼•ç”¨&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;SoftReference&lt;/code&gt;/&lt;code&gt;WeakReference&lt;/code&gt; åˆ›å»ºï¼Œ&lt;strong&gt;å¿…é¡»è§£é™¤å¼ºå¼•ç”¨&lt;/strong&gt;æ‰èƒ½ç”Ÿæ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è™šå¼•ç”¨&lt;/strong&gt;ï¼šéœ€é…åˆ &lt;code&gt;ReferenceQueue&lt;/code&gt;ï¼Œä»…ç”¨äºå›æ”¶äº‹ä»¶ç›‘å¬ã€‚
åˆç†é€‰æ‹©å¼•ç”¨ç±»å‹å¯ä¼˜åŒ–å†…å­˜ç®¡ç†ï¼Œé¿å…æ³„æ¼ï¼Œæå‡åº”ç”¨ç¨³å®šæ€§ï¼ˆå¦‚ç¼“å­˜è‡ªåŠ¨é‡Šæ”¾ã€èµ„æºåŠæ—¶æ¸…ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="æ–¹æ³•åŒº"&gt;æ–¹æ³•åŒº
&lt;/h2&gt;&lt;p&gt;æ–¹æ³•åŒºæ˜¯JVMè§„èŒƒä¸­å®šä¹‰çš„é€»è¾‘å†…å­˜åŒºåŸŸï¼Œå­˜å‚¨ç±»åŠ è½½åçš„å…ƒæ•°æ®ã€å¸¸é‡æ± ç­‰æ ¸å¿ƒä¿¡æ¯ã€‚å…¶ç‰©ç†å®ç°åœ¨ä¸åŒJDKç‰ˆæœ¬ä¸­ç»å†äº†ä»**æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰&lt;strong&gt;åˆ°&lt;/strong&gt;å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰**çš„æ¼”è¿›ï¼ˆJDK8+ï¼‰ã€‚ä»¥ä¸‹æ˜¯æ–¹æ³•åŒºå„ç»„ä»¶çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="ç±»å‹ä¿¡æ¯class-metadata"&gt;&lt;strong&gt;ç±»å‹ä¿¡æ¯ï¼ˆClass Metadataï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨æ¯ä¸ªåŠ è½½ç±»ï¼ˆç±»ã€æ¥å£ã€æšä¸¾ã€æ³¨è§£ï¼‰çš„ç»“æ„åŒ–ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç±»å…¨é™å®šå&lt;/strong&gt;ï¼šå®Œæ•´åŒ…è·¯å¾„ï¼ˆå¦‚&lt;code&gt;java.lang.String&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›´æ¥çˆ¶ç±»å&lt;/strong&gt;ï¼šçˆ¶ç±»çš„å…¨é™å®šåï¼ˆæ¥å£æˆ–&lt;code&gt;Object&lt;/code&gt;ç±»åˆ™æ— çˆ¶ç±»ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿®é¥°ç¬¦&lt;/strong&gt;ï¼š&lt;code&gt;public&lt;/code&gt;ã€&lt;code&gt;abstract&lt;/code&gt;ã€&lt;code&gt;final&lt;/code&gt;ç­‰è®¿é—®æ ‡å¿—&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æ¥å£åˆ—è¡¨&lt;/strong&gt;ï¼šæŒ‰å£°æ˜é¡ºåºå­˜å‚¨ç›´æ¥æ¥å£çš„æœ‰åºåˆ—è¡¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»ç‰ˆæœ¬å·&lt;/strong&gt;ï¼šç¼–è¯‘ç”Ÿæˆçš„ç‰ˆæœ¬æ ‡è¯†ï¼ˆç”¨äºéªŒè¯å…¼å®¹æ€§ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šæ”¯æ’‘&lt;code&gt;instanceof&lt;/code&gt;ã€åå°„ï¼ˆå¦‚&lt;code&gt;Class.getName()&lt;/code&gt;ï¼‰ã€ç±»ç»§æ‰¿å…³ç³»è§£æç­‰æ“ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="å­—æ®µä¿¡æ¯field-metadata"&gt;&lt;strong&gt;å­—æ®µä¿¡æ¯ï¼ˆField Metadataï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è®°å½•ç±»çš„æ‰€æœ‰å­—æ®µå…ƒæ•°æ®åŠå…¶å£°æ˜é¡ºåºï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å­—æ®µå±æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å­—æ®µåç§°&lt;/td&gt;
&lt;td&gt;å¦‚&lt;code&gt;private String username&lt;/code&gt;ä¸­çš„&lt;code&gt;username&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­—æ®µç±»å‹&lt;/td&gt;
&lt;td&gt;åŸºç¡€ç±»å‹ï¼ˆ&lt;code&gt;int&lt;/code&gt;ï¼‰æˆ–å¯¹è±¡å¼•ç”¨ï¼ˆ&lt;code&gt;java.util.List&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­—æ®µä¿®é¥°ç¬¦&lt;/td&gt;
&lt;td&gt;&lt;code&gt;public&lt;/code&gt;/&lt;code&gt;private&lt;/code&gt;/&lt;code&gt;static&lt;/code&gt;/&lt;code&gt;final&lt;/code&gt;/&lt;code&gt;volatile&lt;/code&gt;ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­—æ®µåç§»é‡&lt;/td&gt;
&lt;td&gt;ï¼ˆå¯é€‰ï¼‰JVMä¼˜åŒ–å­—æ®µå†…å­˜å¸ƒå±€çš„åç§»åœ°å€&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šé&lt;code&gt;final&lt;/code&gt;å­—æ®µåœ¨ç±»åŠ è½½çš„&lt;strong&gt;å‡†å¤‡é˜¶æ®µ&lt;/strong&gt;åˆ†é…å†…å­˜ï¼Œåˆå§‹åŒ–ä¸ºé»˜è®¤å€¼ï¼ˆå¦‚&lt;code&gt;int&lt;/code&gt;ä¸º0ï¼‰ï¼›&lt;code&gt;final&lt;/code&gt;å­—æ®µç¼–è¯‘æœŸç¡®å®šå€¼ï¼Œå­˜å‚¨äºå¸¸é‡æ± ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="æ–¹æ³•ä¿¡æ¯method-metadata"&gt;&lt;strong&gt;æ–¹æ³•ä¿¡æ¯ï¼ˆMethod Metadataï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨æ–¹æ³•çš„å®Œæ•´å…ƒæ•°æ®åŠå­—èŠ‚ç æŒ‡ä»¤ï¼š
1.
åŸºç¡€ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•åã€è¿”å›ç±»å‹ã€å‚æ•°åˆ—è¡¨ï¼ˆç±»å‹ä¸é¡ºåºï¼‰&lt;/li&gt;
&lt;li&gt;ä¿®é¥°ç¬¦ï¼ˆ&lt;code&gt;synchronized&lt;/code&gt;ã€&lt;code&gt;native&lt;/code&gt;ã€&lt;code&gt;abstract&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—èŠ‚ç æŒ‡ä»¤&lt;/strong&gt;ï¼šç¼–è¯‘åçš„æ“ä½œç åºåˆ—ï¼ˆå¦‚&lt;code&gt;iload_1&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œæ•°æ ˆæ·±åº¦&lt;/strong&gt;ï¼šæ–¹æ³•æ‰§è¡Œæ‰€éœ€çš„æœ€å¤§æ ˆæ·±åº¦ï¼ˆ&lt;code&gt;max_stack&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±€éƒ¨å˜é‡è¡¨å¤§å°&lt;/strong&gt;ï¼šå­˜å‚¨å±€éƒ¨å˜é‡æ‰€éœ€ç©ºé—´ï¼ˆ&lt;code&gt;max_locals&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸è¡¨&lt;/strong&gt;ï¼š&lt;code&gt;try-catch&lt;/code&gt;å—èŒƒå›´ã€æ•è·çš„å¼‚å¸¸ç±»å‹åŠå¤„ç†ä»£ç ä½ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åŠ¨æ€ç‰¹æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;synchronized&lt;/code&gt;æ–¹æ³•çš„é”å…³è”ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;native&lt;/code&gt;æ–¹æ³•çš„æœ¬åœ°å‡½æ•°å…¥å£åœ°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ä¾‹å¤–&lt;/strong&gt;ï¼š&lt;code&gt;abstract&lt;/code&gt;å’Œ&lt;code&gt;native&lt;/code&gt;æ–¹æ³•æ— å­—èŠ‚ç åŠå¼‚å¸¸è¡¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="è¿è¡Œæ—¶å¸¸é‡æ± runtime-constant-pool"&gt;&lt;strong&gt;è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç±»åŠ è½½åï¼Œå°†&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶çš„&lt;strong&gt;é™æ€å¸¸é‡æ± &lt;/strong&gt;åŠ¨æ€æ˜ å°„åˆ°æ–¹æ³•åŒºï¼Œå½¢æˆè¿è¡Œæ—¶å¸¸é‡æ± ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¸¸é‡ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å†…å®¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—é¢é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²ï¼ˆå¦‚&lt;code&gt;&amp;quot;Hello&amp;quot;&lt;/code&gt;ï¼‰ã€æ•°å€¼ã€&lt;code&gt;final&lt;/code&gt;å¸¸é‡å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¬¦å·å¼•ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»/å­—æ®µ/æ–¹æ³•åï¼ˆå…¨é™å®šåï¼‰ã€æè¿°ç¬¦ï¼ˆå¦‚&lt;code&gt;(I)V&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ¨æ€è§£æç»“æœ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ—¶å°†ç¬¦å·å¼•ç”¨è½¬ä¸ºç›´æ¥å¼•ç”¨ï¼ˆå¦‚æ–¹æ³•å®é™…åœ°å€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒèƒ½åŠ›&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒ&lt;code&gt;String.intern()&lt;/code&gt;å°†å­—ç¬¦ä¸²åŠ¨æ€åŠ å…¥å¸¸é‡æ± ï¼›&lt;/li&gt;
&lt;li&gt;å‡å°‘é‡å¤æ•°æ®å­˜å‚¨ï¼Œå‹ç¼©å­—èŠ‚ç ä½“ç§¯ï¼ˆå¹³å‡40%+ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="é™æ€å˜é‡static-variables"&gt;&lt;strong&gt;é™æ€å˜é‡ï¼ˆStatic Variablesï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨ç±»çš„é™æ€æˆå‘˜ï¼ˆé&lt;code&gt;final&lt;/code&gt;ç±»å˜é‡ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜åˆ†é…&lt;/strong&gt;ï¼šç±»åŠ è½½çš„&lt;strong&gt;å‡†å¤‡é˜¶æ®µ&lt;/strong&gt;åˆ†é…å†…å­˜ï¼Œåˆå§‹åŒ–é˜¶æ®µèµ‹å®é™…å€¼ï¼ˆå¦‚&lt;code&gt;static int count=10&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å­˜å‚¨ä½ç½®ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;JDK7-&lt;/strong&gt;ï¼šæ°¸ä¹…ä»£&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;JDK8+&lt;/strong&gt;ï¼šå †å†…å­˜ï¼ˆé™æ€å˜é‡ä¸å¯¹è±¡å®ä¾‹å…±å­˜ï¼Œé¿å…æ°¸ä¹…ä»£æº¢å‡ºï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ä¸å¸¸é‡çš„åŒºåˆ«&lt;/strong&gt;ï¼š&lt;code&gt;static final&lt;/code&gt;å¸¸é‡åœ¨ç¼–è¯‘æœŸç¡®å®šå€¼ï¼Œç›´æ¥åµŒå…¥å¸¸é‡æ± ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="å³æ—¶ç¼–è¯‘ä»£ç ç¼“å­˜jit-code-cache"&gt;&lt;strong&gt;å³æ—¶ç¼–è¯‘ä»£ç ç¼“å­˜ï¼ˆJIT Code Cacheï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨JITç¼–è¯‘å™¨ä¼˜åŒ–çš„æœ¬åœ°æœºå™¨ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;ï¼šæ–¹æ³•è¢«é¢‘ç¹è°ƒç”¨ï¼ˆçƒ­ç‚¹ä»£ç ï¼‰æ—¶ï¼ŒJITå°†å…¶ç¼–è¯‘ä¸ºæœºå™¨ç ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šé¿å…é‡å¤è§£é‡Šæ‰§è¡Œå­—èŠ‚ç ï¼Œæå‡æ€§èƒ½10å€ä»¥ä¸Šã€‚&lt;/li&gt;
&lt;li&gt;ç®¡ç†æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;ä»£ç ç¼“å­˜åŒºå¤§å°å¯é€šè¿‡&lt;code&gt;-XX:ReservedCodeCacheSize&lt;/code&gt;è°ƒæ•´ï¼›&lt;/li&gt;
&lt;li&gt;ç¼“å­˜æ»¡æ—¶åœæ­¢ç¼–è¯‘ï¼Œé€€å›è§£é‡Šæ‰§è¡Œæ¨¡å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="ç±»åŠ è½½å™¨ä¸classå¯¹è±¡å¼•ç”¨"&gt;&lt;strong&gt;ç±»åŠ è½½å™¨ä¸Classå¯¹è±¡å¼•ç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ–¹æ³•åŒºç»´æŠ¤ç±»ä¸åŠ è½½å™¨åŠClasså¯¹è±¡çš„å…³è”ï¼š
1.
ç±»åŠ è½½å™¨å¼•ç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®°å½•åŠ è½½è¯¥ç±»çš„ç±»åŠ è½½å™¨ï¼ˆå¦‚&lt;code&gt;ClassLoader&lt;/code&gt;å®ä¾‹åœ°å€ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;ç”¨äºåˆ¤æ–­ç±»æ˜¯å¦â€œæ´»è·ƒâ€ï¼ˆç±»å¸è½½éœ€æ»¡è¶³åŠ è½½å™¨ä¸å¯è¾¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;Classå¯¹è±¡æŒ‡é’ˆï¼š
&lt;ul&gt;
&lt;li&gt;æŒ‡å‘å †ä¸­çš„&lt;code&gt;Class&lt;/code&gt;å¯¹è±¡ï¼Œä½œä¸ºåå°„æ“ä½œçš„å…¥å£ï¼ˆå¦‚&lt;code&gt;getDeclaredFields()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="æ–¹æ³•è¡¨method-tables"&gt;&lt;strong&gt;æ–¹æ³•è¡¨ï¼ˆMethod Tablesï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è™šæ–¹æ³•è¡¨ï¼ˆvtableï¼‰&lt;/strong&gt; ä¸ &lt;strong&gt;æ¥å£æ–¹æ³•è¡¨ï¼ˆitableï¼‰&lt;/strong&gt; å­˜å‚¨äºæ–¹æ³•åŒºï¼Œæ”¯æ’‘å¤šæ€è°ƒç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;vtable&lt;/strong&gt;ï¼šç±»ç»§æ‰¿ä½“ç³»ä¸­çš„æ–¹æ³•æŒ‡é’ˆæ•°ç»„ï¼ŒæŒ‰å›ºå®šç´¢å¼•åŠ é€Ÿ&lt;code&gt;invokevirtual&lt;/code&gt;è°ƒç”¨ï¼ˆO(1)ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;itable&lt;/strong&gt;ï¼šåŒå±‚ç»“æ„ï¼ˆæ¥å£åç§»é‡+æ–¹æ³•ç´¢å¼•ï¼‰ï¼Œæ”¯æŒ&lt;code&gt;invokeinterface&lt;/code&gt;è°ƒç”¨ï¼ˆå¯ä¼˜åŒ–è‡³O(1)ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“æ–¹æ³•åŒºçš„æ ¸å¿ƒè§’è‰²ä¸æ¼”è¿›å¯¹æ¯”"&gt;âœ… &lt;strong&gt;æ€»ç»“ï¼šæ–¹æ³•åŒºçš„æ ¸å¿ƒè§’è‰²ä¸æ¼”è¿›å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»„ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;JDK7ï¼ˆæ°¸ä¹…ä»£ï¼‰&lt;/th&gt;
&lt;th&gt;JDK8+ï¼ˆå…ƒç©ºé—´ï¼‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»å‹/å­—æ®µ/æ–¹æ³•ä¿¡æ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ°¸ä¹…ä»£&lt;/td&gt;
&lt;td&gt;å…ƒç©ºé—´ï¼ˆæœ¬åœ°å†…å­˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿è¡Œæ—¶å¸¸é‡æ± &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ°¸ä¹…ä»£&lt;/td&gt;
&lt;td&gt;å…ƒç©ºé—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é™æ€å˜é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ°¸ä¹…ä»£&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å †å†…å­˜&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—ç¬¦ä¸²å¸¸é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ°¸ä¹…ä»£&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å †å†…å­˜&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JITä»£ç ç¼“å­˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç‹¬ç«‹ä»£ç ç¼“å­˜åŒº&lt;/td&gt;
&lt;td&gt;ç‹¬ç«‹ä»£ç ç¼“å­˜åŒº&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡å“²å­¦&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦å­˜å‚¨&lt;/strong&gt;ï¼šé™æ€å˜é‡ä¸å­—ç¬¦ä¸²å¸¸é‡ç§»è‡³å †ï¼Œé¿å…æ°¸ä¹…ä»£æº¢å‡ºï¼ˆå¦‚&lt;code&gt;OutOfMemoryError: PermGen&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ‰©å±•&lt;/strong&gt;ï¼šå…ƒç©ºé—´ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œé»˜è®¤æ— ä¸Šé™ï¼ˆéœ€ç›‘æ§&lt;code&gt;-XX:MaxMetaspaceSize&lt;/code&gt;é˜²æœ¬åœ°å†…å­˜è€—å°½ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;ï¼šæ–¹æ³•è¡¨ä¸JITç¼“å­˜é™ä½è°ƒç”¨å¼€é”€ï¼Œå¸¸é‡æ± ç´¢å¼•å¤ç”¨å‡å°‘å†…å­˜å ç”¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2 id="ç±»å…ƒæ•°æ®"&gt;ç±»å…ƒæ•°æ®
&lt;/h2&gt;&lt;p&gt;ç±»å…ƒæ•°æ®ï¼ˆClass Metadataï¼‰æ˜¯Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸­æè¿°ç±»ç»“æ„ä¿¡æ¯çš„å…³é”®æ•°æ®ï¼Œæ”¯æ’‘äº†Javaçš„åå°„ã€å¤šæ€ã€ç±»åŠ è½½ç­‰æ ¸å¿ƒæœºåˆ¶ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæ¦‚å¿µã€å­˜å‚¨æœºåˆ¶ã€å†…å®¹ç»„æˆã€åº”ç”¨åœºæ™¯å››ä¸ªç»´åº¦æ·±å…¥è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç±»å…ƒæ•°æ®çš„æœ¬è´¨ä¸ä½œç”¨"&gt;ğŸ§  &lt;strong&gt;ç±»å…ƒæ•°æ®çš„æœ¬è´¨ä¸ä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒå®šä¹‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç±»å…ƒæ•°æ®&lt;/strong&gt;ï¼šæè¿°ç±»ç»“æ„ä¿¡æ¯çš„äºŒè¿›åˆ¶æ•°æ®ï¼ŒåŒ…æ‹¬ç±»åã€ç»§æ‰¿å…³ç³»ã€æ–¹æ³•å­—èŠ‚ç ã€å­—æ®µç±»å‹ã€æ³¨è§£ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Classå¯¹è±¡&lt;/strong&gt;ï¼šä½äºJavaå †ä¸­çš„å¯¹è±¡ï¼Œæ˜¯ç¨‹åºè®¿é—®ç±»å…ƒæ•°æ®çš„&lt;strong&gt;å…¥å£ä»£ç†&lt;/strong&gt;ï¼ˆéå…ƒæ•°æ®æœ¬èº«ï¼‰ï¼Œé€šè¿‡åå°„APIï¼ˆå¦‚&lt;code&gt;getMethod()&lt;/code&gt;ï¼‰æä¾›æ“ä½œæ¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼ˆRTTIï¼‰&lt;/strong&gt;ï¼šæ”¯æŒ&lt;code&gt;instanceof&lt;/code&gt;ã€ç±»å‹è½¬æ¢ç­‰æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ–¹æ³•ç»‘å®š&lt;/strong&gt;ï¼šé€šè¿‡æ–¹æ³•è¡¨ï¼ˆvtable/itableï¼‰å®ç°å¤šæ€è°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»åŠ è½½ä¸é“¾æ¥&lt;/strong&gt;ï¼šJVMåŸºäºå…ƒæ•°æ®è§£æç±»ä¾èµ–ã€éªŒè¯å­—èŠ‚ç ã€åˆ†é…å†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å­˜å‚¨æœºåˆ¶ä¸ç‰©ç†å¸ƒå±€"&gt;ğŸ’¾ &lt;strong&gt;å­˜å‚¨æœºåˆ¶ä¸ç‰©ç†å¸ƒå±€&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å­˜å‚¨ä½ç½®æ¼”è¿›"&gt;&lt;strong&gt;å­˜å‚¨ä½ç½®æ¼”è¿›&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;JDKç‰ˆæœ¬&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å­˜å‚¨åŒºåŸŸ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;JDK 1.7åŠä¹‹å‰&lt;/td&gt;
&lt;td&gt;æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰&lt;/td&gt;
&lt;td&gt;å›ºå®šå¤§å°ï¼Œæ˜“å¼•å‘&lt;code&gt;OutOfMemoryError: PermGen&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;JDK 1.8+&lt;/td&gt;
&lt;td&gt;å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼ŒåŠ¨æ€æ‰©å±•ï¼Œä¸Šé™ç”±&lt;code&gt;-XX:MaxMetaspaceSize&lt;/code&gt;æ§åˆ¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ç”Ÿæˆä¸åŠ è½½è¿‡ç¨‹"&gt;&lt;strong&gt;ç”Ÿæˆä¸åŠ è½½è¿‡ç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘é˜¶æ®µ&lt;/strong&gt;ï¼šç¼–è¯‘å™¨å°†æºç è½¬æ¢ä¸º&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ï¼Œå…ƒæ•°æ®ä»¥ç»“æ„åŒ–æ ¼å¼å­˜å‚¨ï¼ˆå¦‚å¸¸é‡æ± ã€å­—æ®µè¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç±»åŠ è½½é˜¶æ®µï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ è½½&lt;/strong&gt;ï¼šç±»åŠ è½½å™¨è¯»å–&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ï¼Œè§£æäºŒè¿›åˆ¶æµç”Ÿæˆå…ƒæ•°æ®å¹¶å­˜å…¥å…ƒç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é“¾æ¥&lt;/strong&gt;ï¼šJVMåŸºäºå…ƒæ•°æ®éªŒè¯å­—èŠ‚ç ã€å‡†å¤‡å†…å­˜ï¼ˆå¦‚é™æ€å˜é‡é»˜è®¤å€¼ï¼‰ã€è§£æç¬¦å·å¼•ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å®¹ç»„æˆè¯¦è§£"&gt;ğŸ“¦ &lt;strong&gt;å†…å®¹ç»„æˆè¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç±»å…ƒæ•°æ®åŒ…å«ä»¥ä¸‹æ ¸å¿ƒä¿¡æ¯ï¼ˆå­˜å‚¨åœ¨&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ç»“æ„ä¸­ï¼‰ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…·ä½“å†…å®¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸºç¡€ä¿¡æ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»å…¨é™å®šåã€åŒ…è·¯å¾„ã€ä¿®é¥°ç¬¦ï¼ˆ&lt;code&gt;public&lt;/code&gt;/&lt;code&gt;final&lt;/code&gt;ç­‰ï¼‰ã€çˆ¶ç±»ã€æ¥å£åˆ—è¡¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­—æ®µä¿¡æ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­—æ®µåç§°ã€ç±»å‹ã€ä¿®é¥°ç¬¦ã€å¸¸é‡å€¼ï¼ˆå¦‚&lt;code&gt;final&lt;/code&gt;å­—æ®µï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–¹æ³•ä¿¡æ¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ–¹æ³•åã€å‚æ•°ç±»å‹ã€è¿”å›ç±»å‹ã€å¼‚å¸¸è¡¨ã€å­—èŠ‚ç æŒ‡ä»¤ï¼ˆ&lt;code&gt;Code&lt;/code&gt;å±æ€§ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ³¨è§£ä¸æ³›å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»/æ–¹æ³•/å­—æ®µä¸Šçš„æ³¨è§£ã€æ³›å‹ç­¾åï¼ˆ&lt;code&gt;Signature&lt;/code&gt;å±æ€§ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¸¸é‡æ± &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­—é¢é‡ï¼ˆå­—ç¬¦ä¸²ã€æ•°å€¼ï¼‰å’Œç¬¦å·å¼•ç”¨ï¼ˆç±»/æ–¹æ³•/å­—æ®µçš„å…¨é™å®šåï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¤ºä¾‹ï¼š&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶é€šè¿‡&lt;strong&gt;å±æ€§è¡¨é›†åˆ&lt;/strong&gt;å­˜å‚¨æ–¹æ³•å­—èŠ‚ç ï¼ˆ&lt;code&gt;Code&lt;/code&gt;å±æ€§ï¼‰å’Œæ³›å‹ç­¾åï¼ˆ&lt;code&gt;Signature&lt;/code&gt;å±æ€§ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-classå¯¹è±¡ä¸ç±»å…ƒæ•°æ®çš„å…³ç³»"&gt;ğŸ”— &lt;strong&gt;Classå¯¹è±¡ä¸ç±»å…ƒæ•°æ®çš„å…³ç³»&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="è®¿é—®è·¯å¾„"&gt;&lt;strong&gt;è®¿é—®è·¯å¾„&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[ç±»å®ä¾‹] --&amp;gt; B[å¯¹è±¡å¤´]
B --&amp;gt; C[Klass Pointer]
C --&amp;gt; D[å…ƒç©ºé—´ç±»å…ƒæ•°æ®]
D --&amp;gt; E[æŒ‡å‘Classå¯¹è±¡]
E --&amp;gt; F[åå°„APIæ“ä½œ]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å®ä¾‹&lt;/strong&gt;ï¼šé€šè¿‡å¯¹è±¡å¤´ä¸­çš„&lt;code&gt;Klass Pointer&lt;/code&gt;å…³è”å…ƒç©ºé—´ä¸­çš„ç±»å…ƒæ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Classå¯¹è±¡&lt;/strong&gt;ï¼šå…ƒæ•°æ®å†…éƒ¨æŒæœ‰æŒ‡å‘å †ä¸­Classå¯¹è±¡çš„å¼•ç”¨ï¼Œå½¢æˆåŒå‘ç»‘å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ ¸å¿ƒåŒºåˆ«"&gt;&lt;strong&gt;æ ¸å¿ƒåŒºåˆ«&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Classå¯¹è±¡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç±»å…ƒæ•°æ®&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‰©ç†ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Javaå †&lt;/td&gt;
&lt;td&gt;å…ƒç©ºé—´ï¼ˆæœ¬åœ°å†…å­˜ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…ƒæ•°æ®è®¿é—®å…¥å£ã€åå°„API&lt;/td&gt;
&lt;td&gt;ç±»ç»“æ„åŸå§‹ä¿¡æ¯ï¼ˆå­—èŠ‚ç ã€æ–¹æ³•è¡¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿæˆæ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»åŠ è½½æ—¶ç”±JVMåœ¨å †ä¸­åˆ›å»º&lt;/td&gt;
&lt;td&gt;ç±»åŠ è½½æ—¶ä»&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶è§£æå­˜å…¥å…ƒç©ºé—´&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¤ºä¾‹ï¼š&lt;code&gt;MyClass.class.getName()&lt;/code&gt;é€šè¿‡Classå¯¹è±¡è®¿é—®å…ƒç©ºé—´ä¸­çš„ç±»åä¿¡æ¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸æŠ€æœ¯å®è·µ"&gt;âš™ï¸ &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸æŠ€æœ¯å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åå°„æœºåˆ¶"&gt;&lt;strong&gt;åå°„æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŠ¨æ€æ“ä½œç±»ï¼šé€šè¿‡Classå¯¹è±¡è·å–æ–¹æ³•/å­—æ®µå¹¶è°ƒç”¨ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Class&amp;lt;?&amp;gt; clazz = Class.forName(&amp;#34;com.example.MyClass&amp;#34;);
Method method = clazz.getMethod(&amp;#34;myMethod&amp;#34;);
method.invoke(clazz.newInstance()); // åŠ¨æ€è°ƒç”¨æ–¹æ³•
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ³¨è§£å¤„ç†"&gt;&lt;strong&gt;æ³¨è§£å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶æ³¨è§£&lt;/strong&gt;ï¼šå¦‚Springçš„&lt;code&gt;@Autowired&lt;/code&gt;ï¼ŒJVMé€šè¿‡å…ƒæ•°æ®è§£æä¾èµ–å…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æ—¶æ³¨è§£&lt;/strong&gt;ï¼šAPTï¼ˆAnnotation Processing Toolï¼‰è¯»å–å…ƒæ•°æ®ç”Ÿæˆä»£ç ï¼ˆå¦‚Lombokï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="jvmæ€§èƒ½ä¼˜åŒ–"&gt;&lt;strong&gt;JVMæ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•å†…è”&lt;/strong&gt;ï¼šJITç¼–è¯‘å™¨åŸºäºæ–¹æ³•è¡¨åˆ†æè°ƒç”¨å…³ç³»ï¼Œå†…è”å•æ€æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»è™šæ‹ŸåŒ–&lt;/strong&gt;ï¼šè‹¥ç±»å±‚æ¬¡åˆ†æï¼ˆCHAï¼‰ç¡®è®¤å”¯ä¸€å®ç°ï¼Œå°†è™šè°ƒç”¨è½¬ä¸ºé™æ€ç»‘å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¡†æ¶è®¾è®¡"&gt;&lt;strong&gt;æ¡†æ¶è®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Springå®¹å™¨ï¼šé€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;ClassMetadata
&lt;/code&gt;&lt;/pre&gt;æ¥å£è§£æç±»ä¿¡æ¯ï¼Œæ”¯æŒä¾èµ–æ³¨å…¥ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;ClassMetadata metadata = new StandardClassMetadata(MyClass.class);
String[] interfaces = metadata.getInterfaceNames(); // è·å–æ¥å£åˆ—è¡¨
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ç±»å…ƒæ•°æ®çš„æ ¸å¿ƒä»·å€¼"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šç±»å…ƒæ•°æ®çš„æ ¸å¿ƒä»·å€¼&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;JavaåŠ¨æ€æ€§çš„åŸºçŸ³&lt;/strong&gt;ï¼šæ”¯æ’‘åå°„ã€åŠ¨æ€ä»£ç†ã€æ³¨è§£ç­‰é«˜çº§ç‰¹æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;JVMæ‰§è¡Œå¼•æ“çš„è“å›¾&lt;/strong&gt;ï¼šæä¾›ç±»ç»“æ„ä¿¡æ¯ï¼ŒæŒ‡å¯¼å­—èŠ‚ç è§£é‡Šä¸ç¼–è¯‘ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡†æ¶è®¾è®¡çš„æ ¸å¿ƒä¾èµ–&lt;/strong&gt;ï¼šSpringã€Hibernateç­‰é€šè¿‡å…ƒæ•°æ®å®ç°è‡ªåŠ¨åŒ–é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¸å®‰å…¨çš„å¹³è¡¡&lt;/strong&gt;ï¼šå…ƒç©ºé—´è®¾è®¡é¿å…æ°¸ä¹…ä»£æº¢å‡ºï¼Œæœ¬åœ°å†…å­˜ç®¡ç†æå‡ç¨³å®šæ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;ï¼šé¢‘ç¹åå°„æ“ä½œå¯èƒ½å› å…ƒæ•°æ®è®¿é—®å¼•å‘æ€§èƒ½ç“¶é¢ˆï¼Œå»ºè®®ç»“åˆç¼“å­˜ï¼ˆå¦‚&lt;code&gt;ReflectionFactory&lt;/code&gt;ï¼‰æˆ–å­—èŠ‚ç å¢å¼ºæŠ€æœ¯ï¼ˆå¦‚ASMï¼‰ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ–¹æ³•è¡¨ç±»å‹"&gt;æ–¹æ³•è¡¨ç±»å‹
&lt;/h2&gt;&lt;p&gt;JVM ä¸­çš„æ–¹æ³•è¡¨æ˜¯å®ç°å¤šæ€å’ŒåŠ¨æ€æ–¹æ³•è°ƒç”¨çš„æ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š&lt;strong&gt;è™šæ–¹æ³•è¡¨ï¼ˆvtableï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;æ¥å£æ–¹æ³•è¡¨ï¼ˆitableï¼‰&lt;/strong&gt;ã€‚å®ƒä»¬åœ¨ç»“æ„ã€ä½œç”¨å’Œè°ƒç”¨é€»è¾‘ä¸Šå­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼Œä»¥ä¸‹ä»è®¾è®¡åŸç†åˆ°å®ç°ç»†èŠ‚å±•å¼€åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è™šæ–¹æ³•è¡¨vtable"&gt;ğŸ” &lt;strong&gt;è™šæ–¹æ³•è¡¨ï¼ˆvtableï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ™®é€šç±»çš„ç»§æ‰¿ä½“ç³»ä¸­çš„æ–¹æ³•è°ƒç”¨ï¼ˆé€šè¿‡ &lt;code&gt;invokevirtual&lt;/code&gt; æŒ‡ä»¤ï¼‰ã€‚
â€‹&lt;strong&gt;æ ¸å¿ƒè®¾è®¡&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç»§æ‰¿é“¾æ–¹æ³•èšåˆ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å­ç±»æ–¹æ³•è¡¨åŸºäºçˆ¶ç±»æ–¹æ³•è¡¨æ„å»ºï¼š
&lt;ul&gt;
&lt;li&gt;ä¿ç•™çˆ¶ç±»æ–¹æ³•çš„æŒ‡é’ˆï¼ˆæœªè¢«é‡å†™æ—¶ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ·»åŠ å­ç±»æ–°å¢æ–¹æ³•ï¼›&lt;/li&gt;
&lt;li&gt;ç”¨å­ç±»å®ç°è¦†ç›–é‡å†™çš„æ–¹æ³•æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;class Person { void speak() {} }
class Boy extends Person {
@Override void speak() {} // è¦†ç›–çˆ¶ç±»æ–¹æ³•
void fight() {} // æ–°å¢æ–¹æ³•
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Boy&lt;/code&gt; çš„æ–¹æ³•è¡¨ï¼š
&lt;code&gt;[Object.toString, Object.hashCode, Person.speak â†’ Boy.speak, Boy.fight]&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å›ºå®šç´¢å¼•åŠ é€Ÿè°ƒç”¨&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªæ–¹æ³•åœ¨ç»§æ‰¿é“¾ä¸­ä½ç½®å›ºå®šï¼ˆå¦‚ &lt;code&gt;speak()&lt;/code&gt; å§‹ç»ˆåœ¨ç´¢å¼• 2ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;JVM æ‰§è¡Œ &lt;code&gt;invokevirtual&lt;/code&gt; æ—¶ï¼Œç›´æ¥é€šè¿‡ç´¢å¼•è·³è½¬ï¼ˆå¦‚ &lt;code&gt;#2&lt;/code&gt; æŒ‡å‘ &lt;code&gt;Boy.speak&lt;/code&gt;ï¼‰ï¼Œ&lt;strong&gt;æ— éœ€éå†æ–¹æ³•å&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ—¶é—´å¤æ‚åº¦ &lt;strong&gt;O(1)&lt;/strong&gt;ï¼Œç©ºé—´å ç”¨å°ï¼ˆä»…éœ€ç»´æŠ¤æŒ‡é’ˆæ•°ç»„ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å¤©ç„¶æ”¯æŒå¤šæ€ï¼šçˆ¶ç±»å¼•ç”¨è°ƒç”¨å­ç±»é‡å†™æ–¹æ³•æ—¶ï¼Œé€šè¿‡å¯¹è±¡å®é™…ç±»å‹çš„æ–¹æ³•è¡¨ç´¢å¼•å®šä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¥å£æ–¹æ³•è¡¨itable"&gt;ğŸ§© &lt;strong&gt;æ¥å£æ–¹æ³•è¡¨ï¼ˆitableï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ¥å£æ–¹æ³•è°ƒç”¨ï¼ˆé€šè¿‡ &lt;code&gt;invokeinterface&lt;/code&gt; æŒ‡ä»¤ï¼‰ã€‚
â€‹&lt;strong&gt;æ ¸å¿ƒè®¾è®¡&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŒå±‚ç»“æ„è§£å†³å¤šç»§æ‰¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»è¡¨ï¼ˆitableï¼‰&lt;/strong&gt;ï¼šå­˜å‚¨è¯¥ç±»å®ç°çš„æ‰€æœ‰æ¥å£çš„æ–¹æ³•æŒ‡é’ˆï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£å­è¡¨&lt;/strong&gt;ï¼šæ¯ä¸ªæ¥å£ç‹¬ç«‹çš„æ–¹æ³•è¡¨ï¼ŒæŒ‰æ¥å£å£°æ˜çš„æ–¹æ³•é¡ºåºæ’åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;interface IDance { void dance(); }
class Dancer extends Person implements IDance {
void dance() {} // å®ç°æ¥å£æ–¹æ³•
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Dancer&lt;/code&gt; çš„ itable ç»“æ„ï¼š
&lt;code&gt;[IDance_itable â†’ [IDance.dance â†’ Dancer.dance]]&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æœç´¢è¿‡ç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; dancer.dance()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ—¶ï¼š
1. å®šä½å¯¹è±¡å®é™…ç±»ï¼ˆ&lt;code&gt;Dancer&lt;/code&gt;ï¼‰ï¼›
2. åœ¨ itable ä¸­æœç´¢ &lt;code&gt;IDance&lt;/code&gt; æ¥å£çš„åç§»é‡ï¼›
3. åœ¨æ¥å£å­è¡¨ä¸­æŒ‰æ–¹æ³•ç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;dance()&lt;/code&gt; æ˜¯æ¥å£çš„ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼‰æ‰¾åˆ°ç›®æ ‡æ–¹æ³•ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼€é”€&lt;/strong&gt;ï¼šéœ€ä¸¤æ¬¡æŸ¥æ‰¾ï¼ˆæ¥å£åç§» + æ–¹æ³•ç´¢å¼•ï¼‰ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦ &lt;strong&gt;O(n)&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ‰‹æ®µ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œç¼“å­˜&lt;/strong&gt;ï¼šå¯¹é«˜é¢‘æ¥å£ç¼“å­˜åç§»é‡ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…è”ç¼“å­˜ï¼ˆInline Cacheï¼‰&lt;/strong&gt;ï¼šåœ¨è°ƒç”¨ç‚¹ç¼“å­˜æœ€è¿‘ä½¿ç”¨çš„å®ç°ç±»æ–¹æ³•åœ°å€ï¼Œé€šè¿‡æ¡ä»¶åˆ†æ”¯ç›´æ¥è·³è½¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ–¹æ³•è¡¨åœ¨-class-æ–‡ä»¶ä¸­çš„è¡¨ç¤º"&gt;âš™ï¸ &lt;strong&gt;æ–¹æ³•è¡¨åœ¨ Class æ–‡ä»¶ä¸­çš„è¡¨ç¤º&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ–¹æ³•è¡¨çš„å…ƒæ•°æ®åœ¨ Class æ–‡ä»¶çš„æ–¹æ³•è¡¨é›†åˆï¼ˆ&lt;code&gt;method_info&lt;/code&gt;ï¼‰ä¸­å®šä¹‰ï¼Œç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;method_info {
u2 access_flags; // è®¿é—®æ ‡å¿—ï¼ˆpublic/staticç­‰ï¼‰
u2 name_index; // æ–¹æ³•åç´¢å¼•ï¼ˆæŒ‡å‘å¸¸é‡æ± ï¼‰
u2 descriptor_index; // æ–¹æ³•æè¿°ç¬¦ï¼ˆå¦‚ &amp;#34;(II)V&amp;#34;ï¼‰
u2 attributes_count;
attribute_info attributes[attributes_count]; // å±æ€§è¡¨
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å…³é”®å±æ€§&lt;/strong&gt;ï¼š
1.
Code å±æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨å­—èŠ‚ç æŒ‡ä»¤ã€æ“ä½œæ•°æ ˆæ·±åº¦ï¼ˆ&lt;code&gt;max_stack&lt;/code&gt;ï¼‰ã€å±€éƒ¨å˜é‡è¡¨å¤§å°ï¼ˆ&lt;code&gt;max_locals&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éæŠ½è±¡æ–¹æ³•å¿…é¡»åŒ…å«&lt;/strong&gt;ï¼ŒæŠ½è±¡æ–¹æ³•å’Œæ¥å£æ–¹æ³•æ— æ­¤å±æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;Exceptions å±æ€§&lt;/strong&gt;ï¼šå£°æ˜æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Signature å±æ€§&lt;/strong&gt;ï¼ˆæ³›å‹æ–¹æ³•ï¼‰ï¼šå­˜å‚¨æ³›å‹ç­¾åã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è¿è¡Œæ—¶ä¼˜åŒ–ä¸æ€§èƒ½å½±å“"&gt;âš¡ &lt;strong&gt;è¿è¡Œæ—¶ä¼˜åŒ–ä¸æ€§èƒ½å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;JVM é€šè¿‡åˆ†å±‚ç­–ç•¥æå‡æ–¹æ³•è°ƒç”¨æ•ˆç‡ï¼š
1.
è§£é‡Šæ‰§è¡Œé˜¶æ®µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è™šæ–¹æ³•ï¼šç›´æ¥ç´¢å¼•è·³è½¬ï¼ˆvtableï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ¥å£æ–¹æ³•ï¼šå†…è”ç¼“å­˜ + itable äºŒåˆ†æŸ¥æ‰¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;JIT ç¼–è¯‘é˜¶æ®µï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å»è™šæ‹ŸåŒ–ï¼ˆDevirtualizationï¼‰&lt;/strong&gt;ï¼šè‹¥ CHAï¼ˆç±»å±‚æ¬¡åˆ†æï¼‰ç¡®è®¤æŸæ–¹æ³•ä»…æœ‰ä¸€ä¸ªå®ç°ï¼Œå°†è™šè°ƒç”¨è½¬ä¸ºé™æ€ç»‘å®šï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•å†…è”&lt;/strong&gt;ï¼šå¯¹å•æ€è°ƒç”¨ç¼“å­˜çš„æ–¹æ³•ï¼Œç›´æ¥å†…è”ç›®æ ‡æ–¹æ³•ä½“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æç«¯åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¶…å¤šæ€æ¥å£è°ƒç”¨&lt;/strong&gt;ï¼ˆ&amp;gt;8 ç§å®ç°ï¼‰ï¼šé€€åŒ–åˆ°å®Œæ•´ itable æœç´¢ï¼Œé€šè¿‡å‡å°‘å†…è”åˆ†æ”¯é¿å…ä»£ç è†¨èƒ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“æ–¹æ³•è¡¨çš„æ ¸å¿ƒå·®å¼‚ä¸è®¾è®¡å“²å­¦"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šæ–¹æ³•è¡¨çš„æ ¸å¿ƒå·®å¼‚ä¸è®¾è®¡å“²å­¦&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è™šæ–¹æ³•è¡¨ï¼ˆvtableï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¥å£æ–¹æ³•è¡¨ï¼ˆitableï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•å±‚è¿ç»­æ•°ç»„&lt;/td&gt;
&lt;td&gt;åŒå±‚ç»“æ„ï¼ˆä¸»è¡¨ + æ¥å£å­è¡¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒç”¨å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;O(1) ç›´æ¥ç´¢å¼•&lt;/td&gt;
&lt;td&gt;O(n) åŠ¨æ€æœç´¢ï¼ˆå¯ä¼˜åŒ–è‡³ O(1)ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šæ€æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»§æ‰¿é“¾æ–¹æ³•è¦†ç›–&lt;/td&gt;
&lt;td&gt;å¤šæ¥å£å®ç°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æå°ï¼ˆå›ºå®šè·³è½¬ï¼‰&lt;/td&gt;
&lt;td&gt;æ¥å£åç§»å®šä½ + æ–¹æ³•ç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼˜åŒ–æ‰‹æ®µ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å»è™šæ‹ŸåŒ–ã€å†…è”&lt;/td&gt;
&lt;td&gt;å†…è”ç¼“å­˜ã€æ¥å£åç§»ç¼“å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ”§ &lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é«˜é¢‘è°ƒç”¨æ–¹æ³•å°½é‡ä½¿ç”¨ç±»ç»§æ‰¿è€Œéæ¥å£ï¼ˆå‡å°‘ itable å¼€é”€ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;é¿å…è¶…å¤šæ€æ¥å£ï¼ˆå¦‚é€šç”¨å·¥å…·ç±»ï¼‰ï¼Œæˆ–é€šè¿‡é€‚é…å™¨æ¨¡å¼æ”¶æ•›å®ç°ï¼›&lt;/li&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;-XX:+PrintInlining&lt;/code&gt; ç›‘æ§ JIT å¯¹æ–¹æ³•è°ƒç”¨çš„ä¼˜åŒ–æ•ˆæœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ–¹æ³•è¡¨ä½ç½®"&gt;æ–¹æ³•è¡¨ä½ç½®
&lt;/h2&gt;&lt;p&gt;åœ¨ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸­ï¼Œæ–¹æ³•è¡¨ï¼ˆMethod Tableï¼‰çš„è®¾è®¡ä¸ä½ç½®ç›´æ¥å…³ç³»åˆ°æ–¹æ³•è°ƒç”¨çš„æ•ˆç‡å’Œå†…å­˜ç®¡ç†çš„åˆç†æ€§ã€‚ä»¥ä¸‹æ˜¯é’ˆå¯¹ä¸¤ä¸ªé—®é¢˜çš„é€å±‚è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ºä»€ä¹ˆæ–¹æ³•è¡¨ä¸å­˜åœ¨å †ä¸Š"&gt;ğŸ” &lt;strong&gt;ä¸ºä»€ä¹ˆæ–¹æ³•è¡¨ä¸å­˜åœ¨å †ä¸Šï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ–¹æ³•è¡¨å­˜å‚¨åœ¨ &lt;strong&gt;æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰&lt;/strong&gt; è€Œéå †ï¼ˆHeapï¼‰ä¸­ï¼ŒåŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸä¸ç¨³å®šæ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å †&lt;/strong&gt;ï¼šå­˜å‚¨å¯¹è±¡å®ä¾‹ï¼Œç”Ÿå‘½å‘¨æœŸçŸ­ä¸”é¢‘ç¹å˜åŠ¨ï¼ˆé¢‘ç¹ GC å›æ”¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•åŒº&lt;/strong&gt;ï¼šå­˜å‚¨ç±»å…ƒæ•°æ®ï¼ˆå¦‚å­—èŠ‚ç ã€æ–¹æ³•è¡¨ï¼‰ï¼Œç”Ÿå‘½å‘¨æœŸä¸ç±»åŠ è½½å™¨ä¸€è‡´ï¼Œ&lt;strong&gt;å‡ ä¹ä¸å˜&lt;/strong&gt;ï¼ˆç±»å¸è½½æ—¶æ‰é‡Šæ”¾ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šæ–¹æ³•è¡¨æ˜¯ç±»å…ƒæ•°æ®çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œéœ€é•¿æœŸç¨³å®šå­˜åœ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç®¡ç†éš”ç¦»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å †ç”± GC ç®¡ç†ï¼ˆYoung/Old GCï¼‰ï¼Œè€Œæ–¹æ³•åŒºåœ¨ JDK 8+ ç”±å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰ç®¡ç†ï¼Œä½¿ç”¨æœ¬åœ°å†…å­˜ç‹¬ç«‹å›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æ–¹æ³•è¡¨åœ¨å †ä¸­ï¼ŒGC æ—¶éœ€é¢å¤–æ‰«æè¿™äº›å‡ ä¹ä¸å˜çš„æ•°æ®ï¼Œé™ä½æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¿é—®æ•ˆç‡ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•è¡¨éœ€è¢«&lt;strong&gt;æ‰€æœ‰çº¿ç¨‹å…±äº«&lt;/strong&gt;ï¼Œä¸”é¢‘ç¹ç”¨äºæ–¹æ³•è°ƒç”¨ã€‚æ–¹æ³•åŒºä¸å †ç‰©ç†éš”ç¦»ï¼ˆJDK 8+ å…ƒç©ºé—´åœ¨æœ¬åœ°å†…å­˜ï¼‰ï¼Œå‡å°‘å † GC å¯¹æ–¹æ³•è°ƒç”¨çš„å¹²æ‰°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°ä¸€è‡´æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•è¡¨æ˜¯ç±»ç»“æ„çš„ä¸€éƒ¨åˆ†ï¼Œä¸å­—èŠ‚ç ã€å¸¸é‡æ± ç­‰å…±åŒå­˜å‚¨åœ¨æ–¹æ³•åŒºï¼Œä¿æŒç±»å…ƒæ•°æ®çš„å®Œæ•´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ç»“è®º&lt;/strong&gt;ï¼šæ–¹æ³•è¡¨éœ€ç¨³å®šã€é«˜é¢‘è®¿é—®ä¸”ä¸ç±»ç”Ÿå‘½å‘¨æœŸç»‘å®šï¼Œå †çš„åŠ¨æ€æ€§å’Œ GC æœºåˆ¶ä¸æ»¡è¶³è¿™äº›éœ€æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-è°ƒç”¨æ–¹æ³•æ˜¯å¦éœ€è¦éå†æ–¹æ³•è¡¨å¯¹æ¯”åç§°"&gt;âš™ï¸ &lt;strong&gt;è°ƒç”¨æ–¹æ³•æ˜¯å¦éœ€è¦éå†æ–¹æ³•è¡¨å¯¹æ¯”åç§°ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ä¸éœ€è¦éå†å¯¹æ¯”åç§°&lt;/strong&gt;ã€‚JVM é€šè¿‡ &lt;strong&gt;å›ºå®šåç§»é‡ï¼ˆIndexï¼‰&lt;/strong&gt; ç›´æ¥å®šä½æ–¹æ³•ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•è¡¨çš„é™æ€ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªç±»çš„æ–¹æ³•è¡¨æŒ‰å›ºå®šé¡ºåºæ’åˆ—ï¼š
&lt;ul&gt;
&lt;li&gt;çˆ¶ç±»æ–¹æ³•ï¼ˆç»§æ‰¿é¡ºåºï¼‰â†’ å­ç±»æ–°å¢æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;é‡å†™æ–¹æ³•è¦†ç›–çˆ¶ç±»åŒä½ç½®æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç¤ºä¾‹ï¼šAnimal ç±»æ–¹æ³•è¡¨
[*sound()] -&amp;gt; Animal.sound()
// Dog ç±»æ–¹æ³•è¡¨ï¼ˆç»§æ‰¿ Animalï¼‰
[*sound()] -&amp;gt; Dog.sound() // è¦†ç›–çˆ¶ç±»æ–¹æ³•
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•è°ƒç”¨çš„é«˜æ•ˆå®šä½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘é˜¶æ®µ&lt;/strong&gt;ï¼šæ¯ä¸ªæ–¹æ³•åœ¨æ–¹æ³•è¡¨ä¸­åˆ†é…&lt;strong&gt;å›ºå®šç´¢å¼•&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;sound()&lt;/code&gt; ä½äºç´¢å¼• 2ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è¿è¡Œæ—¶ï¼šè°ƒç”¨æŒ‡ä»¤ï¼ˆå¦‚ invokevirtualï¼‰ç›´æ¥æºå¸¦ç´¢å¼•å€¼ï¼Œæ— éœ€æŸ¥æ‰¾æ–¹æ³•åã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// å­—èŠ‚ç ç¤ºä¾‹ï¼šinvokevirtual #2 -&amp;gt; ç›´æ¥è°ƒç”¨æ–¹æ³•è¡¨ç¬¬ 2 é¡¹
&lt;/code&gt;&lt;/pre&gt;&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ€çš„å®ç°æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; Animal dog = new Dog()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è°ƒç”¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; dog.sound()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ—¶ï¼š
1. æ ¹æ®å¯¹è±¡å®é™…ç±»å‹ï¼ˆ&lt;code&gt;Dog&lt;/code&gt;ï¼‰æ‰¾åˆ°å…¶æ–¹æ³•è¡¨ã€‚
2. é€šè¿‡å›ºå®šç´¢å¼•ï¼ˆä¸ &lt;code&gt;Animal.sound()&lt;/code&gt; ç´¢å¼•ç›¸åŒï¼‰å®šä½åˆ° &lt;code&gt;Dog.sound()&lt;/code&gt;ã€‚
4. &lt;strong&gt;æ¥å£æ–¹æ³•çš„ç‰¹æ®Šå¤„ç†&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¥å£æ–¹æ³•ï¼ˆ&lt;code&gt;invokeinterface&lt;/code&gt;ï¼‰å› å¤šç»§æ‰¿éœ€&lt;strong&gt;æœç´¢æ–¹æ³•è¡¨&lt;/strong&gt;ï¼Œæ•ˆç‡ä½äºç±»æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;JVM ä½¿ç”¨ &lt;strong&gt;å†…è”ç¼“å­˜ï¼ˆInline Cacheï¼‰&lt;/strong&gt; ä¼˜åŒ–é«˜é¢‘è°ƒç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ç»“è®º&lt;/strong&gt;ï¼šæ™®é€šç±»æ–¹æ³•è°ƒç”¨é€šè¿‡ç´¢å¼•ç›´æ¥è·³è½¬ï¼Œ&lt;strong&gt;æ— éœ€éå†å¯¹æ¯”åç§°&lt;/strong&gt;ï¼›ä»…æ¥å£æ–¹æ³•éœ€æœç´¢ï¼Œä½†å·²ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“æ–¹æ³•è¡¨çš„è®¾è®¡å“²å­¦"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šæ–¹æ³•è¡¨çš„è®¾è®¡å“²å­¦&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å †ï¼ˆHeapï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•åŒºï¼ˆå«æ–¹æ³•è¡¨ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å‚¨å†…å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹è±¡å®ä¾‹ï¼ˆåŠ¨æ€åˆ›å»ºï¼‰&lt;/td&gt;
&lt;td&gt;ç±»å…ƒæ•°æ®ï¼ˆç¨³å®šç»“æ„ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çŸ­ï¼ˆä¾èµ– GCï¼‰&lt;/td&gt;
&lt;td&gt;é•¿ï¼ˆç±»å¸è½½æ‰é‡Šæ”¾ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¿é—®æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯¹è±¡å¼•ç”¨&lt;/td&gt;
&lt;td&gt;å›ºå®šç´¢å¼•ç›´æ¥è·³è½¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;GC é¢‘ç¹ï¼Œç¢ç‰‡åŒ–é£é™©&lt;/td&gt;
&lt;td&gt;æ—  GC å¹²æ‰°ï¼Œè®¿é—®é«˜æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•è¡¨å­˜äºæ–¹æ³•åŒº&lt;/strong&gt;ï¼šä¿éšœç¨³å®šæ€§ã€é¿å… GC å¹²æ‰°ã€æå‡è®¿é—®æ•ˆç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•è°ƒç”¨æœºåˆ¶&lt;/strong&gt;ï¼šé€šè¿‡ç´¢å¼•ç›´æ¥å®šä½ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;strong&gt;O(1)&lt;/strong&gt;ï¼Œä¸éå†æ— å…³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ‰©å±•å»ºè®®&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;javap -c&lt;/code&gt; æŸ¥çœ‹å­—èŠ‚ç ä¸­çš„æ–¹æ³•è°ƒç”¨ç´¢å¼•ï¼Œæˆ–ä½¿ç”¨ &lt;code&gt;JOL&lt;/code&gt; å·¥å…·åˆ†æç±»å†…å­˜å¸ƒå±€ï¼Œå¯æ·±å…¥éªŒè¯ä¸Šè¿°æœºåˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="itable-åŠ¨æ€ç´¢å¼•"&gt;itable åŠ¨æ€ç´¢å¼•
&lt;/h2&gt;&lt;p&gt;åœ¨Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸­ï¼Œ&lt;strong&gt;itableï¼ˆæ¥å£æ–¹æ³•è¡¨ï¼‰éœ€è¦åœ¨è¿è¡Œæ—¶åŠ¨æ€ç¡®å®šç´¢å¼•çš„æ ¹æœ¬åŸå› ï¼Œå¹¶éå› ä¸ºç±»å®ç°çš„æ¥å£åœ¨ç¼–è¯‘æ—¶æ— æ³•ç¡®å®šï¼ˆæ¥å£åˆ—è¡¨ç¡®å®åœ¨ç¼–è¯‘æ—¶å·²çŸ¥ï¼‰ï¼Œè€Œæ˜¯ç”±äºæ¥å£æ–¹æ³•çš„â€œå¤šå®ç°åŠ¨æ€ç»„åˆæ€§â€å¯¼è‡´å…¶åœ¨å…·ä½“ç±»ä¸­çš„ç‰©ç†ä½ç½®æ— æ³•é™æ€å›ºå®š&lt;/strong&gt;ã€‚ä»¥ä¸‹ä»å®ç°æœºåˆ¶ã€å†²çªåœºæ™¯å’Œä¼˜åŒ–ç­–ç•¥ä¸‰ä¸ªç»´åº¦æ·±å…¥è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒçŸ›ç›¾æ¥å£ç»„åˆçš„åŠ¨æ€æ€§ä¸ç´¢å¼•ä¸ç¡®å®šæ€§"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒçŸ›ç›¾ï¼šæ¥å£ç»„åˆçš„åŠ¨æ€æ€§ä¸ç´¢å¼•ä¸ç¡®å®šæ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ¥å£å®ç°çš„çµæ´»æ€§"&gt;&lt;strong&gt;æ¥å£å®ç°çš„çµæ´»æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ¥å£è‡ªç”±ç»„åˆ&lt;/strong&gt;ï¼šä¸€ä¸ªç±»å¯å®ç°å¤šä¸ªæ¥å£ï¼ˆå¦‚ &lt;code&gt;class MyClass implements InterfaceA, InterfaceB&lt;/code&gt;ï¼‰ï¼Œä½†ä¸åŒç±»å®ç°ç›¸åŒæ¥å£çš„&lt;strong&gt;é¡ºåºå¯èƒ½ä¸åŒ&lt;/strong&gt;ï¼ˆä¾‹å¦‚ç±»Aå…ˆå®ç°&lt;code&gt;InterfaceA&lt;/code&gt;å&lt;code&gt;InterfaceB&lt;/code&gt;ï¼Œç±»Bé¡ºåºç›¸åï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å½±å“ç´¢å¼•ä½ç½®ï¼šæ¯ä¸ªç±»åœ¨æ„å»ºitableæ—¶ï¼Œä¼šæŒ‰
æ¥å£å£°æ˜é¡ºåº
å°†æ¥å£æ–¹æ³•åˆ†ç»„å­˜å…¥æ–¹æ³•è¡¨ã€‚å› æ­¤ï¼ŒåŒä¸€æ¥å£æ–¹æ³•åœ¨ä¸åŒç±»ä¸­çš„
ç‰©ç†åç§»é‡å¯èƒ½ä¸åŒ
ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç±»Aï¼šå…ˆå®ç°InterfaceAï¼ŒåInterfaceB
class ClassA implements InterfaceA, InterfaceB { ... }
// ç±»Bï¼šå…ˆå®ç°InterfaceBï¼ŒåInterfaceA
class ClassB implements InterfaceB, InterfaceA { ... }
&lt;/code&gt;&lt;/pre&gt;æ­¤æ—¶ï¼Œ
&lt;pre tabindex="0"&gt;&lt;code&gt;InterfaceA.method1()
&lt;/code&gt;&lt;/pre&gt;åœ¨
&lt;pre tabindex="0"&gt;&lt;code&gt;ClassA
&lt;/code&gt;&lt;/pre&gt;å’Œ
&lt;pre tabindex="0"&gt;&lt;code&gt;ClassB
&lt;/code&gt;&lt;/pre&gt;çš„itableä¸­ä½äºä¸åŒåˆ†ç»„ï¼Œå¯¼è‡´ç´¢å¼•ä½ç½®æ— æ³•ç»Ÿä¸€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¡¥æ¥æ–¹æ³•çš„å¹²æ‰°"&gt;&lt;strong&gt;æ¡¥æ¥æ–¹æ³•çš„å¹²æ‰°&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤æ–¹æ³•å†²çª&lt;/strong&gt;ï¼šè‹¥å¤šä¸ªæ¥å£æœ‰åŒåé»˜è®¤æ–¹æ³•ï¼ˆå¦‚&lt;code&gt;InterfaceA&lt;/code&gt;å’Œ&lt;code&gt;InterfaceB&lt;/code&gt;å‡å«&lt;code&gt;default void log()&lt;/code&gt;ï¼‰ï¼Œå®ç°ç±»éœ€&lt;strong&gt;æ˜¾å¼é‡å†™æˆ–æŒ‡å®š&lt;/strong&gt;å…¶ä¸­ä¸€ä¸ªï¼ŒJVMä¼šç”Ÿæˆ&lt;strong&gt;æ¡¥æ¥æ–¹æ³•&lt;/strong&gt;ï¼ˆBridge Methodï¼‰è§£å†³æ­§ä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç ´åç´¢å¼•ä¸€è‡´æ€§&lt;/strong&gt;ï¼šæ¡¥æ¥æ–¹æ³•éœ€æ’å…¥åˆ°itableçš„å¯¹åº”æ¥å£å­è¡¨ä¸­ï¼Œè¿›ä¸€æ­¥æ‰°ä¹±åŸæœ‰æ–¹æ³•é¡ºåºï¼Œä½¿ç´¢å¼•ä½ç½®æ— æ³•é¢„è®¡ç®—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°æœºåˆ¶itableçš„åŒå±‚æŸ¥æ‰¾ç»“æ„"&gt;ğŸ” &lt;strong&gt;å®ç°æœºåˆ¶ï¼šitableçš„åŒå±‚æŸ¥æ‰¾ç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;itableé‡‡ç”¨äºŒçº§ç»“æ„å­˜å‚¨æ¥å£æ–¹æ³•ï¼ŒåŠ å‰§äº†è¿è¡Œæ—¶è§£æéœ€æ±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Offset Tableï¼ˆåç§»è¡¨ï¼‰&lt;/strong&gt;
å­˜å‚¨æ¯ä¸ªæ¥å£åœ¨itableä¸­çš„&lt;strong&gt;èµ·å§‹åç§»é‡&lt;/strong&gt;â€‹ï¼ˆå¦‚&lt;code&gt;InterfaceA&lt;/code&gt;åç§»&lt;code&gt;0x20&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Method Tableï¼ˆæ–¹æ³•è¡¨ï¼‰&lt;/strong&gt;
æŒ‰æ¥å£åˆ†ç»„å­˜å‚¨æ–¹æ³•æŒ‡é’ˆï¼Œæ¯ç»„å¯¹åº”ä¸€ä¸ªæ¥å£çš„æ‰€æœ‰æ–¹æ³•ã€‚
&lt;strong&gt;è°ƒç”¨æµç¨‹ï¼ˆ&lt;code&gt;invokeinterface&lt;/code&gt;æŒ‡ä»¤ï¼‰&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;sequenceDiagram
participant Caller
participant itable
Caller-&amp;gt;&amp;gt;itable: 1. æ ¹æ®æ¥å£ç±»å‹æŸ¥æ‰¾åç§»è¡¨
itable-&amp;gt;&amp;gt;itable: 2. å®šä½æ¥å£å­è¡¨èµ·å§‹åœ°å€
itable-&amp;gt;&amp;gt;itable: 3. åœ¨å­è¡¨ä¸­çº¿æ€§/äºŒåˆ†æœç´¢ç›®æ ‡æ–¹æ³•ç­¾å
itable-&amp;gt;&amp;gt;Caller: 4. è¿”å›æ–¹æ³•åœ°å€
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ­¤è¿‡ç¨‹éœ€ä¸¤æ¬¡æŸ¥æ‰¾ï¼š
â‘  å®šä½æ¥å£åç§»é‡ï¼ˆO(1)ï¼‰ï¼›
â‘¡ åœ¨æ¥å£å­è¡¨ä¸­åŒ¹é…æ–¹æ³•ç­¾åï¼ˆO(n)æˆ–O(log n)ï¼‰ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¯¹æ¯”vtableå•ç»§æ‰¿ä¸‹çš„é™æ€ç¡®å®šæ€§"&gt;âš¡ &lt;strong&gt;å¯¹æ¯”vtableï¼šå•ç»§æ‰¿ä¸‹çš„é™æ€ç¡®å®šæ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸itableä¸åŒï¼Œvtableï¼ˆè™šæ–¹æ³•è¡¨ï¼‰çš„ç´¢å¼•åœ¨ç¼–è¯‘æ—¶å¯å›ºå®šï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;vtable&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;itable&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•ç»§æ‰¿é“¾ï¼Œæ–¹æ³•é¡ºåºç¨³å®š&lt;/td&gt;
&lt;td&gt;å¤šæ¥å£è‡ªç”±ç»„åˆï¼Œé¡ºåºå¯å˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç´¢å¼•åˆ†é…&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çˆ¶ç±»æ–¹æ³•åœ¨å‰ï¼Œå­ç±»æ–°å¢åœ¨å&lt;/td&gt;
&lt;td&gt;æŒ‰æ¥å£å£°æ˜é¡ºåºåˆ†ç»„å­˜å‚¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†²çªå¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡å†™ä»…æ›¿æ¢æŒ‡é’ˆï¼Œä¸æ”¹å˜ç´¢å¼•&lt;/td&gt;
&lt;td&gt;æ¡¥æ¥æ–¹æ³•æ’å…¥ç ´ååŸå§‹é¡ºåº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒç”¨å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;O(1)ï¼ˆå›ºå®šåç§»è·³è½¬ï¼‰&lt;/td&gt;
&lt;td&gt;O(n) æˆ– O(log n)ï¼ˆåŠ¨æ€æœç´¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Parent { void foo() {} }
class Child extends Parent {
@Override void foo() {} // æ›¿æ¢çˆ¶ç±»fooæŒ‡é’ˆï¼Œç´¢å¼•ä¸å˜
void bar() {} // æ–°å¢æ–¹æ³•ï¼Œç´¢å¼•è¿½åŠ æœ«å°¾
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å­ç±»vtableç›´æ¥ç»§æ‰¿çˆ¶ç±»ç´¢å¼•ç»“æ„ï¼Œä»…éœ€å±€éƒ¨è°ƒæ•´ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-jvmçš„ä¼˜åŒ–ç­–ç•¥"&gt;ğŸ› ï¸ &lt;strong&gt;JVMçš„ä¼˜åŒ–ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä¸ºé™ä½åŠ¨æ€æœç´¢å¼€é”€ï¼ŒJITç¼–è¯‘å™¨é‡‡ç”¨ä»¥ä¸‹ä¼˜åŒ–ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…è”ç¼“å­˜ï¼ˆInline Cacheï¼‰&lt;/strong&gt;
ç¼“å­˜ä¸Šä¸€æ¬¡è°ƒç”¨çš„æ¥å£ç±»å‹å’Œæ–¹æ³•åœ°å€ï¼Œä¸‹æ¬¡ç›´æ¥è·³è½¬ï¼ˆå•æ€è°ƒç”¨æ—¶é€€åŒ–ä¸ºO(1)ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£å­è¡¨æ’åº&lt;/strong&gt;
æŒ‰æ–¹æ³•ç­¾åå“ˆå¸Œå€¼æ’åºå­è¡¨ï¼Œå°†çº¿æ€§æœç´¢ä¼˜åŒ–ä¸º&lt;strong&gt;äºŒåˆ†æŸ¥æ‰¾ï¼ˆO(log n)ï¼‰â€‹&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»è™šæ‹ŸåŒ–ï¼ˆDevirtualizationï¼‰&lt;/strong&gt;
è‹¥è¿è¡Œæ—¶åˆ†æç¡®è®¤æ¥å£æ–¹æ³•&lt;strong&gt;ä»…æœ‰ä¸€ä¸ªå®ç°ç±»&lt;/strong&gt;â€‹ï¼ˆå¦‚&lt;code&gt;List list = new ArrayList()&lt;/code&gt;ï¼‰ï¼Œç›´æ¥æ›¿æ¢ä¸ºé™æ€ç»‘å®šè°ƒç”¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç»“è®ºçµæ´»æ€§ç‰ºç‰²äº†é™æ€ç´¢å¼•èƒ½åŠ›"&gt;ğŸ’ &lt;strong&gt;ç»“è®ºï¼šçµæ´»æ€§ç‰ºç‰²äº†é™æ€ç´¢å¼•èƒ½åŠ›&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘æ—¶å¯ç¡®å®š&lt;/strong&gt;ï¼šç±»å®ç°çš„æ¥å£åˆ—è¡¨ã€æ¥å£æ–¹æ³•ç­¾åã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶éœ€åŠ¨æ€è§£æ&lt;/strong&gt;ï¼šåŒä¸€æ¥å£æ–¹æ³•åœ¨ä¸åŒç±»itableä¸­çš„&lt;strong&gt;ç‰©ç†ä½ç½®&lt;/strong&gt;ï¼ˆå› æ¥å£é¡ºåºã€æ¡¥æ¥æ–¹æ³•æ’å…¥è€Œå„å¼‚ï¼‰ã€‚
è¿™ç§è®¾è®¡å¹³è¡¡äº†Javaæ¥å£çš„&lt;strong&gt;å¤šå®ç°çµæ´»æ€§&lt;/strong&gt;ä¸&lt;strong&gt;å¤šæ€è°ƒç”¨èƒ½åŠ›&lt;/strong&gt;ï¼Œä»£ä»·æ˜¯æ¥å£æ–¹æ³•è°ƒç”¨æ¯”ç±»æ–¹æ³•è°ƒç”¨æ›´æ…¢ã€‚å®é™…å¼€å‘ä¸­ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;é¿å…è¿‡åº¦å®ç°å†—ä½™æ¥å£ï¼›&lt;/li&gt;
&lt;li&gt;å¯¹é«˜é¢‘è°ƒç”¨çš„æ¥å£æ–¹æ³•ï¼Œå°½é‡ä½¿ç”¨&lt;code&gt;default&lt;/code&gt;æ–¹æ³•æä¾›ç¨³å®šå®ç°ï¼›&lt;/li&gt;
&lt;li&gt;ç¡®ä¿å…³é”®è·¯å¾„çš„æ¥å£æœ‰å•ä¸€å®ç°ç±»ï¼Œè§¦å‘JITå»è™šæ‹ŸåŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="itable-æ–¹æ³•æ’åº"&gt;Itable æ–¹æ³•æ’åº
&lt;/h2&gt;&lt;p&gt;åœ¨Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸­ï¼Œitableï¼ˆæ¥å£æ–¹æ³•è¡¨ï¼‰çš„å„æ¥å£å­è¡¨&lt;strong&gt;ä¸é‡‡ç”¨å›ºå®šç´¢å¼•è€Œæ˜¯åŸºäºæ–¹æ³•åï¼ˆç­¾åï¼‰æ’åº&lt;/strong&gt;ï¼Œæ ¸å¿ƒåŸå› åœ¨äº&lt;strong&gt;æ¥å£æ–¹æ³•çš„å¤šå®ç°åŠ¨æ€æ€§å’Œç¼–è¯‘æœŸæ— æ³•é¢„çŸ¥çš„ç»„åˆå†²çª&lt;/strong&gt;ã€‚ä»¥ä¸‹ä»å®ç°æœºåˆ¶ã€å†²çªåœºæ™¯ã€æ€§èƒ½æƒè¡¡ä¸‰ä¸ªç»´åº¦æ·±å…¥è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ¥å£æ–¹æ³•çš„åŠ¨æ€ç»„åˆæ€§ç ´åå›ºå®šç´¢å¼•"&gt;âš™ï¸ &lt;strong&gt;æ¥å£æ–¹æ³•çš„åŠ¨æ€ç»„åˆæ€§ç ´åå›ºå®šç´¢å¼•&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£å®ç°é¡ºåºå¯å˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªç±»å¯å®ç°å¤šä¸ªæ¥å£ï¼ˆå¦‚ &lt;code&gt;class MyClass implements A, B&lt;/code&gt;ï¼‰ï¼Œä½†ä¸åŒç±»å®ç°ç›¸åŒæ¥å£çš„&lt;strong&gt;é¡ºåºå¯èƒ½ä¸åŒ&lt;/strong&gt;ï¼ˆä¾‹å¦‚ç±»Xå…ˆå®ç°&lt;code&gt;A&lt;/code&gt;å&lt;code&gt;B&lt;/code&gt;ï¼Œç±»Yå…ˆå®ç°&lt;code&gt;B&lt;/code&gt;å&lt;code&gt;A&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åæœ&lt;/strong&gt;ï¼šåŒä¸€æ¥å£æ–¹æ³•åœ¨ä¸åŒç±»çš„itableä¸­ä½äºä¸åŒåˆ†ç»„ï¼Œç‰©ç†åç§»é‡æ— æ³•ç»Ÿä¸€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£ç»§æ‰¿å±‚çº§å¤æ‚&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¥å£å¯ç»§æ‰¿å…¶ä»–æ¥å£ï¼ˆå¦‚ &lt;code&gt;interface C extends A, B&lt;/code&gt;ï¼‰ï¼Œå®ç°ç±»éœ€åŒ…å«æ‰€æœ‰çˆ¶æ¥å£æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åæœ&lt;/strong&gt;ï¼š&lt;code&gt;C&lt;/code&gt;çš„å®ç°ç±»éœ€åœ¨itableä¸­ä¸º&lt;code&gt;A&lt;/code&gt;å’Œ&lt;code&gt;B&lt;/code&gt;çš„æ–¹æ³•åˆ†é…ä½ç½®ï¼Œå¯¼è‡´å­è¡¨ç»“æ„å› ç»§æ‰¿æ·±åº¦è€Œå¼‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¤šæ¥å£å†²çªä¸æ¡¥æ¥æ–¹æ³•æ³¨å…¥"&gt;ğŸ”¥ &lt;strong&gt;å¤šæ¥å£å†²çªä¸æ¡¥æ¥æ–¹æ³•æ³¨å…¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤æ–¹æ³•å†²çª&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥å¤šä¸ªæ¥å£æœ‰åŒåé»˜è®¤æ–¹æ³•ï¼ˆå¦‚&lt;code&gt;A.log()&lt;/code&gt;å’Œ&lt;code&gt;B.log()&lt;/code&gt;ï¼‰ï¼Œå®ç°ç±»éœ€æ˜¾å¼é‡å†™æˆ–æŒ‡å®šå…¶ä¸­ä¸€ä¸ªã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åæœ&lt;/strong&gt;ï¼šJVMè‡ªåŠ¨ç”Ÿæˆ&lt;strong&gt;æ¡¥æ¥æ–¹æ³•&lt;/strong&gt;ï¼ˆBridge Methodï¼‰è§£å†³æ­§ä¹‰ï¼Œè¯¥æ–¹æ³•éœ€æ’å…¥åˆ°å¯¹åº”æ¥å£å­è¡¨ä¸­ã€‚
&lt;em&gt;ç¤ºä¾‹&lt;/em&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface A { default void log() {} }
interface B { default void log() {} }
class MyClass implements A, B {
@Override void log() {} // æ¡¥æ¥æ–¹æ³•æ’å…¥itableçš„Aã€Bå­è¡¨
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ç ´å&lt;/strong&gt;ï¼šæ¡¥æ¥æ–¹æ³•åŠ¨æ€æ’å…¥ï¼Œæ‰°ä¹±å­è¡¨åŸæœ‰é¡ºåºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–°å¢é»˜è®¤æ–¹æ³•çš„å…¼å®¹æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥æ¥å£åç»­ç‰ˆæœ¬æ–°å¢é»˜è®¤æ–¹æ³•ï¼Œå·²å­˜åœ¨çš„å®ç°ç±»éœ€åŠ¨æ€æ‰©å±•itableã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åæœ&lt;/strong&gt;ï¼šå›ºå®šç´¢å¼•ä¼šå¯¼è‡´æ–°æ—§ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜ï¼ˆç´¢å¼•ä½ç½®å†²çªï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½æƒè¡¡åŠ¨æ€æœç´¢-vs-å›ºå®šç´¢å¼•çš„ä»£ä»·"&gt;âš–ï¸ &lt;strong&gt;æ€§èƒ½æƒè¡¡ï¼šåŠ¨æ€æœç´¢ vs å›ºå®šç´¢å¼•çš„ä»£ä»·&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å›ºå®šç´¢å¼•çš„ä¸å¯è¡Œæ€§"&gt;&lt;strong&gt;å›ºå®šç´¢å¼•çš„ä¸å¯è¡Œæ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å›ºå®šç´¢å¼•çš„ä»£ä»·&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠ¨æ€æœç´¢çš„çµæ´»æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šæ¥å£å®ç°é¡ºåºå˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç´¢å¼•ä½ç½®æ··ä¹±ï¼ˆç±»Xä¸ç±»Yçš„itableç»“æ„ä¸åŒï¼‰&lt;/td&gt;
&lt;td&gt;æŒ‰æ–¹æ³•åæ’åºï¼Œæ— è§†æ¥å£åˆ†ç»„é¡ºåº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¥å£æ–°å¢é»˜è®¤æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€é‡å»ºæ‰€æœ‰å®ç°ç±»çš„itableï¼ˆäºŒè¿›åˆ¶å…¼å®¹ç ´è£‚ï¼‰&lt;/td&gt;
&lt;td&gt;ä»…éœ€åœ¨å­è¡¨æœ«å°¾è¿½åŠ ï¼Œæ—§ç±»æ— éœ€ä¿®æ”¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¡¥æ¥æ–¹æ³•æ’å…¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç´¢å¼•é¢„ç•™ç©ºæ´æˆ–é‡æ’ï¼ˆå†…å­˜æµªè´¹æˆ–è®¡ç®—å¤æ‚ï¼‰&lt;/td&gt;
&lt;td&gt;åŠ¨æ€æ’å…¥å¹¶æ’åºï¼Œé€‚åº”ä»»æ„å†²çªåœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="åŠ¨æ€æœç´¢çš„ä¼˜åŒ–æ‰‹æ®µ"&gt;&lt;strong&gt;åŠ¨æ€æœç´¢çš„ä¼˜åŒ–æ‰‹æ®µ&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å°½ç®¡éœ€è¿è¡Œæ—¶è§£æï¼ŒJITç¼–è¯‘å™¨é€šè¿‡ä»¥ä¸‹ç­–ç•¥é™ä½å¼€é”€ï¼š
1.
å­è¡¨æŒ‰æ–¹æ³•ç­¾åå“ˆå¸Œæ’åº&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°†çº¿æ€§æ‰«æä¼˜åŒ–ä¸º&lt;strong&gt;äºŒåˆ†æŸ¥æ‰¾ï¼ˆO(log n)ï¼‰&lt;/strong&gt;ï¼Œæ˜¾è‘—å‡å°‘æ¯”è¾ƒæ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å†…è”ç¼“å­˜ï¼ˆInline Cacheï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç¼“å­˜ä¸Šä¸€æ¬¡è°ƒç”¨çš„æ–¹æ³•åœ°å€ï¼Œå•æ€è°ƒç”¨æ—¶ç›´æ¥è·³è½¬ï¼ˆO(1)ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;å»è™šæ‹ŸåŒ–ï¼ˆDevirtualizationï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥JITç¡®å®šæ¥å£æ–¹æ³•ä»…æœ‰ä¸€ä¸ªå®ç°ï¼ˆå¦‚ &lt;code&gt;List list = new ArrayList()&lt;/code&gt;ï¼‰ï¼Œæ›¿æ¢ä¸ºé™æ€ç»‘å®šè°ƒç”¨ï¼ˆæ— itableæŸ¥æ‰¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“çµæ´»æ€§ä¸å…¼å®¹æ€§çš„å¿…ç„¶é€‰æ‹©"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šçµæ´»æ€§ä¸å…¼å®¹æ€§çš„å¿…ç„¶é€‰æ‹©&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£æ–¹æ³•çš„â€œåä¹‰å›ºå®šæ€§â€â‰ ç‰©ç†ä½ç½®å›ºå®š&lt;/strong&gt;ï¼š
æ¥å£æ–¹æ³•ç­¾åç¼–è¯‘æœŸç¡®å®šï¼Œä½†å…¶åœ¨&lt;strong&gt;å…·ä½“å®ç°ç±»ä¸­çš„ç‰©ç†ä½ç½®&lt;/strong&gt;å—å¤šæ¥å£é¡ºåºã€æ¡¥æ¥æ–¹æ³•ã€æ¥å£ç»§æ‰¿ç­‰å› ç´ æ‰°åŠ¨ï¼Œæ— æ³•é™æ€ç»‘å®šç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡å“²å­¦&lt;/strong&gt;ï¼š
Javaæ¥å£çš„&lt;strong&gt;å¤šå®ç°çµæ´»æ€§&lt;/strong&gt;ä¼˜å…ˆäºè°ƒç”¨æ€§èƒ½ã€‚itableçš„äºŒçº§åŠ¨æ€æŸ¥æ‰¾æœºåˆ¶ï¼ˆåç§»è¡¨+æ–¹æ³•å­è¡¨ï¼‰ä»¥å¯æ§æ€§èƒ½ä»£ä»·ï¼Œæ¢å–äº†æ¥å£æ‰©å±•çš„è‡ªç”±åº¦å’ŒäºŒè¿›åˆ¶å…¼å®¹æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš™ï¸ &lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šé«˜é¢‘è°ƒç”¨çš„æ¥å£å¯é€šè¿‡&lt;code&gt;default&lt;/code&gt;æ–¹æ³•æä¾›ç¨³å®šå®ç°ï¼Œæˆ–çº¦æŸå®ç°ç±»ä¸º&lt;code&gt;final&lt;/code&gt;ç±»å‹ï¼Œä»¥è§¦å‘JITçš„å»è™šæ‹ŸåŒ–ä¼˜åŒ–ï¼Œé—´æ¥è§„é¿itableæœç´¢å¼€é”€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¤šæ¥å£å‘½åå†²çª"&gt;å¤šæ¥å£å‘½åå†²çª
&lt;/h2&gt;&lt;p&gt;åœ¨Javaä¸­ï¼Œå½“ä¸€ä¸ªå®ç°ç±»åŒæ—¶ç»§æ‰¿å¤šä¸ªæ¥å£ï¼Œä¸”è¿™äº›æ¥å£åŒ…å«&lt;strong&gt;ç›¸åŒç­¾åï¼ˆæ–¹æ³•å+å‚æ•°åˆ—è¡¨ï¼‰çš„é»˜è®¤æ–¹æ³•&lt;/strong&gt;æ—¶ï¼Œä¼šè§¦å‘æ¥å£å†²çªã€‚æ­¤æ—¶ç¼–è¯‘å™¨æ— æ³•è‡ªåŠ¨ç¡®å®šåº”ä½¿ç”¨å“ªä¸ªé»˜è®¤æ–¹æ³•å®ç°ï¼Œå› æ­¤&lt;strong&gt;å¼ºåˆ¶è¦æ±‚å®ç°ç±»æ˜¾å¼è¦†ç›–å†²çªæ–¹æ³•&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§£å†³æ–¹æ³•å’Œåœºæ™¯åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ˜¾å¼æŒ‡å®šå†²çªæ–¹æ³•çš„è¯­æ³•"&gt;âš™ï¸ æ˜¾å¼æŒ‡å®šå†²çªæ–¹æ³•çš„è¯­æ³•
&lt;/h3&gt;&lt;p&gt;é€šè¿‡ &lt;strong&gt;&lt;code&gt;æ¥å£å.super.æ–¹æ³•å()&lt;/code&gt;&lt;/strong&gt; åœ¨è¦†ç›–æ–¹æ³•ä¸­æ˜ç¡®è°ƒç”¨ç›®æ ‡æ¥å£çš„é»˜è®¤å®ç°ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class å®ç°ç±» implements æ¥å£A, æ¥å£B {
@Override
public void å†²çªæ–¹æ³•() {
æ¥å£A.super.å†²çªæ–¹æ³•(); // æ˜¾å¼è°ƒç”¨æ¥å£Açš„é»˜è®¤æ–¹æ³•
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å…¸å‹å†²çªåœºæ™¯ä¸è§£å†³ç¤ºä¾‹"&gt;ğŸ” å…¸å‹å†²çªåœºæ™¯ä¸è§£å†³ç¤ºä¾‹
&lt;/h3&gt;&lt;h4 id="å¤šä¸ªæ¥å£æœ‰ç›¸åŒç­¾åçš„é»˜è®¤æ–¹æ³•"&gt;&lt;strong&gt;å¤šä¸ªæ¥å£æœ‰ç›¸åŒç­¾åçš„é»˜è®¤æ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šå®ç°ç±»å¿…é¡»é‡å†™å†²çªæ–¹æ³•ï¼Œå¹¶é€‰æ‹©è°ƒç”¨ç‰¹å®šæ¥å£çš„é»˜è®¤æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface FlyCar {
default void start() { System.out.println(&amp;#34;FlyCarå¯åŠ¨&amp;#34;); }
}
interface OperateCar {
default void start() { System.out.println(&amp;#34;OperateCarå¯åŠ¨&amp;#34;); }
}
class FlyingCar implements FlyCar, OperateCar {
@Override
public void start() {
FlyCar.super.start(); // æ˜¾å¼æŒ‡å®šè°ƒç”¨FlyCarçš„é»˜è®¤æ–¹æ³•
OperateCar.super.start(); // ç»§ç»­è°ƒç”¨OperateCarçš„é»˜è®¤æ–¹æ³•
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ¥å£é»˜è®¤æ–¹æ³•ä¸çˆ¶ç±»å®ä¾‹æ–¹æ³•å†²çª"&gt;&lt;strong&gt;æ¥å£é»˜è®¤æ–¹æ³•ä¸çˆ¶ç±»å®ä¾‹æ–¹æ³•å†²çª&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;è§„åˆ™&lt;/strong&gt;ï¼š&lt;strong&gt;ç±»ä¼˜å…ˆåŸåˆ™&lt;/strong&gt;ï¼ˆçˆ¶ç±»æ–¹æ³•è¦†ç›–æ¥å£é»˜è®¤æ–¹æ³•ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;class Horse {
public void run() { System.out.println(&amp;#34;é©¬å¥”è·‘&amp;#34;); }
}
interface Vehicle {
default void run() { System.out.println(&amp;#34;è½¦è¾†è¡Œé©¶&amp;#34;); }
}
class Mustang extends Horse implements Vehicle {
// æ— éœ€é‡å†™run()ï¼Œç›´æ¥ç»§æ‰¿Horseçš„run()æ–¹æ³•
}
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;æ­¤æ—¶ &lt;code&gt;new Mustang().run()&lt;/code&gt; è¾“å‡º &lt;code&gt;&amp;quot;é©¬å¥”è·‘&amp;quot;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id="æ¥å£ç»§æ‰¿é“¾ä¸­çš„æ–¹æ³•è¦†ç›–"&gt;&lt;strong&gt;æ¥å£ç»§æ‰¿é“¾ä¸­çš„æ–¹æ³•è¦†ç›–&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å­æ¥å£é‡å†™çˆ¶æ¥å£é»˜è®¤æ–¹æ³•åï¼Œå®ç°ç±»ä¼˜å…ˆä½¿ç”¨å­æ¥å£ç‰ˆæœ¬ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface Animal {
default void eat() { System.out.println(&amp;#34;åŠ¨ç‰©è¿›é£Ÿ&amp;#34;); }
}
interface Bird extends Animal {
@Override
default void eat() { System.out.println(&amp;#34;é¸Ÿç±»å•„é£Ÿ&amp;#34;); }
}
class Sparrow implements Bird {} // è°ƒç”¨Sparrow.eat() è¾“å‡º &amp;#34;é¸Ÿç±»å•„é£Ÿ&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ— æ³•è‡ªåŠ¨è§£å†³çš„å†²çªåœºæ™¯"&gt;âš ï¸ æ— æ³•è‡ªåŠ¨è§£å†³çš„å†²çªåœºæ™¯
&lt;/h3&gt;&lt;h4 id="æŠ½è±¡æ–¹æ³•ä¸é»˜è®¤æ–¹æ³•å†²çª"&gt;&lt;strong&gt;æŠ½è±¡æ–¹æ³•ä¸é»˜è®¤æ–¹æ³•å†²çª&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;è‹¥ä¸€ä¸ªæ¥å£å£°æ˜æŠ½è±¡æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ¥å£æä¾›åŒåé»˜è®¤æ–¹æ³•ï¼Œå®ç°ç±»å¿…é¡»æä¾›å…·ä½“å®ç°ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface A {
void execute(); // æŠ½è±¡æ–¹æ³•
}
interface B {
default void execute() {} // é»˜è®¤æ–¹æ³•
}
class C implements A, B {
@Override
public void execute() {
// å¿…é¡»å®ç°ï¼Œå¦åˆ™ç¼–è¯‘æŠ¥é”™
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="è¿”å›ç±»å‹ä¸å…¼å®¹çš„æ–¹æ³•å†²çª"&gt;&lt;strong&gt;è¿”å›ç±»å‹ä¸å…¼å®¹çš„æ–¹æ³•å†²çª&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ä¸åŒæ¥å£çš„å†²çªæ–¹æ³•è¿”å›ç±»å‹ä¸å…¼å®¹ï¼ˆå¦‚ &lt;code&gt;void&lt;/code&gt; vs &lt;code&gt;int&lt;/code&gt;ï¼‰ï¼Œç¼–è¯‘å™¨ç›´æ¥æŠ¥é”™ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface X { void action(); }
interface Y { int action(); }
// ç¼–è¯‘é”™è¯¯ï¼šè¿”å›ç±»å‹å†²çª
class Z implements X, Y {}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-é«˜çº§è§£å†³æŠ€å·§"&gt;ğŸ’¡ é«˜çº§è§£å†³æŠ€å·§
&lt;/h3&gt;&lt;h4 id="å†…éƒ¨ç±»éš”ç¦»å†²çª"&gt;&lt;strong&gt;å†…éƒ¨ç±»éš”ç¦»å†²çª&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;é€šè¿‡å†…éƒ¨ç±»å®ç°éƒ¨åˆ†æ¥å£ï¼Œç‰©ç†éš”ç¦»å†²çªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface Printer {
void print();
}
interface Scanner {
void print(); // åŒåå†²çªæ–¹æ³•
}
class AllInOne implements Printer {
@Override
public void print() { System.out.println(&amp;#34;æ‰“å°æ–‡æ¡£&amp;#34;); }
// å†…éƒ¨ç±»å•ç‹¬å®ç°Scanner
private class ScannerImpl implements Scanner {
@Override
public void print() { System.out.println(&amp;#34;æ‰«ææ–‡æ¡£&amp;#34;); }
}
Scanner getScanner() { return new ScannerImpl(); }
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="é‡è½½å·®å¼‚åŒ–å‚æ•°"&gt;&lt;strong&gt;é‡è½½å·®å¼‚åŒ–å‚æ•°&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;é€šè¿‡ä¸åŒå‚æ•°åˆ—è¡¨å®ç°æ–¹æ³•é‡è½½ï¼Œç»•è¿‡ç­¾åå†²çªï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface Writer {
default void write(String text) {}
}
interface Reader {
default void write(String text) {} // ç›¸åŒç­¾å
}
class Device implements Writer, Reader {
@Override
public void write(String text) { // ç»Ÿä¸€å®ç°
}
// æ–°å¢é‡è½½æ–¹æ³•
public void write(byte[] data) {}
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å†²çªè§£å†³è§„åˆ™æ€»ç»“"&gt;âœ… å†²çªè§£å†³è§„åˆ™æ€»ç»“
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§£å†³æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å¤šæ¥å£é»˜è®¤æ–¹æ³•å†²çª&lt;/td&gt;
&lt;td&gt;å®ç°ç±»å¼ºåˆ¶é‡å†™ï¼Œç”¨ &lt;code&gt;æ¥å£A.super.æ–¹æ³•()&lt;/code&gt; æ˜¾å¼æŒ‡å®šè°ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;çˆ¶ç±»å®ä¾‹æ–¹æ³• vs æ¥å£é»˜è®¤æ–¹æ³•&lt;/td&gt;
&lt;td&gt;ç±»ä¼˜å…ˆåŸåˆ™ï¼ˆçˆ¶ç±»æ–¹æ³•è‡ªåŠ¨è¦†ç›–æ¥å£é»˜è®¤æ–¹æ³•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­æ¥å£é‡å†™çˆ¶æ¥å£é»˜è®¤æ–¹æ³•&lt;/td&gt;
&lt;td&gt;å®ç°ç±»ä½¿ç”¨å­æ¥å£ç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æŠ½è±¡æ–¹æ³•ä¸é»˜è®¤æ–¹æ³•å†²çª&lt;/td&gt;
&lt;td&gt;å®ç°ç±»å¿…é¡»æä¾›å…·ä½“å®ç°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¿”å›ç±»å‹ä¸å…¼å®¹çš„å†²çª&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘é”™è¯¯ï¼Œæ— æ³•è§£å†³&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’ &lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¼˜å…ˆé€šè¿‡ &lt;strong&gt;&lt;code&gt;æ¥å£å.super&lt;/code&gt;&lt;/strong&gt; æ˜ç¡®è°ƒç”¨è·¯å¾„ï¼›&lt;/li&gt;
&lt;li&gt;å¤æ‚å†²çªç”¨&lt;strong&gt;å†…éƒ¨ç±»éš”ç¦»&lt;/strong&gt;æˆ–&lt;strong&gt;æ–¹æ³•é‡è½½&lt;/strong&gt;åŒ–è§£ï¼›&lt;/li&gt;
&lt;li&gt;è®¾è®¡æ¥å£æ—¶é¿å…æ— å…³è”çš„é»˜è®¤æ–¹æ³•åŒåï¼Œå‡å°‘å†²çªæ¦‚ç‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2 id="itableæœç´¢ä¼˜åŒ–"&gt;Itableæœç´¢ä¼˜åŒ–
&lt;/h2&gt;&lt;p&gt;JVMå¯¹æ¥å£æ–¹æ³•è°ƒç”¨çš„ä¼˜åŒ–æ˜¯è§£å†³å…¶å›ºæœ‰æ€§èƒ½ç“¶é¢ˆçš„å…³é”®æŠ€æœ¯ï¼Œä¸»è¦é€šè¿‡&lt;strong&gt;å†…è”ç¼“å­˜ï¼ˆInline Cacheï¼‰ã€æ–¹æ³•è¡¨ç»“æ„æ”¹è¿›å’Œåˆ†å±‚ç¼–è¯‘ç­–ç•¥&lt;/strong&gt;å®ç°ã€‚ä»¥ä¸‹ä»åº•å±‚æœºåˆ¶åˆ°ä¼˜åŒ–æ‰‹æ®µè¿›è¡Œç³»ç»Ÿè§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ¥å£æ–¹æ³•è°ƒç”¨çš„å›ºæœ‰ç“¶é¢ˆ"&gt;ğŸ” æ¥å£æ–¹æ³•è°ƒç”¨çš„å›ºæœ‰ç“¶é¢ˆ
&lt;/h3&gt;&lt;p&gt;ç›¸è¾ƒäºç±»æ–¹æ³•ï¼ˆé€šè¿‡è™šæ–¹æ³•è¡¨ç›´æ¥ç´¢å¼•ï¼‰ï¼Œæ¥å£æ–¹æ³•è°ƒç”¨å­˜åœ¨æ›´é«˜å¼€é”€ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€å¤šæ€æ€§&lt;/strong&gt;ï¼šæ¥å£å¯è¢«å¤šä¸ªä¸ç›¸å…³ç±»å®ç°ï¼Œæ— æ³•åœ¨ç¼–è¯‘æœŸç¡®å®šæ–¹æ³•ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;äºŒæ¬¡æŸ¥æ‰¾è¿‡ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤1&lt;/strong&gt;ï¼šè·å–å¯¹è±¡å®é™…ç±»ï¼ˆ&lt;code&gt;obj.getClass()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤2&lt;/strong&gt;ï¼šæŸ¥æ‰¾è¯¥ç±»å®ç°çš„æ¥å£æ–¹æ³•è¡¨ï¼ˆ&lt;strong&gt;Itable&lt;/strong&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤3&lt;/strong&gt;ï¼šåœ¨Itableä¸­æœç´¢æ–¹æ³•ç­¾ååŒ¹é…çš„æ§½ä½ï¼ˆSlotï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œç¢°æ’é£é™©&lt;/strong&gt;ï¼šItableé‡‡ç”¨å“ˆå¸Œç»“æ„ï¼Œç¢°æ’æ—¶éœ€éå†é“¾è¡¨ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦ &lt;strong&gt;O(n)&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;æœªä¼˜åŒ–æ—¶ï¼Œæ¯æ¬¡æ¥å£æ–¹æ³•è°ƒç”¨éœ€ &lt;strong&gt;10~30ä¸ªCPUå‘¨æœŸ&lt;/strong&gt;ï¼Œè¿œé«˜äºç±»æ–¹æ³•çš„ &lt;strong&gt;2~5å‘¨æœŸ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä¼˜åŒ–æŠ€æœ¯å†…è”ç¼“å­˜inline-cache"&gt;âš™ï¸ æ ¸å¿ƒä¼˜åŒ–æŠ€æœ¯ï¼šå†…è”ç¼“å­˜ï¼ˆInline Cacheï¼‰
&lt;/h3&gt;&lt;p&gt;å†…è”ç¼“å­˜é€šè¿‡åœ¨&lt;strong&gt;è°ƒç”¨ç‚¹ï¼ˆCall Siteï¼‰&lt;/strong&gt; ç¼“å­˜å†å²è°ƒç”¨ä¿¡æ¯ï¼Œå°†åŠ¨æ€æŸ¥æ‰¾è½¬ä¸ºæ¡ä»¶åˆ¤æ–­ï¼š&lt;/p&gt;
&lt;h4 id="ç¼“å­˜çŠ¶æ€æœº"&gt;&lt;strong&gt;ç¼“å­˜çŠ¶æ€æœº&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;çŠ¶æ€&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼“å­˜æ¡ç›®æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å‘½ä¸­é€»è¾‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœªåˆå§‹åŒ–ï¼ˆUninitializedï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;é¦–æ¬¡è°ƒç”¨æ‰§è¡Œå®Œæ•´æŸ¥æ‰¾&lt;/td&gt;
&lt;td&gt;åˆå§‹è°ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å•æ€ï¼ˆMonomorphicï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;code&gt;if (receiver.class == cachedClass)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;95%+å•ç±»å‹è°ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤šæ€ï¼ˆPolymorphicï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;2~8ï¼ˆé€šå¸¸ï¼‰&lt;/td&gt;
&lt;td&gt;çº§è”&lt;code&gt;if-else&lt;/code&gt;åŒ¹é…ç¼“å­˜ç±»&lt;/td&gt;
&lt;td&gt;å°‘é‡ç±»å‹äº¤æ›¿ï¼ˆå¦‚2-3ç§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¶…å¤šæ€ï¼ˆMegamorphicï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&amp;gt;8&lt;/td&gt;
&lt;td&gt;é€€åŒ–è‡³å®Œæ•´æŸ¥æ‰¾&lt;/td&gt;
&lt;td&gt;ç±»å‹é¢‘ç¹å˜åŒ–ï¼ˆå¦‚é€šç”¨æ¥å£ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[è°ƒç”¨ç‚¹é¦–æ¬¡æ‰§è¡Œ] --&amp;gt; B[å®Œæ•´æ–¹æ³•æŸ¥æ‰¾]
B --&amp;gt; C[å•æ€ç¼“å­˜]
C -- æ¥æ”¶è€…ç±»å‹åŒ¹é… --&amp;gt; D[ç›´æ¥è·³è½¬ç¼“å­˜æ–¹æ³•]
C -- ç±»å‹ä¸åŒ¹é… --&amp;gt; E{ç±»å‹æ•°â‰¤8?}
E -- æ˜¯ --&amp;gt; F[æ‰©å±•ä¸ºå¤šæ€ç¼“å­˜]
E -- å¦ --&amp;gt; G[é€€åŒ–ä¸ºè¶…å¤šæ€/å®Œæ•´æŸ¥æ‰¾]
F --&amp;gt; D
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ€§èƒ½æå‡åŸç†"&gt;&lt;strong&gt;æ€§èƒ½æå‡åŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘æŒ‡ä»¤æ•°&lt;/strong&gt;ï¼šå°†åŠ¨æ€æŸ¥æ‰¾è½¬ä¸ºå¯„å­˜å™¨æ¯”è¾ƒ+æ¡ä»¶è·³è½¬ï¼ˆçº¦3æŒ‡ä»¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ”¯é¢„æµ‹ä¼˜åŒ–&lt;/strong&gt;ï¼šCPUæ›´å®¹æ˜“é¢„æµ‹å±€éƒ¨æ€§å¼ºçš„ç±»å‹è·³è½¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç å†…è”æœºä¼š&lt;/strong&gt;ï¼šå•æ€ç¼“å­˜å¯è§¦å‘æ–¹æ³•å†…è”ï¼ˆè§åæ–‡æ¡ˆä¾‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;å®æµ‹æ•ˆæœ&lt;/strong&gt;ï¼šå•æ€ç¼“å­˜å‘½ä¸­æ—¶ï¼Œè°ƒç”¨å¼€é”€é™ä½è‡³ &lt;strong&gt;1~3å‘¨æœŸ&lt;/strong&gt;ï¼Œæ¥è¿‘é™æ€ç»‘å®šæ€§èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ–¹æ³•è¡¨ç»“æ„ä¼˜åŒ–itableå‹ç¼©"&gt;ğŸ§© æ–¹æ³•è¡¨ç»“æ„ä¼˜åŒ–ï¼ˆItableå‹ç¼©ï¼‰
&lt;/h3&gt;&lt;p&gt;JVMé€šè¿‡ä¼˜åŒ–Itableå­˜å‚¨ç»“æ„å‡å°‘æŸ¥æ‰¾å¼€é”€ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç­¾åçº¿æ€§æ’åº&lt;/strong&gt;
æ¥å£æ–¹æ³•æŒ‰&lt;strong&gt;æ–¹æ³•ç­¾åå“ˆå¸Œå€¼æ’åº&lt;/strong&gt;ï¼ŒäºŒåˆ†æŸ¥æ‰¾æ›¿ä»£é“¾è¡¨éå†ï¼Œæ—¶é—´å¤æ‚åº¦é™è‡³ â€‹&lt;strong&gt;O(log n)â€‹&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å…±æ¥å£å…±äº«è¡¨&lt;/strong&gt;
è‹¥å¤šä¸ªç±»å®ç°ç›¸åŒæ¥å£ï¼ˆå¦‚&lt;code&gt;Serializable&lt;/code&gt;ï¼‰ï¼Œå…±äº«Itableå‰¯æœ¬ï¼Œå‡å°‘å†…å­˜ä¸åŠ è½½å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°ä»£ç ç»‘å®š&lt;/strong&gt;
JITç¼–è¯‘æ—¶ï¼Œå°†Itableç´¢å¼•ç¡¬ç¼–ç åˆ°æœºå™¨ç ï¼ˆå¦‚&lt;code&gt;mov&lt;/code&gt;æŒ‡ä»¤ç›´æ¥åŠ è½½æ–¹æ³•åœ°å€ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åˆ†å±‚ä¼˜åŒ–ç­–ç•¥"&gt;âš¡ åˆ†å±‚ä¼˜åŒ–ç­–ç•¥
&lt;/h3&gt;&lt;p&gt;æ ¹æ®è°ƒç”¨é¢‘ç‡ï¼ŒJVMåŠ¨æ€å‡çº§ä¼˜åŒ–ç­–ç•¥ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ‰§è¡Œé˜¶æ®µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŒ–æ‰‹æ®µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§£é‡Šæ‰§è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†…è”ç¼“å­˜ + ItableäºŒåˆ†æŸ¥æ‰¾&lt;/td&gt;
&lt;td&gt;é¦–æ¬¡æ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;C1ç¼–è¯‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆå•æ€/å¤šæ€ç¼“å­˜ä»£ç &lt;/td&gt;
&lt;td&gt;æ–¹æ³•è°ƒç”¨è®¡æ•° &amp;gt; 1500ï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;C2ç¼–è¯‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¿€è¿›å†…è” + å»è™šæ‹ŸåŒ–&lt;/td&gt;
&lt;td&gt;è°ƒç”¨è®¡æ•° &amp;gt; 10000ï¼Œä¸”ç¼“å­˜ç¨³å®š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®å‡çº§è¿‡ç¨‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å»è™šæ‹ŸåŒ–ï¼ˆDevirtualizationï¼‰&lt;/strong&gt;
è‹¥CHAï¼ˆç±»å±‚æ¬¡åˆ†æï¼‰ç¡®è®¤æŸæ¥å£ä»…æœ‰ä¸€ç§å®ç°ï¼Œå°†æ¥å£è°ƒç”¨è½¬ä¸ºç±»è°ƒç”¨ï¼Œç›´æ¥ä½¿ç”¨è™šæ–¹æ³•è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;æ¡ä»¶å†…è”
å¯¹å•æ€ç¼“å­˜æ–¹æ³•ï¼Œå°†ç›®æ ‡æ–¹æ³•ä½“å¤åˆ¶åˆ°è°ƒç”¨å¤„ï¼Œæ¶ˆé™¤è°ƒç”¨å¼€é”€ï¼ˆè§ç¤ºä¾‹ğŸ‘‡ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;// ä¼˜åŒ–å‰
service.execute(); // æ¥å£æ–¹æ³•è°ƒç”¨
// å•æ€å†…è”åï¼ˆå‡è®¾å®é™…ç±»å‹ä¸ºServiceAï¼‰
ServiceA.execute(); // é™æ€ç»‘å®š
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–æ•ˆæœä¸å®æµ‹æ¡ˆä¾‹"&gt;ğŸ“Š ä¼˜åŒ–æ•ˆæœä¸å®æµ‹æ¡ˆä¾‹
&lt;/h3&gt;&lt;h4 id="æ€§èƒ½å¯¹æ¯”æµ‹è¯•"&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”æµ‹è¯•&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è°ƒç”¨ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;æœªä¼˜åŒ–è€—æ—¶&lt;/th&gt;
&lt;th&gt;å†…è”ç¼“å­˜ä¼˜åŒ–å&lt;/th&gt;
&lt;th&gt;å†…è”ç¼“å­˜+å»è™šæ‹ŸåŒ–&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å•æ€æ¥å£è°ƒç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;15ns&lt;/td&gt;
&lt;td&gt;2nsï¼ˆ7.5xâ†‘ï¼‰&lt;/td&gt;
&lt;td&gt;1nsï¼ˆ15xâ†‘ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒæ€æ¥å£è°ƒç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;18ns&lt;/td&gt;
&lt;td&gt;5nsï¼ˆ3.6xâ†‘ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¶…å¤šæ€è°ƒç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;50ns+&lt;/td&gt;
&lt;td&gt;45nsï¼ˆâ‰ˆ10%â†‘ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="å®é™…åœºæ™¯ä¼˜åŒ–"&gt;&lt;strong&gt;å®é™…åœºæ™¯ä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Spring Beanæ³¨å…¥&lt;/strong&gt;ï¼šå¤šæ•°&lt;code&gt;@Autowired&lt;/code&gt;æ¥å£å®é™…ä¸ºå•æ€ï¼Œ95%è°ƒç”¨å‘½ä¸­å•æ€ç¼“å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†åˆè¿­ä»£å™¨&lt;/strong&gt;ï¼š&lt;code&gt;ArrayList.iterator()&lt;/code&gt;è¿”å›&lt;code&gt;Itr&lt;/code&gt;ç±»ï¼ŒJVMå¿«é€Ÿè½¬ä¸ºå•æ€å†…è”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–å¤±æ•ˆä¸è§„é¿ç­–ç•¥"&gt;âš ï¸ ä¼˜åŒ–å¤±æ•ˆä¸è§„é¿ç­–ç•¥
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¶…å¤šæ€é€€åŒ–&lt;/strong&gt;
å½“æ¥å£å®ç°ç±»è¶…è¿‡8ç§ï¼ˆå¦‚é€šç”¨æ—¥å¿—æ¥å£ï¼‰ï¼Œé€€åŒ–ä¸ºå®Œæ•´æŸ¥æ‰¾ã€‚
â€‹&lt;strong&gt;è§„é¿&lt;/strong&gt;â€‹ï¼šå¯¹é«˜é¢‘è°ƒç”¨æ¥å£ï¼Œé™åˆ¶å®ç°ç±»æ•°é‡æˆ–ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ç»Ÿä¸€å…¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†·æ–¹æ³•æœªå†…è”&lt;/strong&gt;
ä½é¢‘æ–¹æ³•ä¸è§¦å‘JITç¼–è¯‘ï¼Œæ— æ³•äº«å—å»è™šæ‹ŸåŒ–ä¼˜åŒ–ã€‚
â€‹&lt;strong&gt;è§„é¿&lt;/strong&gt;â€‹ï¼šé€šè¿‡&lt;code&gt;-XX:CompileThreshold&lt;/code&gt;é™ä½ç¼–è¯‘é˜ˆå€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç è†¨èƒ€&lt;/strong&gt;
å¤šæ€ç¼“å­˜ç”Ÿæˆå¤§é‡&lt;code&gt;if-else&lt;/code&gt;åˆ†æ”¯ï¼Œå¯èƒ½å¯¼è‡´CPUç¼“å­˜æœªå‘½ä¸­ã€‚
â€‹&lt;strong&gt;è§„é¿&lt;/strong&gt;â€‹ï¼šç›‘æ§&lt;code&gt;-XX:+PrintInlining&lt;/code&gt;è¾“å‡ºï¼Œé¿å…è¿‡åº¦å†…è”ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-13"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;JVMé€šè¿‡&lt;strong&gt;å†…è”ç¼“å­˜çŠ¶æ€æœº&lt;/strong&gt;ã€&lt;strong&gt;Itableç»“æ„å‹ç¼©&lt;/strong&gt;å’Œ&lt;strong&gt;åˆ†å±‚ç¼–è¯‘ç­–ç•¥&lt;/strong&gt;ä¸‰çº§ä¼˜åŒ–ï¼Œå°†æ¥å£æ–¹æ³•è°ƒç”¨å¼€é”€ä» &lt;strong&gt;O(n)&lt;/strong&gt; åŠ¨æ€é™è‡³æ¥è¿‘ &lt;strong&gt;O(1)&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å•æ€é«˜é¢‘è·¯å¾„&lt;/strong&gt;ï¼šå†…è”ç¼“å­˜+å»è™šæ‹ŸåŒ–+æ–¹æ³•å†…è” â†’ é€¼è¿‘é™æ€è°ƒç”¨æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ€è·¯å¾„&lt;/strong&gt;ï¼šçº§è”æ¡ä»¶åˆ¤æ–­æ›¿ä»£å“ˆå¸ŒæŸ¥æ‰¾ â†’ ä¸­ä½é¢‘åœºæ™¯æ€§èƒ½æå‡3x+ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…å¤šæ€å…œåº•&lt;/strong&gt;ï¼šé€€åŒ–å®Œæ•´æŸ¥æ‰¾ä½†é¿å…ä¼˜åŒ–å¼€é”€ â†’ ä¿éšœæç«¯åœºæ™¯æ­£ç¡®æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¼˜åŒ–æ•ˆæœå–å†³äº&lt;strong&gt;ç±»å‹åˆ†å¸ƒç¨³å®šæ€§&lt;/strong&gt;ï¼Œå»ºè®®é€šè¿‡&lt;code&gt;-XX:+PrintCompilation -XX:+PrintInlining&lt;/code&gt;ç›‘æ§ä¼˜åŒ–çŠ¶æ€ï¼Œç»“åˆArthasç­‰å·¥å…·åˆ†æå®é™…æ¥å£è°ƒç”¨åˆ†å¸ƒã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Javaã€‘ThreadLocal</title><link>https://dyhes.github.io/p/javathreadlocal/</link><pubDate>Sat, 21 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javathreadlocal/</guid><description>&lt;h2 id="threadlocal"&gt;ThreadLocal
&lt;/h2&gt;&lt;p&gt;ThreadLocal æ˜¯ Java å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„æ ¸å¿ƒç±»ï¼Œç”¨äºå®ç°&lt;strong&gt;çº¿ç¨‹çº§åˆ«çš„æ•°æ®éš”ç¦»&lt;/strong&gt;ï¼Œé€šè¿‡ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºå˜é‡çš„ç‹¬ç«‹å‰¯æœ¬ï¼Œé¿å…å…±äº«èµ„æºå¼•å‘çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€åº”ç”¨åœºæ™¯ã€æ½œåœ¨é£é™©åŠæœ€ä½³å®è·µå±•å¼€è¯¦ç»†è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸å®ç°æœºåˆ¶"&gt;ğŸ” æ ¸å¿ƒåŸç†ä¸å®ç°æœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å­˜å‚¨ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªçº¿ç¨‹ï¼ˆ&lt;code&gt;Thread&lt;/code&gt;å¯¹è±¡ï¼‰å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª &lt;code&gt;ThreadLocalMap&lt;/code&gt; å“ˆå¸Œè¡¨ï¼Œé”®ï¼ˆKeyï¼‰ä¸º &lt;code&gt;ThreadLocal&lt;/code&gt; å®ä¾‹ï¼Œå€¼ï¼ˆValueï¼‰æ˜¯è¯¥çº¿ç¨‹çš„å˜é‡å‰¯æœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ThreadLocal&lt;/code&gt; æœ¬èº«ä¸å­˜å‚¨æ•°æ®ï¼Œä»…ä½œä¸ºè®¿é—® &lt;code&gt;ThreadLocalMap&lt;/code&gt; çš„é”®ï¼ˆç±»ä¼¼ç´¢å¼•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±å¼•ç”¨ä¸å†…å­˜ç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ThreadLocalMap&lt;/code&gt; çš„é”®ï¼ˆå³ &lt;code&gt;ThreadLocal&lt;/code&gt; å®ä¾‹ï¼‰é€šè¿‡ &lt;strong&gt;å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰&lt;/strong&gt; æŒæœ‰ã€‚è‹¥ &lt;code&gt;ThreadLocal&lt;/code&gt;å¤–éƒ¨å¼ºå¼•ç”¨è¢«å›æ”¶ï¼ˆå¦‚ç½®ä¸º &lt;code&gt;null&lt;/code&gt;ï¼‰ï¼ŒGC ä¼šå›æ”¶é”®å¯¹è±¡ï¼Œä½†å€¼å¯¹è±¡ä»è¢«å¼ºå¼•ç”¨ä¿ç•™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜æ³„æ¼æ ¹æº&lt;/strong&gt;ï¼šçº¿ç¨‹ï¼ˆå°¤å…¶çº¿ç¨‹æ± ä¸­é•¿ç”Ÿå‘½å‘¨æœŸçº¿ç¨‹ï¼‰æœªè°ƒç”¨ &lt;code&gt;remove()&lt;/code&gt; æ—¶ï¼Œ&lt;code&gt;ThreadLocalMap&lt;/code&gt; ä¸­æ®‹ç•™çš„ &lt;code&gt;null&lt;/code&gt; é”®ä¼šæŒç»­å¼ºå¼•ç”¨å€¼å¯¹è±¡ï¼Œé˜»æ­¢ GC å›æ”¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®æ–¹æ³•&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;set(T value)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°†å€¼å­˜å‚¨åˆ°å½“å‰çº¿ç¨‹çš„ &lt;code&gt;ThreadLocalMap&lt;/code&gt; ä¸­ï¼Œé”®ä¸ºå½“å‰ &lt;code&gt;ThreadLocal&lt;/code&gt; å®ä¾‹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;get()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä»å½“å‰çº¿ç¨‹çš„ &lt;code&gt;ThreadLocalMap&lt;/code&gt; ä¸­è·å–å€¼ï¼›è‹¥æœªåˆå§‹åŒ–åˆ™è°ƒç”¨ &lt;code&gt;initialValue()&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;remove()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç§»é™¤å½“å‰çº¿ç¨‹ä¸­ä¸ &lt;code&gt;ThreadLocal&lt;/code&gt; å…³è”çš„å€¼ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;initialValue()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆå§‹åŒ–å€¼ï¼ˆé»˜è®¤è¿”å› &lt;code&gt;null&lt;/code&gt;ï¼‰ï¼Œå¯é€šè¿‡åŒ¿åå†…éƒ¨ç±»é‡å†™å®ç°è‡ªå®šä¹‰åˆå§‹å€¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;âš™ï¸ å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹ç‹¬äº«èµ„æºç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®åº“è¿æ¥ï¼šæ¯ä¸ªçº¿ç¨‹æŒæœ‰ç‹¬ç«‹è¿æ¥ï¼Œé¿å…å¹¶å‘å†²çªã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;private static ThreadLocal&amp;lt;Connection&amp;gt; connectionHolder = ThreadLocal.withInitial(() -&amp;gt; DriverManager.getConnection(DB_URL));
public static Connection getConnection() { return connectionHolder.get(); }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥æœŸæ ¼å¼åŒ–å·¥å…·&lt;/strong&gt;ï¼šè§£å†³ &lt;code&gt;SimpleDateFormat&lt;/code&gt; éçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ— éœ€åŠ é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€å˜é‡è·¨æ–¹æ³•ä¼ é€’&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ Web è¯·æ±‚ä¸­å­˜å‚¨ç”¨æˆ·ä¼šè¯ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ· IDã€æƒé™ï¼‰ï¼Œé¿å…åœ¨å¤šä¸ªæ–¹æ³•é—´æ˜¾å¼ä¼ é€’å‚æ•°ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;public class UserContext {
private static ThreadLocal&amp;lt;User&amp;gt; currentUser = new ThreadLocal&amp;lt;&amp;gt;();
public static void setUser(User user) { currentUser.set(user); }
public static User getUser() { return currentUser.get(); }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å°†äº‹åŠ¡ä¸Šä¸‹æ–‡ï¼ˆå¦‚æ•°æ®åº“äº‹åŠ¡çŠ¶æ€ï¼‰ç»‘å®šåˆ°å½“å‰çº¿ç¨‹ï¼Œç¡®ä¿åŒä¸€äº‹åŠ¡å†…å¤šä¸ªæ“ä½œä½¿ç”¨ç›¸åŒè¿æ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å­˜æ³„æ¼é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"&gt;âš ï¸ å†…å­˜æ³„æ¼é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ³„æ¼åŸå› &lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ± åœºæ™¯&lt;/strong&gt;ï¼šçº¿ç¨‹å¤ç”¨å¯¼è‡´æ—§ &lt;code&gt;ThreadLocal&lt;/code&gt; å€¼æ®‹ç•™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªæ¸…ç†æ¡ç›®&lt;/strong&gt;ï¼š&lt;code&gt;ThreadLocalMap&lt;/code&gt; ä¸­ &lt;code&gt;null&lt;/code&gt; é”®çš„å€¼å¯¹è±¡å› å¼ºå¼•ç”¨æ— æ³•å›æ”¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è§„é¿ç­–ç•¥&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¼ºåˆ¶è°ƒç”¨remove()ï¼š
ä½¿ç”¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try-finally
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¡®ä¿æ¸…ç†ï¼Œå°¤å…¶åœ¨æ± åŒ–çº¿ç¨‹ä¸­ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
threadLocal.set(data); // è®¾ç½®å€¼
// ...æ‰§è¡Œä¸šåŠ¡é€»è¾‘
} finally {
threadLocal.remove(); // å¿…é¡»æ¸…ç†ï¼
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **é¿å…å­˜å‚¨å¤§å¯¹è±¡**ï¼šå‡å°‘å› æ³„æ¼å¯¼è‡´çš„å†…å­˜å‹åŠ›ã€‚
------
### âš–ï¸ ä¸ `synchronized` çš„å¯¹æ¯”
| **ç»´åº¦** | **ThreadLocal** | **synchronized** |
| -------------- | ------------------------------ | -------------------------- |
| **è§£å†³æ€è·¯** | ç©ºé—´æ¢æ—¶é—´ï¼ˆæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹å‰¯æœ¬ï¼‰ | æ—¶é—´æ¢ç©ºé—´ï¼ˆå…±äº«èµ„æºåŠ é”ï¼‰ |
| **æ•°æ®éš”ç¦»æ€§** | çº¿ç¨‹é—´å®Œå…¨éš”ç¦» | éœ€æ’é˜Ÿè®¿é—®å…±äº«èµ„æº |
| **æ€§èƒ½å½±å“** | æ— é”ï¼Œé«˜æ•ˆ | é”ç«äº‰å¯èƒ½é™ä½å¹¶å‘æ€§èƒ½ |
| **é€‚ç”¨åœºæ™¯** | éœ€çº¿ç¨‹éš”ç¦»æ•°æ®çš„åœºæ™¯ | éœ€ä¸¥æ ¼åŒæ­¥å…±äº«èµ„æºçš„åœºæ™¯ |
------
### ğŸ’ æœ€ä½³å®è·µæ€»ç»“
1. **å£°æ˜ä¸º `static final`**ï¼š
é¿å…é‡å¤åˆ›å»º `ThreadLocal` å®ä¾‹ã€‚
2. **åˆå§‹å€¼é‡å†™**ï¼š
é€šè¿‡ `initialValue()` é¿å… `get()` ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚
3. **åŠ¡å¿…æ¸…ç†**ï¼š
ç»“åˆ `try-finally` æˆ–æ‹¦æˆªå™¨æœºåˆ¶è°ƒç”¨ `remove()`ã€‚
4. **é¿å…é•¿ç”Ÿå‘½å‘¨æœŸæ•°æ®**ï¼š
å°¤å…¶åœ¨çº¿ç¨‹æ± ä¸­ï¼ŒåŠæ—¶æ¸…ç†æ— ç”¨æ•°æ®ã€‚
&amp;gt; ğŸ’¡ **ThreadLocal çš„æ ¸å¿ƒä»·å€¼åœ¨äºå®ç°çº¿ç¨‹å®‰å…¨çš„æ•°æ®éš”ç¦»ï¼Œè€Œéæ›¿ä»£åŒæ­¥æœºåˆ¶ã€‚åˆç†ä½¿ç”¨å¯æå‡ä»£ç ç®€æ´æ€§ä¸å¹¶å‘æ€§èƒ½ï¼Œä½†éœ€ä¸¥æ ¼éµå¾ªæ¸…ç†è§„èŒƒä»¥é˜²å†…å­˜æ³„æ¼ã€‚**
## vs. æ™®é€šå˜é‡
ThreadLocalå˜é‡ä¸æ™®é€šå˜é‡ï¼ˆåŒ…æ‹¬çº¿ç¨‹å†…éƒ¨å®šä¹‰çš„æ™®é€šå˜é‡ï¼‰çš„æ ¸å¿ƒåŒºåˆ«åœ¨äº**å­˜å‚¨æœºåˆ¶ã€ä½œç”¨åŸŸå’Œæ•°æ®éš”ç¦»çº§åˆ«**ï¼Œè¿™ç›´æ¥å†³å®šäº†å®ƒä»¬åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„è¡Œä¸ºå’Œå®‰å…¨æ€§ã€‚ä¸‹é¢ä»äº”ä¸ªç»´åº¦è¯¦ç»†è§£æï¼š
------
### ğŸ§  å­˜å‚¨ä½ç½®ä¸ä½œç”¨åŸŸ
1. **ThreadLocalå˜é‡**
- **å­˜å‚¨ä½ç½®**ï¼šæ¯ä¸ªçº¿ç¨‹å†…éƒ¨çš„`ThreadLocalMap`ä¸­ï¼ŒKeyä¸ºThreadLocalå®ä¾‹ï¼ˆå¼±å¼•ç”¨ï¼‰ï¼ŒValueä¸ºçº¿ç¨‹ç§æœ‰æ•°æ®ã€‚
- **ä½œç”¨åŸŸ**ï¼šçº¿ç¨‹çº§åˆ«ï¼Œè·¨æ–¹æ³•å…±äº«ï¼ˆä¾‹å¦‚åœ¨Controllerã€Serviceã€Daoå±‚å‡å¯è®¿é—®åŒä¸€çº¿ç¨‹çš„ThreadLocalå€¼ï¼‰ã€‚
- ç¤ºä¾‹ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;private static final ThreadLocal&lt;User&gt; userHolder = ThreadLocal.withInitial(() -&amp;gt; new User());
// çº¿ç¨‹Aå’Œçº¿ç¨‹Bé€šè¿‡userHolder.get()è·å–å„è‡ªç‹¬ç«‹çš„Userå¯¹è±¡&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;2. **æ™®é€šå˜é‡**
- å±€éƒ¨å˜é‡
ï¼ˆæ–¹æ³•å†…å®šä¹‰ï¼‰ï¼š
- å­˜å‚¨ä½ç½®ï¼šçº¿ç¨‹æ ˆå¸§çš„å·¥ä½œå†…å­˜ä¸­ï¼Œéšæ–¹æ³•è°ƒç”¨ç»“æŸè€Œé”€æ¯ã€‚
- ä½œç”¨åŸŸï¼šæ–¹æ³•çº§åˆ«ï¼Œçº¿ç¨‹å®‰å…¨ï¼ˆæ¯ä¸ªçº¿ç¨‹æœ‰ç‹¬ç«‹æ ˆå¸§ï¼‰ã€‚
- ç¤ºä¾‹ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;public void run() {
int localVar = 10; // æ¯ä¸ªçº¿ç¨‹çš„run()æ–¹æ³•ä¸­æœ‰è‡ªå·±çš„localVarå‰¯æœ¬
}
```&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆå‘˜å˜é‡ï¼ˆçº¿ç¨‹ç±»å†…éƒ¨å®šä¹‰ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨ä½ç½®ï¼šå †å†…å­˜ä¸­ï¼Œè¢«æ‰€æœ‰çº¿ç¨‹å…±äº«ã€‚&lt;/li&gt;
&lt;li&gt;ä½œç”¨åŸŸï¼šå¯¹è±¡å®ä¾‹çº§åˆ«ï¼Œè‹¥å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€å¯¹è±¡å®ä¾‹ï¼Œåˆ™æˆå‘˜å˜é‡è¢«å…±äº«ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;class MyRunnable implements Runnable {
private int sharedVar; // è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«
public void run() { sharedVar++; } // éœ€åŠ é”ä¿è¯å®‰å…¨
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ”’ æ•°æ®éš”ç¦»æ€§å¯¹æ¯”
| **å˜é‡ç±»å‹** | **æ˜¯å¦çº¿ç¨‹éš”ç¦»** | **å…±äº«èŒƒå›´** | **çº¿ç¨‹å®‰å…¨æœºåˆ¶** |
| --------------- | ---------------- | -------------------------- | ---------------------------- |
| ThreadLocalå˜é‡ | âœ… å®Œå…¨éš”ç¦» | çº¿ç¨‹å†…è·¨æ–¹æ³•å…±äº« | å­˜å‚¨ç»“æ„éš”ç¦»ï¼ˆæ— éœ€é”ï¼‰ |
| æ™®é€šå±€éƒ¨å˜é‡ | âœ… å®Œå…¨éš”ç¦» | ä»…é™åŒä¸€æ–¹æ³•å†… | æ ˆå¸§éš”ç¦»ï¼ˆè‡ªåŠ¨é”€æ¯ï¼‰ |
| æ™®é€šæˆå‘˜å˜é‡ | âŒ ä¸éš”ç¦» | åŒä¸€å¯¹è±¡å®ä¾‹çš„æ‰€æœ‰çº¿ç¨‹å…±äº« | éœ€åŒæ­¥æœºåˆ¶ï¼ˆå¦‚synchronizedï¼‰ |
&amp;gt; **å…³é”®åŒºåˆ«**ï¼š
&amp;gt;
&amp;gt; - ThreadLocalå®ç°çš„æ˜¯**çº¿ç¨‹çº§å…¨å±€å˜é‡**ï¼ˆçº¿ç¨‹å†…ä»»ä½•æ–¹æ³•å¯è®¿é—®ï¼‰ï¼Œè€Œå±€éƒ¨å˜é‡ä»…é™äº**æ–¹æ³•å†…éƒ¨**ã€‚
&amp;gt; - çº¿ç¨‹å†…éƒ¨å®šä¹‰çš„æˆå‘˜å˜é‡ï¼ˆå¦‚`Runnable`çš„æˆå‘˜ï¼‰**ä¸ç‹¬äº«**ï¼Œä¼šè¢«æ‰€æœ‰ä½¿ç”¨åŒä¸€`Runnable`å®ä¾‹çš„çº¿ç¨‹å…±äº«ã€‚
------
### âš™ï¸ å®ç°åŸç†å·®å¼‚
1. **ThreadLocalçš„éš”ç¦»æœºåˆ¶**
- æ¯ä¸ª`Thread`æŒæœ‰`ThreadLocalMap`ï¼Œé€šè¿‡ThreadLocalå¯¹è±¡çš„å“ˆå¸Œå€¼å®šä½æ•°æ®ï¼ˆKeyä¸ºå¼±å¼•ç”¨ï¼ŒValueä¸ºå¼ºå¼•ç”¨ï¼‰ã€‚
- åŒä¸€ThreadLocalå¯¹è±¡åœ¨ä¸åŒçº¿ç¨‹ä¸­é€šè¿‡ä¸åŒMapå­˜å‚¨ï¼Œå®ç°éš”ç¦»ï¼ˆè§ä¸‹å›¾ï¼‰ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt; çº¿ç¨‹Aï¼šThreadLocalMap â†’ Entry(ThreadLocalAå¼±å¼•ç”¨, ValueA)
çº¿ç¨‹Bï¼šThreadLocalMap â†’ Entry(ThreadLocalAå¼±å¼•ç”¨, ValueB)
```
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;æ™®é€šæˆå‘˜å˜é‡çš„å…±äº«æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æˆå‘˜å˜é‡å­˜å‚¨åœ¨å †ä¸­ï¼Œçº¿ç¨‹é€šè¿‡å¯¹è±¡å¼•ç”¨è®¿é—®ã€‚è‹¥å¤šä¸ªçº¿ç¨‹æŒæœ‰åŒä¸€å¯¹è±¡å¼•ç”¨ï¼Œåˆ™ç›´æ¥æ“ä½œå…±äº«å†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-threadlocalçš„å†…å­˜æ³„æ¼é£é™©"&gt;âš ï¸ ThreadLocalçš„å†…å­˜æ³„æ¼é£é™©
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;ï¼š
ThreadLocalMapçš„Keyï¼ˆThreadLocalï¼‰æ˜¯å¼±å¼•ç”¨ï¼ŒValueæ˜¯å¼ºå¼•ç”¨ã€‚è‹¥ThreadLocalæœªè¢«å¼ºå¼•ç”¨ä¸”æœªè°ƒç”¨&lt;code&gt;remove()&lt;/code&gt;ï¼ŒGCä¼šå›æ”¶Keyï¼Œå¯¼è‡´Entryå˜ä¸º&lt;code&gt;(null, Value)&lt;/code&gt;ï¼Œè€ŒValueå› çº¿ç¨‹å­˜æ´»æ— æ³•å›æ”¶ï¼ˆå°¤å…¶çº¿ç¨‹æ± ä¸­ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
ä½¿ç”¨åå¿…é¡»è°ƒç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;remove()
&lt;/code&gt;&lt;/pre&gt;æ¸…ç†ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
userHolder.set(currentUser); // è®¾ç½®å€¼
// ... ä¸šåŠ¡é€»è¾‘
} finally {
userHolder.remove(); // å¼ºåˆ¶æ¸…ç†
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯å¯¹æ¯”"&gt;ğŸ› ï¸ é€‚ç”¨åœºæ™¯å¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ThreadLocal&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ™®é€šå±€éƒ¨å˜é‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ™®é€šæˆå‘˜å˜é‡&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;çº¿ç¨‹å†…è·¨æ–¹æ³•å…±äº«æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ä¼šè¯ï¼‰&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ–¹æ³•å†…éƒ¨ä¸´æ—¶è®¡ç®—&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;çº¿ç¨‹å®‰å…¨å·¥å…·ç±»ï¼ˆå¦‚SimpleDateFormatï¼‰&lt;/td&gt;
&lt;td&gt;âœ…&lt;/td&gt;
&lt;td&gt;âŒï¼ˆéœ€æ¯æ¬¡åˆ›å»ºï¼‰&lt;/td&gt;
&lt;td&gt;âŒï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤šçº¿ç¨‹å…±äº«å¯¹è±¡çŠ¶æ€&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;âœ…ï¼ˆéœ€åŒæ­¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ThreadLocalå…¸å‹ç”¨ä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ›¿æ¢éçº¿ç¨‹å®‰å…¨çš„ SimpleDateFormatï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;private static final ThreadLocal&amp;lt;DateFormat&amp;gt; dateFormatHolder =
ThreadLocal.withInitial(() -&amp;gt; new SimpleDateFormat(&amp;#34;yyyy-MM-dd&amp;#34;));
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Springçš„&lt;code&gt;RequestContextHolder&lt;/code&gt;ã€äº‹åŠ¡ç®¡ç†å™¨ï¼ˆè·¨å±‚ä¼ é€’è¯·æ±‚ä¸Šä¸‹æ–‡ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ThreadLocalå˜é‡&lt;/strong&gt;ï¼šå®ç°çº¿ç¨‹çº§æ•°æ®éš”ç¦»ï¼Œè·¨æ–¹æ³•å…±äº«ï¼Œéœ€æ‰‹åŠ¨æ¸…ç†é˜²æ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™®é€šå±€éƒ¨å˜é‡&lt;/strong&gt;ï¼šå¤©ç„¶çº¿ç¨‹å®‰å…¨ï¼Œä½†ä½œç”¨åŸŸä»…é™äºæ–¹æ³•å†…éƒ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™®é€šæˆå‘˜å˜é‡&lt;/strong&gt;ï¼š&lt;strong&gt;éçº¿ç¨‹ç‹¬æœ‰&lt;/strong&gt;ï¼Œè‹¥è¢«å¤šçº¿ç¨‹å…±äº«éœ€åŠ é”åŒæ­¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;è‹¥éœ€è¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å®ç°&lt;strong&gt;è·¨æ–¹æ³•çš„æ•°æ®ç‹¬äº«&lt;/strong&gt;ï¼ŒThreadLocalæ˜¯å”¯ä¸€é€‰æ‹©ï¼›è‹¥ä»…éœ€æ–¹æ³•å†…ä¸´æ—¶å˜é‡ï¼Œä¼˜å…ˆç”¨å±€éƒ¨å˜é‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å¼±å¼•ç”¨é”®"&gt;å¼±å¼•ç”¨é”®
&lt;/h2&gt;&lt;p&gt;ThreadLocalMapçš„é”®ï¼ˆKeyï¼‰è®¾è®¡ä¸ºå¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰ï¼Œæ˜¯Javaä¸ºè§£å†³ç‰¹å®šå†…å­˜æ³„æ¼é—®é¢˜è€Œé‡‡å–çš„å…³é”®è®¾è®¡ç­–ç•¥ã€‚ä»¥ä¸‹ä»åŸå› ã€æœºåˆ¶ã€å±€é™æ€§å’Œå®è·µå»ºè®®å››ä¸ªç»´åº¦è¯¦ç»†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸå› é¿å…threadlocalå¯¹è±¡çš„å†…å­˜æ³„æ¼"&gt;ğŸ” æ ¸å¿ƒåŸå› ï¼šé¿å…ThreadLocalå¯¹è±¡çš„å†…å­˜æ³„æ¼
&lt;/h3&gt;&lt;h4 id="å¼ºå¼•ç”¨å¯¼è‡´çš„å†…å­˜æ³„æ¼é—®é¢˜"&gt;&lt;strong&gt;å¼ºå¼•ç”¨å¯¼è‡´çš„å†…å­˜æ³„æ¼é—®é¢˜&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è‹¥ThreadLocalMapçš„é”®ä½¿ç”¨å¼ºå¼•ç”¨ï¼Œå³ä½¿å¼€å‘è€…å°†&lt;code&gt;ThreadLocal&lt;/code&gt;å®ä¾‹ç½®ä¸º&lt;code&gt;null&lt;/code&gt;ï¼ˆç§»é™¤å¤–éƒ¨å¼ºå¼•ç”¨ï¼‰ï¼Œçº¿ç¨‹å†…éƒ¨çš„ThreadLocalMapä»ä¼š&lt;strong&gt;å¼ºæŒæœ‰è¯¥å¯¹è±¡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åæœ&lt;/strong&gt;ï¼šThreadLocalå¯¹è±¡å› è¢«å¼ºå¼•ç”¨è€Œæ— æ³•è¢«åƒåœ¾å›æ”¶ï¼ˆGCï¼‰ï¼Œå¯¼è‡´å…¶é•¿æœŸå ç”¨å†…å­˜ï¼Œç›´åˆ°çº¿ç¨‹é”€æ¯ï¼ˆçº¿ç¨‹æ± åœºæ™¯ä¸‹çº¿ç¨‹å¯èƒ½æ°¸ä¸é”€æ¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹åœºæ™¯ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ThreadLocal&amp;lt;String&amp;gt; tl = new ThreadLocal&amp;lt;&amp;gt;();
tl.set(&amp;#34;data&amp;#34;);
tl = null; // å¤–éƒ¨å¼ºå¼•ç”¨è§£é™¤ï¼Œä½†ThreadLocalMapä»æŒæœ‰å¼ºå¼•ç”¨ â†’ æ— æ³•å›æ”¶ï¼
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼±å¼•ç”¨çš„è§£å†³æ–¹æ¡ˆ"&gt;&lt;strong&gt;å¼±å¼•ç”¨çš„è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å¼±å¼•ç”¨ç‰¹æ€§ï¼šå½“&lt;strong&gt;ä»…å‰©å¼±å¼•ç”¨&lt;/strong&gt;æŒ‡å‘å¯¹è±¡æ—¶ï¼ŒGCä¼šç«‹å³å›æ”¶è¯¥å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ä½œç”¨&lt;/strong&gt;ï¼š
å°†é”®è®¾ä¸ºå¼±å¼•ç”¨åï¼Œä¸€æ—¦å¤–éƒ¨å¼ºå¼•ç”¨æ¶ˆå¤±ï¼ˆå¦‚&lt;code&gt;tl = null&lt;/code&gt;ï¼‰ï¼ŒGCä¼šå›æ”¶ThreadLocalå¯¹è±¡ï¼Œæ­¤æ—¶ThreadLocalMapä¸­çš„é”®è‡ªåŠ¨å˜ä¸º&lt;code&gt;null&lt;/code&gt;ã€‚è¿™é¿å…äº†ThreadLocalå¯¹è±¡æœ¬èº«çš„å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è¿ä½œæœºåˆ¶å¼±å¼•ç”¨ä¸ä¸»åŠ¨æ¸…ç†çš„ååŒ"&gt;âš™ï¸ è¿ä½œæœºåˆ¶ï¼šå¼±å¼•ç”¨ä¸ä¸»åŠ¨æ¸…ç†çš„ååŒ
&lt;/h3&gt;&lt;h4 id="é”®å€¼å›æ”¶æµç¨‹"&gt;&lt;strong&gt;é”®å€¼å›æ”¶æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[ThreadLocalå¼ºå¼•ç”¨ç½®null] --&amp;gt; B(GCå›æ”¶ThreadLocalå¯¹è±¡)
B --&amp;gt; C{ThreadLocalMapé”®å˜ä¸ºnull}
C --&amp;gt; D[è°ƒç”¨set/get/removeæ—¶è§¦å‘æ¸…ç†]
D --&amp;gt; E[åˆ é™¤é”®ä¸ºnullçš„Entryå¹¶é‡Šæ”¾Value]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="threadlocalmapçš„ä¸»åŠ¨æ¸…ç†"&gt;&lt;strong&gt;ThreadLocalMapçš„ä¸»åŠ¨æ¸…ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¸…ç†æ—¶æœº&lt;/strong&gt;ï¼šåœ¨è°ƒç”¨&lt;code&gt;set()&lt;/code&gt;ã€&lt;code&gt;get()&lt;/code&gt;ã€&lt;code&gt;remove()&lt;/code&gt;æ–¹æ³•æ—¶ï¼Œä¼šè§¦å‘å†…éƒ¨æ¸…ç†é€»è¾‘ï¼ˆå¦‚&lt;code&gt;expungeStaleEntry()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…ç†é€»è¾‘&lt;/strong&gt;ï¼šæ‰«æEntryæ•°ç»„ï¼Œåˆ é™¤é”®ä¸º&lt;code&gt;null&lt;/code&gt;çš„æ¡ç›®ï¼Œé‡Šæ”¾å…¶å…³è”çš„Valueï¼ˆå¼ºå¼•ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»£ç ç®€åŒ–é€»è¾‘ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;void set(ThreadLocal&amp;lt;?&amp;gt; key, Object value) {
// æ’å…¥æ–°Entry
cleanSomeSlots(); // æ¸…ç†æ— æ•ˆEntryï¼ˆkey=nullï¼‰
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å±€é™æ€§å¼±å¼•ç”¨æ— æ³•å®Œå…¨é¿å…å†…å­˜æ³„æ¼"&gt;âš ï¸ å±€é™æ€§ï¼šå¼±å¼•ç”¨æ— æ³•å®Œå…¨é¿å…å†…å­˜æ³„æ¼
&lt;/h3&gt;&lt;h4 id="valueæ³„æ¼é£é™©"&gt;&lt;strong&gt;Valueæ³„æ¼é£é™©&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜æœ¬è´¨&lt;/strong&gt;ï¼š
é”®è¢«å›æ”¶åï¼ŒValueä»æ˜¯&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;ã€‚è‹¥çº¿ç¨‹é•¿æœŸè¿è¡Œï¼ˆå¦‚çº¿ç¨‹æ± ï¼‰ä¸”æœªè§¦å‘æ¸…ç†æ–¹æ³•ï¼ˆå¦‚æœªè°ƒç”¨&lt;code&gt;get()&lt;/code&gt;/&lt;code&gt;set()&lt;/code&gt;ï¼‰ï¼ŒValueä¼šæŒç»­å ç”¨å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;æ³„æ¼åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ± ä¸­å¤ç”¨çº¿ç¨‹ï¼Œæ—§ä»»åŠ¡çš„Valueæœªè¢«æ¸…ç†ã€‚&lt;/li&gt;
&lt;li&gt;å­˜å‚¨å¤§å¯¹è±¡ï¼ˆå¦‚10MBå­—èŠ‚æ•°ç»„ï¼‰ï¼Œç´¯ç§¯åå¯¼è‡´å†…å­˜æº¢å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼±å¼•ç”¨çš„å‰¯ä½œç”¨"&gt;&lt;strong&gt;å¼±å¼•ç”¨çš„å‰¯ä½œç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é”®å¯èƒ½è¢«&lt;strong&gt;æå‰å›æ”¶&lt;/strong&gt;ï¼Œå¯¼è‡´åç»­&lt;code&gt;get()&lt;/code&gt;è¿”å›&lt;code&gt;null&lt;/code&gt;ï¼ˆå¼€å‘è€…è¯¯ä»¥ä¸ºæ•°æ®ä¸¢å¤±ï¼Œå®ä¸ºå¼±å¼•ç”¨è¢«GCï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®è·µå»ºè®®è§„é¿æ³„æ¼çš„æœ€ä½³å®è·µ"&gt;ğŸ› ï¸ å®è·µå»ºè®®ï¼šè§„é¿æ³„æ¼çš„æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;h4 id="å¼ºåˆ¶è°ƒç”¨"&gt;&lt;strong&gt;å¼ºåˆ¶è°ƒç”¨&lt;code&gt;remove()&lt;/code&gt;æ¸…ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;try-finally
&lt;/code&gt;&lt;/pre&gt;ç¡®ä¿æ¸…ç†ï¼Œå°¤å…¶åœ¨çº¿ç¨‹æ± ä¸­ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
threadLocal.set(data);
// ...æ‰§è¡Œä¸šåŠ¡é€»è¾‘
} finally {
threadLocal.remove(); // å¿…é¡»æ¸…ç†ï¼
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…¶ä»–å…³é”®æªæ–½"&gt;&lt;strong&gt;å…¶ä»–å…³é”®æªæ–½&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å£°æ˜ä¸º&lt;code&gt;static final&lt;/code&gt;&lt;/strong&gt;ï¼š
é¿å…é‡å¤åˆ›å»ºThreadLocalå®ä¾‹ï¼Œå‡å°‘Entryæ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å­˜å‚¨å¤§å¯¹è±¡&lt;/strong&gt;ï¼š
è‹¥éœ€å­˜å‚¨ï¼Œç¡®ä¿ç”Ÿå‘½å‘¨æœŸå¯æ§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥å…·è¾…åŠ©æ£€æµ‹&lt;/strong&gt;ï¼š
ä½¿ç”¨å†…å­˜åˆ†æå·¥å…·ï¼ˆå¦‚MATï¼‰æ£€æŸ¥ThreadLocalMapä¸­æ®‹ç•™çš„Valueã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼ºå¼•ç”¨-vs-å¼±å¼•ç”¨è®¾è®¡å¯¹æ¯”"&gt;&lt;strong&gt;å¼ºå¼•ç”¨ vs å¼±å¼•ç”¨è®¾è®¡å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è®¾è®¡ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ThreadLocalå›æ”¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Valueå›æ”¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å†…å­˜æ³„æ¼é£é™©&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å¼ºå¼•ç”¨é”®&lt;/td&gt;
&lt;td&gt;âŒ æ— æ³•å›æ”¶&lt;/td&gt;
&lt;td&gt;âŒ æ— æ³•å›æ”¶&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆKey+Valueæ³„æ¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¼±å¼•ç”¨é”®&lt;/td&gt;
&lt;td&gt;âœ… å¯å›æ”¶&lt;/td&gt;
&lt;td&gt;âš ï¸ éœ€æ‰‹åŠ¨æ¸…ç†&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆä»…Valueæ³„æ¼ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼±å¼•ç”¨è®¾è®¡ç›®æ ‡&lt;/strong&gt;ï¼šé€šè¿‡å…è®¸GCå›æ”¶æ— ç”¨çš„ThreadLocalå¯¹è±¡ï¼Œ&lt;strong&gt;è§£å†³Keyå¯¼è‡´çš„å†…å­˜æ³„æ¼&lt;/strong&gt;ï¼Œæ˜¯å¹³è¡¡è‡ªåŠ¨å›æ”¶ä¸æ€§èƒ½çš„æŠ˜ä¸­æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼€å‘è€…è´£ä»»&lt;/strong&gt;ï¼šå¼±å¼•ç”¨&lt;strong&gt;æ— æ³•è§£å†³Valueæ³„æ¼&lt;/strong&gt;ï¼Œå¿…é¡»é€šè¿‡&lt;code&gt;remove()&lt;/code&gt;ä¸»åŠ¨æ¸…ç†æˆ–ä¾èµ–å†…éƒ¨æ¸…ç†æœºåˆ¶è§¦å‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬è´¨ç†è§£&lt;/strong&gt;ï¼šå¼±å¼•ç”¨æ˜¯â€œ&lt;strong&gt;æ­¢æŸæœºåˆ¶&lt;/strong&gt;â€â€”â€”å³ä½¿å¼€å‘è€…å¿˜è®°ç®¡ç†ThreadLocalå¯¹è±¡ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿèƒ½é¿å…æœ€ä¸¥é‡çš„å†…å­˜æ³„æ¼ï¼Œä½†Valueçš„æ¸…ç†ä»éœ€å¼€å‘è€…è´Ÿè´£ã€‚&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Javaã€‘Thread</title><link>https://dyhes.github.io/p/javathread/</link><pubDate>Fri, 20 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javathread/</guid><description>&lt;h2 id="thread-ç±»"&gt;Thread ç±»
&lt;/h2&gt;&lt;p&gt;Javaä¸­çš„&lt;code&gt;Thread&lt;/code&gt;ç±»æ˜¯&lt;code&gt;java.lang&lt;/code&gt;åŒ…çš„æ ¸å¿ƒç±»ï¼Œç”¨äºå®ç°å¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œå…è®¸ç¨‹åºå¹¶å‘æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæå‡æ€§èƒ½å’Œèµ„æºåˆ©ç”¨ç‡ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒæ¦‚å¿µä¸ç”¨æ³•çš„ç³»ç»Ÿæ¢³ç†ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-çº¿ç¨‹çš„åˆ›å»ºæ–¹å¼"&gt;âš™ï¸ çº¿ç¨‹çš„åˆ›å»ºæ–¹å¼
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç»§æ‰¿Threadç±»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªå®šä¹‰ç±»ç»§æ‰¿&lt;code&gt;Thread&lt;/code&gt;ï¼Œé‡å†™&lt;code&gt;run()&lt;/code&gt;å®šä¹‰ä»»åŠ¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyThread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;extends&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Thread running&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// å¯åŠ¨çº¿ç¨‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyThread&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨start()è§¦å‘run()æ‰§è¡Œ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°Runnableæ¥å£&lt;/strong&gt;ï¼ˆ&lt;strong&gt;æ›´æ¨è&lt;/strong&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;å®ç°&lt;code&gt;Runnable&lt;/code&gt;æ¥å£ï¼Œå°†ä»»åŠ¡å¯¹è±¡ä¼ å…¥&lt;code&gt;Thread&lt;/code&gt;æ„é€ å™¨ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼šé¿å…å•ç»§æ‰¿é™åˆ¶ï¼Œä»»åŠ¡ä¸çº¿ç¨‹è§£è€¦ã€‚
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyRunnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Runnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Task executed&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyRunnable&lt;/span&gt;&lt;span class="p"&gt;()).&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-threadç±»çš„æ ¸å¿ƒæ–¹æ³•"&gt;ğŸ”§ Threadç±»çš„æ ¸å¿ƒæ–¹æ³•
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;start()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯åŠ¨çº¿ç¨‹ï¼ŒJVMè‡ªåŠ¨è°ƒç”¨&lt;code&gt;run()&lt;/code&gt;ï¼Œ&lt;strong&gt;ä»…èƒ½è°ƒç”¨ä¸€æ¬¡&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;run()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹ä»»åŠ¡é€»è¾‘å…¥å£ï¼Œéœ€é‡å†™æˆ–é€šè¿‡&lt;code&gt;Runnable&lt;/code&gt;ä¼ å…¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;sleep(long millis)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æš‚åœå½“å‰çº¿ç¨‹æŒ‡å®šæ¯«ç§’ï¼Œ&lt;strong&gt;ä¸é‡Šæ”¾é”&lt;/strong&gt;ï¼Œéœ€å¤„ç†&lt;code&gt;InterruptedException&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;join()&lt;/code&gt; / &lt;code&gt;join(millis)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢ï¼ˆæˆ–è¶…æ—¶ï¼‰ï¼Œç”¨äºçº¿ç¨‹åŒæ­¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;interrupt()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸­æ–­çº¿ç¨‹ï¼ˆè®¾ç½®æ ‡å¿—ä½ï¼‰ï¼Œéœ€åœ¨&lt;code&gt;run()&lt;/code&gt;ä¸­æ£€æŸ¥&lt;code&gt;isInterrupted()&lt;/code&gt;å“åº”ä¸­æ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;yield()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æç¤ºè°ƒåº¦å™¨è®©å‡ºCPUï¼Œä½†ä¸ä¿è¯ç«‹å³åˆ‡æ¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;setDaemon(true)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼ˆJVMåœ¨æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶é€€å‡ºï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-çº¿ç¨‹å±æ€§ä¸çŠ¶æ€"&gt;ğŸ“Œ çº¿ç¨‹å±æ€§ä¸çŠ¶æ€
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®å±æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ID&lt;/strong&gt;ï¼šå”¯ä¸€æ ‡è¯†ï¼ˆ&lt;code&gt;getId()&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åç§°&lt;/strong&gt;ï¼šè°ƒè¯•ç”¨ï¼ˆ&lt;code&gt;getName()&lt;/code&gt;/&lt;code&gt;setName()&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆçº§&lt;/strong&gt;ï¼š1~10ï¼ˆé»˜è®¤5ï¼‰ï¼Œé«˜ä¼˜å…ˆçº§ä»…å¢åŠ è°ƒåº¦æ¦‚ç‡ï¼Œä¸ä¿è¯ä¼˜å…ˆ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜¯å¦å­˜æ´»&lt;/strong&gt;ï¼š&lt;code&gt;isAlive()&lt;/code&gt;æ£€æµ‹&lt;code&gt;run()&lt;/code&gt;æ˜¯å¦ç»“æŸ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹çŠ¶æ€ï¼ˆ&lt;code&gt;getState()&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;NEW&lt;/strong&gt;ï¼šåˆ›å»ºæœªå¯åŠ¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RUNNABLE&lt;/strong&gt;ï¼šå¯è¿è¡Œï¼ˆåŒ…æ‹¬å°±ç»ªå’Œè¿è¡Œä¸­ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BLOCKED&lt;/strong&gt;ï¼šç­‰å¾…é”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;WAITING&lt;/strong&gt;ï¼šæ— é™æœŸç­‰å¾…ï¼ˆå¦‚&lt;code&gt;join()&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TIMED_WAITING&lt;/strong&gt;ï¼šè¶…æ—¶ç­‰å¾…ï¼ˆå¦‚&lt;code&gt;sleep()&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TERMINATED&lt;/strong&gt;ï¼šæ‰§è¡Œå®Œæ¯•&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜çº§ç‰¹æ€§ä¸æ³¨æ„äº‹é¡¹"&gt;âš ï¸ é«˜çº§ç‰¹æ€§ä¸æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹ä¸­æ–­æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡&lt;code&gt;interrupt()&lt;/code&gt;è®¾ç½®ä¸­æ–­æ ‡å¿—ï¼Œçº¿ç¨‹éœ€åœ¨&lt;code&gt;run()&lt;/code&gt;ä¸­æ£€æŸ¥&lt;code&gt;isInterrupted()&lt;/code&gt;å¹¶é€€å‡ºå¾ªç¯æˆ–æ•è·&lt;code&gt;InterruptedException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;currentThread&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;isInterrupted&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ‰§è¡Œä»»åŠ¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹åŒæ­¥&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¤šçº¿ç¨‹è®¿é—®å…±äº«èµ„æºéœ€ä½¿ç”¨&lt;code&gt;synchronized&lt;/code&gt;å…³é”®å­—æˆ–&lt;code&gt;Lock&lt;/code&gt;æ¥å£ï¼Œé¿å…ç«æ€æ¡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å±€éƒ¨å˜é‡ï¼ˆThreadLocalï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºç‹¬ç«‹å˜é‡å‰¯æœ¬ï¼Œé¿å…å…±äº«å†²çªï¼ˆå¦‚æ•°æ®åº“è¿æ¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºé‡Šæ”¾&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹ç»ˆæ­¢åï¼Œå…¶å ç”¨çš„å†…å­˜èµ„æºï¼ˆå¦‚å †æ ˆï¼‰ç”±JVMè‡ªåŠ¨å›æ”¶ï¼Œä½†éœ€ç¡®ä¿æ— èµ„æºæ³„æ¼ï¼ˆå¦‚æœªå…³é—­çš„æ–‡ä»¶æµï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®è·µå»ºè®®"&gt;ğŸ’ å®è·µå»ºè®®
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆé€‰æ‹©&lt;code&gt;Runnable&lt;/code&gt;æ¥å£&lt;/strong&gt;ï¼šæå‡ä»£ç çµæ´»æ€§ï¼Œç¬¦åˆç»„åˆä¼˜äºç»§æ‰¿åŸåˆ™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ç›´æ¥è°ƒç”¨&lt;code&gt;run()&lt;/code&gt;&lt;/strong&gt;ï¼šå¦åˆ™å˜ä¸ºæ™®é€šæ–¹æ³•è°ƒç”¨ï¼Œå¤±å»å¹¶å‘æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ˆæŠ¤çº¿ç¨‹æ…ç”¨&lt;/strong&gt;ï¼šç”¨äºè¾…åŠ©ä»»åŠ¡ï¼ˆå¦‚å¿ƒè·³æ£€æµ‹ï¼‰ï¼Œé¿å…å½±å“JVMé€€å‡ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸­æ–­ä¼˜äºå¼ºåˆ¶ç»ˆæ­¢&lt;/strong&gt;ï¼šå¼ƒç”¨&lt;code&gt;suspend()&lt;/code&gt;/&lt;code&gt;resume()&lt;/code&gt;/&lt;code&gt;stop()&lt;/code&gt;ï¼ˆæ˜“å¯¼è‡´æ­»é”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“"&gt;æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Javaçš„&lt;code&gt;Thread&lt;/code&gt;ç±»æ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹çš„åŸºçŸ³ï¼Œé€šè¿‡&lt;code&gt;start()&lt;/code&gt;ã€çŠ¶æ€ç®¡ç†ã€åŒæ­¥æœºåˆ¶ç­‰å®ç°å¹¶å‘æ§åˆ¶ã€‚æ·±å…¥ç†è§£å…¶ç”Ÿå‘½å‘¨æœŸã€ä¸­æ–­æœºåˆ¶åŠåŒæ­¥ç­–ç•¥ï¼Œæ˜¯æ„å»ºé«˜æ•ˆå®‰å…¨å¹¶å‘åº”ç”¨çš„å…³é”®ã€‚å®è·µä¸­åº”ç»“åˆ&lt;code&gt;Runnable&lt;/code&gt;ã€çº¿ç¨‹æ± ï¼ˆå¦‚&lt;code&gt;ExecutorService&lt;/code&gt;ï¼‰ç­‰é«˜çº§å·¥å…·æå‡å¯ç»´æŠ¤æ€§ã€‚&lt;/p&gt;
&lt;h2 id="thread-ç±»é»˜è®¤å®ç°"&gt;&lt;code&gt;Thread&lt;/code&gt; ç±»é»˜è®¤å®ç°
&lt;/h2&gt;&lt;p&gt;Javaä¸­çš„&lt;code&gt;Thread&lt;/code&gt;ç±»é»˜è®¤å®ç°åŒ…å«å¤šä¸ªå…³é”®è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºåœ¨æœªæ˜¾å¼é‡å†™æˆ–æŒ‡å®šæ—¶è‡ªåŠ¨ç”Ÿæ•ˆã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒé»˜è®¤å®ç°çš„ç³»ç»Ÿæ¢³ç†ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-é»˜è®¤æ„é€ æ–¹æ³•"&gt;âš™ï¸ &lt;strong&gt;é»˜è®¤æ„é€ æ–¹æ³•ï¼š&lt;code&gt;Thread()&lt;/code&gt;&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹åç§°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤ç”Ÿæˆæ ¼å¼ä¸º&lt;code&gt;&amp;quot;Thread-&amp;quot; + è‡ªå¢æ•°å­—&lt;/code&gt;ï¼ˆå¦‚&lt;code&gt;Thread-0&lt;/code&gt;ã€&lt;code&gt;Thread-1&lt;/code&gt;ï¼‰ï¼Œé€šè¿‡é™æ€è®¡æ•°å™¨&lt;code&gt;nextThreadNum()&lt;/code&gt;å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;å¯é€šè¿‡&lt;code&gt;Thread.currentThread().getName()&lt;/code&gt;è·å–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡é€»è¾‘ï¼ˆrunæ–¹æ³•ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤&lt;code&gt;run()&lt;/code&gt;æ–¹æ³•&lt;strong&gt;ä¸æ‰§è¡Œä»»ä½•æ“ä½œ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æœªä¼ å…¥&lt;code&gt;Runnable&lt;/code&gt;ä»»åŠ¡å¯¹è±¡æˆ–æœªé‡å†™&lt;code&gt;run()&lt;/code&gt;ï¼Œè°ƒç”¨&lt;code&gt;start()&lt;/code&gt;åçº¿ç¨‹ä¼šå¯åŠ¨ä½†æ— å®é™…é€»è¾‘æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;æºç å®ç°ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// targetä¸ºä¼ å…¥çš„Runnableå¯¹è±¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;run&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-çº¿ç¨‹ç»„threadgroup"&gt;ğŸ§© &lt;strong&gt;çº¿ç¨‹ç»„ï¼ˆThreadGroupï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;é»˜è®¤åˆ†é…è§„åˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥æœªæ˜¾å¼æŒ‡å®šçº¿ç¨‹ç»„ï¼Œæ–°çº¿ç¨‹ä¼š&lt;strong&gt;ç»§æ‰¿çˆ¶çº¿ç¨‹çš„çº¿ç¨‹ç»„&lt;/strong&gt;ï¼ˆå¦‚ä¸»çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹ï¼Œå…¶çº¿ç¨‹ç»„ä¸ä¸»çº¿ç¨‹ç›¸åŒï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;code&gt;ThreadGroup parentGroup = parent.getThreadGroup()&lt;/code&gt;å®ç°ï¼ˆ&lt;code&gt;parent&lt;/code&gt;ä¸ºåˆ›å»ºè¯¥çº¿ç¨‹çš„å½“å‰çº¿ç¨‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;ï¼šçº¿ç¨‹ç»„ä¸ºç©ºæ—¶ï¼Œä¼šé€šè¿‡&lt;code&gt;SecurityManager&lt;/code&gt;æ£€æŸ¥æƒé™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-çº¿ç¨‹åç§°ç”Ÿæˆæœºåˆ¶"&gt;ğŸ“› &lt;strong&gt;çº¿ç¨‹åç§°ç”Ÿæˆæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;è‡ªå¢è§„åˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;é™æ€å˜é‡&lt;code&gt;threadInitNumber&lt;/code&gt;è®°å½•å…¨å±€çº¿ç¨‹æ•°é‡ï¼Œæ¯æ¬¡æ„é€ æ–°çº¿ç¨‹æ—¶è‡ªå¢ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// çº¿ç¨‹åï¼šThread-0&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// çº¿ç¨‹åï¼šThread-1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®ˆæŠ¤çŠ¶æ€ä¸ä¼˜å…ˆçº§ç»§æ‰¿"&gt;âš–ï¸ &lt;strong&gt;å®ˆæŠ¤çŠ¶æ€ä¸ä¼˜å…ˆçº§ç»§æ‰¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemonï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤&lt;strong&gt;éå®ˆæŠ¤çº¿ç¨‹&lt;/strong&gt;ï¼ˆ&lt;code&gt;daemon = false&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ˆæŠ¤çº¿ç¨‹éœ€æ˜¾å¼è°ƒç”¨&lt;code&gt;setDaemon(true)&lt;/code&gt;ï¼Œä¸”å¿…é¡»åœ¨&lt;code&gt;start()&lt;/code&gt;å‰è®¾ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆçº§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤ç»§æ‰¿&lt;strong&gt;çˆ¶çº¿ç¨‹ä¼˜å…ˆçº§&lt;/strong&gt;ï¼ˆé€šå¸¸ä¸»çº¿ç¨‹ä¸º&lt;code&gt;NORM_PRIORITY=5&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯é€šè¿‡&lt;code&gt;setPriority()&lt;/code&gt;è°ƒæ•´ï¼ˆ1~10ï¼‰ï¼Œä½†ä¼˜å…ˆçº§ä»…ä½œè°ƒåº¦å™¨å‚è€ƒï¼Œä¸ä¿è¯æ‰§è¡Œé¡ºåºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-çº¿ç¨‹æ ˆå¤§å°stacksize"&gt;ğŸ” &lt;strong&gt;çº¿ç¨‹æ ˆå¤§å°ï¼ˆstackSizeï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;é»˜è®¤å€¼ä¸º&lt;code&gt;0&lt;/code&gt;ï¼Œè¡¨ç¤ºç”±JVMè‡ªåŠ¨åˆ†é…æ ˆå¤§å°ï¼ˆé€šå¸¸å–å†³äºæ“ä½œç³»ç»Ÿå’ŒJVMå‚æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯é€šè¿‡æ„é€ æ–¹æ³•&lt;code&gt;Thread(ThreadGroup, Runnable, String, long)&lt;/code&gt;æ˜¾å¼æŒ‡å®šæ ˆå¤§å°ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰ï¼Œä½†å¹³å°å…¼å®¹æ€§è¾ƒå·®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é»˜è®¤å®ç°çš„å®è·µæ„ä¹‰ä¸é£é™©"&gt;âš ï¸ &lt;strong&gt;é»˜è®¤å®ç°çš„å®è·µæ„ä¹‰ä¸é£é™©&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¸¸è§è¯¯åŒº&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç›´æ¥è°ƒç”¨&lt;code&gt;run()&lt;/code&gt;è€Œé&lt;code&gt;start()&lt;/code&gt;ï¼šå¯¼è‡´ä»»åŠ¡åœ¨å½“å‰çº¿ç¨‹åŒæ­¥æ‰§è¡Œï¼Œå¤±å»å¤šçº¿ç¨‹æ„ä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;æœªé‡å†™&lt;code&gt;run()&lt;/code&gt;æˆ–ä¼ å…¥&lt;code&gt;Runnable&lt;/code&gt;ï¼šçº¿ç¨‹å¯åŠ¨åæ— æ“ä½œï¼Œæ˜“è¢«å¿½ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡æ„å›¾&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦ä»»åŠ¡ä¸çº¿ç¨‹&lt;/strong&gt;ï¼šé»˜è®¤&lt;code&gt;run()&lt;/code&gt;ç•™ç©ºï¼Œå¼ºåˆ¶å¼€å‘è€…é€šè¿‡&lt;code&gt;Runnable&lt;/code&gt;æˆ–é‡å†™æ–¹å¼æ˜ç¡®ä»»åŠ¡é€»è¾‘ï¼Œç¬¦åˆç»„åˆä¼˜äºç»§æ‰¿åŸåˆ™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨ç»§æ‰¿&lt;/strong&gt;ï¼šçº¿ç¨‹ç»„ã€ä¼˜å…ˆçº§ç­‰å±æ€§çš„è‡ªåŠ¨ç»§æ‰¿ï¼Œå‡å°‘é‡å¤é…ç½®ï¼Œç¡®ä¿çº¿ç¨‹ç¯å¢ƒä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Threadç±»çš„é»˜è®¤å®ç°èšç„¦äº&lt;strong&gt;åŸºç¡€æ¡†æ¶æ­å»º&lt;/strong&gt;ä¸&lt;strong&gt;å®‰å…¨çº¦æŸ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡&lt;strong&gt;ç©ºrun()æ–¹æ³•&lt;/strong&gt;å¼ºåˆ¶ä»»åŠ¡æ˜¾å¼å®šä¹‰ï¼Œé¿å…éšå¼è¡Œä¸ºï¼›&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;strong&gt;åç§°è‡ªå¢ã€çº¿ç¨‹ç»„ç»§æ‰¿&lt;/strong&gt;ç­‰æœºåˆ¶å‡å°‘é…ç½®æˆæœ¬ï¼›&lt;/li&gt;
&lt;li&gt;ä¾èµ–&lt;strong&gt;çˆ¶çº¿ç¨‹å±æ€§&lt;/strong&gt;ï¼ˆä¼˜å…ˆçº§ã€å®ˆæŠ¤çŠ¶æ€ï¼‰ç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§ã€‚
â€‹&lt;strong&gt;å¼€å‘è€…éœ€ä¸»åŠ¨æ³¨å…¥ä»»åŠ¡é€»è¾‘&lt;/strong&gt;â€‹ï¼ˆ&lt;code&gt;Runnable&lt;/code&gt;æˆ–é‡å†™&lt;code&gt;run()&lt;/code&gt;ï¼‰å¹¶ç†è§£é»˜è®¤è¡Œä¸ºï¼Œæ‰èƒ½æœ‰æ•ˆåˆ©ç”¨å¤šçº¿ç¨‹èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="run"&gt;run()
&lt;/h2&gt;&lt;p&gt;æºç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;run&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="runnable"&gt;Runnable
&lt;/h2&gt;&lt;p&gt;Thread ç±»å®ç° &lt;code&gt;Runnable&lt;/code&gt; æ¥å£æ˜¯ Java å¤šçº¿ç¨‹è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ï¼Œå…¶èƒŒåè•´å«äº†èŒè´£åˆ†ç¦»ã€çµæ´»æ€§å’Œæ¡†æ¶å…¼å®¹æ€§ç­‰å¤šé‡è€ƒé‡ã€‚ä»¥ä¸‹ä»è®¾è®¡å“²å­¦ã€æŠ€æœ¯å®ç°å’Œå®é™…åº”ç”¨ä¸‰ä¸ªç»´åº¦è¯¦ç»†è§£æåŸå› ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡å“²å­¦èŒè´£åˆ†ç¦»ä¸ç»„åˆä¼˜äºç»§æ‰¿"&gt;ğŸ”§ &lt;strong&gt;è®¾è®¡å“²å­¦ï¼šèŒè´£åˆ†ç¦»ä¸ç»„åˆä¼˜äºç»§æ‰¿&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç»Ÿä¸€ä»»åŠ¡æ‰§è¡Œæ ‡å‡†&lt;/strong&gt;
&lt;code&gt;Runnable&lt;/code&gt; æ¥å£å®šä¹‰äº†çº¿ç¨‹ä»»åŠ¡çš„å”¯ä¸€æ–¹æ³• &lt;code&gt;run()&lt;/code&gt;ï¼Œè€Œ &lt;code&gt;Thread&lt;/code&gt; ä½œä¸ºçº¿ç¨‹çš„è½½ä½“ï¼Œé€šè¿‡å®ç° &lt;code&gt;Runnable&lt;/code&gt; æ¥å£ï¼Œè‡ªèº«ä¹Ÿæˆä¸ºä¸€ä¸ªå¯æ‰§è¡Œçš„ä»»åŠ¡ã€‚è¿™ç§è®¾è®¡ä½¿å¾—ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡ä¸çº¿ç¨‹è§£è€¦&lt;/strong&gt;ï¼š&lt;code&gt;Runnable&lt;/code&gt; ä»…æè¿°ä»»åŠ¡é€»è¾‘ï¼Œ&lt;code&gt;Thread&lt;/code&gt; è´Ÿè´£çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦å’Œç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»ç»„åˆ&lt;/strong&gt;ï¼šç”¨æˆ·å¯é€šè¿‡ç»§æ‰¿ &lt;code&gt;Thread&lt;/code&gt; é‡å†™ &lt;code&gt;run()&lt;/code&gt;ï¼ˆè‡ªèº«å³ä»»åŠ¡ï¼‰ï¼Œæˆ–å‘ &lt;code&gt;Thread&lt;/code&gt; ä¼ å…¥å¤–éƒ¨ &lt;code&gt;Runnable&lt;/code&gt; å¯¹è±¡ï¼ˆå§”æ‰˜æ‰§è¡Œä»»åŠ¡ï¼‰ï¼Œå®ç°ä»»åŠ¡é€»è¾‘çš„å¤šæ ·åŒ–å°è£…&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§„é¿å•ç»§æ‰¿é™åˆ¶&lt;/strong&gt;
Java ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œè‹¥ &lt;code&gt;Thread&lt;/code&gt; æœªå®ç° &lt;code&gt;Runnable&lt;/code&gt;ï¼Œåˆ™é€šè¿‡ç»§æ‰¿ &lt;code&gt;Thread&lt;/code&gt; å®šä¹‰ä»»åŠ¡çš„æ–¹å¼ä¼šæ°¸ä¹…å ç”¨ç±»çš„ç»§æ‰¿æƒã€‚è€Œå®ç° &lt;code&gt;Runnable&lt;/code&gt; æ¥å£åï¼š
&lt;ul&gt;
&lt;li&gt;å¼€å‘è€…å¯é€‰æ‹©æ›´çµæ´»çš„ &lt;strong&gt;ç»„åˆæ¨¡å¼&lt;/strong&gt;ï¼ˆä¼ å…¥ &lt;code&gt;Runnable&lt;/code&gt; ä»»åŠ¡ï¼‰ï¼Œé¿å…å› ç»§æ‰¿ &lt;code&gt;Thread&lt;/code&gt; å¯¼è‡´æ— æ³•ç»§æ‰¿å…¶ä»–ä¸šåŠ¡ç±»çš„é—®é¢˜&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æŠ€æœ¯å®ç°å§”æ‰˜æœºåˆ¶ä¸é»˜è®¤é€»è¾‘"&gt;âš™ï¸ &lt;strong&gt;æŠ€æœ¯å®ç°ï¼šå§”æ‰˜æœºåˆ¶ä¸é»˜è®¤é€»è¾‘&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æºç ä¸­çš„å§”æ‰˜æ¨¡å¼&lt;/strong&gt;
åœ¨ &lt;code&gt;Thread&lt;/code&gt; ç±»çš„æºç ä¸­ï¼Œé€šè¿‡ &lt;code&gt;target&lt;/code&gt; å­—æ®µæ”¯æŒå¤–éƒ¨ä»»åŠ¡ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public class Thread implements Runnable {
private Runnable target; // å­˜å‚¨å¤–éƒ¨ä»»åŠ¡
@Override
public void run() {
if (target != null) {
target.run(); // å§”æ‰˜æ‰§è¡Œå¤–éƒ¨ä»»åŠ¡
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤è¡Œä¸º&lt;/strong&gt;ï¼šç›´æ¥ç»§æ‰¿ &lt;code&gt;Thread&lt;/code&gt; æ—¶ï¼Œéœ€é‡å†™ &lt;code&gt;run()&lt;/code&gt; æ–¹æ³•ï¼ˆè¦†ç›–é»˜è®¤é€»è¾‘ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤–éƒ¨ä»»åŠ¡&lt;/strong&gt;ï¼šé€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥ &lt;code&gt;Runnable&lt;/code&gt; å¯¹è±¡æ—¶ï¼Œ&lt;code&gt;Thread.run()&lt;/code&gt; ä¼šè°ƒç”¨å…¶ &lt;code&gt;target.run()&lt;/code&gt;&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¯æŒä¸¤ç§ä»»åŠ¡å®šä¹‰æ–¹å¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹å¼1ï¼ˆç»§æ‰¿ Threadï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;class MyThread extends Thread {
@Override public void run() { /* è‡ªå®šä¹‰é€»è¾‘ */ }
}
new MyThread().start();
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;æ–¹å¼2ï¼ˆç»„åˆ Runnableï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;class MyTask implements Runnable {
@Override public void run() { /* è‡ªå®šä¹‰é€»è¾‘ */ }
}
new Thread(new MyTask()).start();
&lt;/code&gt;&lt;/pre&gt;ä¸¤ç§æ–¹å¼æœ€ç»ˆå‡é€šè¿‡ &lt;code&gt;Thread.run()&lt;/code&gt; ç»Ÿä¸€æ‰§è¡Œï¼Œä½“ç°äº†æ¥å£çš„é€‚é…æ€§&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åº”ç”¨çµæ´»æ€§ä¸ç”Ÿæ€å…¼å®¹"&gt;ğŸš€ &lt;strong&gt;å®é™…åº”ç”¨ï¼šçµæ´»æ€§ä¸ç”Ÿæ€å…¼å®¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡å¤ç”¨ä¸çº¿ç¨‹æ± é›†æˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºå…±äº«&lt;/strong&gt;ï¼šåŒä¸€ä¸ª &lt;code&gt;Runnable&lt;/code&gt; ä»»åŠ¡å¯è¢«å¤šä¸ª &lt;code&gt;Thread&lt;/code&gt; å®ä¾‹æ‰§è¡Œï¼ˆå¦‚çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡é˜Ÿåˆ—ï¼‰ï¼Œé¿å…é‡å¤åˆ›å»ºä»»åŠ¡å¯¹è±¡&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹æ± å…¼å®¹ï¼šJava å¹¶å‘æ¡†æ¶ï¼ˆå¦‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; ExecutorService
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt; ï¼‰ç›´æ¥æ¥å—
&lt;/code&gt;&lt;/pre&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; Runnable
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä»»åŠ¡ï¼Œä¸&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; Thread
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è§£è€¦ï¼š
&lt;code&gt;ExecutorService pool = Executors.newFixedThreadPool(2); pool.submit(() -&amp;gt; System.out.println(&amp;quot;Runnableä»»åŠ¡&amp;quot;)); // æ— éœ€ç»‘å®šThreadå®ä¾‹&lt;/code&gt;
2. &lt;strong&gt;å‡½æ•°å¼ç¼–ç¨‹æ”¯æŒ&lt;/strong&gt;
&lt;code&gt;Runnable&lt;/code&gt; æ˜¯å‡½æ•°å¼æ¥å£ï¼ˆä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼‰ï¼Œå¯ç›´æ¥ç”¨ Lambda è¡¨è¾¾å¼ç®€åŒ–ä»£ç ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;new Thread(() -&amp;gt; System.out.println(&amp;#34;Lambdaä»»åŠ¡&amp;#34;)).start();
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è‹¥ &lt;code&gt;Thread&lt;/code&gt; æœªå®ç° &lt;code&gt;Runnable&lt;/code&gt;ï¼Œæ­¤å†™æ³•å°†æ— æ³•æˆç«‹&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚
3. &lt;strong&gt;æ¡†æ¶è®¾è®¡çš„æ‰©å±•æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Callable/Future å…¼å®¹&lt;/strong&gt;ï¼š&lt;code&gt;Callable&lt;/code&gt; ä½œä¸º &lt;code&gt;Runnable&lt;/code&gt; çš„å¢å¼ºç‰ˆï¼ˆæ”¯æŒè¿”å›å€¼ï¼‰ï¼Œé€šè¿‡ &lt;code&gt;FutureTask&lt;/code&gt; é€‚é… &lt;code&gt;Runnable&lt;/code&gt; æ¥å£ï¼Œæœ€ç»ˆä»ç”± &lt;code&gt;Thread&lt;/code&gt; æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è™šæ‹Ÿçº¿ç¨‹æ”¯æŒ&lt;/strong&gt;ï¼šJava 21 çš„è™šæ‹Ÿçº¿ç¨‹ï¼ˆ&lt;code&gt;Thread.startVirtualThread()&lt;/code&gt;ï¼‰ç›´æ¥æ¥å— &lt;code&gt;Runnable&lt;/code&gt; ä»»åŠ¡ï¼Œå»¶ç»­äº†ç»Ÿä¸€çš„ä»»åŠ¡æŠ½è±¡&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç»§æ‰¿thread-vs-å®ç°runnableçš„å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ç»§æ‰¿Thread vs å®ç°Runnableçš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç»§æ‰¿ Thread&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ç° Runnable&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡å®šä¹‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡å†™ &lt;code&gt;run()&lt;/code&gt;ï¼Œä»»åŠ¡ä¸çº¿ç¨‹ç»‘å®š&lt;/td&gt;
&lt;td&gt;å®ç° &lt;code&gt;run()&lt;/code&gt;ï¼Œä»»åŠ¡å¯ç‹¬ç«‹äºçº¿ç¨‹å­˜åœ¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»§æ‰¿çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å ç”¨ç»§æ‰¿æƒï¼Œæ— æ³•ç»§æ‰¿å…¶ä»–ç±»&lt;/td&gt;
&lt;td&gt;å¯ç»§æ‰¿å…¶ä»–ç±»ï¼Œæ— é™åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡å¤ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªçº¿ç¨‹å®ä¾‹åªèƒ½æ‰§è¡Œè‡ªèº«ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;åŒä¸€ä»»åŠ¡å¯è¢«å¤šä¸ªçº¿ç¨‹æ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‡½æ•°å¼æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ Lambda&lt;/td&gt;
&lt;td&gt;æ”¯æŒ Lambda è¡¨è¾¾å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹æ± å…¼å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€åŒ…è£…æˆ &lt;code&gt;Runnable&lt;/code&gt; æäº¤&lt;/td&gt;
&lt;td&gt;ç›´æ¥æäº¤ä»»åŠ¡å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;è®¾è®¡å¯ç¤º&lt;/strong&gt;ï¼š&lt;code&gt;Thread&lt;/code&gt; å®ç° &lt;code&gt;Runnable&lt;/code&gt; æœ¬è´¨æ˜¯ &lt;strong&gt;â€œè‡ªèº«å³ä»»åŠ¡â€&lt;/strong&gt; ä¸ &lt;strong&gt;â€œå§”æ‰˜å¤–éƒ¨ä»»åŠ¡â€&lt;/strong&gt; çš„è¾©è¯ç»Ÿä¸€ï¼Œæ—¢ä¿ç•™äº†ä¼ ç»Ÿç”¨æ³•ï¼Œåˆä¸ºç°ä»£å¹¶å‘æ¡†æ¶é“ºå¹³é“è·¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Thread å®ç° &lt;code&gt;Runnable&lt;/code&gt; æ¥å£çš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç»Ÿä¸€æ€§&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;run()&lt;/code&gt; æ–¹æ³•ç»Ÿä¸€æ‰€æœ‰çº¿ç¨‹ä»»åŠ¡çš„æ‰§è¡Œå…¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦æ€§&lt;/strong&gt;ï¼šåˆ†ç¦»çº¿ç¨‹æ§åˆ¶ï¼ˆ&lt;code&gt;Thread&lt;/code&gt;ï¼‰ä¸ä»»åŠ¡é€»è¾‘ï¼ˆ&lt;code&gt;Runnable&lt;/code&gt;ï¼‰ï¼Œæ”¯æŒç»„åˆä¼˜äºç»§æ‰¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;ï¼šä¸ºçº¿ç¨‹æ± ã€å‡½æ•°å¼ç¼–ç¨‹ã€è™šæ‹Ÿçº¿ç¨‹ç­‰é«˜çº§ç‰¹æ€§æä¾›åº•å±‚å…¼å®¹ã€‚
è¿™ä¸€è®¾è®¡æ˜¯ Java å¹¶å‘æ¨¡å‹çš„åŸºçŸ³ï¼Œæ·±åˆ»ä½“ç°äº† &lt;strong&gt;â€œç®€å•æ€§ä¸åº”ç‰ºç‰²çµæ´»æ€§â€&lt;/strong&gt; çš„å·¥ç¨‹å“²å­¦&lt;a class="link" href="@ref" &gt;1,5,7&lt;/a&gt;ã€‚å®é™…å¼€å‘ä¸­ï¼Œ&lt;strong&gt;ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;Runnable&lt;/code&gt;&lt;/strong&gt;ï¼ˆæˆ– &lt;code&gt;Callable&lt;/code&gt;ï¼‰é…åˆçº¿ç¨‹æ± ï¼Œå·²æˆä¸ºç°ä»£ Java å¹¶å‘çš„é»„é‡‘å®è·µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="join"&gt;Join()
&lt;/h2&gt;&lt;p&gt;åœ¨Javaä¸­ï¼Œ&lt;code&gt;Thread.join()&lt;/code&gt;æ–¹æ³•ç­‰å¾…çš„&lt;strong&gt;ä¸æ˜¯æ˜¾å¼çš„ä¿¡å·é‡æˆ–äº‹ä»¶&lt;/strong&gt;ï¼Œè€Œæ˜¯&lt;strong&gt;ç›®æ ‡çº¿ç¨‹ç»ˆæ­¢ï¼ˆå³çº¿ç¨‹æ‰§è¡Œç»“æŸï¼‰çš„çŠ¶æ€å˜åŒ–&lt;/strong&gt;ã€‚å…¶åº•å±‚å®ç°ä¾èµ–äºJVMå†…éƒ¨çš„çº¿ç¨‹çŠ¶æ€ç®¡ç†ä¸åŒæ­¥æœºåˆ¶ï¼Œå…·ä½“åŸç†å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç­‰å¾…çš„ç›®æ ‡çº¿ç¨‹ç»ˆæ­¢çŠ¶æ€"&gt;âš™ï¸ &lt;strong&gt;ç­‰å¾…çš„ç›®æ ‡ï¼šçº¿ç¨‹ç»ˆæ­¢çŠ¶æ€&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;join()&lt;/code&gt;çš„æ ¸å¿ƒä½œç”¨æ˜¯&lt;strong&gt;é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°ç›®æ ‡çº¿ç¨‹ï¼ˆè°ƒç”¨&lt;code&gt;join&lt;/code&gt;æ–¹æ³•çš„çº¿ç¨‹å®ä¾‹ï¼‰ç»“æŸè¿è¡Œ&lt;/strong&gt;ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cm"&gt;/* ä»»åŠ¡é€»è¾‘ */&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;join&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å½“å‰çº¿ç¨‹åœ¨æ­¤é˜»å¡ï¼Œç›´åˆ°tçº¿ç¨‹æ‰§è¡Œå®Œæ¯•&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œç­‰å¾…çš„â€œä¿¡å·â€å®è´¨æ˜¯&lt;strong&gt;ç›®æ ‡çº¿ç¨‹ä»&lt;code&gt;RUNNABLE&lt;/code&gt;çŠ¶æ€è½¬å˜ä¸º&lt;code&gt;TERMINATED&lt;/code&gt;çŠ¶æ€&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°åŸºäºé”ä¸ç­‰å¾…é˜Ÿåˆ—"&gt;ğŸ”§ &lt;strong&gt;åº•å±‚å®ç°ï¼šåŸºäºé”ä¸ç­‰å¾…é˜Ÿåˆ—&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;join()&lt;/code&gt;çš„é˜»å¡å’Œå”¤é†’ä¾èµ–Javaçš„&lt;strong&gt;å¯¹è±¡ç›‘è§†å™¨é”ï¼ˆMonitorï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;&lt;code&gt;wait/notify&lt;/code&gt;æœºåˆ¶&lt;/strong&gt;ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;h4 id="1é˜»å¡å½“å‰çº¿ç¨‹"&gt;&lt;strong&gt;ï¼ˆ1ï¼‰é˜»å¡å½“å‰çº¿ç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å½“è°ƒç”¨&lt;code&gt;t.join()&lt;/code&gt;æ—¶ï¼Œå½“å‰çº¿ç¨‹ï¼ˆå¦‚ä¸»çº¿ç¨‹ï¼‰ä¼š&lt;strong&gt;è·å–ç›®æ ‡çº¿ç¨‹å¯¹è±¡&lt;code&gt;t&lt;/code&gt;çš„é”&lt;/strong&gt;ï¼ˆ&lt;code&gt;synchronized&lt;/code&gt;ä¿®é¥°çš„æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨é”å†…éƒ¨ï¼Œé€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;while (t.isAlive())
&lt;/code&gt;&lt;/pre&gt;å¾ªç¯æ£€æŸ¥ç›®æ ‡çº¿ç¨‹æ˜¯å¦å­˜æ´»ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥ç›®æ ‡çº¿ç¨‹å­˜æ´»ï¼Œåˆ™è°ƒç”¨&lt;code&gt;t.wait(0)&lt;/code&gt;ï¼Œ&lt;strong&gt;é‡Šæ”¾é”å¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€&lt;/strong&gt;ï¼ˆWAITINGæˆ–TIMED_WAITINGï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2å”¤é†’æœºåˆ¶"&gt;&lt;strong&gt;ï¼ˆ2ï¼‰å”¤é†’æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å½“ç›®æ ‡çº¿ç¨‹&lt;code&gt;t&lt;/code&gt;æ‰§è¡Œå®Œæ¯•ï¼ˆè¿›å…¥&lt;code&gt;TERMINATED&lt;/code&gt;çŠ¶æ€ï¼‰æ—¶ï¼Œ&lt;strong&gt;JVMåœ¨åº•å±‚è‡ªåŠ¨è°ƒç”¨&lt;code&gt;notifyAll()&lt;/code&gt;&lt;/strong&gt;ï¼Œå”¤é†’æ‰€æœ‰åœ¨&lt;code&gt;t&lt;/code&gt;å¯¹è±¡ä¸Šç­‰å¾…çš„çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;è¿™ä¸€è¿‡ç¨‹åœ¨JVMæºç ä¸­ç”±
&lt;pre tabindex="0"&gt;&lt;code&gt;ensure_join()
&lt;/code&gt;&lt;/pre&gt;å‡½æ•°è§¦å‘ï¼ˆå‚è€ƒHotSpotçš„
&lt;pre tabindex="0"&gt;&lt;code&gt;thread.cpp
&lt;/code&gt;&lt;/pre&gt;ï¼‰ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;JavaThread&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ensure_join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å”¤é†’ç­‰å¾…è¯¥çº¿ç¨‹ç»“æŸçš„çº¿ç¨‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;ensure_join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;JavaThread&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;notify_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨notifyAllå”¤é†’ç­‰å¾…è€…&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šå¼€å‘è€…æ— éœ€æ‰‹åŠ¨è°ƒç”¨&lt;code&gt;notify()&lt;/code&gt;ï¼ŒJVMåœ¨&lt;strong&gt;çº¿ç¨‹ç»“æŸæ—¶è‡ªåŠ¨å¤„ç†å”¤é†’é€»è¾‘&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸­æ–­å¤„ç†"&gt;âš ï¸ &lt;strong&gt;ä¸­æ–­å¤„ç†&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è‹¥ç­‰å¾…è¿‡ç¨‹ä¸­å½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼ˆè°ƒç”¨&lt;code&gt;interrupt()&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;join()&lt;/code&gt;ä¼šæŠ›å‡º&lt;code&gt;InterruptedException&lt;/code&gt;ï¼Œå¹¶&lt;strong&gt;æ¸…é™¤ä¸­æ–­æ ‡å¿—ä½&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶éœ€æ•è·å¼‚å¸¸å¹¶å¤„ç†ä¸­æ–­ï¼ˆå¦‚é€€å‡ºä»»åŠ¡æˆ–é‡ç½®çŠ¶æ€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;join&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;InterruptedException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å¤„ç†ä¸­æ–­ï¼šæ¢å¤æ ‡å¿—ä½æˆ–ç»ˆæ­¢ä»»åŠ¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;currentThread&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;interrupt&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id="-è¶…æ—¶æ§åˆ¶"&gt;ğŸ”„ &lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;join(long millis)&lt;/code&gt;å…è®¸è®¾ç½®æœ€å¤§ç­‰å¾…æ—¶é—´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥è¶…æ—¶åç›®æ ‡çº¿ç¨‹ä»æœªç»“æŸï¼Œå½“å‰çº¿ç¨‹ä¼š&lt;strong&gt;è‡ªåŠ¨å”¤é†’å¹¶ç»§ç»­æ‰§è¡Œ&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;å®ç°é€šè¿‡&lt;code&gt;wait(delay)&lt;/code&gt;å¾ªç¯æ£€æŸ¥æ—¶é—´ï¼Œé¿å…æ°¸ä¹…é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ç­‰å¾…çš„ä¿¡å·æ˜¯ä»€ä¹ˆ"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šç­‰å¾…çš„â€œä¿¡å·â€æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰©ç†å±‚é¢&lt;/strong&gt;ï¼šçº¿ç¨‹å¯¹è±¡&lt;code&gt;t&lt;/code&gt;çš„é”çŠ¶æ€å˜åŒ–ï¼ˆ&lt;code&gt;wait()&lt;/code&gt; â†’ &lt;code&gt;notifyAll()&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€»è¾‘å±‚é¢&lt;/strong&gt;ï¼šç›®æ ‡çº¿ç¨‹ä»å­˜æ´»ï¼ˆ&lt;code&gt;isAlive() == true&lt;/code&gt;ï¼‰åˆ°ç»ˆæ­¢ï¼ˆ&lt;code&gt;TERMINATED&lt;/code&gt;ï¼‰çš„çŠ¶æ€åˆ‡æ¢ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ–¹&lt;/strong&gt;ï¼šJVMåœ¨ç›®æ ‡çº¿ç¨‹ç»“æŸæ—¶è‡ªåŠ¨è§¦å‘å”¤é†’æ“ä½œï¼Œæ— éœ€å¼€å‘è€…å¹²é¢„ã€‚
é€šè¿‡è¿™ä¸€æœºåˆ¶ï¼Œ&lt;code&gt;join()&lt;/code&gt;å®ç°äº†çº¿ç¨‹é—´çš„&lt;strong&gt;é¡ºåºæ§åˆ¶&lt;/strong&gt;ï¼Œå¸¸ç”¨äºä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹å®Œæˆåå†è¿›è¡Œç»“æœæ±‡æ€»æˆ–èµ„æºå›æ”¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="interrupt--yield"&gt;Interrupt() &amp;amp; yield()
&lt;/h2&gt;&lt;p&gt;åœ¨Javaä¸­ï¼Œ&lt;code&gt;interrupt()&lt;/code&gt;å’Œ&lt;code&gt;yield()&lt;/code&gt;æ–¹æ³•çš„è°ƒç”¨èŒƒå›´å’Œè¡Œä¸ºæœ‰æ˜¾è‘—åŒºåˆ«ï¼Œå…·ä½“åˆ†æå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-interrupt"&gt;âš™ï¸ &lt;strong&gt;&lt;code&gt;interrupt()&lt;/code&gt;æ–¹æ³•çš„è°ƒç”¨èŒƒå›´&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å†…è°ƒç”¨&lt;/strong&gt;ï¼š
çº¿ç¨‹å¯ä»¥åœ¨è‡ªèº«å†…éƒ¨è°ƒç”¨&lt;code&gt;interrupt()&lt;/code&gt;ï¼Œä¾‹å¦‚åœ¨&lt;code&gt;run()&lt;/code&gt;æ–¹æ³•ä¸­é€šè¿‡&lt;code&gt;Thread.currentThread().interrupt()&lt;/code&gt;ä¸­æ–­è‡ªå·±ã€‚è¿™ç§æ–¹å¼é€šå¸¸ç”¨äºåœ¨æ•è·&lt;code&gt;InterruptedException&lt;/code&gt;åé‡æ–°è®¾ç½®ä¸­æ–­æ ‡å¿—ï¼ˆä¾‹å¦‚åœ¨&lt;code&gt;catch&lt;/code&gt;å—ä¸­ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹å¤–è°ƒç”¨ï¼šå…è®¸åœ¨å…¶ä»–çº¿ç¨‹ä¸­è°ƒç”¨ç›®æ ‡çº¿ç¨‹çš„
&lt;pre tabindex="0"&gt;&lt;code&gt;interrupt()
&lt;/code&gt;&lt;/pre&gt;æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸»çº¿ç¨‹å¯ä»¥é€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;thread.interrupt()
&lt;/code&gt;&lt;/pre&gt;ä¸­æ–­å­çº¿ç¨‹ã€‚ä½†éœ€æ³¨æ„ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥ç›®æ ‡çº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œä»…è®¾ç½®ä¸­æ–­æ ‡å¿—ä½ï¼Œéœ€çº¿ç¨‹å†…éƒ¨ä¸»åŠ¨æ£€æŸ¥ï¼ˆå¦‚&lt;code&gt;isInterrupted()&lt;/code&gt;ï¼‰æ‰èƒ½å“åº”ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ç›®æ ‡çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼ˆå¦‚&lt;code&gt;sleep()&lt;/code&gt;ã€&lt;code&gt;wait()&lt;/code&gt;ã€&lt;code&gt;join()&lt;/code&gt;ï¼‰ï¼Œä¼šç«‹å³æŠ›å‡º&lt;code&gt;InterruptedException&lt;/code&gt;å¹¶æ¸…é™¤ä¸­æ–­æ ‡å¿—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™è¦æ±‚&lt;/strong&gt;ï¼šè°ƒç”¨æ–¹éœ€æŒæœ‰ç›®æ ‡çº¿ç¨‹å¯¹è±¡çš„å¼•ç”¨ï¼Œä¸”è‹¥è·¨çº¿ç¨‹è°ƒç”¨éœ€é€šè¿‡å®‰å…¨æƒé™æ£€æŸ¥ï¼ˆå¦åˆ™æŠ›å‡º&lt;code&gt;SecurityException&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-yield"&gt;â³ &lt;strong&gt;&lt;code&gt;yield()&lt;/code&gt;æ–¹æ³•çš„è°ƒç”¨èŒƒå›´&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å†…è°ƒç”¨&lt;/strong&gt;ï¼š
&lt;code&gt;yield()&lt;/code&gt;æ˜¯é™æ€æ–¹æ³•ï¼Œâ€‹&lt;strong&gt;åªèƒ½åœ¨å½“å‰è¿è¡Œçº¿ç¨‹å†…éƒ¨è°ƒç”¨&lt;/strong&gt;â€‹ï¼ˆå¦‚&lt;code&gt;Thread.yield()&lt;/code&gt;ï¼‰ã€‚å®ƒçš„ä½œç”¨æ˜¯æç¤ºè°ƒåº¦å™¨è®©å‡ºå½“å‰çº¿ç¨‹çš„CPUä½¿ç”¨æƒï¼Œä½¿å½“å‰çº¿ç¨‹ä»è¿è¡ŒçŠ¶æ€ï¼ˆRunningï¼‰è½¬ä¸ºå°±ç»ªçŠ¶æ€ï¼ˆReadyï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å¤–è°ƒç”¨&lt;/strong&gt;ï¼š
â€‹&lt;strong&gt;æ— æ³•åœ¨å…¶ä»–çº¿ç¨‹ä¸­è°ƒç”¨&lt;code&gt;yield()&lt;/code&gt;æ§åˆ¶ç›®æ ‡çº¿ç¨‹&lt;/strong&gt;ã€‚å› ä¸º&lt;code&gt;yield()&lt;/code&gt;ä»…å½±å“è°ƒç”¨å®ƒçš„å½“å‰çº¿ç¨‹ï¼Œä¸”ä¸æ¥æ”¶ä»»ä½•çº¿ç¨‹å¯¹è±¡å‚æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®åŒºåˆ«æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;å…³é”®åŒºåˆ«æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;çº¿ç¨‹å†…è°ƒç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;çº¿ç¨‹å¤–è°ƒç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œä¸ºç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;interrupt()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒï¼ˆå¦‚&lt;code&gt;Thread.currentThread().interrupt()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;æ”¯æŒï¼ˆéœ€æŒæœ‰ç›®æ ‡çº¿ç¨‹å¼•ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;è®¾ç½®ä¸­æ–­æ ‡å¿—æˆ–æŠ›å‡ºå¼‚å¸¸ï¼›å¯è·¨çº¿ç¨‹æ§åˆ¶ç›®æ ‡çº¿ç¨‹ä¸­æ–­ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;yield()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒï¼ˆ&lt;code&gt;Thread.yield()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä¸æ”¯æŒ&lt;/strong&gt;ï¼ˆæ— æ³•è®©å…¶ä»–çº¿ç¨‹è®©å‡ºCPUï¼‰&lt;/td&gt;
&lt;td&gt;ä»…å½±å“å½“å‰çº¿ç¨‹ï¼›æç¤ºè°ƒåº¦å™¨è®©å‡ºCPUï¼Œä¸ä¿è¯ç«‹å³åˆ‡æ¢ï¼›ä¸é‡Šæ”¾é”ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interrupt()
&lt;/code&gt;&lt;/pre&gt;çš„å¯é æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥ç›®æ ‡çº¿ç¨‹æœªæ£€æŸ¥ä¸­æ–­æ ‡å¿—æˆ–æœªå¤„ç†&lt;code&gt;InterruptedException&lt;/code&gt;ï¼Œä¸­æ–­å¯èƒ½æ— æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;I/Oé˜»å¡ï¼ˆå¦‚&lt;code&gt;socket.accept()&lt;/code&gt;ï¼‰æ— æ³•é€šè¿‡&lt;code&gt;interrupt()&lt;/code&gt;ä¸­æ–­ï¼Œéœ€å…³é—­åº•å±‚èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;yield()
&lt;/code&gt;&lt;/pre&gt;çš„å±€é™æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;ä»…æ˜¯&lt;strong&gt;æç¤º&lt;/strong&gt;è€Œéå¼ºåˆ¶è®©å‡ºCPUï¼Œå®é™…æ•ˆæœä¾èµ–æ“ä½œç³»ç»Ÿè°ƒåº¦å™¨ã€‚&lt;/li&gt;
&lt;li&gt;è¿‡åº¦ä½¿ç”¨å¯èƒ½å¯¼è‡´é¢‘ç¹çº¿ç¨‹åˆ‡æ¢ï¼Œé™ä½æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è®¾è®¡æ›¿ä»£æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;éœ€ç²¾ç¡®æ§åˆ¶çº¿ç¨‹æ‰§è¡Œé¡ºåºæ—¶ï¼Œä¼˜å…ˆä½¿ç”¨&lt;code&gt;wait/notify&lt;/code&gt;ã€é”æˆ–&lt;code&gt;Semaphore&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…ä¾èµ–&lt;code&gt;yield()&lt;/code&gt;å®ç°åŒæ­¥é€»è¾‘ï¼ˆå› è¡Œä¸ºä¸å¯é¢„æµ‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åœºæ™¯ç¤ºä¾‹"&gt;ğŸ’¡ &lt;strong&gt;å…¸å‹åœºæ™¯ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;interrupt()&lt;/code&gt;&lt;/strong&gt;ï¼šä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹è¶…æ—¶åä¸­æ–­ä»»åŠ¡ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;worker&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;currentThread&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;isInterrupted&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ‰§è¡Œä»»åŠ¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;worker&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç­‰å¾…5ç§’&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;worker&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;interrupt&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å¤–éƒ¨ä¸­æ–­&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;yield()&lt;/code&gt;&lt;/strong&gt;ï¼šå½“å‰çº¿ç¨‹åœ¨è€—æ—¶å¾ªç¯ä¸­ä¸»åŠ¨è®©å‡ºCPUï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1000000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;yield&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ¯1000æ¬¡è¿­ä»£è®©å‡ºCPU&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;âœ… &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;interrupt()&lt;/code&gt;&lt;/strong&gt;ï¼šæ”¯æŒçº¿ç¨‹å†…å¤–è°ƒç”¨ï¼Œæ˜¯&lt;strong&gt;è·¨çº¿ç¨‹åä½œ&lt;/strong&gt;çš„æ ¸å¿ƒä¸­æ–­æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;yield()&lt;/code&gt;&lt;/strong&gt;ï¼šä»…æ”¯æŒçº¿ç¨‹å†…è°ƒç”¨ï¼Œç”¨äº&lt;strong&gt;å½“å‰çº¿ç¨‹ä¸»åŠ¨ä¼˜åŒ–CPUèµ„æºåˆ†é…&lt;/strong&gt;ï¼Œä¸å½±å“å…¶ä»–çº¿ç¨‹ã€‚
ä¸¤è€…å‡éœ€ç»“åˆçº¿ç¨‹çŠ¶æ€å’Œä»»åŠ¡é€»è¾‘è°¨æ…ä½¿ç”¨ï¼Œé¿å…è¯¯ç”¨å¯¼è‡´æ€§èƒ½æˆ–ç¨³å®šæ€§é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="yield"&gt;yield()
&lt;/h2&gt;&lt;p&gt;åœ¨Javaå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œ&lt;code&gt;Thread.yield()&lt;/code&gt;æ–¹æ³•ç”¨äºæç¤ºçº¿ç¨‹è°ƒåº¦å™¨å½“å‰çº¿ç¨‹æ„¿æ„æš‚æ—¶è®©å‡ºCPUèµ„æºã€‚ä»¥ä¸‹æ˜¯è°ƒç”¨&lt;code&gt;yield()&lt;/code&gt;åçº¿ç¨‹çŠ¶æ€çš„å˜åŒ–åŠå…¶åç»­æ‰§è¡Œè¡Œä¸ºçš„è¯¦ç»†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-çº¿ç¨‹çŠ¶æ€çš„å˜åŒ–"&gt;âš™ï¸ &lt;strong&gt;çº¿ç¨‹çŠ¶æ€çš„å˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»è¿è¡Œæ€è½¬ä¸ºå°±ç»ªæ€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“çº¿ç¨‹è°ƒç”¨&lt;code&gt;yield()&lt;/code&gt;æ—¶ï¼Œä¼šä»&lt;strong&gt;è¿è¡ŒçŠ¶æ€ï¼ˆRunningï¼‰&lt;/strong&gt; ä¸»åŠ¨é€€å›åˆ°&lt;strong&gt;å°±ç»ªçŠ¶æ€ï¼ˆRunnableï¼‰&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…³é”®ç‰¹æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éé˜»å¡&lt;/strong&gt;ï¼šçº¿ç¨‹ä¸ä¼šè¿›å…¥é˜»å¡ï¼ˆBlockedï¼‰æˆ–ç­‰å¾…ï¼ˆWaitingï¼‰çŠ¶æ€ï¼Œä»…é‡Šæ”¾å½“å‰CPUæ—¶é—´ç‰‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸é‡Šæ”¾é”&lt;/strong&gt;ï¼šå³ä½¿è®©å‡ºCPUï¼Œçº¿ç¨‹ä»æŒæœ‰å·²è·å–çš„é”èµ„æºï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•æŠ¢å è¿™äº›é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ä¼‘çœ æ—¶é—´&lt;/strong&gt;ï¼šä¸&lt;code&gt;sleep()&lt;/code&gt;ä¸åŒï¼Œ&lt;code&gt;yield()&lt;/code&gt;ä¸æŒ‡å®šæš‚åœæ—¶é•¿ï¼Œçº¿ç¨‹å¯ç«‹å³å‚ä¸ä¸‹ä¸€è½®CPUç«äº‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œç³»ç»Ÿè°ƒåº¦å™¨çš„è§’è‰²&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;yield()&lt;/code&gt;ä»…æ˜¯&lt;strong&gt;æç¤ºæ€§è¯·æ±‚&lt;/strong&gt;ï¼Œæ“ä½œç³»ç»Ÿè°ƒåº¦å™¨å¯å¿½ç•¥è¯¥è¯·æ±‚ï¼Œç»§ç»­è®©å½“å‰çº¿ç¨‹æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;è‹¥è°ƒåº¦å™¨æ¥å—è¯·æ±‚ï¼Œä¼šä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©å…¶ä»–çº¿ç¨‹æ‰§è¡Œï¼ˆä¼˜å…ˆçº§ç›¸åŒæˆ–æ›´é«˜çš„çº¿ç¨‹å¯èƒ½ä¼˜å…ˆï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åç»­èƒ½å¦é‡æ–°ç»§ç»­æ‰§è¡Œ"&gt;ğŸ”„ &lt;strong&gt;åç»­èƒ½å¦é‡æ–°ç»§ç»­æ‰§è¡Œï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç«‹å³é‡æ–°è°ƒåº¦çš„å¯èƒ½æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹è°ƒç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;yield()
&lt;/code&gt;&lt;/pre&gt;åä»å¤„äºå°±ç»ªé˜Ÿåˆ—ï¼Œ
å¯èƒ½è¢«ç«‹å³é‡æ–°é€‰ä¸­æ‰§è¡Œ
ã€‚ä¾‹å¦‚ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥ç³»ç»Ÿä¸­æ— å…¶ä»–å°±ç»ªçº¿ç¨‹ï¼Œè°ƒåº¦å™¨å¯èƒ½å†æ¬¡åˆ†é…CPUç»™è¯¥çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥çº¿ç¨‹ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œé‡è·æ‰§è¡Œæƒçš„æ¦‚ç‡æ›´é«˜ï¼ˆå°½ç®¡è§„èŒƒè¦æ±‚ä¼˜å…ˆåŒçº§çº¿ç¨‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œä½ç½®çš„å»¶ç»­æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹è¢«é‡æ–°è°ƒåº¦åï¼Œ&lt;strong&gt;ä»&lt;code&gt;yield()&lt;/code&gt;ä¹‹åçš„ä»£ç ç»§ç»­æ‰§è¡Œ&lt;/strong&gt;ï¼Œè€Œéä»å¤´å¼€å§‹ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;yield&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è®©å‡ºCPU&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;è‹¥çº¿ç¨‹åœ¨
&lt;pre tabindex="0"&gt;&lt;code&gt;i=2
&lt;/code&gt;&lt;/pre&gt;æ—¶è®©å‡ºCPUï¼Œæ¢å¤åç›´æ¥ä»
&lt;pre tabindex="0"&gt;&lt;code&gt;i=3
&lt;/code&gt;&lt;/pre&gt;ç»§ç»­å¾ªç¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é‡è¦æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;é‡è¦æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¡Œä¸ºçš„ä¸ç¡®å®šæ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;yield()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çš„æ•ˆæœé«˜åº¦ä¾èµ–æ“ä½œç³»ç»Ÿå’ŒJVMå®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨Windowså’ŒLinuxç­‰ç³»ç»Ÿä¸­ï¼Œè°ƒåº¦ç­–ç•¥å·®å¼‚å¯èƒ½å¯¼è‡´ç»“æœä¸ä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;æµ‹è¯•æ—¶éœ€å¤šæ¬¡è¿è¡Œè§‚å¯Ÿï¼ˆå¦‚&lt;a class="link" href="https://blog.csdn.net/qq_43071699/article/details/144625959" target="_blank" rel="noopener"
&gt;ç¤ºä¾‹ä»£ç &lt;/a&gt;ä¸­çº¿ç¨‹äº¤æ›¿é¡ºåºä¸å›ºå®šï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸&lt;code&gt;sleep(0)&lt;/code&gt;çš„åŒºåˆ«&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;yield()&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;sleep(0)&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çŠ¶æ€å˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ€ â†’ å°±ç»ªæ€&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ€ â†’ é˜»å¡æ€ï¼ˆTIMED_WAITINGï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”é‡Šæ”¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒåº¦å±‚çº§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JVMå±‚é¢æç¤º&lt;/td&gt;
&lt;td&gt;æ“ä½œç³»ç»Ÿçº§è°ƒåº¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;éœ€å¤„ç†&lt;code&gt;InterruptedException&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼š&lt;code&gt;sleep(0)&lt;/code&gt;ä¼šè§¦å‘æ“ä½œç³»ç»Ÿçº§çº¿ç¨‹åˆ‡æ¢ï¼Œè€Œ&lt;code&gt;yield()&lt;/code&gt;ä»…åœ¨JVMå±‚é¢æç¤ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯ä¸é™åˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨&lt;/strong&gt;ï¼šè°ƒè¯•ã€æ€§èƒ½æµ‹è¯•ã€è‡ªæ—‹ç­‰å¾…ä¼˜åŒ–ï¼ˆå¦‚å‡å°‘CPUç©ºè½¬ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…ï¼š
&lt;ul&gt;
&lt;li&gt;ä¾èµ–&lt;code&gt;yield()&lt;/code&gt;æ§åˆ¶çº¿ç¨‹é¡ºåºï¼ˆç»“æœä¸å¯é ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;é¢‘ç¹è°ƒç”¨å¯¼è‡´çº¿ç¨‹åˆ‡æ¢å¼€é”€æ¿€å¢ï¼ˆé™ä½æ€§èƒ½ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€å˜åŒ–&lt;/strong&gt;ï¼š&lt;code&gt;yield()&lt;/code&gt;ä½¿çº¿ç¨‹ä»&lt;strong&gt;è¿è¡Œæ€ â†’ å°±ç»ªæ€&lt;/strong&gt;ï¼Œä¸é˜»å¡ã€ä¸é‡Šæ”¾é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åç»­æ‰§è¡Œ&lt;/strong&gt;ï¼šçº¿ç¨‹å¯èƒ½&lt;strong&gt;ç«‹å³è¢«é‡æ–°è°ƒåº¦&lt;/strong&gt;ï¼Œä¸”ä»&lt;code&gt;yield()&lt;/code&gt;åä»£ç ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒé£é™©&lt;/strong&gt;ï¼šè¡Œä¸ºä¸å¯é¢„æµ‹ï¼Œ&lt;strong&gt;ä¸åº”ç”¨äºå…³é”®çº¿ç¨‹åŒæ­¥&lt;/strong&gt;ï¼ˆä¼˜å…ˆä½¿ç”¨&lt;code&gt;Lock&lt;/code&gt;ã€&lt;code&gt;Semaphore&lt;/code&gt;ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡&lt;code&gt;yield()&lt;/code&gt;ï¼Œå¼€å‘è€…å¯æç¤ºç³»ç»Ÿä¼˜åŒ–èµ„æºåˆ†é…ï¼Œä½†éœ€ç†è§£å…¶éå¼ºåˆ¶æ€§æœ¬è´¨ï¼Œé¿å…è¯¯ç”¨ä¸ºåŒæ­¥æœºåˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ä¸»çº¿ç¨‹"&gt;ä¸»çº¿ç¨‹
&lt;/h2&gt;&lt;p&gt;ä¸»çº¿ç¨‹åœ¨Javaä¸­ä¸å…¶ä»–çº¿ç¨‹åœ°ä½ç›¸åŒï¼Œå…¶è°ƒç”¨&lt;code&gt;yield()&lt;/code&gt;æˆ–&lt;code&gt;interrupt()&lt;/code&gt;çš„å¯è¡Œæ€§åŠæ•ˆæœéœ€åˆ†æƒ…å†µè®¨è®ºã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»çº¿ç¨‹è°ƒç”¨"&gt;âš™ï¸ &lt;strong&gt;ä¸»çº¿ç¨‹è°ƒç”¨ &lt;code&gt;yield()&lt;/code&gt;&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯è¡Œæ€§&lt;/strong&gt;ï¼š
â€‹&lt;strong&gt;æ”¯æŒè°ƒç”¨&lt;/strong&gt;ã€‚&lt;code&gt;yield()&lt;/code&gt;æ˜¯é™æ€æ–¹æ³•ï¼Œä¸»çº¿ç¨‹å¯é€šè¿‡&lt;code&gt;Thread.yield()&lt;/code&gt;ä¸»åŠ¨è®©å‡ºCPUã€‚&lt;/li&gt;
&lt;li&gt;è¡Œä¸ºæ•ˆæœï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€å˜åŒ–&lt;/strong&gt;ï¼šä¸»çº¿ç¨‹ä»&lt;strong&gt;è¿è¡Œæ€ï¼ˆRunningï¼‰&lt;/strong&gt; è½¬ä¸º&lt;strong&gt;å°±ç»ªæ€ï¼ˆRunnableï¼‰&lt;/strong&gt;ï¼Œå…è®¸å…¶ä»–åŒçº§æˆ–æ›´é«˜ä¼˜å…ˆçº§çº¿ç¨‹è·å¾—CPUæ—¶é—´ç‰‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ç¡®å®šæ€§&lt;/strong&gt;ï¼šè°ƒåº¦å™¨å¯èƒ½å¿½ç•¥è¯¥æç¤ºï¼Œä¸»çº¿ç¨‹å¯èƒ½ç«‹å³è¢«é‡æ–°è°ƒåº¦ï¼ˆå°¤å…¶åœ¨æ— å…¶ä»–æ´»è·ƒçº¿ç¨‹æ—¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é”é‡Šæ”¾&lt;/strong&gt;ï¼šå³ä½¿è®©å‡ºCPUï¼Œä¸»çº¿ç¨‹ä»æŒæœ‰å·²è·å–çš„é”èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;ï¼š
ä¸»çº¿ç¨‹åœ¨å¾ªç¯ä¸­æ‰§è¡Œå¯†é›†å‹è®¡ç®—æ—¶ï¼Œé€‚æ—¶è°ƒç”¨&lt;code&gt;yield()&lt;/code&gt;é¿å…é•¿æ—¶é—´ç‹¬å CPUï¼Œæå‡å…¶ä»–åå°çº¿ç¨‹å“åº”æ€§ï¼ˆå¦‚GUIäº‹ä»¶å¤„ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»çº¿ç¨‹è°ƒç”¨-1"&gt;âš¡ &lt;strong&gt;ä¸»çº¿ç¨‹è°ƒç”¨ &lt;code&gt;interrupt()&lt;/code&gt;&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="1ä¸­æ–­è‡ªèº«"&gt;&lt;strong&gt;ï¼ˆ1ï¼‰ä¸­æ–­è‡ªèº«ï¼ˆ&lt;code&gt;Thread.currentThread().interrupt()&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯è¡Œæ€§&lt;/strong&gt;ï¼š
â€‹&lt;strong&gt;æ”¯æŒè°ƒç”¨&lt;/strong&gt;ã€‚ä¸»çº¿ç¨‹å¯ä¸­æ–­è‡ªå·±ï¼Œè®¾ç½®è‡ªèº«çš„ä¸­æ–­æ ‡å¿—ä½ä¸º&lt;code&gt;true&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¡Œä¸ºæ•ˆæœï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸­æ–­çŠ¶æ€æ ‡è®°&lt;/strong&gt;ï¼šä»…è®¾ç½®æ ‡å¿—ä½ï¼Œ&lt;strong&gt;ä¸ä¼šå¼ºåˆ¶ç»ˆæ­¢&lt;/strong&gt;ä¸»çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åç»­å“åº”&lt;/strong&gt;ï¼šä¸»çº¿ç¨‹éœ€ä¸»åŠ¨æ£€æŸ¥ä¸­æ–­çŠ¶æ€ï¼ˆå¦‚&lt;code&gt;Thread.interrupted()&lt;/code&gt;ï¼‰å¹¶å†³å®šæ˜¯å¦é€€å‡ºä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸è§¦å‘&lt;/strong&gt;ï¼šè‹¥ä¸»çº¿ç¨‹åœ¨é˜»å¡æ–¹æ³•ï¼ˆå¦‚&lt;code&gt;Thread.sleep()&lt;/code&gt;ï¼‰ä¸­ï¼Œä¼šç«‹å³æŠ›å‡º&lt;code&gt;InterruptedException&lt;/code&gt;å¹¶æ¸…é™¤ä¸­æ–­æ ‡å¿—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¸å‹åœºæ™¯ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨æ•è·&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;InterruptedException
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åæ¢å¤ä¸­æ–­çŠ¶æ€ï¼Œç¡®ä¿ä¸Šå±‚é€»è¾‘æ„ŸçŸ¥ä¸­æ–­è¯·æ±‚ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
Thread.sleep(1000);
} catch (InterruptedException e) {
Thread.currentThread().interrupt(); // é‡ç½®ä¸­æ–­æ ‡å¿—
System.out.println(&amp;#34;ä¸»çº¿ç¨‹ä¸­æ–­å·²æ¢å¤&amp;#34;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="2ä¸­æ–­å…¶ä»–çº¿ç¨‹"&gt;&lt;strong&gt;ï¼ˆ2ï¼‰ä¸­æ–­å…¶ä»–çº¿ç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯è¡Œæ€§&lt;/strong&gt;ï¼š
â€‹&lt;strong&gt;æ”¯æŒè°ƒç”¨&lt;/strong&gt;ã€‚ä¸»çº¿ç¨‹å¯é€šè¿‡æŒæœ‰ç›®æ ‡çº¿ç¨‹çš„å¼•ç”¨ï¼ˆå¦‚&lt;code&gt;childThread.interrupt()&lt;/code&gt;ï¼‰ä¸­æ–­å­çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¡Œä¸ºæ•ˆæœï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å­çº¿ç¨‹çŠ¶æ€ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥å­çº¿ç¨‹åœ¨&lt;strong&gt;è¿è¡Œä¸­&lt;/strong&gt;ï¼Œä»…è®¾ç½®ä¸­æ–­æ ‡å¿—ï¼Œéœ€å­çº¿ç¨‹ä¸»åŠ¨æ£€æŸ¥å¹¶å“åº”ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å­çº¿ç¨‹åœ¨&lt;strong&gt;é˜»å¡ä¸­&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;sleep()&lt;/code&gt;ï¼‰ï¼Œä¼šæŠ›å‡º&lt;code&gt;InterruptedException&lt;/code&gt;å¹¶æ¸…é™¤ä¸­æ–­æ ‡å¿—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™è¦æ±‚&lt;/strong&gt;ï¼šéœ€æŒæœ‰ç›®æ ‡çº¿ç¨‹å¯¹è±¡å¼•ç”¨ï¼Œä¸”å¯èƒ½å—&lt;code&gt;SecurityManager&lt;/code&gt;é™åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¸å‹åœºæ™¯ï¼š&lt;/p&gt;
&lt;p&gt;ä¸»çº¿ç¨‹è¶…æ—¶åä¸­æ–­å­çº¿ç¨‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Thread worker = new Thread(() -&amp;gt; {
while (!Thread.interrupted()) {
// æ‰§è¡Œä»»åŠ¡
}
});
worker.start();
Thread.sleep(5000); // ç­‰å¾…5ç§’
worker.interrupt(); // ä¸»çº¿ç¨‹ä¸­æ–­å­çº¿ç¨‹
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¯è¡Œæ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é£é™©/é™åˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»çº¿ç¨‹yield&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ”ï¸ æ”¯æŒ&lt;/td&gt;
&lt;td&gt;æ•ˆæœä¸å¯é ï¼ˆä¾èµ–è°ƒåº¦å™¨ï¼‰ï¼›é¢‘ç¹è°ƒç”¨å¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨&lt;code&gt;Semaphore&lt;/code&gt;æ§åˆ¶å¹¶å‘èµ„æºåˆ†é…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»çº¿ç¨‹ä¸­æ–­è‡ªèº«&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ”ï¸ æ”¯æŒ&lt;/td&gt;
&lt;td&gt;ä¸è‡ªåŠ¨ç»ˆæ­¢çº¿ç¨‹ï¼Œéœ€é…åˆçŠ¶æ€æ£€æŸ¥ï¼›é˜»å¡ä¸­è§¦å‘å¼‚å¸¸éœ€é‡ç½®æ ‡å¿—&lt;/td&gt;
&lt;td&gt;è®¾è®¡åä½œå¼ç»ˆæ­¢é€»è¾‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»çº¿ç¨‹ä¸­æ–­å­çº¿ç¨‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ”ï¸ æ”¯æŒï¼ˆéœ€å¼•ç”¨æƒé™ï¼‰&lt;/td&gt;
&lt;td&gt;å­çº¿ç¨‹ä¸æ£€æŸ¥ä¸­æ–­åˆ™æ— æ•ˆï¼›I/Oé˜»å¡æ— æ³•ä¸­æ–­ï¼ˆéœ€å…³é—­åº•å±‚èµ„æºï¼‰&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨&lt;code&gt;Future.cancel()&lt;/code&gt;ç®¡ç†çº¿ç¨‹æ± ä»»åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;yield()&lt;/code&gt;&lt;/strong&gt;ï¼šä¸»çº¿ç¨‹å¯ä¸»åŠ¨è®©å‡ºCPUï¼Œä½†æ•ˆæœä¸ä¿è¯ï¼Œé€‚ç”¨äºä¼˜åŒ–èµ„æºåˆ†é…ï¼Œ&lt;strong&gt;éåŒæ­¥æ§åˆ¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interrupt()
```ï¼š
- ä¸­æ–­è‡ªèº«ï¼šéœ€æ˜¾å¼æ£€æŸ¥çŠ¶æ€æˆ–å¤„ç†é˜»å¡å¼‚å¸¸ï¼›
- ä¸­æ–­å­çº¿ç¨‹ï¼šéœ€ç›®æ ‡çº¿ç¨‹åä½œå“åº”ï¼Œå¦åˆ™æ— æ•ˆã€‚
â€‹**åˆç†åˆ©ç”¨ä¸­æ–­æœºåˆ¶å¯å®ç°ä¼˜é›…ç»ˆæ­¢ï¼Œè€Œ`yield()`åº”è°¨æ…ç”¨äºæ€§èƒ½è°ƒä¼˜**ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="å®ˆæŠ¤è¿›ç¨‹"&gt;å®ˆæŠ¤è¿›ç¨‹
&lt;/h2&gt;&lt;p&gt;å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰åœ¨Javaä¸­ä¸ä¼šå¹²æ‰°JVMçš„æ­£å¸¸é€€å‡ºï¼Œå…¶æ ¸å¿ƒæœºåˆ¶åŸºäºå…¶&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸè®¾è®¡&lt;/strong&gt;å’Œ&lt;strong&gt;JVMçš„é€€å‡ºè§„åˆ™&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åŸå› çš„åˆ†ç‚¹è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿå‘½å‘¨æœŸä¾èµ–éå®ˆæŠ¤çº¿ç¨‹"&gt;âš™ï¸ &lt;strong&gt;ç”Ÿå‘½å‘¨æœŸä¾èµ–éå®ˆæŠ¤çº¿ç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»‘å®šå…³ç³»&lt;/strong&gt;ï¼šå®ˆæŠ¤çº¿ç¨‹çš„å­˜åœ¨æ˜¯ä¸ºäº†æœåŠ¡éå®ˆæŠ¤çº¿ç¨‹ï¼ˆç”¨æˆ·çº¿ç¨‹ï¼‰ã€‚å½“æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹ç»“æŸæ—¶ï¼ŒJVMä¼šç«‹å³ç»ˆæ­¢æ‰€æœ‰å®ˆæŠ¤çº¿ç¨‹å¹¶é€€å‡ºï¼Œæ— è®ºå®ˆæŠ¤çº¿ç¨‹æ˜¯å¦å®Œæˆä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡åŸåˆ™&lt;/strong&gt;ï¼šå®ˆæŠ¤çº¿ç¨‹è¢«å®šä¹‰ä¸ºâ€œè¾…åŠ©æ€§è§’è‰²â€ï¼ˆå¦‚åƒåœ¾å›æ”¶ã€æ—¥å¿—è®°å½•ï¼‰ï¼Œå…¶ä»»åŠ¡ç»“æœä¸å½±å“ç¨‹åºæ ¸å¿ƒé€»è¾‘çš„å®Œæˆã€‚å› æ­¤ï¼Œå½“è¢«æœåŠ¡çš„å¯¹è±¡ï¼ˆç”¨æˆ·çº¿ç¨‹ï¼‰æ¶ˆå¤±æ—¶ï¼Œå®ˆæŠ¤çº¿ç¨‹å¤±å»å­˜åœ¨æ„ä¹‰ï¼ŒJVMæ— éœ€ç­‰å¾…å…¶ç»“æŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-jvmé€€å‡ºè§„åˆ™"&gt;ğŸ”„ &lt;strong&gt;JVMé€€å‡ºè§„åˆ™&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;è§¦å‘æ¡ä»¶ï¼šJVMé€€å‡ºçš„å”¯ä¸€æ¡ä»¶æ˜¯æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹ç»ˆæ­¢ã€‚å®ˆæŠ¤çº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€ä¸å‚ä¸æ­¤åˆ¤æ–­ã€‚
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// ç¤ºä¾‹ï¼šä¸»çº¿ç¨‹é€€å‡ºåï¼ŒJVMæ— è§†å®ˆæŠ¤çº¿ç¨‹ç›´æ¥é€€å‡º&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;daemonThread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Daemon running...&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;daemonThread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setDaemon&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;daemonThread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Main thread exits â†’ JVM exits&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;è¾“å‡ºï¼šä¸»çº¿ç¨‹ç»“æŸåï¼Œå®ˆæŠ¤çº¿ç¨‹çš„å¾ªç¯è¢«å¼ºåˆ¶ç»ˆæ­¢ï¼ŒJVMé€€å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-èµ„æºä¸ä»»åŠ¡çš„ä¸­æ–­æœºåˆ¶"&gt;âš ï¸ &lt;strong&gt;èµ„æºä¸ä»»åŠ¡çš„ä¸­æ–­æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— èµ„æºæŒæœ‰è¦æ±‚&lt;/strong&gt;ï¼šå®ˆæŠ¤çº¿ç¨‹ä¸åº”æŒæœ‰éœ€è¦æ˜¾å¼é‡Šæ”¾çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶é”ã€æ•°æ®åº“è¿æ¥ï¼‰ã€‚å› ä¸ºJVMé€€å‡ºæ—¶ä¸ä¼šè°ƒç”¨å…¶&lt;code&gt;finally&lt;/code&gt;å—æˆ–æ¸…ç†èµ„æºï¼Œå¯èƒ½å¯¼è‡´æ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡å¯ä¸­æ–­æ€§&lt;/strong&gt;ï¼šå®ˆæŠ¤çº¿ç¨‹é€šå¸¸è®¾è®¡ä¸ºå¯éšæ—¶ä¸­æ–­çš„ä»»åŠ¡ï¼ˆå¦‚å‘¨æœŸæ€§æ—¥å¿—å†™å…¥ï¼‰ã€‚è‹¥ä»»åŠ¡éœ€åŸå­æ€§å®Œæˆï¼ˆå¦‚äº‹åŠ¡æäº¤ï¼‰ï¼Œåˆ™ä¸é€‚åˆç”¨å®ˆæŠ¤çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ç”¨æˆ·çº¿ç¨‹çš„æœ¬è´¨åŒºåˆ«"&gt;ğŸ§© &lt;strong&gt;ä¸ç”¨æˆ·çº¿ç¨‹çš„æœ¬è´¨åŒºåˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç”¨æˆ·çº¿ç¨‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å®ˆæŠ¤çº¿ç¨‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é˜»æ­¢JVMé€€å‡º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯ï¼ˆåªè¦å­˜åœ¨å³é˜»æ­¢ï¼‰&lt;/td&gt;
&lt;td&gt;å¦ï¼ˆä¸å‚ä¸JVMå­˜æ´»åˆ¤æ–­ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡é‡è¦æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ ¸å¿ƒé€»è¾‘ï¼ˆå¦‚æ•°æ®å¤„ç†ï¼‰&lt;/td&gt;
&lt;td&gt;è¾…åŠ©ä»»åŠ¡ï¼ˆå¦‚åƒåœ¾å›æ”¶ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ˜¾å¼é‡Šæ”¾èµ„æº&lt;/td&gt;
&lt;td&gt;é¿å…æŒæœ‰å…³é”®èµ„æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸæ§åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€ä¸»åŠ¨ç»“æŸæˆ–ç­‰å¾…å®Œæˆ&lt;/td&gt;
&lt;td&gt;éšç”¨æˆ·çº¿ç¨‹ç»“æŸè‡ªåŠ¨ç»ˆæ­¢&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯çš„åˆç†æ€§"&gt;ğŸ’¡ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯çš„åˆç†æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åƒåœ¾å›æ”¶ï¼ˆGCï¼‰&lt;/strong&gt;ï¼šGCçº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹çš„å…¸èŒƒã€‚å½“ç”¨æˆ·çº¿ç¨‹å…¨éƒ¨ç»“æŸåï¼Œå†…å­˜ä¸­ä¸å†äº§ç”Ÿæ–°åƒåœ¾ï¼ŒGCçº¿ç¨‹æ— éœ€ç»§ç»­è¿è¡Œï¼ŒJVMé€€å‡ºç¬¦åˆé€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿ƒè·³æ£€æµ‹/æ—¥å¿—è®°å½•&lt;/strong&gt;ï¼šè¿™ç±»ä»»åŠ¡å³ä½¿ä¸­é€”ä¸­æ–­ä¹Ÿä¸å½±å“ç¨‹åºæœ€ç»ˆçŠ¶æ€ï¼ˆå¦‚æ—¥å¿—ä¸¢å¤±éƒ¨åˆ†è®°å½•å¯æ¥å—ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„æ½œåœ¨é£é™©ä¸é™åˆ¶"&gt;âš ï¸ æ³¨æ„ï¼šæ½œåœ¨é£é™©ä¸é™åˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¯é çš„ç»ˆæ­¢&lt;/strong&gt;ï¼šå®ˆæŠ¤çº¿ç¨‹ä¸­&lt;code&gt;finally&lt;/code&gt;ä»£ç å—å¯èƒ½ä¸æ‰§è¡Œï¼Œå¯¼è‡´æ¸…ç†é€»è¾‘å¤±æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜»å¡æ“ä½œçš„é£é™©&lt;/strong&gt;ï¼šè‹¥å®ˆæŠ¤çº¿ç¨‹å› I/Oé˜»å¡ï¼ˆå¦‚&lt;code&gt;socket.accept()&lt;/code&gt;ï¼‰ï¼Œè€Œæ‰€æœ‰ç”¨æˆ·çº¿ç¨‹å·²ç»“æŸï¼ŒJVMä»ä¼šå¼ºåˆ¶é€€å‡ºï¼Œå¯èƒ½ç ´åæ“ä½œåŸå­æ€§ã€‚&lt;/li&gt;
&lt;li&gt;é”™è¯¯ä½¿ç”¨å¹²æ‰°JVMï¼š
&lt;ul&gt;
&lt;li&gt;åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­è°ƒç”¨&lt;code&gt;Thread.join()&lt;/code&gt;ä¼šé˜»å¡è°ƒç”¨è€…ï¼ˆå¦‚ä¸»çº¿ç¨‹ï¼‰ï¼Œåè€Œé˜»æ­¢JVMé€€å‡ºã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å®ˆæŠ¤çº¿ç¨‹åˆ›å»ºæ–°ç”¨æˆ·çº¿ç¨‹ï¼Œä¼šè¿åJVMé€€å‡ºæ¡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;å®ˆæŠ¤çº¿ç¨‹ä¸å¹²æ‰°JVMçš„æœ¬è´¨åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®šä½æœºåˆ¶&lt;/strong&gt;ï¼šä½œä¸ºç”¨æˆ·çº¿ç¨‹çš„â€œé™„å±å“â€ï¼Œå…¶å­˜æ´»æ— ç‹¬ç«‹ä»·å€¼ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€€å‡ºè§„åˆ™&lt;/strong&gt;ï¼šJVMä»…ä¾èµ–ç”¨æˆ·çº¿ç¨‹åˆ¤æ–­é€€å‡ºæ—¶æœºï¼Œå®ˆæŠ¤çº¿ç¨‹è¢«å¼ºåˆ¶ç»ˆæ­¢ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡è®¾è®¡&lt;/strong&gt;ï¼šé€‚ç”¨äºå¯ä¸¢å¼ƒã€éå…³é”®çš„åå°ä»»åŠ¡ã€‚
â€‹&lt;strong&gt;åˆç†ä½¿ç”¨å®ˆæŠ¤çº¿ç¨‹èƒ½æå‡åå°ä»»åŠ¡æ•ˆç‡ï¼Œä½†éœ€ä¸¥æ ¼è§„é¿å…³é”®æ“ä½œå’Œèµ„æºæŒæœ‰&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>ã€Javaã€‘Runnable</title><link>https://dyhes.github.io/p/javarunnable/</link><pubDate>Thu, 19 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javarunnable/</guid><description>&lt;h2 id="callable--runnable"&gt;Callable &amp;amp; Runnable
&lt;/h2&gt;&lt;p&gt;åœ¨Javaå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œ&lt;code&gt;Runnable&lt;/code&gt;å’Œ&lt;code&gt;Callable&lt;/code&gt;æ˜¯å®šä¹‰å¼‚æ­¥ä»»åŠ¡çš„ä¸¤ç§æ ¸å¿ƒæ¥å£ï¼Œå®ƒä»¬çš„è®¾è®¡ç›®çš„å’ŒåŠŸèƒ½æœ‰æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯ä¸¤è€…çš„è¯¦ç»†å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ–¹æ³•å®šä¹‰ä¸è¿”å›å€¼"&gt;âš™ï¸ &lt;strong&gt;æ–¹æ³•å®šä¹‰ä¸è¿”å›å€¼&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Runnable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®šä¹‰å•ä¸€æ–¹æ³• &lt;code&gt;run()&lt;/code&gt;ï¼Œè¿”å›ç±»å‹ä¸º &lt;code&gt;void&lt;/code&gt;ï¼Œ&lt;strong&gt;ä¸è¿”å›ä»»ä½•ç»“æœ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šæ—¥å¿—è®°å½•ã€å¼‚æ­¥é€šçŸ¥ç­‰æ— éœ€è¿”å›å€¼çš„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Runnable task = () -&amp;gt; System.out.println(&amp;#34;Task executed&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Callable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®šä¹‰æ–¹æ³• &lt;code&gt;call()&lt;/code&gt;ï¼Œ&lt;strong&gt;æ”¯æŒæ³›å‹è¿”å›å€¼&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;Callable&amp;lt;Integer&amp;gt;&lt;/code&gt; è¿”å›æ•´æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šè®¡ç®—é˜¶ä¹˜ã€æ•°æ®åº“æŸ¥è¯¢ç­‰éœ€è¿”å›ç»“æœçš„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Callable&amp;lt;Integer&amp;gt; task = () -&amp;gt; { return 42; };
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚å¸¸å¤„ç†æœºåˆ¶"&gt;âš ï¸ &lt;strong&gt;å¼‚å¸¸å¤„ç†æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Runnable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;run()&lt;/code&gt; &lt;strong&gt;ä¸èƒ½æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼ˆchecked exceptionï¼‰&lt;/strong&gt;ï¼Œåªèƒ½åœ¨æ–¹æ³•å†…éƒ¨é€šè¿‡ &lt;code&gt;try-catch&lt;/code&gt; å¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Runnable task = () -&amp;gt; {
try { Thread.sleep(1000); }
catch (InterruptedException e) { e.printStackTrace(); }
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Callable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;call()&lt;/code&gt; &lt;strong&gt;å¯æŠ›å‡ºå—æ£€å¼‚å¸¸&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;throws Exception&lt;/code&gt;ï¼‰ï¼Œå¼‚å¸¸ä¼šå°è£…åœ¨ &lt;code&gt;Future.get()&lt;/code&gt; æŠ›å‡ºçš„ &lt;code&gt;ExecutionException&lt;/code&gt; ä¸­ï¼Œå¯é€šè¿‡ &lt;code&gt;getCause()&lt;/code&gt; è·å–åŸå§‹å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Callable&amp;lt;Integer&amp;gt; task = () -&amp;gt; {
if (invalid) throw new Exception(&amp;#34;Error&amp;#34;);
return result;
};
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡Œæ–¹å¼ä¸çº¿ç¨‹æ± å…¼å®¹æ€§"&gt;ğŸ”Œ &lt;strong&gt;æ‰§è¡Œæ–¹å¼ä¸çº¿ç¨‹æ± å…¼å®¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Runnable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯é€šè¿‡ &lt;code&gt;Thread&lt;/code&gt; ç±»ç›´æ¥å¯åŠ¨ï¼ˆ&lt;code&gt;new Thread(runnable).start()&lt;/code&gt;ï¼‰æˆ–æäº¤ç»™ &lt;code&gt;ExecutorService&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æäº¤åè¿”å› &lt;code&gt;Future&amp;lt;?&amp;gt;&lt;/code&gt;ï¼Œä½† &lt;code&gt;get()&lt;/code&gt; å§‹ç»ˆè¿”å› &lt;code&gt;null&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Callable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¿…é¡»é€šè¿‡ &lt;code&gt;ExecutorService.submit()&lt;/code&gt; æäº¤&lt;/strong&gt;ï¼Œè¿”å› &lt;code&gt;Future&amp;lt;V&amp;gt;&lt;/code&gt; å¯¹è±¡ï¼Œç”¨äºè·å–ç»“æœæˆ–å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;æ— æ³•ç›´æ¥é€šè¿‡ &lt;code&gt;Thread&lt;/code&gt; ç±»å¯åŠ¨ï¼Œéœ€å€ŸåŠ© &lt;code&gt;FutureTask&lt;/code&gt; åŒ…è£…ï¼ˆ&lt;code&gt;new Thread(new FutureTask&amp;lt;&amp;gt;(callable)).start()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»è¦åŒºåˆ«å¯¹æ¯”è¡¨"&gt;ğŸ“Š &lt;strong&gt;ä¸»è¦åŒºåˆ«å¯¹æ¯”è¡¨&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Runnable&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Callable&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— &lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒæ³›å‹è¿”å›å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸èƒ½æŠ›å‡ºå—æ£€å¼‚å¸¸&lt;/td&gt;
&lt;td&gt;âœ… å¯æŠ›å‡ºå—æ£€å¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰§è¡Œæ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒ&lt;code&gt;Thread&lt;/code&gt;æˆ–çº¿ç¨‹æ± &lt;/td&gt;
&lt;td&gt;âŒ ä»…æ”¯æŒçº¿ç¨‹æ± æäº¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡çŠ¶æ€è·Ÿè¸ª&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ ä»…èƒ½åˆ¤æ–­æ˜¯å¦å®Œæˆï¼ˆ&lt;code&gt;Future.isDone()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… å¯è·å–ç»“æœã€å¼‚å¸¸åŠå–æ¶ˆä»»åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼•å…¥ç‰ˆæœ¬&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Java 1.0&lt;/td&gt;
&lt;td&gt;Java 5ï¼ˆ&lt;code&gt;java.util.concurrent&lt;/code&gt;åŒ…ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-çº¿ç¨‹çŠ¶æ€ç›‘æ§ä¸ç»“æœè·å–"&gt;ğŸ§© &lt;strong&gt;çº¿ç¨‹çŠ¶æ€ç›‘æ§ä¸ç»“æœè·å–&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Runnable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;Future.isDone()&lt;/code&gt; åˆ¤æ–­ä»»åŠ¡å®ŒæˆçŠ¶æ€ï¼Œä½†æ— æ³•è·å–ç»“æœæˆ–å¼‚å¸¸è¯¦æƒ…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Callable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;Future.get()&lt;/code&gt; &lt;strong&gt;é˜»å¡è·å–ç»“æœ&lt;/strong&gt;ï¼Œæ”¯æŒè¶…æ—¶è®¾ç½®ï¼ˆ&lt;code&gt;get(long timeout, TimeUnit unit)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯æ•è· &lt;code&gt;ExecutionException&lt;/code&gt; å¤„ç†ä»»åŠ¡å†…éƒ¨å¼‚å¸¸ï¼Œæˆ–é€šè¿‡ &lt;code&gt;Future.cancel()&lt;/code&gt; å–æ¶ˆä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯"&gt;ğŸ’¡ &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Runnable&lt;/code&gt;&lt;/strong&gt;ï¼š
ç®€å•å¼‚æ­¥ä»»åŠ¡ï¼ˆå¦‚äº‹ä»¶æ—¥å¿—ã€çº¿ç¨‹æ± åŸºç¡€ä»»åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Callable&lt;/code&gt;&lt;/strong&gt;ï¼š
éœ€è¿”å›ç»“æœæˆ–ä¸¥æ ¼å¼‚å¸¸å¤„ç†çš„ä»»åŠ¡ï¼ˆå¦‚å¹¶è¡Œè®¡ç®—ã€IOæ“ä½œï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä»£ç ç¤ºä¾‹å¯¹æ¯”"&gt;ğŸ“ &lt;strong&gt;ä»£ç ç¤ºä¾‹å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// Runnableç¤ºä¾‹
ExecutorService executor = Executors.newSingleThreadExecutor();
Future&amp;lt;?&amp;gt; futureRunnable = executor.submit(() -&amp;gt; System.out.println(&amp;#34;Runnable&amp;#34;));
futureRunnable.get(); // è¿”å›null
// Callableç¤ºä¾‹
Future&amp;lt;Integer&amp;gt; futureCallable = executor.submit(() -&amp;gt; {
return 100;
});
Integer result = futureCallable.get(); // è¿”å›100
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Runnable&lt;/code&gt;æ˜¯è½»é‡çº§å¼‚æ­¥ä»»åŠ¡çš„åŸºç¡€æ¥å£ï¼Œè€Œ&lt;code&gt;Callable&lt;/code&gt;é€šè¿‡è¿”å›å€¼ã€å¼‚å¸¸ä¼ é€’å’Œ&lt;code&gt;Future&lt;/code&gt;äº¤äº’æœºåˆ¶ï¼Œæ‰©å±•äº†å¤æ‚ä»»åŠ¡çš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚é€‰æ‹©ä¾æ®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ— éœ€ç»“æœ â†’ &lt;code&gt;Runnable&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;éœ€ç»“æœ/å¼‚å¸¸æ§åˆ¶ â†’ &lt;code&gt;Callable&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="future"&gt;Future
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å…³äº Java ä¸­ &lt;code&gt;Future&lt;/code&gt; æ¥å£çš„è¯¦ç»†è§£æï¼Œç»“åˆå…¶æ ¸å¿ƒç‰¹æ€§ã€å®ç°åŸç†ã€ä½¿ç”¨åœºæ™¯åŠæ³¨æ„äº‹é¡¹è¿›è¡Œç³»ç»Ÿæ€§è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-future-çš„æ ¸å¿ƒå®šä½ä¸ä½œç”¨"&gt;âš™ï¸ &lt;strong&gt;Future çš„æ ¸å¿ƒå®šä½ä¸ä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Future&lt;/code&gt; æ˜¯ Java å¹¶å‘ç¼–ç¨‹ä¸­&lt;strong&gt;å¼‚æ­¥è®¡ç®—ç»“æœçš„å®¹å™¨&lt;/strong&gt;ï¼ˆä½äº &lt;code&gt;java.util.concurrent&lt;/code&gt; åŒ…ï¼‰ï¼Œä»£è¡¨ä¸€ä¸ªå°šæœªå®Œæˆçš„å¼‚æ­¥ä»»åŠ¡çš„ç»“æœã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦ä»»åŠ¡æäº¤ä¸ç»“æœè·å–&lt;/strong&gt;ï¼šä¸»çº¿ç¨‹æäº¤ä»»åŠ¡åç»§ç»­æ‰§è¡Œå…¶ä»–é€»è¾‘ï¼Œé€šè¿‡ &lt;code&gt;Future&lt;/code&gt; åœ¨éœ€è¦æ—¶è·å–ç»“æœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸæ§åˆ¶&lt;/strong&gt;ï¼šæ”¯æŒå–æ¶ˆä»»åŠ¡ã€æ£€æŸ¥å®ŒæˆçŠ¶æ€åŠè¶…æ—¶æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;åŒæ­¥ vs. å¼‚æ­¥çš„ç›´è§‚å¯¹æ¯”&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥&lt;/strong&gt;ï¼šç±»ä¼¼æ‰“ç”µè¯ï¼Œå¿…é¡»ç­‰å¾…å¯¹æ–¹æ¥é€šæ‰èƒ½é€šä¿¡ï¼ˆä¸»çº¿ç¨‹é˜»å¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥&lt;/strong&gt;ï¼šç±»ä¼¼å¹¿æ’­ï¼Œå‘é€åæ— éœ€ç­‰å¾…å›å¤ï¼ˆä¸»çº¿ç¨‹éé˜»å¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ–¹æ³•è§£æ"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒæ–¹æ³•è§£æ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;boolean cancel(boolean mayInterruptIfRunning)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°è¯•å–æ¶ˆä»»åŠ¡ã€‚&lt;code&gt;mayInterruptIfRunning=true&lt;/code&gt; æ—¶ï¼Œå¯ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;boolean isCancelled()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ£€æŸ¥ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆï¼ˆæ­£å¸¸å®Œæˆå‰å–æ¶ˆè¿”å› &lt;code&gt;true&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;boolean isDone()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å®Œæˆï¼ˆå«æ­£å¸¸ç»“æŸã€å¼‚å¸¸ç»ˆæ­¢æˆ–å–æ¶ˆï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;V get()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;é˜»å¡&lt;/strong&gt;ç›´åˆ°ä»»åŠ¡å®Œæˆå¹¶è¿”å›ç»“æœï¼Œè‹¥ä»»åŠ¡æŠ›å‡ºå¼‚å¸¸åˆ™å°è£…ä¸º &lt;code&gt;ExecutionException&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;V get(long timeout, TimeUnit unit)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¸¦è¶…æ—¶çš„ç»“æœè·å–ï¼Œè¶…æ—¶æŠ›å‡º &lt;code&gt;TimeoutException&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;å…³é”®è¡Œä¸ºè¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é˜»å¡æ€§&lt;/strong&gt;ï¼š&lt;code&gt;get()&lt;/code&gt; æ–¹æ³•ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹ï¼Œç›´è‡³ä»»åŠ¡å®Œæˆæˆ–è¶…æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸ä¼ é€’&lt;/strong&gt;ï¼šä»»åŠ¡ä¸­çš„å¼‚å¸¸é€šè¿‡ &lt;code&gt;ExecutionException&lt;/code&gt; æŠ›å‡ºï¼Œéœ€è°ƒç”¨ &lt;code&gt;e.getCause()&lt;/code&gt; è·å–åŸå§‹å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹ä½¿ç”¨åœºæ™¯"&gt;âš¡ &lt;strong&gt;å…¸å‹ä½¿ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œè®¡ç®—&lt;/strong&gt;
å°†å¤§ä»»åŠ¡æ‹†åˆ†ä¸ºå­ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼Œé€šè¿‡ &lt;code&gt;Future&lt;/code&gt; åˆ—è¡¨ç»Ÿä¸€æ”¶é›†ç»“æœï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ExecutorService&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Executors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newFixedThreadPool&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;4&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;submit&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;compute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)));&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æäº¤ä»»åŠ¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æŒ‰å®Œæˆé¡ºåºè·å–ç»“æœ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;shutdown&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šæ€»è€—æ—¶ â‰ˆ æœ€æ…¢å­ä»»åŠ¡çš„è€—æ—¶ï¼Œæ˜¾è‘—æå‡æ•ˆç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥ I/O æ“ä½œ&lt;/strong&gt;
å¦‚ç½‘ç»œè¯·æ±‚æˆ–æ–‡ä»¶è¯»å†™ï¼Œä¸»çº¿ç¨‹æäº¤ä»»åŠ¡åç«‹å³è¿”å›ï¼Œé€šè¿‡ &lt;code&gt;Future&lt;/code&gt; åç»­è·å–å“åº”ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;responseFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;submit&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;httpClient&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;fetchData&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// ... ä¸»çº¿ç¨‹æ‰§è¡Œå…¶ä»–é€»è¾‘&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;responseFuture&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TimeUnit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;SECONDS&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è¶…æ—¶æ§åˆ¶&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡å–æ¶ˆä¸è¶…æ—¶æ§åˆ¶&lt;/strong&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;submit&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;longRunningOperation&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TimeUnit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MILLISECONDS&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è¶…æ—¶è®¾ç½®&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TimeoutException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cancel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°åŸç†ä¸æ ¸å¿ƒç±»"&gt;ğŸ§© &lt;strong&gt;å®ç°åŸç†ä¸æ ¸å¿ƒç±»&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="çŠ¶æ€ç®¡ç†æœºåˆ¶"&gt;&lt;strong&gt;çŠ¶æ€ç®¡ç†æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;FutureTask&lt;/code&gt;ï¼ˆ&lt;code&gt;Future&lt;/code&gt; çš„æ ¸å¿ƒå®ç°ç±»ï¼‰é€šè¿‡ 7 ç§çŠ¶æ€ç®¡ç†ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;private static final int NEW = 0; // æ–°å»º
private static final int COMPLETING = 1; // å®Œæˆä¸­ï¼ˆç»“æœå³å°†è®¾ç½®ï¼‰
private static final int NORMAL = 2; // æ­£å¸¸å®Œæˆ
private static final int EXCEPTIONAL = 3; // å¼‚å¸¸ç»“æŸ
private static final int CANCELLED = 4; // å·²å–æ¶ˆ
private static final int INTERRUPTING = 5; // ä¸­æ–­ä¸­
private static final int INTERRUPTED = 6; // å·²ä¸­æ–­
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çŠ¶æ€è½¬æ¢é€šè¿‡ &lt;strong&gt;CASï¼ˆCompare-And-Swapï¼‰&lt;/strong&gt; ä¿è¯åŸå­æ€§ã€‚&lt;/p&gt;
&lt;h4 id="æ ¸å¿ƒå®ç°ç±»å¯¹æ¯”"&gt;&lt;strong&gt;æ ¸å¿ƒå®ç°ç±»å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;FutureTask&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŒæ—¶å®ç° &lt;code&gt;Runnable&lt;/code&gt; å’Œ &lt;code&gt;Future&lt;/code&gt;ï¼Œå¯ç›´æ¥æäº¤ç»™ &lt;code&gt;Thread&lt;/code&gt; æˆ–çº¿ç¨‹æ± æ‰§è¡Œã€‚&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨ç®¡ç†ä»»åŠ¡æ‰§è¡Œä¸ç»“æœè·å–çš„ç®€å•åœºæ™¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;CompletableFuture&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Java 8+ å¼•å…¥ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨ã€ç»„åˆä»»åŠ¡ã€å¼‚å¸¸å›è°ƒï¼ˆéé˜»å¡ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;å¤æ‚å¼‚æ­¥æµç¨‹ï¼ˆå¦‚å¤šä¸ªä»»åŠ¡ä¾èµ–ã€ç»“æœè½¬æ¢ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ScheduledFuture&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰©å±•å»¶è¿Ÿ/å‘¨æœŸæ€§ä»»åŠ¡è°ƒåº¦èƒ½åŠ›ï¼ˆéœ€é…åˆ &lt;code&gt;ScheduledExecutorService&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚å¿ƒè·³æ£€æµ‹ã€å‘¨æœŸæ•°æ®åŒæ­¥ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸŒ° &lt;strong&gt;&lt;code&gt;FutureTask&lt;/code&gt; ä½¿ç”¨ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;FutureTask&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;futureTask&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FutureTask&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;42&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;futureTask&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç›´æ¥å¯åŠ¨çº¿ç¨‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// æˆ–æäº¤è‡³çº¿ç¨‹æ± ï¼šexecutor.submit(futureTask);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;futureTask&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é˜»å¡è·å–ç»“æœ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ± å…³é—­&lt;/strong&gt;
åŠ¡å¿…è°ƒç”¨ &lt;code&gt;executor.shutdown()&lt;/code&gt;ï¼Œé¿å…çº¿ç¨‹æ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;å¼‚å¸¸å¤„ç†&lt;/li&gt;
&lt;li&gt;ä»»åŠ¡å†…éƒ¨å¼‚å¸¸ä¸ä¼šè‡ªåŠ¨ä¼ æ’­ï¼Œå¿…é¡»é€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;Future.get()
&lt;/code&gt;&lt;/pre&gt;æ•è·
&lt;pre tabindex="0"&gt;&lt;code&gt;ExecutionException
&lt;/code&gt;&lt;/pre&gt;å¹¶è§£æï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
future.get();
} catch (ExecutionException e) {
Throwable realCause = e.getCause(); // è·å–åŸå§‹å¼‚å¸¸
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;é¿å…æ°¸ä¹…é˜»å¡
&lt;ul&gt;
&lt;li&gt;å§‹ç»ˆä½¿ç”¨å¸¦è¶…æ—¶çš„ &lt;code&gt;get(long timeout, TimeUnit unit)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç»“åˆ &lt;code&gt;isDone()&lt;/code&gt; è½®è¯¢æ£€æŸ¥çŠ¶æ€ï¼ˆéå®æ—¶ï¼Œéœ€æƒè¡¡æ€§èƒ½ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;èµ„æºç«äº‰ä¼˜åŒ–
&lt;ul&gt;
&lt;li&gt;CPU å¯†é›†å‹ä»»åŠ¡ â†’ å›ºå®šå¤§å°çº¿ç¨‹æ± ï¼ˆ&lt;code&gt;newFixedThreadPool&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;I/O å¯†é›†å‹ä»»åŠ¡ â†’ ç¼“å­˜çº¿ç¨‹æ± ï¼ˆ&lt;code&gt;newCachedThreadPool&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¼”è¿›ä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;ğŸ”„ &lt;strong&gt;æ¼”è¿›ä¸æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="future-çš„å±€é™æ€§"&gt;&lt;code&gt;Future&lt;/code&gt; çš„å±€é™æ€§ï¼š
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é˜»å¡å¼è·å–ç»“æœ&lt;/strong&gt;ï¼š&lt;code&gt;get()&lt;/code&gt; å¯¼è‡´çº¿ç¨‹èµ„æºæµªè´¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»„åˆèƒ½åŠ›å¼±&lt;/strong&gt;ï¼šå¤šä»»åŠ¡ä¾èµ–éœ€æ‰‹åŠ¨åè°ƒï¼ˆåµŒå¥— &lt;code&gt;get()&lt;/code&gt; ä»£ç è‡ƒè‚¿ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å‡çº§æ–¹æ¡ˆ"&gt;&lt;strong&gt;å‡çº§æ–¹æ¡ˆï¼š&lt;code&gt;CompletableFuture&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹æ¨¡å‹ï¼Œå®ç°éé˜»å¡é“¾å¼è°ƒç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;CompletableFuture&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;supplyAsync&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Hello&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;thenApplyAsync&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34; World&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å¼‚æ­¥ç»“æœè½¬æ¢&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;exceptionally&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Fallback&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å¼‚å¸¸å¤„ç†&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;thenAccept&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ¶ˆè´¹ç»“æœ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡ç»„åˆ&lt;/strong&gt;ï¼š&lt;code&gt;thenCombine()&lt;/code&gt;ã€&lt;code&gt;allOf()&lt;/code&gt; ç­‰åè°ƒå¤šä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›è°ƒæœºåˆ¶&lt;/strong&gt;ï¼šå®Œæˆæ—¶è‡ªåŠ¨è§¦å‘åç»­æ“ä½œï¼ˆæ— éœ€é˜»å¡ç­‰å¾…ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Future&lt;/code&gt; æ˜¯ Java å¹¶å‘ç¼–ç¨‹çš„&lt;strong&gt;åŸºç¡€å¼‚æ­¥æ§åˆ¶å•å…ƒ&lt;/strong&gt;ï¼Œé€‚ç”¨äºç®€å•å¼‚æ­¥åœºæ™¯ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š
âœ… â€‹&lt;strong&gt;ç»“æœå®¹å™¨&lt;/strong&gt;â€‹ï¼šå°è£…å¼‚æ­¥è®¡ç®—ç»“æœæˆ–å¼‚å¸¸ã€‚
âœ… â€‹&lt;strong&gt;ä»»åŠ¡æ§åˆ¶&lt;/strong&gt;â€‹ï¼šå–æ¶ˆã€çŠ¶æ€æŸ¥è¯¢ä¸è¶…æ—¶ç®¡ç†ã€‚
âœ… â€‹&lt;strong&gt;çº¿ç¨‹æ± é›†æˆ&lt;/strong&gt;â€‹ï¼šä¸ &lt;code&gt;ExecutorService&lt;/code&gt; æ— ç¼åä½œã€‚
&lt;strong&gt;æ¼”è¿›æ–¹å‘&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€å•ä»»åŠ¡ â†’ &lt;code&gt;Future&lt;/code&gt; + çº¿ç¨‹æ± ã€‚&lt;/li&gt;
&lt;li&gt;å¤æ‚å¼‚æ­¥æµ â†’ &lt;code&gt;CompletableFuture&lt;/code&gt; æˆ–å“åº”å¼æ¡†æ¶ï¼ˆå¦‚ RxJavaï¼‰ã€‚
â€‹&lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;â€‹ï¼š
âš ï¸ é¿å…æ— ç•Œé˜Ÿåˆ—å¯¼è‡´çš„ OOMï¼ˆä¼˜å…ˆè‡ªå®šä¹‰ &lt;code&gt;ThreadPoolExecutor&lt;/code&gt;ï¼‰ã€‚
âš ï¸ è¶…æ—¶è®¾ç½®ä¸å¼‚å¸¸å¤„ç†æ˜¯ä¿éšœç³»ç»Ÿå¥å£®æ€§çš„å…³é”®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="futuretask"&gt;FutureTask
&lt;/h2&gt;&lt;p&gt;æ˜¯çš„ï¼Œ&lt;code&gt;FutureTask&lt;/code&gt; ç¡®å®&lt;strong&gt;å®ç°äº† &lt;code&gt;Runnable&lt;/code&gt; æ¥å£&lt;/strong&gt;ï¼Œå¹¶ä¸”&lt;strong&gt;å†…éƒ¨æŒæœ‰ä¸€ä¸ª &lt;code&gt;Callable&lt;/code&gt; ç±»å‹çš„å­—æ®µ&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°"&gt;ğŸ”§ &lt;strong&gt;å®ç° &lt;code&gt;Runnable&lt;/code&gt; æ¥å£&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;FutureTask&lt;/code&gt; å®ç°äº† &lt;code&gt;RunnableFuture&lt;/code&gt; æ¥å£ï¼Œè€Œ &lt;code&gt;RunnableFuture&lt;/code&gt; åŒæ—¶ç»§æ‰¿äº† &lt;code&gt;Runnable&lt;/code&gt; å’Œ &lt;code&gt;Future&lt;/code&gt; æ¥å£ã€‚å› æ­¤ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;å¯ä½œä¸º &lt;code&gt;Runnable&lt;/code&gt; ä½¿ç”¨&lt;/strong&gt;ï¼š&lt;code&gt;FutureTask&lt;/code&gt; å¯ä»¥ç›´æ¥ä¼ é€’ç»™ &lt;code&gt;Thread&lt;/code&gt; æ„é€ å‡½æ•°æˆ–æäº¤ç»™çº¿ç¨‹æ± ï¼ˆ&lt;code&gt;ExecutorService&lt;/code&gt;ï¼‰æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;æ‰§è¡Œé€»è¾‘&lt;/strong&gt;ï¼šå…¶ &lt;code&gt;run()&lt;/code&gt; æ–¹æ³•ä¼šè°ƒç”¨å†…éƒ¨ä»»åŠ¡çš„é€»è¾‘ï¼ˆå¦‚ &lt;code&gt;Callable.call()&lt;/code&gt; æˆ– &lt;code&gt;Runnable.run()&lt;/code&gt;ï¼‰å¹¶å°†ç»“æœå­˜å‚¨åˆ° &lt;code&gt;outcome&lt;/code&gt; å­—æ®µä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç¤ºä¾‹ï¼šFutureTask ä½œä¸º Runnable ä½¿ç”¨
Callable&amp;lt;Integer&amp;gt; task = () -&amp;gt; 123;
FutureTask&amp;lt;Integer&amp;gt; futureTask = new FutureTask&amp;lt;&amp;gt;(task);
Thread thread = new Thread(futureTask); // ç›´æ¥ä¼ é€’ç»™ Thread
thread.start();
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å†…éƒ¨æŒæœ‰"&gt;ğŸ“¦ &lt;strong&gt;å†…éƒ¨æŒæœ‰ &lt;code&gt;Callable&lt;/code&gt; å­—æ®µ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;FutureTask&lt;/code&gt; çš„æ ¸å¿ƒè®¾è®¡æ˜¯&lt;strong&gt;ç»Ÿä¸€å°è£…ä»»åŠ¡&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;&lt;code&gt;Callable&lt;/code&gt; å­—æ®µ&lt;/strong&gt;ï¼šæºç ä¸­å£°æ˜äº† &lt;code&gt;private Callable&amp;lt;V&amp;gt; callable&lt;/code&gt; å­—æ®µï¼Œç”¨äºå­˜å‚¨ä¼ å…¥çš„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;âœ… æ”¯æŒä¸¤ç§ä»»åŠ¡ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥ &lt;code&gt;Callable&lt;/code&gt; å¯¹è±¡ï¼Œåˆ™ç›´æ¥èµ‹å€¼ç»™ &lt;code&gt;callable&lt;/code&gt; å­—æ®µã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ä¼ å…¥
&lt;pre tabindex="0"&gt;&lt;code&gt;Runnable
&lt;/code&gt;&lt;/pre&gt;å¯¹è±¡ï¼Œä¼šé€šè¿‡
&lt;pre tabindex="0"&gt;&lt;code&gt;Executors.callable()
&lt;/code&gt;&lt;/pre&gt;å°†å…¶é€‚é…ä¸º
&lt;pre tabindex="0"&gt;&lt;code&gt;Callable
&lt;/code&gt;&lt;/pre&gt;ç±»å‹å†å­˜å‚¨ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;// Runnable é€‚é…ä¸º Callable çš„æºç é€»è¾‘
public FutureTask(Runnable runnable, V result) {
this.callable = Executors.callable(runnable, result);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä»»åŠ¡æ‰§è¡Œæµç¨‹"&gt;ğŸ”„ &lt;strong&gt;ä»»åŠ¡æ‰§è¡Œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å½“è°ƒç”¨ &lt;code&gt;FutureTask.run()&lt;/code&gt; æ—¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œ &lt;code&gt;callable.call()&lt;/code&gt;&lt;/strong&gt;ï¼šè¿è¡Œä»»åŠ¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ç»“æœæˆ–å¼‚å¸¸&lt;/strong&gt;ï¼šç»“æœå­˜å…¥ &lt;code&gt;outcome&lt;/code&gt; å­—æ®µï¼ŒçŠ¶æ€æ›´æ–°ä¸º &lt;code&gt;NORMAL&lt;/code&gt;ï¼ˆæˆåŠŸï¼‰æˆ– &lt;code&gt;EXCEPTIONAL&lt;/code&gt;ï¼ˆå¼‚å¸¸ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å”¤é†’é˜»å¡çº¿ç¨‹&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;get()&lt;/code&gt; ç­‰å¾…ç»“æœçš„çº¿ç¨‹ä¼šè¢«å”¤é†’å¹¶è·å–ç»“æœã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;åŒé‡èº«ä»½&lt;/strong&gt;ï¼š&lt;code&gt;FutureTask&lt;/code&gt; æ—¢æ˜¯ &lt;code&gt;Runnable&lt;/code&gt;ï¼ˆå¯è¢«çº¿ç¨‹æ‰§è¡Œï¼‰ï¼Œåˆæ˜¯ &lt;code&gt;Future&lt;/code&gt;ï¼ˆå¯ç®¡ç†ä»»åŠ¡çŠ¶æ€å’Œç»“æœï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;ç»Ÿä¸€å°è£…&lt;/strong&gt;ï¼šé€šè¿‡å†…éƒ¨ &lt;code&gt;Callable&lt;/code&gt; å­—æ®µç»Ÿä¸€å¤„ç† &lt;code&gt;Callable&lt;/code&gt; å’Œ &lt;code&gt;Runnable&lt;/code&gt; ä»»åŠ¡ï¼Œç¡®ä¿æ‰§è¡Œé€»è¾‘çš„ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼šéœ€å¼‚æ­¥æ‰§è¡Œä¸”è·å–ç»“æœçš„ä»»åŠ¡ï¼ˆå¦‚å¹¶è¡Œè®¡ç®—ã€IO æ“ä½œï¼‰ï¼Œæˆ–éœ€å–æ¶ˆä»»åŠ¡æ‰§è¡Œçš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="completionstage"&gt;CompletionStage
&lt;/h2&gt;&lt;p&gt;CompletionStage æ˜¯ Java 8 å¼•å…¥çš„æ ¸å¿ƒå¼‚æ­¥ç¼–ç¨‹æ¥å£ï¼ˆä½äº &lt;code&gt;java.util.concurrent&lt;/code&gt; åŒ…ï¼‰ï¼Œç”¨äºæè¿°å¼‚æ­¥è®¡ç®—ä¸­çš„ä¸€ä¸ª&lt;strong&gt;é˜¶æ®µæ€§ä»»åŠ¡&lt;/strong&gt;ï¼Œæ”¯æŒä»»åŠ¡ä¹‹é—´çš„é“¾å¼ç»„åˆå’Œç»“æœä¼ é€’ã€‚å®ƒé€šè¿‡å‡½æ•°å¼ç¼–ç¨‹æ¨¡å‹è§£å†³äº†ä¼ ç»Ÿ &lt;code&gt;Future&lt;/code&gt; çš„é˜»å¡è°ƒç”¨å’Œä»»åŠ¡ç¼–æ’éš¾é¢˜ï¼Œæ˜¯ &lt;code&gt;CompletableFuture&lt;/code&gt; çš„åº•å±‚è®¾è®¡åŸºç¡€ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒç‰¹æ€§åˆ°å®è·µåº”ç”¨å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå®šä½ä¸è®¾è®¡æ€æƒ³"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒå®šä½ä¸è®¾è®¡æ€æƒ³&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é˜¶æ®µåŒ–ä»»åŠ¡æŠ½è±¡
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªå¼‚æ­¥è®¡ç®—æµç¨‹å¯æ‹†åˆ†ä¸ºå¤šä¸ªç›¸äº’ä¾èµ–çš„ &lt;code&gt;CompletionStage&lt;/code&gt; å­ä»»åŠ¡ï¼Œå½¢æˆ&lt;strong&gt;ä»»åŠ¡æµæ°´çº¿&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªé˜¶æ®µå°è£…ä¸€ä¸ªæ“ä½œï¼ˆå¦‚ &lt;code&gt;Function&lt;/code&gt;ã€&lt;code&gt;Consumer&lt;/code&gt;ï¼‰ï¼Œå¹¶å®šä¹‰å…¶è¾“å…¥/è¾“å‡ºè¡Œä¸ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;éé˜»å¡å›è°ƒæœºåˆ¶
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;thenApply&lt;/code&gt;ã€&lt;code&gt;thenAccept&lt;/code&gt; ç­‰æ–¹æ³•æ³¨å†Œå›è°ƒï¼Œä»»åŠ¡å®Œæˆåè‡ªåŠ¨è§¦å‘åç»­æ“ä½œï¼Œ&lt;strong&gt;æ— éœ€é˜»å¡ç­‰å¾…&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ—¶åºå…³ç³»æè¿°
&lt;ul&gt;
&lt;li&gt;æ˜ç¡®è¡¨è¾¾ä»»åŠ¡é—´çš„&lt;strong&gt;ä¸²è¡Œã€å¹¶è¡Œã€èšåˆï¼ˆAND/ORï¼‰&lt;/strong&gt; å…³ç³»ï¼Œå®ç°å£°æ˜å¼ç¼–æ’ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä»»åŠ¡æ¨¡å‹ä¸å‡½æ•°å¼æ¥å£"&gt;ğŸ§© &lt;strong&gt;æ ¸å¿ƒä»»åŠ¡æ¨¡å‹ä¸å‡½æ•°å¼æ¥å£&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;CompletionStage&lt;/code&gt; å­ä»»åŠ¡çš„æ“ä½œç±»å‹ç”±å‡½æ•°å¼æ¥å£å†³å®šï¼Œåˆ†ä¸ºä¸‰ç±»ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‡½æ•°å¼æ¥å£&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å›è°ƒæ–¹æ³•ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;Function&amp;lt;T,R&amp;gt;&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ‰è¾“å…¥ã€æœ‰è¾“å‡º&lt;/td&gt;
&lt;td&gt;&lt;code&gt;thenApply(fn)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®è½¬æ¢ï¼ˆå¦‚å­—ç¬¦ä¸²å¤„ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;Consumer&amp;lt;T&amp;gt;&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ‰è¾“å…¥ã€æ— è¾“å‡º&lt;/td&gt;
&lt;td&gt;&lt;code&gt;thenAccept(consumer)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç»“æœæ¶ˆè´¹ï¼ˆå¦‚æ—¥å¿—æ‰“å°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;Runnable&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— è¾“å…¥ã€æ— è¾“å‡º&lt;/td&gt;
&lt;td&gt;&lt;code&gt;thenRun(action)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¸…ç†èµ„æºæˆ–å‘é€é€šçŸ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;stage.thenApply(x -&amp;gt; x * 2) // è¾“å…¥æ•´æ•°xï¼Œè¾“å‡º2x
.thenAccept(System.out::println) // æ¶ˆè´¹ç»“æœå¹¶æ‰“å°
.thenRun(() -&amp;gt; cleanUp()); // æ— å‚æ•°æ¸…ç†æ“ä½œ
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-ä»»åŠ¡ç¼–æ’èƒ½åŠ›è¯¦è§£"&gt;â›“ï¸ &lt;strong&gt;ä»»åŠ¡ç¼–æ’èƒ½åŠ›è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¸²è¡Œå…³ç³»sequential"&gt;&lt;strong&gt;ä¸²è¡Œå…³ç³»ï¼ˆSequentialï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;é€šè¿‡ &lt;code&gt;then*&lt;/code&gt; ç³»åˆ—æ–¹æ³•å®ç°é˜¶æ®µé¡ºåºæ‰§è¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;thenApply()&lt;/code&gt;&lt;/strong&gt;ï¼šæ¥æ”¶ä¸Šé˜¶æ®µç»“æœï¼Œè½¬æ¢åè¾“å‡ºæ–°å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;thenCompose()&lt;/code&gt;&lt;/strong&gt;ï¼šæ‰å¹³åŒ–åµŒå¥—ä»»åŠ¡ï¼ˆå¦‚å°† &lt;code&gt;CompletionStage&amp;lt;String&amp;gt;&lt;/code&gt; è½¬æ¢ä¸º &lt;code&gt;CompletionStage&amp;lt;Integer&amp;gt;&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æŸ¥è¯¢ç”¨æˆ·â†’æŸ¥è¯¢è®¢å•ï¼ˆä¾èµ–å‰åºç»“æœï¼‰
userStage.thenCompose(user -&amp;gt; orderService.getOrders(user.getId()));
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å¹¶è¡Œç»„åˆcombination"&gt;&lt;strong&gt;å¹¶è¡Œç»„åˆï¼ˆCombinationï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;åˆå¹¶å¤šä¸ªç‹¬ç«‹ä»»åŠ¡çš„ç»“æœï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;thenCombine(stage2, fn)&lt;/code&gt;&lt;/strong&gt;ï¼šåˆå¹¶ä¸¤ä¸ªé˜¶æ®µç»“æœï¼ˆå¦‚è®¡ç®— BMIï¼šä½“é‡+èº«é«˜â†’æŒ‡æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;thenAcceptBoth(stage2, consumer)&lt;/code&gt;&lt;/strong&gt;ï¼šæ¶ˆè´¹ä¸¤ä¸ªç»“æœä½†æ— è¾“å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;weightStage.thenCombine(heightStage, (w, h) -&amp;gt; w / (h * h));
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="èšåˆå…³ç³»andor"&gt;&lt;strong&gt;èšåˆå…³ç³»ï¼ˆAND/ORï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æ§åˆ¶å¤šä¸ªä»»åŠ¡çš„å®Œæˆè§¦å‘æ¡ä»¶ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¿”å›ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;allOf(stages...)&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰ä»»åŠ¡å®Œæˆ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;CompletableFuture&amp;lt;Void&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;anyOf(stages...)&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»»æ„ä¸€ä¸ªä»»åŠ¡å®Œæˆ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;CompletableFuture&amp;lt;Object&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ‰¹é‡ä¸‹è½½ç½‘é¡µï¼Œç»Ÿè®¡åŒ…å«å…³é”®è¯çš„é¡µé¢æ•°
CompletableFuture.allOf(urlFutures)
.thenApply(v -&amp;gt; urlFutures.stream()
.filter(f -&amp;gt; f.join().contains(&amp;#34;Java&amp;#34;))
.count());
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å¼‚å¸¸å¤„ç†"&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æ”¯æŒé“¾å¼æ•è·å¼‚å¸¸ï¼Œé¿å…ä¸­æ–­æµæ°´çº¿ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;exceptionally(fallbackFn)&lt;/code&gt;&lt;/strong&gt;ï¼šæ•è·å¼‚å¸¸å¹¶è¿”å›é»˜è®¤å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;handle(biFn)&lt;/code&gt;&lt;/strong&gt;ï¼šç»Ÿä¸€å¤„ç†ç»“æœå’Œå¼‚å¸¸ï¼ˆç±»ä¼¼ &lt;code&gt;try-catch-finally&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;stage.exceptionally(ex -&amp;gt; &amp;#34;Fallback&amp;#34;)
.handle((res, ex) -&amp;gt; ex != null ? &amp;#34;Error&amp;#34; : res);
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°æœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;åº•å±‚å®ç°æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;çŠ¶æ€é©±åŠ¨
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ª &lt;code&gt;CompletionStage&lt;/code&gt; ç»´æŠ¤ä»»åŠ¡çŠ¶æ€ï¼ˆæœªå®Œæˆã€å®Œæˆã€å¼‚å¸¸ï¼‰ï¼Œé€šè¿‡ &lt;strong&gt;CAS åŸå­æ“ä½œ&lt;/strong&gt;æ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¾èµ–æ ˆç®¡ç†
&lt;ul&gt;
&lt;li&gt;å›è°ƒæ–¹æ³•æ³¨å†Œä¸º &lt;strong&gt;LIFO æ ˆç»“æ„&lt;/strong&gt;ï¼Œä»»åŠ¡å®Œæˆæ—¶æŒ‰æ³¨å†Œé¡ºåºçš„&lt;strong&gt;é€†åºè§¦å‘å›è°ƒ&lt;/strong&gt;ï¼ˆåŒæ­¥æ¨¡å¼ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹æ± æ§åˆ¶
&lt;ul&gt;
&lt;li&gt;é»˜è®¤ä½¿ç”¨ &lt;code&gt;ForkJoinPool.commonPool()&lt;/code&gt;ï¼Œå¯é€šè¿‡ &lt;code&gt;*Async&lt;/code&gt; æ–¹æ³•åç¼€ï¼ˆå¦‚ &lt;code&gt;thenApplyAsync&lt;/code&gt;ï¼‰æŒ‡å®šè‡ªå®šä¹‰ &lt;code&gt;Executor&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸš€ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å¾®æœåŠ¡è°ƒç”¨é“¾
å¼‚æ­¥ä¸²è¡Œè°ƒç”¨é‰´æƒâ†’æŸ¥è¯¢â†’ç»“æœç»„è£…ï¼Œé¿å…çº¿ç¨‹é˜»å¡ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;authStage.thenCompose(token -&amp;gt; userService.query(token))
.thenApply(user -&amp;gt; buildResponse(user));
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ‰¹é‡å¹¶è¡Œè®¡ç®—&lt;/strong&gt;
åˆ†æ²»ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼ˆå¦‚ MapReduce æ¨¡å‹ï¼‰ï¼Œé€šè¿‡ &lt;code&gt;allOf&lt;/code&gt; èšåˆç»“æœã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç«é€ŸæŸ¥è¯¢ä¼˜åŒ–
åŒæ—¶è¯·æ±‚å¤šä¸ªæ•°æ®æºï¼Œå–é¦–ä¸ªè¿”å›ç»“æœï¼ˆ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;anyOf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;+ è¶…æ—¶æ§åˆ¶ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;CompletableFuture.anyOf(dbQuery, cacheQuery)
.orTimeout(500, TimeUnit.MILLISECONDS);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æµæ°´çº¿æ•°æ®å¤„ç†&lt;/strong&gt;
é€é˜¶æ®µè½¬æ¢æ•°æ®æµï¼ˆå¦‚è¯»å–â†’è¿‡æ»¤â†’èšåˆâ†’å­˜å‚¨ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é˜»å¡å›è°ƒ&lt;/strong&gt;
å›è°ƒä¸­æ‰§è¡Œé˜»å¡æ“ä½œï¼ˆå¦‚åŒæ­¥ I/Oï¼‰ä¼šæ‹–æ…¢æ•´ä¸ªæµæ°´çº¿ï¼Œéœ€æ”¹ç”¨å¼‚æ­¥ I/O æˆ–æŒ‡å®šä¸“ç”¨çº¿ç¨‹æ± ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ± éš”ç¦»&lt;/strong&gt;
CPU å¯†é›†å‹ä¸ I/O å¯†é›†å‹ä»»åŠ¡ä½¿ç”¨ç‹¬ç«‹çº¿ç¨‹æ± ï¼Œé˜²æ­¢èµ„æºç«äº‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸ä¼ æ’­&lt;/strong&gt;
æœªæ•è·çš„è¿è¡Œæ—¶å¼‚å¸¸ä¼šå¯¼è‡´é˜¶æ®µä¸­æ–­ï¼ŒåŠ¡å¿…é€šè¿‡ &lt;code&gt;handle()&lt;/code&gt; æˆ– &lt;code&gt;exceptionally()&lt;/code&gt; å¤„ç†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;CompletionStage&lt;/code&gt; æ˜¯ Java å¼‚æ­¥ç¼–ç¨‹çš„&lt;strong&gt;èŒƒå¼é©æ–°&lt;/strong&gt;ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äºï¼š
âœ… â€‹&lt;strong&gt;å£°æ˜å¼ç¼–æ’&lt;/strong&gt;â€‹ï¼šé€šè¿‡é“¾å¼è°ƒç”¨æè¿°ä»»åŠ¡æ—¶åºï¼Œæ›¿ä»£ &lt;code&gt;Future&lt;/code&gt; çš„é˜»å¡è½®è¯¢ã€‚
âœ… â€‹&lt;strong&gt;å‡½æ•°å¼é›†æˆ&lt;/strong&gt;â€‹ï¼šæ— ç¼ç»“åˆ Lambda è¡¨è¾¾å¼ï¼Œç®€åŒ–å›è°ƒé€»è¾‘ã€‚
âœ… â€‹&lt;strong&gt;çµæ´»ç»„åˆ&lt;/strong&gt;â€‹ï¼šæ”¯æŒ AND/OR èšåˆã€å¼‚å¸¸æ¢å¤ç­‰å¤æ‚æ¨¡å¼ã€‚
&lt;strong&gt;é€‚ç”¨åœºæ™¯ä¼˜å…ˆçº§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘æœåŠ¡ç¼–æ’ â†’ å¾®æœåŠ¡è°ƒç”¨é“¾&lt;/li&gt;
&lt;li&gt;æ‰¹å¤„ç†åŠ é€Ÿ â†’ å¹¶è¡Œè®¡ç®—ä¸èšåˆ&lt;/li&gt;
&lt;li&gt;å“åº”å¼ç³»ç»Ÿ â†’ éé˜»å¡æµæ°´çº¿&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼šä¼˜å…ˆä½¿ç”¨ &lt;code&gt;CompletableFuture&lt;/code&gt;ï¼ˆ&lt;code&gt;CompletionStage&lt;/code&gt; çš„å”¯ä¸€å®ç°ï¼‰ï¼Œç»“åˆè‡ªå®šä¹‰çº¿ç¨‹æ± ä¸è¶…æ—¶æœºåˆ¶ï¼Œæ„å»ºå¥å£®å¼‚æ­¥é“¾è·¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="completablefuture"&gt;CompletableFuture
&lt;/h2&gt;&lt;p&gt;CompletableFuture æ˜¯ Java 8 å¼•å…¥çš„å¼‚æ­¥ç¼–ç¨‹å·¥å…·ï¼Œå®ç°äº† &lt;code&gt;Future&lt;/code&gt; å’Œ &lt;code&gt;CompletionStage&lt;/code&gt; æ¥å£ï¼Œæä¾›äº†æ¯”ä¼ ç»Ÿ &lt;code&gt;Future&lt;/code&gt; æ›´å¼ºå¤§çš„ä»»åŠ¡ç¼–æ’ã€é“¾å¼è°ƒç”¨å’Œå¼‚å¸¸å¤„ç†èƒ½åŠ›ï¼Œæå¤§ç®€åŒ–äº†å¤æ‚å¼‚æ­¥æµç¨‹çš„å¼€å‘ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒç‰¹æ€§ã€å·¥ä½œåŸç†åˆ°å®è·µåº”ç”¨å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§ä¸è®¾è®¡å®šä½"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒç‰¹æ€§ä¸è®¾è®¡å®šä½&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥ç»“æœå®¹å™¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è¡¨ç¤ºä¸€ä¸ªå¯èƒ½æœªå®Œæˆçš„å¼‚æ­¥è®¡ç®—ç»“æœï¼Œæ”¯æŒæ‰‹åŠ¨è®¾ç½®ç»“æœï¼ˆ&lt;code&gt;complete(T)&lt;/code&gt;ï¼‰æˆ–å¼‚å¸¸ç»ˆæ­¢ï¼ˆ&lt;code&gt;completeExceptionally(Throwable)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ &lt;code&gt;Future&lt;/code&gt; çš„é˜»å¡å¼ &lt;code&gt;get()&lt;/code&gt; ä¸åŒï¼Œæ”¯æŒéé˜»å¡å›è°ƒæœºåˆ¶ï¼ˆå¦‚ &lt;code&gt;thenApply&lt;/code&gt;ã€&lt;code&gt;thenAccept&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡ç¼–æ’èƒ½åŠ›&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸²è¡Œ/å¹¶è¡Œç»„åˆ&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;thenCompose&lt;/code&gt;ï¼ˆä¸²è¡Œä¾èµ–ï¼‰ã€&lt;code&gt;thenCombine&lt;/code&gt;ï¼ˆå¹¶è¡Œåˆå¹¶ï¼‰ã€&lt;code&gt;allOf&lt;/code&gt;/&lt;code&gt;anyOf&lt;/code&gt;ï¼ˆå¤šä»»åŠ¡èšåˆï¼‰ç­‰æ–¹æ³•æ„å»ºå¤æ‚æµæ°´çº¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»çº¿ç¨‹æ§åˆ¶&lt;/strong&gt;ï¼šé»˜è®¤ä½¿ç”¨ &lt;code&gt;ForkJoinPool.commonPool()&lt;/code&gt;ï¼Œæ”¯æŒè‡ªå®šä¹‰ &lt;code&gt;Executor&lt;/code&gt; æŒ‡å®šçº¿ç¨‹æ± ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;exceptionally()&lt;/code&gt;ï¼šæ•è·å¼‚å¸¸å¹¶è¿”å›é»˜è®¤å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;handle()&lt;/code&gt;ï¼šåŒæ—¶å¤„ç†æ­£å¸¸ç»“æœå’Œå¼‚å¸¸ï¼Œå¯è½¬æ¢ç»“æœç±»å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒ-api-è¯¦è§£"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒ API è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åˆ›å»ºå¼‚æ­¥ä»»åŠ¡"&gt;&lt;strong&gt;åˆ›å»ºå¼‚æ­¥ä»»åŠ¡&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;supplyAsync(Supplier&amp;lt;T&amp;gt;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œæœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡ï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;runAsync(Runnable)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œæ— è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡ï¼ˆå¦‚æ—¥å¿—å†™å…¥ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;completedFuture(T)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºå·²å®Œæˆçš„å®ä¾‹ï¼Œç›´æ¥æºå¸¦ç»“æœã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;CompletableFuture&amp;lt;String&amp;gt; future = CompletableFuture.supplyAsync(() -&amp;gt; &amp;#34;Hello&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="é“¾å¼å›è°ƒæ–¹æ³•"&gt;&lt;strong&gt;é“¾å¼å›è°ƒæ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;thenApply(Function&amp;lt;T,U&amp;gt;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è½¬æ¢ç»“æœï¼ˆå¦‚å­—ç¬¦ä¸²æ‹¼æ¥ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;thenAccept(Consumer&amp;lt;T&amp;gt;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆè´¹ç»“æœï¼ˆå¦‚æ‰“å°è¾“å‡ºï¼‰ï¼Œæ— è¿”å›å€¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;thenRun(Runnable)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä»»åŠ¡å®Œæˆåæ‰§è¡ŒåŠ¨ä½œï¼Œä¸è®¿é—®ç»“æœã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;thenCompose(Function&amp;lt;T, CompletableFuture&amp;lt;U&amp;gt;&amp;gt;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°†å½“å‰ç»“æœä½œä¸ºè¾“å…¥å¯åŠ¨æ–°å¼‚æ­¥ä»»åŠ¡ï¼ˆé“¾å¼ä¾èµ–ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;future.thenApply(s -&amp;gt; s + &amp;#34; World&amp;#34;)
.thenAccept(System.out::println); // è¾“å‡º &amp;#34;Hello World&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å¤šä»»åŠ¡ç»„åˆ"&gt;&lt;strong&gt;å¤šä»»åŠ¡ç»„åˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;thenCombine(CompletionStage, BiFunction)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆå¹¶ä¸¤ä¸ªç‹¬ç«‹ä»»åŠ¡çš„ç»“æœï¼ˆå¦‚è®¡ç®— A+Bï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;allOf(CompletableFuture...)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼ˆå¦‚æ‰¹é‡è°ƒç”¨ APIï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;anyOf(CompletableFuture...)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä»»æ„ä¸€ä¸ªä»»åŠ¡å®Œæˆå³è§¦å‘ï¼ˆå¦‚ç«é€ŸæŸ¥è¯¢ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;CompletableFuture&amp;lt;Integer&amp;gt; future1 = CompletableFuture.supplyAsync(() -&amp;gt; 2);
CompletableFuture&amp;lt;Integer&amp;gt; future2 = CompletableFuture.supplyAsync(() -&amp;gt; 3);
future1.thenCombine(future2, (a, b) -&amp;gt; a + b)
.thenAccept(sum -&amp;gt; System.out.println(&amp;#34;Sum: &amp;#34; + sum)); // è¾“å‡º 5
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å¼‚å¸¸å¤„ç†-1"&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;CompletableFuture.supplyAsync(() -&amp;gt; {
if (error) throw new RuntimeException(&amp;#34;Error&amp;#34;);
return &amp;#34;Success&amp;#34;;
}).exceptionally(ex -&amp;gt; &amp;#34;Fallback&amp;#34;) // å¼‚å¸¸æ—¶è¿”å›é»˜è®¤å€¼
.handle((res, ex) -&amp;gt; ex != null ? &amp;#34;Recovered&amp;#34; : res); // ç»Ÿä¸€å¤„ç†ç»“æœå’Œå¼‚å¸¸
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯-1"&gt;âš¡ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œè®¡ç®—ä¼˜åŒ–&lt;/strong&gt;
å°†å¤§ä»»åŠ¡æ‹†åˆ†ä¸ºå­ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼Œé€šè¿‡ &lt;code&gt;allOf&lt;/code&gt; èšåˆç»“æœï¼Œæå‡ååé‡ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;CompletableFuture&amp;lt;Integer&amp;gt;&amp;gt; futures = tasks.stream()
.map(task -&amp;gt; CompletableFuture.supplyAsync(task::compute, executor))
.toList();
CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))
.thenApply(v -&amp;gt; futures.stream().map(CompletableFuture::join).sum());
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¾®æœåŠ¡å¼‚æ­¥è°ƒç”¨é“¾&lt;/strong&gt;
ä¸²è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡ï¼ˆå¦‚å…ˆé‰´æƒåæŸ¥è¯¢ï¼‰ï¼Œé¿å…é˜»å¡çº¿ç¨‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CompletableFuture&amp;lt;String&amp;gt; authFuture = authService.authAsync(token);
authFuture.thenCompose(auth -&amp;gt; userService.queryAsync(auth.getUserId()))
.thenAccept(user -&amp;gt; System.out.println(user.getName()));
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç«é€Ÿè¯·æ±‚ä¸è¶…æ—¶æ§åˆ¶&lt;/strong&gt;
åŒæ—¶å‘èµ·å¤šä¸ªæ•°æ®æºæŸ¥è¯¢ï¼Œå–é¦–ä¸ªå“åº”ç»“æœï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;CompletableFuture&amp;lt;Data&amp;gt; source1 = fetchFromSource1();
CompletableFuture&amp;lt;Data&amp;gt; source2 = fetchFromSource2();
CompletableFuture.anyOf(source1, source2)
.orTimeout(500, TimeUnit.MILLISECONDS) // è¶…æ—¶ä¸­æ–­
.thenAccept(data -&amp;gt; System.out.println(&amp;#34;First result: &amp;#34; + data));
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ-1"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ± é€‰æ‹©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CPU å¯†é›†å‹&lt;/strong&gt;ï¼šå›ºå®šå¤§å°çº¿ç¨‹æ± ï¼ˆ&lt;code&gt;Executors.newFixedThreadPool&lt;/code&gt;ï¼‰é¿å…è¿‡åº¦åˆ‡æ¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;I/O å¯†é›†å‹&lt;/strong&gt;ï¼šç¼“å­˜çº¿ç¨‹æ± ï¼ˆ&lt;code&gt;Executors.newCachedThreadPool&lt;/code&gt;ï¼‰æé«˜èµ„æºåˆ©ç”¨ç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å›è°ƒåœ°ç‹±&lt;/strong&gt;
é“¾å¼è°ƒç”¨ä¸å®œè¿‡é•¿ï¼Œå¤æ‚é€»è¾‘å¯æ‹†åˆ†ä¸ºç‹¬ç«‹æ–¹æ³•ï¼Œæˆ–ç”¨ &lt;code&gt;CompletableFuture&lt;/code&gt; ç»„åˆå™¨ç®€åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ³„æ¼é¢„é˜²&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªå®šä¹‰çº¿ç¨‹æ± éœ€æ˜¾å¼å…³é—­ï¼ˆ&lt;code&gt;shutdown()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»»åŠ¡å†…éƒ¨æ•è·å¼‚å¸¸ï¼Œé˜²æ­¢æœªå¤„ç†å¼‚å¸¸ä¸­æ–­çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ç›‘æ§&lt;/strong&gt;
å¼‚æ­¥é“¾è·¯è¾ƒé•¿æ—¶ï¼Œç»“åˆ Micrometer ç­‰å·¥å…·è¿½è¸ªä»»åŠ¡è€—æ—¶å’Œçº¿ç¨‹æ± è´Ÿè½½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ä¼ ç»Ÿ-future-çš„æ ¸å¿ƒå·®å¼‚"&gt;ğŸ’ &lt;strong&gt;ä¸ä¼ ç»Ÿ Future çš„æ ¸å¿ƒå·®å¼‚&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Future&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CompletableFuture&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»“æœè·å–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡å¼ &lt;code&gt;get()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;éé˜»å¡å›è°ƒï¼ˆ&lt;code&gt;thenAccept&lt;/code&gt; ç­‰ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡ç»„åˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨åè°ƒï¼ˆåµŒå¥—é˜»å¡ï¼‰&lt;/td&gt;
&lt;td&gt;å£°æ˜å¼ç»„åˆï¼ˆ&lt;code&gt;thenCombine&lt;/code&gt;/&lt;code&gt;allOf&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€åœ¨ &lt;code&gt;get()&lt;/code&gt; ä¸­æ•è·&lt;/td&gt;
&lt;td&gt;é“¾å¼å¤„ç†ï¼ˆ&lt;code&gt;exceptionally&lt;/code&gt;/&lt;code&gt;handle&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠŸèƒ½åŸºç¡€&lt;/td&gt;
&lt;td&gt;æ”¯æŒæ‰‹åŠ¨å®Œæˆã€è¶…æ—¶æ§åˆ¶ã€å›è°ƒé“¾&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç»¼åˆåº”ç”¨ç¤ºä¾‹"&gt;ğŸš€ &lt;strong&gt;ç»¼åˆåº”ç”¨ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;ExecutorService executor = Executors.newFixedThreadPool(4);
// å¼‚æ­¥æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ + è®¢å•å†å²
CompletableFuture&amp;lt;User&amp;gt; userFuture = CompletableFuture.supplyAsync(UserService::fetchUser, executor);
CompletableFuture&amp;lt;List&amp;lt;Order&amp;gt;&amp;gt; ordersFuture = userFuture.thenComposeAsync(
user -&amp;gt; OrderService.fetchOrders(user.getId()), executor
);
// åˆå¹¶ç»“æœå¹¶å¤„ç†å¼‚å¸¸
CompletableFuture&amp;lt;Void&amp;gt; result = userFuture.thenCombine(ordersFuture, (user, orders) -&amp;gt; {
return String.format(&amp;#34;User: %s, Orders: %d&amp;#34;, user.getName(), orders.size());
}).handle((res, ex) -&amp;gt; {
if (ex != null) return &amp;#34;Error: &amp;#34; + ex.getCause().getMessage();
return res;
}).thenAcceptAsync(System.out::println, executor);
result.join(); // ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
executor.shutdown();
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’¡ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;CompletableFuture æ˜¯ Java å¼‚æ­¥ç¼–ç¨‹çš„&lt;strong&gt;æ ¸å¿ƒè¿›åŒ–&lt;/strong&gt;ï¼Œé€šè¿‡é“¾å¼è°ƒç”¨å’Œç»„åˆæ“ä½œè§£å†³äº†ä¼ ç»Ÿ Future çš„é˜»å¡ä¸åä½œéš¾é¢˜ã€‚&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;åŒ…æ‹¬ï¼šé«˜å¹¶å‘æœåŠ¡ç¼–æ’ã€æ‰¹é‡ä»»åŠ¡å¹¶è¡ŒåŒ–ã€å“åº”å¼å¾®æœåŠ¡è°ƒç”¨ç­‰ã€‚&lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;supplyAsync&lt;/code&gt;/&lt;code&gt;thenApply&lt;/code&gt; ç­‰é“¾å¼æ–¹æ³•æ›¿ä»£é˜»å¡è°ƒç”¨ï¼›&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰çº¿ç¨‹æ± æ§åˆ¶èµ„æºï¼Œé¿å…æ— ç•Œé˜Ÿåˆ—å¯¼è‡´ OOMï¼›&lt;/li&gt;
&lt;li&gt;å¤æ‚é“¾è·¯ç»“åˆ &lt;code&gt;allOf&lt;/code&gt;/&lt;code&gt;anyOf&lt;/code&gt; å’Œè¶…æ—¶æœºåˆ¶æå‡å¥å£®æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="executor-vs-executorservice"&gt;Executor vs. ExecutorService
&lt;/h2&gt;&lt;p&gt;åœ¨ Java å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œ&lt;code&gt;Executor&lt;/code&gt; å’Œ &lt;code&gt;ExecutorService&lt;/code&gt; æ˜¯çº¿ç¨‹æ± ç®¡ç†çš„æ ¸å¿ƒæ¥å£ï¼ŒäºŒè€…è™½æœ‰å…³è”ä½†èŒè´£å’ŒåŠŸèƒ½å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«åŠé€‚ç”¨åœºæ™¯åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ¥å£å±‚çº§ä¸è®¾è®¡å®šä½"&gt;ğŸ”§ &lt;strong&gt;æ¥å£å±‚çº§ä¸è®¾è®¡å®šä½&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Executor&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€æ¥å£&lt;/strong&gt;ï¼šä»…å®šä¹‰å•ä¸€æ–¹æ³• &lt;code&gt;void execute(Runnable command)&lt;/code&gt;ï¼Œç”¨äºæäº¤ &lt;code&gt;Runnable&lt;/code&gt; ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;ï¼šè§£è€¦ä»»åŠ¡æäº¤ä¸æ‰§è¡Œç­–ç•¥ï¼ˆå¦‚çº¿ç¨‹åˆ›å»ºã€è°ƒåº¦ï¼‰ï¼Œä½†ä¸æ¶‰åŠä»»åŠ¡ç»“æœæˆ–ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ä»£ç ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Executor executor = command -&amp;gt; new Thread(command).start(); // è‡ªå®šä¹‰æ‰§è¡Œç­–ç•¥
executor.execute(() -&amp;gt; System.out.println(&amp;#34;Task running&amp;#34;));
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ExecutorService&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­æ¥å£æ‰©å±•&lt;/strong&gt;ï¼šç»§æ‰¿ &lt;code&gt;Executor&lt;/code&gt;ï¼Œæ–°å¢ä»»åŠ¡ç®¡ç†ã€ç»“æœè·å–å’Œçº¿ç¨‹æ± ç”Ÿå‘½å‘¨æœŸæ§åˆ¶æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;ï¼šæä¾›å®Œæ•´çš„å¼‚æ­¥ä»»åŠ¡æ¡†æ¶ï¼Œæ”¯æŒä»»åŠ¡å–æ¶ˆã€ç»“æœè·Ÿè¸ªåŠä¼˜é›…å…³é—­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½å¯¹æ¯”"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä»»åŠ¡æäº¤æ–¹å¼"&gt;&lt;strong&gt;ä»»åŠ¡æäº¤æ–¹å¼&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Executor&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ExecutorService&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡ç±»å‹æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»… &lt;code&gt;Runnable&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Runnable&lt;/code&gt; å’Œ &lt;code&gt;Callable&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æäº¤æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;execute(Runnable)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;submit(Runnable)&lt;/code&gt; / &lt;code&gt;submit(Callable)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;è¿”å› &lt;code&gt;Future&lt;/code&gt; å¯¹è±¡è·Ÿè¸ªç»“æœæˆ–å¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ExecutorService æäº¤ Callable ä»»åŠ¡
ExecutorService executorService = Executors.newFixedThreadPool(2);
Future&amp;lt;Integer&amp;gt; future = executorService.submit(() -&amp;gt; 42);
Integer result = future.get(); // é˜»å¡è·å–ç»“æœ
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ç”Ÿå‘½å‘¨æœŸç®¡ç†"&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;èƒ½åŠ›&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Executor&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ExecutorService&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é—­çº¿ç¨‹æ± &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨å®ç°&lt;/td&gt;
&lt;td&gt;æä¾› &lt;code&gt;shutdown()&lt;/code&gt; å’Œ &lt;code&gt;shutdownNow()&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çŠ¶æ€æ£€æŸ¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;isShutdown()&lt;/code&gt; / &lt;code&gt;isTerminated()&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç­‰å¾…ç»ˆæ­¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;awaitTermination(timeout, unit)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é—­æµç¨‹ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;executorService.shutdown(); // åœæ­¢æ¥æ”¶æ–°ä»»åŠ¡
if (!executorService.awaitTermination(60, TimeUnit.SECONDS)) {
executorService.shutdownNow(); // å¼ºåˆ¶ç»ˆæ­¢å‰©ä½™ä»»åŠ¡
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="æ‰¹é‡ä»»åŠ¡ä¸é«˜çº§æ§åˆ¶"&gt;&lt;strong&gt;æ‰¹é‡ä»»åŠ¡ä¸é«˜çº§æ§åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡æäº¤&lt;/strong&gt;ï¼š
&lt;code&gt;ExecutorService&lt;/code&gt; æ”¯æŒ &lt;code&gt;invokeAll()&lt;/code&gt;ï¼ˆç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼‰å’Œ &lt;code&gt;invokeAny()&lt;/code&gt;ï¼ˆä»»ä¸€ä»»åŠ¡å®Œæˆå³è¿”å›ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;ï¼š
å¯é€šè¿‡ &lt;code&gt;Future.get(timeout, unit)&lt;/code&gt; å®ç°ç»“æœè·å–çš„è¶…æ—¶æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯åˆ†æ"&gt;ğŸ§© &lt;strong&gt;é€‚ç”¨åœºæ™¯åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èæ¥å£&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç®€å•å¼‚æ­¥ä»»åŠ¡ï¼ˆæ— éœ€ç»“æœï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Executor&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è½»é‡çº§æäº¤ï¼Œæ— éœ€ç®¡ç†çº¿ç¨‹æ± ç”Ÿå‘½å‘¨æœŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;éœ€è·å–ç»“æœçš„ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ExecutorService&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;code&gt;Future&lt;/code&gt; è·å–è¿”å›å€¼æˆ–å¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å®šæ—¶/å‘¨æœŸæ€§ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ExecutorService&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;éœ€é…åˆ &lt;code&gt;ScheduledExecutorService&lt;/code&gt;ï¼ˆå­æ¥å£ï¼‰å®ç°è°ƒåº¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é«˜å¹¶å‘æœåŠ¡ï¼ˆå¦‚WebæœåŠ¡å™¨ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ExecutorService&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¦æ±‚çº¿ç¨‹æ± åŠ¨æ€ç®¡ç†ã€ä¼˜é›…å…³é—­å’Œèµ„æºå›æ”¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿäº§å®è·µæ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ç”Ÿäº§å®è·µæ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é¿å…æ— ç•Œé˜Ÿåˆ—
&lt;pre tabindex="0"&gt;&lt;code&gt;Executors.newFixedThreadPool()
&lt;/code&gt;&lt;/pre&gt;ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—å¯èƒ½å¯¼è‡´
&lt;pre tabindex="0"&gt;&lt;code&gt;OOM
&lt;/code&gt;&lt;/pre&gt;ï¼Œå»ºè®®è‡ªå®šä¹‰
&lt;pre tabindex="0"&gt;&lt;code&gt;ThreadPoolExecutor
```ï¼š
&lt;/code&gt;&lt;/pre&gt;new ThreadPoolExecutor(corePoolSize, maxPoolSize, keepAliveTime, unit, new ArrayBlockingQueue&amp;lt;&amp;gt;(capacity));
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;
&lt;code&gt;Executor&lt;/code&gt; ä¸­æœªæ•è·çš„å¼‚å¸¸ä¼šä¼ é€’è‡³ &lt;code&gt;UncaughtExceptionHandler&lt;/code&gt;ï¼Œè€Œ &lt;code&gt;ExecutorService&lt;/code&gt; å¯é€šè¿‡ &lt;code&gt;Future.get()&lt;/code&gt;æ•è· &lt;code&gt;ExecutionException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ³„æ¼é¢„é˜²&lt;/strong&gt;
åŠ¡å¿…è°ƒç”¨ &lt;code&gt;shutdown()&lt;/code&gt; å…³é—­çº¿ç¨‹æ± ï¼Œå¦åˆ™ JVM æ— æ³•é€€å‡ºã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“æ ¸å¿ƒå·®å¼‚å…¨æ™¯å›¾"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šæ ¸å¿ƒå·®å¼‚å…¨æ™¯å›¾&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Executor&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ExecutorService&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¥å£å…³ç³»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çˆ¶æ¥å£&lt;/td&gt;
&lt;td&gt;å­æ¥å£ï¼ˆæ‰©å±•åŠŸèƒ½ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡æäº¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…æ”¯æŒ &lt;code&gt;Runnable&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒ &lt;code&gt;Runnable&lt;/code&gt; å’Œ &lt;code&gt;Callable&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»“æœè·å–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;code&gt;Future&lt;/code&gt; è·Ÿè¸ªç»“æœ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— å†…ç½®æ–¹æ³•&lt;/td&gt;
&lt;td&gt;æä¾›å…³é—­ã€çŠ¶æ€æ£€æŸ¥ç­‰æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•å¼‚æ­¥åœºæ™¯&lt;/td&gt;
&lt;td&gt;ç”Ÿäº§çº§é«˜å¹¶å‘ç®¡ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å®é™…å»ºè®®&lt;/strong&gt;ï¼š
é™¤éæç®€åœºæ™¯ï¼ˆå¦‚å•æ¬¡å¼‚æ­¥æ—¥å¿—ï¼‰ï¼Œâ€‹&lt;strong&gt;ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;ExecutorService&lt;/code&gt;&lt;/strong&gt;ã€‚å…¶å®Œå¤‡çš„ä»»åŠ¡ç®¡ç†ã€ç»“æœè·Ÿè¸ªå’Œèµ„æºæ§åˆ¶èƒ½åŠ›ï¼Œæ›´ç¬¦åˆç”Ÿäº§ç¯å¢ƒéœ€æ±‚ã€‚å¯¹äºå®šæ—¶ä»»åŠ¡ï¼Œå¯è¿›ä¸€æ­¥ä½¿ç”¨å…¶å­æ¥å£ &lt;code&gt;ScheduledExecutorService&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="executors"&gt;Executors
&lt;/h2&gt;&lt;p&gt;Executors æ˜¯ Java å¹¶å‘ç¼–ç¨‹ä¸­ç”¨äº&lt;strong&gt;ç®€åŒ–çº¿ç¨‹æ± åˆ›å»ºå’Œç®¡ç†&lt;/strong&gt;çš„æ ¸å¿ƒå·¥å…·ç±»ï¼ˆä½äº &lt;code&gt;java.util.concurrent&lt;/code&gt; åŒ…ï¼‰ã€‚å®ƒé€šè¿‡é™æ€å·¥å‚æ–¹æ³•æä¾›é¢„é…ç½®çš„çº¿ç¨‹æ± ï¼Œå¸®åŠ©å¼€å‘è€…é¿å…æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’Œèµ„æºåˆ†é…ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒç‰¹æ€§å’Œä½¿ç”¨è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-executors-çš„æ ¸å¿ƒåŠŸèƒ½ä¸æ¶æ„å®šä½"&gt;ğŸ”§ &lt;strong&gt;Executors çš„æ ¸å¿ƒåŠŸèƒ½ä¸æ¶æ„å®šä½&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ± å°è£…&lt;/strong&gt;
Executors å°è£…äº† &lt;code&gt;ThreadPoolExecutor&lt;/code&gt; å’Œ &lt;code&gt;ScheduledThreadPoolExecutor&lt;/code&gt; çš„å¤æ‚é…ç½®ï¼Œæä¾›å¼€ç®±å³ç”¨çš„çº¿ç¨‹æ± å®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;ä»»åŠ¡ä¸æ‰§è¡Œè§£è€¦
åŸºäº Executor æ¡†æ¶çš„ä¸‰å±‚æ¨¡å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡&lt;/strong&gt;ï¼š&lt;code&gt;Runnable&lt;/code&gt; æˆ– &lt;code&gt;Callable&lt;/code&gt; æ¥å£å®šä¹‰å·¥ä½œå•å…ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œæœºåˆ¶&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;ExecutorService&lt;/code&gt; ç®¡ç†ä»»åŠ¡è°ƒåº¦å’Œçº¿ç¨‹èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“æœå¤„ç†&lt;/strong&gt;ï¼š&lt;code&gt;Future&lt;/code&gt; æˆ– &lt;code&gt;FutureTask&lt;/code&gt; è·å–å¼‚æ­¥è®¡ç®—ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºä¼˜åŒ–&lt;/strong&gt;
å¤ç”¨çº¿ç¨‹å‡å°‘åˆ›å»º/é”€æ¯å¼€é”€ï¼Œæå‡ç³»ç»Ÿååé‡ï¼ˆå°¤å…¶åœ¨ I/O å¯†é›†å‹åœºæ™¯ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-executors-æä¾›çš„çº¿ç¨‹æ± ç±»å‹åŠç‰¹ç‚¹"&gt;ğŸ§© &lt;strong&gt;Executors æä¾›çš„çº¿ç¨‹æ± ç±»å‹åŠç‰¹ç‚¹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å…­ç§å¸¸ç”¨çº¿ç¨‹æ± çš„å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å·¥å‚æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;çº¿ç¨‹æ± ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;newFixedThreadPool(int n)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å›ºå®šå¤§å°çº¿ç¨‹æ± &lt;/td&gt;
&lt;td&gt;æ ¸å¿ƒçº¿ç¨‹æ•° = æœ€å¤§çº¿ç¨‹æ•°ï¼›æ— ç•Œé˜Ÿåˆ—ï¼ˆ&lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;CPU å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚è®¡ç®—ã€å›¾åƒå¤„ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;newCachedThreadPool()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯ç¼“å­˜çº¿ç¨‹æ± &lt;/td&gt;
&lt;td&gt;çº¿ç¨‹æ•°æ— ä¸Šé™ï¼ˆå¯å›æ”¶é—²ç½®çº¿ç¨‹ï¼‰ï¼›åŒæ­¥é˜Ÿåˆ—ï¼ˆ&lt;code&gt;SynchronousQueue&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;çŸ­æœŸå¼‚æ­¥ä»»åŠ¡ï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;newSingleThreadExecutor()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹æ± &lt;/td&gt;
&lt;td&gt;ä»…ä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼›æ— ç•Œé˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;éœ€é¡ºåºæ‰§è¡Œçš„ä»»åŠ¡ï¼ˆå¦‚æ—¥å¿—å†™å…¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;newScheduledThreadPool(int n)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®šæ—¶ä»»åŠ¡çº¿ç¨‹æ± &lt;/td&gt;
&lt;td&gt;å›ºå®šæ ¸å¿ƒçº¿ç¨‹ï¼›æ”¯æŒå»¶è¿Ÿ/å‘¨æœŸæ€§ä»»åŠ¡ï¼ˆ&lt;code&gt;DelayedWorkQueue&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å¿ƒè·³æ£€æµ‹ã€å®šæ—¶æ•°æ®åŒæ­¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;newSingleThreadScheduledExecutor()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹å®šæ—¶ä»»åŠ¡æ± &lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹ç‰ˆ &lt;code&gt;ScheduledThreadPool&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;éœ€é¡ºåºæ‰§è¡Œçš„å®šæ—¶ä»»åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;newWorkStealingPool(int n)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å·¥ä½œçªƒå–çº¿ç¨‹æ± ï¼ˆJava 8+ï¼‰&lt;/td&gt;
&lt;td&gt;åŸºäº &lt;code&gt;ForkJoinPool&lt;/code&gt;ï¼›å¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼›é»˜è®¤ä½¿ç”¨ CPU æ ¸å¿ƒæ•°&lt;/td&gt;
&lt;td&gt;åˆ†æ²»ä»»åŠ¡æˆ–å¹¶è¡Œè®¡ç®—&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼š&lt;code&gt;FixedThreadPool&lt;/code&gt; å’Œ &lt;code&gt;SingleThreadExecutor&lt;/code&gt; ä½¿ç”¨&lt;strong&gt;æ— ç•Œé˜Ÿåˆ—&lt;/strong&gt;ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºï¼ˆOOMï¼‰ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®è‡ªå®šä¹‰ &lt;code&gt;ThreadPoolExecutor&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯åˆ†æ-1"&gt;âš¡ &lt;strong&gt;é€‚ç”¨åœºæ™¯åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CPU å¯†é›†å‹&lt;/strong&gt;ï¼ˆè®¡ç®—é€»è¾‘ä¸ºä¸»ï¼‰â†’ &lt;code&gt;FixedThreadPool&lt;/code&gt;ï¼ˆé™åˆ¶å¹¶å‘çº¿ç¨‹æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;I/O å¯†é›†å‹&lt;/strong&gt;ï¼ˆç­‰å¾…èµ„æºä¸ºä¸»ï¼‰â†’ &lt;code&gt;CachedThreadPool&lt;/code&gt;ï¼ˆå¼¹æ€§æ‰©ç¼©å®¹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºæ‰§è¡Œéœ€æ±‚&lt;/strong&gt; â†’ &lt;code&gt;SingleThreadExecutor&lt;/code&gt;ï¼ˆé¿å…å¹¶å‘é—®é¢˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®šæ—¶/å‘¨æœŸä»»åŠ¡&lt;/strong&gt; â†’ &lt;code&gt;ScheduledThreadPool&lt;/code&gt;ï¼ˆæ›¿ä»£ &lt;code&gt;Timer&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œåˆ†æ²»ä»»åŠ¡&lt;/strong&gt; â†’ &lt;code&gt;WorkStealingPool&lt;/code&gt;ï¼ˆé«˜æ•ˆåˆ©ç”¨å¤šæ ¸ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹"&gt;ğŸ’» &lt;strong&gt;åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å›ºå®šçº¿ç¨‹æ± å¤„ç†å¹¶å‘ä»»åŠ¡"&gt;&lt;strong&gt;å›ºå®šçº¿ç¨‹æ± å¤„ç†å¹¶å‘ä»»åŠ¡&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;ExecutorService executor = Executors.newFixedThreadPool(4);
for (int i = 0; i &amp;lt; 10; i++) {
executor.submit(() -&amp;gt; {
System.out.println(&amp;#34;Task executed by &amp;#34; + Thread.currentThread().getName());
});
}
executor.shutdown(); // åœæ­¢æ¥æ”¶æ–°ä»»åŠ¡
executor.awaitTermination(60, TimeUnit.SECONDS); // ç­‰å¾…å‰©ä½™ä»»åŠ¡å®Œæˆ
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å®šæ—¶ä»»åŠ¡è°ƒåº¦"&gt;&lt;strong&gt;å®šæ—¶ä»»åŠ¡è°ƒåº¦&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(2);
// å»¶è¿Ÿ 3 ç§’æ‰§è¡Œ
scheduler.schedule(() -&amp;gt; System.out.println(&amp;#34;Delayed Task&amp;#34;), 3, TimeUnit.SECONDS);
// å‘¨æœŸä»»åŠ¡ï¼šåˆå§‹å»¶è¿Ÿ 1 ç§’ï¼Œæ¯ 2 ç§’æ‰§è¡Œä¸€æ¬¡
scheduler.scheduleAtFixedRate(() -&amp;gt; System.out.println(&amp;#34;Periodic Task&amp;#34;), 1, 2, TimeUnit.SECONDS);
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="è·å–å¼‚æ­¥ç»“æœfuture"&gt;&lt;strong&gt;è·å–å¼‚æ­¥ç»“æœï¼ˆFutureï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;ExecutorService executor = Executors.newCachedThreadPool();
Future&amp;lt;Integer&amp;gt; future = executor.submit(() -&amp;gt; {
TimeUnit.SECONDS.sleep(1);
return 42;
});
Integer result = future.get(); // é˜»å¡ç›´åˆ°ç»“æœå°±ç»ª
System.out.println(&amp;#34;Result: &amp;#34; + result); // è¾“å‡º: 42
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ-2"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…³é—­çº¿ç¨‹æ± &lt;/strong&gt;
å¿…é¡»è°ƒç”¨ &lt;code&gt;shutdown()&lt;/code&gt; æˆ– &lt;code&gt;shutdownNow()&lt;/code&gt; é¿å…èµ„æºæ³„æ¼ï¼Œæ¨èç»“åˆ &lt;code&gt;awaitTermination&lt;/code&gt; ç­‰å¾…ä»»åŠ¡ç»“æŸã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;
ä»»åŠ¡å†…éƒ¨éœ€æ•è·å¼‚å¸¸ï¼Œå¦åˆ™çº¿ç¨‹å¯èƒ½å› æœªå¤„ç†å¼‚å¸¸è€Œç»ˆæ­¢ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;executor.submit(() -&amp;gt; {
try { /* ä¸šåŠ¡ä»£ç  */ }
catch (Exception e) { e.printStackTrace(); }
});
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¿å…æ— ç•Œé˜Ÿåˆ—&lt;/strong&gt;
ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ &lt;code&gt;ThreadPoolExecutor&lt;/code&gt; è‡ªå®šä¹‰é˜Ÿåˆ—å¤§å°ï¼ˆå¦‚ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è°¨æ…ä½¿ç”¨ &lt;code&gt;CachedThreadPool&lt;/code&gt;&lt;/strong&gt;
å¯èƒ½å› ä»»åŠ¡æ¿€å¢åˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œå¯¼è‡´èµ„æºè€—å°½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Executors çš„æ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;é™ä½å¹¶å‘ç¼–ç¨‹å¤æ‚åº¦&lt;/strong&gt;ï¼Œé€šè¿‡é¢„ç½®çº¿ç¨‹æ± æ»¡è¶³å¸¸è§åœºæ™¯éœ€æ±‚ã€‚ä½†éœ€æ³¨æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;ç®€å•åœºæ™¯&lt;/strong&gt;ï¼šç›´æ¥ä½¿ç”¨ &lt;code&gt;Executors&lt;/code&gt; å·¥å‚æ–¹æ³•å¿«é€Ÿå¼€å‘ã€‚&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;å¤æ‚/ç”Ÿäº§ç¯å¢ƒ&lt;/strong&gt;ï¼šæ”¹ç”¨ &lt;code&gt;ThreadPoolExecutor&lt;/code&gt; è‡ªå®šä¹‰å‚æ•°ï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°ã€é˜Ÿåˆ—ç±»å‹ã€æ‹’ç»ç­–ç•¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ğŸ”§ &lt;strong&gt;çº¿ç¨‹èµ„æºç®¡ç†&lt;/strong&gt;ï¼šåŠ¡å¿…å…³é—­çº¿ç¨‹æ± å¹¶å¤„ç†ä»»åŠ¡å¼‚å¸¸ï¼Œä¿éšœç³»ç»Ÿç¨³å®šæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="è‡ªå®šä¹‰-threadpool"&gt;è‡ªå®šä¹‰ ThreadPool
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­è‡ªå®šä¹‰çº¿ç¨‹æ± ä¸»è¦é€šè¿‡ &lt;code&gt;ThreadPoolExecutor&lt;/code&gt; ç±»å®ç°ï¼Œç›¸æ¯” &lt;code&gt;Executors&lt;/code&gt; æä¾›çš„é¢„è®¾çº¿ç¨‹æ± ï¼Œè‡ªå®šä¹‰æ–¹æ¡ˆèƒ½è§„é¿èµ„æºè€—å°½é£é™©ï¼ˆå¦‚æ— ç•Œé˜Ÿåˆ—å¯¼è‡´å†…å­˜æº¢å‡ºï¼‰ï¼Œå¹¶é’ˆå¯¹ä¸šåŠ¡åœºæ™¯ä¼˜åŒ–æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æ­¥éª¤å’Œå…³é”®é…ç½®ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒå‚æ•°é…ç½®7å¤§æ ¸å¿ƒå‚æ•°"&gt;ğŸ”§ æ ¸å¿ƒå‚æ•°é…ç½®ï¼ˆ7å¤§æ ¸å¿ƒå‚æ•°ï¼‰
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ThreadPoolExecutor&lt;/code&gt; çš„æ„é€ å‡½æ•°åŒ…å«ä»¥ä¸‹å‚æ•°ï¼Œéœ€æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;corePoolSize&lt;/code&gt;ï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ± å¸¸é©»çš„æœ€å°çº¿ç¨‹æ•°ï¼Œå³ä½¿ç©ºé—²ä¹Ÿä¸ä¼šé”€æ¯ï¼ˆé™¤éè®¾ç½® &lt;code&gt;allowCoreThreadTimeOut=true&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šCPU å¯†é›†å‹ä»»åŠ¡è®¾ä¸º &lt;code&gt;CPU æ ¸æ•°&lt;/code&gt;ï¼ˆ&lt;code&gt;Runtime.getRuntime().availableProcessors()&lt;/code&gt;ï¼‰ï¼ŒIO å¯†é›†å‹ä»»åŠ¡å‚è€ƒå…¬å¼ï¼š&lt;code&gt;çº¿ç¨‹æ•° = CPUæ ¸æ•° / (1 - é˜»å¡ç³»æ•°)&lt;/code&gt;ï¼ˆé˜»å¡ç³»æ•°å– 0.8~0.9ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;maximumPoolSize&lt;/code&gt;ï¼ˆæœ€å¤§çº¿ç¨‹æ•°ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ± å…è®¸åˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ•°ï¼ˆåŒ…å«æ ¸å¿ƒçº¿ç¨‹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šIO å¯†é›†å‹ä»»åŠ¡å¯è®¾ä¸º &lt;code&gt;corePoolSize * 2&lt;/code&gt;ï¼Œé¿å…çªå‘æµé‡å¯¼è‡´ä»»åŠ¡å †ç§¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;keepAliveTime&lt;/code&gt; + &lt;code&gt;unit&lt;/code&gt;ï¼ˆçº¿ç¨‹ç©ºé—²è¶…æ—¶ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;éæ ¸å¿ƒçº¿ç¨‹ç©ºé—²è¶…è¿‡æ­¤æ—¶é—´ä¼šè¢«å›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šè®¾ä¸º 30~60 ç§’ï¼ˆå¦‚ &lt;code&gt;TimeUnit.SECONDS&lt;/code&gt;ï¼‰ï¼Œå¹³è¡¡èµ„æºå¤ç”¨ä¸é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;workQueue&lt;/code&gt;ï¼ˆä»»åŠ¡é˜Ÿåˆ—ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨å¾…æ‰§è¡Œä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ï¼Œ&lt;strong&gt;å¿…é¡»ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;LinkedBlockingQueue(capacity)&lt;/code&gt;ï¼‰é˜²æ­¢ OOMã€‚&lt;/li&gt;
&lt;li&gt;é˜Ÿåˆ—ç±»å‹é€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ï¼šå›ºå®šå®¹é‡ï¼Œå…¬å¹³é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼šé»˜è®¤æ— ç•Œï¼Œéœ€æ˜¾å¼æŒ‡å®šå®¹é‡ï¼ˆå¦‚ &lt;code&gt;new LinkedBlockingQueue&amp;lt;&amp;gt;(100)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SynchronousQueue&lt;/code&gt;ï¼šç›´æ¥ç§»äº¤ä»»åŠ¡ï¼Œé…åˆ &lt;code&gt;maximumPoolSize&lt;/code&gt; ä½¿ç”¨ï¼ˆé€‚åˆçŸ­ä»»åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;threadFactory&lt;/code&gt;ï¼ˆçº¿ç¨‹å·¥å‚ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªå®šä¹‰çº¿ç¨‹åç§°ã€ä¼˜å…ˆçº§ã€å®ˆæŠ¤çŠ¶æ€ç­‰ï¼Œä¾¿äºç›‘æ§å’Œæ’æŸ¥é—®é¢˜ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;NamedThreadFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ThreadFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AtomicInteger&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;counter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AtomicInteger&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;NamedThreadFactory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;prefix&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;newThread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Runnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-&amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;counter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAndIncrement&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setDaemon&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// éå®ˆæŠ¤çº¿ç¨‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setPriority&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;NORM_PRIORITY&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;handler&lt;/code&gt;ï¼ˆæ‹’ç»ç­–ç•¥ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“ä»»åŠ¡é˜Ÿåˆ—æ»¡ä¸”çº¿ç¨‹æ•°è¾¾ä¸Šé™æ—¶è§¦å‘ï¼Œå†…ç½®ç­–ç•¥æœ‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;AbortPolicy&lt;/code&gt;ï¼ˆé»˜è®¤ï¼‰ï¼šæŠ›å‡º &lt;code&gt;RejectedExecutionException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CallerRunsPolicy&lt;/code&gt;ï¼šç”±æäº¤ä»»åŠ¡çš„çº¿ç¨‹ç›´æ¥æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DiscardPolicy&lt;/code&gt;ï¼šé™é»˜ä¸¢å¼ƒä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DiscardOldestPolicy&lt;/code&gt;ï¼šä¸¢å¼ƒé˜Ÿåˆ—æœ€æ—§çš„ä»»åŠ¡ï¼Œé‡è¯•æäº¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰ç­–ç•¥ï¼ˆå¦‚è®°å½•æ—¥å¿—æˆ–é™çº§å¤„ç†ï¼‰ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LogRejectedHandler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RejectedExecutionHandler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;rejectedExecution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Runnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ThreadPoolExecutor&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;err&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Task rejected: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å¯é€‰ï¼šé‡è¯•æˆ–æŒä¹…åŒ–ä»»åŠ¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®Œæ•´é…ç½®ç¤ºä¾‹"&gt;âš™ï¸ å®Œæ•´é…ç½®ç¤ºä¾‹
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.util.concurrent.*&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CustomThreadPool&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ThreadPoolExecutor&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;createPool&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;corePoolSize&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Runtime&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getRuntime&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;availableProcessors&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// CPUæ ¸æ•°&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;maxPoolSize&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;corePoolSize&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BlockingQueue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Runnable&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LinkedBlockingQueue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;100&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æœ‰ç•Œé˜Ÿåˆ—&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ThreadFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;factory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NamedThreadFactory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;business-pool&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RejectedExecutionHandler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ThreadPoolExecutor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;CallerRunsPolicy&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ThreadPoolExecutor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;corePoolSize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;maxPoolSize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TimeUnit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;SECONDS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;factory&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ä½¿ç”¨ç¤ºä¾‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ThreadPoolExecutor&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;createPool&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;submit&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Task executed by: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;currentThread&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="p"&gt;()));&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;shutdown&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç¨‹åºç»“æŸå‰å…³é—­çº¿ç¨‹æ± &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id="-é«˜çº§ä¼˜åŒ–æŠ€å·§"&gt;ğŸ› ï¸ é«˜çº§ä¼˜åŒ–æŠ€å·§
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€å‚æ•°è°ƒæ•´&lt;/strong&gt;
é€šè¿‡ &lt;code&gt;setCorePoolSize()&lt;/code&gt; å’Œ &lt;code&gt;setMaximumPoolSize()&lt;/code&gt; è¿è¡Œæ—¶è°ƒæ•´çº¿ç¨‹æ•°ï¼Œé€‚åº”æµé‡æ³¢åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§çº¿ç¨‹æ± çŠ¶æ€&lt;/strong&gt;
å®šæœŸé‡‡é›†æŒ‡æ ‡ï¼ˆå¦‚ä»»åŠ¡æ•°ã€æ´»è·ƒçº¿ç¨‹æ•°ã€é˜Ÿåˆ—å¤§å°ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;executor.getTaskCount(); // æ€»ä»»åŠ¡æ•°
executor.getCompletedTaskCount(); // å·²å®Œæˆä»»åŠ¡æ•°
executor.getQueue().size(); // é˜Ÿåˆ—ç§¯å‹é‡
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜é›…å…³é—­&lt;/strong&gt;
ç¡®ä¿ä»»åŠ¡æ‰§è¡Œå®Œæ¯•å†é€€å‡ºç¨‹åºï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;executor.shutdown(); // åœæ­¢æ¥æ”¶æ–°ä»»åŠ¡
if (!executor.awaitTermination(60, TimeUnit.SECONDS)) {
executor.shutdownNow(); // å¼ºåˆ¶ç»ˆæ­¢å‰©ä½™ä»»åŠ¡
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿäº§ç¯å¢ƒå»ºè®®"&gt;âš ï¸ ç”Ÿäº§ç¯å¢ƒå»ºè®®
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—&lt;/strong&gt;ï¼šé˜²æ­¢ä»»åŠ¡å †ç§¯å¯¼è‡´ OOMã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å‘½åè§„èŒƒ&lt;/strong&gt;ï¼šé€šè¿‡è‡ªå®šä¹‰ &lt;code&gt;ThreadFactory&lt;/code&gt; æ˜ç¡®çº¿ç¨‹ç”¨é€”ï¼ˆå¦‚ &lt;code&gt;order-thread-1&lt;/code&gt;ï¼‰ï¼Œç®€åŒ–æ—¥å¿—æ’æŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;æ‹’ç»ç­–ç•¥é€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;æ ¸å¿ƒä¸šåŠ¡ç”¨ &lt;code&gt;CallerRunsPolicy&lt;/code&gt; ä¿è¯å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;éå…³é”®ä»»åŠ¡ç”¨ &lt;code&gt;DiscardPolicy&lt;/code&gt; å‡è½»è´Ÿè½½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºéš”ç¦»&lt;/strong&gt;ï¼šä¸åŒä¸šåŠ¡çº¿ä½¿ç”¨ç‹¬ç«‹çº¿ç¨‹æ± ï¼Œé¿å…äº’ç›¸å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡è‡ªå®šä¹‰ &lt;code&gt;ThreadPoolExecutor&lt;/code&gt;ï¼Œå¼€å‘è€…å¯ç²¾å‡†æ§åˆ¶çº¿ç¨‹èµ„æºï¼Œåœ¨&lt;strong&gt;é«˜å¹¶å‘&lt;/strong&gt;ã€&lt;strong&gt;å¼‚æ­¥ä»»åŠ¡è°ƒåº¦&lt;/strong&gt;åŠ&lt;strong&gt;èµ„æºæ•æ„Ÿå‹åº”ç”¨&lt;/strong&gt;ä¸­å®ç°æ€§èƒ½ä¸ç¨³å®šæ€§çš„å¹³è¡¡ã€‚ç›¸æ¯” &lt;code&gt;Executors&lt;/code&gt; çš„é¢„è®¾æ–¹æ¡ˆï¼Œè‡ªå®šä¹‰çº¿ç¨‹æ± æ˜¯ç”Ÿäº§ç¯å¢ƒçš„å¿…é€‰é¡¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Javaã€‘Sync</title><link>https://dyhes.github.io/p/javasync/</link><pubDate>Thu, 19 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javasync/</guid><description>&lt;h2 id="cas"&gt;CAS
&lt;/h2&gt;&lt;p&gt;CASï¼ˆCompare And Swapï¼Œæ¯”è¾ƒå¹¶äº¤æ¢ï¼‰æ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ç§&lt;strong&gt;æ— é”å¹¶å‘æ§åˆ¶æŠ€æœ¯&lt;/strong&gt;ï¼Œé€šè¿‡ç¡¬ä»¶æŒ‡ä»¤å®ç°åŸå­æ“ä½œï¼Œé¿å…ä¼ ç»Ÿé”æœºåˆ¶çš„æ€§èƒ½å¼€é”€ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡æ¯”è¾ƒå†…å­˜å€¼ä¸é¢„æœŸå€¼æ¥å†³å®šæ˜¯å¦æ›´æ–°ï¼Œæ•´ä¸ªè¿‡ç¨‹ç”±CPUä¿è¯åŸå­æ€§ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-casçš„æ ¸å¿ƒåŸç†"&gt;âš™ï¸ &lt;strong&gt;CASçš„æ ¸å¿ƒåŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸‰æ­¥æ“ä½œï¼ˆåŸå­æ€§ï¼‰&lt;/strong&gt;
CASæ“ä½œåŒ…å«ä¸‰ä¸ªå…³é”®å‚æ•°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜åœ°å€ï¼ˆVï¼‰&lt;/strong&gt;ï¼šè¦ä¿®æ”¹çš„å…±äº«å˜é‡å†…å­˜ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢„æœŸåŸå€¼ï¼ˆAï¼‰&lt;/strong&gt;ï¼šçº¿ç¨‹è®¤ä¸ºå˜é‡å½“å‰åº”æœ‰çš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–°å€¼ï¼ˆBï¼‰&lt;/strong&gt;ï¼šè‹¥å†…å­˜å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™æ›´æ–°ä¸ºæ­¤å€¼ã€‚
ä¼ªä»£ç è¡¨ç¤ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;CAS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ¯”è¾ƒå†…å­˜å€¼ä¸é¢„æœŸå€¼&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç›¸ç­‰åˆ™æ›´æ–°ä¸ºæ–°å€¼&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å¦åˆ™æ“ä½œå¤±è´¥&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;strong&gt;åŸå­æ€§ä¿éšœ&lt;/strong&gt;ï¼šè¿™ä¸‰æ­¥æ“ä½œç”±å•æ¡CPUæŒ‡ä»¤ï¼ˆå¦‚x86çš„&lt;code&gt;lock cmpxchg&lt;/code&gt;ï¼‰å®Œæˆï¼Œæ‰§è¡ŒæœŸé—´ä¸ä¼šè¢«ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œæµç¨‹ç¤ºä¾‹&lt;/strong&gt;
å‡è®¾å…±äº«å˜é‡ &lt;code&gt;count=0&lt;/code&gt;ï¼Œä¸¤ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œ&lt;code&gt;count++&lt;/code&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹1è¯»å–&lt;code&gt;count=0&lt;/code&gt;ï¼Œæ‰§è¡Œ&lt;code&gt;CAS(0, 1)&lt;/code&gt;ï¼šå†…å­˜å€¼&lt;code&gt;0&lt;/code&gt;ç­‰äºé¢„æœŸå€¼&lt;code&gt;0&lt;/code&gt;ï¼Œæ›´æ–°ä¸º&lt;code&gt;1&lt;/code&gt;ï¼ŒæˆåŠŸã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹2è¯»å–&lt;code&gt;count=0&lt;/code&gt;ï¼ˆæœªåŠæ—¶åˆ·æ–°ï¼‰ï¼Œæ‰§è¡Œ&lt;code&gt;CAS(0, 1)&lt;/code&gt;ï¼šå†…å­˜å€¼&lt;code&gt;1&lt;/code&gt;â‰ é¢„æœŸå€¼&lt;code&gt;0&lt;/code&gt;ï¼Œæ“ä½œå¤±è´¥ â†’ é‡è¯•è¯»å–&lt;code&gt;count=1&lt;/code&gt;ï¼Œå†æ‰§è¡Œ&lt;code&gt;CAS(1, 2)&lt;/code&gt;ï¼ŒæˆåŠŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-casçš„ä¼˜ç¼ºç‚¹"&gt;âš–ï¸ &lt;strong&gt;CASçš„ä¼˜ç¼ºç‚¹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="-ä¼˜ç‚¹"&gt;âœ… &lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;æ— é”é«˜æ€§èƒ½
&lt;ul&gt;
&lt;li&gt;é¿å…çº¿ç¨‹é˜»å¡å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œé€‚åˆ&lt;strong&gt;ä½ç«äº‰åœºæ™¯&lt;/strong&gt;ï¼ˆå¦‚è®¡æ•°å™¨å¢å‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ååé‡é«˜äºé”æœºåˆ¶ï¼Œå°¤å…¶åœ¨ç»†ç²’åº¦æ“ä½œä¸­ï¼ˆå¦‚&lt;code&gt;AtomicInteger&lt;/code&gt;è‡ªå¢ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¹è§‚å¹¶å‘
&lt;ul&gt;
&lt;li&gt;å‡è®¾æ“ä½œå†²çªå°‘ï¼Œå¤±è´¥æ—¶é€šè¿‡&lt;strong&gt;è‡ªæ—‹é‡è¯•&lt;/strong&gt;ï¼ˆå¾ªç¯CASï¼‰è€Œéé˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="-ç¼ºç‚¹"&gt;âš ï¸ &lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;ABAé—®é¢˜
&lt;ul&gt;
&lt;li&gt;è‹¥å˜é‡å€¼ä» &lt;code&gt;A â†’ B â†’ A&lt;/code&gt;ï¼ŒCASæ— æ³•æ„ŸçŸ¥ä¸­é—´å˜åŒ–ï¼Œå¯èƒ½è¯¯åˆ¤â€œæœªè¢«ä¿®æ”¹â€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šä½¿ç”¨å¸¦ç‰ˆæœ¬å·çš„åŸå­ç±»ï¼ˆå¦‚&lt;code&gt;AtomicStampedReference&lt;/code&gt;ï¼‰ï¼Œæ¯æ¬¡æ›´æ–°é€’å¢ç‰ˆæœ¬å·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‡ªæ—‹å¼€é”€
&lt;ul&gt;
&lt;li&gt;é«˜ç«äº‰åœºæ™¯ä¸‹é¢‘ç¹å¤±è´¥é‡è¯•ï¼Œå¯¼è‡´&lt;strong&gt;CPUç©ºè½¬&lt;/strong&gt;ï¼ˆå¦‚100ä¸ªçº¿ç¨‹äº‰æŠ¢åŒä¸€å˜é‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å•ä¸€å˜é‡é™åˆ¶
&lt;ul&gt;
&lt;li&gt;åªèƒ½ä¿è¯&lt;strong&gt;ä¸€ä¸ªå…±äº«å˜é‡&lt;/strong&gt;çš„åŸå­æ“ä½œã€‚å¤šå˜é‡éœ€åˆå¹¶æˆ–æ”¹ç”¨é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-javaä¸­çš„caså®ç°"&gt;âš¡ï¸ &lt;strong&gt;Javaä¸­çš„CASå®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Javaé€šè¿‡ &lt;code&gt;java.util.concurrent.atomic&lt;/code&gt; åŒ…æä¾›åŸå­ç±»ï¼Œåº•å±‚è°ƒç”¨&lt;code&gt;Unsafe&lt;/code&gt;ç±»çš„CASæŒ‡ä»¤ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// ä½¿ç”¨AtomicIntegerå®ç°çº¿ç¨‹å®‰å…¨è‡ªå¢
AtomicInteger count = new AtomicInteger(0);
count.incrementAndGet(); // åŸå­è‡ªå¢ï¼Œæ— éœ€é”
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å…³é”®æ–¹æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;compareAndSet(expect, update)&lt;/code&gt;ï¼šæ ¸å¿ƒCASæ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getAndIncrement()&lt;/code&gt;ï¼šå¾ªç¯CASå®ç°è‡ªå¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº•å±‚æœºåˆ¶&lt;/strong&gt;ï¼š
ä¾èµ–&lt;code&gt;sun.misc.Unsafe#compareAndSwapInt&lt;/code&gt;ï¼Œé€šè¿‡JNIè°ƒç”¨CPUæŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ”§ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ— é”è®¡æ•°å™¨&lt;/strong&gt;
å¦‚&lt;code&gt;AtomicInteger&lt;/code&gt;ï¼Œæ›¿ä»£&lt;code&gt;synchronized&lt;/code&gt;å®ç°é«˜æ•ˆè®¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;è‡ªæ—‹é”ï¼ˆSpinLockï¼‰é€šè¿‡CASå®ç°è½»é‡çº§é”ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;public class SpinLock {
private AtomicReference&amp;lt;Thread&amp;gt; owner = new AtomicReference&amp;lt;&amp;gt;();
public void lock() {
while (!owner.compareAndSet(null, Thread.currentThread())) {
// è‡ªæ—‹ç­‰å¾…
}
}
public void unlock() {
owner.compareAndSet(Thread.currentThread(), null);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘å®¹å™¨&lt;/strong&gt;
&lt;code&gt;ConcurrentHashMap&lt;/code&gt;çš„æ¡¶èŠ‚ç‚¹æ“ä½œã€&lt;code&gt;LinkedTransferQueue&lt;/code&gt;ç­‰ä½¿ç”¨CASå‡å°‘é”ç«äº‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-cas-vs-é”æœºåˆ¶"&gt;â†”ï¸ &lt;strong&gt;CAS vs é”æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CAS&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é”ï¼ˆå¦‚synchronizedï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¹è§‚é”ï¼ˆæ— é”ï¼‰&lt;/td&gt;
&lt;td&gt;æ‚²è§‚é”ï¼ˆé˜»å¡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§ç²’åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•ä¸€å˜é‡&lt;/td&gt;
&lt;td&gt;ä»£ç å—/æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ç«äº‰æ—¶é«˜æ•ˆï¼Œé«˜ç«äº‰æ—¶CPUç©ºè½¬&lt;/td&gt;
&lt;td&gt;é«˜ç«äº‰æ—¶ç¨³å®šï¼Œä½†ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¤§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•åŸå­æ“ä½œï¼ˆè‡ªå¢ã€æ ‡å¿—ä½æ›´æ–°ï¼‰&lt;/td&gt;
&lt;td&gt;å¤åˆæ“ä½œï¼ˆå¦‚è½¬è´¦ï¼šå…ˆæ‰£Aå†å¢Bï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ABAé—®é¢˜ã€è‡ªæ—‹å¼€é”€&lt;/td&gt;
&lt;td&gt;æ­»é”ã€ä¼˜å…ˆçº§åè½¬&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰æ‹©åŸåˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€å•å˜é‡ä¸”ä½ç«äº‰ â†’ &lt;strong&gt;CAS&lt;/strong&gt;ï¼ˆå¦‚è®¡æ•°å™¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤æ‚é€»è¾‘æˆ–é«˜ç«äº‰ â†’ &lt;strong&gt;é”&lt;/strong&gt;ï¼ˆå¦‚&lt;code&gt;synchronized&lt;/code&gt;æˆ–&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CASæœ¬è´¨&lt;/strong&gt;ï¼šç¡¬ä»¶çº§åŸå­æŒ‡ä»¤ï¼Œé€šè¿‡â€œæ¯”è¾ƒ-äº¤æ¢â€å®ç°æ— é”å¹¶å‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šé«˜æ€§èƒ½çº¿ç¨‹å®‰å…¨æ“ä½œï¼Œé¿å…é”å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ³¨æ„ï¼š
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆç”¨äº&lt;strong&gt;å•ä¸€å…±äº«å˜é‡&lt;/strong&gt;çš„ç®€å•æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;é«˜ç«äº‰åœºæ™¯éœ€ç›‘æ§CPUå ç”¨ï¼Œå¿…è¦æ—¶åˆ‡æ¢ä¸ºé”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ABAé—®é¢˜&lt;/strong&gt;éœ€é€šè¿‡ç‰ˆæœ¬å·è§£å†³ï¼ˆ&lt;code&gt;AtomicStampedReference&lt;/code&gt;ï¼‰ã€‚
åˆç†è¿ç”¨CASå¯åœ¨ç‰¹å®šåœºæ™¯æ˜¾è‘—æå‡å¹¶å‘æ€§èƒ½ï¼Œä½†éœ€ä¸¥æ ¼è¯„ä¼°å…¶é€‚ç”¨æ€§ï¼Œé¿å…ç›²ç›®æ›¿ä»£é”æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="atomicstampedreference"&gt;AtomicStampedReference
&lt;/h2&gt;&lt;p&gt;AtomicStampedReference æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent.atomic&lt;/code&gt;ï¼‰ä¸­è§£å†³ &lt;strong&gt;CAS æ“ä½œ ABA é—®é¢˜&lt;/strong&gt;çš„æ ¸å¿ƒå·¥å…·ã€‚å®ƒé€šè¿‡ä¸ºå¯¹è±¡å¼•ç”¨é™„åŠ ä¸€ä¸ªæ•´æ•°ç‰ˆæœ¬æˆ³ï¼ˆStampï¼‰ï¼Œå®ç°å¯¹å¼•ç”¨å˜åŒ–çš„ç‰ˆæœ¬è¿½è¸ªï¼Œç¡®ä¿å¹¶å‘ä¿®æ”¹çš„å®‰å…¨æ€§ã€‚ä»¥ä¸‹ä»åŸç†ã€å®ç°åˆ°åº”ç”¨åœºæ™¯å±•å¼€åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-aba-é—®é¢˜ä¸è®¾è®¡åŠ¨æœº"&gt;ğŸ” &lt;strong&gt;ABA é—®é¢˜ä¸è®¾è®¡åŠ¨æœº&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ABA é—®é¢˜æœ¬è´¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯æè¿°&lt;/strong&gt;ï¼š
çº¿ç¨‹ T1 è¯»å–å…±äº«å˜é‡å€¼ä¸º A â†’ T2 å°†å€¼æ”¹ä¸º B åå†æ”¹å› A â†’ T1 æ‰§è¡Œ CAS æ“ä½œï¼Œå‘ç°å€¼ä»ä¸º A å¹¶æˆåŠŸæ›´æ–°ã€‚æ­¤æ—¶ T1 â€‹&lt;strong&gt;æ— æ³•æ„ŸçŸ¥ä¸­é—´çŠ¶æ€å˜åŒ–&lt;/strong&gt;â€‹ï¼ˆAâ†’Bâ†’Aï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å±å®³ï¼šåœ¨æ— é”æ•°æ®ç»“æ„ï¼ˆå¦‚æ ˆã€é˜Ÿåˆ—ï¼‰ä¸­å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–é€»è¾‘é”™è¯¯ã€‚
&lt;ul&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šæ— é”æ ˆçš„ &lt;code&gt;pop()&lt;/code&gt; æ“ä½œä¸­ï¼Œè‹¥èŠ‚ç‚¹è¢«ç§»é™¤åé‡æ–°å…¥æ ˆï¼ŒCAS å¯èƒ½è¯¯åˆ¤ä¸ºæœªå˜åŒ–ï¼Œå¯¼è‡´æ ˆç»“æ„ç ´åã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é‡‘èåœºæ™¯ï¼šè´¦æˆ·ä½™é¢è¢«åå¤ä¿®æ”¹åè¿˜åŸï¼Œå¯¼è‡´é‡å¤æ‰£æ¬¾ï¼ˆå¦‚ 100â†’50â†’100â†’æ‰£æ¬¾ 50 æˆåŠŸï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AtomicStampedReference çš„è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæœºåˆ¶&lt;/strong&gt;ï¼š
å°†å¯¹è±¡å¼•ç”¨ &lt;code&gt;V&lt;/code&gt; ä¸æ•´æ•°æˆ³ &lt;code&gt;int stamp&lt;/code&gt; ç»‘å®šï¼Œæ¯æ¬¡æ›´æ–°æ—¶æˆ³é€’å¢ï¼ˆç±»ä¼¼ç‰ˆæœ¬å·ï¼‰ã€‚CAS æ“ä½œéœ€&lt;strong&gt;åŒæ—¶æ ¡éªŒå¼•ç”¨å€¼å’Œæˆ³&lt;/strong&gt;ï¼Œä»»ä¸€ä¸åŒ¹é…åˆ™å¤±è´¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»æ¯”&lt;/strong&gt;ï¼šæ£€æŸ¥ç‰©å“æ—¶ä¸ä»…çœ‹æ˜¯å¦å­˜åœ¨ï¼Œè¿˜éœ€ç¡®è®¤ç‰ˆæœ¬å·æ˜¯å¦å˜åŒ–ï¼ˆå¦‚â€œæˆ¿é—´ç‰©å“æœªå°‘ï¼Œä½†ç‰ˆæœ¬å·å·²å˜ï¼Œè¯´æ˜æ›¾è¢«ç§»åŠ¨â€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°åŸç†ä¸æºç è§£æ"&gt;âš™ï¸ &lt;strong&gt;å®ç°åŸç†ä¸æºç è§£æ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…éƒ¨æ•°æ®ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯å˜ Pair ç±»ï¼šå°è£…å¼•ç”¨ reference å’Œæˆ³
stampï¼Œä¿è¯åŸå­æ›¿æ¢æ—¶çš„çŠ¶æ€ä¸€è‡´æ€§ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt; private static class Pair&amp;lt;T&amp;gt; {
final T reference;
final int stamp; // ç‰ˆæœ¬æˆ³
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;AtomicReference å°è£…&lt;/strong&gt;ï¼š
&lt;code&gt;volatile AtomicReference&amp;lt;Pair&amp;lt;V&amp;gt;&amp;gt; pair&lt;/code&gt; ç¡®ä¿å†…å­˜å¯è§æ€§ï¼Œåº•å±‚é€šè¿‡ &lt;code&gt;Unsafe&lt;/code&gt; æˆ– &lt;code&gt;VarHandle&lt;/code&gt; å®ç° CASã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒæ–¹æ³• &lt;code&gt;compareAndSet&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸå­æ€§ä¿è¯ï¼šåŒæ—¶æ ¡éªŒé¢„æœŸå¼•ç”¨å’Œæˆ³ï¼Œé€šè¿‡åˆ™æ›´æ–°ä¸ºæ–°å¼•ç”¨å’Œæ–°æˆ³ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;compareAndSet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;expectedReference&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;newReference&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;expectedStamp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;newStamp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pair&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pair&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;expectedReference&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;reference&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ ¡éªŒå¼•ç”¨&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;expectedStamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ ¡éªŒæˆ³&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;newReference&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;reference&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é¿å…æ— æ„ä¹‰æ›´æ–°&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;newStamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stamp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;casPair&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pair&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;of&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;newReference&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;newStamp&lt;/span&gt;&lt;span class="p"&gt;)));&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ‰§è¡Œ CAS&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŸ­è·¯ä¼˜åŒ–&lt;/strong&gt;ï¼šè‹¥æ–°å€¼ä¸å½“å‰å€¼ç›¸åŒï¼Œç›´æ¥è¿”å› &lt;code&gt;true&lt;/code&gt; é¿å… CAS å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æˆ³çš„ç®¡ç†&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€’å¢è§„åˆ™&lt;/strong&gt;ï¼šæˆ³é€šå¸¸å•è°ƒé€’å¢ï¼ˆå¦‚ &lt;code&gt;stamp+1&lt;/code&gt;ï¼‰ï¼Œé˜²æ­¢çŠ¶æ€å›æ»šã€‚&lt;/li&gt;
&lt;li&gt;è·å–æ–¹æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;get(int[] stampHolder)&lt;/code&gt;ï¼šè¿”å›å½“å‰å¼•ç”¨ï¼Œå¹¶å°†æˆ³å­˜å…¥æ•°ç»„ &lt;code&gt;stampHolder[0]&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getStamp()&lt;/code&gt;ï¼šç›´æ¥è¿”å›å½“å‰æˆ³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯-1"&gt;âš¡ï¸ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ— é”æ•°æ®ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ ˆ/é˜Ÿåˆ—èŠ‚ç‚¹æ›´æ–°ï¼šæ¯æ¬¡ push/pop æ“ä½œæ—¶é€’å¢æˆ³ï¼Œé˜²æ­¢èŠ‚ç‚¹è¢«å¤ç”¨å¯¼è‡´çš„ ABA é—®é¢˜ã€‚
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// æ— é”æ ˆç¤ºä¾‹ï¼ˆç®€åŒ–ï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;newNode&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;oldTop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getReference&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getStamp&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;newNode&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;next&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;oldTop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareAndSet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;oldTop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;newNode&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stamp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€æœºä¸èµ„æºç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®¢å•çŠ¶æ€æµè½¬&lt;/strong&gt;ï¼š
çŠ¶æ€ä» &lt;code&gt;UNPAIDâ†’PAIDâ†’REFUNDâ†’UNPAID&lt;/code&gt; æ—¶ï¼Œæˆ³çš„å˜åŒ–å¯é¿å…è¯¯åˆ¤ä¸ºåˆå§‹çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†å¸ƒå¼å¼€å…³æ§åˆ¶ï¼šæœåŠ¡å¯åœæ—¶é€šè¿‡æˆ³æ ¡éªŒé˜²æ­¢é‡å¤æ“ä½œï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SafeSwitch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AtomicStampedReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Boolean&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AtomicStampedReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;turnOn&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stamp&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareAndSet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stamp&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stamp&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ± å¯¹è±¡å¤ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹è±¡ä»æ± ä¸­å–å‡ºâ†’ä¿®æ”¹â†’æ”¾å›æ—¶ï¼Œæˆ³å¯æ£€æµ‹å¯¹è±¡æ˜¯å¦è¢«ç¯¡æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å…¶ä»–æ–¹æ¡ˆçš„å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ä¸å…¶ä»–æ–¹æ¡ˆçš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ABA é˜²æŠ¤&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;AtomicStampedReference&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼•ç”¨ + æ•´æ•°ç‰ˆæœ¬æˆ³&lt;/td&gt;
&lt;td&gt;å¼ºï¼ˆçŠ¶æ€ç©ºé—´å¤§ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€ç²¾ç»†ç‰ˆæœ¬æ§åˆ¶çš„åœºæ™¯&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;AtomicMarkableReference&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼•ç”¨ + å¸ƒå°”æ ‡è®°&lt;/td&gt;
&lt;td&gt;å¼±ï¼ˆä»…ä¸¤ç§çŠ¶æ€ï¼‰&lt;/td&gt;
&lt;td&gt;ç®€å•çŠ¶æ€æ ‡è®°ï¼ˆå¦‚â€œå·²è¯»â€ï¼‰&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¹è§‚é”ï¼ˆæ•°æ®åº“ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³&lt;/td&gt;
&lt;td&gt;å¼º&lt;/td&gt;
&lt;td&gt;æ•°æ®åº“äº‹åŠ¡&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº’æ–¥é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å®Œå…¨ä¸²è¡ŒåŒ–&lt;/td&gt;
&lt;td&gt;æ— é£é™©&lt;/td&gt;
&lt;td&gt;å¤æ‚äº‹åŠ¡&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€ä¸¥æ ¼ç‰ˆæœ¬æ§åˆ¶æ—¶é€‰ &lt;code&gt;AtomicStampedReference&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ä»…éœ€äºŒå…ƒçŠ¶æ€æ—¶ç”¨ &lt;code&gt;AtomicMarkableReference&lt;/code&gt; æ›´è½»é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å±€é™æ€§ä¸æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å±€é™æ€§ä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æˆ³æº¢å‡ºé£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;int&lt;/code&gt; ç±»å‹æˆ³å¯èƒ½ä» &lt;code&gt;Integer.MAX_VALUE&lt;/code&gt; æº¢å‡ºåˆ° &lt;code&gt;Integer.MIN_VALUE&lt;/code&gt;ï¼Œå¯¼è‡´ç‰ˆæœ¬å›é€€è¯¯åˆ¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šç›‘æ§æˆ³èŒƒå›´æˆ–ä½¿ç”¨ &lt;code&gt;long&lt;/code&gt; ç±»å‹ï¼ˆéœ€è‡ªå®šä¹‰å®ç°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯æ¬¡ CAS éœ€åˆ›å»ºæ–° &lt;code&gt;Pair&lt;/code&gt; å¯¹è±¡ï¼Œå¢åŠ  GC å‹åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æ— ç«äº‰åœºæ™¯ä¸‹ï¼Œæ€§èƒ½ä¼˜äºé”ï¼›é«˜ç«äº‰æ—¶å¯èƒ½å› è‡ªæ—‹æ¶ˆè€— CPUã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­£ç¡®ä½¿ç”¨è§„èŒƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æˆ³å¿…é¡»é€’å¢&lt;/strong&gt;ï¼šè‹¥å›æ»šæˆ³å€¼ï¼ˆå¦‚é‡ç½®ä¸ºæ—§å€¼ï¼‰ï¼ŒABA é—®é¢˜å¯èƒ½é‡ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼ºåˆ¶æ ¡éªŒæˆ³&lt;/strong&gt;ï¼šä¸šåŠ¡é€»è¾‘éœ€ä¾èµ–æˆ³çš„å˜åŒ–ï¼Œè€Œéä»…å¼•ç”¨å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;AtomicStampedReference&lt;/code&gt; é€šè¿‡&lt;strong&gt;å¼•ç”¨+ç‰ˆæœ¬æˆ³&lt;/strong&gt;çš„äºŒå…ƒæ ¡éªŒæœºåˆ¶ï¼Œä¸ºæ— é”å¹¶å‘æä¾›äº†å¯é çš„ ABA é—®é¢˜è§£å†³æ–¹æ¡ˆã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€è¿½è¸ª&lt;/strong&gt;ï¼šæˆ³çš„é€’å¢å”¯ä¸€æ ‡è¯†å¼•ç”¨å˜åŒ–å†å²ï¼Œé¿å…éšè”½çš„ä¸­é—´çŠ¶æ€ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é”å¹¶å‘&lt;/strong&gt;ï¼šåŸºäº CAS å®ç°é«˜æ€§èƒ½çº¿ç¨‹å®‰å…¨ï¼Œé€‚ç”¨äºæ ˆã€é˜Ÿåˆ—ã€çŠ¶æ€æœºç­‰åœºæ™¯ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´£ä»»è½¬ç§»&lt;/strong&gt;ï¼šå°† ABA é£é™©ä»ä¸šåŠ¡é€»è¾‘å‰¥ç¦»è‡³åº•å±‚æ¡†æ¶ï¼Œæå‡ä»£ç å¥å£®æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…å¼€å‘ä¸­ï¼Œä¼˜å…ˆç”¨äºéœ€ä¸¥æ ¼ç‰ˆæœ¬æ§åˆ¶çš„å¹¶å‘ç»“æ„ï¼Œå¹¶éµå¾ª &lt;strong&gt;æˆ³é€’å¢+åŠæ—¶æ¸…ç†&lt;/strong&gt; åŸåˆ™ï¼Œä»¥è§„é¿æº¢å‡ºä¸æ€§èƒ½é™·é˜±ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="volatile"&gt;volatile
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;volatile&lt;/code&gt; æ˜¯ Java ä¸­ç”¨äºå¤šçº¿ç¨‹ç¼–ç¨‹çš„å…³é”®å­—ï¼Œä¸»è¦è§£å†³å…±äº«å˜é‡çš„&lt;strong&gt;å¯è§æ€§&lt;/strong&gt;å’Œ&lt;strong&gt;æŒ‡ä»¤é‡æ’åº&lt;/strong&gt;é—®é¢˜ï¼Œä½†&lt;strong&gt;ä¸ä¿è¯åŸå­æ€§&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒä½œç”¨"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å¯è§æ€§ï¼ˆVisibilityï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ™®é€šå˜é‡çš„ä¿®æ”¹å¯èƒ½ä»…å­˜åœ¨äºçº¿ç¨‹çš„æœ¬åœ°å†…å­˜ï¼ˆå¦‚ CPU ç¼“å­˜ï¼‰ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•ç«‹å³æ„ŸçŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;volatile&lt;/code&gt; å˜é‡&lt;strong&gt;æ¯æ¬¡å†™æ“ä½œç›´æ¥åˆ·æ–°åˆ°ä¸»å†…å­˜&lt;/strong&gt;ï¼Œ&lt;strong&gt;æ¯æ¬¡è¯»æ“ä½œä»ä¸»å†…å­˜é‡æ–°åŠ è½½&lt;/strong&gt;ï¼Œç¡®ä¿æ‰€æœ‰çº¿ç¨‹çœ‹åˆ°æœ€æ–°å€¼ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;private volatile boolean running = true;
// çº¿ç¨‹Aä¿®æ”¹ running=false åï¼Œçº¿ç¨‹Bèƒ½ç«‹å³é€€å‡ºå¾ªç¯
while (running) { /* ä»»åŠ¡ */ }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼ˆOrderingï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯èƒ½ä¸ºä¼˜åŒ–æ€§èƒ½é‡æ’æŒ‡ä»¤é¡ºåºï¼Œå¯¼è‡´å¤šçº¿ç¨‹é€»è¾‘é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;volatile é€šè¿‡å†…å­˜å±éšœï¼ˆMemory Barrierï¼‰ç¦æ­¢é‡æ’åºï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†™æ“ä½œ&lt;/strong&gt;å‰æ’å…¥ &lt;code&gt;StoreStore&lt;/code&gt; å±éšœï¼Œåæ’å…¥ &lt;code&gt;StoreLoad&lt;/code&gt; å±éšœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯»æ“ä½œ&lt;/strong&gt;å‰æ’å…¥ &lt;code&gt;LoadLoad&lt;/code&gt; å±éšœï¼Œåæ’å…¥ &lt;code&gt;LoadStore&lt;/code&gt; å±éšœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…¸å‹åœºæ™¯ï¼šå•ä¾‹æ¨¡å¼çš„åŒé‡æ£€æŸ¥é”å®šï¼ˆDouble-Checked Lockingï¼‰ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Singleton&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;volatile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;getInstance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;synchronized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é¿å…é‡æ’åºå¯¼è‡´æœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡æš´éœ²&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å±€é™æ€§ä¸ä¿è¯åŸå­æ€§"&gt;âš ï¸ &lt;strong&gt;å±€é™æ€§ï¼šä¸ä¿è¯åŸå­æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ€§é—®é¢˜&lt;/strong&gt;ï¼š&lt;code&gt;volatile&lt;/code&gt; ä»…ä¿è¯å•æ¬¡è¯»/å†™çš„åŸå­æ€§ï¼ˆå¦‚ &lt;code&gt;long/double&lt;/code&gt; çš„ 64 ä½æ“ä½œï¼‰ï¼Œä½†&lt;strong&gt;å¤åˆæ“ä½œï¼ˆå¦‚ &lt;code&gt;i++&lt;/code&gt;ï¼‰ä»éåŸå­&lt;/strong&gt;ï¼Œå› ä¸ºåŒ…å«â€œè¯»-æ”¹-å†™â€ä¸‰æ­¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;synchronized&lt;/code&gt; æˆ– &lt;code&gt;Lock&lt;/code&gt; ä¿è¯ä»£ç å—åŸå­æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;AtomicInteger&lt;/code&gt; ç­‰åŸå­ç±»ï¼ˆåŸºäº CAS å®ç°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°åŸç†"&gt;ğŸ”§ &lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å±éšœ&lt;/strong&gt;
JVM åœ¨ç¼–è¯‘æ—¶æ’å…¥å±éšœæŒ‡ä»¤ï¼Œå¼ºåˆ¶åˆ·æ–°ä¸»å†…å­˜æ•°æ®å¹¶é™åˆ¶é‡æ’åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ä¸€è‡´æ€§åè®®&lt;/strong&gt;ï¼ˆå¦‚ MESIï¼‰
å¤šæ ¸ CPU é€šè¿‡å—…æ¢æ€»çº¿ï¼Œå‘ç° &lt;code&gt;volatile&lt;/code&gt; å˜é‡ä¿®æ”¹åï¼Œå°†å…¶ä»–æ ¸å¿ƒçš„ç¼“å­˜è¡Œè®¾ä¸ºæ— æ•ˆï¼Œå¼ºåˆ¶ä»ä¸»å†…å­˜åŠ è½½æ–°å€¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯"&gt;ğŸ› ï¸ &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€æ ‡å¿—ä½&lt;/strong&gt;
ç®€å•å¸ƒå°”å˜é‡æ§åˆ¶çº¿ç¨‹æ‰§è¡Œï¼ˆå¦‚åœæ­¢å¾ªç¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€æ¬¡æ€§å‘å¸ƒ&lt;/strong&gt;
ç¡®ä¿å¯¹è±¡åˆå§‹åŒ–å®Œæˆå‰ä¸è¢«å¼•ç”¨ï¼ˆå¦‚å•ä¾‹æ¨¡å¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‹¬ç«‹è§‚å¯Ÿ&lt;/strong&gt;
å®šæœŸæ›´æ–°ä¾›å¤šçº¿ç¨‹è¯»å–çš„å˜é‡ï¼ˆå¦‚å¿ƒè·³æ ‡è®°ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-volatile"&gt;â†”ï¸ &lt;strong&gt;&lt;code&gt;volatile&lt;/code&gt; vs &lt;code&gt;synchronized&lt;/code&gt;&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;&lt;code&gt;volatile&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;synchronized&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯è§æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç›´æ¥è¯»å†™ä¸»å†…å­˜&lt;/td&gt;
&lt;td&gt;âœ… é”é‡Šæ”¾æ—¶åˆ·æ–°ä¸»å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç¦æ­¢é‡æ’åº&lt;/td&gt;
&lt;td&gt;âœ… ä¸²è¡Œæ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä»…å•æ¬¡è¯»/å†™&lt;/td&gt;
&lt;td&gt;âœ… ä»£ç å—/æ–¹æ³•çº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— é˜»å¡&lt;/td&gt;
&lt;td&gt;âœ… çº¿ç¨‹ç«äº‰é”æ—¶é˜»å¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆæ— ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆé”ç«äº‰ã€å†…æ ¸åˆ‡æ¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰æ‹©åŸåˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»…éœ€å¯è§æ€§/æœ‰åºæ€§ â†’ &lt;code&gt;volatile&lt;/code&gt;ï¼ˆå¦‚çŠ¶æ€æ ‡å¿—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éœ€åŸå­æ€§æˆ–å¤åˆæ“ä½œ â†’ &lt;code&gt;synchronized&lt;/code&gt; æˆ–åŸå­ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éä¸‡èƒ½æ›¿ä»£é”&lt;/strong&gt;ï¼šä»…å½“å˜é‡ç‹¬ç«‹äºå…¶ä»–çŠ¶æ€æ—¶é€‚ç”¨ï¼ˆå¦‚ &lt;code&gt;flag&lt;/code&gt; ä¸ä¾èµ–å…¶ä»–å˜é‡å€¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;ï¼šé¢‘ç¹è¯»å†™ &lt;code&gt;volatile&lt;/code&gt; å˜é‡å› ä¸»å†…å­˜åŒæ­¥ç•¥æ…¢äºæ™®é€šå˜é‡ï¼Œä½†ä»ä¼˜äºé”ã€‚
é€šè¿‡åˆç†ä½¿ç”¨ &lt;code&gt;volatile&lt;/code&gt;ï¼Œå¯åœ¨è½»é‡çº§åŒæ­¥éœ€æ±‚ä¸­å¹³è¡¡æ€§èƒ½ä¸çº¿ç¨‹å®‰å…¨ï¼Œä½†éœ€ä¸¥æ ¼åŒºåˆ†å…¶ä¸é”çš„é€‚ç”¨è¾¹ç•Œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="synchronized"&gt;synchronized
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å¯¹ Java ä¸­ &lt;code&gt;synchronized&lt;/code&gt; å…³é”®å­—çš„è¯¦ç»†è§£æï¼Œç»“åˆå…¶ä½œç”¨ã€ç”¨æ³•ã€åº•å±‚å®ç°åŠæœ€ä½³å®è·µï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-synchronized"&gt;âš™ï¸ &lt;strong&gt;&lt;code&gt;synchronized&lt;/code&gt; çš„æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;äº’æ–¥æ€§ï¼ˆMutexï¼‰
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿åŒä¸€æ—¶åˆ»ä»…æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œè¢«ä¿®é¥°çš„ä»£ç å—æˆ–æ–¹æ³•ï¼Œé¿å…å¤šçº¿ç¨‹å¹¶å‘ä¿®æ”¹å…±äº«èµ„æºå¯¼è‡´çš„&lt;strong&gt;ç«æ€æ¡ä»¶&lt;/strong&gt;ï¼ˆRace Conditionï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯è§æ€§ï¼ˆVisibilityï¼‰
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹åœ¨é‡Šæ”¾é”å‰ï¼Œå¼ºåˆ¶å°†æœ¬åœ°å†…å­˜ä¸­çš„å˜é‡ä¿®æ”¹åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼›è·å–é”æ—¶ï¼Œä»ä¸»å†…å­˜é‡æ–°åŠ è½½å˜é‡å€¼ï¼Œä¿è¯å…¶ä»–çº¿ç¨‹çœ‹åˆ°æœ€æ–°æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æœ‰åºæ€§ï¼ˆOrderingï¼‰
&lt;ul&gt;
&lt;li&gt;é€šè¿‡é”æœºåˆ¶ç¦æ­¢ç¼–è¯‘å™¨æˆ–å¤„ç†å™¨å¯¹åŒæ­¥ä»£ç å—å†…çš„æŒ‡ä»¤é‡æ’åºï¼Œç¡®ä¿ä»£ç æŒ‰é¡ºåºæ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-synchronized-1"&gt;ğŸ› ï¸ &lt;strong&gt;&lt;code&gt;synchronized&lt;/code&gt; çš„ä¸‰ç§ç”¨æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¿®é¥°å®ä¾‹æ–¹æ³•"&gt;&lt;strong&gt;ä¿®é¥°å®ä¾‹æ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”å¯¹è±¡&lt;/strong&gt;ï¼šå½“å‰å®ä¾‹ï¼ˆ&lt;code&gt;this&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨èŒƒå›´&lt;/strong&gt;ï¼šæ•´ä¸ªæ–¹æ³•ä½“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public synchronized void increment() {
count++; // çº¿ç¨‹å®‰å…¨çš„å¤åˆæ“ä½œ
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šä¿æŠ¤å¯¹è±¡å®ä¾‹å†…çš„å…±äº«å˜é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¿®é¥°é™æ€æ–¹æ³•"&gt;&lt;strong&gt;ä¿®é¥°é™æ€æ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”å¯¹è±¡&lt;/strong&gt;ï¼šç±»çš„ &lt;code&gt;Class&lt;/code&gt; å¯¹è±¡ï¼ˆå¦‚ &lt;code&gt;MyClass.class&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨èŒƒå›´&lt;/strong&gt;ï¼šæ‰€æœ‰å®ä¾‹å…±äº«åŒä¸€æŠŠé”ï¼Œå½±å“æ•´ä¸ªç±»çš„&lt;strong&gt;é™æ€èµ„æº&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public static synchronized void staticMethod() {
// æ“ä½œé™æ€å˜é‡
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šä¿æŠ¤é™æ€å˜é‡æˆ–ç±»çº§èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¿®é¥°ä»£ç å—"&gt;&lt;strong&gt;ä¿®é¥°ä»£ç å—&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”å¯¹è±¡&lt;/strong&gt;ï¼šä»»æ„æ˜¾å¼æŒ‡å®šçš„å¯¹è±¡ï¼ˆå¦‚ &lt;code&gt;Object lock = new Object()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨èŒƒå›´&lt;/strong&gt;ï¼šä»…åŒæ­¥ä»£ç å—å†…éƒ¨ï¼Œæ”¯æŒç»†ç²’åº¦æ§åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public void method() {
synchronized (lockObj) { // è‡ªå®šä¹‰é”å¯¹è±¡
// ä»…åŒæ­¥å…³é”®ä»£ç 
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå‡å°‘é”èŒƒå›´ï¼Œæå‡å¹¶å‘æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-ä¸‰ç§ç”¨æ³•å¯¹æ¯”"&gt;ğŸ” &lt;strong&gt;ä¸‰ç§ç”¨æ³•å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç”¨æ³•ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é”å¯¹è±¡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨åŸŸ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¿®é¥°å®ä¾‹æ–¹æ³•&lt;/td&gt;
&lt;td&gt;&lt;code&gt;this&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ•´ä¸ªæ–¹æ³•ä½“&lt;/td&gt;
&lt;td&gt;ä¿æŠ¤å®ä¾‹å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¿®é¥°é™æ€æ–¹æ³•&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Class&lt;/code&gt; å¯¹è±¡&lt;/td&gt;
&lt;td&gt;æ•´ä¸ªç±»&lt;/td&gt;
&lt;td&gt;ä¿æŠ¤é™æ€å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¿®é¥°ä»£ç å—&lt;/td&gt;
&lt;td&gt;è‡ªå®šä¹‰å¯¹è±¡&lt;/td&gt;
&lt;td&gt;ä»£ç å—å†…éƒ¨&lt;/td&gt;
&lt;td&gt;ç»†ç²’åº¦æ§åˆ¶ï¼Œå‡å°‘é”ç«äº‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°åŸç†"&gt;âš™ï¸ &lt;strong&gt;åº•å±‚å®ç°åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Monitor æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ª Java å¯¹è±¡å…³è”ä¸€ä¸ª&lt;strong&gt;ç›‘è§†å™¨é”ï¼ˆMonitorï¼‰&lt;/strong&gt;ï¼Œé€šè¿‡å­—èŠ‚ç æŒ‡ä»¤ &lt;code&gt;monitorenter&lt;/code&gt; å’Œ &lt;code&gt;monitorexit&lt;/code&gt; å®ç°é”çš„è·å–ä¸é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹è¿›å…¥åŒæ­¥å—æ—¶å°è¯•è·å–é”ï¼ŒæˆåŠŸåˆ™æ‰§è¡Œä»£ç ï¼›å¤±è´¥åˆ™é˜»å¡ç›´è‡³é”é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”å‡çº§ä¼˜åŒ–ï¼ˆJDK 1.6+ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— é” â†’ åå‘é”&lt;/strong&gt;ï¼šé¦–æ¬¡è·å–é”æ—¶æ ‡è®°åå‘çº¿ç¨‹ï¼Œé¿å…é‡å¤ CAS å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åå‘é” â†’ è½»é‡çº§é”&lt;/strong&gt;ï¼šå¤šçº¿ç¨‹ç«äº‰æ—¶ï¼Œé€šè¿‡ CAS è‡ªæ—‹å°è¯•è·å–é”ï¼ˆå‡å°‘é˜»å¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡çº§é” â†’ é‡é‡çº§é”&lt;/strong&gt;ï¼šè‡ªæ—‹å¤±è´¥åå‡çº§ä¸ºæ“ä½œç³»ç»Ÿçº§äº’æ–¥é”ï¼ˆMutexï¼‰ï¼Œçº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›®çš„&lt;/strong&gt;ï¼šå¹³è¡¡æ€§èƒ½ä¸çº¿ç¨‹å®‰å…¨ï¼Œå‡å°‘é”æ“ä½œçš„å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…æ­»é”&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿å¤šçº¿ç¨‹è·å–é”çš„é¡ºåºä¸€è‡´ï¼ˆå¦‚ï¼šæŒ‰å›ºå®šé¡ºåºé”å®šå¤šä¸ªå¯¹è±¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// ç¤ºä¾‹ï¼šæŒ‰é”å¯¹è±¡çš„å›ºå®šé¡ºåºåŠ é”&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lockOrder&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;obj2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lockOrder&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;synchronized&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;synchronized&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°é”ç²’åº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨&lt;strong&gt;åŒæ­¥ä»£ç å—&lt;/strong&gt;æ›¿ä»£åŒæ­¥æ–¹æ³•ï¼Œä»…é”å®šå¿…è¦èµ„æºï¼ˆå¦‚ &lt;code&gt;FineGrainLock&lt;/code&gt; ç±»ä¸­çš„åˆ†æ®µé”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œè€ƒè™‘ &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼ˆæ”¯æŒå…¬å¹³é”ã€å¯ä¸­æ–­ï¼‰æˆ– &lt;code&gt;StampedLock&lt;/code&gt;ï¼ˆä¹è§‚è¯»é”ï¼‰æå‡æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•ä¾‹æ¨¡å¼çš„åŒé‡æ£€æŸ¥é”å®šï¼ˆDCLï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç»“åˆ &lt;code&gt;volatile&lt;/code&gt; é˜²æ­¢æŒ‡ä»¤é‡æ’åºå¯¼è‡´æœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡è¢«æš´éœ²ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Singleton&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;volatile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;getInstance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;synchronized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-synchronized-2"&gt;â†”ï¸ &lt;strong&gt;&lt;code&gt;synchronized&lt;/code&gt; vs &lt;code&gt;volatile&lt;/code&gt;&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;synchronized&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;volatile&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ä¿è¯å¤åˆæ“ä½œï¼ˆå¦‚ &lt;code&gt;i++&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ä»…ä¿è¯å•æ¬¡è¯»/å†™çš„åŸå­æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯è§æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… é€šè¿‡é”åˆ·æ–°ä¸»å†…å­˜&lt;/td&gt;
&lt;td&gt;âœ… ç›´æ¥è¯»å†™ä¸»å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç¦æ­¢åŒæ­¥å—å†…æŒ‡ä»¤é‡æ’åº&lt;/td&gt;
&lt;td&gt;âœ… ç¦æ­¢å˜é‡ç›¸å…³æŒ‡ä»¤é‡æ’åº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº’æ–¥æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… åŒä¸€æ—¶é—´ä»…ä¸€ä¸ªçº¿ç¨‹è®¿é—®&lt;/td&gt;
&lt;td&gt;âŒ å…è®¸å¤šçº¿ç¨‹å¹¶å‘è¯»å†™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ï¼ˆé”ç«äº‰ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒä½ï¼ˆæ— é”æœºåˆ¶ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤æ‚é€»è¾‘æˆ–å¤šæ­¥æ“ä½œ&lt;/td&gt;
&lt;td&gt;å•ä¸€çŠ¶æ€æ ‡å¿—ï¼ˆå¦‚ &lt;code&gt;boolean flag&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰æ‹©åŸåˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€åŸå­æ€§ â†’ &lt;code&gt;synchronized&lt;/code&gt; æˆ–åŸå­ç±»ï¼ˆ&lt;code&gt;AtomicInteger&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»…éœ€å¯è§æ€§ â†’ &lt;code&gt;volatile&lt;/code&gt;ï¼ˆå¦‚çŠ¶æ€æ ‡å¿—ä½ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;synchronized&lt;/code&gt; æ˜¯ Java çº¿ç¨‹å®‰å…¨çš„åŸºçŸ³ï¼Œé€šè¿‡ &lt;strong&gt;äº’æ–¥æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§&lt;/strong&gt; è§£å†³å¹¶å‘é—®é¢˜ã€‚ä½¿ç”¨æ—¶éœ€æ³¨æ„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é”ç²’åº¦&lt;/strong&gt;ï¼šä¼˜å…ˆç”¨ä»£ç å—ç¼©å°åŒæ­¥èŒƒå›´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”é¡ºåº&lt;/strong&gt;ï¼šé¿å…æ­»é”ï¼Œå›ºå®šå¤šé”è·å–é¡ºåºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;ï¼šé«˜å¹¶å‘åœºæ™¯è€ƒè™‘ &lt;code&gt;ReentrantLock&lt;/code&gt; ç­‰æ›¿ä»£æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤åˆæ“ä½œ&lt;/strong&gt;ï¼šç¡®ä¿åŸå­æ€§éœ€ä¾èµ–é”æœºåˆ¶è€Œé &lt;code&gt;volatile&lt;/code&gt;ã€‚
åˆç†è¿ç”¨ &lt;code&gt;synchronized&lt;/code&gt; å¯é«˜æ•ˆæ„å»ºçº¿ç¨‹å®‰å…¨ç¨‹åºï¼Œä½†éœ€ç»“åˆåœºæ™¯é€‰æ‹©æœ€ä¼˜åŒæ­¥ç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="object-monitor"&gt;Object Monitor
&lt;/h2&gt;&lt;p&gt;Object Monitorï¼ˆç›‘è§†å™¨é”ï¼‰æ˜¯ Java ä¸­å®ç°çº¿ç¨‹åŒæ­¥çš„æ ¸å¿ƒåº•å±‚æœºåˆ¶ï¼Œä¸æ¯ä¸ª Java å¯¹è±¡å…³è”ï¼Œé€šè¿‡ &lt;code&gt;synchronized&lt;/code&gt;å…³é”®å­—è§¦å‘ã€‚å…¶å·¥ä½œåŸç†åŸºäº JVM åº•å±‚çš„ &lt;code&gt;ObjectMonitor&lt;/code&gt; ç±»ï¼ˆC++å®ç°ï¼‰ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-monitor-é”çš„æ ¸å¿ƒç»“æ„"&gt;ğŸ”’ &lt;strong&gt;Monitor é”çš„æ ¸å¿ƒç»“æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ¯ä¸ª Java å¯¹è±¡åœ¨å †å†…å­˜ä¸­å‡å…³è”ä¸€ä¸ª &lt;code&gt;ObjectMonitor&lt;/code&gt; å¯¹è±¡ï¼Œå…³é”®å­—æ®µå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å­—æ®µ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;_owner&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŒ‡å‘æŒæœ‰é”çš„çº¿ç¨‹ï¼ˆ&lt;code&gt;null&lt;/code&gt; è¡¨ç¤ºé”æœªè¢«å ç”¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;_EntryList&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨ç­‰å¾…è·å–é”çš„é˜»å¡çº¿ç¨‹é˜Ÿåˆ—ï¼ˆç«äº‰é”å¤±è´¥æ—¶è¿›å…¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;_WaitSet&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å­˜å‚¨å› è°ƒç”¨ &lt;code&gt;wait()&lt;/code&gt; è€Œä¸»åŠ¨æ”¾å¼ƒé”çš„çº¿ç¨‹é˜Ÿåˆ—ï¼ˆç­‰å¾…å”¤é†’ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;_recursions&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®°å½•é”çš„é‡å…¥æ¬¡æ•°ï¼ˆåŒä¸€çº¿ç¨‹å¤šæ¬¡è·å–é”æ—¶é€’å¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;_count&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é”è®¡æ•°å™¨ï¼ˆçº¿ç¨‹è·å–é”æ—¶ &lt;code&gt;+1&lt;/code&gt;ï¼Œé‡Šæ”¾æ—¶ &lt;code&gt;-1&lt;/code&gt;ï¼Œ&lt;code&gt;0&lt;/code&gt; è¡¨ç¤ºå¯è¢«ç«äº‰ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;å¯¹è±¡å¤´å…³è”&lt;/strong&gt;ï¼šå¯¹è±¡çš„ Mark Word ä¸­é”æ ‡å¿—ä½ä¸º &lt;code&gt;10&lt;/code&gt; æ—¶ï¼ˆé‡é‡çº§é”ï¼‰ï¼Œå­˜å‚¨æŒ‡å‘ &lt;code&gt;ObjectMonitor&lt;/code&gt; çš„æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-monitor-é”çš„å·¥ä½œæµç¨‹"&gt;âš™ï¸ &lt;strong&gt;Monitor é”çš„å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŠ é”æµç¨‹"&gt;&lt;strong&gt;åŠ é”æµç¨‹ï¼ˆ&lt;code&gt;monitorenter&lt;/code&gt; æŒ‡ä»¤ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— ç«äº‰&lt;/strong&gt;ï¼šè‹¥ &lt;code&gt;_owner&lt;/code&gt; ä¸º &lt;code&gt;null&lt;/code&gt;ï¼Œçº¿ç¨‹é€šè¿‡ CAS æ“ä½œå°† &lt;code&gt;_owner&lt;/code&gt; è®¾ä¸ºè‡ªå·±ï¼Œ&lt;code&gt;_count&lt;/code&gt; å’Œ &lt;code&gt;_recursions&lt;/code&gt; ç½®ä¸º &lt;code&gt;1&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”é‡å…¥&lt;/strong&gt;ï¼šè‹¥ &lt;code&gt;_owner&lt;/code&gt; æ˜¯å½“å‰çº¿ç¨‹ï¼Œ&lt;code&gt;_recursions++&lt;/code&gt;ï¼ˆä½“ç°å¯é‡å…¥æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç«äº‰å¤±è´¥ï¼š
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹è¿›å…¥ &lt;code&gt;_EntryList&lt;/code&gt; é˜Ÿåˆ—é˜»å¡ï¼ˆLinux ä¸‹é€šè¿‡ &lt;code&gt;pthread_mutex_lock&lt;/code&gt; å®ç° OS çº§é˜»å¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‹¥å¼€å¯è‡ªæ—‹é”ï¼ˆJDK 6+ é»˜è®¤ï¼‰ï¼Œçº¿ç¨‹å…ˆè‡ªæ—‹å°è¯•è·å–é”ï¼ˆé¿å…ç«‹åˆ»é˜»å¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é‡Šæ”¾é”"&gt;&lt;strong&gt;é‡Šæ”¾é”ï¼ˆ&lt;code&gt;monitorexit&lt;/code&gt; æŒ‡ä»¤ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å°† _recursions å‡ 1 ï¼Œè‹¥ç»“æœä¸º 0 ï¼š
&lt;ul&gt;
&lt;li&gt;é‡ç½® &lt;code&gt;_owner&lt;/code&gt; ä¸º &lt;code&gt;null&lt;/code&gt;ï¼Œ&lt;code&gt;_count&lt;/code&gt; å‡ &lt;code&gt;1&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å”¤é†’ &lt;code&gt;_EntryList&lt;/code&gt; ä¸­çš„é¦–ä¸ªçº¿ç¨‹ï¼ˆéå…¬å¹³é”ï¼‰æˆ–æŒ‰ FIFO å”¤é†’ï¼ˆå…¬å¹³é”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="wait"&gt;&lt;strong&gt;&lt;code&gt;wait()&lt;/code&gt; ä¸ &lt;code&gt;notify()&lt;/code&gt; æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;wait()ï¼š
&lt;ul&gt;
&lt;li&gt;æŒæœ‰é”çš„çº¿ç¨‹è°ƒç”¨ wait()åï¼š
&lt;ol&gt;
&lt;li&gt;é‡Šæ”¾é”ï¼ˆ&lt;code&gt;_owner=null&lt;/code&gt;ï¼Œ&lt;code&gt;_count--&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹å°è£…ä¸º &lt;code&gt;ObjectWaiter&lt;/code&gt; èŠ‚ç‚¹åŠ å…¥ &lt;code&gt;_WaitSet&lt;/code&gt; é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç­‰å¾…å”¤é†’ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;notify()ï¼š
&lt;ul&gt;
&lt;li&gt;ä» &lt;code&gt;_WaitSet&lt;/code&gt; ä¸­ç§»å‡ºé¦–ä¸ªçº¿ç¨‹èŠ‚ç‚¹ï¼ŒåŠ å…¥ &lt;code&gt;_EntryList&lt;/code&gt; å‚ä¸é”ç«äº‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;notifyAll()&lt;/code&gt;&lt;/strong&gt;ï¼šç§»å‡º &lt;code&gt;_WaitSet&lt;/code&gt; ä¸­æ‰€æœ‰çº¿ç¨‹èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šè°ƒç”¨ &lt;code&gt;wait()/notify()&lt;/code&gt; å‰éœ€æŒæœ‰é”ï¼Œå¦åˆ™æŠ›å‡º &lt;code&gt;IllegalMonitorStateException&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é”å‡çº§ä¸é‡é‡çº§é”çš„å…³ç³»"&gt;ğŸ”„ &lt;strong&gt;é”å‡çº§ä¸é‡é‡çº§é”çš„å…³ç³»&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å½“è½»é‡çº§é”/åå‘é”ç«äº‰åŠ å‰§æ—¶ï¼Œä¼šå‡çº§ä¸ºé‡é‡çº§é”ï¼ˆMonitor é”ï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‡çº§æ¡ä»¶ï¼š
&lt;ul&gt;
&lt;li&gt;è‡ªæ—‹è·å–è½»é‡çº§é”å¤±è´¥ï¼ˆé»˜è®¤è‡ªæ—‹ &lt;code&gt;10&lt;/code&gt; æ¬¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤šçº¿ç¨‹æ¿€çƒˆç«äº‰åŒä¸€èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‡çº§è¿‡ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹è±¡å¤´ä¸­çš„é”æ ‡å¿—ä½å˜ä¸º &lt;code&gt;10&lt;/code&gt;ï¼ˆé‡é‡çº§é”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Mark Word æŒ‡å‘ &lt;code&gt;ObjectMonitor&lt;/code&gt; åœ°å€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½å½±å“ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå½»åº•è§£å†³ç«äº‰é—®é¢˜ï¼ˆé€šè¿‡ OS é˜»å¡é˜Ÿåˆ—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šçº¿ç¨‹é˜»å¡/å”¤é†’æ¶‰åŠç”¨æˆ·æ€-å†…æ ¸æ€åˆ‡æ¢ï¼Œæ€§èƒ½å¼€é”€å¤§ï¼ˆå¾®ç§’çº§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-monitor-é”çš„ç‰¹æ€§æ€»ç»“"&gt;âš–ï¸ &lt;strong&gt;Monitor é”çš„ç‰¹æ€§æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯é‡å…¥æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å–é”æ—¶ï¼Œ&lt;code&gt;_recursions&lt;/code&gt; é€’å¢ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éå…¬å¹³æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é»˜è®¤å”¤é†’ &lt;code&gt;_EntryList&lt;/code&gt; é˜Ÿé¦–çº¿ç¨‹ï¼ˆå…è®¸æ–°çº¿ç¨‹æ’é˜Ÿç«äº‰ï¼Œæé«˜ååï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¡ä»¶ç­‰å¾…&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;code&gt;_WaitSet&lt;/code&gt; å®ç°ç²¾ç»†çš„çº¿ç¨‹ç­‰å¾…/å”¤é†’æœºåˆ¶ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº’æ–¥æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…ä¸€ä¸ªçº¿ç¨‹å¯æŒæœ‰é”ï¼ˆ&lt;code&gt;_owner&lt;/code&gt; å”¯ä¸€æ€§ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹"&gt;ğŸ’¡ &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é€‚ç”¨åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜ç«äº‰ã€é•¿è€—æ—¶åŒæ­¥æ“ä½œï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ± ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éœ€ç²¾ç»†æ§åˆ¶çº¿ç¨‹ç­‰å¾…/å”¤é†’çš„å¤æ‚åŒæ­¥é€»è¾‘ï¼ˆå¦‚ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–å»ºè®®ï¼š
&lt;ul&gt;
&lt;li&gt;å‡å°‘åŒæ­¥èŒƒå›´ï¼ˆå¦‚ç”¨åŒæ­¥å—æ›¿ä»£åŒæ­¥æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é«˜å¹¶å‘åœºæ™¯å¯æ”¹ç”¨ &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼ˆæ”¯æŒè¶…æ—¶ã€å¯ä¸­æ–­ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’ &lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šMonitor é”é€šè¿‡ &lt;strong&gt;OS çº§é˜»å¡é˜Ÿåˆ—&lt;/strong&gt; å’Œ &lt;strong&gt;ç²¾å‡†çº¿ç¨‹è°ƒåº¦&lt;/strong&gt;ï¼Œä¸º Java é«˜ç«äº‰åœºæ™¯æä¾›äº†ç»ˆæçº¿ç¨‹å®‰å…¨è§£å†³æ–¹æ¡ˆï¼Œä½†éœ€æƒè¡¡å…¶æ€§èƒ½å¼€é”€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="synchronized-é”å‡çº§"&gt;synchronized é”å‡çº§
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯Javaä¸­åå‘é”ï¼ˆBiased Lockingï¼‰ã€è½»é‡çº§é”ï¼ˆLightweight Lockingï¼‰å’Œé‡é‡çº§é”ï¼ˆHeavyweight Lockingï¼‰çš„è¯¦ç»†è§£æåŠå…¶æ ¸å¿ƒåŒºåˆ«ï¼Œç»“åˆåº•å±‚å®ç°åŸç†ä¸é€‚ç”¨åœºæ™¯å±•å¼€è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-é”çš„å‡çº§æœºåˆ¶ä¸è®¾è®¡èƒŒæ™¯"&gt;ğŸ”’ &lt;strong&gt;é”çš„å‡çº§æœºåˆ¶ä¸è®¾è®¡èƒŒæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Javaçš„&lt;code&gt;synchronized&lt;/code&gt;é”åœ¨JDK 1.6åå¼•å…¥&lt;strong&gt;é”å‡çº§ç­–ç•¥&lt;/strong&gt;ï¼ˆæ— é” â†’ åå‘é” â†’ è½»é‡çº§é” â†’ é‡é‡çº§é”ï¼‰ï¼Œç›®çš„æ˜¯åœ¨&lt;strong&gt;æ— ç«äº‰æ—¶é™ä½å¼€é”€&lt;/strong&gt;ï¼Œ&lt;strong&gt;é«˜ç«äº‰æ—¶ä¿è¯çº¿ç¨‹å®‰å…¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‡çº§è§¦å‘æ¡ä»¶ï¼š
&lt;ul&gt;
&lt;li&gt;åå‘é” â†’ è½»é‡çº§é”ï¼šé¦–æ¬¡å‡ºç°çº¿ç¨‹ç«äº‰æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;è½»é‡çº§é” â†’ é‡é‡çº§é”ï¼šè‡ªæ—‹å¤±è´¥ï¼ˆé»˜è®¤10æ¬¡ï¼‰æˆ–ç«äº‰åŠ å‰§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¯é™çº§&lt;/strong&gt;ï¼šé”å‡çº§åæ— æ³•å›é€€ï¼Œé¿å…çŠ¶æ€è½¬æ¢å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰ç§é”çš„æ ¸å¿ƒåŸç†ä¸ç‰¹ç‚¹"&gt;âš™ï¸ &lt;strong&gt;ä¸‰ç§é”çš„æ ¸å¿ƒåŸç†ä¸ç‰¹ç‚¹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åå‘é”biased-locking"&gt;&lt;strong&gt;åå‘é”ï¼ˆBiased Lockingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€æƒ³&lt;/strong&gt;ï¼šä¼˜åŒ–&lt;strong&gt;å•çº¿ç¨‹é‡å¤åŠ é”&lt;/strong&gt;åœºæ™¯ã€‚é¦–æ¬¡è·å–é”æ—¶è®°å½•çº¿ç¨‹IDåˆ°å¯¹è±¡å¤´ï¼ˆMark Wordï¼‰ï¼Œåç»­åŒä¸€çº¿ç¨‹ç›´æ¥è¿›å…¥åŒæ­¥å—ï¼Œæ— éœ€åŒæ­¥æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹è±¡å¤´æ ‡è®°ä½ï¼š&lt;code&gt;biased_lock=1, lock=01&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡CASè®°å½•çº¿ç¨‹IDï¼ŒæˆåŠŸåé”è¿›å…¥åå‘æ¨¡å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå•çº¿ç¨‹æˆ–çº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—ï¼ˆå¦‚å±€éƒ¨ä»£ç å—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šç«äº‰æ—¶éœ€æ’¤é”€åå‘é”ï¼ˆSTWæš‚åœæŒæœ‰çº¿ç¨‹ï¼‰ï¼Œå¼€é”€è¾ƒå¤§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç°çŠ¶&lt;/strong&gt;ï¼šJDK 15åé»˜è®¤ç¦ç”¨ï¼ˆé«˜ç«äº‰åœºæ™¯ä¸‹æ’¤é”€æˆæœ¬è¿‡é«˜ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è½»é‡çº§é”lightweight-locking"&gt;&lt;strong&gt;è½»é‡çº§é”ï¼ˆLightweight Lockingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€æƒ³&lt;/strong&gt;ï¼šé€šè¿‡&lt;strong&gt;CASè‡ªæ—‹&lt;/strong&gt;é¿å…çº¿ç¨‹é˜»å¡ï¼Œå‡å°‘ç”¨æˆ·æ€/å†…æ ¸æ€åˆ‡æ¢å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ ˆä¸­åˆ›å»ºé”è®°å½•ï¼ˆLock Recordï¼‰ï¼Œå¤åˆ¶å¯¹è±¡å¤´çš„Mark Wordï¼ˆDisplaced Mark Wordï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€šè¿‡CASå°†å¯¹è±¡å¤´æŒ‡å‘é”è®°å½•åœ°å€ï¼ŒæˆåŠŸåˆ™è·å–é”ï¼ˆæ ‡è®°ä½&lt;code&gt;lock=00&lt;/code&gt;ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;å¤±è´¥æ—¶è‡ªæ—‹é‡è¯•ï¼ˆè‡ªé€‚åº”è‡ªæ—‹ï¼šæ ¹æ®å†å²æˆåŠŸç‡åŠ¨æ€è°ƒæ•´è‡ªæ—‹æ¬¡æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;strong&gt;çŸ­æ—¶æ“ä½œ&lt;/strong&gt;ã€&lt;strong&gt;ä½ç«äº‰&lt;/strong&gt;ï¼ˆå¦‚è®¡æ•°å™¨è‡ªå¢ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šè‡ªæ—‹æ¶ˆè€—CPUï¼Œé«˜ç«äº‰æ—¶æ•ˆç‡ä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é‡é‡çº§é”heavyweight-locking"&gt;&lt;strong&gt;é‡é‡çº§é”ï¼ˆHeavyweight Lockingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€æƒ³&lt;/strong&gt;ï¼šä¾èµ–&lt;strong&gt;æ“ä½œç³»ç»Ÿäº’æ–¥é‡ï¼ˆMutexï¼‰&lt;/strong&gt; å®ç°çº¿ç¨‹é˜»å¡ï¼Œå½»åº•è§£å†³ç«äº‰é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹è±¡å¤´æŒ‡å‘æ“ä½œç³»ç»Ÿçº§Monitorï¼ˆé”æ ‡å¿—ä½&lt;code&gt;lock=10&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç«äº‰å¤±è´¥çº¿ç¨‹è¿›å…¥é˜»å¡é˜Ÿåˆ—ï¼Œç”±OSè°ƒåº¦å”¤é†’ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;strong&gt;é«˜ç«äº‰&lt;/strong&gt;ã€&lt;strong&gt;é•¿æ—¶åŒæ­¥æ“ä½œ&lt;/strong&gt;ï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ± ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šçº¿ç¨‹é˜»å¡/å”¤é†’æ¶‰åŠä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½æŸè€—å¤§ï¼ˆå¾®ç§’çº§å»¶è¿Ÿï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰ç§é”çš„æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”"&gt;ğŸ” &lt;strong&gt;ä¸‰ç§é”çš„æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;åå‘é”&lt;/th&gt;
&lt;th&gt;è½»é‡çº§é”&lt;/th&gt;
&lt;th&gt;é‡é‡çº§é”&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç«äº‰åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹é‡å¤è®¿é—®&lt;/td&gt;
&lt;td&gt;å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡Œï¼ˆæ— å®é™…ç«äº‰ï¼‰&lt;/td&gt;
&lt;td&gt;å¤šçº¿ç¨‹æ¿€çƒˆç«äº‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®°å½•çº¿ç¨‹IDï¼ˆæ— CASï¼‰&lt;/td&gt;
&lt;td&gt;CASè‡ªæ—‹ + æ ˆå¸§é”è®°å½•&lt;/td&gt;
&lt;td&gt;æ“ä½œç³»ç»ŸMutex + é˜»å¡é˜Ÿåˆ—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹é˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— é˜»å¡&lt;/td&gt;
&lt;td&gt;âŒ è‡ªæ—‹ï¼ˆä¸é˜»å¡ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… é˜»å¡ï¼ˆOSè°ƒåº¦ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— ç«äº‰æ—¶æœ€ä½&lt;/td&gt;
&lt;td&gt;ä½ç«äº‰æ—¶è¾ƒé«˜ï¼ˆCPUè‡ªæ—‹ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ç«äº‰æ—¶æœ€é«˜ï¼ˆä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹åœºæ™¯&lt;/td&gt;
&lt;td&gt;çŸ­æ—¶æ“ä½œï¼ˆ&amp;lt;çº³ç§’çº§ï¼‰&lt;/td&gt;
&lt;td&gt;é•¿æ—¶é«˜ç«äº‰æ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”æ’¤é”€/å‡çº§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç«äº‰æ—¶å‡çº§ä¸ºè½»é‡çº§é”&lt;/td&gt;
&lt;td&gt;è‡ªæ—‹å¤±è´¥å‡çº§ä¸ºé‡é‡çº§é”&lt;/td&gt;
&lt;td&gt;æ— é™çº§æœºåˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ€§èƒ½å…³é”®ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åå‘é”&lt;/strong&gt;ï¼šæ— ç«äº‰æ—¶æ•ˆç‡æœ€é«˜ï¼Œä½†ç«äº‰æ—¶æ’¤é”€æˆæœ¬é«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡çº§é”&lt;/strong&gt;ï¼šå¹³è¡¡ç‚¹åœ¨äº&lt;strong&gt;è‡ªæ—‹æ—¶é—´ &amp;lt; çº¿ç¨‹åˆ‡æ¢æ—¶é—´&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡é‡çº§é”&lt;/strong&gt;ï¼šå®Œå…¨æ¶ˆé™¤CPUç©ºè½¬ï¼Œä½†åˆ‡æ¢å¼€é”€å›ºå®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é”å‡çº§æµç¨‹ä¸å®æˆ˜å½±å“"&gt;âš ï¸ &lt;strong&gt;é”å‡çº§æµç¨‹ä¸å®æˆ˜å½±å“&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‡çº§è·¯å¾„&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[æ— é”] --&amp;gt;|é¦–æ¬¡åŠ é”| B[åå‘é”]
B --&amp;gt;|ç«äº‰å‘ç”Ÿ| C[è½»é‡çº§é”]
C --&amp;gt;|è‡ªæ—‹å¤±è´¥/å¤šçº¿ç¨‹ç«äº‰| D[é‡é‡çº§é”]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;ç«äº‰è§¦å‘å‡çº§åï¼Œå¯¹è±¡å¤´Mark Wordç»“æ„æ°¸ä¹…å˜åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥ç¨‹å®è·µå»ºè®®&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…è¿‡åº¦åŒæ­¥&lt;/strong&gt;ï¼šé”èŒƒå›´å°½é‡ç¼©å°ï¼ˆå¦‚åŒæ­¥å—ä»£æ›¿åŒæ­¥æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§é”ç«äº‰&lt;/strong&gt;ï¼šä½¿ç”¨&lt;code&gt;jstack&lt;/code&gt;æˆ–&lt;code&gt;Arthas&lt;/code&gt;æŸ¥çœ‹é”çŠ¶æ€ï¼ˆåå‘/è½»é‡/é‡é‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é«˜å¹¶å‘åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;æ›¿ä»£æ–¹æ¡ˆï¼š&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼ˆå¯ä¸­æ–­/è¶…æ—¶ï¼‰æˆ–&lt;code&gt;StampedLock&lt;/code&gt;ï¼ˆä¹è§‚è¯»ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç¦ç”¨åå‘é”ï¼šJDK 15+é»˜è®¤å…³é—­ï¼Œå¯é€šè¿‡&lt;code&gt;-XX:-UseBiasedLocking&lt;/code&gt;æ˜¾å¼ç¦ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åå‘é”&lt;/strong&gt;ï¼šä¸ºå•çº¿ç¨‹è®¾è®¡ï¼Œæ— ç«äº‰æ—¶æ•ˆç‡æè‡´ï¼Œä½†ç«äº‰æ’¤é”€æˆæœ¬é«˜ï¼ˆJDK 15+å·²åºŸå¼ƒï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡çº§é”&lt;/strong&gt;ï¼šé€šè¿‡&lt;strong&gt;CASè‡ªæ—‹&lt;/strong&gt;é¿å…é˜»å¡ï¼Œé€‚åˆçŸ­æ—¶ä½ç«äº‰æ“ä½œï¼Œè‡ªæ—‹å¤±è´¥åˆ™å‡çº§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡é‡çº§é”&lt;/strong&gt;ï¼šç»ˆææ–¹æ¡ˆï¼Œä¾èµ–OSäº’æ–¥é‡ï¼Œä¿è¯é«˜ç«äº‰ä¸‹çš„å®‰å…¨æ€§ï¼Œä½†æ€§èƒ½ä»£ä»·æœ€é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰æ‹©æœ¬è´¨&lt;/strong&gt;ï¼šJVMæ ¹æ®ç«äº‰å¼ºåº¦&lt;strong&gt;åŠ¨æ€é€‰æ‹©é”ç±»å‹&lt;/strong&gt;ï¼Œå¼€å‘è€…éœ€å…³æ³¨é”çŠ¶æ€ä¸ç«äº‰æƒ…å†µï¼Œé¿å…é‡é‡çº§é”æˆä¸ºç“¶é¢ˆã€‚é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œç»“åˆ&lt;code&gt;jstack&lt;/code&gt;åˆ†æé”ç«äº‰ï¼Œå¿…è¦æ—¶é‡‡ç”¨æ˜¾å¼é”ï¼ˆå¦‚&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰æ›¿ä»£&lt;code&gt;synchronized&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="åå‘é”"&gt;åå‘é”
&lt;/h2&gt;&lt;p&gt;åå‘é”ï¼ˆBiased Lockingï¼‰æ˜¯Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸ºä¼˜åŒ–&lt;code&gt;synchronized&lt;/code&gt;å…³é”®å­—æ€§èƒ½è€Œè®¾è®¡çš„é”æœºåˆ¶ï¼Œæ—¨åœ¨&lt;strong&gt;å‡å°‘å•çº¿ç¨‹é‡å¤è·å–é”çš„å¼€é”€&lt;/strong&gt;ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œåå‘â€é¦–ä¸ªè·å–é”çš„çº¿ç¨‹ï¼Œåç»­æ— éœ€åŒæ­¥æ“ä½œã€‚ä»¥ä¸‹ä»åŸç†ã€å·¥ä½œæœºåˆ¶ã€ä¼˜ç¼ºç‚¹åˆ°å®è·µåœºæ™¯å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸è®¾è®¡ç›®æ ‡"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸è®¾è®¡ç›®æ ‡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡èƒŒæ™¯&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šä¼ ç»Ÿé”ï¼ˆå¦‚é‡é‡çº§é”ï¼‰ä¾èµ–æ“ä½œç³»ç»Ÿäº’æ–¥é‡ï¼ˆMutexï¼‰ï¼Œæ¶‰åŠçº¿ç¨‹é˜»å¡/å”¤é†’ï¼Œå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¤§&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–ç›®æ ‡&lt;/strong&gt;ï¼šé’ˆå¯¹å•çº¿ç¨‹æˆ–ä½ç«äº‰åœºæ™¯ï¼Œé¿å…æ— æ„ä¹‰çš„åŒæ­¥æ“ä½œï¼ˆå¦‚CASï¼‰ï¼Œæå‡æ€§èƒ½&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯åŸºç¡€ï¼šå¯¹è±¡å¤´ä¸Mark Word&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªJavaå¯¹è±¡å¤´éƒ¨åŒ…å«&lt;strong&gt;Mark Word&lt;/strong&gt;å­—æ®µï¼ˆ64ä½ï¼‰ï¼Œå­˜å‚¨é”çŠ¶æ€ã€å“ˆå¸Œç ã€GCåˆ†ä»£å¹´é¾„ç­‰ä¿¡æ¯&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åå‘é”çŠ¶æ€ä¸‹çš„Mark Wordç»“æ„ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;| é”æ ‡å¿—ä½ (01) | åå‘çº¿ç¨‹ID (54 bits) | Epoch (2 bits) | æœªä½¿ç”¨ (1 bit) |
&lt;/code&gt;&lt;/pre&gt;å…¶ä¸­ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åå‘çº¿ç¨‹ID&lt;/strong&gt;ï¼šè®°å½•é¦–æ¬¡è·å–é”çš„çº¿ç¨‹IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Epoch&lt;/strong&gt;ï¼šç”¨äºæ‰¹é‡é‡åå‘çš„ç‰ˆæœ¬å·ï¼Œé¿å…é¢‘ç¹æ’¤é”€&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæœºåˆ¶è¯¦è§£"&gt;ğŸ”„ &lt;strong&gt;å·¥ä½œæœºåˆ¶è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åå‘é”çš„è·å–æµç¨‹"&gt;&lt;strong&gt;åå‘é”çš„è·å–æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤1ï¼šåˆå§‹æ— é”çŠ¶æ€&lt;/strong&gt;
å¯¹è±¡åˆ›å»ºæ—¶ï¼ŒMark Wordä¸ºæ— é”çŠ¶æ€ï¼ˆé”æ ‡å¿—ä½&lt;code&gt;01&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ­¥éª¤2ï¼šé¦–æ¬¡è·å–é”
çº¿ç¨‹T1é¦–æ¬¡è¿›å…¥åŒæ­¥å—ï¼š
&lt;ul&gt;
&lt;li&gt;JVMé€šè¿‡&lt;strong&gt;CASæ“ä½œ&lt;/strong&gt;å°†Mark Wordçš„é”æ ‡å¿—ä½æ”¹ä¸ºåå‘é”ï¼ˆ&lt;code&gt;01&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å°†T1çš„çº¿ç¨‹IDå†™å…¥Mark Word&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶é”è¿›å…¥â€œåå‘æ¨¡å¼â€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ­¥éª¤3ï¼šå†æ¬¡è·å–é” T1åç»­è¿›å…¥åŒæ­¥å—æ—¶ï¼š
&lt;ul&gt;
&lt;li&gt;JVMæ£€æŸ¥Mark Wordä¸­çš„çº¿ç¨‹IDæ˜¯å¦ä¸T1åŒ¹é…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‹¥åŒ¹é…&lt;/strong&gt;ï¼šç›´æ¥æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œ&lt;strong&gt;æ— ä»»ä½•åŒæ­¥æ“ä½œ&lt;/strong&gt;ï¼ˆå¦‚CASæˆ–é˜»å¡ï¼‰&lt;a class="link" href="@ref" &gt;2,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åå‘é”çš„æ’¤é”€ä¸å‡çº§"&gt;&lt;strong&gt;åå‘é”çš„æ’¤é”€ä¸å‡çº§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;ï¼šå½“çº¿ç¨‹T2å°è¯•è·å–å·²è¢«T1åå‘çš„é”æ—¶&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ’¤é”€è¿‡ç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;æš‚åœæŒæœ‰é”çš„çº¿ç¨‹T1ï¼ˆSTWï¼ŒStop-The-Worldï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥T1æ˜¯å¦ä»æ´»è·ƒï¼šè‹¥å·²é€€å‡ºåŒæ­¥å—ï¼Œåˆ™æ’¤é”€åå‘é”ï¼Œæ¢å¤ä¸ºæ— é”çŠ¶æ€ï¼›è‹¥ä»åœ¨æ‰§è¡Œï¼Œåˆ™å‡çº§ä¸º&lt;strong&gt;è½»é‡çº§é”&lt;/strong&gt;ï¼ˆé”æ ‡å¿—ä½&lt;code&gt;00&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å”¤é†’T1å’ŒT2ï¼ŒT2é€šè¿‡&lt;strong&gt;è‡ªæ—‹ï¼ˆCASï¼‰&lt;/strong&gt; ç«äº‰è½»é‡çº§é”&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡é‡åå‘ä¼˜åŒ–&lt;/strong&gt;ï¼š
è‹¥åŒä¸€ç±»çš„å¤§é‡å¯¹è±¡è¢«ä¸åŒçº¿ç¨‹äº¤æ›¿è®¿é—®ï¼ŒJVMä¼šé€šè¿‡&lt;code&gt;Epoch&lt;/code&gt;æœºåˆ¶æ‰¹é‡é‡åå‘ï¼Œé¿å…é¢‘ç¹æ’¤é”€&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é”å‡çº§è·¯å¾„"&gt;&lt;strong&gt;é”å‡çº§è·¯å¾„&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[æ— é”çŠ¶æ€] --&amp;gt;|å•çº¿ç¨‹é‡å¤è®¿é—®| B[åå‘é”]
B --&amp;gt;|å¤šçº¿ç¨‹ç«äº‰| C[è½»é‡çº§é”]
C --&amp;gt;|ç«äº‰æ¿€çƒˆ| D[é‡é‡çº§é”]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;è½»é‡çº§é”é€šè¿‡&lt;strong&gt;è‡ªæ—‹CAS&lt;/strong&gt;å‡å°‘é˜»å¡ï¼Œé‡é‡çº§é”ä¾èµ–&lt;strong&gt;æ“ä½œç³»ç»Ÿäº’æ–¥é‡&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜ç¼ºç‚¹åˆ†æ"&gt;âš–ï¸ &lt;strong&gt;ä¼˜ç¼ºç‚¹åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="-æ ¸å¿ƒä¼˜åŠ¿"&gt;âœ… **æ ¸å¿ƒä¼˜åŠ¿
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é›¶åŒæ­¥å¼€é”€&lt;/strong&gt;ï¼šå•çº¿ç¨‹é‡å¤è®¿é—®æ—¶ï¼Œæ— éœ€CASæˆ–çº¿ç¨‹è°ƒåº¦ï¼Œæ€§èƒ½æ¥è¿‘æ— é”&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢&lt;/strong&gt;ï¼šé¿å…çº¿ç¨‹é˜»å¡/å”¤é†’ï¼Œé™ä½CPUèµ„æºæ¶ˆè€—&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="-å±€é™æ€§"&gt;âš ï¸ **å±€é™æ€§
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ’¤é”€å¼€é”€å¤§&lt;/strong&gt;ï¼šç«äº‰è§¦å‘æ’¤é”€æ—¶éœ€STWï¼Œæš‚åœæ‰€æœ‰çº¿ç¨‹ï¼Œå»¶è¿Ÿæ•æ„Ÿåœºæ™¯æ€§èƒ½ä¸‹é™&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡æ— æ•ˆ&lt;/strong&gt;ï¼šå¯¹è±¡è‹¥è¢«å¤šä¸ªçº¿ç¨‹å¿«é€Ÿäº¤æ›¿è®¿é—®ï¼Œåå‘é”åå¤æ’¤é”€åè€Œé™ä½æ•ˆç‡&lt;a class="link" href="@ref" &gt;4,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜ç«äº‰åœºæ™¯ä¸é€‚ç”¨&lt;/strong&gt;ï¼šé¢‘ç¹ç«äº‰å¯¼è‡´é”å‡çº§ä¸ºé‡é‡çº§é”ï¼Œæ€§èƒ½åè€Œä¸å¦‚ç›´æ¥ç¦ç”¨åå‘é”&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸é…ç½®å»ºè®®"&gt;ğŸ¯ &lt;strong&gt;é€‚ç”¨åœºæ™¯ä¸é…ç½®å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç†æƒ³åœºæ™¯"&gt;&lt;strong&gt;ç†æƒ³åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å•çº¿ç¨‹ä¸»å¯¼&lt;/strong&gt;ï¼šå¦‚çº¿ç¨‹æ± ä¸­å•çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€åˆå§‹åŒ–é˜¶æ®µåŠ è½½èµ„æº&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½ç«äº‰ç¯å¢ƒ&lt;/strong&gt;ï¼šé”è¢«åŒä¸€çº¿ç¨‹é•¿æœŸæŒæœ‰ï¼Œå¶æœ‰å…¶ä»–çº¿ç¨‹å°è¯•ç«äº‰ï¼ˆå¦‚åå°ç›‘æ§çº¿ç¨‹ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;// å•çº¿ç¨‹é‡å¤è®¿é—®åŒæ­¥å—
public void processTask() {
synchronized(lock) { // é¦–æ¬¡è·å–ååå‘å½“å‰çº¿ç¨‹
// ä¸šåŠ¡é€»è¾‘
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘ç«äº‰ï¼ˆå¦‚ç§’æ€ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é”å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçŸ­ï¼ˆå¦‚ä¸´æ—¶å¯¹è±¡åŒæ­¥å—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éœ€ä¸¥æ ¼å®æ—¶å“åº”çš„ç³»ç»Ÿï¼ˆSTWå¯èƒ½å¯¼è‡´å»¶è¿Ÿæ³¢åŠ¨ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="jvmå‚æ•°é…ç½®"&gt;&lt;strong&gt;JVMå‚æ•°é…ç½®&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:+UseBiasedLocking&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯ç”¨åå‘é”ï¼ˆJDK 6u23åé»˜è®¤å¼€å¯ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:-UseBiasedLocking&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç¦ç”¨åå‘é”ï¼ˆé«˜ç«äº‰åœºæ™¯æ¨èï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;-XX:BiasedLockingStartupDelay=0&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å–æ¶ˆåå‘é”å»¶è¿Ÿï¼ˆé»˜è®¤å»¶è¿Ÿ4ç§’ï¼Œé¿å…çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡æ— æ•ˆä¼˜åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šJDK 15ååå‘é”é»˜è®¤å…³é—­ï¼ŒJDK 18ä¸­å½»åº•ç§»é™¤ï¼Œå› ç°ä»£ç¡¬ä»¶ç¯å¢ƒä¸‹è½»é‡çº§é”ä¼˜åŒ–å·²è¶³å¤Ÿé«˜æ•ˆ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å…¶ä»–é”çš„å¯¹æ¯”"&gt;ğŸ”„ &lt;strong&gt;ä¸å…¶ä»–é”çš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;åå‘é”&lt;/th&gt;
&lt;th&gt;è½»é‡çº§é”&lt;/th&gt;
&lt;th&gt;é‡é‡çº§é”&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹/ä½ç«äº‰&lt;/td&gt;
&lt;td&gt;å¤šçº¿ç¨‹äº¤æ›¿è®¿é—®ï¼ˆä½ç«äº‰ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ç«äº‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®°å½•çº¿ç¨‹IDï¼Œå…åŒæ­¥æ“ä½œ&lt;/td&gt;
&lt;td&gt;CASè‡ªæ—‹å°è¯•è·å–é”&lt;/td&gt;
&lt;td&gt;æ“ä½œç³»ç»Ÿäº’æ–¥é‡ï¼ˆMutexï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¥è¿‘é›¶å¼€é”€ï¼ˆæ— ç«äº‰æ—¶ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆè‡ªæ—‹æ¶ˆè€—CPUï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‡çº§è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šçº¿ç¨‹ç«äº‰&lt;/td&gt;
&lt;td&gt;è‡ªæ—‹å¤±è´¥æˆ–ç«äº‰æ¿€çƒˆ&lt;/td&gt;
&lt;td&gt;ç«äº‰è¶…æ—¶æˆ–èµ„æºäº‰ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨é”ç±»å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;synchronized&lt;/code&gt;æ–¹æ³•/å—&lt;/td&gt;
&lt;td&gt;&lt;code&gt;synchronized&lt;/code&gt;æ–¹æ³•/å—&lt;/td&gt;
&lt;td&gt;&lt;code&gt;synchronized&lt;/code&gt;ã€&lt;code&gt;ReentrantLock&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¥æºï¼š&lt;a class="link" href="@ref" &gt;3,6,8&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åå‘é”é€šè¿‡&lt;strong&gt;æ¶ˆé™¤å•çº¿ç¨‹é‡å¤åŒæ­¥çš„å¼€é”€&lt;/strong&gt;ï¼Œæˆä¸ºJVMé”ä¼˜åŒ–çš„é‡è¦ä¸€ç¯ã€‚å…¶ä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æå‡&lt;/strong&gt;ï¼šå•çº¿ç¨‹åœºæ™¯åŒæ­¥æ•ˆç‡æ¥è¿‘æ— é”æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºèŠ‚çº¦&lt;/strong&gt;ï¼šå‡å°‘CPUä¸Šä¸‹æ–‡åˆ‡æ¢ä¸CASæ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹³æ»‘å‡çº§&lt;/strong&gt;ï¼šä¸è½»é‡çº§é”ã€é‡é‡çº§é”å½¢æˆåŠ¨æ€ä¼˜åŒ–é“¾è·¯ã€‚
&lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;ï¼šåœ¨æ˜ç¡®å•çº¿ç¨‹ä¸»å¯¼çš„åœºæ™¯å¯ç”¨åå‘é”ï¼›é«˜å¹¶å‘æˆ–çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡åœºæ™¯å»ºè®®ç¦ç”¨ï¼ˆ&lt;code&gt;-XX:-UseBiasedLocking&lt;/code&gt;ï¼‰ã€‚ç°ä»£JDKä¸­ï¼Œéšç€è‡ªæ—‹ä¼˜åŒ–ä¸ç¡¬ä»¶å‘å±•ï¼Œè½»é‡çº§é”å·²èƒ½è¦†ç›–å¤šæ•°åœºæ™¯ï¼Œåå‘é”é€æ¸é€€å‡ºå†å²èˆå°ï¼Œä½†å…¶è®¾è®¡æ€æƒ³ä»å€¼å¾—å€Ÿé‰´&lt;a class="link" href="@ref" &gt;4,6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="å¼ƒç”¨åå‘é”"&gt;å¼ƒç”¨åå‘é”
&lt;/h2&gt;&lt;p&gt;åå‘é”ï¼ˆBiased Lockingï¼‰åœ¨JDK 15ä¸­è¢«é»˜è®¤å…³é—­ï¼ˆé€šè¿‡JEP 374å®ç°ï¼‰ï¼Œå¹¶åœ¨åç»­ç‰ˆæœ¬ä¸­è¢«åºŸå¼ƒç”šè‡³ç§»é™¤ã€‚è¿™ä¸€å†³ç­–æ˜¯JVMå›¢é˜ŸåŸºäºç°ä»£ç¡¬ä»¶ç‰¹æ€§ã€åº”ç”¨åœºæ™¯å˜åŒ–å’Œæ€§èƒ½å®æµ‹æ•°æ®çš„ç»¼åˆè€ƒé‡ï¼Œä¸»è¦åŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½æ”¶ç›Šä¸æˆæœ¬å¤±è¡¡"&gt;ğŸ”§ &lt;strong&gt;æ€§èƒ½æ”¶ç›Šä¸æˆæœ¬å¤±è¡¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–åœºæ™¯å‡å°‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åå‘é”çš„åˆè¡·æ˜¯ä¼˜åŒ–&lt;strong&gt;å•çº¿ç¨‹é‡å¤è®¿é—®åŒæ­¥å—&lt;/strong&gt;çš„åœºæ™¯ï¼ˆå¦‚åˆå§‹åŒ–é˜¶æ®µæˆ–çº¿ç¨‹å±€éƒ¨æ“ä½œï¼‰ï¼Œé€šè¿‡é¿å…CASæ“ä½œé™ä½å¼€é”€&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç°ä»£åº”ç”¨å˜åŒ–&lt;/strong&gt;ï¼šå¾®æœåŠ¡ã€é«˜å¹¶å‘ç³»ç»Ÿä¸­ï¼Œé”å¯¹è±¡å¸¸è¢«å¤šçº¿ç¨‹ç«äº‰è®¿é—®ï¼ˆå¦‚çº¿ç¨‹æ± å¤„ç†è¯·æ±‚ï¼‰ï¼Œåå‘é”çš„é€‚ç”¨åœºæ™¯å¤§å¹…å‡å°‘&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’¤é”€å¼€é”€è¿‡é«˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å½“å…¶ä»–çº¿ç¨‹å°è¯•è·å–å·²è¢«åå‘çš„é”æ—¶ï¼ŒJVMéœ€è§¦å‘
æ’¤é”€æ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;æš‚åœæŒæœ‰åå‘é”çš„çº¿ç¨‹ï¼ˆ&lt;strong&gt;Stop-The-World, STW&lt;/strong&gt;ï¼‰ï¼Œç­‰å¾…å…¨å±€å®‰å…¨ç‚¹ï¼ˆSafepointï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å‡çº§ä¸ºè½»é‡çº§é”æˆ–é‡é‡çº§é”ï¼Œæ¶‰åŠçº¿ç¨‹çŠ¶æ€æ£€æŸ¥å’ŒMark Wordæ›´æ–°&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘åœºæ™¯ä¸‹&lt;/strong&gt;ï¼šé¢‘ç¹æ’¤é”€å¯¼è‡´STWæ“ä½œæ¿€å¢ï¼Œæˆä¸ºå»¶è¿ŸæŠ–åŠ¨å’Œååé‡ä¸‹é™çš„ä¸»å› &lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹æ¯”æ”¶ç›Šä¸è¶³&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç°ä»£ç¡¬ä»¶ï¼ˆå¤šæ ¸CPUï¼‰å’ŒJITä¼˜åŒ–ï¼ˆå¦‚é”æ¶ˆé™¤ã€è‡ªé€‚åº”è‡ªæ—‹ï¼‰ä½¿è½»é‡çº§é”çš„æ€§èƒ½æ¥è¿‘åå‘é”ï¼Œä¸”æ— æ’¤é”€æˆæœ¬&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®˜æ–¹åŸºå‡†æµ‹è¯•ï¼ˆå¦‚SPECjbb2015ï¼‰æ˜¾ç¤ºï¼šç¦ç”¨åå‘é”åï¼Œ99%çš„å»¶è¿Ÿæ³¢åŠ¨é™ä½5%-10%ï¼Œååé‡æ— æ˜¾è‘—æŸå¤±&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°å¤æ‚æ€§ä¸ç»´æŠ¤è´Ÿæ‹…"&gt;âš™ï¸ &lt;strong&gt;å®ç°å¤æ‚æ€§ä¸ç»´æŠ¤è´Ÿæ‹…&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç è€¦åˆåº¦é«˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åå‘é”çš„å®ç°ï¼ˆå¦‚&lt;code&gt;biased_locking.cpp&lt;/code&gt;ï¼‰ä¸HotSpotçš„é”å­ç³»ç»Ÿæ·±åº¦è€¦åˆï¼Œçº¦å JVMä»£ç é‡çš„2%ï¼Œå¢åŠ äº†ç»´æŠ¤éš¾åº¦å’Œæ½œåœ¨Bugé£é™©&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ’¤é”€é€»è¾‘æ¶‰åŠå®‰å…¨ç‚¹æœºåˆ¶ã€çº¿ç¨‹çŠ¶æ€ç®¡ç†ç­‰å¤æ‚äº¤äº’ï¼Œé˜»ç¢äº†JVMå…¶ä»–ç‰¹æ€§çš„æ¼”è¿›ï¼ˆå¦‚GraalVMå³æ—¶ç¼–è¯‘ä¼˜åŒ–ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å…¶ä»–æœºåˆ¶å†²çª&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HashCodeè°ƒç”¨&lt;/strong&gt;ï¼šåœ¨åå‘é”çŠ¶æ€ä¸‹è°ƒç”¨&lt;code&gt;hashCode()&lt;/code&gt;ä¼šå¼ºåˆ¶æ’¤é”€é”å¹¶å‡çº§ï¼Œå¼•å‘é¢å¤–æ€§èƒ½æŸè€—&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŸ­æœŸå¯¹è±¡æ— æ•ˆ&lt;/strong&gt;ï¼šå¤§é‡çŸ­æš‚å¯¹è±¡ï¼ˆå¦‚HTTPè¯·æ±‚ä¸Šä¸‹æ–‡ï¼‰çš„é”ç«äº‰ç›´æ¥è·³è¿‡åå‘é˜¶æ®µï¼Œä½¿å…¶ä¼˜åŒ–æ— æ•ˆ&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç°ä»£ç¡¬ä»¶ä¸å¹¶å‘æ¨¡å‹çš„æ¼”è¿›"&gt;ğŸ”„ &lt;strong&gt;ç°ä»£ç¡¬ä»¶ä¸å¹¶å‘æ¨¡å‹çš„æ¼”è¿›&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ ¸å¤„ç†å™¨æ™®åŠ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨æ™®éå…·å¤‡æ•°åæ ¸ï¼Œçº¿ç¨‹ç«äº‰é¢‘ç‡æ˜¾è‘—å¢åŠ ï¼Œåå‘é”çš„â€œå•çº¿ç¨‹å‡è®¾â€ä¸é«˜å¹¶å‘åœºæ™¯ä¸åŒ¹é…&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡çº§é”è¶³å¤Ÿé«˜æ•ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è½»é‡çº§é”é€šè¿‡&lt;strong&gt;CASè‡ªæ—‹&lt;/strong&gt;å¤„ç†ä½ç«äº‰åœºæ™¯ï¼Œé¿å…äº†ç”¨æˆ·æ€-å†…æ ¸æ€åˆ‡æ¢ï¼Œæ€§èƒ½å·²æ¥è¿‘åå‘é”&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åº”æ€§è‡ªæ—‹ä¼˜åŒ–&lt;/strong&gt;ï¼šJVMåŠ¨æ€è°ƒæ•´è‡ªæ—‹æ¬¡æ•°ï¼ˆåŸºäºå†å²ç«äº‰æƒ…å†µï¼‰ï¼Œå‡å°‘æ— æ•ˆCPUæ¶ˆè€—&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é”ç¼–ç¨‹çš„å…´èµ·&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;java.util.concurrent&lt;/code&gt;åŒ…æä¾›çš„åŸå­ç±»ï¼ˆå¦‚&lt;code&gt;AtomicInteger&lt;/code&gt;ï¼‰ã€å¹¶å‘å®¹å™¨ï¼ˆå¦‚&lt;code&gt;ConcurrentHashMap&lt;/code&gt;ï¼‰æ›¿ä»£äº†éƒ¨åˆ†åŒæ­¥å—éœ€æ±‚&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¼€å‘è€…å½±å“ä¸åº”å¯¹å»ºè®®"&gt;âš–ï¸ &lt;strong&gt;å¼€å‘è€…å½±å“ä¸åº”å¯¹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤è¡Œä¸ºå˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;JDK 15+ï¼šé»˜è®¤å…³é—­åå‘é”ï¼ˆç­‰ä»·äº
&lt;pre tabindex="0"&gt;&lt;code&gt;-XX:-UseBiasedLocking
&lt;/code&gt;&lt;/pre&gt;ï¼‰ï¼Œé”å‡çº§è·¯å¾„ç®€åŒ–ä¸ºï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;æ— é” â†’ è½»é‡çº§é” â†’ é‡é‡çº§é”
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è°ƒä¼˜å»ºè®®&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å•çº¿ç¨‹é«˜é¢‘è®¿é—®åŒæ­¥å—&lt;/td&gt;
&lt;td&gt;é€šè¿‡&lt;code&gt;-XX:+UseBiasedLocking&lt;/code&gt;æ‰‹åŠ¨å¯ç”¨ï¼Œä½†éœ€æµ‹è¯•å…¼å®¹æ€§ï¼ˆæœªæ¥ç‰ˆæœ¬å¯èƒ½ç§»é™¤ï¼‰&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é«˜å¹¶å‘åº”ç”¨&lt;/td&gt;
&lt;td&gt;æ¥å—é»˜è®¤é…ç½®ï¼Œä¾èµ–è½»é‡çº§é”ä¼˜åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å»¶è¿Ÿæ•æ„Ÿå‹ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;ä¼˜å…ˆä½¿ç”¨æ— é”æ•°æ®ç»“æ„ï¼ˆå¦‚&lt;code&gt;LongAdder&lt;/code&gt;ï¼‰æˆ–æ˜¾å¼é”ï¼ˆå¦‚&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘åŒæ­¥å—ç²’åº¦&lt;/strong&gt;ï¼šç¼©å°ä¸´ç•ŒåŒºèŒƒå›´ï¼Œé¿å…é•¿æ—¶é—´æŒæœ‰é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”æ¶ˆé™¤ä¸ç²—åŒ–&lt;/strong&gt;ï¼šä¾èµ–JITç¼–è¯‘å™¨è‡ªåŠ¨æ¶ˆé™¤æ— æ•ˆé”ï¼Œæˆ–åˆå¹¶è¿ç»­é”æ“ä½œ&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åå‘é”çš„åºŸå¼ƒæ˜¯JVMé€‚åº”æ—¶ä»£å‘å±•çš„å¿…ç„¶ç»“æœï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å±‚é¢&lt;/strong&gt;ï¼šæ’¤é”€æˆæœ¬ï¼ˆSTWï¼‰è¿œè¶…å•çº¿ç¨‹ä¼˜åŒ–æ”¶ç›Šï¼Œè½»é‡çº§é”æˆä¸ºæ›´æ™®é€‚çš„ä½å¼€é”€æ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥ç¨‹å±‚é¢&lt;/strong&gt;ï¼šç®€åŒ–JVMé”å­ç³»ç»Ÿï¼Œæå‡å¯ç»´æŠ¤æ€§ï¼Œä¸ºæœªæ¥ä¼˜åŒ–è…¾å‡ºç©ºé—´&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæ€å±‚é¢&lt;/strong&gt;ï¼šæ¨åŠ¨å¼€å‘è€…è½¬å‘æ›´é€‚åº”é«˜å¹¶å‘çš„åŒæ­¥ç­–ç•¥ï¼ˆå¦‚æ— é”ç¼–ç¨‹ã€æ˜¾å¼é”æ§åˆ¶ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ€ç»ˆå»ºè®®&lt;/strong&gt;ï¼šé™¤éæ˜ç¡®éœ€å…¼å®¹é—ç•™å•çº¿ç¨‹é«˜é¢‘é”åœºæ™¯ï¼Œå¦åˆ™æ— éœ€ä¸»åŠ¨å¯ç”¨åå‘é”ã€‚JDK 15+çš„é»˜è®¤é…ç½®å·²é’ˆå¯¹ç°ä»£ç¡¬ä»¶å’Œä¸»æµåº”ç”¨ä¼˜åŒ–ï¼Œæ€§èƒ½æ›´ç¨³å®šå¯é ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="unsafe"&gt;Unsafe
&lt;/h2&gt;&lt;p&gt;Unsafe ç±»æ˜¯ Java ä¸­ä½äº &lt;code&gt;sun.misc&lt;/code&gt; åŒ…ä¸‹çš„ç‰¹æ®Šå·¥å…·ç±»ï¼Œæä¾›ç›´æ¥æ“ä½œå†…å­˜ã€çº¿ç¨‹è°ƒåº¦ã€å¯¹è±¡å®ä¾‹åŒ–ç­‰åº•å±‚èƒ½åŠ›ï¼Œå› å…¶ç»•è¿‡ JVM å®‰å…¨æœºåˆ¶è€Œå¾—åâ€œä¸å®‰å…¨â€ã€‚å®ƒæ˜¯ JDK å†…éƒ¨å®ç°é«˜æ€§èƒ½æ¡†æ¶çš„æ ¸å¿ƒï¼Œä½†æ™®é€šå¼€å‘éœ€è°¨æ…ä½¿ç”¨ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŠŸèƒ½ä¸åŸç†"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½ä¸åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å†…å­˜æ“ä½œ"&gt;&lt;strong&gt;å†…å­˜æ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ç›´æ¥åˆ†é…ã€è¯»å†™å †å¤–å†…å­˜ï¼Œé¿å… GC å¼€é”€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;allocateMemory(long bytes)&lt;/code&gt;&lt;/strong&gt;ï¼šåˆ†é…æŒ‡å®šå­—èŠ‚çš„å †å¤–å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;putXXX(address, value)&lt;/code&gt;&lt;/strong&gt; / &lt;strong&gt;&lt;code&gt;getXXX(address)&lt;/code&gt;&lt;/strong&gt;ï¼šç›´æ¥è¯»å†™å†…å­˜æ•°æ®ï¼ˆå¦‚ &lt;code&gt;putInt&lt;/code&gt;ã€&lt;code&gt;getLong&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;freeMemory(address)&lt;/code&gt;&lt;/strong&gt;ï¼šæ‰‹åŠ¨é‡Šæ”¾å†…å­˜ï¼Œå¦åˆ™å¯¼è‡´å†…å­˜æ³„æ¼ã€‚
â€‹&lt;strong&gt;ç”¨é€”&lt;/strong&gt;â€‹ï¼šNetty çš„ &lt;code&gt;DirectByteBuffer&lt;/code&gt;ã€é«˜é¢‘ I/O åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¯¹è±¡æ“ä½œ"&gt;&lt;strong&gt;å¯¹è±¡æ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œç›´æ¥ä¿®æ”¹å¯¹è±¡å­—æ®µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;objectFieldOffset(Field f)&lt;/code&gt;&lt;/strong&gt;ï¼šè·å–å­—æ®µå†…å­˜åç§»é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;putObject(Object o, long offset, Object value)&lt;/code&gt;&lt;/strong&gt;ï¼šé€šè¿‡åç§»é‡ä¿®æ”¹å­—æ®µï¼ˆæ— è§† &lt;code&gt;private&lt;/code&gt; ä¿®é¥°ï¼‰ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;User user = new User();
long offset = unsafe.objectFieldOffset(User.class.getDeclaredField(&amp;#34;age&amp;#34;));
unsafe.putInt(user, offset, 25); // å¼ºåˆ¶ä¿®æ”¹ageå­—æ®µ
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="casåŸå­æ“ä½œ"&gt;&lt;strong&gt;CASï¼ˆåŸå­æ“ä½œï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;é€šè¿‡ CPU æŒ‡ä»¤å®ç°æ— é”å¹¶å‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;compareAndSwapInt(Object o, long offset, int expected, int update)&lt;/code&gt;&lt;/strong&gt;ï¼šè‹¥å½“å‰å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™æ›´æ–°ã€‚
â€‹&lt;strong&gt;ç”¨é€”&lt;/strong&gt;â€‹ï¼š&lt;code&gt;AtomicInteger&lt;/code&gt;ã€&lt;code&gt;ConcurrentHashMap&lt;/code&gt; çš„åº•å±‚å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="çº¿ç¨‹è°ƒåº¦"&gt;&lt;strong&gt;çº¿ç¨‹è°ƒåº¦&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ç²¾å‡†æ§åˆ¶çº¿ç¨‹é˜»å¡ä¸å”¤é†’ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;park(boolean isAbsolute, long timeout)&lt;/code&gt;&lt;/strong&gt;ï¼šæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼ˆç±»ä¼¼ &lt;code&gt;LockSupport.park&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;unpark(Thread thread)&lt;/code&gt;&lt;/strong&gt;ï¼šå”¤é†’æŒ‡å®šçº¿ç¨‹ã€‚
â€‹&lt;strong&gt;ç”¨é€”&lt;/strong&gt;â€‹ï¼š&lt;code&gt;StampedLock&lt;/code&gt;ã€AQS çš„é˜»å¡é˜Ÿåˆ—å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç±»ä¸å¯¹è±¡å®ä¾‹åŒ–"&gt;&lt;strong&gt;ç±»ä¸å¯¹è±¡å®ä¾‹åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ç»•è¿‡æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;allocateInstance(Class&amp;lt;?&amp;gt; clazz)&lt;/code&gt;&lt;/strong&gt;ï¼šä¸è°ƒç”¨æ„é€ æ–¹æ³•ç›´æ¥å®ä¾‹åŒ–å¯¹è±¡ï¼ˆå¯¹è±¡å­—æ®µä¸ºé»˜è®¤å€¼ï¼‰ã€‚
â€‹&lt;strong&gt;é£é™©&lt;/strong&gt;â€‹ï¼šç ´åå¯¹è±¡ä¸å˜æ€§ï¼ˆå¦‚ &lt;code&gt;final&lt;/code&gt; å­—æ®µæœªåˆå§‹åŒ–ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-è·å–-unsafe-å®ä¾‹çš„æ–¹æ³•"&gt;ğŸ” &lt;strong&gt;è·å– Unsafe å®ä¾‹çš„æ–¹æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç”±äºè®¾è®¡é™åˆ¶ï¼Œå¸¸è§„æ–¹æ³•æ— æ³•ç›´æ¥è·å–ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åå°„è·å–å•ä¾‹&lt;/strong&gt;ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Field field = Unsafe.class.getDeclaredField(&amp;#34;theUnsafe&amp;#34;);
field.setAccessible(true);
Unsafe unsafe = (Unsafe) field.get(null);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;-Xbootclasspath/a&lt;/code&gt; å‚æ•°å¼ºåˆ¶ç”± Bootstrap ClassLoader åŠ è½½è°ƒç”¨ç±»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»è¦é£é™©ä¸äº‰è®®"&gt;âš ï¸ &lt;strong&gt;ä¸»è¦é£é™©ä¸äº‰è®®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å®‰å…¨é£é™©"&gt;&lt;strong&gt;å®‰å…¨é£é™©&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜æ³„æ¼&lt;/strong&gt;ï¼šéœ€æ‰‹åŠ¨é‡Šæ”¾å†…å­˜ï¼Œå¦åˆ™æŒç»­å ç”¨èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;JVM å´©æºƒ&lt;/strong&gt;ï¼šéæ³•å†…å­˜è®¿é—®ï¼ˆå¦‚è¶Šç•Œå†™æ“ä½œï¼‰å¯¼è‡´è¿›ç¨‹ç»ˆæ­¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡çŠ¶æ€ç ´å&lt;/strong&gt;ï¼šç»•è¿‡æ„é€ å‡½æ•°å¯èƒ½ä½¿å¯¹è±¡å¤„äºä¸ä¸€è‡´çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¹¶å‘é—®é¢˜"&gt;&lt;strong&gt;å¹¶å‘é—®é¢˜&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç«äº‰&lt;/strong&gt;ï¼šä¸å½“çš„ CAS æ“ä½œæˆ–å†…å­˜è¯»å†™å¼•å‘çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨æ¼æ´&lt;/strong&gt;ï¼šæ¶æ„ä»£ç å¯åˆ©ç”¨ Unsafe ä¿®æ”¹æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å¯†ç å­—æ®µï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…¼å®¹æ€§ä¸å®˜æ–¹æ€åº¦"&gt;&lt;strong&gt;å…¼å®¹æ€§ä¸å®˜æ–¹æ€åº¦&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Java 9+ é™åˆ¶&lt;/strong&gt;ï¼šæ¨¡å—åŒ–ç³»ç»Ÿç¦æ­¢åº”ç”¨ä»£ç è®¿é—® &lt;code&gt;sun.misc.Unsafe&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªæ¥ç§»é™¤è®¡åˆ’&lt;/strong&gt;ï¼šJEP 471 æè®®å¼ƒç”¨å†…å­˜è®¿é—®æ–¹æ³•ï¼Œæ¨è &lt;code&gt;jdk.incubator.foreign.MemorySegment&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯-vs-æ›¿ä»£æ–¹æ¡ˆ"&gt;âš–ï¸ &lt;strong&gt;é€‚ç”¨åœºæ™¯ vs æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èæ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å †å¤–å†…å­˜ç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… Unsafeï¼ˆé«˜æ€§èƒ½åœºæ™¯ï¼‰ â†’ æ›¿ä»£ï¼š&lt;code&gt;ByteBuffer.allocateDirect&lt;/code&gt; æˆ– &lt;code&gt;MemorySegment&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ— é”å¹¶å‘æ§åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… Unsafe çš„ CAS â†’ æ›¿ä»£ï¼š&lt;code&gt;AtomicInteger&lt;/code&gt;ã€&lt;code&gt;LongAdder&lt;/code&gt;ï¼ˆå·²å°è£…å®‰å…¨æ“ä½œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜æ€§èƒ½æ¡†æ¶å¼€å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… Nettyã€Disruptor ç­‰åº•å±‚ä¾èµ– â†’ æ™®é€šåº”ç”¨æ— éœ€ç›´æ¥ä½¿ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯¹è±¡å­—æ®µåå°„ä¿®æ”¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ é¿å… Unsafe â†’ æ›¿ä»£ï¼šæ ‡å‡†åå°„ API æˆ– &lt;code&gt;MethodHandles&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“ä¸æœ€ä½³å®è·µ"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼š
Unsafe æ˜¯ Java é«˜æ€§èƒ½ç”Ÿæ€çš„åŸºçŸ³ï¼Œä¸ºå¹¶å‘æ¡†æ¶ã€ç½‘ç»œåº“æä¾›åº•å±‚æ”¯æŒï¼Œä½†å…¶èƒ½åŠ›ä¸é£é™©å¹¶å­˜ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åŸåˆ™ï¼š
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»…é™å¿…è¦åœºæ™¯&lt;/strong&gt;ï¼šå¦‚æ¡†æ¶å¼€å‘æˆ–æè‡´æ€§èƒ½ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;ä¸¥æ ¼èµ„æºç®¡ç†&lt;/strong&gt;ï¼šå†…å­˜åˆ†é…åå¿…é¡»é…å¯¹é‡Šæ”¾ï¼ˆ&lt;code&gt;try-finally&lt;/code&gt; å—ç¡®ä¿ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡çº§æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼šJava 17+ ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;VarHandle&lt;/code&gt;ã€&lt;code&gt;MemorySegment&lt;/code&gt; ç­‰å®‰å…¨ APIã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç»ˆæå»ºè®®ï¼š
&lt;blockquote&gt;
&lt;p&gt;â€œé™¤éä½ æ¸…æ¥šæ¯ä¸€è¡Œä»£ç çš„åº•å±‚å½±å“ï¼Œå¦åˆ™è¿œç¦» Unsafeã€‚â€ â€”â€” é€‚ç”¨äº 99% çš„å¸¸è§„ä¸šåŠ¡å¼€å‘ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="locksupport"&gt;LockSupport
&lt;/h2&gt;&lt;p&gt;LockSupport æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent.locks&lt;/code&gt;ï¼‰ä¸­çš„&lt;strong&gt;çº¿ç¨‹é˜»å¡å”¤é†’å·¥å…·ç±»&lt;/strong&gt;ï¼Œæä¾›åŸºäºè®¸å¯ï¼ˆPermitï¼‰çš„åº•å±‚çº¿ç¨‹æ§åˆ¶æœºåˆ¶ã€‚å®ƒæ˜¯æ„å»ºé«˜çº§åŒæ­¥å™¨ï¼ˆå¦‚ AQSã€ReentrantLockï¼‰çš„åŸºç¡€ï¼Œç›¸æ¯”ä¼ ç»ŸåŒæ­¥æœºåˆ¶æ›´çµæ´»é«˜æ•ˆã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€å…³é”®æ–¹æ³•ã€åº”ç”¨åœºæ™¯åŠåº•å±‚å®ç°å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†è®¸å¯æœºåˆ¶permit"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†ï¼šè®¸å¯æœºåˆ¶ï¼ˆPermitï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ¯ä¸ªçº¿ç¨‹å…³è”ä¸€ä¸ª&lt;strong&gt;äºŒå…ƒè®¸å¯è¯&lt;/strong&gt;ï¼ˆå€¼ä»…ä¸º &lt;code&gt;0&lt;/code&gt; æˆ– &lt;code&gt;1&lt;/code&gt;ï¼‰ï¼Œé»˜è®¤åˆå§‹å€¼ä¸º &lt;code&gt;0&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;park()ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥è®¸å¯ä¸º &lt;code&gt;1&lt;/code&gt;ï¼Œæ¶ˆè€—è®¸å¯å¹¶&lt;strong&gt;ç«‹å³è¿”å›&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;è‹¥è®¸å¯ä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œ&lt;strong&gt;é˜»å¡çº¿ç¨‹&lt;/strong&gt;ï¼Œç›´åˆ°æ»¡è¶³å”¤é†’æ¡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;unpark(Thread thread)ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥ç›®æ ‡çº¿ç¨‹è®¸å¯ä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œå°†å…¶ç½®ä¸º &lt;code&gt;1&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;è‹¥ç›®æ ‡çº¿ç¨‹å›  &lt;code&gt;park()&lt;/code&gt; é˜»å¡ï¼Œåˆ™&lt;strong&gt;å”¤é†’å®ƒ&lt;/strong&gt;ï¼ˆå”¤é†’åè®¸å¯é‡ç½®ä¸º &lt;code&gt;0&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;å…³é”®ç‰¹æ€§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºæ— å…³æ€§&lt;/strong&gt;ï¼š&lt;code&gt;unpark&lt;/code&gt; å¯å…ˆäº &lt;code&gt;park&lt;/code&gt; è°ƒç”¨ï¼ˆè®¸å¯æå‰å­˜å‚¨ï¼Œ&lt;code&gt;park&lt;/code&gt; ä¸é˜»å¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¸å¯ä¸ç´¯ç§¯&lt;/strong&gt;ï¼šå¤šæ¬¡ &lt;code&gt;unpark&lt;/code&gt; ä»…ä¿ç•™ä¸€ä¸ªè®¸å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸­æ–­å“åº”&lt;/strong&gt;ï¼šé˜»å¡çº¿ç¨‹è¢«ä¸­æ–­æ—¶ï¼Œ&lt;code&gt;park()&lt;/code&gt; è‡ªåŠ¨è¿”å›ï¼ˆ&lt;strong&gt;ä¸æŠ›å¼‚å¸¸&lt;/strong&gt;ï¼‰ï¼Œéœ€æ‰‹åŠ¨æ£€æŸ¥ &lt;code&gt;Thread.interrupted()&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ–¹æ³•è¯¦è§£"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒæ–¹æ³•è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;park()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ— é™é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°è¢«å”¤é†’æˆ–ä¸­æ–­ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;park(Object blocker)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡çº¿ç¨‹å¹¶è®°å½•é˜»å¡åŸå› ï¼ˆ&lt;code&gt;blocker&lt;/code&gt;ï¼‰ï¼Œä¾¿äºç›‘æ§å·¥å…·è¯Šæ–­ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;parkNanos(long nanos)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡æŒ‡å®šçº³ç§’æ•°åè‡ªåŠ¨è¿”å›ï¼ˆæ”¯æŒè¶…æ—¶æ§åˆ¶ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;parkUntil(long deadline)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡ç›´åˆ°ç»å¯¹æ—¶é—´æˆ³ &lt;code&gt;deadline&lt;/code&gt;ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;unpark(Thread thread)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å”¤é†’æŒ‡å®šçº¿ç¨‹ï¼ˆç²¾å‡†æ§åˆ¶ï¼Œé¿å…éšæœºå”¤é†’ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å”¤é†’æ¡ä»¶&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…¶ä»–çº¿ç¨‹è°ƒç”¨ &lt;code&gt;unpark(å½“å‰çº¿ç¨‹)&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;å½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼ˆ&lt;code&gt;thread.interrupt()&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;è™šå‡å”¤é†’ï¼ˆæå°‘å‘ç”Ÿï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°è·¨è¶Šä¸‰å±‚æ¶æ„"&gt;âš¡ &lt;strong&gt;åº•å±‚å®ç°ï¼šè·¨è¶Šä¸‰å±‚æ¶æ„&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;LockSupport çš„é«˜æ•ˆæ€§æºäºå…¶åˆ†å±‚è®¾è®¡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Java API å±‚&lt;/strong&gt;ï¼š
è°ƒç”¨ &lt;code&gt;Unsafe.park()&lt;/code&gt;/&lt;code&gt;Unsafe.unpark()&lt;/code&gt; çš„æœ¬åœ°æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;JVM å±‚ï¼ˆHotSpotï¼‰ï¼š
æ¯ä¸ªçº¿ç¨‹å…³è”ä¸€ä¸ª Parker å¯¹è±¡ï¼ˆC++ ç±»ï¼‰ï¼Œå†…å«ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;_counter&lt;/code&gt;ï¼šè®¸å¯è®¡æ•°å™¨ï¼ˆ&lt;code&gt;0&lt;/code&gt; æˆ– &lt;code&gt;1&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_mutex&lt;/code&gt; å’Œ &lt;code&gt;_cond&lt;/code&gt;ï¼šåŸºäº OS çš„åŒæ­¥åŸè¯­ï¼ˆå¦‚ Linux çš„ &lt;code&gt;pthread_cond_wait&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œç³»ç»Ÿå±‚&lt;/strong&gt;ï¼š
Linux é€šè¿‡ &lt;code&gt;futex&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨å®ç°é«˜æ•ˆçº¿ç¨‹é˜»å¡/å”¤é†’ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[Java: LockSupport.park()] --&amp;gt; B[JVM: Parker.park()]
B --&amp;gt; C[OS: futex/pthread_cond_wait]
C --&amp;gt; D[CPU: çº¿ç¨‹æŒ‚èµ·]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-ä¸ä¼ ç»ŸåŒæ­¥æœºåˆ¶å¯¹æ¯”"&gt;ğŸ†š &lt;strong&gt;ä¸ä¼ ç»ŸåŒæ­¥æœºåˆ¶å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;LockSupport&lt;/th&gt;
&lt;th&gt;Object.wait()/notify()&lt;/th&gt;
&lt;th&gt;Condition.await()/signal()&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–é”å¯¹è±¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— éœ€ä»»ä½•é”&lt;/td&gt;
&lt;td&gt;âœ… éœ€ &lt;code&gt;synchronized&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âœ… éœ€ &lt;code&gt;ReentrantLock&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å”¤é†’ç²¾åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æŒ‡å®šçº¿ç¨‹å”¤é†’&lt;/td&gt;
&lt;td&gt;âŒ &lt;code&gt;notify()&lt;/code&gt; éšæœºå”¤é†’&lt;/td&gt;
&lt;td&gt;âŒ &lt;code&gt;signal()&lt;/code&gt; éšæœºå”¤é†’&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é¡ºåºå®¹é”™æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒå…ˆ &lt;code&gt;unpark&lt;/code&gt; å &lt;code&gt;park&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ å…ˆ &lt;code&gt;notify&lt;/code&gt; å &lt;code&gt;wait&lt;/code&gt; å¤±æ•ˆ&lt;/td&gt;
&lt;td&gt;âŒ å…ˆ &lt;code&gt;signal&lt;/code&gt; å &lt;code&gt;await&lt;/code&gt; å¤±æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸­æ–­å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¿”å›åéœ€æ‰‹åŠ¨æ£€æŸ¥ä¸­æ–­çŠ¶æ€&lt;/td&gt;
&lt;td&gt;æŠ›å‡º &lt;code&gt;InterruptedException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŠ›å‡º &lt;code&gt;InterruptedException&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½¿ç”¨å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆæ— é”ç«äº‰é£é™©ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆæ˜“æ­»é”ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆéœ€ç®¡ç†é”ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;Object.wait() çš„å±€é™&lt;/strong&gt;ï¼š
å¿…é¡»åœ¨ &lt;code&gt;synchronized&lt;/code&gt; å—ä¸­ä½¿ç”¨ï¼Œä¸” &lt;code&gt;notify()&lt;/code&gt; æ— æ³•ç²¾å‡†å”¤é†’ç‰¹å®šçº¿ç¨‹ï¼Œæ˜“å¯¼è‡´â€œä¿¡å·ä¸¢å¤±â€æˆ–â€œæƒŠç¾¤æ•ˆåº”â€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹"&gt;ğŸ› ï¸ &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç²¾å‡†æ§åˆ¶çº¿ç¨‹åä½œ"&gt;&lt;strong&gt;ç²¾å‡†æ§åˆ¶çº¿ç¨‹åä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// ç¤ºä¾‹ï¼šä¸‰ä¸ªçº¿ç¨‹äº¤æ›¿æ‰“å° ABC&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AlternatePrint&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Runnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;taskA&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LockSupport&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;park&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç­‰å¾…å”¤é†’&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;A&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LockSupport&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unpark&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å”¤é†’B&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç±»ä¼¼å®ç° taskBï¼ˆæ‰“å°Båå”¤é†’Cï¼‰ã€taskCï¼ˆæ‰“å°Cåå”¤é†’Aï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;taskA&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;taskB&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;taskC&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LockSupport&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unpark&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å¯åŠ¨æµç¨‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// è¾“å‡ºï¼šABCABC&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="è¶…æ—¶æ§åˆ¶ä¸ä¸­æ–­å¤„ç†"&gt;&lt;strong&gt;è¶…æ—¶æ§åˆ¶ä¸ä¸­æ–­å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;worker&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;workFinished&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;interrupted&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cleanUp&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å“åº”ä¸­æ–­æ¸…ç†èµ„æº&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LockSupport&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;parkNanos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;500_000_000&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é˜»å¡0.5ç§’&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;worker&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// å¤–éƒ¨ä¸­æ–­æˆ–è¶…æ—¶åè‡ªåŠ¨æ¢å¤&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="æ„å»ºé«˜çº§åŒæ­¥å™¨å¦‚aqs"&gt;&lt;strong&gt;æ„å»ºé«˜çº§åŒæ­¥å™¨ï¼ˆå¦‚AQSï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;AQS çš„é˜»å¡é˜Ÿåˆ—ä¾èµ– &lt;code&gt;LockSupport.park()&lt;/code&gt; æŒ‚èµ·çº¿ç¨‹ï¼Œ&lt;code&gt;release()&lt;/code&gt; æ—¶è°ƒç”¨ &lt;code&gt;unpark()&lt;/code&gt; å”¤é†’åç»§èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-1"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…æ­»é”&lt;/strong&gt;ï¼š
&lt;code&gt;unpark()&lt;/code&gt; éœ€ç¡®ä¿ç›®æ ‡çº¿ç¨‹å·²å¯åŠ¨ï¼ˆå¦åˆ™å”¤é†’æ— æ•ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¸å¯ä¸ç´¯ç§¯&lt;/strong&gt;ï¼š
è¿ç»­å¤šæ¬¡ &lt;code&gt;unpark()&lt;/code&gt; ç­‰æ•ˆäºä¸€æ¬¡ï¼Œè®¾è®¡é€»è¾‘æ—¶å‹¿ä¾èµ–å¤šæ¬¡è°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸­æ–­å¤„ç†&lt;/strong&gt;ï¼š
åœ¨ &lt;code&gt;park()&lt;/code&gt; åæ£€æŸ¥ &lt;code&gt;Thread.interrupted()&lt;/code&gt;ï¼Œç¡®ä¿ä¸šåŠ¡é€»è¾‘å¥å£®æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜»å¡åŸå› è®°å½•&lt;/strong&gt;ï¼š
ä½¿ç”¨ &lt;code&gt;park(Object blocker)&lt;/code&gt; ä¾¿äºè¯Šæ–­çº¿ç¨‹é˜»å¡é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;LockSupport æ˜¯ Java å¹¶å‘ç¼–ç¨‹çš„&lt;strong&gt;åº•å±‚åŸºçŸ³&lt;/strong&gt;ï¼Œé€šè¿‡&lt;strong&gt;è®¸å¯æœºåˆ¶&lt;/strong&gt;å’Œ&lt;strong&gt;ç²¾å‡†å”¤é†’&lt;/strong&gt;è§£å†³äº†ä¼ ç»ŸåŒæ­¥å·¥å…·çš„å±€é™æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;ï¼šè„±ç¦»é”æŸç¼šï¼Œå¯åœ¨ä»»æ„ä½ç½®é˜»å¡/å”¤é†’çº¿ç¨‹ï¼›&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;é«˜æ•ˆæ€§&lt;/strong&gt;ï¼šåŸºäº JVM å’Œ OS åŸè¯­ï¼Œæ€§èƒ½ä¼˜äº &lt;code&gt;synchronized&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;ç²¾å‡†æ€§&lt;/strong&gt;ï¼šæŒ‡å®šçº¿ç¨‹å”¤é†’ï¼Œé¿å…éšæœºæ€§å’Œä¿¡å·ä¸¢å¤±ï¼›&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;å¥å£®æ€§&lt;/strong&gt;ï¼šæ”¯æŒè¶…æ—¶æ§åˆ¶å’Œä¸­æ–­å“åº”ã€‚
æŒæ¡ LockSupport æ˜¯ç†è§£ AQSã€ReentrantLock ç­‰é«˜çº§åŒæ­¥å™¨çš„å…³é”®ï¼Œå°¤å…¶é€‚åˆæ„å»ºé«˜å¹¶å‘ã€ä½å»¶è¿Ÿçš„åŒæ­¥ç»„ä»¶ï¼ˆå¦‚è¿æ¥æ± ã€é™æµå™¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="abstractqueuedsynchronizer"&gt;AbstractQueuedSynchronizer
&lt;/h2&gt;&lt;p&gt;AbstractQueuedSynchronizerï¼ˆAQSï¼‰æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent.locks&lt;/code&gt;ï¼‰çš„æ ¸å¿ƒæ¡†æ¶ï¼Œç”± Doug Lea è®¾è®¡ï¼Œç”¨äºæ„å»ºé”å’Œå…¶ä»–åŒæ­¥å™¨ï¼ˆå¦‚ &lt;code&gt;ReentrantLock&lt;/code&gt;ã€&lt;code&gt;Semaphore&lt;/code&gt;ã€&lt;code&gt;CountDownLatch&lt;/code&gt; ç­‰ï¼‰ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ &lt;strong&gt;åŸå­çŠ¶æ€ç®¡ç†&lt;/strong&gt; å’Œ &lt;strong&gt;FIFO çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—&lt;/strong&gt; å®ç°é«˜æ•ˆçš„çº¿ç¨‹åŒæ­¥ã€‚ä»¥ä¸‹ä»è®¾è®¡åŸç†ã€æ ¸å¿ƒç»“æ„ã€å·¥ä½œæµç¨‹ã€åº”ç”¨åœºæ™¯åŠå®ç°æ¡ˆä¾‹å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒè®¾è®¡åŸç†"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒè®¾è®¡åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="çŠ¶æ€ç®¡ç†state"&gt;&lt;strong&gt;çŠ¶æ€ç®¡ç†ï¼ˆStateï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;state å˜é‡ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;volatile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;ç±»å‹ï¼Œè¡¨ç¤ºèµ„æºçš„å¯ç”¨çŠ¶æ€ï¼ˆå¦‚é”æ˜¯å¦è¢«å ç”¨ã€ä¿¡å·é‡å‰©ä½™è®¸å¯æ•°ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;æ“ä½œæ–¹æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;getState()&lt;/code&gt;ï¼šè·å–å½“å‰çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setState(int)&lt;/code&gt;ï¼šç›´æ¥è®¾ç½®çŠ¶æ€ï¼ˆéåŸå­ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;compareAndSetState(int, int)&lt;/code&gt;ï¼šCAS åŸå­æ›´æ–°çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åº”ç”¨ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼š&lt;code&gt;state=0&lt;/code&gt; è¡¨ç¤ºæœªé”å®šï¼Œ&lt;code&gt;state&amp;gt;0&lt;/code&gt; è¡¨ç¤ºé”å®šæ¬¡æ•°ï¼ˆæ”¯æŒé‡å…¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Semaphore&lt;/code&gt;ï¼š&lt;code&gt;state&lt;/code&gt; è¡¨ç¤ºå¯ç”¨è®¸å¯æ•°é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç­‰å¾…é˜Ÿåˆ—clh-å˜ä½“"&gt;&lt;strong&gt;ç­‰å¾…é˜Ÿåˆ—ï¼ˆCLH å˜ä½“ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŒå‘é“¾è¡¨é˜Ÿåˆ—ï¼šå­˜å‚¨ç­‰å¾…èµ„æºçš„çº¿ç¨‹ï¼ŒèŠ‚ç‚¹ä¸º Nodeå¯¹è±¡
&lt;ul&gt;
&lt;li&gt;å…³é”®å­—æ®µï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;head&lt;/code&gt;/&lt;code&gt;tail&lt;/code&gt;ï¼šé˜Ÿé¦–å’Œé˜Ÿå°¾æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;Node ç»“æ„ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Node&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;volatile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waitStatus&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// èŠ‚ç‚¹çŠ¶æ€ï¼ˆå¦‚ç­‰å¾…å”¤é†’ã€å·²å–æ¶ˆï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;volatile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prev&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å‰é©±èŠ‚ç‚¹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;volatile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// åç»§èŠ‚ç‚¹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;volatile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å…³è”çº¿ç¨‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;nextWaiter&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ¡ä»¶é˜Ÿåˆ—çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;waitStatus çŠ¶æ€å€¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;CANCELLED (1)&lt;/code&gt;ï¼šçº¿ç¨‹å·²å–æ¶ˆç­‰å¾…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SIGNAL (-1)&lt;/code&gt;ï¼šåç»­èŠ‚ç‚¹éœ€è¢«å”¤é†’ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CONDITION (-2)&lt;/code&gt;ï¼šèŠ‚ç‚¹å¤„äºæ¡ä»¶é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;Condition&lt;/code&gt; çš„ç­‰å¾…é˜Ÿåˆ—ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="çº¿ç¨‹é˜»å¡ä¸å”¤é†’"&gt;&lt;strong&gt;çº¿ç¨‹é˜»å¡ä¸å”¤é†’&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;LockSupport&lt;/code&gt; å·¥å…·&lt;/strong&gt;ï¼š
åŸºäºè®¸å¯æœºåˆ¶é˜»å¡ï¼ˆ&lt;code&gt;park()&lt;/code&gt;ï¼‰æˆ–å”¤é†’ï¼ˆ&lt;code&gt;unpark()&lt;/code&gt;ï¼‰çº¿ç¨‹ï¼Œé¿å…æ­»é”é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹ä»¥ç‹¬å æ¨¡å¼ä¸ºä¾‹"&gt;âš™ï¸ &lt;strong&gt;å·¥ä½œæµç¨‹ï¼ˆä»¥ç‹¬å æ¨¡å¼ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="è·å–èµ„æº"&gt;&lt;strong&gt;è·å–èµ„æºï¼ˆ&lt;code&gt;acquire&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;public final void acquire(int arg) {
if (!tryAcquire(arg) &amp;amp;&amp;amp;
acquireQueued(addWaiter(Node.EXCLUSIVE), arg)) {
selfInterrupt();
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;tryAcquire(arg)&lt;/code&gt;&lt;/strong&gt;ï¼šå­ç±»å®ç°ï¼Œå°è¯•è·å–èµ„æºï¼ˆå¦‚ CAS è®¾ç½® &lt;code&gt;state&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤±è´¥åˆ™å…¥é˜Ÿï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;addWaiter()&lt;/code&gt;ï¼šå°†çº¿ç¨‹å°è£…ä¸º &lt;code&gt;Node&lt;/code&gt; åŠ å…¥é˜Ÿå°¾ï¼ˆCAS ä¿è¯åŸå­æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;acquireQueued()&lt;/code&gt;ï¼šè‡ªæ—‹å°è¯•è·å–èµ„æºï¼Œå¤±è´¥åˆ™é˜»å¡ï¼ˆ&lt;code&gt;LockSupport.park()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;å”¤é†’åé‡è¯•&lt;/strong&gt;ï¼šå‰é©±èŠ‚ç‚¹é‡Šæ”¾èµ„æºåï¼Œå”¤é†’å½“å‰èŠ‚ç‚¹é‡æ–°å°è¯•è·å–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="é‡Šæ”¾èµ„æº"&gt;&lt;strong&gt;é‡Šæ”¾èµ„æºï¼ˆ&lt;code&gt;release&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;public final boolean release(int arg) {
if (tryRelease(arg)) {
Node h = head;
if (h != null &amp;amp;&amp;amp; h.waitStatus != 0)
unparkSuccessor(h); // å”¤é†’åç»§èŠ‚ç‚¹
return true;
}
return false;
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;tryRelease(arg)&lt;/code&gt;&lt;/strong&gt;ï¼šå­ç±»å®ç°ï¼Œé‡Šæ”¾èµ„æºï¼ˆå¦‚é‡ç½® &lt;code&gt;state&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;å”¤é†’åç»§&lt;/strong&gt;ï¼šè‹¥é˜Ÿåˆ—ä¸­å­˜åœ¨æœ‰æ•ˆèŠ‚ç‚¹ï¼Œå”¤é†’å…¶çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;å…±äº«æ¨¡å¼&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;Semaphore&lt;/code&gt;ï¼‰é€»è¾‘ç±»ä¼¼ï¼Œä½†å…è®¸å¤šçº¿ç¨‹åŒæ—¶è·å–èµ„æºï¼ˆ&lt;code&gt;tryAcquireShared()&lt;/code&gt; è¿”å›å‰©ä½™è®¸å¯æ•°ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-aqs-çš„ä¸¤ç§æ¨¡å¼"&gt;ğŸ› ï¸ &lt;strong&gt;AQS çš„ä¸¤ç§æ¨¡å¼&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‹¬å æ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŒä¸€æ—¶é—´ä»…ä¸€ä¸ªçº¿ç¨‹å¯è·å–èµ„æºï¼ˆå¦‚ &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å†™æ“ä½œã€äº’æ–¥è®¿é—®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…±äº«æ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šä¸ªçº¿ç¨‹å¯åŒæ—¶è·å–èµ„æºï¼ˆå¦‚ &lt;code&gt;Semaphore&lt;/code&gt;ã€&lt;code&gt;CountDownLatch&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;è¯»æ“ä½œã€èµ„æºæ± ç®¡ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åŸºäº-aqs-çš„-jdk-åŒæ­¥å·¥å…·"&gt;ğŸŒ &lt;strong&gt;åŸºäº AQS çš„ JDK åŒæ­¥å·¥å…·&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ReentrantLockï¼š
&lt;ul&gt;
&lt;li&gt;ç‹¬å é”ï¼Œæ”¯æŒé‡å…¥å’Œå…¬å¹³æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;state&lt;/code&gt; è®°å½•é‡å…¥æ¬¡æ•°ï¼Œå…¬å¹³é”æŒ‰é˜Ÿåˆ—é¡ºåºè·å–èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Semaphoreï¼š
&lt;ul&gt;
&lt;li&gt;å…±äº«æ¨¡å¼ï¼Œ&lt;code&gt;state&lt;/code&gt; è¡¨ç¤ºå¯ç”¨è®¸å¯æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;acquire()&lt;/code&gt; å‡å°‘è®¸å¯ï¼Œ&lt;code&gt;release()&lt;/code&gt; å¢åŠ è®¸å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;CountDownLatchï¼š
&lt;ul&gt;
&lt;li&gt;å…±äº«æ¨¡å¼ï¼Œåˆå§‹åŒ– &lt;code&gt;state=N&lt;/code&gt;ï¼Œ&lt;code&gt;countDown()&lt;/code&gt; é€’å‡ &lt;code&gt;state&lt;/code&gt;ï¼Œ&lt;code&gt;await()&lt;/code&gt; åœ¨ &lt;code&gt;state=0&lt;/code&gt; æ—¶å”¤é†’çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ReentrantReadWriteLockï¼š
&lt;ul&gt;
&lt;li&gt;æ··åˆæ¨¡å¼ï¼šå†™é”ç‹¬å ï¼Œè¯»é”å…±äº«ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;state&lt;/code&gt; é«˜ 16 ä½è®°å½•è¯»é”æ•°é‡ï¼Œä½ 16 ä½è®°å½•å†™é”é‡å…¥æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°"&gt;ğŸ’» &lt;strong&gt;è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ­¥éª¤"&gt;&lt;strong&gt;æ­¥éª¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;å®šä¹‰å†…éƒ¨ç±»ç»§æ‰¿ &lt;code&gt;AQS&lt;/code&gt;ï¼Œé‡å†™é’©å­æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;tryAcquire&lt;/code&gt;ã€&lt;code&gt;tryRelease&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å°è£…åŒæ­¥æ¥å£ï¼ˆå¦‚ &lt;code&gt;Lock&lt;/code&gt;ï¼‰ï¼Œå§”æ‰˜ç»™ AQS å­ç±»æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="ç¤ºä¾‹éé‡å…¥äº’æ–¥é”"&gt;&lt;strong&gt;ç¤ºä¾‹ï¼šéé‡å…¥äº’æ–¥é”&lt;/strong&gt;
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Mutex&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Lock&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Sync&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sync&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Sync&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å§”æ‰˜ç»™ Sync ç±»&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sync&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;acquire&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Sync&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;extends&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AbstractQueuedSynchronizer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;protected&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;tryAcquire&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;arg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;compareAndSetState&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// CAS è·å–é”&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;protected&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;tryRelease&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;arg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;setState&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é‡Šæ”¾é”&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="æ³¨æ„äº‹é¡¹"&gt;&lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é’©å­æ–¹æ³•éœ€çº¿ç¨‹å®‰å…¨&lt;/strong&gt;ï¼šé¿å…ä½¿ç”¨é˜»å¡æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ä»¶å˜é‡æ”¯æŒ&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;newCondition()&lt;/code&gt; è¿”å› &lt;code&gt;ConditionObject&lt;/code&gt;ï¼ˆéœ€å®ç° &lt;code&gt;isHeldExclusively()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-aqs-ä¸-synchronized-å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;AQS ä¸ synchronized å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AQS&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;synchronized&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯ä¸­æ–­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒ &lt;code&gt;lockInterruptibly()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸å¯ä¸­æ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¶…æ—¶æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒ &lt;code&gt;tryLock(timeout, unit)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¬å¹³æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å¯é…ç½®ï¼ˆå…¬å¹³/éå…¬å¹³ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ä»…éå…¬å¹³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨å®ç°é”é€»è¾‘&lt;/td&gt;
&lt;td&gt;JVM è‡ªåŠ¨ç®¡ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ç«äº‰åœºæ™¯æ›´ä¼˜ï¼ˆå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ç«äº‰åœºæ™¯è¶³å¤Ÿé«˜æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;AQS é€šè¿‡ &lt;strong&gt;åŸå­çŠ¶æ€ç®¡ç† + CLH é˜Ÿåˆ— + æ¨¡æ¿æ–¹æ³•&lt;/strong&gt; çš„è®¾è®¡ï¼Œä¸ºæ„å»ºé«˜æ•ˆåŒæ­¥ç»„ä»¶æä¾›äº†æ ‡å‡†åŒ–æ¡†æ¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šè§£è€¦åŒæ­¥çŠ¶æ€ç®¡ç†ä¸çº¿ç¨‹è°ƒåº¦ï¼Œæ”¯æŒç‹¬å /å…±äº«ä¸¤ç§æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘éœ€ç²¾ç»†æ§åˆ¶é”ï¼ˆå¦‚è¶…æ—¶ã€å…¬å¹³æ€§ï¼‰çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;ï¼šä¼˜å…ˆä½¿ç”¨ JDK å†…ç½®åŒæ­¥å·¥å…·ï¼ˆå¦‚ &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰ï¼Œä»…å½“ç‰¹æ®Šéœ€æ±‚æ—¶è‡ªå®šä¹‰ AQS å­ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ·±å…¥ç†è§£ AQS æ˜¯æŒæ¡ Java å¹¶å‘çš„å…³é”®ï¼Œå…¶è®¾è®¡æ€æƒ³ï¼ˆå¦‚ CASã€é˜Ÿåˆ—è°ƒåº¦ï¼‰å¹¿æ³›ç”¨äºé«˜æ€§èƒ½ä¸­é—´ä»¶ï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ± ã€é™æµå™¨ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="clh-é˜Ÿåˆ—"&gt;CLH é˜Ÿåˆ—
&lt;/h2&gt;&lt;p&gt;CLHé˜Ÿåˆ—æ˜¯ä¸€ç§åŸºäºé“¾è¡¨çš„&lt;strong&gt;å…¬å¹³è‡ªæ—‹é”å®ç°&lt;/strong&gt;ï¼Œç”±Craigã€Landinå’ŒHagerstenæå‡ºï¼ˆå–ä¸‰äººåå­—é¦–å­—æ¯å‘½åï¼‰ã€‚å®ƒé€šè¿‡éšå¼é˜Ÿåˆ—ç®¡ç†çº¿ç¨‹çš„é”è¯·æ±‚é¡ºåºï¼Œæ˜¯Javaå¹¶å‘æ¡†æ¶ä¸­&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;ï¼ˆAQSï¼‰çš„åº•å±‚è®¾è®¡åŸºç¡€ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€å®ç°æœºåˆ¶ã€ä¼˜ç¼ºç‚¹åŠåº”ç”¨åœºæ™¯å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç»“æ„ä¸å·¥ä½œæµç¨‹"&gt;â›“ï¸ &lt;strong&gt;æ ¸å¿ƒç»“æ„ä¸å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç»„ä»¶"&gt;&lt;strong&gt;æ ¸å¿ƒç»„ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹ï¼ˆNodeï¼‰
æ¯ä¸ªçº¿ç¨‹è¯·æ±‚é”æ—¶åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼ŒåŒ…å«ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;locked&lt;/code&gt;ï¼šå¸ƒå°”å€¼ï¼Œæ ‡è¯†çº¿ç¨‹æ˜¯å¦éœ€è¦ç­‰å¾…ï¼ˆ&lt;code&gt;true&lt;/code&gt;è¡¨ç¤ºç­‰å¾…é”ï¼Œ&lt;code&gt;false&lt;/code&gt;è¡¨ç¤ºå¯è·å–é”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;prev&lt;/code&gt;ï¼šæŒ‡å‘å‰é©±èŠ‚ç‚¹çš„å¼•ç”¨ï¼ˆæ„å»ºéšå¼é“¾è¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°¾æŒ‡é’ˆï¼ˆTailï¼‰&lt;/strong&gt;
åŸå­å¼•ç”¨ç±»å‹ï¼ˆå¦‚&lt;code&gt;AtomicReference&lt;/code&gt;ï¼‰ï¼ŒæŒ‡å‘é˜Ÿåˆ—ä¸­æœ€æ–°åŠ å…¥çš„èŠ‚ç‚¹ï¼Œé€šè¿‡CASæ“ä½œä¿è¯çº¿ç¨‹å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å·¥ä½œæµç¨‹"&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[çº¿ç¨‹ç”³è¯·é”] --&amp;gt; B[åˆ›å»ºæ–°èŠ‚ç‚¹ locked=true]
B --&amp;gt; C[CASæ“ä½œåŠ å…¥é˜Ÿå°¾]
C --&amp;gt; D[è‡ªæ—‹æ£€æŸ¥å‰é©±èŠ‚ç‚¹çŠ¶æ€]
D --&amp;gt; E{å‰é©±èŠ‚ç‚¹ locked=false?}
E -- æ˜¯ --&amp;gt; F[è·å–é”æ‰§è¡Œ]
E -- å¦ --&amp;gt; D
F --&amp;gt; G[æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ]
G --&amp;gt; H[é‡Šæ”¾é”ï¼š locked=false]
H --&amp;gt; I[æ–­å¼€å‰é©±å¼•ç”¨]
&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ é”æµç¨‹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤1&lt;/strong&gt;ï¼šçº¿ç¨‹åˆ›å»ºæ–°èŠ‚ç‚¹ï¼Œ&lt;code&gt;locked=true&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤2&lt;/strong&gt;ï¼šé€šè¿‡CASå°†æ–°èŠ‚ç‚¹ç½®ä¸ºé˜Ÿå°¾ï¼Œå¹¶è®°å½•åŸå°¾èŠ‚ç‚¹ä½œä¸ºå‰é©±èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤3&lt;/strong&gt;ï¼šçº¿ç¨‹åœ¨å‰é©±èŠ‚ç‚¹çš„&lt;code&gt;locked&lt;/code&gt;å­—æ®µä¸Š&lt;strong&gt;è‡ªæ—‹ç­‰å¾…&lt;/strong&gt;ï¼Œç›´åˆ°å…¶å˜ä¸º&lt;code&gt;false&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡Šæ”¾æµç¨‹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤1&lt;/strong&gt;ï¼šçº¿ç¨‹å°†è‡ªèº«èŠ‚ç‚¹çš„&lt;code&gt;locked&lt;/code&gt;è®¾ä¸º&lt;code&gt;false&lt;/code&gt;ï¼Œé€šçŸ¥åç»§çº¿ç¨‹å¯è·å–é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­¥éª¤2&lt;/strong&gt;ï¼šæ–­å¼€å½“å‰èŠ‚ç‚¹ä¸å‰é©±èŠ‚ç‚¹çš„å¼•ç”¨ï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹Aè·å–é” â†’ èŠ‚ç‚¹A(&lt;code&gt;locked=true&lt;/code&gt;)å…¥é˜Ÿ â†’ &lt;code&gt;tail&lt;/code&gt;æŒ‡å‘Aã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹BåŠ å…¥ â†’ èŠ‚ç‚¹Bå…¥é˜Ÿ â†’ &lt;code&gt;tail&lt;/code&gt;æŒ‡å‘B â†’ Bè‡ªæ—‹æ£€æŸ¥Açš„&lt;code&gt;locked&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Aé‡Šæ”¾é”ï¼šè®¾ç½®A.&lt;code&gt;locked=false&lt;/code&gt; â†’ Bæ£€æµ‹åˆ°åé€€å‡ºè‡ªæ—‹ï¼Œè·å–é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æŠ€æœ¯ç‰¹ç‚¹åˆ†æ"&gt;âš™ï¸ &lt;strong&gt;æŠ€æœ¯ç‰¹ç‚¹åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒä¼˜åŠ¿"&gt;&lt;strong&gt;æ ¸å¿ƒä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸¥æ ¼å…¬å¹³æ€§&lt;/strong&gt;
æŒ‰è¯·æ±‚é¡ºåºåˆ†é…é”ï¼ˆFIFOï¼‰ï¼Œå½»åº•é¿å…çº¿ç¨‹é¥¥é¥¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±€éƒ¨è‡ªæ—‹å‡å°‘å¼€é”€&lt;/strong&gt;
çº¿ç¨‹ä»…è‡ªæ—‹æ£€æŸ¥&lt;strong&gt;å‰é©±èŠ‚ç‚¹&lt;/strong&gt;çš„çŠ¶æ€ï¼ˆè€Œéå…¨å±€å˜é‡ï¼‰ï¼Œå‡å°‘ç¼“å­˜åŒæ­¥å’Œæ€»çº¿æµé‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— â€œæƒŠç¾¤æ•ˆåº”â€&lt;/strong&gt;
é”é‡Šæ”¾æ—¶ä»…å”¤é†’ç›´æ¥åç»§èŠ‚ç‚¹ï¼Œé¿å…åŒæ—¶å”¤é†’å¤§é‡çº¿ç¨‹ç«äº‰èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å¤æ‚åº¦ä½&lt;/strong&gt;
è‹¥æœ‰Nä¸ªçº¿ç¨‹ç«äº‰Lä¸ªé”ï¼Œç©ºé—´å¤æ‚åº¦ä¸º&lt;code&gt;O(L+N)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å±€é™æ€§"&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;NUMAæ¶æ„æ€§èƒ½å·®&lt;/strong&gt;
åœ¨éç»Ÿä¸€å†…å­˜è®¿é—®ï¼ˆNUMAï¼‰ç³»ç»Ÿä¸­ï¼Œå‰é©±èŠ‚ç‚¹å¯èƒ½ä½äºè¿œç¨‹å†…å­˜ï¼Œè‡ªæ—‹æ£€æŸ¥å»¶è¿Ÿé«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªæ—‹æ¶ˆè€—CPU&lt;/strong&gt;
é«˜ç«äº‰åœºæ™¯ä¸‹ï¼Œé•¿æ—¶é—´è‡ªæ—‹å¯èƒ½å¯¼è‡´CPUç©ºè½¬ï¼ˆé€‚ç”¨äºçŸ­ä»»åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ç›´æ¥æ”¯æŒé”é‡å…¥&lt;/strong&gt;
éœ€é¢å¤–æœºåˆ¶å®ç°é‡å…¥ï¼ˆå¦‚AQSé€šè¿‡&lt;code&gt;state&lt;/code&gt;è®¡æ•°æ”¯æŒï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-clhåœ¨aqsä¸­çš„å˜ä½“å®ç°"&gt;ğŸ”„ &lt;strong&gt;CLHåœ¨AQSä¸­çš„å˜ä½“å®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;AQSå¯¹CLHè¿›è¡Œäº†å…³é”®æ”¹è¿›ä»¥é€‚åº”æ›´å¤æ‚åœºæ™¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŒå‘é“¾è¡¨ä»£æ›¿å•å‘é“¾è¡¨&lt;/strong&gt;
å¢åŠ &lt;code&gt;next&lt;/code&gt;æŒ‡é’ˆï¼Œæ”¯æŒé«˜æ•ˆå–æ¶ˆèŠ‚ç‚¹ï¼ˆå¦‚è¶…æ—¶æˆ–ä¸­æ–­ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜»å¡æ›¿ä»£è‡ªæ—‹&lt;/strong&gt;
ç”¨&lt;code&gt;LockSupport.park()&lt;/code&gt;æŒ‚èµ·çº¿ç¨‹ï¼ˆéè‡ªæ—‹ï¼‰ï¼Œå‡å°‘CPUæ¶ˆè€—ã€‚&lt;/li&gt;
&lt;li&gt;çŠ¶æ€æ‰©å±•èŠ‚ç‚¹
&lt;pre tabindex="0"&gt;&lt;code&gt;waitStatus
&lt;/code&gt;&lt;/pre&gt;æ”¯æŒå¤šç§çŠ¶æ€ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SIGNAL (-1)&lt;/code&gt;ï¼šåç»§èŠ‚ç‚¹éœ€å”¤é†’ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CANCELLED (1)&lt;/code&gt;ï¼šèŠ‚ç‚¹å·²å–æ¶ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CONDITION (-2)&lt;/code&gt;ï¼šèŠ‚ç‚¹åœ¨æ¡ä»¶é˜Ÿåˆ—ç­‰å¾…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒé˜Ÿåˆ—è®¾è®¡&lt;/strong&gt;
åˆ†ç¦»&lt;strong&gt;åŒæ­¥é˜Ÿåˆ—&lt;/strong&gt;â€‹ï¼ˆé”ç«äº‰ï¼‰å’Œ&lt;strong&gt;æ¡ä»¶é˜Ÿåˆ—&lt;/strong&gt;â€‹ï¼ˆ&lt;code&gt;Condition&lt;/code&gt;ç­‰å¾…ï¼‰ï¼Œæå‡çµæ´»æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš¡ &lt;strong&gt;æ€§èƒ½å¯¹æ¯”ï¼ˆCLH vs AQSå˜ä½“ï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;CLHé˜Ÿåˆ—&lt;/th&gt;
&lt;th&gt;AQSå˜ä½“&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜ç«äº‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;CPUç©ºè½¬ä¸¥é‡&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹æŒ‚èµ·ï¼Œå‡å°‘å¼€é”€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é•¿ä»»åŠ¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸é€‚ç”¨&lt;/td&gt;
&lt;td&gt;é€‚ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¬å¹³æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸¥æ ¼FIFO&lt;/td&gt;
&lt;td&gt;å¯é…ç½®å…¬å¹³/éå…¬å¹³&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯-1"&gt;ğŸŒ &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;SMPæ¶æ„çš„çŸ­ä»»åŠ¡é”&lt;/strong&gt;
å¤šæ ¸CPUå…±äº«å†…å­˜çš„åœºæ™¯ï¼ˆå¦‚è®¡æ•°å™¨ç´¯åŠ ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€ä¸¥æ ¼å…¬å¹³æ€§çš„åœºæ™¯&lt;/strong&gt;
å¦‚äº¤æ˜“ç³»ç»ŸæŒ‰è¯·æ±‚é¡ºåºå¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€é”åŸè¯­è®¾è®¡&lt;/strong&gt;
æ•°æ®åº“äº‹åŠ¡ç®¡ç†ã€åˆ†å¸ƒå¼é”ï¼ˆå¦‚ZooKeeperï¼‰å‚è€ƒCLHæ€æƒ³ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;CLHé˜Ÿåˆ—é€šè¿‡&lt;strong&gt;éšå¼é“¾è¡¨+å‰é©±èŠ‚ç‚¹è‡ªæ—‹&lt;/strong&gt;çš„æœºåˆ¶ï¼Œä»¥ä½å¼€é”€å®ç°äº†ä¸¥æ ¼å…¬å¹³é”ï¼Œå°¤å…¶é€‚åˆ&lt;strong&gt;çŸ­ä»»åŠ¡&lt;/strong&gt;å’Œ&lt;strong&gt;SMPæ¶æ„&lt;/strong&gt;ã€‚å…¶å±€é™æ€§ï¼ˆå¦‚NUMAæ€§èƒ½å·®ã€CPUç©ºè½¬ï¼‰ä¿ƒä½¿AQSç­‰æ¡†æ¶å¼•å…¥&lt;strong&gt;é˜»å¡å”¤é†’&lt;/strong&gt;å’Œ&lt;strong&gt;çŠ¶æ€æ‰©å±•&lt;/strong&gt;ä¼˜åŒ–ï¼Œæˆä¸ºJavaé«˜å¹¶å‘ç»„ä»¶çš„åŸºçŸ³ã€‚ç†è§£CLHæ˜¯æŒæ¡ç°ä»£åŒæ­¥å™¨è®¾è®¡çš„å…³é”®ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;h2 id="lock"&gt;Lock
&lt;/h2&gt;&lt;p&gt;Lock æ¥å£æ˜¯ Java å¹¶å‘ç¼–ç¨‹ä¸­ç”¨äºæ›¿ä»£ &lt;code&gt;synchronized&lt;/code&gt; çš„çº¿ç¨‹åŒæ­¥æœºåˆ¶ï¼Œä½äº &lt;code&gt;java.util.concurrent.locks&lt;/code&gt; åŒ…ä¸­ã€‚å®ƒæä¾›äº†æ›´çµæ´»ã€åŠŸèƒ½æ›´ä¸°å¯Œçš„é”æ§åˆ¶èƒ½åŠ›ï¼Œé€‚ç”¨äºå¤æ‚å¹¶å‘åœºæ™¯ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒä½œç”¨ã€æ–¹æ³•è¯¦è§£ã€å®ç°ç±»ã€ä¸ &lt;code&gt;synchronized&lt;/code&gt; çš„å¯¹æ¯”åŠé€‚ç”¨åœºæ™¯å±•å¼€åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-lock-æ¥å£çš„æ ¸å¿ƒä½œç”¨"&gt;ğŸ”’ &lt;strong&gt;Lock æ¥å£çš„æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç²¾ç»†åŒ–é”æ§åˆ¶
&lt;ul&gt;
&lt;li&gt;æ”¯æŒ&lt;strong&gt;å¯ä¸­æ–­é”&lt;/strong&gt;ã€&lt;strong&gt;è¶…æ—¶è·å–é”&lt;/strong&gt;ã€&lt;strong&gt;éé˜»å¡å°è¯•é”&lt;/strong&gt;ç­‰é«˜çº§åŠŸèƒ½ï¼Œå¼¥è¡¥ &lt;code&gt;synchronized&lt;/code&gt; çš„ä¸è¶³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ˜¾å¼é”ç®¡ç†
&lt;ul&gt;
&lt;li&gt;éœ€æ‰‹åŠ¨è°ƒç”¨ &lt;code&gt;lock()&lt;/code&gt; å’Œ &lt;code&gt;unlock()&lt;/code&gt; æ–¹æ³•ï¼Œé¿å…éšå¼é”çš„ä¸å¯æ§æ€§ï¼Œä½†éœ€åœ¨ &lt;code&gt;finally&lt;/code&gt; å—ä¸­ç¡®ä¿é‡Šæ”¾ï¼Œé˜²æ­¢æ­»é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ”¯æŒå¤šæ¡ä»¶å˜é‡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;Condition&lt;/code&gt; å¯¹è±¡å®ç°å¤šæ¡ä»¶é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;await()&lt;/code&gt;/&lt;code&gt;signal()&lt;/code&gt;ï¼‰ï¼Œæ¯” &lt;code&gt;synchronized&lt;/code&gt; çš„å•ä¸€ç­‰å¾…é›†æ›´çµæ´»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-lock-æ¥å£æ–¹æ³•è¯¦è§£"&gt;âš™ï¸ &lt;strong&gt;Lock æ¥å£æ–¹æ³•è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½¿ç”¨ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;void lock()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡è·å–é”ï¼Œè‹¥é”è¢«å ç”¨åˆ™çº¿ç¨‹ä¼‘çœ ç­‰å¾…&lt;/td&gt;
&lt;td&gt;åŸºç¡€é”æ“ä½œï¼Œéœ€é…åˆ &lt;code&gt;unlock()&lt;/code&gt; ä½¿ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;boolean tryLock()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å°è¯•éé˜»å¡è·å–é”ï¼ŒæˆåŠŸè¿”å› &lt;code&gt;true&lt;/code&gt;ï¼Œå¤±è´¥ç«‹å³è¿”å› &lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‚ç”¨äºè½»é‡çº§ä»»åŠ¡ï¼Œé¿å…çº¿ç¨‹é˜»å¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;tryLock(long, TimeUnit)&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¶…æ—¶å°è¯•è·å–é”ï¼Œæ”¯æŒä¸­æ–­å“åº”&lt;/td&gt;
&lt;td&gt;é¿å…æ— é™ç­‰å¾…ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆå¦‚ &lt;code&gt;lock.tryLock(100, TimeUnit.MILLISECONDS)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;lockInterruptibly()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯ä¸­æ–­è·å–é”ï¼Œç­‰å¾…è¿‡ç¨‹ä¸­å“åº” &lt;code&gt;interrupt()&lt;/code&gt; ä¿¡å·å¹¶æŠ›å‡º &lt;code&gt;InterruptedException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è§£å†³çº¿ç¨‹é•¿æœŸé˜»å¡é—®é¢˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;void unlock()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡Šæ”¾é”ï¼Œ&lt;strong&gt;å¿…é¡»&lt;/strong&gt;åœ¨ &lt;code&gt;finally&lt;/code&gt; å—ä¸­è°ƒç”¨&lt;/td&gt;
&lt;td&gt;ç¡®ä¿å¼‚å¸¸æ—¶é”ä»é‡Šæ”¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;Condition newCondition()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºç»‘å®šåˆ°é”çš„æ¡ä»¶å˜é‡ï¼Œæ”¯æŒç²¾ç»†çº¿ç¨‹é€šä¿¡&lt;/td&gt;
&lt;td&gt;æ›¿ä»£ &lt;code&gt;wait()&lt;/code&gt;/&lt;code&gt;notify()&lt;/code&gt;ï¼Œå®ç°å¤šæ¡ä»¶ç­‰å¾…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// æ ‡å‡†ä½¿ç”¨æ¨¡æ¿ï¼ˆé¿å…æ­»é”ï¼‰
Lock lock = new ReentrantLock();
lock.lock();
try {
// åŒæ­¥ä»£ç é€»è¾‘
} finally {
lock.unlock(); // ç¡®ä¿é‡Šæ”¾
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-lock-çš„ä¸»è¦å®ç°ç±»"&gt;ğŸ”§ &lt;strong&gt;Lock çš„ä¸»è¦å®ç°ç±»&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼ˆå¯é‡å…¥é”ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç‰¹æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;åŒä¸€çº¿ç¨‹å¯é‡å¤è·å–é”ï¼ˆé‡å…¥è®¡æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒ&lt;strong&gt;å…¬å¹³é”&lt;/strong&gt;ï¼ˆæŒ‰è¯·æ±‚é¡ºåºåˆ†é…ï¼‰å’Œ&lt;strong&gt;éå…¬å¹³é”&lt;/strong&gt;ï¼ˆé»˜è®¤ï¼Œååé‡é«˜ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ›¿ä»£ &lt;code&gt;synchronized&lt;/code&gt;ï¼Œéœ€é‡å…¥æˆ–å…¬å¹³æ€§çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ReentrantReadWriteLock&lt;/code&gt;ï¼ˆè¯»å†™é”ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç‰¹æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;åˆ†ç¦»è¯»é”ï¼ˆå…±äº«ï¼‰å’Œå†™é”ï¼ˆç‹¬å ï¼‰ï¼Œ&lt;strong&gt;è¯»å¤šå†™å°‘&lt;/strong&gt;æ—¶å¤§å¹…æå‡å¹¶å‘æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;å†™é”ä¼˜å…ˆï¼šé¿å…è¯»çº¿ç¨‹é¥¥é¥¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ReadWriteLock rwLock = new ReentrantReadWriteLock();
rwLock.readLock().lock(); // å¤šçº¿ç¨‹å¯å¹¶å‘è¯»
rwLock.writeLock().lock(); // å†™é”ç‹¬å 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-lock-vs-synchronized-æ ¸å¿ƒå¯¹æ¯”"&gt;â†”ï¸ &lt;strong&gt;Lock vs Synchronized æ ¸å¿ƒå¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Lock&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Synchronized&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¾å¼é”ï¼ˆæ‰‹åŠ¨è·å–/é‡Šæ”¾ï¼‰&lt;/td&gt;
&lt;td&gt;éšå¼é”ï¼ˆè‡ªåŠ¨é‡Šæ”¾ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯ä¸­æ–­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒ &lt;code&gt;lockInterruptibly()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸å¯ä¸­æ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¶…æ—¶æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… &lt;code&gt;tryLock(timeout)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¬å¹³æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… å¯é…ç½®ï¼ˆå…¬å¹³/éå…¬å¹³ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ ä»…éå…¬å¹³é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¡ä»¶å˜é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒå¤šä¸ª &lt;code&gt;Condition&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ å•ä¸€ç­‰å¾…é›†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ï¼ˆé«˜ç«äº‰ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ›´ä¼˜ï¼ˆCAS å‡å°‘é˜»å¡ï¼‰&lt;/td&gt;
&lt;td&gt;JDK 6+ ä¼˜åŒ–åæ¥è¿‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ­»é”é£é™©&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨é‡Šæ”¾ï¼ˆå¿˜è®° &lt;code&gt;unlock()&lt;/code&gt; æ˜“æ­»é”ï¼‰&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨é‡Šæ”¾ï¼ˆå¼‚å¸¸æ—¶å®‰å…¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ï¼ˆéœ€æ¨¡æ¿ä»£ç ï¼‰&lt;/td&gt;
&lt;td&gt;ç®€æ´ï¼ˆå…³é”®å­—ä¿®é¥°ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰æ‹©åŸåˆ™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç®€å•åŒæ­¥&lt;/strong&gt; â†’ &lt;code&gt;synchronized&lt;/code&gt;ï¼ˆä»£ç ç®€æ´ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜çº§éœ€æ±‚&lt;/strong&gt;ï¼ˆå¯ä¸­æ–­ã€è¶…æ—¶ã€å…¬å¹³é”ï¼‰ â†’ &lt;code&gt;Lock&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯-2"&gt;ğŸ¯ &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘è¯»åœºæ™¯&lt;/strong&gt;
ä½¿ç”¨ &lt;code&gt;ReentrantReadWriteLock&lt;/code&gt; æå‡è¯»å¹¶å‘æ€§èƒ½ï¼ˆå¦‚ç¼“å­˜ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…çº¿ç¨‹æ— é™é˜»å¡&lt;/strong&gt;
éœ€è¶…æ—¶ï¼ˆ&lt;code&gt;tryLock&lt;/code&gt;ï¼‰æˆ–å¯ä¸­æ–­ï¼ˆ&lt;code&gt;lockInterruptibly&lt;/code&gt;ï¼‰çš„æ•æ„Ÿä»»åŠ¡ï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚çº¿ç¨‹åä½œ&lt;/strong&gt;
å¤šæ¡ä»¶å˜é‡ï¼ˆ&lt;code&gt;Condition&lt;/code&gt;ï¼‰å®ç°ç²¾ç»†è°ƒåº¦ï¼ˆå¦‚ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¹³æ€§è¦æ±‚&lt;/strong&gt;
éœ€æŒ‰è¯·æ±‚é¡ºåºåˆ†é…èµ„æºï¼ˆå¦‚äº¤æ˜“ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-2"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é”é‡Šæ”¾&lt;/strong&gt;ï¼šåŠ¡å¿…åœ¨ &lt;code&gt;finally&lt;/code&gt; ä¸­è°ƒç”¨ &lt;code&gt;unlock()&lt;/code&gt;ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æ­»é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æƒè¡¡&lt;/strong&gt;ï¼šä½ç«äº‰æ—¶ &lt;code&gt;synchronized&lt;/code&gt; æ€§èƒ½æ¥è¿‘ï¼Œä¸”ä»£ç æ›´ç®€æ´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ABA é—®é¢˜&lt;/strong&gt;ï¼š&lt;code&gt;Lock&lt;/code&gt; æœ¬èº«ä¸è§£å†³ï¼Œéœ€ç»“åˆ &lt;code&gt;AtomicStampedReference&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Lock æ¥å£é€šè¿‡&lt;strong&gt;æ˜¾å¼é”ç®¡ç†&lt;/strong&gt;ã€&lt;strong&gt;å¯ä¸­æ–­æ€§&lt;/strong&gt;ã€&lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;åŠ&lt;strong&gt;å¤šæ¡ä»¶å˜é‡&lt;/strong&gt;ï¼Œæä¾›äº†æ¯” &lt;code&gt;synchronized&lt;/code&gt; æ›´çµæ´»çš„å¹¶å‘æ§åˆ¶èƒ½åŠ›ã€‚å…¶æ ¸å¿ƒå®ç°ç±» &lt;code&gt;ReentrantLock&lt;/code&gt; å’Œ &lt;code&gt;ReentrantReadWriteLock&lt;/code&gt; åˆ†åˆ«é€‚ç”¨äºé‡å…¥é”å’Œè¯»å†™åˆ†ç¦»åœºæ™¯ã€‚é€‰æ‹©æ—¶éœ€æƒè¡¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç®€å•éœ€æ±‚&lt;/strong&gt; â†’ &lt;code&gt;synchronized&lt;/code&gt;ï¼ˆå®‰å…¨ç®€æ´ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚æ§åˆ¶&lt;/strong&gt; â†’ &lt;code&gt;Lock&lt;/code&gt;ï¼ˆåŠŸèƒ½å¼ºå¤§ï¼Œéœ€è°¨æ…é‡Šæ”¾é”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="condition"&gt;Condition
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å…³äº Java å¹¶å‘ç¼–ç¨‹ä¸­ &lt;code&gt;Condition&lt;/code&gt; æ¥å£çš„è¯¦ç»†è§£æï¼Œæ¶µç›–å…¶æ ¸å¿ƒåŸç†ã€ä½¿ç”¨è§„èŒƒã€åº•å±‚å®ç°åŠå…¸å‹åº”ç”¨åœºæ™¯ï¼Œç»“åˆæƒå¨æŠ€æœ¯æ–‡æ¡£ä¸æºç å®ç°æ•´ç†ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-condition-çš„æ ¸å¿ƒä½œç”¨ä¸ä¼˜åŠ¿"&gt;âš™ï¸ &lt;strong&gt;Condition çš„æ ¸å¿ƒä½œç”¨ä¸ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Condition&lt;/code&gt; æ˜¯ &lt;code&gt;java.util.concurrent.locks&lt;/code&gt; åŒ…ä¸­ä¸æ˜¾å¼é”ï¼ˆå¦‚ &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰é…å¥—çš„çº¿ç¨‹åè°ƒæœºåˆ¶ï¼Œç”¨äºæ›¿ä»£ä¼ ç»Ÿçš„ &lt;code&gt;Object.wait()/notify()&lt;/code&gt;ï¼Œæä¾›æ›´&lt;strong&gt;ç²¾ç»†åŒ–çš„çº¿ç¨‹ç­‰å¾…/é€šçŸ¥æ§åˆ¶&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤šæ¡ä»¶é˜Ÿåˆ—ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ª &lt;code&gt;Lock&lt;/code&gt; å¯å…³è”å¤šä¸ª &lt;code&gt;Condition&lt;/code&gt;ï¼ˆä¾‹å¦‚ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ä¸­çš„â€œéç©ºâ€å’Œâ€œéæ»¡â€æ¡ä»¶ï¼‰ï¼Œæ¯ä¸ªæ¡ä»¶ç‹¬ç«‹ç®¡ç†çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹:
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
ReentrantLock lock = new ReentrantLock();
Condition notEmpty = lock.newCondition(); // é˜Ÿåˆ—éç©ºæ¡ä»¶
Condition notFull = lock.newCondition(); // é˜Ÿåˆ—éæ»¡æ¡ä»¶
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ç²¾å‡†å”¤é†’ï¼š
&lt;ul&gt;
&lt;li&gt;æ”¯æŒ &lt;code&gt;signal()&lt;/code&gt;ï¼ˆå”¤é†’å•ä¸ªç­‰å¾…çº¿ç¨‹ï¼‰å’Œ &lt;code&gt;signalAll()&lt;/code&gt;ï¼ˆå”¤é†’å…¨éƒ¨çº¿ç¨‹ï¼‰ï¼Œé¿å… &lt;code&gt;notifyAll()&lt;/code&gt; å¯¼è‡´çš„æ— æ•ˆç«äº‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¢å¼ºæ§åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;æä¾›è¶…æ—¶ç­‰å¾…ï¼ˆ&lt;code&gt;awaitNanos()&lt;/code&gt;ï¼‰ã€ä¸å¯ä¸­æ–­ç­‰å¾…ï¼ˆ&lt;code&gt;awaitUninterruptibly()&lt;/code&gt;ï¼‰ã€æˆªæ­¢æ—¶é—´ç­‰å¾…ï¼ˆ&lt;code&gt;awaitUntil()&lt;/code&gt;ï¼‰ç­‰çµæ´»é€‰é¡¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°åŸç†åŸºäº-aqs"&gt;â›“ï¸ &lt;strong&gt;åº•å±‚å®ç°åŸç†ï¼ˆåŸºäº AQSï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Condition&lt;/code&gt; çš„å®ç°ç±» &lt;code&gt;ConditionObject&lt;/code&gt; æ˜¯ AQSï¼ˆ&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;ï¼‰çš„å†…éƒ¨ç±»ï¼Œæ ¸å¿ƒæœºåˆ¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŒé˜Ÿåˆ—æ¨¡å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒæ­¥é˜Ÿåˆ—&lt;/strong&gt;ï¼šAQS çš„ä¸»é˜Ÿåˆ—ï¼Œç®¡ç†ç«äº‰é”çš„çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ä»¶é˜Ÿåˆ—&lt;/strong&gt;ï¼šæ¯ä¸ª &lt;code&gt;Condition&lt;/code&gt; ç»´æŠ¤ç‹¬ç«‹çš„ FIFO é˜Ÿåˆ—ï¼Œå­˜å‚¨ç­‰å¾…ç‰¹å®šæ¡ä»¶çš„çº¿ç¨‹èŠ‚ç‚¹ï¼ˆ&lt;code&gt;Node&lt;/code&gt;ï¼‰ï¼ŒèŠ‚ç‚¹çŠ¶æ€ä¸º &lt;code&gt;CONDITION&lt;/code&gt;ï¼ˆ-2ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;await() æµç¨‹ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é‡Šæ”¾å½“å‰çº¿ç¨‹æŒæœ‰çš„é”ï¼ˆå®Œå…¨é‡Šæ”¾ï¼Œå³ä½¿é‡å…¥é”ä¹Ÿä¼šæ¸…é›¶è®¡æ•°ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;åˆ›å»º &lt;code&gt;CONDITION&lt;/code&gt; èŠ‚ç‚¹åŠ å…¥æ¡ä»¶é˜Ÿåˆ—å°¾éƒ¨ã€‚&lt;/li&gt;
&lt;li&gt;é˜»å¡çº¿ç¨‹ï¼Œç­‰å¾…è¢«å”¤é†’æˆ–ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;å”¤é†’åï¼ŒèŠ‚ç‚¹ä»æ¡ä»¶é˜Ÿåˆ—è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—ï¼Œé‡æ–°ç«äº‰é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;signal() æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;å°†æ¡ä»¶é˜Ÿåˆ—çš„å¤´èŠ‚ç‚¹è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹èŠ‚ç‚¹çŠ¶æ€ï¼Œå¹¶é€šè¿‡ &lt;code&gt;LockSupport.unpark()&lt;/code&gt; å”¤é†’çº¿ç¨‹ï¼ˆå”¤é†’åä»éœ€ç«äº‰é”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;å…³é”®è®¾è®¡&lt;/strong&gt;ï¼šæ¡ä»¶é˜Ÿåˆ—ä¸åŒæ­¥é˜Ÿåˆ—åˆ†ç¦»ï¼Œé€šè¿‡èŠ‚ç‚¹è¿ç§»å®ç°é”é‡Šæ”¾ä¸é‡æ–°è·å–çš„åŸå­æ€§ï¼Œé¿å…ä¿¡å·ä¸¢å¤±ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨è§„èŒƒä¸æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨è§„èŒƒä¸æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å¼ºåˆ¶ä½¿ç”¨è§„èŒƒ"&gt;&lt;strong&gt;å¼ºåˆ¶ä½¿ç”¨è§„èŒƒ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è§„åˆ™&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¿è§„åæœ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ˆè·å–é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è°ƒç”¨ &lt;code&gt;await()/signal()&lt;/code&gt; å‰å¿…é¡»æŒæœ‰å…³è”çš„ &lt;code&gt;Lock&lt;/code&gt; é”&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IllegalMonitorStateException&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¾ªç¯æ£€æŸ¥æ¡ä»¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿…é¡»ç”¨ &lt;code&gt;while&lt;/code&gt; è€Œé &lt;code&gt;if&lt;/code&gt; æ£€æŸ¥æ¡ä»¶ï¼Œé˜²æ­¢&lt;strong&gt;è™šå‡å”¤é†’ï¼ˆSpurious Wakeupï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€»è¾‘é”™è¯¯ï¼ˆæ¡ä»¶ä¸æ»¡è¶³æ—¶é”™è¯¯æ‰§è¡Œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¡®ä¿é‡Šæ”¾é”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;unlock()&lt;/code&gt; å¿…é¡»æ”¾åœ¨ &lt;code&gt;finally&lt;/code&gt; å—ä¸­&lt;/td&gt;
&lt;td&gt;æ­»é”é£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ä¸­æ–­å¤„ç†"&gt;&lt;strong&gt;ä¸­æ–­å¤„ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;await()&lt;/code&gt; å¯èƒ½æŠ›å‡º &lt;code&gt;InterruptedException&lt;/code&gt;ï¼Œéœ€æ˜ç¡®å¤„ç†ä¸­æ–­é€»è¾‘ï¼ˆå¦‚é‡è¯•æˆ–ç»ˆæ­¢ä»»åŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;awaitUninterruptibly()&lt;/code&gt; æä¾›ä¸å¯ä¸­æ–­æ¨¡å¼ï¼Œé€‚ç”¨äºå¿…é¡»å®Œæˆçš„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å”¤é†’ç­–ç•¥å»ºè®®"&gt;&lt;strong&gt;å”¤é†’ç­–ç•¥å»ºè®®&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆ &lt;code&gt;signal()&lt;/code&gt;&lt;/strong&gt;ï¼šæ˜ç¡®å”¤é†’ç›®æ ‡æ—¶ä½¿ç”¨ï¼Œå‡å°‘çº¿ç¨‹ç«äº‰å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°¨æ… &lt;code&gt;signalAll()&lt;/code&gt;&lt;/strong&gt;ï¼šä¸ç¡®å®šå”¤é†’ç›®æ ‡æ—¶ä½¿ç”¨ï¼Œä½†å¯èƒ½å¼•å‘â€œæƒŠç¾¤æ•ˆåº”â€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯ä¸æ¡ˆä¾‹"&gt;ğŸ› ï¸ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯ä¸æ¡ˆä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹å¤š-condition-ç‰ˆ"&gt;&lt;strong&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼ˆå¤š Condition ç‰ˆï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BoundedBuffer&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;capacity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ReentrantLock&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ReentrantLock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Condition&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;notFull&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newCondition&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é˜Ÿåˆ—éæ»¡æ¡ä»¶ &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Condition&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;notEmpty&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newCondition&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é˜Ÿåˆ—éç©ºæ¡ä»¶ &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;InterruptedException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;capacity&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;notFull&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;await&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é˜Ÿåˆ—æ»¡æ—¶ç­‰å¾… &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;notEmpty&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å”¤é†’ä¸€ä¸ªæ¶ˆè´¹è€… &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unlock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;take&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;InterruptedException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isEmpty&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;notEmpty&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;await&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é˜Ÿåˆ—ç©ºæ—¶ç­‰å¾… &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;notFull&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å”¤é†’ä¸€ä¸ªç”Ÿäº§è€… &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unlock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§è€…ä»…å”¤é†’æ¶ˆè´¹è€…ï¼ˆè€Œéæ‰€æœ‰çº¿ç¨‹ï¼‰ï¼Œå‡å°‘æ— æ•ˆç«äº‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤šä»»åŠ¡é¡ºåºè°ƒåº¦ç²¾å‡†å”¤é†’"&gt;&lt;strong&gt;å¤šä»»åŠ¡é¡ºåºè°ƒåº¦ï¼ˆç²¾å‡†å”¤é†’ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TaskScheduler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ReentrantLock&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ReentrantLock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Condition&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;condA&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newCondition&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Condition&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;condB&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newCondition&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// 1:æ‰§è¡ŒA, 2:æ‰§è¡ŒB &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;runTaskA&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;InterruptedException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;condA&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;await&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ä»…ç­‰å¾…æ¡ä»¶A &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ‰§è¡Œä»»åŠ¡A &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;condB&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç²¾å‡†å”¤é†’ä»»åŠ¡B &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unlock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// runTaskB ç±»ä¼¼ï¼Œå”¤é†’ condA &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå¤šé˜¶æ®µä»»åŠ¡ï¼ˆå¦‚åŠ æ²¹â†’æ´—è½¦â†’é©¶ç¦»ï¼‰çš„é¡ºåºæ§åˆ¶ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-condition-vs-object-ç›‘è§†å™¨æ–¹æ³•"&gt;ğŸ”„ &lt;strong&gt;Condition vs Object ç›‘è§†å™¨æ–¹æ³•&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Lock + Condition&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;synchronized + wait/notify&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ¡ä»¶å˜é‡æ•°é‡&lt;/td&gt;
&lt;td&gt;âœ… å¤šæ¡ä»¶é˜Ÿåˆ—ï¼ˆå¯è‡ªå®šä¹‰ï¼‰&lt;/td&gt;
&lt;td&gt;âŒ å•ä¸€ç­‰å¾…é˜Ÿåˆ—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¶…æ—¶æ§åˆ¶&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒ &lt;code&gt;awaitNanos()&lt;/code&gt;, &lt;code&gt;awaitUntil()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ ä»…æœ‰é™è¶…æ—¶ï¼ˆ&lt;code&gt;wait(long timeout)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸­æ–­å“åº”&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒå¯ä¸­æ–­/ä¸å¯ä¸­æ–­æ¨¡å¼&lt;/td&gt;
&lt;td&gt;âŒ ä»…æŠ›å¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å”¤é†’ç²¾åº¦&lt;/td&gt;
&lt;td&gt;âœ… å¯ç²¾å‡†å”¤é†’æŒ‡å®šæ¡ä»¶é˜Ÿåˆ—&lt;/td&gt;
&lt;td&gt;âŒ åªèƒ½å”¤é†’å…¨éƒ¨ï¼ˆ&lt;code&gt;notifyAll()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é”æœºåˆ¶&lt;/td&gt;
&lt;td&gt;æ˜¾å¼é”ï¼ˆä»£ç æ§åˆ¶ï¼‰&lt;/td&gt;
&lt;td&gt;éšå¼é”ï¼ˆJVM ç®¡ç†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€å•åŒæ­¥ â†’ &lt;code&gt;synchronized&lt;/code&gt;ï¼ˆä»£ç ç®€æ´ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤æ‚çº¿ç¨‹åä½œï¼ˆå¦‚å¤šæ¡ä»¶ã€è¶…æ—¶æ§åˆ¶ï¼‰â†’ &lt;code&gt;Lock + Condition&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ç¨‹å®è·µæ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;å·¥ç¨‹å®è·µæ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é¿å…åµŒå¥—è°ƒç”¨ï¼š
&lt;ul&gt;
&lt;li&gt;ç¦æ­¢åœ¨ &lt;code&gt;Condition&lt;/code&gt; ç­‰å¾…ä¸­åµŒå¥—è°ƒç”¨å…¶ä»–é”æ“ä½œï¼Œé˜²æ­¢æ­»é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ï¼‰åº•å±‚é‡‡ç”¨ &lt;code&gt;Condition&lt;/code&gt; å®ç°ï¼Œä¼˜å…ˆå¤ç”¨æ ‡å‡†åº“ç»„ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æ§å·¥å…·ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;jstack&lt;/code&gt; æˆ– &lt;code&gt;JProfiler&lt;/code&gt; æŸ¥çœ‹æ¡ä»¶é˜Ÿåˆ—çŠ¶æ€ï¼Œå®šä½çº¿ç¨‹é˜»å¡é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Condition&lt;/code&gt; é€šè¿‡&lt;strong&gt;å¤šæ¡ä»¶é˜Ÿåˆ—ã€ç²¾å‡†å”¤é†’å’Œçµæ´»ç­‰å¾…æœºåˆ¶&lt;/strong&gt;ï¼Œå®ç°äº†æ¯”ä¼ ç»Ÿ &lt;code&gt;wait/notify&lt;/code&gt; æ›´ç²¾ç»†çš„çº¿ç¨‹åä½œï¼Œå°¤å…¶é€‚ç”¨äºç”Ÿäº§è€…-æ¶ˆè´¹è€…ã€ä»»åŠ¡è°ƒåº¦ç­‰å¤æ‚åŒæ­¥åœºæ™¯ã€‚å…¶åº•å±‚ä¾èµ– AQS çš„&lt;strong&gt;åŒé˜Ÿåˆ—æ¨¡å‹å’ŒèŠ‚ç‚¹è¿ç§»æœºåˆ¶&lt;/strong&gt;ï¼Œä¿è¯äº†æ“ä½œçš„åŸå­æ€§ã€‚ä½¿ç”¨æ—¶éœ€ä¸¥å®ˆ&lt;strong&gt;é”æŒæœ‰ã€å¾ªç¯æ£€æŸ¥æ¡ä»¶å’Œä¸­æ–­å¤„ç†&lt;/strong&gt;ä¸‰å¤§è§„èŒƒï¼Œé¿å…æ­»é”ä¸é€»è¾‘é”™è¯¯ã€‚åœ¨ Java å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œ&lt;code&gt;Condition&lt;/code&gt; æ˜¯æ„å»ºé«˜æ•ˆã€å¯æ§åŒæ­¥é€»è¾‘çš„æ ¸å¿ƒå·¥å…·ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡æŠ€æœ¯è¦ç‚¹æºè‡ª AQS æºç ã€ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹åŠç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="semaphore"&gt;Semaphore
&lt;/h2&gt;&lt;h3 id="-semaphoreä¿¡å·é‡è¯¦è§£åŸç†å®ç°ä¸åº”ç”¨åœºæ™¯"&gt;ğŸš¦ Semaphoreï¼ˆä¿¡å·é‡ï¼‰è¯¦è§£ï¼šåŸç†ã€å®ç°ä¸åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;Semaphore æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent&lt;/code&gt;ï¼‰ä¸­çš„æ ¸å¿ƒåŒæ­¥å·¥å…·ï¼Œç”¨äº&lt;strong&gt;æ§åˆ¶å¯¹å…±äº«èµ„æºçš„å¹¶å‘è®¿é—®æ•°é‡&lt;/strong&gt;ï¼Œé€šè¿‡ç»´æŠ¤â€œè®¸å¯è¯â€ï¼ˆPermitsï¼‰å®ç°çº¿ç¨‹æ•°é‡çš„ç²¾ç¡®é™åˆ¶ã€‚ä»¥ä¸‹æ˜¯å…¶å…¨æ–¹ä½è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸æ¨¡å‹"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸æ¨¡å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä¿¡å·é‡æ¨¡å‹"&gt;&lt;strong&gt;ä¿¡å·é‡æ¨¡å‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è®¡æ•°å™¨æœºåˆ¶ï¼š
Semaphore å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªæ•´æ•°è®¡æ•°å™¨ï¼ˆstateï¼‰ï¼Œè¡¨ç¤ºå¯ç”¨è®¸å¯è¯æ•°é‡ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;acquire()&lt;/code&gt;&lt;/strong&gt;ï¼ˆPæ“ä½œï¼‰ï¼šè¯·æ±‚è®¸å¯è¯ï¼Œè®¡æ•°å™¨å‡ 1ï¼›è‹¥è®¡æ•°å™¨ä¸º 0ï¼Œåˆ™çº¿ç¨‹é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;release()&lt;/code&gt;&lt;/strong&gt;ï¼ˆVæ“ä½œï¼‰ï¼šé‡Šæ”¾è®¸å¯è¯ï¼Œè®¡æ•°å™¨åŠ  1ï¼Œå”¤é†’ç­‰å¾…çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»å…¸ç±»æ¯”&lt;/strong&gt;ï¼š
åœè½¦åœºæ¨¡å‹ï¼ˆ3 ä¸ªè½¦ä½ï¼‰â†’ 5 è¾†è½¦åŒæ—¶åˆ°è¾¾ï¼Œä»… 3 è¾†å¯è¿›å…¥ï¼Œåç»­è½¦è¾†éœ€ç­‰å¾…ç©ºä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…¬å¹³æ€§ä¸éå…¬å¹³æ€§"&gt;&lt;strong&gt;å…¬å¹³æ€§ä¸éå…¬å¹³æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éå…¬å¹³æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰&lt;/strong&gt;ï¼š
çº¿ç¨‹ç›´æ¥å°è¯•è·å–è®¸å¯è¯ï¼Œä¸ä¿è¯é¡ºåºï¼ˆé«˜ååé‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¹³æ¨¡å¼&lt;/strong&gt;ï¼š
çº¿ç¨‹æŒ‰ FIFO é¡ºåºè·å–è®¸å¯è¯ï¼ˆé€šè¿‡ AQS é˜Ÿåˆ—å®ç°ï¼‰ã€‚
æ„é€ å‡½æ•°ç¤ºä¾‹ï¼š&lt;code&gt;new Semaphore(5, true)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°åŸºäº-aqs"&gt;âš™ï¸ &lt;strong&gt;åº•å±‚å®ç°ï¼ˆåŸºäº AQSï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="aqs-å…±äº«æ¨¡å¼"&gt;&lt;strong&gt;AQS å…±äº«æ¨¡å¼&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Semaphore é€šè¿‡å†…éƒ¨ç±» &lt;code&gt;Sync&lt;/code&gt;ï¼ˆç»§æ‰¿è‡ª &lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;ï¼‰å®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;state&lt;/code&gt; å­—æ®µ&lt;/strong&gt;ï¼šå­˜å‚¨å¯ç”¨è®¸å¯è¯æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒæ–¹æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;éå…¬å¹³è·å–ï¼š&lt;code&gt;nonfairTryAcquireShared()&lt;/code&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;nonfairTryAcquireShared&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;acquires&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(;;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;available&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;remaining&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;available&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;acquires&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;remaining&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;compareAndSetState&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;available&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;remaining&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;remaining&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è´Ÿæ•°è¡¨ç¤ºè·å–å¤±è´¥&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¹³è·å–&lt;/strong&gt;ï¼š&lt;code&gt;tryAcquireShared()&lt;/code&gt; ä¸­å…ˆæ£€æŸ¥æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹ï¼ˆ&lt;code&gt;hasQueuedPredecessors()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="çº¿ç¨‹é˜»å¡ä¸å”¤é†’-1"&gt;&lt;strong&gt;çº¿ç¨‹é˜»å¡ä¸å”¤é†’&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;acquire()&lt;/code&gt;&lt;/strong&gt; â†’ è°ƒç”¨ &lt;code&gt;sync.acquireSharedInterruptibly(1)&lt;/code&gt;ï¼š
è‹¥ &lt;code&gt;tryAcquireShared()&lt;/code&gt; è¿”å›è´Ÿå€¼ï¼Œçº¿ç¨‹åŠ å…¥ AQS é˜Ÿåˆ—é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;release()&lt;/code&gt;&lt;/strong&gt; â†’ è°ƒç”¨ &lt;code&gt;sync.releaseShared(1)&lt;/code&gt;ï¼š
é€šè¿‡ CAS å¢åŠ  &lt;code&gt;state&lt;/code&gt;ï¼Œå¹¶å”¤é†’é˜Ÿåˆ—ä¸­çš„åç»§èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒ-api-ä¸ä½¿ç”¨ç¤ºä¾‹"&gt;ğŸ› ï¸ &lt;strong&gt;æ ¸å¿ƒ API ä¸ä½¿ç”¨ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å¸¸ç”¨æ–¹æ³•"&gt;&lt;strong&gt;å¸¸ç”¨æ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;acquire()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡è·å–ä¸€ä¸ªè®¸å¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;tryAcquire()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°è¯•è·å–è®¸å¯ï¼ˆç«‹å³è¿”å›æˆåŠŸ/å¤±è´¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;tryAcquire(long timeout, TimeUnit unit)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¶…æ—¶ç­‰å¾…è·å–è®¸å¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;release()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é‡Šæ”¾ä¸€ä¸ªè®¸å¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;availablePermits()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿”å›å½“å‰å¯ç”¨è®¸å¯æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="ä»£ç ç¤ºä¾‹é™åˆ¶å¹¶å‘ä¸‹è½½çº¿ç¨‹æ•°"&gt;&lt;strong&gt;ä»£ç ç¤ºä¾‹ï¼šé™åˆ¶å¹¶å‘ä¸‹è½½çº¿ç¨‹æ•°&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;// å…è®¸æœ€å¤š 3 ä¸ªçº¿ç¨‹åŒæ—¶ä¸‹è½½
Semaphore semaphore = new Semaphore(3);
void downloadFile(String url) throws InterruptedException {
semaphore.acquire(); // è·å–è®¸å¯
try {
// æ¨¡æ‹Ÿä¸‹è½½è€—æ—¶
Thread.sleep(1000);
System.out.println(Thread.currentThread().getName() + &amp;#34; ä¸‹è½½å®Œæˆ: &amp;#34; + url);
} finally {
semaphore.release(); // ç¡®ä¿é‡Šæ”¾è®¸å¯
}
}
// å¯åŠ¨ 10 ä¸ªä¸‹è½½çº¿ç¨‹ï¼ˆä»… 3 ä¸ªå¹¶å‘æ‰§è¡Œï¼‰
for (int i = 0; i &amp;lt; 10; i++) {
new Thread(() -&amp;gt; downloadFile(&amp;#34;file&amp;#34; + i)).start();
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯"&gt;ğŸŒ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="èµ„æºæ± ç®¡ç†"&gt;&lt;strong&gt;èµ„æºæ± ç®¡ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“è¿æ¥æ± &lt;/strong&gt;ï¼šé™åˆ¶æœ€å¤§è¿æ¥æ•°ï¼ˆå¦‚æœ€å¤š 10 ä¸ªè¿æ¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹è±¡æ± ï¼šå¤ç”¨æ˜‚è´µèµ„æºï¼ˆå¦‚çº¿ç¨‹ã€ç½‘ç»œè¿æ¥ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;public class ObjectPool&amp;lt;T&amp;gt; {
private final Semaphore semaphore;
private final BlockingQueue&amp;lt;T&amp;gt; pool;
public ObjectPool(int size, Supplier&amp;lt;T&amp;gt; supplier) {
semaphore = new Semaphore(size);
pool = new LinkedBlockingQueue&amp;lt;&amp;gt;();
for (int i = 0; i &amp;lt; size; i++) {
pool.add(supplier.get());
}
}
public T borrow() throws InterruptedException {
semaphore.acquire();
return pool.take();
}
public void release(T obj) {
pool.offer(obj);
semaphore.release();
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æµé‡æ§åˆ¶"&gt;&lt;strong&gt;æµé‡æ§åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;API é™æµ&lt;/strong&gt;ï¼šé™åˆ¶æ¯ç§’è¯·æ±‚å¤–éƒ¨æœåŠ¡çš„æ¬¡æ•°ï¼ˆå¦‚æ¯ç§’ 100 æ¬¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸‹è½½é™é€Ÿ&lt;/strong&gt;ï¼šæ§åˆ¶åŒæ—¶ä¸‹è½½æ–‡ä»¶çš„ç”¨æˆ·æ•°ï¼ˆå¦‚æœ€å¤š 3 ä¸ªï¼‰.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç”Ÿäº§è€…-æ¶ˆè´¹è€…åè°ƒ"&gt;&lt;strong&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…åè°ƒ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å†²é˜Ÿåˆ—&lt;/strong&gt;ï¼šé€šè¿‡ Semaphore æ§åˆ¶ç”Ÿäº§é€Ÿç‡ï¼ˆå¦‚ç”Ÿäº§å‰æ£€æŸ¥ç©ºé—²ç¼“å†²åŒºï¼‰.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-3"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¸å¯é‡Šæ”¾åŒ¹é…&lt;/strong&gt;ï¼š
ç¡®ä¿æ¯ä¸ª &lt;code&gt;acquire()&lt;/code&gt; éƒ½æœ‰å¯¹åº”çš„ &lt;code&gt;release()&lt;/code&gt;ï¼Œå¦åˆ™ä¼šå¯¼è‡´èµ„æºæ³„æ¼æˆ–æ­»é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…è¶…é¢é‡Šæ”¾&lt;/strong&gt;ï¼š
&lt;code&gt;release()&lt;/code&gt; æ¬¡æ•° &amp;gt; &lt;code&gt;acquire()&lt;/code&gt; æ¬¡æ•°ä¼šæŠ›å‡º &lt;code&gt;SemaphoreFullException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ€§èƒ½é€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;å•è¿›ç¨‹ä¼˜å…ˆç”¨ &lt;code&gt;SemaphoreSlim&lt;/code&gt;ï¼ˆ.NET ä¸­çš„è½»é‡çº§å®ç°ï¼Œç”¨æˆ·æ€åŒæ­¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è·¨è¿›ç¨‹åŒæ­¥éœ€ç”¨å¸¦åç§°çš„ &lt;code&gt;Semaphore&lt;/code&gt;ï¼ˆå†…æ ¸çº§åŒæ­¥ï¼‰.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;ï¼š
é«˜å¹¶å‘åœºæ™¯ä½¿ç”¨ &lt;code&gt;tryAcquire(timeout)&lt;/code&gt; é¿å…çº¿ç¨‹æ— é™é˜»å¡.&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-11"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šSemaphore é€šè¿‡&lt;strong&gt;è®¸å¯è¯è®¡æ•°&lt;/strong&gt;å®ç°å¯¹å¹¶å‘çº¿ç¨‹æ•°çš„ç²¾ç¡®æ§åˆ¶ï¼Œé€‚ç”¨äºèµ„æºæ± ã€é™æµç­‰é«˜å¹¶å‘åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;é€‰å‹å»ºè®®ï¼š
&lt;ul&gt;
&lt;li&gt;ç®€å•é™æµ â†’ &lt;code&gt;Semaphore&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é«˜æ€§èƒ½å•è¿›ç¨‹ â†’ &lt;code&gt;SemaphoreSlim&lt;/code&gt;ï¼ˆå…¶ä»–è¯­è¨€ï¼‰æˆ–éå…¬å¹³æ¨¡å¼ï¼›
&lt;ul&gt;
&lt;li&gt;ä¸¥æ ¼é¡ºåº â†’ å…¬å¹³æ¨¡å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº•å±‚åŸºçŸ³&lt;/strong&gt;ï¼šåŸºäº AQS çš„å…±äº«æ¨¡å¼å®ç°ï¼Œç»“åˆ CAS å’Œé˜Ÿåˆ—ç®¡ç†ä¿è¯é«˜æ•ˆä¸å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡åˆç†ä½¿ç”¨ Semaphoreï¼Œå¯æ˜¾è‘—æå‡ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œèµ„æºåˆ©ç”¨ç‡ï¼Œæ˜¯å¹¶å‘ç¼–ç¨‹ä¸­çš„â€œæµé‡é˜€é—¨â€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="countdownlatch"&gt;CountDownLatch
&lt;/h2&gt;&lt;p&gt;CountDownLatch æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent&lt;/code&gt;ï¼‰ä¸­çš„æ ¸å¿ƒåŒæ­¥å·¥å…·ç±»ï¼Œç”¨äºåè°ƒå¤šä¸ªçº¿ç¨‹çš„æ‰§è¡Œé¡ºåºï¼Œ&lt;strong&gt;å…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ“ä½œåå†ç»§ç»­æ‰§è¡Œ&lt;/strong&gt;ã€‚å…¶è®¾è®¡åŸºäºè®¡æ•°å™¨æœºåˆ¶ï¼Œç»“åˆ AQSï¼ˆAbstractQueuedSynchronizerï¼‰å®ç°é«˜æ•ˆçº¿ç¨‹é˜»å¡ä¸å”¤é†’ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€ä½¿ç”¨æ–¹å¼ã€åº”ç”¨åœºæ™¯ã€æºç å®ç°åŠå¯¹æ¯”åˆ†æå±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæœºåˆ¶è®¡æ•°å™¨æ¨¡å‹"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒæœºåˆ¶ï¼šè®¡æ•°å™¨æ¨¡å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç»„ä»¶-1"&gt;&lt;strong&gt;æ ¸å¿ƒç»„ä»¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è®¡æ•°å™¨ï¼ˆStateï¼‰åˆå§‹åŒ–æ—¶æŒ‡å®šæ­£æ•´æ•° countï¼Œè¡¨ç¤ºéœ€ç­‰å¾…å®Œæˆçš„çº¿ç¨‹/ä»»åŠ¡æ•°é‡ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;countDown()&lt;/code&gt;&lt;/strong&gt;ï¼šä»»åŠ¡å®Œæˆåè°ƒç”¨ï¼Œè®¡æ•°å™¨å‡ 1ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŸºäº CASï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;await()&lt;/code&gt;&lt;/strong&gt;ï¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°è®¡æ•°å™¨å½’é›¶ï¼ˆæ”¯æŒè¶…æ—¶å’Œä¸­æ–­å“åº”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸€æ¬¡æ€§ç‰¹æ€§"&gt;&lt;strong&gt;ä¸€æ¬¡æ€§ç‰¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;è®¡æ•°å™¨å½’é›¶åæ— æ³•é‡ç½®ï¼Œè‹¥éœ€é‡å¤ä½¿ç”¨ï¼Œéœ€æ¢ç”¨ &lt;code&gt;CyclicBarrier&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨æ–¹å¼ä¸ç¤ºä¾‹"&gt;ğŸ“ &lt;strong&gt;ä½¿ç”¨æ–¹å¼ä¸ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºç¡€ä½¿ç”¨æ­¥éª¤"&gt;&lt;strong&gt;åŸºç¡€ä½¿ç”¨æ­¥éª¤&lt;/strong&gt;
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// 1. åˆå§‹åŒ–è®¡æ•°å™¨ï¼ˆå‡è®¾éœ€ç­‰å¾…3ä¸ªä»»åŠ¡ï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;CountDownLatch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;latch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CountDownLatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;3&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// 2. å¯åŠ¨å­çº¿ç¨‹ï¼ˆæ¯ä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡åè°ƒç”¨ countDown()ï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;doTask&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;latch&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;countDown&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ä»»åŠ¡å®Œæˆï¼Œè®¡æ•°å™¨-1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// 3. ä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹å®Œæˆ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;latch&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;await&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;æ‰€æœ‰ä»»åŠ¡å·²å®Œæˆï¼&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="å…¸å‹åœºæ™¯ç¤ºä¾‹"&gt;&lt;strong&gt;å…¸å‹åœºæ™¯ç¤ºä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯1ï¼šä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹å®Œæˆä»»åŠ¡&lt;/strong&gt;
ä¸»çº¿ç¨‹å¯åŠ¨å¤šä¸ªå­çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œæ±‡æ€»æœ€ç»ˆç»“æœï¼ˆå¦‚æ‰¹é‡æ–‡ä»¶å¤„ç†ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;ExecutorService executor = Executors.newFixedThreadPool(5);
CountDownLatch latch = new CountDownLatch(5);
for (int i = 0; i &amp;lt; 5; i++) {
executor.submit(() -&amp;gt; {
try {
doWork();
} finally {
latch.countDown(); // ç¡®ä¿å¼‚å¸¸æ—¶ä»é‡Šæ”¾è®¡æ•°å™¨
}
});
}
latch.await(); // ä¸»çº¿ç¨‹é˜»å¡ç­‰å¾…
executor.shutdown();
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯2ï¼šå¹¶å‘æµ‹è¯•ï¼ˆæ¨¡æ‹ŸåŒæ—¶è§¦å‘ï¼‰&lt;/strong&gt;
å¤šä¸ªçº¿ç¨‹ç­‰å¾…ç»Ÿä¸€ä¿¡å·ååŒæ—¶æ‰§è¡Œï¼ˆå¦‚æ¨¡æ‹Ÿç§’æ€è¯·æ±‚ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;CountDownLatch startSignal = new CountDownLatch(1); // å‘ä»¤æª
for (int i = 0; i &amp;lt; 10; i++) {
new Thread(() -&amp;gt; {
startSignal.await(); // ç­‰å¾…å‘ä»¤
executeConcurrentTask();
}).start();
}
Thread.sleep(2000);
startSignal.countDown(); // åŒæ—¶é‡Šæ”¾æ‰€æœ‰çº¿ç¨‹
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯-1"&gt;ğŸŒ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»ä»åä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸»çº¿ç¨‹éœ€ç­‰å¾…æ‰€æœ‰å­ä»»åŠ¡å®Œæˆåå†ç»§ç»­æ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;æœåŠ¡å¯åŠ¨æ—¶ç­‰å¾…èµ„æºåˆå§‹åŒ–å®Œæˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é˜¶æ®µåŒæ­¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šé˜¶æ®µä»»åŠ¡ä¸­ï¼Œä¸‹ä¸€é˜¶æ®µéœ€ç­‰å¾…å‰ä¸€é˜¶æ®µæ‰€æœ‰å­ä»»åŠ¡ç»“æŸ&lt;/td&gt;
&lt;td&gt;åˆ†æ‰¹æ¬¡æ•°æ®å¤„ç†åæ±‡æ€»ç»“æœ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘å‹åŠ›æµ‹è¯•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¨¡æ‹Ÿé«˜å¹¶å‘åœºæ™¯ï¼Œæ§åˆ¶å¤šä¸ªçº¿ç¨‹åŒæ—¶è§¦å‘è¯·æ±‚&lt;/td&gt;
&lt;td&gt;æ¥å£ç§’æ€æ€§èƒ½æµ‹è¯•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èµ„æºä¾èµ–æ£€æŸ¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¡®ä¿æ‰€æœ‰ä¾èµ–èµ„æºï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€é…ç½®åŠ è½½ï¼‰å°±ç»ªåå†æ‰§è¡Œä¸šåŠ¡é€»è¾‘&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼ç³»ç»Ÿå¯åŠ¨åè°ƒ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°åŸºäº-aqs-1"&gt;ğŸ”§ &lt;strong&gt;åº•å±‚å®ç°ï¼ˆåŸºäº AQSï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒæºç è§£æ"&gt;&lt;strong&gt;æ ¸å¿ƒæºç è§£æ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å†…éƒ¨ç±» &lt;code&gt;Sync&lt;/code&gt; ç»§æ‰¿ AQSï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;private static final class Sync extends AbstractQueuedSynchronizer {
Sync(int count) { setState(count); } // åˆå§‹åŒ–è®¡æ•°å™¨
// å°è¯•è·å–å…±äº«é”ï¼šè®¡æ•°å™¨ä¸º0æ—¶è¿”å›1ï¼ˆæˆåŠŸï¼‰ï¼Œå¦åˆ™é˜»å¡
protected int tryAcquireShared(int acquires) {
return (getState() == 0) ? 1 : -1;
}
// é‡Šæ”¾å…±äº«é”ï¼šCAS å‡å°‘è®¡æ•°å™¨ï¼Œå½’é›¶æ—¶å”¤é†’ç­‰å¾…çº¿ç¨‹
protected boolean tryReleaseShared(int releases) {
for (;;) {
int c = getState();
if (c == 0) return false;
int nextc = c - 1;
if (compareAndSetState(c, nextc))
return nextc == 0; // è®¡æ•°å™¨å½’é›¶æ—¶è¿”å› true
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…³é”®æ–¹æ³•æ˜ å°„"&gt;&lt;strong&gt;å…³é”®æ–¹æ³•æ˜ å°„&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;CountDownLatch æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AQS æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;await()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;acquireSharedInterruptibly(1)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡çº¿ç¨‹ï¼Œç›´åˆ°è®¡æ•°å™¨å½’é›¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;countDown()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;releaseShared(1)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‡å°‘è®¡æ•°å™¨ï¼Œå½’é›¶æ—¶å”¤é†’æ‰€æœ‰é˜»å¡çº¿ç¨‹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…±äº«æ¨¡å¼ä¼˜åŠ¿&lt;/strong&gt;ï¼š
å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶ç­‰å¾…è®¡æ•°å™¨å½’é›¶ï¼Œå”¤é†’æ—¶æ‰€æœ‰ç­‰å¾…çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼ˆå¯¹æ¯”ç‹¬å æ¨¡å¼æ•ˆç‡æ›´é«˜ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹-4"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¯é‡ç”¨æ€§&lt;/strong&gt;ï¼š
è®¡æ•°å™¨å½’é›¶åæ— æ³•é‡ç½®ï¼Œé‡å¤ä½¿ç”¨éœ€æ–°å»ºå®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;ï¼š
å­çº¿ç¨‹ä¸­åŠ¡å¿…åœ¨ &lt;code&gt;finally&lt;/code&gt; ä¸­è°ƒç”¨ &lt;code&gt;countDown()&lt;/code&gt;ï¼Œé¿å…ä»»åŠ¡å¼‚å¸¸å¯¼è‡´ä¸»çº¿ç¨‹æ°¸ä¹…é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;ï¼š
ä½¿ç”¨ &lt;code&gt;await(long timeout, TimeUnit unit)&lt;/code&gt; é¿å…æ­»é”ï¼Œè¶…æ—¶è¿”å› &lt;code&gt;false&lt;/code&gt; åå¯æ‰§è¡Œé™çº§é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;ï¼š
é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œ&lt;code&gt;await()&lt;/code&gt; é˜»å¡çº¿ç¨‹å¯èƒ½å¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼Œéœ€ç»“åˆçº¿ç¨‹æ± ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å…¶ä»–åŒæ­¥å·¥å…·å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ä¸å…¶ä»–åŒæ­¥å·¥å…·å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;CountDownLatch&lt;/th&gt;
&lt;th&gt;CyclicBarrier&lt;/th&gt;
&lt;th&gt;Semaphore&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é‡ç½®æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸€æ¬¡æ€§&lt;/td&gt;
&lt;td&gt;âœ… å¯å¾ªç¯ä½¿ç”¨&lt;/td&gt;
&lt;td&gt;âœ… åŠ¨æ€è°ƒæ•´è®¸å¯æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç­‰å¾…æ–¹å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸»ç­‰å­&lt;/td&gt;
&lt;td&gt;å­ç­‰å­ï¼ˆç›¸äº’ç­‰å¾…ï¼‰&lt;/td&gt;
&lt;td&gt;æ§åˆ¶èµ„æºè®¿é—®æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒæ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;await()&lt;/code&gt;/&lt;code&gt;countDown()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;await()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;acquire()&lt;/code&gt;/&lt;code&gt;release()&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»»åŠ¡å®Œæˆåè°ƒ&lt;/td&gt;
&lt;td&gt;åˆ†é˜¶æ®µä»»åŠ¡åŒæ­¥&lt;/td&gt;
&lt;td&gt;èµ„æºæ± é™æµ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç­‰å¾…ç¦»æ•£äº‹ä»¶å®Œæˆ â†’ &lt;code&gt;CountDownLatch&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;å¤šçº¿ç¨‹åˆ†é˜¶æ®µæ±‡èš â†’ &lt;code&gt;CyclicBarrier&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;é™åˆ¶å¹¶å‘èµ„æºè®¿é—® â†’ &lt;code&gt;Semaphore&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-12"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;CountDownLatch æ˜¯ Java å¹¶å‘ç¼–ç¨‹ä¸­çš„&lt;strong&gt;çº¿ç¨‹åè°ƒåˆ©å™¨&lt;/strong&gt;ï¼Œé€šè¿‡ç®€æ´çš„è®¡æ•°å™¨æ¨¡å‹è§£å†³â€œä¸»ç­‰å­â€åœºæ™¯çš„åŒæ­¥é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šè§£è€¦ä»»åŠ¡æ‰§è¡Œä¸ç»“æœæ±‡æ€»ï¼Œæå‡å¤šçº¿ç¨‹åä½œæ•ˆç‡ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼šç»“åˆçº¿ç¨‹æ± ç®¡ç†èµ„æºï¼Œä¸¥æ ¼å¤„ç†å¼‚å¸¸ä¸è¶…æ—¶ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨è¾¹ç•Œ&lt;/strong&gt;ï¼šä¸€æ¬¡æ€§ä»»åŠ¡åè°ƒï¼Œéœ€é‡å¤åŒæ­¥æ—¶æ¢ç”¨ &lt;code&gt;CyclicBarrier&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ·±å…¥ç†è§£å…¶åŸºäº AQS çš„å…±äº«æ¨¡å¼å®ç°ï¼Œå¯æ›´å¥½åœ°é©¾é©­é«˜å¹¶å‘åœºæ™¯ä¸‹çš„çº¿ç¨‹è°ƒåº¦ï¼ˆå¦‚åˆ†å¸ƒå¼ç³»ç»Ÿå¯åŠ¨ã€æ‰¹é‡ä»»åŠ¡å¤„ç†ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="cyclicbarrier"&gt;CyclicBarrier
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯å…³äº Java å¹¶å‘å·¥å…· &lt;code&gt;CyclicBarrier&lt;/code&gt; çš„è¯¦ç»†è§£æï¼Œç»“åˆå…¶æ ¸å¿ƒåŸç†ã€æºç å®ç°ã€ä½¿ç”¨åœºæ™¯åŠä¸åŒç±»å·¥å…·çš„å¯¹æ¯”å±•å¼€è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†å¾ªç¯å±éšœæœºåˆ¶"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†ï¼šå¾ªç¯å±éšœæœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒè®¾è®¡"&gt;&lt;strong&gt;æ ¸å¿ƒè®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å±éšœç‚¹ï¼ˆBarrier Pointï¼‰&lt;/strong&gt;
åˆå§‹åŒ–æ—¶æŒ‡å®šçº¿ç¨‹æ•°é‡ &lt;code&gt;parties&lt;/code&gt;ï¼Œæ¯ä¸ªçº¿ç¨‹è°ƒç”¨ &lt;code&gt;await()&lt;/code&gt; è¡¨ç¤ºåˆ°è¾¾å±éšœç‚¹å¹¶é˜»å¡ã€‚å½“ç¬¬ &lt;code&gt;parties&lt;/code&gt; ä¸ªçº¿ç¨‹åˆ°è¾¾æ—¶ï¼Œå±éšœæ‰“å¼€ï¼Œæ‰€æœ‰çº¿ç¨‹åŒæ—¶ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é‡ç”¨æ€§ï¼ˆCyclicï¼‰&lt;/strong&gt;
å±éšœè§¦å‘åè‡ªåŠ¨é‡ç½®è®¡æ•°å™¨ï¼ˆ&lt;code&gt;count = parties&lt;/code&gt;ï¼‰ï¼Œæ”¯æŒå¤šè½®åŒæ­¥ï¼Œæ— éœ€é‡æ–°åˆ›å»ºå®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±éšœåŠ¨ä½œï¼ˆBarrier Actionï¼‰&lt;/strong&gt;
å¯é€‰çš„å›è°ƒä»»åŠ¡ï¼ˆ&lt;code&gt;Runnable&lt;/code&gt;ï¼‰ï¼Œåœ¨æ‰€æœ‰çº¿ç¨‹å”¤é†’å‰ç”±&lt;strong&gt;æœ€åä¸€ä¸ªåˆ°è¾¾çš„çº¿ç¨‹&lt;/strong&gt;æ‰§è¡Œï¼Œç”¨äºæ±‡æ€»ç»“æœæˆ–å‘ä»¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å·¥ä½œæµç¨‹-1"&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[çº¿ç¨‹è°ƒç”¨ await] --&amp;gt; B{å½“å‰æ˜¯ç¬¬ parties ä¸ªçº¿ç¨‹?}
B -- æ˜¯ --&amp;gt; C[æ‰§è¡Œ Barrier Action]
C --&amp;gt; D[å”¤é†’æ‰€æœ‰çº¿ç¨‹ &amp;amp; é‡ç½®å±éšœ]
B -- å¦ --&amp;gt; E[çº¿ç¨‹é˜»å¡ç­‰å¾…]
D --&amp;gt; F[æ‰€æœ‰çº¿ç¨‹ç»§ç»­æ‰§è¡Œ]
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°åŸºäºé”ä¸æ¡ä»¶å˜é‡"&gt;â›“ï¸ &lt;strong&gt;åº•å±‚å®ç°ï¼šåŸºäºé”ä¸æ¡ä»¶å˜é‡&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç»„ä»¶æºç å…³é”®å­—æ®µ"&gt;&lt;strong&gt;æ ¸å¿ƒç»„ä»¶ï¼ˆæºç å…³é”®å­—æ®µï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ReentrantLock lock&lt;/code&gt;&lt;/strong&gt;
ä¿è¯çº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨æ“ä½œå’Œæ¡ä»¶ç­‰å¾…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Condition trip&lt;/code&gt;&lt;/strong&gt;
çº¿ç¨‹é˜»å¡é˜Ÿåˆ—ï¼Œæœªåˆ°è¾¾å±éšœçš„çº¿ç¨‹åœ¨æ­¤ç­‰å¾…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Generation generation&lt;/code&gt;&lt;/strong&gt;
ä»£é™…ç®¡ç†å¯¹è±¡ï¼Œè®°å½•å½“å‰å±éšœçŠ¶æ€ï¼ˆæ˜¯å¦æŸå &lt;code&gt;broken&lt;/code&gt;ï¼‰ã€‚æ¯æ¬¡å±éšœé‡ç½®æ—¶åˆ›å»ºæ–°ä»£ï¼Œç¡®ä¿å¼‚å¸¸ä¸å½±å“ä¸‹ä¸€è½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="await"&gt;&lt;strong&gt;&lt;code&gt;await()&lt;/code&gt; æ‰§è¡Œæ­¥éª¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·å–é”&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;lock.lock()&lt;/code&gt; è¿›å…¥ä¸´ç•ŒåŒºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥çŠ¶æ€&lt;/strong&gt;ï¼šè‹¥å±éšœå·²æŸåï¼ˆ&lt;code&gt;generation.broken&lt;/code&gt;ï¼‰ï¼ŒæŠ›å‡º &lt;code&gt;BrokenBarrierException&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è®¡æ•°å™¨å‡1&lt;/strong&gt;ï¼š&lt;code&gt;int index = --count&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è§¦å‘å±éšœï¼šè‹¥&lt;/p&gt;
&lt;p&gt;index == 0&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œ &lt;code&gt;barrierCommand.run()&lt;/code&gt;ï¼ˆè‹¥æœ‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒç”¨ &lt;code&gt;nextGeneration()&lt;/code&gt;ï¼šå”¤é†’æ‰€æœ‰çº¿ç¨‹ã€é‡ç½®è®¡æ•°å™¨ã€åˆ›å»ºæ–°ä»£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é˜»å¡ç­‰å¾…&lt;/strong&gt;ï¼šéæœ€ååˆ°è¾¾çš„çº¿ç¨‹è¿›å…¥ &lt;code&gt;trip.await()&lt;/code&gt; æŒ‚èµ·ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;é‡ç½®é€»è¾‘ï¼ˆ&lt;code&gt;nextGeneration()&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;private void nextGeneration() {
trip.signalAll(); // å”¤é†’æ‰€æœ‰çº¿ç¨‹
count = parties; // é‡ç½®è®¡æ•°å™¨
generation = new Generation(); // åˆ›å»ºæ–°ä»£
}
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ"&gt;ğŸ› ï¸ &lt;strong&gt;ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…¸å‹åº”ç”¨åœºæ™¯"&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¤šé˜¶æ®µä»»åŠ¡åŒæ­¥
å¦‚å¹¶è¡Œè®¡ç®—ä¸­ï¼Œæ¯é˜¶æ®µç»“æŸåçº¿ç¨‹éœ€åŒæ­¥æ•°æ®åå†è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// åˆ†é˜¶æ®µè®¡ç®—ç¤ºä¾‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CyclicBarrier&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;barrier&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CyclicBarrier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;THREAD_NUM&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stage&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stage&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;STAGES&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stage&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;threads&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;computeStage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stage&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;barrier&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;await&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆæœ¬é˜¶æ®µ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é«˜å¹¶å‘æµ‹è¯•&lt;/strong&gt;
æ¨¡æ‹Ÿç¬æ—¶é«˜æµé‡ï¼ˆå¦‚ç§’æ€åœºæ™¯ï¼‰ï¼Œæ§åˆ¶æ‰€æœ‰çº¿ç¨‹åŒæ—¶å‘èµ·è¯·æ±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;èµ„æºåˆå§‹åŒ–&lt;/strong&gt;
å¤šä¸ªä¾èµ–èµ„æºå¹¶è¡Œåˆå§‹åŒ–ï¼Œå…¨éƒ¨å°±ç»ªåå¯åŠ¨æœåŠ¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æœ€ä½³å®è·µä¸é¿å‘æŒ‡å—"&gt;&lt;strong&gt;æœ€ä½³å®è·µä¸é¿å‘æŒ‡å—&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;
ä½¿ç”¨ &lt;code&gt;await(long timeout, TimeUnit unit)&lt;/code&gt; é¿å…çº¿ç¨‹æ°¸ä¹…é˜»å¡ï¼ˆæŠ›å‡º &lt;code&gt;TimeoutException&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;
çº¿ç¨‹ä¸­æ–­æˆ–è¶…æ—¶ä¼šå¯¼è‡´å±éšœæŸåï¼ˆ&lt;code&gt;broken=true&lt;/code&gt;ï¼‰ï¼Œå…¶ä»–çº¿ç¨‹å”¤é†’æ—¶å°†æŠ›å‡º &lt;code&gt;BrokenBarrierException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±éšœåŠ¨ä½œè½»é‡åŒ–&lt;/strong&gt;
&lt;code&gt;barrierCommand&lt;/code&gt; åº”å¿«é€Ÿæ‰§è¡Œï¼Œå¦åˆ™é˜»å¡æ‰€æœ‰çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡ç½®è°¨æ…æ€§&lt;/strong&gt;
&lt;code&gt;reset()&lt;/code&gt; æ–¹æ³•å¼ºåˆ¶é‡ç½®å±éšœï¼Œå¯èƒ½ä¸­æ–­ç­‰å¾…ä¸­çš„çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸-countdownlatch-çš„å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ä¸ CountDownLatch çš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CyclicBarrier&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CountDownLatch&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é‡ç”¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… è‡ªåŠ¨é‡ç½®ï¼Œæ”¯æŒå¤šè½®åŒæ­¥&lt;/td&gt;
&lt;td&gt;âŒ ä¸€æ¬¡æ€§ä½¿ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç­‰å¾…æ–¹å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­çº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼ˆå¯¹ç­‰åä½œï¼‰&lt;/td&gt;
&lt;td&gt;ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ï¼ˆä¸»ä»åä½œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¡æ•°å™¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ æ³•è®¡æ•°ï¼ˆ&lt;code&gt;parties&lt;/code&gt; åˆå§‹åŒ–ï¼Œé€’å‡è‡³0è§¦å‘ï¼‰&lt;/td&gt;
&lt;td&gt;å‡æ³•è®¡æ•°ï¼ˆåˆå§‹åŒ–åé€’å‡ï¼Œå½’é›¶è§¦å‘ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å›è°ƒæ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ”¯æŒ &lt;code&gt;barrierAction&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ æ— &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šé˜¶æ®µä»»åŠ¡ã€å¾ªç¯åŒæ­¥&lt;/td&gt;
&lt;td&gt;å•æ¬¡ä»»åŠ¡å®Œæˆç­‰å¾…ï¼ˆå¦‚æœåŠ¡å¯åŠ¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹åŒºåˆ†&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;èµ›è·‘åœºæ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;CyclicBarrier&lt;/code&gt; åŒæ­¥èµ·è·‘ï¼ˆæ‰€æœ‰é€‰æ‰‹å°±ç»ªååŒæ—¶å¼€å§‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;CountDownLatch&lt;/code&gt; ç­‰å¾…æ‰€æœ‰é€‰æ‰‹å®Œèµ›ï¼ˆä¸»çº¿ç¨‹ç»Ÿè®¡ç»“æœï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-13"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼š
&lt;code&gt;CyclicBarrier&lt;/code&gt; é€šè¿‡ &lt;strong&gt;å¯é‡ç”¨å±éšœ&lt;/strong&gt; å’Œ &lt;strong&gt;å¤šçº¿ç¨‹å¯¹ç­‰åŒæ­¥&lt;/strong&gt; æœºåˆ¶ï¼Œè§£å†³äº†åˆ†é˜¶æ®µä»»åŠ¡åä½œé—®é¢˜ï¼Œå°¤å…¶é€‚åˆè¿­ä»£å¼å¹¶è¡Œè®¡ç®—ã€‚&lt;/li&gt;
&lt;li&gt;é€‰å‹å»ºè®®ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€å¾ªç¯åŒæ­¥ â†’ &lt;code&gt;CyclicBarrier&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å•æ¬¡ç­‰å¾… â†’ &lt;code&gt;CountDownLatch&lt;/code&gt;ï¼›
&lt;ul&gt;
&lt;li&gt;èµ„æºé™æµ â†’ &lt;code&gt;Semaphore&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½æ³¨æ„&lt;/strong&gt;ï¼š
é«˜ç«äº‰åœºæ™¯ä¸‹ï¼ŒåŸºäºé”çš„å®ç°å¯èƒ½æˆä¸ºç“¶é¢ˆï¼Œå¯è€ƒè™‘æ— é”æ–¹æ¡ˆï¼ˆå¦‚ &lt;code&gt;Phaser&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡åˆç†ä½¿ç”¨ &lt;code&gt;CyclicBarrier&lt;/code&gt;ï¼Œå¯æ˜¾è‘—æå‡å¤šçº¿ç¨‹åä½œçš„ç®€æ´æ€§ä¸å¥å£®æ€§ï¼Œæ˜¯æ„å»ºé«˜å¹¶å‘ç³»ç»Ÿçš„æ ¸å¿ƒåŒæ­¥å·¥å…·ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Javaã€‘Composition</title><link>https://dyhes.github.io/p/javacomposition/</link><pubDate>Wed, 18 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javacomposition/</guid><description>&lt;h2 id="ç»„åˆä¼˜äºç»§æ‰¿"&gt;ç»„åˆä¼˜äºç»§æ‰¿
&lt;/h2&gt;&lt;p&gt;ç»„åˆä¼˜äºç»§æ‰¿ï¼ˆComposition over Inheritanceï¼‰æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„æ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼Œå¼ºè°ƒé€šè¿‡&lt;strong&gt;ç»„åˆå¯¹è±¡&lt;/strong&gt;ï¼ˆhas-a å…³ç³»ï¼‰è€Œé&lt;strong&gt;ç»§æ‰¿ç±»&lt;/strong&gt;ï¼ˆis-a å…³ç³»ï¼‰å®ç°ä»£ç å¤ç”¨å’ŒåŠŸèƒ½æ‰©å±•ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆï¼ˆå°†å…¶ä»–ç±»çš„å®ä¾‹ä½œä¸ºæˆå‘˜å˜é‡ï¼‰è€Œéç±»ç»§æ‰¿æ¥æ„å»ºç³»ç»Ÿï¼Œä»¥æå‡çµæ´»æ€§ã€é™ä½è€¦åˆåº¦ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒè¦ç‚¹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸åŒºåˆ«"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸åŒºåˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç»„åˆï¼ˆCompositionï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šä¸€ä¸ªç±»é€šè¿‡æŒæœ‰å…¶ä»–ç±»çš„å®ä¾‹ï¼ˆæˆå‘˜å¯¹è±¡ï¼‰æ¥å¤ç”¨å…¶åŠŸèƒ½ï¼Œä½“ç° &lt;strong&gt;â€œhas-aâ€&lt;/strong&gt; å…³ç³»ï¼ˆå¦‚æ±½è½¦æœ‰å‘åŠ¨æœºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;ï¼šé€šè¿‡æ¥å£æˆ–ç±»å®ä¾‹çš„å§”æ‰˜è°ƒç”¨ï¼ˆå¦‚ &lt;code&gt;car.engine.start()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç»§æ‰¿ï¼ˆInheritanceï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®šä¹‰&lt;/strong&gt;ï¼šå­ç±»é€šè¿‡æ‰©å±•çˆ¶ç±»è·å¾—å±æ€§å’Œæ–¹æ³•ï¼Œä½“ç° &lt;strong&gt;â€œis-aâ€&lt;/strong&gt; å…³ç³»ï¼ˆå¦‚ç‹—æ˜¯åŠ¨ç‰©ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é—®é¢˜ï¼š
&lt;ul&gt;
&lt;li&gt;å­ç±»ä¸çˆ¶ç±»å¼ºè€¦åˆï¼Œçˆ¶ç±»ä¿®æ”¹å¯èƒ½ç ´åå­ç±»é€»è¾‘ï¼›&lt;/li&gt;
&lt;li&gt;ç»§æ‰¿å±‚æ¬¡è¿‡æ·±å¯¼è‡´ç±»çˆ†ç‚¸ï¼ˆClass Explosionï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å¯èƒ½ç»§æ‰¿ä¸å¿…è¦çš„å±æ€§å’Œæ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ºä»€ä¹ˆç»„åˆä¼˜äºç»§æ‰¿"&gt;âš–ï¸ &lt;strong&gt;ä¸ºä»€ä¹ˆç»„åˆä¼˜äºç»§æ‰¿ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç»„åˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç»§æ‰¿&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è€¦åˆåº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆé€šè¿‡æ¥å£äº¤äº’ï¼Œå®ç°æ¾è€¦åˆï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå­ç±»ä¾èµ–çˆ¶ç±»å®ç°ç»†èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆè¿è¡Œæ—¶åŠ¨æ€æ›¿æ¢ç»„ä»¶ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆç¼–è¯‘æ—¶ç¡®å®šï¼Œæ— æ³•åŠ¨æ€è°ƒæ•´ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜“æ‰©å±•ï¼ˆæ–°å¢åŠŸèƒ½åªéœ€æ·»åŠ æ–°ç»„ä»¶ï¼‰&lt;/td&gt;
&lt;td&gt;éš¾æ‰©å±•ï¼ˆéœ€åˆ›å»ºæ–°å­ç±»ï¼Œæ˜“å¼•å‘ç±»çˆ†ç‚¸ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å°è£…æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå†…éƒ¨ç»†èŠ‚éšè—ï¼Œä»…æš´éœ²æ¥å£ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆçˆ¶ç±»å®ç°æš´éœ²ç»™å­ç±»ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤ç”¨ç²’åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç»†ç²’åº¦ï¼ˆæŒ‰éœ€ç»„åˆæ‰€éœ€åŠŸèƒ½ï¼‰&lt;/td&gt;
&lt;td&gt;ç²—ç²’åº¦ï¼ˆå¼ºåˆ¶ç»§æ‰¿å…¨éƒ¨åŠŸèƒ½ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯ä¸æ¡ˆä¾‹"&gt;ğŸ’¡ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯ä¸æ¡ˆä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é¿å…æ— æ•ˆç»§æ‰¿å…³ç³»"&gt;&lt;strong&gt;é¿å…æ— æ•ˆç»§æ‰¿å…³ç³»&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šæ±½è½¦ä¸æ˜¯å‘åŠ¨æœºï¼ˆ&lt;code&gt;Car extends Engine&lt;/code&gt;ï¼‰ï¼Œä½†ç»§æ‰¿å¼ºåˆ¶å»ºç«‹ is-a å…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;ç»„åˆæ–¹æ¡ˆï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Engine&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cm"&gt;/* ... */&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Car&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Engine&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;engine&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Car has-a Engine&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;engine&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å§”æ‰˜è°ƒç”¨&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;å¯åŠ¨æ€æ›´æ¢å¼•æ“ï¼ˆå¦‚ç”µåŠ¨å¼•æ“ï¼‰ï¼Œæ— éœ€åˆ›å»ºæ–°å­ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è§£å†³è¡Œä¸ºç»„åˆé—®é¢˜"&gt;&lt;strong&gt;è§£å†³è¡Œä¸ºç»„åˆé—®é¢˜&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šé¸Ÿç±»ç»§æ‰¿å¯¼è‡´å†—ä½™ï¼ˆé¸µé¸Ÿä¸åº”ç»§æ‰¿ &lt;code&gt;fly()&lt;/code&gt; æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç»„åˆæ–¹æ¡ˆï¼ˆæ¥å£ + å§”æ‰˜ï¼‰ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;Flyable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;fly&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;FlyAbility&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Flyable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;fly&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cm"&gt;/* é£è¡Œå®ç° */&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Sparrow&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FlyAbility&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flyer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FlyAbility&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;fly&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flyer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;fly&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å§”æ‰˜&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Ostrich&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cm"&gt;/* æ— éœ€å®ç° Flyable */&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;ä»…éœ€ç»„åˆæ‰€éœ€èƒ½åŠ›ï¼Œé¿å…æ–¹æ³•å†—ä½™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŠ¨æ€æ‰©å±•åŠŸèƒ½"&gt;&lt;strong&gt;åŠ¨æ€æ‰©å±•åŠŸèƒ½&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è£…é¥°å™¨æ¨¡å¼ï¼šé€šè¿‡ç»„åˆåµŒå¥—å¯¹è±¡åŠ¨æ€æ·»åŠ åŠŸèƒ½ï¼ˆå¦‚ä¸ºå’–å•¡æ·»åŠ ç‰›å¥¶ï¼‰ã€‚
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;Coffee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MilkDecorator&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Coffee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Coffee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;MilkDecorator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Coffee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;base&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;æ¯”ç»§æ‰¿ï¼ˆå¦‚
&lt;pre tabindex="0"&gt;&lt;code&gt;MilkCoffee extends Coffee
&lt;/code&gt;&lt;/pre&gt;ï¼‰æ›´çµæ´»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä½•æ—¶ä½¿ç”¨ç»§æ‰¿"&gt;âš ï¸ &lt;strong&gt;ä½•æ—¶ä½¿ç”¨ç»§æ‰¿ï¼Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å°½ç®¡ç»„åˆæ›´çµæ´»ï¼Œ&lt;strong&gt;ç»§æ‰¿ä»æœ‰é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¨³å®šçš„ is-a å…³ç³»&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;Dog extends Animal&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€åˆ©ç”¨å¤šæ€ç‰¹æ€§&lt;/strong&gt;ï¼ˆå¦‚çˆ¶ç±»æ–¹æ³•éœ€è¢«å­ç±»é‡å†™ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡†æ¶é™åˆ¶&lt;/strong&gt;ï¼ˆå¦‚æŸäº› API å¼ºåˆ¶è¦æ±‚ç»§æ‰¿åŸºç±»ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®è·µå»ºè®®"&gt;ğŸ’ &lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆç»„åˆ&lt;/strong&gt;ï¼šæ–°åŠŸèƒ½é€šè¿‡ç»„åˆç°æœ‰ç»„ä»¶å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘æ¥å£ç¼–ç¨‹&lt;/strong&gt;ï¼šä¾èµ–æŠ½è±¡æ¥å£è€Œéå…·ä½“ç±»ï¼Œæå‡ç»„ä»¶å¯æ›¿æ¢æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶ç»§æ‰¿å±‚æ¬¡&lt;/strong&gt;ï¼šç»§æ‰¿å±‚æ¬¡ â‰¤ 2 å±‚ï¼Œé¿å…å¤æ‚æ€§å’Œè„†å¼±æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨è®¾è®¡æ¨¡å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç­–ç•¥æ¨¡å¼&lt;/strong&gt;ï¼šé€šè¿‡ç»„åˆä¸åŒç­–ç•¥å¯¹è±¡åŠ¨æ€æ”¹å˜è¡Œä¸ºï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Mixin æ¨¡å¼&lt;/strong&gt;ï¼ˆPython/Rustï¼‰ï¼šæ°´å¹³æ··å…¥åŠŸèƒ½ï¼Œæ›¿ä»£å¤šé‡ç»§æ‰¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç»„åˆä¼˜äºç»§æ‰¿çš„æ ¸å¿ƒä»·å€¼åœ¨äº&lt;strong&gt;è§£è€¦ä¸åŠ¨æ€æ‰©å±•&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»„åˆé€šè¿‡ &lt;strong&gt;â€œé»‘ç›’å¤ç”¨â€&lt;/strong&gt;ï¼ˆä»…ä¾èµ–æ¥å£ï¼‰å’Œ &lt;strong&gt;â€œåŠ¨æ€ç»„è£…â€&lt;/strong&gt; è§£å†³äº†ç»§æ‰¿çš„å¼ºè€¦åˆä¸åƒµåŒ–é—®é¢˜ï¼›&lt;/li&gt;
&lt;li&gt;ç»§æ‰¿é€‚ç”¨äº &lt;strong&gt;ç±»å‹ä¸¥æ ¼åŒ¹é…&lt;/strong&gt; çš„åœºæ™¯ï¼Œä½†éœ€è­¦æƒ•å±‚æ¬¡è¿‡æ·±å¸¦æ¥çš„ç»´æŠ¤æˆæœ¬ã€‚
åœ¨ç°ä»£è¯­è¨€ï¼ˆå¦‚ Goã€Rustï¼‰ä¸­ï¼Œç»„åˆå·²æˆä¸ºä¸»æµï¼Œè€Œç»§æ‰¿é€æ¸è¢«æ¥å£å’Œ Trait æ›¿ä»£ã€‚&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Javaã€‘Java çº¿ç¨‹å®‰å…¨é›†åˆ</title><link>https://dyhes.github.io/p/javajava-%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%9B%86%E5%90%88/</link><pubDate>Wed, 18 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javajava-%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%9B%86%E5%90%88/</guid><description>&lt;h2 id="æ€»è§ˆ"&gt;æ€»è§ˆ
&lt;/h2&gt;&lt;p&gt;åœ¨Javaå¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œçº¿ç¨‹å®‰å…¨é›†åˆæ˜¯ç¡®ä¿æ•°æ®ä¸€è‡´æ€§å’Œæ“ä½œå¯é æ€§çš„å…³é”®ç»„ä»¶ã€‚ä»¥ä¸‹æ˜¯Javaçº¿ç¨‹å®‰å…¨é›†åˆçš„è¯¦ç»†åˆ†ç±»åŠå®ç°åŸç†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼ ç»ŸåŒæ­¥é›†åˆæ—©æœŸå®ç°æ€§èƒ½è¾ƒä½"&gt;âš™ï¸ ä¼ ç»ŸåŒæ­¥é›†åˆï¼ˆæ—©æœŸå®ç°ï¼Œæ€§èƒ½è¾ƒä½ï¼‰
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Vector&lt;/code&gt; ä¸ &lt;code&gt;Stack&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æœºåˆ¶&lt;/strong&gt;ï¼šæ‰€æœ‰æ–¹æ³•é€šè¿‡&lt;code&gt;synchronized&lt;/code&gt;ä¿®é¥°ï¼Œå…¨å±€é”ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Vector&lt;/code&gt;æ˜¯çº¿ç¨‹å®‰å…¨çš„åŠ¨æ€æ•°ç»„ï¼Œç±»ä¼¼&lt;code&gt;ArrayList&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Stack&lt;/code&gt;ç»§æ‰¿&lt;code&gt;Vector&lt;/code&gt;ï¼Œå®ç°åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰æ ˆç»“æ„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šé«˜å¹¶å‘ä¸‹æ€§èƒ½å·®ï¼ˆé”ç²’åº¦è¿‡å¤§ï¼‰ï¼Œå·²é€æ¸è¢«æ›¿ä»£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Hashtable&lt;/code&gt;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ç°æœºåˆ¶&lt;/strong&gt;ï¼šæ‰€æœ‰æ–¹æ³•ä½¿ç”¨&lt;code&gt;synchronized&lt;/code&gt;åŒæ­¥é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šçº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨ï¼Œ&lt;strong&gt;ä¸å…è®¸é”®æˆ–å€¼ä¸º&lt;code&gt;null&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šå¹¶å‘æ€§èƒ½ä½ï¼Œè¢«&lt;code&gt;ConcurrentHashMap&lt;/code&gt;å–ä»£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åŒæ­¥åŒ…è£…å™¨collectionssynchronizedxxx"&gt;ğŸ”„ åŒæ­¥åŒ…è£…å™¨ï¼ˆ&lt;code&gt;Collections.synchronizedXXX&lt;/code&gt;ï¼‰
&lt;/h3&gt;&lt;p&gt;é€šè¿‡å·¥å…·ç±»åŒ…è£…éçº¿ç¨‹å®‰å…¨é›†åˆï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;List&amp;lt;String&amp;gt; syncList = Collections.synchronizedList(new ArrayList&amp;lt;&amp;gt;());
Map&amp;lt;String, String&amp;gt; syncMap = Collections.synchronizedMap(new HashMap&amp;lt;&amp;gt;());
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šæ‰€æœ‰æ–¹æ³•æ·»åŠ &lt;code&gt;synchronized&lt;/code&gt;é”ã€‚&lt;/li&gt;
&lt;li&gt;æ³¨æ„äº‹é¡¹ï¼š
&lt;ul&gt;
&lt;li&gt;è¿­ä»£æ“ä½œéœ€æ‰‹åŠ¨åŠ é”ï¼ˆå¦åˆ™å¯èƒ½æŠ›å‡º&lt;code&gt;ConcurrentModificationException&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤åˆæ“ä½œï¼ˆå¦‚å…ˆæ£€æŸ¥åæ›´æ–°ï¼‰éœ€é¢å¤–åŒæ­¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå…¼å®¹æ—§ä»£ç æˆ–ä½å¹¶å‘éœ€æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¹¶å‘é›†åˆjavautilconcurrentåŒ…"&gt;ğŸš€ å¹¶å‘é›†åˆï¼ˆ&lt;code&gt;java.util.concurrent&lt;/code&gt;åŒ…ï¼‰
&lt;/h3&gt;&lt;h4 id="concurrenthashmap"&gt;&lt;strong&gt;&lt;code&gt;ConcurrentHashMap&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹å®‰å…¨æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;JDK 1.7ï¼šåˆ†æ®µé”ï¼ˆSegmentï¼‰å‡å°‘é”ç«äº‰ï¼›&lt;/li&gt;
&lt;li&gt;JDK 1.8+ï¼šCAS + &lt;code&gt;synchronized&lt;/code&gt;ï¼ˆé”ç²’åº¦ç»†åŒ–åˆ°æ¡¶çº§åˆ«ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘è¯»å†™ï¼ˆ&lt;code&gt;get()&lt;/code&gt;æ— é”ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ”¯æŒåŸå­æ“ä½œï¼ˆå¦‚&lt;code&gt;putIfAbsent()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé«˜å¹¶å‘é”®å€¼å­˜å‚¨ï¼Œæ›¿ä»£&lt;code&gt;Hashtable&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å†™æ—¶å¤åˆ¶é›†åˆ"&gt;&lt;strong&gt;å†™æ—¶å¤åˆ¶é›†åˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;CopyOnWriteArrayList / CopyOnWriteArraySet&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šå†™æ“ä½œï¼ˆå¢åˆ æ”¹ï¼‰æ—¶å¤åˆ¶æ•´ä¸ªæ•°ç»„ï¼Œæ–°å‰¯æœ¬ä¿®æ”¹åæ›¿æ¢æ—§æ•°æ®ã€‚
&lt;ul&gt;
&lt;li&gt;ç‰¹ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;è¯»æ“ä½œæ— é”ï¼ŒåŸºäºå¿«ç…§è¿­ä»£ï¼ˆé¿å…&lt;code&gt;ConcurrentModificationException&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å†™æ“ä½œæ€§èƒ½ä½ï¼ˆé€‚åˆ&lt;strong&gt;è¯»å¤šå†™å°‘&lt;/strong&gt;åœºæ™¯ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šç›‘å¬å™¨åˆ—è¡¨ã€é…ç½®ç®¡ç†ç­‰ä½é¢‘æ›´æ–°åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¹¶å‘é˜Ÿåˆ—"&gt;&lt;strong&gt;å¹¶å‘é˜Ÿåˆ—&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ConcurrentLinkedQueue
&lt;ul&gt;
&lt;li&gt;æ— é”å®ç°ï¼ˆåŸºäºCASï¼‰ï¼Œéé˜»å¡çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ConcurrentSkipListMap / ConcurrentSkipListSet&lt;/li&gt;
&lt;li&gt;åŸºäºè·³è¡¨ï¼ˆSkip Listï¼‰çš„æœ‰åºé›†åˆï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é˜»å¡é˜Ÿåˆ—"&gt;&lt;strong&gt;é˜»å¡é˜Ÿåˆ—ï¼ˆ&lt;code&gt;BlockingQueue&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼Œæ”¯æŒé˜»å¡æ“ä½œï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é˜Ÿåˆ—ç±»å‹&lt;/th&gt;
&lt;th&gt;ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ArrayBlockingQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æœ‰ç•Œæ•°ç»„é˜Ÿåˆ—ï¼Œå›ºå®šå®¹é‡ï¼ŒFIFOæ’åº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LinkedBlockingQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯é€‰æœ‰ç•Œï¼ˆé»˜è®¤æ— ç•Œï¼‰ï¼Œé“¾è¡¨å®ç°ï¼ŒåŒé”åˆ†ç¦»æé«˜ååé‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;PriorityBlockingQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ— ç•Œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ŒæŒ‰è‡ªç„¶é¡ºåºæˆ–Comparatoræ’åº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;SynchronousQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸å­˜å‚¨å…ƒç´ ï¼Œç›´æ¥ä¼ é€’ä»»åŠ¡ï¼ˆå¦‚çº¿ç¨‹æ± ä»»åŠ¡è°ƒåº¦ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‰å‹å»ºè®®ä¸æ³¨æ„äº‹é¡¹"&gt;ğŸ§© é€‰å‹å»ºè®®ä¸æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;h4 id="åœºæ™¯åŒ–é€‰å‹æŒ‡å—"&gt;&lt;strong&gt;åœºæ™¯åŒ–é€‰å‹æŒ‡å—&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åœºæ™¯&lt;/th&gt;
&lt;th&gt;æ¨èé›†åˆç±»&lt;/th&gt;
&lt;th&gt;ç†ç”±&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;é«˜å¹¶å‘è¯»å†™Map&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ConcurrentHashMap&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ†æ®µé”/CASä¼˜åŒ–ï¼Œæ€§èƒ½è¿œè¶…&lt;code&gt;Hashtable&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¯»å¤šå†™å°‘List/Set&lt;/td&gt;
&lt;td&gt;&lt;code&gt;CopyOnWriteArrayList/Set&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ— é”è¯»ï¼Œå†™æ—¶å¤åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;BlockingQueue&lt;/code&gt;å®ç°ç±»&lt;/td&gt;
&lt;td&gt;é˜»å¡æœºåˆ¶ç®€åŒ–çº¿ç¨‹åä½œï¼ˆå¦‚&lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœ‰åºå¹¶å‘é›†åˆ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ConcurrentSkipListMap/Set&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·³è¡¨å®ç°é«˜æ•ˆå¹¶å‘æœ‰åºè®¿é—®&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="å…³é”®æ³¨æ„äº‹é¡¹"&gt;&lt;strong&gt;å…³é”®æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤åˆæ“ä½œé£é™©&lt;/strong&gt;ï¼šå³ä½¿ä½¿ç”¨çº¿ç¨‹å®‰å…¨é›†åˆï¼Œç»„åˆæ“ä½œï¼ˆå¦‚â€œæ£€æŸ¥-æ›´æ–°â€ï¼‰ä»éœ€é¢å¤–åŒæ­¥æˆ–åŸå­æ–¹æ³•ï¼ˆå¦‚&lt;code&gt;ConcurrentHashMap.putIfAbsent()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è¿­ä»£å™¨ä¸€è‡´æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ConcurrentHashMap&lt;/code&gt;è¿­ä»£å™¨æ˜¯&lt;strong&gt;å¼±ä¸€è‡´æ€§&lt;/strong&gt;ï¼ˆå¯èƒ½ä¸åæ˜ æœ€æ–°ä¿®æ”¹ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CopyOnWrite&lt;/code&gt;é›†åˆè¿­ä»£å™¨åŸºäº&lt;strong&gt;å¿«ç…§&lt;/strong&gt;ï¼ˆåˆ›å»ºåä¸å˜ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½æƒè¡¡ï¼š
&lt;ul&gt;
&lt;li&gt;å†™é¢‘ç¹åœºæ™¯é¿å…&lt;code&gt;CopyOnWrite&lt;/code&gt;ï¼ˆå¤åˆ¶å¼€é”€å¤§ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;é«˜ååéœ€æ±‚ä¼˜å…ˆé€‰æ— é”é˜Ÿåˆ—ï¼ˆå¦‚&lt;code&gt;ConcurrentLinkedQueue&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Javaçº¿ç¨‹å®‰å…¨é›†åˆä»æ—©æœŸå…¨å±€é”ï¼ˆ&lt;code&gt;Vector&lt;/code&gt;ã€&lt;code&gt;Hashtable&lt;/code&gt;ï¼‰æ¼”è¿›ä¸ºé«˜æ•ˆå¹¶å‘ç»“æ„ï¼ˆ&lt;code&gt;ConcurrentHashMap&lt;/code&gt;ã€æ— é”é˜Ÿåˆ—ï¼‰ã€‚&lt;strong&gt;æ ¸å¿ƒä¼˜åŒ–æ–¹å‘æ˜¯ç¼©å°é”ç²’åº¦ã€å‡å°‘ç«äº‰ã€åˆ†ç¦»è¯»å†™æ“ä½œ&lt;/strong&gt;ã€‚é€‰å‹æ—¶éœ€ç»“åˆ&lt;strong&gt;è¯»å†™æ¯”ä¾‹ã€æ•°æ®ä¸€è‡´æ€§è¦æ±‚ã€æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;ç»¼åˆæƒè¡¡ï¼Œé¿å…è¯¯ç”¨å¯¼è‡´æ€§èƒ½ä¸‹é™æˆ–çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id="åˆ†æ®µé”"&gt;åˆ†æ®µé”
&lt;/h2&gt;&lt;p&gt;åˆ†æ®µé”ï¼ˆSegment Lockingï¼‰æ˜¯ä¸€ç§é€šè¿‡&lt;strong&gt;ç»†åŒ–é”ç²’åº¦&lt;/strong&gt;æ¥æé«˜å¤šçº¿ç¨‹å¹¶å‘æ€§èƒ½çš„é”è®¾è®¡ç­–ç•¥ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯å°†å…±äº«æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹åŒºå—ï¼ˆSegmentï¼‰ï¼Œæ¯ä¸ªåŒºå—åˆ†é…ç‹¬ç«‹çš„é”ã€‚çº¿ç¨‹è®¿é—®ä¸åŒåŒºå—æ—¶æ— éœ€ç«äº‰åŒä¸€æŠŠé”ï¼Œä»è€Œå‡å°‘é˜»å¡ã€‚ä»¥ä¸‹ä»¥Javaçš„&lt;code&gt;ConcurrentHashMap&lt;/code&gt;ï¼ˆJDK7å®ç°ï¼‰ä¸ºä¾‹è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ®µå­˜å‚¨&lt;/strong&gt;ï¼š&lt;code&gt;ConcurrentHashMap&lt;/code&gt;å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª&lt;code&gt;Segment&lt;/code&gt;æ•°ç»„ï¼ˆé»˜è®¤16ä¸ªï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Segmentç»“æ„&lt;/strong&gt;ï¼šæ¯ä¸ª&lt;code&gt;Segment&lt;/code&gt;ç»§æ‰¿&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼ŒåŒ…å«ä¸€ä¸ª&lt;code&gt;HashEntry&lt;/code&gt;æ•°ç»„ï¼ˆç±»ä¼¼å°å‹&lt;code&gt;HashMap&lt;/code&gt;ï¼‰ï¼Œç‹¬ç«‹ç®¡ç†ä¸€éƒ¨åˆ†é”®å€¼å¯¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”ç²’åº¦ç»†åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†™æ“ä½œ&lt;/strong&gt;ï¼šæ ¹æ®é”®çš„å“ˆå¸Œå€¼å®šä½åˆ°ç‰¹å®š&lt;code&gt;Segment&lt;/code&gt;ï¼Œä»…é”å®šè¯¥&lt;code&gt;Segment&lt;/code&gt;ï¼Œå…¶ä»–&lt;code&gt;Segment&lt;/code&gt;ä»å¯å¹¶å‘è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯»æ“ä½œ&lt;/strong&gt;ï¼šé€šå¸¸æ— é”ï¼ˆä¾èµ–&lt;code&gt;volatile&lt;/code&gt;å˜é‡ä¿è¯å¯è§æ€§ï¼‰ï¼Œé«˜å¹¶å‘è¯»å–ä¸å—é™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘åº¦æ§åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤æ”¯æŒ16çº¿ç¨‹å¹¶å‘å†™&lt;/strong&gt;ï¼šå› &lt;code&gt;Segment&lt;/code&gt;æ•°é‡å›ºå®šä¸º16ï¼Œä¸åŒçº¿ç¨‹æ“ä½œä¸åŒ&lt;code&gt;Segment&lt;/code&gt;æ—¶å¯å¹¶è¡Œæ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ä½œæµç¨‹ç¤ºä¾‹"&gt;âš¡ &lt;strong&gt;å·¥ä½œæµç¨‹ç¤ºä¾‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ä»¥&lt;code&gt;put()&lt;/code&gt;æ“ä½œä¸ºä¾‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è®¡ç®—é”®çš„å“ˆå¸Œå€¼ï¼Œç¡®å®šæ‰€å±&lt;code&gt;Segment&lt;/code&gt;ç´¢å¼•ï¼ˆå¦‚ &lt;code&gt;(hash &amp;gt;&amp;gt;&amp;gt; segmentShift) &amp;amp; segmentMask&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»…å¯¹ç›®æ ‡&lt;code&gt;Segment&lt;/code&gt;åŠ é”ï¼Œæ‰§è¡Œæ’å…¥æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;å…¶ä»–çº¿ç¨‹è‹¥æ“ä½œä¸åŒ&lt;code&gt;Segment&lt;/code&gt;ï¼Œå¯åŒæ—¶æ‰§è¡Œå†™æ“ä½œï¼Œäº’ä¸é˜»å¡ã€‚
&lt;strong&gt;å…¨å±€æ“ä½œï¼ˆå¦‚&lt;code&gt;size()&lt;/code&gt;ï¼‰çš„ä»£ä»·&lt;/strong&gt;ï¼šéœ€æŒ‰é¡ºåºè·å–æ‰€æœ‰&lt;code&gt;Segment&lt;/code&gt;çš„é”ï¼Œå†ç»Ÿè®¡æ€»æ•°ï¼Œæ€§èƒ½è¾ƒä½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜ç¼ºç‚¹åˆ†æ"&gt;âš–ï¸ &lt;strong&gt;ä¼˜ç¼ºç‚¹åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;âœ… &lt;strong&gt;é«˜å¹¶å‘å†™&lt;/strong&gt;ï¼šä¸åŒ&lt;code&gt;Segment&lt;/code&gt;å¹¶è¡Œæ“ä½œ&lt;/td&gt;
&lt;td&gt;âŒ &lt;strong&gt;å†…å­˜å¼€é”€å¤§&lt;/strong&gt;ï¼šæ¯ä¸ª&lt;code&gt;Segment&lt;/code&gt;éœ€ç‹¬ç«‹é”å’Œæ•°æ®ç»“æ„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;âœ… &lt;strong&gt;å‡å°‘é”ç«äº‰&lt;/strong&gt;ï¼šé”ç²’åº¦ç»†åŒ–è‡³åŒºå—çº§&lt;/td&gt;
&lt;td&gt;âŒ &lt;strong&gt;å…¨å±€æ“ä½œä½æ•ˆ&lt;/strong&gt;ï¼šå¦‚&lt;code&gt;size()&lt;/code&gt;éœ€é”å…¨éƒ¨åˆ†æ®µ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;âœ… &lt;strong&gt;è¯»æ“ä½œæ— é”&lt;/strong&gt;ï¼šé«˜æ€§èƒ½è¯»å–&lt;/td&gt;
&lt;td&gt;âŒ &lt;strong&gt;æ­»é”é£é™©&lt;/strong&gt;ï¼šåµŒå¥—è·å–å¤šåˆ†æ®µé”æ—¶å¯èƒ½æ­»é”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-java-8çš„ä¼˜åŒ–"&gt;ğŸ”„ &lt;strong&gt;Java 8çš„ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;JDK8çš„&lt;code&gt;ConcurrentHashMap&lt;/code&gt;å¼ƒç”¨&lt;code&gt;Segment&lt;/code&gt;ï¼Œæ”¹ç”¨æ›´ç»†ç²’åº¦çš„&lt;strong&gt;CAS + &lt;code&gt;synchronized&lt;/code&gt;é”æ¡¶ï¼ˆNodeï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”ç²’åº¦ç»†åŒ–åˆ°å•ä¸ªæ¡¶&lt;/strong&gt;ï¼šä»…å†²çªå“ˆå¸Œæ¡¶åŠ é”ï¼Œå¹¶å‘åº¦æ›´é«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å ç”¨æ›´ä½&lt;/strong&gt;ï¼šæ¶ˆé™¤&lt;code&gt;Segment&lt;/code&gt;å±‚çº§ç»“æ„ã€‚
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰ˆæœ¬&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é”æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹¶å‘ç²’åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†æ®µé”ï¼ˆSegmentï¼‰&lt;/td&gt;
&lt;td&gt;16ä¸ªåˆ†åŒº&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK8+&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;CAS + &lt;code&gt;synchronized&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å•ä¸ªå“ˆå¸Œæ¡¶&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯"&gt;ğŸ’¡ &lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘å†™å…¥&lt;/strong&gt;ï¼šå¤šçº¿ç¨‹é¢‘ç¹ä¿®æ”¹ä¸åŒé”®å€¼å¯¹ï¼ˆå¦‚åˆ†ç‰‡æ•°æ®å­˜å‚¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯»å¤šå†™å°‘&lt;/strong&gt;ï¼šæ— é”è¯»æ“ä½œé€‚åˆé«˜é¢‘æŸ¥è¯¢åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;æ›¿ä»£æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;å†™æå°‘ï¼š&lt;code&gt;CopyOnWriteArrayList&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å…¨å±€åŸå­æ“ä½œï¼š&lt;code&gt;ConcurrentHashMap.compute()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åˆ†æ®µé”é€šè¿‡&lt;strong&gt;æ•°æ®åˆ†ç‰‡ + ç‹¬ç«‹é”&lt;/strong&gt;æå‡å¹¶å‘æ€§èƒ½ï¼Œæ˜¯JDK7&lt;code&gt;ConcurrentHashMap&lt;/code&gt;é«˜å¹¶å‘çš„åŸºçŸ³ã€‚ä½†å…¶å†…å­˜å¼€é”€å’Œå…¨å±€æ“ä½œç“¶é¢ˆä¿ƒä½¿JDK8è½¬å‘æ›´ç²¾ç»†çš„æ¡¶çº§åˆ«é”ã€‚å®é™…å¼€å‘ä¸­ï¼Œåº”ç»“åˆæ•°æ®è®¿é—®æ¨¡å¼ï¼ˆè¯»å†™æ¯”ä¾‹ã€é”®åˆ†å¸ƒï¼‰é€‰æ‹©çº¿ç¨‹å®‰å…¨é›†åˆï¼Œå¹¶ä¼˜å…ˆä½¿ç”¨JDK8+çš„ä¼˜åŒ–å®ç°ã€‚&lt;/p&gt;
&lt;h2 id="concurrenthashmap-1"&gt;ConcurrentHashMap
&lt;/h2&gt;&lt;p&gt;ConcurrentHashMap æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent&lt;/code&gt;ï¼‰ä¸­æ ¸å¿ƒçš„çº¿ç¨‹å®‰å…¨å“ˆå¸Œè¡¨å®ç°ï¼Œä¸“ä¸ºé«˜å¹¶å‘åœºæ™¯è®¾è®¡ã€‚å®ƒé€šè¿‡&lt;strong&gt;ç»†ç²’åº¦é”ã€CAS æ“ä½œå’Œæ•°æ®ç»“æ„ä¼˜åŒ–&lt;/strong&gt;ï¼Œåœ¨ä¿è¯çº¿ç¨‹å®‰å…¨çš„åŒæ—¶å®ç°é«˜æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒåŸç†ã€æ¼”è¿›åŠå…³é”®ç‰¹æ€§çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-çº¿ç¨‹å®‰å…¨å®ç°æœºåˆ¶ç‰ˆæœ¬æ¼”è¿›"&gt;âš™ï¸ &lt;strong&gt;çº¿ç¨‹å®‰å…¨å®ç°æœºåˆ¶ï¼ˆç‰ˆæœ¬æ¼”è¿›ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="java-7åˆ†æ®µé”segment-locking"&gt;&lt;strong&gt;Java 7ï¼šåˆ†æ®µé”ï¼ˆSegment Lockingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ•°æ®ç»“æ„ï¼š
&lt;ul&gt;
&lt;li&gt;å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª &lt;strong&gt;Segment æ•°ç»„&lt;/strong&gt;ï¼ˆé»˜è®¤ 16 ä¸ªï¼‰ï¼Œæ¯ä¸ª &lt;code&gt;Segment&lt;/code&gt; ç»§æ‰¿ &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼ŒåŒ…å«ç‹¬ç«‹çš„ &lt;code&gt;HashEntry&lt;/code&gt; æ•°ç»„ï¼ˆç±»ä¼¼å°å‹ &lt;code&gt;HashMap&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é”æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†™æ“ä½œ&lt;/strong&gt;ï¼šæ ¹æ®é”®çš„å“ˆå¸Œå€¼å®šä½åˆ°ç‰¹å®š &lt;code&gt;Segment&lt;/code&gt;ï¼Œä»…é”å®šè¯¥ &lt;code&gt;Segment&lt;/code&gt;ï¼Œå…¶ä»– &lt;code&gt;Segment&lt;/code&gt; å¯å¹¶å‘è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯»æ“ä½œ&lt;/strong&gt;ï¼šæ— é”ï¼Œä¾èµ– &lt;code&gt;volatile&lt;/code&gt; å˜é‡ä¿è¯å¯è§æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¹¶å‘åº¦é™åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;é»˜è®¤æ”¯æŒ 16 çº¿ç¨‹å¹¶å‘å†™ï¼ˆå›  &lt;code&gt;Segment&lt;/code&gt; æ•°é‡å›ºå®šï¼‰ï¼Œå…¨å±€æ“ä½œï¼ˆå¦‚ &lt;code&gt;size()&lt;/code&gt;ï¼‰éœ€é”æ‰€æœ‰ &lt;code&gt;Segment&lt;/code&gt;ï¼Œæ€§èƒ½ä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="java-8èŠ‚ç‚¹çº§é”node-level-locking"&gt;&lt;strong&gt;Java 8+ï¼šèŠ‚ç‚¹çº§é”ï¼ˆNode-Level Lockingï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ•°æ®ç»“æ„ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;æŠ›å¼ƒ &lt;code&gt;Segment&lt;/code&gt;ï¼Œæ”¹ç”¨ &lt;strong&gt;æ•°ç»„ + é“¾è¡¨/çº¢é»‘æ ‘&lt;/strong&gt;ï¼ˆé“¾è¡¨é•¿åº¦ â‰¥8 æ—¶è½¬ä¸ºçº¢é»‘æ ‘ï¼Œé¿å…æŸ¥è¯¢é€€åŒ–ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é”æœºåˆ¶å‡çº§ï¼š
&lt;ul&gt;
&lt;li&gt;CAS + synchronizedï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç©ºæ¡¶æ’å…¥&lt;/strong&gt;ï¼šä½¿ç”¨ CAS æ— é”æ“ä½œï¼ˆå¦‚ &lt;code&gt;tabAt&lt;/code&gt; å®šä½æ¡¶å CAS å†™å…¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éç©ºæ¡¶æ“ä½œ&lt;/strong&gt;ï¼šå¯¹æ¡¶çš„å¤´èŠ‚ç‚¹åŠ  &lt;code&gt;synchronized&lt;/code&gt; é”ï¼Œéå†é“¾è¡¨/çº¢é»‘æ ‘æ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯»æ“ä½œ&lt;/strong&gt;ï¼šä»æ— é”ï¼Œä¾èµ– &lt;code&gt;volatile&lt;/code&gt; ä¿®é¥°çš„ &lt;code&gt;Node.val&lt;/code&gt; å’Œ &lt;code&gt;next&lt;/code&gt; æŒ‡é’ˆä¿è¯å¯è§æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;é”ç²’åº¦ç»†åŒ–åˆ°&lt;strong&gt;å•ä¸ªæ¡¶&lt;/strong&gt;ï¼Œå¹¶å‘åº¦æ›´é«˜ï¼ˆä¸æ¡¶æ•°é‡æ­£ç›¸å…³ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å†…å­˜å ç”¨æ›´ä½ï¼ˆæ¶ˆé™¤ &lt;code&gt;Segment&lt;/code&gt; å±‚çº§ï¼‰ã€‚
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰ˆæœ¬&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é”æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹¶å‘ç²’åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åˆ†æ®µé”ï¼ˆ&lt;code&gt;Segment&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;16 ä¸ªåˆ†åŒº&lt;/td&gt;
&lt;td&gt;æ•°ç»„ + é“¾è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;JDK8+&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;CAS + &lt;code&gt;synchronized&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å•ä¸ªå“ˆå¸Œæ¡¶&lt;/td&gt;
&lt;td&gt;æ•°ç»„ + é“¾è¡¨/çº¢é»‘æ ‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ“ä½œæµç¨‹ä»¥"&gt;ğŸ”„ &lt;strong&gt;æ ¸å¿ƒæ“ä½œæµç¨‹ï¼ˆä»¥ &lt;code&gt;put()&lt;/code&gt; ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è®¡ç®—å“ˆå¸Œï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨æ‰°åŠ¨å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;spread()&lt;/code&gt;ï¼‰è®¡ç®—é”®çš„å“ˆå¸Œå€¼ï¼Œå‡å°‘å†²çªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®šä½æ¡¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;(n-1) &amp;amp; hash&lt;/code&gt; ç¡®å®šé”®å€¼å¯¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼ˆ&lt;code&gt;n&lt;/code&gt; ä¸ºæ•°ç»„é•¿åº¦ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ’å…¥/æ›´æ–°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç©ºæ¡¶&lt;/strong&gt;ï¼šå°è¯• CAS æ’å…¥æ–°èŠ‚ç‚¹ï¼ˆæ— é”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éç©ºæ¡¶ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹å¤´èŠ‚ç‚¹åŠ  &lt;code&gt;synchronized&lt;/code&gt; é”ï¼›&lt;/li&gt;
&lt;li&gt;éå†é“¾è¡¨/çº¢é»‘æ ‘ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥é”®å­˜åœ¨ï¼Œæ›´æ–°å€¼ï¼›&lt;/li&gt;
&lt;li&gt;è‹¥ä¸å­˜åœ¨ï¼Œæ’å…¥æ–°èŠ‚ç‚¹ï¼ˆå°¾æ’æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ‰©å®¹è§¦å‘ï¼š
&lt;ul&gt;
&lt;li&gt;å…ƒç´ æ•° â‰¥ &lt;code&gt;å®¹é‡ Ã— è´Ÿè½½å› å­&lt;/code&gt;ï¼ˆé»˜è®¤ 0.75ï¼‰æ—¶è§¦å‘æ‰©å®¹ï¼›&lt;/li&gt;
&lt;li&gt;å…¶ä»–çº¿ç¨‹æ’å…¥æ—¶å‘ç°æ‰©å®¹ï¼Œä¼šååŠ©è¿ç§»æ•°æ®ï¼ˆå¤šçº¿ç¨‹ååŒï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®ç‰¹æ€§ä¸ä¼˜åŒ–"&gt;âš¡ &lt;strong&gt;å…³é”®ç‰¹æ€§ä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é«˜å¹¶å‘è¯»å†™"&gt;&lt;strong&gt;é«˜å¹¶å‘è¯»å†™&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯»æ— é”&lt;/strong&gt;ï¼šä¾èµ– &lt;code&gt;volatile&lt;/code&gt; å˜é‡ï¼Œæ”¯æŒå®Œå…¨å¹¶å‘çš„è¯»æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™é«˜æ•ˆ&lt;/strong&gt;ï¼šä¸åŒæ¡¶çš„å†™æ“ä½œäº’ä¸å½±å“ï¼Œä»…ç›¸åŒæ¡¶çš„å†™æ“ä½œç«äº‰åŒä¸€æŠŠé”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŠ¨æ€æ‰©å®¹æœºåˆ¶"&gt;&lt;strong&gt;åŠ¨æ€æ‰©å®¹æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å¢é‡è¿ç§»ï¼š
&lt;ul&gt;
&lt;li&gt;æ—§æ•°ç»„åˆ†å—è¿ç§»ï¼Œé¿å…é•¿æ—¶é—´é˜»å¡ï¼›&lt;/li&gt;
&lt;li&gt;è¿ç§»æœŸé—´ï¼Œæ–°æ“ä½œåœ¨æ—§æ•°ç»„æˆ–æ–°æ•°ç»„ä¸Šå¹¶è¡Œè¿›è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¹¶å‘ååŠ©ï¼š
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ’å…¥æ—¶è‹¥å‘ç°æ¡¶å·²è¿ç§»ï¼Œç›´æ¥æ“ä½œæ–°æ•°ç»„ï¼›è‹¥æœªè¿ç§»ï¼ŒååŠ©è¿ç§»è¯¥æ¡¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¼±ä¸€è‡´æ€§è¿­ä»£å™¨"&gt;&lt;strong&gt;å¼±ä¸€è‡´æ€§è¿­ä»£å™¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éå¼ºä¸€è‡´&lt;/strong&gt;ï¼šè¿­ä»£å™¨éå†æ—¶å¯èƒ½åæ˜ éƒ¨åˆ†å¹¶å‘ä¿®æ”¹ï¼Œä½†&lt;strong&gt;ä¸æŠ›å‡º &lt;code&gt;ConcurrentModificationException&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;ï¼šåŸºäºåˆ›å»ºæ—¶çš„æ•°æ®å¿«ç…§æˆ–å½“å‰æ•°ç»„çŠ¶æ€ï¼Œä¸é”å®šæ•´ä¸ªè¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸå­å¤åˆæ–¹æ³•"&gt;&lt;strong&gt;åŸå­å¤åˆæ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æä¾›çº¿ç¨‹å®‰å…¨çš„å¤åˆæ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;putIfAbsent(key, value)&lt;/code&gt;ï¼šé”®ä¸å­˜åœ¨æ—¶æ‰æ’å…¥ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;computeIfAbsent(key, func)&lt;/code&gt;ï¼šé”®ä¸å­˜åœ¨æ—¶é€šè¿‡å‡½æ•°è®¡ç®—å€¼å¹¶æ’å…¥ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;merge(key, value, remap)&lt;/code&gt;ï¼šåˆå¹¶é”®å€¼å¯¹ï¼ˆå¦‚è®¡æ•°å™¨ç´¯åŠ ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç»Ÿè®¡ä¼˜åŒ–"&gt;&lt;strong&gt;ç»Ÿè®¡ä¼˜åŒ–ï¼ˆ&lt;code&gt;size()&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ®µè®¡æ•°&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;CounterCell[]&lt;/code&gt; åˆ†æ•£ç»Ÿè®¡ï¼Œå‡å°‘ç«äº‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿‘ä¼¼å€¼&lt;/strong&gt;ï¼šè¿”å›ç»“æœå¯èƒ½éå®æ—¶ç²¾ç¡®ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸-hashmaphashtable-çš„å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ä¸ HashMapã€Hashtable çš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ConcurrentHashMap&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;HashMap&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Hashtable&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ˜¯ï¼ˆç»†ç²’åº¦é”/CASï¼‰&lt;/td&gt;
&lt;td&gt;å¦&lt;/td&gt;
&lt;td&gt;æ˜¯ï¼ˆå…¨å±€é”ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”ç²’åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¡¶çº§åˆ«ï¼ˆJDK8+ï¼‰&lt;/td&gt;
&lt;td&gt;æ— é”&lt;/td&gt;
&lt;td&gt;æ•´ä¸ªè¡¨åŠ é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Null é”®/å€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸å…è®¸&lt;/td&gt;
&lt;td&gt;å…è®¸&lt;/td&gt;
&lt;td&gt;ä¸å…è®¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿­ä»£å™¨ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼±ä¸€è‡´æ€§&lt;/td&gt;
&lt;td&gt;å¿«é€Ÿå¤±è´¥ï¼ˆFail-Fastï¼‰&lt;/td&gt;
&lt;td&gt;å¿«é€Ÿå¤±è´¥ï¼ˆFail-Fastï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆè¯»æ— é”ï¼Œå†™ä½ç«äº‰ï¼‰&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹æœ€ä¼˜&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆå…¨å±€é”ç«äº‰ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ"&gt;ğŸ¯ &lt;strong&gt;é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;æ¨èåœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘è¯»å†™ï¼ˆå¦‚ç¼“å­˜ã€è®¡æ•°å™¨ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ›¿ä»£ &lt;code&gt;Hashtable&lt;/code&gt; æˆ–åŒæ­¥åŒ…è£…çš„ &lt;code&gt;HashMap&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è§„é¿åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;å¼ºä¸€è‡´æ€§è¿­ä»£éœ€æ±‚ï¼ˆå¦‚å®æ—¶äº¤æ˜“ç³»ç»Ÿï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å†™æé¢‘ç¹ä¸”é”®é«˜åº¦å†²çªï¼ˆçº¢é»‘æ ‘è½¬æ¢å¼€é”€å¢å¤§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®è·µå»ºè®®ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆä½¿ç”¨ JDK8+ å®ç°&lt;/strong&gt;ï¼šæ€§èƒ½æ›´é«˜ï¼Œå†…å­˜æ›´ä¼˜ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤åˆæ“ä½œä½¿ç”¨åŸå­æ–¹æ³•&lt;/strong&gt;ï¼šé¿å…é¢å¤–åŒæ­¥ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³æ³¨æ‰©å®¹æˆæœ¬&lt;/strong&gt;ï¼šåˆå§‹åŒ–æ—¶é¢„ä¼°å®¹é‡ï¼Œå‡å°‘æ‰©å®¹æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ConcurrentHashMap é€šè¿‡ &lt;strong&gt;åˆ†æ®µé” â†’ èŠ‚ç‚¹çº§é” + CAS çš„æ¼”è¿›&lt;/strong&gt;ã€&lt;strong&gt;è¯»å†™åˆ†ç¦»&lt;/strong&gt;å’Œ&lt;strong&gt;å¤šçº¿ç¨‹ååŒæ‰©å®¹&lt;/strong&gt;ï¼Œå®ç°äº†é«˜å¹¶å‘ä¸‹çš„é«˜æ€§èƒ½çº¿ç¨‹å®‰å…¨ã€‚å…¶æ ¸å¿ƒåœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é”ç²’åº¦ç»†åŒ–&lt;/strong&gt;ï¼šä»åˆ†æ®µï¼ˆJDK7ï¼‰åˆ°æ¡¶ï¼ˆJDK8+ï¼‰ï¼Œæœ€å¤§åŒ–å¹¶è¡Œåº¦ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— é”è¯» + CAS å†™&lt;/strong&gt;ï¼šå‡å°‘çº¿ç¨‹é˜»å¡ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„ä¼˜åŒ–&lt;/strong&gt;ï¼šçº¢é»‘æ ‘é˜²æ­¢å“ˆå¸Œå†²çªå¯¼è‡´çš„æ€§èƒ½é€€åŒ–ã€‚
åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œå®ƒå·²æˆä¸ºæ›¿ä»£ä¼ ç»ŸåŒæ­¥å®¹å™¨çš„é¦–é€‰ï¼Œä½†éœ€æ ¹æ®ä¸€è‡´æ€§è¦æ±‚ã€è¯»å†™æ¯”ä¾‹åˆç†é€‰å‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="copyonwritearraylistset"&gt;CopyOnWriteArrayList/Set
&lt;/h2&gt;&lt;p&gt;CopyOnWriteArrayList å’Œ CopyOnWriteArraySet æ˜¯ Java å¹¶å‘åŒ…ä¸­åŸºäº&lt;strong&gt;å†™æ—¶å¤åˆ¶ï¼ˆCopy-On-Writeï¼‰&lt;/strong&gt; æœºåˆ¶å®ç°çš„çº¿ç¨‹å®‰å…¨é›†åˆï¼Œé€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚å°½ç®¡ä¸¤è€…å…±äº«ç›¸ä¼¼çš„æ ¸å¿ƒæœºåˆ¶ï¼Œä½†åœ¨æ•°æ®ç»“æ„ã€å…ƒç´ å”¯ä¸€æ€§ã€é€‚ç”¨åœºæ™¯ç­‰æ–¹é¢å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯äºŒè€…çš„è¯¦ç»†å¯¹æ¯”åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CopyOnWriteArrayList&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CopyOnWriteArraySet&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åº•å±‚å®ç°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€æ•°ç»„ï¼ˆæ”¯æŒé‡å¤å…ƒç´ ï¼‰&lt;/td&gt;
&lt;td&gt;åŸºäº &lt;code&gt;CopyOnWriteArrayList&lt;/code&gt;ï¼ˆå…ƒç´ å”¯ä¸€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†™æ—¶å¤åˆ¶ï¼ˆä¿®æ”¹æ—¶å¤åˆ¶æ•´ä¸ªæ•°ç»„ï¼‰&lt;/td&gt;
&lt;td&gt;åŒä¸Šï¼Œç»§æ‰¿è‡ª &lt;code&gt;CopyOnWriteArrayList&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…ƒç´ å”¯ä¸€æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ å…è®¸é‡å¤å…ƒç´ &lt;/td&gt;
&lt;td&gt;âœ… è‡ªåŠ¨å»é‡ï¼ˆä¾èµ– &lt;code&gt;equals()&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»æ“ä½œæ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš¡ æé«˜ï¼ˆæ— é”ï¼Œç›´æ¥è®¿é—®æ•°ç»„ï¼‰&lt;/td&gt;
&lt;td&gt;âš¡ æé«˜ï¼ˆæ— é”ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†™æ“ä½œæ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ ä½ï¼ˆå¤åˆ¶æ•°ç»„ï¼ŒO(n) æ—¶é—´å¤æ‚åº¦ï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ æ›´ä½ï¼ˆéœ€éå†æ£€æŸ¥å…ƒç´ å”¯ä¸€æ€§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŸ¥æ‰¾æ•ˆç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… ç´¢å¼•è®¿é—® O(1)ï¼Œå†…å®¹æœç´¢ O(n)&lt;/td&gt;
&lt;td&gt;âŒ çº¿æ€§æœç´¢ O(n)ï¼ˆæ— å“ˆå¸Œä¼˜åŒ–ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿­ä»£å™¨ä¸€è‡´æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼±ä¸€è‡´æ€§ï¼ˆåŸºäºåˆ›å»ºæ—¶çš„å¿«ç…§ï¼‰&lt;/td&gt;
&lt;td&gt;å¼±ä¸€è‡´æ€§ï¼ˆåŒä¸Šï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå†™æ“ä½œå¤åˆ¶æ•´ä¸ªæ•°ç»„ï¼‰&lt;/td&gt;
&lt;td&gt;æ›´é«˜ï¼ˆå†™æ“ä½œéœ€é¢å¤–æ£€æŸ¥å”¯ä¸€æ€§ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°ä¸å…³é”®æœºåˆ¶"&gt;ğŸ” &lt;strong&gt;åº•å±‚å®ç°ä¸å…³é”®æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="copyonwritearraylist"&gt;&lt;strong&gt;CopyOnWriteArrayList&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;ï¼šåŠ¨æ€æ•°ç»„ï¼Œå…è®¸é‡å¤å…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;å†™æ“ä½œæµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;åŠ é”ï¼ˆ&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼‰ â†’ å¤åˆ¶åŸæ•°ç»„ â†’ ä¿®æ”¹æ–°æ•°ç»„ â†’ æ›¿æ¢åŸæ•°ç»„å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š&lt;code&gt;add(E e)&lt;/code&gt; ä¼šè§¦å‘å…¨æ•°ç»„å¤åˆ¶ï¼Œå†…å­˜å ç”¨ç¿»å€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯»æ“ä½œ&lt;/strong&gt;ï¼šç›´æ¥è®¿é—®å½“å‰æ•°ç»„ï¼Œæ— éœ€åŒæ­¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="copyonwritearrayset"&gt;&lt;strong&gt;CopyOnWriteArraySet&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;ï¼šå†…éƒ¨å°è£… &lt;code&gt;CopyOnWriteArrayList&lt;/code&gt;ï¼Œé€šè¿‡å…¶æ–¹æ³•å®ç°å»é‡ã€‚&lt;/li&gt;
&lt;li&gt;å”¯ä¸€æ€§ä¿è¯ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;add(E e)&lt;/code&gt; è°ƒç”¨ &lt;code&gt;CopyOnWriteArrayList.addIfAbsent(e)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ·»åŠ å‰éå†æ•°ç»„æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼ˆO(n) å¼€é”€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å†™æ“ä½œæµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;å…ˆæ£€æŸ¥å…ƒç´ å”¯ä¸€æ€§ â†’ è‹¥ä¸å­˜åœ¨åˆ™å¤åˆ¶æ•°ç»„å¹¶æ·»åŠ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸é€‚ç”¨åœºæ™¯"&gt;âš–ï¸ &lt;strong&gt;æ€§èƒ½ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ€§èƒ½å¯¹æ¯”"&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å†™æ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ArrayList&lt;/code&gt; å†™æ“ä½œä»…å¤åˆ¶æ•°ç»„ï¼ˆO(n)ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ArraySet&lt;/code&gt; å†™æ“ä½œéœ€é¢å¤–éå†æ£€æŸ¥å”¯ä¸€æ€§ï¼Œæ€§èƒ½æ›´å·®ï¼ˆO(n) éå† + O(n) å¤åˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æŸ¥æ‰¾æ“ä½œï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ArrayList&lt;/code&gt; æ”¯æŒç´¢å¼•éšæœºè®¿é—®ï¼ˆ&lt;code&gt;get(index)&lt;/code&gt; ä¸º O(1)ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ArraySet&lt;/code&gt; å¿…é¡»éå†æ•°ç»„ï¼ˆ&lt;code&gt;contains()&lt;/code&gt; ä¸º O(n)ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é€‚ç”¨åœºæ™¯"&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é›†åˆç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èåœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹ç”¨ä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CopyOnWriteArrayList&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;- è¯»å¤šå†™å°‘çš„æœ‰åºåˆ—è¡¨ - å…è®¸é‡å¤å…ƒç´ &lt;/td&gt;
&lt;td&gt;ç›‘å¬å™¨åˆ—è¡¨ã€é…ç½®ç®¡ç†ã€æ—¥å¿—ç¼“å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CopyOnWriteArraySet&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;- è¯»å¤šå†™å°‘çš„å”¯ä¸€å…ƒç´ é›†åˆ - æ— éœ€æ’åº&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·é»‘åå•ã€å”¯ä¸€æ ‡è¯†ç¬¦æ± ã€çº¿ç¨‹å®‰å…¨æ³¨å†Œè¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…±åŒç¼ºé™·"&gt;&lt;strong&gt;å…±åŒç¼ºé™·&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;ï¼šå†™æ“ä½œå¤åˆ¶å…¨æ•°ç»„ï¼Œå¤§é›†åˆæˆ–é¢‘ç¹ä¿®æ”¹æ˜“å¼•å‘å†…å­˜å‹åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å¼±ä¸€è‡´æ€§&lt;/strong&gt;ï¼šè¿­ä»£å™¨åŸºäºå¿«ç…§ï¼Œä¸åæ˜ åç»­ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé¢‘ç¹å†™æ“ä½œã€å¤§é›†åˆä¿®æ”¹ã€å¼ºä¸€è‡´æ€§éœ€æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ›¿ä»£æ–¹æ¡ˆ"&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å†™é¢‘ç¹åœºæ™¯ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;ConcurrentHashMap&lt;/code&gt;ï¼ˆé”®é›†åˆï¼‰æˆ– &lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;ï¼ˆè·³è¡¨å®ç°ï¼Œæœ‰åºä¸”é«˜å¹¶å‘ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€šç”¨çº¿ç¨‹å®‰å…¨é›†åˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Collections.synchronizedList/synchronizedSet&lt;/code&gt;ï¼ˆåŒæ­¥é”ï¼Œé€‚åˆä½é¢‘å¹¶å‘ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;CopyOnWriteArrayList&lt;/code&gt; å’Œ &lt;code&gt;CopyOnWriteArraySet&lt;/code&gt; ä»¥&lt;strong&gt;ç‰ºç‰²å†™æ€§èƒ½&lt;/strong&gt;ä¸ºä»£ä»·ï¼Œé€šè¿‡å†™æ—¶å¤åˆ¶æœºåˆ¶å®ç°&lt;strong&gt;æ— é”è¯»&lt;/strong&gt;å’Œ&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;ã€‚äºŒè€…æ ¸å¿ƒåŒºåˆ«åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;ï¼š&lt;code&gt;ArrayList&lt;/code&gt; ä¸ºåŠ¨æ€æ•°ç»„ï¼ˆå…è®¸é‡å¤ï¼‰ï¼Œ&lt;code&gt;ArraySet&lt;/code&gt; åŸºäº &lt;code&gt;ArrayList&lt;/code&gt; å°è£…å¹¶å¼ºåˆ¶å”¯ä¸€æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;ï¼š&lt;code&gt;ArraySet&lt;/code&gt; å› éœ€æ£€æŸ¥å”¯ä¸€æ€§ï¼Œå†™æ“ä½œå¼€é”€æ›´å¤§ã€‚&lt;/li&gt;
&lt;li&gt;é€‚ç”¨æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€æœ‰åºæˆ–å…è®¸é‡å¤ â†’ &lt;code&gt;ArrayList&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;éœ€å…ƒç´ å”¯ä¸€ä¸”è¯»å¤šå†™å°‘ â†’ &lt;code&gt;ArraySet&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å®é™…å»ºè®®&lt;/strong&gt;ï¼šä¼˜å…ˆè€ƒè™‘ &lt;code&gt;ConcurrentHashMap&lt;/code&gt; æˆ–è·³è¡¨é›†åˆï¼ˆå¦‚ &lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;ï¼‰ä»¥å¹³è¡¡è¯»å†™æ€§èƒ½ï¼Œä»…åœ¨&lt;strong&gt;è¯»æ“ä½œå æ¯” &amp;gt;90%&lt;/strong&gt; ä¸”&lt;strong&gt;é›†åˆè§„æ¨¡è¾ƒå°&lt;/strong&gt;æ—¶é€‰ç”¨å†™æ—¶å¤åˆ¶é›†åˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="set--çº¢é»‘æ ‘"&gt;Set &amp;amp; çº¢é»‘æ ‘
&lt;/h2&gt;&lt;p&gt;CopyOnWriteArraySeté€‰æ‹©åŸºäºåŠ¨æ€æ•°ç»„å®ç°è€Œéçº¢é»‘æ ‘ï¼Œæ ¸å¿ƒæ˜¯ä¸ºäº†åœ¨&lt;strong&gt;ç‰¹å®šå¹¶å‘åœºæ™¯ä¸‹å®ç°è¯»æ“ä½œçš„æ— é”åŒ–ä¸æè‡´æ€§èƒ½&lt;/strong&gt;ï¼Œå…¶è®¾è®¡æƒè¡¡ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒè®¾è®¡ç›®æ ‡è¯»æ€§èƒ½ä¼˜å…ˆ"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒè®¾è®¡ç›®æ ‡ï¼šè¯»æ€§èƒ½ä¼˜å…ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ— é”è¯»æ“ä½œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°ç»„å®ç°&lt;/strong&gt;ï¼šè¯»æ“ä½œç›´æ¥è®¿é—®æ•°ç»„å¼•ç”¨ï¼ˆ&lt;code&gt;volatile&lt;/code&gt;ä¿®é¥°ï¼‰ï¼Œæ— éœ€åŒæ­¥ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º &lt;code&gt;O(1)&lt;/code&gt;ï¼ˆç´¢å¼•è®¿é—®ï¼‰æˆ– &lt;code&gt;O(n)&lt;/code&gt;ï¼ˆéå†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¢é»‘æ ‘ç¼ºé™·&lt;/strong&gt;ï¼šçº¢é»‘æ ‘çš„è¯»å–éœ€éå†æ ‘ç»“æ„cO(log n)`ï¼‰ï¼Œä¸”å¹¶å‘ç¯å¢ƒä¸‹ä»éœ€CASæˆ–é”æœºåˆ¶ä¿è¯ä¸€è‡´æ€§ï¼Œæ— æ³•å®Œå…¨é¿å…ç«äº‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šç›‘å¬å™¨åˆ—è¡¨ã€é…ç½®è¡¨ç­‰&lt;strong&gt;è¯»å æ¯” &amp;gt;90%&lt;/strong&gt; çš„åœºæ™¯ï¼Œæ— é”è¯»å¯å¤§å¹…æå‡ååé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±ä¸€è‡´æ€§è¿­ä»£å™¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºæ•°ç»„å¿«ç…§çš„è¿­ä»£å™¨å½»åº•é¿å… &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ï¼Œè€Œæ ‘ç»“æ„çš„å¹¶å‘è¿­ä»£éœ€å¤æ‚çš„çŠ¶æ€ç®¡ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å†™æ“ä½œçš„ä»£ä»·ä¸å–èˆ"&gt;âš–ï¸ &lt;strong&gt;å†™æ“ä½œçš„ä»£ä»·ä¸å–èˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†™æ€§èƒ½ç‰ºç‰²&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°ç»„å¤åˆ¶å¼€é”€&lt;/strong&gt;ï¼šæ¯æ¬¡å†™æ“ä½œï¼ˆå¢åˆ ï¼‰éœ€å¤åˆ¶æ•´ä¸ªæ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;code&gt;O(n)&lt;/code&gt;ï¼Œå†…å­˜å ç”¨ç¿»å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»é‡æ•ˆç‡ä½&lt;/strong&gt;ï¼šæ·»åŠ å…ƒç´ æ—¶éœ€éå†æ•°ç»„æ£€æŸ¥å”¯ä¸€æ€§ï¼ˆ&lt;code&gt;O(n)&lt;/code&gt;ï¼‰ï¼Œè€Œçº¢é»‘æ ‘é€šè¿‡å“ˆå¸Œæˆ–æ’åºå¯ä¼˜åŒ–è‡³ &lt;code&gt;O(log n)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡å¦¥å&lt;/strong&gt;ï¼šé€šè¿‡æ¥å—å†™æ€§èƒ½æŸå¤±ï¼Œæ¢å–è¯»æ“ä½œçš„æ— é”åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€é”ç®€åŒ–å¹¶å‘æ§åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å†™æ“ä½œä½¿ç”¨å•ä¸€æŠŠ &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼Œé¿å…çº¢é»‘æ ‘æ‰€éœ€çš„ç»†ç²’åº¦é”æˆ–CASï¼ˆå¦‚ &lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;çš„è·³è¡¨å®ç°æ›´å¤æ‚ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å­˜ä¸è®¡ç®—æ•ˆç‡çš„æƒè¡¡"&gt;ğŸ“Š &lt;strong&gt;å†…å­˜ä¸è®¡ç®—æ•ˆç‡çš„æƒè¡¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å±€éƒ¨æ€§ä¼˜åŠ¿&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°ç»„è¿ç»­å­˜å‚¨æå‡CPUç¼“å­˜å‘½ä¸­ç‡ï¼Œéå†é€Ÿåº¦è¿œè¶…çº¢é»‘æ ‘çš„æŒ‡é’ˆè·³è½¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æµ‹è¡¨ç°&lt;/strong&gt;ï¼šåƒçº§å…ƒç´ å†…éå†é€Ÿåº¦å¯æ¯” &lt;code&gt;TreeSet&lt;/code&gt; å¿«5å€ä»¥ä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°å¤æ‚åº¦ä½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•°ç»„æ“ä½œä»…éœ€å¤åˆ¶ä¸æ›¿æ¢ï¼Œè€Œçº¢é»‘æ ‘çš„æ—‹è½¬ã€å†å¹³è¡¡ç­‰é€»è¾‘åœ¨å¹¶å‘ç¯å¢ƒä¸‹ææ˜“å‡ºé”™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸æ ‘ç»“æ„çš„æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”"&gt;âš¡ &lt;strong&gt;ä¸æ ‘ç»“æ„çš„æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CopyOnWriteArraySetï¼ˆæ•°ç»„ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ConcurrentSkipListSetï¼ˆè·³è¡¨ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš¡ æ— é”ï¼ŒO(1) ç´¢å¼•è®¿é—®&lt;/td&gt;
&lt;td&gt;ğŸ”’ æ— é”ä½†éœ€éå†è·³è¡¨ï¼ŒO(log n)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†™æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ å¤åˆ¶å…¨æ•°ç»„ï¼ŒO(n)&lt;/td&gt;
&lt;td&gt;âœ… æ— é”CASï¼ŒO(log n)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å†…å­˜å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš ï¸ å†™æ—¶å†…å­˜ç¿»å€&lt;/td&gt;
&lt;td&gt;âš ï¸ å¤šå±‚ç´¢å¼•ï¼Œé¢å¤–ç©ºé—´å ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»æå¤šå†™æå°‘ã€å…ƒç´ å°‘ï¼ˆ&amp;lt;1kï¼‰&lt;/td&gt;
&lt;td&gt;è¯»å†™å‡è¡¡ã€å¤§é›†åˆã€éœ€æ’åº&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…ƒç´ å°‘ï¼ˆç™¾çº§ï¼‰ä¸”è¯»é¢‘ç‡è¿œé«˜äºå†™ â†’ &lt;code&gt;CopyOnWriteArraySet&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;å…ƒç´ å¤šæˆ–å†™è¾ƒé¢‘ç¹ â†’ &lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;ï¼ˆè·³è¡¨ï¼‰æˆ– &lt;code&gt;ConcurrentHashMap&lt;/code&gt; å®ç°çš„Setã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“è®¾è®¡å“²å­¦ä¸ä¸šåŠ¡åœºæ™¯çš„å¥‘åˆ"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šè®¾è®¡å“²å­¦ä¸ä¸šåŠ¡åœºæ™¯çš„å¥‘åˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;CopyOnWriteArraySet æ˜¯ &lt;strong&gt;â€œä»¥ç©ºé—´æ¢æ—¶é—´+ä»¥å†™æ¢è¯»â€&lt;/strong&gt; çš„ç»å…¸å®è·µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æç«¯ä¼˜åŒ–è¯»è·¯å¾„&lt;/strong&gt;ï¼šé€šè¿‡å†™æ—¶å¤åˆ¶å’Œæ•°ç»„ç»“æ„ï¼Œå°†è¯»æ€§èƒ½æ¨å‘æè‡´ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸šåŠ¡åœºæ™¯é™å®š&lt;/strong&gt;ï¼šä»…é€‚ç”¨äº&lt;strong&gt;ä½é¢‘å†™ã€é«˜é¢‘è¯»ã€æ•°æ®è§„æ¨¡å°&lt;/strong&gt;çš„å¹¶å‘åœºæ™¯ï¼ˆå¦‚äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§„é¿æ ‘ç»“æ„å¤æ‚æ€§&lt;/strong&gt;ï¼šç®€åŒ–çº¿ç¨‹å®‰å…¨è®¾è®¡ï¼Œé¿å…çº¢é»‘æ ‘åœ¨å¹¶å‘ä¸‹çš„ç»´æŠ¤æˆæœ¬ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;è‹¥éœ€å¹³è¡¡è¯»å†™æ€§èƒ½ï¼Œå¯è½¬å‘ &lt;code&gt;ConcurrentSkipListSet&lt;/code&gt;ï¼Œå®ƒåœ¨è·³è¡¨åŸºç¡€ä¸Šå®ç°äº†æ— é”å¹¶å‘ï¼Œä½†ç‰ºç‰²äº†éƒ¨åˆ†å†…å­˜å’Œè¯»æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="è·³è¡¨"&gt;è·³è¡¨
&lt;/h2&gt;&lt;p&gt;è·³è¡¨ï¼ˆSkip Listï¼‰æ˜¯ä¸€ç§åŸºäºå¤šå±‚æœ‰åºé“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡&lt;strong&gt;ç©ºé—´æ¢æ—¶é—´&lt;/strong&gt;çš„ç­–ç•¥æå‡æŸ¥è¯¢æ•ˆç‡ï¼Œå®ç°è¿‘ä¼¼å¹³è¡¡æ ‘ï¼ˆå¦‚çº¢é»‘æ ‘ï¼‰çš„æ€§èƒ½ï¼Œä½†å®ç°æ›´ç®€å•ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒåŸç†ã€è®¾è®¡åŠåº”ç”¨çš„è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åŸºæœ¬æ¦‚å¿µä¸è®¾è®¡ç›®æ ‡"&gt;âš™ï¸ &lt;strong&gt;åŸºæœ¬æ¦‚å¿µä¸è®¾è®¡ç›®æ ‡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€æƒ³&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜èƒŒæ™¯&lt;/strong&gt;ï¼šä¼ ç»Ÿæœ‰åºé“¾è¡¨çš„æŸ¥æ‰¾éœ€éå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡å»ºç«‹å¤šçº§ç´¢å¼•ï¼Œå°†æŸ¥æ‰¾è·¯å¾„â€œè·³è·ƒå¼â€ç¼©çŸ­ã€‚
&lt;ul&gt;
&lt;li&gt;åº•å±‚ï¼ˆLevel 0ï¼‰ä¸ºå®Œæ•´æœ‰åºé“¾è¡¨ï¼›&lt;/li&gt;
&lt;li&gt;ä¸Šå±‚ç´¢å¼•ï¼ˆLevel 1, 2, &amp;hellip;ï¼‰æ˜¯ä¸‹å±‚çš„å­é›†ï¼ŒèŠ‚ç‚¹æ•°é€å±‚å‡åŠã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›®æ ‡&lt;/strong&gt;ï¼šå°†æŸ¥æ‰¾å¤æ‚åº¦ä¼˜åŒ–è‡³ O(log n)ï¼Œæ¥è¿‘äºŒåˆ†æŸ¥æ‰¾çš„æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹ç»“æ„ï¼š
&lt;ul&gt;
&lt;li&gt;å€¼ï¼ˆKeyï¼‰ã€æŒ‡é’ˆæ•°ç»„ï¼ˆæŒ‡å‘åŒå±‚ä¸‹ä¸€èŠ‚ç‚¹ï¼‰ã€å±‚æ•°ï¼ˆéšæœºç”Ÿæˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š&lt;code&gt;Head â†’ 8 â†’ 15 â†’ NULL&lt;/code&gt;ï¼ˆL2å±‚ï¼‰ï¼Œ&lt;code&gt;Head â†’ 3 â†’ 8 â†’ 15 â†’ NULL&lt;/code&gt;ï¼ˆL1å±‚ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç´¢å¼•ç”Ÿæˆè§„åˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;æ–°èŠ‚ç‚¹æ’å…¥æ—¶ï¼Œéšæœºç”Ÿæˆå±‚æ•°ï¼ˆå¦‚æŠ›ç¡¬å¸ï¼š50%æ¦‚ç‡å‡åˆ°ä¸‹ä¸€å±‚ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é«˜å±‚ç´¢å¼•èŠ‚ç‚¹æ•° â‰ˆ n/(2^k)ï¼ˆnä¸ºåº•å±‚èŠ‚ç‚¹æ•°ï¼Œkä¸ºå±‚æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ“ä½œæµç¨‹"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒæ“ä½œæµç¨‹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥æ‰¾ï¼ˆSearchï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ­¥éª¤ï¼š
&lt;ol&gt;
&lt;li&gt;ä»æœ€é«˜å±‚å¤´èŠ‚ç‚¹å¼€å§‹å‘å³éå†ï¼Œç›´è‡³å½“å‰èŠ‚ç‚¹å€¼ â‰¥ ç›®æ ‡å€¼ï¼›&lt;/li&gt;
&lt;li&gt;è‹¥æœªå‘½ä¸­åˆ™å‘ä¸‹ä¸€å±‚ç»§ç»­ï¼Œç›´åˆ°åº•å±‚ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;ï¼šå¹³å‡ O(log n)ï¼Œæœ€å O(n)ï¼ˆæ¦‚ç‡æä½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šæŸ¥æ‰¾å€¼ &lt;code&gt;7&lt;/code&gt;ï¼Œè·¯å¾„ï¼š&lt;code&gt;Head(L2)â†’5â†’NULL&lt;/code&gt; â†’ é™è‡³L1â†’&lt;code&gt;5â†’7&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’å…¥ï¼ˆInsertï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ­¥éª¤ï¼š
&lt;ol&gt;
&lt;li&gt;æŸ¥æ‰¾æ’å…¥ä½ç½®ï¼Œè®°å½•æ¯å±‚çš„å‰é©±èŠ‚ç‚¹ï¼›&lt;/li&gt;
&lt;li&gt;éšæœºç”Ÿæˆæ–°èŠ‚ç‚¹å±‚æ•° kï¼›&lt;/li&gt;
&lt;li&gt;åˆ›å»ºæ–°èŠ‚ç‚¹ï¼Œæ›´æ–° k å±‚å†…çš„æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;ï¼šå¹³å‡ O(log n)ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€å¹³è¡¡&lt;/strong&gt;ï¼šéšæœºå±‚æ•°é˜²æ­¢ç´¢å¼•é€€åŒ–ï¼ˆå¦‚è¿ç»­æ’å…¥å¯¼è‡´ç´¢å¼•é—´éš”è¿‡å¤§ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ é™¤ï¼ˆDeleteï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ­¥éª¤ï¼š
&lt;ol&gt;
&lt;li&gt;æŸ¥æ‰¾ç›®æ ‡èŠ‚ç‚¹ï¼Œè®°å½•è·¯å¾„ï¼›&lt;/li&gt;
&lt;li&gt;é€å±‚ç§»é™¤èŠ‚ç‚¹æŒ‡é’ˆï¼Œé‡Šæ”¾å†…å­˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;ï¼šå¹³å‡ O(log n)ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¸ä¼˜ç¼ºç‚¹åˆ†æ"&gt;âš–ï¸ &lt;strong&gt;æ€§èƒ½ä¸ä¼˜ç¼ºç‚¹åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è·³è¡¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;çº¢é»‘æ ‘&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥æ‰¾/æ’å…¥/åˆ é™¤å‡ä¸º O(log n)ï¼ˆå¹³å‡ï¼‰&lt;/td&gt;
&lt;td&gt;ç›¸åŒï¼Œä½†éœ€å¤æ‚æ—‹è½¬ç»´æŠ¤å¹³è¡¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç©ºé—´å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ï¼ˆå¤šçº§æŒ‡é’ˆï¼Œç©ºé—´å¤æ‚åº¦ O(n)ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒä½ï¼ˆä»…å·¦å³å­èŠ‚ç‚¹æŒ‡é’ˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°éš¾åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­ ç®€å•ï¼ˆæ— éœ€æ—‹è½¬ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­ å¤æ‚ï¼ˆéœ€å¤„ç†é¢œè‰²å’Œæ—‹è½¬ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âš¡ é«˜æ•ˆï¼ˆç›´æ¥éå†åº•å±‚é“¾è¡¨ï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ ä½æ•ˆï¼ˆéœ€ä¸­åºéå†ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¹¶å‘æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ˜“å®ç°æ— é”ï¼ˆå¦‚ CASï¼‰&lt;/td&gt;
&lt;td&gt;âŒ éœ€é”æˆ–å¤æ‚æ— é”ç»“æ„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;å®ç°ç®€å•ï¼Œè°ƒè¯•æˆæœ¬ä½ï¼›&lt;/li&gt;
&lt;li&gt;å¤©ç„¶æ”¯æŒé«˜æ•ˆèŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚éå†åŒºé—´å€¼ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ˜“äºæ‰©å±•ä¸ºå¹¶å‘ç‰ˆæœ¬ï¼ˆå¦‚ Java çš„ &lt;code&gt;ConcurrentSkipListMap&lt;/code&gt;ï¼‰ã€‚
&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;ç©ºé—´å ç”¨è¾ƒé«˜ï¼ˆå­˜å‚¨å¤šçº§ç´¢å¼•ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ä¾èµ–éšæœºæ€§ï¼Œæç«¯æƒ…å†µä¸‹å¯èƒ½é€€åŒ–æˆé“¾è¡¨ï¼ˆæ¦‚ç‡æä½ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯"&gt;ğŸŒ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“ä¸ç¼“å­˜ç³»ç»Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redis æœ‰åºé›†åˆï¼ˆZSETï¼‰&lt;/strong&gt;ï¼šè·³è¡¨å®ç°æŒ‰åˆ†å€¼æ’åºçš„æˆå‘˜æŸ¥è¯¢ï¼Œæ”¯æŒ O(log n) çš„æ’å…¥ã€åˆ é™¤å’ŒèŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚ &lt;code&gt;ZRANGE&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LevelDB/RocksDB&lt;/strong&gt;ï¼šè·³è¡¨ç”¨äºå†…å­˜è¡¨ï¼ˆMemTableï¼‰ï¼ŒåŠ é€Ÿé”®å€¼å†™å…¥ä¸æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœç´¢å¼•æ“ä¸å¤§æ•°æ®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Apache Lucene&lt;/strong&gt;ï¼šè·³è¡¨ä¼˜åŒ–æ–‡æ¡£ ID é›†åˆçš„å¿«é€ŸæŸ¥æ‰¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£å¹³è¡¡æ ‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;éœ€ç»´æŠ¤æœ‰åºæ•°æ®ä½†å¸Œæœ›é¿å…å¤æ‚å¹³è¡¡æ“ä½œçš„åœºæ™¯ï¼ˆå¦‚é«˜é¢‘å†™å…¥çš„æ—¥å¿—ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;è·³è¡¨é€šè¿‡&lt;strong&gt;éšæœºå¤šå±‚ç´¢å¼•&lt;/strong&gt;å’Œ&lt;strong&gt;ç©ºé—´æ¢æ—¶é—´&lt;/strong&gt;ç­–ç•¥ï¼Œä»¥ç®€æ´çš„å®ç°è¾¾åˆ°äº†ä¸å¹³è¡¡æ ‘ç›¸å½“çš„æŸ¥è¯¢æ•ˆç‡ï¼ˆO(log n)ï¼‰ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¹³è¡¡å¤æ‚åº¦&lt;/strong&gt;ï¼šé¿å…çº¢é»‘æ ‘ç­‰ç»“æ„çš„å¤æ‚æ—‹è½¬æ“ä½œï¼Œé™ä½å®ç°é—¨æ§›ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§å¼º&lt;/strong&gt;ï¼šå¤©ç„¶æ”¯æŒèŒƒå›´æŸ¥è¯¢å’Œå¹¶å‘ä¼˜åŒ–ï¼Œé€‚åˆç°ä»£é«˜å¹¶å‘ç³»ç»Ÿï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ç»´æŠ¤&lt;/strong&gt;ï¼šéšæœºå±‚æ•°ç”Ÿæˆç¡®ä¿ç´¢å¼•å‡åŒ€åˆ†å¸ƒï¼Œé˜²æ­¢æ€§èƒ½é€€åŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‚ç”¨å»ºè®®&lt;/strong&gt;ï¼šåœ¨éœ€è¦é«˜æ•ˆèŒƒå›´æŸ¥è¯¢ã€å¹¶å‘è®¿é—®æˆ–å¿«é€ŸåŸå‹å¼€å‘çš„åœºæ™¯ä¸­ï¼Œè·³è¡¨æ˜¯æ¯”å¹³è¡¡æ ‘æ›´ä¼˜çš„é€‰æ‹©ï¼›è‹¥å¯¹å†…å­˜æ•æ„Ÿæˆ–éœ€ç»å¯¹ç¨³å®šæ€§ï¼Œå¯æƒè¡¡é€‰æ‹©å…¶ä»–ç»“æ„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="blockingqueue"&gt;BlockingQueue
&lt;/h2&gt;&lt;p&gt;BlockingQueue æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent&lt;/code&gt;ï¼‰ä¸­ç”¨äº&lt;strong&gt;è§£å†³ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜&lt;/strong&gt;çš„æ ¸å¿ƒçº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ï¼Œé€šè¿‡å†…ç½®çš„é˜»å¡æœºåˆ¶å®ç°çº¿ç¨‹é—´é«˜æ•ˆåä½œã€‚ä»¥ä¸‹ä»åŸç†ã€å®ç°ã€åº”ç”¨åŠé€‰å‹è§’åº¦å…¨é¢è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸ç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é˜»å¡æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é˜Ÿåˆ—æ»¡æ—¶&lt;/strong&gt;ï¼šç”Ÿäº§è€…çº¿ç¨‹æ’å…¥æ“ä½œï¼ˆå¦‚ &lt;code&gt;put()&lt;/code&gt;ï¼‰ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—æœ‰ç©ºä½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜Ÿåˆ—ç©ºæ—¶&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…çº¿ç¨‹å–å‡ºæ“ä½œï¼ˆå¦‚ &lt;code&gt;take()&lt;/code&gt;ï¼‰ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—æœ‰æ–°å…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;ï¼šæä¾› &lt;code&gt;offer(e, timeout, unit)&lt;/code&gt; å’Œ &lt;code&gt;poll(timeout, unit)&lt;/code&gt; æ–¹æ³•ï¼Œæ”¯æŒé™æ—¶é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨å®ç°&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é”ä¸æ¡ä»¶å˜é‡ï¼šåŸºäº ReentrantLock å’Œ Conditionï¼ˆå¦‚ notEmptyï¼ŒnotFullï¼‰å®ç°åŒæ­¥ã€‚
&lt;ul&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š&lt;code&gt;ArrayBlockingQueue&lt;/code&gt; ä½¿ç”¨ä¸€ä¸ªé”æ§åˆ¶è¯»å†™ï¼Œ&lt;code&gt;LinkedBlockingQueue&lt;/code&gt; é‡‡ç”¨åˆ†ç¦»é”ï¼ˆ&lt;code&gt;putLock&lt;/code&gt;å’Œ &lt;code&gt;takeLock&lt;/code&gt;ï¼‰æå‡ååé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å¯è§æ€§&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;volatile&lt;/code&gt; å˜é‡ä¿è¯å¤šçº¿ç¨‹ä¸‹çŠ¶æ€çš„å¯è§æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„ä¸è¾¹ç•Œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ‰ç•Œé˜Ÿåˆ—&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ï¼‰ï¼šéœ€æŒ‡å®šå›ºå®šå®¹é‡ï¼Œé¿å…å†…å­˜æº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ç•Œé˜Ÿåˆ—&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼‰ï¼šé»˜è®¤å®¹é‡ä¸º &lt;code&gt;Integer.MAX_VALUE&lt;/code&gt;ï¼Œå¯èƒ½å¼•å‘å†…å­˜é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹æ®Šé˜Ÿåˆ—&lt;/strong&gt;ï¼š&lt;code&gt;SynchronousQueue&lt;/code&gt; æ— å®¹é‡ï¼Œç”Ÿäº§æ¶ˆè´¹å¿…é¡»ä¸€ä¸€åŒ¹é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»è¦å®ç°ç±»åŠé€‚ç”¨åœºæ™¯"&gt;ğŸ“¦ &lt;strong&gt;ä¸»è¦å®ç°ç±»åŠé€‚ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å®ç°ç±»&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¾¹ç•Œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ArrayBlockingQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°ç»„&lt;/td&gt;
&lt;td&gt;æœ‰ç•Œ&lt;/td&gt;
&lt;td&gt;è¯»å†™å…±ç”¨ä¸€æŠŠé”ï¼Œå…¬å¹³é”å¯é€‰ï¼›å†…å­˜å ç”¨ä½ä½†ååé‡è¾ƒä½ã€‚&lt;/td&gt;
&lt;td&gt;æµé‡æ§åˆ¶ã€ä½é¢‘æ•°æ®åŒæ­¥ï¼ˆå¦‚ç»„ç»‡æ¶æ„å˜æ›´ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;LinkedBlockingQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é“¾è¡¨&lt;/td&gt;
&lt;td&gt;å¯é€‰æœ‰ç•Œ&lt;/td&gt;
&lt;td&gt;è¯»å†™åˆ†ç¦»é”ï¼Œé«˜å¹¶å‘ååé‡ä¼˜ï¼›é¢‘ç¹å¢åˆ æ˜“è§¦å‘GCã€‚&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘æ¶ˆæ¯ç¼“å†²ï¼ˆå¦‚è®¢å•é€šçŸ¥ç³»ç»Ÿï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;PriorityBlockingQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å †ï¼ˆæ•°ç»„å®ç°ï¼‰&lt;/td&gt;
&lt;td&gt;æ— ç•Œ&lt;/td&gt;
&lt;td&gt;æŒ‰ä¼˜å…ˆçº§æ’åºï¼ˆéœ€å®ç° &lt;code&gt;Comparable&lt;/code&gt;ï¼‰ï¼Œä¸ä¿è¯FIFOã€‚&lt;/td&gt;
&lt;td&gt;VIPä»»åŠ¡è°ƒåº¦ã€ç´§æ€¥äº‹ä»¶å¤„ç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;DelayQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼˜å…ˆçº§å †&lt;/td&gt;
&lt;td&gt;æ— ç•Œ&lt;/td&gt;
&lt;td&gt;å…ƒç´ éœ€å®ç° &lt;code&gt;Delayed&lt;/code&gt; æ¥å£ï¼Œåˆ°æœŸæ‰èƒ½å–å‡ºã€‚&lt;/td&gt;
&lt;td&gt;è®¢å•è¶…æ—¶å–æ¶ˆã€å®šæ—¶ä»»åŠ¡è°ƒåº¦ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;SynchronousQueue&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— å­˜å‚¨&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;ç›´æ¥ä¼ é€’æ•°æ®ï¼Œç”Ÿäº§è€…éœ€ç­‰å¾…æ¶ˆè´¹è€…æ¥æ‰‹ã€‚&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹æ± ä»»åŠ¡è°ƒåº¦ï¼ˆå¦‚ &lt;code&gt;newCachedThreadPool&lt;/code&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒapiä¸æ“ä½œè¡Œä¸º"&gt;âš¡ &lt;strong&gt;æ ¸å¿ƒAPIä¸æ“ä½œè¡Œä¸º&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;BlockingQueue æä¾›å››ç±»æ“ä½œç­–ç•¥ï¼Œåº”å¯¹ä¸åŒéœ€æ±‚ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ’å…¥æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç§»é™¤æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œä¸ºè¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŠ›å‡ºå¼‚å¸¸&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;add(e)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;remove()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—æ»¡/ç©ºæ—¶æŠ›å‡º &lt;code&gt;IllegalStateException&lt;/code&gt; æˆ– &lt;code&gt;NoSuchElementException&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›ç‰¹æ®Šå€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;offer(e)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;poll()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—æ»¡/ç©ºæ—¶è¿”å› &lt;code&gt;false&lt;/code&gt; æˆ– &lt;code&gt;null&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ°¸ä¹…é˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;put(e)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;take()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—æ»¡/ç©ºæ—¶æ— é™æœŸé˜»å¡ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¶…æ—¶é˜»å¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;offer(e, timeout, unit)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;poll(timeout, unit)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜»å¡æŒ‡å®šæ—¶é—´ï¼Œè¶…æ—¶è¿”å› &lt;code&gt;false&lt;/code&gt; æˆ– &lt;code&gt;null&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éç©ºçº¦æŸ&lt;/strong&gt;ï¼šæ‰€æœ‰å®ç°ç±»ç¦æ­¢æ’å…¥ &lt;code&gt;null&lt;/code&gt; å€¼ï¼ˆ&lt;code&gt;null&lt;/code&gt; ç”¨äºè¡¨ç¤ºæ“ä½œå¤±è´¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±ä¸€è‡´æ€§è¿­ä»£å™¨&lt;/strong&gt;ï¼šè¿­ä»£æ—¶å¯èƒ½åæ˜ éƒ¨åˆ†å¹¶å‘ä¿®æ”¹ï¼Œä¸æŠ› &lt;code&gt;ConcurrentModificationException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å®é™…åº”ç”¨åœºæ™¯"&gt;ğŸ› ï¸ &lt;strong&gt;å®é™…åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;BlockingQueue&amp;lt;Integer&amp;gt; queue = new ArrayBlockingQueue&amp;lt;&amp;gt;(10);
// ç”Ÿäº§è€…
new Thread(() -&amp;gt; {
while (true) queue.put(produceItem()); // é˜Ÿåˆ—æ»¡æ—¶è‡ªåŠ¨é˜»å¡
}).start();
// æ¶ˆè´¹è€…
new Thread(() -&amp;gt; {
while (true) consumeItem(queue.take()); // é˜Ÿåˆ—ç©ºæ—¶è‡ªåŠ¨é˜»å¡
}).start();
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šè‡ªåŠ¨åè°ƒç”Ÿäº§æ¶ˆè´¹é€Ÿç‡å·®å¼‚ï¼Œé¿å…å¿™ç­‰å¾…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ± é…ç½®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ExecutorService pool = new ThreadPoolExecutor(
2, 4, 60, TimeUnit.SECONDS,
new LinkedBlockingQueue&amp;lt;&amp;gt;(100) // ä»»åŠ¡ç¼“å†²é˜Ÿåˆ—
);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;ï¼šå½“æ ¸å¿ƒçº¿ç¨‹å¿™æ—¶ï¼Œæ–°ä»»åŠ¡è¿›å…¥é˜»å¡é˜Ÿåˆ—ï¼›é˜Ÿåˆ—æ»¡æ—¶è§¦å‘éæ ¸å¿ƒçº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥æ¶ˆæ¯å¤„ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿä»»åŠ¡&lt;/strong&gt;ï¼š&lt;code&gt;DelayQueue&lt;/code&gt; å¤„ç†è®¢å•è¶…æ—¶å–æ¶ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆçº§è°ƒåº¦&lt;/strong&gt;ï¼š&lt;code&gt;PriorityBlockingQueue&lt;/code&gt; å®ç°VIPæ’é˜Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é€‰å‹å»ºè®®ä¸æ€§èƒ½è€ƒé‡"&gt;âš–ï¸ &lt;strong&gt;é€‰å‹å»ºè®®ä¸æ€§èƒ½è€ƒé‡&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èå®ç°ç±»&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç†ç”±&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å›ºå®šå®¹é‡+å†…å­˜æ•æ„Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ArrayBlockingQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ•°ç»„ç»“æ„å†…å­˜ç´§å‡‘ï¼Œé¿å…GCå‹åŠ›ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜ååé‡+å¤§å¹¶å‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LinkedBlockingQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¯»å†™åˆ†ç¦»é”æ”¯æŒç”Ÿäº§æ¶ˆè´¹å¹¶è¡Œæ“ä½œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»»åŠ¡æŒ‰ä¼˜å…ˆçº§æ‰§è¡Œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PriorityBlockingQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åŠ¨æ€æ’åºä¿éšœé«˜ä¼˜å…ˆçº§ä»»åŠ¡ä¼˜å…ˆå¤„ç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®æ—¶ä»»åŠ¡ä¼ é€’ï¼ˆæ— ç¼“å†²ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SynchronousQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é¿å…ä»»åŠ¡ç§¯å‹ï¼Œç”Ÿäº§è€…ç›´æ¥å¯¹æ¥æ¶ˆè´¹è€…ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é¿å‘æŒ‡å—&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— ç•Œé˜Ÿåˆ—é£é™©&lt;/strong&gt;ï¼š&lt;code&gt;LinkedBlockingQueue&lt;/code&gt; æœªæŒ‡å®šå®¹é‡æ—¶ï¼Œå¯èƒ½å› æ¶ˆè´¹æ»åå¯¼è‡´å†…å­˜æº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ååé‡æƒè¡¡&lt;/strong&gt;ï¼š&lt;code&gt;ArrayBlockingQueue&lt;/code&gt; çš„å•é”è®¾è®¡åœ¨æé«˜å¹¶å‘ä¸‹å¯èƒ½æˆä¸ºç“¶é¢ˆï¼Œæ­¤æ—¶é€‰ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼šåˆ†å¸ƒå¼åœºæ™¯å¯ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚ Kafkaã€RocketMQï¼‰ï¼Œä½†å•æœºåº”ç”¨ BlockingQueue æ›´è½»é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;BlockingQueue é€šè¿‡&lt;strong&gt;é˜»å¡æœºåˆ¶+é”åˆ†ç¦»è®¾è®¡&lt;/strong&gt;ï¼Œæˆä¸ºè§£å†³çº¿ç¨‹åä½œé—®é¢˜çš„æ ‡å‡†å·¥å…·ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šç®€åŒ–ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹çš„åŒæ­¥é€»è¾‘ï¼Œé¿å…æ‰‹åŠ¨é”æ§åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å…³é”®&lt;/strong&gt;ï¼šæ ¹æ®æ•°æ®é‡ã€ååéœ€æ±‚ã€ä¼˜å…ˆçº§ç­–ç•¥é€‰æ‹©åŒ¹é…çš„å®ç°ç±»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼”è¿›è¶‹åŠ¿&lt;/strong&gt;ï¼šJDK åç»­æ–°å¢äº† &lt;code&gt;LinkedTransferQueue&lt;/code&gt;ï¼ˆæ··åˆæ¨¡å¼ï¼‰å’Œ &lt;code&gt;LinkedBlockingDeque&lt;/code&gt;ï¼ˆåŒå‘æ“ä½œï¼‰ï¼Œè¿›ä¸€æ­¥æ‰©å±•é€‚ç”¨åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…å¼€å‘ä¸­ï¼Œ&lt;strong&gt;ä¼˜å…ˆè¯„ä¼°é˜Ÿåˆ—å®¹é‡ä¸çº¿ç¨‹ç«äº‰å¼ºåº¦&lt;/strong&gt;ï¼Œç»“åˆä¸šåŠ¡ç‰¹æ€§ï¼ˆå¦‚æ˜¯å¦éœ€è¦ä¼˜å…ˆçº§/å»¶è¿Ÿï¼‰é€‰æ‹©å®ç°ç±»ï¼Œå¹¶å–„ç”¨è¶…æ—¶APIé¿å…çº¿ç¨‹æ°¸ä¹…é˜»å¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="arrayblockingqueue"&gt;ArrayBlockingQueue
&lt;/h2&gt;&lt;p&gt;ArrayBlockingQueue æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent&lt;/code&gt;ï¼‰ä¸­åŸºäº&lt;strong&gt;æ•°ç»„å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—&lt;/strong&gt;ï¼Œä¸“ä¸ºç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹è®¾è®¡ã€‚å®ƒé€šè¿‡&lt;strong&gt;é”æœºåˆ¶å’Œæ¡ä»¶å˜é‡&lt;/strong&gt;å®ç°çº¿ç¨‹å®‰å…¨ï¼Œå¹¶åœ¨é˜Ÿåˆ—æ»¡/ç©ºæ—¶è‡ªåŠ¨é˜»å¡çº¿ç¨‹ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€å®ç°æœºåˆ¶ã€åº”ç”¨åœºæ™¯åŠä¼˜åŒ–ç­–ç•¥å±•å¼€æ·±å…¥åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ‰ç•Œæ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºæ—¶å¿…é¡»æŒ‡å®šå›ºå®šå®¹é‡ï¼ˆå¦‚ &lt;code&gt;new ArrayBlockingQueue&amp;lt;&amp;gt;(10)&lt;/code&gt;ï¼‰ï¼Œä¸€æ—¦æ»¡å‘˜ï¼Œåç»­æ’å…¥æ“ä½œä¼šè¢«é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é‡ä¸å¯å˜&lt;/strong&gt;ï¼šæ— æ³•åŠ¨æ€æ‰©å®¹ï¼Œéœ€åˆå§‹åŒ–æ—¶åˆç†é¢„ä¼°éœ€æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨ä¸é˜»å¡æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é”æ§åˆ¶&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;ReentrantLock&lt;/code&gt; ä¿è¯æ“ä½œåŸå­æ€§ï¼Œç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…&lt;strong&gt;å…±ç”¨åŒä¸€æŠŠé”&lt;/strong&gt;ï¼ˆéåˆ†ç¦»é”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¡ä»¶å˜é‡ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;notEmpty&lt;/code&gt;ï¼šé˜Ÿåˆ—ç©ºæ—¶é˜»å¡æ¶ˆè´¹è€…çº¿ç¨‹ï¼ˆ&lt;code&gt;take()&lt;/code&gt; ç­‰å¾…ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;notFull&lt;/code&gt;ï¼šé˜Ÿåˆ—æ»¡æ—¶é˜»å¡ç”Ÿäº§è€…çº¿ç¨‹ï¼ˆ&lt;code&gt;put()&lt;/code&gt; ç­‰å¾…ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¹³æ€§å¯é€‰&lt;/strong&gt;ï¼šæ„é€ å‡½æ•°æ”¯æŒå…¬å¹³é”ï¼ˆ&lt;code&gt;fair=true&lt;/code&gt;ï¼‰ï¼Œä¿éšœçº¿ç¨‹æŒ‰ç­‰å¾…é¡ºåºæ‰§è¡Œï¼Œé¿å…é¥¥é¥¿ï¼ˆé»˜è®¤éå…¬å¹³é”ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¾ªç¯æ•°ç»„&lt;/strong&gt;ï¼šåº•å±‚ä¸º &lt;code&gt;Object[] items&lt;/code&gt;ï¼Œé€šè¿‡ &lt;code&gt;takeIndex&lt;/code&gt;ï¼ˆå‡ºé˜Ÿä½ç½®ï¼‰å’Œ &lt;code&gt;putIndex&lt;/code&gt;ï¼ˆå…¥é˜Ÿä½ç½®ï¼‰å®ç° FIFO å¾ªç¯é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ƒç´ éç©º&lt;/strong&gt;ï¼šç¦æ­¢æ’å…¥ &lt;code&gt;null&lt;/code&gt;ï¼Œå›  &lt;code&gt;null&lt;/code&gt; ç”¨äºæ ‡è¯†æ“ä½œå¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ“ä½œä¸æºç æœºåˆ¶"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒæ“ä½œä¸æºç æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…¥é˜Ÿæ“ä½œ"&gt;&lt;strong&gt;å…¥é˜Ÿæ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œä¸º&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;add(e)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è°ƒç”¨ &lt;code&gt;offer(e)&lt;/code&gt;ï¼ŒæˆåŠŸè¿”å› &lt;code&gt;true&lt;/code&gt;ï¼›é˜Ÿåˆ—æ»¡æ—¶æŠ› &lt;code&gt;IllegalStateException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;éœ€å¿«é€Ÿå¤±è´¥éªŒè¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;offer(e)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—æœªæ»¡æ—¶æ’å…¥å¹¶è¿”å› &lt;code&gt;true&lt;/code&gt;ï¼›æ»¡æ—¶ç›´æ¥è¿”å› &lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;éé˜»å¡å°è¯•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;put(e)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—æ»¡æ—¶é˜»å¡çº¿ç¨‹ï¼Œç›´åˆ°æœ‰ç©ºä½æˆ–çº¿ç¨‹è¢«ä¸­æ–­&lt;/td&gt;
&lt;td&gt;éœ€æŒä¹…åŒ–æäº¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;offer(e, timeout, unit)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—æ»¡æ—¶é˜»å¡æŒ‡å®šæ—¶é—´ï¼Œè¶…æ—¶è¿”å› &lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é™æ—¶ç­‰å¾…åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æºç å…³é”®é€»è¾‘&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public void put(E e) throws InterruptedException {
checkNotNull(e);
final ReentrantLock lock = this.lock;
lock.lockInterruptibly();
try {
while (count == items.length) // é˜Ÿåˆ—æ»¡æ—¶å¾ªç¯æ£€æŸ¥
notFull.await(); // é˜»å¡åœ¨ notFull æ¡ä»¶
enqueue(e); // å…¥é˜Ÿå¹¶å”¤é†’ notEmpty
} finally {
lock.unlock();
}
}
private void enqueue(E x) {
items[putIndex] = x;
putIndex = (putIndex + 1 == items.length) ? 0 : putIndex + 1; // å¾ªç¯æ•°ç»„
count++;
notEmpty.signal(); // å”¤é†’ç­‰å¾…çš„æ¶ˆè´¹è€…
}
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="å‡ºé˜Ÿæ“ä½œ"&gt;&lt;strong&gt;å‡ºé˜Ÿæ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¡Œä¸º&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;poll()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—éç©ºæ—¶è¿”å›é˜Ÿé¦–å…ƒç´ ï¼›ç©ºæ—¶è¿”å› &lt;code&gt;null&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;éé˜»å¡å°è¯•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;take()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—ç©ºæ—¶é˜»å¡çº¿ç¨‹ï¼Œç›´åˆ°æ–°å…ƒç´ åŠ å…¥æˆ–çº¿ç¨‹ä¸­æ–­&lt;/td&gt;
&lt;td&gt;æŒä¹…åŒ–æ¶ˆè´¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;poll(timeout, unit)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é˜Ÿåˆ—ç©ºæ—¶é˜»å¡æŒ‡å®šæ—¶é—´ï¼Œè¶…æ—¶è¿”å› &lt;code&gt;null&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é™æ—¶ç­‰å¾…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;peek()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿”å›é˜Ÿé¦–å…ƒç´ ä½†ä¸ç§»é™¤ï¼ˆæ— é˜»å¡ï¼‰&lt;/td&gt;
&lt;td&gt;ä»…æŸ¥çœ‹é˜Ÿé¦–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æºç å…³é”®é€»è¾‘&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;public E take() throws InterruptedException {
final ReentrantLock lock = this.lock;
lock.lockInterruptibly();
try {
while (count == 0) // é˜Ÿåˆ—ç©ºæ—¶å¾ªç¯æ£€æŸ¥
notEmpty.await(); // é˜»å¡åœ¨ notEmpty æ¡ä»¶
return dequeue(); // å‡ºé˜Ÿå¹¶å”¤é†’ notFull
} finally {
lock.unlock();
}
}
private E dequeue() {
E x = (E) items[takeIndex];
items[takeIndex] = null; // é‡Šæ”¾å¼•ç”¨ï¼Œé¿å…å†…å­˜æ³„æ¼
takeIndex = (takeIndex + 1 == items.length) ? 0 : takeIndex + 1;
count--;
notFull.signal(); // å”¤é†’ç­‰å¾…çš„ç”Ÿäº§è€…
return x;
}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ-1"&gt;âš–ï¸ &lt;strong&gt;é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…¸å‹åº”ç”¨åœºæ™¯"&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹&lt;/strong&gt;ï¼šåè°ƒç”Ÿäº§ä¸æ¶ˆè´¹é€Ÿç‡å·®å¼‚ï¼Œé¿å…å¿™ç­‰å¾…ï¼ˆå¦‚è®¢å•å¤„ç†ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµé‡å‰Šå³°&lt;/strong&gt;ï¼šç¼“å†²çªå‘è¯·æ±‚ï¼Œä¿æŠ¤åç«¯æœåŠ¡ï¼ˆå¦‚ API ç½‘å…³é™æµï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ&lt;/strong&gt;ï¼šä½œä¸ºçº¿ç¨‹æ± çš„ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;ThreadPoolExecutor&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ± ç®¡ç†&lt;/strong&gt;ï¼šç®¡ç†æ•°æ®åº“è¿æ¥ã€çº¿ç¨‹ç­‰èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æœ€ä½³å®è·µ"&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®¹é‡è®¾ç½®&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿‡å°&lt;/strong&gt;ï¼šæ˜“è§¦å‘é˜»å¡ï¼Œå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿‡å¤§&lt;/strong&gt;ï¼šå†…å­˜å ç”¨é«˜ï¼Œå“åº”å»¶è¿Ÿå¢åŠ ï¼ˆå¦‚é»˜è®¤å€¼ &lt;code&gt;Integer.MAX_VALUE&lt;/code&gt; æ˜“è‡´ OOMï¼‰ã€‚
â€‹&lt;strong&gt;å»ºè®®&lt;/strong&gt;â€‹ï¼šæ ¹æ®ä¸šåŠ¡ååé‡å’Œå†…å­˜é™åˆ¶æŠ˜ä¸­ï¼ˆå¦‚ 100-10,000ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¹³æ€§é€‰æ‹©&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¬å¹³é”&lt;/strong&gt;ï¼ˆ&lt;code&gt;fair=true&lt;/code&gt;ï¼‰ï¼šä¿éšœçº¿ç¨‹é¡ºåºæ‰§è¡Œï¼Œé¿å…é¥¥é¥¿ï¼Œä½†é™ä½ååã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éå…¬å¹³é”&lt;/strong&gt;ï¼ˆé»˜è®¤ï¼‰ï¼šé«˜å¹¶å‘ä¸‹ååæ›´é«˜ï¼Œä½†å¯èƒ½å¼•å‘çº¿ç¨‹é¥¥é¥¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å†…å­˜æ³„æ¼&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åŠæ—¶ç§»é™¤æ— ç”¨å¯¹è±¡ï¼ˆ&lt;code&gt;dequeue()&lt;/code&gt; ä¸­æ˜¾å¼ç½® &lt;code&gt;null&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é¿å…å­˜å‚¨å¤§å¯¹è±¡ï¼Œæ‹†åˆ†æ•°æ®å•å…ƒä¼ è¾“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜é›…ä¸­æ–­&lt;/strong&gt;ï¼š
æ‰€æœ‰é˜»å¡æ–¹æ³•ï¼ˆ&lt;code&gt;put()&lt;/code&gt;, &lt;code&gt;take()&lt;/code&gt;ï¼‰å‡å“åº” &lt;code&gt;InterruptedException&lt;/code&gt;ï¼Œéœ€æ•è·å¹¶æ¢å¤ä¸­æ–­çŠ¶æ€ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;try {
queue.put(data);
} catch (InterruptedException e) {
Thread.currentThread().interrupt(); // æ¢å¤ä¸­æ–­æ ‡å¿—
// æ¸…ç†é€»è¾‘
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ç“¶é¢ˆä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;âš¡ &lt;strong&gt;æ€§èƒ½ç“¶é¢ˆä¸æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ€§èƒ½ç“¶é¢ˆ"&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å•é”ç«äº‰&lt;/strong&gt;ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å…±ç”¨åŒä¸€æŠŠé”ï¼Œé«˜å¹¶å‘ä¸‹æ˜“æˆæ€§èƒ½ç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°ç»„æ‹·è´æˆæœ¬&lt;/strong&gt;ï¼š&lt;code&gt;remove(Object o)&lt;/code&gt; åˆ é™¤éé˜Ÿé¦–å…ƒç´ æ—¶éœ€ç§»åŠ¨æ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦ O(n)ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å ç”¨&lt;/strong&gt;ï¼šé¢„åˆ†é…å›ºå®šæ•°ç»„ï¼Œå¯èƒ½é—²ç½®å†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”"&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é˜Ÿåˆ—ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠ£åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LinkedBlockingQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¯»å†™åˆ†ç¦»é”ï¼Œååæ›´é«˜&lt;/td&gt;
&lt;td&gt;å†…å­˜å ç”¨é«˜ï¼ˆèŠ‚ç‚¹å¼€é”€ï¼‰ï¼ŒGC å‹åŠ›å¤§&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ã€å¤§å®¹é‡ä»»åŠ¡é˜Ÿåˆ—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ConcurrentLinkedQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ— é” CAS å®ç°ï¼Œè¶…é«˜å¹¶å‘&lt;/td&gt;
&lt;td&gt;æ— é˜»å¡æœºåˆ¶ï¼Œéœ€è‡ªæ—‹ç­‰å¾…&lt;/td&gt;
&lt;td&gt;è¶…é«˜ååä¸”æ— éœ€é˜»å¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;SynchronousQueue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥ä¼ é€’æ•°æ®ï¼Œé›¶å®¹é‡&lt;/td&gt;
&lt;td&gt;æ— ç¼“å†²èƒ½åŠ›ï¼Œç”Ÿäº§æ¶ˆè´¹éœ€ä¸¥æ ¼é…å¯¹&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹æ± ä»»åŠ¡è°ƒåº¦ï¼ˆ&lt;code&gt;newCachedThreadPool&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€ä¸¥æ ¼å®¹é‡æ§åˆ¶ â†’ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;éœ€é«˜åå â†’ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;éœ€æ— é” â†’ &lt;code&gt;ConcurrentLinkedQueue&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ArrayBlockingQueue é€šè¿‡ &lt;strong&gt;å¾ªç¯æ•°ç»„ + å•é” + åŒæ¡ä»¶å˜é‡&lt;/strong&gt; çš„ç®€æ´è®¾è®¡ï¼Œå®ç°äº†é«˜æ•ˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šç®€åŒ–ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹çš„åŒæ­¥é€»è¾‘ï¼Œé¿å…æ‰‹åŠ¨é”æ§åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨è¾¹ç•Œ&lt;/strong&gt;ï¼šé€‚åˆä¸­ä½å¹¶å‘ã€éœ€ä¸¥æ ¼æ§åˆ¶èµ„æºå ç”¨çš„åœºæ™¯ï¼ˆå¦‚åµŒå…¥å¼ç³»ç»Ÿã€ä½é¢‘ä»»åŠ¡è°ƒåº¦ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;ï¼šæƒè¡¡å…¬å¹³æ€§ä¸ååé‡ï¼Œåˆç†è®¾ç½®å®¹é‡ï¼Œé¿å…å­˜å‚¨å¤§å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…å¼€å‘ä¸­ï¼Œ&lt;strong&gt;ä¼˜å…ˆè¯„ä¼°å¹¶å‘å¼ºåº¦å’Œèµ„æºé™åˆ¶&lt;/strong&gt;ã€‚è‹¥é‡æ€§èƒ½ç“¶é¢ˆï¼Œå¯è€ƒè™‘ &lt;code&gt;LinkedBlockingQueue&lt;/code&gt; æˆ– &lt;code&gt;Disruptor&lt;/code&gt;ï¼ˆé«˜æ€§èƒ½æ— é”é˜Ÿåˆ—ï¼‰ï¼Œä½†åè€…å®ç°å¤æ‚åº¦æ˜¾è‘—å¢åŠ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="linkedblockingqueue"&gt;LinkedBlockingQueue
&lt;/h2&gt;&lt;p&gt;LinkedBlockingQueue æ˜¯ Java å¹¶å‘åŒ…ï¼ˆ&lt;code&gt;java.util.concurrent&lt;/code&gt;ï¼‰ä¸­åŸºäº&lt;strong&gt;é“¾è¡¨å®ç°çš„æœ‰ç•Œ/æ— ç•Œé˜»å¡é˜Ÿåˆ—&lt;/strong&gt;ï¼Œé€šè¿‡&lt;strong&gt;åŒé”åˆ†ç¦»æŠ€æœ¯&lt;/strong&gt;å®ç°é«˜å¹¶å‘æ€§èƒ½ï¼Œæ˜¯ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹çš„ç»å…¸å®ç°ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€æºç æœºåˆ¶ã€æ€§èƒ½ä¼˜åŒ–åŠå®è·µåœºæ™¯å±•å¼€æ·±å…¥è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§ä¸è®¾è®¡æ€æƒ³"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒç‰¹æ€§ä¸è®¾è®¡æ€æƒ³&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é“¾è¡¨ç»“æ„&lt;/strong&gt;ï¼šç”±å•å‘é“¾è¡¨èŠ‚ç‚¹æ„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«æ•°æ®é¡¹ï¼ˆ&lt;code&gt;item&lt;/code&gt;ï¼‰å’Œåç»§æŒ‡é’ˆï¼ˆ&lt;code&gt;next&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å“¨å…µèŠ‚ç‚¹&lt;/strong&gt;ï¼šå¤´èŠ‚ç‚¹ï¼ˆ&lt;code&gt;head&lt;/code&gt;ï¼‰å§‹ç»ˆä¸ºå“‘èŠ‚ç‚¹ï¼ˆ&lt;code&gt;item=null&lt;/code&gt;ï¼‰ï¼Œå°¾èŠ‚ç‚¹ï¼ˆ&lt;code&gt;last&lt;/code&gt;ï¼‰æŒ‡å‘æœ€æ–°æ’å…¥å…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;å®¹é‡æ§åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;é»˜è®¤æ— ç•Œï¼ˆ&lt;code&gt;capacity=Integer.MAX_VALUE&lt;/code&gt;ï¼‰ï¼Œä½†å»ºè®®æ˜¾å¼æŒ‡å®šå®¹é‡é¿å… OOMã€‚&lt;/li&gt;
&lt;li&gt;å®é™…å®¹é‡é€šè¿‡ &lt;code&gt;final int capacity&lt;/code&gt; å›ºå®šï¼Œä¸å¯åŠ¨æ€è°ƒæ•´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åŒé”åˆ†ç¦»ï¼ˆTake/Put Lockï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;takeLock&lt;/code&gt;ï¼šæ§åˆ¶å‡ºé˜Ÿï¼ˆæ¶ˆè´¹ï¼‰æ“ä½œï¼Œå…³è”æ¡ä»¶å˜é‡ &lt;code&gt;notEmpty&lt;/code&gt;ï¼ˆé˜Ÿåˆ—ç©ºæ—¶é˜»å¡æ¶ˆè´¹è€…ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;putLock&lt;/code&gt;ï¼šæ§åˆ¶å…¥é˜Ÿï¼ˆç”Ÿäº§ï¼‰æ“ä½œï¼Œå…³è”æ¡ä»¶å˜é‡ &lt;code&gt;notFull&lt;/code&gt;ï¼ˆé˜Ÿåˆ—æ»¡æ—¶é˜»å¡ç”Ÿäº§è€…ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸå­è®¡æ•°å™¨&lt;/strong&gt;ï¼š&lt;code&gt;AtomicInteger count&lt;/code&gt; è®°å½•å…ƒç´ æ•°é‡ï¼Œä¿è¯å¹¶å‘ä¿®æ”¹çš„å¯è§æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜»å¡è¡Œä¸º&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;put(e)&lt;/code&gt;ï¼šé˜Ÿåˆ—æ»¡æ—¶é˜»å¡ç”Ÿäº§è€…çº¿ç¨‹ï¼Œç›´åˆ°æœ‰ç©ºä½æˆ–çº¿ç¨‹è¢«ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;take()&lt;/code&gt;ï¼šé˜Ÿåˆ—ç©ºæ—¶é˜»å¡æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œç›´åˆ°æœ‰æ–°å…ƒç´ æˆ–çº¿ç¨‹è¢«ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒè¶…æ—¶æ“ä½œï¼š&lt;code&gt;offer(e, timeout, unit)&lt;/code&gt; å’Œ &lt;code&gt;poll(timeout, unit)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ“ä½œæºç è§£æ"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒæ“ä½œæºç è§£æ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…¥é˜Ÿæ“ä½œ-1"&gt;&lt;strong&gt;å…¥é˜Ÿæ“ä½œï¼ˆ&lt;code&gt;put()&lt;/code&gt;ï¼‰æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;public void put(E e) throws InterruptedException {
Node&amp;lt;E&amp;gt; node = new Node&amp;lt;&amp;gt;(e); // åˆ›å»ºæ–°èŠ‚ç‚¹
putLock.lockInterruptibly(); // è·å–å¯ä¸­æ–­çš„å†™é”
try {
while (count.get() == capacity) { // é˜Ÿåˆ—æ»¡æ—¶å¾ªç¯ç­‰å¾…
notFull.await(); // é˜»å¡åœ¨ notFull æ¡ä»¶
}
enqueue(node); // é“¾è¡¨å°¾éƒ¨æ’å…¥èŠ‚ç‚¹
int c = count.getAndIncrement(); // åŸå­é€’å¢è®¡æ•°å™¨
if (c + 1 &amp;lt; capacity) { // æ’å…¥åä»æœ‰ç©ºä½
notFull.signal(); // å”¤é†’å…¶ä»–ç”Ÿäº§è€…
}
} finally {
putLock.unlock();
}
if (c == 0) { // æ’å…¥å‰é˜Ÿåˆ—ä¸ºç©º
signalNotEmpty(); // å”¤é†’æ¶ˆè´¹è€…ï¼ˆéœ€å…ˆè·å– takeLockï¼‰
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å…³é”®é€»è¾‘&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å”¤é†’ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;æ’å…¥åé˜Ÿåˆ—æœªæ»¡ â†’ å”¤é†’ä¸€ä¸ªé˜»å¡çš„ç”Ÿäº§è€…ï¼ˆé¿å…æ— æ•ˆå”¤é†’ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ’å…¥å‰é˜Ÿåˆ—ä¸ºç©º â†’ å”¤é†’é˜»å¡çš„æ¶ˆè´¹è€…ï¼ˆ&lt;code&gt;signalNotEmpty()&lt;/code&gt; å†…éƒ¨éœ€è·å– &lt;code&gt;takeLock&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¥é˜Ÿæ“ä½œ&lt;/strong&gt;ï¼š&lt;code&gt;enqueue(node)&lt;/code&gt; ä»…æ“ä½œå°¾æŒ‡é’ˆï¼Œæ—¶é—´å¤æ‚åº¦ O(1)ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å‡ºé˜Ÿæ“ä½œ-1"&gt;&lt;strong&gt;å‡ºé˜Ÿæ“ä½œï¼ˆ&lt;code&gt;take()&lt;/code&gt;ï¼‰æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;public E take() throws InterruptedException {
takeLock.lockInterruptibly(); // è·å–å¯ä¸­æ–­çš„è¯»é”
try {
while (count.get() == 0) { // é˜Ÿåˆ—ç©ºæ—¶å¾ªç¯ç­‰å¾…
notEmpty.await(); // é˜»å¡åœ¨ notEmpty æ¡ä»¶
}
E x = dequeue(); // ç§»é™¤å¤´èŠ‚ç‚¹åç»§ï¼ˆå®é™…é¦–å…ƒç´ ï¼‰
int c = count.getAndDecrement(); // åŸå­é€’å‡è®¡æ•°å™¨
if (c &amp;gt; 1) { // å–å‡ºå‰é˜Ÿåˆ—è‡³å°‘æœ‰ä¸¤ä¸ªå…ƒç´ 
notEmpty.signal(); // å”¤é†’å…¶ä»–æ¶ˆè´¹è€…
}
return x;
} finally {
takeLock.unlock();
}
if (c == capacity) { // å–å‡ºå‰é˜Ÿåˆ—æ»¡
signalNotFull(); // å”¤é†’ç”Ÿäº§è€…ï¼ˆéœ€å…ˆè·å– putLockï¼‰
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å…³é”®é€»è¾‘&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡ºé˜Ÿæ“ä½œ&lt;/strong&gt;ï¼š&lt;code&gt;dequeue()&lt;/code&gt; å°†å¤´èŠ‚ç‚¹çš„ &lt;code&gt;next&lt;/code&gt; è®¾ä¸ºæ–°å¤´ï¼Œå¹¶ç½®ç©ºæ—§å¤´ï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å”¤é†’ä¼˜åŒ–&lt;/strong&gt;ï¼šç±»ä¼¼å…¥é˜Ÿï¼Œä»…åœ¨å¿…è¦æ—¶å”¤é†’å¯¹æ–¹è§’è‰²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€§èƒ½ä¼˜åŠ¿ä¸ç“¶é¢ˆ"&gt;âš¡ &lt;strong&gt;æ€§èƒ½ä¼˜åŠ¿ä¸ç“¶é¢ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é«˜å¹¶å‘æ€§èƒ½çš„å…³é”®"&gt;&lt;strong&gt;é«˜å¹¶å‘æ€§èƒ½çš„å…³é”®&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æœºåˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½æ”¶ç›Š&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¯»å†™é”åˆ†ç¦»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…äº’ä¸ç«äº‰é”èµ„æº&lt;/td&gt;
&lt;td&gt;ååé‡æ˜¾è‘—é«˜äºå•é”é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;ArrayBlockingQueue&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é“¾è¡¨ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ’å…¥/åˆ é™¤ä»…ä¿®æ”¹æŒ‡é’ˆï¼Œæ— éœ€æ•°æ®æ¬è¿&lt;/td&gt;
&lt;td&gt;æ—¶é—´å¤æ‚åº¦ O(1)ï¼Œæ— æ•°ç»„å¤åˆ¶çš„å¼€é”€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¡ä»¶å”¤é†’ä¼˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…å½“é˜Ÿåˆ—çŠ¶æ€å˜åŒ–å¯èƒ½è§£é™¤å¯¹æ–¹é˜»å¡æ—¶æ‰å”¤é†’&lt;/td&gt;
&lt;td&gt;å‡å°‘æ— æ•ˆçº¿ç¨‹åˆ‡æ¢ï¼Œé™ä½ CPU å¼€é”€&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æ€§èƒ½ç“¶é¢ˆ-1"&gt;&lt;strong&gt;æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;GC å‹åŠ›&lt;/strong&gt;ï¼šé¢‘ç¹å¢åˆ å¯¼è‡´èŠ‚ç‚¹å¯¹è±¡åˆ›å»º/å›æ”¶ï¼Œå¯èƒ½è§¦å‘ Young GC æˆ– Full GCã€‚&lt;/li&gt;
&lt;li&gt;é”ç«äº‰ï¼š
&lt;ul&gt;
&lt;li&gt;åŒä¸€è§’è‰²å¤šçº¿ç¨‹ç«äº‰ï¼ˆå¦‚å¤šä¸ªç”Ÿäº§è€…äº‰ &lt;code&gt;putLock&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;count&lt;/code&gt; çš„åŸå­æ“ä½œåœ¨é«˜å¹¶å‘ä¸‹å¯èƒ½æˆä¸ºçƒ­ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å ç”¨&lt;/strong&gt;ï¼šæ¯ä¸ªèŠ‚ç‚¹å«å¯¹è±¡å¤´+æŒ‡é’ˆï¼Œç©ºé—´åˆ©ç”¨ç‡ä½äºæ•°ç»„ç»“æ„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ-2"&gt;ğŸ› ï¸ &lt;strong&gt;é€‚ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…¸å‹åº”ç”¨åœºæ™¯-1"&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹&lt;/strong&gt;ï¼šç¼“å†²ä»»åŠ¡/æ•°æ®ï¼Œè§£è€¦ç”Ÿäº§ä¸æ¶ˆè´¹é€Ÿç‡ï¼ˆå¦‚è®¢å•å¤„ç†ç³»ç»Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—&lt;/strong&gt;ï¼šä½œä¸º &lt;code&gt;ThreadPoolExecutor&lt;/code&gt; çš„ä»»åŠ¡ç¼“å†²é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;newFixedThreadPool&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æµç®¡é“&lt;/strong&gt;ï¼šè¿æ¥å¤„ç†é˜¶æ®µï¼Œç¡®ä¿æ•°æ®æœ‰åºä¼ é€’ï¼ˆå¦‚æ—¥å¿—è¿‡æ»¤æµæ°´çº¿ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æœ€ä½³å®è·µ-1"&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å®è·µè¦ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ˜¾å¼è®¾ç½®é˜Ÿåˆ—å®¹é‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…é»˜è®¤æ— ç•Œé˜Ÿåˆ—å¼•å‘ OOMï¼ˆå¦‚ &lt;code&gt;new LinkedBlockingQueue&amp;lt;&amp;gt;(1000)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½¿ç”¨è¶…æ—¶ API&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…æ°¸ä¹…é˜»å¡ï¼ˆå¦‚ &lt;code&gt;offer(e, 500, TimeUnit.MILLISECONDS)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç›‘æ§é˜Ÿåˆ—å¤§å°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é€šè¿‡ &lt;code&gt;size()&lt;/code&gt; å’Œ &lt;code&gt;remainingCapacity()&lt;/code&gt; åŠ¨æ€è°ƒæ•´ç”Ÿäº§/æ¶ˆè´¹ç­–ç•¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é¿å…å­˜å‚¨å¤§å¯¹è±¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å‡å°‘ GC å‹åŠ›ï¼Œå¯å­˜å‚¨å¼•ç”¨æˆ–æ‹†åˆ†æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¼˜é›…å…³é—­çº¿ç¨‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸­æ–­é˜»å¡çš„ &lt;code&gt;put/take&lt;/code&gt; çº¿ç¨‹ï¼Œæ•è· &lt;code&gt;InterruptedException&lt;/code&gt; å¹¶æ¢å¤ä¸­æ–­çŠ¶æ€&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸æ›¿ä»£æ–¹æ¡ˆçš„å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;ä¸æ›¿ä»£æ–¹æ¡ˆçš„å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;é˜Ÿåˆ—å®ç°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠ£åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ArrayBlockingQueue&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å†…å­˜ç´§å‡‘ï¼ˆæ•°ç»„è¿ç»­å­˜å‚¨ï¼‰ï¼Œæ— èŠ‚ç‚¹å¼€é”€&lt;/td&gt;
&lt;td&gt;å•é”è®¾è®¡ï¼Œååé‡ä½&lt;/td&gt;
&lt;td&gt;å†…å­˜æ•æ„Ÿã€ä¸­ä½å¹¶å‘åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ConcurrentLinkedQueue&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— é” CAS å®ç°ï¼Œè¶…é«˜åå&lt;/td&gt;
&lt;td&gt;æ— é˜»å¡æœºåˆ¶ï¼Œéœ€è‡ªæ—‹ç­‰å¾…&lt;/td&gt;
&lt;td&gt;è¶…é«˜å¹¶å‘ä¸”æ— éœ€é˜»å¡ï¼ˆå¦‚äº‹ä»¶æ€»çº¿ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;SynchronousQueue&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥ä¼ é€’ä»»åŠ¡ï¼Œé›¶å»¶è¿Ÿ&lt;/td&gt;
&lt;td&gt;æ— ç¼“å†²èƒ½åŠ›ï¼Œç”Ÿäº§æ¶ˆè´¹éœ€ä¸¥æ ¼é…å¯¹&lt;/td&gt;
&lt;td&gt;é«˜å“åº”è¦æ±‚çš„ä»»åŠ¡è°ƒåº¦ï¼ˆå¦‚ &lt;code&gt;CachedThreadPool&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€å¹³è¡¡ååä¸å†…å­˜ â†’ &lt;strong&gt;&lt;code&gt;LinkedBlockingQueue&lt;/code&gt;ï¼ˆæŒ‡å®šå®¹é‡ï¼‰&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;æç«¯å†…å­˜é™åˆ¶ â†’ &lt;strong&gt;&lt;code&gt;ArrayBlockingQueue&lt;/code&gt;&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;æé™ååéœ€æ±‚ â†’ &lt;strong&gt;&lt;code&gt;ConcurrentLinkedQueue&lt;/code&gt; + è‡ªå®šä¹‰é˜»å¡å±‚&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;LinkedBlockingQueue é€šè¿‡&lt;strong&gt;åŒé”åˆ†ç¦» + é“¾è¡¨ç»“æ„ + æ¡ä»¶å”¤é†’ä¼˜åŒ–&lt;/strong&gt;ï¼Œæˆä¸ºé«˜å¹¶å‘åœºæ™¯ä¸‹ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹çš„ç†æƒ³é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ç²¾é«“&lt;/strong&gt;ï¼šè¯»å†™é”åˆ†ç¦»æœ€å¤§åŒ–å¹¶å‘ååï¼ŒåŸå­è®¡æ•°å™¨ä¿éšœçº¿ç¨‹å®‰å…¨ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨è¾¹ç•Œ&lt;/strong&gt;ï¼šé€‚åˆè¯»/å†™æ“ä½œå‡è¡¡ä¸”éœ€ç¼“å†²èƒ½åŠ›çš„åœºæ™¯ï¼Œé¿å…ç”¨äºæç«¯å†…å­˜æ•æ„Ÿæˆ–è¶…é«˜ååæ— é˜»å¡éœ€æ±‚ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼”è¿›æ–¹å‘&lt;/strong&gt;ï¼šåŠ¨æ€å®¹é‡éœ€æ±‚å¯å‚è€ƒç¾å›¢ &lt;code&gt;ResizableCapacityLinkedBlockingQueue&lt;/code&gt;ï¼Œæˆ–ç»“åˆ &lt;code&gt;Disruptor&lt;/code&gt; æ— é”é˜Ÿåˆ—è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…å¼€å‘ä¸­ï¼Œ&lt;strong&gt;ä¼˜å…ˆé€šè¿‡å‹åŠ›æµ‹è¯•éªŒè¯å®¹é‡ä¸ååé‡&lt;/strong&gt;ï¼Œç»“åˆç›‘æ§ï¼ˆå¦‚é˜Ÿåˆ—å †ç§¯å‘Šè­¦ï¼‰åŠ¨æ€è°ƒæ•´å‚æ•°ï¼Œä»¥å……åˆ†å‘æŒ¥å…¶å¹¶å‘ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Javaã€‘Object ç±»æ–¹æ³•</title><link>https://dyhes.github.io/p/javaobject-%E7%B1%BB%E6%96%B9%E6%B3%95/</link><pubDate>Wed, 18 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javaobject-%E7%B1%BB%E6%96%B9%E6%B3%95/</guid><description>&lt;h2 id="finalize-deprecated"&gt;finalize() &lt;code&gt;@deprecated&lt;/code&gt;
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;finalize()&lt;/code&gt; æ˜¯ Java &lt;code&gt;Object&lt;/code&gt; ç±»ä¸­çš„ä¸€ä¸ªå—ä¿æŠ¤æ–¹æ³•ï¼Œç”¨äºåœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼ˆGCï¼‰å‰æ‰§è¡Œæ¸…ç†æ“ä½œã€‚å°½ç®¡å…¶è®¾è®¡åˆè¡·æ˜¯ç®¡ç†èµ„æºï¼Œä½†å› è¯¸å¤šç¼ºé™·ï¼Œè‡ª &lt;strong&gt;Java 9 èµ·&lt;/strong&gt;å·²è¢«æ ‡è®°ä¸ºå¼ƒç”¨ï¼ˆ&lt;code&gt;@Deprecated&lt;/code&gt;ï¼‰ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒæœºåˆ¶å’Œæ³¨æ„äº‹é¡¹çš„è¯¦ç»†è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä½œç”¨ä¸è®¾è®¡åˆè¡·"&gt;ğŸ” &lt;strong&gt;ä½œç”¨ä¸è®¾è®¡åˆè¡·&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ¸…ç†&lt;/strong&gt;
ç”¨äºé‡Šæ”¾å¯¹è±¡æŒæœ‰çš„&lt;strong&gt;éå†…å­˜èµ„æº&lt;/strong&gt;â€‹ï¼ˆå¦‚æ–‡ä»¶å¥æŸ„ã€æ•°æ®åº“è¿æ¥ã€ç½‘ç»œç«¯å£ç­‰ï¼‰ã€‚ä¾‹å¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;protected void finalize() throws Throwable {
if (fileInputStream != null) {
fileInputStream.close(); // ç¡®ä¿æ–‡ä»¶æµå…³é—­
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°èµ„æºé‡Šæ”¾&lt;/strong&gt;
é€‚ç”¨äºé€šè¿‡ JNIï¼ˆJava Native Interfaceï¼‰åˆ›å»ºçš„æœ¬åœ°å¯¹è±¡ï¼ˆå¦‚ C/C++ åˆ†é…çš„å†…å­˜ï¼‰ï¼Œéœ€åœ¨ &lt;code&gt;finalize()&lt;/code&gt; ä¸­è°ƒç”¨åŸç”Ÿæ–¹æ³•é‡Šæ”¾ï¼ˆå¦‚ &lt;code&gt;free()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å¤æ´»æœºåˆ¶&lt;/strong&gt;
åœ¨ &lt;code&gt;finalize()&lt;/code&gt; ä¸­ï¼Œå¯å°†å½“å‰å¯¹è±¡é‡æ–°èµ‹å€¼ç»™ä¸€ä¸ªå¯è¾¾å¼•ç”¨ï¼ˆå¦‚é™æ€å˜é‡ï¼‰ï¼Œä½¿å¯¹è±¡â€œå¤æ´»â€ï¼Œé¿å…è¢« GC å›æ”¶ã€‚ä½†æ­¤æœºåˆ¶åªèƒ½ç”Ÿæ•ˆä¸€æ¬¡ï¼ˆåç»­å›æ”¶æ—¶ä¸å†è°ƒç”¨ &lt;code&gt;finalize()&lt;/code&gt;ï¼‰ã€‚
&lt;pre tabindex="0"&gt;&lt;code&gt;protected void finalize() {
SAVE_HOOK = this; // å¯¹è±¡å¤æ´»
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ‰§è¡ŒåŸç†ä¸ç”Ÿå‘½å‘¨æœŸ"&gt;âš™ï¸ &lt;strong&gt;æ‰§è¡ŒåŸç†ä¸ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å½“å¯¹è±¡ä¸å†è¢«å¼•ç”¨æ—¶ï¼ŒGC ä¼šæŒ‰ä»¥ä¸‹æµç¨‹å¤„ç†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¯è¾¾åˆ¤å®š&lt;/strong&gt;
åƒåœ¾å›æ”¶å™¨å‘ç°å¯¹è±¡ä» â€‹&lt;strong&gt;GC Roots&lt;/strong&gt;â€‹ ä¸å¯è¾¾ï¼ˆå³æ— ä»»ä½•æ´»åŠ¨çº¿ç¨‹èƒ½è®¿é—®è¯¥å¯¹è±¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç»ˆç»“çŠ¶æ€æ£€æŸ¥
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœªè¦†ç›– &lt;code&gt;finalize()&lt;/code&gt;&lt;/strong&gt;ï¼šç›´æ¥å›æ”¶å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¦†ç›– &lt;code&gt;finalize()&lt;/code&gt; ä¸”æœªæ‰§è¡Œè¿‡&lt;/strong&gt;ï¼šå¯¹è±¡è¢«æ ‡è®°ä¸º &lt;code&gt;finalizable&lt;/code&gt;ï¼ŒåŠ å…¥ &lt;code&gt;F-Queue&lt;/code&gt; é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥æ‰§è¡Œ&lt;/strong&gt;
ç”± JVM çš„ä½ä¼˜å…ˆçº§åå°çº¿ç¨‹æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ &lt;code&gt;finalize()&lt;/code&gt; æ–¹æ³•ï¼ˆ&lt;strong&gt;ä¸ä¿è¯åŠæ—¶æ€§&lt;/strong&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;äºŒæ¬¡åˆ¤å®š
æ‰§è¡Œåå†æ¬¡æ£€æŸ¥å¯¹è±¡å¯è¾¾æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¯è¾¾&lt;/strong&gt;ï¼šå›æ”¶å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯è¾¾&lt;/strong&gt;ï¼ˆå› â€œå¤æ´»â€ï¼‰ï¼šå¯¹è±¡çŠ¶æ€å˜ä¸º &lt;code&gt;finalized&lt;/code&gt;ï¼Œå­˜æ´»è‡³ä¸‹æ¬¡ä¸å¯è¾¾æ—¶è¢«å›æ”¶ï¼ˆä¸å†è°ƒç”¨ &lt;code&gt;finalize()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Š &lt;strong&gt;å¯¹è±¡çŠ¶æ€å˜è¿å›¾&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[æ–°å»ºï¼šreachable, unfinalized] --&amp;gt;|å¤±å»å¼•ç”¨| B[f-reachable/unreachable]
B --&amp;gt;|GCæ£€æµ‹| C[finalizable]
C --&amp;gt;|å…¥é˜Ÿ| D[F-Queue]
D --&amp;gt;|æ‰§è¡Œ finalize()| E[å¯è¾¾ï¼šfinalized]
E --&amp;gt;|å†æ¬¡ä¸å¯è¾¾| F[å›æ”¶]
C --&amp;gt;|æ—  finalize()| F
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-ç¼ºé™·ä¸å¼ƒç”¨åŸå› "&gt;âš ï¸ &lt;strong&gt;ç¼ºé™·ä¸å¼ƒç”¨åŸå› &lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œæ—¶æœºä¸ç¡®å®š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;GC è§¦å‘æ—¶é—´æœªçŸ¥ï¼Œå¯èƒ½å¯¼è‡´èµ„æºé•¿æœŸæœªé‡Šæ”¾ï¼ˆå¦‚æ–‡ä»¶å¥æŸ„è€—å°½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹åºé€€å‡ºæ—¶ï¼Œæœªæ‰§è¡Œçš„ &lt;code&gt;finalize()&lt;/code&gt; ä¼šè¢«ä¸¢å¼ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹è±¡éœ€è‡³å°‘ä¸¤è½® GC æ‰èƒ½å›æ”¶ï¼ˆå…ˆå…¥é˜Ÿï¼Œåå›æ”¶ï¼‰ï¼Œå»¶é•¿å­˜æ´»æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;ä½ä¼˜å…ˆçº§çº¿ç¨‹æ‰§è¡Œæ¸…ç†å¯èƒ½é˜»å¡ GCï¼Œå¢åŠ åœé¡¿æ—¶é—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ &lt;code&gt;finalize()&lt;/code&gt; æŠ›å‡ºæœªæ•è·å¼‚å¸¸ï¼ŒJVM ä¼šå¿½ç•¥å¹¶ç»ˆæ­¢æ¸…ç†ï¼Œå¯¼è‡´èµ„æºæ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;æ¶æ„ä»£ç å¯èƒ½é€šè¿‡è¦†ç›– &lt;code&gt;finalize()&lt;/code&gt; æ‰§è¡Œéæ³•æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å¤æ´»éšæ‚£&lt;/strong&gt;
é”™è¯¯ä½¿ç”¨å¤æ´»æœºåˆ¶ä¼šå¯¼è‡´å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ··ä¹±ï¼Œå¢åŠ å†…å­˜æ³„æ¼é£é™©ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ç¦ç”¨æ–¹æ³•&lt;/strong&gt;
&lt;code&gt;System.runFinalizersOnExit()&lt;/code&gt; ç­‰å¼ºåˆ¶ç»ˆç»“æ–¹æ³•å·²è¢«åºŸå¼ƒï¼ˆå› æ­»é”å’ŒçŠ¶æ€ä¸ä¸€è‡´é—®é¢˜ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ›¿ä»£æ–¹æ¡ˆ"&gt;ğŸ”§ &lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;try-with-resources&lt;/code&gt; è¯­å¥&lt;/strong&gt;
Java 7+ æ¨èæ–¹å¼ï¼Œå¯¹å®ç° &lt;code&gt;AutoCloseable&lt;/code&gt; æ¥å£çš„èµ„æºè‡ªåŠ¨è°ƒç”¨ &lt;code&gt;close()&lt;/code&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;try (FileInputStream fis = new FileInputStream(&amp;#34;file.txt&amp;#34;)) {
// ä½¿ç”¨èµ„æº
} // è‡ªåŠ¨å…³é—­ï¼Œæ— éœ€ finalize()
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;java.lang.ref.Cleaner&lt;/code&gt;&lt;/strong&gt;
Java 9+ å¼•å…¥ï¼Œé€šè¿‡å¹»è±¡å¼•ç”¨ï¼ˆPhantomReferenceï¼‰æ³¨å†Œå›è°ƒï¼Œé¿å…å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¢«å»¶é•¿ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Cleaner cleaner = Cleaner.create();
cleaner.register(obj, () -&amp;gt; cleanResource()); // å›è°ƒæ¸…ç†å‡½æ•°
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜¾å¼é‡Šæ”¾æ–¹æ³•&lt;/strong&gt;
æä¾› &lt;code&gt;close()&lt;/code&gt; æˆ– &lt;code&gt;dispose()&lt;/code&gt; æ–¹æ³•ï¼Œè¦æ±‚è°ƒç”¨è€…æ‰‹åŠ¨é‡Šæ”¾èµ„æºï¼ˆå¦‚ &lt;code&gt;Socket.close()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;finalize()&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;è°ƒç”¨æ—¶æœº&lt;/td&gt;
&lt;td&gt;ä¸ç¡®å®šï¼Œä¾èµ– GC&lt;/td&gt;
&lt;td&gt;ç¡®å®šï¼ˆ&lt;code&gt;try&lt;/code&gt; å—ç»“æŸæˆ–æ‰‹åŠ¨è°ƒç”¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ€§èƒ½å½±å“&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå»¶è¿Ÿå›æ”¶ï¼Œå¢åŠ  GC è´Ÿæ‹…ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆç›´æ¥é‡Šæ”¾ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;èµ„æºé‡Šæ”¾å¯é æ€§&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆå¯èƒ½æ°¸ä¸æ‰§è¡Œï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå¼ºåˆ¶é‡Šæ”¾ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é€‚ç”¨åœºæ™¯&lt;/td&gt;
&lt;td&gt;æœ¬åœ°èµ„æºï¼ˆJNIï¼‰&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰éå†…å­˜èµ„æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»“è®º&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;â€‹&lt;strong&gt;é¿å…ä½¿ç”¨ &lt;code&gt;finalize()&lt;/code&gt;&lt;/strong&gt;ï¼Œä¼˜å…ˆé‡‡ç”¨ &lt;code&gt;try-with-resources&lt;/code&gt; æˆ– &lt;code&gt;Cleaner&lt;/code&gt; ç®¡ç†èµ„æºã€‚ä»…åœ¨éœ€é‡Šæ”¾ JNI æœ¬åœ°å†…å­˜ç­‰æç«¯åœºæ™¯ä¸‹è€ƒè™‘å…¶ä½œä¸ºè¡¥å……ï¼ˆä½†éœ€ä¸¥æ ¼æµ‹è¯•ï¼‰ã€‚ç°ä»£ Java å¼€å‘ä¸­ï¼Œå…¶è®¾è®¡å·²è¢«æ›´å¯é æœºåˆ¶å–ä»£ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="çº¿ç¨‹é—´é€šä¿¡"&gt;çº¿ç¨‹é—´é€šä¿¡
&lt;/h3&gt;&lt;p&gt;Object ç±»ä¸­çš„ &lt;code&gt;wait()&lt;/code&gt;ã€&lt;code&gt;notify()&lt;/code&gt;ã€&lt;code&gt;notifyAll()&lt;/code&gt; ä»¥åŠ Thread ç±»çš„ &lt;code&gt;sleep()&lt;/code&gt; æ˜¯ Java å¤šçº¿ç¨‹ç¼–ç¨‹çš„æ ¸å¿ƒæ–¹æ³•ï¼Œç”¨äºçº¿ç¨‹åŒæ­¥ä¸åä½œã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ–¹æ³•åŠŸèƒ½ä¸åŒºåˆ«"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒæ–¹æ³•åŠŸèƒ½ä¸åŒºåˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="wait"&gt;&lt;strong&gt;&lt;code&gt;wait()&lt;/code&gt; æ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šä½¿å½“å‰çº¿ç¨‹é‡Šæ”¾å¯¹è±¡é”å¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨åŒä¸€å¯¹è±¡çš„ &lt;code&gt;notify()&lt;/code&gt;/&lt;code&gt;notifyAll()&lt;/code&gt; æˆ–è¶…æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒç”¨æ¡ä»¶&lt;/strong&gt;ï¼šå¿…é¡»åœ¨ &lt;code&gt;synchronized&lt;/code&gt; åŒæ­¥å—æˆ–æ–¹æ³•å†…è°ƒç”¨ï¼Œå¦åˆ™æŠ›å‡º &lt;code&gt;IllegalMonitorStateException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é‡è½½å½¢å¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;wait()&lt;/code&gt;ï¼šæ— é™æœŸç­‰å¾…ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;wait(long timeout)&lt;/code&gt;ï¼šç­‰å¾…æŒ‡å®šæ¯«ç§’ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;wait(long timeout, int nanos)&lt;/code&gt;ï¼šç²¾ç¡®åˆ°çº³ç§’çš„è¶…æ—¶æ§åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="notify"&gt;&lt;strong&gt;&lt;code&gt;notify()&lt;/code&gt; æ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šéšæœºå”¤é†’&lt;strong&gt;ä¸€ä¸ª&lt;/strong&gt;åœ¨è¯¥å¯¹è±¡ä¸Šç­‰å¾…çš„çº¿ç¨‹ï¼ˆç”± JVM è°ƒåº¦é€‰æ‹©ï¼‰ï¼Œè¢«å”¤é†’çº¿ç¨‹éœ€é‡æ–°ç«äº‰é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒç”¨æ¡ä»¶&lt;/strong&gt;ï¼šåŒæ ·éœ€åœ¨ &lt;code&gt;synchronized&lt;/code&gt; å—å†…è°ƒç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="notifyall"&gt;&lt;strong&gt;&lt;code&gt;notifyAll()&lt;/code&gt; æ–¹æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šå”¤é†’&lt;strong&gt;æ‰€æœ‰&lt;/strong&gt;åœ¨è¯¥å¯¹è±¡ä¸Šç­‰å¾…çš„çº¿ç¨‹ï¼Œçº¿ç¨‹éœ€ç«äº‰é”åæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šéœ€å”¤é†’å…¨éƒ¨ç­‰å¾…çº¿ç¨‹æ—¶ï¼ˆå¦‚èµ„æºæ± é‡Šæ”¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="sleep"&gt;&lt;strong&gt;&lt;code&gt;sleep()&lt;/code&gt; æ–¹æ³•ï¼ˆThread ç±»é™æ€æ–¹æ³•ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šæš‚åœå½“å‰çº¿ç¨‹æ‰§è¡ŒæŒ‡å®šæ—¶é—´ï¼Œ&lt;strong&gt;ä¸é‡Šæ”¾é”&lt;/strong&gt;ï¼Œæ—¶é—´ç»“æŸåçº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒç”¨ä½ç½®&lt;/strong&gt;ï¼šå¯åœ¨ä»»ä½•ä»£ç ä¸­è°ƒç”¨ï¼Œæ— éœ€åŒæ­¥å—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸&lt;/strong&gt;ï¼šéœ€æ•è· &lt;code&gt;InterruptedException&lt;/code&gt;ï¼ˆä¸­æ–­æ—¶ä¼šæŠ›å‡ºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;å…³é”®å¯¹æ¯”ï¼š&lt;code&gt;wait()&lt;/code&gt; vs &lt;code&gt;sleep()&lt;/code&gt;&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;wait()&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;sleep()&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰€å±ç±»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Object&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Thread&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”é‡Šæ”¾&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é‡Šæ”¾å¯¹è±¡é”&lt;/td&gt;
&lt;td&gt;ä¸é‡Šæ”¾é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è°ƒç”¨ä½ç½®&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿…é¡»åœ¨ &lt;code&gt;synchronized&lt;/code&gt; å—å†…&lt;/td&gt;
&lt;td&gt;ä»»æ„ä½ç½®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å”¤é†’æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ˜¾å¼è°ƒç”¨ &lt;code&gt;notify()&lt;/code&gt;/&lt;code&gt;notifyAll()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¶…æ—¶è‡ªåŠ¨å”¤é†’&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¼‚å¸¸å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€å¤„ç† &lt;code&gt;InterruptedException&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;éœ€å¤„ç† &lt;code&gt;InterruptedException&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹é—´åä½œï¼ˆå¦‚æ¡ä»¶ç­‰å¾…ï¼‰&lt;/td&gt;
&lt;td&gt;å•çº¯å»¶è¿Ÿæ‰§è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// wait() ç¤ºä¾‹
synchronized (obj) {
while (!condition) {
obj.wait(); // é‡Šæ”¾é”å¹¶ç­‰å¾…
}
}
// sleep() ç¤ºä¾‹
Thread.sleep(1000); // çº¿ç¨‹æš‚åœ1ç§’ï¼Œä¸é‡Šæ”¾é”
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ”„ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹"&gt;&lt;strong&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;ç¼“å†²åŒºæ»¡æ—¶ï¼Œç”Ÿäº§è€…è°ƒç”¨ &lt;code&gt;wait()&lt;/code&gt; ç­‰å¾…ï¼›&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹è€…æ¶ˆè´¹åè°ƒç”¨ &lt;code&gt;notify()&lt;/code&gt; å”¤é†’ç”Ÿäº§è€…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»£ç ç‰‡æ®µï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Buffer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;synchronized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;produce&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;full&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç­‰å¾…ç¼“å†²åŒºéæ»¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç”Ÿäº§æ•°æ®&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;notifyAll&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;synchronized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;consume&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç­‰å¾…ç¼“å†²åŒºéç©º&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ¶ˆè´¹æ•°æ®&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;notifyAll&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤šçº¿ç¨‹æ¡ä»¶ç­‰å¾…"&gt;&lt;strong&gt;å¤šçº¿ç¨‹æ¡ä»¶ç­‰å¾…&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åœºæ™¯ï¼šçº¿ç¨‹ A éœ€ç­‰å¾…çº¿ç¨‹ B å®ŒæˆæŸä»»åŠ¡åå†æ‰§è¡Œã€‚
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;synchronized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;taskLock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;taskCompleted&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;taskLock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// A çº¿ç¨‹ç­‰å¾…&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ä»»åŠ¡å®Œæˆåç»§ç»­æ‰§è¡Œ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;çº¿ç¨‹ B å®Œæˆåè°ƒç”¨
&lt;pre tabindex="0"&gt;&lt;code&gt;taskLock.notify()
&lt;/code&gt;&lt;/pre&gt;å”¤é†’ Aã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…è™šå‡å”¤é†’&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;while&lt;/code&gt; è€Œé &lt;code&gt;if&lt;/code&gt; æ£€æŸ¥æ¡ä»¶ï¼Œé˜²æ­¢æœªæ»¡è¶³æ¡ä»¶æ—¶è¢«æ„å¤–å”¤é†’ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š&lt;code&gt;while (!condition) wait();&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”ç«äº‰ä¸æ€§èƒ½&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;notifyAll()&lt;/code&gt; ä¼šå”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ï¼Œå¯èƒ½å¯¼è‡´é”ç«äº‰æ¿€çƒˆï¼Œä¼˜å…ˆä½¿ç”¨ &lt;code&gt;notify()&lt;/code&gt; é™¤éå¿…è¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸­æ–­å¤„ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;wait()&lt;/code&gt; å’Œ &lt;code&gt;sleep()&lt;/code&gt; å‡å¯è¢« &lt;code&gt;interrupt()&lt;/code&gt; ä¸­æ–­ï¼Œéœ€å¦¥å–„å¤„ç† &lt;code&gt;InterruptedException&lt;/code&gt;ï¼ˆå¦‚æ¢å¤ä¸­æ–­çŠ¶æ€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶æ§åˆ¶&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;wait(long timeout)&lt;/code&gt; é¿å…æ°¸ä¹…ç­‰å¾…ï¼Œé˜²æ­¢çº¿ç¨‹é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ &lt;code&gt;synchronized&lt;/code&gt; çš„å¼ºä¾èµ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;wait()&lt;/code&gt;/&lt;code&gt;notify()&lt;/code&gt; å¿…é¡»ä¸ &lt;code&gt;synchronized&lt;/code&gt; é…åˆï¼Œç¡®ä¿çº¿ç¨‹åœ¨æŒæœ‰é”æ—¶æ“ä½œå¯¹è±¡ç›‘è§†å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;wait()&lt;/code&gt;/&lt;code&gt;notify()&lt;/code&gt;/&lt;code&gt;notifyAll()&lt;/code&gt;&lt;/strong&gt;ï¼šç”¨äºçº¿ç¨‹é—´&lt;strong&gt;åä½œä¸åŒæ­¥&lt;/strong&gt;ï¼Œéœ€åœ¨åŒæ­¥å—ä¸­è°ƒç”¨ï¼Œä¾èµ–é”æœºåˆ¶é‡Šæ”¾ä¸è·å–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;sleep()&lt;/code&gt;&lt;/strong&gt;ï¼šç”¨äº&lt;strong&gt;å»¶è¿Ÿæ‰§è¡Œ&lt;/strong&gt;ï¼Œä¸æ¶‰åŠé”é‡Šæ”¾ï¼Œå¯ç‹¬ç«‹ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒåŸåˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;wait()&lt;/code&gt; è®©çº¿ç¨‹&lt;strong&gt;æ¡ä»¶æ€§ç­‰å¾…&lt;/strong&gt;ï¼Œé€šè¿‡ &lt;code&gt;notify()&lt;/code&gt; &lt;strong&gt;ç²¾å‡†å”¤é†’&lt;/strong&gt;æˆ– &lt;code&gt;notifyAll()&lt;/code&gt; &lt;strong&gt;å…¨å±€å”¤é†’&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sleep()&lt;/code&gt; ä»…ç”¨äº&lt;strong&gt;æ—¶é—´æ§åˆ¶&lt;/strong&gt;ï¼Œä¸å‚ä¸çº¿ç¨‹åè°ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ·±å…¥ç†è§£è¿™äº›æ–¹æ³•çš„å·®å¼‚ä¸é€‚ç”¨åœºæ™¯ï¼Œæ˜¯æ„å»ºé«˜æ•ˆã€å®‰å…¨å¤šçº¿ç¨‹åº”ç”¨çš„åŸºç¡€ã€‚ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®ç»“åˆ &lt;code&gt;java.util.concurrent&lt;/code&gt; åŒ…çš„å¹¶å‘å·¥å…·ï¼ˆå¦‚ &lt;code&gt;Lock&lt;/code&gt;ã€&lt;code&gt;Condition&lt;/code&gt;ï¼‰æ›¿ä»£åŸç”Ÿæ–¹æ³•ï¼Œä»¥æå‡å¯æ§æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Javaã€‘åå°„</title><link>https://dyhes.github.io/p/java%E5%8F%8D%E5%B0%84/</link><pubDate>Wed, 18 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/java%E5%8F%8D%E5%B0%84/</guid><description>&lt;h2 id="åå°„å®šä¹‰"&gt;åå°„å®šä¹‰
&lt;/h2&gt;&lt;p&gt;Javaåå°„ï¼ˆReflectionï¼‰æ˜¯Javaè¯­è¨€çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€è·å–ç±»çš„ä¿¡æ¯å¹¶æ“ä½œç±»æˆ–å¯¹è±¡çš„ç»“æ„ï¼ˆå¦‚å±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨ç­‰ï¼‰ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œé€šè¿‡Classå¯¹è±¡åƒé•œå­ä¸€æ ·é€è§†ç±»çš„å†…éƒ¨ç»“æ„â€ï¼Œä»è€Œå®ç°åŠ¨æ€ç¼–ç¨‹ã€‚ä»¥ä¸‹ä»äº”ä¸ªæ–¹é¢è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-åå°„çš„æ ¸å¿ƒåŸç†"&gt;ğŸ” åå°„çš„æ ¸å¿ƒåŸç†
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Classå¯¹è±¡çš„æ ¸å¿ƒä½œç”¨&lt;/strong&gt;
å½“JVMåŠ è½½ä¸€ä¸ªç±»æ—¶ï¼ˆå¦‚é€šè¿‡&lt;code&gt;new&lt;/code&gt;æˆ–&lt;code&gt;Class.forName()&lt;/code&gt;ï¼‰ï¼Œä¼šåœ¨å †ä¸­ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„&lt;code&gt;Class&lt;/code&gt;å¯¹è±¡ï¼ˆ&lt;code&gt;java.lang.Class&lt;/code&gt;å®ä¾‹ï¼‰ï¼Œè¯¥å¯¹è±¡å­˜å‚¨ç±»çš„å…ƒæ•°æ®ï¼ˆæˆå‘˜å˜é‡ã€æ–¹æ³•ã€æ„é€ å™¨ç­‰ç»“æ„ä¿¡æ¯ï¼‰ã€‚åå°„å³é€šè¿‡æ­¤å¯¹è±¡æ“ä½œç±»ã€‚
&lt;ul&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;java.lang.String&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è·å–Stringç±»çš„Classå¯¹è±¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ€§ vs é™æ€æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é™æ€åŠ è½½&lt;/strong&gt;ï¼šç¼–è¯‘æ—¶ç»‘å®šç±»ï¼Œç±»ä¸å­˜åœ¨åˆ™ç¼–è¯‘æŠ¥é”™ï¼ˆå¦‚&lt;code&gt;new&lt;/code&gt;åˆ›å»ºå¯¹è±¡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€åŠ è½½&lt;/strong&gt;ï¼šè¿è¡Œæ—¶é€šè¿‡å­—ç¬¦ä¸²ç±»ååŠ è½½ç±»ï¼Œå³ä½¿ç±»ä¸å­˜åœ¨ï¼Œåªè¦æœªæ‰§è¡Œåˆ°ç›¸å…³ä»£ç ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚åå°„å±äºåŠ¨æ€åŠ è½½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åå°„çš„æ ¸å¿ƒapiåŠä½¿ç”¨"&gt;âš™ï¸ åå°„çš„æ ¸å¿ƒAPIåŠä½¿ç”¨
&lt;/h3&gt;&lt;p&gt;åå°„é€šè¿‡ä»¥ä¸‹ç±»æ“ä½œç›®æ ‡ç±»ç»“æ„ï¼ˆå‡åœ¨&lt;code&gt;java.lang.reflect&lt;/code&gt;åŒ…ä¸­ï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è·å–Classå¯¹è±¡&lt;/strong&gt;ï¼ˆä¸‰ç§æ–¹å¼ï¼‰ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Class.forName(&amp;quot;å…¨ç±»å&amp;quot;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç±»åæ¥è‡ªé…ç½®æ–‡ä»¶ã€æ•°æ®åº“ç­‰åŠ¨æ€åœºæ™¯&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Class.forName(&amp;quot;com.example.User&amp;quot;)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ç±»å.class&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘æ—¶å·²çŸ¥ç±»åï¼Œæ€§èƒ½æ›´å¥½&lt;/td&gt;
&lt;td&gt;&lt;code&gt;String.class&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;å¯¹è±¡.getClass()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å·²æœ‰å¯¹è±¡å®ä¾‹æ—¶è·å–&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;quot;abc&amp;quot;.getClass()&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œç±»ç»“æ„&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ„é€ å¯¹è±¡ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;obj1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newInstance&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨æ— å‚æ„é€ ï¼ˆéœ€å­˜åœ¨ï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Constructor&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;con&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getConstructor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;obj2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;con&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newInstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Tom&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨æœ‰å‚æ„é€ &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;æ“ä½œå­—æ®µï¼ˆFieldï¼‰ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Field&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDeclaredField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setAccessible&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// çªç ´ç§æœ‰é™åˆ¶ï¼ˆå…³é”®ï¼ï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Jerry&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è®¾ç½®å­—æ®µå€¼&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è·å–å­—æ®µå€¼&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;è°ƒç”¨æ–¹æ³•ï¼ˆMethodï¼‰ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Method&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMethod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;setName&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;invoke&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Lucy&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨æ–¹æ³•&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åå°„çš„ä¼˜ç¼ºç‚¹"&gt;âš–ï¸ åå°„çš„ä¼˜ç¼ºç‚¹
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ¨æ€æ‰©å±•æ€§&lt;/strong&gt;ï¼šæ— éœ€ä¿®æ”¹æºç å³å¯åŠ è½½æ–°ç±»ï¼ˆå¦‚Springä¾èµ–æ³¨å…¥ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;ï¼šåå°„è°ƒç”¨æ¯”ç›´æ¥ä»£ç æ…¢ï¼ˆJVMæ— æ³•ä¼˜åŒ–åŠ¨æ€æ“ä½œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§£è€¦è®¾è®¡&lt;/strong&gt;ï¼šæ¡†æ¶é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶ç±»åŠ è½½ï¼ˆå¦‚MyBatisæ˜ å°„æ¥å£ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å®‰å…¨é£é™©&lt;/strong&gt;ï¼šå¯ç»•è¿‡è®¿é—®é™åˆ¶ï¼ˆå¦‚è°ƒç”¨ç§æœ‰æ–¹æ³•ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;ï¼šæ”¯æŒè¿è¡Œæ—¶æ“ä½œæ³›å‹ã€æ³¨è§£ç­‰ï¼ˆå¦‚åŠ¨æ€ä»£ç†ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ç ´åå°è£…&lt;/strong&gt;ï¼šæš´éœ²ç±»å†…éƒ¨ç»“æ„ï¼Œé™ä½å¯ç»´æŠ¤æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ€§èƒ½ä¼˜åŒ–æŠ€å·§&lt;/strong&gt;ï¼š
é€šè¿‡&lt;code&gt;setAccessible(true)&lt;/code&gt;å…³é—­å®‰å…¨æ£€æŸ¥ï¼Œå¯æå‡åå°„æ•ˆç‡ï¼ˆä½†éœ€æƒè¡¡å®‰å…¨ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åå°„çš„å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ› ï¸ åå°„çš„å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¡†æ¶å¼€å‘&lt;/strong&gt;
Springã€Hibernateç­‰æ¡†æ¶åˆ©ç”¨åå°„å®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–æ³¨å…¥&lt;/strong&gt;ï¼šæ ¹æ®é…ç½®åŠ¨æ€åˆ›å»ºå¯¹è±¡å¹¶æ³¨å…¥å±æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ä»£ç†&lt;/strong&gt;ï¼šå¦‚AOPé€šè¿‡&lt;code&gt;Proxy.newProxyInstance()&lt;/code&gt;ç”Ÿæˆä»£ç†ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥å…·åº“ä¸æµ‹è¯•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€šç”¨æ“ä½œ&lt;/strong&gt;ï¼šå¦‚Apache Commons BeanUtilsé€šè¿‡åå°„æ“ä½œJavaBeanã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•å…ƒæµ‹è¯•&lt;/strong&gt;ï¼šMockæ¡†æ¶ï¼ˆå¦‚Mockitoï¼‰æ¨¡æ‹Ÿç§æœ‰æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨è§£å¤„ç†&lt;/strong&gt;
è¿è¡Œæ—¶è§£ææ³¨è§£ï¼ˆå¦‚&lt;code&gt;@Test&lt;/code&gt;ï¼‰å¹¶åŠ¨æ€è°ƒç”¨æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Javaåå°„æ˜¯&lt;strong&gt;è¿è¡Œæ—¶åŠ¨æ€ç¼–ç¨‹çš„åŸºçŸ³&lt;/strong&gt;ï¼Œé€šè¿‡&lt;code&gt;Class&lt;/code&gt;å¯¹è±¡å®ç°â€œé€è§†ç±»ç»“æ„â†’æ“ä½œæˆå‘˜â†’è°ƒç”¨æ–¹æ³•â€çš„èƒ½åŠ›ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ€§&lt;/strong&gt;ï¼šè§£è€¦ä»£ç ä¸å…·ä½“ç±»ï¼Œæå‡æ‰©å±•æ€§ï¼ˆæ¡†æ¶è®¾è®¡çš„çµé­‚ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»æ€§&lt;/strong&gt;ï¼šçªç ´ç¼–è¯‘æ—¶é™åˆ¶ï¼Œæ”¯æŒè¿è¡Œæ—¶ç±»å‹æ“ä½œã€‚
ä½†éœ€è°¨æ…ä½¿ç”¨ï¼šåå°„åº”ä½œä¸º&lt;strong&gt;ç‰¹å®šåœºæ™¯çš„è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼ˆå¦‚æ¡†æ¶å¼€å‘ï¼‰ï¼Œè€Œéæ—¥å¸¸ç¼–ç é¦–é€‰ï¼Œé¿å…æ€§èƒ½ä¸å®‰å…¨é£é™©ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ä½¿ç”¨åœºæ™¯"&gt;ä½¿ç”¨åœºæ™¯
&lt;/h2&gt;&lt;p&gt;Javaåå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯å¹¿æ³›ï¼Œå°¤å…¶åœ¨éœ€è¦&lt;strong&gt;è¿è¡Œæ—¶åŠ¨æ€æ“ä½œç±»æˆ–å¯¹è±¡&lt;/strong&gt;çš„æ¡†æ¶ã€å·¥å…·å’Œé«˜çº§ç¼–ç¨‹ä¸­ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒä½¿ç”¨åœºæ™¯åŠå…·ä½“æ¡ˆä¾‹è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ¡†æ¶å¼€å‘ä¾èµ–æ³¨å…¥ä¸åŠ¨æ€åŠ è½½"&gt;ğŸ§© æ¡†æ¶å¼€å‘ï¼ˆä¾èµ–æ³¨å…¥ä¸åŠ¨æ€åŠ è½½ï¼‰
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Springçš„ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰&lt;/strong&gt;
â€‹&lt;strong&gt;åœºæ™¯&lt;/strong&gt;â€‹ï¼šSpringå®¹å™¨é€šè¿‡åå°„æ‰«ææ³¨è§£ï¼ˆå¦‚&lt;code&gt;@Service&lt;/code&gt;ã€&lt;code&gt;@Autowired&lt;/code&gt;ï¼‰ï¼ŒåŠ¨æ€åˆ›å»ºBeanå®ä¾‹å¹¶æ³¨å…¥ä¾èµ–ã€‚
â€‹&lt;strong&gt;ä»£ç ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;com.example.UserService&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDeclaredConstructor&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;newInstance&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Field&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;daoField&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDeclaredField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;userDao&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;daoField&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setAccessible&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;daoField&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userDaoInstance&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ³¨å…¥ä¾èµ–&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šåå°„çªç ´ç§æœ‰å­—æ®µé™åˆ¶ï¼Œå®ç°å±æ€§è‡ªåŠ¨è£…é…ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Hibernateçš„ORMæ˜ å°„&lt;/strong&gt;
â€‹&lt;strong&gt;åœºæ™¯&lt;/strong&gt;â€‹ï¼šå°†æ•°æ®åº“è¡¨å­—æ®µæ˜ å°„åˆ°å®ä½“ç±»çš„ç§æœ‰å±æ€§ã€‚
â€‹&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;â€‹ï¼šHibernateé€šè¿‡åå°„è¯»å–å®ä½“ç±»æ³¨è§£ï¼ŒåŠ¨æ€ç”ŸæˆSQLå¹¶å¡«å……æŸ¥è¯¢ç»“æœåˆ°å¯¹è±¡ç§æœ‰å­—æ®µã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åŠ¨æ€ä»£ç†ä¸aop"&gt;ğŸ”„ åŠ¨æ€ä»£ç†ä¸AOP
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Spring AOP
åœºæ™¯ï¼šåœ¨æ–¹æ³•è°ƒç”¨å‰åæ·»åŠ æ—¥å¿—ã€äº‹åŠ¡ç­‰é€»è¾‘ã€‚
ä»£ç ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;InvocationHandler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Before method&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;invoke&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;targetObj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// åå°„è°ƒç”¨ç›®æ ‡æ–¹æ³•&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;After method&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;MyInterface&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MyInterface&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Proxy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newProxyInstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyInterface&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getClassLoader&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;MyInterface&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŸç†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Proxy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newProxyInstance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŸºäºåå°„ç”Ÿæˆä»£ç†ç±»ï¼Œæ‹¦æˆªæ–¹æ³•è°ƒç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"&gt;ğŸ“¦ åºåˆ—åŒ–ä¸ååºåˆ—åŒ–
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;JSONåº“ï¼ˆå¦‚Jackson/Gsonï¼‰
åœºæ™¯ï¼šå°†JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºJavaå¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰ã€‚
ç¤ºä¾‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç§æœ‰å­—æ®µ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// ååºåˆ—åŒ–æ—¶é€šè¿‡åå°„è®¾ç½®nameå­—æ®µ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Field&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;nameField&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDeclaredField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;nameField&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setAccessible&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;nameField&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;personObj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;John&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;ä½œç”¨ï¼šåå°„ç»•è¿‡ç§æœ‰æƒé™ï¼Œç›´æ¥æ“ä½œå­—æ®µå€¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å•å…ƒæµ‹è¯•ä¸è°ƒè¯•"&gt;ğŸ§ª å•å…ƒæµ‹è¯•ä¸è°ƒè¯•
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;JUnitæµ‹è¯•ç§æœ‰æ–¹æ³•
åœºæ™¯ï¼šå¯¹ç±»çš„ç§æœ‰æ–¹æ³•è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚
ä»£ç ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Method&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;privateMethod&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyClass&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDeclaredMethod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;internalLogic&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;privateMethod&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setAccessible&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;privateMethod&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;invoke&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;testInstance&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨ç§æœ‰æ–¹æ³•&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»·å€¼ï¼šç¡®ä¿ä»£ç å…¨è¦†ç›–æµ‹è¯•ï¼ŒéªŒè¯å†…éƒ¨é€»è¾‘ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ’ä»¶ç³»ç»Ÿä¸åŠ¨æ€æ‰©å±•"&gt;ğŸ”Œ æ’ä»¶ç³»ç»Ÿä¸åŠ¨æ€æ‰©å±•
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Eclipse/IDEAæ’ä»¶æœºåˆ¶
åœºæ™¯ï¼šä¸»ç¨‹åºåŠ¨æ€åŠ è½½ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚
ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pluginClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;com.plugins.CustomPlugin&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Plugin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;plugin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Plugin&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pluginClass&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newInstance&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;plugin&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ‰§è¡Œæ’ä»¶åŠŸèƒ½&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¼˜åŠ¿ï¼šæ— éœ€é‡æ–°ç¼–è¯‘ä¸»ç¨‹åºï¼Œæ‰©å±•æ€§å¼ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨è§£å¤„ç†"&gt;âš™ï¸ æ³¨è§£å¤„ç†
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è‡ªå®šä¹‰æ³¨è§£è§£æ
åœºæ™¯ï¼šè¿è¡Œæ—¶è¯»å–ç±»æˆ–æ–¹æ³•ä¸Šçš„æ³¨è§£ï¼ˆå¦‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Test&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ï¼‰ã€‚
ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isAnnotationPresent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Test&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Test&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;testAnnotation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAnnotation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Test&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;priority&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;testAnnotation&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;priority&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è·å–æ³¨è§£å‚æ•°&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åº”ç”¨ï¼šJUnitã€Spring MVCç­‰æ¡†æ¶é€šè¿‡åå°„è§£ææ³¨è§£è§¦å‘é€»è¾‘ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“åå°„çš„æ ¸å¿ƒä»·å€¼ä¸æƒè¡¡"&gt;ğŸ’ æ€»ç»“ï¼šåå°„çš„æ ¸å¿ƒä»·å€¼ä¸æƒè¡¡
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹æ¡ˆä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åå°„çš„ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é£é™©æç¤º&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ¡†æ¶å¼€å‘&lt;/td&gt;
&lt;td&gt;Spring, Hibernate&lt;/td&gt;
&lt;td&gt;åŠ¨æ€åˆ›å»ºå¯¹è±¡ã€æ³¨å…¥ä¾èµ–&lt;/td&gt;
&lt;td&gt;æ€§èƒ½å¼€é”€ã€ç ´åå°è£…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŠ¨æ€ä»£ç†&lt;/td&gt;
&lt;td&gt;Spring AOP&lt;/td&gt;
&lt;td&gt;æ‹¦æˆªæ–¹æ³•è°ƒç”¨ï¼Œå®ç°åˆ‡é¢é€»è¾‘&lt;/td&gt;
&lt;td&gt;ä»£ç†ç±»ç”Ÿæˆå¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åºåˆ—åŒ–/ååºåˆ—åŒ–&lt;/td&gt;
&lt;td&gt;Jackson, Gson&lt;/td&gt;
&lt;td&gt;æ“ä½œç§æœ‰å­—æ®µè½¬æ¢æ•°æ®&lt;/td&gt;
&lt;td&gt;å®‰å…¨æ€§é£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å•å…ƒæµ‹è¯•&lt;/td&gt;
&lt;td&gt;JUnit&lt;/td&gt;
&lt;td&gt;æµ‹è¯•ç§æœ‰æ–¹æ³•æˆ–å­—æ®µ&lt;/td&gt;
&lt;td&gt;æ©ç›–è®¾è®¡ç¼ºé™·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ’ä»¶ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;Eclipseæ’ä»¶&lt;/td&gt;
&lt;td&gt;åŠ¨æ€åŠ è½½å¤–éƒ¨ç±»&lt;/td&gt;
&lt;td&gt;ç±»å†²çªé£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æœ€ä½³å®è·µå»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ¡†æ¶ã€å·¥å…·åº“ã€æµ‹è¯•ç­‰éæ€§èƒ½æ•æ„Ÿæ¨¡å—ã€‚&lt;/li&gt;
&lt;li&gt;è§„é¿é£é™©ï¼š
&lt;ul&gt;
&lt;li&gt;ç¼“å­˜&lt;code&gt;Class&lt;/code&gt;ã€&lt;code&gt;Method&lt;/code&gt;ç­‰å¯¹è±¡å‡å°‘é‡å¤è§£æï¼›&lt;/li&gt;
&lt;li&gt;é¿å…é«˜é¢‘å¾ªç¯ä¸­æ»¥ç”¨åå°„ï¼›&lt;/li&gt;
&lt;li&gt;é…åˆå®‰å…¨ç®¡ç†å™¨ï¼ˆ&lt;code&gt;SecurityManager&lt;/code&gt;ï¼‰é™åˆ¶æ•æ„Ÿæ“ä½œã€‚
åå°„æ˜¯JavaåŠ¨æ€èƒ½åŠ›çš„æ ¸å¿ƒï¼Œä½†å…¶**â€œåŒåˆƒå‰‘â€ç‰¹æ€§è¦æ±‚å¼€å‘è€…ä¸¥æ ¼æŠŠæ§ä½¿ç”¨è¾¹ç•Œ**â€”â€”åœ¨çµæ´»æ€§ä¸æ€§èƒ½ã€å°è£…æ€§ä¹‹é—´è°¨æ…æƒè¡¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="-é€šé…ç¬¦"&gt;&lt;?&gt; é€šé…ç¬¦
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œä½¿ç”¨ &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt; æˆ– &lt;code&gt;Constructor&amp;lt;?&amp;gt;&lt;/code&gt; çš„å†™æ³•æ˜¯ä¸ºäº†è§£å†³&lt;strong&gt;ç±»å‹å®‰å…¨ä¸çµæ´»æ€§&lt;/strong&gt;çš„å¹³è¡¡é—®é¢˜ï¼Œå°¤å…¶åœ¨æ³›å‹ä¸åå°„ç»“åˆçš„åœºæ™¯ä¸­ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒåŸå› åŠå…¸å‹åº”ç”¨åœºæ™¯ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸ºä»€ä¹ˆç”¨--é€šé…ç¬¦ç±»å‹å®‰å…¨çš„å¦¥å"&gt;âš™ï¸ ä¸ºä»€ä¹ˆç”¨ &lt;code&gt;?&lt;/code&gt; é€šé…ç¬¦ï¼Ÿâ€”â€”ç±»å‹å®‰å…¨çš„å¦¥å
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ³›å‹æ“¦é™¤çš„çº¦æŸ&lt;/strong&gt;
Java æ³›å‹åœ¨ç¼–è¯‘åä¼šè¢«æ“¦é™¤ä¸ºåŸå§‹ç±»å‹ï¼Œè¿è¡Œæ—¶æ— æ³•ç›´æ¥è·å–æ³›å‹å‚æ•°çš„å…·ä½“ç±»å‹ï¼ˆå¦‚ &lt;code&gt;T&lt;/code&gt; çš„å®é™…ç±»å‹ï¼‰ã€‚&lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt; è¡¨ç¤ºâ€œæœªçŸ¥ç±»å‹â€ï¼Œæ˜¯ç¼–è¯‘å™¨å¯¹æ³›å‹æ“¦é™¤çš„ä¸€ç§å®‰å…¨å¦¥åã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…ç±»å‹ç¡¬ç¼–ç &lt;/strong&gt;
ä½¿ç”¨ &lt;code&gt;Class&amp;lt;String&amp;gt;&lt;/code&gt; ä¼šå¼ºåˆ¶ç»‘å®šå…·ä½“ç±»å‹ï¼Œè€Œåå°„åœºæ™¯ï¼ˆå¦‚ &lt;code&gt;Class.forName(&amp;quot;java.lang.String&amp;quot;)&lt;/code&gt;ï¼‰åœ¨ç¼–è¯‘æ—¶æ— æ³•ç¡®å®šç±»å‹ï¼Œåªèƒ½è¿”å› &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-classt-vs-class-çš„æ ¸å¿ƒåŒºåˆ«"&gt;ğŸ” &lt;code&gt;Class&amp;lt;T&amp;gt;&lt;/code&gt; vs &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt; çš„æ ¸å¿ƒåŒºåˆ«
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;Class&amp;lt;T&amp;gt;&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»å‹ç»‘å®š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿…é¡»æ˜ç¡®æŒ‡å®šå…·ä½“ç±»å‹ï¼ˆå¦‚ &lt;code&gt;String&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;ç±»å‹æœªçŸ¥ï¼Œå…¼å®¹æ‰€æœ‰ &lt;code&gt;Class&lt;/code&gt; ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»å‹å®‰å…¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹ä¸€è‡´æ€§ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆéœ€å¼ºåˆ¶è½¬æ¢æˆ–é¢å¤–ç±»å‹æ£€æŸ¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»å‹æ˜ç¡®æ—¶ï¼ˆå¦‚ååºåˆ—åŒ–ï¼‰&lt;/td&gt;
&lt;td&gt;åŠ¨æ€åå°„ã€é€šç”¨å·¥å…·ç±»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Class&amp;lt;String&amp;gt; clazz = String.class&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Class&amp;lt;?&amp;gt; clazz = Class.forName(&amp;quot;User&amp;quot;)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Class&amp;lt;T&amp;gt;&lt;/code&gt; ç”¨äº&lt;strong&gt;ç±»å‹ç¡®å®šçš„åœºæ™¯&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;T createInstance(Class&amp;lt;T&amp;gt; clazz)&lt;/code&gt;ï¼‰ï¼Œç¡®ä¿æ–¹æ³•è¾“å…¥è¾“å‡ºç±»å‹ä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt; ç”¨äº&lt;strong&gt;ç±»å‹åŠ¨æ€åŠ è½½çš„åœºæ™¯&lt;/strong&gt;ï¼ˆå¦‚æ’ä»¶ç³»ç»Ÿã€é…ç½®æ–‡ä»¶è¯»å–ç±»åï¼‰ï¼Œé¿å…ç¼–è¯‘æ—¶ç±»å‹çº¦æŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åœºæ™¯åˆ†æ"&gt;ğŸ› ï¸ å…¸å‹åœºæ™¯åˆ†æ
&lt;/h3&gt;&lt;h4 id="åå°„åŠ¨æ€åŠ è½½ç±»"&gt;&lt;strong&gt;åå°„åŠ¨æ€åŠ è½½ç±»&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;é€šè¿‡å­—ç¬¦ä¸²åŠ è½½ç±»æ—¶ï¼Œç±»å‹åœ¨ç¼–è¯‘æ—¶æœªçŸ¥ï¼Œå¿…é¡»ç”¨ &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;com.example.User&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// åŠ¨æ€åŠ è½½ï¼Œç±»å‹ä¸ç¡®å®š&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="é€šç”¨å·¥å…·æ–¹æ³•è®¾è®¡"&gt;&lt;strong&gt;é€šç”¨å·¥å…·æ–¹æ³•è®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;éœ€å…¼å®¹ä»»æ„ç±»å‹çš„æ–¹æ³•å‚æ•°æ—¶ï¼Œä½¿ç”¨é€šé…ç¬¦æå‡çµæ´»æ€§ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;printClassInfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ä¸ä¾èµ–å…·ä½“ç±»å‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="æ³›å‹ç±»ä¸åå°„ç»“åˆ"&gt;&lt;strong&gt;æ³›å‹ç±»ä¸åå°„ç»“åˆ&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;åå°„åˆ›å»ºæ³›å‹å¯¹è±¡æ—¶ï¼Œéœ€é€šè¿‡ &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt; è¿‡æ¸¡ï¼Œå†é€šè¿‡å¼ºåˆ¶è½¬æ¢æˆ–ç±»å‹æ•è·ï¼ˆType Captureï¼‰ç¡®å®šç±»å‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyGenericClass&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// æ— æ³•ç›´æ¥åˆ›å»ºæ³›å‹å®ä¾‹ï¼šMyGenericClass&amp;lt;String&amp;gt; obj = clazz.newInstance(); âŒ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// éœ€å¼ºåˆ¶è½¬æ¢ï¼ˆç‰ºç‰²éƒ¨åˆ†å®‰å…¨æ€§ï¼‰&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;MyGenericClass&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MyGenericClass&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newInstance&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æ›¿ä»£æ–¹æ¡ˆ"&gt;âš ï¸ æ³¨æ„äº‹é¡¹ä¸æ›¿ä»£æ–¹æ¡ˆ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¼ºåˆ¶è½¬æ¢çš„é£é™©&lt;/strong&gt;
ä» &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt; è½¬æ¢åˆ° &lt;code&gt;Class&amp;lt;T&amp;gt;&lt;/code&gt; å¯èƒ½å¼•å‘ &lt;code&gt;ClassCastException&lt;/code&gt;ï¼Œéœ€ç¡®ä¿ç±»å‹åŒ¹é…ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wildcardClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;specificClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wildcardClass&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// é£é™©æ“ä½œ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç±»å‹æ•è·ï¼ˆType Captureï¼‰&lt;/strong&gt;
é€šè¿‡æ³›å‹æ–¹æ³•æ•è·é€šé…ç¬¦çš„å…·ä½“ç±»å‹ï¼Œé¿å…å¼ºåˆ¶è½¬æ¢ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;safeCreate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Exception&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newInstance&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç±»å‹å®‰å…¨&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨ï¼šString s = safeCreate(String.class);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¿å…åŸå§‹ç±»å‹ &lt;code&gt;Class&lt;/code&gt;&lt;/strong&gt;
ä½¿ç”¨åŸå§‹ç±»å‹ &lt;code&gt;Class&lt;/code&gt;ï¼ˆæ— æ³›å‹ï¼‰ä¼šç»•è¿‡ç¼–è¯‘å™¨æ£€æŸ¥ï¼Œäº§ç”Ÿ &lt;code&gt;unchecked&lt;/code&gt; è­¦å‘Šï¼Œä¼˜å…ˆé€‰æ‹© &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt; ä¿ç•™æ³›å‹æ£€æŸ¥èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt; æˆ– &lt;code&gt;Constructor&amp;lt;?&amp;gt;&lt;/code&gt; çš„æœ¬è´¨æ˜¯ï¼šåœ¨æ³›å‹æ“¦é™¤çš„çº¦æŸä¸‹ï¼Œé€šè¿‡é€šé…ç¬¦ &lt;code&gt;?&lt;/code&gt; å¹³è¡¡ç±»å‹å®‰å…¨ä¸åŠ¨æ€çµæ´»æ€§ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;ä¼˜å…ˆ &lt;code&gt;Class&amp;lt;T&amp;gt;&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ç±»å‹æ˜ç¡®æ—¶ï¼ˆå¦‚ API è®¾è®¡éœ€å¼ºç±»å‹çº¦æŸï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;é€‰æ‹© &lt;code&gt;Class&amp;lt;?&amp;gt;&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ç±»å‹åŠ¨æ€åŠ è½½æˆ–éœ€å…¼å®¹æœªçŸ¥ç±»å‹æ—¶ï¼ˆå¦‚åå°„æ¡†æ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;æ…ç”¨åŸå§‹ç±»å‹&lt;/strong&gt;ï¼šé¿å…ç»•è¿‡æ³›å‹æ£€æŸ¥å¯¼è‡´è¿è¡Œæ—¶é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡åˆç†ä½¿ç”¨é€šé…ç¬¦å’Œç±»å‹æ•è·ï¼Œå¯åœ¨ä¿è¯å®‰å…¨æ€§çš„å‰æä¸‹æœ€å¤§åŒ–åå°„çš„çµæ´»æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="rtti"&gt;RTTI
&lt;/h2&gt;&lt;p&gt;åœ¨ Java ä¸­ï¼Œ&lt;strong&gt;RTTIï¼ˆRun-Time Type Identificationï¼Œè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼‰&lt;/strong&gt; æ˜¯ä¸€ç§å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€è¯†åˆ«å¯¹è±¡å®é™…ç±»å‹çš„æœºåˆ¶ã€‚å®ƒæ˜¯ Java å¤šæ€æ€§çš„é‡è¦æ”¯æ’‘ï¼Œä½¿ä»£ç èƒ½å¤ŸåŸºäºå¯¹è±¡çš„å…·ä½“ç±»å‹æ‰§è¡Œä¸åŒæ“ä½œã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæ¦‚å¿µã€å®ç°æ–¹å¼ã€åº”ç”¨åœºæ™¯åŠä¸åå°„çš„åŒºåˆ«å±•å¼€è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-rtti-çš„æ ¸å¿ƒåŸç†"&gt;ğŸ” &lt;strong&gt;RTTI çš„æ ¸å¿ƒåŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹ä¿¡æ¯çš„åŠ¨æ€ç»‘å®š&lt;/strong&gt;
Java çš„å¤šæ€æ€§å…è®¸é€šè¿‡åŸºç±»å¼•ç”¨è°ƒç”¨å­ç±»æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;Shape&lt;/code&gt; å¼•ç”¨è°ƒç”¨ &lt;code&gt;Circle.draw()&lt;/code&gt;ï¼‰ï¼Œä½†æœ‰æ—¶éœ€åœ¨è¿è¡Œæ—¶ç¡®å®šå¯¹è±¡çš„ç²¾ç¡®ç±»å‹ï¼ˆä¾‹å¦‚åˆ¤æ–­æ˜¯ &lt;code&gt;Circle&lt;/code&gt; è¿˜æ˜¯ &lt;code&gt;Square&lt;/code&gt;ï¼‰ã€‚RTTI é€šè¿‡ &lt;code&gt;Class&lt;/code&gt; å¯¹è±¡å®ç°è¿™ä¸€èƒ½åŠ›ï¼Œè¯¥å¯¹è±¡åœ¨ç±»åŠ è½½æ—¶ç”± JVM åˆ›å»ºï¼Œå­˜å‚¨ç±»çš„å…ƒæ•°æ®ï¼ˆç±»åã€çˆ¶ç±»ã€æ–¹æ³•ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ä¼ ç»Ÿå¤šæ€çš„å…³ç³»&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ€&lt;/strong&gt;ï¼šåŸºç±»å¼•ç”¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œå®é™…æ‰§è¡Œå­ç±»é‡å†™çš„æ–¹æ³•ï¼ˆåŠ¨æ€ç»‘å®šï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RTTI&lt;/strong&gt;ï¼šåœ¨åŠ¨æ€ç»‘å®šçš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥è¯†åˆ«å¯¹è±¡çš„&lt;strong&gt;å…·ä½“å­ç±»ç±»å‹&lt;/strong&gt;ï¼Œç”¨äºç±»å‹æ£€æŸ¥æˆ–å¼ºåˆ¶è½¬æ¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-rtti-çš„å®ç°æ–¹å¼"&gt;âš™ï¸ &lt;strong&gt;RTTI çš„å®ç°æ–¹å¼&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Java æä¾›ä¸‰ç§ä¸»è¦æ–¹å¼å®ç° RTTIï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;instanceof&lt;/code&gt; å…³é”®å­—&lt;/strong&gt;
æ£€æŸ¥å¯¹è±¡æ˜¯å¦å±äºç‰¹å®šç±»æˆ–å…¶å­ç±»ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;instanceof&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å®‰å…¨å‘ä¸‹è½¬å‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šé¿å… &lt;code&gt;ClassCastException&lt;/code&gt;ï¼Œç¡®ä¿ç±»å‹è½¬æ¢å®‰å…¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;getClass()&lt;/code&gt; æ–¹æ³•&lt;/strong&gt;
è¿”å›å¯¹è±¡çš„è¿è¡Œæ—¶ç±»å¯¹åº”çš„ &lt;code&gt;Class&lt;/code&gt; å¯¹è±¡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getClass&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clazz&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è¾“å‡º &amp;#34;Circle&amp;#34;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼šç²¾ç¡®è·å–å¯¹è±¡ç±»å‹ï¼Œæ— è§†ç»§æ‰¿å…³ç³»ï¼ˆ&lt;code&gt;Circle&lt;/code&gt; çš„ &lt;code&gt;getClass()&lt;/code&gt; ä¸ä¼šè¿”å› &lt;code&gt;Shape&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ˜¾å¼ç±»å‹è½¬æ¢ä¸ &lt;code&gt;Class&lt;/code&gt; å¯¹è±¡&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘ä¸‹è½¬å‹ï¼ˆDowncastingï¼‰æ—¶ï¼ŒRTTI è‡ªåŠ¨è¿›è¡Œç±»å‹æ£€æŸ¥ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è¿è¡Œæ—¶æ£€æŸ¥ç±»å‹æ˜¯å¦åŒ¹é…&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;ç›´æ¥æ“ä½œ Class å¯¹è±¡ï¼ˆéœ€ç¼–è¯‘æ—¶å·²çŸ¥ç±»å‹ï¼‰ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circleClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circleClass&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newInstance&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// åˆ›å»ºå®ä¾‹&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;æ³¨æ„ï¼šæ­¤æ–¹å¼ä¾èµ–ç¼–è¯‘æ—¶å·²çŸ¥çš„ç±»åã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-rtti-çš„å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ› ï¸ &lt;strong&gt;RTTI çš„å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨å‘ä¸‹è½¬å‹&lt;/strong&gt;
åœ¨æ³›å‹é›†åˆä¸­å–å‡ºå¯¹è±¡åï¼Œéœ€è½¬å‹å›å…·ä½“ç±»å‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Shape&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;asList&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Square&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;instanceof&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Circle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// RTTI ç¡®ä¿å®‰å…¨&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circle&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;draw&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ç±»å‹æ£€æŸ¥&lt;/strong&gt;
æ¡†æ¶ä¸­æ ¹æ®å¯¹è±¡ç±»å‹æ‰§è¡Œä¸åŒé€»è¾‘ï¼ˆå¦‚äº‹ä»¶å¤„ç†å™¨åˆ†å‘ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“åˆå¤šæ€æ‰©å±•åŠŸèƒ½&lt;/strong&gt;
å½“å­ç±»æœ‰ç‰¹æ®Šæ–¹æ³•æ—¶ï¼Œé€šè¿‡ RTTI è¯†åˆ«å¹¶è°ƒç”¨ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;instanceof&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Triangle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Triangle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="na"&gt;specialMethod&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç‰¹å®šå­ç±»æ“ä½œ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-rtti-ä¸åå°„çš„åŒºåˆ«"&gt;â†”ï¸ &lt;strong&gt;RTTI ä¸åå°„çš„åŒºåˆ«&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å°½ç®¡ä¸¤è€…å‡ä¾èµ– &lt;code&gt;Class&lt;/code&gt; å¯¹è±¡ï¼Œä½†æ ¸å¿ƒå·®å¼‚åœ¨äº&lt;strong&gt;ç±»å‹ä¿¡æ¯çš„è·å–æ—¶æœº&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RTTI&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åå°„ï¼ˆReflectionï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç±»å‹å·²çŸ¥æ—¶æœº&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼–è¯‘æ—¶å·²çŸ¥ï¼ˆå¦‚ &lt;code&gt;Circle.class&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;è¿è¡Œæ—¶åŠ¨æ€è§£æï¼ˆå¦‚ &lt;code&gt;Class.forName(&amp;quot;æœªçŸ¥ç±»&amp;quot;)&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;èƒ½åŠ›èŒƒå›´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»å‹æ£€æŸ¥ã€ç®€å•å®ä¾‹åŒ–&lt;/td&gt;
&lt;td&gt;åŠ¨æ€è°ƒç”¨æ–¹æ³•ã€è®¿é—®ç§æœ‰å­—æ®µã€ä¿®æ”¹æ³¨è§£ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒä½ï¼ˆJVM ä¼˜åŒ–ï¼‰&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ï¼ˆéœ€è¿è¡Œæ—¶è§£æå…ƒæ•°æ®ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç±»å‹å®‰å…¨è½¬æ¢ã€å¤šæ€æ‰©å±•&lt;/td&gt;
&lt;td&gt;æ¡†æ¶å¼€å‘ï¼ˆSpring DIï¼‰ã€åºåˆ—åŒ–å·¥å…·ï¼ˆJSON åº“ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æœ¬è´¨è”ç³»&lt;/strong&gt;ï¼š
RTTI æ˜¯åå°„çš„åŸºç¡€ï¼Œåå°„æ˜¯ RTTI çš„&lt;strong&gt;è¶…é›†&lt;/strong&gt;ã€‚RTTI å¤„ç†ç¼–è¯‘æ—¶å·²çŸ¥çš„ç±»å‹ï¼Œåå°„åˆ™çªç ´æ­¤é™åˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-rtti-çš„æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;RTTI çš„æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;
é¢‘ç¹ä½¿ç”¨ &lt;code&gt;instanceof&lt;/code&gt; æˆ– &lt;code&gt;getClass()&lt;/code&gt; å¯èƒ½å½±å“æ€§èƒ½ï¼Œå°¤å…¶åœ¨å¾ªç¯ä¸­ã€‚å»ºè®®ä¼˜å…ˆä½¿ç”¨å¤šæ€è®¾è®¡æ›¿ä»£ RTTIã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡åŸåˆ™&lt;/strong&gt;
è¿‡åº¦ä¾èµ– RTTI å¯èƒ½ç ´åå¤šæ€æ€§ï¼Œå¯¼è‡´ä»£ç å†—ä½™ã€‚ä¾‹å¦‚ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;// ä¸æ¨èï¼šç”¨ RTTI æ›¿ä»£å¤šæ€
if (shape instanceof Circle) { ... }
else if (shape instanceof Square) { ... }
&lt;/code&gt;&lt;/pre&gt;&lt;strong&gt;æ”¹è¿›æ–¹æ¡ˆ&lt;/strong&gt;ï¼šå°†å·®å¼‚é€»è¾‘å°è£…åˆ°å­ç±»æ–¹æ³•ä¸­ï¼Œé€šè¿‡ &lt;code&gt;shape.draw()&lt;/code&gt; ç»Ÿä¸€è°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹è½¬æ¢å®‰å…¨&lt;/strong&gt;
å‘ä¸‹è½¬å‹å‰å¿…é¡»ç”¨ &lt;code&gt;instanceof&lt;/code&gt; æ£€æŸ¥ï¼Œå¦åˆ™å¯èƒ½æŠ›å‡º &lt;code&gt;ClassCastException&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RTTI æ˜¯ä»€ä¹ˆ&lt;/strong&gt;ï¼šè¿è¡Œæ—¶è¯†åˆ«å¯¹è±¡ç±»å‹çš„èƒ½åŠ›ï¼Œæ”¯æ’‘ Java å¤šæ€ä¸ç±»å‹å®‰å…¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šåœ¨ç¼–è¯‘æ—¶å·²çŸ¥ç±»å‹çš„å‰æä¸‹ï¼Œå®ç°&lt;strong&gt;å®‰å…¨ç±»å‹è½¬æ¢&lt;/strong&gt;å’Œ&lt;strong&gt;ç²¾ç»†åŒ–çš„ç±»å‹æ§åˆ¶&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨è¾¹ç•Œ&lt;/strong&gt;ï¼šé€‚åˆç±»å‹æ˜ç¡®çš„åœºæ™¯ï¼ˆå¦‚é›†åˆå…ƒç´ å¤„ç†ï¼‰ï¼Œé¿å…æ›¿ä»£å¤šæ€è®¾è®¡ï¼›è‹¥éœ€æ“ä½œå®Œå…¨æœªçŸ¥çš„ç±»ï¼Œåº”ä½¿ç”¨åå°„ã€‚
é€šè¿‡åˆç†è¿ç”¨ RTTIï¼Œå¼€å‘è€…èƒ½åœ¨ä¿è¯ç±»å‹å®‰å…¨çš„åŒæ—¶ï¼Œå¢å¼ºä»£ç çš„åŠ¨æ€çµæ´»æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Javaã€‘åŠ¨æ€ä»£ç†</title><link>https://dyhes.github.io/p/java%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/</link><pubDate>Tue, 17 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/java%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/</guid><description>&lt;p&gt;åŠ¨æ€ä»£ç†ï¼ˆDynamic Proxyï¼‰æ˜¯ä¸€ç§åœ¨&lt;strong&gt;ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡&lt;/strong&gt;çš„æŠ€æœ¯ï¼Œç”¨äºåœ¨ä¸ä¿®æ”¹åŸå§‹ç±»ä»£ç çš„å‰æä¸‹ï¼Œæ‹¦æˆªå¹¶å¢å¼ºç›®æ ‡å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºå®ç°&lt;strong&gt;é€»è¾‘ä¸ä¸šåŠ¡è§£è€¦&lt;/strong&gt;ï¼Œå¹¿æ³›åº”ç”¨äºæ—¥å¿—è®°å½•ã€äº‹åŠ¡ç®¡ç†ã€æƒé™æ§åˆ¶ç­‰åœºæ™¯ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸åŸç†"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç†çš„æœ¬è´¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é™æ€ä»£ç†&lt;/strong&gt;ï¼šéœ€é¢„å…ˆç¼–å†™ä»£ç†ç±»ï¼Œæ¯ä¸ªç›®æ ‡ç±»éœ€å¯¹åº”ä¸€ä¸ªä»£ç†ç±»ï¼Œä»£ç å†—ä½™åº¦é«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€ä»£ç†&lt;/strong&gt;ï¼šåœ¨è¿è¡Œæ—¶é€šè¿‡åå°„æˆ–å­—èŠ‚ç æŠ€æœ¯ï¼ˆå¦‚JDK Proxyã€CGLIBï¼‰åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‹¦æˆªæœºåˆ¶&lt;/strong&gt;ï¼šä»£ç†å¯¹è±¡æ‹¦æˆªæ‰€æœ‰æ–¹æ³•è°ƒç”¨ï¼Œè½¬å‘ç»™å…³è”çš„å¤„ç†å™¨ï¼ˆå¦‚&lt;code&gt;InvocationHandler&lt;/code&gt;æˆ–&lt;code&gt;MethodInterceptor&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢å¼ºé€»è¾‘&lt;/strong&gt;ï¼šåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰åæ’å…¥è‡ªå®šä¹‰æ“ä½œï¼ˆå¦‚æ—¥å¿—è®°å½•ã€æƒé™æ ¡éªŒï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°æ–¹å¼ä»¥javaä¸ºä¾‹"&gt;ğŸ› ï¸ &lt;strong&gt;å®ç°æ–¹å¼ï¼ˆä»¥Javaä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="jdkåŠ¨æ€ä»£ç†åŸºäºæ¥å£"&gt;&lt;strong&gt;JDKåŠ¨æ€ä»£ç†ï¼ˆåŸºäºæ¥å£ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¦æ±‚&lt;/strong&gt;ï¼šç›®æ ‡ç±»å¿…é¡»å®ç°è‡³å°‘ä¸€ä¸ªæ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒç±»ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Proxy&lt;/code&gt;ï¼šç”Ÿæˆä»£ç†å¯¹è±¡ï¼ˆ&lt;code&gt;Proxy.newProxyInstance()&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;InvocationHandler&lt;/code&gt;ï¼šå®šä¹‰æ‹¦æˆªé€»è¾‘ï¼ˆ&lt;code&gt;invoke()&lt;/code&gt;æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LogHandler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;InvocationHandler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;invoke&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Method&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Throwable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Before method: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;invoke&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨ç›®æ ‡æ–¹æ³•&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;After method: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// ç”Ÿæˆä»£ç†å¯¹è±¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Service&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Service&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Proxy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newProxyInstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getClass&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getClassLoader&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getClass&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getInterfaces&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LogHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="cglibåŠ¨æ€ä»£ç†åŸºäºç»§æ‰¿"&gt;&lt;strong&gt;CGLIBåŠ¨æ€ä»£ç†ï¼ˆåŸºäºç»§æ‰¿ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¦æ±‚&lt;/strong&gt;ï¼šå¯ä»£ç†æ™®é€šç±»ï¼ˆæ— æ³•ä»£ç†&lt;code&gt;final&lt;/code&gt;ç±»æˆ–æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒç±»ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Enhancer&lt;/code&gt;ï¼šç”Ÿæˆä»£ç†ç±»ï¼ˆç»§æ‰¿ç›®æ ‡ç±»ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MethodInterceptor&lt;/code&gt;ï¼šå®šä¹‰æ‹¦æˆªé€»è¾‘ï¼ˆ&lt;code&gt;intercept()&lt;/code&gt;æ–¹æ³•ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CglibInterceptor&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MethodInterceptor&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;intercept&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Method&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MethodProxy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;throws&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Throwable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Before method: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;invokeSuper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒç”¨çˆ¶ç±»ï¼ˆç›®æ ‡ç±»ï¼‰æ–¹æ³•&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;After method: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// ç”Ÿæˆä»£ç†å¯¹è±¡&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Enhancer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enhancer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Enhancer&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;enhancer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setSuperclass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TargetClass&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;enhancer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setCallback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CglibInterceptor&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;TargetClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TargetClass&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enhancer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="jdkä»£ç†-vs-cglibä»£ç†å¯¹æ¯”"&gt;&lt;strong&gt;JDKä»£ç† vs CGLIBä»£ç†å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;JDKåŠ¨æ€ä»£ç†&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CGLIBåŠ¨æ€ä»£ç†&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä»£ç†å¯¹è±¡è¦æ±‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¿…é¡»å®ç°æ¥å£&lt;/td&gt;
&lt;td&gt;å¯ä»£ç†ä»»æ„æ™®é€šç±»ï¼ˆé&lt;code&gt;final&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åå°„&lt;/td&gt;
&lt;td&gt;å­—èŠ‚ç å¢å¼ºï¼ˆASMæ¡†æ¶ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è°ƒç”¨é€Ÿåº¦è¾ƒæ…¢ï¼ˆåå°„å¼€é”€ï¼‰&lt;/td&gt;
&lt;td&gt;ç”Ÿæˆå¿«ï¼Œè°ƒç”¨å¿«ï¼ˆç›´æ¥è°ƒç”¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¾èµ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;JavaåŸç”Ÿæ”¯æŒ&lt;/td&gt;
&lt;td&gt;éœ€å¼•å…¥CGLIBåº“&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;â­ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—¥å¿—è®°å½•&lt;/strong&gt;ï¼šåœ¨æ–¹æ³•è°ƒç”¨å‰åè‡ªåŠ¨è®°å½•å‚æ•°ã€è¿”å›å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹åŠ¡ç®¡ç†&lt;/strong&gt;ï¼šæ–¹æ³•æ‰§è¡Œå‰å¼€å¯äº‹åŠ¡ï¼Œæ‰§è¡Œåæäº¤æˆ–å›æ»šï¼ˆå¦‚Spring &lt;code&gt;@Transactional&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™æ§åˆ¶&lt;/strong&gt;ï¼šæ‹¦æˆªæ–¹æ³•è°ƒç”¨ï¼Œæ ¡éªŒç”¨æˆ·æƒé™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡†æ¶é›†æˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Spring AOP&lt;/strong&gt;ï¼šé»˜è®¤ä½¿ç”¨JDKä»£ç†ï¼ˆæ¥å£ï¼‰æˆ–CGLIBï¼ˆæ— æ¥å£ç±»ï¼‰å®ç°åˆ‡é¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MyBatis&lt;/strong&gt;ï¼šåŠ¨æ€ä»£ç†Mapperæ¥å£ï¼Œè‡ªåŠ¨ç”ŸæˆSQLæ‰§è¡Œé€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RPCæ¡†æ¶ï¼ˆå¦‚Dubboï¼‰&lt;/strong&gt;ï¼šä»£ç†è¿œç¨‹æœåŠ¡æ¥å£ï¼Œå°è£…ç½‘ç»œé€šä¿¡ç»†èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿ŸåŠ è½½&lt;/strong&gt;ï¼šä»£ç†å¯¹è±¡æŒ‰éœ€åŠ è½½èµ„æºï¼ˆå¦‚Hibernateæ‡’åŠ è½½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜ç®¡ç†&lt;/strong&gt;ï¼šæ–¹æ³•è°ƒç”¨å‰æŸ¥è¯¢ç¼“å­˜sï¼Œå‘½ä¸­åˆ™ç›´æ¥è¿”å›ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜ç¼ºç‚¹åˆ†æ"&gt;âš–ï¸ &lt;strong&gt;ä¼˜ç¼ºç‚¹åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ— ä¾µå…¥æ€§&lt;/strong&gt;ï¼šä¸ä¿®æ”¹ç›®æ ‡ç±»ä»£ç ï¼Œå®ç°åŠŸèƒ½å¢å¼ºã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å¼€é”€&lt;/strong&gt;ï¼šåå°„æˆ–å­—èŠ‚ç ç”Ÿæˆå¯¼è‡´è°ƒç”¨é€Ÿåº¦ç•¥ä½äºç›´æ¥è°ƒç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è§£è€¦è®¾è®¡&lt;/strong&gt;ï¼šåˆ†ç¦»æ ¸å¿ƒä¸šåŠ¡ä¸æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€äº‹åŠ¡ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ä½¿ç”¨é™åˆ¶&lt;/strong&gt;ï¼šJDKä»£ç†éœ€æ¥å£ï¼ŒCGLIBæ— æ³•ä»£ç†&lt;code&gt;final&lt;/code&gt;æ–¹æ³•ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çµæ´»æ‰©å±•&lt;/strong&gt;ï¼šåŠ¨æ€è°ƒæ•´ä»£ç†é€»è¾‘ï¼Œé€‚åº”å¤šå˜éœ€æ±‚ã€‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;å¤æ‚åº¦&lt;/strong&gt;ï¼šä»£ç†é“¾è¿‡é•¿å¯èƒ½å¢åŠ è°ƒè¯•éš¾åº¦ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;åŠ¨æ€ä»£ç†æ˜¯&lt;strong&gt;è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡&lt;/strong&gt;çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œé€šè¿‡&lt;strong&gt;æ‹¦æˆªæ–¹æ³•è°ƒç”¨&lt;/strong&gt;å®ç°åŠŸèƒ½å¢å¼ºï¼Œå…¶ä»·å€¼åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è§£è€¦ä¸šåŠ¡ä¸éåŠŸèƒ½æ€§éœ€æ±‚&lt;/strong&gt;ï¼ˆå¦‚æ—¥å¿—ã€äº‹åŠ¡ï¼‰ï¼Œæå‡ä»£ç å¯ç»´æŠ¤æ€§ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¯æ’‘ä¸»æµæ¡†æ¶&lt;/strong&gt;ï¼ˆå¦‚Spring AOPã€MyBatisï¼‰ï¼Œç®€åŒ–å¼€å‘æµç¨‹ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§å¼º&lt;/strong&gt;ï¼Œå¯çµæ´»é€‚åº”å¤æ‚ä¸šåŠ¡åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;ä½¿ç”¨å»ºè®®&lt;/strong&gt;ï¼šä¼˜å…ˆé€‰æ‹©JDKä»£ç†ï¼ˆç›®æ ‡ç±»æœ‰æ¥å£ï¼‰ï¼Œæ— æ¥å£æ—¶ç”¨CGLIBï¼›é¿å…è¿‡åº¦ä»£ç†å¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œå¯é€šè¿‡ç¼“å­˜ä»£ç†ç±»ä¼˜åŒ–æ•ˆç‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>ã€Javaã€‘å¯¹è±¡å¥‘çº¦</title><link>https://dyhes.github.io/p/java%E5%AF%B9%E8%B1%A1%E5%A5%91%E7%BA%A6/</link><pubDate>Tue, 17 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/java%E5%AF%B9%E8%B1%A1%E5%A5%91%E7%BA%A6/</guid><description>&lt;p&gt;Javaå¯¹è±¡å¥‘çº¦ï¼ˆObject Contractï¼‰æŒ‡Javaä¸­æ‰€æœ‰å¯¹è±¡å¿…é¡»éµå®ˆçš„è¡Œä¸ºè§„èŒƒï¼Œè¿™äº›è§„èŒƒç”±Objectç±»å®šä¹‰çš„æ ¸å¿ƒæ–¹æ³•çº¦å®šæ„æˆï¼Œç¡®ä¿å¯¹è±¡åœ¨é›†åˆæ“ä½œã€æ¯”è¾ƒã€å¤šçº¿ç¨‹äº¤äº’ç­‰åœºæ™¯ä¸‹è¡Œä¸ºä¸€è‡´ä¸”å¯é ã€‚ä»¥ä¸‹æ˜¯å…³é”®ç»„æˆéƒ¨åˆ†åŠå…¶å®è´¨ï¼š&lt;/p&gt;
&lt;h3 id="-æ ¸å¿ƒæ–¹æ³•å¥‘çº¦"&gt;âš–ï¸ æ ¸å¿ƒæ–¹æ³•å¥‘çº¦
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;equals()æ–¹æ³•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¥‘çº¦è¦æ±‚&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåæ€§&lt;/strong&gt;ï¼šx.equals(x)å¿…é¡»è¿”å›trueã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹ç§°æ€§&lt;/strong&gt;ï¼šè‹¥x.equals(y)ä¸ºtrueï¼Œåˆ™y.equals(x)ä¹Ÿå¿…é¡»ä¸ºtrueã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼ é€’æ€§&lt;/strong&gt;ï¼šè‹¥x.equals(y)ä¸”y.equals(z)ï¼Œåˆ™x.equals(z)éœ€æˆç«‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;ï¼šå¤šæ¬¡è°ƒç”¨ç»“æœç›¸åŒï¼ˆå¯¹è±¡æœªä¿®æ”¹æ—¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éç©ºæ€§&lt;/strong&gt;ï¼šx.equals(null)è¿”å›falseã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‹¥é‡å†™&lt;code&gt;equals()&lt;/code&gt;ä½†æœªåŒæ­¥é‡å†™&lt;code&gt;hashCode()&lt;/code&gt;ï¼Œä¼šè¿åå¥‘çº¦ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;hashCode()æ–¹æ³•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¥‘çº¦è¦æ±‚&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥x.equals(y)==trueï¼Œåˆ™&lt;code&gt;x.hashCode() == y.hashCode()&lt;/code&gt;&lt;strong&gt;å¿…é¡»æˆç«‹&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åŒä¸€å¯¹è±¡å¤šæ¬¡è°ƒç”¨ç»“æœä¸€è‡´ï¼ˆæœªä¿®æ”¹æ—¶ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©åœºæ™¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æœªåŒæ­¥é‡å†™hashCode()æ—¶ï¼Œä¸¤ä¸ªé€»è¾‘ç›¸ç­‰çš„å¯¹è±¡åœ¨HashMapä¸­å¯èƒ½è¢«å­˜å‚¨åˆ°ä¸åŒæ¡¶ä½ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–æ£€ç´¢å¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;toString()æ–¹æ³•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éšå«å¥‘çº¦&lt;/strong&gt;ï¼šè¿”å›æ¸…æ™°æè¿°å¯¹è±¡çŠ¶æ€çš„å­—ç¬¦ä¸²ï¼ˆéå¼ºåˆ¶ï¼Œä½†ä¸ºæœ€ä½³å®è·µï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é»˜è®¤å®ç°ï¼ˆå¦‚&lt;code&gt;ClassName@hashCode&lt;/code&gt;ï¼‰é€šå¸¸éœ€é‡å†™ä»¥æå‡å¯è¯»æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;clone()æ–¹æ³•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¥‘çº¦è¦æ±‚&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€å®ç°&lt;code&gt;Cloneable&lt;/code&gt;æ ‡è®°æ¥å£ï¼ˆå¦åˆ™æŠ›å¼‚å¸¸ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é»˜è®¤å®ç°ä¸º&lt;strong&gt;æµ…æ‹·è´&lt;/strong&gt;ï¼Œéœ€é‡å†™ä»¥å®ç°æ·±æ‹·è´ï¼ˆå¦‚é€’å½’è°ƒç”¨å­å¯¹è±¡clone()ï¼‰ã€‚&lt;br&gt;
â €&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-å¥‘çº¦å¼è®¾è®¡design-by-contractçš„æ‰©å±•"&gt;ğŸ”— å¥‘çº¦å¼è®¾è®¡ï¼ˆDesign by Contractï¼‰çš„æ‰©å±•
&lt;/h3&gt;&lt;p&gt;Javaè™½æœªåŸç”Ÿæ”¯æŒå¥‘çº¦å¼ç¼–ç¨‹ï¼ˆDbCï¼‰ï¼Œä½†é€šè¿‡å·¥å…·å’Œæ³¨è§£æ¨¡æ‹Ÿç±»ä¼¼æ€æƒ³ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Contract&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;null -&amp;gt; fail; !null -&amp;gt; !null&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// å‚æ•°éç©ºåˆ™è¿”å›éç©º&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;trim&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è‹¥ä¼ å…¥nullï¼ŒIDEæç¤ºè¿åå¥‘çº¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Objects.requireNonNull()&lt;/strong&gt; ï¼šæ˜¾å¼å®ˆå«å‰ç½®æ¡ä»¶ï¼ˆå¦‚å‚æ•°éç©ºï¼‰ã€‚
â €&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-å®é™…åº”ç”¨åœºæ™¯"&gt;âš™ï¸ å®é™…åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é›†åˆæ¡†æ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HashMap&lt;/code&gt;ä¾èµ–&lt;code&gt;hashCode()&lt;/code&gt;å’Œ&lt;code&gt;equals()&lt;/code&gt;å®šä½é”®å€¼å¯¹ã€‚è¿åå¥‘çº¦ä¼šå¯¼è‡´æ•°æ®é‡å¤æˆ–ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HashSet&lt;/code&gt;å†…éƒ¨ä½¿ç”¨&lt;code&gt;HashMap&lt;/code&gt;ï¼Œç›¸åŒçº¦æŸé€‚ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº¿ç¨‹åä½œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;wait()&lt;/code&gt;, &lt;code&gt;notify()&lt;/code&gt;, &lt;code&gt;notifyAll()&lt;/code&gt;çš„è°ƒç”¨éœ€åœ¨&lt;code&gt;synchronized&lt;/code&gt;å—ä¸­ï¼Œå¦åˆ™æŠ›&lt;code&gt;IllegalMonitorStateException&lt;/code&gt;ï¼Œè¿™æ˜¯éšå«çš„çº¿ç¨‹å®‰å…¨å¥‘çº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡åºåˆ—åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®ç°&lt;code&gt;Serializable&lt;/code&gt;æ¥å£ï¼ˆæ ‡è®°æ¥å£ï¼‰å³æ‰¿è¯ºå¯¹è±¡å¯è¢«åºåˆ—åŒ–ï¼Œéœ€ä¿è¯ï¼š
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰å­—æ®µå¯åºåˆ—åŒ–&lt;/li&gt;
&lt;li&gt;æˆ–æ ‡è®°ä¸º&lt;code&gt;transient&lt;/code&gt;&lt;br&gt;
â €&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="-é‡è¦æ€§æ€»ç»“"&gt;ğŸ’ é‡è¦æ€§æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¡Œä¸ºä¸€è‡´æ€§&lt;/strong&gt; ï¼šç¡®ä¿å¯¹è±¡åœ¨é›†åˆã€æ¯”è¾ƒã€å¹¶å‘ç­‰åœºæ™¯ä¸‹è¡Œä¸ºå¯é ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡†æ¶å…¼å®¹æ€§&lt;/strong&gt; ï¼šJavaé›†åˆã€åºåˆ—åŒ–ã€åå°„ç­‰æœºåˆ¶ä¾èµ–å¯¹è±¡å¥‘çº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç å¥å£®æ€§&lt;/strong&gt; ï¼šéµå®ˆå¥‘çº¦å¯é¿å…éšè”½Bugï¼ˆå¦‚HashMapé€»è¾‘é”™è¯¯ï¼‰ã€‚
â €âš ï¸ &lt;strong&gt;å…³é”®æç¤º&lt;/strong&gt; ï¼šé‡å†™equals()æ—¶&lt;strong&gt;å¿…é¡»åŒæ­¥é‡å†™&lt;/strong&gt;hashCode()ï¼Œå¦åˆ™ç ´åå¥‘çº¦å¯¼è‡´ç¨‹åºæœªå®šä¹‰è¡Œä¸ºã€‚è¿™æ˜¯Javaå¼€å‘ä¸­æœ€å¸¸è§çš„å¥‘çº¦è¿ååœºæ™¯ä¹‹ä¸€ã€‚&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Javaã€‘String split</title><link>https://dyhes.github.io/p/javastring-split/</link><pubDate>Mon, 23 Sep 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javastring-split/</guid><description>&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;parts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;\\.&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è€Œé&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;parts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;\.&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>ã€Javaã€‘Enum</title><link>https://dyhes.github.io/p/javaenum/</link><pubDate>Sun, 14 Jul 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javaenum/</guid><description>&lt;img src="https://dyhes.github.io/covers/cover19.png" alt="Featured image of post ã€Javaã€‘Enum" /&gt;&lt;p&gt;Java enums are a special type of class used to define collections of constants. They provide a way to represent a fixed set of values, which can be useful for categorizing data and ensuring type safety.&lt;/p&gt;
&lt;h2 id="key-points"&gt;Key Points
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Implicitly final and static: Enum constants are implicitly public, static, and final.&lt;/li&gt;
&lt;li&gt;values() method: Every enum has a static values() method that returns an array of all enum constants.&lt;/li&gt;
&lt;li&gt;valueOf(String) method: This static method returns the &lt;strong&gt;enum constant&lt;/strong&gt; with the specified name.&lt;/li&gt;
&lt;li&gt;The name() method returns the name of the enum constant as declared in its enum declaration. It&amp;rsquo;s an instance method available on all enum constants.&lt;/li&gt;
&lt;li&gt;valueOf(String) and name() provide a way to convert between the Enum and String.&lt;/li&gt;
&lt;li&gt;ordinal() method: Returns the &lt;strong&gt;position&lt;/strong&gt; of the enum constant (zero-based).&lt;/li&gt;
&lt;li&gt;Constructors, Fields, and Methods: Enums can have constructors, fields, and methods, allowing you to associate data and behavior with each constant.&lt;/li&gt;
&lt;li&gt;Implementing Interfaces: Enums can implement interfaces, providing a way to define behavior for each constant.&lt;/li&gt;
&lt;li&gt;EnumSet and EnumMap: These are specialized Set and Map implementations for use with enum types, offering &lt;strong&gt;better performance&lt;/strong&gt; than their general-purpose counterparts.&lt;/li&gt;
&lt;li&gt;Constant-specific method implementation: You can &lt;strong&gt;override methods for specific enum&lt;/strong&gt; constants, allowing for different behavior per constant.&lt;/li&gt;
&lt;li&gt;Abstract methods in enums: You can define abstract methods in an enum, forcing each constant to provide its own implementation.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="example"&gt;example
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// Basic enum definition&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;enum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Day&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MONDAY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TUESDAY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;WEDNESDAY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;THURSDAY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FRIDAY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SATURDAY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SUNDAY&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// Enum with constructor, fields, and methods&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;enum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Planet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MERCURY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;303e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;23&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;4397e6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VENUS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;869e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;24&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;0518e6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EARTH&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;976e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;24&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;37814e6&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mass&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// in kilograms&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// in meters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Planet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mass&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;mass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mass&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;radius&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;getMass&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mass&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;getRadius&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Enum constant-specific method implementation&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;surfaceGravity&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;67300E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;11&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;// Usage examples&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;EnumExample&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Basic usage&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Day&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Day&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MONDAY&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Today is &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Switch statement with enum&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MONDAY&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Start of the work week&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FRIDAY&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;TGIF!&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Midweek&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Using enum methods&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Planet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;earth&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Planet&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;EARTH&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Earth&amp;#39;s mass: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;earth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMass&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Earth&amp;#39;s surface gravity: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;earth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;surfaceGravity&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Iterating over enum values&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Planet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;planet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Planet&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;values&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;planet&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;name&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;planet&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;surfaceGravity&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="usage-with-pageable"&gt;Usage with Pageable
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;enum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserSortField&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FIRST_NAME&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;firstName&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LAST_NAME&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;lastName&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EMAIL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;email&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CREATED_DATE&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;createdDate&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fieldName&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserSortField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fiel&lt;/span&gt;&lt;span class="err"&gt;&lt;/span&gt;&lt;span class="n"&gt;dName&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;fieldName&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fieldName&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;getFieldName&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fieldName&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@RestController&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@RequestMapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;/api/users&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserController&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Autowired&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserService&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userService&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GetMapping&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ResponseEntity&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;getAllUsers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@RequestParam&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defaultValue&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@RequestParam&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defaultValue&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;10&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@RequestParam&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defaultValue&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserSortField&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sortBy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userPage&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userService&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAllUsers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sortBy&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ... rest of the method remains the same&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Service&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserService&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Autowired&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserRepository&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userRepository&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;getAllUsers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserSortField&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sortBy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pageable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pageable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PageRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;of&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Sort&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sortBy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getFieldName&lt;/span&gt;&lt;span class="p"&gt;()));&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userRepository&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pageable&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="usage-with-spring-data-jpa"&gt;Usage with Spring Data JPA
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;enum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Status&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ACTIVE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;INACTIVE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PENDING&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;javax.persistence.*&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strategy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GenerationType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;IDENTITY&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Enumerated&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EnumType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;STRING&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Status&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The @Enumerated annotation is used to specify how the Enum should be persisted in the database. There are two options:&lt;/p&gt;
&lt;p&gt;EnumType.ORDINAL: Stores the Enum as an integer (the ordinal value of the Enum constant).
EnumType.STRING: Stores the Enum as a string (the name of the Enum constant).&lt;/p&gt;
&lt;h3 id="enumtypeordinal"&gt;EnumType.ORDINAL
&lt;/h3&gt;&lt;h4 id="pros"&gt;Pros
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Database efficiency&lt;/strong&gt;: Stores enums as integers, which typically use less storage space than strings.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Potentially faster queries&lt;/strong&gt;: Integer comparisons are generally faster than string comparisons.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Simpler database representation&lt;/strong&gt;: The database column is a simple integer type.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="cons"&gt;Cons
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Fragility to enum order changes&lt;/strong&gt;: If you add, remove, or reorder enum constants, the ordinal values change, which can corrupt existing data.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Less readable in raw database queries&lt;/strong&gt;: You see numbers instead of meaningful names.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Potential for invalid states&lt;/strong&gt;: If the database contains an integer that doesnâ€™t correspond to any enum constant, it can lead to runtime errors.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="enumtypestring"&gt;EnumType.STRING
&lt;/h3&gt;&lt;h4 id="pros-1"&gt;Pros
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Readability&lt;/strong&gt;: The database stores the actual names of the enum constants, making raw database queries more understandable.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Resilience to enum order changes&lt;/strong&gt;: Adding or reordering enum constants doesnâ€™t affect existing data.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Self-documenting&lt;/strong&gt;: The database schema itself documents the possible enum values.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Safety&lt;/strong&gt;: Itâ€™s harder to accidentally introduce invalid states, as any string not matching an enum constant will be rejected.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="cons-1"&gt;Cons
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Less efficient storage&lt;/strong&gt;: Strings typically use more storage space than integers.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Potentially slower queries&lt;/strong&gt;: String comparisons can be slower than integer comparisons, especially for large datasets.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Case sensitivity&lt;/strong&gt;: By default, the comparison is case-sensitive, which might lead to issues if not handled carefully.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="recommendation"&gt;Recommendation
&lt;/h3&gt;&lt;p&gt;In most cases, EnumType.STRING is the safer and more maintainable choice, despite the slight performance trade-off. The benefits of readability, safety, and resilience to changes &lt;strong&gt;usually outweigh&lt;/strong&gt; the minor efficiency gains of EnumType.ORDINAL.&lt;/p&gt;
&lt;p&gt;However, if youâ€™re dealing with a very large dataset where performance and storage efficiency are critical, and you can guarantee that the enum order will never change, EnumType.ORDINAL might be considered.&lt;/p&gt;
&lt;h3 id="best-practices"&gt;Best Practices
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Default&lt;/strong&gt; to EnumType.STRING unless you have a compelling reason not to.
If using EnumType.ORDINAL, document it clearly and warn about the dangers of changing the enum order.
Consider using a &lt;strong&gt;custom UserType&lt;/strong&gt; for more complex enum persistence scenarios.
If using EnumType.STRING, be aware of &lt;strong&gt;case sensitivity&lt;/strong&gt; in your database queries.&lt;/p&gt;</description></item><item><title>ã€Javaã€‘Dates and Times</title><link>https://dyhes.github.io/p/javadates-and-times/</link><pubDate>Fri, 12 Jul 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javadates-and-times/</guid><description>&lt;img src="https://dyhes.github.io/covers/cover19.png" alt="Featured image of post ã€Javaã€‘Dates and Times" /&gt;&lt;h2 id="javautildate"&gt;&lt;code&gt;java.util.Date&lt;/code&gt;
&lt;/h2&gt;&lt;p&gt;You&amp;rsquo;re right to ask about the Date class. The pre-Java 8 java.util.Date class is indeed still available, but it&amp;rsquo;s generally considered &lt;strong&gt;outdated&lt;/strong&gt; for modern Java projects.&lt;/p&gt;
&lt;h3 id="issues"&gt;Issues
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Mutable (not &lt;strong&gt;thread-safe&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;Poorly designed API&lt;/li&gt;
&lt;li&gt;Doesn&amp;rsquo;t handle time zones well&lt;/li&gt;
&lt;li&gt;Only &lt;strong&gt;millisecond&lt;/strong&gt; precision&lt;/li&gt;
&lt;li&gt;Confusing method names (e.g., getYear() returns year since 1900)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="modern-alternatives"&gt;Modern alternatives
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Java 8+ java.time package (recommended)&lt;/li&gt;
&lt;li&gt;Third-party libraries like Joda-Time (for pre-Java 8 projects)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="migration"&gt;Migration
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;java.time provides methods to convert between old and new date/time classes&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="javatime"&gt;&lt;code&gt;java.time&lt;/code&gt;
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;java.time&lt;/code&gt; introduced in Java 8, provides a comprehensive and much-improved API for handling dates, times, and durations.&lt;/p&gt;
&lt;h3 id="localdate"&gt;LocalDate
&lt;/h3&gt;&lt;p&gt;Represents a date without time or time zone.&lt;/p&gt;
&lt;h3 id="localtime"&gt;LocalTime
&lt;/h3&gt;&lt;p&gt;Represents a time without date or time zone.&lt;/p&gt;
&lt;h3 id="localdatetime"&gt;LocalDateTime
&lt;/h3&gt;&lt;p&gt;Combines date and time, without a time zone.&lt;/p&gt;
&lt;h3 id="zoneddatetime"&gt;ZonedDateTime
&lt;/h3&gt;&lt;p&gt;Date and time with a time zone.&lt;/p&gt;
&lt;h3 id="zoneid"&gt;ZoneId
&lt;/h3&gt;&lt;p&gt;represents a time zone&lt;/p&gt;
&lt;h3 id="instant"&gt;Instant
&lt;/h3&gt;&lt;p&gt;Instant represents a point in time on the timeline, typically in UTC (Coordinated Universal Time). It&amp;rsquo;s essentially a &lt;strong&gt;timestamp&lt;/strong&gt; with nanosecond precision.&lt;/p&gt;
&lt;h3 id="period"&gt;Period
&lt;/h3&gt;&lt;p&gt;Represents a &lt;strong&gt;date-based&lt;/strong&gt; amount of time.&lt;/p&gt;
&lt;h3 id="duration"&gt;Duration
&lt;/h3&gt;&lt;p&gt;Represents a &lt;strong&gt;time-based&lt;/strong&gt; amount of time.&lt;/p&gt;
&lt;h3 id="datetimeformatter"&gt;DateTimeFormatter
&lt;/h3&gt;&lt;p&gt;is used for parsing and formatting date-time objects.&lt;/p&gt;
&lt;h2 id="usage-in-database"&gt;Usage in Database
&lt;/h2&gt;&lt;h3 id="recommended-classes"&gt;Recommended classes
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;LocalDate: For date-only fields (e.g., birthdate)&lt;/li&gt;
&lt;li&gt;LocalDateTime: For date and time without time zone&lt;/li&gt;
&lt;li&gt;Instant: For timestamps (e.g., created_at, updated_at)&lt;/li&gt;
&lt;li&gt;ZonedDateTime: If you need to store time zone information&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="considerations"&gt;Considerations
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Instant is often preferred &lt;strong&gt;for timestamps&lt;/strong&gt; because it&amp;rsquo;s always in UTC and avoids time zone ambiguities.&lt;/li&gt;
&lt;li&gt;If using an &lt;strong&gt;older version of Hibernate&lt;/strong&gt; (pre-5.0), you might need additional configuration or converters.&lt;/li&gt;
&lt;li&gt;Some databases might require specific column definitions. For example, &lt;strong&gt;PostgreSQL might need @Column(columnDefinition = &amp;ldquo;TIMESTAMP WITH TIME ZONE&amp;rdquo;) for Instant&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="database-specific-notes"&gt;Database-specific notes
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;MySQL: LocalDateTime is typically stored as DATETIME, Instant as TIMESTAMP.&lt;/li&gt;
&lt;li&gt;PostgreSQL: Supports all types well, but ensure your JDBC driver is up to date.&lt;/li&gt;
&lt;li&gt;Oracle: May require additional configuration for LocalDate and LocalDateTime.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="best-practices"&gt;Best practices
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Use Instant for audit fields&lt;/strong&gt; (created_at, updated_at).&lt;/li&gt;
&lt;li&gt;Use LocalDateTime for user-entered date-times if time zone isn&amp;rsquo;t important.&lt;/li&gt;
&lt;li&gt;Always consider time zone implications in your application logic.
You can set the following property to ensure proper handling of JDBC time zones:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;jpa&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;properties&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hibernate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;jdbc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;time_zone&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;UTC&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="example"&gt;example
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;javax.persistence.*&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.time.Instant&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.time.LocalDate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.time.LocalDateTime&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strategy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GenerationType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;IDENTITY&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LocalDate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;birthDate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LocalDateTime&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lastLogin&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Column&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columnDefinition&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;TIMESTAMP&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;createdAt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="instant-usage"&gt;Instant usage
&lt;/h2&gt;&lt;p&gt;Use Instant for:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;System-generated timestamps (created_at, updated_at)&lt;/li&gt;
&lt;li&gt;Event occurrences (lastLogin, orderPlacedAt)&lt;/li&gt;
&lt;li&gt;Any time you need to record a specific moment and &lt;strong&gt;might deal with different time zones&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="audit-field"&gt;Audit field
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;created_at: When a record was created&lt;/li&gt;
&lt;li&gt;updated_at: When a record was last modified&lt;/li&gt;
&lt;li&gt;sometimes deleted_at: When a record was soft-deleted&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="benifits"&gt;Benifits
&lt;/h3&gt;&lt;p&gt;Querying&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Easy to query for records created or updated within a specific time range.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Sorting&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Straightforward to sort records by creation or update time.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Time zone handling&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;When displaying to users, you can easily convert Instant to their local time zone.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Potential pitfall to avoid&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Don&amp;rsquo;t use LocalDateTime for audit fields unless you&amp;rsquo;re absolutely sure all your servers and databases will always be in the same time zone.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Converting for display&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;When you need to display these times to users
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ZoneId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userZone&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ZoneId&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;of&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;America/New_York&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;createdAt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCreatedAt&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;ZonedDateTime&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userTime&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ZonedDateTime&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ofInstant&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;createdAt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userZone&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="database-considerations"&gt;Database considerations
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;For MySQL: Use TIMESTAMP column type&lt;/li&gt;
&lt;li&gt;For PostgreSQL: Use TIMESTAMP WITH TIME ZONE&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="jpa-auditting"&gt;JPA Auditting
&lt;/h3&gt;&lt;p&gt;If you want to use Spring Data JPA&amp;rsquo;s automatic auditing features, such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@CreatedDate&lt;/li&gt;
&lt;li&gt;@LastModifiedDate&lt;/li&gt;
&lt;li&gt;@CreatedBy&lt;/li&gt;
&lt;li&gt;@LastModifiedBy
enable JPA Auditing.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="manual-auditting"&gt;manual Auditting
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyEntity&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// other fields&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Column&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;updatable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;createdAt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;updatedAt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@PrePersist&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;protected&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;onCreate&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;createdAt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;now&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;updatedAt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;now&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@PreUpdate&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;protected&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;onUpdate&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;updatedAt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;now&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="example-1"&gt;example
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;org.springframework.data.annotation.CreatedDate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;org.springframework.data.annotation.LastModifiedDate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;org.springframework.data.jpa.domain.support.AuditingEntityListener&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;javax.persistence.*&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.time.Instant&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Entity&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@EntityListeners&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuditingEntityListener&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AuditedEntity&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Id&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@GeneratedValue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strategy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GenerationType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;IDENTITY&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@CreatedDate&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Column&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;updatable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;createdAt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@LastModifiedDate&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Instant&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;updatedAt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// getters and setters&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Configuration&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@EnableJpaAuditing&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;JpaConfig&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// other configurations &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="other-usage"&gt;Other usage
&lt;/h3&gt;&lt;p&gt;It&amp;rsquo;s often a good practice to store times as Instant and convert to appropriate local times when presenting to users.&lt;/p&gt;
&lt;p&gt;This ensures consistent storage and easier querying, while still allowing flexible display options.&lt;/p&gt;
&lt;p&gt;While Instant is great for many scenarios, there are cases where other types might be more appropriate:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a) LocalDate: When you only need the date without time (e.g., birthDate, holidayDate).&lt;/li&gt;
&lt;li&gt;b) LocalDateTime: When you need date and time, but the time zone is implicit or unnecessary.&lt;/li&gt;
&lt;li&gt;c) ZonedDateTime: When you need to &lt;strong&gt;preserve&lt;/strong&gt; the specific time zone information.&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Javaã€‘Releases</title><link>https://dyhes.github.io/p/javareleases/</link><pubDate>Fri, 12 Jul 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javareleases/</guid><description>&lt;img src="https://dyhes.github.io/covers/cover9.png" alt="Featured image of post ã€Javaã€‘Releases" /&gt;&lt;p&gt;Oracle has moved to a new release model since Java 9:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There are new Java releases every six months.&lt;/li&gt;
&lt;li&gt;Every two (three before java17) years, the September release is designated as an LTS release.&lt;/li&gt;
&lt;li&gt;Non-LTS releases are supported only until the next release.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-10-1996"&gt;Java 1.0 (1996)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;First public release&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-11-1997"&gt;Java 1.1 (1997)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Inner classes&lt;/li&gt;
&lt;li&gt;JavaBeans&lt;/li&gt;
&lt;li&gt;JDBC&lt;/li&gt;
&lt;li&gt;RMI (Remote Method Invocation)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-12-1998"&gt;Java 1.2 (1998)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Collections framework&lt;/li&gt;
&lt;li&gt;Swing GUI&lt;/li&gt;
&lt;li&gt;JIT (Just-In-Time) compiler&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-13-2000"&gt;Java 1.3 (2000)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;HotSpot JVM&lt;/li&gt;
&lt;li&gt;JNDI (Java Naming and Directory Interface)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-14-2002"&gt;Java 1.4 (2002)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Assert keyword&lt;/li&gt;
&lt;li&gt;Regular expressions&lt;/li&gt;
&lt;li&gt;Logging API&lt;/li&gt;
&lt;li&gt;NIO (New Input/Output)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-5-2004"&gt;Java 5 (2004)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Generics&lt;/li&gt;
&lt;li&gt;Annotations&lt;/li&gt;
&lt;li&gt;Autoboxing/Unboxing&lt;/li&gt;
&lt;li&gt;Enumerations&lt;/li&gt;
&lt;li&gt;Varargs&lt;/li&gt;
&lt;li&gt;Enhanced for loop&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-6-2006"&gt;Java 6 (2006)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Scripting language support&lt;/li&gt;
&lt;li&gt;JDBC 4.0&lt;/li&gt;
&lt;li&gt;Java Compiler API&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-7-2011"&gt;Java 7 (2011)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Try-with-resources&lt;/li&gt;
&lt;li&gt;Diamond operator&lt;/li&gt;
&lt;li&gt;Switch with Strings&lt;/li&gt;
&lt;li&gt;NIO 2.0&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-8-2014---lts"&gt;Java 8 (2014) - LTS
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Lambda expressions&lt;/li&gt;
&lt;li&gt;Stream API&lt;/li&gt;
&lt;li&gt;Optional class&lt;/li&gt;
&lt;li&gt;Default methods in interfaces&lt;/li&gt;
&lt;li&gt;New Date and Time API&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-9-2017"&gt;Java 9 (2017)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Module system (Project Jigsaw)&lt;/li&gt;
&lt;li&gt;JShell (REPL)&lt;/li&gt;
&lt;li&gt;Private methods in interfaces&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-10-2018"&gt;Java 10 (2018)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Local variable type inference (var keyword)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-11-2018---lts"&gt;Java 11 (2018) - LTS
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;HTTP Client API&lt;/li&gt;
&lt;li&gt;Launch single-file source-code programs&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-12-2019"&gt;Java 12 (2019)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Switch expressions (preview)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-13-2019"&gt;Java 13 (2019)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Text blocks (preview)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-14-2020"&gt;Java 14 (2020)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Records (preview)&lt;/li&gt;
&lt;li&gt;Pattern matching for instanceof (preview)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-15-2020"&gt;Java 15 (2020)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Sealed classes (preview)&lt;/li&gt;
&lt;li&gt;Hidden classes&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-16-2021"&gt;Java 16 (2021)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Pattern matching for instanceof (finalized)&lt;/li&gt;
&lt;li&gt;Records (finalized)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-17-2021---lts"&gt;Java 17 (2021) - LTS
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Sealed classes (finalized)&lt;/li&gt;
&lt;li&gt;Pattern matching for switch (preview)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-18-2022"&gt;Java 18 (2022)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Simple web server&lt;/li&gt;
&lt;li&gt;Code snippets in Java API documentation&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-19-2022"&gt;Java 19 (2022)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Virtual threads (preview)&lt;/li&gt;
&lt;li&gt;Pattern matching for switch (second preview)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-20-2023"&gt;Java 20 (2023)
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Scoped values (incubator)&lt;/li&gt;
&lt;li&gt;Record patterns (second preview)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="java-212023---lts"&gt;Java 21(2023) - LTS
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Virtual Threads (finalized)&lt;/li&gt;
&lt;li&gt;Pattern Matching for Switch (finalized)&lt;/li&gt;
&lt;li&gt;Record Patterns (finalized)&lt;/li&gt;
&lt;li&gt;Sequenced Collections&lt;/li&gt;
&lt;li&gt;String Templates (preview)&lt;/li&gt;
&lt;li&gt;Unnamed Classes and Instance Main Methods (preview)&lt;/li&gt;
&lt;li&gt;Unnamed Patterns and Variables (preview)&lt;/li&gt;
&lt;li&gt;Scoped Values (preview)&lt;/li&gt;
&lt;li&gt;Foreign Function &amp;amp; Memory API (preview)&lt;/li&gt;
&lt;li&gt;Structured Concurrency (preview)&lt;/li&gt;
&lt;li&gt;Vector API (incubator)&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Javaã€‘æ³¨è§£ä¸åå°„</title><link>https://dyhes.github.io/p/java%E6%B3%A8%E8%A7%A3%E4%B8%8E%E5%8F%8D%E5%B0%84/</link><pubDate>Fri, 07 Jan 2022 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/java%E6%B3%A8%E8%A7%A3%E4%B8%8E%E5%8F%8D%E5%B0%84/</guid><description>&lt;h2 id="classç±»"&gt;Classç±»
&lt;/h2&gt;&lt;p&gt;Classç±»çš„å®ä¾‹æä¾›äº†ç‰¹å®šæ•°æ®ç±»å‹çš„ç›¸å…³ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªClassç±»çš„å¯¹è±¡å®é™…ä¸Šè¡¨ç¤ºçš„æ˜¯&lt;strong&gt;ä¸€ç§ç±»å‹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è·å–Classçš„ä¸‰ç§æ–¹å¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;//ï¼ˆ1ï¼‰.getClass()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getClass&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//ï¼ˆ2ï¼‰Class.forName()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;java.util.Date&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//ï¼ˆ3ï¼‰T.Class&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Double&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="åå°„"&gt;åå°„
&lt;/h3&gt;&lt;p&gt;æ‰€è°“â€œåå°„ï¼ˆReflectionï¼‰â€ï¼Œå°±æ˜¯æŠŠJavaç±»ä¸­çš„å„ç§æˆä»½æ˜ å°„æˆç›¸åº”çš„å¦å¤–ä¸€äº›ç‰¹æ®Šçš„Javaç±»çš„å®ä¾‹ï¼Œä»è€Œå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å®Œæˆä¸€äº›å·¥ä½œï¼šæ¯”å¦‚åŠ¨æ€è£…è½½ç±»å‹å¹¶åˆ›å»ºå®ä¾‹ï¼ŒæŸ¥è¯¢ç±»çš„æˆå‘˜ä¿¡æ¯ï¼ŒåŠ¨æ€åœ°è°ƒç”¨æ–¹æ³•ç­‰ã€‚åå°„æŠ€æœ¯çš„&lt;strong&gt;æ ¸å¿ƒç±»å‹&lt;/strong&gt;æ˜¯Classç±»ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ç®¡æ¯ä¸ªç±»å‹åˆ›å»ºäº†å¤šå°‘ä¸ªå®ä¾‹ï¼Œä¹Ÿä¸ç®¡ä½ ç”¨ä»€ä¹ˆæ–¹æ³•è·å–æ­¤ç±»å‹çš„Classå®ä¾‹ï¼Œæ¯ä¸ªç±»å‹éƒ½åªå¯¹åº”ä¸€ä¸ªClasså®ä¾‹ã€‚&lt;/p&gt;
&lt;h2 id="åŠ¨æ€åˆ›å»ºå¯¹è±¡"&gt;åŠ¨æ€åˆ›å»ºå¯¹è±¡
&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨æ„é€ æ–¹æ³•å¯¹è±¡æˆ–Classå¯¹è±¡çš„&lt;code&gt;newInstance()&lt;/code&gt;æ–¹æ³•åŠ¨æ€åˆ›å»ºæŒ‡å®šç±»å‹çš„å¯¹è±¡&lt;/p&gt;
&lt;h2 id="æ³¨è§£"&gt;æ³¨è§£
&lt;/h2&gt;&lt;p&gt;æ³¨è§£ç›¸å½“äºä¸€ç§æ ‡è®°ï¼ŒåŠ äº†æ³¨è§£å°±ç­‰äºç»™ä»£ç æ‰“ä¸Šäº†æŸä¸ªæ ‡è®°ã€‚javacç¼–è¯‘å™¨ã€ IntelliJä¹‹ç±»IDEä»¥åŠå…¶ä»–ä¸€äº›æ³¨è§£å¤„ç†å·¥å…·ï¼ˆAnnotation Processing Toolï¼ŒAPTï¼‰å°± å¯ä»¥åˆ©ç”¨å®ƒæ¥å®Œæˆä¸€äº›ç‰¹æ®Šçš„å·¥ä½œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@Deprecatedï¼šæ ‡è®°ç±»çš„æˆå‘˜å·²è¿‡æ—¶&lt;/li&gt;
&lt;li&gt;@Overrideï¼šè¦æ±‚å­ç±»å¿…é¡»è¦†ç›–åŸºç±»çš„æ–¹æ³•&lt;/li&gt;
&lt;li&gt;@Serializableï¼šæŒ‡å®šæŸä¸ªç±»æ˜¯å¯ä»¥åºåˆ—åŒ–çš„&lt;/li&gt;
&lt;li&gt;@FunctionalInterfaceï¼šæŒ‡å®šæŸä¸ªæ–¹æ³•é‡å†™äº†åŸºç±»çš„åŒåæ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="è‡ªå®šä¹‰"&gt;è‡ªå®šä¹‰
&lt;/h3&gt;&lt;p&gt;æ³¨è§£ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªä½¿ç”¨@interfaceå®šä¹‰çš„æ¥å£&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@interface&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyTestAnnotation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="å…ƒæ³¨è§£"&gt;å…ƒæ³¨è§£
&lt;/h3&gt;&lt;p&gt;å®šä¹‰æ³¨è§£çš„ç±»å‹ä¹Ÿå¯ä»¥æ·»åŠ â€œæ³¨è§£â€ï¼Œè¿™ç§é’ˆå¯¹â€œæ³¨è§£â€çš„â€œæ³¨è§£â€ï¼Œ ç§°ä¸ºâ€œå…ƒæ³¨è§£ï¼ˆmeta-annotationï¼‰â€&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Retention&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RetentionPolicy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;RUNTIME&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;//æŒ‡æ˜æ³¨è§£ç”Ÿå­˜çš„æ—¶é—´&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nd"&gt;@Target&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;ElementType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;METHOD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ElementType&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;TYPE&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;//æŒ‡æ˜æ³¨è§£é€‚ç”¨çš„åœºåˆ&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@interface&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyTestAnnotation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>ã€Javaã€‘IO</title><link>https://dyhes.github.io/p/javaio/</link><pubDate>Wed, 05 Jan 2022 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javaio/</guid><description>&lt;p&gt;ä»æ–‡ä»¶ä¸­è¯»å–å†…å®¹ï¼Œå‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼ŒæˆªçŸ­æ–‡ä»¶ã€åˆå¹¶æ–‡ ä»¶ã€å‹ç¼©æ–‡ä»¶â€¦â€¦ï¼Œè¯¸å¦‚æ­¤ç±»çš„æ“ä½œï¼Œç§°ä¸º&lt;strong&gt;æ–‡ä»¶å­˜å–æ“ä½œ&lt;/strong&gt;ï¼Œ ä¸»è¦ä½¿ç”¨â€œæµï¼ˆStreamï¼‰â€æ¥å®Œæˆ&lt;/p&gt;
&lt;p&gt;ä¸æ–‡ä»¶æ“ä½œç›¸å…³çš„ç±»ï¼Œé›†ä¸­äºjava.ioåŒ…ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;Java 1.4ä¸­åŠ å…¥äº†ä¸€ä¸ªNew I/O APIï¼Œæä¾›äº†ä¸€äº›ç±»å®Œæˆæ–‡ä»¶å’Œæµæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;Java 7ä¸­åˆåŠ å…¥äº†ä¸€äº›æ–°ç±»å‹ï¼Œç§°ä¸ºNIO.2ï¼ŒNIO.2ä¸­æœ€é‡è¦çš„æ˜¯å¼•å…¥äº†&lt;strong&gt;Path&lt;/strong&gt;å’Œ &lt;strong&gt;AutoCloseable&lt;/strong&gt;æ¥å£ï¼Œè¿˜æœ‰ä¸€ä¸ª&lt;strong&gt;Filesç±»&lt;/strong&gt;ï¼Œå®ƒçš„é™æ€æ–¹æ³•å°è£…äº†æ–‡ä»¶çš„å¸¸ç”¨æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id="fileç±»"&gt;Fileç±»
&lt;/h2&gt;&lt;p&gt;Javaä½¿ç”¨Fileç±»æ¥ç»Ÿä¸€æ“ä½œæ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;java.io.Fileä»£è¡¨ä¸å¹³å°æ— å…³çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡Fileç±»åœ¨Javaç¨‹åºä¸­æ“ä½œæ–‡ä»¶æˆ–ç›®å½•ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;Fileç±»åªèƒ½ç”¨æ¥&lt;strong&gt;æ“ä½œ&lt;/strong&gt;æ–‡ä»¶æˆ–ç›®å½•ï¼ˆåŒ…æ‹¬æ–°å»ºã€åˆ é™¤ã€é‡å‘½åæ–‡ä»¶å’Œç›®å½•ç­‰æ“ä½œï¼‰ï¼Œä½†&lt;strong&gt;ä¸èƒ½ç”¨æ¥è®¿é—®&lt;/strong&gt;æ–‡ä»¶ä¸­çš„å†…å®¹ï¼›&lt;/li&gt;
&lt;li&gt;å¦‚æœéœ€è¦è®¿é—®æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œåˆ™éœ€è¦ä½¿ç”¨è¾“å…¥/è¾“å‡ºæµã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;RandomAccessFile&lt;/code&gt;ï¼ˆéšæœºæ–‡ä»¶æ“ä½œï¼‰ï¼šä¸€ä¸ªç‹¬ç«‹çš„ç±»ï¼Œç›´æ¥ç»§æ‰¿è‡³Object.å®ƒçš„åŠŸèƒ½ä¸°å¯Œï¼Œå¯ä»¥ä»æ–‡ä»¶çš„ä»»æ„ä½ç½®è¿›è¡Œå­˜å–ï¼ˆè¾“å…¥è¾“å‡ºï¼‰æ“ä½œã€‚&lt;code&gt;RandomAccessFile&lt;/code&gt;ç±»æ”¯æŒâ€œéšæœºè®¿é—®â€æ–¹å¼ï¼Œè¿™é‡Œâ€œéšæœºâ€æ˜¯æŒ‡å¯ä»¥è·³è½¬åˆ°æ–‡ä»¶çš„ä»»æ„ä½ç½®å¤„è¯»å†™æ•°æ®ã€‚ åœ¨è®¿é—®ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œä¸å¿…æŠŠæ–‡ä»¶ä»å¤´è¯»åˆ°å°¾ï¼Œè€Œæ˜¯å¸Œæœ›åƒè®¿é—®ä¸€ä¸ªæ•°æ®åº“ä¸€æ ·â€œéšå¿ƒæ‰€æ¬²â€åœ°è®¿é—®ä¸€ä¸ªæ–‡ä»¶çš„æŸä¸ªéƒ¨åˆ†ï¼Œè¿™æ—¶ä½¿ç”¨ç±»å°±æ˜¯æœ€ä½³é€‰æ‹©ã€‚â€
&lt;code&gt;RandomAccessFile&lt;/code&gt;å¯¹è±¡ç±»æœ‰ä¸ª&lt;strong&gt;ä½ç½®æŒ‡ç¤ºå™¨â€&lt;/strong&gt;â€ï¼ŒæŒ‡å‘å½“å‰è¯»å†™å¤„çš„ä½ç½®ï¼Œå½“å‰è¯»å†™nä¸ªå­—èŠ‚åï¼Œæ–‡ä»¶æŒ‡ç¤ºå™¨å°†æŒ‡å‘è¿™nä¸ªå­—èŠ‚åé¢çš„ä¸‹ä¸€ä¸ªå­—èŠ‚å¤„ã€‚ åˆšæ‰“å¼€æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶æŒ‡ç¤ºå™¨æŒ‡å‘æ–‡ä»¶çš„å¼€å¤´å¤„ï¼Œå¯ä»¥ç§»åŠ¨æ–‡ä»¶æŒ‡ç¤ºå™¨åˆ°æ–°çš„ä½ç½®ï¼Œéšåçš„è¯»å†™æ“ä½œå°†ä»æ–°çš„ä½ç½®å¼€å§‹ã€‚ ç±»åœ¨æ•°æ®ç­‰é•¿è®°å½•æ ¼å¼æ–‡ä»¶çš„éšæœºï¼ˆç›¸å¯¹é¡ºåºè€Œè¨€ï¼‰è¯»å–æ—¶æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ï¼Œä½†è¯¥ç±»ä»…é™äºæ“ä½œæ–‡ä»¶ï¼Œä¸èƒ½è®¿é—®å…¶ä»–çš„I/Oè®¾å¤‡ï¼Œå¦‚ç½‘ç»œã€å†…å­˜æ˜ åƒç­‰ã€‚&lt;/p&gt;
&lt;h2 id="io-stream"&gt;&lt;strong&gt;IO Stream&lt;/strong&gt;
&lt;/h2&gt;&lt;h4 id="åˆ†ç±»"&gt;åˆ†ç±»
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ ¹æ®æ“ä½œæ•°æ®ç±»å‹ï¼ˆ&lt;em&gt;èƒ½ç”¨è®°äº‹æœ¬æ‰“å¼€å¹¶èƒ½çœ‹åˆ°å…¶ä¸­çš„å­—ç¬¦å†…å®¹çš„æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œåä¹‹æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶&lt;/em&gt;ï¼‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å­—èŠ‚æµï¼šäºŒè¿›åˆ¶ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½&lt;/p&gt;
&lt;p&gt;å­—èŠ‚æµçš„ä¸¤ä¸ªåŸºç±» InputStreamå’ŒOutputStream&lt;/p&gt;
&lt;p&gt;å‡¡æ˜¯ä»¥InputStreamæˆ–OutputStreamç»“å°¾çš„ç±»å‹ä¸ºå­—èŠ‚æµ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å­—ç¬¦æµï¼šæ–‡æœ¬,ä»¥å­—ç¬¦ï¼ˆ2ä¸ªå­—èŠ‚ï¼‰ä¸ºå•ä½&lt;/p&gt;
&lt;p&gt;å­—ç¬¦æµçš„ä¸¤ä¸ªåŸºç±» Readerå’ŒWriter&lt;/p&gt;
&lt;p&gt;å‡¡æ˜¯ä»¥Readeræˆ–Writerç»“å°¾çš„å‡ä¸ºå­—ç¬¦æµ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŒºåˆ«&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å­—èŠ‚æµæ²¡æœ‰ç¼“å†²åŒºï¼Œæ˜¯ç›´æ¥è¾“å‡ºçš„ï¼Œè€Œå­—ç¬¦æµæ˜¯è¾“å‡ºåˆ°ç¼“å†²åŒºçš„ã€‚å› æ­¤åœ¨è¾“å‡ºæ—¶ï¼Œå­—èŠ‚æµä¸è°ƒç”¨&lt;code&gt;colse()&lt;/code&gt;æ–¹æ³•æ—¶ï¼Œä¿¡æ¯å·²ç»è¾“å‡ºäº†ï¼Œè€Œå­—ç¬¦æµåªæœ‰åœ¨è°ƒç”¨close()æ–¹æ³•å…³é—­ç¼“å†²åŒºæ—¶ï¼Œä¿¡æ¯æ‰è¾“å‡ºã€‚è¦æƒ³å­—ç¬¦æµåœ¨æœªå…³é—­æ—¶è¾“å‡ºä¿¡æ¯ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨è°ƒç”¨flush()æ–¹æ³•ï¼›&lt;/li&gt;
&lt;li&gt;è¯»å†™å•ä½ä¸åŒï¼šå­—èŠ‚æµä»¥å­—èŠ‚ï¼ˆ&lt;code&gt;8bit&lt;/code&gt;ï¼‰ä¸ºå•ä½ï¼Œå­—ç¬¦æµä»¥å­—ç¬¦ä¸ºå•ä½ï¼Œæ ¹æ®ç è¡¨æ˜ å°„å­—ç¬¦ï¼Œä¸€æ¬¡å¯èƒ½è¯»å¤šä¸ªå­—èŠ‚ï¼›&lt;/li&gt;
&lt;li&gt;å¤„ç†å¯¹è±¡ä¸åŒï¼šå­—èŠ‚æµèƒ½å¤„ç†æ‰€æœ‰ç±»å‹çš„æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€&lt;code&gt;avi&lt;/code&gt;ç­‰ï¼‰ï¼Œè€Œå­—ç¬¦æµåªèƒ½å¤„ç†å­—ç¬¦ç±»å‹çš„æ•°æ®ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ ¹æ®æµå‘&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¾“å…¥æµ&lt;/li&gt;
&lt;li&gt;è¾“å‡ºæµ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ ¹æ®å…·ä½“åŠŸèƒ½&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;èŠ‚ç‚¹æµï¼šä»¥ä»æˆ–å‘ä¸€ä¸ªç‰¹å®šçš„åœ°æ–¹ï¼ˆèŠ‚ç‚¹ï¼‰è¯»å†™æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;1ã€æ–‡ä»¶ï¼š &lt;code&gt;FileInputStream&lt;/code&gt; ã€&lt;code&gt;FileOutputStream&lt;/code&gt;ã€ &lt;code&gt;FileReader&lt;/code&gt;å’Œ &lt;code&gt;FileWriter&lt;/code&gt; æ–‡ä»¶è¿›è¡Œå¤„ç†çš„èŠ‚ç‚¹æµï¼› ã€€ã€€&lt;/p&gt;
&lt;p&gt;2ã€å­—ç¬¦ä¸²ï¼š &lt;code&gt;StringReader&lt;/code&gt; å’Œ&lt;code&gt;StringWriter&lt;/code&gt; å¯¹å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†çš„èŠ‚ç‚¹æµï¼› ã€€ã€€&lt;/p&gt;
&lt;p&gt;3ã€æ•°ç»„ï¼š &lt;code&gt;ByteArrayInputStream&lt;/code&gt;ã€&lt;code&gt;ByteArrayOutputStream&lt;/code&gt;ã€&lt;code&gt;CharArrayReader&lt;/code&gt;å’Œ&lt;code&gt;CharArrayWriter&lt;/code&gt; å¯¹æ•°ç»„è¿›è¡Œå¤„ç†çš„èŠ‚ç‚¹æµ(å¯¹åº”çš„ä¸å†æ˜¯æ–‡ä»¶ï¼Œè€Œæ˜¯å†…å­˜ä¸­çš„ä¸€ä¸ªæ•°ç»„)ï¼› ã€€ã€€&lt;/p&gt;
&lt;p&gt;4ã€ç®¡é“ï¼š &lt;code&gt;PipedInputStream&lt;/code&gt; ã€&lt;code&gt;PipedOutputStream&lt;/code&gt; å’Œ&lt;code&gt;PipedReaderPipedWriter&lt;/code&gt;å¯¹ç®¡é“è¿›è¡Œå¤„ç†çš„èŠ‚ç‚¹æµï¼› ã€€ã€€&lt;/p&gt;
&lt;p&gt;5ã€åŸºç±»ï¼š &lt;code&gt;InputStream&lt;/code&gt;ã€ &lt;code&gt;OutputStream&lt;/code&gt;ã€ &lt;code&gt;Reader&lt;/code&gt;å’Œ &lt;code&gt;Writer&lt;/code&gt;ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¤„ç†æµï¼šæ˜¯å¯¹ä¸€ä¸ªå·²å­˜åœ¨çš„æµçš„&lt;strong&gt;è¿æ¥å’Œå°è£…&lt;/strong&gt;ï¼Œé€šè¿‡æ‰€å°è£…çš„æµçš„åŠŸèƒ½è°ƒç”¨å®ç°æ•°æ®è¯»å†™ã€‚å¤„ç†æµçš„æ„é€ æ–¹æ³•æ€»æ˜¯è¦å¸¦ä¸€ä¸ªå…¶ä»–çš„æµå¯¹è±¡åšå‚æ•°ã€‚ä¸€ä¸ªæµå¯¹è±¡ç»è¿‡å…¶ä»–æµçš„å¤šæ¬¡åŒ…è£…ï¼Œç§°ä¸ºæµçš„é“¾æ¥ã€‚&lt;/p&gt;
&lt;p&gt;1ã€ç¼“å†²æµï¼š&lt;code&gt;BufferedInputStream&lt;/code&gt;ã€ &lt;code&gt;BufferedOutputStream&lt;/code&gt;ã€ &lt;code&gt;BufferedReader&lt;/code&gt;å’Œ&lt;code&gt;BufferedWriter&lt;/code&gt; ã€€å¢åŠ ç¼“å†²åŠŸèƒ½ï¼Œé¿å…é¢‘ç¹è¯»å†™ç¡¬ç›˜ã€‚ ã€€ã€€&lt;/p&gt;
&lt;p&gt;2ã€è½¬æ¢æµï¼š&lt;code&gt;InputStreamReader&lt;/code&gt;å’Œ &lt;code&gt;OutputStreamReader&lt;/code&gt;å®ç°å­—èŠ‚æµå’Œå­—ç¬¦æµä¹‹é—´çš„è½¬æ¢ã€‚ ã€€ã€€&lt;/p&gt;
&lt;p&gt;3ã€æ•°æ®æµ &lt;code&gt;DataInputStream&lt;/code&gt;å’Œ&lt;code&gt;DataOutputStream&lt;/code&gt;ç­‰æä¾›å°†åŸºç¡€æ•°æ®ç±»å‹å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæˆ–è€…è¯»å–å‡ºæ¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://pics2.baidu.com/feed/6159252dd42a28341e23dde5587a81ec17cebfa8.jpeg?token=201587ab58af94624ef1a60c83d1e396&amp;amp;s=C8611F7091BFE5CC1C5D95CB000030B2"
loading="lazy"
alt="img"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://pic4.zhimg.com/80/v2-a001c51e37e77edf5a73dbba3bc80153_1440w.jpg"
loading="lazy"
alt="img"
&gt;&lt;/p&gt;
&lt;h4 id="å…³é—­æµ"&gt;å…³é—­æµ
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;æµå…³é—­çš„åŸåˆ™&lt;/strong&gt;ï¼šå…ˆæ‰“å¼€å…ˆå…³é—­ï¼›å¦‚æœAä¾èµ–Bï¼Œåˆ™å…ˆå…³é—­Aå†å…³é—­Bï¼›å¯¹äºå¤„ç†æµå¦‚æœå°†èŠ‚ç‚¹æµå…³é—­ä»¥åå†å…³é—­å¤„ç†æµï¼Œä¼šæŠ›å‡ºIOå¼‚å¸¸ï¼Œæ‰€ä»¥ç›´æ¥å…³é—­å¤„ç†æµå°±è¡Œäº†ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å…³é—­é‡Œé¢èŠ‚ç‚¹æµçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœå°†èŠ‚ç‚¹æµå…³é—­ä»¥åå†å…³é—­å¤„ç†æµï¼Œä¼šæŠ›å‡ºIOå¼‚å¸¸&lt;/li&gt;
&lt;li&gt;å¦‚æœå…³é—­äº†å¤„ç†æµï¼Œåœ¨å…³é—­ä¸ä¹‹ç›¸å…³çš„èŠ‚ç‚¹æµï¼Œä¹Ÿå¯èƒ½å‡ºç°IOå¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h4 id="inputstream"&gt;InputStream
&lt;/h4&gt;&lt;p&gt;&lt;img src="https://pic1.zhimg.com/80/v2-d464303fd5be6fdb7b11678857824520_1440w.jpg"
loading="lazy"
alt="img"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ByteArrayInputStream&lt;/code&gt;ï¼šå­—èŠ‚æ•°ç»„è¾“å…¥æµï¼Œå®ƒçš„å†…éƒ¨ç¼“å†²åŒºå°±æ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œè¯¥ç±»çš„åŠŸèƒ½å°±æ˜¯ä»å­—èŠ‚æ•°ç»„(&lt;code&gt;byte[]&lt;/code&gt;)ä¸­è¿›è¡Œä»¥å­—èŠ‚ä¸ºå•ä½çš„è¯»å–èµ„æºæ–‡ä»¶ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PipedInputStream&lt;/code&gt;ï¼šç®¡é“å­—èŠ‚è¾“å…¥æµï¼Œå®ƒå’Œ&lt;code&gt;PipedOutputStream&lt;/code&gt;ä¸€èµ·ä½¿ç”¨ï¼Œèƒ½å®ç°**å¤šçº¿ç¨‹é—´çš„ç®¡é“é€šä¿¡ã€‚**å¤šçº¿ç¨‹ç®¡é“é€šä¿¡çš„ä¸»è¦æµç¨‹æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å‘&lt;code&gt;PipedOutputStream&lt;/code&gt;å†™å…¥æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¼šè‡ªåŠ¨ä¼ é€åˆ°å¯¹åº”çš„ç®¡é“è¾“å…¥æµ&lt;code&gt;PipedInputStream&lt;/code&gt;ä¸­ï¼Œå…¶ä»–çº¿ç¨‹é€šè¿‡è¯»å–&lt;code&gt;PipeInputStream&lt;/code&gt;ä¸­ç¼“å†²çš„æ•°æ®å®ç°å¤šçº¿ç¨‹é—´é€šä¿¡ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;FilterInputStream&lt;/code&gt; ï¼šè¿‡æ»¤è¾“å…¥æµï¼Œè£…é¥°è€…æ¨¡å¼ä¸­å¤„äºè£…é¥°è€…ï¼Œå…·ä½“çš„è£…é¥°è€…éƒ½è¦ç»§æ‰¿å®ƒï¼Œæ‰€ä»¥åœ¨è¯¥ç±»çš„å­ç±»ä¸‹éƒ½æ˜¯ç”¨æ¥è£…é¥°åˆ«çš„æµçš„ï¼Œä¹Ÿå°±æ˜¯å¤„ç†ç±»ã€‚å¸¸è§çš„å­ç±»æœ‰&lt;code&gt;DataInputStream&lt;/code&gt;å’Œ&lt;code&gt;BufferedInputStream&lt;/code&gt;ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;BufferedInputStream&lt;/code&gt;ï¼šç¼“å†²è¾“å…¥æµï¼Œç”±äºåŸºç¡€è¾“å…¥æµä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¯»å–,é¢‘ç¹ä¸ç£ç›˜è¿›è¡Œäº¤äº’,é€ æˆè¯»å–é€Ÿåº¦è¾ƒä½.ç¼“å†²æµçš„å­˜åœ¨å°±æ˜¯å…ˆå°†æ•°æ®è¯»å–åˆ°ç¼“å†²æµ(å†…å­˜ä¸­),ç„¶åä¸€æ¬¡æ€§ä»å†…å­˜ä¸­è¯»å–å¤šä¸ªå­—ç¬¦.æé«˜è¯»å–çš„æ•ˆç‡ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;DataInputStream&lt;/code&gt;ï¼šæ•°æ®è¾“å…¥æµ,ä»¥æœºå™¨æ— å…³çš„æ–¹å¼è¯»å–Javaçš„åŸºæœ¬ç±»å‹ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;FileInputSream&lt;/code&gt;ï¼šæ–‡ä»¶è¾“å…¥æµï¼Œå®ƒé€šå¸¸ç”¨äºå¯¹æ–‡ä»¶è¿›è¡Œè¯»å–æ“ä½œï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;File&lt;/code&gt;ï¼šå¯¹æŒ‡å®šç›®å½•çš„æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚æ³¨æ„ï¼Œè¯¥ç±»è™½ç„¶æ˜¯åœ¨IOåŒ…ä¸‹ï¼Œä½†æ˜¯å¹¶ä¸ç»§æ‰¿è‡ªå››å¤§åŸºç¡€ç±»ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ObjectInputStream&lt;/code&gt;ï¼šå¯¹è±¡è¾“å…¥æµï¼Œç”¨æ¥æä¾›å¯¹â€œåŸºæœ¬æ•°æ®æˆ–å¯¹è±¡â€çš„æŒä¹…å­˜å‚¨ã€‚é€šä¿—ç‚¹è®²ï¼Œä¹Ÿå°±æ˜¯èƒ½ç›´æ¥ä¼ è¾“å¯¹è±¡ï¼ˆååºåˆ—åŒ–ä¸­ä½¿ç”¨ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id="outputstream"&gt;OutputStream
&lt;/h4&gt;&lt;p&gt;&lt;img src="https://pic4.zhimg.com/80/v2-e208c6f6b8021e0d2a3c519fcbecb6d7_1440w.jpg"
loading="lazy"
alt="img"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ByteArrayOutputStream&lt;/code&gt;ï¼šå­—èŠ‚æ•°ç»„è¾“å‡ºæµï¼Œå®ƒçš„å†…éƒ¨ç¼“å†²åŒºå°±æ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œè¯¥ç±»çš„åŠŸèƒ½å°±æ˜¯ä»å­—èŠ‚æ•°ç»„(&lt;code&gt;byte[]&lt;/code&gt;)ä¸­è¿›è¡Œä»¥å­—èŠ‚ä¸ºå•ä½çš„å†™å…¥èµ„æºæ–‡ä»¶ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PipedOutputStream&lt;/code&gt; ï¼šç®¡é“å­—èŠ‚è¾“å‡ºæµï¼Œå®ƒå’Œ&lt;code&gt;PipedInputStream&lt;/code&gt;ä¸€èµ·ä½¿ç”¨ï¼Œèƒ½å®ç°&lt;strong&gt;å¤šçº¿ç¨‹é—´çš„ç®¡é“é€šä¿¡ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;FilterOutputStream&lt;/code&gt; ï¼šè¿‡æ»¤è¾“å‡ºæµï¼Œè£…é¥°è€…æ¨¡å¼ä¸­å¤„äºè£…é¥°è€…ï¼Œå…·ä½“çš„è£…é¥°è€…éƒ½è¦ç»§æ‰¿å®ƒï¼Œæ‰€ä»¥åœ¨è¯¥ç±»çš„å­ç±»ä¸‹éƒ½æ˜¯ç”¨æ¥è£…é¥°åˆ«çš„æµçš„ï¼Œä¹Ÿå°±æ˜¯å¤„ç†ç±»ã€‚å¸¸è§çš„å­ç±»æœ‰&lt;code&gt;DatOutputStream&lt;/code&gt;ã€&lt;code&gt;BufferedOutputStream&lt;/code&gt;å’Œ&lt;/p&gt;
&lt;p&gt;&lt;code&gt;BufferedOutputStream&lt;/code&gt;ï¼šç¼“å†²è¾“å‡ºæµï¼Œç”±äºåŸºç¡€è¾“å…¥æµä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚å†™å…¥,é¢‘ç¹ä¸ç£ç›˜è¿›è¡Œäº¤äº’,é€ æˆè¯»å–é€Ÿåº¦è¾ƒä½.ç¼“å†²æµçš„å­˜åœ¨å°±æ˜¯å…ˆå°†æ•°æ®å†™å…¥åˆ°ç¼“å†²æµ(å†…å­˜ä¸­),ç„¶åä¸€æ¬¡æ€§ä»å†…å­˜ä¸­å†™å…¥å¤šä¸ªå­—ç¬¦.æé«˜è¯»å–çš„æ•ˆç‡ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;DataOutputStream&lt;/code&gt;ï¼šæ•°æ®è¾“å‡ºæµ,ä»¥æœºå™¨æ— å…³çš„æ–¹å¼è¯»å–Javaçš„åŸºæœ¬ç±»å‹ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PrintStream&lt;/code&gt;ï¼šç»§æ‰¿äº†&lt;code&gt;FilterOutputStream&lt;/code&gt;ã€‚æ˜¯&amp;quot;è£…é¥°ç±»&amp;quot;çš„ä¸€ç§,æ‰€ä»¥å±äºå­—èŠ‚æµä½“ç³»ä¸­(ä¸&lt;code&gt;PrintStream&lt;/code&gt;ç›¸ä¼¼çš„æµ&lt;code&gt;PrintWriter&lt;/code&gt;ç»§æ‰¿äº&lt;code&gt;Writer&lt;/code&gt;,å±äºå­—ç¬¦æµä½“ç³»ä¸­),ä¸ºå…¶ä»–çš„è¾“å‡ºæµæ·»åŠ åŠŸèƒ½.ä½¿å®ƒä»¬èƒ½å¤Ÿæ–¹ä¾¿æ‰“å°å„ç§æ•°æ®å€¼çš„è¡¨ç¤ºå½¢å¼ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;FileOutputStream&lt;/code&gt; ï¼šæ–‡ä»¶è¾“å‡ºæµï¼Œå®ƒé€šå¸¸ç”¨äºå¯¹æ–‡ä»¶è¿›è¡Œå†™å…¥æ“ä½œï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ObjectOutputStream&lt;/code&gt; ï¼šå¯¹è±¡è¾“å‡ºæµï¼Œç”¨æ¥æä¾›å¯¹â€œåŸºæœ¬æ•°æ®æˆ–å¯¹è±¡â€çš„æŒä¹…å­˜å‚¨ã€‚é€šä¿—ç‚¹è®²ï¼Œä¹Ÿå°±æ˜¯èƒ½ç›´æ¥ä¼ è¾“å¯¹è±¡ï¼ˆååºåˆ—åŒ–ä¸­ä½¿ç”¨ï¼‰ï¼Œå’Œæ‰€æœ‰&lt;code&gt;FilterOutputStream&lt;/code&gt; çš„å­ç±»éƒ½æ˜¯è£…é¥°æµ(åºåˆ—åŒ–ä¸­ä½¿ç”¨)ã€‚&lt;/p&gt;
&lt;h4 id="reader"&gt;Reader
&lt;/h4&gt;&lt;p&gt;&lt;img src="https://pic1.zhimg.com/80/v2-0e823bac3cb2feab11a1d7db5b598dc4_1440w.jpg"
loading="lazy"
alt="img"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;CharArrayReader&lt;/code&gt; :å­—ç¬¦æ•°ç»„è¾“å…¥æµã€‚å®ƒå’Œ&lt;code&gt;ByteArrayInputStream&lt;/code&gt;ç±»ä¼¼ï¼Œåªä¸è¿‡&lt;code&gt;ByteArrayInputStream&lt;/code&gt;æ˜¯å­—èŠ‚æ•°ç»„è¾“å…¥æµï¼Œè€Œ&lt;code&gt;CharArray&lt;/code&gt;æ˜¯å­—ç¬¦æ•°ç»„è¾“å…¥æµ&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PipedReader&lt;/code&gt;:ç®¡é“å­—ç¬¦æµï¼Œ æ˜¯ä»ä¸å…¶å®ƒçº¿ç¨‹å…±ç”¨çš„ç®¡é“ä¸­è¯»å–æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;FilterReader&lt;/code&gt;ï¼šè¿‡æ»¤è¾“å…¥å­—ç¬¦æµï¼Œ æ˜¯æ‰€æœ‰è‡ªå®šä¹‰å…·ä½“è£…é¥°æµçš„çˆ¶ç±»ï¼Œä¸ºæ‰€æœ‰è£…é¥°ç±»æä¾›ä¸€ä¸ªæ ‡å‡†ã€åªæ˜¯ç®€å•é‡å†™äº†çˆ¶ç±»Readerçš„æ‰€æœ‰æ–¹æ³•ã€è¦æ±‚å­ç±»å¿…é¡»é‡å†™æ ¸å¿ƒæ–¹æ³•ã€å’Œæä¾›å…·æœ‰è‡ªå·±ç‰¹è‰²çš„æ–¹æ³•ã€è¿™é‡Œæ²¡æœ‰åƒå­—èŠ‚æµé‚£æ ·æœ‰å¾ˆå¤šçš„å­ç±»æ¥å®ç°ä¸åŒçš„åŠŸèƒ½ã€å¯èƒ½æ˜¯å› ä¸ºå­—ç¬¦æµæœ¬æ¥å°±æ˜¯å­—èŠ‚æµçš„ä¸€ç§è£…é¥°ã€æ‰€ä»¥åœ¨è¿™é‡Œæ²¡æœ‰å¿…è¦å†å¯¹å…¶è¿›è¡Œè£…é¥°ã€åªæ˜¯æä¾›ä¸€ä¸ªæ‰©å±•çš„æ¥å£è€Œå·²ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;BufferedReader&lt;/code&gt;ï¼šç¼“å†²å­—ç¬¦æµï¼Œ ä¸ºäº†æé«˜å­—ç¬¦æµè¯»å†™çš„æ•ˆç‡ï¼Œå¼•å…¥äº†ç¼“å†²æœºåˆ¶ï¼Œè¿›è¡Œå­—ç¬¦æ‰¹é‡çš„è¯»å†™ï¼Œæé«˜äº†å•ä¸ªå­—ç¬¦è¯»å†™çš„æ•ˆç‡ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;InputStreamReader&lt;/code&gt;æ˜¯ä¸€ä¸ªè¿æ¥å­—èŠ‚æµå’Œå­—ç¬¦æµçš„æ¡¥æ¢ï¼Œå®ƒå°†å­—èŠ‚æµè½¬å˜ä¸ºå­—ç¬¦æµï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;FileReader&lt;/code&gt;ï¼šç»§æ‰¿&lt;code&gt;InputStreamReader&lt;/code&gt;ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªè¾¾åˆ°æ­¤åŠŸèƒ½ã€å¸¸ç”¨çš„å·¥å…·ç±»ï¼Œåœ¨å…¶æºä»£ç ä¸­æ˜æ˜¾ä½¿ç”¨äº†å°†&lt;code&gt;FileInputStream&lt;/code&gt; è½¬å˜ä¸º&lt;code&gt;Reader&lt;/code&gt; çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ªç±»ä¸­å¾—åˆ°ä¸€å®šçš„æŠ€å·§ã€‚&lt;code&gt;Reader&lt;/code&gt; ä¸­å„ä¸ªç±»çš„ç”¨é€”å’Œä½¿ç”¨æ–¹æ³•åŸºæœ¬å’Œ&lt;code&gt;InputStream&lt;/code&gt; ä¸­çš„ç±»ä½¿ç”¨ä¸€è‡´ã€‚åé¢ä¼šæœ‰&lt;code&gt;Reader&lt;/code&gt; ä¸&lt;code&gt;InputStream&lt;/code&gt; çš„å¯¹åº”å…³ç³»ã€‚&lt;/p&gt;
&lt;h4 id="writer"&gt;Writer
&lt;/h4&gt;&lt;p&gt;&lt;img src="https://pic1.zhimg.com/80/v2-e0bddfb105d00fe202435737684e8240_1440w.jpg"
loading="lazy"
alt="img"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;CharArrayWriter&lt;/code&gt;ã€&lt;code&gt;StringWriter&lt;/code&gt; æ˜¯ä¸¤ç§åŸºæœ¬çš„ä»‹è´¨æµï¼Œå®ƒä»¬åˆ†åˆ«å‘&lt;code&gt;Char&lt;/code&gt; æ•°ç»„ã€&lt;code&gt;String&lt;/code&gt; ä¸­å†™å…¥æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PipedWriter&lt;/code&gt; æ˜¯å‘ä¸å…¶å®ƒçº¿ç¨‹å…±ç”¨çš„ç®¡é“ä¸­å†™å…¥æ•°æ® &lt;code&gt;BufferedWriter&lt;/code&gt; æ˜¯ä¸€ä¸ªè£…é¥°å™¨ä¸º&lt;code&gt;Writer&lt;/code&gt; æä¾›ç¼“å†²åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PrintWriter&lt;/code&gt; å’Œ&lt;code&gt;PrintStream&lt;/code&gt; æå…¶ç±»ä¼¼ï¼ŒåŠŸèƒ½å’Œä½¿ç”¨ä¹Ÿéå¸¸ç›¸ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;OutputStreamWriter&lt;/code&gt; æ˜¯&lt;code&gt;OutputStream&lt;/code&gt; åˆ°&lt;code&gt;Writer&lt;/code&gt; è½¬æ¢çš„æ¡¥æ¢ï¼Œå®ƒçš„å­ç±»&lt;code&gt;FileWriter&lt;/code&gt; å…¶å®å°±æ˜¯ä¸€ä¸ªå®ç°æ­¤åŠŸèƒ½çš„å…·ä½“ç±»ã€‚åŠŸèƒ½å’Œä½¿ç”¨å’Œ&lt;code&gt;OutputStream&lt;/code&gt; æå…¶ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;è½¬æ¢æµ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4.1ã€å®šä¹‰&lt;/strong&gt;ï¼šå­—ç¬¦å’Œå­—èŠ‚ç›´æ¥çš„è½¬æ¢ï¼Œæ˜¯å­—ç¬¦æµå’Œå­—èŠ‚æµä¹‹é—´çš„æ¡¥æ¢ï¼Œæ–‡æœ¬æ–‡ä»¶åœ¨ç¡¬ç›˜ä¸­ä»¥å­—èŠ‚æµçš„å½¢å¼å­˜å‚¨æ—¶ï¼Œé€šè¿‡&lt;code&gt;InputStreamReader&lt;/code&gt;è¯»å–åè½¬åŒ–ä¸ºå­—ç¬¦æµç»™ç¨‹åºå¤„ç†ï¼Œå³å¯å¯¹è¯»å–åˆ°çš„å­—èŠ‚æ•°æ®ç»è¿‡æŒ‡å®šç¼–ç è½¬æ¢æˆå­—ç¬¦ï¼›ç¨‹åºå¤„ç†çš„å­—ç¬¦æµé€šè¿‡&lt;code&gt;OutputStreamWriter&lt;/code&gt;è½¬æ¢ä¸ºå­—èŠ‚æµä¿å­˜ï¼Œå³å¯å¯¹è¯»å–åˆ°çš„å­—ç¬¦æ•°æ®ç»è¿‡æŒ‡å®šç¼–ç è½¬æ¢æˆå­—èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4.2ã€ä½•æ—¶ä½¿ç”¨è½¬æ¢æµï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;â‘ å½“å­—èŠ‚å’Œå­—ç¬¦ä¹‹é—´æœ‰è½¬æ¢åŠ¨ä½œæ—¶ï¼› â‘¡æµæ“ä½œçš„æ•°æ®éœ€è¦ç¼–ç æˆ–è§£ç æ—¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4.3ã€å…·ä½“çš„å¯¹è±¡ä½“ç°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;InputStreamReader&lt;/code&gt;:å­—èŠ‚åˆ°å­—ç¬¦çš„æ¡¥æ¢ &lt;code&gt;OutputStreamWriter&lt;/code&gt;:å­—ç¬¦åˆ°å­—èŠ‚çš„æ¡¥æ¢ è¿™ä¸¤ä¸ªæµå¯¹è±¡æ˜¯å­—ç¬¦ä½“ç³»ä¸­çš„æˆå‘˜ï¼Œå®ƒä»¬æœ‰è½¬æ¢ä½œç”¨ï¼Œæœ¬èº«åˆæ˜¯å­—ç¬¦æµï¼Œæ‰€ä»¥åœ¨æ„é€ çš„æ—¶å€™éœ€è¦ä¼ å…¥å­—èŠ‚æµå¯¹è±¡è¿›æ¥ï¼Œå³ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;InputStreamReader(InputStream in&lt;/code&gt;)ï¼šå°†å­—èŠ‚æµä»¥å­—ç¬¦æµè¾“å…¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;OutputStreamWriter&lt;/code&gt;(&lt;code&gt;OutStreamout&lt;/code&gt;):å°†å­—èŠ‚æµä»¥å­—ç¬¦æµè¾“å‡ºã€‚&lt;/p&gt;
&lt;h4 id="systemin-and-systemout"&gt;&lt;code&gt;System.in&lt;/code&gt; and &lt;code&gt;System.out&lt;/code&gt;
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;System.in&lt;/strong&gt;å’Œ&lt;strong&gt;System.out&lt;/strong&gt;åˆ†åˆ«ä»£è¡¨äº†ç³»ç»Ÿæ ‡å‡†çš„è¾“å…¥å’Œè¾“å‡ºè®¾å¤‡
é»˜è®¤è¾“å…¥è®¾å¤‡æ˜¯ï¼šé”®ç›˜ï¼Œè¾“å‡ºè®¾å¤‡æ˜¯ï¼šæ˜¾ç¤ºå™¨
System.inçš„ç±»å‹æ˜¯InputStream
System.outçš„ç±»å‹æ˜¯PrintStream&lt;/p&gt;
&lt;h4 id="å¯¹è±¡æµ"&gt;å¯¹è±¡æµ
&lt;/h4&gt;&lt;p&gt;ObjectInputStreamå’ŒOjbectOutputSteamç”¨äºå­˜å‚¨å’Œè¯»å–åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®æˆ–å¯¹è±¡çš„å¤„ç†æµã€‚å®ƒçš„å¼ºå¤§ä¹‹å¤„å°±æ˜¯å¯ä»¥æŠŠJavaä¸­çš„å¯¹è±¡å†™å…¥åˆ°æ•°æ®æºä¸­ï¼Œä¹Ÿèƒ½æŠŠå¯¹è±¡ä»æ•°æ®æºä¸­è¿˜åŸå›æ¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åºåˆ—åŒ–ï¼šç”¨ObjectOutputStreamç±»ä¿å­˜åŸºæœ¬ç±»å‹æ•°æ®æˆ–å¯¹è±¡çš„æœºåˆ¶&lt;/li&gt;
&lt;li&gt;ååºåˆ—åŒ–ï¼šç”¨ObjectInputStreamç±»è¯»å–åŸºæœ¬ç±»å‹æ•°æ®æˆ–å¯¹è±¡çš„æœºåˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ObjectOutputStreamå’ŒObjectInputStreamä¸èƒ½åºåˆ—åŒ–staticå’Œtransientä¿®é¥°çš„æˆå‘˜å˜é‡&lt;/p&gt;
&lt;h4 id="æ€»ç»“"&gt;æ€»ç»“
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;InputStream&lt;/code&gt;ç±»çš„åŠŸèƒ½ä¸è¶³è¢«&lt;code&gt;Scanner&lt;/code&gt;è§£å†³äº†&lt;/p&gt;
&lt;p&gt;&lt;code&gt;OutputStream&lt;/code&gt;ç±»çš„åŠŸèƒ½ä¸è¶³è¢«&lt;code&gt;PrintStream&lt;/code&gt;è§£å†³äº†&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Reader&lt;/code&gt;ç±»åŠŸèƒ½ä¸è¶³è¢«&lt;code&gt;BufferReader&lt;/code&gt;è§£å†³äº†&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Writer&lt;/code&gt;ç±»çš„åŠŸèƒ½ä¸è¶³è¢«&lt;code&gt;PrintWriter&lt;/code&gt;è§£å†³äº†&lt;/p&gt;
&lt;p&gt;è¾“å‡ºæ•°æ®ç”¨&lt;code&gt;printStream&lt;/code&gt;ï¼Œ&lt;code&gt;printwriter&lt;/code&gt;è¯»å–æ•°æ®ç”¨&lt;code&gt;Scanner&lt;/code&gt;å…¶æ¬¡æ˜¯&lt;code&gt;bufferReader&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="nio"&gt;NIO
&lt;/h2&gt;&lt;p&gt;java.nioå…¨ç§°java non-blocking IOï¼Œæ˜¯æŒ‡jdk1.4 åŠä»¥ä¸Šç‰ˆæœ¬é‡Œæä¾›çš„æ–°apiï¼ˆNew IOï¼‰ ï¼Œä¸ºæ‰€æœ‰çš„åŸå§‹ç±»å‹ï¼ˆbooleanç±»å‹é™¤å¤–ï¼‰æä¾›ç¼“å­˜æ”¯æŒçš„æ•°æ®å®¹å™¨ï¼Œä½¿ç”¨å®ƒå¯ä»¥æä¾›éé˜»å¡å¼çš„é«˜ä¼¸ç¼©æ€§ç½‘ç»œã€‚&lt;/p&gt;</description></item><item><title>ã€Javaã€‘é‡‘æ—­äº®-Javaç¨‹åºè®¾è®¡</title><link>https://dyhes.github.io/p/java%E9%87%91%E6%97%AD%E4%BA%AE-java%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</link><pubDate>Sat, 11 Dec 2021 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/java%E9%87%91%E6%97%AD%E4%BA%AE-java%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</guid><description>&lt;h2 id="string"&gt;String
&lt;/h2&gt;&lt;h3 id="stringbuffer"&gt;StringBuffer
&lt;/h3&gt;&lt;p&gt;çº¿ç¨‹å®‰å…¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;stringbuffer.toString()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="stringbuilder"&gt;StringBuilder
&lt;/h3&gt;&lt;p&gt;çº¿ç¨‹ä¸å®‰å…¨ï¼Œå› è€Œæ€§èƒ½ç›¸å¯¹æ›´é«˜&lt;/p&gt;
&lt;h2 id="arraysç±»"&gt;Arraysç±»
&lt;/h2&gt;&lt;p&gt;Arraysç±»ä¸­å°è£…äº†ä¸æ•°ç»„æœ‰å…³çš„é™æ€æ–¹æ³•&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Arrays.CcopyOf()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Arrays.sort()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Arrays.fill()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç­‰&lt;/p&gt;
&lt;h2 id="å¯¹è±¡è¿æ¥"&gt;å¯¹è±¡è¿æ¥
&lt;/h2&gt;&lt;p&gt;åœ¨â€œ+ â€è¿ç®—ä¸­ï¼Œå½“ä¸€ä¸ªå¯¹è±¡ä¸ä¸€ä¸ªStringå¯¹è±¡è¿æ¥æ—¶ï¼Œä¼š éšå¼åœ°è°ƒç”¨å…¶toString()æ–¹æ³•ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤æ–¹æ³•è¿”å› â€œç±»å @ + hashCodeâ€ ã€‚ ä¸ºäº†è¿”å›æœ‰æ„ä¹‰çš„ä¿¡æ¯ï¼Œå­ç±»å¯ä»¥é‡å†™toString()æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h2 id="æ¥å£"&gt;æ¥å£
&lt;/h2&gt;&lt;p&gt;åœ¨é¢å‘å¯¹è±¡ä¸–ç•Œä¸­ï¼Œå¯ä»¥ä½¿ç”¨â€œæ¥å£ï¼ˆinterfaceï¼‰â€æ¥æŠ½è±¡å¯¹è±¡çš„&lt;strong&gt;è¡Œä¸ºç‰¹æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;eg:èƒ½å¦æŠŠâ€œä¼šæ¸¸æ³³â€ã€â€œèƒ½è¢«åƒâ€è¿™ç§ç‰¹æ€§ç‹¬ç«‹å‡ºæ¥ä½œä¸ºä¸€ç§â€œå¯é€‰é¡¹â€ï¼Œå¯ä»¥è¢«â€œé™„åŠ â€ åˆ°å…·ä½“å¯¹è±¡ä¸Šï¼Ÿ è¿™æ ·ä¸€æ¥ï¼Œæ°´é¸Ÿå¯ä»¥æ‹¥æœ‰â€œä¼šæ¸¸æ³³â€è¿™ä¸ªç‰¹æ€§ï¼Œå…¶å®ƒç§ç±»çš„é¸Ÿå°±ä¸å…·å¤‡è¿™ä¸ªç‰¹æ€§ï¼Œä½†å®ƒ å¯èƒ½æœ‰å…¶ä»–çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœæ¥å£ä¸å£°æ˜ä¸ºpublicçš„ï¼Œåˆ™è‡ªåŠ¨å˜ä¸ºpackage&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;æ¥å£ç±»å‹ æ¥å£ç±»å‹çš„å˜é‡ï¼ new å®ç°äº†æ¥å£çš„å…·ä½“ç±»å‹ï¼ˆï¼‰ï¼›&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡ç»§æ‰¿æ¥å£æ¥æ‰©å……å·²æœ‰æ¥å£ï¼Œå¹¶å½¢æˆä¸€ä¸ªæ–°çš„æ¥å£&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="å‡½æ•°å¼æ¥å£"&gt;å‡½æ•°å¼æ¥å£
&lt;/h3&gt;&lt;p&gt;JDKä¸­å¼•å…¥äº†ä¸€ç§â€œå‡½æ•°å¼â€æ¥å£ï¼Œè¿™ç§æ¥å£åªå®šä¹‰æœ‰ä¸€ä¸ªå…¬æœ‰ æ–¹æ³•ï¼Œä½¿ç”¨@FunctionalInterfaceæ³¨è§£åŠ ä»¥æ ‡æ³¨ï¼Œè¿™ç§ç±»å‹çš„æ¥å£ï¼Œä¸»è¦ç”¨äºâ€œå‡½æ•°å¼ç¼–ç¨‹â€åœºæ™¯&lt;/p&gt;
&lt;h2 id="å¼‚å¸¸"&gt;å¼‚å¸¸
&lt;/h2&gt;&lt;p&gt;&lt;img src="C:%5cUsers%5cdyhes%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220417171405687.png"
loading="lazy"
alt="image-20220417171405687"
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥æœ‰å¤šä¸ªcatchè¯­å¥å—ï¼Œæ¯ä¸ªä»£ç å—æ•è·ä¸€ç§å¼‚å¸¸ã€‚åœ¨æŸä¸ªtryå—åæœ‰ä¸¤ä¸ªä¸åŒçš„catch å—æ•è·ä¸¤ä¸ªç›¸åŒç±»å‹çš„å¼‚å¸¸æ˜¯è¯­æ³•é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨catchè¯­å¥ï¼Œåªèƒ½æ•è·Exceptionç±»åŠå…¶å­ç±»çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œä¸€ä¸ªæ•è·Exceptionå¯¹è±¡çš„catchè¯­å¥å—å¯ä»¥æ•è·æ‰€æœ‰â€œå¯æ•è·â€çš„å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;å°†catch(Exception e)æ”¾åœ¨åˆ«çš„catchå—å‰é¢ä¼šä½¿è¿™äº›catchå—éƒ½ä¸æ‰§è¡Œï¼Œå› æ­¤Javaä¸ä¼šç¼–è¯‘è¿™ä¸ªç¨‹åº&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Java 7 åŠä»¥åçš„ç‰ˆæœ¬ï¼Œå…è®¸åœ¨ä¸€ä¸ªcatchå—ä¸­æ•è·å¤šä¸ªå¼‚å¸¸ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SocketException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NullPointerException&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="æ³›å‹"&gt;æ³›å‹
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ä¸èƒ½å®šä¹‰æ³›å‹åŒ–æ•°ç»„&lt;/li&gt;
&lt;li&gt;ä¸èƒ½ç›´æ¥åˆ›å»ºæ³›å‹ç±»å‹çš„å®ä¾‹&lt;/li&gt;
&lt;li&gt;æ³›å‹ç±»å‹ä¸èƒ½ç›´æ¥æˆ–é—´æ¥ç»§æ‰¿è‡ªThrowable&lt;/li&gt;
&lt;li&gt;ä¸èƒ½å®šä¹‰é™æ€æ³›å‹æˆå‘˜&lt;/li&gt;
&lt;li&gt;ä¸å…è®¸åŸºç±»ä¸­æœ‰æ³›å‹å‚æ•°ï¼Œä»æ³›å‹åŸºç±»æ´¾ç”Ÿæ—¶ï¼Œåº”è¯¥ç»™å…¶æŒ‡å®šä¸€ä¸ªå…·ä½“çš„ç±»å‹&lt;/li&gt;
&lt;li&gt;å¯ä»¥åœ¨æ™®é€šç±»æˆ–æ³›å‹ç±»ä¸­å®šä¹‰æ³›å‹æ–¹æ³•&lt;/li&gt;
&lt;li&gt;æ³›å‹æ–¹æ³•æ”¯æŒä½¿ç”¨â€œâ€¦â€å®šä¹‰ä¸ªæ•°å¯å˜çš„å‚æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="æ³›å‹çº¦æŸ"&gt;æ³›å‹çº¦æŸ
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ç±»å‹çº¦æŸ&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;extends&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Comparable&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//â€¦&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//T extends Comparable &amp;amp; Serializable&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//å¤šä¸ªçº¦æŸæ¡ä»¶ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªæ˜¯ç±»ï¼Œä¸”å¿…é¡»æ”¾åœ¨ç¬¬ä¸€ä½&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç±»å‹é€šé…ç¬¦&lt;/p&gt;
&lt;p&gt;åœ¨æ³›å‹çº¦æŸä¸­ä½¿ç”¨â€œ?â€ï¼Œå¯ä»¥åŒ¹é…ä»»æ„ç±»å‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;printList&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lst&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;lst&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="å†…éƒ¨ç±»"&gt;å†…éƒ¨ç±»
&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªç±»ä¸­åŒ…å®¹è®¸å¤šæ–¹æ³•å’Œå­—æ®µï¼Œæœ‰äº›å­—æ®µå’Œæ–¹æ³•ä»é€»è¾‘ä¸Šçœ‹å…·æœ‰æ¯”è¾ƒç´§å¯†çš„è”ç³»ï¼Œå¯ä»¥æŠŠå®ƒä»¬â€œæ”¾åœ¨ä¸€å—â€ï¼Œâ€œè§†ä¸ºä¸€ä¸ªæ•´ä½“â€ã€‚&lt;/p&gt;
&lt;p&gt;å†…éƒ¨ç±»å¯çœ‹æˆæ˜¯å¤–éƒ¨ç±»çš„æˆå‘˜ï¼Œå…¶åœ°ä½ç­‰åŒäºç±»ä¸­çš„å…¶ä»–æˆå‘˜ã€‚å†…éƒ¨ç±»ç¼–è¯‘ä»¥åï¼Œæ¯ä¸ªå†…éƒ¨ç±»éƒ½ä¼šäº§ç”Ÿä¸€ä¸ª.classæ–‡ä»¶ï¼Œå…¶æ–‡ä»¶åé€šå¸¸å…·æœ‰ä»¥ä¸‹æ ¼å¼ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;å¤–éƒ¨ç±»å$å†…éƒ¨ç±»å&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="comparableæ¥å£"&gt;Comparableæ¥å£
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;//old&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;Comparable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;compareTo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//new and recomended&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inteface&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Comparable&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;compareTo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareTo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//å¯¹è±¡Xå’ŒYç›¸ç­‰ï¼Œè¿”å›0&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//å¯¹è±¡X&amp;lt;Y,è¿”å›-1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//X&amp;gt;Yï¼Œè¿”å›1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡¡æ˜¯æ”¯æŒå¤§å°æ¯”è¾ƒçš„ç±»å‹ï¼ˆæ¯”å¦‚Integerï¼‰ï¼Œéƒ½å®ç°äº†Comparableæ¥å£ã€‚&lt;/p&gt;
&lt;h2 id="-and-equals"&gt;â€˜==â€™ and &lt;code&gt;equals()&lt;/code&gt;
&lt;/h2&gt;&lt;p&gt;â€œ ==â€æ–½åŠ äºå¯¹è±¡ç±»å‹ï¼Œæ˜¯æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å˜é‡æ˜¯å¦å¼•ç”¨åŒä¸€å¯¹è±¡ã€‚å¦‚æœéœ€è¦æ¯”å¯¹å¯¹è±¡çš„â€œå†…å®¹ï¼ˆå³å„å­—æ®µçš„å€¼ï¼‰â€ï¼Œé€šå¸¸æ˜¯è°ƒç”¨å¯¹è±¡çš„ equalsæ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;equalsæ–¹æ³•ç”±Objectç±»æ‰€å®šä¹‰ï¼Œå…¶é»˜è®¤å®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;equals&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å­ç±»å¯æ ¹æ®å®é™…æƒ…å†µï¼Œâ€œé‡å†™ï¼ˆOverrideï¼‰â€Objectç±»çš„equalsæ–¹æ³•&lt;/p&gt;
&lt;p&gt;é‡å†™Objectçš„equalsæ–¹æ³•ï¼Œæ³¨æ„å…¶&lt;strong&gt;å‚æ•°ç±»å‹å¿…é¡»æ˜¯â€œObjectâ€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œä¸ºäº†è®©å¯¹è±¡èƒ½æ”¾å…¥å„ç§å®¹å™¨ä¸­ï¼Œé€šå¸¸è¿˜éœ€è¦é‡å†™ hashCodeæ–¹æ³•ã€‚&lt;/p&gt;
&lt;h2 id="å¯¹è±¡ç»„åˆ"&gt;å¯¹è±¡ç»„åˆ
&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªå¯¹è±¡åŒ…å®¹å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç§°ä¸ºâ€œå¯¹è±¡ç»„åˆâ€&lt;/p&gt;
&lt;p&gt;æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Aå¯¹è±¡å®Œå…¨åŒ…å®¹Bå¯¹è±¡ï¼Œå®¹å™¨å¯¹è±¡ç®¡ç†è¢«åŒ…å®¹å¯¹è±¡çš„ç”Ÿå‘½æœŸ&lt;/li&gt;
&lt;li&gt;Bå¯¹è±¡æ˜¯ç‹¬ç«‹çš„ï¼ŒAå¯¹è±¡å¼•ç”¨ç°æˆçš„Bå¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="cloneable"&gt;Cloneable
&lt;/h2&gt;&lt;p&gt;JDKä¸­æä¾›äº†ä¸€ä¸ªCloneableæ¥å£ï¼Œéœ€è¦å®ç°æ·±å¤åˆ¶çš„å¯¹è±¡åº”è¯¥å®ç°è¿™ä¸€æ¥å£ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;Cloneable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åƒè¿™ç§æ ¹æœ¬å°±æ²¡æœ‰å®šä¹‰ä»»ä½•ä¸€ä¸ªæˆå‘˜çš„æ¥å£ï¼Œç§°ä¸ºâ€œæ ‡è®°æ¥å£â€ã€‚&lt;/p&gt;
&lt;h2 id="collection"&gt;Collection
&lt;/h2&gt;&lt;p&gt;&lt;img src="C:%5cUsers%5cdyhes%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220417184028233.png"
loading="lazy"
alt="image-20220417184028233"
&gt;&lt;/p&gt;
&lt;h2 id="iterator"&gt;Iterator
&lt;/h2&gt;&lt;p&gt;Iteratoræ¥å£å®šä¹‰äº†3ä¸ªæ–¹æ³•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Iterator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;hasNext&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;next&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// è·å–ä¸‹ä¸€ä¸ªå…ƒç´ &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// ç§»é™¤iteratorè¿”å›çš„ä¸Šä¸€ä¸ªå…ƒç´ &lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰€æœ‰å®ç°äº†Collectionæ¥å£çš„é›†åˆå¯¹è±¡ï¼Œéƒ½æä¾›äº†ä¸€ä¸ªiterator()æ–¹æ³•ï¼Œ ä»¥è·å–ä¸€ä¸ªiteratorå¯¹è±¡&lt;/p&gt;
&lt;p&gt;JDK 5ä»¥åï¼ŒCollectionæ¥å£æ´¾ç”Ÿè‡ªIterableï¼Œå› æ­¤JDKä¸­å†…ç½®çš„æ‰€æœ‰é›†åˆéƒ½å¯ä»¥ä½¿ ç”¨æ–°çš„foreachè¯­å¥å®Œæˆéå†å·¥ä½œ&lt;/p&gt;
&lt;p&gt;é›†åˆå¯¹è±¡æœ‰ä¸€ä¸ªforEach()æ–¹æ³•ï¼Œå®ƒå¯ä»¥æ¥æ”¶ä¸€ä¸ªLambdaè¡¨è¾¾å¼ï¼Œå¯ç”¨äºéå†é›†åˆå…ƒç´ ï¼Œ å®ƒä¸foreachå¾ªç¯ä¸æ˜¯ä¸€å›äº‹ï¼Œ foreachå¾ªç¯æ˜¯ä¸€ç§è¯­æ³•ç‰¹æ€§ï¼Œ forEachåˆ™æ˜¯JDKä¸ºé›†åˆç±»å‹æä¾›çš„ä¸€ä¸ªæ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåœ¨éå†æ—¶éè¦åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ï¼Œåˆ™å¿…é¡»é€šè¿‡è¿­ä»£å™¨å¯¹è±¡çš„removeæ–¹æ³•ï¼Œ è€Œä¸èƒ½é€šè¿‡é›†åˆå¯¹è±¡ç›´æ¥åˆ é™¤ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡ç¡®å®å¯ä»¥åœ¨è¿­ä»£æ—¶ç§»é™¤å½“å‰è®¿é—®çš„å…ƒç´ ï¼Œä½†å¹¶ä¸æ¨èè¿™ä¹ˆåšï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¼šå¸¦æ¥å¾ˆå¤§çš„éº»çƒ¦ã€‚æ¨èçš„ä½œæ³•æ˜¯ä½¿ç”¨Stream APIä¸­çš„filter()æ–¹æ³•ï¼Œè¿‡æ»¤æ‰ä¸éœ€è¦çš„å…ƒç´ ã€‚&lt;/p&gt;
&lt;h2 id="hashtable"&gt;HashTable
&lt;/h2&gt;&lt;p&gt;HashMapå’ŒHashTableä¸¤è€…åŠŸèƒ½ä¸ç”¨æ³•åŸºæœ¬ä¸€æ ·ï¼Œä½†HashTableæ˜¯&lt;strong&gt;çº¿ç¨‹å®‰å…¨&lt;/strong&gt;çš„ï¼Œ å¦å¤–ï¼ŒHashMapå¯ä»¥ä½¿ç”¨nullä½œä¸ºKeyã€‚&lt;/p&gt;
&lt;h3 id="properties"&gt;Properties
&lt;/h3&gt;&lt;p&gt;Propertiesæ´¾ç”Ÿè‡ªHashTableï¼Œå¯ä»¥æ–¹ä¾¿åœ°å¤„ç†â€œå±æ€§-å€¼â€å¯¹ï¼Œå¹¶ä¸”å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†å…¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œåœ¨ç¼–ç¨‹ä¸­å¾ˆå¸¸ç”¨&lt;/p&gt;
&lt;h2 id="collections"&gt;Collections
&lt;/h2&gt;&lt;p&gt;Javaæä¾›äº†ä¸€ä¸ªå·¥å…·ç±»Collectionsï¼Œå°è£…äº†ä¸€äº›é›†åˆçš„å¸¸è§„æ“ä½œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ›´æ”¹é›†åˆä¸­å…ƒç´ çš„é¡ºåºï¼šreverseã€rotateã€shuffleã€sortå’Œswap&lt;/li&gt;
&lt;li&gt;ç”¨ä¸€ä¸ªé›†åˆå¡«å……å¦ä¸€ä¸ªé›†åˆï¼šcopyã€fillå’ŒreplaceAllã€ addAll&lt;/li&gt;
&lt;li&gt;è·å–é›†åˆä¸­çš„æœ€å¤§å’Œæœ€å°å…ƒç´ ï¼šmaxã€min&lt;/li&gt;
&lt;li&gt;æŸ¥æ‰¾å…ƒç´ ï¼š binarySearchã€ indexOfSubListå’ŒlastIndexOfSubList&lt;/li&gt;
&lt;li&gt;åˆ›å»ºåŒ…å®¹å¤šä¸ªç›¸åŒå…ƒç´ çš„é›†åˆï¼šnCopies&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="å‡½æ•°å¼ç¼–ç¨‹"&gt;å‡½æ•°å¼ç¼–ç¨‹
&lt;/h2&gt;&lt;p&gt;Javaå¯¹â€œå‡½æ•°å¼ç¼–ç¨‹â€èŒƒå¼çš„æ”¯æŒï¼Œæ˜¯ä»JDK 8å¼•å…¥Lambdaè¡¨è¾¾å¼ä¹‹åæ‰å¼€å§‹çš„ï¼Œä¸»è¦åŒ…å®¹ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lambdaè¡¨è¾¾å¼ä¸å‡½æ•°å¼æ¥å£ç‰¹æ€§ï¼ˆJDK 8èµ·ï¼‰&lt;/li&gt;
&lt;li&gt;Stream APIï¼ˆJDK 8èµ·ï¼‰ä¸Flow APIï¼ˆJDK 9èµ·ï¼‰&lt;/li&gt;
&lt;li&gt;å¯¹JDKåŸæœ‰ç»„ä»¶è¿›è¡Œæ”¹é€ ï¼Œä»¥æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹èŒƒå¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="å‡½æ•°å¼æ¥å£-1"&gt;å‡½æ•°å¼æ¥å£
&lt;/h3&gt;&lt;p&gt;èƒ½æ¥æ”¶ä¸€ä¸ªLambdaè¡¨è¾¾å¼çš„å˜é‡ï¼Œå¿…é¡»æ˜¯æ¥å£ç±»å‹ï¼Œå¹¶ä¸”è¿™ç§æ¥å£ï¼Œè¿˜å¿… é¡»æ˜¯ä¸€ç§â€œå‡½æ•°å¼æ¥å£ï¼ˆfunctional interfaceï¼‰â€ã€‚æ‰€è°“â€œå‡½æ•°å¼æ¥å£â€ï¼Œå°±æ˜¯â€œåªå®šä¹‰æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£â€ã€‚Java 8ä¸­ï¼Œä½¿ç”¨â€œ@FunctionalInterfaceâ€æ ‡è¯†ä¸€ä¸ªâ€œå‡½æ•°å¼æ¥å£â€ã€‚&lt;/p&gt;
&lt;p&gt;JDK8 ä»¥åæ¥å£å¯æœ‰é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•&lt;/p&gt;
&lt;h3 id="æ–¹æ³•å¼•ç”¨"&gt;æ–¹æ³•å¼•ç”¨
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;ClassName::Method&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥æŠŠæ–¹æ³•å¼•ç”¨çœ‹ä½œé’ˆå¯¹ä»…ä»…æ¶‰åŠå•ä¸€æ–¹æ³•çš„Lambdaçš„â€œè¯­æ³• ç³–â€&lt;/p&gt;
&lt;h3 id="stream-api"&gt;Stream API
&lt;/h3&gt;&lt;p&gt;ä¸åŒäºæ–‡ä»¶æ“ä½œä¸­çš„Stream,è€Œæ˜¯&lt;strong&gt;ä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„å…ƒç´ åºåˆ—&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Stream APIé‡‡ç”¨ä¸€ç§â€œå³æŠ½å–å³ä½¿ç”¨å³ä¸¢å¼ƒâ€çš„æ–¹å¼å¤„ç†æ•°æ®ï¼Œä¸éœ€è¦æŠŠæ‰€æœ‰æ•°æ®éƒ½åŠ è½½åˆ°å†…å­˜ä¸­ï¼ˆé›†åˆå°±æ˜¯è¿™æ ·çš„ï¼‰æ‰èƒ½å·¥ä½œï¼Œæ‰€ä»¥ï¼Œèƒ½å¤„ç†å¾ˆå¤§çš„æ•°æ®é›†&lt;/p&gt;
&lt;p&gt;Stream APIä¸­å®šä¹‰çš„æ•°æ®å¤„ç†å‡½æ•°ï¼Œé€šå¸¸å¯ä»¥çº§è”è°ƒç”¨ï¼Œæ„æˆä¸€ä¸ªæ•°æ®å¤„ç†é“¾æ¡&lt;/p&gt;
&lt;p&gt;Stream APIä¸­å®šä¹‰çš„æ•°æ®å¤„ç†å‡½æ•°ï¼Œå¯ä»¥åˆ†ä¸º&lt;strong&gt;ä¸­é—´æ“ä½œ&lt;/strong&gt;å’Œ&lt;strong&gt;ç»ˆç«¯æ“ä½œ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;intermediate operation&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;peek()&lt;/code&gt;:similar to &lt;code&gt;forEach()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;limit()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;skip()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;filter()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sorted()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;map()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;terminal operation&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;forEach()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;reduce()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;collect()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åˆ›å»ºæµå¯¹è±¡"&gt;åˆ›å»ºæµå¯¹è±¡
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸºäºé›†åˆï¼šæ‰€æœ‰é›†åˆå¯¹è±¡éƒ½å®ç°çš„Collectionæ¥å£å®šä¹‰äº†ä¸€ä¸ªStream()æˆ– parallelStream()æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥åˆ›å»ºæµå¯¹è±¡&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;Stream.Of&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;Stream.Builder&lt;/code&gt;æ¥å£&lt;/li&gt;
&lt;li&gt;é’ˆå¯¹intã€longã€doubleè¿™ä¸‰ç§åŸå§‹æ•°å€¼ç±»å‹ï¼Œjava 8æä¾›äº†å•ç‹¬çš„æµç±»å‹ï¼š IntStreamã€LongStreamå’ŒDoubleStream&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Stream.empty()&lt;/code&gt;åˆ›å»ºç©ºæµ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="æ¨¡å—åŒ–å¼€å‘"&gt;æ¨¡å—åŒ–å¼€å‘
&lt;/h2&gt;&lt;p&gt;JPMSï¼ˆJava Platform Module Systemï¼‰ï¼Œæ˜¯ JDK 9å¼•å…¥çš„æœ€é‡è¦çš„æ–°ç‰¹æ€§ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡å—åŒ–ä¹‹åï¼Œæ•´ä¸ªç¨‹åºè¢«åˆ†è§£ä¸ºè‹¥å¹²ä¸ªä¸¥æ ¼é™å®šä¾èµ–å…³ç³»çš„æ¨¡å—ã€‚åªè¦ä¸æ˜¾å¼å£°æ˜å¯¼å‡ºï¼Œæ¨¡å—ä¸­çš„æ‰€æœ‰ç±»å¤–ç•Œéƒ½æ˜¯ä¸å¯è®¿é—®çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡å—ï¼ˆmoduleï¼‰æ˜¯åŒ…å«ä»£ç çš„å¯è¯†åˆ«è½¯ä»¶æ„ä»¶ï¼Œä½¿ç”¨äº†å…ƒæ•°æ®ï¼ˆmetadataï¼‰æ¥æè¿°æ¨¡å—åŠå…¶ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»ã€‚ å¯ä»¥æŠŠæ¨¡å—çœ‹æˆæ˜¯ä¸€ç»„ç”¨äºä»£ç é‡ç”¨çš„åŒ…ï¼ˆpackageï¼‰ã€‚æ¨¡å—åŒ–ï¼ˆ modularizationï¼‰æ˜¯æŒ‡å°†ç³»ç»Ÿåˆ†è§£æˆç‹¬ç«‹ä¸”ç›¸äº’è¿æ¥çš„æ¨¡å—çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“æ•£åçš„JDKæ¨¡å—ï¼Œ ä»¥.jmodä½œä¸ºæ–‡ä»¶æ‰©å±•åã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡å—ä¹‹é—´å­˜åœ¨ç€â€œå•å‘â€ä¾èµ–å…³ç³»ï¼ŒJavaæ¨¡å—ç³»ç»Ÿä¸å…è®¸æ¨¡å—ä¹‹é—´ å­˜åœ¨ç¼–è¯‘æ—¶çš„å¾ªç¯ä¾èµ–&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªæ¨¡å—éƒ½éšå¼ä¾èµ–äºä¸€ä¸ªåä¸ºâ€œjava.baseâ€çš„ç‰¹æ®Šæ¨¡å—ï¼Œå®ƒæ˜¯ ä¸€ç§â€œèšåˆå™¨æ¨¡å—ï¼ˆaggregator moduleï¼‰â€ï¼Œè¿™ç§ç±»å‹çš„æ¨¡å—ä¸»è¦ç”¨äºå¯¹å…¶ä»–æ¨¡å—è¿›è¡Œé€»è¾‘åˆ†ç»„ï¼Œé¿å…åœ¨module-info.javaä¸­å¯¼å…¥å¤ªå¤šçš„æ¨¡å—å£°æ˜ã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡å—è®¾è®¡ä¸‰ä¸ªæ ¸å¿ƒåŸåˆ™&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¼ºå°è£…æ€§&lt;/li&gt;
&lt;li&gt;å®šä¹‰è‰¯å¥½çš„æ¥å£&lt;/li&gt;
&lt;li&gt;æ˜¾å¼ä¾èµ–&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="gui-javafx"&gt;GUI-JavaFX
&lt;/h2&gt;&lt;p&gt;JavaFXåœ¨è®¾è®¡ä¹‹åˆå°±è€ƒè™‘äº†åº”ç”¨MVCè®¾è®¡æ¨¡å¼ï¼Œæ•´ä¸ªJavaFXåº”ç”¨ æ¡†æ¶å›´ç»•ç€MVCè®¾è®¡æ¨¡å¼è€Œå±•å¼€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="C:%5cUsers%5cdyhes%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220419095921802.png"
loading="lazy"
alt="image-20220419095921802"
&gt;&lt;/p&gt;
&lt;h2 id="javabean"&gt;JavaBean
&lt;/h2&gt;&lt;p&gt;JavaBeanå¯ä»¥çœ‹æˆæ˜¯ä¸€ç§ç¼–ç¨‹çº¦å®šï¼ŒæŒ‰ç…§è¿™ç§çº¦å®šç¼–å†™Javaç±»ï¼Œå¼€å‘è€…ä¹‹é—´å°±æ˜“äºåä½œï¼Œå¹¶ä¸”ä»£ç ä¹Ÿæ˜“äºé‡ç”¨ï¼Œå¹¶ä¸”æœ‰ä¸€äº›å¼€å‘å·¥å…·ï¼ˆæ¯”å¦‚ NetBeansè¿™æ ·çš„IDEï¼‰èƒ½è¯†åˆ«JavaBeanæ‰€å®šä¹‰çš„å„ç§å±æ€§ã€æ–¹æ³•å’Œäº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="C:%5cUsers%5cdyhes%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220419101022585.png"
loading="lazy"
alt="image-20220419101022585"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://www.blog.dyhes.cn/wp-content/uploads/2022/04/image-20220419101022585.png" target="_blank" rel="noopener"
&gt;http://www.blog.dyhes.cn/wp-content/uploads/2022/04/image-20220419101022585.png&lt;/a&gt;&lt;/p&gt;</description></item><item><title>ã€Javaã€‘Basics</title><link>https://dyhes.github.io/p/javabasics/</link><pubDate>Sun, 20 Dec 2020 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/javabasics/</guid><description>&lt;h2 id="introduction"&gt;Introduction
&lt;/h2&gt;&lt;p&gt;Every line of code that runs in Java must be inside a &lt;code&gt;class&lt;/code&gt;. A class should always start with an uppercase first letter.&lt;/p&gt;
&lt;p&gt;The name of the java file &lt;strong&gt;must match&lt;/strong&gt; the class name. When saving the file, save it using the class name and add &amp;ldquo;.java&amp;rdquo; to the end of the filename.&lt;/p&gt;
&lt;p&gt;Every program must contain the &lt;code&gt;main()&lt;/code&gt; method.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="variables"&gt;Variables
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;variablename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;arrayname&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="data-types"&gt;Data Types
&lt;/h3&gt;&lt;h4 id="primitive-types"&gt;primitive types
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;Data Type&lt;/th&gt;
&lt;th style="text-align: left"&gt;Size&lt;/th&gt;
&lt;th style="text-align: left"&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;byte&lt;/td&gt;
&lt;td style="text-align: left"&gt;1 byte&lt;/td&gt;
&lt;td style="text-align: left"&gt;Stores whole numbers from -128 to 127&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;short&lt;/td&gt;
&lt;td style="text-align: left"&gt;2 bytes&lt;/td&gt;
&lt;td style="text-align: left"&gt;Stores whole numbers from -32,768 to 32,767&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;int&lt;/td&gt;
&lt;td style="text-align: left"&gt;4 bytes&lt;/td&gt;
&lt;td style="text-align: left"&gt;Stores whole numbers from -2,147,483,648 to 2,147,483,647&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;long&lt;/td&gt;
&lt;td style="text-align: left"&gt;8 bytes&lt;/td&gt;
&lt;td style="text-align: left"&gt;Stores whole numbers from -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;float&lt;/td&gt;
&lt;td style="text-align: left"&gt;4 bytes&lt;/td&gt;
&lt;td style="text-align: left"&gt;Stores fractional numbers. Sufficient for storing 6 to 7 decimal digits&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;double&lt;/td&gt;
&lt;td style="text-align: left"&gt;8 bytes&lt;/td&gt;
&lt;td style="text-align: left"&gt;Stores fractional numbers. Sufficient for storing 15 decimal digits&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;boolean&lt;/td&gt;
&lt;td style="text-align: left"&gt;1 bit&lt;/td&gt;
&lt;td style="text-align: left"&gt;Stores true or false values&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;char&lt;/td&gt;
&lt;td style="text-align: left"&gt;2 bytes&lt;/td&gt;
&lt;td style="text-align: left"&gt;Stores a single character/letter or ASCII values&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="non-primitive"&gt;Non-primitive
&lt;/h4&gt;&lt;p&gt;Non-primitive data types are called &lt;strong&gt;reference types&lt;/strong&gt; because they refer to objects.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;String&lt;/li&gt;
&lt;li&gt;Arrays&lt;/li&gt;
&lt;li&gt;Classes&lt;/li&gt;
&lt;li&gt;Interfaces&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="main-difference"&gt;main difference
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Primitive types are &lt;strong&gt;predefined&lt;/strong&gt; in Java. Non-primitive types are created by the programmer and is not defined by Java (except for &lt;code&gt;String&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;A primitive type has always a value, while non-primitive types can be &lt;code&gt;null&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;A &lt;strong&gt;primitive type&lt;/strong&gt; starts with a &lt;strong&gt;lowercase letter&lt;/strong&gt;, while &lt;strong&gt;non-primitive types&lt;/strong&gt; starts with an &lt;strong&gt;uppercase letter&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;The size of a primitive type depends on the data type, while &lt;strong&gt;non-primitive types have all the same size&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="final"&gt;final
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myNum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;15&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//you couldn&amp;#39;t change it anymore&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//just like const in js&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="name-rules"&gt;name rules
&lt;/h3&gt;&lt;p&gt;The general rules for naming variables are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Names can contain &lt;strong&gt;letters, digits, underscores, and dollar signs&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Names must &lt;strong&gt;begin with a letter&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Names should start with a &lt;strong&gt;lowercase&lt;/strong&gt; letter and it &lt;strong&gt;cannot contain whitespace&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Names can also begin with &lt;strong&gt;$ and _&lt;/strong&gt; (but we will not use it in this tutorial)&lt;/li&gt;
&lt;li&gt;Names are &lt;strong&gt;case sensitive&lt;/strong&gt; (&amp;ldquo;myVar&amp;rdquo; and &amp;ldquo;myvar&amp;rdquo; are different variables)&lt;/li&gt;
&lt;li&gt;Reserved words (like Java keywords, such as &lt;code&gt;int&lt;/code&gt; or &lt;code&gt;boolean&lt;/code&gt;) cannot be used as names&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="casting"&gt;Casting
&lt;/h3&gt;&lt;h4 id="widening-casting"&gt;Widening Casting
&lt;/h4&gt;&lt;p&gt;Widening casting is done automatically when passing a smaller size type to a larger size type&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myInt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;9&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myDouble&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myInt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="narrowing-casting"&gt;Narrowing Casting
&lt;/h4&gt;&lt;p&gt;Narrowing casting must be done manually by placing the type in parentheses in front of the value&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myDouble&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;9&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;78d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myInt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myDouble&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="overload"&gt;Overload
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;myMethod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;myMethod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;myMethod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;myMethod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="classes"&gt;Classes
&lt;/h2&gt;&lt;p&gt;a class is a template for objects, and an object is an instance of a class.&lt;/p&gt;
&lt;h3 id="constructor"&gt;Constructor
&lt;/h3&gt;&lt;p&gt;A constructor in Java is a &lt;strong&gt;special method&lt;/strong&gt; that is used to initialize objects. The constructor is called when an object of a class is created. It can be used to set initial values for object attributes&lt;/p&gt;
&lt;p&gt;Note that the constructor name must &lt;strong&gt;match the class name&lt;/strong&gt;, and it cannot have a &lt;strong&gt;return type&lt;/strong&gt; (like &lt;code&gt;void&lt;/code&gt;).&lt;/p&gt;
&lt;h3 id="modifiers"&gt;Modifiers
&lt;/h3&gt;&lt;h4 id="access-modifiers"&gt;Access Modifiers
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;**public: **accessible for all classes&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;protected:&lt;/strong&gt; accessible in the same package and &lt;strong&gt;subclasses&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;**default: **accessible in the same package&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;private:&lt;/strong&gt; only accessible within the declared class&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="non-access-modifiers"&gt;Non-Access Modifiers
&lt;/h4&gt;&lt;h5 id="for-classes"&gt;for classes
&lt;/h5&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;final&lt;/strong&gt;: cannot be inherited&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;abstract&lt;/strong&gt;: cannot be used to create objects&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id="for-attributes-and-methods"&gt;for attributes and methods
&lt;/h5&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;final&lt;/strong&gt;: cannot be overridden/modified&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;static&lt;/strong&gt; :belongs to the class, rather than an object&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;abstract&lt;/strong&gt;: Can only be used in an abstract class, and can only be used on methods.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="main-concepts-of-oop"&gt;Main Concepts of OOP
&lt;/h3&gt;&lt;h4 id="encapsulation"&gt;Encapsulation
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;declare class variables/attributes as &lt;code&gt;private&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;provide public &lt;strong&gt;get&lt;/strong&gt; and &lt;strong&gt;set&lt;/strong&gt; methods to access and update the value of a &lt;code&gt;private&lt;/code&gt; variable&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To inherit from a class, use the &lt;code&gt;extends&lt;/code&gt; keyword.&lt;/p&gt;
&lt;h4 id="inheritance"&gt;Inheritance
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;subclass&lt;/strong&gt; (child) - the class that inherits from another class&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;superclass&lt;/strong&gt; (parent) - the class being inherited from&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="polymorphism"&gt;Polymorphism
&lt;/h4&gt;&lt;p&gt;subclasses can override methods inherited from superclasses&lt;/p&gt;
&lt;h4 id="abstract"&gt;Abstract
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Abstract class:&lt;/strong&gt; is a restricted class that cannot be used to create objects (to access it, it must be inherited from another class).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Abstract method:&lt;/strong&gt; can only be used in an abstract class, and it does not have a body. The body is provided by the subclass (inherited from).&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="interface"&gt;Interface
&lt;/h3&gt;&lt;p&gt;An &lt;code&gt;interface&lt;/code&gt; is a completely &amp;ldquo;&lt;strong&gt;abstract class&lt;/strong&gt;&amp;rdquo; that is used to group related methods with empty bodies&lt;/p&gt;
&lt;p&gt;To access the interface methods, the interface must be &amp;ldquo;implemented&amp;rdquo; (kinda like inherited) by another class with the &lt;code&gt;implements&lt;/code&gt; keyword (instead of &lt;code&gt;extends&lt;/code&gt;). The body of the interface method is provided by the &amp;ldquo;implement&amp;rdquo; class.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;On implementation of an interface, you must override all of its methods&lt;/li&gt;
&lt;li&gt;Interface &lt;strong&gt;methods&lt;/strong&gt; are by default &lt;code&gt;abstract&lt;/code&gt; and &lt;code&gt;public&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Interface &lt;strong&gt;attributes&lt;/strong&gt; are by default &lt;code&gt;public&lt;/code&gt;, &lt;code&gt;static&lt;/code&gt; and &lt;code&gt;final&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;An interface cannot contain a constructor (as it cannot be used to create objects)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="why"&gt;why
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;To achieve &lt;strong&gt;security&lt;/strong&gt; - hide certain details and only show the important details of an object (interface).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Java does not support &amp;ldquo;multiple inheritance&amp;rdquo; (a class can only inherit from one superclass). However, it can be achieved with interfaces, because the class can &lt;strong&gt;implement&lt;/strong&gt; multiple interfaces. &lt;strong&gt;Note:&lt;/strong&gt; To implement multiple interfaces, separate them with a comma (see example below).&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="inner-classes"&gt;Inner Classes
&lt;/h3&gt;&lt;p&gt;In Java, it is also possible to nest classes (a class within a class). The purpose of nested classes is to group classes that belong together, which makes your code more &lt;strong&gt;readable and maintainable&lt;/strong&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;OuterClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;InnerClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OuterClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myOuter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OuterClass&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OuterClass&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;InnerClass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myInner&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myOuter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;InnerClass&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;myInner&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myOuter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="wrapper-classes"&gt;Wrapper Classes
&lt;/h3&gt;&lt;p&gt;Wrapper classes provide a way to use primitive data types (&lt;code&gt;int&lt;/code&gt;, &lt;code&gt;boolean&lt;/code&gt;, etc..) as objects.&lt;/p&gt;
&lt;p&gt;The table below shows the primitive type and the equivalent wrapper class:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;Primitive Data Type&lt;/th&gt;
&lt;th style="text-align: left"&gt;Wrapper Class&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;byte&lt;/td&gt;
&lt;td style="text-align: left"&gt;Byte&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;short&lt;/td&gt;
&lt;td style="text-align: left"&gt;Short&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;int&lt;/td&gt;
&lt;td style="text-align: left"&gt;Integer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;long&lt;/td&gt;
&lt;td style="text-align: left"&gt;Long&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;float&lt;/td&gt;
&lt;td style="text-align: left"&gt;Float&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;double&lt;/td&gt;
&lt;td style="text-align: left"&gt;Double&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;boolean&lt;/td&gt;
&lt;td style="text-align: left"&gt;Boolean&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;char&lt;/td&gt;
&lt;td style="text-align: left"&gt;Character&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="enums"&gt;Enums
&lt;/h2&gt;&lt;p&gt;An &lt;code&gt;enum&lt;/code&gt; is a special &amp;ldquo;class&amp;rdquo; that represents a group of &lt;strong&gt;constants&lt;/strong&gt; (unchangeable variables, like &lt;code&gt;final&lt;/code&gt; variables).&lt;/p&gt;
&lt;p&gt;To create an &lt;code&gt;enum&lt;/code&gt;, use the &lt;code&gt;enum&lt;/code&gt; keyword (instead of class or interface), and separate the constants with a comma. Note that they should be in uppercase letters&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;enum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LOW&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MEDIUM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HIGH&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//looping&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myVar&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Level&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;values&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;myVar&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;An &lt;code&gt;enum&lt;/code&gt; can, just like a &lt;code&gt;class&lt;/code&gt;, have attributes and methods. The only difference is that enum constants are &lt;code&gt;public&lt;/code&gt;, &lt;code&gt;static&lt;/code&gt; and &lt;code&gt;final&lt;/code&gt; (unchangeable - cannot be overridden).&lt;/p&gt;
&lt;p&gt;An &lt;code&gt;enum&lt;/code&gt; cannot be used to create objects, and it cannot extend other classes (but it can implement interfaces).&lt;/p&gt;
&lt;h2 id="user-input"&gt;User Input
&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;Scanner&lt;/code&gt; class is used to get user input, and it is found in the &lt;code&gt;java.util&lt;/code&gt; package.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.util.Scanner&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Import the Scanner class&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Scanner&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myObj&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Scanner&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;in&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Create a Scanner object&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Enter username&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userName&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;myObj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;nextLine&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Read user input&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Username is: &amp;#34;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userName&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Output user input&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;Method&lt;/th&gt;
&lt;th style="text-align: left"&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;nextBoolean()&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;Reads a &lt;code&gt;boolean&lt;/code&gt; value from the user&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;nextByte()&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;Reads a &lt;code&gt;byte&lt;/code&gt; value from the user&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;nextDouble()&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;Reads a &lt;code&gt;double&lt;/code&gt; value from the user&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;nextFloat()&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;Reads a &lt;code&gt;float&lt;/code&gt; value from the user&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;nextInt()&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;Reads a &lt;code&gt;int&lt;/code&gt; value from the user&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;nextLine()&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;Reads a &lt;code&gt;String&lt;/code&gt; value from the user&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;nextLong()&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;Reads a &lt;code&gt;long&lt;/code&gt; value from the user&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;nextShort()&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;Reads a &lt;code&gt;short&lt;/code&gt; value from the user&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="collections"&gt;Collections
&lt;/h2&gt;&lt;h4 id="arraylist"&gt;ArrayList
&lt;/h4&gt;&lt;p&gt;The &lt;code&gt;ArrayList&lt;/code&gt; class is a resizable array&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cars&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="linkedlist"&gt;LinkedList
&lt;/h4&gt;&lt;p&gt;The &lt;code&gt;LinkedList&lt;/code&gt; class has all of the same methods as the &lt;code&gt;ArrayList&lt;/code&gt; class because they both implement the &lt;code&gt;List&lt;/code&gt; interface. But they work in different way.&lt;/p&gt;
&lt;h4 id="hashmap"&gt;HashMap
&lt;/h4&gt;&lt;p&gt;A &lt;code&gt;HashMap&lt;/code&gt; however, store items in &amp;ldquo;&lt;strong&gt;key&lt;/strong&gt;/&lt;strong&gt;value&lt;/strong&gt;&amp;rdquo; pairs, and you can access them by an index of another type.(e.g. a &lt;code&gt;String&lt;/code&gt;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;capitalCities&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="hashset"&gt;HashSet
&lt;/h4&gt;&lt;p&gt;A HashSet is a collection of items where every item is unique.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;HashSet&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cars&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HashSet&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="iterator"&gt;Iterator
&lt;/h4&gt;&lt;p&gt;An &lt;code&gt;Iterator&lt;/code&gt; is an object that can be used to loop through collections.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// Import the ArrayList class and the Iterator class&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.util.ArrayList&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;java.util.Iterator&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Make a collection&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cars&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cars&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Volvo&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cars&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;BMW&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cars&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Ford&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cars&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Mazda&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Get the iterator&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Iterator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cars&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;iterator&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Print the first item&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;next&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To loop through a collection, use the &lt;code&gt;hasNext()&lt;/code&gt; and &lt;code&gt;next()&lt;/code&gt; methods of the &lt;code&gt;Iterator&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hasNext&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;next&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h5 id="removing-items"&gt;Removing items
&lt;/h5&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hasNext&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;next&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Trying to remove items using a &lt;strong&gt;for loop&lt;/strong&gt; or a &lt;strong&gt;for-each loop&lt;/strong&gt; would not work correctly because the collection is changing size at the same time that the code is trying to loop.&lt;/p&gt;
&lt;h2 id="lambda"&gt;Lambda
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;parameter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;expression&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameter1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;parameter2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;expression&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameter1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;parameter2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="thread"&gt;Thread
&lt;/h2&gt;&lt;p&gt;Threads allows a program to operate more efficiently by doing multiple things at the same time.&lt;/p&gt;
&lt;p&gt;Threads can be used to perform complicated tasks in the background without interrupting the main program.&lt;/p&gt;
&lt;h3 id="creating"&gt;Creating
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;//1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;extends&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;This code is running in a thread&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//2&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Runnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;This code is running in a thread&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="running"&gt;Running
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;//1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;extends&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Main&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;This code is outside of the thread&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;This code is running in a thread&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;//2&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Runnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Main&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;This code is outside of the thread&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;This code is running in a thread&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="exceptions"&gt;Exceptions
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;throw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Exception&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>