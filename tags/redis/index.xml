<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Redis on é£é¸¿è¸é›ªæ³¥</title><link>https://dyhes.github.io/tags/redis/</link><description>Recent content in Redis on é£é¸¿è¸é›ªæ³¥</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 20 Oct 2025 22:07:04 +0800</lastBuildDate><atom:link href="https://dyhes.github.io/tags/redis/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€Redisã€‘Cluster</title><link>https://dyhes.github.io/p/rediscluster/</link><pubDate>Thu, 03 Jul 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/rediscluster/</guid><description>&lt;h2 id="redis-cluster"&gt;Redis Cluster
&lt;/h2&gt;&lt;p&gt;Redis Cluster æ˜¯ Redis å®˜æ–¹æ¨å‡ºçš„åˆ†å¸ƒå¼é›†ç¾¤è§£å†³æ–¹æ¡ˆï¼Œæ—¨åœ¨è§£å†³å•æœº Redis çš„å†…å­˜é™åˆ¶ã€æ€§èƒ½ç“¶é¢ˆå’Œå•ç‚¹æ•…éšœé—®é¢˜ã€‚å®ƒé€šè¿‡&lt;strong&gt;æ•°æ®åˆ†ç‰‡ï¼ˆShardingï¼‰&lt;/strong&gt;ã€&lt;strong&gt;ä¸»ä»å¤åˆ¶ï¼ˆReplicationï¼‰&lt;/strong&gt; å’Œ&lt;strong&gt;è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆFailoverï¼‰&lt;/strong&gt; å®ç°é«˜å¯ç”¨æ€§ä¸æ°´å¹³æ‰©å±•ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæ¶æ„ã€å·¥ä½œæœºåˆ¶ã€ç‰¹æ€§åŠé™åˆ¶å››ä¸ªç»´åº¦å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¶æ„è®¾è®¡"&gt;ğŸ” æ ¸å¿ƒæ¶æ„è®¾è®¡
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åˆ†ç‰‡ï¼ˆHash Slot æœºåˆ¶ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;16384 ä¸ªå“ˆå¸Œæ§½&lt;/strong&gt;ï¼šæ‰€æœ‰æ•°æ®é€šè¿‡ &lt;code&gt;CRC16(key) % 16384&lt;/code&gt; è®¡ç®—æ§½ä½ï¼Œåˆ†æ•£åˆ°ä¸åŒèŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;1,5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§½ä½åˆ†é…&lt;/strong&gt;ï¼šæ¯ä¸ªä¸»èŠ‚ç‚¹è´Ÿè´£éƒ¨åˆ†æ§½ä½ï¼ˆå¦‚èŠ‚ç‚¹ A ç®¡ç†æ§½ 0-5000ï¼‰ï¼Œé›†ç¾¤é€šè¿‡æ§½ä½æ˜ å°„è¡¨å¿«é€Ÿå®šä½æ•°æ®èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€è¿ç§»&lt;/strong&gt;ï¼šæ‰©å®¹/ç¼©å®¹æ—¶ï¼Œæ§½ä½å¯åœ¨çº¿è¿ç§»ï¼ˆ&lt;code&gt;redis-cli --cluster reshard&lt;/code&gt;ï¼‰ï¼Œè¿‡ç¨‹ä¸­é€šè¿‡ &lt;code&gt;ASK&lt;/code&gt; é‡å®šå‘ä¿è¯æ•°æ®ä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹è§’è‰²&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰&lt;/strong&gt;ï¼šå¤„ç†è¯»å†™è¯·æ±‚ï¼Œå‚ä¸æ•…éšœæ£€æµ‹ä¸æ§½ä½ç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»èŠ‚ç‚¹ï¼ˆSlaveï¼‰&lt;/strong&gt;ï¼šå¼‚æ­¥å¤åˆ¶ä¸»èŠ‚ç‚¹æ•°æ®ï¼Œä¸»èŠ‚ç‚¹æ•…éšœæ—¶é€šè¿‡é€‰ä¸¾å‡ä¸»ï¼ˆRaft ç®—æ³•ï¼‰&lt;a class="link" href="@ref" &gt;1,5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€å°é›†ç¾¤é…ç½®&lt;/strong&gt;ï¼š3 ä¸» + 3 ä»ï¼Œç¡®ä¿åŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹å¯æŠ•ç¥¨å®Œæˆæ•…éšœè½¬ç§»&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»ä¸­å¿ƒåŒ–é€šä¿¡ï¼ˆGossip åè®®ï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹é—´é€šè¿‡ TCP é€šé“å®šæœŸäº¤æ¢çŠ¶æ€ï¼ˆPing/Pong æ¶ˆæ¯ï¼‰ï¼Œç«¯å£å·ä¸ºæœåŠ¡ç«¯å£ +10000ï¼ˆå¦‚ 6379 â†’ 16379ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;MEET&lt;/code&gt;ï¼šæ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FAIL&lt;/code&gt;ï¼šèŠ‚ç‚¹æ•…éšœå¹¿æ’­ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PING/PONG&lt;/code&gt;ï¼šå¿ƒè·³æ£€æµ‹ä¸å…ƒæ•°æ®åŒæ­¥&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®å·¥ä½œæœºåˆ¶"&gt;âš™ï¸ å…³é”®å·¥ä½œæœºåˆ¶
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯è¯·æ±‚è·¯ç”±&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ™ºèƒ½é‡å®šå‘&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯è¿æ¥ä»»æ„èŠ‚ç‚¹ï¼Œè‹¥ Key ä¸å±äºå½“å‰èŠ‚ç‚¹ï¼Œè¿”å› &lt;code&gt;MOVED&lt;/code&gt; é”™è¯¯å¹¶æºå¸¦æ­£ç¡®èŠ‚ç‚¹åœ°å€ï¼Œå®¢æˆ·ç«¯è‡ªåŠ¨é‡è¯•&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç§»ä¸­çš„è¯·æ±‚å¤„ç†&lt;/strong&gt;ï¼šæ§½ä½è¿ç§»æœŸé—´ï¼ŒæºèŠ‚ç‚¹è¿”å› &lt;code&gt;ASK&lt;/code&gt; é‡å®šå‘ï¼Œå®¢æˆ·ç«¯ä¸´æ—¶è®¿é—®ç›®æ ‡èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœè½¬ç§»ï¼ˆFailoverï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœæ£€æµ‹&lt;/strong&gt;ï¼šåŠæ•°ä»¥ä¸Šä¸»èŠ‚ç‚¹æ ‡è®°æŸèŠ‚ç‚¹ä¸º &lt;code&gt;PFAIL&lt;/code&gt;ï¼ˆç–‘ä¼¼ä¸‹çº¿ï¼‰åï¼Œå‡çº§ä¸º &lt;code&gt;FAIL&lt;/code&gt;ï¼ˆå·²ä¸‹çº¿ï¼‰&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»èŠ‚ç‚¹é€‰ä¸¾&lt;/strong&gt;ï¼šä»èŠ‚ç‚¹å‘èµ·æŠ•ç¥¨ï¼ˆ&lt;code&gt;FAILOVER_AUTH_REQUEST&lt;/code&gt;ï¼‰ï¼Œè·å¤šæ•°ä¸»èŠ‚ç‚¹åŒæ„åå‡ä¸»ï¼Œå¹¶æ¥ç®¡åŸä¸»æ§½ä½&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;ï¼šå¼‚æ­¥å¤åˆ¶å¯èƒ½å¯¼è‡´æ•…éšœæœŸé—´å°‘é‡æ•°æ®ä¸¢å¤±ï¼ˆéå¼ºä¸€è‡´æ€§ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤æ‰©å®¹/ç¼©å®¹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰©å®¹ï¼š
&lt;ol&gt;
&lt;li&gt;æ·»åŠ æ–°èŠ‚ç‚¹ï¼š&lt;code&gt;redis-cli --cluster add-node&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è¿ç§»æ§½ä½ï¼š&lt;code&gt;redis-cli --cluster reshard&lt;/code&gt;&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç¼©å®¹ï¼š
&lt;ol&gt;
&lt;li&gt;è¿ç§»å¾…åˆ èŠ‚ç‚¹çš„æ§½ä½ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;åˆ é™¤èŠ‚ç‚¹ï¼š&lt;code&gt;redis-cli --cluster del-node&lt;/code&gt;&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§ä¸ä¼˜åŠ¿"&gt;âš¡ï¸ æ ¸å¿ƒç‰¹æ€§ä¸ä¼˜åŠ¿
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸»ä»åˆ‡æ¢åœ¨ç§’çº§å®Œæˆï¼ˆé»˜è®¤èŠ‚ç‚¹è¶…æ—¶æ—¶é—´ 15 ç§’ï¼‰ï¼ŒæœåŠ¡ä¸é—´æ–­&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒ&lt;strong&gt;è¯»è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å¯é…ç½®ä»èŠ‚ç‚¹å¤„ç†è¯»è¯·æ±‚ï¼ˆ&lt;code&gt;FAILOVER_DISTRIBUTE&lt;/code&gt; ç­–ç•¥ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ°´å¹³æ‰©å±•èƒ½åŠ›&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç†è®ºæ”¯æŒ â‰¤1000 ä¸ªèŠ‚ç‚¹ï¼Œæ•°æ®åˆ†å¸ƒå‡åŒ€æ—¶å¯çº¿æ€§æå‡ååé‡&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ€§èƒ½æ¥è¿‘å•æœº Redisï¼Œå•èŠ‚ç‚¹ QPS å¯è¾¾ 10 ä¸‡+&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ä¸­å¿ƒæ¶æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ— ä»£ç†å±‚ï¼Œå®¢æˆ·ç«¯ç›´è¿èŠ‚ç‚¹ï¼Œé™ä½å»¶è¿Ÿä¸å¤æ‚æ€§&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é™åˆ¶ä¸åº”å¯¹ç­–ç•¥"&gt;âš ï¸ é™åˆ¶ä¸åº”å¯¹ç­–ç•¥
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½é™åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¨æ§½ä½æ“ä½œ&lt;/strong&gt;ï¼šäº‹åŠ¡ï¼ˆMULTIï¼‰ã€Lua è„šæœ¬ã€&lt;code&gt;MGET/MSET&lt;/code&gt; ç­‰éœ€æ‰€æœ‰ Key ä½äºåŒä¸€æ§½ä½ï¼ˆå¯ç”¨ &lt;code&gt;{hash_tag}&lt;/code&gt;å¼ºåˆ¶è·¯ç”±ï¼Œå¦‚ &lt;code&gt;{user}:1&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»…æ”¯æŒ db0&lt;/strong&gt;ï¼šæ— æ³•ä½¿ç”¨ &lt;code&gt;SELECT&lt;/code&gt; åˆ‡æ¢æ•°æ®åº“&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¼‚æ­¥å¤åˆ¶å¯¼è‡´ä¸»èŠ‚ç‚¹å†™å…¥æˆåŠŸåï¼Œä»èŠ‚ç‚¹å¯èƒ½æœªåŒæ­¥ï¼ˆæ•…éšœæ—¶ä¸¢å¤±æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”å¯¹æ–¹æ¡ˆ&lt;/strong&gt;ï¼šå¯¹å¼ºä¸€è‡´æ€§åœºæ™¯ï¼Œéœ€ä¸šåŠ¡å±‚è¡¥å¿ï¼ˆå¦‚å¼‚æ­¥é˜Ÿåˆ—é‡è¯•ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´å¤æ‚åº¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰©ç¼©å®¹éœ€æ‰‹åŠ¨è¿ç§»æ§½ä½ï¼Œå¯èƒ½å¼•å‘æ€§èƒ½æ³¢åŠ¨&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–å»ºè®®&lt;/strong&gt;ï¼šå¯ç”¨æ§½ä½ç¼“å­˜ï¼ˆå¦‚ phpredis çš„ &lt;code&gt;redis.clusters.cache_slots=1&lt;/code&gt;ï¼‰ï¼Œå‡å°‘é‡å®šå‘&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ’ å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘è¯»å†™&lt;/strong&gt;ï¼šå¦‚ç”µå•†ç§’æ€ç³»ç»Ÿï¼Œåˆ†æ•£è¯·æ±‚è‡³å¤šèŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµ·é‡æ•°æ®å­˜å‚¨&lt;/strong&gt;ï¼šçªç ´å•æœºå†…å­˜é™åˆ¶ï¼Œæ”¯æŒ PB çº§æ•°æ®&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼šè¯å…±äº«&lt;/strong&gt;ï¼šåœ¨ PHP ç­‰ç¯å¢ƒä¸­å­˜å‚¨åˆ†å¸ƒå¼ä¼šè¯ï¼ˆéœ€é…ç½®å‹ç¼©ä¸è¶…æ—¶ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redis Cluster é€šè¿‡ &lt;strong&gt;åˆ†ç‰‡æœºåˆ¶&lt;/strong&gt; è§£å†³å•æœºç“¶é¢ˆï¼Œä»¥ &lt;strong&gt;å»ä¸­å¿ƒåŒ–æ¶æ„&lt;/strong&gt; ç¡®ä¿é«˜å¯ç”¨æ€§ï¼Œæ˜¯ Redis å¤§è§„æ¨¡éƒ¨ç½²çš„æ ¸å¿ƒæ–¹æ¡ˆã€‚å°½ç®¡å­˜åœ¨è·¨èŠ‚ç‚¹æ“ä½œé™åˆ¶å’Œæ•°æ®ä¸€è‡´æ€§é£é™©ï¼Œå…¶çº¿æ€§æ‰©å±•èƒ½åŠ›å’Œæ¯«ç§’çº§æ•…éšœè½¬ç§»ä»ä½¿å…¶æˆä¸ºé«˜å¹¶å‘ã€å¤§æ•°æ®åœºæ™¯çš„é¦–é€‰ã€‚
â€‹&lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… ç”Ÿäº§ç¯å¢ƒé‡‡ç”¨ 6 èŠ‚ç‚¹ï¼ˆ3 ä¸» 3 ä»ï¼‰èµ·æ­¥ï¼›&lt;/li&gt;
&lt;li&gt;âš ï¸ é¿å…çƒ­ç‚¹ Key ä¸è·¨æ§½äº‹åŠ¡ï¼›&lt;/li&gt;
&lt;li&gt;ğŸ”§ ä½¿ç”¨å®¢æˆ·ç«¯ä¼˜åŒ–ï¼ˆå¦‚ Jedis/phpredis çš„æ§½ä½ç¼“å­˜ï¼‰æå‡æ€§èƒ½&lt;a class="link" href="@ref" &gt;1,4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="å¼‚æ­¥å¤åˆ¶"&gt;å¼‚æ­¥å¤åˆ¶
&lt;/h2&gt;&lt;p&gt;Redisä¸»ä»èŠ‚ç‚¹çš„å¼‚æ­¥æ•°æ®å¤åˆ¶æ˜¯å…¶é«˜å¯ç”¨æ¶æ„çš„æ ¸å¿ƒæœºåˆ¶ï¼Œé€šè¿‡&lt;strong&gt;éé˜»å¡å¼æ•°æ®åŒæ­¥&lt;/strong&gt;åœ¨ä¿è¯ä¸»èŠ‚ç‚¹é«˜æ€§èƒ½çš„åŒæ—¶å®ç°æ•°æ®å†—ä½™ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€æµç¨‹ã€é—®é¢˜åŠä¼˜åŒ–å››ä¸ªç»´åº¦å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚æ­¥å¤åˆ¶çš„æ ¸å¿ƒåŸç†"&gt;ğŸ”§ å¼‚æ­¥å¤åˆ¶çš„æ ¸å¿ƒåŸç†
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éé˜»å¡è®¾è®¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸»èŠ‚ç‚¹å¤„ç†å†™å‘½ä»¤åç«‹å³å“åº”å®¢æˆ·ç«¯ï¼Œ&lt;strong&gt;å¼‚æ­¥&lt;/strong&gt;å°†æ•°æ®åŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼Œé¿å…å› ç­‰å¾…ä»èŠ‚ç‚¹ç¡®è®¤è€Œé˜»å¡ä¸»èŠ‚ç‚¹æ€§èƒ½&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æµå‘&lt;/strong&gt;ï¼šä¸»èŠ‚ç‚¹ â†’ å¤åˆ¶ç¼“å†²åŒº â†’ ä»èŠ‚ç‚¹ï¼ˆå•å‘æµåŠ¨ï¼Œä¸å¯åå‘ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³é”®æ•°æ®ç»“æ„&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Replication Buffer&lt;/strong&gt;ï¼šä¸»èŠ‚ç‚¹ä¸ºæ¯ä¸ªä»èŠ‚ç‚¹ç‹¬ç«‹åˆ†é…çš„ç¼“å†²åŒºï¼Œä¸´æ—¶å­˜å‚¨å¾…åŒæ­¥çš„å†™å‘½ä»¤ã€‚è‹¥ä»èŠ‚ç‚¹å¤„ç†æ…¢æˆ–ç½‘ç»œå»¶è¿Ÿï¼Œç¼“å†²åŒºç§¯å‹å¯èƒ½å¯¼è‡´ä¸»èŠ‚ç‚¹å†…å­˜å‹åŠ›&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Repl-Backlog Buffer&lt;/strong&gt;ï¼šå…¨å±€ç¯å½¢ç¼“å†²åŒºï¼ˆé»˜è®¤1MBï¼‰ï¼Œå­˜å‚¨æœ€è¿‘å†™å‘½ä»¤ã€‚ç”¨äºç½‘ç»œé—ªæ–­åçš„å¢é‡åŒæ­¥ï¼Œé¿å…å…¨é‡å¤åˆ¶&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚
&lt;em&gt;ç¤ºä¾‹&lt;/em&gt;ï¼šè‹¥ä»èŠ‚ç‚¹æ–­å¼€åé‡è¿ï¼Œä¸»èŠ‚ç‚¹æ£€æŸ¥å…¶å¤åˆ¶åç§»é‡ï¼ˆoffsetï¼‰æ˜¯å¦åœ¨ç§¯å‹ç¼“å†²åŒºèŒƒå›´å†…ï¼Œæ˜¯åˆ™å‘é€ç¼ºå¤±æ•°æ®ï¼Œå¦åˆ™è§¦å‘å…¨é‡åŒæ­¥&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚æ­¥å¤åˆ¶æµç¨‹"&gt;âš™ï¸ å¼‚æ­¥å¤åˆ¶æµç¨‹
&lt;/h3&gt;&lt;h4 id="å…¨é‡å¤åˆ¶åˆå§‹åŒ–åŒæ­¥"&gt;&lt;strong&gt;å…¨é‡å¤åˆ¶ï¼ˆåˆå§‹åŒ–åŒæ­¥ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘åœºæ™¯&lt;/strong&gt;ï¼šä»èŠ‚ç‚¹é¦–æ¬¡è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œæˆ–å¤åˆ¶åç§»é‡ä¸è¿ç»­ï¼ˆå¦‚ç½‘ç»œä¸­æ–­è¿‡ä¹…å¯¼è‡´ç§¯å‹ç¼“å†²åŒºæ•°æ®è¢«è¦†ç›–ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ­¥éª¤ï¼š
&lt;ol&gt;
&lt;li&gt;ä»èŠ‚ç‚¹å‘é€&lt;code&gt;PSYNC ? -1&lt;/code&gt;å‘½ä»¤è¯·æ±‚åŒæ­¥&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸»èŠ‚ç‚¹æ‰§è¡Œ&lt;code&gt;BGSAVE&lt;/code&gt;ç”ŸæˆRDBå¿«ç…§ï¼ŒåŒæ—¶ç¼“å­˜æ–°å†™å‘½ä»¤è‡³&lt;strong&gt;Replication Buffer&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;RDBæ–‡ä»¶ä¼ è¾“è‡³ä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹æ¸…ç©ºæ—§æ•°æ®å¹¶åŠ è½½RDBã€‚&lt;/li&gt;
&lt;li&gt;ä¸»èŠ‚ç‚¹å‘é€ç§¯å‹çš„å†™å‘½ä»¤ï¼Œä½¿ä»èŠ‚ç‚¹æ•°æ®ä¸ä¸»èŠ‚ç‚¹ä¸€è‡´&lt;a class="link" href="@ref" &gt;4,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¢é‡å¤åˆ¶å‘½ä»¤ä¼ æ’­"&gt;&lt;strong&gt;å¢é‡å¤åˆ¶ï¼ˆå‘½ä»¤ä¼ æ’­ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŒç»­åŒæ­¥&lt;/strong&gt;ï¼šå…¨é‡å¤åˆ¶å®Œæˆåï¼Œä¸»èŠ‚ç‚¹å°†æ–°å†™å‘½ä»¤å®æ—¶æ¨é€è‡³ä»èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ–­ç‚¹ç»­ä¼ ï¼š
&lt;ul&gt;
&lt;li&gt;ç½‘ç»œä¸­æ–­æœŸé—´ï¼Œä¸»èŠ‚ç‚¹å†™å‘½ä»¤å­˜å…¥&lt;strong&gt;Repl-Backlog Buffer&lt;/strong&gt;ï¼ˆç¯å½¢é˜Ÿåˆ—ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç½‘ç»œæ¢å¤åï¼Œä»èŠ‚ç‚¹å‘é€&lt;code&gt;PSYNC &amp;lt;runid&amp;gt; &amp;lt;offset&amp;gt;&lt;/code&gt;ï¼Œä¸»èŠ‚ç‚¹æ ¡éªŒåç§»é‡æœ‰æ•ˆæ€§åå‘é€ç¼ºå¤±æ•°æ®&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¿ƒè·³ç»´æŒ"&gt;&lt;strong&gt;å¿ƒè·³ç»´æŒ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ä»èŠ‚ç‚¹æ¯ç§’å‘é€&lt;code&gt;REPLCONF ACK &amp;lt;offset&amp;gt;&lt;/code&gt;æŠ¥å‘Šè‡ªèº«å¤åˆ¶åç§»é‡&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸»èŠ‚ç‚¹é€šè¿‡åç§»é‡ç›‘æ§ä»èŠ‚ç‚¹å»¶è¿Ÿï¼Œè¶…æ—¶ï¼ˆé»˜è®¤60ç§’ï¼‰åˆ™æ–­å¼€è¿æ¥&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¼‚æ­¥å¤åˆ¶çš„é£é™©ä¸æŒ‘æˆ˜"&gt;âš ï¸ å¼‚æ­¥å¤åˆ¶çš„é£é™©ä¸æŒ‘æˆ˜
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ä¸ä¸€è‡´é£é™©&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿé—®é¢˜&lt;/strong&gt;ï¼šä¸»èŠ‚ç‚¹å†™å…¥æˆåŠŸåï¼Œä»èŠ‚ç‚¹å¯èƒ½æœªåŒæ­¥å³å®•æœºï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼ˆå°¤å…¶çŸ­æ—¶é—´é«˜å¹¶å‘å†™å…¥ï¼‰&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§æ‰‹æ®µ&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;INFO replication&lt;/code&gt;æŸ¥çœ‹&lt;code&gt;master_repl_offset&lt;/code&gt;ä¸&lt;code&gt;slave_repl_offset&lt;/code&gt;å·®å€¼ï¼Œå»¶è¿Ÿè¶…è¿‡é˜ˆå€¼éœ€å‘Šè­¦&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è„‘è£‚é—®é¢˜ï¼ˆSplit-Brainï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šç½‘ç»œåˆ†åŒºæ—¶ï¼ŒåŸä¸»èŠ‚ç‚¹å’Œæå‡çš„æ–°ä¸»èŠ‚ç‚¹åŒæ—¶å†™å…¥ï¼Œæ¢å¤åæ•°æ®å†²çª&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§„é¿æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;é…ç½®&lt;code&gt;min-slaves-to-write 1&lt;/code&gt;å’Œ&lt;code&gt;min-slaves-max-lag 10&lt;/code&gt;ï¼Œè¦æ±‚è‡³å°‘1ä¸ªä»èŠ‚ç‚¹å»¶è¿Ÿâ‰¤10ç§’ï¼Œå¦åˆ™ä¸»èŠ‚ç‚¹æ‹’ç»å†™å…¥&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºæ¶ˆè€—&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜å‹åŠ›&lt;/strong&gt;ï¼šå…¨é‡å¤åˆ¶æ—¶&lt;code&gt;BGSAVE&lt;/code&gt;çš„&lt;code&gt;fork&lt;/code&gt;æ“ä½œå¯èƒ½é˜»å¡ä¸»çº¿ç¨‹ï¼ˆå°¤å…¶å†…å­˜è¿‡å¤§æ—¶ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œå¸¦å®½&lt;/strong&gt;ï¼šRDBæ–‡ä»¶ä¼ è¾“å ç”¨å¸¦å®½ï¼Œå½±å“å…¶ä»–æœåŠ¡ï¼ˆå»ºè®®ä½å³°æœŸæ‰©å®¹ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿäº§çº§ä¼˜åŒ–æ–¹æ¡ˆ"&gt;ğŸ› ï¸ ç”Ÿäº§çº§ä¼˜åŒ–æ–¹æ¡ˆ
&lt;/h3&gt;&lt;h4 id="å‡å°‘å…¨é‡å¤åˆ¶"&gt;&lt;strong&gt;å‡å°‘å…¨é‡å¤åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¢å¤§ç§¯å‹ç¼“å†²åŒº&lt;/strong&gt;ï¼šè°ƒæ•´&lt;code&gt;repl-backlog-size&lt;/code&gt;ï¼ˆå»ºè®®512MBä»¥ä¸Šï¼‰ï¼Œé¿å…ç½‘ç»œæŠ–åŠ¨è§¦å‘å…¨é‡å¤åˆ¶&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ç›˜å¤åˆ¶&lt;/strong&gt;ï¼šRedis 6.0+æ”¯æŒ&lt;code&gt;repl-diskless-sync yes&lt;/code&gt;ï¼Œä¸»èŠ‚ç‚¹ç›´æ¥é€šè¿‡Socketå‘é€RDBï¼Œé¿å…ç£ç›˜IO&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¢å¼ºä¸€è‡´æ€§"&gt;&lt;strong&gt;å¢å¼ºä¸€è‡´æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;WAITå‘½ä»¤&lt;/strong&gt;ï¼šå¼ºåˆ¶ç­‰å¾…Nä¸ªä»èŠ‚ç‚¹åŒæ­¥å®Œæˆï¼ˆå¦‚&lt;code&gt;WAIT 2 5000&lt;/code&gt;ç­‰å¾…2ä¸ªä»èŠ‚ç‚¹æˆ–è¶…æ—¶5ç§’ï¼‰ï¼Œä½†ç‰ºç‰²æ€§èƒ½æ¢å–å¼ºä¸€è‡´æ€§&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»èŠ‚ç‚¹é…ç½®ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;replica-serve-stale-data no # åŒæ­¥ä¸­æ–­æ—¶æ‹’ç»è¯»è¯·æ±‚ï¼Œé¿å…è„æ•°æ®[1](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é«˜å¯ç”¨æ¶æ„"&gt;&lt;strong&gt;é«˜å¯ç”¨æ¶æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å“¨å…µæ¨¡å¼&lt;/strong&gt;ï¼šè‡ªåŠ¨ç›‘æ§ä¸»èŠ‚ç‚¹çŠ¶æ€å¹¶æ•…éšœè½¬ç§»ï¼Œéœ€éƒ¨ç½²å¥‡æ•°ä¸ªSentinelèŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤æ¨¡å¼&lt;/strong&gt;ï¼šæ•°æ®åˆ†ç‰‡åˆ°å¤šä¸»èŠ‚ç‚¹ï¼Œæ¯ä¸ªä¸»èŠ‚ç‚¹é…ä»èŠ‚ç‚¹ï¼Œè§„é¿å•ç‚¹æ•…éšœ&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…³é”®å‚æ•°é…ç½®å‚è€ƒ"&gt;&lt;strong&gt;å…³é”®å‚æ•°é…ç½®å‚è€ƒ&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èå€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;repl-backlog-size&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;512mb&lt;/td&gt;
&lt;td&gt;æ‰©å¤§ç§¯å‹ç¼“å†²åŒºï¼Œæ”¯æŒæ›´é•¿ä¸­æ–­æ¢å¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;repl-timeout&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;60&lt;/td&gt;
&lt;td&gt;å¤åˆ¶è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;min-slaves-to-write&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;è‡³å°‘éœ€åŒæ­¥çš„ä»èŠ‚ç‚¹æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;min-slaves-max-lag&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;ä»èŠ‚ç‚¹æœ€å¤§å»¶è¿Ÿï¼ˆç§’ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Rediså¼‚æ­¥å¤åˆ¶é€šè¿‡&lt;strong&gt;éé˜»å¡è®¾è®¡&lt;/strong&gt;å¹³è¡¡æ€§èƒ½ä¸æ•°æ®å†—ä½™ï¼Œä½†éœ€è­¦æƒ•æ•°æ®å»¶è¿Ÿå’Œè„‘è£‚é£é™©ã€‚&lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;ç›‘æ§å»¶è¿Ÿ&lt;/strong&gt;ï¼šå®šæœŸæ£€æŸ¥&lt;code&gt;INFO replication&lt;/code&gt;çš„åç§»é‡å·®å€¼&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;ä¼˜åŒ–é…ç½®&lt;/strong&gt;ï¼šå¢å¤§&lt;code&gt;repl-backlog-size&lt;/code&gt;ã€å¯ç”¨æ— ç›˜å¤åˆ¶&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ï¼›&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;å®¹ç¾è®¾è®¡&lt;/strong&gt;ï¼šç»“åˆå“¨å…µ/é›†ç¾¤æ¨¡å¼ï¼Œå¹¶é€šè¿‡&lt;code&gt;min-slaves-*&lt;/code&gt;é™åˆ¶å†™å…¥æ¡ä»¶&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å¼‚æ­¥å¤åˆ¶æ˜¯Redisé«˜æ€§èƒ½çš„åŸºçŸ³ï¼Œç†è§£å…¶æœºåˆ¶ä¸å±€é™ï¼Œæ–¹èƒ½æ„å»ºç¨³å®šå¯é çš„åˆ†å¸ƒå¼ç¼“å­˜ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å“ˆå¸Œæ§½"&gt;å“ˆå¸Œæ§½
&lt;/h2&gt;&lt;p&gt;Redis Cluster ä¸­å®¢æˆ·ç«¯å®ç°è´Ÿè½½å‡è¡¡å’Œæ•°æ®å®šä½çš„æ ¸å¿ƒæœºåˆ¶æ˜¯&lt;strong&gt;å“ˆå¸Œæ§½ï¼ˆHash Slotï¼‰åˆ†é…&lt;/strong&gt;ä¸&lt;strong&gt;æ™ºèƒ½é‡å®šå‘&lt;/strong&gt;ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æµç¨‹åŠåŸç†ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å“ˆå¸Œæ§½æœºåˆ¶ä¸æ•°æ®å®šä½"&gt;ğŸ” å“ˆå¸Œæ§½æœºåˆ¶ä¸æ•°æ®å®šä½
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œæ§½åˆ†é…&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Redis Cluster å°†æ•°æ®åˆ’åˆ†ä¸º &lt;strong&gt;16384 ä¸ªå›ºå®šæ§½ä½&lt;/strong&gt;ï¼ˆSlotsï¼‰ï¼Œæ¯ä¸ªä¸»èŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†æ§½ä½ï¼ˆå¦‚èŠ‚ç‚¹ A ç®¡ç† 0-5000ï¼ŒèŠ‚ç‚¹ B ç®¡ç† 5001-10000ï¼‰&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”®å€¼æ˜ å°„è§„åˆ™&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å¯¹ Key æ‰§è¡Œ &lt;code&gt;CRC16(key) % 16384&lt;/code&gt; è®¡ç®—æ§½ä½å·ï¼Œä¾‹å¦‚ &lt;code&gt;user:123&lt;/code&gt; çš„ CRC16 å€¼ä¸º 9876ï¼Œåˆ™å½’å±æ§½ä½ 9876&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯æ§½ä½ç¼“å­˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯é¦–æ¬¡è¿æ¥é›†ç¾¤æ—¶ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹è·å–&lt;strong&gt;æ§½ä½æ˜ å°„è¡¨&lt;/strong&gt;ï¼ˆSlot-Node Mappingï¼‰ï¼Œè®°å½•æ¯ä¸ªæ§½ä½å¯¹åº”çš„èŠ‚ç‚¹ IP å’Œç«¯å£&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åç»­è¯·æ±‚ç›´æ¥æ ¹æ®æœ¬åœ°æ˜ å°„è¡¨è·¯ç”±åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œé¿å…é‡å¤æŸ¥è¯¢&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®¢æˆ·ç«¯è¯·æ±‚è·¯ç”±ä¸é‡å®šå‘"&gt;âš™ï¸ å®¢æˆ·ç«¯è¯·æ±‚è·¯ç”±ä¸é‡å®šå‘
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ­£å¸¸è·¯ç”±æµç¨‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯è®¡ç®— Key çš„æ§½ä½å·ï¼ŒæŸ¥è¯¢æœ¬åœ°æ˜ å°„è¡¨ï¼Œç›´æ¥å‘é€è¯·æ±‚è‡³è´Ÿè´£è¯¥æ§½ä½çš„èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šè‹¥æ§½ä½ 5001 ç”±èŠ‚ç‚¹ B ç®¡ç†ï¼Œè¯·æ±‚ &lt;code&gt;SET order:100 &amp;quot;data&amp;quot;&lt;/code&gt; ä¼šç›´æ¥å‘é€è‡³èŠ‚ç‚¹ B&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡å®šå‘æœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MOVED é‡å®šå‘&lt;/strong&gt;ï¼šè‹¥è¯·æ±‚å‘é€åˆ°é”™è¯¯èŠ‚ç‚¹ï¼ˆå¦‚æ§½ä½ 5001 çš„è¯·æ±‚å‘åˆ°èŠ‚ç‚¹ Aï¼‰ï¼ŒèŠ‚ç‚¹ A è¿”å› &lt;code&gt;MOVED 5001 192.168.1.2:7001&lt;/code&gt;ï¼Œå®¢æˆ·ç«¯æ›´æ–°æœ¬åœ°æ˜ å°„è¡¨å¹¶é‡è¯•&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ASK é‡å®šå‘&lt;/strong&gt;ï¼šåœ¨æ•°æ®è¿ç§»è¿‡ç¨‹ä¸­ï¼Œè‹¥æ§½ä½æ­£åœ¨ä»èŠ‚ç‚¹ A è¿ç§»åˆ°èŠ‚ç‚¹ Bï¼š
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹ A è‹¥ä»å­˜æœ‰æ•°æ®ï¼Œåˆ™ç›´æ¥å“åº”ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æ•°æ®å·²è¿ç§»ï¼Œè¿”å› &lt;code&gt;ASK 5001 192.168.1.3:7002&lt;/code&gt;ï¼Œå®¢æˆ·ç«¯å‘èŠ‚ç‚¹ B å‘é€ &lt;code&gt;ASKING&lt;/code&gt; å‘½ä»¤åé‡æ–°æ‰§è¡ŒåŸè¯·æ±‚&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è´Ÿè½½å‡è¡¡å®ç°æ–¹å¼"&gt;âš–ï¸ è´Ÿè½½å‡è¡¡å®ç°æ–¹å¼
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åˆ†ç‰‡å‡è¡¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é›†ç¾¤å¯åŠ¨æ—¶æ§½ä½&lt;strong&gt;å¹³å‡åˆ†é…&lt;/strong&gt;åˆ°ä¸»èŠ‚ç‚¹ï¼ˆå¦‚ 3 èŠ‚ç‚¹æ—¶å„å  5461 ä¸ªæ§½ä½ï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€å†å¹³è¡¡&lt;/strong&gt;ï¼šæ–°å¢èŠ‚ç‚¹æ—¶ï¼Œé›†ç¾¤è‡ªåŠ¨ä»å…¶ä»–èŠ‚ç‚¹è¿ç§»éƒ¨åˆ†æ§½ä½åˆ°æ–°èŠ‚ç‚¹ï¼›èŠ‚ç‚¹ä¸‹çº¿æ—¶ï¼Œå…¶æ§½ä½é‡æ–°åˆ†é…ç»™å­˜æ´»èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯·æ±‚åˆ†æ•£&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯é€šè¿‡&lt;strong&gt;æœ¬åœ°æ§½ä½æ˜ å°„è¡¨&lt;/strong&gt;å°†è¯·æ±‚å‡åŒ€åˆ†å‘åˆ°ä¸åŒä¸»èŠ‚ç‚¹ï¼Œé¿å…å•ç‚¹å‹åŠ›&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯»å†™æ“ä½œå‡åœ¨ä¸»èŠ‚ç‚¹å®Œæˆï¼Œä»èŠ‚ç‚¹ä»…ä½œå¤‡ä»½ï¼ˆæ•…éšœæ—¶æå‡ä¸ºä¸»èŠ‚ç‚¹ï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯åº“ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ Jedis Clusterã€Lettuce ç­‰åº“&lt;strong&gt;è‡ªåŠ¨ç»´æŠ¤æ§½ä½æ˜ å°„è¡¨&lt;/strong&gt;ï¼Œå¤„ç†é‡å®šå‘é€»è¾‘ï¼Œå¯¹ä¸šåŠ¡é€æ˜&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒè¿æ¥æ± å¤ç”¨å’Œæ•…éšœèŠ‚ç‚¹è‡ªåŠ¨æ’é™¤ï¼Œå‡å°‘ç½‘ç»œå¼€é”€&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å®¢æˆ·ç«¯åº“çš„ä¼˜åŒ–å®è·µ"&gt;ğŸ› ï¸ å®¢æˆ·ç«¯åº“çš„ä¼˜åŒ–å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¯åŠ¨åˆå§‹åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯è¿æ¥é›†ç¾¤æ—¶ï¼Œé€šè¿‡ &lt;code&gt;CLUSTER SLOTS&lt;/code&gt; å‘½ä»¤è·å–å…¨é‡æ§½ä½æ˜ å°„ï¼Œå¹¶ç¼“å­˜èŠ‚ç‚¹è¿æ¥æ± &lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡å®šå‘å¤„ç†ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹ &lt;code&gt;MOVED&lt;/code&gt; å“åº”æ›´æ–°æœ¬åœ°æ˜ å°„è¡¨ï¼›å¯¹ &lt;code&gt;ASK&lt;/code&gt; å“åº”ä»…ä¸´æ—¶è·³è½¬ï¼Œä¸æ›´æ–°ç¼“å­˜&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é™åˆ¶é‡è¯•æ¬¡æ•°ï¼Œé¿å…ç½‘ç»œç¯è·¯&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™ä¸é«˜å¯ç”¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹æ•…éšœæ—¶ï¼Œå®¢æˆ·ç«¯æ”¶åˆ° &lt;code&gt;ConnectionError&lt;/code&gt; åéšæœºé€‰æ‹©å…¶ä»–èŠ‚ç‚¹é‡è¯•ï¼Œå¹¶ç”±æ–°èŠ‚ç‚¹é€šè¿‡ &lt;code&gt;MOVED&lt;/code&gt; å“åº”çº æ­£è·¯ç”±&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é›†ç¾¤ä¸»ä»åˆ‡æ¢æœŸé—´ï¼Œå®¢æˆ·ç«¯è‡ªåŠ¨åˆ‡æ¢åˆ°æ–°ä¸»èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;p&gt;Redis Cluster çš„è´Ÿè½½å‡è¡¡å’Œæ•°æ®å®šä½ä¾èµ– &lt;strong&gt;16384 å“ˆå¸Œæ§½&lt;/strong&gt;çš„ç²¾ç»†åˆ†ç‰‡å’Œå®¢æˆ·ç«¯&lt;strong&gt;æ™ºèƒ½è·¯ç”±æœºåˆ¶&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;å®šä½æ•ˆç‡&lt;/strong&gt;ï¼šé€šè¿‡æ§½ä½è®¡ç®—å’Œæœ¬åœ°ç¼“å­˜å®ç°å¿«é€Ÿå®šä½ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šæ•°æ®å‡åŒ€åˆ†å¸ƒ + åŠ¨æ€è¿ç§» + å®¢æˆ·ç«¯ç›´è¿åˆ†å‘è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;å®¹é”™æ€§&lt;/strong&gt;ï¼š&lt;code&gt;MOVED&lt;/code&gt;/&lt;code&gt;ASK&lt;/code&gt; é‡å®šå‘ä¿éšœè¯·æ±‚å¯è¾¾æ€§ã€‚&lt;/li&gt;
&lt;li&gt;âœ… &lt;strong&gt;å®¢æˆ·ç«¯ä¼˜åŒ–&lt;/strong&gt;ï¼šä¸»æµåº“ï¼ˆå¦‚ Jedis Clusterï¼‰å°è£…å¤æ‚æ€§ï¼Œå¼€å‘è€…æ— éœ€å…³æ³¨åº•å±‚ç»†èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç”Ÿäº§å»ºè®®&lt;/strong&gt;ï¼šä½¿ç”¨æ”¯æŒ Cluster çš„å®¢æˆ·ç«¯åº“ï¼ˆå¦‚ Lettuceï¼‰ï¼Œå¹¶é…ç½®åˆç†çš„è¿æ¥æ± å¤§å°ï¼›é¿å…è·¨æ§½ä½æ“ä½œï¼ˆå¦‚å¤š Key äº‹åŠ¡ï¼‰ï¼Œä»¥è§„é¿æ€§èƒ½æŸè€—&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å“ˆå¸Œæ§½--ä¸€è‡´æ€§å“ˆå¸Œ"&gt;å“ˆå¸Œæ§½ &amp;amp; ä¸€è‡´æ€§å“ˆå¸Œ
&lt;/h2&gt;&lt;p&gt;å“ˆå¸Œæ§½ï¼ˆHash Slotï¼‰å’Œä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashingï¼‰æ˜¯ä¸¤ç§ä¸åŒçš„åˆ†å¸ƒå¼æ•°æ®åˆ†ç‰‡ç®—æ³•ï¼Œå®ƒä»¬åœ¨è®¾è®¡ç›®æ ‡ã€å®ç°æœºåˆ¶å’Œé€‚ç”¨åœºæ™¯ä¸Šå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒå¯¹æ¯”ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«æ€»ç»“"&gt;ğŸ” &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å“ˆå¸Œæ§½ï¼ˆHash Slotï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashingï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å›ºå®š 16384 ä¸ªæ§½ä½ï¼ˆRedis Clusterï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;è™šæ‹Ÿç¯çŠ¶ç»“æ„ï¼ˆèŒƒå›´ 0~2Â³Â²-1ï¼‰&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å®šä½é€»è¾‘&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é”® â†’ CRC16å–æ¨¡ â†’ æ§½ä½ â†’ èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;é”®å“ˆå¸Œ â†’ ç¯ä¸Šä½ç½® â†’ é¡ºæ—¶é’ˆé¦–ä¸ªèŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠ¨æ€æ‰©ç¼©å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹åŠ¨è¿ç§»æ•´æ§½æ•°æ®ï¼ˆå¦‚ &lt;code&gt;CLUSTER ADDSLOTS&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨è¿ç§»ç›¸é‚»æ•°æ®ï¼Œå½±å“å±€éƒ¨&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºåˆ¶æ§½ä½å‡åŒ€åˆ†é…ï¼Œå¤©ç„¶å‡è¡¡&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–è™šæ‹ŸèŠ‚ç‚¹ä¼˜åŒ–ï¼Œå¦åˆ™æ˜“å€¾æ–œ&lt;a class="link" href="@ref" &gt;2,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®ç°å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•ï¼ˆæ§½ä½æ˜ å°„è¡¨+å›ºå®šè®¡ç®—ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å¤æ‚ï¼ˆéœ€ç»´æŠ¤ç¯+è™šæ‹ŸèŠ‚ç‚¹æ˜ å°„ï¼‰&lt;a class="link" href="@ref" &gt;2,9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¸å‹åº”ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Redis Clusterã€å¼ºä¸€è‡´æ€§æ•°æ®åº“&lt;a class="link" href="@ref" &gt;8,7&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Memcachedã€Cassandraã€CDN&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®å·®å¼‚è¯¦è§£"&gt;âš™ï¸ &lt;strong&gt;å…³é”®å·®å¼‚è¯¦è§£&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åˆ†å¸ƒæœºåˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å“ˆå¸Œæ§½ï¼š
&lt;ul&gt;
&lt;li&gt;æ•°æ®é€šè¿‡ &lt;code&gt;CRC16(key) % 16384&lt;/code&gt; æ˜ å°„åˆ°å›ºå®šæ§½ä½ï¼Œæ§½ä½ä¸èŠ‚ç‚¹ç»‘å®š&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šæ§½ä½åˆ†é…å¯æ§ï¼ˆå¦‚é«˜æ€§èƒ½èŠ‚ç‚¹åˆ†é…æ›´å¤šæ§½ä½ï¼‰ï¼Œé¿å…æ•°æ®å€¾æ–œ&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸€è‡´æ€§å“ˆå¸Œï¼š
&lt;ul&gt;
&lt;li&gt;æ•°æ®å“ˆå¸Œåå®šä½åˆ°ç¯ä¸Šï¼Œç”±é¡ºæ—¶é’ˆæ–¹å‘çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ç®¡ç†&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šèŠ‚ç‚¹è¾ƒå°‘æ—¶æ˜“å€¾æ–œï¼Œéœ€è™šæ‹ŸèŠ‚ç‚¹ï¼ˆå¦‚1ç‰©ç†èŠ‚ç‚¹=1000è™šæ‹ŸèŠ‚ç‚¹ï¼‰åˆ†æ•£æ•°æ®&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ‰©ç¼©å®¹æ•ˆç‡&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å“ˆå¸Œæ§½ï¼š
&lt;ul&gt;
&lt;li&gt;æ‰©å®¹æ—¶éœ€è¿ç§»æ•´æ§½æ•°æ®ï¼ˆå¦‚ä»èŠ‚ç‚¹Aè¿ç§»1000ä¸ªæ§½åˆ°èŠ‚ç‚¹Bï¼‰ï¼Œè¿ç§»ç²’åº¦å¤§ä½†æ“ä½œé›†ä¸­&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»£ä»·&lt;/strong&gt;ï¼šè¿ç§»æœŸé—´ç½‘ç»œå¸¦å®½å‹åŠ›å¤§ï¼Œä½†æ•°æ®è·¯ç”±ä¸å˜ï¼ˆå®¢æˆ·ç«¯ç¼“å­˜æ§½ä½æ˜ å°„ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸€è‡´æ€§å“ˆå¸Œï¼š
&lt;ul&gt;
&lt;li&gt;å¢å‡èŠ‚ç‚¹æ—¶ä»…å½±å“ç›¸é‚»æ•°æ®ï¼ˆçº¦ 1/N æ•°æ®è¿ç§»ï¼ŒNä¸ºèŠ‚ç‚¹æ•°ï¼‰&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ä»·&lt;/strong&gt;ï¼šéœ€é‡æ–°è®¡ç®—è™šæ‹ŸèŠ‚ç‚¹åˆ†å¸ƒï¼Œå¯èƒ½å¼•å‘ä¸´æ—¶ç¼“å­˜ç©¿é€&lt;a class="link" href="@ref" &gt;4,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;å…ƒæ•°æ®ç®¡ç†å¼€é”€&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å“ˆå¸Œæ§½ï¼š
&lt;ul&gt;
&lt;li&gt;æ§½ä½åˆ†é…ä¿¡æ¯ä»…éœ€ 2KBï¼ˆ16384æ§½ç”¨bitmapå‹ç¼©ï¼‰&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é€‚åˆå¤§è§„æ¨¡é›†ç¾¤ï¼ˆå¦‚1000èŠ‚ç‚¹ï¼‰ï¼Œå¿ƒè·³åŒ…è½»é‡&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸€è‡´æ€§å“ˆå¸Œï¼š
&lt;ul&gt;
&lt;li&gt;è™šæ‹ŸèŠ‚ç‚¹å…ƒæ•°æ®åºå¤§ï¼ˆ1000èŠ‚ç‚¹Ã—1000è™šæ‹ŸèŠ‚ç‚¹=ç™¾ä¸‡çº§æ¡ç›®ï¼‰ï¼Œå¿ƒè·³åŒ…å¯è¾¾8KB&lt;a class="link" href="@ref" &gt;4,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡å“²å­¦å¯¹æ¯”"&gt;ğŸ—ï¸ &lt;strong&gt;è®¾è®¡å“²å­¦å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;å“ˆå¸Œæ§½&lt;/th&gt;
&lt;th&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼ºæ•°æ®ä¸€è‡´æ€§ + é›†ç¾¤ç®¡ç†ä¾¿æ·&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;é«˜åŠ¨æ€æ‰©å±•æ€§ + æœ€å°åŒ–æ•°æ®è¿ç§»&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®æ§åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ”¯æŒæ‰‹åŠ¨åˆ†é…æ§½ä½ï¼ˆå¦‚æŒ‰ç¡¬ä»¶æ€§èƒ½è°ƒæ•´ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ–å“ˆå¸Œå‡½æ•°åˆ†å¸ƒï¼Œäººå·¥å¹²é¢„éš¾&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•…éšœæ¢å¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ§½ä½æ•´ä½“åˆ‡æ¢ï¼ˆä¸»å®•æœºæ—¶ä»èŠ‚ç‚¹æ¥ç®¡æ§½ä½ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®è‡ªåŠ¨è¿ç§»åˆ°ç›¸é‚»èŠ‚ç‚¹ï¼Œä½†å¯èƒ½å¼•å‘è¿é”æ•…éšœ&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‚ç”¨åœºæ™¯å»ºè®®"&gt;âš ï¸ &lt;strong&gt;é€‚ç”¨åœºæ™¯å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©å“ˆå¸Œæ§½&lt;/strong&gt;çš„åœºæ™¯ï¼š
âœ… â€‹&lt;strong&gt;Redis Cluster&lt;/strong&gt;â€‹ï¼šéœ€å¼ºä¸€è‡´æ€§ã€äº‹åŠ¡æ”¯æŒï¼ˆå°½ç®¡æœ‰é™ï¼‰åŠè¿ç»´ç®€åŒ–&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚
âœ… â€‹&lt;strong&gt;é‡‘èäº¤æ˜“ç³»ç»Ÿ&lt;/strong&gt;â€‹ï¼šè¦æ±‚æ¯«ç§’çº§å®šä½ï¼Œé¿å…ç¯æŸ¥æ‰¾å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚
âœ… â€‹&lt;strong&gt;ä¸­å°è§„æ¨¡é›†ç¾¤&lt;/strong&gt;â€‹ï¼šèŠ‚ç‚¹æ•°â‰¤1000ï¼Œé¿å…å…ƒæ•°æ®è†¨èƒ€&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©ä¸€è‡´æ€§å“ˆå¸Œ&lt;/strong&gt;çš„åœºæ™¯ï¼š
âœ… â€‹&lt;strong&gt;åˆ†å¸ƒå¼ç¼“å­˜&lt;/strong&gt;â€‹ï¼ˆå¦‚Memcachedï¼‰ï¼šèŠ‚ç‚¹é¢‘ç¹å˜åŠ¨ï¼Œéœ€æœ€å°åŒ–è¿ç§»æˆæœ¬&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚
âœ… â€‹&lt;strong&gt;è¶…å¤§è§„æ¨¡ç³»ç»Ÿ&lt;/strong&gt;â€‹ï¼šèŠ‚ç‚¹æ•°ï¼1000ï¼Œçµæ´»æ€§ä¼˜äºç®¡ç†æˆæœ¬&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚
âœ… â€‹&lt;strong&gt;CDNè´Ÿè½½å‡è¡¡&lt;/strong&gt;â€‹ï¼šè¯·æ±‚æŒ‰åœ°ç†ä½ç½®è·¯ç”±ï¼ŒåŠ¨æ€è°ƒæ•´èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œæ§½&lt;/strong&gt;æ˜¯ &lt;strong&gt;ç©ºé—´åˆ†åŒºç­–ç•¥&lt;/strong&gt;ï¼Œä»¥å›ºå®šæ§½ä½ä¸ºä¸­ä»‹è§£è€¦æ•°æ®ä¸èŠ‚ç‚¹ï¼Œé€‚åˆéœ€å¼ºç®¡æ§çš„åœºæ™¯&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/strong&gt;æ˜¯ &lt;strong&gt;æ‹“æ‰‘è·¯ç”±ç®—æ³•&lt;/strong&gt;ï¼Œé€šè¿‡ç¯å½¢è™šæ‹Ÿç©ºé—´å®ç°åŠ¨æ€ä¼¸ç¼©ï¼Œé€‚åˆé«˜æµåŠ¨æ€§åœºæ™¯&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;äºŒè€…æœ¬è´¨æ˜¯ &lt;strong&gt;åˆ†æ²»æ€æƒ³&lt;/strong&gt; çš„ä¸åŒå®è·µï¼šå“ˆå¸Œæ§½ä»¥â€œåˆ†æ§½æ²»ä¹‹â€ä¼˜å…ˆç®¡ç†æ•ˆç‡ï¼Œä¸€è‡´æ€§å“ˆå¸Œä»¥â€œåŠ¨æ€å¯»å€â€ä¼˜å…ˆå¼¹æ€§ï¼Œæ— ç»å¯¹ä¼˜åŠ£ï¼Œåªæœ‰é€‚ç”¨ä¸å¦&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="crc16"&gt;CRC16
&lt;/h2&gt;&lt;p&gt;CRC16æ˜¯ä¸€ç§&lt;strong&gt;æ ¡éªŒç®—æ³•&lt;/strong&gt;ï¼Œå±äº&lt;strong&gt;å“ˆå¸Œç®—æ³•ï¼ˆHash Algorithmï¼‰çš„èŒƒç•´&lt;/strong&gt;ï¼Œä½†å…¶è®¾è®¡ç›®æ ‡å’ŒæŠ€æœ¯ç‰¹æ€§ä¸&lt;strong&gt;åŠ å¯†çº§å“ˆå¸Œç®—æ³•&lt;/strong&gt;ï¼ˆå¦‚SHA-256ã€MD5ï¼‰å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-crc16çš„æœ¬è´¨å“ˆå¸Œç®—æ³•çš„å­ç±»"&gt;ğŸ” CRC16çš„æœ¬è´¨ï¼šå“ˆå¸Œç®—æ³•çš„å­ç±»
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å“ˆå¸Œç®—æ³•çš„æ ¸å¿ƒç‰¹å¾&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å›ºå®šé•¿åº¦è¾“å‡º&lt;/strong&gt;ï¼šå°†ä»»æ„é•¿åº¦è¾“å…¥æ˜ å°„ä¸ºå›ºå®šé•¿åº¦çš„æ•£åˆ—å€¼ï¼ˆå¦‚CRC16è¾“å‡º16ä½ï¼‰&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¡®å®šæ€§&lt;/strong&gt;ï¼šç›¸åŒè¾“å…¥å§‹ç»ˆäº§ç”Ÿç›¸åŒè¾“å‡º&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ•ˆæ€§&lt;/strong&gt;ï¼šè®¡ç®—é€Ÿåº¦å¿«ï¼Œé€‚åˆå®æ—¶å¤„ç†&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚
CRC16å®Œå…¨æ»¡è¶³ä¸Šè¿°ç‰¹å¾ï¼Œå› æ­¤å±äºå“ˆå¸Œç®—æ³•çš„ä¸€ç§&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CRC16çš„å“ˆå¸Œå±æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆæ•°æ®æ‘˜è¦&lt;/strong&gt;ï¼šé€šè¿‡å¤šé¡¹å¼é™¤æ³•ç”Ÿæˆ16ä½æ ¡éªŒç ï¼Œä½œä¸ºæ•°æ®çš„â€œæŒ‡çº¹â€&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›ªå´©æ•ˆåº”&lt;/strong&gt;ï¼šè¾“å…¥æ•°æ®çš„å¾®å°å˜åŒ–ï¼ˆå¦‚1æ¯”ç‰¹ç¿»è½¬ï¼‰ä¼šå¯¼è‡´è¾“å‡ºæ ¡éªŒç å¤§å¹…å˜åŒ–&lt;a class="link" href="@ref" &gt;10,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-crc16ä¸åŠ å¯†å“ˆå¸Œç®—æ³•çš„å…³é”®åŒºåˆ«"&gt;âš ï¸ CRC16ä¸åŠ å¯†å“ˆå¸Œç®—æ³•çš„å…³é”®åŒºåˆ«
&lt;/h3&gt;&lt;p&gt;å°½ç®¡CRC16æ˜¯å“ˆå¸Œç®—æ³•ï¼Œä½†&lt;strong&gt;ä¸å…·å¤‡åŠ å¯†çº§å®‰å…¨æ€§&lt;/strong&gt;ï¼Œä¸»è¦å·®å¼‚å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CRC16&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠ å¯†å“ˆå¸Œï¼ˆå¦‚SHA-256ï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¾è®¡ç›®æ ‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é”™è¯¯æ£€æµ‹ï¼ˆæ•°æ®å®Œæ•´æ€§ï¼‰&lt;/td&gt;
&lt;td&gt;æ•°æ®å®‰å…¨ï¼ˆé˜²ç¯¡æ”¹ã€æŠ—ç¢°æ’ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¢°æ’é£é™©&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¾ƒé«˜ï¼Œå¯èƒ½è¢«æ•…æ„æ„é€ ç¢°æ’&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æä½ï¼ˆå¼ºæŠ—ç¢°æ’æ€§ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸å¯é€†æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¼±ï¼ˆå¯è¢«é€†å‘å·¥ç¨‹ç ´è§£ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å¼ºï¼ˆæ— æ³•ä»å“ˆå¸Œå€¼è¿˜åŸè¾“å…¥ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®‰å…¨åœºæ™¯é€‚ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ ä¸é€‚ç”¨äºå¯†ç å­˜å‚¨ã€æ•°å­—ç­¾å&lt;/td&gt;
&lt;td&gt;âœ… ä¸“ä¸ºå®‰å…¨åœºæ™¯è®¾è®¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="å…·ä½“å·®å¼‚åˆ†æ"&gt;å…·ä½“å·®å¼‚åˆ†æï¼š
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æŠ—ç¢°æ’æ€§ä¸è¶³&lt;/strong&gt;
CRC16çš„16ä½è¾“å‡ºä»…æ”¯æŒ65,536ç§ç»„åˆï¼Œç¢°æ’æ¦‚ç‡è¿œé«˜äºSHA-256ï¼ˆ2Â²âµâ¶ç§ç»„åˆï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚æ”»å‡»è€…å¯è½»æ˜“æ‰¾åˆ°ä¸åŒæ•°æ®ç”Ÿæˆç›¸åŒCRC16å€¼ï¼Œæ— æ³•ç”¨äºé˜²ä¼ªé€ &lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— åŠ å¯†ç‰¹æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éå•å‘æ€§&lt;/strong&gt;ï¼šCRC16å¯é€šè¿‡æ•°å­¦æ¨å¯¼æˆ–æŸ¥è¡¨åå‘é€¼è¿‘åŸå§‹æ•°æ®&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ï¼Œè€ŒåŠ å¯†å“ˆå¸Œæ˜¯å•å‘å‡½æ•°&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ç›å€¼æ”¯æŒ&lt;/strong&gt;ï¼šCRC16è®¡ç®—æ— éœ€ç›å€¼ï¼ˆSaltï¼‰ï¼Œæ— æ³•æŠµå¾¡å½©è™¹è¡¨æ”»å‡»&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-crc16çš„æ ¸å¿ƒåº”ç”¨åœºæ™¯"&gt;âš™ï¸ CRC16çš„æ ¸å¿ƒåº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;p&gt;CRC16çš„å®šä½æ˜¯&lt;strong&gt;é«˜æ•ˆæ£€é”™&lt;/strong&gt;ï¼Œè€ŒéåŠ å¯†ï¼Œä¸»è¦åº”ç”¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€šä¿¡åè®®æ ¡éªŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸²å£é€šä¿¡ï¼ˆå¦‚Modbusï¼‰ã€ä»¥å¤ªç½‘å¸§æ ¡éªŒï¼Œæ£€æµ‹ä¼ è¾“ä¸­çš„æ¯”ç‰¹é”™è¯¯&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚Modbus RTUä½¿ç”¨CRC16-IBMï¼ˆå¤šé¡¹å¼0x8005ï¼‰éªŒè¯æ•°æ®å¸§å®Œæ•´æ€§&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜å‚¨ä»‹è´¨æ ¡éªŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;SDå¡ã€Flashå­˜å‚¨å™¨ç”¨CRC16ç¡®ä¿è¯»å†™æ•°æ®æ— ç‰©ç†æŸå&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åµŒå…¥å¼ç³»ç»Ÿä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç¡¬ä»¶åŠ é€Ÿå®ç°ï¼ˆå¦‚STM32çš„CRCå¤–è®¾ï¼‰ï¼Œæ»¡è¶³å®æ—¶æ€§è¦æ±‚&lt;a class="link" href="@ref" &gt;6,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æŸ¥è¡¨æ³•ä¼˜åŒ–è®¡ç®—é€Ÿåº¦ï¼Œå‡å°‘CPUå¼€é”€&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“crc16çš„å®šä½"&gt;ğŸ’ æ€»ç»“ï¼šCRC16çš„å®šä½
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;æ˜¯å“ˆå¸Œç®—æ³•&lt;/strong&gt;ï¼šç¬¦åˆå›ºå®šè¾“å‡ºã€ç¡®å®šæ€§ã€é«˜æ•ˆæ€§ç­‰åŸºæœ¬ç‰¹å¾ã€‚&lt;/li&gt;
&lt;li&gt;âŒ &lt;strong&gt;éåŠ å¯†å“ˆå¸Œ&lt;/strong&gt;ï¼šç¼ºä¹æŠ—ç¢°æ’æ€§ã€ä¸å¯é€†æ€§ç­‰å®‰å…¨å±æ€§ï¼Œä¸èƒ½ç”¨äºåŠ å¯†åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;é€‚ç”¨åœºæ™¯å»ºè®®ï¼š
&lt;ul&gt;
&lt;li&gt;é€‰æ‹©CRC16 â†’ é€šä¿¡é”™è¯¯æ£€æµ‹ã€å­˜å‚¨æ ¡éªŒç­‰&lt;strong&gt;éå®‰å…¨é¢†åŸŸ&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€‰æ‹©SHA-256 â†’ å¯†ç å­˜å‚¨ã€æ•°å­—ç­¾åç­‰&lt;strong&gt;å®‰å…¨æ•æ„Ÿé¢†åŸŸ&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ç®€è¨€ä¹‹ï¼šCRC16æ˜¯å“ˆå¸Œå®¶æ—çš„â€œå®ç”¨æ´¾â€ï¼Œä¸“æ”»&lt;strong&gt;æ•ˆç‡ä¸æ£€é”™&lt;/strong&gt;ï¼›è€ŒåŠ å¯†å“ˆå¸Œæ˜¯â€œå®‰å…¨ä¸“å®¶â€ï¼Œä¸“æ”»&lt;strong&gt;é˜²ç ´è§£ä¸æŠ—å†²çª&lt;/strong&gt;ã€‚äºŒè€…å„å¸å…¶èŒï¼Œä¸å¯äº’æ¢ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ§½æ•°"&gt;æ§½æ•°
&lt;/h2&gt;&lt;p&gt;Redis é›†ç¾¤é€‰æ‹© &lt;strong&gt;16384ï¼ˆ2Â¹â´ï¼‰&lt;/strong&gt; ä¸ªå“ˆå¸Œæ§½ï¼ˆHash Slotï¼‰ä½œä¸ºåˆ†ç‰‡æ•°é‡ï¼Œæ˜¯ç»¼åˆè€ƒé‡ç½‘ç»œå¼€é”€ã€é›†ç¾¤è§„æ¨¡ã€æ•°æ®åˆ†å¸ƒæ•ˆç‡ç­‰å› ç´ åçš„å·¥ç¨‹æœ€ä¼˜è§£ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒåŸå› åŠè¯¦ç»†åˆ†æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å¿ƒè·³åŒ…å¤§å°ä¼˜åŒ–æ ¸å¿ƒå› ç´ "&gt;âš™ï¸ &lt;strong&gt;å¿ƒè·³åŒ…å¤§å°ä¼˜åŒ–ï¼ˆæ ¸å¿ƒå› ç´ ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ§½ä½ä¿¡æ¯å­˜å‚¨æ–¹å¼&lt;/strong&gt;ï¼š
Redis èŠ‚ç‚¹é€šè¿‡å¿ƒè·³åŒ…ï¼ˆ&lt;code&gt;PING/PONG&lt;/code&gt;ï¼‰äº¤æ¢é›†ç¾¤çŠ¶æ€ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…å«èŠ‚ç‚¹è´Ÿè´£çš„æ§½ä½åˆ†é…ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯ä»¥ â€‹&lt;strong&gt;ä½å›¾ï¼ˆbitmapï¼‰â€‹&lt;/strong&gt;â€‹ å­˜å‚¨ï¼Œæ¯ä¸ªæ§½ä½å  1 æ¯”ç‰¹ï¼ˆbitï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;16384 æ§½ä½çš„ç©ºé—´å ç”¨&lt;/strong&gt;ï¼š
&lt;code&gt;16384 bits / 8 = 2048 å­—èŠ‚ = 2KB&lt;/code&gt;&lt;a class="link" href="@ref" &gt;1,3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‹¥é‡‡ç”¨ 65536 æ§½ä½&lt;/strong&gt;ï¼š
&lt;code&gt;65536 bits / 8 = 8192 å­—èŠ‚ = 8KB&lt;/code&gt;ï¼Œæ˜¯ 16384 æ–¹æ¡ˆçš„ â€‹&lt;strong&gt;4 å€&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å½±å“&lt;/strong&gt;ï¼š
å¿ƒè·³åŒ…é»˜è®¤æ¯ç§’å‘é€å¤šæ¬¡ï¼Œè‹¥æ§½ä½ä¿¡æ¯å ç”¨ 8KBï¼Œä¼šæ˜¾è‘—æ¶ˆè€—ç½‘ç»œå¸¦å®½ï¼Œå°¤å…¶åœ¨èŠ‚ç‚¹æ•°å¤šæ—¶å¯èƒ½å¼•å‘ç½‘ç»œæ‹¥å µ&lt;a class="link" href="@ref" &gt;1,4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;ç±»æ¯”&lt;/strong&gt;ï¼šå¦‚åŒå¿«é€’å‘˜æ¯æ—¥æ±‡æŠ¥åŒ…è£¹ä½ç½®ï¼Œç²¾ç®€çš„æ¸…å•ï¼ˆ2KBï¼‰æ¯”å†—é•¿æ¸…å•ï¼ˆ8KBï¼‰æ›´é«˜æ•ˆ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é›†ç¾¤è§„æ¨¡é™åˆ¶1000èŠ‚ç‚¹åŸåˆ™"&gt;ğŸ“ &lt;strong&gt;é›†ç¾¤è§„æ¨¡é™åˆ¶ï¼ˆ1000èŠ‚ç‚¹åŸåˆ™ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redis å®˜æ–¹å»ºè®®é›†ç¾¤ä¸»èŠ‚ç‚¹æ•°é‡ &lt;strong&gt;ä¸è¶…è¿‡ 1000 ä¸ª&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;1,4,6&lt;/a&gt;ï¼ŒåŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹æ•°é‡ä¸å¿ƒè·³åŒ…è´Ÿè½½&lt;/strong&gt;ï¼š
èŠ‚ç‚¹è¶Šå¤šï¼Œå¿ƒè·³åŒ…ä¸­æºå¸¦çš„èŠ‚ç‚¹çŠ¶æ€ä¿¡æ¯ï¼ˆå¦‚æ§½ä½ã€åœ°å€ï¼‰è¶Šå¤šï¼Œè¶…è¿‡ 1000 èŠ‚ç‚¹æ˜“å¯¼è‡´ç½‘ç»œæ‹¥å µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§½ä½åˆ†é…çš„åˆç†æ€§&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;16384 æ§½ä½&lt;/strong&gt;ï¼šåœ¨ 1000 èŠ‚ç‚¹æ—¶ï¼Œå¹³å‡æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£çº¦ &lt;strong&gt;16 ä¸ªæ§½ä½&lt;/strong&gt;ï¼ˆ16384 Ã· 1000ï¼‰ï¼Œåˆ†å¸ƒå‡åŒ€ä¸”æ˜“äºç®¡ç†&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è‹¥æ§½ä½è¿‡å°‘ï¼ˆå¦‚ 1000ï¼‰&lt;/strong&gt;ï¼šæ¯ä¸ªèŠ‚ç‚¹ä»…åˆ†åˆ° 1 ä¸ªæ§½ä½ï¼Œå“ˆå¸Œç®—æ³•é€€åŒ–ä¸ºç®€å•å–æ¨¡ï¼Œå¤±å»çµæ´»æ‰©ç¼©å®¹èƒ½åŠ›&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®è¿ç§»ç²’åº¦&lt;/strong&gt;ï¼š
æ§½ä½ä½œä¸ºæ•°æ®è¿ç§»çš„æœ€å°å•ä½ï¼Œ16384 çš„ç»†ç²’åº¦æ”¯æŒæ›´å¹³æ»‘çš„æ‰©å®¹ï¼ˆå¦‚æ–°èŠ‚ç‚¹ä»å¤šä¸ªè€èŠ‚ç‚¹å„è¿ç§»å°‘é‡æ§½ä½ï¼‰&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ•°æ®å‹ç¼©æ•ˆç‡"&gt;ğŸ“¦ &lt;strong&gt;æ•°æ®å‹ç¼©æ•ˆç‡&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ§½ä½ä¿¡æ¯å‹ç¼©æœºåˆ¶&lt;/strong&gt;ï¼š
å¿ƒè·³åŒ…ä¸­çš„æ§½ä½ä½å›¾ï¼ˆbitmapï¼‰åœ¨ä¼ è¾“å‰ä¼šè¿›è¡Œå‹ç¼©ï¼ˆå¦‚ &lt;code&gt;zlib&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‹ç¼©ç‡ä¸å¡«å……ç‡çš„å…³ç³»&lt;/strong&gt;ï¼š
å‹ç¼©ç‡å–å†³äº â€‹&lt;strong&gt;å¡«å……ç‡&lt;/strong&gt;â€‹ï¼ˆ&lt;code&gt;slots / N&lt;/code&gt;ï¼ŒN ä¸ºèŠ‚ç‚¹æ•°ï¼‰ã€‚å¡«å……ç‡è¶Šä½ï¼ˆå³æ§½ä½ç¨€ç–ï¼‰ï¼Œå‹ç¼©æ•ˆæœè¶Šå¥½&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;16384 çš„ä¼˜åŠ¿&lt;/strong&gt;ï¼š
åœ¨èŠ‚ç‚¹è¾ƒå°‘ï¼ˆå¦‚ 10 èŠ‚ç‚¹ï¼‰æ—¶ï¼Œ16384 æ§½ä½çš„å¡«å……ç‡è¾ƒä½ï¼ˆçº¦ 0.06%ï¼‰ï¼Œå‹ç¼©åä½“ç§¯è¿œå°äº 65536 æ§½ä½æ–¹æ¡ˆ&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš¡ï¸ &lt;strong&gt;å¯¹æ¯”&lt;/strong&gt;ï¼š16384 æ§½ä½åœ¨å°å‹é›†ç¾¤ä¸­å‹ç¼©ç‡æ›´é«˜ï¼Œä¼ è¾“æ•ˆç‡æå‡æ˜æ˜¾&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å·¥ç¨‹å®è·µæƒè¡¡"&gt;âš–ï¸ &lt;strong&gt;å·¥ç¨‹å®è·µæƒè¡¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—æ•ˆç‡&lt;/strong&gt;ï¼š
&lt;code&gt;16384 = 2Â¹â´&lt;/code&gt; æ˜¯ 2 çš„å¹‚æ¬¡æ–¹ï¼Œå–æ¨¡è¿ç®—ï¼ˆ&lt;code&gt;CRC16(key) % 16384&lt;/code&gt;ï¼‰å¯é€šè¿‡ä½æ“ä½œï¼ˆ&lt;code&gt;&amp;amp; 0x3FFF&lt;/code&gt;ï¼‰ä¼˜åŒ–ï¼Œæ¯”é€šç”¨å–æ¨¡å¿« 3-5 å€&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´å‹å¥½æ€§&lt;/strong&gt;ï¼š
å›ºå®šæ§½ä½æ•°ç®€åŒ–äº†é›†ç¾¤ç®¡ç†å·¥å…·çš„è®¾è®¡ï¼Œå¦‚æ§½ä½è¿ç§»å‘½ä»¤ &lt;code&gt;CLUSTER ADDSLOTS&lt;/code&gt; å¯ç›´æ¥æ“ä½œæ§½ä½ç¼–å·&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…æç«¯æ•°æ®å€¾æ–œ&lt;/strong&gt;ï¼š
16384 çš„æ§½ä½æ•°è¿œå¤§äºå…¸å‹é›†ç¾¤è§„æ¨¡ï¼ˆå¦‚ 100 èŠ‚ç‚¹ï¼‰ï¼Œç»“åˆ CRC16 çš„å‡åŒ€åˆ†å¸ƒç‰¹æ€§ï¼Œæœ‰æ•ˆè§„é¿äº†æ•°æ®çƒ­ç‚¹é—®é¢˜&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“16384-çš„åˆç†æ€§"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼š16384 çš„åˆç†æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;16384 æ§½ä½æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;65536 æ§½ä½æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¿ƒè·³åŒ…å¤§å°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;2KBï¼ˆå¸¦å®½å ç”¨ä½ï¼‰&lt;/td&gt;
&lt;td&gt;8KBï¼ˆæ˜“å¼•å‘æ‹¥å µï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åƒèŠ‚ç‚¹è´Ÿè½½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯èŠ‚ç‚¹çº¦ 16 æ§½ï¼ˆå‡è¡¡ï¼‰&lt;/td&gt;
&lt;td&gt;æ¯èŠ‚ç‚¹çº¦ 65 æ§½ï¼ˆä»å¯è¡Œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‹ç¼©æ•ˆç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¡«å……ç‡ä½ï¼Œå‹ç¼©ç‡é«˜&lt;/td&gt;
&lt;td&gt;å¡«å……ç‡é«˜ï¼Œå‹ç¼©ç‡ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¡ç®—æ•ˆç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½è¿ç®—ä¼˜åŒ–ï¼Œé€Ÿåº¦å¿«&lt;/td&gt;
&lt;td&gt;æ ‡å‡†å–æ¨¡ï¼Œé€Ÿåº¦æ…¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿ç»´å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å·¥å…·é“¾æˆç†Ÿï¼Œæ˜“æ“ä½œ&lt;/td&gt;
&lt;td&gt;ç®¡ç†æˆæœ¬é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ”‘ &lt;strong&gt;è®¾è®¡æœ¬è´¨&lt;/strong&gt;ï¼š16384 æ˜¯ &lt;strong&gt;å·¥ç¨‹æœ€ä¼˜è§£&lt;/strong&gt;ï¼ˆè€Œéç†è®ºæœ€ä¼˜ï¼‰ï¼Œåœ¨å¿ƒè·³å¼€é”€ã€é›†ç¾¤è§„æ¨¡ã€è®¡ç®—æ•ˆç‡ä¸‰è€…é—´å–å¾—å¹³è¡¡&lt;a class="link" href="@ref" &gt;4,6,7&lt;/a&gt;ã€‚
æ­£å¦‚ Redis ä½œè€… Antirez æ‰€è¿°ï¼š&lt;em&gt;â€œ16384 è¶³ä»¥è¦†ç›– 1000 èŠ‚ç‚¹é›†ç¾¤çš„éœ€æ±‚ï¼ŒåŒæ—¶é¿å…å¿ƒè·³åŒ…è¿‡å¤§â€&lt;/em&gt;&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="redisson"&gt;redisson
&lt;/h2&gt;&lt;p&gt;Redisson æ˜¯ä¸€ä¸ªé«˜çº§çš„ &lt;strong&gt;Java å®¢æˆ·ç«¯åº“&lt;/strong&gt;ï¼Œå®ƒæ—¢æ”¯æŒå•èŠ‚ç‚¹ Redisï¼Œä¹Ÿæ”¯æŒ Redis Cluster é›†ç¾¤æ¨¡å¼ã€‚å…¶æ ¸å¿ƒè®¾è®¡æ˜¯&lt;strong&gt;æŠ½è±¡åº•å±‚ Redis çš„éƒ¨ç½²æ¶æ„&lt;/strong&gt;ï¼Œå¼€å‘è€…å¯é€šè¿‡åŒä¸€å¥— API æ“ä½œä¸åŒéƒ¨ç½²æ¨¡å¼çš„ Redisï¼Œæ— éœ€å…³æ³¨åº•å±‚å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-redisson-ä¸-redisredis-cluster-çš„å…³ç³»"&gt;ğŸ” Redisson ä¸ Redis/Redis Cluster çš„å…³ç³»
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€å®šä½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redis&lt;/strong&gt;ï¼šæ˜¯å¼€æºçš„å†…å­˜é”®å€¼æ•°æ®åº“ï¼Œæä¾›æ•°æ®ç»“æ„å­˜å‚¨èƒ½åŠ›ï¼ˆå¦‚å­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ç­‰ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Redisson&lt;/strong&gt;ï¼šæ˜¯ Java å®¢æˆ·ç«¯åº“ï¼Œå°è£… Redis çš„æ“ä½œå¹¶æä¾›åˆ†å¸ƒå¼é«˜çº§åŠŸèƒ½ï¼ˆå¦‚é”ã€é˜Ÿåˆ—ã€é›†åˆï¼‰ï¼Œ&lt;strong&gt;åŒæ—¶é€‚é…å•èŠ‚ç‚¹å’Œé›†ç¾¤æ¨¡å¼&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¯æŒæ¨¡å¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å•èŠ‚ç‚¹ Redis&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;useSingleServer()&lt;/code&gt; é…ç½®è¿æ¥å•ä¸ª Redis å®ä¾‹&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Redis Cluster&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;useClusterServers()&lt;/code&gt; é…ç½®ï¼Œè‡ªåŠ¨å¤„ç†é›†ç¾¤èŠ‚ç‚¹å‘ç°ã€æ•°æ®åˆ†ç‰‡ã€æ•…éšœè½¬ç§»ç­‰å¤æ‚æ€§&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¶ä»–æ¨¡å¼&lt;/strong&gt;ï¼šè¿˜æ”¯æŒå“¨å…µï¼ˆSentinelï¼‰ã€ä¸»ä»ï¼ˆMaster/Slaveï¼‰ç­‰éƒ¨ç½²æ¶æ„&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-redisson-å¦‚ä½•é€‚é…ä¸åŒæ¨¡å¼"&gt;âš™ï¸ Redisson å¦‚ä½•é€‚é…ä¸åŒæ¨¡å¼
&lt;/h3&gt;&lt;h4 id="å•èŠ‚ç‚¹-redis-çš„é€‚é…"&gt;&lt;strong&gt;å•èŠ‚ç‚¹ Redis çš„é€‚é…&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é…ç½®ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Config config = new Config();
config.useSingleServer().setAddress(&amp;#34;redis://127.0.0.1:6379&amp;#34;);
RedissonClient client = Redisson.create(config);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹ç‚¹&lt;/strong&gt;ï¼š
æ‰€æœ‰æ“ä½œç›´æ¥å‘é€åˆ°å•ä¸€èŠ‚ç‚¹ï¼Œæ— éœ€å¤„ç†åˆ†ç‰‡æˆ–è·¯ç”±é€»è¾‘&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="redis-cluster-çš„é€‚é…"&gt;&lt;strong&gt;Redis Cluster çš„é€‚é…&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;é…ç½®ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;Config config = new Config();
config.useClusterServers()
.addNodeAddress(&amp;#34;redis://node1:7001&amp;#34;, &amp;#34;redis://node2:7002&amp;#34;);
RedissonClient client = Redisson.create(config);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;å…³é”®æŠ€æœ¯æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹å‘ç°&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;CLUSTER NODES&lt;/code&gt; å‘½ä»¤è‡ªåŠ¨è·å–é›†ç¾¤æ‹“æ‰‘ï¼Œç»´æŠ¤èŠ‚ç‚¹çŠ¶æ€è¡¨&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®è·¯ç”±&lt;/strong&gt;ï¼šåŸºäº &lt;strong&gt;å“ˆå¸Œæ§½ï¼ˆHash Slotï¼‰&lt;/strong&gt; è®¡ç®—é”®çš„å½’å±èŠ‚ç‚¹ï¼ˆå¦‚ &lt;code&gt;CRC16(key) % 16384&lt;/code&gt;ï¼‰ï¼Œå°†è¯·æ±‚å‘é€åˆ°æ­£ç¡®èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•…éšœè½¬ç§»&lt;/strong&gt;ï¼šç›‘æ§èŠ‚ç‚¹å¿ƒè·³ï¼Œä¸»èŠ‚ç‚¹æ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°ä»èŠ‚ç‚¹ï¼Œå¹¶æ›´æ–°æœ¬åœ°è·¯ç”±è¡¨&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‘½ä»¤æ‰¹å¤„ç†&lt;/strong&gt;ï¼šè·¨æ§½ä½æ“ä½œè‡ªåŠ¨æ‹†åˆ†ä¸ºæ‰¹é‡å‘½ä»¤ï¼Œå‘é€åˆ°å¤šä¸ªèŠ‚ç‚¹æ‰§è¡Œ&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®åŠŸèƒ½åœ¨ä¸åŒæ¨¡å¼ä¸‹çš„è¡Œä¸ºå¯¹æ¯”"&gt;ğŸ“Š å…³é”®åŠŸèƒ½åœ¨ä¸åŒæ¨¡å¼ä¸‹çš„è¡Œä¸ºå¯¹æ¯”
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å•èŠ‚ç‚¹ Redis&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Redis Cluster&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼é”ï¼ˆRLockï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥é€šè¿‡ &lt;code&gt;SETNX&lt;/code&gt; å‘½ä»¤å®ç°é”&lt;/td&gt;
&lt;td&gt;é€šè¿‡çº¢é”ï¼ˆRedLockï¼‰ç®—æ³•è·¨å¤šèŠ‚ç‚¹åå•†é”&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼é›†åˆï¼ˆRMapï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å•ä¸€èŠ‚ç‚¹&lt;/td&gt;
&lt;td&gt;æ•°æ®æŒ‰é”®åˆ†ç‰‡å­˜å‚¨åˆ°ä¸åŒèŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº‹åŠ¡æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•èŠ‚ç‚¹äº‹åŠ¡ï¼ˆ&lt;code&gt;MULTI/EXEC&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;ä»…æ”¯æŒåŒä¸€æ§½ä½å†…çš„é”®çš„äº‹åŠ¡&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è·¨èŠ‚ç‚¹æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤©ç„¶æ”¯æŒï¼ˆæ— åˆ†ç‰‡ï¼‰&lt;/td&gt;
&lt;td&gt;éœ€é€šè¿‡ &lt;code&gt;RBatch&lt;/code&gt; æ‰¹é‡å¤„ç†è·¨èŠ‚ç‚¹å‘½ä»¤&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨æ³¨æ„äº‹é¡¹"&gt;âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤é™åˆ¶&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¨æ§½ä½äº‹åŠ¡&lt;/strong&gt;ï¼šRedis Cluster ä¸æ”¯æŒè·¨æ§½ä½äº‹åŠ¡ï¼Œéœ€ç¡®ä¿äº‹åŠ¡å†…çš„é”®å±äºåŒä¸€æ§½ä½&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šé”®æ“ä½œ&lt;/strong&gt;ï¼šå¦‚ &lt;code&gt;RMap.getAll(keys)&lt;/code&gt; éœ€æ‰€æœ‰é”®åœ¨åŒä¸€èŠ‚ç‚¹ï¼Œå¦åˆ™éœ€éå†å¤šä¸ªèŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥æ± é…ç½®&lt;/strong&gt;ï¼šé›†ç¾¤æ¨¡å¼ä¸‹éœ€å¢å¤§è¿æ¥æ± ï¼Œé¿å…èŠ‚ç‚¹è¿‡å¤šå¯¼è‡´è¿æ¥ä¸è¶³&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°ç¼“å­˜&lt;/strong&gt;ï¼šå¯¹çƒ­ç‚¹æ•°æ®å¯ç”¨ &lt;code&gt;RMapCache&lt;/code&gt; æœ¬åœ°ç¼“å­˜ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»´å»ºè®®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ‰©ç¼©å®¹&lt;/strong&gt;ï¼šé›†ç¾¤æ‰©å®¹æ—¶ï¼ŒRedisson è‡ªåŠ¨æ„ŸçŸ¥æ–°èŠ‚ç‚¹å¹¶æ›´æ–°è·¯ç”±ï¼Œä½†è¿ç§»æœŸé—´å¯èƒ½æœ‰çŸ­æš‚é‡å®šå‘ï¼ˆ&lt;code&gt;MOVED&lt;/code&gt; å“åº”ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;CLUSTER INFO&lt;/code&gt; ç›‘æ§é›†ç¾¤çŠ¶æ€ï¼Œç»“åˆ Redisson æ—¥å¿—æ’æŸ¥è·¯ç”±å¼‚å¸¸&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ æ€»ç»“
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç»“è®º&lt;/strong&gt;ï¼š
Redisson â€‹&lt;strong&gt;åŒæ—¶æ”¯æŒå•èŠ‚ç‚¹ Redis å’Œ Redis Cluster&lt;/strong&gt;ï¼Œé€šè¿‡ç»Ÿä¸€ API å±è”½åº•å±‚å·®å¼‚ï¼Œå¼€å‘è€…åªéœ€è°ƒæ•´é…ç½®å³å¯åˆ‡æ¢æ¨¡å¼&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;ä¸­å°è§„æ¨¡åº”ç”¨ â†’ å•èŠ‚ç‚¹æ¨¡å¼ï¼ˆç®€å•é«˜æ•ˆï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;é«˜å¹¶å‘/å¤§æ•°æ®é‡ â†’ Redis Cluster æ¨¡å¼ï¼ˆæ°´å¹³æ‰©å±•ã€é«˜å¯ç”¨ï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ä»·å€¼&lt;/strong&gt;ï¼š
Redisson çš„æœ¬è´¨æ˜¯ â€‹&lt;strong&gt;Redis çš„æ™ºèƒ½å®¢æˆ·ç«¯&lt;/strong&gt;ï¼Œæ— è®ºåº•å±‚æ˜¯å•èŠ‚ç‚¹è¿˜æ˜¯é›†ç¾¤ï¼Œå®ƒéƒ½æä¾›ä¸€è‡´çš„åˆ†å¸ƒå¼ç¼–ç¨‹ä½“éªŒï¼Œå¤§å¹…é™ä½åˆ†å¸ƒå¼ç³»ç»Ÿå¤æ‚åº¦&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>ã€Redisã€‘Concepts</title><link>https://dyhes.github.io/p/redisconcepts/</link><pubDate>Sat, 28 Jun 2025 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/redisconcepts/</guid><description>&lt;h2 id="å•çº¿ç¨‹"&gt;å•çº¿ç¨‹
&lt;/h2&gt;&lt;p&gt;Redis çš„å•çº¿ç¨‹æ¶æ„æ˜¯å…¶é«˜æ€§èƒ½è®¾è®¡çš„æ ¸å¿ƒï¼Œä½†è¿™ä¸€æ¦‚å¿µå¸¸è¢«è¯¯è§£ã€‚ä¸‹é¢ä»&lt;strong&gt;è®¾è®¡æœ¬è´¨ã€æ€§èƒ½åŸç†ã€å¤šçº¿ç¨‹æ¼”è¿›&lt;/strong&gt;å’Œ&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;å››ä¸ªç»´åº¦è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å•çº¿ç¨‹çš„æœ¬è´¨æ ¸å¿ƒå‘½ä»¤ä¸²è¡Œæ‰§è¡Œ"&gt;ğŸ§  &lt;strong&gt;å•çº¿ç¨‹çš„æœ¬è´¨ï¼šæ ¸å¿ƒå‘½ä»¤ä¸²è¡Œæ‰§è¡Œ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;â€œå•çº¿ç¨‹â€çš„å‡†ç¡®å«ä¹‰&lt;/strong&gt;
Redis çš„â€œå•çº¿ç¨‹â€ç‰¹æŒ‡ â€‹&lt;strong&gt;ä¸»çº¿ç¨‹ï¼ˆMain Threadï¼‰ä¸²è¡Œå¤„ç†æ ¸å¿ƒæ“ä½œ&lt;/strong&gt;â€‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œ I/O&lt;/strong&gt;ï¼šæ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ã€è¯»å–è¯·æ±‚æ•°æ®ã€å‘é€å“åº”&lt;a class="link" href="@ref" &gt;1,7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‘½ä»¤æ‰§è¡Œ&lt;/strong&gt;ï¼šè§£æè¯·æ±‚ã€æ“ä½œå†…å­˜æ•°æ®ç»“æ„ï¼ˆå¦‚ &lt;code&gt;SET&lt;/code&gt;/&lt;code&gt;GET&lt;/code&gt;ï¼‰ã€è¿”å›ç»“æœ&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº¿ç¨‹çš„è¾…åŠ©è§’è‰²&lt;/strong&gt;
Redis å¹¶éå®Œå…¨å•çº¿ç¨‹ï¼Œä»¥ä¸‹æ“ä½œç”±å…¶ä»–çº¿ç¨‹/è¿›ç¨‹å®Œæˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŒä¹…åŒ–&lt;/strong&gt;ï¼š&lt;code&gt;bgsave&lt;/code&gt; ç”Ÿæˆ RDB å¿«ç…§ï¼ˆå­è¿›ç¨‹ï¼‰ã€&lt;code&gt;bgrewriteaof&lt;/code&gt; é‡å†™ AOF æ–‡ä»¶ï¼ˆå­è¿›ç¨‹ï¼‰&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥åˆ é™¤&lt;/strong&gt;ï¼š&lt;code&gt;UNLINK&lt;/code&gt; å‘½ä»¤å°†å¤§é”®åˆ é™¤ç§»äº¤åå°çº¿ç¨‹&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œ I/O å¤šçº¿ç¨‹&lt;/strong&gt;ï¼ˆRedis 6.0+ï¼‰ï¼šè¯»å†™ Socket æ•°æ®ç”± I/O çº¿ç¨‹æ± å¹¶è¡Œå¤„ç†&lt;a class="link" href="@ref" &gt;1,3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å•çº¿ç¨‹é«˜æ€§èƒ½çš„äº”å¤§æ”¯æŸ±"&gt;âš¡ &lt;strong&gt;å•çº¿ç¨‹é«˜æ€§èƒ½çš„äº”å¤§æ”¯æŸ±&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ”¯æŸ±&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸç†è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½æ”¶ç›Š&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¯å†…å­˜æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®å…¨é‡é©»ç•™å†…å­˜ï¼Œè¯»å†™è€—æ—¶åœ¨å¾®ç§’çº§ï¼ˆvs ç£ç›˜æ¯«ç§’çº§ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;è·³è¿‡ç£ç›˜ I/O ç“¶é¢ˆï¼Œé€Ÿåº¦æå‡ 10â¶ å€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ— é”åŸå­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•çº¿ç¨‹å¤©ç„¶ä¿è¯å‘½ä»¤åŸå­æ€§ï¼Œæ— éœ€åŠ é”æˆ–åŒæ­¥æœºåˆ¶&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;é¿å…é”ç«äº‰ã€æ­»é”åŠçº¿ç¨‹åˆ‡æ¢å¼€é”€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;I/O å¤šè·¯å¤ç”¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºäº &lt;code&gt;epoll&lt;/code&gt;ï¼ˆLinuxï¼‰çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œå•çº¿ç¨‹ç›‘å¬æ•°ä¸‡è¿æ¥ï¼Œéé˜»å¡å¤„ç†å°±ç»ªäº‹ä»¶&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ä¸‹ CPU åˆ©ç”¨ç‡ &amp;gt;90%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜æ•ˆæ•°æ®ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;SDSã€è·³è·ƒè¡¨ã€å“ˆå¸Œè¡¨ç­‰ä¼˜åŒ–è®¾è®¡ï¼Œå¤šæ•°æ“ä½œ O(1) å¤æ‚åº¦&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å‘½ä»¤æ‰§è¡Œè·¯å¾„çŸ­ï¼ˆ&amp;lt;100 è¡Œä»£ç ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç²¾ç®€çº¿ç¨‹æ¨¡å‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼ŒCPU ç¼“å­˜å‘½ä¸­ç‡é«˜&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å•æ ¸å¯è¾¾ 10ä¸‡~15ä¸‡ QPS&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;ï¼š&lt;code&gt;GET key&lt;/code&gt; å‘½ä»¤çš„å¤„ç†æµç¨‹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;epoll_wait&lt;/code&gt; ç›‘å¬åˆ° Socket å¯è¯»äº‹ä»¶ â†’&lt;/li&gt;
&lt;li&gt;ä¸»çº¿ç¨‹è¯»å–è¯·æ±‚å¹¶è§£æä¸º &lt;code&gt;GET&lt;/code&gt; å‘½ä»¤ â†’&lt;/li&gt;
&lt;li&gt;ä»å†…å­˜å“ˆå¸Œè¡¨æŸ¥æ‰¾ &lt;code&gt;key&lt;/code&gt; çš„å€¼ â†’&lt;/li&gt;
&lt;li&gt;å°†ç»“æœå†™å…¥è¾“å‡ºç¼“å†²åŒº â†’&lt;/li&gt;
&lt;li&gt;&lt;code&gt;epoll_wait&lt;/code&gt; è§¦å‘å¯å†™äº‹ä»¶åå‘é€å“åº”&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å¤šçº¿ç¨‹æ¼”è¿›redis-0-çš„é’ˆå¯¹æ€§ä¼˜åŒ–"&gt;ğŸ”§ &lt;strong&gt;å¤šçº¿ç¨‹æ¼”è¿›ï¼šRedis 0+ çš„é’ˆå¯¹æ€§ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redis 6.0 å¼•å…¥ &lt;strong&gt;I/O å¤šçº¿ç¨‹&lt;/strong&gt;ä»¥çªç ´ç½‘ç»œç“¶é¢ˆï¼Œä½†&lt;strong&gt;å‘½ä»¤æ‰§è¡Œä»ä¿æŒå•çº¿ç¨‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# redis.conf é…ç½®ç¤ºä¾‹
io-threads-do-reads yes # å¯ç”¨ I/O å¤šçº¿ç¨‹
io-threads 4 # çº¿ç¨‹æ•°å»ºè®®ä¸º CPU æ ¸æ•°-1[1,9](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å·¥ä½œæµç¨‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸»çº¿ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;æ¥æ”¶è¿æ¥ï¼Œå°† Socket æ”¾å…¥å…¨å±€é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;è½®è¯¢åˆ†é… Socket ç»™ I/O çº¿ç¨‹&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;I/O çº¿ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;è¯»å–è¯·æ±‚æ•°æ®å¹¶è§£æåè®®ï¼ˆä¸æ‰§è¡Œå‘½ä»¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;å°†ä¸»çº¿ç¨‹çš„æ‰§è¡Œç»“æœå†™å› Socket&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‘½ä»¤æ‰§è¡Œï¼š
&lt;ul&gt;
&lt;li&gt;ä»…ç”±ä¸»çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œï¼Œä¿éšœåŸå­æ€§&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šI/O å¤šçº¿ç¨‹ä»…ä¼˜åŒ–ç½‘ç»œååï¼ˆå¦‚ Pipeline/TLS åœºæ™¯ï¼‰ï¼Œå¯¹ CPU å¯†é›†å‹æ“ä½œæ— æ•ˆ&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å•çº¿ç¨‹çš„å±€é™ä¸åº”å¯¹ç­–ç•¥"&gt;âš ï¸ &lt;strong&gt;å•çº¿ç¨‹çš„å±€é™ä¸åº”å¯¹ç­–ç•¥&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç“¶é¢ˆ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é•¿è€—æ—¶å‘½ä»¤é˜»å¡&lt;/strong&gt;ï¼šå¦‚ &lt;code&gt;KEYS *&lt;/code&gt;ï¼ˆå…¨è¡¨æ‰«æï¼‰ã€å¤æ‚ Lua è„šæœ¬ã€å¤§ Key åˆ é™¤ï¼ˆ&lt;code&gt;DEL&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•æ ¸ CPU åˆ©ç”¨ç‡&lt;/strong&gt;ï¼šæ— æ³•åˆ©ç”¨å¤šæ ¸ï¼ˆéœ€åˆ†ç‰‡æ‰©å±•ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å¤§ Key åˆ é™¤&lt;/td&gt;
&lt;td&gt;ç”¨ &lt;code&gt;UNLINK&lt;/code&gt; æ›¿ä»£ &lt;code&gt;DEL&lt;/code&gt;ï¼ˆåå°çº¿ç¨‹å¼‚æ­¥åˆ é™¤ï¼‰&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å…¨é‡é”®éå†&lt;/td&gt;
&lt;td&gt;ç”¨ &lt;code&gt;SCAN&lt;/code&gt; æ›¿ä»£ &lt;code&gt;KEYS&lt;/code&gt;ï¼ˆåˆ†æ‰¹è·å–ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é«˜å¹¶å‘å†™å…¥&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ Redis Cluster åˆ†ç‰‡ï¼ˆ16384 æ§½åˆ†æ•£åˆ°å¤šèŠ‚ç‚¹ï¼‰&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CPU å¯†é›†å‹æ“ä½œ&lt;/td&gt;
&lt;td&gt;æ‹†è§£ Lua è„šæœ¬æˆ–æ”¹ç”¨ Redis æ¨¡å—ï¼ˆå¦‚ RediSearchï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“redis-çº¿ç¨‹æ¨¡å‹çš„æ ¸å¿ƒé€»è¾‘"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šRedis çº¿ç¨‹æ¨¡å‹çš„æ ¸å¿ƒé€»è¾‘&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å•çº¿ç¨‹æ ¸å¿ƒ&lt;/strong&gt;ï¼šå‘½ä»¤æ‰§è¡Œä¸²è¡ŒåŒ–æ˜¯ Redis é«˜ååã€ä½å»¶è¿Ÿçš„åŸºçŸ³ï¼Œé€šè¿‡å†…å­˜æ“ä½œ + I/O å¤šè·¯å¤ç”¨å®ç°é«˜æ•ˆå¹¶å‘&lt;a class="link" href="@ref" &gt;5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº¿ç¨‹è¾…åŠ©&lt;/strong&gt;ï¼šç½‘ç»œ I/Oã€å¼‚æ­¥åˆ é™¤ç­‰ä¼˜åŒ–é’ˆå¯¹ç‰¹å®šç“¶é¢ˆï¼Œ&lt;strong&gt;ç»ä¸ç ´åå‘½ä»¤åŸå­æ€§&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;9,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¨è&lt;/strong&gt;ï¼šé«˜å¹¶å‘è¯»å†™ï¼ˆå¦‚è®¡æ•°å™¨ã€ä¼šè¯ç¼“å­˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§„é¿&lt;/strong&gt;ï¼šCPU å¯†é›†å‹ä»»åŠ¡ã€å¤§æ•°æ®åˆ†æï¼ˆæ”¹ç”¨ Spark/Flinkï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;INFO COMMANDSTATS&lt;/code&gt; ç›‘æ§å‘½ä»¤è€—æ—¶ï¼Œç»“åˆ &lt;code&gt;io-threads&lt;/code&gt; é…ç½®è°ƒæ•´ï¼Œå¯æœ€å¤§åŒ–å‘æŒ¥ Redis æ€§èƒ½æ½œåŠ›&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ç±»å‹"&gt;ç±»å‹
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ Redis æ ¸å¿ƒæ•°æ®ç±»å‹çš„è¯¦ç»†è¯´æ˜ï¼Œæ¶µç›–åº•å±‚ç»“æ„ã€å…¸å‹åº”ç”¨åŠæ“ä½œç‰¹æ€§ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-stringå­—ç¬¦ä¸²"&gt;âš™ï¸ &lt;strong&gt;Stringï¼ˆå­—ç¬¦ä¸²ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç‰¹æ€§"&gt;&lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å½¢å¼&lt;/strong&gt;ï¼šå¯å­˜å‚¨å­—ç¬¦ä¸²ï¼ˆæœ€é•¿ &lt;strong&gt;512MB&lt;/strong&gt;ï¼‰ã€æ•´æ•°æˆ–æµ®ç‚¹æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ“ä½œ&lt;/strong&gt;ï¼šæ”¯æŒ &lt;code&gt;INCR/DECR&lt;/code&gt;ï¼ˆè®¡æ•°å™¨ï¼‰ã€&lt;code&gt;APPEND&lt;/code&gt;ï¼ˆè¿½åŠ ï¼‰ç­‰åŸå­å‘½ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äºŒè¿›åˆ¶å®‰å…¨&lt;/strong&gt;ï¼šæ”¯æŒä»»æ„æ ¼å¼æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€åºåˆ—åŒ–å¯¹è±¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åº•å±‚ç»“æ„"&gt;&lt;strong&gt;åº•å±‚ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;SDSï¼ˆç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;ç»“æ„ï¼šåŒ…å« &lt;code&gt;len&lt;/code&gt;ï¼ˆå½“å‰é•¿åº¦ï¼‰ã€&lt;code&gt;free&lt;/code&gt;ï¼ˆå‰©ä½™ç©ºé—´ï¼‰ã€&lt;code&gt;buf[]&lt;/code&gt;ï¼ˆæ•°æ®æ•°ç»„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–ï¼šé¢„åˆ†é…å†…å­˜ï¼ˆ&amp;lt;1MB æ—¶åŒå€æ‰©å®¹ï¼Œ&amp;gt;1MB æ—¶å¤šæ‰© 1MBï¼‰åŠæƒ°æ€§ç©ºé—´é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åº”ç”¨åœºæ™¯"&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜&lt;/strong&gt;ï¼šå­˜å‚¨æ•°æ®åº“æŸ¥è¯¢ç»“æœã€ä¼šè¯ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¡æ•°å™¨&lt;/strong&gt;ï¼šç½‘é¡µè®¿é—®é‡ç»Ÿè®¡ï¼ˆ&lt;code&gt;INCR&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼é”&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;SET key value NX&lt;/code&gt; å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-liståˆ—è¡¨"&gt;ğŸ“‹ &lt;strong&gt;Listï¼ˆåˆ—è¡¨ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç‰¹æ€§-1"&gt;&lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ‰åºç»“æ„&lt;/strong&gt;ï¼šå…ƒç´ æŒ‰æ’å…¥é¡ºåºæ’åˆ—ï¼Œå…è®¸é‡å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒç«¯æ“ä½œ&lt;/strong&gt;ï¼šæ”¯æŒ &lt;code&gt;LPUSH/RPUSH&lt;/code&gt;ï¼ˆå¤´/å°¾æ’å…¥ï¼‰ã€&lt;code&gt;LPOP/RPOP&lt;/code&gt;ï¼ˆå¤´/å°¾å¼¹å‡ºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åº•å±‚ç»“æ„-1"&gt;&lt;strong&gt;åº•å±‚ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;QuickListï¼ˆå¿«é€Ÿåˆ—è¡¨ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;ç”±å¤šä¸ª &lt;code&gt;listpack&lt;/code&gt;ï¼ˆç´§å‡‘åˆ—è¡¨ï¼‰èŠ‚ç‚¹ç»„æˆçš„åŒå‘é“¾è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ›¿ä»£æ—§ç‰ˆ &lt;code&gt;ziplist&lt;/code&gt; + &lt;code&gt;linkedlist&lt;/code&gt;ï¼Œå¹³è¡¡å†…å­˜ä¸æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åº”ç”¨åœºæ™¯-1"&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt;ï¼šç”Ÿäº§è€…é€šè¿‡ &lt;code&gt;LPUSH&lt;/code&gt; å†™å…¥ï¼Œæ¶ˆè´¹è€…é€šè¿‡ &lt;code&gt;BRPOP&lt;/code&gt; é˜»å¡è¯»å–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´çº¿&lt;/strong&gt;ï¼šå­˜å‚¨æœ€æ–°åŠ¨æ€ï¼ˆå¦‚å¾®åšæ—¶é—´çº¿ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-hashå“ˆå¸Œè¡¨"&gt;ğŸ§® &lt;strong&gt;Hashï¼ˆå“ˆå¸Œè¡¨ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç‰¹æ€§-2"&gt;&lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»“æ„åŒ–å­˜å‚¨&lt;/strong&gt;ï¼šé”®å€¼å¯¹é›†åˆï¼Œé€‚åˆå­˜å‚¨å¯¹è±¡ï¼ˆå¦‚ç”¨æˆ·å±æ€§ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ•ˆå­—æ®µæ“ä½œ&lt;/strong&gt;ï¼šæ”¯æŒå•ç‹¬è¯»å†™å­—æ®µï¼ˆ&lt;code&gt;HGET&lt;/code&gt;/&lt;code&gt;HSET&lt;/code&gt;ï¼‰ï¼Œé¿å…å…¨é‡å­˜å–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åº•å±‚ç»“æ„-2"&gt;&lt;strong&gt;åº•å±‚ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;HashTable æˆ– ListPackï¼š
&lt;ul&gt;
&lt;li&gt;å°æ•°æ®ï¼ˆé»˜è®¤å­—æ®µæ•° &amp;lt;512 ä¸”å€¼ &amp;lt;64Bï¼‰ç”¨ &lt;code&gt;listpack&lt;/code&gt;ï¼ˆè¿ç»­å†…å­˜å—ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤§æ•°æ®è½¬ä¸ºå“ˆå¸Œè¡¨ï¼ˆé“¾åœ°å€æ³•è§£å†³å†²çªï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¸¸ç”¨å‘½ä»¤ç¤ºä¾‹"&gt;&lt;strong&gt;å¸¸ç”¨å‘½ä»¤ç¤ºä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‘½ä»¤&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;HSET&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®å­—æ®µå€¼&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HSET user:1 name &amp;quot;Alice&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;HINCRBY&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å­—æ®µå€¼è‡ªå¢&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HINCRBY user:1 age 1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;HGETALL&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–æ‰€æœ‰å­—æ®µåŠå€¼&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HGETALL user:1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="åº”ç”¨åœºæ™¯-2"&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å­˜å‚¨&lt;/strong&gt;ï¼šç”¨æˆ·ä¿¡æ¯ï¼ˆ&lt;code&gt;user:id&lt;/code&gt; ä¸º keyï¼Œå±æ€§ä¸º fieldï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´­ç‰©è½¦&lt;/strong&gt;ï¼šç”¨æˆ· ID ä¸º keyï¼Œå•†å“ ID ä¸º fieldï¼Œæ•°é‡ä¸º valueã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-seté›†åˆ"&gt;ğŸ§© &lt;strong&gt;Setï¼ˆé›†åˆï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç‰¹æ€§-3"&gt;&lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ— åºå”¯ä¸€&lt;/strong&gt;ï¼šå…ƒç´ ä¸é‡å¤ä¸”æ— åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†åˆè¿ç®—&lt;/strong&gt;ï¼šæ”¯æŒäº¤é›†ï¼ˆ&lt;code&gt;SINTER&lt;/code&gt;ï¼‰ã€å¹¶é›†ï¼ˆ&lt;code&gt;SUNION&lt;/code&gt;ï¼‰ã€å·®é›†ï¼ˆ&lt;code&gt;SDIFF&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åº•å±‚ç»“æ„-3"&gt;&lt;strong&gt;åº•å±‚ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;IntSet æˆ– HashTableï¼š
&lt;ul&gt;
&lt;li&gt;æ•´æ•°å…ƒç´ è¾ƒå°‘æ—¶ç”¨ &lt;code&gt;intset&lt;/code&gt;ï¼ˆæ•´æ•°æ•°ç»„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…¶ä»–æƒ…å†µç”¨å“ˆå¸Œè¡¨ï¼ˆå€¼å›ºå®šä¸º &lt;code&gt;NULL&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é›†åˆæ“ä½œå‘½ä»¤"&gt;&lt;strong&gt;é›†åˆæ“ä½œå‘½ä»¤&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;SADD tags:post1 &amp;#34;tech&amp;#34; &amp;#34;redis&amp;#34; # æ·»åŠ å…ƒç´ 
SINTER tags:post1 tags:post2 # æ±‚äº¤é›†ï¼ˆå…±åŒæ ‡ç­¾ï¼‰
SPOP tags:post1 1 # éšæœºå¼¹å‡ºå…ƒç´ ï¼ˆæŠ½å¥–ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="åº”ç”¨åœºæ™¯-3"&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ‡ç­¾ç³»ç»Ÿ&lt;/strong&gt;ï¼šæ–‡ç« æ ‡ç­¾å»é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ½å¥–&lt;/strong&gt;ï¼š&lt;code&gt;SPOP&lt;/code&gt; éšæœºç§»é™¤å…ƒç´ ï¼ˆä¸­å¥–è€…ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-sorted-setæœ‰åºé›†åˆ"&gt;ğŸ“Š &lt;strong&gt;Sorted Setï¼ˆæœ‰åºé›†åˆï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒç‰¹æ€§-4"&gt;&lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æƒé‡æ’åº&lt;/strong&gt;ï¼šæ¯ä¸ªå…ƒç´ å…³è” &lt;code&gt;score&lt;/code&gt;ï¼ˆåˆ†æ•°ï¼‰ï¼ŒæŒ‰åˆ†æ•°å‡åºæ’åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŒƒå›´æŸ¥è¯¢&lt;/strong&gt;ï¼šæ”¯æŒ &lt;code&gt;ZRANGE&lt;/code&gt;ï¼ˆæŒ‰åˆ†æŸ¥å…ƒç´ ï¼‰ã€&lt;code&gt;ZRANK&lt;/code&gt;ï¼ˆæŸ¥æ’åï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åº•å±‚ç»“æ„-4"&gt;&lt;strong&gt;åº•å±‚ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;SkipList + ListPackï¼š
&lt;ul&gt;
&lt;li&gt;è·³è·ƒè¡¨å®ç°é«˜æ•ˆèŒƒå›´æŸ¥è¯¢ï¼Œ&lt;code&gt;listpack&lt;/code&gt; å­˜å‚¨å…ƒç´ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ›¿ä»£æ—§ç‰ˆ &lt;code&gt;ziplist&lt;/code&gt;ï¼Œæå‡å†…å­˜æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åº”ç”¨åœºæ™¯-4"&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ’è¡Œæ¦œ&lt;/strong&gt;ï¼šæ¸¸æˆç§¯åˆ†å®æ—¶æ›´æ–°ï¼ˆ&lt;code&gt;ZADD&lt;/code&gt;ï¼‰å¹¶è·å– TOP10ï¼ˆ&lt;code&gt;ZRANGE&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»¶è¿Ÿé˜Ÿåˆ—&lt;/strong&gt;ï¼šç”¨ &lt;code&gt;score&lt;/code&gt; å­˜å‚¨æ‰§è¡Œæ—¶é—´ï¼Œå®šæ—¶æ‰«æåˆ°æœŸä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜çº§æ•°æ®ç±»å‹è¡¥å……"&gt;ğŸ” &lt;strong&gt;é«˜çº§æ•°æ®ç±»å‹ï¼ˆè¡¥å……ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;Geospatialï¼ˆåœ°ç†ç©ºé—´ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨ç»çº¬åº¦ï¼Œæ”¯æŒä½ç½®è®¡ç®—ï¼ˆå¦‚ &lt;code&gt;GEODIST&lt;/code&gt; æ±‚è·ç¦»ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;HyperLogLogï¼š
&lt;ul&gt;
&lt;li&gt;åŸºæ•°ç»Ÿè®¡ï¼ˆå¦‚ UVï¼‰ï¼Œè¯¯å·® &amp;lt;1%ï¼Œå†…å­˜å ç”¨æä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Bitmap / Bitfieldï¼š
&lt;ul&gt;
&lt;li&gt;ä½æ“ä½œï¼šç”¨æˆ·ç­¾åˆ°çŠ¶æ€ï¼ˆæ¯æ—¥ 1 bitï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Streamï¼š
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯é˜Ÿåˆ—ï¼šæ”¯æŒæ¶ˆè´¹è€…ç»„ã€æ¶ˆæ¯æŒä¹…åŒ–ï¼ˆæ›¿ä»£ Kafka è½»é‡çº§æ–¹æ¡ˆï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-äº”ç±»æ ¸å¿ƒæ•°æ®ç±»å‹å¯¹æ¯”æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;äº”ç±»æ ¸å¿ƒæ•°æ®ç±»å‹å¯¹æ¯”æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœ‰åºæ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å”¯ä¸€æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹å‘½ä»¤&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;String&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;é”®å”¯ä¸€&lt;/td&gt;
&lt;td&gt;ç¼“å­˜ã€è®¡æ•°å™¨ã€é”&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SET&lt;/code&gt;, &lt;code&gt;INCR&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;List&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ’å…¥é¡ºåº&lt;/td&gt;
&lt;td&gt;å¯é‡å¤&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯é˜Ÿåˆ—ã€æ—¶é—´çº¿&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LPUSH&lt;/code&gt;, &lt;code&gt;BRPOP&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Hash&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;å­—æ®µå”¯ä¸€&lt;/td&gt;
&lt;td&gt;å¯¹è±¡å­˜å‚¨ã€è´­ç‰©è½¦&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HSET&lt;/code&gt;, &lt;code&gt;HGETALL&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Set&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;å…ƒç´ å”¯ä¸€&lt;/td&gt;
&lt;td&gt;æ ‡ç­¾ã€å»é‡ã€é›†åˆè¿ç®—&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SADD&lt;/code&gt;, &lt;code&gt;SINTER&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Sorted Set&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æŒ‰åˆ†æ•°æ’åº&lt;/td&gt;
&lt;td&gt;å…ƒç´ å”¯ä¸€&lt;/td&gt;
&lt;td&gt;æ’è¡Œæ¦œã€å»¶è¿Ÿä»»åŠ¡&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ZADD&lt;/code&gt;, &lt;code&gt;ZRANGE&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‰å‹å»ºè®®"&gt;ğŸ’¡ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜é¢‘è¯»å†™ç®€å•å€¼&lt;/strong&gt; â†’ String&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡å±æ€§æ“ä½œ&lt;/strong&gt; â†’ Hash&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºæ•æ„Ÿä»»åŠ¡&lt;/strong&gt; â†’ List&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»é‡ä¸é›†åˆè¿ç®—&lt;/strong&gt; â†’ Set&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé‡æ’åºéœ€æ±‚&lt;/strong&gt; â†’ Sorted Set
é€šè¿‡åˆç†é€‰æ‹©æ•°æ®ç±»å‹ï¼Œå¯æ˜¾è‘—ä¼˜åŒ– Redis åœ¨æ€§èƒ½ã€å†…å­˜åŠåŠŸèƒ½ä¸Šçš„è¡¨ç°ã€‚è¯¦ç»†å‘½ä»¤å‚è€ƒå®˜æ–¹æ–‡æ¡£æˆ–å®æ“æ¼”ç»ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="string"&gt;String
&lt;/h2&gt;&lt;p&gt;Redis çš„ String ç±»å‹æ˜¯æœ€åŸºç¡€ä¸”çµæ´»çš„æ•°æ®ç±»å‹ï¼Œæ”¯æŒå­˜å‚¨å­—ç¬¦ä¸²ã€æ•´æ•°ã€æµ®ç‚¹æ•°åŠäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€åºåˆ—åŒ–å¯¹è±¡ï¼‰ï¼Œæœ€å¤§å®¹é‡ä¸º &lt;strong&gt;512MB&lt;/strong&gt;ã€‚å…¶é«˜æ€§èƒ½å’Œçµæ´»æ€§æºäºåº•å±‚çš„ &lt;strong&gt;SDSï¼ˆç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼‰&lt;/strong&gt; ç»“æ„å’ŒåŠ¨æ€ç¼–ç ä¼˜åŒ–æœºåˆ¶ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç‰¹æ€§"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤šåŠŸèƒ½å­˜å‚¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒå­—ç¬¦ä¸²ã€æ•´æ•°ï¼ˆ&lt;code&gt;INCR&lt;/code&gt;/&lt;code&gt;DECR&lt;/code&gt; æ“ä½œï¼‰ã€æµ®ç‚¹æ•°ï¼ˆ&lt;code&gt;INCRBYFLOAT&lt;/code&gt;ï¼‰åŠäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰æ“ä½œï¼ˆå¦‚ &lt;code&gt;SET&lt;/code&gt;ã€&lt;code&gt;GET&lt;/code&gt;ã€&lt;code&gt;APPEND&lt;/code&gt;ï¼‰å‡ä¸º&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;ï¼Œç¡®ä¿å¹¶å‘å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ•ˆè¯»å†™&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;è¯»å–é•¿åº¦å¤æ‚åº¦ä¸º &lt;code&gt;O(1)&lt;/code&gt;ï¼ˆç›´æ¥è®¿é—® &lt;code&gt;len&lt;/code&gt; å±æ€§ï¼‰ï¼Œè€Œ C å­—ç¬¦ä¸²éœ€ &lt;code&gt;O(n)&lt;/code&gt; éå†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨ç±»å‹è½¬æ¢&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•´æ•°æ‰§è¡Œ &lt;code&gt;APPEND&lt;/code&gt; æ—¶è‡ªåŠ¨è½¬ä¸ºå­—ç¬¦ä¸²ï¼›å­—ç¬¦ä¸²æ‰§è¡Œ &lt;code&gt;INCR&lt;/code&gt; æ—¶å°è¯•è½¬ä¸ºæ•´æ•°ï¼ˆå¤±è´¥æŠ¥é”™ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°sdsç®€å•åŠ¨æ€å­—ç¬¦ä¸²"&gt;ğŸ§± &lt;strong&gt;åº•å±‚å®ç°ï¼šSDSï¼ˆç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;SDS æ˜¯ Redis è‡ªç ”çš„å­—ç¬¦ä¸²ç»“æ„ï¼Œè§£å†³äº† C å­—ç¬¦ä¸²çš„ç¼ºé™·ï¼ˆå¦‚ç¼“å†²åŒºæº¢å‡ºã€é•¿åº¦è®¡ç®—ä½æ•ˆï¼‰ï¼Œå…¶è®¾è®¡å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;h4 id="sds-ç»“æ„å®šä¹‰ä»¥"&gt;&lt;strong&gt;SDS ç»“æ„å®šä¹‰ï¼ˆä»¥ &lt;code&gt;sdshdr8&lt;/code&gt; ä¸ºä¾‹ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;struct __attribute__ ((__packed__)) sdshdr8 {
uint8_t len; // å·²ç”¨é•¿åº¦ï¼ˆä¸å«ç»“å°¾ `\0`ï¼‰
uint8_t alloc; // æ€»åˆ†é…ç©ºé—´ï¼ˆä¸å«ç»“å°¾ `\0`ï¼‰
unsigned char flags;// æ ‡è¯† SDS ç±»å‹ï¼ˆå¦‚ sdshdr8ï¼‰
char buf[]; // æŸ”æ€§æ•°ç»„ï¼Œå­˜å‚¨å®é™…æ•°æ®
};
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;äº”ç§ SDS ç±»å‹ï¼šæ ¹æ®å­—ç¬¦ä¸²é•¿åº¦åŠ¨æ€é€‰æ‹©å¤´ç±»å‹ï¼ŒèŠ‚çœå†…å­˜ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;sdshdr8&lt;/code&gt;&lt;/strong&gt;ï¼ˆâ‰¤256Bï¼‰ã€&lt;strong&gt;&lt;code&gt;sdshdr16&lt;/code&gt;&lt;/strong&gt;ï¼ˆâ‰¤64KBï¼‰ã€&lt;strong&gt;&lt;code&gt;sdshdr32&lt;/code&gt;&lt;/strong&gt;ï¼ˆâ‰¤4GBï¼‰ã€&lt;strong&gt;&lt;code&gt;sdshdr64&lt;/code&gt;&lt;/strong&gt;ï¼ˆâ‰¤16EBï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚çŸ­å­—ç¬¦ä¸²ç”¨ &lt;code&gt;sdshdr8&lt;/code&gt;ï¼Œå¤´ä»…å  3 å­—èŠ‚ï¼ˆ&lt;code&gt;len&lt;/code&gt;+&lt;code&gt;alloc&lt;/code&gt;+&lt;code&gt;flags&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="sds-çš„å…³é”®ä¼˜åŒ–"&gt;&lt;strong&gt;SDS çš„å…³é”®ä¼˜åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äºŒè¿›åˆ¶å®‰å…¨&lt;/strong&gt;ï¼š
é€šè¿‡ &lt;code&gt;len&lt;/code&gt; è€Œé &lt;code&gt;\0&lt;/code&gt; åˆ¤æ–­ç»“æŸï¼Œå¯å­˜å‚¨å« &lt;code&gt;\0&lt;/code&gt; çš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´é¢„åˆ†é…&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;æ‰©å®¹æ—¶ï¼šè‹¥æ–°é•¿åº¦ &amp;lt;1MBï¼Œåˆ†é… &lt;strong&gt;2å€æ–°é•¿åº¦ç©ºé—´&lt;/strong&gt;ï¼›è‹¥ â‰¥1MBï¼Œåˆ†é… &lt;strong&gt;æ–°é•¿åº¦+1MB&lt;/strong&gt; ç©ºé—´ã€‚
&lt;ul&gt;
&lt;li&gt;ä¾‹å¦‚åŸå­—ç¬¦ä¸² 60Bï¼Œè¿½åŠ  60B åæ€»å ç”¨ 180Bï¼ˆå«é¢„åˆ†é…ç©ºé—´ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒ°æ€§ç©ºé—´é‡Šæ”¾&lt;/strong&gt;ï¼š
ç¼©çŸ­å­—ç¬¦ä¸²æ—¶ä¸ç«‹å³å›æ”¶å†…å­˜ï¼Œä¿ç•™ç©ºé—´ä¾›åç»­æ“ä½œå¤ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç¼–ç æ–¹å¼ä¸å†…å­˜ä¼˜åŒ–"&gt;ğŸ”§ &lt;strong&gt;ç¼–ç æ–¹å¼ä¸å†…å­˜ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;String çš„å€¼å®é™…å­˜å‚¨åœ¨ &lt;strong&gt;RedisObject&lt;/strong&gt; ä¸­ï¼Œæ ¹æ®å†…å®¹åŠ¨æ€é€‰æ‹©ç¼–ç æ–¹å¼ä»¥èŠ‚çœå†…å­˜ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç¼–ç æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å†…å­˜å¸ƒå±€&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;int&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å€¼ä¸º 64 ä½æ•´æ•°ï¼ˆå¦‚ &lt;code&gt;SET num 100&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;RedisObject çš„ &lt;code&gt;ptr&lt;/code&gt; ç›´æ¥å­˜å‚¨æ•´æ•°&lt;/td&gt;
&lt;td&gt;æ— é¢å¤–æŒ‡é’ˆï¼ŒèŠ‚çœ 8 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;embstr&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²é•¿åº¦ â‰¤44 å­—èŠ‚ï¼ˆRedis 6+ï¼‰&lt;/td&gt;
&lt;td&gt;RedisObject + SDS è¿ç»­å­˜å‚¨ï¼ˆå•æ¬¡åˆ†é…ï¼‰&lt;/td&gt;
&lt;td&gt;å‡å°‘å†…å­˜ç¢ç‰‡ï¼Œè®¿é—®æ›´å¿«&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;raw&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²é•¿åº¦ &amp;gt;44 å­—èŠ‚&lt;/td&gt;
&lt;td&gt;RedisObject å’Œ SDS åˆ†ä¸¤å—å†…å­˜å­˜å‚¨&lt;/td&gt;
&lt;td&gt;æ”¯æŒå¤§å­—ç¬¦ä¸²ï¼Œé¿å…è¿ç»­å¤§å—å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SET age 30&lt;/code&gt; â†’ &lt;code&gt;int&lt;/code&gt; ç¼–ç ï¼ˆç›´æ¥å­˜æ•´æ•°ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SET name &amp;quot;Alice&amp;quot;&lt;/code&gt; â†’ &lt;code&gt;embstr&lt;/code&gt; ç¼–ç ï¼ˆçŸ­å­—ç¬¦ä¸²è¿ç»­å­˜å‚¨ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SET data &amp;quot;é•¿æ–‡æœ¬...&amp;quot;&lt;/code&gt;ï¼ˆ45Bï¼‰â†’ &lt;code&gt;raw&lt;/code&gt; ç¼–ç ï¼ˆåˆ†ç¦»å­˜å‚¨ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜æ€§èƒ½è®¾è®¡"&gt;âš¡ &lt;strong&gt;é«˜æ€§èƒ½è®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å‡å°‘å†…å­˜åˆ†é…æ¬¡æ•°
&lt;ul&gt;
&lt;li&gt;ç©ºé—´é¢„åˆ†é…å‡å°‘è¿ç»­ä¿®æ”¹æ—¶çš„å†…å­˜é‡åˆ†é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç´§å‡‘å†…å­˜å¸ƒå±€
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;embstr&lt;/code&gt; ç¼–ç å°†å…ƒæ•°æ®ä¸æ•°æ®è¿ç»­å­˜å‚¨ï¼Œæå‡ CPU ç¼“å­˜å‘½ä¸­ç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é¿å…ç¼“å†²åŒºæº¢å‡º
&lt;ul&gt;
&lt;li&gt;SDS æ“ä½œå‰æ£€æŸ¥ç©ºé—´ï¼Œä¸è¶³åˆ™æ‰©å®¹ï¼ˆC å­—ç¬¦ä¸²éœ€æ‰‹åŠ¨è®¡ç®—ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯"&gt;ğŸ’¡ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¼“å­˜&lt;/strong&gt;ï¼šå­˜å‚¨åºåˆ—åŒ–å¯¹è±¡ï¼ˆ&lt;code&gt;SET user:1 JSON&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¡æ•°å™¨&lt;/strong&gt;ï¼š&lt;code&gt;INCR&lt;/code&gt; å®ç°è®¿é—®é‡ç»Ÿè®¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼é”&lt;/strong&gt;ï¼š&lt;code&gt;SET lock 1 NX EX 30&lt;/code&gt;ï¼ˆåŸå­äº‰æŠ¢é”ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äºŒè¿›åˆ¶å­˜å‚¨&lt;/strong&gt;ï¼šå›¾ç‰‡ Base64 ç¼–ç åå­˜å…¥ï¼ˆ&lt;code&gt;SET image_data &amp;quot;...&amp;quot;&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å­˜å ç”¨åˆ†æ"&gt;âš ï¸ &lt;strong&gt;å†…å­˜å ç”¨åˆ†æ&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å­˜å‚¨é”®å€¼å¯¹æ—¶ï¼Œéœ€è€ƒè™‘ &lt;strong&gt;å…¨å±€å“ˆå¸Œè¡¨æ¡ç›®ï¼ˆ&lt;code&gt;dictEntry&lt;/code&gt;ï¼‰&lt;/strong&gt; çš„å¼€é”€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;dictEntry&lt;/code&gt; ç»“æ„&lt;/strong&gt;ï¼šå« 3 ä¸ªæŒ‡é’ˆï¼ˆ24 å­—èŠ‚ï¼‰ï¼Œä½† jemalloc æŒ‰ 32 å­—èŠ‚åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;æ€»å†…å­˜
= RedisObjectï¼ˆ16Bï¼‰ + SDS å¤´ + æ•°æ® +
&lt;pre tabindex="0"&gt;&lt;code&gt;dictEntry
&lt;/code&gt;&lt;/pre&gt;ï¼ˆ32Bï¼‰ã€‚
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Š &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šå­˜å‚¨ 16 å­—èŠ‚æ•´æ•°æ—¶ï¼Œæ€»å ç”¨ â‰ˆ 64Bï¼ˆRedisObject 8B + æ•´æ•° 8B + &lt;code&gt;dictEntry&lt;/code&gt; 32B + å¡«å……ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redis String çš„é«˜æ€§èƒ½æºäº &lt;strong&gt;SDS çš„åŠ¨æ€ä¼˜åŒ–&lt;/strong&gt; å’Œ &lt;strong&gt;æ™ºèƒ½ç¼–ç é€‰æ‹©&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å±‚é¢&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…³é”®æŠ€æœ¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;SDS åŠ¨æ€æ‰©å®¹ã€æƒ°æ€§é‡Šæ”¾&lt;/td&gt;
&lt;td&gt;é«˜æ•ˆå†…å­˜ç®¡ç†ï¼Œé¿å…æº¢å‡º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–ç ä¼˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;int&lt;/code&gt;/&lt;code&gt;embstr&lt;/code&gt;/&lt;code&gt;raw&lt;/code&gt; æŒ‰éœ€åˆ‡æ¢&lt;/td&gt;
&lt;td&gt;å‡å°‘ç¢ç‰‡ï¼Œæå‡å°å­—ç¬¦ä¸²æ€§èƒ½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ“ä½œ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;INCR&lt;/code&gt;ã€&lt;code&gt;APPEND&lt;/code&gt; ç­‰åŸå­å‘½ä»¤&lt;/td&gt;
&lt;td&gt;å¹¶å‘å®‰å…¨ï¼Œç®€åŒ–å¼€å‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;OBJECT ENCODING key&lt;/code&gt; å¯æŸ¥çœ‹é”®çš„ç¼–ç æ–¹å¼ï¼Œç»“åˆå®é™…åœºæ™¯è°ƒæ•´æ•°æ®è®¾è®¡ï¼ˆå¦‚çŸ­å­—ç¬¦ä¸²ä¼˜å…ˆç”¨ &lt;code&gt;embstr&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="sds"&gt;SDS
&lt;/h2&gt;&lt;p&gt;Redis SDSï¼ˆSimple Dynamic Stringï¼‰çš„å†…å­˜é¢„åˆ†é…å’Œæƒ°æ€§é‡Šæ”¾æ˜¯å…¶é«˜æ•ˆç®¡ç†å­—ç¬¦ä¸²å†…å­˜çš„æ ¸å¿ƒç­–ç•¥ï¼Œæ˜¾è‘—æå‡äº†å­—ç¬¦ä¸²æ“ä½œçš„æ€§èƒ½ã€‚ä»¥ä¸‹ä»åŸç†ã€å®ç°æœºåˆ¶åŠä¼˜åŠ¿ä¸‰æ–¹é¢è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å†…å­˜é¢„åˆ†é…space-preallocation"&gt;ğŸ“Š &lt;strong&gt;å†…å­˜é¢„åˆ†é…ï¼ˆSpace Preallocationï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒåŸç†"&gt;&lt;strong&gt;æ ¸å¿ƒåŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å½“SDSéœ€è¦æ‰©å®¹ï¼ˆå¦‚è¿½åŠ å­—ç¬¦ä¸²ï¼‰ä¸”å‰©ä½™ç©ºé—´ï¼ˆ&lt;code&gt;free&lt;/code&gt;ï¼‰ä¸è¶³æ—¶ï¼ŒRedisä¸ä»…åˆ†é…æ‰€éœ€ç©ºé—´ï¼Œè¿˜ä¼šé¢å¤–åˆ†é…é¢„ç•™ç©ºé—´ï¼Œä»¥å‡å°‘åç»­æ‰©å®¹æ¬¡æ•°&lt;a class="link" href="@ref" &gt;2,5,7&lt;/a&gt;ã€‚ç­–ç•¥è§„åˆ™å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é•¿åº¦ &amp;lt; 1MB&lt;/strong&gt;ï¼šåˆ†é… &lt;strong&gt;åŒå€&lt;/strong&gt; æ–°é•¿åº¦çš„ç©ºé—´ï¼ˆ&lt;code&gt;newlen * 2&lt;/code&gt;ï¼‰ã€‚
ç¤ºä¾‹ï¼šåŸå­—ç¬¦ä¸²é•¿ &lt;code&gt;13å­—èŠ‚&lt;/code&gt;ï¼Œè¿½åŠ åéœ€ &lt;code&gt;13å­—èŠ‚&lt;/code&gt;ï¼Œåˆ™åˆ†é… &lt;code&gt;13ï¼ˆæ–°å†…å®¹ï¼‰ + 13ï¼ˆé¢„ç•™ï¼‰ + 1ï¼ˆ\0ï¼‰ = 27å­—èŠ‚&lt;/code&gt;&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿åº¦ â‰¥ 1MB&lt;/strong&gt;ï¼šå›ºå®šåˆ†é… &lt;strong&gt;1MB&lt;/strong&gt; é¢„ç•™ç©ºé—´ã€‚
ç¤ºä¾‹ï¼šæ–°é•¿åº¦ &lt;code&gt;30MB&lt;/code&gt;ï¼Œåˆ™åˆ†é… &lt;code&gt;30MBï¼ˆæ–°å†…å®¹ï¼‰ + 1MBï¼ˆé¢„ç•™ï¼‰ + 1å­—èŠ‚ï¼ˆ\0ï¼‰&lt;/code&gt;&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æºç å®ç°"&gt;&lt;strong&gt;æºç å®ç°&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æ‰©å®¹é€»è¾‘ä½äº &lt;code&gt;sdsMakeRoomFor&lt;/code&gt; å‡½æ•°ä¸­&lt;a class="link" href="@ref" &gt;2,7&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;if (newlen &amp;lt; SDS_MAX_PREALLOC) // SDS_MAX_PREALLOC = 1MB
newlen *= 2; // æ–°é•¿åº¦ &amp;lt; 1MBï¼ŒåŒå€æ‰©å®¹
else
newlen += SDS_MAX_PREALLOC; // æ–°é•¿åº¦ â‰¥ 1MBï¼Œä»…åŠ  1MB
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä¼˜åŠ¿"&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘å†…å­˜é‡åˆ†é…æ¬¡æ•°&lt;/strong&gt;ï¼šè¿ç»­Næ¬¡æ‰©å®¹æ“ä½œï¼Œå†…å­˜åˆ†é…æ¬¡æ•°ä» &lt;strong&gt;O(N) é™è‡³ O(logN)&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é¢‘ç¹ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;ï¼šå†…å­˜åˆ†é…æ¶‰åŠç³»ç»Ÿè°ƒç”¨ï¼Œé¢„åˆ†é…é™ä½å¼€é”€ï¼Œæå‡æ€§èƒ½&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æƒ°æ€§ç©ºé—´é‡Šæ”¾lazy-space-free"&gt;â³ &lt;strong&gt;æƒ°æ€§ç©ºé—´é‡Šæ”¾ï¼ˆLazy Space Freeï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒåŸç†-1"&gt;&lt;strong&gt;æ ¸å¿ƒåŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å½“SDSç¼©çŸ­ï¼ˆå¦‚æˆªæ–­å­—ç¬¦ä¸²ï¼‰æ—¶ï¼ŒRedis &lt;strong&gt;ä¸ç«‹å³å›æ”¶å¤šä½™å†…å­˜&lt;/strong&gt;ï¼Œè€Œæ˜¯å°†å¤šä½™ç©ºé—´è®°å½•åœ¨ &lt;code&gt;free&lt;/code&gt; å±æ€§ä¸­ï¼Œä¾›åç»­æ“ä½œå¤ç”¨&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚
ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸå­—ç¬¦ä¸² &lt;code&gt;&amp;quot;Hello, World&amp;quot;&lt;/code&gt;ï¼ˆ&lt;code&gt;len=12&lt;/code&gt;ï¼‰ï¼Œç¼©çŸ­ä¸º &lt;code&gt;&amp;quot;Hello&amp;quot;&lt;/code&gt;ï¼ˆ&lt;code&gt;len=5&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ“ä½œåï¼š&lt;code&gt;len=5&lt;/code&gt;ï¼Œ&lt;code&gt;free=19&lt;/code&gt;ï¼ˆåŸæ€»ç©ºé—´ &lt;code&gt;12+12+1=25&lt;/code&gt;ï¼Œå‡å» &lt;code&gt;len+1=6&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç©ºé—´å›æ”¶æ—¶æœº"&gt;&lt;strong&gt;ç©ºé—´å›æ”¶æ—¶æœº&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Redis ä»…åœ¨æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ä¸»åŠ¨å›æ”¶ç©ºé—´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;free &amp;gt; len / 10&lt;/code&gt;&lt;/strong&gt;ï¼ˆé¢„ç•™ç©ºé—´è¶…è¿‡å·²ç”¨ç©ºé—´çš„10%ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§¦å‘åœºæ™¯ï¼šå¦‚å®¢æˆ·ç«¯æ˜¾å¼è°ƒç”¨ &lt;code&gt;sdsRemoveFreeSpace()&lt;/code&gt;ï¼Œæˆ–å†…éƒ¨å®šæ—¶ä»»åŠ¡&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¼˜åŠ¿-1"&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¿å…é¢‘ç¹å†…å­˜å›æ”¶&lt;/strong&gt;ï¼šç¼©çŸ­æ“ä½œæ— éœ€ç«‹å³é‡Šæ”¾å†…å­˜ï¼Œå‡å°‘ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¯æŒå¿«é€Ÿæ‰©å±•&lt;/strong&gt;ï¼šåç»­è¿½åŠ æ“ä½œå¯ç›´æ¥å¤ç”¨ &lt;code&gt;free&lt;/code&gt; ç©ºé—´ï¼Œé¿å…é‡æ–°åˆ†é…&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é¢„åˆ†é…ä¸æƒ°æ€§é‡Šæ”¾çš„ååŒä¼˜åŠ¿"&gt;âš–ï¸ &lt;strong&gt;é¢„åˆ†é…ä¸æƒ°æ€§é‡Šæ”¾çš„ååŒä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å†…å­˜æ“ä½œæ¬¡æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;é¢„åˆ†é…&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²å¢é•¿&lt;/td&gt;
&lt;td&gt;ä» O(N) â†’ O(logN)&lt;/td&gt;
&lt;td&gt;å†™æ“ä½œååé‡æå‡ 200%+&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æƒ°æ€§é‡Šæ”¾&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²ç¼©çŸ­&lt;/td&gt;
&lt;td&gt;ä» O(N) â†’ O(1)&lt;/td&gt;
&lt;td&gt;é¿å…å†™æ“ä½œå»¶è¿ŸæŠ–åŠ¨&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="å®é™…æ•ˆæœ"&gt;&lt;strong&gt;å®é™…æ•ˆæœ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘åœºæ™¯&lt;/strong&gt;ï¼šé¢‘ç¹ä¿®æ”¹å­—ç¬¦ä¸²æ—¶ï¼ˆå¦‚ç¼“å­˜æ›´æ–°ã€æ—¥å¿—è¿½åŠ ï¼‰ï¼Œå†…å­˜æ“ä½œå¼€é”€é™ä½ 60% ä»¥ä¸Š&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜åˆ©ç”¨ç‡&lt;/strong&gt;ï¼šé¢„ç•™ç©ºé—´é€šå¸¸æ§åˆ¶åœ¨ 10% ä»¥å†…ï¼Œé¿å…è¿‡åº¦æµªè´¹&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-1"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¢„åˆ†é…&lt;/strong&gt;ï¼šä»¥ç©ºé—´æ¢æ—¶é—´ï¼Œé€šè¿‡&lt;strong&gt;åŠ å€/å›ºå®šé¢„ç•™ç­–ç•¥&lt;/strong&gt;å‡å°‘æ‰©å®¹é¢‘ç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒ°æ€§é‡Šæ”¾&lt;/strong&gt;ï¼šä»¥æ—¶é—´æ¢æ•ˆç‡ï¼Œé€šè¿‡&lt;strong&gt;å»¶è¿Ÿå›æ”¶&lt;/strong&gt;é¿å…ç¼©çŸ­æ“ä½œçš„å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ååŒä»·å€¼&lt;/strong&gt;ï¼šäºŒè€…ç»“åˆä½¿ SDS åœ¨é¢‘ç¹ä¿®æ”¹åœºæ™¯ä¸‹ï¼Œå†…å­˜æ“ä½œå¤æ‚åº¦ä» &lt;strong&gt;O(NÂ²) é™è‡³ O(N)&lt;/strong&gt;ï¼Œæˆä¸º Redis é«˜æ€§èƒ½å­—ç¬¦ä¸²å¤„ç†çš„åŸºçŸ³&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡å‘½ä»¤ &lt;code&gt;MEMORY USAGE key&lt;/code&gt; å¯è§‚å¯Ÿ SDS å†…å­˜å ç”¨ï¼Œç»“åˆ &lt;code&gt;free&lt;/code&gt; ä¸ &lt;code&gt;len&lt;/code&gt; æ¯”ä¾‹è°ƒæ•´ä¸šåŠ¡é€»è¾‘ï¼Œå¯è¿›ä¸€æ­¥ä¼˜åŒ–å†…å­˜æ•ˆç‡ ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ziplist"&gt;ziplist
&lt;/h2&gt;&lt;p&gt;Redis ä¸­çš„ &lt;strong&gt;Ziplistï¼ˆå‹ç¼©åˆ—è¡¨ï¼‰&lt;/strong&gt; æ˜¯ä¸€ç§ä¸ºæè‡´èŠ‚çœå†…å­˜è€Œè®¾è®¡çš„ç´§å‡‘å‹æ•°æ®ç»“æ„ï¼Œæ›¾å¹¿æ³›åº”ç”¨äºå“ˆå¸Œï¼ˆHashï¼‰ã€åˆ—è¡¨ï¼ˆListï¼‰å’Œæœ‰åºé›†åˆï¼ˆZsetï¼‰çš„åº•å±‚å®ç°ï¼ˆRedis 7.0 åè¢« Listpack å–ä»£ï¼‰ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡&lt;strong&gt;è¿ç»­å†…å­˜å¸ƒå±€&lt;/strong&gt;å’Œ&lt;strong&gt;å˜é•¿ç¼–ç &lt;/strong&gt;å‡å°‘æŒ‡é’ˆä¸å…ƒæ•°æ®å¼€é”€ã€‚ä»¥ä¸‹ä»ç»“æ„è®¾è®¡ã€æ“ä½œé€»è¾‘ã€åº”ç”¨åœºæ™¯åŠæ¼”è¿›ä¼˜åŒ–å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç»“æ„è®¾è®¡"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒç»“æ„è®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ•´ä½“å¸ƒå±€"&gt;&lt;strong&gt;æ•´ä½“å¸ƒå±€&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Ziplist ç”±è¿ç»­å†…å­˜å—ç»„æˆï¼Œç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;| zlbytes (4B) | zltail (4B) | zllen (2B) | entry1 | ... | entryN | zlend (1B) |
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;zlbytes&lt;/strong&gt;ï¼š32 ä½æ— ç¬¦å·æ•´æ•°ï¼Œè®°å½•æ•´ä¸ª Ziplist å ç”¨çš„å­—èŠ‚æ•°ï¼ˆå«è‡ªèº«ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;zltail&lt;/strong&gt;ï¼š32 ä½æ— ç¬¦å·æ•´æ•°ï¼ŒæŒ‡å‘æœ€åä¸€ä¸ª entry çš„åç§»é‡ï¼Œæ”¯æŒ O(1) å°¾éƒ¨æ“ä½œï¼ˆå¦‚ &lt;code&gt;RPOP&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;zllen&lt;/strong&gt;ï¼š16 ä½æ— ç¬¦å·æ•´æ•°ï¼Œå­˜å‚¨ entry æ•°é‡ã€‚è‹¥æ•°é‡ â‰¥ 65535ï¼Œå€¼å›ºå®šä¸º 65535ï¼Œéœ€éå†è·å–å®é™…æ•°é‡&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;zlend&lt;/strong&gt;ï¼šå›ºå®šå€¼ &lt;code&gt;0xFF&lt;/code&gt;ï¼ˆ255ï¼‰ï¼Œæ ‡è¯†ç»“æŸä½ç½®&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="entry-èŠ‚ç‚¹ç»“æ„"&gt;&lt;strong&gt;Entry èŠ‚ç‚¹ç»“æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æ¯ä¸ª entry ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;| prevlen (1/5B) | encoding (1~5B) | content (å˜é•¿) |
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;prevlenï¼š
&lt;ul&gt;
&lt;li&gt;å‰é©±èŠ‚ç‚¹é•¿åº¦ â‰¤ 253 å­—èŠ‚ï¼š&lt;code&gt;prevlen&lt;/code&gt; å  &lt;strong&gt;1 å­—èŠ‚&lt;/strong&gt;ï¼ˆå€¼ = é•¿åº¦ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å‰é©±é•¿åº¦ â‰¥ 254 å­—èŠ‚ï¼š&lt;code&gt;prevlen&lt;/code&gt; å  &lt;strong&gt;5 å­—èŠ‚&lt;/strong&gt;ï¼ˆé¦–å­—èŠ‚ä¸º &lt;code&gt;0xFE&lt;/code&gt;ï¼Œå 4 å­—èŠ‚ä¸ºå®é™…é•¿åº¦ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;encodingï¼šåŠ¨æ€ç¼–ç æ•°æ®ç±»å‹ä¸é•¿åº¦ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼–ç æ ¼å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é•¿åº¦èŒƒå›´&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;çŸ­å­—ç¬¦ä¸²&lt;/td&gt;
&lt;td&gt;&lt;code&gt;00xxxxxx&lt;/code&gt;ï¼ˆ6 ä½é•¿åº¦ï¼‰&lt;/td&gt;
&lt;td&gt;â‰¤ 63 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸­å­—ç¬¦ä¸²&lt;/td&gt;
&lt;td&gt;&lt;code&gt;01xxxxxx xxxxxxxx&lt;/code&gt;ï¼ˆ14 ä½é•¿åº¦ï¼‰&lt;/td&gt;
&lt;td&gt;â‰¤ 16383 å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é•¿å­—ç¬¦ä¸²&lt;/td&gt;
&lt;td&gt;&lt;code&gt;10000000 xxxxxxxx ...&lt;/code&gt;ï¼ˆ32 ä½é•¿åº¦ï¼‰&lt;/td&gt;
&lt;td&gt;â‰¤ 4GB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å°æ•´æ•°&lt;/td&gt;
&lt;td&gt;&lt;code&gt;1111xxxx&lt;/code&gt;ï¼ˆxxxx âˆˆ [1,13]ï¼‰&lt;/td&gt;
&lt;td&gt;å€¼ = &lt;code&gt;xxxx-1&lt;/code&gt;ï¼ˆ0~12ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ•´æ•°&lt;/td&gt;
&lt;td&gt;&lt;code&gt;11xxxxxx&lt;/code&gt;ï¼ˆåè·Ÿ 1/2/3/4/8 å­—èŠ‚æ•°æ®ï¼‰&lt;/td&gt;
&lt;td&gt;int8/int16/&amp;hellip;/int64&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;content&lt;/strong&gt;ï¼šå­˜å‚¨å®é™…æ•°æ®ï¼ˆæ•´æ•°ç±»å‹æ— ç‹¬ç«‹ contentï¼Œå€¼ç›´æ¥åµŒå…¥ encodingï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æ“ä½œä¸æ€§èƒ½ç‰¹æ€§"&gt;âš™ï¸ &lt;strong&gt;å…³é”®æ“ä½œä¸æ€§èƒ½ç‰¹æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="è¯»å†™æ“ä½œ"&gt;&lt;strong&gt;è¯»å†™æ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æŸ¥è¯¢ï¼š
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹æ•°é‡ï¼š&lt;code&gt;zllen &amp;lt; 65535&lt;/code&gt; æ—¶ O(1)ï¼Œå¦åˆ™ O(N) éå†&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æŒ‰ç´¢å¼•å®šä½ï¼šéœ€éå†æ‰€æœ‰ entryï¼Œå¹³å‡ O(N)&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ’å…¥/åˆ é™¤ï¼š
&lt;ul&gt;
&lt;li&gt;å¤´éƒ¨/ä¸­éƒ¨æ“ä½œéœ€ç§»åŠ¨åç»­æ•°æ®ï¼Œå¹³å‡ O(N)&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å°¾éƒ¨æ“ä½œå€ŸåŠ© &lt;code&gt;zltail&lt;/code&gt; å¯ä¼˜åŒ–è‡³ O(1)&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è¿é”æ›´æ–°cascade-update"&gt;&lt;strong&gt;è¿é”æ›´æ–°ï¼ˆCascade Updateï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;è§¦å‘æ¡ä»¶ï¼š
æ’å…¥æˆ–åˆ é™¤èŠ‚ç‚¹å¯¼è‡´åç»­èŠ‚ç‚¹çš„
&lt;pre tabindex="0"&gt;&lt;code&gt;prevlen
&lt;/code&gt;&lt;/pre&gt;é•¿åº¦å˜åŒ–ï¼ˆ1B â†” 5Bï¼‰ã€‚ä¾‹å¦‚ï¼š
&lt;blockquote&gt;
&lt;p&gt;åŸèŠ‚ç‚¹é•¿åº¦å‡ä¸º 250Bï¼ˆ&lt;code&gt;prevlen=1B&lt;/code&gt;ï¼‰â†’ å¤´éƒ¨æ’å…¥ 300B èŠ‚ç‚¹ â†’ åç»­èŠ‚ç‚¹ &lt;code&gt;prevlen&lt;/code&gt; éœ€æ‰©å±•ä¸º 5B â†’ èŠ‚ç‚¹æ€»é•¿è¶…è¿‡ 254B â†’ è¿é”è§¦å‘åç»­èŠ‚ç‚¹æ›´æ–°&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚åº¦&lt;/strong&gt;ï¼šæœ€å O(NÂ²)ï¼Œä½†å®é™…å‘ç”Ÿæ¦‚ç‡æä½ï¼ˆéœ€è¿ç»­å¤šä¸ª 250~253B èŠ‚ç‚¹ï¼‰&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å†…å­˜ç®¡ç†"&gt;&lt;strong&gt;å†…å­˜ç®¡ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€æ‰©å®¹&lt;/strong&gt;ï¼šæ¯æ¬¡ä¿®æ”¹å‡å¯èƒ½è§¦å‘ &lt;code&gt;realloc&lt;/code&gt; é‡æ–°åˆ†é…å†…å­˜&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¢ç‰‡æ§åˆ¶&lt;/strong&gt;ï¼šç´§å‡‘å¸ƒå±€å‡å°‘å†…å­˜ç¢ç‰‡ï¼Œä½†é¢‘ç¹æ›´æ–°å¯èƒ½äº§ç”Ÿç©ºæ´&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯ä¸é…ç½®"&gt;ğŸ“Š &lt;strong&gt;åº”ç”¨åœºæ™¯ä¸é…ç½®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é€‚ç”¨æ•°æ®ç±»å‹"&gt;&lt;strong&gt;é€‚ç”¨æ•°æ®ç±»å‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Hash&lt;/strong&gt;ï¼šé”®å€¼å¯¹æ•°é‡ â‰¤ &lt;code&gt;hash-max-ziplist-entries&lt;/code&gt;ï¼ˆé»˜è®¤ 512ï¼‰ï¼Œä¸”é”®å€¼é•¿åº¦ â‰¤ &lt;code&gt;hash-max-ziplist-value&lt;/code&gt;ï¼ˆé»˜è®¤ 64Bï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Zset&lt;/strong&gt;ï¼šå…ƒç´ æ•°é‡ â‰¤ &lt;code&gt;zset-max-ziplist-entries&lt;/code&gt;ï¼ˆé»˜è®¤ 128ï¼‰ï¼Œä¸”æˆå‘˜é•¿åº¦ â‰¤ &lt;code&gt;zset-max-ziplist-value&lt;/code&gt;ï¼ˆé»˜è®¤ 64Bï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;List&lt;/strong&gt;ï¼ˆRedis 7.0 å‰ï¼‰ï¼šå°è§„æ¨¡åˆ—è¡¨ä¼˜å…ˆä½¿ç”¨ Ziplist è€Œé LinkedList&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å…¸å‹ç”¨ä¾‹"&gt;&lt;strong&gt;å…¸å‹ç”¨ä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å­˜å‚¨çŸ­é…ç½®ä¿¡æ¯ï¼ˆå¦‚ Redis å“ˆå¸Œå­˜å‚¨ç”¨æˆ·ä¼šè¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°è½»é‡çº§é˜Ÿåˆ—ï¼ˆå°‘é‡å…ƒç´ çš„ Listï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ç¼ºé™·ä¸æ¼”è¿›æ›¿ä»£"&gt;âš ï¸ &lt;strong&gt;ç¼ºé™·ä¸æ¼”è¿›æ›¿ä»£&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å›ºæœ‰ç¼ºé™·"&gt;&lt;strong&gt;å›ºæœ‰ç¼ºé™·&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½ä¸ç¨³å®š&lt;/strong&gt;ï¼šè¿é”æ›´æ–°å¯¼è‡´æç«¯åœºæ™¯å»¶è¿Ÿé™¡å¢&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹é‡é™åˆ¶&lt;/strong&gt;ï¼šå•ä¸ª entry æœ€å¤§ 64KBï¼Œæ•´ä¸ª Ziplist æœ€å¤§ 512MB&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éå†æ•ˆç‡ä½&lt;/strong&gt;ï¼šé•¿åˆ—è¡¨æŸ¥è¯¢æ€§èƒ½å·®&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="listpackziplist-çš„ç»§ä»»è€…"&gt;&lt;strong&gt;Listpackï¼šZiplist çš„ç»§ä»»è€…&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ”¹è¿›ç‚¹ï¼š
&lt;ul&gt;
&lt;li&gt;ç§»é™¤ &lt;code&gt;prevlen&lt;/code&gt;ï¼Œæ”¹ç”¨ &lt;strong&gt;element-tot-len&lt;/strong&gt;ï¼ˆè®°å½•å½“å‰èŠ‚ç‚¹æ€»é•¿ï¼Œå«è‡ªèº«ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;strong&gt;å˜é•¿å­—èŠ‚+ç»“æŸæ ‡å¿—ä½&lt;/strong&gt;ï¼ˆé«˜ä½ 0/1ï¼‰å®ç°åå‘éå†ï¼Œå½»åº•è§„é¿è¿é”æ›´æ–°&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨&lt;/strong&gt;ï¼šRedis 7.0 åå…¨é¢æ›¿ä»£ Ziplist&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-2"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Ziplist é€šè¿‡ &lt;strong&gt;è¿ç»­å†…å­˜+å˜é•¿ç¼–ç &lt;/strong&gt; åœ¨ç‰¹å®šåœºæ™¯ä¸‹æ˜¾è‘—èŠ‚çœå†…å­˜ï¼ˆè¾ƒ LinkedList å‡å°‘ 50%+ï¼‰ï¼Œæ˜¯å°æ•°æ®å­˜å‚¨çš„é«˜æ•ˆè§£å†³æ–¹æ¡ˆã€‚å…¶è®¾è®¡ç²¾é«“åœ¨äºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å‹ç¼©&lt;/strong&gt;ï¼šåŠ¨æ€ç¼–ç ã€æ•´æ•°å†…åµŒã€çœç•¥æŒ‡é’ˆ&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°¾éƒ¨ä¼˜åŒ–&lt;/strong&gt;ï¼š&lt;code&gt;zltail&lt;/code&gt; æ”¯æŒå¿«é€Ÿç«¯æ“ä½œ&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒå‘éå†&lt;/strong&gt;ï¼š&lt;code&gt;prevlen&lt;/code&gt; å®ç°åå‘è¿­ä»£ï¼ˆä»£ä»·æ˜¯è¿é”æ›´æ–°é£é™©ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;ï¼šåœ¨ Redis â‰¤ 6.x ç‰ˆæœ¬ä¸­ï¼Œåˆç†é…ç½® &lt;code&gt;*-max-ziplist-*&lt;/code&gt; å‚æ•°ï¼›å‡çº§è‡³ Redis 7.0+ å¯è‡ªåŠ¨äº«å— Listpack çš„ä¼˜åŒ–æ”¶ç›Š ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="prevlen"&gt;prevlen
&lt;/h2&gt;&lt;p&gt;Redis çš„ &lt;code&gt;ziplist&lt;/code&gt; ä¸­ &lt;code&gt;prevlen&lt;/code&gt; å­—æ®µé‡‡ç”¨ &lt;strong&gt;1 å­—èŠ‚æˆ– 5 å­—èŠ‚çš„å˜é•¿è®¾è®¡&lt;/strong&gt;ï¼Œæ ¸å¿ƒç›®çš„æ˜¯åœ¨&lt;strong&gt;ç©ºé—´æ•ˆç‡&lt;/strong&gt;å’Œ&lt;strong&gt;åŠŸèƒ½å®ç°&lt;/strong&gt;ä¹‹é—´å–å¾—å¹³è¡¡ã€‚å…·ä½“åŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡ç›®æ ‡ç©ºé—´å‹ç¼©ä¸åŒå‘éå†"&gt;ğŸ” &lt;strong&gt;è®¾è®¡ç›®æ ‡ï¼šç©ºé—´å‹ç¼©ä¸åŒå‘éå†&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´å‹ç¼©éœ€æ±‚&lt;/strong&gt;ï¼š&lt;code&gt;ziplist&lt;/code&gt; æ˜¯å†…å­˜ç´§å‡‘å‹æ•°æ®ç»“æ„ï¼Œéœ€æœ€å°åŒ–å…ƒæ•°æ®ï¼ˆå¦‚æŒ‡é’ˆã€é•¿åº¦å­—æ®µï¼‰çš„å ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒå‘éå†æ”¯æŒ&lt;/strong&gt;ï¼š&lt;code&gt;prevlen&lt;/code&gt; è®°å½•å‰ä¸€é¡¹çš„é•¿åº¦ï¼Œä½¿ç¨‹åºèƒ½é€šè¿‡ &lt;code&gt;å½“å‰åœ°å€ - prevlen&lt;/code&gt; å¿«é€Ÿå®šä½å‰ä¸€èŠ‚ç‚¹ï¼Œå®ç°å€’åºéå†&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-15å­—èŠ‚å˜é•¿çš„å¿…è¦æ€§"&gt;âš™ï¸ &lt;strong&gt;1/5å­—èŠ‚å˜é•¿çš„å¿…è¦æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å°é•¿åº¦ä¼˜åŒ–1å­—èŠ‚"&gt;&lt;strong&gt;å°é•¿åº¦ä¼˜åŒ–ï¼ˆ1å­—èŠ‚ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè‹¥å‰ä¸€èŠ‚ç‚¹é•¿åº¦ â‰¤ 253 å­—èŠ‚ï¼ˆ&lt;code&gt;0xFD&lt;/code&gt;ï¼‰ï¼Œ&lt;code&gt;prevlen&lt;/code&gt; ä»…éœ€ &lt;strong&gt;1 å­—èŠ‚&lt;/strong&gt;å­˜å‚¨é•¿åº¦å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´èŠ‚çœ&lt;/strong&gt;ï¼šå¤šæ•°åœºæ™¯ä¸‹ï¼Œç›¸é‚»èŠ‚ç‚¹é•¿åº¦è¾ƒå°ï¼ˆå¦‚çŸ­å­—ç¬¦ä¸²ã€å°æ•´æ•°ï¼‰ï¼Œ1 å­—èŠ‚å¯è¦†ç›–å¸¸è§æƒ…å†µï¼Œé¿å…å›ºå®š4å­—èŠ‚çš„æµªè´¹&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤§é•¿åº¦å…¼å®¹5å­—èŠ‚"&gt;&lt;strong&gt;å¤§é•¿åº¦å…¼å®¹ï¼ˆ5å­—èŠ‚ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ä¸´ç•Œå€¼è®¾å®šï¼šé•¿åº¦ â‰¥ 254 å­—èŠ‚æ—¶ï¼Œprevlen æ‰©å±•ä¸º 5 å­—èŠ‚ï¼š
&lt;ul&gt;
&lt;li&gt;é¦–å­—èŠ‚ä¸ºæ ‡å¿—ä½ &lt;code&gt;0xFE&lt;/code&gt;ï¼ˆ254ï¼‰ï¼Œæ ‡è¯†â€œå¤§é•¿åº¦æ¨¡å¼â€ã€‚&lt;/li&gt;
&lt;li&gt;å4å­—èŠ‚å­˜å‚¨å®é™…é•¿åº¦ï¼ˆæœ€å¤§æ”¯æŒ 4GBï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å…å†²çª&lt;/strong&gt;ï¼šå€¼ &lt;code&gt;0xFF&lt;/code&gt;ï¼ˆ255ï¼‰ä¿ç•™ç»™ &lt;code&gt;zlend&lt;/code&gt;ï¼ˆåˆ—è¡¨ç»“æŸæ ‡å¿—ï¼‰ï¼Œå› æ­¤é€‰ç”¨ 254 ä½œä¸ºåˆ†ç•Œç‚¹&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç©ºé—´æ•ˆç‡å¯¹æ¯”"&gt;&lt;strong&gt;ç©ºé—´æ•ˆç‡å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‰ä¸€é¡¹é•¿åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å›ºå®š4å­—èŠ‚æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å˜é•¿1/5å­—èŠ‚æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;èŠ‚çœæ•ˆæœ&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;5å­—èŠ‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;4å­—èŠ‚ï¼ˆæµªè´¹3å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;1å­—èŠ‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;èŠ‚çœ75%ç©ºé—´&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;300å­—èŠ‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;4å­—èŠ‚ï¼ˆä¸è¶³ï¼‰&lt;/td&gt;
&lt;td&gt;5å­—èŠ‚&lt;/td&gt;
&lt;td&gt;å¤š1å­—èŠ‚ï¼Œä½†å¯æ¥å—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;10å­—èŠ‚&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;4å­—èŠ‚ï¼ˆæµªè´¹3å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;1å­—èŠ‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;èŠ‚çœ75%ç©ºé—´&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨å­˜å‚¨å¤§é‡å°å¯¹è±¡çš„åœºæ™¯ï¼ˆå¦‚çŸ­å­—ç¬¦ä¸²ã€é…ç½®é¡¹ï¼‰ï¼Œå˜é•¿è®¾è®¡æ˜¾è‘—å‡å°‘å†…å­˜å ç”¨&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å‰¯ä½œç”¨è¿é”æ›´æ–°cascade-update"&gt;âš ï¸ &lt;strong&gt;å‰¯ä½œç”¨ï¼šè¿é”æ›´æ–°ï¼ˆCascade Updateï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å°½ç®¡å˜é•¿è®¾è®¡èŠ‚çœç©ºé—´ï¼Œä½†ä¹Ÿå¼•å…¥&lt;strong&gt;è¿é”æ›´æ–°é£é™©&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åœ¨é•¿åº¦æ¥è¿‘ 253 å­—èŠ‚çš„èŠ‚ç‚¹ä¹‹é—´æ’å…¥æ–°èŠ‚ç‚¹ï¼ˆé•¿åº¦ â‰¥ 254 å­—èŠ‚ï¼‰æ—¶ï¼Œåä¸€èŠ‚ç‚¹çš„ &lt;code&gt;prevlen&lt;/code&gt; éœ€ä» 1 å­—èŠ‚æ‰©å±•ä¸º 5 å­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥åç»­èŠ‚ç‚¹åŸé•¿åº¦ä¹Ÿæ¥è¿‘ 253 å­—èŠ‚ï¼Œæ‰©å±•åè‡ªèº«é•¿åº¦è¶…è¿‡ 253 å­—èŠ‚ï¼Œä¼šè¿›ä¸€æ­¥è§¦å‘å…¶åèŠ‚ç‚¹çš„ &lt;code&gt;prevlen&lt;/code&gt; æ‰©å±•ï¼Œå½¢æˆè¿é”ååº”&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æœ€åæ—¶é—´å¤æ‚åº¦è¾¾ O(NÂ²)ï¼Œä½†å› éœ€è¿ç»­å¤šä¸ªé•¿åº¦åœ¨ 250~253 å­—èŠ‚çš„èŠ‚ç‚¹ï¼Œå®é™…å‘ç”Ÿæ¦‚ç‡æä½ã€‚&lt;/li&gt;
&lt;li&gt;Redis é€šè¿‡&lt;strong&gt;æƒ°æ€§æ›´æ–°&lt;/strong&gt;ä¼˜åŒ–ï¼šä»…å¤„ç†åˆ°é¦–ä¸ªæ— éœ€æ‰©å±•çš„èŠ‚ç‚¹å³åœæ­¢&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“æƒè¡¡çš„è‰ºæœ¯"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“ï¼šæƒè¡¡çš„è‰ºæœ¯&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;prevlen&lt;/code&gt; çš„ 1/5 å­—èŠ‚å˜é•¿è®¾è®¡æœ¬è´¨æ˜¯ &lt;strong&gt;â€œä»¥è½»å¾®å¤æ‚åº¦æ¢å–æè‡´ç©ºé—´ä¼˜åŒ–â€&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´ä¼˜å…ˆ&lt;/strong&gt;ï¼šå¯¹å°å¯¹è±¡ï¼ˆå å¤šæ•°åœºæ™¯ï¼‰èŠ‚çœ 3 å­—èŠ‚/é¡¹ï¼Œæ•´ä½“å†…å­˜é™ä½æ˜¾è‘—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½å®Œå¤‡&lt;/strong&gt;ï¼šæ”¯æŒ O(1) å°¾éƒ¨æ“ä½œï¼ˆå€ŸåŠ© &lt;code&gt;zltail&lt;/code&gt;ï¼‰å’ŒåŒå‘éå†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯æ§ä»£ä»·&lt;/strong&gt;ï¼šè¿é”æ›´æ–°åœ¨æç«¯åœºæ™¯æ‰è§¦å‘ï¼Œä¸”åç»­æ”¹è¿›ï¼ˆå¦‚ Redis 7.0 çš„ Listpackï¼‰å·²å½»åº•è§£å†³è¯¥é—®é¢˜&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸€è®¾è®¡ä½“ç°äº† Redis å¯¹&lt;strong&gt;å†…å­˜æ•ˆç‡çš„æè‡´è¿½æ±‚&lt;/strong&gt;ï¼Œä¹Ÿæ˜¯å…¶åœ¨å°æ•°æ®åœºæ™¯æ€§èƒ½é¢†å…ˆçš„å…³é”®ç»†èŠ‚ ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="listpack"&gt;listpack
&lt;/h2&gt;&lt;p&gt;Listpack æ˜¯ Redis ä¸ºä¼˜åŒ–å†…å­˜æ•ˆç‡å’Œæ“ä½œç¨³å®šæ€§è€Œè®¾è®¡çš„ç´§å‡‘å‹æ•°æ®ç»“æ„ï¼Œäº Redis 5.0 å¼•å…¥ï¼Œå¹¶åœ¨ 7.0 ä¸­å®Œå…¨å–ä»£ ziplistï¼Œæˆä¸ºå°å‹é›†åˆï¼ˆHashã€Listã€Sorted Setï¼‰çš„é»˜è®¤åº•å±‚å®ç°ã€‚ä»¥ä¸‹ä»è®¾è®¡ç›®æ ‡ã€ç»“æ„åŸç†ã€æ€§èƒ½ç‰¹ç‚¹åˆ°åº”ç”¨åœºæ™¯å±•å¼€è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="è®¾è®¡èƒŒæ™¯ä¸æ ¸å¿ƒç›®æ ‡"&gt;&lt;strong&gt;è®¾è®¡èƒŒæ™¯ä¸æ ¸å¿ƒç›®æ ‡&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³ ziplist çš„ç¼ºé™·&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çº§è”æ›´æ–°é—®é¢˜&lt;/strong&gt;ï¼šziplist çš„æ¯ä¸ªèŠ‚ç‚¹è®°å½•å‰é©±èŠ‚ç‚¹é•¿åº¦ï¼Œå½“ä¸­é—´èŠ‚ç‚¹é•¿åº¦å˜åŒ–æ—¶ï¼Œåç»­èŠ‚ç‚¹éœ€è¿é”æ›´æ–°é•¿åº¦å­—æ®µï¼Œæœ€åæƒ…å†µå¯¼è‡´ O(nÂ²) æ—¶é—´å¼€é”€&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éå†æ•ˆç‡ä½&lt;/strong&gt;ï¼šåå‘éå†ä¾èµ–å‰é©±èŠ‚ç‚¹é•¿åº¦ï¼Œå®ç°å¤æ‚ä¸”æ€§èƒ½ä¸ç¨³å®š&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç¢ç‰‡é£é™©&lt;/strong&gt;ï¼šé¢‘ç¹æ›´æ–°å¯èƒ½å¼•å‘å†…å­˜é‡åˆ†é…ï¼Œäº§ç”Ÿç¢ç‰‡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾è®¡ä¼˜åŒ–æ–¹å‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‹¬ç«‹èŠ‚ç‚¹&lt;/strong&gt;ï¼šæ¯ä¸ªèŠ‚ç‚¹ä»…è®°å½•è‡ªèº«é•¿åº¦ï¼Œæ¶ˆé™¤çº§è”æ›´æ–°&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–ç»“æ„&lt;/strong&gt;ï¼šå‡å°‘å…ƒæ•°æ®å†—ä½™ï¼Œæå‡å†…å­˜åˆ©ç”¨ç‡ä¸ä»£ç å¯ç»´æŠ¤æ€§&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿æŒç´§å‡‘å­˜å‚¨&lt;/strong&gt;ï¼šè¿ç»­å†…å­˜å¸ƒå±€å‡å°‘ç¢ç‰‡ï¼Œæå‡ CPU ç¼“å­˜å‘½ä¸­ç‡&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="ç»“æ„ç»„æˆä¸ç¼–ç æœºåˆ¶"&gt;&lt;strong&gt;ç»“æ„ç»„æˆä¸ç¼–ç æœºåˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ•´ä½“å¸ƒå±€-1"&gt;&lt;strong&gt;æ•´ä½“å¸ƒå±€&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Listpack ç”±å››éƒ¨åˆ†ç»„æˆï¼ˆå›ºå®šå¤´éƒ¨ + åŠ¨æ€å…ƒç´  + ç»ˆæ­¢ç¬¦ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Total Bytes (4B)&lt;/strong&gt;ï¼šæ€»å­—èŠ‚æ•°ï¼ˆå«å¤´éƒ¨ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Num Elements (2B)&lt;/strong&gt;ï¼šå…ƒç´ æ•°é‡ï¼ˆè‹¥ â‰¥65535 éœ€éå†ç»Ÿè®¡ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Entriesï¼šå…ƒç´ åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ åŒ…å«ä¸‰éƒ¨åˆ†ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Encoding-Type&lt;/strong&gt;ï¼šæ•°æ®ç±»å‹ä¸é•¿åº¦æ ‡è¯†ï¼ˆ1~5 å­—èŠ‚ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Element-Data&lt;/strong&gt;ï¼šå®é™…æ•°æ®ï¼ˆæ•´æ•°æˆ–å­—ç¬¦ä¸²ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Element-Tot-Len&lt;/strong&gt;ï¼šå½“å‰å…ƒç´ æ€»é•¿åº¦ï¼ˆ1~5 å­—èŠ‚ï¼Œå« Encoding å’Œ Dataï¼‰&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;End Marker (0xFF)&lt;/strong&gt;ï¼šç»“æŸæ ‡å¿—&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é«˜æ•ˆç¼–ç è®¾è®¡"&gt;&lt;strong&gt;é«˜æ•ˆç¼–ç è®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Listpack é€šè¿‡å˜é•¿ç¼–ç å‹ç¼©æ•°æ®ï¼Œé’ˆå¯¹ä¸åŒç±»å‹ä¼˜åŒ–å­˜å‚¨ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç¼–ç ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ‡è¯†ä½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®èŒƒå›´/é•¿åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LP_ENCODING_7BIT_UINT&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0xxxxxxx&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;0~127ï¼ˆ1 å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;å°æ•´æ•°ï¼ˆå¦‚è®¡æ•°å™¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LP_ENCODING_13BIT_INT&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;110xxxxx&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;-2048~2047ï¼ˆ2 å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰æ•´æ•°ï¼ˆå¦‚æ—¶é—´æˆ³ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LP_ENCODING_16/24/32BIT&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;11110001~11&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;16/24/32 ä½æ•´æ•°&lt;/td&gt;
&lt;td&gt;å¤§æ•´æ•°ï¼ˆå¦‚ IDï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LP_ENCODING_6BIT_STR&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;10xxxxxx&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;â‰¤63 å­—èŠ‚çš„å­—ç¬¦ä¸²&lt;/td&gt;
&lt;td&gt;çŸ­æ–‡æœ¬ï¼ˆå¦‚å­—æ®µåï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LP_ENCODING_12BIT_STR&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;1110xxxx&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;â‰¤4095 å­—èŠ‚çš„å­—ç¬¦ä¸²&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰æ–‡æœ¬ï¼ˆå¦‚æ—¥å¿—å†…å®¹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;LP_ENCODING_32BIT_STR&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;11110000&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;â‰¤4GB çš„å­—ç¬¦ä¸²&lt;/td&gt;
&lt;td&gt;é•¿æ–‡æœ¬ï¼ˆå¦‚åºåˆ—åŒ–å¯¹è±¡ï¼‰ &lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®æœºåˆ¶&lt;/strong&gt;ï¼š&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Element-Tot-Len ç‰¹æ®Šç¼–ç &lt;/strong&gt;ï¼šæ¯ä¸ªå­—èŠ‚æœ€é«˜ä½æ ‡è¯†æ˜¯å¦ç»“æŸï¼ˆ1 ä¸ºç»§ç»­ï¼Œ0 ä¸ºç»ˆæ­¢ï¼‰ï¼Œä½ 7 ä½å­˜å‚¨é•¿åº¦å€¼ï¼ˆå¤§ç«¯åºï¼‰ï¼Œæ”¯æŒåå‘è§£æ&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿæ•°å¤„ç†&lt;/strong&gt;ï¼šå°†æœ‰ç¬¦å·æ•´æ•°æ˜ å°„åˆ°æ— ç¬¦å·åŒºé—´ï¼ˆå¦‚ 13 ä½ç¼–ç ä¸­ï¼Œ4096&lt;del&gt;8191 è¡¨ç¤º -4096&lt;/del&gt;-1ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="æ“ä½œæ€§èƒ½ä¸é™åˆ¶"&gt;&lt;strong&gt;æ“ä½œæ€§èƒ½ä¸é™åˆ¶&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ“ä½œå¤æ‚åº¦"&gt;&lt;strong&gt;æ“ä½œå¤æ‚åº¦&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æŸ¥æ‰¾&lt;/td&gt;
&lt;td&gt;O(n)&lt;/td&gt;
&lt;td&gt;éœ€çº¿æ€§éå†ï¼ˆé€‚åˆå°å‹é›†åˆï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ’å…¥/åˆ é™¤&lt;/td&gt;
&lt;td&gt;O(n)&lt;/td&gt;
&lt;td&gt;å¹³å‡éœ€ç§»åŠ¨åç»­å…ƒç´ ï¼Œä½†æ— çº§è”æ›´æ–°ï¼Œæ€§èƒ½æ›´ç¨³å®š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;éå†&lt;/td&gt;
&lt;td&gt;O(n)&lt;/td&gt;
&lt;td&gt;æ”¯æŒåŒå‘éå†ï¼ˆæ­£å‘è·³è¿‡å…ƒç´ é•¿åº¦ï¼Œåå‘è§£æ Element-Tot-Lenï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æ€§èƒ½ä¼˜åŠ¿"&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜é«˜æ•ˆ&lt;/strong&gt;ï¼šçœå» ziplist çš„ &lt;code&gt;zltail&lt;/code&gt; å­—æ®µï¼Œå…ƒç´ ç‹¬ç«‹é¿å…å†—ä½™é•¿åº¦è®°å½•ï¼Œå®æµ‹å†…å­˜å ç”¨é™ä½ 5%~15%&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CPU å‹å¥½&lt;/strong&gt;ï¼šè¿ç»­å†…å­˜æå‡ç¼“å­˜å‘½ä¸­ç‡ï¼Œç´§å‡‘ç¼–ç å‡å°‘è§£ç å¼€é”€&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ“ä½œ&lt;/strong&gt;ï¼šæ’å…¥/åˆ é™¤å•å…ƒç´ ä¿è¯åŸå­æ€§ï¼Œé€‚åˆå¹¶å‘åœºæ™¯&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é™åˆ¶"&gt;&lt;strong&gt;é™åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ€å¤§å®¹é‡&lt;/strong&gt;ï¼šå•ä¸ª listpack ä¸è¶…è¿‡ 4GBï¼ˆå— &lt;code&gt;Total Bytes&lt;/code&gt; å­—æ®µé™åˆ¶ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šä»…å½“é›†åˆå…ƒç´ æ•°é‡å°‘ï¼ˆé»˜è®¤ â‰¤512ï¼‰ä¸”å…ƒç´ å€¼å°ï¼ˆé»˜è®¤ â‰¤64Bï¼‰æ—¶å¯ç”¨ï¼Œè¶…é˜ˆå€¼è½¬ hashtable æˆ– skiplist&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="åº”ç”¨åœºæ™¯ä¸-redis-é›†æˆ"&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯ä¸ Redis é›†æˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å…¸å‹åº”ç”¨"&gt;&lt;strong&gt;å…¸å‹åº”ç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å°å‹ Hash&lt;/strong&gt;ï¼šå­˜å‚¨ç”¨æˆ·å±æ€§ï¼ˆå¦‚ &lt;code&gt;HSET user:1 name &amp;quot;Alice&amp;quot; age 30&lt;/code&gt;ï¼‰ï¼Œå­—æ®µå°‘æ—¶å†…å­˜èŠ‚çœæ˜¾è‘—&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½»é‡ List&lt;/strong&gt;ï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚ &lt;code&gt;LPUSH logs &amp;quot;error: timeout&amp;quot;&lt;/code&gt;ï¼‰ï¼Œå¿«é€Ÿè¿½åŠ ä½†éšæœºè®¿é—®å°‘&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç´§å‡‘ Sorted Set&lt;/strong&gt;ï¼šæ’è¡Œæ¦œï¼ˆå¦‚ &lt;code&gt;ZADD leaderboard 150 &amp;quot;Alice&amp;quot;&lt;/code&gt;ï¼‰ï¼Œå…ƒç´ å°‘æ—¶é¿å…è·³è¡¨æŒ‡é’ˆå¼€é”€&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="redis-ä¸­çš„è‡ªåŠ¨è½¬æ¢"&gt;&lt;strong&gt;Redis ä¸­çš„è‡ªåŠ¨è½¬æ¢&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å½“é›†åˆè§„æ¨¡å¢é•¿ï¼ŒRedis æ ¹æ®é…ç½®å‚æ•°è‡ªåŠ¨è½¬æ¢åº•å±‚ç»“æ„ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;listpack è§¦å‘æ¡ä»¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è½¬æ¢ç›®æ ‡&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Hash&lt;/td&gt;
&lt;td&gt;&lt;code&gt;field&lt;/code&gt; æ•°é‡ &amp;gt; &lt;code&gt;hash-max-listpack-entries&lt;/code&gt; æˆ–ä»»ä¸€ &lt;code&gt;value&lt;/code&gt; &amp;gt; &lt;code&gt;hash-max-listpack-value&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Hashtable&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Sorted Set&lt;/td&gt;
&lt;td&gt;å…ƒç´ æ•°é‡ &amp;gt; &lt;code&gt;zset-max-listpack-entries&lt;/code&gt; æˆ–ä»»ä¸€ &lt;code&gt;member&lt;/code&gt; &amp;gt; &lt;code&gt;zset-max-listpack-value&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Skiplist + Dict&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;List&lt;/td&gt;
&lt;td&gt;å…ƒç´ æ•°é‡ &amp;gt; &lt;code&gt;list-max-listpack-size&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Quicklistï¼ˆlistpack èŠ‚ç‚¹ï¼‰&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šRedis 7.0+ ä¸­ï¼Œæ‰€æœ‰åŸ ziplist åœºæ™¯å‡æ›¿æ¢ä¸º listpackï¼Œå‚æ•°ååŒæ­¥æ›´æ–°ï¼ˆå¦‚ &lt;code&gt;listpack-max-entries&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="ä¸-ziplist-çš„å…³é”®å¯¹æ¯”"&gt;&lt;strong&gt;ä¸ ziplist çš„å…³é”®å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ziplist&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;listpack&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é•¿åº¦è®°å½•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;èŠ‚ç‚¹è®°å½•å‰é©±é•¿åº¦&lt;/td&gt;
&lt;td&gt;èŠ‚ç‚¹è®°å½•è‡ªèº«é•¿åº¦&lt;/td&gt;
&lt;td&gt;å½»åº•æ¶ˆé™¤çº§è”æ›´æ–°&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åå‘éå†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾èµ– &lt;code&gt;zltail&lt;/code&gt; å’Œ &lt;code&gt;prevlen&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è§£æ Element-Tot-Len å®ç°&lt;/td&gt;
&lt;td&gt;æ— é¢å¤–å­—æ®µï¼Œå†…å­˜æ›´çœ&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¤´éƒ¨å¼€é”€&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;10 å­—èŠ‚ï¼ˆ&lt;code&gt;zlbytes+zltail+zllen&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;6 å­—èŠ‚ï¼ˆ&lt;code&gt;Total Bytes+Num Elements&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å‡å°‘ 4 å­—èŠ‚å›ºå®šå¼€é”€&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼–ç å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤šç±»å‹æ··åˆç¼–ç å¤æ‚&lt;/td&gt;
&lt;td&gt;ç»Ÿä¸€å˜é•¿ç¼–ç ï¼Œè§£ç æ›´ç®€å•&lt;/td&gt;
&lt;td&gt;ä»£ç ç»´æŠ¤å’Œæ‰©å±•æ€§æ›´ä¼˜&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Listpack é€šè¿‡ &lt;strong&gt;ç‹¬ç«‹èŠ‚ç‚¹é•¿åº¦è®°å½•&lt;/strong&gt;ã€&lt;strong&gt;ç´§å‡‘å˜é•¿ç¼–ç &lt;/strong&gt; å’Œ &lt;strong&gt;è¿ç»­å†…å­˜å¸ƒå±€&lt;/strong&gt;ï¼Œåœ¨ç»§æ‰¿ ziplist å†…å­˜ä¼˜åŠ¿çš„åŒæ—¶ï¼Œè§£å†³äº†å…¶æ ¸å¿ƒç¼ºé™·ï¼Œæˆä¸º Redis å°è§„æ¨¡æ•°æ®å­˜å‚¨çš„ç†æƒ³é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;æ¨èåœºæ™¯&lt;/strong&gt;ï¼šå­—æ®µå°‘ä¸”å€¼å°çš„ Hashã€å…ƒç´ å°‘çš„ Sorted Setã€è½»é‡ List/Streamã€‚&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;é¿å‘å»ºè®®&lt;/strong&gt;ï¼šç›‘æ§é›†åˆè§„æ¨¡ï¼Œé¿å…è¶…é˜ˆå€¼å¯¼è‡´æ€§èƒ½é™¡é™ï¼›é•¿æ–‡æœ¬ä¼˜å…ˆç”¨ String ç±»å‹ã€‚&lt;/li&gt;
&lt;li&gt;ğŸ”® &lt;strong&gt;æœªæ¥æ¼”è¿›&lt;/strong&gt;ï¼šéšç€ Redis å…¨é¢å¼ƒç”¨ ziplistï¼Œlistpack å°†è¿›ä¸€æ­¥ä¼˜åŒ–ç¼–ç æ•ˆç‡ï¼ˆå¦‚ SIMD åŠ é€Ÿï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚
å¯é€šè¿‡å‘½ä»¤ &lt;code&gt;OBJECT ENCODING key&lt;/code&gt; æŸ¥çœ‹é”®æ˜¯å¦ä½¿ç”¨ listpackï¼ˆè¿”å› &lt;code&gt;listpack&lt;/code&gt;ï¼‰ï¼Œç»“åˆ &lt;code&gt;MEMORY USAGE&lt;/code&gt; åˆ†æå®é™…å†…å­˜æ”¶ç›Š&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="element-tot-len"&gt;Element-Tot-Len
&lt;/h2&gt;&lt;p&gt;Redis çš„ &lt;strong&gt;listpack&lt;/strong&gt;ï¼ˆç´§å‡‘åˆ—è¡¨ï¼‰æ˜¯æ›¿ä»£ ziplist çš„æ–°å‹ç´§å‡‘æ•°æ®ç»“æ„ï¼Œå…¶æ ¸å¿ƒåˆ›æ–°ç‚¹ &lt;strong&gt;Element-Tot-Len&lt;/strong&gt;ï¼ˆå…ƒç´ æ€»é•¿åº¦å­—æ®µï¼‰å½»åº•è§£å†³äº† ziplist çš„è¿é”æ›´æ–°é—®é¢˜ã€‚ä»¥ä¸‹ä»è®¾è®¡ç›®æ ‡ã€ç»“æ„åŸç†ã€ç¼–ç æœºåˆ¶ã€æ“ä½œé€»è¾‘åŠå®è·µæ„ä¹‰äº”ä¸ªç»´åº¦æ·±å…¥è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-element-tot-len-çš„è®¾è®¡ç›®æ ‡"&gt;ğŸ”§ &lt;strong&gt;Element-Tot-Len çš„è®¾è®¡ç›®æ ‡&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ ¸å¿ƒé—®é¢˜è¿é”æ›´æ–°cascade-update"&gt;&lt;strong&gt;æ ¸å¿ƒé—®é¢˜ï¼šè¿é”æ›´æ–°ï¼ˆCascade Updateï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ziplist çš„ entry ä¾èµ– &lt;code&gt;prevlen&lt;/code&gt; è®°å½•å‰é©±èŠ‚ç‚¹é•¿åº¦ï¼Œæ’å…¥/åˆ é™¤å¯èƒ½è§¦å‘åç»­èŠ‚ç‚¹è¿é”æ‰©å±•ï¼ˆ1B â†” 5Bï¼‰ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦ O(NÂ²)&lt;a class="link" href="@ref" &gt;1,2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾‹&lt;/strong&gt;ï¼šåœ¨èŠ‚ç‚¹ A åæ’å…¥å¤§èŠ‚ç‚¹ B â†’ B çš„ &lt;code&gt;prevlen&lt;/code&gt; ä» 1B æ‰©è‡³ 5B â†’ èŠ‚ç‚¹ C éœ€åŒæ­¥æ‰©å±• â†’ è¿é”ä¼ æ’­&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è§£å†³æ–¹æ¡ˆè‡ªåŒ…å«è®¾è®¡"&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆï¼šè‡ªåŒ…å«è®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Element-Tot-Len &lt;strong&gt;ä»…è®°å½•å½“å‰èŠ‚ç‚¹è‡ªèº«é•¿åº¦&lt;/strong&gt;ï¼ˆå« &lt;code&gt;encoding-type&lt;/code&gt; å’Œ &lt;code&gt;element-data&lt;/code&gt;ï¼‰ï¼Œä¸ä¾èµ–å‰é©±èŠ‚ç‚¹ï¼Œéš”ç¦»å˜æ›´å½±å“&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-element-tot-len-çš„ç»“æ„ä¸ç¼–ç "&gt;ğŸ§± &lt;strong&gt;Element-Tot-Len çš„ç»“æ„ä¸ç¼–ç &lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä½ç½®ä¸ä½œç”¨"&gt;&lt;strong&gt;ä½ç½®ä¸ä½œç”¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ä½äº entry æœ«å°¾ï¼š&lt;code&gt;&amp;lt;encoding-type&amp;gt; &amp;lt;element-data&amp;gt; &amp;lt;element-tot-len&amp;gt;&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åŠŸèƒ½ï¼š
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨å½“å‰èŠ‚ç‚¹æ€»é•¿åº¦ï¼ˆä¸å«è‡ªèº«ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒé€†å‘éå†ï¼šé€šè¿‡åç§»é‡å®šä½å‰é©±èŠ‚ç‚¹èµ·å§‹ä½ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å˜é•¿ç¼–ç æœºåˆ¶"&gt;&lt;strong&gt;å˜é•¿ç¼–ç æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ç¼–ç è§„åˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªå­—èŠ‚ &lt;strong&gt;æœ€é«˜ä½ä¸ºæ ‡å¿—ä½&lt;/strong&gt;ï¼š&lt;code&gt;0&lt;/code&gt; è¡¨ç¤ºç»“æŸï¼Œ&lt;code&gt;1&lt;/code&gt; è¡¨ç¤ºç»§ç»­&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½ 7 ä½å­˜å‚¨æ•°æ®&lt;/strong&gt;ï¼šæŒ‰å¤§ç«¯åºï¼ˆé«˜ä½åœ¨å·¦ï¼‰ç»„åˆä¸ºå®é™…é•¿åº¦å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é•¿åº¦è®¡ç®—æµç¨‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;graph LR
A[ä»å³å‘å·¦è¯»å­—èŠ‚] --&amp;gt; B{æœ€é«˜ä½=0ï¼Ÿ}
B -- æ˜¯ --&amp;gt; C[å½“å‰å­—èŠ‚ä¸ºæœ«å­—èŠ‚]
B -- å¦ --&amp;gt; D[ç»§ç»­å‘å·¦è¯»ä¸‹ä¸€å­—èŠ‚]
C --&amp;gt; E[æ‹¼æ¥æ‰€æœ‰ä½7ä½ â†’ å®é™…é•¿åº¦]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;å…³é”®ç‚¹&lt;/strong&gt;ï¼šé•¿åº¦å€¼æŒ‰ 7bit åˆ†æ®µå­˜å‚¨ï¼ŒåŠ¨æ€é€‚é… 1~5 å­—èŠ‚ï¼Œé¿å…å›ºå®š 4 å­—èŠ‚æµªè´¹&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-é€†å‘éå†çš„å®ç°"&gt;âš™ï¸ &lt;strong&gt;é€†å‘éå†çš„å®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å®šä½å‰é©±èŠ‚ç‚¹"&gt;&lt;strong&gt;å®šä½å‰é©±èŠ‚ç‚¹&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ­¥éª¤ï¼š
&lt;ol&gt;
&lt;li&gt;å½“å‰èŠ‚ç‚¹èµ·å§‹åœ°å€ä¸º &lt;code&gt;P&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è§£æ &lt;code&gt;Element-Tot-Len&lt;/code&gt; å¾—é•¿åº¦ &lt;code&gt;L&lt;/code&gt;ï¼ˆå« &lt;code&gt;encoding-type&lt;/code&gt; + &lt;code&gt;element-data&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å‰é©±èŠ‚ç‚¹èµ·å§‹åœ°å€ = &lt;code&gt;P - L - Element-Tot-Lenè‡ªèº«å­—èŠ‚æ•°&lt;/code&gt;&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å®ä¾‹æ¼”ç¤º"&gt;&lt;strong&gt;å®ä¾‹æ¼”ç¤º&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å‡è®¾å½“å‰èŠ‚ç‚¹ä½ç½® &lt;code&gt;0x1000&lt;/code&gt;ï¼Œ&lt;code&gt;Element-Tot-Len&lt;/code&gt; å€¼ 130ï¼ˆç¼–ç  &lt;code&gt;0x82 0x01&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å‰é©±èŠ‚ç‚¹èµ·å§‹åœ°å€ = &lt;code&gt;0x1000 - 130 - 2 = 0x0F7C&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¯¹æ¯”-ziplist-çš„æ€§èƒ½ä¼˜åŠ¿"&gt;âš¡ï¸ &lt;strong&gt;å¯¹æ¯” ziplist çš„æ€§èƒ½ä¼˜åŠ¿&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ziplist (prevlen)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;listpack (Element-Tot-Len)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å˜æ›´å½±å“èŒƒå›´&lt;/td&gt;
&lt;td&gt;å¯èƒ½è§¦å‘åç»­èŠ‚ç‚¹è¿é”æ›´æ–°&lt;/td&gt;
&lt;td&gt;ä»…é™å½“å‰èŠ‚ç‚¹&lt;/td&gt;
&lt;td&gt;æ¶ˆé™¤ O(NÂ²) æœ€åå¤æ‚åº¦&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†…å­˜å ç”¨&lt;/td&gt;
&lt;td&gt;å›ºå®š 1/5 å­—èŠ‚&lt;/td&gt;
&lt;td&gt;1~5 å­—èŠ‚åŠ¨æ€é€‚é…&lt;/td&gt;
&lt;td&gt;å°é•¿åº¦æ›´çœå†…å­˜ï¼ˆå¦‚ 5â†’1 å­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;éå†å¤æ‚åº¦&lt;/td&gt;
&lt;td&gt;åŒå‘ O(1)&lt;/td&gt;
&lt;td&gt;é€†å‘ O(1)ï¼Œä½†éœ€è§£æå˜é•¿ç¼–ç &lt;/td&gt;
&lt;td&gt;ç‰ºç‰²å¾®é‡æ€§èƒ½æ¢ç¨³å®šæ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡å“²å­¦ä¸å·¥ç¨‹æ„ä¹‰"&gt;ğŸ’ &lt;strong&gt;è®¾è®¡å“²å­¦ä¸å·¥ç¨‹æ„ä¹‰&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç©ºé—´-æ—¶é—´æŠ˜è¡·
&lt;ul&gt;
&lt;li&gt;é€šè¿‡å˜é•¿ç¼–ç  &lt;strong&gt;å‹ç¼©å°é•¿åº¦å­˜å‚¨&lt;/strong&gt;ï¼ˆå¦‚ 130 ä»…éœ€ 2 å­—èŠ‚ï¼‰ï¼ŒåŒæ—¶æ¥å—è§£æå¼€é”€&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å±€éƒ¨æ€§åŸç†ä¼˜åŒ–
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹è‡ªåŒ…å«è®¾è®¡å¥‘åˆ CPU ç¼“å­˜è¡Œï¼Œæå‡ç´§å‡‘æ•°æ®éå†æ•ˆç‡&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…¼å®¹æ€§æ¼”è¿›
&lt;ul&gt;
&lt;li&gt;Redis 7.0 å°† listpack ä½œä¸º Hashã€Listã€Zset çš„ç»Ÿä¸€åº•å±‚ç»“æ„ï¼Œæ›¿ä»£ ziplist æ ¹æ²»è¿é”æ›´æ–°ç—›ç‚¹&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;ï¼šç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¯é€šè¿‡ &lt;code&gt;hash-max-listpack-value&lt;/code&gt; ç­‰å‚æ•°æ§åˆ¶ listpack èŠ‚ç‚¹å¤§å°ï¼ˆé»˜è®¤ 64 å­—èŠ‚ï¼‰ï¼Œå¹³è¡¡å†…å­˜ä¸æ“ä½œæ€§èƒ½ ğŸ”§ã€‚
&lt;img src="https://mmbiz.qpic.cn/sz_mmbiz_png/TibzXAgdOgMCGiaHY6icZNo5OyFS0iaCOvhEJQJdTgcmHqOHbibv9dBnv9shNbuufzOdicsj9ibOfdfvf42y8srdFZ60g/640?wx_fmt=png&amp;amp;from=appmsg&amp;amp;tp=webp&amp;amp;wxfrom=5&amp;amp;wx_lazy=1"
loading="lazy"
alt="Image"
&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="quicklist"&gt;Quicklist
&lt;/h2&gt;&lt;p&gt;Redis çš„ &lt;strong&gt;Quicklistï¼ˆå¿«é€Ÿåˆ—è¡¨ï¼‰&lt;/strong&gt; æ˜¯è‡ª Redis 3.2 ç‰ˆæœ¬èµ·ç”¨äºå®ç° List ç±»å‹çš„åº•å±‚æ•°æ®ç»“æ„ï¼Œå®ƒé€šè¿‡ç»“åˆ&lt;strong&gt;åŒå‘é“¾è¡¨&lt;/strong&gt;çš„çµæ´»æ€§ä¸&lt;strong&gt;å‹ç¼©åˆ—è¡¨ï¼ˆZiplistï¼‰&lt;/strong&gt; çš„å†…å­˜ç´§å‡‘æ€§ï¼Œè§£å†³äº†æ—©æœŸ &lt;code&gt;LinkedList&lt;/code&gt;ï¼ˆå†…å­˜ç¢ç‰‡å¤šï¼‰å’Œ &lt;code&gt;Ziplist&lt;/code&gt;ï¼ˆè¿é”æ›´æ–°é£é™©ï¼‰çš„ç¼ºé™·ï¼Œæˆä¸ºå¹³è¡¡å†…å­˜æ•ˆç‡ä¸æ“ä½œæ€§èƒ½çš„æ ¸å¿ƒæ–¹æ¡ˆã€‚ä»¥ä¸‹ä»è®¾è®¡æ€æƒ³ã€ç»“æ„å®ç°ã€æ“ä½œé€»è¾‘ã€ä¼˜åŒ–ç­–ç•¥åŠå®è·µåº”ç”¨å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡èƒŒæ™¯ä¸æ ¸å¿ƒæ€æƒ³"&gt;ğŸ”§ &lt;strong&gt;è®¾è®¡èƒŒæ™¯ä¸æ ¸å¿ƒæ€æƒ³&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ—©æœŸé—®é¢˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;LinkedList&lt;/code&gt;ï¼ˆåŒå‘é“¾è¡¨ï¼‰&lt;/strong&gt;ï¼šæ¯ä¸ªå…ƒç´ ç‹¬ç«‹åˆ†é…å†…å­˜ï¼Œéœ€å­˜å‚¨å‰åæŒ‡é’ˆï¼ˆå„å  8 å­—èŠ‚ï¼‰ï¼Œå†…å­˜ç¢ç‰‡ç‡é«˜ï¼Œå¤§åˆ—è¡¨éå†æ•ˆç‡ä½&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Ziplist&lt;/code&gt;ï¼ˆå‹ç¼©åˆ—è¡¨ï¼‰&lt;/strong&gt;ï¼šå†…å­˜è¿ç»­ç´§å‡‘ï¼Œä½†æ’å…¥/åˆ é™¤å¯èƒ½è§¦å‘è¿é”æ›´æ–°ï¼ˆCascade Updateï¼‰ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦ O(NÂ²)ï¼Œä¸”å¤§åˆ—è¡¨å†…å­˜ç”³è¯·æ•ˆç‡ä½&lt;a class="link" href="@ref" &gt;5,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
Quicklist å°†é•¿åˆ—è¡¨æ‹†åˆ†ä¸º&lt;strong&gt;å¤šä¸ªçŸ­ Ziplist èŠ‚ç‚¹&lt;/strong&gt;ï¼Œé€šè¿‡åŒå‘é“¾è¡¨è¿æ¥ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ²»ç­–ç•¥&lt;/strong&gt;ï¼šå•èŠ‚ç‚¹ Ziplist å¤§å°å—æ§ï¼ˆé»˜è®¤ 8KBï¼‰ï¼Œé¿å…è¿é”æ›´æ–°æ‰©æ•£è‡³å…¨å±€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±€éƒ¨è¿ç»­&lt;/strong&gt;ï¼šèŠ‚ç‚¹å†…å†…å­˜è¿ç»­ï¼Œå‡å°‘ç¢ç‰‡ï¼›èŠ‚ç‚¹é—´é€šè¿‡æŒ‡é’ˆå…³è”ï¼Œæ”¯æŒåŠ¨æ€æ‰©å±•&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç»“æ„å®ç°"&gt;ğŸ§± &lt;strong&gt;æ ¸å¿ƒç»“æ„å®ç°&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ•´ä½“ç»“æ„"&gt;&lt;strong&gt;æ•´ä½“ç»“æ„ï¼ˆ&lt;code&gt;quicklist&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;typedef struct quicklist {
quicklistNode *head; // å¤´èŠ‚ç‚¹æŒ‡é’ˆ
quicklistNode *tail; // å°¾èŠ‚ç‚¹æŒ‡é’ˆ
unsigned long count; // æ‰€æœ‰èŠ‚ç‚¹å…ƒç´ æ€»æ•°
unsigned long len; // èŠ‚ç‚¹æ•°é‡
int fill : 16; // æ§åˆ¶å•èŠ‚ç‚¹å¤§å°ï¼ˆ`list-max-ziplist-size`ï¼‰
unsigned int compress : 16; // å‹ç¼©æ·±åº¦ï¼ˆ`list-compress-depth`ï¼‰
} quicklist;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;fill
&lt;/code&gt;&lt;/pre&gt;**ï¼šé™åˆ¶å•èŠ‚ç‚¹ Ziplist å¤§å°
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å–å€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å«ä¹‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å…¸å‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ­£æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;èŠ‚ç‚¹æœ€å¤šå…ƒç´ æ•°ï¼ˆå¦‚ &lt;code&gt;5&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;å›ºå®šæ•°é‡çš„å°å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è´Ÿæ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;èŠ‚ç‚¹æœ€å¤§å­—èŠ‚æ•°ï¼ˆ&lt;code&gt;-1&lt;/code&gt;~&lt;code&gt;-5&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-2&lt;/code&gt;ï¼ˆ8KBï¼Œé»˜è®¤ï¼‰&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;compress&lt;/code&gt;&lt;/strong&gt;ï¼šæ§åˆ¶èŠ‚ç‚¹å‹ç¼©èŒƒå›´ï¼ˆå¦‚ &lt;code&gt;1&lt;/code&gt; è¡¨ç¤ºå¤´å°¾å„ 1 ä¸ªèŠ‚ç‚¹ä¸å‹ç¼©ï¼‰&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="èŠ‚ç‚¹ç»“æ„"&gt;&lt;strong&gt;èŠ‚ç‚¹ç»“æ„ï¼ˆ&lt;code&gt;quicklistNode&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;typedef struct quicklistNode {
struct quicklistNode *prev; // å‰é©±èŠ‚ç‚¹æŒ‡é’ˆ
struct quicklistNode *next; // åç»§èŠ‚ç‚¹æŒ‡é’ˆ
unsigned char *zl; // æŒ‡å‘ Ziplist æˆ–å‹ç¼©æ•°æ®ï¼ˆ`quicklistLZF`ï¼‰
unsigned int sz; // Ziplist åŸå§‹å­—èŠ‚å¤§å°
unsigned int count : 16; // å½“å‰èŠ‚ç‚¹å…ƒç´ æ•°é‡
unsigned int encoding : 2; // ç¼–ç ï¼š1ï¼ˆæœªå‹ç¼©ï¼‰ã€2ï¼ˆLZF å‹ç¼©ï¼‰
unsigned int recompress : 1; // ä¸´æ—¶è§£å‹æ ‡è®°ï¼ˆè®¿é—®åéœ€é‡å‹ç¼©ï¼‰
} quicklistNode;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;**
&lt;pre tabindex="0"&gt;&lt;code&gt;zl
&lt;/code&gt;&lt;/pre&gt;æŒ‡é’ˆåŠ¨æ€ç±»å‹**ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœªå‹ç¼©&lt;/strong&gt;ï¼šç›´æ¥æŒ‡å‘ Ziplistã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‹ç¼©&lt;/strong&gt;ï¼šæŒ‡å‘ &lt;code&gt;quicklistLZF&lt;/code&gt; ç»“æ„ï¼ˆå«å‹ç¼©æ•°æ®å¤§å° &lt;code&gt;sz&lt;/code&gt; å’Œå­—èŠ‚æ•°ç»„ &lt;code&gt;compressed&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®æ“ä½œä¸æ€§èƒ½"&gt;âš™ï¸ &lt;strong&gt;å…³é”®æ“ä½œä¸æ€§èƒ½&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ’å…¥æ“ä½œ"&gt;&lt;strong&gt;æ’å…¥æ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å¤´éƒ¨/å°¾éƒ¨æ’å…¥ï¼š
&lt;ul&gt;
&lt;li&gt;è‹¥å¤´/å°¾èŠ‚ç‚¹æœªæ»¡ï¼ˆ&lt;code&gt;count &amp;lt; fill&lt;/code&gt;ï¼‰ï¼Œç›´æ¥æ’å…¥å…¶ Ziplistã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å·²æ»¡ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹æ’å…¥ï¼Œå¹¶æ›´æ–°é“¾è¡¨å¤´/å°¾æŒ‡é’ˆ&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸­é—´æ’å…¥ï¼š
&lt;ul&gt;
&lt;li&gt;å®šä½ç›®æ ‡èŠ‚ç‚¹ï¼Œè‹¥èŠ‚ç‚¹æœªæ»¡åˆ™æ’å…¥ Ziplistã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹åˆ†è£‚&lt;/strong&gt;ï¼šè‹¥æ’å…¥å¯¼è‡´èŠ‚ç‚¹è¶…é™ï¼Œåˆ†è£‚ä¸ºä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆç±»ä¼¼ B æ ‘åˆ†è£‚ï¼‰ï¼Œå‡æ‘Šå¤æ‚åº¦ O(1)&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åˆ é™¤æ“ä½œ"&gt;&lt;strong&gt;åˆ é™¤æ“ä½œ&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åˆ é™¤åè‹¥èŠ‚ç‚¹ä¸ºç©ºï¼Œç§»é™¤èŠ‚ç‚¹å¹¶é‡Šæ”¾å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹åˆå¹¶&lt;/strong&gt;ï¼šè‹¥ç›¸é‚»èŠ‚ç‚¹æ€»å¤§å°æœªè¶… &lt;code&gt;fill&lt;/code&gt;ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå‡å°‘ç¢ç‰‡ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å‹ç¼©æœºåˆ¶"&gt;&lt;strong&gt;å‹ç¼©æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;ï¼šåŸºäº &lt;code&gt;compress&lt;/code&gt; å‚æ•°å‹ç¼©ä¸­é—´èŠ‚ç‚¹ï¼ˆå¦‚ &lt;code&gt;compress=1&lt;/code&gt; æ—¶å¤´å°¾èŠ‚ç‚¹ä¸å‹ç¼©ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LZF ç®—æ³•&lt;/strong&gt;ï¼šæ— æŸå‹ç¼©ï¼Œè®¿é—®å‹ç¼©æ•°æ®æ—¶ä¸´æ—¶è§£å‹ï¼ˆ&lt;code&gt;recompress=1&lt;/code&gt; æ ‡è®°åç»­é‡å‹ç¼©ï¼‰&lt;a class="link" href="@ref" &gt;2,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šä¸­é—´èŠ‚ç‚¹è®¿é—®é¢‘ç‡ä½ï¼Œå‹ç¼©åå†…å­˜é™ä½ 50%+ï¼ˆå®æµ‹ 100 ä¸‡å…ƒç´ åˆ—è¡¨ä» 120MB â†’ 60MBï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¼˜åŒ–ç­–ç•¥ä¸é…ç½®"&gt;ğŸ› ï¸ &lt;strong&gt;ä¼˜åŒ–ç­–ç•¥ä¸é…ç½®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å‚æ•°è°ƒä¼˜å»ºè®®"&gt;&lt;strong&gt;å‚æ•°è°ƒä¼˜å»ºè®®&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èå€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;list-max-ziplist-size&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;-2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å•èŠ‚ç‚¹ Ziplist â‰¤ 8KBï¼ˆå¹³è¡¡å†…å­˜ä¸æ€§èƒ½ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;list-compress-depth&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¤´å°¾å„ 1 èŠ‚ç‚¹ä¸å‹ç¼©ï¼ˆä¿éšœä¸¤ç«¯æ“ä½œé€Ÿåº¦ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="æ€§èƒ½å¯¹æ¯”quicklist-vs-linkedlist"&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”ï¼ˆQuicklist vs LinkedListï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;LinkedList&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Quicklist&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ’å…¥ 100 ä¸‡å…ƒç´ &lt;/td&gt;
&lt;td&gt;1.2 ç§’&lt;/td&gt;
&lt;td&gt;0.8 ç§’&lt;/td&gt;
&lt;td&gt;é«˜å¹¶å‘ä¼˜åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†…å­˜å ç”¨&lt;/td&gt;
&lt;td&gt;120 MB&lt;/td&gt;
&lt;td&gt;60 MB&lt;/td&gt;
&lt;td&gt;èŠ‚çœ 50%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;éå†æ•ˆç‡&lt;/td&gt;
&lt;td&gt;O(N)&lt;/td&gt;
&lt;td&gt;O(N) + ç¼“å­˜å‹å¥½&lt;/td&gt;
&lt;td&gt;å±€éƒ¨æ€§åŸç†ä¼˜åŒ–&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯-1"&gt;ğŸ’¡ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é«˜é¢‘æ“ä½œé˜Ÿåˆ—&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚ LPUSH/RPOPï¼‰ï¼Œéœ€ä¸¤ç«¯å¿«é€Ÿæ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šå¤´å°¾èŠ‚ç‚¹ä¸å‹ç¼©ï¼Œæ’å…¥/åˆ é™¤å¤æ‚åº¦ O(1)&lt;a class="link" href="@ref" &gt;7,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§è§„æ¨¡åˆ—è¡¨å­˜å‚¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šç”¨æˆ·åŠ¨æ€æ—¶é—´çº¿ï¼ˆå¦‚å¾®åšåˆ—è¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šåˆ†èŠ‚ç‚¹å­˜å‚¨ï¼Œé¿å…å• Ziplist è¿‡å¤§ï¼›å‹ç¼©ä¸­é—´èŠ‚ç‚¹èŠ‚çœå†…å­˜&lt;a class="link" href="@ref" &gt;5,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜æ•æ„Ÿå‹æœåŠ¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šåµŒå…¥å¼è®¾å¤‡æˆ–äº‘æœåŠ¡ï¼ˆå†…å­˜æˆæœ¬é«˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šå®æµ‹å†…å­˜å ç”¨æ¯” LinkedList ä½ 50%ï¼Œä¸”æ”¯æŒåŠ¨æ€å‹ç¼©&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ¼”è¿›ä¸å±€é™æ€§"&gt;âš ï¸ &lt;strong&gt;æ¼”è¿›ä¸å±€é™æ€§&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Ziplist â†’ Listpack&lt;/strong&gt;ï¼š
Redis 7.0 å°† Quicklist åº•å±‚ Ziplist æ›¿æ¢ä¸º â€‹&lt;strong&gt;Listpack&lt;/strong&gt;â€‹ï¼ˆç§»é™¤ &lt;code&gt;prevlen&lt;/code&gt; å½»åº•è§£å†³è¿é”æ›´æ–°ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å±€é™æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸­é—´èŠ‚ç‚¹éå†éœ€è§£å‹ï¼Œ&lt;strong&gt;éšæœºè®¿é—®æ€§èƒ½å¼±äºæ•°ç»„&lt;/strong&gt;ï¼ˆéœ€éå†èŠ‚ç‚¹å®šä½ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é¢‘ç¹ä¿®æ”¹ä¸­é—´å…ƒç´ å¯èƒ½è§¦å‘&lt;strong&gt;èŠ‚ç‚¹åˆ†è£‚/åˆå¹¶&lt;/strong&gt;ï¼ˆéœ€åˆç†è®¾ç½® &lt;code&gt;fill&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-3"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Quicklist é€šè¿‡ &lt;strong&gt;â€œåˆ†æ²»ç­–ç•¥â€&lt;/strong&gt;ï¼ˆçŸ­ Ziplist èŠ‚ç‚¹ + åŒå‘é“¾è¡¨ï¼‰å’Œ &lt;strong&gt;â€œæŒ‰éœ€å‹ç¼©â€&lt;/strong&gt;ï¼ˆLZF å‹ç¼©ä¸­é—´èŠ‚ç‚¹ï¼‰ï¼Œå®ç°äº†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜é«˜æ•ˆ&lt;/strong&gt;ï¼šè¾ƒ LinkedList å†…å­˜å ç”¨é™ä½ 50%+ï¼Œå°¤å…¶é€‚åˆå­˜å‚¨å°å¯¹è±¡&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œçµæ´»&lt;/strong&gt;ï¼šä¸¤ç«¯æ“ä½œ O(1)ï¼Œä¸­é—´æ“ä½œé€šè¿‡èŠ‚ç‚¹åˆ†è£‚/åˆå¹¶å‡æ‘Š O(1)&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§å¼º&lt;/strong&gt;ï¼šå‚æ•°ï¼ˆ&lt;code&gt;fill&lt;/code&gt;ã€&lt;code&gt;compress&lt;/code&gt;ï¼‰æ”¯æŒæŒ‰ä¸šåŠ¡åœºæ™¯åŠ¨æ€è°ƒä¼˜&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®® &lt;code&gt;list-max-ziplist-size = -2&lt;/code&gt;ï¼ˆ8KB èŠ‚ç‚¹ï¼‰ + &lt;code&gt;list-compress-depth = 1&lt;/code&gt;ï¼ˆå‹ç¼©ä¸­é—´èŠ‚ç‚¹ï¼‰ï¼Œå…¼é¡¾æ€§èƒ½ä¸å†…å­˜ ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æŒä¹…åŒ–ç­–ç•¥"&gt;æŒä¹…åŒ–ç­–ç•¥
&lt;/h2&gt;&lt;p&gt;Redisçš„æŒä¹…åŒ–æœºåˆ¶æ˜¯å…¶é«˜å¯ç”¨æ€§çš„æ ¸å¿ƒï¼Œé€šè¿‡å°†å†…å­˜æ•°æ®ä¿å­˜åˆ°ç£ç›˜ï¼Œç¡®ä¿å®•æœºæˆ–é‡å¯åæ•°æ®å¯æ¢å¤ã€‚Redisæä¾›&lt;strong&gt;RDB&lt;/strong&gt;ã€&lt;strong&gt;AOF&lt;/strong&gt;å’Œ&lt;strong&gt;æ··åˆæŒä¹…åŒ–&lt;/strong&gt;ä¸‰ç§ç­–ç•¥ï¼Œå„æœ‰é€‚ç”¨åœºæ™¯å’Œä¼˜ç¼ºç‚¹ã€‚ä»¥ä¸‹ä»åŸç†ã€é…ç½®ã€æ€§èƒ½åŠåº”ç”¨åœºæ™¯å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-rdbredis-databaseå¿«ç…§æŒä¹…åŒ–"&gt;ğŸ“Š &lt;strong&gt;RDBï¼ˆRedis Databaseï¼‰å¿«ç…§æŒä¹…åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸç†"&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;RDBé€šè¿‡ç”Ÿæˆ&lt;strong&gt;æŸä¸€æ—¶åˆ»çš„æ•°æ®å¿«ç…§&lt;/strong&gt;ï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé»˜è®¤&lt;code&gt;dump.rdb&lt;/code&gt;ï¼‰å®ç°æŒä¹…åŒ–ã€‚è§¦å‘æœºåˆ¶åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰‹åŠ¨è§¦å‘ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SAVE&lt;/code&gt;ï¼šä¸»çº¿ç¨‹æ‰§è¡Œï¼Œé˜»å¡æœåŠ¡ç›´åˆ°å®Œæˆï¼ˆ&lt;strong&gt;ç”Ÿäº§ç¯å¢ƒç¦ç”¨&lt;/strong&gt;ï¼‰&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BGSAVE&lt;/code&gt;ï¼šforkå­è¿›ç¨‹å¼‚æ­¥ç”Ÿæˆå¿«ç…§ï¼Œä¸»çº¿ç¨‹ä»…é˜»å¡çŸ­æš‚forkæ—¶é—´ï¼ˆ&lt;strong&gt;æ¨èæ–¹å¼&lt;/strong&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨è§¦å‘&lt;/strong&gt;ï¼šé€šè¿‡é…ç½®æ–‡ä»¶&lt;code&gt;save&lt;/code&gt;è§„åˆ™å®šæ—¶è§¦å‘ï¼ˆå¦‚&lt;code&gt;save 60 10000&lt;/code&gt;è¡¨ç¤º60ç§’å†…1ä¸‡æ¬¡ä¿®æ”¹è§¦å‘ï¼‰&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é…ç½®ç¤ºä¾‹"&gt;&lt;strong&gt;é…ç½®ç¤ºä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;save 900 1 # 900ç§’å†…è‡³å°‘1æ¬¡ä¿®æ”¹è§¦å‘
save 300 10 # 300ç§’å†…è‡³å°‘10æ¬¡ä¿®æ”¹
dir /data/rdb # RDBæ–‡ä»¶å­˜å‚¨è·¯å¾„
dbfilename dump.rdb
rdbcompression yes # å¯ç”¨LZFå‹ç¼©ï¼ˆé»˜è®¤å¼€å¯ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä¼˜ç¼ºç‚¹"&gt;&lt;strong&gt;ä¼˜ç¼ºç‚¹&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ–‡ä»¶å°ï¼ˆäºŒè¿›åˆ¶ç´§å‡‘ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ•°æ®ä¸¢å¤±é£é™©é«˜ï¼ˆä¸¢å¤±æœ€åä¸€æ¬¡å¿«ç…§åçš„æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¢å¤é€Ÿåº¦å¿«ï¼ˆç›´æ¥åŠ è½½å†…å­˜ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ— æ³•å®æ—¶æŒä¹…åŒ–ï¼ˆä¾èµ–å®šæ—¶è§¦å‘ï¼‰&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¯¹æ€§èƒ½å½±å“å°ï¼ˆå­è¿›ç¨‹æ‰§è¡Œï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;é¢‘ç¹å¿«ç…§å¯èƒ½é˜»å¡ä¸»çº¿ç¨‹ï¼ˆforkå¼€é”€ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ•°æ®å¤‡ä»½ã€ç¾éš¾æ¢å¤ã€å…è®¸åˆ†é’Ÿçº§æ•°æ®ä¸¢å¤±çš„ç¼“å­˜åœºæ™¯&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-aofappend-only-fileæ—¥å¿—æŒä¹…åŒ–"&gt;ğŸ“ &lt;strong&gt;AOFï¼ˆAppend Only Fileï¼‰æ—¥å¿—æŒä¹…åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸç†-1"&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;AOFè®°å½•&lt;strong&gt;æ‰€æœ‰å†™æ“ä½œå‘½ä»¤&lt;/strong&gt;ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰ï¼Œé€šè¿‡é‡æ”¾å‘½ä»¤æ¢å¤æ•°æ®ã€‚æµç¨‹åˆ†å››æ­¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å†™å‘½ä»¤è¿½åŠ åˆ°&lt;code&gt;aof_buf&lt;/code&gt;ç¼“å†²åŒº&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®
&lt;pre tabindex="0"&gt;&lt;code&gt;appendfsync
&lt;/code&gt;&lt;/pre&gt;ç­–ç•¥åˆ·ç›˜ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;always&lt;/code&gt;ï¼šæ¯æ¬¡å†™æ“ä½œåŒæ­¥ï¼ˆæ•°æ®æœ€å®‰å…¨ï¼Œæ€§èƒ½æœ€ä½ï¼‰&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;everysec&lt;/code&gt;ï¼šæ¯ç§’åŒæ­¥ï¼ˆ&lt;strong&gt;é»˜è®¤é…ç½®&lt;/strong&gt;ï¼Œå¹³è¡¡å®‰å…¨ä¸æ€§èƒ½ï¼‰&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;no&lt;/code&gt;ï¼šç”±æ“ä½œç³»ç»Ÿå†³å®šï¼ˆæ€§èƒ½æœ€é«˜ï¼Œå¯èƒ½ä¸¢å¤±30ç§’æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AOFé‡å†™&lt;/strong&gt;ï¼ˆ&lt;code&gt;BGREWRITEAOF&lt;/code&gt;ï¼‰ï¼šå‹ç¼©æ—¥å¿—ï¼ˆåˆå¹¶å‘½ä»¤ï¼‰ï¼Œè§£å†³æ–‡ä»¶è†¨èƒ€é—®é¢˜&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é‡å¯æ—¶é‡æ”¾AOFæ–‡ä»¶æ¢å¤æ•°æ®&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="é…ç½®ç¤ºä¾‹-1"&gt;&lt;strong&gt;é…ç½®ç¤ºä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;appendonly yes # å¯ç”¨AOF
appendfilename &amp;#34;appendonly.aof&amp;#34;
appendfsync everysec # æ¯ç§’åˆ·ç›˜
auto-aof-rewrite-percentage 100 # æ–‡ä»¶æ¯”ä¸Šæ¬¡é‡å†™å¤§100%æ—¶è§¦å‘
auto-aof-rewrite-min-size 64mb # æœ€å°é‡å†™æ–‡ä»¶å¤§å°
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä¼˜ç¼ºç‚¹-1"&gt;&lt;strong&gt;ä¼˜ç¼ºç‚¹&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ•°æ®å®‰å…¨æ€§é«˜ï¼ˆç§’çº§/å®æ—¶ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ–‡ä»¶ä½“ç§¯å¤§ï¼ˆè®°å½•æ¯æ¡å‘½ä»¤ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¯è¯»æ€§å¼ºï¼ˆæ–‡æœ¬æ ¼å¼æ˜“æ’æŸ¥ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ¢å¤é€Ÿåº¦æ…¢ï¼ˆéœ€é‡æ”¾æ‰€æœ‰å‘½ä»¤ï¼‰&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ”¯æŒé‡å†™å‹ç¼©å†å²å‘½ä»¤&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;é«˜é¢‘å†™å…¥æ—¶I/Oå‹åŠ›å¤§&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé‡‘èäº¤æ˜“ã€è®¢å•ç³»ç»Ÿç­‰å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚é«˜çš„åœºæ™¯&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ··åˆæŒä¹…åŒ–rdbaof"&gt;ğŸ”€ &lt;strong&gt;æ··åˆæŒä¹…åŒ–ï¼ˆRDB+AOFï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸç†-2"&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;Redis 4.0+å¼•å…¥ï¼Œ&lt;strong&gt;ç»“åˆRDBå¿«ç…§ä¸AOFå¢é‡å‘½ä»¤&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;AOFé‡å†™æ—¶&lt;/strong&gt;ï¼šé¦–å…ˆç”ŸæˆRDBæ ¼å¼æ•°æ®å†™å…¥æ–‡ä»¶å¤´éƒ¨ï¼Œåç»­å‘½ä»¤ä»¥AOFæ ¼å¼è¿½åŠ &lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¢å¤æ—¶&lt;/strong&gt;ï¼šå…ˆåŠ è½½RDBéƒ¨åˆ†å¿«é€Ÿæ¢å¤åŸºç¡€æ•°æ®ï¼Œå†æ‰§è¡ŒAOFå‘½ä»¤æ¢å¤å¢é‡æ“ä½œ&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é…ç½®ç¤ºä¾‹-2"&gt;&lt;strong&gt;é…ç½®ç¤ºä¾‹&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;appendonly yes
aof-use-rdb-preamble yes # å¯ç”¨æ··åˆæŒä¹…åŒ–
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="ä¼˜åŠ¿ä¸å±€é™"&gt;&lt;strong&gt;ä¼˜åŠ¿ä¸å±€é™&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;âœ… ä¼˜åŠ¿&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å¯åŠ¨é€Ÿåº¦&lt;strong&gt;å¿«äºçº¯AOF&lt;/strong&gt;ï¼ˆRDBåŸºç¡€æ•°æ®åŠ è½½å¿«ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®ä¸¢å¤±é£é™©&lt;strong&gt;ä½äºçº¯RDB&lt;/strong&gt;ï¼ˆAOFè®°å½•å¢é‡å‘½ä»¤ï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;âš ï¸ å±€é™&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶å¯è¯»æ€§å·®ï¼ˆå¤´éƒ¨ä¸ºäºŒè¿›åˆ¶RDBï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»…Redis 4.0+æ”¯æŒï¼Œä¸å‘ä¸‹å…¼å®¹æ—§ç‰ˆæœ¬&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚
&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šéœ€å…¼é¡¾æ¢å¤é€Ÿåº¦ä¸æ•°æ®å®‰å…¨çš„åœºæ™¯ï¼ˆå¦‚ç”µå•†å®æ—¶è®¢å•ï¼‰&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸‰ç§ç­–ç•¥å¯¹æ¯”ä¸é€‰å‹å»ºè®®"&gt;âš–ï¸ &lt;strong&gt;ä¸‰ç§ç­–ç•¥å¯¹æ¯”ä¸é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;RDB&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;AOF&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ··åˆæŒä¹…åŒ–&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®å¯é æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆå¯èƒ½ä¸¢å¤±åˆ†é’Ÿçº§æ•°æ®ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆç§’çº§/å®æ—¶ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆRDBåŸºç¡€+AOFå¢é‡ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¢å¤é€Ÿåº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;â­â­â­â­ï¼ˆå¿«ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­ï¼ˆæ…¢ï¼‰&lt;/td&gt;
&lt;td&gt;â­â­â­ï¼ˆè¾ƒå¿«ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ–‡ä»¶ä½“ç§¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å°ï¼ˆäºŒè¿›åˆ¶å‹ç¼©ï¼‰&lt;/td&gt;
&lt;td&gt;å¤§ï¼ˆæ–‡æœ¬è®°å½•å‘½ä»¤ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰ï¼ˆRDBå¤´éƒ¨+AOFå°¾éƒ¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½å½±å“&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆå­è¿›ç¨‹æ‰§è¡Œï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­é«˜ï¼ˆä¾èµ–åˆ·ç›˜ç­–ç•¥ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆé‡å†™æ—¶åˆå¹¶å¼€é”€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤‡ä»½ã€ç¼“å­˜&lt;/td&gt;
&lt;td&gt;é‡‘èã€è®¢å•ç­‰é«˜å¯é æ€§éœ€æ±‚&lt;/td&gt;
&lt;td&gt;å¹³è¡¡é€Ÿåº¦ä¸å®‰å…¨çš„é€šç”¨åœºæ™¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="é€‰å‹æŒ‡å—"&gt;&lt;strong&gt;é€‰å‹æŒ‡å—&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆæ··åˆæŒä¹…åŒ–&lt;/strong&gt;ï¼šRedis 4.0+é»˜è®¤æ¨èï¼Œå…¼é¡¾æ•ˆç‡ä¸å®‰å…¨&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¯RDB&lt;/strong&gt;ï¼šä»…ç”¨äºå…è®¸æ•°æ®ä¸¢å¤±çš„ç¼“å­˜æˆ–å¤‡ä»½åœºæ™¯&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¯AOF&lt;/strong&gt;ï¼šä»…å½“å¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚æé«˜ä¸”èƒ½å®¹å¿æ¢å¤å»¶è¿Ÿæ—¶ä½¿ç”¨&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸ä¼˜åŒ–å®è·µ"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸ä¼˜åŒ–å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é¿å…æ•°æ®ä¸¢å¤±ï¼š
&lt;ul&gt;
&lt;li&gt;RDBéœ€åˆç†é…ç½®&lt;code&gt;save&lt;/code&gt;è§„åˆ™ï¼ˆå¦‚&lt;code&gt;save 60 10000&lt;/code&gt;ï¼‰ï¼Œå‡å°‘ä¸¢å¤±çª—å£&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;AOFå»ºè®®ç”¨&lt;code&gt;appendfsync everysec&lt;/code&gt;ï¼Œé¿å…&lt;code&gt;always&lt;/code&gt;çš„æ€§èƒ½ç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ä¼˜åŒ–ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤§Keyå¤„ç†&lt;/strong&gt;ï¼šé¿å…å•ä¸ªKeyè¿‡å¤§å½±å“RDB/AOFé‡å†™ï¼ˆå¦‚æ‹†åˆ†Hashï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç£ç›˜IO&lt;/strong&gt;ï¼šAOFæ–‡ä»¶ä¸RDBåˆ†ç›˜å­˜å‚¨ï¼Œé¿å…IOç«äº‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®¹ç¾å¤‡ä»½ï¼š
&lt;ul&gt;
&lt;li&gt;å®šæœŸå¤‡ä»½RDB/AOFæ–‡ä»¶åˆ°å¼‚åœ°ï¼ˆå¦‚äº‘å­˜å‚¨ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;redis-check-aof&lt;/code&gt;/&lt;code&gt;redis-check-rdb&lt;/code&gt;æ ¡éªŒæ–‡ä»¶å®Œæ•´æ€§&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-4"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;RedisæŒä¹…åŒ–çš„æœ¬è´¨æ˜¯åœ¨&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;ã€&lt;strong&gt;å¯é æ€§&lt;/strong&gt;å’Œ&lt;strong&gt;èµ„æºå¼€é”€&lt;/strong&gt;é—´æƒè¡¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RDB&lt;/strong&gt;ï¼šç‰ºç‰²å®æ—¶æ€§æ¢é«˜æ•ˆå¤‡ä»½ï¼Œé€‚åˆå†·å¤‡åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AOF&lt;/strong&gt;ï¼šç‰ºç‰²å­˜å‚¨ç©ºé—´æ¢æ•°æ®å®‰å…¨ï¼Œé€‚åˆå…³é”®ä¸šåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ··åˆæŒä¹…åŒ–&lt;/strong&gt;ï¼šæŠ˜ä¸­æ–¹æ¡ˆï¼Œæ˜¯å¤šæ•°ç”Ÿäº§ç¯å¢ƒçš„&lt;strong&gt;æœ€ä¼˜è§£&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡å‘½ä»¤ &lt;code&gt;INFO PERSISTENCE&lt;/code&gt; å¯ç›‘æ§æŒä¹…åŒ–çŠ¶æ€ï¼Œç»“åˆä¸šåŠ¡éœ€æ±‚åŠ¨æ€è°ƒæ•´é…ç½®ï¼Œæœ€å¤§åŒ–å¹³è¡¡æ€§èƒ½ä¸æ•°æ®å®‰å…¨ ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="ç¼“å­˜æ·˜æ±°"&gt;ç¼“å­˜æ·˜æ±°
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ Redis ç¼“å­˜æ·˜æ±°ç­–ç•¥çš„å…¨é¢æ€»ç»“ï¼Œç»“åˆå…¶å®ç°åŸç†ã€é€‚ç”¨åœºæ™¯åŠé…ç½®å»ºè®®ï¼Œå¸®åŠ©é«˜æ•ˆç®¡ç†å†…å­˜èµ„æºï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ·˜æ±°ç­–ç•¥åˆ†ç±»"&gt;ğŸ”§ &lt;strong&gt;æ·˜æ±°ç­–ç•¥åˆ†ç±»&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redis æä¾› &lt;strong&gt;8 ç§ç­–ç•¥&lt;/strong&gt;ï¼Œåˆ†ä¸ºä¸‰å¤§ç±»å‹ï¼š&lt;/p&gt;
&lt;h4 id="ä¸æ·˜æ±°ç­–ç•¥"&gt;&lt;strong&gt;ä¸æ·˜æ±°ç­–ç•¥&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;noevictionï¼ˆé»˜è®¤ç­–ç•¥ï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¡Œä¸º&lt;/strong&gt;ï¼šå†…å­˜æ»¡æ—¶æ‹’ç»å†™å…¥æ“ä½œï¼ˆè¿”å› OOM é”™è¯¯ï¼‰ï¼Œä»…å…è®¸è¯»å’Œåˆ é™¤æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæ•°æ®ä¸å¯ä¸¢å¤±çš„æŒä¹…åŒ–å­˜å‚¨ï¼ˆå¦‚æ ¸å¿ƒé…ç½®ï¼‰&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä»…æ·˜æ±°æœ‰è¿‡æœŸæ—¶é—´çš„é”®"&gt;&lt;strong&gt;ä»…æ·˜æ±°æœ‰è¿‡æœŸæ—¶é—´çš„é”®ï¼ˆ&lt;code&gt;volatile-\*&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;volatile-lru&lt;/code&gt;&lt;/strong&gt;ï¼šåœ¨&lt;strong&gt;è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®&lt;/strong&gt;ä¸­ï¼Œæ·˜æ±°&lt;strong&gt;æœ€è¿‘æœ€å°‘ä½¿ç”¨&lt;/strong&gt;çš„é”®ï¼ˆLRU ç®—æ³•ï¼‰&lt;a class="link" href="@ref" &gt;1,3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;volatile-lfu&lt;/code&gt;&lt;/strong&gt;ï¼ˆRedis 4.0+ï¼‰ï¼šæ·˜æ±°&lt;strong&gt;ä½¿ç”¨é¢‘ç‡æœ€ä½&lt;/strong&gt;çš„é”®ï¼ˆLFU ç®—æ³•ï¼‰&lt;a class="link" href="@ref" &gt;3,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;volatile-ttl&lt;/code&gt;&lt;/strong&gt;ï¼šæ·˜æ±°&lt;strong&gt;å‰©ä½™ç”Ÿå­˜æ—¶é—´æœ€çŸ­&lt;/strong&gt;çš„é”®ï¼ˆä¼˜å…ˆæ¸…ç†æœ€æ—©è¿‡æœŸçš„æ•°æ®ï¼‰&lt;a class="link" href="@ref" &gt;1,4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;volatile-random&lt;/code&gt;&lt;/strong&gt;ï¼šéšæœºæ·˜æ±°è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ·˜æ±°æ‰€æœ‰é”®"&gt;&lt;strong&gt;æ·˜æ±°æ‰€æœ‰é”®ï¼ˆ&lt;code&gt;allkeys-\*&lt;/code&gt;ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;allkeys-lru&lt;/code&gt;&lt;/strong&gt;ï¼šä»&lt;strong&gt;æ‰€æœ‰é”®&lt;/strong&gt;ä¸­æ·˜æ±°&lt;strong&gt;æœ€è¿‘æœ€å°‘ä½¿ç”¨&lt;/strong&gt;çš„é”®&lt;a class="link" href="@ref" &gt;1,3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;allkeys-lfu&lt;/code&gt;&lt;/strong&gt;ï¼ˆRedis 4.0+ï¼‰ï¼šæ·˜æ±°&lt;strong&gt;ä½¿ç”¨é¢‘ç‡æœ€ä½&lt;/strong&gt;çš„é”®&lt;a class="link" href="@ref" &gt;3,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;allkeys-random&lt;/code&gt;&lt;/strong&gt;ï¼šéšæœºæ·˜æ±°ä»»æ„é”®&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒç®—æ³•åŸç†"&gt;âš™ï¸ &lt;strong&gt;æ ¸å¿ƒç®—æ³•åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="lruæœ€è¿‘æœ€å°‘ä½¿ç”¨"&gt;&lt;strong&gt;LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ç°&lt;/strong&gt;ï¼šè®°å½•æ¯ä¸ªé”®çš„æœ€åè®¿é—®æ—¶é—´æˆ³ï¼Œé€šè¿‡&lt;strong&gt;éšæœºé‡‡æ ·&lt;/strong&gt;ï¼ˆé»˜è®¤ 5 ä¸ªé”®ï¼‰æ·˜æ±°æœ€ä¹…æœªè®¿é—®çš„é”®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–&lt;/strong&gt;ï¼šä½¿ç”¨è¿‘ä¼¼ç®—æ³•é™ä½å†…å­˜å¼€é”€ï¼ˆéä¸¥æ ¼é“¾è¡¨ï¼Œç»´æŠ¤ 24 ä½æ—¶é—´æˆ³ï¼‰&lt;a class="link" href="@ref" &gt;3,6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šè®¿é—®æ¨¡å¼ç¨³å®šï¼Œéœ€ä¿ç•™&lt;strong&gt;è¿‘æœŸçƒ­ç‚¹æ•°æ®&lt;/strong&gt;ï¼ˆå¦‚ç”¨æˆ·ä¼šè¯ç¼“å­˜ï¼‰&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="lfuæœ€ä¸ç»å¸¸ä½¿ç”¨"&gt;&lt;strong&gt;LFUï¼ˆæœ€ä¸ç»å¸¸ä½¿ç”¨ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ç°&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;ä¸ºé”®åˆ†é… &lt;strong&gt;8 ä½è®¡æ•°å™¨&lt;/strong&gt;ï¼ˆå­˜å‚¨é¢‘æ¬¡å¯¹æ•°å€¼ï¼‰ï¼Œéšæ—¶é—´è¡°å‡ï¼ˆé¿å…æ—§æ•°æ®é•¿æœŸå ç”¨ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;éšæœºé‡‡æ ·æ·˜æ±°è®¡æ•°å™¨å€¼æœ€å°çš„é”®&lt;a class="link" href="@ref" &gt;6,7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šæ›´ç²¾å‡†è¯†åˆ«&lt;strong&gt;é•¿æœŸçƒ­ç‚¹æ•°æ®&lt;/strong&gt;ï¼ˆå¦‚çƒ­é—¨å•†å“æ’è¡Œï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹æ¯” LRU&lt;/strong&gt;ï¼šLRU å…³æ³¨è®¿é—®æ—¶é—´ï¼ŒLFU å…³æ³¨è®¿é—®é¢‘ç‡&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ttlå‰©ä½™ç”Ÿå­˜æ—¶é—´"&gt;&lt;strong&gt;TTLï¼ˆå‰©ä½™ç”Ÿå­˜æ—¶é—´ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ç›´æ¥æ·˜æ±°&lt;strong&gt;æœ€æ—©è¿‡æœŸ&lt;/strong&gt;çš„é”®ï¼Œæ— éœ€ç»Ÿè®¡è®¿é—®è¡Œä¸º&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é…ç½®ä¸æ€§èƒ½"&gt;âš¡ &lt;strong&gt;é…ç½®ä¸æ€§èƒ½&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é…ç½®æ–¹å¼"&gt;&lt;strong&gt;é…ç½®æ–¹å¼&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;# è®¾ç½®æœ€å¤§å†…å­˜ï¼ˆç¤ºä¾‹ï¼š2GBï¼‰
config set maxmemory 2gb
# è®¾ç½®æ·˜æ±°ç­–ç•¥ï¼ˆç¤ºä¾‹ï¼šallkeys-lruï¼‰
config set maxmemory-policy allkeys-lru
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å…³é”®å‚æ•°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;maxmemory&lt;/code&gt;ï¼šé™åˆ¶å†…å­˜ä¸Šé™ï¼ˆé»˜è®¤ 0ï¼Œå³æ— é™åˆ¶ï¼‰&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;maxmemory-samples&lt;/code&gt;ï¼šè°ƒæ•´ LRU/LFU é‡‡æ ·æ•°é‡ï¼ˆæé«˜ç²¾åº¦éœ€ç‰ºç‰² CPUï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ€§èƒ½å¯¹æ¯”"&gt;&lt;strong&gt;æ€§èƒ½å¯¹æ¯”&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ååé‡ (ops/sec)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å†…å­˜å‘½ä¸­ç‡&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;allkeys-lru&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;82,000&lt;/td&gt;
&lt;td&gt;89.3%&lt;/td&gt;
&lt;td&gt;é€šç”¨ç¼“å­˜ï¼ˆé»˜è®¤æ¨èï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;allkeys-lfu&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;78,500&lt;/td&gt;
&lt;td&gt;92.1%&lt;/td&gt;
&lt;td&gt;é•¿æœŸçƒ­ç‚¹æ•°æ®ï¼ˆå¦‚ç”µå•†æ¨èï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;volatile-ttl&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;75,200&lt;/td&gt;
&lt;td&gt;85.6%&lt;/td&gt;
&lt;td&gt;æ—¶æ•ˆæ•æ„Ÿæ•°æ®ï¼ˆä¼˜æƒ åˆ¸ï¼‰&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;allkeys-random&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;85,300&lt;/td&gt;
&lt;td&gt;82.4%&lt;/td&gt;
&lt;td&gt;æ— æ˜ç¡®è®¿é—®æ¨¡å¼&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é€‰å‹å»ºè®®-1"&gt;ğŸ¯ &lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ä¸šåŠ¡åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èç­–ç•¥&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç†ç”±&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çº¯ç¼“å­˜&lt;/strong&gt;ï¼ˆå…è®¸æ•°æ®ä¸¢å¤±ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;allkeys-lru&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¼˜å…ˆä¿ç•™è¿‘æœŸè®¿é—®æ•°æ®ï¼Œå¹³è¡¡å‘½ä¸­ç‡ä¸æ€§èƒ½&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;çƒ­ç‚¹æ•°æ®ç¼“å­˜&lt;/strong&gt;ï¼ˆå¦‚æ’è¡Œæ¦œï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;allkeys-lfu&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç²¾å‡†è¯†åˆ«é«˜é¢‘è®¿é—®é”®ï¼Œé¿å…å¶å‘è®¿é—®å¹²æ‰°&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ··åˆæŒä¹…åŒ–+ç¼“å­˜&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;volatile-lru&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä»…æ·˜æ±°å¸¦ TTL çš„é”®ï¼Œä¿æŠ¤æŒä¹…åŒ–æ•°æ®&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸´æ—¶æ•°æ®&lt;/strong&gt;ï¼ˆå¦‚ä¼šè¯ã€ä¼˜æƒ åˆ¸ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;volatile-ttl&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¼˜å…ˆæ¸…ç†æœ€æ—©è¿‡æœŸæ•°æ®ï¼Œç¬¦åˆä¸šåŠ¡é€»è¾‘&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ— è®¿é—®è§„å¾‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;allkeys-random&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¿«é€Ÿé‡Šæ”¾å†…å­˜ï¼Œé¿å…ç®—æ³•å¼€é”€&lt;a class="link" href="@ref" &gt;5,7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ç­–ç•¥ç”Ÿæ•ˆå‰æï¼š
&lt;ul&gt;
&lt;li&gt;å¿…é¡»è®¾ç½® &lt;code&gt;maxmemory &amp;gt; 0&lt;/code&gt;ï¼Œå¦åˆ™ç­–ç•¥æ— æ•ˆ&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®å®‰å…¨ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;volatile-*&lt;/code&gt; ç­–ç•¥éœ€ç¡®ä¿å…³é”®é”®è®¾ç½® TTLï¼Œå¦åˆ™å¯èƒ½è§¦å‘ &lt;code&gt;noeviction&lt;/code&gt; å¯¼è‡´å†™å…¥å¤±è´¥&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½è°ƒä¼˜ï¼š
&lt;ul&gt;
&lt;li&gt;é«˜é¢‘å†™å…¥åœºæ™¯ä¸­ï¼ŒLFU çš„è®¡æ•°å™¨è¡°å‡æœºåˆ¶å¯èƒ½å¢åŠ  CPU å¼€é”€ï¼ˆéœ€ç›‘æ§ &lt;code&gt;lfu-decay-time&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‰ˆæœ¬å…¼å®¹ï¼š
&lt;ul&gt;
&lt;li&gt;LFU ç­–ç•¥éœ€ Redis â‰¥4.0ï¼›æ—§ç‰ˆæœ¬ä¼˜å…ˆé€‰ LRU æˆ– TTL&lt;a class="link" href="@ref" &gt;3,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-5"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redis ç¼“å­˜æ·˜æ±°ç­–ç•¥æ˜¯å¹³è¡¡å†…å­˜ã€æ€§èƒ½ä¸ä¸šåŠ¡éœ€æ±‚çš„å…³é”®å·¥å…·ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆ &lt;code&gt;allkeys-lru/lfu&lt;/code&gt;&lt;/strong&gt;ï¼šé€‚ç”¨äºçº¯ç¼“å­˜åœºæ™¯ï¼Œæœ€å¤§åŒ–åˆ©ç”¨è®¿é—®è§„å¾‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ…ç”¨ &lt;code&gt;noeviction&lt;/code&gt;&lt;/strong&gt;ï¼šä»…é™ä¸å¯ä¸¢å¤±æ•°æ®çš„åœºæ™¯ï¼Œéœ€ä¸¥æ ¼ç›‘æ§å†…å­˜&lt;a class="link" href="@ref" &gt;1,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»„åˆç­–ç•¥&lt;/strong&gt;ï¼šç»“åˆ TTL è®¾ç½®ä¸ &lt;code&gt;volatile-*&lt;/code&gt; ç­–ç•¥ï¼Œç²¾ç»†åŒ–æ§åˆ¶æ·˜æ±°é€»è¾‘&lt;a class="link" href="@ref" &gt;4,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;INFO memory&lt;/code&gt; ç›‘æ§å†…å­˜ä½¿ç”¨ï¼Œç»“åˆä¸šåŠ¡æµé‡è°ƒæ•´ç­–ç•¥ï¼Œå¯æ˜¾è‘—æå‡ç¼“å­˜å‘½ä¸­ç‡ä¸ç³»ç»Ÿç¨³å®šæ€§ ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="é«˜å¯ç”¨"&gt;é«˜å¯ç”¨
&lt;/h2&gt;&lt;p&gt;Redisé«˜å¯ç”¨æ–¹æ¡ˆé€šè¿‡å¤šå±‚æ¬¡æŠ€æœ¯ç»„åˆï¼Œç¡®ä¿æœåŠ¡åœ¨æ•…éšœæ—¶æŒç»­å¯ç”¨å¹¶ä¿éšœæ•°æ®å®‰å…¨ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒæ¶æ„çš„æ·±åº¦è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸»ä»å¤åˆ¶master-slave"&gt;ğŸ”° &lt;strong&gt;ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slaveï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šæ•°æ®å†—ä½™ã€è¯»å†™åˆ†ç¦»ã€æ•…éšœæ¢å¤åŸºç¡€&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚
â€‹&lt;strong&gt;å·¥ä½œåŸç†&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŒæ­¥æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¨é‡åŒæ­¥&lt;/strong&gt;ï¼šä»èŠ‚ç‚¹é¦–æ¬¡è¿æ¥ä¸»èŠ‚ç‚¹æ—¶ï¼Œä¸»èŠ‚ç‚¹ç”ŸæˆRDBå¿«ç…§å¹¶ä¼ è¾“ï¼Œä»èŠ‚ç‚¹åŠ è½½æ•°æ®&lt;a class="link" href="@ref" &gt;1,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢é‡åŒæ­¥&lt;/strong&gt;ï¼ˆRedis 2.8+ï¼‰ï¼šæ–­çº¿é‡è¿åï¼Œé€šè¿‡&lt;strong&gt;å¤åˆ¶ç§¯å‹ç¼“å†²åŒº&lt;/strong&gt;ï¼ˆé»˜è®¤1MBï¼‰æ¢å¤æ–­ç‚¹åçš„æ•°æ®&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è¯»å†™åˆ†ç¦»ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸»èŠ‚ç‚¹å¤„ç†å†™è¯·æ±‚ï¼Œä»èŠ‚ç‚¹åˆ†æ‹…è¯»è¯·æ±‚ï¼ˆéœ€å®¢æˆ·ç«¯ä¸»åŠ¨åˆ†æµï¼‰&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚
&lt;strong&gt;å±€é™&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰‹åŠ¨æ•…éšœè½¬ç§»&lt;/strong&gt;ï¼šä¸»èŠ‚ç‚¹å®•æœºéœ€äººå·¥ä»‹å…¥åˆ‡æ¢ä»èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™æ€§èƒ½ç“¶é¢ˆ&lt;/strong&gt;ï¼šå†™æ“ä½œé›†ä¸­ä¸»èŠ‚ç‚¹ï¼Œæ— æ³•æ°´å¹³æ‰©å±•&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å“¨å…µæ¨¡å¼sentinel"&gt;ğŸš¨ &lt;strong&gt;å“¨å…µæ¨¡å¼ï¼ˆSentinelï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼š&lt;strong&gt;è‡ªåŠ¨åŒ–æ•…éšœè½¬ç§»&lt;/strong&gt;ï¼Œè§£å†³ä¸»ä»å¤åˆ¶çš„æ‰‹åŠ¨åˆ‡æ¢é—®é¢˜&lt;a class="link" href="@ref" &gt;1,6,7&lt;/a&gt;ã€‚
â€‹&lt;strong&gt;å·¥ä½œæœºåˆ¶&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç›‘æ§ä¸åˆ¤å®šï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»è§‚ä¸‹çº¿ï¼ˆSDOWNï¼‰&lt;/strong&gt;ï¼šå•ä¸ªå“¨å…µåˆ¤å®šèŠ‚ç‚¹æ— å“åº”ï¼ˆé»˜è®¤30ç§’è¶…æ—¶ï¼‰&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢è§‚ä¸‹çº¿ï¼ˆODOWNï¼‰&lt;/strong&gt;ï¼šå¤šä¸ªå“¨å…µï¼ˆâ‰¥é…ç½®æ•°ï¼‰ç¡®è®¤ä¸»èŠ‚ç‚¹ä¸‹çº¿åè§¦å‘æ•…éšœè½¬ç§»&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€‰ä¸¾ä¸åˆ‡æ¢ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Leaderé€‰ä¸¾&lt;/strong&gt;ï¼šå“¨å…µèŠ‚ç‚¹é€šè¿‡&lt;strong&gt;Raftç®—æ³•&lt;/strong&gt;é€‰ä¸¾Leaderæ‰§è¡Œæ•…éšœè½¬ç§»&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–°ä¸»èŠ‚ç‚¹é€‰ä¸¾&lt;/strong&gt;ï¼šåŸºäºä¼˜å…ˆçº§ï¼ˆ&lt;code&gt;slave-priority&lt;/code&gt;ï¼‰ã€å¤åˆ¶åç§»é‡ï¼ˆæ•°æ®å®Œæ•´æ€§ï¼‰ã€è¿è¡ŒIDæœ€å°åŸåˆ™é€‰æ‹©ä»èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯é‡å®šå‘ï¼š
&lt;ul&gt;
&lt;li&gt;å“¨å…µé€šçŸ¥å®¢æˆ·ç«¯æ–°ä¸»èŠ‚ç‚¹åœ°å€ï¼Œæ”¯æŒåŠ¨æ€åˆ‡æ¢è¿æ¥&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚
&lt;strong&gt;é…ç½®ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;sentinel monitor mymaster 192.168.1.100 6379 2 # éœ€2ä¸ªå“¨å…µç¡®è®¤ä¸»èŠ‚ç‚¹ä¸‹çº¿
sentinel down-after-milliseconds mymaster 30000 # 30ç§’æ— å“åº”åˆ¤ä¸ºä¸»è§‚ä¸‹çº¿
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;å±€é™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å†™æ‰©å±•ä¸è¶³&lt;/strong&gt;ï¼šä»ä¾èµ–å•ä¸»èŠ‚ç‚¹å†™æ“ä½œ&lt;a class="link" href="@ref" &gt;3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è„‘è£‚é£é™©&lt;/strong&gt;ï¼šç½‘ç»œåˆ†åŒºå¯èƒ½å¯¼è‡´å¤šä¸»èŠ‚ç‚¹ï¼ˆéœ€è‡³å°‘3ä¸ªå“¨å…µèŠ‚ç‚¹é¿å…ï¼‰&lt;a class="link" href="@ref" &gt;7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-clusteré›†ç¾¤æ¨¡å¼åˆ†å¸ƒå¼é«˜å¯ç”¨"&gt;ğŸŒ &lt;strong&gt;Clusteré›†ç¾¤æ¨¡å¼ï¼ˆåˆ†å¸ƒå¼é«˜å¯ç”¨ï¼‰&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒèƒ½åŠ›&lt;/strong&gt;ï¼š&lt;strong&gt;æ•°æ®åˆ†ç‰‡&lt;/strong&gt; + &lt;strong&gt;å¤šä¸»èŠ‚ç‚¹è´Ÿè½½å‡è¡¡&lt;/strong&gt; + &lt;strong&gt;è‡ªåŠ¨æ•…éšœè½¬ç§»&lt;/strong&gt;&lt;a class="link" href="@ref" &gt;2,3,5&lt;/a&gt;ã€‚
â€‹&lt;strong&gt;æ¶æ„åŸç†&lt;/strong&gt;â€‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ•°æ®åˆ†ç‰‡ï¼š
&lt;ul&gt;
&lt;li&gt;æ•°æ®æŒ‰&lt;strong&gt;å“ˆå¸Œæ§½ï¼ˆHash Slotï¼‰&lt;/strong&gt; åˆ†ç‰‡ï¼ˆå…±16384æ§½ï¼‰ï¼Œæ¯ä¸ªä¸»èŠ‚ç‚¹è´Ÿè´£éƒ¨åˆ†æ§½ä½&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é«˜å¯ç”¨å®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»ä»å†—ä½™&lt;/strong&gt;ï¼šæ¯ä¸ªä¸»èŠ‚ç‚¹é…ç½®1+ä»èŠ‚ç‚¹ï¼Œä¸»å®•æœºæ—¶ä»èŠ‚ç‚¹æ¥æ›¿æ§½ä½èŒè´£&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gossipåè®®&lt;/strong&gt;ï¼šèŠ‚ç‚¹é—´äº¤æ¢çŠ¶æ€ä¿¡æ¯ï¼Œå®æ—¶æ„ŸçŸ¥é›†ç¾¤å˜åŒ–&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•…éšœè½¬ç§»æµç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸»èŠ‚ç‚¹å®¢è§‚ä¸‹çº¿ â†’ ä»èŠ‚ç‚¹å‘èµ·é€‰ä¸¾ â†’ å¤šæ•°èŠ‚ç‚¹åŒæ„ååˆ‡æ¢ä¸ºæ–°ä¸»èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;2,8&lt;/a&gt;ã€‚
&lt;strong&gt;éƒ¨ç½²å‘½ä»¤&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;redis-cli --cluster create 192.168.1.100:6379 192.168.1.101:6379 ... --cluster-replicas 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ°´å¹³æ‰©å±•&lt;/strong&gt;ï¼šæ”¯æŒTBçº§æ•°æ®ä¸ç™¾ä¸‡çº§QPS&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ— ç¼å®¹ç¾&lt;/strong&gt;ï¼šæ•…éšœè½¬ç§»ç§’çº§å®Œæˆï¼ˆé»˜è®¤15ç§’è¶…æ—¶åˆ¤å®šï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æŒä¹…åŒ–ä¸æ•°æ®å®‰å…¨"&gt;ğŸ’¾ &lt;strong&gt;æŒä¹…åŒ–ä¸æ•°æ®å®‰å…¨&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šæ•…éšœæ¢å¤æ—¶ä¿éšœæ•°æ®å®Œæ•´æ€§ï¼Œæ”¯æ’‘é«˜å¯ç”¨åº•å±‚&lt;a class="link" href="@ref" &gt;1,4,5&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;RDBå¿«ç…§&lt;/strong&gt;ï¼šå®šæ—¶å…¨é‡å¤‡ä»½ï¼Œæ¢å¤å¿«ä½†å¯èƒ½ä¸¢æ•°æ®&lt;a class="link" href="@ref" &gt;1,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AOFæ—¥å¿—&lt;/strong&gt;ï¼šè®°å½•å†™å‘½ä»¤ï¼Œæ•°æ®å®‰å…¨é«˜ä½†æ¢å¤æ…¢&lt;a class="link" href="@ref" &gt;4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ··åˆæŒä¹…åŒ–&lt;/strong&gt;ï¼ˆRedis 4.0+ï¼‰ï¼šRDBå¿«ç…§ + AOFå¢é‡ï¼Œå¹³è¡¡é€Ÿåº¦ä¸å®‰å…¨&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ–¹æ¡ˆé€‰å‹å¯¹æ¯”"&gt;âš–ï¸ &lt;strong&gt;æ–¹æ¡ˆé€‰å‹å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸»ä»å¤åˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è¯»å¤šå†™å°‘ã€æ•°æ®å¤‡ä»½&lt;/td&gt;
&lt;td&gt;ç®€å•æ˜“éƒ¨ç½²ã€è¯»å†™åˆ†ç¦»&lt;/td&gt;
&lt;td&gt;æ‰‹åŠ¨æ•…éšœè½¬ç§»ã€å†™æ€§èƒ½ç“¶é¢ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å“¨å…µæ¨¡å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸­å°è§„æ¨¡ã€è‡ªåŠ¨åŒ–å®¹ç¾&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨æ•…éšœè½¬ç§»ã€é…ç½®ç®€å•&lt;/td&gt;
&lt;td&gt;å†™æ— æ³•æ‰©å±•ã€ç½‘ç»œåˆ†åŒºé£é™©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Clusteré›†ç¾¤&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤§æ•°æ®é‡ã€é«˜å¹¶å‘ã€å¼ºæ‰©å±•éœ€æ±‚&lt;/td&gt;
&lt;td&gt;æ•°æ®åˆ†ç‰‡ã€å¤šä¸»å†™ã€è‡ªåŠ¨å®¹ç¾&lt;/td&gt;
&lt;td&gt;éƒ¨ç½²å¤æ‚ã€è·¨æ§½äº‹åŠ¡ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-é«˜å¯ç”¨æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;é«˜å¯ç”¨æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å¤šèŠ‚ç‚¹éƒ¨ç½²ï¼š
&lt;ul&gt;
&lt;li&gt;å“¨å…µè‡³å°‘3èŠ‚ç‚¹é˜²è„‘è£‚&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;ï¼›Clusterå»ºè®®6èŠ‚ç‚¹èµ·ï¼ˆ3ä¸»3ä»ï¼‰&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æ§å‘Šè­¦ï¼š
&lt;ul&gt;
&lt;li&gt;å®æ—¶è·Ÿè¸ªèŠ‚ç‚¹çŠ¶æ€ã€å†…å­˜ä½¿ç”¨ã€å¤åˆ¶å»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;4,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®¹é‡è§„åˆ’ï¼š
&lt;ul&gt;
&lt;li&gt;Clusteråˆ†ç‰‡é¢„ç•™20%æ§½ä½ä¾¿äºæ‰©å®¹&lt;a class="link" href="@ref" &gt;2,3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯å…¼å®¹æ€§ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨æ”¯æŒClusterå’ŒSentinelçš„å®¢æˆ·ç«¯ï¼ˆå¦‚Jedisã€Lettuceï¼‰&lt;a class="link" href="@ref" &gt;2,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-6"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redisé«˜å¯ç”¨æ¶æ„éœ€åˆ†å±‚è®¾è®¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€å±‚&lt;/strong&gt;ï¼šä¸»ä»å¤åˆ¶ + æŒä¹…åŒ–ä¿éšœæ•°æ®å†—ä½™ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§åˆ¶å±‚&lt;/strong&gt;ï¼šå“¨å…µå®ç°æ•…éšœè½¬ç§»è‡ªåŠ¨åŒ–ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•å±‚&lt;/strong&gt;ï¼šClusteré›†ç¾¤çªç ´æ€§èƒ½ä¸å®¹é‡ç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;3,5,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®é™…é€‰å‹éœ€ç»¼åˆ&lt;strong&gt;æ•°æ®è§„æ¨¡&lt;/strong&gt;ã€&lt;strong&gt;æ€§èƒ½éœ€æ±‚&lt;/strong&gt;åŠ&lt;strong&gt;è¿ç»´å¤æ‚åº¦&lt;/strong&gt;ï¼Œä¸­å°åœºæ™¯ç”¨å“¨å…µï¼Œæµ·é‡æ•°æ®é€‰Cluster ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="redis-cluster"&gt;REDIS CLUSTER
&lt;/h2&gt;&lt;p&gt;Redis Cluster æ˜¯ Redis å®˜æ–¹æä¾›çš„åˆ†å¸ƒå¼é›†ç¾¤æ–¹æ¡ˆï¼Œé€šè¿‡&lt;strong&gt;æ— ä¸­å¿ƒåŒ–æ¶æ„&lt;/strong&gt;ã€&lt;strong&gt;å“ˆå¸Œæ§½åˆ†ç‰‡&lt;/strong&gt;å’Œ&lt;strong&gt;ä¸»ä»è‡ªåŠ¨æ•…éšœè½¬ç§»&lt;/strong&gt;å®ç°é«˜å¯ç”¨ä¸æ°´å¹³æ‰©å±•ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€æ¶æ„è®¾è®¡ã€æ­å»ºé…ç½®åˆ°åº”ç”¨å®è·µå±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŸç†ä¸æ¶æ„è®¾è®¡"&gt;ğŸ”§ &lt;strong&gt;æ ¸å¿ƒåŸç†ä¸æ¶æ„è®¾è®¡&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ— ä¸­å¿ƒåŒ–æ¶æ„"&gt;&lt;strong&gt;æ— ä¸­å¿ƒåŒ–æ¶æ„&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚ç‚¹äº’è”&lt;/strong&gt;ï¼šæ‰€æœ‰èŠ‚ç‚¹é€šè¿‡ &lt;strong&gt;PING-PONG æœºåˆ¶&lt;/strong&gt;ç›´è¿ï¼ˆäºŒè¿›åˆ¶åè®®é«˜æ•ˆé€šä¿¡ï¼‰ï¼Œå®¢æˆ·ç«¯è¿æ¥ä»»æ„èŠ‚ç‚¹å³å¯è®¿é—®æ•´ä¸ªé›†ç¾¤&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åˆ†ç‰‡&lt;/strong&gt;ï¼šé‡‡ç”¨ &lt;strong&gt;16384 ä¸ªå“ˆå¸Œæ§½ï¼ˆSlotï¼‰&lt;/strong&gt;ï¼Œæ¯ä¸ªé”®é€šè¿‡ &lt;code&gt;CRC16(key) % 16384&lt;/code&gt; è®¡ç®—æ‰€å±æ§½ä½ï¼Œæ§½ä½åˆ†å¸ƒåœ¨ä¸åŒèŠ‚ç‚¹ä¸Šï¼ˆå¦‚èŠ‚ç‚¹Aè´Ÿè´£0-5460æ§½ï¼‰&lt;a class="link" href="@ref" &gt;2,4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;# è®¡ç®—é”® &amp;#34;user:1001&amp;#34; çš„æ§½ä½
redis-cli&amp;gt; CLUSTER KEYSLOT &amp;#34;user:1001&amp;#34;
(integer) 1523 # å½’å±èŠ‚ç‚¹Bï¼ˆè‹¥Bè´Ÿè´£5461-10922æ§½ï¼‰[4](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é«˜å¯ç”¨æœºåˆ¶"&gt;&lt;strong&gt;é«˜å¯ç”¨æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸»ä»å¤åˆ¶&lt;/strong&gt;ï¼šæ¯ä¸ªä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰é…ç½®1ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ï¼ˆSlaveï¼‰ã€‚ä¸»èŠ‚ç‚¹æ•…éšœæ—¶ï¼Œä»èŠ‚ç‚¹è‡ªåŠ¨å‡ä¸»&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ•…éšœæ£€æµ‹ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸»è§‚ä¸‹çº¿ï¼ˆSDOWNï¼‰ï¼šå•èŠ‚ç‚¹è®¤ä¸ºç›®æ ‡èŠ‚ç‚¹å¤±è”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®¢è§‚ä¸‹çº¿ï¼ˆODOWNï¼‰ï¼šè¶…åŠæ•°èŠ‚ç‚¹ç¡®è®¤å¤±è”ï¼Œè§¦å‘è‡ªåŠ¨æ•…éšœè½¬ç§»&lt;a class="link" href="@ref" &gt;2,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®ä¸€è‡´æ€§"&gt;&lt;strong&gt;æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼‚æ­¥å¤åˆ¶&lt;/strong&gt;ï¼šä¸»èŠ‚ç‚¹å†™æ“ä½œå¼‚æ­¥åŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼Œæç«¯æƒ…å†µå¯èƒ½ä¸¢å¤±å°‘é‡æ•°æ®ï¼ˆå¼ºä¸€è‡´æ€§éœ€ä¸šåŠ¡å±‚ä¿éšœï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ§½ä½è¿ç§»åŸå­æ€§&lt;/strong&gt;ï¼šæ‰©å®¹/ç¼©å®¹æ—¶ï¼Œæ§½ä½æ•°æ®åˆ†æ‰¹è¿ç§»ï¼ŒæœŸé—´é›†ç¾¤ä»å¯ç”¨&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-é›†ç¾¤æ­å»ºä¸é…ç½®"&gt;âš™ï¸ &lt;strong&gt;é›†ç¾¤æ­å»ºä¸é…ç½®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="èŠ‚ç‚¹é…ç½®"&gt;&lt;strong&gt;èŠ‚ç‚¹é…ç½®&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æ¯ä¸ªèŠ‚ç‚¹éœ€å¯ç”¨é›†ç¾¤æ¨¡å¼å¹¶æŒ‡å®šé…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# redis.conf å…³é”®é…ç½®
port 6379
cluster-enabled yes
cluster-config-file nodes-6379.conf # èŠ‚ç‚¹æ‹“æ‰‘è‡ªåŠ¨ä¿å­˜
cluster-node-timeout 15000 # èŠ‚ç‚¹å¤±è”è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰
cluster-require-full-coverage no # éƒ¨åˆ†èŠ‚ç‚¹å®•æœºä¸å½±å“å…¶ä»–æ§½ä½[4,6](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="é›†ç¾¤åˆå§‹åŒ–"&gt;&lt;strong&gt;é›†ç¾¤åˆå§‹åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;6èŠ‚ç‚¹é›†ç¾¤ï¼ˆ3ä¸»3ä»ï¼‰æ­å»ºå‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;redis-cli --cluster create \
192.168.1.10:6379 192.168.1.10:6380 192.168.1.11:6379 \
192.168.1.11:6380 192.168.1.12:6379 192.168.1.12:6380 \
--cluster-replicas 1 # æ¯ä¸ªä¸»èŠ‚ç‚¹é…1ä¸ªä»èŠ‚ç‚¹[4](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šèŠ‚ç‚¹éœ€åœ¨ä¸åŒç‰©ç†æœºéƒ¨ç½²ï¼Œé¿å…å•ç‚¹æ•…éšœ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id="é›†ç¾¤ç®¡ç†å‘½ä»¤"&gt;&lt;strong&gt;é›†ç¾¤ç®¡ç†å‘½ä»¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æŸ¥çœ‹èŠ‚ç‚¹æ‹“æ‰‘ï¼š&lt;code&gt;CLUSTER NODES&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ‰‹åŠ¨æ•…éšœè½¬ç§»ï¼š&lt;code&gt;CLUSTER FAILOVER&lt;/code&gt;ï¼ˆç»´æŠ¤æ—¶ä¸»åŠ¨åˆ‡æ¢ï¼‰&lt;/li&gt;
&lt;li&gt;æ§½ä½è¿ç§»ï¼š&lt;code&gt;CLUSTER ADDSLOTS&lt;/code&gt; å’Œ &lt;code&gt;CLUSTER DELSLOTS&lt;/code&gt;&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å®¢æˆ·ç«¯è®¿é—®ä¸æ•°æ®æ“ä½œ"&gt;âš¡ &lt;strong&gt;å®¢æˆ·ç«¯è®¿é—®ä¸æ•°æ®æ“ä½œ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="å®¢æˆ·ç«¯é‡å®šå‘"&gt;&lt;strong&gt;å®¢æˆ·ç«¯é‡å®šå‘&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MOVED å“åº”&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯è®¿é—®é”™è¯¯æ§½ä½æ—¶ï¼ŒèŠ‚ç‚¹è¿”å› &lt;code&gt;MOVED &amp;lt;slot&amp;gt; &amp;lt;ç›®æ ‡èŠ‚ç‚¹IP:ç«¯å£&amp;gt;&lt;/code&gt;ï¼Œå®¢æˆ·ç«¯é‡å®šå‘åˆ°ç›®æ ‡èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;4,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ASK é‡å®šå‘&lt;/strong&gt;ï¼šæ§½ä½è¿ç§»ä¸­ä¸´æ—¶é‡å®šå‘ï¼Œéœ€å…ˆå‘ &lt;code&gt;ASKING&lt;/code&gt; å‘½ä»¤&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¤šé”®æ“ä½œé™åˆ¶"&gt;&lt;strong&gt;å¤šé”®æ“ä½œé™åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¨æ§½ä½é™åˆ¶&lt;/strong&gt;ï¼š&lt;code&gt;MGET&lt;/code&gt;ã€&lt;code&gt;MSET&lt;/code&gt; ç­‰å‘½ä»¤éœ€æ‰€æœ‰é”®åœ¨åŒä¸€æ§½ä½ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ {} å®šä¹‰é”®å“ˆå¸Œæ ‡ç­¾ï¼Œå¼ºåˆ¶åŒæ§½ä½å­˜å‚¨ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;MSET user:{1001}:name &amp;#34;Alice&amp;#34; user:{1001}:age 30 # ä»…æ ¹æ® &amp;#34;1001&amp;#34; è®¡ç®—æ§½ä½[4](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ•…éšœæ¢å¤ä¸æ‰©å®¹"&gt;âš ï¸ &lt;strong&gt;æ•…éšœæ¢å¤ä¸æ‰©å®¹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ•…éšœæ¢å¤åœºæ™¯"&gt;&lt;strong&gt;æ•…éšœæ¢å¤åœºæ™¯&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¤„ç†æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¸»èŠ‚ç‚¹å®•æœº&lt;/td&gt;
&lt;td&gt;ä»èŠ‚ç‚¹å‡ä¸»ï¼ŒåŸä¸»æ¢å¤åå˜ä¸ºæ–°ä¸»ä»èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;2,6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸»ä»åŒæ—¶å®•æœº&lt;/td&gt;
&lt;td&gt;è‹¥ &lt;code&gt;cluster-require-full-coverage=no&lt;/code&gt;ï¼Œä»…å®•æœºæ§½ä½ä¸å¯ç”¨ï¼Œå…¶ä»–æ§½ä½æ­£å¸¸æœåŠ¡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç½‘ç»œåˆ†åŒº&lt;/td&gt;
&lt;td&gt;å°‘æ•°èŠ‚ç‚¹åˆ†åŒºåæš‚åœæœåŠ¡ï¼Œæ¢å¤åè‡ªåŠ¨åŒæ­¥æ•°æ®&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="åŠ¨æ€æ‰©å®¹æ­¥éª¤"&gt;&lt;strong&gt;åŠ¨æ€æ‰©å®¹æ­¥éª¤&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;æ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼š&lt;code&gt;redis-cli --cluster add-node &amp;lt;æ–°èŠ‚ç‚¹IP:ç«¯å£&amp;gt; &amp;lt;é›†ç¾¤ä»»æ„èŠ‚ç‚¹IP:ç«¯å£&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¿ç§»æ§½ä½ï¼šä»ç°æœ‰èŠ‚ç‚¹æŠ½å–éƒ¨åˆ†æ§½ä½ç»™æ–°èŠ‚ç‚¹ï¼ˆå¦‚ä»Aã€Bã€Cå„å–1000æ§½ï¼‰&lt;/li&gt;
&lt;li&gt;æ·»åŠ ä»èŠ‚ç‚¹ï¼š&lt;code&gt;redis-cli --cluster add-node --slave --master-id &amp;lt;ä¸»èŠ‚ç‚¹ID&amp;gt;&lt;/code&gt;&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-javaå®¢æˆ·ç«¯è®¿é—®"&gt;ğŸ’» &lt;strong&gt;Javaå®¢æˆ·ç«¯è®¿é—®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="jedis-è¿æ¥é›†ç¾¤"&gt;&lt;strong&gt;Jedis è¿æ¥é›†ç¾¤&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;Set&amp;lt;HostAndPort&amp;gt; nodes = new HashSet&amp;lt;&amp;gt;();
nodes.add(new HostAndPort(&amp;#34;192.168.1.10&amp;#34;, 6379));
nodes.add(new HostAndPort(&amp;#34;192.168.1.11&amp;#34;, 6379));
// æ·»åŠ æ‰€æœ‰èŠ‚ç‚¹...
JedisCluster jedisCluster = new JedisCluster(nodes);
jedisCluster.set(&amp;#34;key&amp;#34;, &amp;#34;value&amp;#34;); // è‡ªåŠ¨å¤„ç†é‡å®šå‘[5](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šé•¿è¿æ¥ç®¡ç†éœ€è°¨æ…ï¼Œé¿å…æ³„æ¼&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id="lettuce-è¿æ¥é›†ç¾¤æ¨è"&gt;&lt;strong&gt;Lettuce è¿æ¥é›†ç¾¤ï¼ˆæ¨èï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;RedisClusterClient clusterClient = RedisClusterClient.create(&amp;#34;redis://192.168.1.10:6379&amp;#34;);
StatefulRedisClusterConnection&amp;lt;String, String&amp;gt; connection = clusterClient.connect();
RedisAdvancedClusterCommands&amp;lt;String, String&amp;gt; commands = connection.sync();
commands.set(&amp;#34;key&amp;#34;, &amp;#34;value&amp;#34;); // åŸºäºNettyï¼Œæ”¯æŒå¼‚æ­¥IO[5](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šè¿æ¥æ± ç®¡ç†æ›´é«˜æ•ˆï¼Œé€‚åˆé«˜å¹¶å‘&lt;a class="link" href="@ref" &gt;5&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-redisé›†ç¾¤æ–¹æ¡ˆå¯¹æ¯”"&gt;ğŸ“Š &lt;strong&gt;Redisé›†ç¾¤æ–¹æ¡ˆå¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä¸»ä»å¤åˆ¶&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å“¨å…µæ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Clusteræ¨¡å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•°æ®åˆ†å¸ƒ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å…¨é‡å¤åˆ¶&lt;/td&gt;
&lt;td&gt;å…¨é‡å¤åˆ¶&lt;/td&gt;
&lt;td&gt;åˆ†ç‰‡å­˜å‚¨ï¼ˆ16384æ§½ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰©å®¹å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒåœ¨çº¿æ‰©å®¹&lt;/td&gt;
&lt;td&gt;å¤æ‚&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;æ”¯æŒåŠ¨æ€æ‰©ç¼©å®¹&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é«˜å¯ç”¨æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰‹åŠ¨åˆ‡æ¢&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨åˆ‡æ¢&lt;/td&gt;
&lt;td&gt;è‡ªåŠ¨åˆ‡æ¢+åˆ†åŒºå®¹å¿&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨è§„æ¨¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&amp;lt; 10èŠ‚ç‚¹&lt;/td&gt;
&lt;td&gt;&amp;lt; 100èŠ‚ç‚¹&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&amp;gt; 100èŠ‚ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®¢æˆ·ç«¯å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç®€å•&lt;/td&gt;
&lt;td&gt;ä¸­ç­‰&lt;/td&gt;
&lt;td&gt;éœ€å¤„ç†é‡å®šå‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹"&gt;âš ï¸ &lt;strong&gt;ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ§½ä½å‡è¡¡&lt;/strong&gt;ï¼šå®šæœŸæ£€æŸ¥ &lt;code&gt;CLUSTER SLOTS&lt;/code&gt;ï¼Œé¿å…æ•°æ®å€¾æ–œ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒä¹…åŒ–é…ç½®&lt;/strong&gt;ï¼šæ‰€æœ‰èŠ‚ç‚¹å¼€å¯ &lt;code&gt;AOF + RDB&lt;/code&gt;ï¼Œé˜²æ­¢é‡å¯åé›†ç¾¤çŠ¶æ€ä¸¢å¤±&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å†…æ ¸ä¼˜åŒ–ï¼šå…³é—­é€æ˜å¤§é¡µï¼ˆTHPï¼‰ï¼Œé¿å…å†…å­˜å»¶è¿Ÿï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;echo never &amp;gt; /sys/kernel/mm/transparent_hugepage/enabled[3](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¦å®½é¢„ç•™&lt;/strong&gt;ï¼šèŠ‚ç‚¹é—´é€šä¿¡å ç”¨å¸¦å®½ï¼Œå»ºè®®åƒå…†ç½‘ç»œ&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-7"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redis Cluster é€šè¿‡&lt;strong&gt;åˆ†ç‰‡è´Ÿè½½&lt;/strong&gt;ã€&lt;strong&gt;ä¸»ä»é«˜å¯ç”¨&lt;/strong&gt;å’Œ&lt;strong&gt;æ— ä¸­å¿ƒåŒ–&lt;/strong&gt;æ¶æ„ï¼Œæˆä¸ºç™¾ä¸‡çº§å¹¶å‘åœºæ™¯çš„é¦–é€‰æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;ï¼šæµ·é‡æ•°æ®ï¼ˆå¦‚ç”µå•†åº“å­˜ï¼‰ã€é«˜å¹¶å‘è¯»å†™ï¼ˆå¦‚å®æ—¶è®¡æ•°å™¨ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§„é¿é™·é˜±&lt;/strong&gt;ï¼šé¿å…è·¨æ§½ä½å¤šé”®æ“ä½œã€åˆç†è®¾ç½® &lt;code&gt;cluster-node-timeout&lt;/code&gt;ï¼ˆå»ºè®®15-30ç§’ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼”è¿›è¶‹åŠ¿&lt;/strong&gt;ï¼šäº‘æœåŠ¡å•†ï¼ˆå¦‚AWS ElastiCacheï¼‰å·²åŸºäºClusteræä¾›æ‰˜ç®¡æœåŠ¡ï¼Œè¿›ä¸€æ­¥é™ä½è¿ç»´æˆæœ¬&lt;a class="link" href="@ref" &gt;2&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="åˆ†å¸ƒå¼é”"&gt;åˆ†å¸ƒå¼é”
&lt;/h2&gt;&lt;p&gt;Redisåˆ†å¸ƒå¼é”æ˜¯ä¸€ç§åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°è·¨è¿›ç¨‹/è·¨èŠ‚ç‚¹äº’æ–¥è®¿é—®å…±äº«èµ„æºçš„æœºåˆ¶ï¼Œé€šè¿‡Redisçš„åŸå­æ“ä½œå’Œå•çº¿ç¨‹ç‰¹æ€§ä¿è¯é”çš„å®‰å…¨æ€§ã€‚ä»¥ä¸‹ä»&lt;strong&gt;æ ¸å¿ƒåŸç†ã€å®ç°æ¼”è¿›ã€å…³é”®é—®é¢˜åŠä¼˜åŒ–æ–¹æ¡ˆ&lt;/strong&gt;å±•å¼€è¯¦ç»†è§£æï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-redisåˆ†å¸ƒå¼é”çš„æ ¸å¿ƒåŸç†"&gt;ğŸ”’ &lt;strong&gt;Redisåˆ†å¸ƒå¼é”çš„æ ¸å¿ƒåŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºç¡€å‘½ä»¤"&gt;&lt;strong&gt;åŸºç¡€å‘½ä»¤ï¼š&lt;code&gt;SET key value NX PX&lt;/code&gt;&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;NX&lt;/code&gt;ï¼ˆNot eXistsï¼‰&lt;/strong&gt;ï¼šä»…å½“Keyä¸å­˜åœ¨æ—¶è®¾ç½®å€¼ï¼Œç¡®ä¿äº’æ–¥æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;PX&lt;/code&gt;ï¼ˆæ¯«ç§’çº§è¿‡æœŸæ—¶é—´ï¼‰&lt;/strong&gt;ï¼šè®¾ç½®é”è‡ªåŠ¨é‡Šæ”¾æ—¶é—´ï¼Œé¿å…æ­»é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å”¯ä¸€æ ‡è¯†ï¼ˆvalueï¼‰&lt;/strong&gt;ï¼šä½¿ç”¨UUIDç­‰å”¯ä¸€å€¼æ ‡è®°é”æŒæœ‰è€…ï¼Œé˜²æ­¢è¯¯åˆ &lt;a class="link" href="@ref" &gt;1,4,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SET lock:order 8a9f3c PX 30000 NX # 30ç§’åè‡ªåŠ¨é‡Šæ”¾
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="åŸå­æ€§é‡Šæ”¾é”luaè„šæœ¬"&gt;&lt;strong&gt;åŸå­æ€§é‡Šæ”¾é”ï¼šLuaè„šæœ¬&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;é‡Šæ”¾é”æ—¶éœ€éªŒè¯æŒæœ‰è€…èº«ä»½å¹¶åˆ é™¤Keyï¼Œé€šè¿‡Luaè„šæœ¬ä¿è¯åŸå­æ€§ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;if redis.call(&amp;#34;GET&amp;#34;, KEYS[1]) == ARGV[1] then
return redis.call(&amp;#34;DEL&amp;#34;, KEYS[1])
else
return 0
end
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ­¤è„šæœ¬é˜²æ­¢åœ¨&lt;strong&gt;åˆ¤æ–­æŒæœ‰è€…ä¸åˆ é™¤æ“ä½œä¹‹é—´&lt;/strong&gt;å‘ç”Ÿé”è¿‡æœŸæˆ–ç«äº‰é—®é¢˜&lt;a class="link" href="@ref" &gt;4,5,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id="é”ç»­æœŸæœºåˆ¶watch-dog"&gt;&lt;strong&gt;é”ç»­æœŸæœºåˆ¶ï¼ˆWatch Dogï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šä¸šåŠ¡æ‰§è¡Œæ—¶é—´å¯èƒ½è¶…è¿‡é”è¿‡æœŸæ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼šåå°çº¿ç¨‹å®šæœŸï¼ˆå¦‚æ¯éš”10ç§’ï¼‰æ£€æŸ¥é”çŠ¶æ€å¹¶åˆ·æ–°è¿‡æœŸæ—¶é—´ï¼ˆç»­æœŸï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;// Redisson çš„ Watch Dog å®ç°
RedissonLock lock = redisson.getLock(&amp;#34;lock&amp;#34;);
lock.lock(30, TimeUnit.SECONDS); // è‡ªåŠ¨ç»­æœŸ
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id="-å®ç°æ¼”è¿›ä»é’é“œåˆ°é’»çŸ³æ–¹æ¡ˆ"&gt;ğŸ”§ &lt;strong&gt;å®ç°æ¼”è¿›ï¼šä»é’é“œåˆ°é’»çŸ³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ ¸å¿ƒé€»è¾‘&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¼ºé™·&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è§£å†³æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é’é“œæ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»…ç”¨ &lt;code&gt;SETNX&lt;/code&gt; åŠ é”&lt;/td&gt;
&lt;td&gt;æ­»é”ï¼ˆæœªè®¾è¿‡æœŸæ—¶é—´ï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ å¼ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç™½é“¶æ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SETNX&lt;/code&gt; + &lt;code&gt;EXPIRE&lt;/code&gt; åˆ†æ­¥æ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;ä¸¤æ­¥æ“ä½œéåŸå­æ€§ï¼ˆè®¾è¿‡æœŸæ—¶é—´å¯èƒ½å¤±è´¥ï¼‰&lt;/td&gt;
&lt;td&gt;âš ï¸ å¼ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é»„é‡‘æ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SET key value NX EX&lt;/code&gt; åŸå­å‘½ä»¤&lt;/td&gt;
&lt;td&gt;é”è¿‡æœŸåè¢«å…¶ä»–å®¢æˆ·ç«¯æŠ¢å ï¼ŒåŸæŒæœ‰è€…è¯¯åˆ ä»–äººé”&lt;/td&gt;
&lt;td&gt;â¡ï¸ å¼•å…¥å”¯ä¸€æ ‡è¯†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é“‚é‡‘æ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é»„é‡‘æ–¹æ¡ˆ + å”¯ä¸€æ ‡è¯† + éåŸå­åˆ¤æ–­é‡Šæ”¾&lt;/td&gt;
&lt;td&gt;åˆ¤æ–­æŒæœ‰è€…ä¸åˆ é™¤æ“ä½œä¹‹é—´é”å¯èƒ½è¿‡æœŸ&lt;/td&gt;
&lt;td&gt;â¡ï¸ Luaè„šæœ¬ä¿è¯åŸå­æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é’»çŸ³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é“‚é‡‘æ–¹æ¡ˆ + Luaè„šæœ¬é‡Šæ”¾é”&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;âœ… ç”Ÿäº§çº§æ–¹æ¡ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;é’»çŸ³æ–¹æ¡ˆæ˜¯&lt;strong&gt;ç”Ÿäº§ç¯å¢ƒæ¨èæ ‡å‡†&lt;/strong&gt;ï¼ŒRedissonç­‰å®¢æˆ·ç«¯åº“å·²å†…ç½®æ­¤å®ç°&lt;a class="link" href="@ref" &gt;4,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"&gt;âš ï¸ &lt;strong&gt;å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é”è¯¯åˆ é—®é¢˜"&gt;&lt;strong&gt;é”è¯¯åˆ é—®é¢˜&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼š
çº¿ç¨‹Aå› é˜»å¡å¯¼è‡´é”è¿‡æœŸ â†’ çº¿ç¨‹Bè·å–é” â†’ çº¿ç¨‹Aæ¢å¤ååˆ é™¤Bçš„é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
é‡Šæ”¾é”æ—¶éªŒè¯å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚UUID+çº¿ç¨‹IDï¼‰ï¼Œç¡®ä¿åªèƒ½åˆ é™¤è‡ªå·±çš„é”&lt;a class="link" href="@ref" &gt;5,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ä¸»ä»åˆ‡æ¢å¯¼è‡´é”ä¸¢å¤±"&gt;&lt;strong&gt;ä¸»ä»åˆ‡æ¢å¯¼è‡´é”ä¸¢å¤±&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼š
ä¸»èŠ‚ç‚¹å†™å…¥é”åå®•æœº â†’ ä»èŠ‚ç‚¹æ™‹å‡ä¸ºä¸»èŠ‚ç‚¹ â†’ æ–°å®¢æˆ·ç«¯å¯è·å–åŒä¸€æŠŠé”ï¼ˆåŸé”æœªåŒæ­¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RedLockç®—æ³•&lt;/strong&gt;ï¼šåœ¨å¤šä¸ªç‹¬ç«‹Rediså®ä¾‹ä¸Šè·å–é”ï¼ˆN/2+1æˆåŠŸæ‰ç®—è·å–æˆåŠŸï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±€é™æ€§&lt;/strong&gt;ï¼šæ€§èƒ½ä½ã€éƒ¨ç½²å¤æ‚ï¼Œå¤šæ•°åœºæ™¯ä¸‹é’»çŸ³æ–¹æ¡ˆå·²è¶³å¤Ÿ&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é”é‡å…¥é—®é¢˜"&gt;&lt;strong&gt;é”é‡å…¥é—®é¢˜&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šåŒä¸€çº¿ç¨‹å†…å¤šæ¬¡è·å–åŒä¸€æŠŠé”ï¼ˆå¦‚é€’å½’è°ƒç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Redissoné€šè¿‡Hashç»“æ„è®°å½•çº¿ç¨‹IDå’Œé‡å…¥æ¬¡æ•°ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;HINCRBY lock:order thread:1 1 # é‡å…¥æ¬¡æ•°+1
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é”ç­‰å¾…ä¸å…¬å¹³æ€§"&gt;&lt;strong&gt;é”ç­‰å¾…ä¸å…¬å¹³æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯è‡ªæ—‹é‡è¯•&lt;/strong&gt;ï¼šç®€å•ä½†å¯èƒ½å¯¼è‡´Rediså‹åŠ›å¤§&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Redissonçš„æ’é˜Ÿæœºåˆ¶&lt;/strong&gt;ï¼šåŸºäºRedisçš„å‘å¸ƒè®¢é˜…å®ç°å…¬å¹³é”&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æœ€ä½³å®è·µä¸ä¼˜åŒ–"&gt;ğŸ› ï¸ &lt;strong&gt;æœ€ä½³å®è·µä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é”ç²’åº¦æ§åˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;ç»†ç²’åº¦é”ï¼ˆå¦‚è®¢å•IDçº§ï¼‰å‡å°‘ç«äº‰ï¼Œæå‡å¹¶å‘æ€§&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è¶…æ—¶æ—¶é—´è®¾ç½®ï¼š
&lt;ul&gt;
&lt;li&gt;æ ¹æ®ä¸šåŠ¡è€—æ—¶åŠ¨æ€è°ƒæ•´ï¼ˆå¦‚å¹³å‡è€—æ—¶çš„2å€ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æ§ä¸æ—¥å¿—ï¼š
&lt;ul&gt;
&lt;li&gt;è®°å½•é”è·å–/é‡Šæ”¾æ—¶é—´ã€æŒæœ‰è€…ä¿¡æ¯ï¼Œä¾¿äºé—®é¢˜è¿½è¸ª&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ›¿ä»£æ–¹æ¡ˆé€‰æ‹©ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºä¸€è‡´æ€§åœºæ™¯&lt;/strong&gt;ï¼šç”¨ZooKeeperæ›¿ä»£ï¼ˆç‰ºç‰²æ€§èƒ½æ¢å®‰å…¨æ€§ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¹¶å‘åœºæ™¯&lt;/strong&gt;ï¼šRedisé” + æœ¬åœ°é”ç»“åˆå‡å°‘Redisè°ƒç”¨&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯"&gt;ğŸ’ &lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é”ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç§’æ€åº“å­˜æ‰£å‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é¿å…è¶…å–&lt;/td&gt;
&lt;td&gt;é”ä½å•†å“IDï¼Œä¿è¯åº“å­˜è®¡ç®—åŸå­æ€§&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼“å­˜é‡å»º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é˜²æ­¢ç¼“å­˜å‡»ç©¿ï¼ˆå¤šä¸ªçº¿ç¨‹åŒæ—¶é‡å»ºç¼“å­˜ï¼‰&lt;/td&gt;
&lt;td&gt;é”ä½æ•°æ®Keyï¼Œä»…ä¸€ä¸ªçº¿ç¨‹æŸ¥DB&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¡®ä¿é›†ç¾¤ä¸­ä»…ä¸€ä¸ªèŠ‚ç‚¹æ‰§è¡Œå®šæ—¶ä»»åŠ¡&lt;/td&gt;
&lt;td&gt;é”ä½ä»»åŠ¡ID&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="æ€»ç»“-1"&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Redisåˆ†å¸ƒå¼é”ä»¥&lt;strong&gt;åŸå­æ“ä½œ+å”¯ä¸€æ ‡è¯†+Luaè„šæœ¬&lt;/strong&gt;ä¸ºæ ¸å¿ƒï¼Œå¹³è¡¡æ€§èƒ½ä¸å®‰å…¨æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;æ¨èæ–¹æ¡ˆ&lt;/strong&gt;ï¼šé’»çŸ³æ–¹æ¡ˆï¼ˆå”¯ä¸€æ ‡è¯† + Luaé‡Šæ”¾ï¼‰æ»¡è¶³å¤šæ•°åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;âš ï¸ &lt;strong&gt;é¿å‘ç‚¹&lt;/strong&gt;ï¼šé¿å…é•¿äº‹åŠ¡é˜»å¡å¯¼è‡´é”è¿‡æœŸï¼›ä¸»ä»æ¶æ„ä¸‹ä¼˜å…ˆç”¨Redis Clusterã€‚&lt;/li&gt;
&lt;li&gt;ğŸ”§ &lt;strong&gt;å·¥å…·é€‰æ‹©&lt;/strong&gt;ï¼šç”Ÿäº§ç¯å¢ƒæ¨èRedissonï¼ˆå†…ç½®Watch Dogã€å¯é‡å…¥é”ç­‰é«˜çº§ç‰¹æ€§ï¼‰&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡å‘½ä»¤ &lt;code&gt;TTL lock:key&lt;/code&gt; ç›‘æ§é”çŠ¶æ€ï¼Œç»“åˆæ—¥å¿—åˆ†æé”ç«äº‰æƒ…å†µï¼Œå¯ä¼˜åŒ–é”è¶…æ—¶æ—¶é—´å’Œå¹¶å‘ç­–ç•¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="nx"&gt;NX
&lt;/h2&gt;&lt;p&gt;Redis ä¸­çš„ &lt;strong&gt;&lt;code&gt;NX&lt;/code&gt;&lt;/strong&gt;ï¼ˆ*&lt;em&gt;Not eXists*&lt;/em&gt;ï¼‰æ˜¯ä¸€ä¸ªæ ¸å¿ƒå‚æ•°ï¼Œç”¨äºåœ¨æ“ä½œä¸­å¼ºåˆ¶æ£€æŸ¥é”®çš„å­˜åœ¨æ€§ï¼Œç¡®ä¿æ“ä½œä»…åœ¨é”®&lt;strong&gt;ä¸å­˜åœ¨&lt;/strong&gt;æ—¶æ‰§è¡Œã€‚å®ƒæ˜¯å®ç°åŸå­æ€§æ§åˆ¶ï¼ˆå¦‚åˆ†å¸ƒå¼é”ã€å¹‚ç­‰æ€§ï¼‰çš„å…³é”®å·¥å…·ã€‚ä»¥ä¸‹ä»åŸç†ã€ç”¨æ³•ã€åœºæ™¯åŠæœ€ä½³å®è·µå±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-nx-çš„æ ¸å¿ƒåŸç†"&gt;ğŸ”‘ &lt;strong&gt;NX çš„æ ¸å¿ƒåŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="ä½œç”¨æœºåˆ¶"&gt;&lt;strong&gt;ä½œç”¨æœºåˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¡ä»¶é™åˆ¶&lt;/strong&gt;ï¼š&lt;code&gt;NX&lt;/code&gt; è¦æ±‚æ“ä½œä»…åœ¨é”®&lt;strong&gt;ä¸å­˜åœ¨&lt;/strong&gt;æ—¶ç”Ÿæ•ˆã€‚è‹¥é”®å·²å­˜åœ¨ï¼Œæ“ä½œè¢«æ‹’ç»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ€§ä¿éšœ&lt;/strong&gt;ï¼šRedis å•çº¿ç¨‹æ¨¡å‹ç¡®ä¿ &lt;code&gt;NX&lt;/code&gt; æ“ä½œæ˜¯åŸå­çš„ï¼Œå¤šä¸ªå®¢æˆ·ç«¯å¹¶å‘æ—¶ä»…æœ‰ä¸€ä¸ªæˆåŠŸ&lt;a class="link" href="@ref" &gt;1,3,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å‘½ä»¤è¯­æ³•"&gt;&lt;strong&gt;å‘½ä»¤è¯­æ³•&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€æ ¼å¼&lt;/strong&gt;ï¼š&lt;code&gt;SET key value NX&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ ¼å¼&lt;/strong&gt;ï¼šæ”¯æŒç»“åˆè¿‡æœŸæ—¶é—´å‚æ•°ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SET key value NX EX 10 # é”®ä¸å­˜åœ¨æ—¶è®¾ç½®å€¼ï¼Œ10ç§’åè¿‡æœŸ
SET key value NX PX 5000 # æ¯«ç§’çº§è¿‡æœŸæ—¶é—´[8,9](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **è¿”å›å€¼**
- **æˆåŠŸ**ï¼šè¿”å› `OK`ï¼ˆ`SET NX`ï¼‰æˆ– `1`ï¼ˆ`SETNX`ï¼‰ã€‚
- **å¤±è´¥**ï¼šè¿”å› `(nil)` æˆ– `0`ï¼ˆé”®å·²å­˜åœ¨ï¼‰[3,9](@ref)ã€‚
------
### âš™ï¸ **NX çš„å…·ä½“ä½¿ç”¨åœºæ™¯**
#### **åˆ†å¸ƒå¼é”ï¼ˆæ ¸å¿ƒåº”ç”¨ï¼‰**
- å®ç°é€»è¾‘ï¼š
- è·å–é”ï¼š`SET lock_key unique_id NX EX 10`
ï¼ˆ`unique_id` ä¸ºå®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ï¼Œé˜²æ­¢è¯¯åˆ ï¼‰
- é‡Šæ”¾é”ï¼šLua è„šæœ¬éªŒè¯ unique_id å¹¶åŸå­åˆ é™¤ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;if redis.call(&amp;ldquo;GET&amp;rdquo;, KEYS[1]) == ARGV[1] then
return redis.call(&amp;ldquo;DEL&amp;rdquo;, KEYS[1])
end
```&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;ï¼šé¿å…æ­»é”ï¼ˆè‡ªåŠ¨è¿‡æœŸï¼‰ + é˜²è¯¯åˆ ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰&lt;a class="link" href="@ref" &gt;3,4,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="å¹‚ç­‰æ€§æ§åˆ¶"&gt;&lt;strong&gt;å¹‚ç­‰æ€§æ§åˆ¶&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯ä¸¾ä¾‹&lt;/strong&gt;ï¼šæ”¯ä»˜å»é‡ã€é‡å¤æäº¤é˜²æŠ¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œç¤ºä¾‹&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SET order:1234 &amp;#34;processing&amp;#34; NX EX 30 # è®¢å•IDä¸ºé”®ï¼Œä»…é¦–æ¬¡è¯·æ±‚æˆåŠŸ
&lt;/code&gt;&lt;/pre&gt;è‹¥é”®å­˜åœ¨ï¼ˆå³è¯·æ±‚å·²å¤„ç†ï¼‰ï¼Œæ‹’ç»é‡å¤æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ•°æ®åˆå§‹åŒ–"&gt;&lt;strong&gt;æ•°æ®åˆå§‹åŒ–&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šé¦–æ¬¡å¯åŠ¨æ—¶åˆå§‹åŒ–é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;SET config:max_users 1000 NX # ä»…å½“é…ç½®ä¸å­˜åœ¨æ—¶è®¾ç½®é»˜è®¤å€¼
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-setnx-vs-set-nxåŒºåˆ«ä¸é€‰å‹"&gt;âš–ï¸ &lt;strong&gt;SETNX vs SET NXï¼šåŒºåˆ«ä¸é€‰å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å°½ç®¡åŠŸèƒ½ç›¸ä¼¼ï¼Œä¸¤è€…æœ‰&lt;strong&gt;å…³é”®å·®å¼‚&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;SETNX&lt;/code&gt; å‘½ä»¤&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;&lt;code&gt;SET key NX&lt;/code&gt;&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… æ˜¯&lt;/td&gt;
&lt;td&gt;âœ… æ˜¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ”¯æŒè¿‡æœŸæ—¶é—´&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âŒ éœ€é¢å¤–è°ƒç”¨ &lt;code&gt;EXPIRE&lt;/code&gt;ï¼ˆéåŸå­ï¼‰&lt;/td&gt;
&lt;td&gt;âœ… åŸç”Ÿæ”¯æŒ &lt;code&gt;EX&lt;/code&gt;/&lt;code&gt;PX&lt;/code&gt;ï¼ˆåŸå­æ“ä½œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1ï¼ˆæˆåŠŸï¼‰æˆ– 0ï¼ˆå¤±è´¥ï¼‰&lt;/td&gt;
&lt;td&gt;OKï¼ˆæˆåŠŸï¼‰æˆ– nilï¼ˆå¤±è´¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Redis æ—§ç‰ˆæœ¬å…¼å®¹&lt;/td&gt;
&lt;td&gt;âœ… ç”Ÿäº§ç¯å¢ƒé¦–é€‰ï¼ˆå°¤å…¶åˆ†å¸ƒå¼é”ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å®˜æ–¹æ¨è&lt;/strong&gt;ï¼šä¼˜å…ˆä½¿ç”¨ &lt;code&gt;SET key value NX EX seconds&lt;/code&gt;ï¼Œé¿å… &lt;code&gt;SETNX + EXPIRE&lt;/code&gt; çš„éåŸå­æ€§é£é™©&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¿å…æ­»é”&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¿…é¡»è®¾ç½®è¿‡æœŸæ—¶é—´&lt;/strong&gt;ï¼šå¦‚ &lt;code&gt;EX 10&lt;/code&gt;ï¼Œé˜²æ­¢å®¢æˆ·ç«¯å´©æºƒåé”æ— æ³•é‡Šæ”¾&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»­æœŸæœºåˆ¶&lt;/strong&gt;ï¼šå¯¹é•¿ä»»åŠ¡ä½¿ç”¨ Watch Dogï¼ˆå¦‚ Redissonï¼‰è‡ªåŠ¨åˆ·æ–°é”æ—¶é—´&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜²è¯¯åˆ é”&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;é‡Šæ”¾é”æ—¶éœ€éªŒè¯&lt;strong&gt;å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†&lt;/strong&gt;ï¼ˆå¦‚ UUIDï¼‰ï¼Œé˜²æ­¢é‡Šæ”¾ä»–äººæŒæœ‰çš„é”&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜å¯ç”¨ç¯å¢ƒ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸»ä»æ¶æ„ä¸‹å¯èƒ½å› ä¸»ä»åŒæ­¥å»¶è¿Ÿå¯¼è‡´é”ä¸¢å¤±ï¼ˆå¦‚ä¸»èŠ‚ç‚¹å®•æœºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼šä½¿ç”¨ RedLock ç®—æ³•ï¼ˆå¤šå®ä¾‹æŠ•ç¥¨ï¼‰æˆ–åˆ‡è‡³ Redis Cluster&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›¿ä»£æ–¹æ¡ˆ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼ºä¸€è‡´æ€§éœ€æ±‚&lt;/strong&gt;ï¼šè€ƒè™‘ ZooKeeperï¼ˆç‰ºç‰²æ€§èƒ½æ¢å®‰å…¨æ€§ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-8"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;NX çš„æœ¬è´¨&lt;/strong&gt;ï¼šé€šè¿‡é”®å­˜åœ¨æ€§æ£€æŸ¥å®ç°åŸå­æ“ä½œï¼Œæ˜¯åˆ†å¸ƒå¼äº’æ–¥æ§åˆ¶çš„åŸºçŸ³ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒä»·å€¼&lt;/strong&gt;ï¼šåœ¨åˆ†å¸ƒå¼é”ã€å¹‚ç­‰æ§åˆ¶ã€åˆå§‹åŒ–ç­‰åœºæ™¯ä¸­ç¡®ä¿æ“ä½œçš„&lt;strong&gt;å®‰å…¨æ€§ä¸ä¸€è‡´æ€§&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³å®è·µ&lt;/strong&gt;ï¼š
âœ… ä¼˜å…ˆä½¿ç”¨ &lt;code&gt;SET NX EX&lt;/code&gt; åŸå­å‘½ä»¤æ›¿ä»£ &lt;code&gt;SETNX&lt;/code&gt;ï¼›
âœ… ç»“åˆå”¯ä¸€æ ‡è¯† + Lua è„šæœ¬é‡Šæ”¾é”ï¼›
âœ… ç›‘æ§é”ç«äº‰ï¼ˆ&lt;code&gt;TTL lock_key&lt;/code&gt;ï¼‰å¹¶ä¼˜åŒ–è¶…æ—¶æ—¶é—´&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡å‘½ä»¤ &lt;code&gt;INFO KEYSPACE&lt;/code&gt; å¯è§‚å¯Ÿé”®çŠ¶æ€ï¼Œç»“åˆä¸šåŠ¡æµé‡è°ƒæ•´ç­–ç•¥ï¼Œæœ€å¤§åŒ–ç³»ç»Ÿé²æ£’æ€§ ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å»¶æ—¶æ¶ˆæ¯"&gt;å»¶æ—¶æ¶ˆæ¯
&lt;/h2&gt;&lt;p&gt;Redis å»¶æ—¶æ¶ˆæ¯æ˜¯ä¸€ç§åˆ©ç”¨ Redis å®ç°æ¶ˆæ¯å»¶è¿ŸæŠ•é€’çš„æœºåˆ¶ï¼Œé€‚ç”¨äºè®¢å•è¶…æ—¶å–æ¶ˆã€å®šæ—¶æé†’ç­‰åœºæ™¯ã€‚å…¶æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡æœ‰åºé›†åˆï¼ˆZSETï¼‰å­˜å‚¨æ¶ˆæ¯ï¼Œä»¥æ—¶é—´æˆ³ä½œä¸ºåˆ†æ•°ï¼ˆscoreï¼‰å®ç°æ¶ˆæ¯çš„å»¶è¿Ÿè°ƒåº¦ã€‚ä»¥ä¸‹ä»å®ç°åŸç†ã€åº”ç”¨åœºæ™¯ã€æŠ€æœ¯æ–¹æ¡ˆåŠä¼˜åŒ–ç­–ç•¥å±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-å®ç°åŸç†"&gt;ğŸ”§ &lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŸºäº-zset-çš„æœ‰åºå­˜å‚¨"&gt;&lt;strong&gt;åŸºäº ZSET çš„æœ‰åºå­˜å‚¨&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æ•°æ®ç»“æ„ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Key&lt;/strong&gt;ï¼šå»¶æ—¶é˜Ÿåˆ—åç§°ï¼ˆå¦‚ &lt;code&gt;delay_queue&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Score&lt;/strong&gt;ï¼šæ¶ˆæ¯åˆ°æœŸæ—¶é—´æˆ³ï¼ˆå½“å‰æ—¶é—´ + å»¶è¿Ÿæ—¶é—´ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Value&lt;/strong&gt;ï¼šæ¶ˆæ¯å”¯ä¸€æ ‡è¯†æˆ–å†…å®¹ï¼ˆå¦‚è®¢å•IDï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‘½ä»¤ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ZADD delay_queue &amp;lt;åˆ°æœŸæ—¶é—´æˆ³&amp;gt; &amp;lt;æ¶ˆæ¯ID&amp;gt; # æ·»åŠ å»¶æ—¶æ¶ˆæ¯[1,3,4](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ¶ˆæ¯æ¶ˆè´¹æµç¨‹"&gt;&lt;strong&gt;æ¶ˆæ¯æ¶ˆè´¹æµç¨‹&lt;/strong&gt;
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;è½®è¯¢åˆ°æœŸæ¶ˆæ¯ï¼š
&lt;ul&gt;
&lt;li&gt;æ¶ˆè´¹è€…å®šæœŸæ‰§è¡Œ &lt;code&gt;ZRANGEBYSCORE key 0 &amp;lt;å½“å‰æ—¶é—´æˆ³&amp;gt; LIMIT 0 1&lt;/code&gt;ï¼Œè·å–å·²åˆ°æœŸçš„æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
Set&lt;String&gt; messages = jedis.zrangeByScore(&amp;ldquo;delay_queue&amp;rdquo;, 0, System.currentTimeMillis(), 0, 1);
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;åŸå­æ€§ç§»é™¤ä¸å¤„ç†ï¼š
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ Lua è„šæœ¬åˆå¹¶æŸ¥è¯¢ä¸åˆ é™¤æ“ä½œï¼Œé¿å…å¹¶å‘ç«äº‰ï¼ˆå¦‚å¤šä¸ªæ¶ˆè´¹è€…äº‰æŠ¢åŒä¸€æ¶ˆæ¯ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;local message = redis.call(&amp;#39;ZRANGEBYSCORE&amp;#39;, KEYS[1], 0, ARGV[1], &amp;#39;LIMIT&amp;#39;, 0, 1)
if #message &amp;gt; 0 then
redis.call(&amp;#39;ZREM&amp;#39;, KEYS[1], message[1])
return message[1]
end
return nil
&lt;/code&gt;&lt;/pre&gt;è°ƒç”¨è„šæœ¬ç¡®ä¿â€œæŸ¥åˆ â€åŸå­æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-åº”ç”¨åœºæ™¯-2"&gt;âš¡ &lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¡ˆä¾‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æŠ€æœ¯å®ç°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è®¢å•è¶…æ—¶å–æ¶ˆ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç”¨æˆ·ä¸‹å•å30åˆ†é’Ÿæœªæ”¯ä»˜è‡ªåŠ¨å…³é—­è®¢å•&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯å»¶è¿Ÿæ—¶é—´è®¾ä¸º30åˆ†é’Ÿï¼Œè§¦å‘è®¢å•çŠ¶æ€æ›´æ–°&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®šæ—¶æé†’&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤–å–è®¢å•è·è¶…æ—¶å‰10åˆ†é’Ÿæ¨é€é€šçŸ¥&lt;/td&gt;
&lt;td&gt;è®¾ç½®å»¶è¿Ÿæ—¶é—´æˆ³ï¼Œåˆ°æœŸè§¦å‘æ¨é€æœåŠ¡&lt;a class="link" href="@ref" &gt;8,10&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é‡è¯•æœºåˆ¶&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯å¤„ç†å¤±è´¥åå»¶è¿Ÿ5åˆ†é’Ÿé‡è¯•&lt;/td&gt;
&lt;td&gt;å¤±è´¥æ¶ˆæ¯é‡æ–°æ’å…¥ZSETå¹¶æ›´æ–°åˆ†æ•°&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é›†ç¾¤èŠ‚ç‚¹åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œä»»åŠ¡ï¼ˆå¦‚æ•°æ®å¤‡ä»½ï¼‰&lt;/td&gt;
&lt;td&gt;ä»»åŠ¡IDä½œä¸ºValueï¼Œæ‰§è¡Œæ—¶é—´ä½œä¸ºScore&lt;a class="link" href="@ref" &gt;8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æŠ€æœ¯æ–¹æ¡ˆ"&gt;ğŸ› ï¸ &lt;strong&gt;æŠ€æœ¯æ–¹æ¡ˆ&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ–¹æ¡ˆä¸€åŸç”Ÿ-zset--è½®è¯¢"&gt;&lt;strong&gt;æ–¹æ¡ˆä¸€ï¼šåŸç”Ÿ ZSET + è½®è¯¢&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿäº§è€…&lt;/strong&gt;ï¼š&lt;code&gt;ZADD&lt;/code&gt; æ·»åŠ æ¶ˆæ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆè´¹è€…&lt;/strong&gt;ï¼šå®šæ—¶ä»»åŠ¡è½®è¯¢ ZSETï¼ŒLua è„šæœ¬åŸå­åŒ–æ¶ˆè´¹æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå®ç°ç®€å•ï¼Œæ— éœ€é¢å¤–ç»„ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šé¢‘ç¹è½®è¯¢å¢åŠ  Redis è´Ÿè½½ï¼›éœ€å¤„ç†å¹¶å‘ç«äº‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ–¹æ¡ˆäºŒredisson-é«˜çº§é˜Ÿåˆ—"&gt;&lt;strong&gt;æ–¹æ¡ˆäºŒï¼šRedisson é«˜çº§é˜Ÿåˆ—&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»„ä»¶&lt;/strong&gt;ï¼š&lt;code&gt;RDelayedQueue&lt;/code&gt; + &lt;code&gt;RBlockingQueue&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æµç¨‹ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;// ç”Ÿäº§è€…
delayedQueue.offer(&amp;#34;message_1&amp;#34;, 5, TimeUnit.SECONDS); // å»¶è¿Ÿ5ç§’æŠ•é€’[1,10](@ref)
// æ¶ˆè´¹è€…
String message = blockingQueue.take(); // é˜»å¡ç­‰å¾…åˆ°æœŸæ¶ˆæ¯
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿ï¼š
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨è½¬ç§»æ¶ˆæ¯ï¼šåˆ°æœŸåä»å»¶è¿Ÿé˜Ÿåˆ—ç§»è‡³é˜»å¡é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ”¯æŒé˜»å¡ç­‰å¾…ï¼Œå‡å°‘ç©ºè½®è¯¢å¼€é”€&lt;a class="link" href="@ref" &gt;1&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æ–¹æ¡ˆä¸‰å¤šçº§åˆ†ç‰‡é˜Ÿåˆ—é«˜å¹¶å‘ä¼˜åŒ–"&gt;&lt;strong&gt;æ–¹æ¡ˆä¸‰ï¼šå¤šçº§åˆ†ç‰‡é˜Ÿåˆ—ï¼ˆé«˜å¹¶å‘ä¼˜åŒ–ï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šå• ZSET åœ¨æµ·é‡æ¶ˆæ¯ä¸‹æˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;æŒ‰ä¸šåŠ¡åˆ†ç‰‡ï¼ˆå¦‚ &lt;code&gt;delay_queue:order&lt;/code&gt;ã€&lt;code&gt;delay_queue:coupon&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œä¸åŒåˆ†ç‰‡åˆ†å¸ƒåˆ°å¤šä¸ª Redis èŠ‚ç‚¹&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸ä¼˜åŒ–"&gt;âš ï¸ &lt;strong&gt;æ³¨æ„äº‹é¡¹ä¸ä¼˜åŒ–&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯ä¸¢å¤±é£é™©&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Redis å†…å­˜æ•°æ®å¯èƒ½å› å®•æœºä¸¢å¤±ï¼Œéœ€å¼€å¯ &lt;strong&gt;AOF + RDB æŒä¹…åŒ–&lt;/strong&gt;ï¼ˆç‰ºç‰²éƒ¨åˆ†æ€§èƒ½æ¢å®‰å…¨ï¼‰&lt;a class="link" href="@ref" &gt;7,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¡¥å¿æœºåˆ¶ï¼šå°†æ¶ˆæ¯å¤‡ä»½åˆ°æ•°æ®åº“ï¼Œå®šæ—¶æ‰«æè¡¥å¿æœªå¤„ç†çš„æ¶ˆæ¯&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘ç«äº‰å¤„ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Lua è„šæœ¬&lt;/strong&gt;ï¼šç¡®ä¿â€œæŸ¥åˆ â€åŸå­æ€§ï¼ˆå¦‚å‰æ–‡ç¤ºä¾‹ï¼‰&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼é”&lt;/strong&gt;ï¼šæ¶ˆè´¹å‰å¯¹æ¶ˆæ¯åŠ é”ï¼Œé¿å…é‡å¤å¤„ç†ï¼ˆå¦‚ &lt;code&gt;SET lock:msg1 NX EX 10&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½è°ƒä¼˜&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è½®è¯¢é—´éš”&lt;/strong&gt;ï¼šæ ¹æ®ä¸šåŠ¡å®¹å¿åº¦è°ƒæ•´ï¼ˆå¦‚ 100ms~1sï¼‰&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰¹é‡æ¶ˆè´¹&lt;/strong&gt;ï¼šä¸€æ¬¡è·å–å¤šæ¡æ¶ˆæ¯å‡å°‘ç½‘ç»œå¼€é”€ï¼ˆ&lt;code&gt;ZRANGEBYSCORE ... LIMIT 0 10&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤éƒ¨ç½²&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redis Cluster&lt;/strong&gt;ï¼šåˆ†ç‰‡å­˜å‚¨æ¶ˆæ¯ï¼Œé¿å…å•ç‚¹ç“¶é¢ˆ&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Key è®¾è®¡&lt;/strong&gt;ï¼š&lt;code&gt;delay_queue:{shard_id}&lt;/code&gt; å®ç°å‡åŒ€åˆ†å¸ƒ&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-9"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ–¹æ¡ˆ&lt;/strong&gt;ï¼šZSET æ—¶é—´æˆ³æ’åº + åŸå­æ¶ˆè´¹æ˜¯å»¶æ—¶æ¶ˆæ¯çš„åŸºçŸ³&lt;a class="link" href="@ref" &gt;1,3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰å‹å»ºè®®&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;ä¸­å°è§„æ¨¡ï¼šåŸç”Ÿ ZSET + Lua è„šæœ¬ï¼ˆæˆæœ¬ä½ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§çº§é«˜å¹¶å‘ï¼šRedisson æˆ–åˆ†ç‰‡é˜Ÿåˆ—ï¼ˆå¯é æ€§å¼ºï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¿å‘æŒ‡å—&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;li&gt;å¿…å¼€æŒä¹…åŒ–é˜²æ¶ˆæ¯ä¸¢å¤±ï¼›
&lt;ul&gt;
&lt;li&gt;å¿…ç”¨åŸå­æ“ä½œé˜²å¹¶å‘å†²çªï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æ§é˜Ÿåˆ—å †ç§¯ï¼ˆ&lt;code&gt;ZCARD delay_queue&lt;/code&gt;ï¼‰åŠæ—¶æ‰©å®¹&lt;a class="link" href="@ref" &gt;6,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¤ºä¾‹å‘½ä»¤ï¼šé€šè¿‡ &lt;code&gt;ZRANGE delay_queue 0 -1 WITHSCORES&lt;/code&gt; è§‚å¯Ÿæ¶ˆæ¯åˆ°æœŸçŠ¶æ€ï¼Œç»“åˆä¸šåŠ¡æµé‡è°ƒæ•´ç­–ç•¥ ğŸ”§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="hset--hmset"&gt;HSET &amp;amp; HMSET
&lt;/h2&gt;&lt;p&gt;åœ¨ Redis ä¸­ï¼Œ&lt;code&gt;HSET&lt;/code&gt; å’Œ &lt;code&gt;HMSET&lt;/code&gt; éƒ½æ˜¯ç”¨äºæ“ä½œå“ˆå¸Œè¡¨ï¼ˆHashï¼‰çš„å‘½ä»¤ï¼Œä½†å®ƒä»¬åœ¨åŠŸèƒ½ã€å‚æ•°å’Œé€‚ç”¨åœºæ™¯ä¸Šå­˜åœ¨æ˜¾è‘—åŒºåˆ«ã€‚ä»¥ä¸‹æ˜¯ä¸¤è€…çš„æ ¸å¿ƒå¯¹æ¯”åŠè¯¦ç»†è¯´æ˜ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”"&gt;ğŸ“Š &lt;strong&gt;æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å¯¹æ¯”ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;HSET&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;HMSET&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®å•ä¸ªå­—æ®µ-å€¼å¯¹&lt;/td&gt;
&lt;td&gt;ä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªå­—æ®µ-å€¼å¯¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å‚æ•°æ ¼å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HSET key field value&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HMSET key field1 value1 field2 value2 ...&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ•´æ•°ï¼ˆ1ï¼šæ–°å»ºå­—æ®µï¼›0ï¼šè¦†ç›–å·²æœ‰å­—æ®µï¼‰&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²ï¼ˆ&amp;ldquo;OK&amp;rdquo; è¡¨ç¤ºæˆåŠŸï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å•å­—æ®µæ“ä½œåŸå­æ€§&lt;/td&gt;
&lt;td&gt;å¤šå­—æ®µæ“ä½œåŸå­æ€§ï¼ˆå…¨éƒ¨æˆåŠŸæˆ–å…¨éƒ¨å¤±è´¥ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ›´æ–°æˆ–æ–°å¢å•ä¸ªå­—æ®µ&lt;/td&gt;
&lt;td&gt;æ‰¹é‡åˆå§‹åŒ–æˆ–æ›´æ–°å¤šä¸ªå­—æ®µ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç‰ˆæœ¬æ¼”è¿›&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Redis 4.0+ æ”¯æŒå¤šå­—æ®µæ“ä½œï¼ˆ&lt;code&gt;HSET key field1 value1 ...&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;Redis 4.0+ æ ‡è®°ä¸ºåºŸå¼ƒï¼ˆæ¨èç”¨ &lt;code&gt;HSET&lt;/code&gt; æ›¿ä»£ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-è¯¦ç»†è¯´æ˜"&gt;ğŸ§© &lt;strong&gt;è¯¦ç»†è¯´æ˜&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="åŠŸèƒ½ä¸å‚æ•°"&gt;&lt;strong&gt;åŠŸèƒ½ä¸å‚æ•°&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;HSET&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯æ¬¡ä»…æ“ä½œ&lt;strong&gt;ä¸€ä¸ªå­—æ®µ&lt;/strong&gt;ï¼Œè¯­æ³•ä¸º &lt;code&gt;HSET key field value&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ï¼šè®¾ç½®ç”¨æˆ·å§“å
&lt;pre tabindex="0"&gt;&lt;code&gt;HSET user:1 name &amp;#34;Alice&amp;#34; # è¿”å› 1ï¼ˆæ–°å»ºå­—æ®µï¼‰
HSET user:1 name &amp;#34;Bob&amp;#34; # è¿”å› 0ï¼ˆè¦†ç›–æ—§å€¼ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-[1,8](@ref)" data-lang="[1,8](@ref)"&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HMSET&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒ&lt;strong&gt;æ‰¹é‡è®¾ç½®å¤šå­—æ®µ&lt;/strong&gt;ï¼Œè¯­æ³•ä¸º &lt;code&gt;HMSET key field1 value1 field2 value2 ...&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¤ºä¾‹ï¼šåŒæ—¶è®¾ç½®ç”¨æˆ·å§“åå’Œå¹´é¾„&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;HMSET user:1 name &amp;#34;Alice&amp;#34; age 30 # è¿”å› &amp;#34;OK&amp;#34;
``` [9,11](@ref)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="è¿”å›å€¼å·®å¼‚"&gt;&lt;strong&gt;è¿”å›å€¼å·®å¼‚&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;HSET&lt;/code&gt;&lt;/strong&gt;
è¿”å›æ•´æ•°ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;1&lt;/code&gt;&lt;/strong&gt;ï¼šå­—æ®µä¸ºæ–°åˆ›å»ºï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;0&lt;/code&gt;&lt;/strong&gt;ï¼šå­—æ®µå·²å­˜åœ¨ä¸”å€¼è¢«è¦†ç›–&lt;a class="link" href="@ref" &gt;1,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;HMSET&lt;/code&gt;&lt;/strong&gt;
è¿”å›å­—ç¬¦ä¸² â€‹**&lt;code&gt;&amp;quot;OK&amp;quot;&lt;/code&gt;**â€‹ è¡¨ç¤ºå…¨éƒ¨å­—æ®µè®¾ç½®æˆåŠŸï¼Œä¸åŒºåˆ†æ–°å»ºæˆ–è¦†ç›–&lt;a class="link" href="@ref" &gt;9,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åŸå­æ€§ä¸æ€§èƒ½"&gt;&lt;strong&gt;åŸå­æ€§ä¸æ€§èƒ½&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŸå­æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HSET&lt;/code&gt; ä»…ä¿è¯å•å­—æ®µæ“ä½œçš„åŸå­æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HMSET&lt;/code&gt; ä¿è¯æ‰€æœ‰å­—æ®µæ“ä½œçš„åŸå­æ€§ï¼šè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥&lt;a class="link" href="@ref" &gt;10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰¹é‡æ“ä½œæ—¶ï¼Œ&lt;code&gt;HMSET&lt;/code&gt; &lt;strong&gt;ç½‘ç»œå¼€é”€æ›´å°&lt;/strong&gt;ï¼ˆ1æ¬¡è¯·æ±‚ vs å¤šæ¬¡ &lt;code&gt;HSET&lt;/code&gt; è¯·æ±‚ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Redis 4.0+ åï¼Œå¤šå­—æ®µæ“ä½œæ¨èç”¨ &lt;code&gt;HSET&lt;/code&gt;ï¼Œæ€§èƒ½ä¸ &lt;code&gt;HMSET&lt;/code&gt; ä¸€è‡´&lt;a class="link" href="@ref" &gt;10,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç‰ˆæœ¬å…¼å®¹æ€§"&gt;&lt;strong&gt;ç‰ˆæœ¬å…¼å®¹æ€§&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Redis 4.0+
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HSET&lt;/code&gt; æ”¯æŒå¤šå­—æ®µæ“ä½œï¼ˆå¦‚ &lt;code&gt;HSET key f1 v1 f2 v2&lt;/code&gt;ï¼‰ï¼ŒåŠŸèƒ½å®Œå…¨è¦†ç›– &lt;code&gt;HMSET&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HMSET&lt;/code&gt; è¢«æ ‡è®°ä¸º&lt;strong&gt;åºŸå¼ƒ&lt;/strong&gt;ï¼ˆDeprecatedï¼‰ï¼Œä½†ä»å¯å…¼å®¹ä½¿ç”¨&lt;a class="link" href="@ref" &gt;10,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ä½¿ç”¨åœºæ™¯å»ºè®®"&gt;âš¡ &lt;strong&gt;ä½¿ç”¨åœºæ™¯å»ºè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æ¨èå‘½ä»¤&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å•å­—æ®µæ›´æ–°&lt;/strong&gt;ï¼ˆå¦‚ä¿®æ”¹ç”¨æˆ·åï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HSET&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ— éœ€æ‰¹é‡æ“ä½œï¼Œä¸”éœ€åˆ¤æ–­å­—æ®µæ˜¯å¦æ–°å»º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‰¹é‡åˆå§‹åŒ–å¯¹è±¡&lt;/strong&gt;ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HSET&lt;/code&gt;ï¼ˆå¤šå­—æ®µï¼‰&lt;/td&gt;
&lt;td&gt;Redis 4.0+ é¦–é€‰ï¼Œå…¼å®¹æœªæ¥ç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…¼å®¹æ—§ç‰ˆæœ¬ Redis&lt;/strong&gt;ï¼ˆ&amp;lt;4.0ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HMSET&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ—§ç‰ˆæœ¬ä¸­å”¯ä¸€æ”¯æŒæ‰¹é‡æ“ä½œçš„å‘½ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-æ€»ç»“-10"&gt;ğŸ’ &lt;strong&gt;æ€»ç»“&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒå·®å¼‚&lt;/strong&gt;ï¼š&lt;code&gt;HSET&lt;/code&gt; é’ˆå¯¹å•å­—æ®µï¼Œè¿”å›çŠ¶æ€ç ï¼›&lt;code&gt;HMSET&lt;/code&gt; æ”¯æŒå¤šå­—æ®µï¼Œè¿”å›ç»Ÿä¸€ç»“æœã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬æ¼”è¿›&lt;/strong&gt;ï¼šRedis 4.0+ &lt;strong&gt;ç»Ÿä¸€ä½¿ç”¨ &lt;code&gt;HSET&lt;/code&gt;&lt;/strong&gt; æ›¿ä»£ &lt;code&gt;HMSET&lt;/code&gt;ï¼Œå…¼é¡¾åŠŸèƒ½ä¸å…¼å®¹æ€§&lt;a class="link" href="@ref" &gt;10,11&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;ï¼šæ‰¹é‡æ“ä½œä¼˜å…ˆç”¨ &lt;code&gt;HSET&lt;/code&gt;ï¼ˆå¤šå­—æ®µï¼‰æˆ– Pipeline æ‰“åŒ…å¤šä¸ª &lt;code&gt;HSET&lt;/code&gt;ï¼Œå‡å°‘ç½‘ç»œå»¶è¿Ÿ&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡å‘½ä»¤ &lt;code&gt;OBJECT ENCODING key&lt;/code&gt; å¯æŸ¥çœ‹å“ˆå¸Œè¡¨åº•å±‚ç»“æ„ï¼ˆå¦‚ &lt;code&gt;ziplist&lt;/code&gt; æˆ– &lt;code&gt;hashtable&lt;/code&gt;ï¼‰ï¼Œä¼˜åŒ–å­—æ®µæ•°é‡å’Œå€¼å¤§å°ä»¥æå‡æ€§èƒ½&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="zscore"&gt;ZSCORE
&lt;/h2&gt;&lt;h3 id="-zscoreå‘½ä»¤æ ¸å¿ƒæ¦‚å¿µ"&gt;ğŸ§  ZSCOREå‘½ä»¤æ ¸å¿ƒæ¦‚å¿µ
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ZSCORE&lt;/strong&gt; æ˜¯ Redis ä¸­é’ˆå¯¹æœ‰åºé›†åˆï¼ˆSorted Setï¼‰çš„å…³é”®å‘½ä»¤ï¼Œç”¨äº&lt;strong&gt;è·å–æŒ‡å®šæˆå‘˜çš„åˆ†æ•°ï¼ˆscoreï¼‰&lt;/strong&gt;ã€‚å…¶æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯­æ³•ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;ZSCORE key member
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;key&lt;/code&gt;ï¼šæœ‰åºé›†åˆçš„é”®åã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;member&lt;/code&gt;ï¼šéœ€æŸ¥è¯¢åˆ†æ•°çš„æˆå‘˜åç§°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è¿”å›å€¼ï¼š
&lt;ul&gt;
&lt;li&gt;æˆå‘˜å­˜åœ¨ â†’ è¿”å›åˆ†æ•°ï¼ˆåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œä»¥å­—ç¬¦ä¸²å½¢å¼è¡¨ç¤ºï¼‰&lt;a class="link" href="@ref" &gt;6,7,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æˆå‘˜ä¸å­˜åœ¨æˆ– key ä¸å­˜åœ¨ â†’ è¿”å› &lt;code&gt;nil&lt;/code&gt;&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ZADD players 150 &amp;#34;Alice&amp;#34; # æ·»åŠ æˆå‘˜ Aliceï¼Œåˆ†æ•° 150
ZSCORE players &amp;#34;Alice&amp;#34; # è¿”å› &amp;#34;150&amp;#34;
ZSCORE players &amp;#34;Bob&amp;#34; # è¿”å› nil
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id="-åº•å±‚å®ç°ä¸æ€§èƒ½"&gt;âš™ï¸ åº•å±‚å®ç°ä¸æ€§èƒ½
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®ç»“æ„&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;æœ‰åºé›†åˆé€šè¿‡è·³è·ƒè¡¨ï¼ˆSkip Listï¼‰å’Œ å“ˆå¸Œè¡¨ç»„åˆå®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;è·³è·ƒè¡¨æ”¯æŒæŒ‰åˆ†æ•°æ’åºå’Œé«˜æ•ˆèŒƒå›´æŸ¥è¯¢ï¼ˆ&lt;code&gt;O(log N)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å“ˆå¸Œè¡¨å­˜å‚¨æˆå‘˜åˆ°åˆ†æ•°çš„æ˜ å°„ï¼Œå®ç° &lt;code&gt;O(1)&lt;/code&gt; å¤æ‚åº¦çš„åˆ†æ•°å®šä½&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æˆå‘˜å”¯ä¸€ï¼Œä½†åˆ†æ•°å¯é‡å¤ï¼ˆå¦‚å¤šäººåŒåˆ†ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ZSCORE&lt;/code&gt; çš„æ—¶é—´å¤æ‚åº¦ä¸º &lt;strong&gt;&lt;code&gt;O(1)&lt;/code&gt;&lt;/strong&gt;ï¼ˆç›´æ¥é€šè¿‡å“ˆå¸Œè¡¨è·å–åˆ†æ•°ï¼‰&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ³¨æ„ï¼šéƒ¨åˆ†æ–‡æ¡£æè¿°ä¸º &lt;code&gt;O(log N)&lt;/code&gt; æ˜¯å› æ—©æœŸç‰ˆæœ¬å®ç°å·®å¼‚ï¼ŒRedis 5.0+ å·²ä¼˜åŒ–ä¸º &lt;code&gt;O(1)&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-å…¸å‹åº”ç”¨åœºæ™¯-1"&gt;ğŸ’¡ å…¸å‹åº”ç”¨åœºæ™¯
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶æ’è¡Œæ¦œ&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨ç©å®¶ç§¯åˆ†ï¼ˆåˆ†æ•°ï¼‰å’Œ IDï¼ˆæˆå‘˜ï¼‰ï¼Œé€šè¿‡ &lt;code&gt;ZSCORE&lt;/code&gt; å¿«é€ŸæŸ¥è¯¢ä¸ªäººåˆ†æ•°&lt;a class="link" href="@ref" &gt;1,6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç»“åˆ &lt;code&gt;ZRANGE&lt;/code&gt; è·å–æ’åå‰åˆ—çš„æˆå‘˜åŠåˆ†æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;ï¼šæ¸¸æˆç©å®¶ç§¯åˆ†æŸ¥è¯¢ã€å•†å“é”€é‡æ’åã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´åºåˆ—æ•°æ®&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;ä»¥æ—¶é—´æˆ³ä¸ºåˆ†æ•°ï¼Œæ—¥å¿—ä¸ºæˆå‘˜ï¼Œé€šè¿‡ &lt;code&gt;ZSCORE&lt;/code&gt; è·å–äº‹ä»¶å‘ç”Ÿæ—¶é—´&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ•°æ ¡éªŒä¸æ›´æ–°&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;åœ¨æ›´æ–°åˆ†æ•°å‰ï¼ˆå¦‚ &lt;code&gt;ZINCRBY&lt;/code&gt;ï¼‰ï¼Œå…ˆç”¨ &lt;code&gt;ZSCORE&lt;/code&gt; éªŒè¯æˆå‘˜å­˜åœ¨æ€§&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ-1"&gt;âš ï¸ æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¿”å›å€¼å¤„ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;è¿”å›å€¼ç±»å‹ä¸º&lt;strong&gt;å­—ç¬¦ä¸²&lt;/strong&gt;ï¼ˆå³ä½¿åˆ†æ•°ä¸ºæ•´æ•°ï¼‰ï¼Œç¼–ç¨‹æ—¶éœ€è½¬æ¢ä¸ºæ•°å€¼ç±»å‹ï¼ˆå¦‚ Python çš„ &lt;code&gt;float()&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æˆå‘˜ä¸å­˜åœ¨æ—¶è¿”å› &lt;code&gt;nil&lt;/code&gt;ï¼ˆPython è¿”å› &lt;code&gt;None&lt;/code&gt;ï¼ŒJava è¿”å› &lt;code&gt;null&lt;/code&gt;ï¼‰ï¼Œéœ€æ˜¾å¼å¤„ç†é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘åœºæ™¯ä¼˜åŒ–&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜é¢‘è¯»&lt;/strong&gt;ï¼šå¯¹çƒ­ç‚¹æˆå‘˜åˆ†æ•°åšåº”ç”¨å±‚ç¼“å­˜ï¼Œå‡å°‘ Redis å‹åŠ›&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é«˜é¢‘å†™&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;strong&gt;Pipeline&lt;/strong&gt; æ‰¹é‡æ‰§è¡Œ &lt;code&gt;ZADD&lt;/code&gt; å’Œ &lt;code&gt;ZSCORE&lt;/code&gt;ï¼Œå‡å°‘ç½‘ç»œå¼€é”€&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…å­˜ç®¡ç†&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;å®šæœŸæ¸…ç†è¿‡æœŸæˆå‘˜ï¼ˆ&lt;code&gt;ZREM&lt;/code&gt;ï¼‰ï¼Œé¿å…é›†åˆè†¨èƒ€å½±å“æ€§èƒ½&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¶…å¤§é›†åˆï¼ˆå¦‚åƒä¸‡çº§ï¼‰é‡‡ç”¨&lt;strong&gt;åˆ†æ¡¶ç­–ç•¥&lt;/strong&gt;ï¼ˆå¦‚æŒ‰ç”¨æˆ·åœ°åŸŸæ‹†åˆ†é”®ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‰ˆæœ¬å…¼å®¹æ€§&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ZSCORE&lt;/code&gt; åœ¨ Redis â‰¥1.2.0 ä¸­å¯ç”¨ï¼Œä½† &lt;code&gt;O(1)&lt;/code&gt; ä¼˜åŒ–éœ€ Redis 5.0+&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ä¸å…¶ä»–å‘½ä»¤çš„åä½œ"&gt;ğŸ’ ä¸å…¶ä»–å‘½ä»¤çš„åä½œ
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‘½ä»¤ç»„åˆ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç¤ºä¾‹åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ZSCORE + ZRANGE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–æˆå‘˜åˆ†æ•°åï¼ŒæŸ¥è¯¢å…¶æ’ååŒºé—´&lt;/td&gt;
&lt;td&gt;æ˜¾ç¤ºç©å®¶åˆ†æ•°åŠé™„è¿‘æ’å&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ZSCORE + ZINCRBY&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŸ¥è¯¢å½“å‰åˆ†æ•°åæŒ‰éœ€æ›´æ–°&lt;/td&gt;
&lt;td&gt;ç§¯åˆ†ç´¯åŠ å‰éªŒè¯æˆå‘˜å­˜åœ¨æ€§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ZSCORE + ZREM&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–åˆ†æ•°åç§»é™¤æˆå‘˜ï¼ˆå¦‚å°ç¦ç”¨æˆ·ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ¸…ç†æ— æ•ˆæ•°æ®å‰è®°å½•åŸå§‹åˆ†æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id="-zscore-æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“"&gt;ğŸ“Š ZSCORE æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç»´åº¦&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ ¸å¿ƒåŠŸèƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;è·å–æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„åˆ†æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¿”å›å€¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æˆå‘˜å­˜åœ¨ â†’ åˆ†æ•°ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼›ä¸å­˜åœ¨ â†’ &lt;code&gt;nil&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¶é—´å¤æ‚åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;O(1)&lt;/code&gt;ï¼ˆRedis 5.0+ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ’è¡Œæ¦œã€æ—¶é—´åºåˆ—ã€åˆ†æ•°æ ¡éªŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ˜¾å¼å¤„ç† &lt;code&gt;nil&lt;/code&gt; è¿”å›å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€§èƒ½ä¼˜åŒ–&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ç¼“å­˜çƒ­ç‚¹æ•°æ®ã€åˆ†æ¡¶å­˜å‚¨è¶…å¤§é›†åˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æ“ä½œå»ºè®®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å‰ç¡®ä¿é”®ç±»å‹ä¸ºæœ‰åºé›†åˆï¼ˆé¿å…ç±»å‹é”™è¯¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç»“åˆ &lt;code&gt;EXISTS&lt;/code&gt; æˆ– &lt;code&gt;TYPE&lt;/code&gt; å‘½ä»¤é¢„æ£€é”®ç±»å‹ã€‚&lt;/li&gt;
&lt;li&gt;ç”Ÿäº§ç¯å¢ƒé¿å…é¢‘ç¹æŸ¥è¯¢ç›¸åŒæˆå‘˜ï¼ˆä¼˜å…ˆæœ¬åœ°ç¼“å­˜ï¼‰&lt;a class="link" href="@ref" &gt;6,10&lt;/a&gt;ã€‚
é€šè¿‡åˆç†åº”ç”¨ &lt;code&gt;ZSCORE&lt;/code&gt;ï¼Œå¯é«˜æ•ˆå®ç°åŠ¨æ€æ’åã€å®æ—¶ç›‘æ§ç­‰åœºæ™¯ï¼Œå……åˆ†å‘æŒ¥ Redis æœ‰åºé›†åˆçš„æ€§èƒ½ä¼˜åŠ¿ ğŸ”¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="bigkey"&gt;bigKey
&lt;/h2&gt;&lt;p&gt;ä¸ºé¿å…Redis BigKeyå¯¹ç³»ç»Ÿæ€§èƒ½ã€å†…å­˜å’Œç¨³å®šæ€§é€ æˆå±å®³ï¼Œéœ€é‡‡å–ç³»ç»ŸåŒ–çš„é¢„é˜²ã€æ£€æµ‹ä¸æ²»ç†ç­–ç•¥ã€‚ä»¥ä¸‹æ–¹æ¡ˆåŸºäºæœ€ä½³å®è·µå’Œè¡Œä¸šç»éªŒæ•´ç†ï¼Œåˆ†ä¸ºè®¾è®¡é¢„é˜²ã€ç›‘æ§æ£€æµ‹ã€å¤„ç†ä¼˜åŒ–ä¸‰éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-è®¾è®¡é¢„é˜²ä»æºå¤´é¿å…bigkeyäº§ç”Ÿ"&gt;ğŸ›  &lt;strong&gt;è®¾è®¡é¢„é˜²ï¼šä»æºå¤´é¿å…BigKeyäº§ç”Ÿ&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆç†æ•°æ®ç»“æ„é€‰å‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Stringç±»å‹&lt;/strong&gt;ï¼šå€¼ä¸è¶…è¿‡ &lt;strong&gt;10KB&lt;/strong&gt;ï¼ˆå¦‚JSONã€å›¾ç‰‡ç­‰å¤§æ–‡æœ¬åº”å‹ç¼©æˆ–åˆ†ç‰‡ï¼‰&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;é›†åˆç±»å‹ï¼ˆHash/List/Set/ZSetï¼‰ï¼šå…ƒç´ æ•°ä¸è¶…è¿‡ 5,000ä¸ª
&lt;ul&gt;
&lt;li&gt;æ›¿ä»£æ–¹æ¡ˆï¼š
&lt;ul&gt;
&lt;li&gt;ç»Ÿè®¡ç±»åœºæ™¯ â†’ HyperLogLogï¼ˆUVç»Ÿè®¡ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;çŠ¶æ€æ ‡è®° â†’ Bitmapï¼ˆç­¾åˆ°è®°å½•ï¼‰
&lt;ul&gt;
&lt;li&gt;å¤§æ–‡ä»¶å­˜å‚¨ â†’ å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚OSSï¼‰+ Rediså­˜å…ƒæ•°æ®&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åˆ†ç‰‡ä¸æ‹†åˆ†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‚ç›´æ‹†åˆ†&lt;/strong&gt;ï¼šæŒ‰ä¸šåŠ¡ç»´åº¦åˆ†ç¦»æ•°æ®ï¼ˆå¦‚ &lt;code&gt;user:{id}:profile&lt;/code&gt;ã€&lt;code&gt;user:{id}:orders&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;æ°´å¹³æ‹†åˆ†ï¼š
&lt;ul&gt;
&lt;li&gt;Hashç±»å‹ â†’ æŒ‰å­—æ®µå“ˆå¸Œåˆ†æ¡¶ï¼ˆ&lt;code&gt;user:data:{id}:shard_{n}&lt;/code&gt;ï¼‰&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;List/Set â†’ æŒ‰æ—¶é—´æˆ–æ•°é‡åˆ†ç‰‡ï¼ˆ&lt;code&gt;news:20240501:part1&lt;/code&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;é˜²è„è¯»æŠ€å·§&lt;/em&gt;ï¼šå†™å…¥æ—¶ç”Ÿæˆç‰ˆæœ¬å·ï¼ŒåŸå­æ›´æ–°å…ƒæ•°æ®æŒ‡å‘æ–°åˆ†ç‰‡&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;å‹ç¼©ä¸åºåˆ—åŒ–ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å‹ç¼©ç®—æ³•é€‰å‹ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç®—æ³•&lt;/th&gt;
&lt;th&gt;å‹ç¼©ç‡&lt;/th&gt;
&lt;th&gt;CPUå¼€é”€&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Snappy&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;td&gt;å®æ—¶è¯»å†™ï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;LZ4&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;æä½&lt;/td&gt;
&lt;td&gt;é«˜æ€§èƒ½è¦æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Gzip&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;é«˜&lt;/td&gt;
&lt;td&gt;å†·æ•°æ®å­˜å‚¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åºåˆ—åŒ–ä¼˜åŒ–&lt;/strong&gt;ï¼šProtocol Buffers/MessagePackæ›¿ä»£JSONï¼Œå‡å°‘å†—ä½™å­—æ®µ&lt;a class="link" href="@ref" &gt;4&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰Keyå¿…é¡»è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆ&lt;code&gt;EXPIRE&lt;/code&gt;ï¼‰ï¼Œè¿‡æœŸæ—¶é—´éšæœºæ‰“æ•£ï¼ˆé¿å…é›†ä¸­å¤±æ•ˆï¼‰&lt;a class="link" href="@ref" &gt;1,9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å†·çƒ­æ•°æ®åˆ†ç¦»ï¼šé«˜é¢‘æ•°æ®å­˜Redisï¼Œä½é¢‘æ•°æ®è½¬å­˜æ•°æ®åº“&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-ç›‘æ§æ£€æµ‹å®æ—¶å‘ç°bigkeyé£é™©"&gt;ğŸ” &lt;strong&gt;ç›‘æ§æ£€æµ‹ï¼šå®æ—¶å‘ç°BigKeyé£é™©&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è‡ªåŠ¨åŒ–æ‰«æå·¥å…·&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;redis-cli --bigkeys&lt;/code&gt;&lt;/strong&gt;ï¼šå®šæœŸåœ¨ä»èŠ‚ç‚¹æ‰§è¡Œï¼Œè¯†åˆ«å„ç±»å‹TOP1å¤§Keyï¼ˆé‡‡æ ·æ¨¡å¼å½±å“å°ï¼‰&lt;a class="link" href="@ref" &gt;3,6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;RDBåˆ†æå·¥å…·ï¼š
&lt;ul&gt;
&lt;li&gt;å·¥å…·ï¼š&lt;code&gt;rdb-tools&lt;/code&gt;ã€&lt;code&gt;redis-rdb-cli&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¾“å‡ºï¼šç²¾ç¡®è®¡ç®—æ¯ä¸ªKeyçš„å†…å­˜å ç”¨ï¼Œç”ŸæˆTopNåˆ—è¡¨&lt;a class="link" href="@ref" &gt;6,7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰è„šæœ¬ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;for key in redis.scan_iter(count=1000):
size = redis.memory_usage(key)
if size &amp;gt; 10 * 1024: # è¶…è¿‡10KBæŠ¥è­¦
alert(f&amp;#34;BigKey: {key} size={size}&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶ç›‘æ§ä¸å‘Šè­¦&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æ§æŒ‡æ ‡ï¼š
&lt;ul&gt;
&lt;li&gt;å†…å­˜å¢é•¿ç‡çªå¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆ&lt;code&gt;slowlog get&lt;/code&gt;ï¼‰ä¸­çš„è€—æ—¶å‘½ä»¤ï¼ˆå¦‚&lt;code&gt;HGETALL&lt;/code&gt;ã€&lt;code&gt;LRANGE 0 -1&lt;/code&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;ç½‘ç»œæµé‡å³°å€¼ï¼ˆçªå¢å¯èƒ½å› å¤§Keyè¯»å–ï¼‰&lt;a class="link" href="@ref" &gt;6,8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å‘Šè­¦è§„åˆ™ï¼š
&lt;ul&gt;
&lt;li&gt;Keyå†…å­˜ &amp;gt; 10MB æˆ– é›†åˆå…ƒç´  &amp;gt; 5,000 â†’ ç«‹å³å‘Šè­¦&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é›†ç¾¤èŠ‚ç‚¹å†…å­˜å·®å¼‚ &amp;gt; 30% â†’ æ£€æŸ¥æ•°æ®å€¾æ–œ&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-å¤„ç†ä¼˜åŒ–å®‰å…¨æ²»ç†å·²æœ‰bigkey"&gt;âš™ï¸ &lt;strong&gt;å¤„ç†ä¼˜åŒ–ï¼šå®‰å…¨æ²»ç†å·²æœ‰BigKey&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨åˆ é™¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Redis 4.0+&lt;/strong&gt;ï¼šç”¨ &lt;code&gt;UNLINK&lt;/code&gt; æ›¿ä»£ &lt;code&gt;DEL&lt;/code&gt;ï¼ˆå¼‚æ­¥éé˜»å¡ï¼‰&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æ—§ç‰ˆæœ¬ï¼šæ¸è¿›å¼åˆ é™¤
&lt;ul&gt;
&lt;li&gt;Hashï¼š&lt;code&gt;HSCAN&lt;/code&gt; + &lt;code&gt;HDEL&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Setï¼š&lt;code&gt;SSCAN&lt;/code&gt; + &lt;code&gt;SREM&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Listï¼š&lt;code&gt;LTRIM&lt;/code&gt; åˆ†æ‰¹æˆªæ–­&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;è¯»å†™ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¦æ­¢é«˜å±å‘½ä»¤&lt;/strong&gt;ï¼š&lt;code&gt;KEYS&lt;/code&gt;ã€&lt;code&gt;FLUSHALL&lt;/code&gt;ã€&lt;code&gt;HGETALL&lt;/code&gt; â†’ ç”¨ &lt;code&gt;SCAN&lt;/code&gt;ã€&lt;code&gt;HSCAN&lt;/code&gt; æ›¿ä»£&lt;a class="link" href="@ref" &gt;9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢é‡æ“ä½œ&lt;/strong&gt;ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;cursor = 0
while True:
cursor, data = redis.hscan(&amp;#34;big_hash&amp;#34;, cursor, count=100)
process(data)
if cursor == 0: break
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†ç¾¤ä¸æ¶æ„ä¼˜åŒ–&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯ç”¨Lazy-Freeï¼ˆæƒ°æ€§åˆ é™¤ï¼‰ï¼š
&lt;pre tabindex="0"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;redis.conf&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; lazyfree-lazy-user-del yes
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;lazyfree-lazy-eviction yes
```
- ä¸»çº¿ç¨‹ä¸å†é˜»å¡&lt;a class="link" href="@ref" &gt;3,8&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é›†ç¾¤åˆ†ç‰‡ï¼š
&lt;ul&gt;
&lt;li&gt;Codis/Redis Clusterå°†å¤§Keyè‡ªåŠ¨åˆ†æ•£åˆ°å¤šèŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é¿å…è¿ç§»é˜»å¡ï¼šè°ƒæ•´ &lt;code&gt;cluster-node-timeout&lt;/code&gt; â‰¥ 900sï¼ˆé˜²è¿ç§»è¶…æ—¶è§¦å‘æ•…éšœåˆ‡æ¢ï¼‰&lt;a class="link" href="@ref" &gt;6&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æœ€ä½³å®è·µé—­ç¯"&gt;ğŸ’ &lt;strong&gt;æœ€ä½³å®è·µé—­ç¯&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æµç¨‹è§„èŒƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¼€å‘é˜¶æ®µï¼šä»£ç å®¡æŸ¥ç¦æ­¢å†™å…¥è¶…è§„æ ¼Keyï¼ˆå¦‚String &amp;gt; 10KBï¼‰&lt;/li&gt;
&lt;li&gt;ä¸Šçº¿å‰ï¼šCI/CDæµæ°´çº¿é›†æˆBigKeyæ‰«æï¼ˆå¤±è´¥åˆ™é˜»æ–­å‘å¸ƒï¼‰&lt;a class="link" href="@ref" &gt;3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;è¿ç»´æœŸï¼šæ¯æœˆå…¨é›†ç¾¤æ‰«æ + å­£åº¦æ¶æ„è¯„å®¡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¹³è¡¡åŸåˆ™&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç©ºé—´æ¢æ—¶é—´&lt;/strong&gt;ï¼šåˆ†ç‰‡æå‡å¹¶å‘èƒ½åŠ›ï¼ˆå¦‚è´­ç‰©è½¦HashæŒ‰ç”¨æˆ·IDåˆ†æ¡¶ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´æ¢å®‰å…¨&lt;/strong&gt;ï¼šæ¸è¿›å¼åˆ é™¤é¿å…é˜»å¡&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—æ¢å­˜å‚¨&lt;/strong&gt;ï¼šå‹ç¼©ç®—æ³•é™ä½å†…å­˜ï¼Œä½†éœ€è¯„ä¼°CPUæˆæœ¬&lt;a class="link" href="@ref" &gt;3,4&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡ &lt;strong&gt;â€œè®¾è®¡é¢„é˜² â†’ å®æ—¶ç›‘æ§ â†’ å®‰å…¨æ²»ç†â€&lt;/strong&gt; é—­ç¯ï¼Œå¯é™ä½90% BigKeyé£é™©ã€‚å¯¹äºå·²å­˜åœ¨çš„BigKeyï¼Œä¼˜å…ˆä½¿ç”¨&lt;strong&gt;åˆ†ç‰‡æ‹†åˆ†&lt;/strong&gt;ä¸&lt;strong&gt;å¼‚æ­¥åˆ é™¤&lt;/strong&gt;ï¼Œå¹¶åŒæ­¥ä¼˜åŒ–æ•°æ®è®¾è®¡ï¼Œä»æºå¤´æœç»æ–°BigKeyäº§ç”Ÿ&lt;a class="link" href="@ref" &gt;3,6,9&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="zookeeper"&gt;Zookeeper
&lt;/h2&gt;&lt;p&gt;Zookeeper æ˜¯ä¸€ä¸ªç”± Apache å¼€æºçš„ &lt;strong&gt;åˆ†å¸ƒå¼åè°ƒæœåŠ¡æ¡†æ¶&lt;/strong&gt;ï¼Œæ—¨åœ¨è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€è‡´æ€§ã€å¯é æ€§å’Œåè°ƒé—®é¢˜ã€‚å®ƒé€šè¿‡ç®€å•çš„æ•°æ®æ¨¡å‹å’Œé«˜æ•ˆçš„åè®®ï¼Œä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›æ ¸å¿ƒçš„åè°ƒèƒ½åŠ›ï¼Œè¢«å¹¿æ³›åº”ç”¨äº Hadoopã€Kafkaã€Dubbo ç­‰ç³»ç»Ÿã€‚ä»¥ä¸‹ä»æ ¸å¿ƒåŸç†ã€åº”ç”¨åœºæ™¯ã€é›†ç¾¤æœºåˆ¶åˆ°å®è·µæ“ä½œå±•å¼€è¯¦è§£ï¼š&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒæ¦‚å¿µä¸æ•°æ®æ¨¡å‹"&gt;ğŸŒ² &lt;strong&gt;æ ¸å¿ƒæ¦‚å¿µä¸æ•°æ®æ¨¡å‹&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="æ•°æ®æ¨¡å‹æ ‘çŠ¶ç»“æ„znode"&gt;&lt;strong&gt;æ•°æ®æ¨¡å‹ï¼šæ ‘çŠ¶ç»“æ„ï¼ˆZNodeï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å±‚æ¬¡åŒ–è·¯å¾„&lt;/strong&gt;ï¼šç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ &lt;code&gt;/services/service1&lt;/code&gt;ï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç§°ä¸º &lt;strong&gt;ZNode&lt;/strong&gt;ï¼Œå­˜å‚¨æ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯&lt;a class="link" href="@ref" &gt;1,3,5&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ZNodeç»„æˆï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;stat&lt;/code&gt;ï¼šç‰ˆæœ¬ã€æƒé™ç­‰å…ƒæ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;data&lt;/code&gt;ï¼šå…³è”æ•°æ®ï¼ˆâ‰¤1MBï¼Œæ¨èå°æ•°æ®ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;children&lt;/code&gt;ï¼šå­èŠ‚ç‚¹åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹ç±»å‹ï¼š
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;ç‰¹æ€§&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŒä¹…èŠ‚ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼šè¯ç»“æŸä¸åˆ é™¤&lt;/td&gt;
&lt;td&gt;å­˜å‚¨é…ç½®ã€æœåŠ¡æ³¨å†Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŒä¹…é¡ºåºèŠ‚ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;èŠ‚ç‚¹åè‡ªåŠ¨è¿½åŠ å…¨å±€è‡ªå¢åºåˆ—ï¼ˆå¦‚ &lt;code&gt;/lock_00000001&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;åˆ†å¸ƒå¼é”ã€é˜Ÿåˆ—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸´æ—¶èŠ‚ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼šè¯ç»“æŸè‡ªåŠ¨åˆ é™¤&lt;/td&gt;
&lt;td&gt;æœåŠ¡å®ä¾‹æ³¨å†Œï¼ˆå¦‚ Dubboï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä¸´æ—¶é¡ºåºèŠ‚ç‚¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¼šè¯ç»“æŸåˆ é™¤ + è‡ªå¢åºåˆ—&lt;/td&gt;
&lt;td&gt;Leader é€‰ä¸¾ã€åˆ†å¸ƒå¼é”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç›‘å¬æœºåˆ¶watcher"&gt;&lt;strong&gt;ç›‘å¬æœºåˆ¶ï¼ˆWatcherï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;äº‹ä»¶é©±åŠ¨&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å¯ç›‘å¬ ZNode çš„å˜åŒ–ï¼ˆæ•°æ®ä¿®æ”¹ã€å­èŠ‚ç‚¹å¢åˆ ï¼‰&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµç¨‹&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;å®¢æˆ·ç«¯æ³¨å†Œ Watcherï¼ˆå¦‚ &lt;code&gt;get /data watch&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡ç«¯è§¦å‘äº‹ä»¶å¹¶é€šçŸ¥å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯å›è°ƒå¤„ç†ï¼ˆå¦‚æ›´æ–°é…ç½®ã€é‡è¿æœåŠ¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-é›†ç¾¤æ¶æ„ä¸ä¸€è‡´æ€§åè®®"&gt;âš™ï¸ &lt;strong&gt;é›†ç¾¤æ¶æ„ä¸ä¸€è‡´æ€§åè®®&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é›†ç¾¤è§’è‰²"&gt;&lt;strong&gt;é›†ç¾¤è§’è‰²&lt;/strong&gt;
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;è§’è‰²&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;è¯»å†™æƒé™&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Leader&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤„ç†æ‰€æœ‰å†™è¯·æ±‚ï¼ŒåŒæ­¥æ•°æ®åˆ° Follower&lt;/td&gt;
&lt;td&gt;è¯»å†™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Follower&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¤„ç†è¯»è¯·æ±‚ï¼Œå‚ä¸ Leader é€‰ä¸¾å’Œå†™æŠ•ç¥¨&lt;/td&gt;
&lt;td&gt;åªè¯» + æŠ•ç¥¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Observer&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰©å±•è¯»æ€§èƒ½ï¼Œä¸å‚ä¸æŠ•ç¥¨ï¼ˆé¿å…é€‰ä¸¾å»¶è¿Ÿï¼‰&lt;/td&gt;
&lt;td&gt;åªè¯»&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="zab-åè®®zookeeper-atomic-broadcast"&gt;&lt;strong&gt;ZAB åè®®ï¼ˆZookeeper Atomic Broadcastï¼‰&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„æ ¸å¿ƒåè®®ï¼Œåˆ†ä¸ºä¸¤ä¸ªæ¨¡å¼&lt;a class="link" href="@ref" &gt;3,9&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¢å¤æ¨¡å¼ï¼ˆé€‰ä¸»ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;Leader å®•æœºåè§¦å‘é€‰ä¸¾ï¼ŒåŸºäº &lt;code&gt;(zxid, sid)&lt;/code&gt; æŠ•ç¥¨ï¼ˆzxid æœ€å¤§è€…ä¼˜å…ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‰ä¸¾è§„åˆ™&lt;/strong&gt;ï¼šåŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹åŒæ„å³ç”Ÿæ•ˆï¼ˆæ¨èé›†ç¾¤èŠ‚ç‚¹æ•° &lt;strong&gt;2N+1&lt;/strong&gt;ï¼Œå¦‚ 3/5/7 å°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¹¿æ’­æ¨¡å¼ï¼ˆåŒæ­¥ï¼‰ï¼š
&lt;ul&gt;
&lt;li&gt;Leader å°†å†™è¯·æ±‚è½¬ä¸ºäº‹åŠ¡ææ¡ˆï¼ˆProposalï¼‰ï¼Œå¹¿æ’­ç»™ Followerã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åŠæ•°ä»¥ä¸Š Follower ç¡®è®¤åæäº¤ï¼Œæ›´æ–°å†…å­˜æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="é«˜å¯ç”¨è®¾è®¡"&gt;&lt;strong&gt;é«˜å¯ç”¨è®¾è®¡&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®¹é”™æœºåˆ¶&lt;/strong&gt;ï¼šåŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹å­˜æ´»å³æœåŠ¡å¯ç”¨ï¼ˆå¦‚ 3 èŠ‚ç‚¹é›†ç¾¤å®¹å¿ 1 èŠ‚ç‚¹æ•…éšœï¼‰&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æŒä¹…åŒ–&lt;/strong&gt;ï¼šäº‹åŠ¡æ—¥å¿—ï¼ˆLogï¼‰ + å†…å­˜å¿«ç…§ï¼ˆSnapshotï¼‰ï¼Œå´©æºƒåå¿«é€Ÿæ¢å¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-æ ¸å¿ƒåº”ç”¨åœºæ™¯"&gt;ğŸ› ï¸ &lt;strong&gt;æ ¸å¿ƒåº”ç”¨åœºæ™¯&lt;/strong&gt;
&lt;/h3&gt;&lt;h4 id="é…ç½®ç®¡ç†"&gt;&lt;strong&gt;é…ç½®ç®¡ç†&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šé›†ä¸­ç®¡ç†åˆ†å¸ƒå¼ç³»ç»Ÿé…ç½®ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ä¸²ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;é…ç½®å†™å…¥ ZNodeï¼ˆå¦‚ &lt;code&gt;/config/db_url&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰èŠ‚ç‚¹ç›‘å¬è¯¥èŠ‚ç‚¹ï¼Œå˜æ›´æ—¶å®æ—¶åŒæ­¥&lt;a class="link" href="@ref" &gt;1,8,10&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="æœåŠ¡æ³¨å†Œä¸å‘ç°"&gt;&lt;strong&gt;æœåŠ¡æ³¨å†Œä¸å‘ç°&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šå¾®æœåŠ¡åŠ¨æ€ä¸Šä¸‹çº¿ï¼ˆå¦‚ Dubboï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°ï¼š
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å¯åŠ¨æ—¶åˆ›å»º&lt;strong&gt;ä¸´æ—¶èŠ‚ç‚¹&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;/services/payment/192.168.1.100:8080&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹è€…ç›‘å¬èŠ‚ç‚¹åˆ—è¡¨ï¼Œè·å–å¯ç”¨æœåŠ¡åœ°å€&lt;a class="link" href="@ref" &gt;8,9&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="åˆ†å¸ƒå¼é”-1"&gt;&lt;strong&gt;åˆ†å¸ƒå¼é”&lt;/strong&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ’ä»–é”&lt;/strong&gt;ï¼šå¤šä¸ªå®¢æˆ·ç«¯åˆ›å»ºåŒä¸€èŠ‚ç‚¹ï¼ŒæˆåŠŸè€…è·é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºé”&lt;/strong&gt;ï¼šä½¿ç”¨ä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼Œæœ€å°åºå·è·é”ï¼ˆå…¬å¹³é”ï¼‰
&lt;pre tabindex="0"&gt;&lt;code&gt;// åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹
String lockPath = zk.create(&amp;#34;/lock_&amp;#34;, null, OPEN_ACL_UNSAFE, EPHEMERAL_SEQUENTIAL);
// æ£€æŸ¥æ˜¯å¦ä¸ºæœ€å°åºå·
if (lockPath.equals(minNode)) {
// è·å–é”
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **é›†ç¾¤ç®¡ç†**
- **èŠ‚ç‚¹ç›‘æ§**ï¼šä¸´æ—¶èŠ‚ç‚¹è¡¨ç¤ºåœ¨çº¿çŠ¶æ€ï¼ŒèŠ‚ç‚¹å®•æœºè‡ªåŠ¨åˆ é™¤ã€‚
- **Masteré€‰ä¸¾**ï¼šä¸´æ—¶é¡ºåºèŠ‚ç‚¹æœ€å°åºå·è€…æˆä¸º Master[8,9](@ref)ã€‚
#### **åˆ†å¸ƒå¼é˜Ÿåˆ—**
- **åŒæ­¥é˜Ÿåˆ—**ï¼šæ‰€æœ‰ä»»åŠ¡å®Œæˆæ‰è§¦å‘ï¼ˆé€šè¿‡ä¸´æ—¶èŠ‚ç‚¹è®¡æ•°ï¼‰ã€‚
- **FIFOé˜Ÿåˆ—**ï¼šé¡ºåºèŠ‚ç‚¹å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹[1](@ref)ã€‚
------
### ğŸ”§ **é›†ç¾¤æ­å»ºä¸æ“ä½œ**
#### **å®‰è£…ä¸é…ç½®**
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id="æ­¥éª¤ç¤ºä¾‹3èŠ‚ç‚¹é›†ç¾¤18"&gt;æ­¥éª¤ç¤ºä¾‹ï¼ˆ3èŠ‚ç‚¹é›†ç¾¤ï¼‰&lt;a class="link" href="@ref" &gt;1,8&lt;/a&gt;
&lt;/h1&gt;&lt;h1 id="ä¸‹è½½è§£å‹"&gt;ä¸‹è½½è§£å‹
&lt;/h1&gt;&lt;p&gt;tar -xzf apache-zookeeper-3.8.0-bin.tar.gz&lt;/p&gt;
&lt;h1 id="é…ç½®-zoocfg"&gt;é…ç½® zoo.cfg
&lt;/h1&gt;&lt;p&gt;tickTime=2000
dataDir=/var/zookeeper
clientPort=2181
server.1=node1:2888:3888 # 2888:æ•°æ®åŒæ­¥ç«¯å£, 3888:é€‰ä¸¾ç«¯å£
server.2=node2:2888:3888
server.3=node3:2888:3888&lt;/p&gt;
&lt;h1 id="åˆ›å»º-myid-æ–‡ä»¶"&gt;åˆ›å»º myid æ–‡ä»¶
&lt;/h1&gt;&lt;p&gt;echo &amp;ldquo;1&amp;rdquo; &amp;gt; /var/zookeeper/myid # æ¯å°èŠ‚ç‚¹åˆ†åˆ«å†™1,2,3&lt;/p&gt;
&lt;h1 id="å¯åŠ¨é›†ç¾¤"&gt;å¯åŠ¨é›†ç¾¤
&lt;/h1&gt;&lt;p&gt;bin/zkServer.sh start&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **å¸¸ç”¨å‘½ä»¤**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;create /config &amp;ldquo;init_data&amp;rdquo; # åˆ›å»ºèŠ‚ç‚¹
get /config watch # ç›‘å¬æ•°æ®å˜åŒ–
set /config &amp;ldquo;new_data&amp;rdquo; # ä¿®æ”¹æ•°æ®
ls /services # æŸ¥çœ‹å­èŠ‚ç‚¹
delete /config # åˆ é™¤èŠ‚ç‚¹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **Javaå®¢æˆ·ç«¯ç¤ºä¾‹**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;// è¿æ¥é›†ç¾¤
ZooKeeper zk = new ZooKeeper(&amp;ldquo;node1:2181,node2:2181&amp;rdquo;, 3000, null);
// åˆ›å»ºæŒä¹…èŠ‚ç‚¹
zk.create(&amp;quot;/config/db_url&amp;quot;, &amp;ldquo;jdbc:mysql://db&amp;rdquo;.getBytes(),
ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);
// ç›‘å¬èŠ‚ç‚¹å˜åŒ–
zk.getData(&amp;quot;/config&amp;quot;, event -&amp;gt; {
if (event.getType() == EventType.NodeDataChanged) {
System.out.println(&amp;ldquo;é…ç½®å·²æ›´æ–°ï¼&amp;rdquo;);
}
}, null);&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### âš ï¸ **ç”Ÿäº§å®è·µä¸é¿å‘æŒ‡å—**
1. é›†ç¾¤éƒ¨ç½²ä¼˜åŒ–ï¼š
- èŠ‚ç‚¹æ•°æ¨è **3/5/7**ï¼ˆé¿å…å¶æ•°å¯¼è‡´é€‰ä¸¾åƒµå±€ï¼‰[3](@ref)ã€‚
- ç‰©ç†éš”ç¦»éƒ¨ç½²ï¼Œé¿å…å•æœºæˆ¿æ•…éšœã€‚
2. æ€§èƒ½è°ƒä¼˜ï¼š
- åˆ†ç¦»äº‹åŠ¡æ—¥å¿—ä¸å¿«ç…§ç›®å½•ï¼ˆ`dataDir` ä¸ `dataLogDir`ï¼‰ã€‚
- å¢åŠ  Observer èŠ‚ç‚¹æ‰©å±•è¯»ååé‡[3](@ref)ã€‚
3. å¸¸è§é—®é¢˜ï¼š
- **ç«¯å£å†²çª**ï¼šæ£€æŸ¥ `2181`ï¼ˆå®¢æˆ·ç«¯ï¼‰ã€`2888/3888`ï¼ˆé›†ç¾¤å†…éƒ¨ï¼‰ç«¯å£å ç”¨ã€‚
- **è„‘è£‚é—®é¢˜**ï¼šé…ç½® `zookeeper.forceSync=yes` å¼ºåˆ¶å†™ç£ç›˜é˜²æ•°æ®ä¸¢å¤±ã€‚
- **å¤§èŠ‚ç‚¹é£é™©**ï¼šZNode æ•°æ®å‹¿è¶…è¿‡ 1MBï¼ˆå½±å“ç½‘ç»œä¼ è¾“ä¸å†…å­˜ï¼‰ã€‚
------
### ğŸ’ **æ€»ç»“**
Zookeeper ä»¥ **æ ‘å½¢æ•°æ®æ¨¡å‹** å’Œ **ZABåè®®** ä¸ºæ ¸å¿ƒï¼Œæˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„â€œç¥ç»ç³»ç»Ÿâ€ï¼Œåœ¨é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€åˆ†å¸ƒå¼é”ç­‰åœºæ™¯ä¸­ä¸å¯æˆ–ç¼ºï¼š
- **ä¼˜åŠ¿**ï¼šå¼ºä¸€è‡´æ€§ã€é«˜å¯ç”¨ã€è½»é‡çº§ APIã€‚
- **å±€é™**ï¼šå†™æ€§èƒ½å—é™äº Leaderï¼ˆ&amp;gt;10K QPS éœ€è€ƒè™‘æ‰©å±•æ–¹æ¡ˆï¼‰ã€‚
- **æ¼”è¿›è¶‹åŠ¿**ï¼šäº‘åŸç”Ÿæ—¶ä»£ï¼Œéƒ¨åˆ†åœºæ™¯è¢« Etcdã€Consul æ›¿ä»£ï¼Œä½† Zookeeper åœ¨ Hadoop/Kafka ç­‰ç”Ÿæ€ä¸­ä»ä¸å¯æ›¿ä»£ ğŸ”§ã€‚
&amp;gt; æ›´å¤šå®è·µæ¡ˆä¾‹ï¼ˆå¦‚ Kafka é›†ç¾¤åè°ƒï¼‰å¯å‚è€ƒ [Zookeeper å®˜æ–¹æ–‡æ¡£](https://zookeeper.apache.org/)ã€‚
## å†…å­˜æ·˜æ±°ç­–ç•¥
Redis å†…å­˜æ·˜æ±°ç­–ç•¥æ˜¯å½“å†…å­˜ä½¿ç”¨è¾¾åˆ°é…ç½®ä¸Šé™ï¼ˆ`maxmemory`ï¼‰æ—¶ï¼ŒRedis è‡ªåŠ¨åˆ é™¤éƒ¨åˆ†æ•°æ®ä»¥é‡Šæ”¾ç©ºé—´çš„æœºåˆ¶ã€‚ä»¥ä¸‹ä¸ºè¯¦ç»†è§£æï¼Œç»“åˆç­–ç•¥åˆ†ç±»ã€é…ç½®æ–¹æ³•ã€é€‚ç”¨åœºæ™¯åŠå†…éƒ¨å®ç°ï¼š
------
### ğŸ”§ **æ·˜æ±°ç­–ç•¥åˆ†ç±»**
Redis æä¾› **8 ç§ç­–ç•¥**ï¼Œåˆ†ä¸ºä¸¤ç±» [1,6,7](@ref)ï¼š
| **ç­–ç•¥ç±»å‹** | **ç­–ç•¥åç§°** | **è¡Œä¸ºæè¿°** |
| ------------------------ | ----------------- | ------------------------------------------------------------ |
| **ä¸æ·˜æ±°æ•°æ®** | `noeviction` | å†…å­˜æ»¡æ—¶æ‹’ç»å†™å…¥æ–°æ•°æ®ï¼Œè¿”å›é”™è¯¯ï¼ˆé»˜è®¤ç­–ç•¥ï¼‰[1,6](@ref)ã€‚ |
| **é’ˆå¯¹æ‰€æœ‰é”®** | `allkeys-lru` | æ·˜æ±°**æœ€è¿‘æœ€å°‘ä½¿ç”¨**ï¼ˆLeast Recently Usedï¼‰çš„é”® [2,6](@ref)ã€‚ |
| | `allkeys-lfu` | æ·˜æ±°**æœ€ä¸ç»å¸¸ä½¿ç”¨**ï¼ˆLeast Frequently Usedï¼‰çš„é”®ï¼ˆRedis 4.0+ï¼‰[2,7](@ref)ã€‚ |
| | `allkeys-random` | **éšæœºæ·˜æ±°**ä»»æ„é”® [3,6](@ref)ã€‚ |
| **ä»…é’ˆå¯¹å¸¦è¿‡æœŸæ—¶é—´çš„é”®** | `volatile-lru` | ä»**è®¾å®šäº† TTL çš„é”®**ä¸­æ·˜æ±°æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é”® [3,6](@ref)ã€‚ |
| | `volatile-lfu` | ä»**è®¾å®šäº† TTL çš„é”®**ä¸­æ·˜æ±°æœ€ä¸ç»å¸¸ä½¿ç”¨çš„é”® [2,7](@ref)ã€‚ |
| | `volatile-random` | ä»**è®¾å®šäº† TTL çš„é”®**ä¸­éšæœºæ·˜æ±° [3,6](@ref)ã€‚ |
| | `volatile-ttl` | ä¼˜å…ˆæ·˜æ±° **TTL æœ€çŸ­**ï¼ˆå³å°†è¿‡æœŸï¼‰çš„é”® [1,5](@ref)ã€‚ |
&amp;gt; ğŸ’¡ **å…³é”®åŒºåˆ«**ï¼š
&amp;gt;
&amp;gt; - `allkeys-*` ç­–ç•¥å½±å“æ‰€æœ‰æ•°æ®ï¼›`volatile-*` ä»…å½±å“å¸¦è¿‡æœŸæ—¶é—´çš„æ•°æ® [6,7](@ref)ã€‚
&amp;gt; - `LRU` åŸºäºè®¿é—®æ—¶é—´ï¼Œ`LFU` åŸºäºè®¿é—®é¢‘ç‡ï¼Œ`TTL` åŸºäºå‰©ä½™å­˜æ´»æ—¶é—´ [2,6](@ref)ã€‚
------
### âš™ï¸ **é…ç½®æ–¹å¼**
#### **é™æ€é…ç½®ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰**
ä¿®æ”¹ `redis.conf` æ–‡ä»¶ [6,7](@ref)ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;maxmemory 2gb # è®¾ç½®å†…å­˜ä¸Šé™
maxmemory-policy allkeys-lru # æŒ‡å®šæ·˜æ±°ç­–ç•¥
maxmemory-samples 5 # LRU/LFU é‡‡æ ·ç²¾åº¦ï¼ˆé»˜è®¤5ï¼Œè¶Šé«˜è¶Šç²¾ç¡®ï¼‰&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **åŠ¨æ€é…ç½®ï¼ˆä¸´æ—¶ç”Ÿæ•ˆï¼‰**
é€šè¿‡ Redis å‘½ä»¤è¡ŒåŠ¨æ€è°ƒæ•´ [4,6](@ref)ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;CONFIG SET maxmemory 2gb
CONFIG SET maxmemory-policy volatile-lfu&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;gt; âš ï¸ **æ³¨æ„**ï¼šåŠ¨æ€é…ç½®é‡å¯åå¤±æ•ˆï¼Œéœ€åœ¨é…ç½®æ–‡ä»¶ä¸­æ°¸ä¹…ä¿å­˜ [6,7](@ref)ã€‚
------
### âš¡ï¸ **ç­–ç•¥æ‰§è¡Œæœºåˆ¶ä¸å†…éƒ¨åŸç†**
1. **è§¦å‘æ—¶æœº**
- æ¯æ¬¡æ‰§è¡Œå‘½ä»¤å‰æ£€æŸ¥å†…å­˜ï¼Œè‹¥è¶…è¿‡ `maxmemory` åˆ™å°è¯•æ·˜æ±°æ•°æ® [1,6](@ref)ã€‚
- è‹¥æ·˜æ±°å¤±è´¥ï¼ˆå¦‚ `noeviction` ç­–ç•¥ï¼‰ï¼Œæ‹’ç»å†™å…¥å¹¶è¿”å› `OOM` é”™è¯¯ [1,4](@ref)ã€‚
2. **LRU/LFU è¿‘ä¼¼ç®—æ³•**
- **æ·˜æ±°æ± ï¼ˆEviction Poolï¼‰**ï¼šéšæœºé€‰å– `maxmemory-samples` ä¸ªé”®è¿›å…¥æ± ä¸­ï¼ŒæŒ‰ç­–ç•¥æ’åºåæ·˜æ±°æœ€ä¸é‡è¦çš„é”® [1,6](@ref)ã€‚
- LFU è®¡æ•°é€»è¾‘ï¼š
- 8bit å­˜å‚¨è®¿é—®é¢‘æ¬¡ï¼ˆ`logc`ï¼‰ï¼Œ16bit å­˜å‚¨æœ€åè¡°å‡æ—¶é—´ï¼ˆ`ldt`ï¼‰[2](@ref)ã€‚
- è®¿é—®æ—¶ä»¥æ¦‚ç‡å¢åŠ è®¡æ•°ï¼ˆé¿å…æ¯æ¬¡æ›´æ–°ï¼‰ï¼Œéšæ—¶é—´è¡°å‡é¢‘æ¬¡ï¼ˆå¦‚æ¯1åˆ†é’Ÿå‡1ï¼‰[1,2](@ref)ã€‚
------
### ğŸ¯ **é€‚ç”¨åœºæ™¯ä¸é€‰å‹å»ºè®®**
| **ç­–ç•¥** | **é€‚ç”¨åœºæ™¯** | **æ³¨æ„äº‹é¡¹** |
| ---------------- | ------------------------------------------------------------ | ------------------------------------- |
| `allkeys-lru` | çƒ­ç‚¹æ•°æ®æ˜æ˜¾ï¼ˆå¦‚ç¼“å­˜ç³»ç»Ÿï¼‰ï¼Œéœ€ä¿ç•™é«˜é¢‘è®¿é—®æ•°æ® [3,6](@ref)ã€‚ | è®¿é—®æ¨¡å¼çªå˜æ—¶å¯èƒ½è¯¯åˆ çƒ­ç‚¹æ•°æ®ã€‚ |
| `allkeys-lfu` | æ•°æ®è®¿é—®é¢‘ç‡å·®å¼‚å¤§ï¼Œéœ€åŸºäºä½¿ç”¨é¢‘æ¬¡æ·˜æ±°ï¼ˆå¦‚æ¨èç³»ç»Ÿï¼‰[6,7](@ref)ã€‚ | éœ€é¢å¤–å†…å­˜è®°å½•é¢‘æ¬¡ï¼Œæ€§èƒ½ç•¥ä½ã€‚ |
| `volatile-ttl` | ä¼˜å…ˆæ¸…ç†å³å°†è¿‡æœŸçš„ä¸´æ—¶æ•°æ®ï¼ˆå¦‚ä¼šè¯ç¼“å­˜ï¼‰[1,5](@ref)ã€‚ | è‹¥æ‰€æœ‰é”® TTL ç›¸è¿‘ï¼Œæ•ˆæœç±»ä¼¼éšæœºæ·˜æ±°ã€‚ |
| `noeviction` | æ•°æ®ä¸å¯ä¸¢å¤±ï¼ˆå¦‚é…ç½®å­˜å‚¨ï¼‰ï¼Œå®æ‹’ç»å†™å…¥ä¹Ÿä¸æ·˜æ±° [4,6](@ref)ã€‚ | éœ€ç›‘æ§å†…å­˜ï¼Œé¿å…æœåŠ¡ä¸å¯ç”¨ã€‚ |
| `allkeys-random` | æ•°æ®è®¿é—®å‡åŒ€ï¼Œæ— æ˜ç¡®çƒ­ç‚¹ [3,6](@ref)ã€‚ | å¯èƒ½è¯¯åˆ é‡è¦æ•°æ®ï¼Œæ…ç”¨ã€‚ |
&amp;gt; âœ… **é€‰å‹å…³é”®å› ç´ **ï¼š
&amp;gt;
&amp;gt; - **æ•°æ®é‡è¦æ€§**ï¼šé‡è¦æ•°æ®é¿å…ä½¿ç”¨ `allkeys-*`ï¼Œä¼˜å…ˆç”¨ `volatile-*` æˆ– `noeviction`ã€‚
&amp;gt; - **è®¿é—®æ¨¡å¼**ï¼šçƒ­ç‚¹æ•°æ®ç”¨ `LRU/LFU`ï¼Œå‡åŒ€è®¿é—®ç”¨ `random`ï¼Œä¸´æ—¶æ•°æ®ç”¨ `TTL` [6,7](@ref)ã€‚
&amp;gt; - **æ€§èƒ½å¼€é”€**ï¼š`LFU` &amp;gt; `LRU` &amp;gt; `TTL` &amp;gt; `random` [6](@ref)ã€‚
------
### ğŸ’ **å®æˆ˜é…ç½®ç¤ºä¾‹**
#### **åœºæ™¯ï¼šç¼“å­˜ç³»ç»Ÿï¼ˆçƒ­ç‚¹æ•°æ®+ä¸´æ—¶å­˜å‚¨ï¼‰**
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id="redisconf"&gt;redis.conf
&lt;/h1&gt;&lt;p&gt;maxmemory 4gb
maxmemory-policy volatile-lfu # ä¼˜å…ˆæ·˜æ±°ä½é¢‘çš„ä¸´æ—¶æ•°æ®
maxmemory-samples 10 # æé«˜LRU/LFUç²¾åº¦&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#### **Java ä»£ç åŠ¨æ€è®¾ç½®ï¼ˆJedisï¼‰**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Jedis jedis = new Jedis(&amp;ldquo;localhost&amp;rdquo;, 6379);
jedis.configSet(&amp;ldquo;maxmemory&amp;rdquo;, &amp;ldquo;2gb&amp;rdquo;);
jedis.configSet(&amp;ldquo;maxmemory-policy&amp;rdquo;, &amp;ldquo;allkeys-lru&amp;rdquo;); // å¯ç”¨LRUå…¨å±€æ·˜æ±°
jedis.close();&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### âš ï¸ **æ³¨æ„äº‹é¡¹**
1. **å†…å­˜ç›‘æ§**ï¼šå®šæœŸæ‰§è¡Œ `INFO memory` æŸ¥çœ‹å†…å­˜ä½¿ç”¨åŠæ·˜æ±°é”®æ•°é‡ [7](@ref)ã€‚
2. **å†·å¯åŠ¨é—®é¢˜**ï¼šæ–°ç³»ç»Ÿæ— è®¿é—®è®°å½•æ—¶ï¼Œ`LRU/LFU` å¯èƒ½è¡¨ç°ä¸ä½³ï¼Œå¯é¢„çƒ­æ•°æ®æˆ–åˆæœŸç”¨ `TTL`ã€‚
3. **ä¸€è‡´æ€§é£é™©**ï¼šé›†ç¾¤ç¯å¢ƒä¸‹ï¼Œä¸åŒèŠ‚ç‚¹å¯èƒ½æ·˜æ±°ä¸åŒæ•°æ®ï¼Œéœ€ä¸šåŠ¡å±‚å…œåº•ï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰[6](@ref)ã€‚
&amp;gt; ğŸ“Š **æ€§èƒ½ä¼˜åŒ–**ï¼š
&amp;gt;
&amp;gt; - å¢å¤§ `maxmemory-samples` æå‡ LRU/LFU ç²¾åº¦ï¼ˆç‰ºç‰² CPUï¼‰[1,6](@ref)ã€‚
&amp;gt; - å¯¹é«˜é¢‘æ›´æ–°é”®è®¾ç½®åˆç† TTLï¼Œé¿å… `volatile-*` ç­–ç•¥å¤±æ•ˆ [5,7](@ref)ã€‚
é€šè¿‡åˆç†é€‰æ‹©ç­–ç•¥ï¼ŒRedis å¯åœ¨å†…å­˜å—é™æ—¶å¹³è¡¡æ€§èƒ½ä¸æ•°æ®å®Œæ•´æ€§ï¼Œé¿å… OOM å¯¼è‡´æœåŠ¡ä¸­æ–­ã€‚å®é™…åº”ç”¨ä¸­éœ€ç»“åˆç›‘æ§æ•°æ®åŠ¨æ€è°ƒæ•´ç­–ç•¥å‚æ•° [6,7](@ref)ã€‚
## SETNX
`SETNX`å‘½ä»¤åœ¨Redisä¸­**ä¸“é—¨ç”¨äºæ“ä½œå­—ç¬¦ä¸²ï¼ˆStringï¼‰ç±»å‹**ï¼Œè€Œä¸æ˜¯å­˜å…¥Setæˆ–Hashç­‰æ•°æ®ç»“æ„ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§£æï¼š
### ğŸ“Œ **`SETNX`çš„ä½œç”¨ä¸æ•°æ®ç±»å‹**
- **æ“ä½œå¯¹è±¡**ï¼š`SETNX`æ“ä½œçš„æ˜¯Redisçš„**å­—ç¬¦ä¸²ï¼ˆStringï¼‰ç±»å‹**ã€‚å®ƒç”¨äºåœ¨é”®ï¼ˆkeyï¼‰ä¸å­˜åœ¨æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„é”®å€¼å¯¹[2,3,7](@ref)ã€‚
- å‘½ä»¤è¯­æ³•ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;SETNX key value&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;è‹¥
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;key&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;key&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;çš„å€¼ä¸º
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;value&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œå¹¶è¿”å›
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;1&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ï¼›è‹¥
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;key&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;å·²å­˜åœ¨ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼Œè¿”å›
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;0&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;4,6,7
ã€‚
### âš ï¸ **ä¸å…¶ä»–æ•°æ®ç»“æ„çš„åŒºåˆ«**
- **Setç±»å‹**ï¼š
Setæ˜¯æ— åºé›†åˆï¼Œé€šè¿‡å‘½ä»¤å¦‚`SADD`æ·»åŠ å…ƒç´ ã€‚`SETNX`ä¸Setæ— å…³ï¼Œä¸ä¼šå°†æ•°æ®å­˜å…¥Set[5](@ref)ã€‚
- **Hashç±»å‹**ï¼š
Hashæ˜¯é”®å€¼å¯¹é›†åˆï¼Œé€šè¿‡`HSET`å‘½ä»¤è®¾ç½®å­—æ®µå€¼ã€‚`SETNX`ä»…æ“ä½œå­—ç¬¦ä¸²é”®å€¼ï¼Œä¸Hashæ— å…³[5,9](@ref)ã€‚
### ğŸ”§ **è¦†ç›–è¡Œä¸ºä¸ç±»å‹è½¬æ¢**
- è¦†ç›–è§„åˆ™ï¼š
è‹¥
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;key&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;å·²å­˜åœ¨ä¸”
éå­—ç¬¦ä¸²ç±»å‹
ï¼ˆå¦‚Listã€Hashï¼‰ï¼Œ
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;SETNX&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ä¼š
å¼ºåˆ¶å°†å…¶è¦†ç›–ä¸ºå­—ç¬¦ä¸²ç±»å‹
ï¼Œå¹¶è®¾ç½®æ–°å€¼
2,3
ã€‚
ä¾‹å¦‚ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;127.0.0.1:6379&amp;gt; LPUSH mylist &amp;ldquo;item&amp;rdquo; # åˆ›å»ºListç±»å‹
(integer) 1
127.0.0.1:6379&amp;gt; SETNX mylist &amp;ldquo;new_value&amp;rdquo;
(integer) 1 # è¦†ç›–ä¸ºStringç±»å‹
127.0.0.1:6379&amp;gt; TYPE mylist
&amp;ldquo;string&amp;rdquo; # ç±»å‹è¢«ä¿®æ”¹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;### âš¡ **æ›¿ä»£æ–¹æ¡ˆï¼š`SET`å‘½ä»¤çš„æ‰©å±•**
Redis 2.6.12+ æä¾›äº†æ›´å¼ºå¤§çš„`SET`å‘½ä»¤ï¼Œæ”¯æŒ`NX`é€‰é¡¹ï¼ˆç­‰æ•ˆäº`SETNX`ï¼‰ï¼Œå¹¶å¯ç›´æ¥è®¾ç½®è¿‡æœŸæ—¶é—´ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;SET key value NX EX 10 # ä»…å½“keyä¸å­˜åœ¨æ—¶è®¾ç½®å€¼ï¼Œ10ç§’åè¿‡æœŸ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;æ­¤æ“ä½œ**åŸå­æ€§ä¼˜äº`SETNX` + `EXPIRE`ç»„åˆ**ï¼Œé¿å…äº†éåŸå­æ“ä½œçš„é£é™©[7,8](@ref)ã€‚
### ğŸ’ **å…¸å‹åº”ç”¨åœºæ™¯**
- **åˆ†å¸ƒå¼é”**ï¼š
é€šè¿‡`SETNX`ç«äº‰é”é”®ï¼ŒæˆåŠŸè¿”å›`1`è¡¨ç¤ºè·å–é”ï¼Œé…åˆå”¯ä¸€æ ‡è¯†ï¼ˆå¦‚UUIDï¼‰å’Œè¿‡æœŸæ—¶é—´é¿å…æ­»é”[6,7,8](@ref)ã€‚
- **è¯·æ±‚å»é‡ä¸å¹‚ç­‰æ€§æ§åˆ¶**ï¼š
ç”¨å”¯ä¸€è¯·æ±‚IDä½œä¸º`key`ï¼Œé€šè¿‡`SETNX`ç¡®ä¿ä»…ç¬¬ä¸€æ¬¡è¯·æ±‚è¢«å¤„ç†[7](@ref)ã€‚
### ğŸ“Š æ€»ç»“å¯¹æ¯”
| **å‘½ä»¤** | **æ“ä½œç±»å‹** | **è¦†ç›–è¡Œä¸º** | **é€‚ç”¨åœºæ™¯** |
| -------- | -------------- | ------------------- | -------------------- |
| `SETNX` | å­—ç¬¦ä¸²(String) | ä»…å½“keyä¸å­˜åœ¨æ—¶è®¾ç½® | åˆ†å¸ƒå¼é”ã€è¯·æ±‚å»é‡ |
| `SADD` | é›†åˆ(Set) | æ·»åŠ å…ƒç´ åˆ°æ— åºé›†åˆ | æ ‡ç­¾ç³»ç»Ÿã€å…±åŒå¥½å‹ |
| `HSET` | å“ˆå¸Œ(Hash) | è®¾ç½®Hashä¸­çš„å­—æ®µå€¼ | å¯¹è±¡å±æ€§å­˜å‚¨ã€è´­ç‰©è½¦ |
&amp;gt; âœ… **ç»“è®º**ï¼š`SETNX`æ˜¯**çº¯å­—ç¬¦ä¸²æ“ä½œå‘½ä»¤**ï¼Œä¸Setã€Hashç­‰æ•°æ®ç±»å‹æ— å…³ã€‚ä½¿ç”¨æ—¶éœ€æ³¨æ„å…¶è¦†ç›–è¡Œä¸ºï¼Œå¹¶ä¼˜å…ˆé‡‡ç”¨`SET key value NX EX`å®ç°åŸå­æ€§é”ç®¡ç†ã€‚
## &amp;#34;:&amp;#34;
åœ¨ Redis ä¸­ï¼Œé”®ï¼ˆKeyï¼‰ä¸­çš„å†’å· `:` æ˜¯ä¸€ç§**å±‚çº§åˆ†éš”ç¬¦**ï¼Œä¸»è¦ç”¨äºç»„ç»‡é”®çš„å‘½åç©ºé—´å’Œæ•°æ®ç»“æ„ï¼Œæå‡å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§åŠæ“ä½œæ•ˆç‡ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒä½œç”¨åŠå…·ä½“åº”ç”¨åœºæ™¯ï¼š
------
### ğŸ”‘ **æ ¸å¿ƒä½œç”¨**
1. **å±‚çº§å‘½åç©ºé—´ï¼ˆLogical Namespaceï¼‰**
`:` å°†é”®åˆ’åˆ†ä¸ºå¤šä¸ªé€»è¾‘å±‚çº§ï¼Œå½¢æˆç±»ä¼¼æ–‡ä»¶è·¯å¾„çš„ç»“æ„ï¼Œä¾‹å¦‚ï¼š
- `user:1001:profile`ï¼šè¡¨ç¤ºç”¨æˆ· ID ä¸º 1001 çš„ä¸ªäººèµ„æ–™[7,6](@ref)
- `order:2025:07:03:12345`ï¼šè¡¨ç¤º 2025 å¹´ 7 æœˆ 3 æ—¥çš„è®¢å• ID 12345[7](@ref)
è¿™ç§ç»“æ„æ¸…æ™°è¡¨è¾¾äº†æ•°æ®çš„å½’å±å…³ç³»ï¼Œé¿å…é”®åå†²çªã€‚
2. **å‘½åç©ºé—´éš”ç¦»ï¼ˆNamespace Isolationï¼‰**
ä¸åŒä¸šåŠ¡æ¨¡å—é€šè¿‡å‰ç¼€éš”ç¦»ï¼Œä¾‹å¦‚ï¼š
- `cache:product:1001`ï¼ˆç¼“å­˜æ¨¡å—ï¼‰
- `auth:token:abcd`ï¼ˆè®¤è¯æ¨¡å—ï¼‰[7](@ref)
ä¾¿äºåˆ†ç±»ç®¡ç†ï¼Œé¿å…é”®åé‡å¤ã€‚
3. **æ¨¡å¼åŒ¹é…ï¼ˆPattern Matchingï¼‰**
ç»“åˆ `KEYS` æˆ– `SCAN` å‘½ä»¤ï¼Œé€šè¿‡é€šé…ç¬¦æ‰¹é‡æ“ä½œç›¸å…³é”®ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;KEYS user:* # è·å–æ‰€æœ‰ç”¨æˆ·ç›¸å…³é”®
KEYS order:2025:* # è·å– 2025 å¹´çš„è®¢å•é”®&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;é€‚ç”¨äºæ‰¹é‡åˆ é™¤ã€æ›´æ–°æˆ–ç»Ÿè®¡ã€‚
4. **æå‡å¯è¯»æ€§ä¸ç»´æŠ¤æ€§**
ç»“æ„åŒ–é”®åï¼ˆå¦‚ `article:42:comments`ï¼‰æ¯”æ— åˆ†éš”é”®åï¼ˆå¦‚ `article_comments_42`ï¼‰æ›´æ˜“ç†è§£ï¼Œé™ä½ç»´æŠ¤æˆæœ¬[6,7](@ref)ã€‚
------
### âš™ï¸ **å®é™…åº”ç”¨åœºæ™¯**
#### **å­˜å‚¨å¯¹è±¡å±æ€§**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;HSET user:1001 name &amp;ldquo;John&amp;rdquo; age 30 # å­˜å‚¨ç”¨æˆ·å±æ€§
HGET user:1001 name # è·å–ç”¨æˆ·å&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **é”®ç»“æ„**ï¼š`user:{id}:field`ï¼Œç›´æ¥å®šä½å¯¹è±¡å±æ€§ã€‚
#### **ç®¡ç†ç¼“å­˜æ•°æ®**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;SET cache:product:1001 &amp;ldquo;{&amp;hellip;JSONæ•°æ®&amp;hellip;}&amp;rdquo; EX 3600 # å•†å“ç¼“å­˜ï¼ˆ1å°æ—¶è¿‡æœŸï¼‰&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **é”®ç»“æ„**ï¼š`cache:{æ•°æ®ç±»å‹}:{id}`ï¼Œç»Ÿä¸€ç®¡ç†ç¼“å­˜ç”Ÿå‘½å‘¨æœŸ[4,7](@ref)ã€‚
#### **å®ç°åˆ†å¸ƒå¼é”**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;SET lock:order:update:1001 &amp;ldquo;UUID&amp;rdquo; NX PX 10000 # è·å–è®¢å•æ›´æ–°é”ï¼ˆ10ç§’è¶…æ—¶ï¼‰&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **é”®ç»“æ„**ï¼š`lock:{ä¸šåŠ¡}:{æ“ä½œ}:{id}`ï¼Œæ˜ç¡®é”çš„ç”¨é€”[4,7](@ref)ã€‚
#### **æ„å»ºæ¶ˆæ¯é˜Ÿåˆ—**
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;LPUSH queue:email &amp;ldquo;task_data&amp;rdquo; # é‚®ä»¶ä»»åŠ¡å…¥é˜Ÿ
RPOP queue:email # æ¶ˆè´¹ä»»åŠ¡&lt;a class="link" href="@ref" &gt;7&lt;/a&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- **é”®ç»“æ„**ï¼š`queue:{ä»»åŠ¡ç±»å‹}`ï¼ŒåŒºåˆ†ä¸åŒé˜Ÿåˆ—ã€‚
------
### âš ï¸ **ä½¿ç”¨è§„èŒƒä¸æ³¨æ„äº‹é¡¹**
1. **åˆ†éš”ç¬¦é€‰æ‹©**
- ä¼˜å…ˆä½¿ç”¨ `:`ï¼ˆç¤¾åŒºå…±è¯†ï¼‰ï¼Œä¹Ÿå¯ç”¨ `_`ã€`.` æˆ– `-`ï¼Œä½†éœ€å›¢é˜Ÿç»Ÿä¸€[6,7](@ref)ã€‚
- **é¿å…ç‰¹æ®Šå­—ç¬¦**ï¼šå¦‚ `#`ã€`?`ã€ç©ºæ ¼ç­‰ï¼Œå¯èƒ½å½±å“å‘½ä»¤è§£æã€‚
2. **é”®åè®¾è®¡åŸåˆ™**
- **ç®€æ´æ€§**ï¼š`user:1001:orders` ä¼˜äº `user_id_1001_order_history`[6](@ref)ã€‚
- **é•¿åº¦æ§åˆ¶**ï¼šè¿‡é•¿çš„é”®åå¢åŠ å†…å­˜å ç”¨ï¼ˆRedis æ¯ä¸ªé”®éœ€é¢å¤–å­˜å‚¨å…ƒæ•°æ®ï¼‰ã€‚
- **å¤§å°å†™æ•æ„Ÿ**ï¼š`User:1001` ä¸ `user:1001` æ˜¯ä¸åŒé”®[6](@ref)ã€‚
3. **æ€§èƒ½ä¼˜åŒ–**
- **é¿å… `KEYS *`**ï¼šå…¨é‡åŒ¹é…é˜»å¡æœåŠ¡ï¼Œç”¨ `SCAN` åˆ†æ‰¹è¿­ä»£[2,7](@ref)ã€‚
- **æ§åˆ¶å±‚çº§æ·±åº¦**ï¼šè¿‡å¤šå±‚çº§ï¼ˆå¦‚ `a:b:c:d:e`ï¼‰å¢åŠ åŒ¹é…å¤æ‚åº¦ã€‚
------
### ğŸ’ **ä¸åŒæ•°æ®ç»“æ„çš„åˆ†å±‚é”®ç¤ºä¾‹**
| **æ•°æ®ç±»å‹** | **é”®ç¤ºä¾‹** | **ç”¨é€”è¯´æ˜** |
| ------------ | ------------------------- | ------------------------------ |
| String | `config:app:timeout` | åº”ç”¨è¶…æ—¶é…ç½® |
| Hash | `product:1001:details` | å•†å“è¯¦æƒ…ï¼ˆå­—æ®µï¼špriceã€stockï¼‰ |
| List | `log:2025:07:03:errors` | æŒ‰æ—¥æœŸå­˜å‚¨é”™è¯¯æ—¥å¿— |
| Sorted Set | `leaderboard:game:racing` | èµ›è½¦æ¸¸æˆå®æ—¶æ’è¡Œæ¦œ |
| Set | `blacklist:ip:2025` | 2025 å¹´ IP é»‘åå• |
------
### âœ… **æ€»ç»“**
- **æ ¸å¿ƒä»·å€¼**ï¼š`:` æ˜¯ Redis é”®è®¾è®¡çš„**æœ€ä½³å®è·µ**ï¼Œé€šè¿‡å±‚çº§åŒ–å®ç°æ•°æ®åˆ†ç±»ã€éš”ç¦»ä¸é«˜æ•ˆç®¡ç†[6,7](@ref)ã€‚
- **é€‚ç”¨åœºæ™¯**ï¼šå¯¹è±¡å­˜å‚¨ã€ç¼“å­˜ç®¡ç†ã€åˆ†å¸ƒå¼é”ã€é˜Ÿåˆ—ç³»ç»Ÿç­‰ã€‚
- **é¿å‘æŒ‡å—**ï¼š
â†’ é”®åéœ€ç®€çŸ­ã€æ˜“è¯»ã€æ— æ­§ä¹‰ï¼›
â†’ ä¼˜å…ˆä½¿ç”¨ `:` å¹¶å›¢é˜Ÿç»Ÿä¸€ï¼›
â†’ æ…ç”¨ `KEYS` å‘½ä»¤ï¼Œæ”¹ç”¨ `SCAN` è¿­ä»£[2,7](@ref)ã€‚
åˆç†ä½¿ç”¨ `:` åˆ†éš”ç¬¦ï¼Œèƒ½æ˜¾è‘—æå‡ Redis æ•°æ®ç®¡ç†çš„æ¸…æ™°åº¦ä¸æ“ä½œæ•ˆç‡ï¼Œå°¤å…¶åœ¨å¤§å‹ç³»ç»Ÿä¸­è‡³å…³é‡è¦ã€‚
## SCAN
åœ¨ Redis ä¸­ï¼Œ**SCAN å‘½ä»¤å¯ä»¥é€šè¿‡ `MATCH` å‚æ•°æ ¹æ®é”®åä¸­çš„å†’å· `:` è¿›è¡Œç­›é€‰**ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è¯´æ˜å’Œæ³¨æ„äº‹é¡¹ï¼š
------
### ğŸ” **ç­›é€‰è¯­æ³•ä¸ç¤ºä¾‹**
- è¯­æ³•æ ¼å¼ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;SCAN cursor [MATCH pattern] [COUNT count]&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;å…¶ä¸­
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;pattern&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;æ”¯æŒåŒ…å«
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;çš„é€šé…ç¬¦æ¨¡å¼ï¼ˆå¦‚
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;user:*&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;æˆ–
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;order:2025:*&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ï¼‰ã€‚
- ç¤ºä¾‹ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id="æŸ¥æ‰¾æ‰€æœ‰ä»¥-user-å¼€å¤´çš„é”®"&gt;æŸ¥æ‰¾æ‰€æœ‰ä»¥ &amp;ldquo;user:&amp;rdquo; å¼€å¤´çš„é”®
&lt;/h1&gt;&lt;p&gt;SCAN 0 MATCH &amp;ldquo;user:*&amp;rdquo; COUNT 100&lt;/p&gt;
&lt;h1 id="æŸ¥æ‰¾æ‰€æœ‰åŒ…å«-order2025-çš„é”®"&gt;æŸ¥æ‰¾æ‰€æœ‰åŒ…å« &amp;ldquo;order:2025&amp;rdquo; çš„é”®
&lt;/h1&gt;&lt;p&gt;SCAN 0 MATCH &amp;ldquo;&lt;em&gt;order:2025&lt;/em&gt;&amp;rdquo; COUNT 100&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### âš™ï¸ **å…³é”®ç‰¹æ€§**
1.
é€šé…ç¬¦æ”¯æŒï¼š
- `*` åŒ¹é…ä»»æ„å­—ç¬¦ï¼ˆåŒ…æ‹¬ `:` å‰åçš„å†…å®¹ï¼‰ã€‚
- `:` è¢«è§†ä¸ºæ™®é€šå­—ç¬¦ï¼Œæ— ç‰¹æ®Šå«ä¹‰ï¼Œå¯ç›´æ¥ç”¨äºåŒ¹é…å±‚çº§ç»“æ„ï¼ˆå¦‚ `user:1001`ï¼‰[6,8,9](@ref)ã€‚
2.
éé˜»å¡è¿­ä»£ï¼š
- SCAN é€šè¿‡æ¸¸æ ‡åˆ†æ‰¹è¿”å›ç»“æœï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰é”®å¯¼è‡´ Redis é˜»å¡[6,8,10](@ref)ã€‚
3.
ç»“æœä¸€è‡´æ€§ï¼š
- åœ¨è¿­ä»£è¿‡ç¨‹ä¸­æ–°å¢/åˆ é™¤é”®å¯èƒ½å¯¼è‡´ç»“æœé‡å¤æˆ–é—æ¼ï¼Œéœ€ä¸šåŠ¡å±‚å»é‡[8,10](@ref)ã€‚
4.
æ€§èƒ½å½±å“ï¼š
- æ¨¡å¼è¶Šç²¾ç¡®ï¼ˆå¦‚ `user:1001:orders`ï¼‰ï¼ŒåŒ¹é…æ•ˆç‡è¶Šé«˜ã€‚
- é¿å…è¿‡åº¦æ³›åŒ–çš„æ¨¡å¼ï¼ˆå¦‚ `*:*:*`ï¼‰ï¼Œå¯èƒ½é™ä½æ‰«ææ•ˆç‡[6,9](@ref)ã€‚
------
### âš ï¸ **æ³¨æ„äº‹é¡¹**
1.
åŒ¹é…æ—¶æœºï¼š
- `MATCH` è¿‡æ»¤åœ¨æ•°æ®ä» Redis å–å‡ºåæ‰§è¡Œï¼Œè‹¥æ•°æ®é›†å¤§ä½†åŒ¹é…é¡¹å°‘ï¼Œå¯èƒ½å¤šæ¬¡è¿”å›ç©ºæ•°ç»„[8](@ref)ã€‚
2.
COUNT å‚æ•°ï¼š
- `COUNT` ä»…ä½œä¸ºæ¯æ¬¡è¿­ä»£çš„å‚è€ƒå€¼ï¼ˆéç²¾ç¡®è¿”å›æ•°é‡ï¼‰ï¼Œå®é™…è¿”å›æ•°é‡å¯èƒ½æ³¢åŠ¨[8,10](@ref)ã€‚
3.
ç¼–ç¨‹å®ç°ç¤ºä¾‹ï¼ˆJava + Jedisï¼‰ï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;try (Jedis jedis = new Jedis(&amp;ldquo;localhost&amp;rdquo;, 6379)) {
String cursor = &amp;ldquo;0&amp;rdquo;;
ScanParams params = new ScanParams().match(&amp;ldquo;user:*&amp;rdquo;).count(100);
do {
ScanResult&lt;String&gt; scanResult = jedis.scan(cursor, params);
List&lt;String&gt; keys = scanResult.getResult();
keys.forEach(System.out::println); // å¤„ç†åŒ¹é…çš„é”®
cursor = scanResult.getCursor();
} while (!cursor.equals(&amp;ldquo;0&amp;rdquo;));
}&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;
------
### ğŸ’ **é€‚ç”¨åœºæ™¯**
| **åœºæ™¯** | **æ¨èæ¨¡å¼** | **è¯´æ˜** |
| ---------------- | ---------------------- | ---------------------------------------- |
| æŒ‰ä¸šåŠ¡å±‚çº§æŸ¥è¯¢ | `user:1001:*` | ç²¾ç¡®åŒ¹é…ç”¨æˆ· ID ä¸º 1001 çš„æ‰€æœ‰å­é”® |
| è·¨æ¨¡å—é”®æœç´¢ | `*:order:*` | æŸ¥æ‰¾æ‰€æœ‰åŒ…å« &amp;#34;order&amp;#34; å±‚çº§çš„é”® |
| é«˜å¹¶å‘ç¯å¢ƒé”®éå† | åˆ†æ‰¹ SCAN + å®¢æˆ·ç«¯å»é‡ | é¿å…é˜»å¡ Redisï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒ[6,10](@ref) |
------
### âœ… **æ€»ç»“**
- **SCAN æ”¯æŒé€šè¿‡ `MATCH` å‚æ•°ç­›é€‰å« `:` çš„é”®**ï¼Œå¦‚ `user:*` æˆ– `*:profile`ã€‚
- **ä¼˜åŠ¿**ï¼šéé˜»å¡ã€å†…å­˜å®‰å…¨ï¼Œé€‚åˆå¤§è§„æ¨¡é”®ç©ºé—´éå†[6,8](@ref)ã€‚
- **å±€é™**ï¼šç»“æœå¯èƒ½é‡å¤/é—æ¼ï¼Œéœ€ä¸šåŠ¡å±‚å¤„ç†ï¼›æ³›åŒ–æ¨¡å¼å¯èƒ½é™ä½æ•ˆç‡[8,10](@ref)ã€‚
&amp;gt; ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œ**ä¼˜å…ˆä½¿ç”¨ SCAN æ›¿ä»£ KEYS**ï¼Œå°¤å…¶å½“é”®ååŒ…å«å±‚çº§åˆ†éš”ç¬¦ï¼ˆå¦‚ `:`ï¼‰æ—¶ï¼Œå¯æ˜¾è‘—æå‡ç³»ç»Ÿç¨³å®šæ€§[6,9](@ref)ã€‚
## PX &amp;amp; EX
åœ¨ Redis ä¸­ï¼ŒEX å’Œ PX æ˜¯ç”¨äºè®¾ç½®é”®å€¼å¯¹è¿‡æœŸæ—¶é—´çš„å‚æ•°ï¼Œæ ¸å¿ƒåŒºåˆ«åœ¨äºæ—¶é—´å•ä½ä¸åŒï¼š
EXï¼šä»¥ç§’ï¼ˆsecondsï¼‰ä¸ºå•ä½è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚
PXï¼šä»¥æ¯«ç§’ï¼ˆmillisecondsï¼‰ä¸ºå•ä½è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚
ä»¥ä¸‹æ˜¯å…·ä½“åŒºåˆ«å’Œå…¸å‹ä½¿ç”¨åœºæ™¯çš„å¯¹æ¯”ï¼š
â±ï¸ 1. æ—¶é—´å•ä½ä¸ç²¾åº¦
å‚æ•° å•ä½ å‘½ä»¤ç¤ºä¾‹ é€‚ç”¨åœºæ™¯
EX ç§’ï¼ˆsecondsï¼‰ SET key value EX 10 è®¾ç½®ç§’çº§è¿‡æœŸï¼ˆå¦‚ç¼“å­˜30åˆ†é’Ÿï¼šEX 1800ï¼‰
PX æ¯«ç§’ï¼ˆmillisecondsï¼‰ SET key value PX 5000 è®¾ç½®æ¯«ç§’çº§è¿‡æœŸï¼ˆå¦‚åˆ†å¸ƒå¼é”è¶…æ—¶æ§åˆ¶ï¼‰
ç¤ºä¾‹å¯¹æ¯”ï¼š
EX 1 = 1ç§’åè¿‡æœŸ
PX 1000 = 1000æ¯«ç§’ï¼ˆå³1ç§’ï¼‰åè¿‡æœŸ[citation:1][citation:5]ã€‚
âš™ï¸ 2. åŸå­æ€§æ“ä½œ
ä¸¤è€…å‡å¯ä¸ SET å‘½ä»¤çš„ NXï¼ˆé”®ä¸å­˜åœ¨æ—¶è®¾ç½®ï¼‰æˆ– XXï¼ˆé”®å­˜åœ¨æ—¶è®¾ç½®ï¼‰å‚æ•°ç»„åˆä½¿ç”¨ï¼Œä¿è¯è®¾ç½®å€¼ä¸è¿‡æœŸæ—¶é—´çš„åŸå­æ€§ï¼š
åŸå­æ“ä½œï¼šè®¾ç½®å€¼+è¿‡æœŸæ—¶é—´ï¼ˆé¿å…åˆ†æ­¥æ‰§è¡Œå¯¼è‡´æ­»é”é£é™©ï¼‰
SET lock_key unique_id NX EX 10 # ç§’çº§
SET lock_key unique_id NX PX 10000 # æ¯«ç§’çº§
é’é“œæ–¹æ¡ˆç¼ºé™·ï¼šåˆ†æ­¥æ‰§è¡Œ SETNX + EXPIRE å¯èƒ½å› ä¸­é—´å´©æºƒå¯¼è‡´æ­»é”ï¼Œè€Œ EX/PX ä¸€æ­¥æ“ä½œè§„é¿æ­¤é—®é¢˜[citation:2][citation:3]ã€‚
âš ï¸ 3. é€‚ç”¨åœºæ™¯
åœºæ™¯ æ¨èå‚æ•° åŸå› 
åˆ†å¸ƒå¼é”è¶…æ—¶æ§åˆ¶ PX éœ€ç²¾ç¡®æ§åˆ¶é”æŒæœ‰æ—¶é—´ï¼ˆå¦‚é”ç»­æœŸã€é˜²æ­»é”ï¼‰ï¼Œæ¯«ç§’çº§ç²¾åº¦æ›´å¯é [citation:2][citation:3]ã€‚
å¸¸è§„ç¼“å­˜è¿‡æœŸ EX ç§’çº§è¶³å¤Ÿæ»¡è¶³éœ€æ±‚ï¼ˆå¦‚ä¼šè¯è¶…æ—¶30åˆ†é’Ÿï¼‰[citation:7][citation:8]ã€‚
é«˜é¢‘çŸ­æœŸç¼“å­˜ PX æ¯«ç§’çº§é€‚åˆç¬æ—¶æ•°æ®ï¼ˆå¦‚é™æµè®¡æ•°å™¨ï¼‰[citation:5]ã€‚
ğŸ”§ 4. å…¶ä»–ç›¸å…³å‘½ä»¤
æŸ¥çœ‹å‰©ä½™æ—¶é—´ï¼š
TTL key â†’ è¿”å›ç§’çº§å‰©ä½™æ—¶é—´ï¼ˆ-1è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼Œ-2è¡¨ç¤ºé”®ä¸å­˜åœ¨ï¼‰[citation:8]ã€‚
PTTL key â†’ è¿”å›æ¯«ç§’çº§å‰©ä½™æ—¶é—´[citation:6]ã€‚
å–æ¶ˆè¿‡æœŸæ—¶é—´ï¼šPERSIST key ä½¿é”®æ°¸ä¸è¿‡æœŸ[citation:8]ã€‚
ğŸ’ æ€»ç»“
âœ… EXï¼šå¸¸è§„ç¼“å­˜ã€ä¼šè¯ç®¡ç†ç­‰ç§’çº§ç²¾åº¦è¶³å¤Ÿçš„åœºæ™¯ã€‚
âœ… PXï¼šåˆ†å¸ƒå¼é”ã€é«˜é¢‘è®¡æ•°å™¨ç­‰éœ€è¦æ¯«ç§’çº§ç²¾ç¡®æ§åˆ¶çš„åœºæ™¯ã€‚
âš ï¸ å…³é”®å»ºè®®ï¼š
ä¼˜å…ˆä½¿ç”¨ SET key value NX EX/PX åŸå­æ“ä½œï¼Œé¿å…åˆ†æ­¥è®¾ç½®å¯¼è‡´çš„æ­»é”é£é™©[citation:2][citation:3]ã€‚
åˆ†å¸ƒå¼é”åŠ¡å¿…é…åˆå”¯ä¸€æ ‡è¯†ï¼ˆå¦‚UUIDï¼‰å’ŒLuaè„šæœ¬é‡Šæ”¾ï¼Œé˜²æ­¢è¯¯åˆ å…¶ä»–çº¿ç¨‹çš„é”[citation:3]ã€‚
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>ã€Redisã€‘In Spring Boot</title><link>https://dyhes.github.io/p/redisin-spring-boot/</link><pubDate>Mon, 23 Sep 2024 00:00:00 +0000</pubDate><guid>https://dyhes.github.io/p/redisin-spring-boot/</guid><description>&lt;h2 id="dependency"&gt;dependency
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;dependency&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;groupId&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;springframework&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;boot&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;groupId&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;artifactId&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;boot&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;starter&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;redis&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;artifactId&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;dependency&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="applicationproperties"&gt;application.properties
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;redis&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;redis&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;6379&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="composeyaml"&gt;compose.yaml
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-dockerfile" data-lang="dockerfile"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;redis:&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; &lt;span class="c1"&gt;# ä¸ â€™redis:latest&amp;#39; subtle differences&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; image: redis:latest&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; container_name: postopia-redis&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; ports:&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;&lt;/span&gt; - &lt;span class="s2"&gt;&amp;#34;6379:6379&amp;#34;&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="config"&gt;Config
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Configuration&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RedisConfig&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisConnectionFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;redisConnectionFactory&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LettuceConnectionFactory&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Bean&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisTemplate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RedisConnectionFactory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connectionFactory&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisTemplate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisTemplate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setConnectionFactory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;connectionFactory&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Use String serializers for keys&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setKeySerializer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StringRedisSerializer&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setValueSerializer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StringRedisSerializer&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="service"&gt;Service
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@Service&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RedisService&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nd"&gt;@Autowired&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RedisTemplate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;setByMinute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;minute&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;opsForValue&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;minute&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TimeUnit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MINUTES&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;opsForValue&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;redisTemplate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>